"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[15711],{18530:(e,t,r)=>{r.d(t,{V:()=>i});var n=()=>r(762433),s=()=>r(640653);function i(e){const{spaceStore:t,billingData:r,isMmOrEnterprise:i}=e;if((0,n().N8)(null==r?void 0:r.subscription))return"sales_assisted";return t&&i&&!(0,s().hT)(t)?"sales_eligible":"self_serve"}},94825:(e,t,r)=>{r.r(t),r.d(t,{getUpgradeSystemAction:()=>g,triggerUpgrade:()=>v});var n=()=>r(646736),s=()=>r(765957),i=()=>r(19575),a=()=>r(128265),o=()=>r(749356),l=()=>r(324561),u=()=>r(18530),c=()=>r(295870),d=()=>r(153861);const p={eligible_to_request:e=>{let{environment:t,product:n,source:s,userId:i,setRequestState:a}=e;return n&&(0,r(232802).rU)(n)?((0,r(2220).u)({environment:t,event:{eventName:"upgrade_request_button_clicked",eventProperties:{feature:n,entrypoint:s}}}),r(398304).Q.update((e=>({open:!0,feature:n,userId:i,setRequestState:a,entrypoint:"upgrade_system"}))),Promise.resolve()):Promise.resolve()},eligible_for_trial:async e=>{let{environment:t,spaceStore:n,billingData:s,product:i,source:a}=e;i&&await(0,r(911964).showUpgradeModal)({environment:t,spaceStore:n,billingData:s,product:i,from:a,isTrial:!0})},request_pending:()=>Promise.resolve(),eligible_for_upgrade:async e=>{let{environment:t,spaceStore:n,source:s,billingData:i,product:a}=e;if(!a)return;const{showUpgradeModal:o}=await Promise.resolve().then(r.bind(r,911964));await o({environment:t,spaceStore:n,billingData:i,product:a,from:s,isTrial:!1})},not_eligible:async()=>{},sales_assisted:()=>((0,i().cz)(),Promise.resolve()),sales_eligible:e=>{let{source:t,product:n}=e;const s=n?(0,r(134217).pt)(n):void 0;return(0,i().lK)({openedFrom:t,initialQuestion:s}),Promise.resolve()}};function g(e){const t=p[e.status];return async e=>{await t(e)}}async function v(e){var t;const r=s().default.state.currentSpaceStore;if(!r)return;const{upsell:i,source:p,environment:v}=e,b=(null===(t=v.currentUser)||void 0===t?void 0:t.id)||"",_=(0,n().dp)(r,b),m="product"===i.type?i.product:void 0,[f,S]=await Promise.all([(0,l().OD)({spaceId:r.id,environment:v}),(0,a().G)(v)]),y=(0,u().V)({spaceStore:r,billingData:f,isMmOrEnterprise:S}),q=(0,c().Jg)({product:m,spaceId:r.id,userId:b,billingData:f,environment:v,spaceUserStore:_,spaceStore:r}),w="product"===i.type&&"preferred"===i.trialability?await(0,o().OC)(v,r.id,p):void 0,D=g((0,d().a)({environment:v,upsell:i,salesStatus:y,requestState:q,spaceStore:r,offer:w}));await D({userId:b,source:p,product:m,billingData:(0,l().a9)(f),spaceStore:r,environment:v})}},153861:(e,t,r)=>{r.d(t,{T:()=>s,a:()=>i});var n=()=>r(979340);function s(e){let{upsell:t,intl:r}=e;return"product"===t.type?(0,n().u2)({product:t.product,intl:r}):void 0}function i(e){const{upsell:t,spaceStore:r,salesStatus:s,offer:i,requestState:a}=e;return"unrequested"===a?{status:"eligible_to_request"}:"pending"===a?{status:"request_pending"}:null!=r&&r.canAdmin()?"none"===t.type?{status:"not_eligible"}:"sales_assisted"===s?{status:"sales_assisted"}:(0,n().h0)(t.product)&&"sales_eligible"===s?{status:"sales_eligible"}:"preferred"===t.trialability&&"trial"===(null==i?void 0:i.type)&&i.subscriptionTier===t.product?{status:"eligible_for_trial"}:{status:"eligible_for_upgrade"}:{status:"not_eligible"}}},295870:(e,t,r)=>{r.d(t,{Jg:()=>l});r(898992),r(672577);var n=()=>r(232802),s=()=>r(762433),i=()=>r(979340),a=()=>r(807778),o=()=>r(920370);function l(e){var t;const{product:r,spaceId:l,userId:u,environment:c,billingData:d,spaceUserStore:p,spaceStore:g}=e;if(!r||!l||!u)return"not_eligible";if((0,s().eh)(d,r))return"product_already_available";const v=(0,n().rU)(r),b=function(e){const{billingData:t,environment:r,spaceUserStore:n,spaceStore:o}=e;if(!o||!n||!t)return!1;const l=(0,a().Gy)(r),u=o.getDisableMemberUpgradeRequests();if(!l)return!1;if(u)return!1;if(!(0,i().jR)((0,s().AI)(t)))return!1;if((0,s().et)(t))return!1;const c=Boolean(n.isMember()&&!n.isWorkspaceOwner());return c}({billingData:d,environment:c,spaceUserStore:p,spaceStore:g});if(!v||!b)return"not_eligible";const _=function(e){let{spaceId:t,environment:r}=e;if(!t)return;return o().L.getData(r,{spaceId:t})}({spaceId:l,environment:c});if(!_)return"not_eligible";const m=null===(t=_[r])||void 0===t?void 0:t.find((e=>e.created_by_id===u));return(null==m?void 0:m.request_status)||"unrequested"}},398304:(e,t,r)=>{r.d(t,{Q:()=>n});const n=r(757695).Store.createValue({open:!1},{name:"UpgradeRequestFormModalStore"})},920370:(e,t,r)=>{r.d(t,{L:()=>n});const n=new(r(391685).n)((e=>{let{spaceId:t}=e;return t}),(async(e,t)=>{const n=await Promise.resolve().then(r.bind(r,449506)),s=await n.callApi({eventName:"getAllUpgradeRequestsForSpace",environment:e,data:t}),i=[{key:(0,r(921997).VI)(t),version:-1}];return"success"===s.type?{value:s.data.requests,dependencies:s.data.dependencies??i}:void 0}))}}]);