"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[61440],{350646:(e,t,s)=>{s.d(t,{k:()=>n});s(296540);var a=s(474848);const o={viewBox:"0 0 20 20",fittedViewBox:"1.27 3.53 17.42 12.94",svg:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("path",{d:"M10.375 6.775c.345 0 .625.28.625.625v3.15a.625.625 0 1 1-1.25 0V7.4c0-.345.28-.625.625-.625m0 6.775a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5"}),(0,a.jsx)("path",{d:"M4.066 8.914a6.477 6.477 0 0 1 12.859 1.029 3.494 3.494 0 0 1-1.725 6.532H5.121a3.855 3.855 0 0 1-1.056-7.56m6.384-4.14a5.226 5.226 0 0 0-5.2 4.716l-.047.482-.48.075a2.605 2.605 0 0 0 .406 5.178H15.2a2.244 2.244 0 0 0 .853-4.32l-.41-.169.024-.443q.008-.146.008-.293a5.225 5.225 0 0 0-5.225-5.225"})]})},n=(0,s(340498).wt)("cloudExclamation",o)},659064:(e,t,s)=>{s.r(t),s.d(t,{OfflinePagesListener:()=>C,TestOnlyOfflineToastManager:()=>D});s(898992),s(803949);var a=s(296540),o=()=>s(852507),n=()=>s(56366),i=()=>s(415622),l=()=>s(340498),d=s(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"1.27 3.53 17.42 12.94",svg:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("path",{d:"M10.45 8.089v.936c0 .45-.54.672-.857.355L8.248 8.034a.495.495 0 0 1 0-.71L9.593 5.98a.501.501 0 0 1 .857.355v.654a3.46 3.46 0 1 1-3.461 3.46.55.55 0 1 1 1.1 0 2.36 2.36 0 1 0 2.361-2.36"}),(0,d.jsx)("path",{d:"M4.066 8.914a6.477 6.477 0 0 1 12.859 1.029 3.494 3.494 0 0 1-1.725 6.532H5.121a3.855 3.855 0 0 1-1.056-7.56m6.384-4.14a5.226 5.226 0 0 0-5.2 4.716l-.047.482-.48.075a2.605 2.605 0 0 0 .406 5.178H15.2a2.244 2.244 0 0 0 .853-4.32l-.41-.169.024-.443q.008-.146.008-.293a5.225 5.225 0 0 0-5.225-5.225"})]})},c=(0,l().wt)("cloudArrowCircleCounterclockwiseLeft",r),u={viewBox:"0 0 20 20",fittedViewBox:"1.28 3.52 17.42 12.96",svg:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("path",{d:"M12.786 8.665a.625.625 0 1 0-1.072-.643L9.46 11.778l-1.235-1.441a.625.625 0 0 0-.95.813l1.8 2.1a.625.625 0 0 0 1.01-.085z"}),(0,d.jsx)("path",{d:"M10.45 3.525a6.48 6.48 0 0 0-6.384 5.39 3.856 3.856 0 0 0 1.056 7.56H15.2a3.494 3.494 0 0 0 1.725-6.532 6.475 6.475 0 0 0-6.475-6.418M5.25 9.49a5.226 5.226 0 0 1 10.417.803l-.024.443.41.17a2.245 2.245 0 0 1-.854 4.319H5.13a2.605 2.605 0 0 1-.405-5.178l.479-.075z"})]})},f=(0,l().wt)("cloudCheck",u);var w=()=>s(350646),g=()=>s(959013),p=()=>s(209660),x=()=>s(812182),T=()=>s(364280),j=()=>s(554509),v=()=>s(78901),h=()=>s(963589),m=()=>s(722038),M=()=>s(670631);function C(){const e=(0,m().y)(),t=(0,h().X)("offline_desktop_ui_updates");return e&&t?(0,d.jsx)(O,{}):null}const A="offlineInfoToast",k="offlineErrorToast",b=new(s(178624).R)({key:"offlineToastSettings",namespace:s(419494).Bq,important:!1,trackingType:"preference"});function y(){p().Ow({currentTab:"offline",openedFrom:"sidebar_offline_indicator"})}function O(){const[e,t]=(0,a.useState)({}),s=(0,n().K8)((()=>M().A.state.offlinePages??i().Pc),[]),l=(0,a.useRef)();(0,o().w)((()=>{var e;const a=null===(e=b.state)||void 0===e?void 0:e.errorDismissedTs;t((()=>{const e={};for(const[t,o]of Object.entries(s))if(null!=o&&o.isExplicitlyOfflinedOrigin&&"failed"===(null==o?void 0:o.downloadStatus)){(!a||o.lastDownloadedAt&&o.lastDownloadedAt>a)&&(e[t]="failed")}return e}))})),(0,a.useEffect)((()=>{t((e=>{const t={...e};let a=!1;for(const[o,n]of Object.entries(s))null!=n&&n.isExplicitlyOfflinedOrigin&&void 0!==(null==n?void 0:n.downloadStatus)&&("downloading"!==n.downloadStatus||o in e?o in e&&n.downloadStatus!==e[o]&&(t[o]=n.downloadStatus,a=!0):(t[o]=n.downloadStatus,a=!0));return a?t:e}))}),[s]);const r=(0,a.useCallback)((e=>{t((t=>{const s={...t};return Object.entries(t).forEach((t=>{let[a,o]=t;e.includes(o)&&delete s[a]})),s})),e.includes("failed")&&b.setState({...b.state,errorDismissedTs:Date.now()})}),[]),u=(0,a.useCallback)(((e,t)=>{const s=e+t;return{id:A,actions:{primary:{onAction:()=>{l.current&&clearTimeout(l.current),x().UW(A),y()},title:(0,d.jsx)(g().sA,{id:"offline.statusToast.primaryActionTitle",defaultMessage:"View all downloads"})}},icon:e>0?c:f,jsxMessage:(0,d.jsxs)(T().VP,{gap:8,children:[(0,d.jsx)(j().D,{colorName:"secondary",children:(0,d.jsx)(g().sA,{id:"offline.statusToast.infoMessage",defaultMessage:"{downloadedCount} of {totalCount} pages downloaded",values:{downloadedCount:t,totalCount:s}})}),(0,d.jsx)(v().z,{percentage:t/s*100})]}),onDismiss:()=>{r(["downloading","success"])},presentationType:"persistent",title:e>0?(0,d.jsx)(g().sA,{id:"offline.statusToast.downloadingTitle",defaultMessage:"Download in progress"}):(0,d.jsx)(g().sA,{id:"offline.statusToast.successTitle",defaultMessage:"Download complete"})}}),[r]),p=(0,a.useCallback)((e=>({id:k,actions:{primary:{onAction:()=>{x().UW(k),y()},title:(0,d.jsx)(g().sA,{id:"offline.statusToast.primaryActionTitle",defaultMessage:"View all downloads"})}},icon:w().k,jsxMessage:(0,d.jsx)(j().D,{children:(0,d.jsx)(g().sA,{id:"offline.statusToast.failedMessage",defaultMessage:(0,g().LS)("failedCount",{one:"# page has failed to download",other:"# pages have failed to download"}),values:{failedCount:e}})}),onDismiss:()=>{r(["failed"])},presentationType:"persistent",title:(0,d.jsx)(g().sA,{id:"offline.statusToast.failedTitle",defaultMessage:(0,g().LS)("failedCount",{one:"# error",other:"# errors"}),values:{failedCount:e}}),variant:"error"})),[r]);return(0,a.useEffect)((()=>{let t=0,s=0,a=0;return Object.values(e).forEach((e=>{"downloading"===e?t+=1:"failed"===e?s+=1:"success"===e&&(a+=1)})),l.current&&(clearTimeout(l.current),l.current=void 0),t>0||a>0?(x().HK(u(t,a)),0===t&&(l.current=setTimeout((()=>{x().UW(A)}),1e4))):0===t&&0===a&&x().UW(A),s>0&&x().HK(p(s)),()=>{l.current&&clearTimeout(l.current)}}),[p,u,e]),null}const D=O}}]);