"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[18766],{124954:(e,t,o)=>{o.d(t,{w:()=>g});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(987555),s=()=>o(246826),d=()=>o(751156),c=()=>o(187820),u=()=>o(738865),p=o(474848);function g(e){const{clickTitleBehavior:t,blockStore:o,format:l,shouldWrap:g}=e,f="edit"===t,h=(0,i().v3)(),[y,b,k]=(0,r().K8)((()=>[o.getIcon(),o.isEmptyPage(),o.isReady()&&"none"===o.getRole()]),[o]),m=(0,r().K8)((()=>(0,c().Te)(o)),[o]),{style:x}=(0,a().IS)((()=>({style:{flexShrink:0,marginRight:f?0:u().U[l].recordIconMarginRight,justifyContent:"flex-start",...g&&{display:"inline-block",verticalAlign:"text-top",marginBottom:-1}}})),[f,l,g]),v=(0,n.useCallback)((e=>{const t=o.getIconStore();t&&d().createAndCommit({userAction:"RelationToken.handleRecordIconChange",environment:h,canUndo:!0,perform:o=>{s().KY({store:t,value:e,transaction:o})}})}),[o,h]),M={icon:y,size:u().U[l].pageIconSize,isEmptyPage:b,iconRecordCategory:m,style:x};return k?(0,p.jsx)(S,{...M}):f?(0,p.jsx)(c().B6,{...M,disabled:!1,onChange:v,bucket:"public"}):(0,p.jsx)(c().B6,{...M,disabled:!0})}function S(e){const t=(0,a().DP)();return(0,l().T)({...e.style,width:e.size,height:e.size,fill:t.icon.secondary,verticalAlign:"top",marginTop:1})}},163194:(e,t,o)=>{o.d(t,{A:()=>i});o(898992),o(672577);class n extends(()=>o(959180))().A{findRow(e,t,o){return this.find((n=>n.relatedPageStoreId===e&&n.rowType===t&&n.property===o))}}const i=new n},197534:(e,t,o)=>{o.d(t,{Q:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("settingsMembersFilled",{viewBox:"0 0 20 13",svg:(0,n.jsx)("path",{d:"M13.582 6.00293C15.0723 6.00293 16.3369 4.67676 16.3369 2.96094C16.3369 1.28613 15.0654 0.0078125 13.582 0.0078125C12.0986 0.0078125 10.8203 1.30664 10.8271 2.97461C10.8271 4.67676 12.0918 6.00293 13.582 6.00293ZM5.67969 6.16016C6.97852 6.16016 8.0791 4.99805 8.0791 3.50781C8.0791 2.04492 6.97168 0.9375 5.67969 0.9375C4.3877 0.9375 3.27344 2.06543 3.28027 3.52148C3.28027 4.99805 4.38086 6.16016 5.67969 6.16016ZM1.91309 12.3604H7.0332C6.30859 11.3145 7.1084 9.25 8.64648 8.04688C7.89453 7.55469 6.91016 7.19922 5.67969 7.19922C2.62402 7.19922 0.648438 9.44824 0.648438 11.3076C0.648438 11.9775 0.990234 12.3604 1.91309 12.3604ZM9.31641 12.3604H17.8408C18.9619 12.3604 19.3516 12.0186 19.3516 11.3965C19.3516 9.63281 17.123 7.21289 13.5752 7.21289C10.0342 7.21289 7.80566 9.63281 7.80566 11.3965C7.80566 12.0186 8.19531 12.3604 9.31641 12.3604Z"})})},243443:(e,t,o)=>{o.d(t,{d:()=>re,RelationMenuRow:()=>q});o(898992),o(354520),o(581454);var n=o(296540),i=()=>o(402014),r=()=>o(484714),a=()=>o(790748),l=()=>o(56366),s=()=>o(401497),d=()=>o(584262),c=()=>o(66689),u=()=>o(784892),p=()=>o(168687),g=()=>o(212050),S=()=>o(887146),f=()=>o(689094),h=()=>o(197534),y=()=>o(413267),b=()=>o(959013),k=()=>o(496603),m=()=>o(534177),x=()=>o(284371),v=()=>o(727395),M=()=>o(281948),w=()=>o(458366),T=()=>o(544073),R=()=>o(728611),I=()=>o(972435),C=()=>o(592678),B=()=>o(685889),P=()=>o(571468),A=()=>o(806401),j=()=>o(163194),L=()=>o(205682),E=()=>o(712505),O=()=>o(239391),W=o(474848);const z=(0,b().YK)({openAsPageTitle:{defaultMessage:"Open",id:"database.navigateButton.openAsPageTitle"},openPageSidePeekAriaLabel:{defaultMessage:"Open in side peek",id:"database.relationMenuRow.button.openPageSidePeek.ariaLabel"},openPageCenterPeekAriaLabel:{defaultMessage:"Open in center peek",id:"database.relationMenuRow.button.openPageCenterPeek.ariaLabel"},openPageFullPageAriaLabel:{defaultMessage:"Open as page",id:"database.relationMenuRow.button.openPageFullPage.ariaLabel"}});function U(e){const{hideLabel:t,style:n,peekMode:i,onOpenPageButtonClick:r}=e;let a,l,s;return"side_peek"===i?(a=z.openPageSidePeekAriaLabel,l=o(177256).A,s=(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.openPageSidePeek.message",defaultMessage:"Open in side peek"})):"center_peek"===i?(a=z.openPageCenterPeekAriaLabel,l=o(415566).q,s=(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.openPageCenterPeek.message",defaultMessage:"Open in center peek"})):"full_page"===i?(a=z.openPageFullPageAriaLabel,l=o(882262).m,s=(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.openPage.message",defaultMessage:"Open as page"})):(0,m().HB)(i),(0,W.jsx)(re,{caption:t?void 0:I().A.formatMessage(z.openAsPageTitle),ariaLabel:I().A.formatMessage(a),onClick:r,style:{width:60,...n},icon:l,tooltipMessage:s})}const N=n.memo(U);var H=()=>o(828180),K=()=>o(704152),V=()=>o(57232),D=()=>o(59364),_=()=>o(285790),Y=()=>o(678553),F=()=>o(958378),G=()=>o(859428),Q=()=>o(566081);const Z=(0,b().YK)({dragRowHandleAriaLabel:{defaultMessage:"Drag to move a related page",id:"database.relationMenuRow.dragRowHandle.ariaLabel"},floatingInsertButtonAriaLabel:{defaultMessage:"Create a new related page",id:"database.relationMenuRow.floatingInsertButton.ariaLabel"},defaultIsSelectedPrimaryButtonAriaLabel:{defaultMessage:"Unlink page",id:"database.relationMenuRow.button.primary.default.isSelected.ariaLabel"},defaultIsNotSelectedPrimaryButtonAriaLabel:{defaultMessage:"Link page",id:"database.relationMenuRow.button.primary.default.isNotSelected.ariaLabel"},sprintIsSelectedPrimaryButtonAriaLabel:{defaultMessage:"Remove this sprint",id:"database.relationMenuRow.button.primary.sprint.isSelected.ariaLabel"},sprintIsNotSelectedPrimaryButtonAriaLabel:{defaultMessage:"Add this sprint",id:"database.relationMenuRow.button.primary.sprint.isNotSelected.ariaLabel"},defaultIsSelectedSecondaryButtonAriaLabel:{defaultMessage:"Insert new page",id:"database.relationMenuRow.button.secondary.default.isSelected.ariaLabel"},defaultIsNotSelectedSecondaryButtonAriaLabel:{defaultMessage:"Link another page",id:"database.relationMenuRow.button.secondary.default.isNotSelected.ariaLabel"},sprintIsSelectedSecondaryButtonAriaLabel:{defaultMessage:"Insert new page",id:"database.relationMenuRow.button.secondary.sprint.isSelected.ariaLabel"},sprintIsNotSelectedSecondaryButtonAriaLabel:{defaultMessage:"Move to a different sprint",id:"database.relationMenuRow.button.secondary.sprint.isNotSelected.ariaLabel"}}),$=48;function q(e){const{collectionStore:t,collectionId:o,schema:i,propertySchema:s,targetCollectionStore:u,relatedPageStore:p,isSelected:g,disabled:S,locked:f,canDrag:h,pageStore:y,property:b,propertyLimit:k,limitReached:m,rowType:x,onActionButtonClick:w,onSecondaryButtonClick:I,onOpenPageButtonClick:C,onMouseEnter:B,onMouseLeave:O,blockPropertyValueOverlayStore:z,onInsertInline:U,onTitleEsc:N,index:H,focused:K,disableClickToNavigateToPage:V}=e,[D,_]=n.useState(!1),Y=(0,r().v3)(),F=(0,r().Y0)(),G=n.useRef(null),Q=n.useRef(null);(0,a().b)(j().A,(()=>({relatedPageStoreId:p.id,rowType:x,property:b,relationTokenBlockStoreRef:G,getNode:()=>Q.current})),[p,x,b]);const Z=(0,l().K8)((()=>{if(E().default.state.open)return E().default.state.mode;const e=null==z?void 0:z.state;if(null==e||!e.isOpen||null==e||!e.collectionContextStore)return E().default.state.mode;const t=e.collectionContextStore,o=null==t?void 0:t.collectionViewStore(),n=null==o?void 0:o.getType();return o&&n?o.getFormat().collection_peek_mode??T().C9[n]:E().default.state.mode}),[z]),$=(0,l().K8)((()=>u.getDatabaseType()),[u]),q=(0,A().D)(s);if((0,P().W)(p))return null;if(F.isPhone&&"popup"===x)return q?(0,W.jsx)(le,{...e}):(0,W.jsx)(se,{...e});if(q){const e=(0,W.jsx)(X,{canDrag:h,rowType:x,focused:K,disabled:S,locked:f,relatedPageStore:p,pageStore:y,onInsertInline:U,index:H,blockPropertyValueOverlayStore:z,collectionStore:t,targetCollectionStore:u,property:b,relationTokenBlockStoreRef:G});return(0,W.jsx)(ie,{innerRelationMenuRow:e,handleButtonClick:e=>function(e,t,o,n){o||n||t(e)}(e,w,S,g),canDrag:h,rowType:x,focused:K,disabled:S,limitReached:m,propertyLimit:k,hasMouseEntered:D,sectionOnClick:e=>Se(e,Y,o,u,g,p,w,S,Z),outerRef:Q,onSecondaryButtonClick:I,onMouseEnter:B,onMouseLeave:O})}if($===c().av){const e=(0,W.jsx)(ee,{canDrag:h,rowType:x,focused:K,disabled:S,locked:f,isSelected:g,onSecondaryButtonClick:I,onOpenPageButtonClick:C,onActionButtonClick:w,propertyLimit:k,relatedPageStore:p,pageStore:y,onInsertInline:U,index:H,blockPropertyValueOverlayStore:z,collectionStore:t,targetCollectionStore:u,property:b,relationTokenBlockStoreRef:G,outerRef:Q,peekMode:Z});return(0,W.jsx)(ie,{innerRelationMenuRow:e,handleButtonClick:e=>function(e,t,o,n){o||n||t(e)}(e,w,S,g),canDrag:h,rowType:x,focused:K,disabled:S,limitReached:m,propertyLimit:k,hasMouseEntered:D,sectionOnClick:e=>Se(e,Y,o,u,g,p,w,S,Z),outerRef:Q,onSecondaryButtonClick:I,onMouseEnter:B,onMouseLeave:O})}{const e=(0,W.jsx)(J,{canDrag:h,rowType:x,focused:K,disabled:S,locked:f,propertyLimit:k,limitReached:m,isSelected:g,onSecondaryButtonClick:I,onOpenPageButtonClick:C,onActionButtonClick:w,relatedPageStore:p,pageStore:y,onInsertInline:U,onTitleEsc:N,index:H,blockPropertyValueOverlayStore:z,collectionStore:t,schema:i,targetCollectionStore:u,property:b,relationTokenBlockStoreRef:G,outerRef:Q,peekMode:Z}),n=(0,W.jsx)(ie,{innerRelationMenuRow:e,handleButtonClick:e=>function(e,t,o,n,i,r,a,l,s,c,u,p){if(a||s){if(p)return;const r=R().Vr(e),a=o===n.id?E().default.state.resultsStore:void 0,s=o===n.id?E().default.state.collectionContextStore:void 0,g=E().default.isSidePeekOpen();if(M().VU({environment:t,store:i,peekMode:c,openInNew:r,resultsStore:a,collectionContextStore:s,pageVisitSource:d().y8.PeekOpen}),(0,v()._)(t,{from:"inline"===l||"section"===l?"property_value":"configure_relation_modal",meta_click:Boolean(r)}),"popup"===l&&!g){(u??L().A).setState({isOpen:!1})}}else r(e)}(e,Y,o,u,p,w,S,x,g,Z,z,V),canDrag:h,rowType:x,focused:K,disabled:S,limitReached:m,propertyLimit:k,hasMouseEntered:D,sectionOnClick:e=>Se(e,Y,o,u,g,p,w,S,Z),outerRef:Q,onMouseEnter:B,onMouseLeave:O});return(0,W.jsx)(te,{rowContainer:n,disabled:S,locked:f,canDrag:h,rowType:x,targetCollectionStore:u,propertyLimit:k,hasMouseEntered:D,outerRef:Q,handleMouseEnter:()=>_(!0),handleMouseLeave:()=>_(!1),onInsertInline:U})}}function J(e){const{canDrag:t,rowType:o,focused:n,disabled:i,locked:a,propertyLimit:d,limitReached:c,isSelected:u,onSecondaryButtonClick:g,onOpenPageButtonClick:S,onActionButtonClick:h,relatedPageStore:y,pageStore:m,onInsertInline:x,onTitleEsc:v,index:M,blockPropertyValueOverlayStore:T,collectionStore:R,targetCollectionStore:C,schema:P,property:A,relationTokenBlockStoreRef:j,outerRef:L,peekMode:E}=e,O=(0,r().Y0)(),z=(0,s().IS)((e=>({dragHandle:{marginLeft:2,height:20}})),[]),U=(0,l().K8)((()=>"section"===o&&!i&&y.canEdit()&&!O.isMobile),[o,i,y,O.isMobile]),N=O.isPhone?(0,W.jsx)(ne,{relatedPageStore:y,rowType:o,pageStore:m,canEditTitle:U,shouldShowOverflow:!1,noUnderline:!1,relationTokenBlockStoreRef:j,onInsertInline:x,onTitleEsc:v,index:M}):(0,W.jsx)(oe,{collectionStore:R,property:A,relatedPageStore:y,targetCollectionStore:C,blockPropertyValueOverlayStore:T,rowType:o,pageStore:m,index:M,onInsertInline:x,onTitleEsc:v,canEditTitle:U,shouldShowOverflow:!1,noUnderline:!1,disabled:i,relationTokenBlockStoreRef:j}),H=(0,l().K8)((()=>B().s2(P,A)),[P,A]),K=(0,l().K8)((()=>{const e=null==T?void 0:T.state;if(e&&e.isOpen)return e.format}),[T]),D=function(e){const{device:t,rowType:o,focused:n,disabled:i,locked:r,propertyLimit:a,limitReached:l,onSecondaryButtonClick:s,onOpenPageButtonClick:d,onActionButtonClick:c,isSelected:u,isGithubRelationProperty:g,peekMode:S,onClick:h,format:y}=e,m=!t.isMobile&&n&&!i&&"section"===o&&!k().b0(d),x=(t.isMobile||n)&&!r&&!i&&!l&&(void 0===a||a>1),v=!t.isMobile&&!r&&n&&!i&&"inline"===o&&!k().b0(s),M=x?function(e){const{isSelected:t,isGithubRelationProperty:o,onActionButtonClick:n,format:i}=e,r=t?Z.defaultIsSelectedPrimaryButtonAriaLabel:Z.defaultIsNotSelectedPrimaryButtonAriaLabel;let a;const l=t?p().t:f().W;a=i&&(0,w().NN)(i)?void 0:t?o?(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.removePR.message",defaultMessage:"Unlink PR"}):(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.removePage.message",defaultMessage:"Unlink page"}):o?(0,W.jsx)(b().sA,{defaultMessage:"Link PR",id:"database.relationMenuRow.tooltip.addPR.message"}):(0,W.jsx)(b().sA,{defaultMessage:"Link page",id:"database.relationMenuRow.tooltip.addPage.message"});return(0,W.jsx)(re,{ariaLabel:I().A.formatMessage(r),onClick:n,style:{borderRadius:3},icon:l,tooltipMessage:a})}({isSelected:u,isGithubRelationProperty:g,onActionButtonClick:c,format:y}):void 0,T=v?function(e){const{rowType:t,isSelected:o,isGithubRelationProperty:n,onClick:i}=e;let r;r="section"===t&&o?n?(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPRInline.message",defaultMessage:"Insert new PR"}):(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPageInline.message",defaultMessage:"Insert new page"}):n?(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPR.message",defaultMessage:"Link another PR"}):(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPage.message",defaultMessage:"Link another page"});const a="section"===t&&o?Z.defaultIsSelectedSecondaryButtonAriaLabel:Z.defaultIsNotSelectedSecondaryButtonAriaLabel;return(0,W.jsx)(re,{ariaLabel:I().A.formatMessage(a),onClick:i,style:{borderRadius:0},icon:f().W,tooltipMessage:r})}({rowType:o,isSelected:u,isGithubRelationProperty:g,onClick:h}):void 0,R=m&&void 0!==d?(0,W.jsx)(ge,{peekMode:S,showPrimaryButton:void 0!==M,showSecondaryButton:void 0!==T,onOpenPageButtonClick:d}):void 0;return(0,W.jsx)(pe,{primaryButton:M,secondaryButton:T,openPageButton:R})}({device:O,rowType:o,focused:n,disabled:i,locked:a,propertyLimit:d,limitReached:c,isSelected:u,onSecondaryButtonClick:g,onOpenPageButtonClick:S,onActionButtonClick:h,isGithubRelationProperty:H,peekMode:E,onClick:()=>null==g?void 0:g(L.current),format:K});return(0,W.jsxs)(W.Fragment,{children:[t&&"popup"===o&&(0,W.jsx)(V().A,{iconSize:12,style:z.dragHandle}),N,D]})}function X(e){const{canDrag:t,rowType:o,disabled:n,relatedPageStore:i,pageStore:a,onInsertInline:d,onTitleEsc:c,index:u,blockPropertyValueOverlayStore:p,collectionStore:g,targetCollectionStore:S,property:f,relationTokenBlockStoreRef:y}=e,b=(0,r().Y0)(),k=(0,s().IS)((e=>({dragHandle:{marginLeft:2,height:20},iconWrapper:{display:"flex",alignItems:"center",marginLeft:"auto",height:24,padding:0,paddingRight:4},membersIcon:{width:16,height:16,fill:e.icon.secondary,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]),m=(0,l().K8)((()=>"section"===o&&!n&&i.canEdit()&&!b.isMobile),[o,n,i,b.isMobile]),x=(0,W.jsxs)(W.Fragment,{children:[t&&"popup"===o&&(0,W.jsx)(V().A,{iconSize:12,style:k.dragHandle}),(0,W.jsx)(ne,{relatedPageStore:i,rowType:o,pageStore:a,canEditTitle:m,shouldShowOverflow:!0,noUnderline:!0,relationTokenBlockStoreRef:y,onInsertInline:d,onTitleEsc:c,index:u})]}),v=(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(oe,{collectionStore:g,property:f,relatedPageStore:i,targetCollectionStore:S,blockPropertyValueOverlayStore:p,rowType:o,pageStore:a,index:u,onInsertInline:d,onTitleEsc:c,canEditTitle:m,shouldShowOverflow:!0,noUnderline:!0,disabled:n,relationTokenBlockStoreRef:y}),(0,W.jsx)("div",{style:k.iconWrapper,children:(0,h().Q)(k.membersIcon)})]}),M=(0,W.jsxs)(W.Fragment,{children:[t&&(0,W.jsx)(V().A,{iconSize:12,style:k.dragHandle}),v]}),w="popup"===o?M:v;return b.isPhone?x:w}function ee(e){const{canDrag:t,rowType:o,focused:n,disabled:i,locked:a,isSelected:d,onSecondaryButtonClick:c,onOpenPageButtonClick:u,onActionButtonClick:g,propertyLimit:S,relatedPageStore:h,pageStore:m,onInsertInline:x,onTitleEsc:v,index:M,blockPropertyValueOverlayStore:w,collectionStore:T,targetCollectionStore:R,property:C,relationTokenBlockStoreRef:B,outerRef:P,peekMode:A}=e,j=(0,r().Y0)(),L=(0,s().IS)((e=>({dragHandle:{marginLeft:2,height:20},iconWrapper:{display:"flex",marginLeft:"auto",alignItems:"center",justifyContent:"center",padding:0,height:24},icon:{width:16,height:16,fill:e.icon.primary,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]),E=(0,l().K8)((()=>"section"===o&&!i&&h.canEdit()&&!j.isMobile),[o,i,h,j.isMobile]),O=function(e){const{device:t,rowType:o,focused:n,disabled:i,locked:r,onSecondaryButtonClick:a,onOpenPageButtonClick:l,onActionButtonClick:s,isSelected:d,propertyLimit:c,peekMode:u,onClick:g}=e,S=!t.isMobile&&n&&!i&&("section"===o||"inline"===o)&&!k().b0(l),h=(t.isMobile||n)&&!r&&!i,y="section"!==o?(t.isMobile||n)&&!r&&!i&&1!==c&&"popup"===o&&d:h,m=!t.isMobile&&!r&&n&&!i&&!S&&"section"!==o&&!k().b0(a),x=y?function(e){const{isSelected:t,onActionButtonClick:o}=e,n=t?Z.sprintIsSelectedPrimaryButtonAriaLabel:Z.sprintIsNotSelectedPrimaryButtonAriaLabel,i=t?(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.removePage.messageSprints",defaultMessage:"Remove this sprint"}):(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.addPage.messageSprints",defaultMessage:"Add this sprint"});return(0,W.jsx)(re,{ariaLabel:I().A.formatMessage(n),onClick:o,style:{borderRadius:3},icon:t?p().t:f().W,tooltipMessage:i})}({isSelected:d,onActionButtonClick:s}):void 0,v=m?function(e){const{rowType:t,isSelected:o,onClick:n}=e,i="section"===t&&o?Z.sprintIsSelectedSecondaryButtonAriaLabel:Z.sprintIsNotSelectedSecondaryButtonAriaLabel,r="section"===t&&o?(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPageInline.message",defaultMessage:"Insert new page"}):(0,W.jsx)(b().sA,{id:"database.relationMenuRow.tooltip.insertPage.messageSprints",defaultMessage:"Move to a different sprint"});return(0,W.jsx)(re,{ariaLabel:I().A.formatMessage(i),onClick:n,style:{borderRadius:0},icon:f().W,tooltipMessage:r})}({rowType:o,isSelected:d,onClick:g}):void 0,M=S&&void 0!==l?(0,W.jsx)(ge,{peekMode:u,showPrimaryButton:void 0!==x,showSecondaryButton:void 0!==v,onOpenPageButtonClick:l}):void 0;return(0,W.jsx)(pe,{primaryButton:x,secondaryButton:v,openPageButton:M})}({device:j,rowType:o,focused:n,disabled:i,locked:a,isSelected:d,onSecondaryButtonClick:c,onOpenPageButtonClick:u,onActionButtonClick:g,propertyLimit:S,peekMode:A,onClick:()=>null==c?void 0:c(P.current)});return(0,W.jsxs)(W.Fragment,{children:[t&&"popup"===o&&(0,W.jsx)(V().A,{iconSize:12,style:L.dragHandle}),j.isPhone?(0,W.jsx)(ne,{relatedPageStore:h,rowType:o,pageStore:m,canEditTitle:E,shouldShowOverflow:!0,noUnderline:!0,relationTokenBlockStoreRef:B,onInsertInline:x,onTitleEsc:v,index:M}):(0,W.jsx)(oe,{collectionStore:T,property:C,relatedPageStore:h,targetCollectionStore:R,blockPropertyValueOverlayStore:w,rowType:o,pageStore:m,index:M,onInsertInline:x,onTitleEsc:v,canEditTitle:E,shouldShowOverflow:!0,noUnderline:!0,disabled:i,relationTokenBlockStoreRef:B}),d&&"popup"===o&&(0,W.jsx)("div",{style:L.iconWrapper,children:(0,y().b)(L.icon)}),O]})}function te(e){const{rowContainer:t,disabled:o,locked:n,canDrag:i,rowType:a,targetCollectionStore:d,propertyLimit:c,hasMouseEntered:u,outerRef:p,handleMouseEnter:g,handleMouseLeave:S,onInsertInline:h}=e,y=(0,r().Y0)(),k=(0,s().IS)((e=>({menuItem:{display:"flex",alignItems:"center",width:`calc(100% + ${$}px)`,paddingLeft:$,position:"relative",left:-$},tooltip:{color:e.text.contrastSecondary},icon:{width:16,height:16,fill:e.icon.tertiary},iconHover:{borderRadius:4},iconButton:{marginLeft:i?-44:-22,position:"absolute",marginRight:4}})),[i]),m=(0,l().K8)((()=>d.canEdit()),[d]),x=!n&&!o&&"section"===a&&!y.isMobile&&!(1===c)&&m;return(0,W.jsxs)("div",{style:k.menuItem,onMouseEnter:g,onMouseLeave:S,ref:p,children:[u&&x&&(0,W.jsx)(G().A,{renderTooltip:()=>(0,W.jsx)(b().sA,{defaultMessage:"Click <medium>to insert a page below</medium>",id:"database.relationMenuRow.tooltip.floatingAddPageButton.message",values:{medium:e=>(0,W.jsx)("span",{style:k.tooltip,children:e})}}),render:e=>(0,W.jsx)(_().A,{hasBackground:!1,ariaLabel:I().A.formatMessage(Z.floatingInsertButtonAriaLabel),icon:f().W,iconStyle:k.icon,onClick:h,hoveredStyle:k.iconHover,style:k.iconButton,...e})}),t]})}function oe(e){const{relatedPageStore:t,targetCollectionStore:o,blockPropertyValueOverlayStore:i,rowType:a,pageStore:d,index:c,onInsertInline:u,onTitleEsc:p,canEditTitle:g,shouldShowOverflow:S,noUnderline:f,collectionStore:h,property:y,disabled:b,relationTokenBlockStoreRef:m}=e,v=(0,r().Y0)(),M=(0,l().K8)((()=>t.isReady()&&!t.canRead()),[t]),w=(0,l().K8)((()=>{const e=o.getSchema();return e?!h||M?[{property:"title",visible:!0}]:B().B7({collectionStore:h,property:y}).filter((t=>t.visible&&("title"===t.property||e[t.property]))):[]}),[o,h,M,y]),T=(0,l().K8)((()=>"section"!==a||(b||!t.canEdit()||v.isMobile)),[a,b,t,v.isMobile]),R=(0,s().IS)((e=>({wrapper:{display:"flex",marginRight:8,maxHeight:22,alignItems:"center",...x().RC}})),[]);if(k().Im(w))return null;const I=w.map((e=>"title"===e.property?(0,W.jsx)(n.Fragment,{children:(0,W.jsx)(ne,{relatedPageStore:t,rowType:a,pageStore:d,canEditTitle:g,shouldShowOverflow:S,noUnderline:f,relationTokenBlockStoreRef:m,onInsertInline:u,onTitleEsc:p,index:c})},"title"):(0,W.jsx)(O().q,{store:t,property:e.property,disabled:T,locked:!1,format:"section"===a?"relation_section":"relation",tableWrap:!1,blockPropertyValueOverlayStore:i??L().A,collectionStore:o},e.property)));return(0,W.jsx)("div",{style:R.wrapper,children:I})}function ne(e){const{relatedPageStore:t,rowType:o,pageStore:n,canEditTitle:i,shouldShowOverflow:a,noUnderline:l,relationTokenBlockStoreRef:d,onInsertInline:c,onTitleEsc:p,index:g}=e,S=(0,r().Y0)(),f=(0,s().IS)((e=>({wrapper:{display:"flex",alignItems:"center",flex:"0 1 auto",minHeight:0,...!a&&{minWidth:40},paddingLeft:"section"===o?4:6},relationToken:{display:"flex",alignItems:"center",margin:0,whiteSpace:"nowrap",marginRight:"section"===o?0:S.isTablet?8:0,minWidth:0},title:{...x().RC,maxWidth:"100%"}})),[o,a,S.isTablet]);return(0,W.jsx)("div",{style:f.wrapper,children:(0,W.jsx)(Q().A,{ref:d,format:u().NY.Inline,blockId:t.id,isSingle:!0,parentStore:n,noUnderline:l,style:f.relationToken,titleStyle:f.title,clickTitleBehavior:i?"edit":void 0,onTitleEnter:c,onTitleEsc:p,index:g},t.id)})}function ie(e){const{innerRelationMenuRow:t,handleButtonClick:o,canDrag:n,rowType:a,focused:l,disabled:d,limitReached:c,propertyLimit:u,hasMouseEntered:p,sectionOnClick:g,outerRef:f,onSecondaryButtonClick:h,onMouseEnter:y,onMouseLeave:k}=e,m=(0,r().v3)(),x=(0,s().IS)((e=>({container:{display:"flex",alignItems:"center",width:"100%"},tooltip:{color:e.text.contrastSecondary},icon:{width:14,height:14,fill:e.icon.tertiary},iconHover:{borderRadius:4},iconButton:{cursor:"grab",width:D().Z+4,marginLeft:-(D().Z+4),height:24,borderRadius:4},row:de(a,e,l,c,u)})),[a,l,c,u]);return(0,W.jsxs)("div",{style:x.container,ref:f,children:["section"===a&&p&&n&&(0,W.jsx)(G().A,{renderTooltip:()=>(0,W.jsx)(b().sA,{defaultMessage:"Drag <medium>to move</medium>",id:"database.relationMenuRow..dragPrompt.text",values:{medium:e=>(0,W.jsx)("span",{style:x.tooltip,children:e})}}),render:e=>(0,W.jsx)(_().A,{hasBackground:!1,ariaLabel:I().A.formatMessage(Z.dragRowHandleAriaLabel),icon:S().i,iconStyle:x.icon,hoveredStyle:x.iconHover,style:x.iconButton,...e})}),"section"===a?(0,W.jsx)("div",{style:x.row,onContextMenu:e=>ce(e,m),onMouseEnter:y,onMouseLeave:k,onClick:g,role:"button","aria-label":"Editable title","aria-disabled":d,tabIndex:d?-1:0,children:t}):(0,W.jsx)(G().A,{disableTooltip:!(c&&u&&u>1),renderTooltip:()=>(0,W.jsx)(b().sA,{defaultMessage:"To select more, remove selection above",id:"database.relationMenuRow.limitReached"}),render:e=>(0,W.jsx)("div",{style:x.row,onContextMenu:e=>ce(e,m),onMouseEnter:y,onMouseLeave:k,role:"button",tabIndex:d?-1:0,"aria-disabled":d,onClick:e=>{(0,i().SQ)({event:e,context:i().y$.Click,callback:()=>{(0,C().Vt)(e)||(h?h(f.current):o(e))}})},...e,children:t})})]})}function re(e){const{caption:t,onClick:o,style:n,icon:i,tooltipMessage:r,ariaLabel:a}=e;return(0,W.jsx)(G().A,{renderTooltip:()=>r,disableTooltip:(0,m().uy)(r),render:e=>(0,W.jsx)(_().A,{hasBackground:!1,ariaLabel:a,icon:i,onClick:o,caption:t,hoveredStyle:{borderRadius:4},style:{height:20,width:20,flex:"0 0 auto",...n},...e})})}function ae(e){let{onActionButtonClick:t}=e;return(0,W.jsx)(K().A,{onClick:t,style:{padding:12,marginRight:-12},children:(0,g().u)({width:20,height:20})})}function le(e){const{rowType:t,relatedPageStore:o,pageStore:i,onInsertInline:r,onTitleEsc:a,index:l,disabled:d,isSelected:c,...u}=e,p=n.useRef(null),g=(0,s().IS)((e=>({container:{display:"flex",alignItems:"center"},iconWrapper:{display:"flex",alignItems:"center",marginLeft:"auto",height:24,padding:0},titleWrapper:{flex:1,overflow:"hidden",paddingRight:16},membersIcon:{width:16,height:16,fill:e.icon.secondary,display:"inline-flex",alignItems:"center",justifyContent:"center"}})),[]),S=!d&&c,f=!d&&!c;return(0,W.jsx)(Y().Ay,{...u,title:(0,W.jsxs)("div",{style:g.container,children:[(0,W.jsx)("div",{style:g.titleWrapper,children:(0,W.jsx)(ne,{relatedPageStore:o,rowType:t,pageStore:i,canEditTitle:!1,shouldShowOverflow:!0,noUnderline:!0,relationTokenBlockStoreRef:p,onInsertInline:r,onTitleEsc:a,index:l})}),S&&(0,W.jsx)(ae,{onActionButtonClick:t=>{e.onActionButtonClick(t),t.stopPropagation()}}),f&&(0,W.jsx)("div",{style:g.iconWrapper,children:(0,h().Q)(g.membersIcon)})]})})}function se(e){const t=!e.disabled&&e.isSelected;return(0,W.jsx)(F().A,{...e,store:e.relatedPageStore,hidePath:!0,right:t?(0,W.jsx)(ae,{onActionButtonClick:e.onActionButtonClick}):void 0})}function de(e,t,o,n,i){const r=n&&i&&i>1;return{...x().RC,display:"flex",alignItems:"center",position:"relative",borderRadius:4,width:"100%",height:B().d0,paddingTop:2,paddingRight:4,paddingBottom:2,paddingLeft:"popup"!==e?2:0,fontSize:H().Mi,margin:"popup"===e?"0px 4px":0,cursor:r?"default":"pointer",background:o&&!r?t.buttonHoveredBackground:void 0,userSelect:"none",opacity:r?.4:1}}function ce(e,t){const{device:o}=t;o.isAndroid&&o.isPhone&&e.preventDefault()}const ue={position:"absolute",top:4,display:"inline-flex",flexShrink:0,borderRadius:4,overflow:"hidden",padding:2,gap:1};function pe(e){const{primaryButton:t,secondaryButton:o,openPageButton:n}=e,i=(0,s().IS)((e=>({relationButtonWrapperStyle:{right:6,background:e.popoverBackground,boxShadow:e.shadowSM,...ue}})),[]);return(0,W.jsxs)(W.Fragment,{children:[(t||o)&&(0,W.jsxs)("div",{style:i.relationButtonWrapperStyle,children:[t,o]}),n]})}function ge(e){const t=(0,s().IS)((t=>({relationButtonWrapperStyle:{position:"absolute",right:e.showPrimaryButton||e.showSecondaryButton?36:6,background:t.popoverBackground,boxShadow:t.shadowSM,...ue}})),[e.showPrimaryButton,e.showSecondaryButton]);return(0,W.jsx)("div",{style:t.relationButtonWrapperStyle,children:(0,W.jsx)(N,{...e})})}function Se(e,t,o,n,r,a,l,s,c){(0,i().SQ)({event:e,context:i().y$.Click,callback:()=>{if(!(0,C().Vt)(e))if(r||s){if(!a.canRead())return;const i=R().Vr(e),r=o===n.id?E().default.state.resultsStore:void 0,l=o===n.id?E().default.state.collectionContextStore:void 0;M().VU({environment:t,store:a,peekMode:c,openInNew:i,resultsStore:r,collectionContextStore:l,pageVisitSource:d().y8.PeekOpen}),(0,v()._)(t,{from:"relation_section",meta_click:Boolean(i)})}else l(e)}})}},279620:(e,t,o)=>{o.d(t,{Y:()=>a});var n=o(296540),i=()=>o(16006),r=o(474848);function a(e){const{blockStore:t,shouldWrap:o,titleStyle:a,recordTitleRef:l,noUnderline:s,disableTooltip:d}=e,c=(0,n.useRef)({getNode:()=>l.current});return(0,r.jsx)(i().A,{store:t,underline:!s,shouldWrap:o,style:a,ref:c,enableHover:!0,showTooltipWhenTruncated:!0,disableTooltip:d})}},413267:(e,t,o)=>{o.d(t,{b:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("thinCheck",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},566081:(e,t,o)=>{o.d(t,{A:()=>E});var n=o(296540),i=()=>o(56366),r=()=>o(728611),a=()=>o(908006),l=()=>o(725614),s=()=>o(685889),d=()=>o(704152),c=()=>o(16006),u=o(474848);function p(e){const{blockStore:t,titleStyle:o,shouldWrap:i,recordTitleRef:r,disableTooltip:p}=e,g=(0,n.useRef)({getNode:()=>r.current}),S=(0,n.useCallback)((e=>{a().default.afterNextFlush((()=>{const e=t.getBlockTitleStore();if(!e)return;const o=e.getValue(),n=o?o[0][0].length:0,i={start:{index:n,store:e},end:{index:n,store:e}};l().setMultiSelection({multiSelection:i})}))}),[t]);return(0,u.jsx)(d().A,{style:{height:s().d0+2,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:5,padding:"6px 8px 7px 8px",overflow:"hidden"},onClick:S,children:(0,u.jsx)(c().A,{store:t,underline:!0,shouldWrap:i,style:o,ref:g,disableTooltip:p})})}var g=()=>o(959013),S=()=>o(496603),f=()=>o(792540),h=()=>o(972435),y=()=>o(524702);const b=(0,g().YK)({typeTitle:{defaultMessage:"Type a title...",id:"relationToken.title.placeholder"}});function k(e){const{blockStore:t,clickTitleBehavior:o,onTitleEnter:n,onTitleEsc:r}=e,a="edit"===o,l=(0,i().K8)((()=>t.getBlockTitleStore()),[t]);return(0,u.jsx)(y().A,{store:l,disabled:!a,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,onEnter:n,onEsc:r,onTab:S().D_,placeholder:h().A.formatMessage(b.typeTitle),style:{padding:"6px 8px 7px 8px",textOverflow:"none",overflow:"visible",whiteSpace:"pre"},disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:f().Os.none})}var m=()=>o(484714),x=()=>o(919709),v=()=>o(319975);const M=function(e){const{store:t,style:a,disableLinks:l,disableHover:s,isAndroid:d,externalIntegrations:c,canEdit:p,shouldWrap:S,tokenFormat:f}=e,h=(0,n.useRef)(null),y=(0,g().tz)(),b=(0,m().v3)(),k=(0,o(401497).DP)(),{isExternalIntegrationPageType:M,blockType:w,blockId:T,blockModel:R}=(0,i().K8)((()=>{const e=t.getModel();return{isExternalIntegrationPageType:Boolean(null==e?void 0:e.isType(o(700500).xd.externalObjectInstancePage)),blockType:t.getType(),blockId:t.id,blockModel:e}}),[t]),I=(0,i().K8)((()=>o(267419).A.getState()),[]),C=(0,n.useCallback)((()=>{if(!h||!h.current)return;const e=(0,x().bMp)(t.id),o=(0,x().wmz)(e);return{textValue:[o],tokenIndex:0,textToken:o,node:h.current}}),[h,t.id]),B=(0,n.useCallback)((e=>{if(s)return;const o=C(),n=t.getTitleStore();n&&o&&v().xE({environment:b,event:e,interactiveToken:o,store:n,canEdit:p})}),[s,C,t,b,p]),P=(0,n.useCallback)((e=>{const o=C(),n=t.getTitleStore();n&&o&&!s&&v().HH({environment:b,event:e,interactiveToken:o,store:n,canEdit:p})}),[C,t,s,b,p]),A=t.getRecordModel,j=T,L=(0,o(712030).FN)(b),E=o(780054).A.domainBaseUrl,O=b.currentUser.id,W=!l,z=(0,i().K8)((()=>{if(R)return(0,o(191772).gA)({blockModel:R,shouldWrap:S,index:0,style:a,disableHover:s,disableLinks:l,isAndroid:d,theme:k,getRecordModel:A,currentUserId:O,baseUrl:E,emojiType:L,externalIntegrations:c,classNames:[],intl:y,emojiData:I,stopLinkPropagation:W,tokenFormat:(0,o(425497).Ug)(f)})}),[R,S,a,s,l,d,k,A,O,E,L,c,y,I,W,f]);return j?"external_object_instance_page"!==w?null:M?(0,u.jsx)("span",{ref:h,onMouseOver:B,onMouseOut:P,onClick:W?r().kV:void 0,style:{width:"100%"},children:z}):null:null};function w(e){const{blockStore:t,shouldWrap:n,style:r,disableLinks:a,format:l}=e,s=(0,i().K8)((()=>(0,o(939768).q7)(t.getSyncedUri())),[t]),d=(0,i().O$)(o(53137).A.integrations),c=(0,m().v3)();return(0,u.jsx)(M,{shouldWrap:n,store:t,style:r,disableHover:a||!s,disableLinks:a||!s,isAndroid:c.device.isAndroid,externalIntegrations:d,canEdit:!0,tokenFormat:l})}var T=()=>o(738865);function R(e){const{format:t,showRemoveButton:n,onClickRemove:i}=e,{height:r,closeIconSize:a}=T().U[t];return n?(0,u.jsx)(d().A,{onClick:i,style:{display:"flex",alignItems:"center",justifyContent:"center",width:r,height:r,marginLeft:2,marginRight:2,flexGrow:0,flexShrink:0,borderRadius:4},children:(0,o(65767).l)({width:a,height:a,opacity:.5})}):null}var I=()=>o(584262),C=()=>o(519839),B=()=>o(175116),P=()=>o(492414),A=()=>o(765957);var j=()=>o(231722),L=()=>o(24157);const E=(0,n.forwardRef)((function(e,t){const{parentStore:r,blockId:a,shouldWrap:l,format:s,showRemoveButton:d,clickTitleBehavior:c,onClickRemove:p,titleStyle:g,onTitleEnter:S,onTitleEsc:f,index:h,noUnderline:y,disableTooltip:b,disableLinks:k}=e,m=o(630116).Bv.createChildStore(r,{table:o(179034).ev,id:a}),{style:x}=(0,T().t)(e),v=(0,n.useRef)(null),M=(0,n.useRef)(null),I="peek"===c;(0,n.useImperativeHandle)(t,(()=>m),[m]);const C=(0,i().K8)((()=>"external_object_instance_page"===m.getType()),[m]);if((0,o(571468).W)(m))return null;if(C)return(0,u.jsx)(w,{shouldWrap:l,blockStore:m,style:x,disableLinks:k,format:s});const B=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(o(124954).w,{format:s,blockStore:m,clickTitleBehavior:c,shouldWrap:l}),(0,u.jsx)(W,{blockStore:m,recordTitleRef:v,clickTitleBehavior:c,shouldWrap:l,titleStyle:g,noUnderline:y,onTitleEnter:S,onTitleEsc:f,index:h,disableTooltip:b})]});return(0,u.jsxs)("div",{style:x,ref:M,children:[I?(0,u.jsx)(O,{blockStore:m,relationTokenStyle:x,children:B}):B,(0,u.jsx)(R,{showRemoveButton:d,onClickRemove:p,format:s})]})}));function O(e){let{blockStore:t,relationTokenStyle:a,children:l}=e;const{blockUrlPage:s,blockUrlPeek:d}=function(e){const t=(0,m().v3)(),o=(0,B().Ks)(),n=(0,i().K8)((()=>(0,P().Ay)({store:e,fullyQualified:!1,pageVisitSource:I().y8.LinkInPage})),[e]);return{blockUrlPeek:(0,i().K8)((()=>{const{mainEditorCurrentBlockStore:n}=A().default.state;return C().wy({environment:t,store:e,mainEditorCurrentBlockStore:n,collectionContextStore:o,fullyQualified:!1})}),[t,e,o]),blockUrlPage:n}}(t),c=(0,n.useMemo)((()=>({display:a.display,height:a.height,alignItems:a.alignItems})),[a]);return(0,u.jsx)(o(187485).A,{href:s,metaHref:d,onClick:r().kV,style:c,children:l})}function W(e){const{blockStore:t,clickTitleBehavior:n,onTitleEnter:r,onTitleEsc:a,index:l,recordTitleRef:s,titleStyle:d,shouldWrap:c,noUnderline:g,disableTooltip:S}=e,f=(0,o(551619).Sm)(t),h="edit"===n&&!f,y=function(e){return(0,i().K8)((()=>{var t;const o=L().default.state;return"editing"===o.mode&&(null===(t=(0,j().H7)(o.multiSelection))||void 0===t?void 0:t.store)===e.getBlockTitleStore()}),[e])}(t);return h?y&&r&&l?(0,u.jsx)(k,{blockStore:t,clickTitleBehavior:n,onTitleEnter:r,onTitleEsc:a}):(0,u.jsx)(p,{blockStore:t,recordTitleRef:s,titleStyle:d,shouldWrap:c,disableTooltip:S}):(0,u.jsx)(o(279620).Y,{blockStore:t,recordTitleRef:s,titleStyle:d,shouldWrap:c,noUnderline:g,disableTooltip:S})}},738865:(e,t,o)=>{o.d(t,{U:()=>l,t:()=>s});var n=()=>o(401497),i=()=>o(784892),r=()=>o(284371),a=()=>o(685889);const l={[i().NY.ExtremeSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[i().NY.ExtraSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[i().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",recordIconMarginRight:3,pageIconSize:16,closeIconSize:8},[i().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Medium]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Inline]:{height:20,fontSize:14,margin:"0 12px 0 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",recordIconMarginRight:4,pageIconSize:24,closeIconSize:10}};function s(e){let{format:t,shouldShrink:o,shouldWrap:s,isSingle:c,style:u,clickTitleBehavior:p}=e;const g="edit"===p;return(0,n().IS)((()=>{const{fontSize:e,margin:n}=l[t],p=g?a().d0:l[t].height;return{style:{...s?{display:"inline",lineHeight:1.5,borderRadius:4}:d({height:p}),fontSize:e,fontWeight:r().Wy.medium,minWidth:o?0:"auto",margin:c?0:n,...t===i().NY.Inline&&{overflow:"hidden"},...u}}}),[t,o,s,c,g,u])}function d(e){let{height:t}=e;return{display:"flex",alignItems:"center",lineHeight:1.2,height:t}}}}]);