"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[68540],{71506:(e,t,n)=>{n.r(t),n.d(t,{TranscriptionBlockAnnotation:()=>p});n(296540);var i=()=>n(56366),o=()=>n(47170),s=()=>n(249847),r=()=>n(329304),a=()=>n(891360),l=()=>n(396209),c=()=>n(353890),d=()=>n(910493),u=n(474848);function p(e){const{blockRef:t}=e,{store:n,isInTemplate:p}=(0,c().s)(),g=(0,o().O)(),m=(0,s().T)(),f=(0,r()._X)({name:"ai_meeting_notes",spaceId:g??"",userId:m??"",amount:1}),h=(0,i().K8)((()=>{var e;if("rateLimited"===(null===(e=a().W.state)||void 0===e?void 0:e.type))return{retryAfterSec:a().W.state.retryAfterSec}}),[]),k=(0,l().Uz)({featureAvailability:f,location:"footer"});return!k||p?null:(0,u.jsx)(d().w,{children:k.render({blockId:n.id,blockRef:t,featureAvailability:f,isRateLimited:h})})}},124749:(e,t,n)=>{n.d(t,{$:()=>s});var i=()=>n(56366);const o=new(n(496506).ComputedStore)((()=>n(765957).default.state.currentUserStore),{debugName:"AppStoreCurrentUserStore"});function s(){return(0,i().O$)(o)}},179101:(e,t,n)=>{n.r(t),n.d(t,{TranscriptionBlockControls:()=>P});var i=n(296540),o=()=>n(484714),s=()=>n(56366),r=()=>n(401497),a=()=>n(735790),l=()=>n(959013),c=()=>n(2220),d=()=>n(406699),u=()=>n(285790),p=()=>n(897119),g=()=>n(477293),m=()=>n(962730),f=()=>n(227440),h=()=>n(964345),k=()=>n(353890);function v(){const{store:e}=(0,k().s)();return(0,s().K8)((()=>h().gZ.state&&h().Di.state===e.id),[e])}var S=()=>n(534177),b=()=>n(124749);var A=()=>n(210667),x=()=>n(748197),y=()=>n(405689),I=()=>n(645873);const C=new(I().O2)("TranscriptionBlockSettingsMenu",(async()=>n.e(46726).then(n.bind(n,746523)))),B=(0,I()._h)(C,(e=>e.TranscriptionBlockSettingsMenu));var _=()=>n(529099),j=()=>n(761777),w=()=>n(501305),O=()=>n(859428),T=()=>n(765957),z=()=>n(430483),M=()=>n(295169),K=n(474848);const R=(0,l().YK)({askAiButton:{defaultMessage:"Ask AI",id:"transcriptionBlock.askAiButton"}});function W(){const e=(0,l().tz)(),t=(0,o().Y0)(),n=(0,o().v3)(),a=(0,s().O$)(T().AppStoreMainEditorCurrentBlockStore),c=(0,s().K8)((()=>z().zD.shouldShowAssistantInCorner(t)),[t]),d=(0,r().IS)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",borderRadius:6},icon:{width:20,height:20}})),[]),p=(0,i.useCallback)((async()=>{if(!a)return;const{sessionId:e}=await(0,j().resetAndInitializeAssistantSession)({environment:n,sessionId:void 0,completionContext:void 0,makeActiveSession:!0}),t=M().default.getSessionContext(e);null==t||t.assistantConfigurationStore.setSearchScope({type:"page",pageId:a.id}),M().default.setActiveSessionId(e),(0,w().openAssistantRightHandSideMenu)({environment:n,from:"transcription_block"})}),[n,a]);return a&&c?(0,K.jsx)(O().A,{render:t=>(0,K.jsx)(u().A,{...t,style:d.container,icon:_().aiFaceIcon,iconStyle:d.icon,size:"lg",onClick:p,ariaLabel:e.formatMessage(R.askAiButton)}),renderTooltip:()=>(0,K.jsx)(l().sA,{...R.askAiButton})}):null}var $=()=>n(15570);const F=(0,l().YK)({moreOptions:{defaultMessage:"Options",id:"transcriptionBlock.options"}});function P(){const{store:e,state:t,isEnabled:n,isInTemplate:I}=(0,k().s)(),C=t.state,_=(0,l().tz)(),j=(0,o().Y0)(),w=(0,o().v3)(),O=(0,s().O$)(f().e),T=(0,s().K8)((()=>e.id),[e]),z=(0,s().K8)((()=>x().c.isSettingsOpenForBlockId(T)),[T]),M=v(),R=function(){const{state:e}=(0,k().s)(),t=v(),n=(0,s().O$)(h().gZ),i=(0,s().K8)((()=>h().Ay.state.loading),[]),o=(0,b().$)();return"transcribing"===e.state&&i&&(null==o?void 0:o.id)===e.transcriber_id?n:!!t||"idle"!==e.state&&"summarizing"!==e.state&&("transcribing"===e.state||"paused"===e.state||"initial"!==e.state&&(0,S().HB)(e))}(),P=(0,i.useMemo)((()=>!j.isPhone&&O&&!I&&n&&"initial"!==C&&"summarizing"!==C),[j.isPhone,O,I,n,C]),L=(0,r().IS)((()=>({buttonsContainer:{display:"flex",gap:4,flexShrink:0},audioVisualizerContainer:{flex:1,minWidth:0,display:"flex"},spacer:{flex:1,minWidth:0},moreIconButton:{width:30,height:32}})),[]),Y="allow_browser"===(0,g().r)("ai_meeting_notes_allow_browser"),E=(0,A().h)()||Y;return(0,K.jsxs)(K.Fragment,{children:[R?(0,K.jsx)("div",{style:L.audioVisualizerContainer,children:(0,K.jsx)(y().t,{fakeSoundwave:!M&&"transcribing"===C,fillWidth:!0,forceRender:"paused"===C||!E,rootBlockId:e.id})}):(0,K.jsx)("div",{style:L.spacer}),(0,K.jsxs)("div",{style:L.buttonsContainer,children:[P&&(0,K.jsx)(W,{}),"idle"!==C&&(0,K.jsx)($().t,{}),E?(0,K.jsx)(d().Ay,{renderOrigin:e=>(0,K.jsx)(u().A,{icon:a().M,iconStyle:{width:20,height:20},style:L.moreIconButton,ariaLabel:_.formatMessage(F.moreOptions),...e}),render:e=>(0,K.jsx)(B,{onClose:e.close}),popupType:j.isPhone?p().nl.BottomSheet:p().nl.Popup,placementToOrigin:m().W.Bottom,alignmentToOrigin:m().C.End,open:z,onClick:()=>{x().c.setSettingsOpenForBlockId(e.id),(0,c().u)({environment:w,event:{eventName:"transcription_settings_menu_opened",eventProperties:{block_id:e.id}}})},onClose:()=>{x().c.setSettingsOpenForBlockId(void 0)}}):null]})]})}}}]);