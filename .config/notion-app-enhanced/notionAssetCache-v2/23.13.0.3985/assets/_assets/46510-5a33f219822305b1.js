"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[46510],{113474:(e,t,n)=>{n.d(t,{_:()=>d});n(296540);var o=()=>n(484714),r=()=>n(401497),i=()=>n(668725),a=()=>n(704152),c=()=>n(678553),l=()=>n(125565),u=n(474848);function d(e){const t=(0,r().DP)(),n=(0,o().v3)(),{device:d}=n;return(0,u.jsx)(a().A,{onClick:e.onClick,hovered:e.focused,disabled:e.disabled,style:{width:"100%",...!d.isMobile&&{borderRadius:6},...e.buttonStyle},hoveredStyle:e.hoveredButtonStyle,pressedStyle:e.pressedButtonStyle,children:(0,u.jsx)(c().Ay,{...e,dontShrinkTitle:!0,right:(0,u.jsxs)("div",{style:{display:"flex",whiteSpace:"nowrap"},children:[e.right&&(0,u.jsx)(l().A,{isSecondaryColor:!0,isMobile:d.isMobile,children:e.right}),!d.isMobile&&(0,u.jsx)("div",{style:{flexShrink:0},children:(0,i().b)({width:10,marginLeft:4,fill:t.icon.tertiary,transform:"right"===e.chevronType?"rotate(-90deg)":void 0,transition:"transform 0.2s ease"})})]})})})}},422540:(e,t,n)=>{n.d(t,{$0:()=>h,Fx:()=>C,Ge:()=>m,I3:()=>s,Kj:()=>x,PP:()=>T,TK:()=>k,Yy:()=>d,aE:()=>M,cQ:()=>S,kH:()=>y,m7:()=>p,nq:()=>b,nv:()=>v,tj:()=>f});n(898992),n(354520),n(737550);var o=()=>n(496603),r=()=>n(534177),i=()=>n(970013),a=()=>n(651124),c=()=>n(349835),l=()=>n(390066);const u={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1},d={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function s(e){return Boolean(u[e.type]&&!(0,i().UU)(e)&&(!(0,i().$M)(e)||void 0===(0,i().om)(e)))}function p(e){const{collectionFormat:t,collectionSchema:n,filter:c,sort:u,sourcePropertyIds:d}=e,p=(d??(0,r().uv)(n)).filter(((t,o,r)=>{const a=n[t];return!(!a||!s(a))&&(("relation"!==a.type||!e.restrictCrossSpace||!(0,i().o2)(e.spaceId,a))&&(!c||c([t,a],o,n)))}));if(0===p.length)return[];if(!t||!1===u)return p;const m=(0,l().L)(t,n,void 0,a().jf.Page).collection_page_properties||[];return o().Ul(p,(e=>m.findIndex((t=>t.property===e))))}function m(e){const{collectionFormat:t,collectionSchema:n,sort:c}=e,u=(0,r().uv)(n).filter(((e,t,o)=>{const r=n[e];return!(!r||!(0,i().JY)(r))}));if(0===u.length)return[];if(!t||!1===c)return u;const d=(0,l().L)(t,n,void 0,a().jf.Page).collection_page_properties||[];return o().Ul(u,(e=>d.findIndex((t=>t.property===e))))}function y(e){return e.type===c().M9.InvalidCharacter?{type:e.type,character:e.character}:e.type===c().M9.TokenExpected?{type:e.type,token:e.token}:e.type===c().uW.MissingSchemaPropertyOnThisRow||e.type===c().uW.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===c().uW.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===c().uW.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===c().uW.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===c().uW.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===c().uW.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===c().uW.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer,node:e.node}:e.type===c().uW.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===c().uW.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===c().uW.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===c().uW.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===c().uW.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===c().uW.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const f={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,place:!1};function h(e){return Boolean(f[e.type])}function v(e){const{collectionFormat:t,collectionSchema:n,filter:c,sort:u}=e,d=(0,r().uv)(n).filter(((e,t,o)=>{var r;const a=n[e];return!(!a||!f[a.type])&&((!(0,i().$M)(a)||null===(r=(0,i().om)(a))||void 0===r||!r.auto_update_on_edit)&&(!c||c([e,a],t,n)))}));if(0===d.length)return[];if(!t||!1===u)return d;const s=(0,l().L)(t,n,void 0,a().jf.Page).collection_page_properties||[];return o().Ul(d,(e=>s.findIndex((t=>t.property===e))))}const g={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1};function b(e){return g[e.type]}const _={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1};function x(e){return _[e.type]}function S(e){return 0===e}function C(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function T(e){const{property:t,collectionSchema:n}=e;return!!n&&!n[t]}function k(e){const{collectionSchema:t,property:n,type:o}=e,r=null==t?void 0:t[n];return!r||("action"===o?!s(r):!f[r.type])}function M(e){let{automationTrigger:t,collectionSchema:n}=e;if("event"===(null==t?void 0:t.type)){const{pagesAdded:e,pagePropertiesEdited:o,source:i,relativeDate:a}=t.event;if(void 0===i)return!1;const c="some"===o.type&&o.some,l="all"===o.type&&o.all;if((c||l||[]).some((e=>T({collectionSchema:n,property:e.property})||k({collectionSchema:n,property:e.property,type:"trigger"}))))return!1;const u="some"===o.type&&(!(0,r().O9)(o.some)||0===o.some.length),d="all"===o.type&&(!(0,r().O9)(o.all)||0===o.all.length);if(!e&&("none"===o.type||u||d)&&!a)return!1}else{if("recurrence"!==(null==t?void 0:t.type))return!1;if(!t.recurrence)return!1}return!0}},541181:(e,t,n)=>{n.d(t,{n:()=>i});var o=()=>n(645873);const r=new(o().O2)("react-day-picker",(async()=>await Promise.all([n.e(95555),n.e(41986),n.e(68548)]).then(n.bind(n,762290)))),i=(0,o()._h)(r,(e=>e.default))},546461:(e,t,n)=>{n.d(t,{EC:()=>C,To:()=>S,YC:()=>T,or:()=>x,u:()=>_});n(16280);var o=n(296540),r=()=>n(484714),i=()=>n(792485),a=()=>n(56366),c=()=>n(496506),l=()=>n(322867),u=()=>n(959013),d=()=>n(534177),s=()=>n(813297),p=()=>n(862292),m=()=>n(698331),y=()=>n(645873),f=()=>n(190019),h=()=>n(76190),v=n(474848);const g=new WeakMap,b=(0,o.createContext)({automationStore:void 0,contextType:void 0,defined:!1,typecheckResult:void 0});b.displayName="AutomationContext";function _(e){const{automationStore:t,children:n,contextType:o}=e,_=(0,r().v3)(),x=(0,u().tz)(),{value:S}=(0,y().fJ)(p().T.formulas),{value:C}=(0,y().fJ)(s().QV.automationTypecheck),T=(0,h().n)(t),k=(0,i().S)(),M=(0,a().K8)((()=>{if(!S)return{error:new(l().N9)("Missing formulas dependency")};if(!C)return{error:new(l().N9)("Missing automation dependency")};const e=function(e){const{environment:t,automationStore:n,automationTypecheckModule:o,contextType:r,formulasModule:i,intl:a,isSubscribed:l,pageStore:u}=e,s=g.get(n);if(s)return s;{const e=new(c().ComputedStore)((()=>{const e=n.getTriggerType();let c=r;return(0,d().O9)(e)&&(0,m().x2)(e)&&(c=(0,m().H8)(e)),(0,f().Z)({environment:t,automationStore:n,automationTypecheckModule:o,contextType:c,formulasModule:i,intl:a,isSubscribed:l,pageStore:u})}),{debugName:"automationContextTypecheckResultCachedStore"});return g.set(n,e),e}}({environment:_,automationStore:t,automationTypecheckModule:C,contextType:o,formulasModule:S,intl:x,isSubscribed:T,pageStore:"button_block"===o?null==k?void 0:k.pageStore:void 0});return e.state}),[_,t,C,o,S,x,T,null==k?void 0:k.pageStore]);return(0,v.jsx)(b.Provider,{value:{automationStore:t,typecheckResult:M,contextType:o,defined:!0},children:n})}function x(e){const{automationStore:t,children:n}=e,o=(0,a().K8)((()=>{var e;return null===(e=t.getTrigger())||void 0===e?void 0:e.type}),[t]);return(0,v.jsx)(_,{automationStore:t,contextType:(0,m().H8)(o??"event"),children:n})}function S(e){var t;return null===(t=g.get(e))||void 0===t?void 0:t.state}function C(){const e=o.useContext(b);if(!1===e.defined)throw new Error("No automation context found!");return e}function T(){return o.useContext(b)}},573351:(e,t,n)=>{n.d(t,{A:()=>i});var o=n(296540),r=n(474848);const i=function(e){let{firstDayOfWeek:t,value:i,selectValue:a=!0,onChange:c,onFocus:l,onBlur:u,disabledDays:d,className:s}=e;const p=(0,o.useMemo)((()=>new Date(i)),[i]),[m,y]=(0,o.useState)(p),f=(0,o.useRef)(i);(0,o.useLayoutEffect)((()=>{f.current!==i&&(y(new Date(i)),f.current=i)}),[i]);const h=(0,o.useCallback)(((e,t,n)=>{c(e.getTime())}),[c]);return(0,r.jsx)("div",{style:{paddingRight:8,paddingBottom:8,paddingLeft:8,paddingTop:4},children:(0,r.jsx)(n(541181).n,{locale:n(662303).locale,className:s??"notion-calendar-picker",numberOfMonths:1,weekStartsOn:t,modifiers:a?{value:p}:{},showOutsideDays:!0,fixedWeeks:!0,onDayClick:h,onMonthSelected:y,disabled:d,month:m,onDayBlur:u,onDayFocus:l})})}},698331:(e,t,n)=>{n.d(t,{$X:()=>i,H8:()=>a,x2:()=>r});var o=()=>n(534177);function r(e){return"event"===e||"recurrence"===e}function i(e){const t=e.getTrigger();return(0,o().O9)(t)&&r(t.type)}function a(e){return"event"===e?"event":"recurrence"===e?"recurrence":void(0,o().HB)(e)}},781697:(e,t,n)=>{n.d(t,{e:()=>c,v:()=>a});var o=()=>n(484714),r=()=>n(56366),i=()=>n(722872);function a(e){return e.device.isPhone||"actionSheet"===e.tabletBehavior&&e.device.isTablet?{menuType:i().gu.ActionSheet}:{menuType:i().gu.Popup,maxHeight:e.maxHeight,maxWidth:e.maxWidth,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,width:e.width,minWidth:e.minWidth}}function c(e){const t=(0,o().Y0)();return(0,r().K8)((()=>a({device:t,maxHeight:null==e?void 0:e.maxHeight,maxWidth:null==e?void 0:e.maxWidth,paddingTop:null==e?void 0:e.paddingTop,paddingBottom:null==e?void 0:e.paddingBottom,width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,tabletBehavior:null==e?void 0:e.tabletBehavior})),[t,null==e?void 0:e.maxHeight,null==e?void 0:e.maxWidth,null==e?void 0:e.paddingTop,null==e?void 0:e.paddingBottom,null==e?void 0:e.width,null==e?void 0:e.minWidth,null==e?void 0:e.tabletBehavior])}},839916:(e,t,n)=>{n.r(t),n.d(t,{addRecurrence:()=>x,confirmDiscardRecurrenceChangesOnNavigation:()=>I,createRecurrenceInner:()=>C,deleteRecurrence:()=>S});var o=()=>n(390527),r=()=>n(236262),i=()=>n(340498),a=()=>n(206267),c=()=>n(912720),l=()=>n(199378),u=()=>n(519831),d=()=>n(534177),s=()=>n(901389),p=()=>n(896628),m=()=>n(246826),y=()=>n(751156),f=()=>n(679924),h=()=>n(594794),v=()=>n(972435),g=()=>n(765957),b=()=>n(630116),_=()=>n(324587);function x(e){let{environment:t,blockStore:n,recurrence:r}=e;const i=n.getAutomationId(),a=(0,o().convertFromUnpersistedRecurrenceConfig)(r);i?function(e,t,n,o){const r=n.getParentStore();if(!r||r.table!==u().Vl)return;const i=n.getSpaceId(),a={table:c().yB,id:t,spaceId:i},d=b().dn.createChildStore(n,a),s=d.getTrigger();if(!s)return;const p=d.getActionStores()[0];y().createAndCommit({environment:e,userAction:"recurrenceActions.updateRecurrence",canUndo:!0,perform:t=>{const a=T({automationId:d.id,spaceId:i,collectionPointer:r.getSpaceShardedPointer(),templatePageId:n.id});let c;p?(c=p.id,m().zv({store:p,data:a,transaction:t})):(c=(0,h().Z1)({environment:e,table:l().SC,spaceId:i}),m().eC({environment:e,table:l().SC,inMemoryRecordCache:d.inMemoryRecordCache,transaction:t,value:{id:c,...a}})),m().zv({store:d,data:{alive:!0,status:"active",trigger:{id:s.id,type:"recurrence",recurrence:o},action_ids:[c]},transaction:t})}}),k(e,{type:"updated",frequency:o.frequency})}(t,i,n,a):function(e,t,n){y().createAndCommit({environment:e,userAction:"recurrenceActions.createRecurrence",canUndo:!0,perform:o=>{C(o,e,t,n)}})}(t,n,a)}function S(e){let{environment:t,blockStore:n}=e;const o=n.getAutomationStore();(0,d().O9)(o)&&(y().createAndCommit({environment:t,userAction:"recurrenceActions.deleteRecurrence",canUndo:!0,perform:e=>{_().disableAutomation({automationStore:o,environment:t,transaction:e}),_().deleteAutomation({automationStore:o,environment:t,transaction:e}),p().zA({stores:[n],update:{automation_id:void 0},transaction:e})}}),k(t,{type:"deleted"}))}function C(e,t,n,o){const{currentUserRootStore:r}=g().default.state;if(!r)return;const i=n.getParentStore();if(!i||i.table!==u().Vl)return;if(!i.getParentBlockStore())return;const d=n.getSpaceId(),s=(0,h().Z1)({environment:t,table:l().SC,spaceId:d}),y=m().eC({environment:t,table:c().yB,inMemoryRecordCache:n.inMemoryRecordCache,value:{parent_id:n.id,parent_table:n.table,alive:!0,space_id:d,status:"active",trigger:{id:a().JW(),type:"recurrence",recurrence:o},action_ids:[s]},transaction:e}).pointer.id;p().zA({stores:[n],update:{automation_id:y},transaction:e}),m().eC({environment:t,table:l().SC,inMemoryRecordCache:n.inMemoryRecordCache,transaction:e,value:{id:s,...T({automationId:y,spaceId:d,collectionPointer:i.getSpaceShardedPointer(),templatePageId:n.id})}}),k(t,{type:"created",frequency:o.frequency})}function T(e){const{automationId:t,spaceId:n,collectionPointer:o,templatePageId:r}=e;return{parent_id:t,parent_table:c().yB,type:"create_page",alive:!0,space_id:n,config:{collection:o,template_page_id:r}}}function k(e,t){(0,f().v)(e,"recurrence_saved",t)}const M=(0,n(959013).YK)({confirmDiscardChangesMessage:{id:"recurrence.confirmDiscardChanges.message",defaultMessage:"Discard unsaved changes?"},confirmDiscardChangesAccept:{defaultMessage:"Discard",id:"recurrence.confirmDiscardChanges.acceptLabel"}});async function I(e){const{hasPendingChanges:t}=e;if(!t)return!0;return(await s().Gh({acceptLabel:v().A.formatMessage(M.confirmDiscardChangesAccept),message:v().A.formatMessage(M.confirmDiscardChangesMessage),icon:(0,r().trashIcon)({height:i().Ev.xl,width:i().Ev.xl})})).accept}},866515:(e,t,n)=>{n.d(t,{n:()=>r});var o=n(296540);function r(e,t,n){const r=(0,o.useRef)(e),i=(0,o.useRef)(null);(0,o.useEffect)((()=>{r.current=e}),[e]),(0,o.useEffect)((()=>{const e=async()=>{i.current&&(clearTimeout(i.current),i.current=null),n&&(await r.current(),i.current=setTimeout(e,t))};return n&&e(),()=>{i.current&&(clearTimeout(i.current),i.current=null)}}),[n,t])}}}]);