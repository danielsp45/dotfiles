"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[40589,95496],{233035:(e,o,t)=>{t.r(o),t.d(o,{handlePropertyBgClick:()=>b,handlePropertyClick:()=>w,handlePropertyContextMenu:()=>C,handlePropertyEnter:()=>h,handlePropertyEsc:()=>g,handlePropertyOpenProperty:()=>z,handlePropertyTabOrUntab:()=>v});t(944114);var n=()=>t(908006),r=()=>t(741496),l=()=>t(901265),i=()=>t(522986),a=()=>t(778417),c=()=>t(319975),s=()=>t(751156),d=()=>t(345913),m=()=>t(404779),u=()=>t(780054),p=()=>t(502438),S=()=>t(24157),f=()=>t(556148),y=()=>t(339016);function v(e){const{type:o,environment:t,blockPropertyValueOverlayStore:n,showPropertyFormats:r,collectionContextStore:l,groupFormat:a,allRows:c,selectionStartRectStore:s,normalizedTableSelection:d,frozenSectionWidth:m,frozenIndex:u,disableHorizontalEdgeScroll:p}=e,S=n.state;if(!S.isOpen)return;const v=f().Yg(S.store,S.property,r,c),h="tab"===o?{col:Math.min(v.col+1,r.length-1),row:v.row}:{col:Math.max(v.col-1,0),row:v.row};(0,y().setSelection)({selection:{start:h,end:h},shouldNormalize:!0,environment:t,collectionContextStore:l,groupFormat:a,showPropertyFormats:r,allRows:c,selectionStartRectStore:s}),(0,y().updateSelectionScroll)({environment:t,direction:"tab"===o?f().Dp.Right:f().Dp.Left,showPropertyFormats:r,normalizedTableSelection:d,allRows:c,frozenSectionWidth:m,frozenIndex:u,disableHorizontalEdgeScroll:p}),i().VN({environment:t,blockPropertyValueOverlayStore:n})}function h(e){const{environment:o,blockPropertyValueOverlayStore:t,showPropertyFormats:r,collectionContextStore:l,groupFormat:a,allRows:d,selectionStartRectStore:m,normalizedTableSelection:p,frozenSectionWidth:v,frozenIndex:h,disableHorizontalEdgeScroll:w}=e,b=t.state;if(!b.isOpen)return;const{store:g,property:z}=b;if(u().A.isMobile){const e=l.normalizedSchemaStore.state[z],t=S().default.state;return void("text"===(null==e?void 0:e.type)&&"editing"===t.mode&&s().createAndCommit({userAction:"TableSelectionOverlay.mobileEnter",environment:o,canUndo:!0,perform:e=>{c().$D({environment:o,editorMode:"default",multiSelection:t.multiSelection,string:"\n",disableMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0,transaction:e})}}))}const C=f().Yg(g,z,r,d),R={col:C.col,row:C.row+1};n().default.afterNextFlush((()=>{f().Hh(t)&&(0,y().setSelection)({selection:{start:R,end:R},shouldNormalize:!0,environment:o,collectionContextStore:l,groupFormat:a,showPropertyFormats:r,allRows:d,selectionStartRectStore:m})})),(0,y().updateSelectionScroll)({environment:o,direction:f().Dp.Down,showPropertyFormats:r,normalizedTableSelection:p,allRows:d,frozenSectionWidth:v,frozenIndex:h,disableHorizontalEdgeScroll:w}),i().VN({environment:o,blockPropertyValueOverlayStore:t})}function w(e){var o;const{store:t,property:n,schema:r,environment:l,showPropertyFormats:i,collectionContextStore:a,groupFormat:c,allRows:s,selectionStartRectStore:d}=e;if("checkbox"!==(null===(o=r[n])||void 0===o?void 0:o.type)||u().A.isMobile)(0,m().y)();else{const e=f().Yg(t,n,i,s);(0,y().setSelection)({selection:{start:e,end:e},shouldNormalize:!0,environment:l,collectionContextStore:a,groupFormat:c,showPropertyFormats:i,allRows:s,selectionStartRectStore:d})}}function b(e,o,t,n,r,l,i,a,c,s,d){R({environment:e,blockPropertyValueOverlayStore:o,showPropertyFormats:t,collectionContextStore:n,groupFormat:r,allRows:l,selectionStartRectStore:i,normalizedTableSelection:a,frozenSectionWidth:c,frozenIndex:s,disableHorizontalEdgeScroll:d})}function g(e){const{environment:o,collectionContextStore:t,blockPropertyValueOverlayStore:n,showPropertyFormats:l,groupFormat:i,allRows:a,selectionStartRectStore:c,normalizedTableSelection:m,frozenSectionWidth:u,frozenIndex:p,disableHorizontalEdgeScroll:S}=e;R({environment:o,blockPropertyValueOverlayStore:n,showPropertyFormats:l,collectionContextStore:t,groupFormat:i,allRows:a,selectionStartRectStore:c,normalizedTableSelection:m,frozenSectionWidth:u,frozenIndex:p,disableHorizontalEdgeScroll:S,onDismiss:e=>{const{isNewBlock:n,store:l}=e;n&&l.isEmptyTitle()&&l.isEmptyPage()&&s().createAndCommit({userAction:"TableSelectionOverlay.handlePropertyEsc",environment:o,canUndo:!0,perform:e=>{d().oD({environment:o,blocks:[l],transaction:e}),e.postSubmitCallbacks.push((e=>{if(!e){const e=t.collectionStore(),n=t.collectionViewBlockStore();(0,r().N)(o,{analyticsName:"delete",from:"collection_esc_shortcut",block_id:l.id,block_type:"page",collection_id:null==e?void 0:e.id,collection_view_id:null==n?void 0:n.id})}}))}})}})}function z(e){const{openProperty:o,blockPropertyValueOverlayStore:t,disableHorizontalEdgeScroll:n,collectionContextStore:r,environment:l}=e,a=t.state;if(!a.isOpen)return;const{store:c}=a;i().ho({environment:l,blockPropertyValueOverlayStore:t,store:c,property:o,format:"table",disableHorizontalEdgeScroll:n,collectionContextStore:r})}function C(e){const{mouseEvent:o,environment:t,collectionContextStore:n,allRows:r,normalizedTableSelection:i}=e;if(o.preventDefault(),!(o.target instanceof Element))return;const c=i,s=f().RT(o.target);let d=!1;if(c&&s){const e=Math.min(c.start.row,c.end.row),i=Math.max(c.start.row,c.end.row);if(s.row>=e&&s.row<=i){const c=r.slice(e,i+1);c.length>0&&(a().td({environment:t,stores:c}),a().Lt({environment:t,store:c[0]}),l().it({environment:t,stores:p().default.state.stores,left:o.clientX,top:o.clientY,actionSectionGroupKey:"block_in_collection",showInput:!0,analyticsFrom:"content_block_menu",optionalAnalyticsProperties:{collectionContextStore:n}}),d=!0)}}if(!d&&s){const e=r[s.row];e&&(a().Lt({environment:t,store:e}),l().it({environment:t,stores:p().default.state.stores,left:o.clientX,top:o.clientY,actionSectionGroupKey:"block_in_collection",showInput:!0,analyticsFrom:"content_block_menu",optionalAnalyticsProperties:{collectionContextStore:n}}))}}function R(e){const{environment:o,blockPropertyValueOverlayStore:t,showPropertyFormats:n,collectionContextStore:r,groupFormat:l,allRows:a,selectionStartRectStore:c,normalizedTableSelection:s,frozenSectionWidth:d,frozenIndex:p,disableHorizontalEdgeScroll:S,onDismiss:v}=e,h=t.state;if(!h.isOpen)return;const{store:w,property:b}=h,g=f().Yg(w,b,n,a);u().A.isMobile?(0,m().y)():f().Hh(t)&&(0,y().setSelection)({selection:{start:g,end:g},shouldNormalize:!0,environment:o,collectionContextStore:r,groupFormat:l,showPropertyFormats:n,allRows:a,selectionStartRectStore:c}),(0,y().updateSelectionScroll)({environment:o,direction:f().Dp.Down,showPropertyFormats:n,normalizedTableSelection:s,allRows:a,frozenSectionWidth:d,frozenIndex:p,disableHorizontalEdgeScroll:S}),i().VN({environment:o,blockPropertyValueOverlayStore:t}),null==v||v(h)}},339016:(e,o,t)=>{t.r(o),t.d(o,{handleCommandEnter:()=>Q,handleCommandShiftEnter:()=>te,handleCopy:()=>$,handleCut:()=>J,handleDelete:()=>j,handleDirection:()=>Y,handleDragCancel:()=>L,handleDragEnd:()=>W,handleDragMove:()=>U,handleDragStart:()=>B,handleDuplicate:()=>oe,handleEnter:()=>G,handleEsc:()=>X,handleKeypress:()=>ne,handleMoveTo:()=>Z,handlePaste:()=>q,handleRowSelectableEnter:()=>re,handleShiftEnter:()=>ee,setSelection:()=>N,updateSelectionScroll:()=>ie});t(944114),t(898992),t(803949),t(581454),t(908872);var n=()=>t(908006),r=()=>t(584262),l=()=>t(970013),i=()=>t(713998),a=()=>t(522419),c=()=>t(179034),s=()=>t(708830),d=()=>t(522986),m=()=>t(612008),u=()=>t(843306),p=()=>t(750660),S=()=>t(246826),f=()=>t(755636),y=()=>t(281948),v=()=>t(435009),h=()=>t(620689),w=()=>t(778417),b=()=>t(4319),g=()=>t(319975),z=()=>t(751156),C=()=>t(2220),R=()=>t(404779),x=()=>t(519839),F=()=>t(458366),P=()=>t(38337),k=()=>t(405417),E=()=>t(492414),T=()=>t(592678),A=()=>t(57618),V=()=>t(695625),M=()=>t(644914),D=()=>t(765957),O=()=>t(353643),I=()=>t(732770),H=()=>t(611371),_=()=>t(450510),K=()=>t(556148);function N(e){const{selection:o,shouldNormalize:t,environment:n,collectionContextStore:r,groupFormat:l,showPropertyFormats:i,allRows:a,selectionStartRectStore:c}=e,s=r.collectionViewBlockStore();if(!s)return;const d=t?(0,_().yR)(o,i.length,a.length):o,m=a[d.start.row];b().td({environment:n,selectionKey:{collectionViewBlockStore:s,groupFormat:l},selection:d,currentRowStore:m}),c.recompute()}function B(e){const{dragEvent:o,environment:t,collectionContextStore:n,showPropertyFormats:r,paddingLeft:l,disabled:i,dragAndFillStore:a,frozenColumnRepositionStore:c,frozenIndex:s,allRows:d,normalizedTableSelection:m}=e;if(o.preventDefault(),o.target instanceof Element){if(K().Hl(o.target,P().FZs))c.setState({isRepositioning:!0,newFrozenIndex:s,newFrozenColumnXPosition:void 0}),function(e){var o;const{environment:t,collectionContextStore:n,showPropertyFormats:r,paddingLeft:l,allRows:i}=e;if(!n.frozoneStore.state.isScrolled)return;const a=i[0],c=r[0].property,s=A().A.findBlockPropertyValue(a,c),d=n.frozoneStore.state.scrollerLeftOffset??0,m=(0,M().kf)(t),u=Math.max(m-d,0),p=(0,_().QP)(t,n)?u:0;null==s||null===(o=s.getScrollerContext())||void 0===o||null===(o=o.horizontalScroller)||void 0===o||null===(o=o.getNode())||void 0===o||o.scrollTo({left:l-p})}({environment:t,collectionContextStore:n,showPropertyFormats:r,paddingLeft:l,allRows:d}),O().A.setState({...O().A.state,disableHorizontalEdgeScroll:!0,disableVerticalEdgeScroll:!0});else{const e=m;if(e&&K().Gd(i,n)&&K().Hl(o.target,P().yle))return void a.setState({...e})}(0,R().y)()}}function U(e){const{dragEvent:o,environment:t,collectionContextStore:n,groupFormat:r,showPropertyFormats:l,dragAndFillStore:i,frozenColumnRepositionStore:a,normalizedTableSelection:c,allRows:s,selectionStartRectStore:d}=e;if(!(o.target instanceof Element))return;if(a.state.isRepositioning);else if((0,T().Zm)()){const e=K().RT(o.target);if(!e)return;const a=i.state,m=(null==a?void 0:a.start)??(null==c?void 0:c.start)??e;if(!m)return;N({selection:{start:m,end:e},shouldNormalize:!0,environment:t,collectionContextStore:n,groupFormat:r,showPropertyFormats:l,allRows:s,selectionStartRectStore:d})}}function W(e){const{environment:o,collectionContextStore:t,showPropertyFormats:n,schema:r,dragAndFillStore:i,frozenColumnRepositionStore:a,normalizedTableSelection:c,allRows:s}=e;!function(e){const{environment:o,collectionContextStore:t,frozenColumnRepositionStore:n}=e,r=n.state.isRepositioning;if(!r)return;z().createAndCommit({userAction:"TableHeaderCell.handleFreezeColumns",environment:o,canUndo:!0,perform:e=>{b().sp({environment:o,collectionContextStore:t,currentIndex:n.state.newFrozenIndex,transaction:e,entrypoint:"TableSelectionOverlay.FrozenColumnRepositioner"}),n.reset()}})}({environment:o,collectionContextStore:t,frozenColumnRepositionStore:a}),function(e){const{environment:o,showPropertyFormats:t,schema:n,dragAndFillStore:r,normalizedTableSelection:i,allRows:a}=e,c=i;if(!c)return;const s=r.state;if(!s)return;const{start:d,end:m}=s;if(d.row!==m.row)return;const{start:u,end:p}=c,[S,f]=[Math.min(u.row,p.row),Math.max(u.row,p.row)],[y,v]=[Math.min(u.col,p.col),Math.max(u.col,p.col)],h=a[u.row],w=t.slice(y,v+1),b=w.reduce(((e,o)=>{var t;const r=null===(t=n[o.property])||void 0===t?void 0:t.type;return!r||l().rb.has(r)||"verification"===r||e.push({property:o.property,propertyType:r,value:h.getPropertyValue(o.property)||[]}),e}),[]);if(0===b.length)return;const g=a.slice(S,f+1);z().createAndCommit({userAction:"TableSelectionOverlay.handleDragAndFill",environment:o,canUndo:!0,perform:e=>{b.forEach((o=>{let{value:t,property:n,propertyType:r}=o;le({transaction:e,value:t,property:n,propertyType:r,startRowStore:h,rowStores:g})}))}}),(0,C().u)({environment:o,event:{eventName:"collection_table_drag_and_fill",eventProperties:{property_types:b.map((e=>e.propertyType)),num_rows:f-S,num_cols:b.length}}}),r.reset()}({environment:o,showPropertyFormats:n,schema:r,collectionContextStore:t,dragAndFillStore:i,normalizedTableSelection:c,allRows:s})}function L(e){const{dragAndFillStore:o,frozenColumnRepositionStore:t}=e;o.reset(),t.reset(),(0,R().y)()}function Y(e){var o;const{shortcutOrKeyboardEvent:t,direction:n,environment:r,collectionContextStore:l,groupFormat:i,showPropertyFormats:a,normalizedTableSelection:c,allRows:s,frozenSectionWidth:d,frozenIndex:m,disableHorizontalEdgeScroll:u,shiftKeyOverride:p}=e;null===(o=t.preventDefault)||void 0===o||o.call(t),I().A.setKeyboardMode(!0);const S=c;if(!S)return;const f=l.collectionViewBlockStore();if(!f)return;const y=void 0!==p?p:"shiftKey"in t&&t.shiftKey||!1,v={collectionViewBlockStore:f,groupFormat:i};let h=S;switch(n){case K().Dp.Left:h=b().jG({environment:r,selectionKey:v,selection:S,shiftKey:y,columnCount:a.length});break;case K().Dp.Right:h=b().Uz({environment:r,selectionKey:v,selection:S,shiftKey:y,columnCount:a.length,rowCount:s.length});break;case K().Dp.Up:h=b().bi({environment:r,selectionKey:v,selection:S,shiftKey:y});break;case K().Dp.Down:h=b().mL({environment:r,selectionKey:v,selection:S,shiftKey:y,rowCount:s.length})}ie({environment:r,direction:n,showPropertyFormats:a,normalizedTableSelection:h,allRows:s,frozenSectionWidth:d,frozenIndex:m,disableHorizontalEdgeScroll:u})}function G(e){const{shortcutEvent:o,environment:t,schema:n,showPropertyFormats:r,disabled:l,blockPropertyValueOverlayStore:a,collectionContextStore:c,normalizedTableSelection:s,allRows:m,disableHorizontalEdgeScroll:u}=e;o.preventDefault&&o.preventDefault(),I().A.setKeyboardMode(!0);const p=s;if(!p)return;const S=m[p.start.row],f=r[p.start.col].property,y=n[f];if(y&&!l)if((0,F().B2)(y))d().ho({environment:t,blockPropertyValueOverlayStore:a,store:S,property:f,format:"table",disableHorizontalEdgeScroll:u,collectionContextStore:c}),(0,R().y)();else if("checkbox"===y.type){const e=S.getPropertyStore(f),o=i().wu(e.getValue()),n=m.slice(p.start.row,p.end.row+1);z().createAndCommit({userAction:"TableSelectionOverlay.handleEnter",environment:t,canUndo:!0,perform:e=>{for(const r of n)g().R9({environment:t,store:r.getPropertyStore(f),value:i().rN(!o),transaction:e})}})}}function Q(e){const{environment:o,collectionContextStore:t,normalizedTableSelection:n,allRows:r,overrideLinkClick:l}=e,{device:i}=o,a=n;if(i.isMobile||!a)return;const c=r[a.start.row],{mainEditorCurrentBlockStore:s}=D().default.state,d=(0,x().wy)({environment:o,store:c,mainEditorCurrentBlockStore:s,collectionContextStore:t,fullyQualified:!1});d&&(l?l(d):v().oo({environment:o,url:d}))}function X(e){const{keyboardEvent:o,environment:t,normalizedTableSelection:n,allRows:r}=e;if(t.device.isMobile)return;o.preventDefault(),I().A.setKeyboardMode(!0);const l=n;if((0,R().y)(),l){const e=(0,_().hn)(l),o=r.slice(e.minRow,e.maxRow+1);w().td({environment:t,stores:o})}}function Z(e){var o;const{shortcutOrKeyboardEvent:t,environment:n,normalizedTableSelection:r,allRows:l}=e;null===(o=t.preventDefault)||void 0===o||o.call(t),I().A.setKeyboardMode(!0);const i=r;if((0,R().y)(),!i)return;const a=(0,_().hn)(i),c=l.slice(a.minRow,a.maxRow+1);if(0===c.length)return;w().td({environment:n,stores:c});const s=V().T.getRectFromStore(c[0]);p().ho({environment:n,blocks:c,originRect:s,moveToContext:"action_menu"})}function j(e){const{environment:o,collectionContextStore:t,disabled:n,showPropertyFormats:r,normalizedTableSelection:l,allRows:i}=e,a=l,c=t.normalizedSchemaStore.state;a&&!n&&z().createAndCommit({userAction:"TableSelectionOverlay.handleDelete",environment:o,canUndo:!0,perform:e=>{b().ic({selection:a,schema:c,currentPropertyFormats:r,currentRows:i,transaction:e})}})}function J(e){const{clipboardEvent:o,environment:t,collectionContextStore:n,disabled:r,groupFormat:l,showPropertyFormats:i,normalizedTableSelection:a,allRows:c,formulasModule:s}=e,d=a,m=n.normalizedSchemaStore.state,u=n.collectionViewBlockStore();u&&d&&!r&&z().createAndCommit({userAction:"TableSelectionOverlay.handleCut",environment:t,canUndo:!0,perform:e=>{b().De({selectionKey:{collectionViewBlockStore:u,groupFormat:l},schema:m,selection:d,currentPropertyFormats:i,currentRows:c,event:o,transaction:e,formulasModule:s})}})}function $(e){const{clipboardEvent:o,collectionContextStore:t,groupFormat:n,showPropertyFormats:r,normalizedTableSelection:l,allRows:i,formulasModule:a}=e,c=l,s=t.normalizedSchemaStore.state,d=t.collectionViewBlockStore();d&&c&&b().A_({selectionKey:{collectionViewBlockStore:d,groupFormat:n},schema:s,selection:c,currentPropertyFormats:r,currentRows:i,event:o,formulasModule:a})}function q(e){const{clipboardEvent:o,environment:t,collectionContextStore:n,groupFormat:r,schema:l,showPropertyFormats:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:c,disabled:s,normalizedTableSelection:d,allRows:m,clipboardActions:u}=e,p=d,S=n.collectionViewBlockStore();S&&p&&!s&&z().createAndCommit({userAction:"TableSelectionOverlay.handlePaste",environment:t,canUndo:!0,perform:e=>{b().GZ({environment:t,collectionContextStore:n,clipboardActions:u,selectionKey:{collectionViewBlockStore:S,groupFormat:r},selection:p,currentPropertyFormats:i,currentRows:m,event:o,transaction:e,schema:l,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:c})}})}function ee(e){const{environment:o,collectionContextStore:t,groupFormat:l,blockPropertyValueOverlayStore:i,showPropertyFormats:a,normalizedTableSelection:c,allRows:p,selectionStartRectStore:S,frozenSectionWidth:f,frozenIndex:v,disableHorizontalEdgeScroll:h}=e,{device:w}=o;if(w.isMobile)return;const b=c;if(!b)return;if(!(0,H().EF)(o))return;if(!t.shouldAllowNewItemCreation({overrideAllowForTypedViews:!0}))return;const g=p[b.start.row],C=t.subitemTreeStore.state,R=(0,s().Qe)(C.children,(e=>e.value.store===g)),F="table_selection_overlay_shift_enter";if(R){const e=R?(0,k().kY)(R.map((e=>e.value.store))):"",c=t.subitemExpandedStore.state.get(e),s=Boolean(null==c?void 0:c.isExpanded),f=[...R].splice(0,R.length-1),v=f?(0,k().kY)(f.map((e=>e.value.store))):"",h=t.subitemExpandedStore.state.get(v),w=Boolean(null==h?void 0:h.isExpanded);if(s||w)z().createAndCommit({userAction:"TableSelectionOverlay.handleNestedItemShiftEnter",environment:o,canUndo:!0,perform:e=>{const n=t.collectionStore();if(!n)return;const r=(0,u().u)({environment:o,collectionContextStore:t,groupsPointer:l?[l]:[],store:g,before:!1,collectionStore:n,transaction:e,subitemPath:R,subitemInsertDirection:w&&!s?"below":"into",from:F});if(r&&i){const e=()=>{d().ho({isNewBlock:!0,environment:o,blockPropertyValueOverlayStore:i,store:r,property:"title",format:"table",collectionContextStore:t})};t.registerCallbackForItemMounted(r,e)}}});else{const e={col:b.end.col,row:t.currentViewHasSort()?p.length:b.end.row+1};z().createAndCommit({userAction:"TableSelectionOverlay.handleShiftEnter",environment:o,canUndo:!0,perform:n=>{const i=(0,m().Q)({environment:o,collectionContextStore:t,groupsPointer:l?[l]:[],insertAtIndex:e.row,shouldCoerce:!0,templateStore:t.defaultPageTemplateStore.state,transaction:n,from:{createBlock:F},inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache});if(i&&!i.coercionSucceeded){const e=l?[l]:[],n=t.groupsStore.getGroupState(e);y().VU({environment:o,store:i.newStore,peekMode:(0,x().hH)(t),resultsStore:null==n?void 0:n.resultsStore,collectionContextStore:t,pageVisitSource:r().y8.Create})}}}),n().default.afterNextFlush((()=>{N({selection:{start:e,end:e},shouldNormalize:!1,environment:o,collectionContextStore:t,groupFormat:l,showPropertyFormats:a,allRows:p,selectionStartRectStore:S})}))}}else{const e={col:b.end.col,row:t.currentViewHasSort()?p.length:b.end.row+1};z().createAndCommit({userAction:"TableSelectionOverlay.handleShiftEnter",environment:o,canUndo:!0,perform:n=>{const i=(0,m().Q)({environment:o,collectionContextStore:t,groupsPointer:l?[l]:[],insertAtIndex:e.row,shouldCoerce:!0,templateStore:t.defaultPageTemplateStore.state,transaction:n,from:{createBlock:F},inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache});if(i&&!i.coercionSucceeded){const e=l?[l]:[],n=t.groupsStore.getGroupState(e);y().VU({environment:o,store:i.newStore,peekMode:(0,x().hH)(t),resultsStore:null==n?void 0:n.resultsStore,collectionContextStore:t,pageVisitSource:r().y8.Create})}}}),n().default.afterNextFlush((()=>{N({selection:{start:e,end:e},shouldNormalize:!1,environment:o,collectionContextStore:t,groupFormat:l,showPropertyFormats:a,allRows:p,selectionStartRectStore:S})}))}ie({environment:o,direction:K().Dp.Down,showPropertyFormats:a,normalizedTableSelection:c,allRows:p,frozenSectionWidth:f,frozenIndex:v,disableHorizontalEdgeScroll:h}),d().VN({environment:o,blockPropertyValueOverlayStore:i})}function oe(e){var o;const{keyboardEvent:t,environment:n,disabled:r,schema:l,showPropertyFormats:i,normalizedTableSelection:a,allRows:c}=e,{device:s}=n;if(s.isMobile)return;const d=a;if(!d||d.start.col!==d.end.col||r)return;if(!(0,H().EF)(n))return;const{start:m,end:u}=d,[p,S]=[Math.min(m.row,u.row),Math.max(m.row,u.row)],f=i[m.col],{property:y}=f,v=null===(o=l[f.property])||void 0===o?void 0:o.type;if(!v)return;const h=c.slice(p,S+1),w=c[m.row],b=w.getPropertyValue(y)||[];t.preventDefault(),z().createAndCommit({userAction:"TableSelectionOverlay.handleDuplicate",environment:n,canUndo:!0,perform:e=>{le({transaction:e,value:b,property:y,propertyType:v,startRowStore:w,rowStores:h})}})}function te(e){const{environment:o,normalizedTableSelection:t,allRows:n}=e,{device:l}=o;if(l.isMobile)return;if(t){const e=n[t.start.row],l=(0,E().Ay)({store:e,fullyQualified:!1,pageVisitSource:r().y8.LinkInPage});f().f({environment:o,url:l})}}function ne(e){const{keyboardEvent:o,environment:t,schema:n,showPropertyFormats:r,disabled:i,blockPropertyValueOverlayStore:a,collectionContextStore:c,normalizedTableSelection:s,allRows:m,disableHorizontalEdgeScroll:u}=e;if(!o.key||o.metaKey||o.ctrlKey)return;o.preventDefault(),I().A.setKeyboardMode(!0);const p=s;if(!p)return;const S=m[p.start.row],f=r[p.start.col].property,y=n[f];y&&!i&&l().wz.includes(y.type)&&o.key&&1===o.key.length&&(d().ho({environment:t,blockPropertyValueOverlayStore:a,store:S,property:f,format:"table",disableHorizontalEdgeScroll:u,insertChar:o.key,collectionContextStore:c}),(0,R().y)())}function re(e){const{onEnterArgs:o,environment:t,collectionContextStore:n,groupFormat:r,showPropertyFormats:l,allRows:i,selectionStartRectStore:a}=e,c=o.blocks.map((e=>i.indexOf(e))),s=Math.min(...c)||0,d=Math.max(...c)||0;s>=0&&d>=0&&N({selection:{start:{col:0,row:s},end:{col:0,row:d}},shouldNormalize:!0,environment:t,collectionContextStore:n,groupFormat:r,showPropertyFormats:l,allRows:i,selectionStartRectStore:a})}function le(e){const{transaction:o,value:t,property:n,propertyType:r,startRowStore:l,rowStores:s}=e,d={table:c().ev,id:l.id,spaceId:l.getSpaceId()};s.forEach((e=>{if(e.id!==l.id&&(g().R9({environment:e.environment,store:e.getPropertyStore(n),value:t,transaction:o}),"text"===r||"file"===r||"url"===r)){const n=(t?i().pJ(t):[]).reduce(((e,o)=>{const t=(0,a().oN)({urlOrAlias:o.url});return t?[...e,t]:e}),[]);n.length>0&&S().Bn({store:e,source:d,fileIds:n.map((e=>e.fileId)),transaction:o})}}))}function ie(e){const{environment:o,direction:t,showPropertyFormats:n,normalizedTableSelection:r,allRows:l,frozenSectionWidth:i,frozenIndex:a,disableHorizontalEdgeScroll:c}=e,s=r;if(!s)return;let d;d=t===K().Dp.Down?s.start.row>s.end.row?s.start:s.end:t===K().Dp.Up?s.start.row<s.end.row?s.start:s.end:t===K().Dp.Right?s.start.col>s.end.row?s.start:s.end:s.start.col<s.end.row?s.start:s.end;const m=l[d.row],u=n[d.col].property,p=A().A.findBlockPropertyValue(m,u),S=(null==p?void 0:p.getNode())??null;if(S){const e=i??0,t=c||a&&s.start.col<=a&&s.end.col<=a;h().hT({element:S,environment:o,vertical:{reveal:"closest",paddingToTopEdge:96,paddingToBottomEdge:48},horizontal:t?void 0:{reveal:"closest",paddingToLeftEdge:e},scrollerContext:null==p?void 0:p.getScrollerContext()})}}}}]);