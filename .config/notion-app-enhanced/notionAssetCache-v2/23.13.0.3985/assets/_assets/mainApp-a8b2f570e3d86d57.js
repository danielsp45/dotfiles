"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[21088,78217],{9991:(e,t,n)=>{n.d(t,{T:()=>ri});var o=n(296540),r=()=>n(662303),i=()=>n(484714),a=()=>n(852507),s=()=>n(554279),c=()=>n(885443),l=()=>n(402390),d=()=>n(306622),u=()=>n(824772),p=()=>n(599824),m=()=>n(206267),f=()=>n(765957),v=()=>n(679924),g=()=>n(329418),h=()=>n(763884);function b(e){h().K.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}const S=6e4;async function y(e){var t,n;void 0!==f().default.state.currentUserStore&&void 0!==f().default.state.currentSpaceStore||await f().default.waitUntil((()=>void 0!==f().default.state.currentUserStore&&void 0!==f().default.state.currentSpaceStore));const o=null===(t=f().default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(n=f().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!document.hasFocus())return;if(!o||!r)return;const i=(0,g().g)({userId:o,spaceId:r}),a=Date.now();b(i?{userId:o,spaceId:r,session:{...i,lastFocusedTime:a}}:{userId:o,spaceId:r,session:{id:m().JW(),sessionStartTime:a,lastFocusedTime:a}})}var w=()=>n(780054),A=()=>n(645873);const k=new(A().O2)("thirdPartyScripts",(()=>n.e(1978).then(n.bind(n,63620)))),I=(0,A()._h)(k,(e=>e.InjectThirdPartyScripts));var C=()=>n(38337);const _={GlobalInAppMessageListener:new(A().O2)("GlobalInAppMessageListener",(()=>n.e(94869).then(n.bind(n,793383))))},x=(0,A()._h)(_.GlobalInAppMessageListener,(e=>e.GlobalInAppMessageListener)),E=new(A().O2)("offlinePagesListener",(()=>n.e(61440).then(n.bind(n,659064)))),T=(0,A()._h)(E,(e=>e.OfflinePagesListener));n(944114);var P=()=>n(56366),L=()=>n(249847),U=()=>n(667193),M=()=>n(308665),R=()=>n(227440),j=()=>n(217429),B=()=>n(961581),D=()=>n(722038);var N=()=>n(884064),O=()=>n(554894),q=()=>n(401497),z=()=>n(959013),W=()=>n(284371),K=()=>n(436572),F=()=>n(186445),V=()=>n(540758),$=()=>n(670631),G=n(474848);function H(){const e=(0,z().tz)(),t=(0,q().DP)(),n=!(0,P().O$)(R().e),r=(0,P().K8)((()=>(0,F().s0)()),[]),i=(0,o.useRef)(n),a=(0,o.useRef)(r);(0,o.useEffect)((()=>{!n||i.current&&r===a.current||function(e){var t;const{isOffline:n,currentPageId:o,intl:r,theme:i}=e;if(!($().A.state.offlinePages&&j().default.checkGate({gateName:"download_for_offline"})&&n&&o&&(0,V().Bd)(o)))return;const a=null===(t=$().A.state.offlinePages[o])||void 0===t?void 0:t.lastDownloadedAt,s=a?r.formatDate(a,{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}):void 0;K().D6({label:(0,G.jsxs)("div",{children:[(0,G.jsx)("div",{style:{fontWeight:W().Wy.medium},children:(0,G.jsx)(z().sA,{defaultMessage:"Working offline",id:"offlinePages.snackbar.title"})}),a&&(0,G.jsx)("div",{style:{color:i.text.secondary},children:(0,G.jsx)(z().sA,{defaultMessage:"Last sync on {lastDownloadedAtFormatted}.",id:"offlinePages.snackbar.description",values:{lastDownloadedAtFormatted:s}})})]})})}({isOffline:n,currentPageId:r,intl:e,theme:t}),i.current=n,a.current=r}),[n,r,e,t])}var J=()=>n(537972),Z=(n(16280),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(581454),()=>n(591779)),Y=()=>n(496603),Q=()=>n(763824),X=()=>n(825972),ee=()=>n(963589),te=()=>n(291606),ne=()=>n(406792),oe=()=>n(560868),re=()=>n(344300),ie=()=>n(756581);const ae=1e3;class se extends Error{constructor(e){super(e),this.name="OfflineAutosyncAbortedError"}}async function ce(e){const{environment:{currentUser:{id:t},defaultRecordCache:{persistedRecordCache:n}},desiredPageIds:o}=e;if(!n||!t)return{pagesToAdd:[],pagesToRemove:[]};return function(e){const{desiredPageIds:t,existingAutosyncedPageIds:n}=e,o=new Set(t),r=new Set(n);return{pagesToAdd:(0,Y().sb)(t.filter((e=>!r.has(e)))),pagesToRemove:n.filter((e=>!o.has(e)))}}({desiredPageIds:o,existingAutosyncedPageIds:(await n.getOfflineAutosyncedOrigins({userId:t})).map((e=>e.id))})}async function le(e){const{environment:t,abortSignal:n,autosyncIntervalMs:o}=e,{currentUser:{id:r},defaultRecordCache:{persistedRecordCache:i}}=t;if(!i||!r)return;const a=j().default.getConfigKey("offline_mode_settings","autosynced_pages_limit"),s=j().default.getConfigKey("offline_mode_settings","autosynced_favorite_pages_limit"),c=function(e){var t;let{limit:n}=e;return null===(t=X().wI.state)||void 0===t?void 0:t.slice(0,n).map((e=>e.pageId))}({limit:a}),l=function(e){let{limit:t}=e;const n=f().default.state.currentSpaceViewStore,o=null==n?void 0:n.getBookmarkedPageIds();if(o)return null==o?void 0:o.slice(0,t)}({limit:s});void 0!==c&&void 0!==l&&(await navigator.locks.request(`toggle_offline_page_${t.currentUser.id}`,(()=>{})),await navigator.locks.request(`offline_background_task_${t.currentUser.id}`,{ifAvailable:!0},(async e=>{if(!e)return;const a=await i.getOfflineMetadataLastExecutedAt({userId:r,taskType:"autosync"});if(a){if(Date.now()-a<.95*o)return}const s=Date.now(),{pagesToAdd:d,pagesToRemove:u}=await ce({environment:t,desiredPageIds:[...c,...l]});if(0===d.length&&0===u.length)return;n.throwIfAborted();const p=new Set;await(0,Q().lX)(d,5,(async e=>{await(0,oe().og)({from:"addAutosyncedPage",autosyncTypes:["frecent"],pageId:e,environment:t,originPageIds:[e],visitedBlockIds:{forThisOriginPage:new Set,forThisInterval:p},stats:{imageCount:0,loadCachedPageChunkV2ForOfflineCount:0,queryCollectionCount:0},downloadAbortSignal:n}),n.throwIfAborted()})),await i.updateOfflineMetadataLastExecutedAt({userId:r,taskType:"autosync",lastExecutedAt:s});for(const o of u)await(0,oe().zB)({from:"removeAutosyncedPage",pageId:o,environment:t}),n.throwIfAborted();ne().default.measure({metricName:"update_autosynced_pages",startTime:s,endTime:performance.now()},{environment:t,data:{number_of_pages_added:d.length,number_of_pages_removed:u.length}})})))}function de(){const e=(0,i().v3)(),t=(0,D().y)(),n=(0,D().R)(),r=(0,ee().X)("offline_autosync"),a=(0,ie().C)(),s=(0,P().K8)((()=>function(e,t){const n=(0,te().dE)();if(void 0===n&&(e||t))return(0,te().Nw)("on"),"on";return n}(a,n)),[a,n]),c=(0,Z().ZC)(s)??"off",l=(0,P().K8)((()=>B().A.state.initialRenderCompleted&&R().A.state.online&&(n||t&&r&&a)),[t,r,a,n]),d=(0,P().K8)((()=>j().default.getConfigKey("offline_mode_settings","autosync_interval_ms")),[]);(0,o.useEffect)((()=>{const t=new AbortController,n=(0,Y().sg)((()=>{if(l)if("on"!==c||"off"!==s){if("on"===s){le({environment:e,abortSignal:t.signal,autosyncIntervalMs:d}).catch((e=>{if(!(e instanceof se))throw e}));const n=.05*d,o=d+Math.random()*n*2-n;return setInterval((()=>{le({environment:e,abortSignal:t.signal,autosyncIntervalMs:o}).catch((e=>{if(!(e instanceof se))throw e}))}),o)}}else(async function(e){const{defaultRecordCache:{persistedRecordCache:t},currentUser:{id:n}}=e;t&&n&&(await t.removeAllOfflineAutosyncedOrigins({userId:n}),await t.updateOfflineMetadataLastExecutedAt({userId:n,taskType:"autosync",lastExecutedAt:0}),(0,re().readAndCacheOfflinePages)({userId:n,persistedRecordCache:t,tellOtherTabsToUpdate:!0}))})(e).catch((e=>{if(!(e instanceof se))throw e}))}),ae),o=n();return()=>{"off"===s&&t.abort(new se("Autosync aborted because it was turned off")),n.cancel(),o&&clearInterval(o)}}),[e,l,s,c,d])}(0,n(604341).exposeDebugValue)("debugAutosync",(function(e){if(!e)throw new Error("Pass in `__console.environment` as the first param.");le({environment:e,abortSignal:(new AbortController).signal,autosyncIntervalMs:0})}));var ue=()=>n(346),pe=()=>n(534177),me=()=>n(874913),fe=()=>n(137493);async function ve(e,t){var n;return"undefined"==typeof navigator||void 0===(null===(n=navigator.locks)||void 0===n?void 0:n.request)?t():await navigator.locks.request(e,{ifAvailable:!0},(async e=>{if(e)return t()}))}const ge=(0,n(583835).Dv)("extractWebClipperContent");var he=()=>n(578194),be=()=>n(449506),Se=()=>n(787172),ye=()=>n(357625),we=()=>n(864260),Ae=()=>n(302022);const ke=new(n(752196).A);var Ie=()=>n(851650),Ce=()=>n(20822);var _e=()=>n(457395),xe=()=>n(640653),Ee=()=>n(151059);function Te(){const e=(0,i().v3)(),t=(0,P().K8)((()=>f().default.state.currentUserRootStore),[]);(0,o.useEffect)((()=>{t&&async function(e,t){await _e().y();const n=t.getSpaceViewStores();for(const o of n){const t=o.getBookmarkedPageStores();for(const e of t)Pe(e);const n=o.getSharedPages();if(n)for(const e of n)Pe(e);const r=o.getTeamsStores();for(const e of r){const t=e.getTeamPagesStores();for(const e of t)Pe(e)}const i=o.getSpaceStore();if(i){Ee().A.getData(e,{spaceId:i.id});const t=(0,xe().I0)(e,i);for(const e of t)Pe(e)}}}(e,t)}),[t,e])}function Pe(e){e.load();const t=e.getCollectionViewSourceOrLinkCollectionStores();for(const n of t)n.load()}var Le=()=>n(857639),Ue=()=>n(994310),Me=()=>n(711059),Re=()=>n(502626),je=()=>n(934839),Be=()=>n(901389),De=()=>n(135552),Ne=()=>n(731320),Oe=()=>n(150193),qe=()=>n(865241);const ze=6e4;function We(){const e=(0,i().v3)(),t=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"checking"}})}(e)),[e]),n=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n;o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"error",error:t}})}(0,n,e)),[e]),r=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),a=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n,r=(0,Me().parseVersion)(t.version),i=me().getDesktopVersion(),a=(0,Me().getUpdateType)({currentVersion:i,nextVersion:r,app:"desktop"});o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"downloading",type:a,version:r,timestamp:Date.now(),progress:0}})}(0,n,e)),[e]),s=(0,o.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:o}=n,r=o.state;r.electronUpdate&&"downloading"===r.electronUpdate.state&&o.setState({appUpdate:r.appUpdate,electronUpdate:{...r.electronUpdate,progress:t.transferred/t.total}})}(0,n,e)),[e]),c=(0,o.useCallback)(((t,n)=>function(e,t,n){const{device:o}=n,{AppUpdateStore:r}=n,i=Ue().A.get(Re().wp),a=t.version;if(i===a){if(o.isMac)return r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"ready",type:Me().UpdateType.Major,version:void 0,versionCreatedTime:0}}),void Be().ui({message:(0,G.jsx)(z().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.prompt",defaultMessage:"Please move the Notion app into the Applications folder for the auto-updater to work."}),showCancel:!1,keepFocus:!1,handleCancel:()=>Re().K0(n),items:[{label:(0,G.jsx)(z().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.dismissButton.label",defaultMessage:"OK"}),onAccept:()=>Re().K0(n)}]});Le().log({level:"error",from:"AppUpdateListener",type:"electronUpdateFailed",data:{miscDataToConvertToString:{previousUpdateReady:i,nextUpdateReady:a}}})}const s=me().getDesktopVersion(),c=(0,Me().parseVersion)(t.version),l=(0,Me().getUpdateType)({currentVersion:s,nextVersion:c,app:"desktop"});r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"ready",type:l,version:c,versionCreatedTime:0}})}(0,n,e)),[e]),l=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"checking"}})}(e)),[e]),d=(0,o.useCallback)(((t,n)=>Ve(n,e)),[e]),u=(0,o.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),p=(0,o.useCallback)(((t,n)=>$e(n,e)),[e]),m=(0,o.useCallback)(((t,n)=>Ge(n,e)),[e]),f=(0,o.useCallback)(((t,n)=>He(n,e)),[e]),v=(0,o.useCallback)((()=>function(e){const t=e.AppUpdateStore;if(R().A.getState().online&&t.isSilentUpdate()){const n=t.state.appUpdate;Re().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}(e)),[e]);(0,o.useEffect)((()=>{const{device:o}=e;if(o.isElectron){const e=me().electronUpdateReady.addListener(c),o=me().electronUpdateError.addListener(n),i=me().electronUpdateChecking.addListener(t),g=me().electronUpdateAvailable.addListener(a),h=me().electronUpdateProgress.addListener(s),b=me().electronUpdateNotAvailable.addListener(r),S=me().appUpdateReady.addListener(f),y=me().appUpdateError.addListener(d),w=me().appUpdateChecking.addListener(l),A=me().appUpdateAvailable.addListener(p),k=me().appUpdateInstall.addListener(v),I=me().appUpdateProgress.addListener(m),C=me().appUpdateNotAvailable.addListener(u);return()=>{null==e||e(),null==o||o(),null==i||i(),null==g||g(),null==h||h(),null==b||b(),null==S||S(),null==y||y(),null==w||w(),null==A||A(),null==k||k(),null==I||I(),null==C||C()}}}),[e,l,u,p,d,v,m,f,a,t,n,r,s,c]),(0,o.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(n&&n.updateReceiveApiHandlers({appUpdateReady:t=>He(t,e),appUpdateError:t=>Ve(t,e),appUpdateChecking:l,appUpdateAvailable:t=>$e(t,e),appUpdateProgress:t=>Ge(t,e),appUpdateNotAvailable:u}),function(e){const t=Re().Cv(),n=Re().B0();if(!(0,Me().isEqualVersion)(t,n)){0;Fe((0,Me().getUpdateType)({currentVersion:t,nextVersion:n,app:"client"}),n,Re().bg(),e)}}(e),t.isMobileNative&&n&&n.api.openUpdateSettings){const n=t.osVersion,o=t.isAndroid&&(0,Me().isLessThanVersion)(n,[7,0]),r=t.isIOS&&(0,Me().isLessThanVersion)(n,[16,0]);(o||r)&&function(e){const{mobileNative:t}=e;if(!t)return;je().HQ({bannerStore:Oe().A,id:"PlatformUpdateWarning",contentKey:"mobile_platform_unsupported",styleKey:De().q.Red})}(e)}}),[e,l,u]);const g=(0,o.useRef)("");(0,o.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(!n&&!t.isElectron&&!w().A.isAdminMode){async function o(){if(qe().A.state.isVisible)try{const t=Re().Cv(),n=await be().callApi({eventName:"getAssetsJsonV2",environment:e,data:{hash:g.current}});if("success"===n.type){const o=n.data;if(o.version){const n=o,r=(0,Me().parseVersion)(n.version);r&&((0,Me().isEqualVersion)(r,t)||He(n,e)),g.current=o.hash}}}catch(t){}}const r=setInterval(o,ze);return()=>clearInterval(r)}}),[e])}async function Ke(e,t){const n=await async function(e){await f().default.waitUntilRendered();const{mainEditorCurrentBlockStore:t,currentUserStore:n}=f().default.state;return!(!n||!t||(0,Ne().qb)(e,t))}(e);n&&(Re().Dv(e,t,"banner"),je().HQ({bannerStore:Oe().A,id:"AppUpdate",contentKey:"minor_app_update",styleKey:De().q.Blue}))}function Fe(e,t,n,o){e===Me().UpdateType.Major||e===Me().UpdateType.Minor||Re().wT()?(t&&Re().fC(t)&&Re().qr(t,n),Ke(o,e)):Re().KD()?function(e,t){Re().Dv(e,t,"modal"),Be().ui({message:(0,G.jsx)(z().sA,{defaultMessage:"We just launched new features!",id:"breakingUpdateDialog.title"}),showCancel:!1,keepFocus:!1,handleCancel:()=>Re().K0(e),items:[{label:(0,G.jsx)(z().sA,{defaultMessage:"Update and see whatâ€™s new",id:"breakingUpdateDialog.updateButtonTitle"}),color:"blue",onAccept:()=>Re().K0(e)}],innerStyle:{width:380}})}(o,e):t&&Re().fC(t)&&Re().qr(t,n)}function Ve(e,t){const{AppUpdateStore:n}=t;n.state.appUpdate&&"ready"===n.state.appUpdate.state||n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"error",error:e}})}function $e(e,t){const{AppUpdateStore:n}=t;if(n.state.appUpdate&&"ready"===n.state.appUpdate.state)return;const o=(0,Me().parseVersion)(e.version),r=Re().Cv(),i=(0,Me().getUpdateType)({currentVersion:r,nextVersion:o,app:"client"});n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"downloading",type:i,version:o,timestamp:Date.now(),progress:0}})}function Ge(e,t){const{AppUpdateStore:n}=t,o=n.state;o.appUpdate&&"downloading"===o.appUpdate.state&&n.setState({electronUpdate:o.electronUpdate,appUpdate:{...o.appUpdate,progress:e.downloaded/e.total}})}function He(e,t){const{AppUpdateStore:n}=t,o=(0,Me().parseVersion)(e.version),r=Re().Cv(),i=(0,Me().getUpdateType)({currentVersion:r,nextVersion:o,app:"client"}),a=e.createdTime;if(!Re().fC(o)){const e={state:"ready",type:i,version:o,versionCreatedTime:a};n.setState({electronUpdate:n.state.electronUpdate,appUpdate:e})}Fe(i,o,a,t)}var Je=()=>n(861017),Ze=()=>n(939768);var Ye=()=>n(14307);async function Qe(e){if(e.device.isBrowser&&document.hidden)return;if(e.device.isElectron&&!(await me().isWindowVisible()))return;if(Ye().isConnected())return void Xe(!0);if(!1===navigator.onLine)return void Xe(!1);"success"===(await be().callApi({eventName:"ping",environment:e,data:{}})).type?Xe(!0):Xe(!1)}function Xe(e){R().A.setState({...R().A.state,online:e,lastOfflineTimestamp:e?R().A.state.lastOfflineTimestamp:Date.now()})}const et=5e3;var tt=()=>n(466103);n(672577),n(430670);var nt=()=>n(955825),ot=()=>n(919709),rt=()=>n(191772),it=()=>n(751735),at=()=>n(381349),st=()=>n(667019),ct=()=>n(94953),lt=()=>n(555776),dt=()=>n(116008),ut=()=>n(786074),pt=()=>n(372154),mt=()=>n(141465),ft=()=>n(871399);function vt(e){const{discussionId:t,level:n}=e;return`\n\t\t.${(0,nt().EJ)({level:n})}.${(0,nt().wV)({discussionId:t})}.${rt().Do} {\n\t\t\tbackground: ${(0,at().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,at().JG)(e)} !important;\n\t\t}\n\t`}function gt(e){const{level:t}=e;return`\n\t\t.${(0,nt().EJ)({level:t})}.${rt().uU}.${rt().Do} {\n\t\t\tbackground: ${(0,at().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,at().JG)(e)} !important;\n\t\t}\n\t`}function ht(e){const t=(0,at().aO)({level:1,mode:e.mode,hovered:!1,selected:!1}),n=(0,it().Mj)(t).alpha()/2,o=(0,it().Mj)(t).alpha(n).toRgbString(),r=(0,at().JG)({level:1,mode:e.mode,hovered:!1,selected:!1}),i=(0,it().Mj)(r).alpha()/2,a=(0,it().Mj)(r).alpha(i).toRgbString();return`\n\t\t.${rt().K6}.${rt().Do} {\n\t\t\tbox-shadow: unset !important;\n\t\t\tpadding-bottom: 2px;\n\t\t\tbackground: ${o} !important;\n\t\t\tborder-bottom: 2px solid ${a} !important;\n\t\t\tanimation: commentFadeIn 500ms ease-in;\n\t\t}\n\t`}function bt(e){const{theme:t,selected:n,hovered:o}=e;return`background: ${(0,at().FK)({annotationType:"update",type:"background",selected:n,hovered:o,overlapping:!1,mode:t.mode})} !important;\n\t\t\tborder-bottom: 2px solid ${(0,at().FK)({annotationType:"update",type:"underline",selected:!1,hovered:!0,overlapping:!1,mode:t.mode})} !important;`}function St(e){const{discussionId:t,theme:n,selected:o,hovered:r}=e;return`\n\t\t.${(0,nt().ED)({type:"update"})}.${(0,nt().wV)({discussionId:t})}.${rt().Do} {\n\t\t\t${bt({theme:n,selected:o,hovered:r})}\n\t\t}\n\t\t.${(0,nt().ED)({type:"remove"})}.${(0,nt().wV)({discussionId:t})}.${rt().Do} {\n\t\t\t${function(e){const{theme:t,selected:n,hovered:o}=e,r=(0,at().FK)({annotationType:"remove",type:"background",selected:n,hovered:o,overlapping:!1,mode:t.mode}),i=(0,at().FK)({annotationType:"remove",type:"underline",selected:n,hovered:o,overlapping:!1,mode:t.mode});return`background: ${r} !important;\n\t\t\tcolor: ${t.text.secondary} !important;\n\t\t\ttext-decoration: none !important;\n\t\t\tborder-bottom: 2px solid ${i} !important;`}({theme:n,selected:o,hovered:r})}\n\t\t}\n\t`}function yt(e){var t,n,o;const r=(null===(t=ct().A.state)||void 0===t?void 0:t.discussionIds)||[],i=null!==(n=pt().A.state)&&void 0!==n&&n.open&&(null===(o=pt().A.state)||void 0===o?void 0:o.discussionIds)||[];return[...r.flatMap((t=>Y().Hn(nt().DS).map((n=>vt({discussionId:t,level:n+1,hovered:!0,selected:!1,mode:e.mode}))))),...i.flatMap((t=>Y().Hn(nt().DS).map((n=>vt({discussionId:t,level:n+1,hovered:!1,selected:!0,mode:e.mode})))))].join("\n")}function wt(e){var t,n,o;const r=(null===(t=ct().A.state)||void 0===t?void 0:t.discussionIds)||[],i=null!==(n=pt().A.state)&&void 0!==n&&n.open&&(null===(o=pt().A.state)||void 0===o?void 0:o.discussionIds)||[];return[...r.map((t=>St({theme:e,discussionId:t,selected:!1,hovered:!0}))),...i.map((t=>St({theme:e,discussionId:t,selected:!0,hovered:!1})))].join("\n")}function At(e){let t="";const n=ut().A.getHoveredEdit();n&&(t=`\n\t\t\t.${(0,nt().K3)({type:"insert",editId:n.editId})} {\n\t\t\t\t${bt({theme:e,selected:!1,hovered:!0})}\n\t\t\t}\n\t\t\t.${(0,nt().K3)({type:"remove",editId:n.editId})} {\n\t\t\t\t${function(e){return`background: ${(0,at().FK)({annotationType:"remove",type:"background",selected:!1,hovered:!0,overlapping:!1,mode:e.mode})} !important;\n\t\t\tcolor: ${e.text.secondary} !important;\n\t\t\ttext-decoration-color: rgba(0, 0, 0, 0) !important;`}(e)}\n\t\t\t}\n\t\t`);return`\n\t\t${t}\n\t\t${`\n\t\t.${C()._Qb} .${(0,nt().h_)("insert")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.text.primary} !important;\n\t\t}\n\n\t\t.${C()._Qb} .${(0,nt().h_)("remove")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${e.text.quaternary} !important;\n\t\t}\n\t`}\n\t`}function kt(e){const t=st().W.getHoveredEditId();return t?function(e){const{editId:t,theme:n,selected:o,hovered:r}=e;return`\n\t\t.${(0,nt().rI)({editId:t})}.${rt().Do} {\n\t\t\t${bt({theme:n,selected:o,hovered:r})}\n\t\t}\n\t`}({editId:t,theme:e,selected:!1,hovered:!0}):""}function It(){const e=(0,q().DP)(),t=(0,P().K8)((()=>[yt(e),wt(e)].join("\n")),[e]),n=(0,P().K8)((()=>function(){var e,t,n;const o=null===(e=mt().A.state)||void 0===e?void 0:e.store,r="token"===(null===(t=mt().A.state)||void 0===t?void 0:t.type)?null===(n=mt().A.state)||void 0===n||null===(n=n.annotations)||void 0===n?void 0:n.find(ot().sh$):void 0;if(!r)return"";const i=(0,ot().cQR)(r);return"block"!==(null==o?void 0:o.table)?"":`\n\t\t\t.${(0,nt().re)({href:i,blockId:o.id})}.${rt().Do} {\n\t\t\t\ttransition: border-color 100ms ease-in, opacity 100ms ease-in;\n\t\t\t\tborder-color: currentColor !important;\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`}()),[]),r=(0,P().K8)((()=>At(e)),[e]),i=(0,P().K8)((()=>function(e){var t,n,o;if(!(null===(t=dt().A.state)||void 0===t?void 0:t.open))return"";let r=[],i=[];return null!==(n=lt().A.state)&&void 0!==n&&n.isHovered&&(r=Y().Hn(nt().DS).map((t=>gt({level:t+1,hovered:!0,selected:!1,mode:e.mode})))),null!==(o=lt().A.state)&&void 0!==o&&o.isActivelyComposing&&(i=Y().Hn(nt().DS).map((t=>gt({level:t+1,hovered:!1,selected:!0,mode:e.mode})))),[...r,...i].join("\n")}(e)),[e]),a=(0,P().K8)((()=>function(e){return ft().default.isRightMarginCommentHovered()?[ht(e)].join("\n"):""}(e)),[e]),s=(0,P().K8)((()=>kt(e)),[e]),c=(0,o.useMemo)((()=>[t,n,r,i,a,s].filter(Boolean).join("\n")),[r,t,n,i,a,s]),l=(0,o.useRef)(null);(0,o.useLayoutEffect)((()=>{if(!l.current){const e=document.createElement("style");l.current=e,document.head.appendChild(e)}l.current.innerHTML=c}),[c])}var Ct=()=>n(522419),_t=()=>n(825237),xt=()=>n(278238),Et=()=>n(945778),Tt=()=>n(435009),Pt=()=>n(712030),Lt=()=>n(51183),Ut=()=>n(363686),Mt=()=>n(807054),Rt=()=>n(589994),jt=()=>n(977390),Bt=()=>n(46986),Dt=()=>n(648088);function Nt(){const e=(0,i().v3)(),t=(0,z().tz)(),n=(0,q().DP)(),r=(0,o.useRef)(),a=(0,Bt().x6)(),s=(0,P().r6)((()=>{const{RouterStore:t}=e,n=t.state.route;return(0,Dt().Z)({environment:e,store:f().default.state.mainEditorCurrentBlockStore,isWorkflowsContainerWithCreationEnabled:a,route:n})}),[e,a],{useDeepEqual:!0});(0,P().O$)(s),(0,o.useEffect)((()=>{const t=Y().sg((function(){const{device:t}=e,o=s.state;if(!o)return;const{url:i,title:a,icon:c,assetPath:l,isNonverified:d,hasBypassedContentClassification:u,isMemberOfSpace:p,description:m,shouldNoIndex:f,spaceNameForMetaTag:v,authorName:g,coverImage:h,isPublicSite:b}=o;let S,y,A,k;c&&(0,xt().T8)(c.icon)?A=c.icon:c&&(0,Et().A)(c.icon)?S=c.icon:c&&Ct().GM(c.icon)?y=c.icon:l&&Ct().Du(l)&&(k=l);const I=d&&!u&&!p,C=(0,Dt().EL)(e,o);C&&document.title!==C&&(document.title=C,me().setWindowTitle(C)),i&&Ze().ZO(i)!==Ze().ZO(window.location.href)&&(window.history.replaceState(window.history.state,void 0,i),Tt().Mu({environment:e,url:window.location.href}));const _=document.querySelector("link[rel='shortcut icon']");if(_){const o={linkEl:_,environment:e,device:t,theme:n,config:w().A,lastSetIconStringRef:r},i=(0,Dt().oo)("production");I?(_.href=i,r.current=i):S?function(e,t){const{linkEl:n,environment:o,lastSetIconStringRef:r}=e;if(t===r.current)return;r.current=t,(0,Lt().A)(t,(0,Pt().FN)(o)).then((async e=>{await Mt().waitForInitialPageRenderToComplete(),await jt().A.waitUntil((()=>!jt().A.state.isMeasuring)),n.href=(null==e?void 0:e.toDataURL("image/png"))||""}))}(o,S):A?function(e,t){const{linkEl:n,device:o,theme:r,lastSetIconStringRef:i}=e;if(t===i.current)return;i.current=t;const a=`${t}?mode=${r.mode}`;o.isFirefox?n.href=a:(0,Ut().A)(a).then((e=>{n.href=e}))}(o,A):c&&y?function(e,t,n){const{linkEl:o,environment:r,config:i,lastSetIconStringRef:a}=e,{...s}=t,c=window.location.origin!==i.domainBaseUrl,l=_t().wY({url:n,permissionRecord:s.pointer,baseUrl:i.domainBaseUrl,fullyQualified:!1,userId:r.currentUser.id,...c?{favicon:!0}:{width:100}});if(l===a.current)return;a.current=l,Rt().transactionQueue.awaitRecordTransaction(s.pointer).then((()=>{if(!c)return(0,Ut().A)(l);o.href=l})).then((e=>{!c&&e&&(o.href=e)}))}(o,c,y):k?function(e,t){const{linkEl:n,environment:o,config:r,lastSetIconStringRef:i}=e,a=_t().x8({url:t,width:100,baseUrl:r.domainBaseUrl,fullyQualified:!1,userId:o.currentUser.id});if(a===i.current)return;i.current=a,(0,Ut().A)(a).then((e=>{n.href=e}))}(o,k):i!==r.current&&(_.href=i,r.current=i)}if(b){!function(e){let{title:t,description:n,url:o,icon:r,image:i,shouldNoIndex:a,author:s,spaceName:c}=e;function l(e,t){const n=`meta[property="${t}"], meta[name="${e}"]`,o=document.querySelector(n);if(o&&o instanceof HTMLMetaElement)return o;const r=document.createElement("meta");return t?r.setAttribute("property",t):r.setAttribute("name",e),document.head.appendChild(r),r}function d(e){const t=document.querySelector(`link[rel="${e}"]`);if(t&&t instanceof HTMLLinkElement)return t;const n=document.createElement("link");return n.setAttribute("rel",e),document.head.appendChild(n),n}['meta[name="twitter:site"]'].forEach((e=>{const t=document.querySelector(e);t&&t instanceof HTMLMetaElement&&t.remove()}));l("twitter:title").setAttribute("content",t);if(l("og:title","og:title").setAttribute("content",t),n){l("description").setAttribute("content",n);l("twitter:description").setAttribute("content",n);l("og:description","og:description").setAttribute("content",n)}if(o){l("twitter:url").setAttribute("content",o);l("og:url","og:url").setAttribute("content",o);d("canonical").setAttribute("href",o)}if(i){l("twitter:image").setAttribute("content",i);l("og:image","og:image").setAttribute("content",i)}if(s){l("article:author","article:author").setAttribute("content",s)}if(c){l("og:site_name","og:site_name").setAttribute("content",c)}if(r){d("shortcut icon").setAttribute("href",r)}if(a){l("robots").setAttribute("content","noindex")}else{const e=document.querySelector('meta[name="robots"]');e&&e instanceof HTMLMetaElement&&e.remove()}}({title:a??"",description:m,url:i,icon:null==_?void 0:_.href,image:h,shouldNoIndex:f,author:g,spaceName:v});const e=document.querySelector('script[type="application/ld+json"]');e&&e.remove();const t=document.createElement("script");t.type="application/ld+json",t.textContent=JSON.stringify({"@context":"https://schema.org","@type":"WebSite",name:v,url:window.location.href}),document.head.appendChild(t)}}),500,{leading:!0}),o=document.title;return s.state&&t(),s.addListener(t),()=>{s.removeListener(t),document.title=o}}),[e,t,s,n])}n(803949);var Ot=()=>n(248265),qt=()=>n(840125),zt=()=>n(700149);var Wt=()=>n(319975),Kt=()=>n(751156),Ft=()=>n(441467),Vt=()=>n(404783),$t=()=>n(962845),Gt=()=>n(135985);var Ht=()=>n(347199),Jt=()=>n(5705),Zt=()=>n(797265);var Yt=()=>n(492553);var Qt=()=>n(24157),Xt=()=>n(725614);const en={"editor:textSelection":{saveState:function(){const e=Qt().default.state;if("empty"===e.mode)return;const t=(0,Gt().Ns)(e.multiSelection);return{version:1,data:{...e,multiSelection:t}}},restoreState:function(e){let{savedState:t}=e;const{data:n}=t,{multiSelection:o,mode:r}=n,i=(0,Gt().Em)(o);return!!i&&(Xt().setMultiSelection({multiSelection:i,readOnly:"readOnly"===r}),!0)}},"editor:historyState":{saveState:function(){var e,t;const n=null===(e=window.history.state)||void 0===e?void 0:e.id,o=null===(t=window.history.state)||void 0===t?void 0:t.currentUserId;if(n&&o)return Jt().zd({historyId:n,currentUserId:o}),{version:1,data:{historyId:n,userId:o}}},restoreState:function(e){var t,n;let{environment:o,savedState:r}=e;const{data:{historyId:i,userId:a}}=r,s=null===(t=window.history.state)||void 0===t?void 0:t.id,c=null===(n=window.history.state)||void 0===n?void 0:n.currentUserId;if(c!==a)return!0;if(s===i)return!0;const l=Jt().GL({historyId:i,currentUserId:c});if(!l)return!0;!function(e){var t;let{environment:n,historyState:o}=e;const{PageScroller:r}=Ht().A;if(!o)return;if(null!==(t=o.blockIds)&&void 0!==t&&t.length)return void Zt().Ls(n,{blockId:o.blockIds[0],animate:!1});r&&Y().Et(o.scrollTop)&&setTimeout((()=>{var e;null===(e=r.getNode())||void 0===e||e.scrollTo({top:o.scrollTop})}),500)}({environment:o,historyState:l});const d=o.RouterStore;return Jt().TC({RouterStore:d,currentUserId:c}),window.history.replaceState({id:i,currentUserId:c},""),d.update((e=>({...e,id:i,historyState:l}))),!0}},"collaboration:discussion":{saveState:function(){const e=dt().A.state;let t;if(!e.open)return;return"block"===e.type&&"reaction"===e.content||("comment"===e.content&&(t=function(e){const t=e.discussionInputStore.getState(),n=t.textStore.getValue();if(!n)return;const o={open:e.open,blockId:e.blockId,content:e.content,rectBounds:{left:e.rect.left,top:e.rect.top,width:e.rect.width,height:e.rect.height},property_id:e.property_id,lastKnownBlockStoreId:e.lastKnownBlockStore.id,discussionInputStoreState:{textValue:n,showAttachFileIntro:t.showAttachFileIntro,renderFileAttachIntro:t.renderFileAttachIntro},spaceId:t.textStore.pointer.spaceId};if("inline"===e.type)return{...o,type:"inline",multiSelection:(0,Gt().Ns)(e.multiSelection)};if("block"===e.type)return{...o,type:"block"}}(e)),"reaction"===e.content&&(t=function(e){if("inline"===e.type)return{open:e.open,blockId:e.blockId,content:e.content,emoji:e.emoji,rectBounds:{left:e.rect.left,top:e.rect.top,width:e.rect.width,height:e.rect.height},type:"inline",multiSelection:(0,Gt().Ns)(e.multiSelection)}}(e)),!t)?void 0:{version:1,data:t}},restoreState:function(e){let{environment:t,savedState:n}=e;const{data:o}=n;return"comment"===o.content?function(e,t){const{rectBounds:n,discussionInputStoreState:o,spaceId:r,lastKnownBlockStoreId:i,...a}=t;if(!r)return!1;const s=new DOMRect(n.left,n.top,n.width,n.height),c=(0,Gt().AK)(i);if(!c)return!1;const l=new(Vt().A)(e,r);if(Kt().createAndCommit({userAction:"DiscussionInput.willMount",environment:e,canUndo:!0,perform:t=>{Wt().R9({environment:e,store:l.state.textStore,value:o.textValue,transaction:t})}}),"inline"===t.type){const e=(0,Gt().Em)(t.multiSelection);if(!e)return!1;dt().A.setState({...a,rect:s,lastKnownBlockStore:c,blockStore:c,type:"inline",discussionInputStore:l,lastEditables:(0,$t().$W)(e),multiSelection:e})}else"block"===t.type&&dt().A.setState({...a,rect:s,lastKnownBlockStore:c,blockStore:c,type:"block",discussionInputStore:l});return!0}(t,o):"reaction"!==o.content||function(e,t){const{rectBounds:n,...o}=t,r=new DOMRect(n.left,n.top,n.width,n.height),i=(0,Gt().AK)(t.blockId);if(!i)return!1;if("inline"===t.type){const n=(0,Gt().Em)(t.multiSelection);if(!n)return!1;dt().A.setState({...o,rect:r,blockStore:i,type:"inline",multiSelection:n}),Ft().of({environment:e,blockStore:i,multiSelection:n,formulasModule:void 0,rect:r})}return!0}(t,o)}},"collaboration:discussionMenuInteraction":{saveState:function(){const e=lt().A.state;if(e.isActivelyComposing||e.isHovered)return{version:1,data:e}},restoreState:function(e){let{savedState:t}=e;const{data:n}=t;return lt().A.setState(n),!0}},"desktop:navigationHistory":{saveState:function(){const e=Yt().H.getState();if(void 0!==e.activeIndex)return{version:1,data:e}},restoreState:function(e){let{savedState:t}=e;const{data:n}=t;return Yt().H.setState(n),Ot().NF(),!0}}},tn=new Map;function nn(e,t){tn.has(e)||tn.set(e,t)}function on(e){tn.delete(e)}function rn(){const e=function(){const e=(0,qt().getCloseConfirmationDialogReason)();if(e)return[{reason:e,providerId:"UnloadBlockerFromBeforeUnload"}];for(const t of tn.values()){const e=t.getUnloadBlockers;if(!e)continue;const n=e();if(n.length>0)return n}return[]}();if(e.length>0)return[{blockers:e}];return[{tabClientStates:an()}]}function an(){const e={};for(const[o,r]of tn.entries())try{var t;const n=null===(t=r.saveState)||void 0===t?void 0:t.call(r);if(!n)continue;e[o]=n}catch(n){}return e}function sn(){return[an()]}var cn=()=>n(549500);const ln={transcription_idle:async(e,t)=>{(await cn().$O.load()).idleTranscriptionActions.showIdleTranscriptionToast(e,t)},transcription_error:async(e,t)=>{(await cn().$O.load()).transcriptionErrorActions.showTranscriptionErrorToast(e,t)},transcription_recording_stopped:async(e,t)=>{(await cn().$O.load()).transcriptionNotificationActions.showTranscriptionRecordingStoppedToast(e,t)}};var dn=()=>n(831872),un=()=>n(857783),pn=()=>n(2220),mn=()=>n(973647),fn=()=>n(615234);n(737550);const vn={zoom:["us.zoom.xos","Zoom.exe"],safari:["com.apple.WebKit.GPU"],chrome:["com.google.Chrome.helper","chrome.exe"],teams:["com.microsoft.teams2","ms-teams.exe"],edge:["msedge.exe"],brave:["com.brave.Browser.helper","brave.exe"],arc:["company.thebrowser.browser.helper","Arc.exe"],firefox:["org.mozilla.firefox","firefox.exe"]};function gn(e){for(const t of(0,pe().uv)(vn)){if(vn[t].some((t=>e.toLowerCase().includes(t.toLowerCase()))))return t}}var hn=()=>n(239837),bn=()=>n(982254),Sn=()=>n(630116),yn=()=>n(964345);var wn=()=>n(249696);function An(e){const t=(0,i().v3)(),n=(0,wn().W)(),r=(0,P().K8)((()=>t.device.isElectron&&e&&n),[t.device.isElectron,n,e]),a=function(){const e=(0,P().O$)(f().AppStoreCurrentSpaceStore);return(0,P().K8)((()=>{const t=bn().A.state.tabs,n=yn().ei.state,o=[];return null!=n&&n.isTranscriptionBlock()&&o.push(n),o.push(...t.flatMap((e=>e.activeBlocks)).flatMap((t=>{if(!t)return[];if(!e)return[];const n=Sn().Bv.createChildStore(e,t.pointer);return n.isTranscriptionBlock()&&o.push(n),[]}))),Y().hS(o,"id")}),[e])}(),s=(0,o.useCallback)((async(e,n,o)=>{if(!r)return;if(!(await me().isMainTabOrWindow()))return;const i=o.map(gn).filter(pe().O9),s=n.map(gn).filter(pe().O9);for(const r of i){if(a.length>0)break;if(!s.includes(r)){(await cn().$O.load()).audioProcessDetectionActions.sendNotificationForRunningAudioProcess(t,r);break}}const c=a[0];for(const r of s)if(!i.includes(r)&&c){kn({fn:async()=>{if("transcribing"!==(0,hn().by)(c).state)return;(0,pn().u)({environment:t,event:{eventName:"system_audio_process_stopped",eventProperties:{process_name:r,currently_running_audio_processes:i,previously_running_audio_processes:s,block_id:c.id}}});(await cn().$O.load()).transcriptionBlockActions.stopTranscription({environment:t,blockStore:c,from:"audio_process_detection"})},processName:r,delayMs:2*fn().TD});break}}),[t,r,a]);(0,o.useEffect)((()=>me().runningInputAudioProcessesChanged.addListener(s)),[s]),(0,o.useEffect)((()=>{r&&me().initializeRunningInputAudioProcessDetection(1e3,!1)}),[r])}function kn(e){const{fn:t,processName:n,delayMs:o}=e;setTimeout((async()=>{const e=await me().getRunningInputAudioProcesses();if(mn().Q.isFail(e))return;e.value.map(gn).filter(pe().O9).includes(n)||t()}),o)}const In=(0,z().YK)({have_local_draft_unsaved_changes:{defaultMessage:"Changes you made to the layout may not be saved.",id:"closeConfirmationMessages.haveLocalDraftUnsavedChanges"},dictation_in_progress:{defaultMessage:"Transcription is in progress.",id:"closeConfirmationMessages.dictationInProgress"}});var Cn=()=>n(869562),_n=()=>n(749687),xn=()=>n(948914),En=()=>n(38864),Tn=()=>n(730591),Pn=()=>n(732770),Ln=()=>n(148832),Un=()=>n(330932);function Mn(){const{tabStates:e,isFrameReady:t}=(0,P().O$)(zt().f),n=(0,i().v3)();(0,o.useEffect)((()=>{e&&t&&function(e){for(const[n,o]of tn.entries())try{const t=o.restoreState,r=zt().f.getStateForProvider(n);if(!t||!r)continue;t({environment:e,savedState:r})&&zt().f.consumeState(n)}catch(t){}}(n)}),[e,t,n])}function Rn(){const e=(0,i().v3)(),t=(0,z().tz)(),n=(0,P().O$)(f().AppStoreCurrentSpaceStore),r=(0,P().K8)((()=>bn().A.state.tabs),[]),a=(0,P().K8)((()=>({observedWidth:_n().sidebarSizeObserver.rect.state.width,targetWidth:_n().sidebarWidthStore.state,isExpanded:_n().sidebarExpandedStore.state,resizing:_n().sidebarResizingStore.state,isMouseEntered:_n().sidebarMouseEnteredStore.state})),[]),s=(0,P().K8)((()=>Tn().A.state.open),[]),c=(0,P().K8)((()=>En().I.state.open),[]),l=(0,P().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]),[d,u]=(0,o.useState)(!1),p=e.currentUser.isLoggedIn(),m=(0,Me().formatVersion)(me().getDesktopVersion()),[v,g]=(0,o.useState)(void 0),{shouldShowSidebar:h}=(0,P().K8)((()=>(0,F().X4)(e)),[e]);(0,o.useEffect)((()=>{v&&d&&me().windowSidebarState.set({isLoggedIn:p,shouldShowSidebar:h,...a,observedWidth:a.isExpanded?a.targetWidth:a.observedWidth})}),[a,p,v,d,h]),(0,o.useEffect)((()=>{v&&Ot().NF()}),[v]);const b=(0,P().K8)((()=>{var e,t;const n="transcription"===(null===(e=yn().Ay.state.rootBlock)||void 0===e?void 0:e.getType())?null===(t=yn().Ay.state.rootBlock)||void 0===t?void 0:t.pointer:void 0;return n?[{type:"transcription",pointer:n}]:[]}),[]);(0,o.useEffect)((()=>{me().setActiveBlocks(b)}),[b]);const S=(0,P().K8)((()=>yn().Ay.getState().enabled),[]);(0,o.useEffect)((()=>{me().setIsRecording(S)}),[S]),(0,o.useEffect)((()=>{let e;e=p?a.isExpanded?"expanded":"collapsed":"disabled",me().sidebarState.set(e)}),[a.isExpanded,p]);const y=(0,P().K8)((()=>{var e,t,n;return{currentUserId:null===(e=f().default.state.currentUserStore)||void 0===e?void 0:e.id,currentSpaceId:null===(t=f().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId(),currentPageId:null===(n=f().default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.id}}),[]);(0,o.useEffect)((()=>{me().setAppStoreState(y)}),[y]);const A=(0,ee().X)("tab_groups_beta_launch");(0,o.useEffect)((()=>{me().tabSpacesState.setIsTabSpacesBetaEnabled(A)}),[A]),An(Boolean(v));const k=(0,P().K8)((()=>F().$o.state&&"page"===e.RouterStore.state.route.name),[e.RouterStore]);(0,o.useLayoutEffect)((()=>{me().setZenMode(k)}),[k]),(0,o.useEffect)((()=>{v||Pn().A.setKeyboardMode(!1)}),[v]);const I=(0,o.useCallback)(((t,n)=>{n.forEach((t=>{(0,pn().u)({environment:e,event:t})}))}),[e]);(0,o.useEffect)((()=>me().trackBatched.addListener(I)),[I]);const C=(0,o.useCallback)(((e,t)=>{l||g(t)}),[l]),_=(0,ee().X)("tab_unloading"),x=(0,P().K8)((()=>j().default.getConfigKey("tab_unload_threshold","thresholdInMs")),[]);(0,o.useEffect)((()=>{me().setTabUnloadingEnabled(_)}),[_]),(0,o.useEffect)((()=>{_&&me().setTabUnloadThreshold(x)}),[x,_]),(0,o.useEffect)((()=>{if(!_||l)return;const e=function(){for(const[e,t]of(0,pe().WP)(en))nn(e,t);return()=>{for(const e of(0,pe().uv)(en))on(e)}}();me().getRestoredClientState().then((e=>{e&&zt().f.setTabStates(e)}));const t=me().addUnloadTabHandler(rn);return()=>{e(),null==t||t()}}),[l,_]),(0,o.useEffect)((()=>me().addGetClientStateHandler(sn)),[]),Mn();const E=(0,o.useCallback)(((e,t)=>{!async function(){const e=await cn().$O.load();await e.dictationActions.updateActiveBlocks(t)}()}),[]),T=(0,P().K8)((()=>{const{tabs:e}=bn().A.state;return e.flatMap((e=>e.activeBlocks??[]))}),[]);(0,o.useEffect)((()=>{T.length>0&&E(void 0,T)}),[E,T]),(0,o.useEffect)((()=>{if(void 0===v||l)return;const e=()=>{qe().A.update((e=>({...e,isVisible:!document.hidden&&v})))};return e(),document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[v,l]),(0,o.useEffect)((()=>{if(!l)return me().isActiveTab.get().then((e=>{g(e)})),me().isActiveTab.addListener(C)}),[C,l]);const L=(0,o.useCallback)(((e,t)=>{void 0===t.isShowingTabBar&&(t.isShowingTabBar=!0),xn().A.setState(t)}),[]);(0,o.useEffect)((()=>{var e;return null===(e=me().electronAppFeatures.get())||void 0===e||e.then((e=>{xn().A.setState(e)})),me().electronAppFeatures.addListener(L)}),[L]);const U=(0,o.useCallback)(((e,t)=>{bn().A.update((e=>({...e,tabs:t})))}),[]);(0,o.useEffect)((()=>me().electronTabs.addListener(U)),[U]);const M=(0,o.useCallback)(((e,t)=>{bn().A.update((e=>({...e,currentTab:t})))}),[]);(0,o.useEffect)((()=>me().electronCurrentTab.addListener(M)),[M]);const R=(0,o.useCallback)(((e,t)=>{bn().A.update((e=>{const n=new Set(e.unauthorizedIframeUrls??[]);n.add(t);const o=Array.from(n);return{...e,unauthorizedIframeUrls:o}}))}),[]);(0,o.useEffect)((()=>me().setUnauthorizedIframeUrls.addListener(R)),[R]);const B=(0,o.useCallback)((t=>{Cn().setExpand({environment:e,isExpanded:!a.isExpanded,from:"electron_listener",saveDetailsSidebarPreference:!1})}),[e,a.isExpanded]);(0,o.useEffect)((()=>me().sidebarState.addToggleListener(B)),[B]);const D=(0,o.useCallback)(((e,t)=>{t?Cn().open({fromElectron:!0}):Cn().close()}),[]);(0,o.useEffect)((()=>me().sidebarState.addSetSidebarOpenListener(D)),[D]);const N=(0,o.useCallback)(((e,t)=>{_n().sidebarExpandedStore.setState(t.isExpanded),_n().sidebarWidthStore.setState(t.targetWidth)}),[]),O=(0,o.useCallback)((e=>{let t;Tn().A.update((e=>(t=!e.open,{...e,open:t}))),t&&c&&En().I.update((e=>({...e,open:!1})))}),[c]);(0,o.useEffect)((()=>me().tabSpacesState.addToggleMenuListener(O)),[O]);const q=(0,o.useCallback)(((e,t)=>{Tn().A.update((e=>({...e,tabSpacesState:{...e.tabSpacesState,...t}})))}),[]);(0,o.useEffect)((()=>me().tabSpacesState.addListener(q)),[q]),(0,o.useEffect)((()=>{!v&&s&&Tn().A.update((e=>({...e,open:!1})))}),[v,s]),(0,o.useEffect)((()=>{!v&&c&&En().I.update((e=>({...e,open:!1})))}),[v,c]);const W=(0,o.useCallback)(((e,t)=>{K().D6({label:t})}),[]);(0,o.useEffect)((()=>me().tabSpacesState.addSnackBarMessageListener(W)),[W]),(0,o.useEffect)((()=>{if(!l)return me().windowSidebarState.get().then((e=>{e&&(_n().sidebarExpandedStore.setState(e.isExpanded),_n().sidebarWidthStore.setState(e.targetWidth),_n().sidebarSizeObserver.rect.update((t=>({...t,width:e.observedWidth})))),u(!0)})),me().windowSidebarState.addListener(N)}),[N,l]),(0,o.useEffect)((()=>{!async function(){if(void 0===m)return;const t=await be().callApi({eventName:"isDesktopVersionCompatible",environment:e,data:{desktopVersion:m}});"success"!==t.type||t.data.compatible||window.location.replace(w().A.domainBaseUrl+t.data.redirect)}()}),[m,e]),(0,o.useEffect)((()=>me().performShortcut.addListener(((t,n)=>{dn().N6(e,n)}))),[e]);const V=(0,P().K8)((()=>{if(j().default.checkGate({gateName:"desktop_close_confirmation_dialog"})){const e=(0,qt().getUserControlledCloseConfirmationDialogReason)();if(e){return{analytics_id:e,localized_message:t.formatMessage(In[e])}}}}),[t]);(0,o.useEffect)((()=>{me().setCloseConfirmationDialogReason(V)}),[V]);const $=(0,o.useCallback)(((t,o)=>{if(!n)return;const r=Ln().B.createChildStore(n,o.pointer);un().uK({environment:e,store:r,pageVisitSource:o.source})}),[e,n]);(0,o.useEffect)((()=>me().navigateToBlock.addListener($)),[$]);const G=(0,o.useCallback)(((t,n)=>{ln[n.toastId](e,n)}),[e]);(0,o.useEffect)((()=>{var e;return null===(e=me().pushToast)||void 0===e?void 0:e.addListener(G)}),[G]);const H=(0,o.useCallback)(((t,n)=>{"back"===n?Ot().aX(e):"forward"===n&&Ot().sY(e)}),[e]);(0,o.useEffect)((()=>me().handleBackForwardNavigation.addListener(H)),[H]);const J=(0,o.useCallback)(((t,n)=>{Ot().YK(e,n)}),[e]);(0,o.useEffect)((()=>me().handleMetaClick.addListener(J)),[J]);const Z=(0,o.useCallback)(((e,t)=>{En().I.setState({direction:t,open:!0}),s&&Tn().A.update((e=>({...e,open:!1})))}),[s]);(0,o.useEffect)((()=>me().showTabHistoryMenu.addListener(Z)),[Z]);const Y=(0,o.useCallback)(((e,t,o)=>{const r=bn().A.state.tabs.find((e=>e.id===t)),i=Un().j.state.open;if(!r||!r.pagePointer||!n||i)return;const a=Ln().B.createChildStore(n,r.pagePointer);mt().A.setState({type:"tab",store:a,domRect:{...o,y:0,height:0},tabId:t})}),[n]);(0,o.useEffect)((()=>me().setHoveredTab.addListener(Y)),[Y]);const Q=(0,o.useCallback)((e=>{mt().A.setState(void 0)}),[]);(0,o.useEffect)((()=>me().clearHoveredTab.addListener(Q)),[Q]);const X=(0,P().K8)((()=>{var e;return"tab"===(null===(e=mt().A.state)||void 0===e?void 0:e.type)?mt().A.state.tabId:void 0}),[]);(0,o.useEffect)((()=>{k&&X&&mt().A.setState(void 0)}),[X,k]),(0,o.useEffect)((()=>{!v&&X&&mt().A.setState(void 0)}),[X,v]),(0,o.useEffect)((()=>{const e=r.find((e=>e.id===X));X&&!e&&mt().A.setState(void 0)}),[X,r])}var jn=()=>n(720665),Bn=()=>n(974233);function Dn(e){(0,Bn().default)({url:`${w().A.secureFileConfig.rootPath}/refresh`,environment:e,method:"GET",format:"text"})}n(823215);var Nn=()=>n(979340),On=()=>n(498212);var qn=()=>n(749240);function zn(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,P().K8)((()=>{const{currentUserStore:n,currentUserSettingsStore:o,currentUserRootStore:r}=f().default.state;if(!(e.currentUser.id&&n&&o&&r))return e.publicDomainUserId?{user_id:e.publicDomainUserId}:void 0;const i=r.getSpaceViewStores(),a=i.length>0&&i.every((e=>e.isReady()));if(!n.isDefined()||!o.isDefined()||!a)return;const s=Y().oE(i.map((e=>e.getSpaceId()))).map((t=>Ee().A.getData(e,{spaceId:t}))),c=i.map((e=>e.getModel())).filter((e=>(0,pe().O9)(e))).filter((e=>!e.getNotifyEmail())).map((e=>e.getSpaceId())).map(On().ot);if(!s.every((e=>Boolean(e)||null===e)))return;const l=function(e){const t=e.map((e=>(0,xe().Gb)(e))),n=new Set(Y().oE(t));if(n.has("enterprise"))return"enterprise";if(n.has("business"))return"business";if(n.has("plus"))return"plus";if(n.has("personal"))return"personal_pro";if(n.has("team_free"))return"team_free";if(n.has("personal_free"))return"personal_free";if(n.has("free"))return"free";return"none"}(s),d=o.getSettings();if(!d)return;if(void 0===qn().subscriptionDataStoreInstance.state)return;const u={user_id:n.id,email:n.getEmail(),user_persona:d.persona,user_team_role:d.team_role,user_use_cases:d.use_cases,user_company_size:d.company_size,user_source:d.source,user_plan_type:l,user_subscription_tier:qn().subscriptionDataStoreInstance.state.subscriptionTier,user_has_at_least_one_free_tier_space:Kn(s),time_zone:d.time_zone,locale:d.locale,preferred_locale:d.preferred_locale,signup_time:d.signup_time,app_version:t.version,workspace_email_opt_out:c};return d.signup_time&&(u.created_at=Math.floor(d.signup_time/1e3)),t.desktopAppVersion&&(u.desktop_app_version=t.desktopAppVersion),t.mobileAppVersion&&(u.mobile_app_version=t.mobileAppVersion),d.used_desktop_web_app&&(u.used_desktop_web_app=d.used_desktop_web_app),d.used_mobile_web_app&&(u.used_mobile_web_app=d.used_mobile_web_app),d.used_mac_app&&(u.used_mac_app=d.used_mac_app),d.used_windows_app&&(u.used_windows_app=d.used_windows_app),d.used_ios_app&&(u.used_ios_app=d.used_ios_app),d.used_android_app&&(u.used_android_app=d.used_android_app),u}),[e,t],{useDeepEqual:!0});(0,o.useEffect)((()=>{n&&"none"!==n.user_plan_type&&Wn(e,n)}),[e,n]);const r=void 0!==n;(0,o.useEffect)((()=>{const t=window.setTimeout((()=>{!r&&e.currentUser.id&&Wn(e,{user_id:e.currentUser.id})}),5e3);return()=>{window.clearTimeout(t)}}),[e,r])}const Wn=Y().nF((function(e,t){(0,n(551625).T)({environment:e,userId:(0,On().ot)(t.user_id),traits:{...t,user_id:(0,On().ot)(t.user_id)}})}),5e3);function Kn(e){return e.map((e=>(0,xe().Gb)(e))).filter(pe().Vq).some((e=>Nn().dL(e)))}var Fn=()=>n(893820),Vn=()=>n(268405),$n=()=>n(576727);var Gn=()=>n(588165),Hn=()=>n(724368),Jn=()=>n(621979);var Zn=()=>n(987201),Yn=()=>n(410690),Qn=()=>n(711771),Xn=()=>n(148777),eo=()=>n(47170),to=()=>n(20199);const no={recentPagesActions:new(A().O2)("recentPagesActions",(async()=>Promise.resolve().then(n.bind(n,824188)))),userSignalsHelpers:new(A().O2)("userSignalsHelpers",(async()=>n.e(84084).then(n.bind(n,954220)))),broadcastChannel:new(A().O2)("broadcastChannel",(async()=>Promise.resolve().then(n.bind(n,467135)))),minisearchDependency:Qn().f};function oo(e){const{elector:t,broadcastChannel:n}=e.state;e.setState(e.getInitialState());(async()=>{await(null==t?void 0:t.die()),await(null==n?void 0:n.close())})()}function ro(){(0,o.useEffect)((()=>{(0,Xn().So)((()=>({appStart:(0,Yn().getAppStartTime)(),hookStart:performance.now()})))}),[]);const e=(0,i().v3)(),t=(0,L().T)(),n=(0,eo().O)(),r=(0,Z().ZC)(t),a=(0,Z().ZC)(n);(0,o.useEffect)((()=>{t&&n&&(t!==r||n!==a)&&(oo(to().A),async function(e){const{spaceId:t,userId:n,environment:o}=e;oo(to().A),(0,Xn().So)((e=>({appStart:e.appStart,hookStart:e.hookStart,setupLocalSearchStart:performance.now()})));const r=no.recentPagesActions.load().then((async e=>{await e.reinitializeGlobalRecentPagesStoreState(o,n,t)})),i=no.userSignalsHelpers.load(),a=no.broadcastChannel.load(),s=(async()=>{const{BroadcastChannel:e,createLeaderElection:o}=await a,r=new e(`local_search_${t}_${n}`),i=o(r);to().A.update((e=>({...e,elector:i,broadcastChannel:r})))})(),c=(await i).initializeAndLoadAllUserSignals({spaceId:t,userId:n,environment:o});await Promise.all([Qn().f,r,c,s])}({spaceId:n,userId:t,environment:e}))}),[e,t,n,r,a])}var io=()=>n(673998);var ao=()=>n(908006),so=()=>n(620689),co=()=>n(574012);const lo=new(n(496506).ComputedStore)((()=>{const e=co().A.state;return e.phase===co().i.willShow?0:e.estimatedKeyboardWebViewOverlap}),{debugName:"estimatedKeyboardWebViewOverlapStore"});var uo=()=>n(852477),po=()=>n(522945);function mo(){const e=(0,i().v3)();(0,o.useEffect)((()=>{function t(t){!function(e,t){(0,v().v)(e,"show_page_reload_confirmation_dialog",t)}(e,{reason:t})}return qt().showConfirmationDialogEventEmitter.addListener(t),()=>{qt().showConfirmationDialogEventEmitter.removeListener(t)}}),[e])}const fo=300;var vo=()=>n(187174),go=()=>n(165162);var ho=()=>n(250454);const bo=5e3,So=Math.random()<.01&&!0;ho().I.setShouldCollect(So);var yo=()=>n(352246);const wo=5e3;yo().t.setShouldCollect(!1);var Ao=()=>n(906537),ko=()=>n(649642);const Io=window.matchMedia("(prefers-color-scheme: dark)");var Co=()=>n(677338),_o=()=>n(196286);const xo=!1,Eo=(xo?1:10)*jn().TD,To=5*Eo;function Po(){xo&&console.log(...arguments)}function Lo(){(0,o.useEffect)((()=>{if(!window.BroadcastChannel)return;const e=(0,Co().x0)(),t=new Map,n=new BroadcastChannel("notion_tab_tracker");n.onmessage=e=>{const n=e.data;"string"==typeof n&&t.set(n,Date.now())};const o=window.setInterval((()=>{(()=>{const e=[],n=Date.now();for(const[o,r]of t.entries())n-r>To&&e.push(o);e.length&&Po("Removing tab ids:",e);for(const o of e)t.delete(o)})(),n.postMessage(e);const o=t.size+1;Po("Tab count is",o),(0,_o().g)(o)}),Eo);return()=>{n.close(),window.clearInterval(o)}}),[])}var Uo=()=>n(919878),Mo=()=>n(980914);const Ro="loadCachedPageChunk";var jo=()=>n(502800);const Bo=function(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{(0,pn().u)({environment:e,event:{eventName:"statsig_client_init_error",eventProperties:{statsig_init_method:"bootstrap"}}}),Le().log({level:"error",from:"statsig",type:"initialize",error:(0,jo().convertErrorToLog)(t),data:{userId:e.currentUser.id}})}),[e]);(0,a().l)((()=>{go().StatsigInitializer.initializePromise?go().StatsigInitializer.error?t(go().StatsigInitializer.error):go().StatsigInitializer.isComplete||t(new Error("`statsig.initialize` was not awaited on app bootstrap")):t(new Error("`statsig.initialize` was not called on app bootstrap"))}))};var Do=()=>n(386466),No=()=>n(529543);const Oo=function(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{(0,pn().u)({environment:e,event:{eventName:"statsig_client_update_user_error",eventProperties:{statsig_init_method:"bootstrap"}}}),Le().log({level:"error",from:"statsig",type:"updateUser",error:(0,jo().convertErrorToLog)(t),data:{nextUserId:e.currentUser.id,err:(0,n(319625).A)(t).message}})}),[e]),[a]=(0,vo().Yb)((async()=>await No().getExperimentDeviceId(e)),[e]),[s]=(0,vo().Yb)((async()=>await No().getBrowserId(e)),[e]),c=(0,P().K8)((()=>{var e,t;return!(null===(e=f().default.state.currentUserStore)||void 0===e||!e.isDefined())&&!(null!==(t=f().default.state.currentUserStore)&&void 0!==t&&t.getOnboardingCompleted())}),[]),l=(0,P().K8)((()=>{var e;return null===(e=f().default.state.currentSpaceStore)||void 0===e?void 0:e.isDefined()}),[]),d=(0,P().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]),u=(0,o.useRef)(go().StatsigInitializer.statsigStageTwoUser),p=(0,P().K8)((()=>{if("resolved"===a.status&&"resolved"===s.status&&(B().A.state.initialRenderCompleted||d)&&(!e.currentUser.id||l||c||d)){const o=n(546369).getDataForStatsigUser({environment:e,deviceId:a.value,browserId:s.value});if(void 0===o.subscriptionTier){var t;const e=null===(t=u.current)||void 0===t||null===(t=t.custom)||void 0===t?void 0:t.spaceSubscriptionTier;n(326215).nb.find((t=>t===e))&&(o.subscriptionTier=e)}return(0,Do().t)({data:o,config:{env:"production"}})}}),[e,a,s,l,c,d],{useDeepEqual:!0}),m=(0,o.useRef)(0),v=!(0,P().O$)(R().e),g=(0,P().K8)((()=>{var e;return null===(e=n(618743).LX.getState())||void 0===e?void 0:e.isStatsigUserDiffDebuggingEnabled}),[]);(0,o.useEffect)((()=>{!async function(){if(go().StatsigInitializer.isComplete&&p&&!Y().n4(p,u.current)&&!v){u.current=p,m.current++;try{const t=await go().statsigClientLoader.getClient()||go().statsigClientLoader.getUninitializedStatsigClient({statsigUser:p,initialValues:void 0,overrideStableID:(0,go().getOrCreateStableID)()}),o=async function(){var o,i,a,s,c,l,d,u;const m=(0,n(754704).createApiHttpJsonRequestOptions)({environment:e,eventName:"getStatsigResults",data:{...p.customIDs,device:(0,Do().getDeviceAttributesForStatsigUser)(e.device),locale:r().locale,clientSdkApiKey:w().A.statsig.apiKey,spaceId:null===(o=f().default.state.currentSpaceStore)||void 0===o?void 0:o.id,additionalUserAttributes:{spaceCreatedTime:null===(i=p.custom)||void 0===i?void 0:i.spaceCreatedTime,spaceCreatedDate:null===(a=p.custom)||void 0===a?void 0:a.spaceCreatedDate,subscriptionTier:null===(s=p.custom)||void 0===s?void 0:s.spaceSubscriptionTier,isSalesAssistedPlan:null===(c=p.custom)||void 0===c?void 0:c.isSalesAssistedPlan,spacePlanType:null===(l=p.custom)||void 0===l?void 0:l.spacePlanType,userSignupTime:null===(d=p.custom)||void 0===d?void 0:d.userSignupTime,domainType:null===(u=p.custom)||void 0===u?void 0:u.domainType}},activeUserId:e.currentUser.id,tracking:void 0,eventListeners:(0,n(459225).getPerformanceEventListeners)({eventName:"getStatsigResults",isPrefetchRequest:!0})}),v=await(0,Bn().default)(m);"success"===v.type?(t.dataAdapter.setData(JSON.stringify(v.data.initialValues)),t.updateUserSync(v.data.statsigUser)):Le().log({level:"error",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsigAndServer",data:{message:"Unable to reach statsig and fallback failed",err:(0,Bn().V)(v),nextUserId:e.currentUser.id}})},i=async function(n){t.off("initialization_failure",i),Le().log({level:"info",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsig",data:{message:"Unable to reach statsig, trying to get latest values from server.",nextUserId:e.currentUser.id}}),await o()};t.dataAdapter.getDataSync(p)?(t.on("initialization_failure",i),await t.updateUserAsync(p)):await o()}catch(o){t(o)}m.current--,0===m.current&&j().default.recomputeAllGroupStores()}}()}),[t,p,e,v,g])};var qo=()=>n(110750),zo=()=>n(628182),Wo=()=>n(584262),Ko=()=>n(243020),Fo=()=>n(427704),Vo=()=>n(179034),$o=()=>n(245241);const Go=["compact","regular","unknown"];var Ho=()=>n(671593),Jo=()=>n(638681),Zo=()=>n(328523),Yo=()=>n(95313),Qo=()=>n(518646),Xo=()=>n(324234),er=()=>n(750660),tr=()=>n(495262),nr=()=>n(867201),or=()=>n(537941),rr=()=>n(260488),ir=()=>n(778417),ar=()=>n(426116),sr=()=>n(840153),cr=()=>n(994877),lr=()=>n(453101),dr=()=>n(430483);var ur=()=>n(357307);var pr=()=>n(155959),mr=()=>n(210737);var fr=()=>n(644914);var vr=()=>n(756279),gr=()=>n(313790),hr=()=>n(595985);var br=()=>n(183558);function Sr(e){const t=(0,qo().Xz)(e);switch(t.type){case"native":return;case"web":const e=t.route;switch(e.name){case"page":return e.collectionViewId?"collection":"page";case"nativeTab":switch(e.tab){case"updates":return"updates";case"assistant":return"assistant";case"trash":return"trash";case"members":return"members";case"help":return"help";case"templates":return"templates";case"offline":return"offline_settings"}break;default:return}}}var yr=()=>n(862292),wr=()=>n(972435),Ar=()=>n(986260),kr=()=>n(372657),Ir=()=>n(836251),Cr=()=>n(780865),_r=()=>n(124749),xr=()=>n(719431),Er=()=>n(575301),Tr=()=>n(1130);const Pr={MobileNativePerformanceListener:new(A().O2)("MobileNativePerformanceListener",(async()=>await n.e(62058).then(n.bind(n,227731))))},Lr=(0,A()._h)(Pr.MobileNativePerformanceListener,(e=>e.MobileNativePerformanceListener));var Ur=()=>n(671973),Mr=()=>n(179266),Rr=()=>n(129522),jr=()=>n(106628),Br=()=>n(690978),Dr=()=>n(624307),Nr=()=>n(323914),Or=()=>n(496067),qr=()=>n(718807),zr=()=>n(524450),Wr=()=>n(518888),Kr=()=>n(732797),Fr=()=>n(529649),Vr=()=>n(933371),$r=()=>n(75368),Gr=()=>n(466872),Hr=()=>n(224701);const Jr=(0,z().YK)({failedToMovePageGeneric:{id:"MobileNativeListener.failedToMovePage",defaultMessage:"Failed to move page"}}),Zr=Y().Bj((async(e,t)=>(await jr().T.searchActions.load()).getLocalCacheFromAppState({environment:e})),((e,t)=>{var n;return`${e.currentUser.id}-${(null===(n=f().default.state.currentSpaceViewStore)||void 0===n?void 0:n.id)??"none"}-${t??"none"}`}));function Yr(e){const{mobileNative:t,TabbedRouterStore:o,device:r}=e();if(r.isMobileNative&&t){var i;t.updateReceiveApiHandlers({nativeToWebRenderStart:e=>{Ur().N.markNativeStart(e)},connectivityTypeChanged:e=>{R().A.setState({...R().A.state,mobileConnectivityType:e})},toggleAvailableOffline:t=>{const{pageId:n}=t;oe().lX({store:new(Sn().Bv)(e(),{table:Vo().ev,id:n}),environment:e(),analyticsFrom:"mobile_home"})},statusBarTap:Xr,backButtonPress:()=>dn().N6(e(),{type:"backbutton"}),getLocalizedUrl:e=>[{value:{url:(0,Ir().xS)(e.routeId)}}],keyboardWillShow:t=>{co().A.updateKeyboardPhase(e(),co().i.willShow,t??0)},keyboardDidShow:t=>{co().A.updateKeyboardPhase(e(),co().i.shown,t??0)},keyboardWillHide:()=>{co().A.updateKeyboardPhase(e(),co().i.willHide,0)},keyboardDidHide:()=>{var t;(co().A.updateKeyboardPhase(e(),co().i.hidden,0),r.isIpad)&&(ir().IU({environment:e()}),null===(t=e().NativeMobileActionBarStore)||void 0===t||t.clear(!0))},keyboardConfigChanged:e=>{co().A.updateKeyboardConfig(e.packageName,e.activeLocale)},safeAreaConfigChanged:t=>{(0,pr().T)("supportsNativeSafeAreaConfig")?(zo().U4.update((e=>({...e,supportsNativeSafeAreaConfig:!0,top:t.top,bottom:t.bottom,left:t.left,right:t.right}))),e().WindowSizeStore.updateWindowSize()):zo().U4.reset()},keyboardShortcut:t=>dn().N6(e(),t),nativeBottomBarDidChange:e=>{void 0!==e.height&&co().A.update((t=>t.lastUpdatedTimestamp&&e.timestamp&&e.timestamp<t.lastUpdatedTimestamp?t:{...t,nativeBottomBarHeight:e.height,lastUpdatedTimestamp:e.timestamp}))},pushNotificationTokenRefresh:t=>Xo().handleTokenRefresh(e(),t,"refresh"),resume:zr().A.resume,pause:async()=>{zr().A.pause();const{stopDictation:t}=await Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(43678),n.e(15019),n.e(45620),n.e(2681),n.e(70193),n.e(75814)]).then(n.bind(n,870193));await t({environment:e(),from:"native_action"})},refreshSubscriptionData:async t=>{await be().callApi({eventName:"invalidateSubscriptionData",environment:e(),data:{spaceId:t,provider:"revenue_cat"}});const n=f().default.state.currentSpaceStore;n&&await Hr().o2({environment:e(),spaceStore:n})},refreshSubscriptionDataV2:async()=>{const t=f().default.state.currentSpaceStore;t&&await Hr().o2({environment:e(),spaceStore:t})},processMobileActionBarAction:e=>{const{componentId:n,action:o}=e;t.componentEvents.dispatch("MobileActionBar",n,"onAction",{action:o})},logout:t=>{xr().logoutSingleAccount({environment:e(),userId:t,logoutOrigin:Ko().d.MobileNativeListener})},logoutV2:t=>{const{userId:n,fcmToken:o}=t;xr().logoutSingleAccount({environment:e(),userId:n,logoutOrigin:Ko().d.MobileNativeListener,fcmToken:o})},logoutAll:()=>{xr().logout(e())},openDestinationV2:t=>{mr().A.closeAll();const n=e(),o=(0,qo().Xz)(n.TabbedRouterStore.state),{activeTab:r,tabs:i}=n.TabbedRouterStore.state,a=o===i[r].rootPage,s="native"===o.type,c=a&&s;switch((0,Ir().Al)(n)&&or().s({environment:n,tab:n.TabbedRouterStore.state.activeTab,nativeRootPageOverrideEnabled:!1}),t.type){case"moveTo":!function(e,t){const n=new(Sn().Bv)(t,{table:Vo().ev,id:e});er().ho({environment:t,blocks:[n],moveToContext:"home_tab",onAccept:e=>{nr().Y({store:n,environment:t,pageVisitSource:Wo().y8.Move})}})}(t.blockId,n);break;case"trash":ni({query:t.query});break;case"webSearch":!function(e,t){rr()._N({environment:e,analyticsFrom:"mobile-bottom-bar",query:t}),Zo().Mq(e,{itemName:"search",logging_source:"mobile_native"})}(n,t.query);break;case"templates":!function(e,t){oi(e),$r().A.setState({open:!0,isFromNativeHome:!0,source:t.source})}(n,{source:t.source});break;case"AIAssistant":!function(e,t,n){Vr().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)}))),Tt().oo({environment:e,url:`${Fo().GJ.nativeTab}/assistant`,redirect:t})}(n,c,{query:t.query,searchSessionId:t.searchSessionId,from:t.from});break;case"passkeySettings":const e=`${Fo().GJ.nativeTab}/settings?addPasskey=true`;Tt().oo({environment:n,url:e,redirect:!0});break;case"createOrJoinWorkspace":return ti(n,t.userId)}},openDestination:t=>{mr().A.closeAll();const n=e();switch("closePopup"!==t&&(0,Ir().Al)(n)&&Boolean(n.TabbedRouterStore.state.tabs[n.TabbedRouterStore.state.activeTab].nativeRootPageOverrideEnabled)&&or().s({environment:n,tab:o.state.activeTab,nativeRootPageOverrideEnabled:!1}),t){case"addPage":oi(n);break;case"allUpdates":!function(e){(0,pr().T)("supportsNativeHome")&&e.device.isPhone?(Jt().TC({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),Tt().oo({environment:e,url:`${Fo().GJ.nativeTab}/updates`,redirect:!0})):Gr().A.setState({...Gr().A.state,open:!0})}(n);break;case"addAccount":Nr().c.setState({...Nr().c.state,open:!0});break;case"createOrJoinWorkspace":return ti(n);case"notificationAndSettings":Dr().A.setState({open:!0,source:Dr().C.Home});break;case"trash":ni({});break;case"memberSettings":Fr().A.setState({...Fr().A.state,open:!0});break;case"help":Kr().A.setState({...Kr().A.state,open:!0});break;case"intercom_messages":!function(e){cr().SI({environment:e,from:"help_button"})}(n);break;case"aiWriter":!function(e){Ar().hW(e)}(n)}},updateFileUploadProgress:e=>{const{uploadKey:t,progressPercent:n}=e,o=Wr().default.getKeyState(t);o&&Wr().default.setKeyState(t,{...o,progressPercent:n})},setCurrentUserId:async t=>{await ei(t,e())},setCurrentSpace:async t=>{await async function(e,t,n){const o=await sr().T({environment:n,newCurrentUserId:e}),{currentUserRootStore:r,currentUserSettingsStore:i}=f().default.state;if(!r)return;await r.load();const a=(0,xe().km)(t);a&&await ar().tR({environment:o,spaceViewStore:a,userSettingsStore:i,userRootStore:r,pageVisitSource:Wo().y8.SwitchSpace,navigationType:"switchingToOrLoadingSpace"})}(t.userId,t.spaceId,e())},updateHorizontalSizeClass:e=>{const n=(0,Ho().tf)(Jo().literals(...Go),e)?"unknown":e;n!==t.horizontalSizeClass.state&&t.horizontalSizeClass.setState(n)},updateTabbedRouterState:t=>{var n;const o=e(),{TabbedRouterStore:r}=o,i=r.state;if(t.tab!==i.activeTab||null!==(n=t.pages)&&void 0!==n&&n.length||!Y().n4(t.modal,i.modal)||i.tabs[i.activeTab].pages.length){const n=t.navigationEffect;if(n&&"AIAssistant"===n.type)Vr().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)})));or().s({environment:e(),tab:t.tab,queryParams:t.queryParams,pages:t.pages,modal:t.modal,nativeRootPageOverrideEnabled:t.nativeRootPageOverrideEnabled,navigationAction:t.navigationAction,navigationSource:t.navigationSource})}else Xr();const a=r.state;return[{state:a,topPage:(0,qo().Xz)(a),webTransitionType:Sr(a),updateId:t.updateId??(0,On().Ay)()}]},getLocalSearchResults:async t=>{const n=await Zr(e(),t.searchSessionId);if(!n)return[{error:"Local cache does not exist"}];const o=(0,Ho().tf)($o().gG,t.sort);if(o)return[{error:`old sort type is unsupported! ${o}`}];const r=t.sort,i=!R().A.state.online&&j().default.checkGate({gateName:"download_for_offline"}),a={...t.filters,isOfflineOnly:i},s=(0,Br().k)({query:{query:{text:t.query??"",filters:a,sort:r},limit:t.limit},localCachedPages:n,includeRecordMap:!1,userId:e().currentUser.id,environment:e(),spaceStore:f().default.state.currentSpaceStore}),c=[{value:{total:0,results:[],recordMap:{},trackEventProperties:void 0}}];if(!s||0===s.results.length)return c;const l=R().A.state.online?Cr().kZ(e(),s.results):s.results;return[{value:{results:l,total:l.length,recordMap:{},trackEventProperties:{}}}]},customAddCommentMenuItemTapped:async()=>{const t=await yr().T.formulas.load();(0,Ar().aI)(e(),"custom_add_comment_menu_item",t)},filterValidMoveToBlocks:t=>{const n=t.targets.map((t=>new(Sn().Bv)(e(),{table:Vo().ev,id:t}))),o=t.blocks.filter((t=>{const o=new(Sn().Bv)(e(),{table:Vo().ev,id:t});return o.canEdit()&&(0,kr().zO)(o,n)}));return[{value:{targets:t.targets,blocks:o}}]},completeMoveToTransaction:async t=>{const{targets:n,destination:o,moveToContext:r,timeToSelectMs:i,isSearchResult:a,flowId:s}=t,c=n.map((t=>new(Sn().Bv)(e(),{table:Vo().ev,id:t}))),l=er().zs(e(),n,o);if(c&&c.length>0&&!l)try{return await Kt().createAndCommitAsync({userAction:"MobileNativeListener.completeMoveTo",environment:e(),waitForServerCommit:!1,perform:async t=>{await er().Ju({targetBlocks:c,value:o,transaction:t,environment:e(),moveToContext:r,renderType:"native",timeToSelectMs:i,disableSuccessToast:!0,isSearchResult:a,flowId:s})}}),[{value:t}]}catch(d){}return Yo().qN(e(),{type:"moved_to_subpage"}),[{error:wr().A.formatMessage(Jr.failedToMovePageGeneric)}]},undoRevision:()=>{tr().tN({environment:e(),preventSelectText:!0})},searchTeams:async e=>{const{query:t}=e,n=f().default.state.currentSpaceStore,o=f().default.state.currentSpaceViewStore;if(!n||!o)return[{error:"SpaceStore or SpaceViewStore was undefined"}];const r=await jr().T.searchActions.load();return[{value:{ids:(await r.searchTeams({spaceViewStore:o,query:t,teamStores:o.getTeamsStores()})).map((e=>e.id))}}]},getImageBlockUrls:async t=>{var n;const{blockId:o,renderWidth:r}=t,i=null===(n=Rr().K.findBlockFromId(o))||void 0===n?void 0:n.getBlockStore();if(!i||"image"!==i.getType())return[{error:"blockId points to a non-image block"}];const a=i,s=(0,lr().x7)(a),c={isAuthenticated:!0,url:s,width:r,permissionRecord:a.pointer},l=e(),d=await(0,Mr().L)(c,l);if(!d)return[{error:"could not get proxied image url"}];const u=0===d.indexOf("https:")?d:`${w().A.domainBaseUrl}${d}`;let p;return Ct()._J(s)&&(p=await(0,Qo().k)(l,{url:s,download:!1,downloadName:"image",permissionRecord:a.pointer},!1,!1)),[{value:{previewUrl:u,originalUrl:p}}]}});const s=e().mobileNative;var a;if(null!=s&&null!==(i=s.api)&&void 0!==i&&i.ready)null==s||null===(a=s.api)||void 0===a||a.ready()}}function Qr(){const e=(0,i().v3)(),{device:t}=e;(0,o.useEffect)((()=>Yr((()=>e))),[e]),function(){const e=(0,i().v3)(),t=(0,P().K8)((()=>(0,ur().Y)(e)),[e]);(0,o.useEffect)((()=>{var n;null===(n=e.mobileNative)||void 0===n||n.toggleBottomBar(t)}),[e.mobileNative,t])}(),function(){const{mobileNative:e}=(0,i().v3)(),t=(0,P().K8)((()=>{const{currentUserStore:e,currentSpaceStore:t}=f().default.state;if(!e||!t)return;const n=dr().zD.isShowingQNAOnMobile();return{userId:e.id,spaceId:t.id,enabled:n,showAssistantFace:n}}),[]);(0,o.useEffect)((()=>{t&&(null==e||e.updateAiAssistantEnabledState(t))}),[e,t])}(),function(){const{mobileNative:e}=(0,i().v3)();(0,o.useEffect)((()=>{null==e||e.updateAiAssistantVisibilityState({enabled:!1})}),[e])}(),function(){const e=(0,i().v3)(),{mobileNative:t,WindowSizeStore:n}=e,r=(0,P().O$)(n),a=(0,P().K8)((()=>({visible:_n().sidebarExpandedStore.state&&!(0,fr().o1)(e),width:(0,fr().r6)(e)})),[e]);(0,o.useEffect)((()=>{null==t||t.sidebarVisibility(a.visible,a.width)}),[e,t,r,a])}(),function(){const e=(0,i().v3)(),{mobileNative:t,TabbedRouterStore:n}=e,{state:r,previousState:a}=(0,P().K8)((()=>({state:n.state,previousState:n.getPreviousState()})),[n]);(0,o.useEffect)((()=>{const n=null==t?void 0:t.api.handleTabbedRouterStateUpdate;if(n){if(n({state:r,topPage:(0,qo().Xz)(r),webTransitionType:Sr(r),updateId:(0,br().Ay)()}),!a)return;const t=(0,qo().WP)(a),o=(0,qo().WP)(r);Y().n4(t,o)||Zo().yY(e,{origin:t,destination:o,from:r.navigationSource,action:r.navigationAction,logging_source:"mobile_native"})}}),[e,t,r,a])}(),function(){const{mobileNative:e,RouterStore:t}=(0,i().v3)(),{isIOS:n}=(0,i().Y0)(),r=(0,o.useRef)(!1),a=(0,P().O$)(gr().A),s=(0,P().K8)((()=>"onboarding"===t.state.route.name),[t]);(0,o.useEffect)((()=>{n&&null!=e&&e.setWebViewAllowsNavigationGestures&&(s||_n().sidebarOpenStore.state||hr().A.getPreventScrollType()!==vr().A.None?!1!==r.current&&(r.current=!1,e.setWebViewAllowsNavigationGestures(!1)):!0!==r.current&&(r.current=!0,e.setWebViewAllowsNavigationGestures(!0)))}),[n,s,e,a])}(),function(){const{mobileNative:e,TabbedRouterStore:t}=(0,i().v3)(),n=(0,P().K8)((()=>{var e;if(!(0,pr().T)("supportsCustomAddCommentMenuItem"))return!1;const{currentUserStore:n}=f().default.state;if(!Boolean(null==n?void 0:n.id))return!1;if((0,pr().T)("supportsNativeBottomBarOverlappingWebView")?mr().A.hasOpenMobileSlideUps():mr().A.hasOpenPopups())return!1;const o=(0,qo().Xz)(t.state),r="web"===o.type&&((null===(e=o.redirectedTo)||void 0===e?void 0:e.route)||o.route);if(!r||"page"!==r.name)return!1;const i=Qt().default.state;if("empty"===i.mode)return!1;const a=(0,$t().ZS)({multiSelection:i.multiSelection,filterCommonAncestors:!0,focus:void 0});return!(!a||0===a.stores.length)&&a.stores.every((e=>e.canComment()))}),[t]);(0,o.useEffect)((()=>{(0,pr().T)("supportsCustomAddCommentMenuItem")&&(null==e||e.updateCustomAddCommentMenuItemEnabled(n))}),[e,n])}(),function(){const{mobileNative:e}=(0,i().v3)(),t=(0,P().K8)((()=>{var e;return Boolean(null===(e=yn().ei.state)||void 0===e?void 0:e.isTranscriptionBlock())}),[]);(0,o.useEffect)((()=>{null==e||e.requestKeepScreenOn(t)}),[t,e])}(),(0,Er().qh)(),(0,o.useEffect)((()=>{t.isTablet&&_n().sidebarWidthStore.setState(300)}),[t]);const n=(0,o.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.keys(e.tabs).forEach((n=>{const o=n;t&&(e.tabs[o].nativeRootPageOverrideEnabled=void 0),o!==e.activeTab?e.tabs[o].pages=[]:e.tabs[o].pages=e.tabs[o].pages.slice(-1)}))}),[]),r=(0,o.useCallback)(((t,o)=>{var r;const{mobileNative:i,TabbedRouterStore:a,currentUser:s}=e,c=f().default.state.currentSpaceStore,l=null==c?void 0:c.id;if(null!=i&&null!==(r=i.api)&&void 0!==r&&r.setCurrentSpaceInfo&&(Le().log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"Web calling nativeAPI setCurrentSpaceInfo",spaceId:l}}),i.api.setCurrentSpaceInfo({spaceId:l,spaceViewId:null==t?void 0:t.id,userId:s.id,editable:(null==c?void 0:c.canEdit())??!0})),(0,Ir().Al)(e)){const e=e=>{if("web"!==e.type)return;const t={...e.queryParams},n=l&&(0,On().Xw)(l);t.spaceId=n,e.queryParams=t,e.route.spaceId=n},t=Y().mg(a.state);e(t.tabs.updates.rootPage),e(t.tabs.addPage.rootPage),void 0!==(null==o?void 0:o.id)&&n(t),a.setState(t)}Zr(e,void 0)}),[n,e]),a=(0,o.useCallback)((t=>{var o;null!==(o=e.mobileNative)&&void 0!==o&&null!==(o=o.api)&&void 0!==o&&o.setCurrentUserInfo&&e.mobileNative.api.setCurrentUserInfo({userId:null==t?void 0:t.id,loggedInUserIds:e.currentUser.loggedInUserIds});const r=!(0,Ir().Al)(e)||void 0===e.currentUser.id,{TabbedRouterStore:i}=e,a=Y().mg(i.state);n(a,r),i.setState(a)}),[n,e]),s=(0,_r().$)(),c=(0,Z().ZC)(s);(0,o.useEffect)((()=>{(null==s?void 0:s.id)!==(null==c?void 0:c.id)&&a(s)}),[a,s,c,t.isMobileNative,e.mobileNative]);const l=(0,P().O$)(f().AppStoreCurrentSpaceViewStore),d=(0,Z().ZC)(l);(0,o.useEffect)((()=>{(null==l?void 0:l.id)!==(null==d?void 0:d.id)&&r(l,d)}),[r,l,d,t.isMobileNative,e.mobileNative]);const u=(0,ee().X)("mab_debugging");return(0,o.useEffect)((()=>{Ar().tu(u)}),[u]),(0,G.jsx)(Lr,{})}function Xr(){var e;if(hr().A.getPreventScrollType()===vr().A.None)if(_n().sidebarOpenStore.state)Ht().A.SidebarMobileScroller&&(null===(e=Ht().A.SidebarMobileScroller.getNode())||void 0===e||e.scrollTo({top:0,behavior:"auto"}));else if(Ht().A.MenuScroller){var t;null===(t=Ht().A.MenuScroller.getNode())||void 0===t||t.scrollTo({top:0,behavior:"auto"})}else if(Ht().A.MenuPageScroller){var n;null===(n=Ht().A.MenuPageScroller.getNode())||void 0===n||n.scrollTo({top:0,behavior:"auto"})}else if(Ht().A.PageScroller){var o;null===(o=Ht().A.PageScroller.getNode())||void 0===o||o.scrollTo({top:0,behavior:"auto"})}}async function ei(e,t){return t.currentUser.id===e?t:await sr().T({environment:t,newCurrentUserId:e})}async function ti(e,t){let n=e;t&&(n=await ei(t,e)),await Tr().Ig(n,"mobile_native_listener")}function ni(e){Or().A.setState({open:!0});const{query:t}=e;t&&qr().Ay.setState({...qr().Ay.state,currentTab:"all_pages",filter:t,limit:qr().Ay.startLimit})}function oi(e){(0,pr().T)("supportsNativeHome")&&e.device.isPhone?(Jt().TC({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),Cn().quickAddPage({environment:e,from:"mobile_bottom_bar",redirect:!0,quickAddParentOverride:{type:"space-private-pages"}})):Cn().quickAddPage({environment:e,from:"mobile_bottom_bar"}),Zo().Mq(e,{itemName:"add_page"})}function ri(e){const t=(0,i().v3)();(0,a().l)((()=>{const{device:e,mobileNative:n}=t;if(d().cL(t),u().fD(t),n&&n.hideSplashscreen(),w().A.isMobile){const e=document.body.parentElement;e&&e.classList.add(C().Hw6)}(0,p().E)(t),s().hR({device:e,config:w().A,cookieService:t.cookieService}),l().g5({locale:r().locale,env:"production"}),(0,c().O8)(window.location.href)})),function(){const e=(0,i().v3)(),t=(0,i().Y0)();(0,o.useEffect)((()=>{if(t.isMobileNative)return;let e;document.hasFocus()&&(e=setInterval((()=>{y()}),S),y());const n=()=>{e&&clearInterval(e),e=setInterval((()=>{y()}),S),y()},o=()=>{e&&clearInterval(e),e=void 0};return window.addEventListener("focus",n),window.addEventListener("blur",o),()=>{e&&clearInterval(e),window.removeEventListener("focus",n),window.removeEventListener("blur",o)}}),[t.isMobileNative,e])}(),function(){const e=(0,o.useRef)(!1),t=(0,i().v3)(),n=(0,o.useCallback)((async e=>{if(e.currentUser.id&&ye().fJ.size>0){const t=await be().callApi({eventName:"getTasks",environment:e,data:{taskIds:Array.from(ye().fJ.values())}});if("success"===t.type){const{results:n}=t.data,o=new Set(ye().fJ);for(const t of n)o.delete(t.id),t.status&&(0,Se().s)({environment:e,eventName:t.eventName,response:t.status,userId:e.currentUser.id}),ye().u_.emit(t.id,t),ke.emit(t.eventName,t),"failure"!==t.state&&"success"!==t.state&&"dead"!==t.state&&"timeout_before_execution"!==t.state||ye().fJ.delete(t.id);if(o.size>0)for(const e of o.values())ye().fJ.delete(e)}}}),[]),r=(0,P().K8)((()=>{var e;return null===(e=f().default.state)||void 0===e||null===(e=e.currentSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),a=(0,o.useCallback)((async e=>{if(e.currentUser.id&&r){const t=await be().callApi({eventName:"getUserTasks",environment:e,data:{spaceId:r}});if("success"===t.type){for(const e of t.data.taskIds)ye().fJ.add(e);t.data.taskIds.length>0&&n(e)}}}),[n,r]),s=(0,o.useCallback)((()=>{const n=R().A.state.online;n&&!e.current&&a(t),e.current=n}),[t,a]);function c(e){"success"===e.state?we().A.setStatus(e.request.blockId,void 0):"in_progress"===e.state||"not_started"===e.state?we().A.setStatus(e.request.blockId,e.status):we().A.setStatus(e.request.blockId,void 0)}function l(e){"success"===e.state?Ae().A.setStatus(e.request.blockId,!1):"in_progress"===e.state||"not_started"===e.state?Ae().A.setStatus(e.request.blockId,!0):Ae().A.setStatus(e.request.blockId,!1)}(0,o.useEffect)((()=>{e.current=R().A.state.online;const o=setInterval((()=>n(t)),2e3);return a(t),R().A.addListener(s),ke.addListener(he().r,c),ke.addListener(ge,l),()=>{clearInterval(o),R().A.removeListener(s),ke.removeListener(he().r,c),ke.removeListener(ge,l)}}),[t,n,s,a])}(),function(){const e=(0,i().v3)(),t=(0,o.useCallback)((()=>{Ie().uh(e)}),[e]);(0,o.useEffect)((()=>(t(),Ce().A.addListener(t),()=>{Ce().A.removeListener(t)})),[t])}(),Te(),We(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{"external"===(0,Je().parseRoute)({url:window.location.href,isMobile:Boolean(w().A.isMobile),baseUrl:w().A.domainBaseUrl,publicDomainName:w().A.publicDomainName,protocol:w().A.protocol,currentUrl:window.location.href}).name&&Be().ui({message:"Mismatch between origin and baseUrl (dev).",showCancel:!1,keepFocus:!1,items:[{label:(0,G.jsx)(z().sA,{defaultMessage:"OK",id:"notionAppContainer.dialog.mismatchedOriginURL.okayButton.label"}),onAccept:()=>{const e=Ze().pf({relativeUrl:Ze().ZO(window.location.href),baseUrl:w().A.domainBaseUrl}),t=Ze().qg(e);t.protocol=Ze().qg(window.location.href).protocol,window.location.href=Ze().GP(t)}}]})}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{Qe(e);const t=window.setInterval((()=>Qe(e)),et);return()=>window.clearInterval(t)}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{(0,tt().setEnvironment)(e)}),[e])}(),It(),Nt(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{Dn(e);const t=window.setInterval((()=>Dn(e)),jn().pT);return()=>window.clearInterval(t)}),[e])}(),zn(),function(){const e=(0,i().v3)(),t=(0,P().K8)((()=>$n().default.state.isLoaded),[]),n=(0,P().K8)((()=>$n().default.state.isLoggingEnabled),[]);(0,o.useEffect)((()=>{t&&async function(){const t=await(0,Vn().T)(e);await Fn().n_({config:w().A,isEnabled:n,deviceId:t,cookieService:e.cookieService,endpoint:$n().default.state.endpoint})}()}),[e,t,n])}(),function(){const e=(0,i().v3)(),t=(0,P().K8)((()=>Hn().getKeyboardShortcuts()),[],{useDeepEqual:!0});(0,o.useEffect)((()=>{const n=t=>{dn().N6(e,t)},o=n=>{const o=(0,Gn().a)(t),r=Y().Tj(o,((t,o)=>(0,Jn().A)(e,n,t)));r&&!{cut:!0,copy:!0,paste:!0}[r]&&dn().uj(e,n,r)};return window.addEventListener("keydown",o),window.addEventListener("cut",n),window.addEventListener("copy",n),window.addEventListener("paste",n),window.addEventListener("keypress",n),()=>{window.removeEventListener("keydown",o),window.removeEventListener("cut",n),window.removeEventListener("copy",n),window.removeEventListener("paste",n),window.removeEventListener("keypress",n)}}))}(),(0,Zn().A)(),ro(),function(){const e=(0,i().v3)(),t=(0,i().Y0)();(0,o.useEffect)((()=>{t.isElectron&&me().setLogglyData(Le().clientLogglyEnvironmentData),e.mobileNative&&e.mobileNative.setLogglyData(Le().clientLogglyEnvironmentData)}),[t.isElectron,e.mobileNative])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{io().GB({environment:e})}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{if(w().A.isMobile){function t(){ao().default.afterNextFlush((()=>{so().pS(e)}))}return Qt().default.addListener(t),lo.addListener(t),co().A.addListener(t),()=>{Qt().default.removeListener(t),lo.removeListener(t),co().A.addListener(t)}}}),[e])}(),(0,uo().A)(),(0,po().Ay)(),function(){const[{value:e}]=(0,vo().Yb)((()=>go().statsigClientLoader.getClient()),[]),t=(0,P().O$)(R().e);(0,o.useEffect)((()=>{e&&(t?e.updateRuntimeOptions({disableLogging:!1}):e.updateRuntimeOptions({disableLogging:!0}))}),[e,t])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{if(!ho().I.getShouldCollect())return;const t=setInterval((()=>{ho().I.getLongEventMetrics().forEach((t=>{(0,pn().u)({environment:e,event:t})})),ho().I.resetMetrics()}),bo);return()=>clearInterval(t)}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{if(!yo().t.getShouldCollect())return;const t=setInterval((()=>{yo().t.getMetrics().forEach((t=>{(0,pn().u)({environment:e,event:t})})),yo().t.resetMetrics()}),wo);return()=>{clearInterval(t),yo().t.resetMetrics()}}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const{mobileNative:t}=e;t&&t.enableBridgeMetricsCollection(e,ne().default,j().default)}),[e])}(),mo(),function(){const e=(0,i().v3)(),t=(0,P().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]);(0,o.useEffect)((()=>{if(t)return;let n,o=!document.hidden;function r(){e.device.isElectron||qe().A.setState({...qe().A.state,isVisible:!document.hidden});const t=!document.hidden;t!==o&&(o=t,qe().P.setState(t),clearTimeout(n),t&&(n=setTimeout((()=>{qe().P.setState(!1)}),fo)));const r=Re().K7(),i=r&&(Date.now()-r)/jn().nD>=7;if(e.device.isBrowser&&!document.hidden&&(!r||i)&&R().A.getState().online){const t=e.AppUpdateStore;if(t.isSilentUpdate()){const n=t.state.appUpdate;Re().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}}return document.addEventListener("visibilitychange",r),r(),()=>{document.removeEventListener("visibilitychange",r)}}),[e,t])}(),function(){const{WasmSqlite:e,ElectronSqlite:t}=(0,i().v3)(),n=e||t||void 0,r=(0,ee().X)("recover_from_sqlite_corruption");(0,o.useEffect)((()=>{n&&(r?n.enableCorruptionRepair():n.disableCorruptionRepair())}),[n,r])}(),function(){const{deviceType:e}=(0,i().Y0)(),t=(0,i().v3)(),n=t.currentUser.isLoggedIn();(0,o.useEffect)((()=>{if(!n)return;if("windows-desktop"!==e&&"mac-desktop"!==e)return;const o=async()=>{await me().isMainTabOrWindow()&&be().callApi({eventName:"registerDesktopApp",environment:t,data:{deviceType:e}})};o();const r=window.setInterval((()=>{o()}),5*jn().Xb);return()=>{window.clearInterval(r)}}),[n,e,t])}(),Lo(),function(){const e=(0,i().v3)(),t=(0,o.useRef)(),n=(0,o.useRef)();(0,o.useEffect)((()=>{function o(){const o=Qt().default.state,r="empty"===o.mode?void 0:o.multiSelection.start.store,i="empty"===o.mode?void 0:o.multiSelection.end.store;if(t.current===r&&n.current===i)return;if(t.current=r,n.current=i,t.current!==n.current)return;const a=Mo().wg();if(!a)return;const{rowIndex:s,columnIndex:c,simpleTableStore:l}=a.getProps();Uo().VC({environment:e,rowIndex:s,columnIndex:c,simpleTableStore:l})}return Qt().default.addListener(o),()=>{Qt().default.removeListener(o),t.current=void 0,n.current=void 0}}))}(),function(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{var n,o;const r={compressed:t.decodedBodySize!==t.encodedBodySize,local_cache_hit:0===t.transferSize,next_hop_protocol:t.nextHopProtocol,did_prefetch:"hit-match"===(null===(n=e.prefetchCache.getPrefetchAnalytic(`loadCachedPageChunk(${null===(o=f().default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.id})`))||void 0===n?void 0:n.type)},i={dns_lookup:{startTime:t.domainLookupStart,endTime:t.domainLookupEnd},connection_establish:{startTime:t.connectStart,endTime:t.connectEnd},request_queued:{startTime:t.connectEnd,endTime:t.requestStart},response_wait:{startTime:t.requestStart,endTime:t.responseStart},response_download:{startTime:t.responseStart,endTime:t.responseEnd}};ne().default.DO_NOT_USE_measureLegacy({metricName:"load_cached_page_chunk.fetch",startTime:t.fetchStart,endTime:t.responseEnd},{environment:e,data:{...r,sub_metrics:{dns_lookup:i.dns_lookup.endTime-i.dns_lookup.startTime,connection_establish:i.connection_establish.endTime-i.connection_establish.startTime,request_queued:i.request_queued.endTime-i.request_queued.startTime,response_wait:i.response_wait.endTime-i.response_wait.startTime,response_download:i.response_download.endTime-i.response_download.startTime}}});for(const[a,{startTime:s,endTime:c}]of Object.entries(i))ne().default.DO_NOT_USE_measureLegacy({metricName:`load_cached_page_chunk.fetch.${a}`,startTime:s,endTime:c},{environment:e,data:r})}),[e]);(0,o.useEffect)((()=>{const e=new PerformanceObserver((n=>{const o=n.getEntries().find((e=>e.name.includes(`${w().A.api.http}/${Ro}`)&&!e.name.endsWith("s")));o&&("resource"===o.entryType&&t(o),null==e||e.disconnect())}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[t])}(),Bo(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{const t=()=>Kt().updateConnectionState(e);return t(),R().A.addListener(t),()=>{R().A.removeListener(t)}}),[e])}(),function(){const e=(0,i().v3)();(0,o.useEffect)((()=>{e.defaultRecordCache.persistedRecordCache&&e.defaultRecordCache.persistedRecordCache.setEnvironment(e)}),[e])}(),function(){const e=(0,i().v3)(),t=(0,o.useRef)("none"),n=(0,o.useCallback)((e=>{const n=t.current;e!==n&&(t.current=e,"dragging"===e?ko().A.setState({isDragging:!0}):"dragging"===n&&ko().A.setState({isDragging:!1}))}),[]),r=(0,o.useCallback)((()=>{"none"===t.current&&n("touching")}),[n]),a=(0,o.useCallback)((()=>{n("none")}),[n]),s=(0,o.useCallback)((()=>{"touching"===t.current&&Ao().isExpanded(Ao().get())&&n("dragging")}),[n]);(0,o.useEffect)((()=>{if(e.device.isIOS)return window.addEventListener("touchstart",r),window.addEventListener("touchend",a),window.addEventListener("touchcancel",a),document.addEventListener("selectionchange",s),()=>{window.removeEventListener("touchstart",r),window.removeEventListener("touchend",a),window.removeEventListener("touchcancel",a),document.removeEventListener("selectionchange",s)}}),[e.device.isIOS,r,a,s]);const c=(0,o.useCallback)((()=>{ao().default.afterNextFlush((()=>{Xt().clearSavedSelectionXPosition()}))}),[]),l=(0,o.useCallback)((()=>{setTimeout((()=>{Ao().get()||Xt().clear({environment:e})}),0)}),[e]);(0,o.useEffect)((()=>(window.addEventListener("mousedown",c),e.device.isMobileBrowser&&document.addEventListener("focusout",l),()=>{window.removeEventListener("mousedown",c),document.removeEventListener("focusout",l)})),[e,c,l])}(),function(){const e=(0,P().O$)(fe().j),t=(0,ee().X)("simulate_offline");(0,o.useEffect)((()=>{ve("simulate_offline_set_value_in_local_storage",(()=>{t&&void 0===e&&fe().j.setState({shouldSimulateOffline:!1,lastUpdatedTime:Date.now()})}))}),[t,e]);const n=(0,P().K8)((()=>{var e;return null===(e=fe().j.state)||void 0===e?void 0:e.shouldSimulateOffline}),[]),r=(0,Z().ZC)(n);(0,o.useEffect)((()=>{ve("simulate_offline_update_electron_with_new_value",(async()=>{t&&void 0!==n&&("boolean"==typeof r&&n!==r||void 0===r&&!0===n)&&(n?await me().setNetworkEmulation({title:"Offline",requestsAllowed:"none"}):await me().setNetworkEmulation({title:"Online (No throttling)",requestsAllowed:"all",latency:0,downloadThroughput:-1,uploadThroughput:-1}))}))}),[t,n,r]),(0,o.useEffect)((()=>{}),[])}(),(0,O().o_)(),(0,J().Ay)(),de(),function(){const e=(0,i().v3)(),t=(0,D().y)(),n=(0,U().p)(),r=(0,P().O$)(f().AppStoreCurrentSpaceViewStore),a=(0,P().O$)(f().AppStoreCurrentSpaceStore),s=(0,L().T)(),c=(0,P().K8)((()=>{if(!B().A.state.initialRenderCompleted)return;if(!(n&&r&&a&&s))return;if(!t)return;if(!j().default.checkGate({gateName:"offline_cache_sidebar_images"}))return;if(!R().A.state.online)return;const e=[...n.visiblePrivatePagesStores,...n.visibleSharedPagesStores,...r.getWorkspacePages()??[],...r.getBookmarkedPages()];for(const t of n.visibleTeamsStores)e.push(...t.getTeamPagesStores());return e}),[n,r,s,a,t]);(0,o.useEffect)((()=>{const t=new AbortController;return(async()=>{if(void 0!==c){const{cacheSidebarImagesDebounced:n}=await M().W.load();await n({pageStores:c,environment:e,currentUserId:s,currentSpaceStore:a,abortSignal:t.signal})}})(),()=>{t.abort()}}),[c,s,a,e])}(),H(),function(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,o.useRef)(!1),r=(0,o.useCallback)((()=>{"system"===Ie().lv(e)&&Ce().A.emit()}),[e]),a=(0,P().K8)((()=>{var e;return null===(e=f().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.isReady()}),[]);(0,o.useLayoutEffect)((()=>{!n.current&&a&&(r(),n.current=!0)}),[a,r]),(0,o.useEffect)((()=>{if(t.isAndroid&&e.mobileNative)e.mobileNative.updateReceiveApiHandlers({themeChanged:e=>r()});else{if(Io.addEventListener&&Io.removeEventListener)return Io.addEventListener("change",r),()=>{Io.removeEventListener("change",r)};if(Io.addListener&&Io.removeListener)return Io.addListener(r),()=>{Io.removeListener(r)}}}),[t.isAndroid,e,r])}(),Oo(),(0,o.useEffect)((()=>{function e(e){}return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[!1]);const n=(0,ue().kg)();return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Qr,{}),!w().A.isMobile&&t.device.isElectron&&(0,G.jsx)(li,{}),!w().A.isMobile&&n&&(0,G.jsx)(di,{}),(0,G.jsx)(ii,{}),(0,G.jsx)(T,{}),(0,G.jsx)(I,{}),(0,G.jsx)(x,{})]})}function ii(){const e=(0,D().y)(),t="none"!==(0,N()._)();return e&&t?(0,G.jsx)(si,{}):null}const ai=new(A().O2)("usePageSubscriptionManager",(()=>n.e(25556).then(n.bind(n,245549))));function si(){const{value:e}=(0,A().fJ)(ai);return e?(0,G.jsx)(ci,{usePageSubscriptionManager:e.usePageSubscriptionManager}):null}function ci(e){return e.usePageSubscriptionManager(),null}function li(){return Rn(),null}function di(){return(0,ue().a1)(),null}},10289:(e,t,n)=>{n.d(t,{Y:()=>i});var o=()=>n(645873);const r=new(o().O2)("invoice",(async()=>await n.e(60896).then(n.bind(n,430600)))),i=(0,o()._h)(r,(e=>e.Invoice))},104077:(e,t,n)=>{n.d(t,{r:()=>r});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.79 2.35 14.41 15.68",svg:(0,n(474848).jsx)("path",{d:"M10 2.355a2.35 2.35 0 0 0-2.253 1.686 5.06 5.06 0 0 0-2.803 4.527v1.189c0 .919-.334 1.806-.939 2.498l-.818.935c-.881 1.007-.166 2.583 1.173 2.583h3.02a2.65 2.65 0 0 0 5.24 0h3.02c1.339 0 2.054-1.576 1.173-2.583l-.818-.935a3.8 3.8 0 0 1-.939-2.498v-1.19a5.06 5.06 0 0 0-2.803-4.526A2.35 2.35 0 0 0 10 2.355m1.5 13.418a1.55 1.55 0 0 1-2.998 0zM8.909 4.564A1.104 1.104 0 0 1 10 3.605c.556 0 1.017.415 1.091.96l.049.353.329.138a3.81 3.81 0 0 1 2.337 3.512v1.189c0 1.221.444 2.401 1.248 3.32l.818.936a.307.307 0 0 1-.232.51H4.36a.308.308 0 0 1-.232-.51l.818-.935a5.04 5.04 0 0 0 1.248-3.321v-1.19c0-1.58.963-2.936 2.337-3.511l.33-.138z"})},r=(0,n(340498).wt)("bell",o)},105819:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,pencilLineIcon:()=>r});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.63 4.12 14.99 11.76",svg:(0,n(474848).jsx)("path",{d:"m13.987 5.682-.684.684-1.288-1.288.692-.691a.91.91 0 0 1 1.28 0c.35.35.35.93 0 1.28zm-9.433 9.433 7.914-7.914-1.289-1.289-7.92 7.908c-.122.122-.214.29-.274.457l-.336 1.082c-.06.229.153.442.366.366l1.082-.335q.252-.07.457-.275m12.446.76H5.61l1.25-1.25H17a.625.625 0 1 1 0 1.25"})},r=(0,n(340498).wt)("pencilLine",o)},124749:(e,t,n)=>{n.d(t,{$:()=>i});var o=()=>n(56366);const r=new(n(496506).ComputedStore)((()=>n(765957).default.state.currentUserStore),{debugName:"AppStoreCurrentUserStore"});function i(){return(0,o().O$)(r)}},135985:(e,t,n)=>{n.d(t,{AK:()=>l,Em:()=>u,Ns:()=>d});var o=()=>n(179034),r=()=>n(969197),i=()=>n(129522),a=()=>n(695625),s=()=>n(765957),c=()=>n(148832);function l(e){var t;const n=null===(t=i().K.findBlockFromId(e))||void 0===t?void 0:t.getBlockStore();if(n)return n;const r=s().default.state.currentSpaceStore;return r?c().B.createChildStore(r,{id:e,table:o().ev}):void 0}function d(e){return{start:{blockStoreId:e.start.store.id,index:e.start.index},end:{blockStoreId:e.end.store.id,index:e.end.index}}}function u(e){const t=e.start.blockStoreId,n=e.end.blockStoreId,[o,i]=a().T.findSelectablesFromIds([t,n]),s=(null==o?void 0:o.props.store)&&(0,r().aI)(null==o?void 0:o.props.store),c=t===n?s:(null==i?void 0:i.props.store)&&(0,r().aI)(null==i?void 0:i.props.store);if(s&&c)return{start:{store:s,index:e.start.index},end:{store:c,index:e.end.index}}}},137493:(e,t,n)=>{n.d(t,{j:()=>o});const o=new(n(178624).R)({key:"SimulateOffline",namespace:"Offline",important:!0,trackingType:"necessary"})},149257:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(296540),r=()=>n(959013),i=n(474848);const a=(0,r().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const s=function(e){const{teamStore:t,teamName:s,teamId:c,isModalOpen:l,onDismiss:d}=e,[u,p]=(0,o.useState)(""),m=(0,n(484714).v3)(),f=(0,r().tz)(),v=async()=>{await n(350648).Ip({environment:m,teamId:c,message:u}),d()},g=(0,n(401497).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,i.jsx)(n(676007).a,{open:l,onDismiss:d,innerStyle:g.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:g.requestTitle,children:(0,i.jsx)(r().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:s,icon:(0,i.jsx)(n(898808).x,{style:g.icon,store:t,disabled:!0,size:22})}})}),(0,i.jsx)(n(623580).A,{textarea:!0,style:g.input,value:u,onChange:e=>{p(e.target.value)},placeholder:f.formatMessage(a.message_placeholder)}),(0,i.jsxs)("div",{style:g.footer,children:[(0,i.jsx)(n(125565).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,i.jsx)(r().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,i.jsx)(n(204063).A,{size:"lg",style:g.requestInvitesButton,onClick:v,children:(0,i.jsx)(r().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},171510:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>b});n(898992),n(354520);var o=n(296540),r=()=>n(484714),i=()=>n(56366);const a="initial_handshake";var s=()=>n(798880),c=()=>n(959013),l=()=>n(496603),d=()=>n(763824),u=()=>n(498212),p=()=>n(780054),m=()=>n(630116),f=()=>n(179534),v=()=>n(214006),g=n(474848);const h=1;function b(){const e=(0,r().v3)(),t=(0,c().tz)(),n=`${p().A.identity.domainBaseUrl}/authSync`,b=e.currentUser.isLoggedIn(),[S,y]=(0,o.useState)(null),[w,A]=(0,o.useState)({value:!1,count:0}),k=(0,i().K8)((()=>f().A.getTotalUnreadMentionsCount()),[]),I=(0,i().K8)((()=>v().A.getAllSpaceViewStores(e)),[e]);(0,o.useEffect)((()=>{const e=t=>{const n=p().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(y(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,o.useEffect)((()=>{b&&(w.value||0===w.count||null==S||S.postMessage({version:h,name:"unreadCount",source:"notion",unreadCount:k}))}),[b,w.count,w.value,S,k]);const C=(0,o.useCallback)((async()=>{const e=l().hS(I,"userId"),n=await(0,d().lX)(e,10,(async e=>{if(!e.userId)return;const n=m().LU.createChildStore(e,{table:s().oo,id:e.userId});await n.load();const o=n.getEmail()??"",r=n.getDisplayName(t)??"";return{id:e.userId,displayName:r,emailAddress:o}}));null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,S,I]);(0,o.useEffect)((()=>{b&&S&&(w.value||0===w.count)&&C()}),[b,C,w.count,w.value,S]),(0,o.useEffect)((()=>{e.currentUser.id&&!(0,u().uj)(e.currentUser.id)||null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id?e.currentUser.id:"",type:"mutation"})}),[e.currentUser.id,S]),(0,o.useEffect)((()=>{b||(null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"}),null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:[],persistCookie:!0}))}),[b,S]);const _=(0,o.useCallback)((e=>{if(e.data.version!==h)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)A((e=>({value:!0,count:e.count+1})))}),[]);return(0,o.useEffect)((()=>(y((e=>(e&&(e.onmessage=_),e))),()=>{y((e=>(e&&(e.onmessage=null),e)))})),[_,S]),(0,g.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(a,p().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},205338:(e,t,n)=>{var o=n(440961);t.createRoot=o.createRoot,t.hydrateRoot=o.hydrateRoot},207207:(e,t,n)=>{n.d(t,{J:()=>r});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.62 2.62 15.26 15.26",svg:(0,n(474848).jsx)("path",{d:"M8.875 2.625a6.25 6.25 0 1 0 3.955 11.09l3.983 3.982a.625.625 0 1 0 .884-.884l-3.983-3.982a6.25 6.25 0 0 0-4.84-10.205m-5 6.25a5 5 0 1 1 10 0 5 5 0 0 1-10 0"})},r=(0,n(340498).wt)("magnifyingGlass",o)},245500:(e,t,n)=>{var o=()=>n(645873);const r={WorkflowTemplatesBuilderNotInProd:new(o().O2)("WorkflowTemplateBuilderNotInProd",(async()=>await Promise.all([n.e(92845),n.e(48486),n.e(46414),n.e(65881),n.e(94611)]).then(n.bind(n,228474)))),CollectionItemNameConfigMenuItemNotInProd:new(o().O2)("CollectionItemNameConfigMenuItemNotInProd",(async()=>await n.e(12062).then(n.bind(n,120364))))};(0,o()._h)(r.WorkflowTemplatesBuilderNotInProd,(e=>e.WorkflowTemplatesBuilderNotInProd)),(0,o()._h)(r.CollectionItemNameConfigMenuItemNotInProd,(e=>e.CollectionItemNameConfigMenuItemNotInProd))},253849:(e,t,n)=>{n.d(t,{S:()=>i});var o=()=>n(645873);const r=new(o().O2)("AppComponents",(async()=>Promise.all([n.e(75134),n.e(9304),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(62475),n.e(3151),n.e(98629),n.e(49889),n.e(97727),n.e(22900),n.e(85128),n.e(95555),n.e(14659),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(93282),n.e(43678),n.e(15019),n.e(90978),n.e(3910),n.e(77213),n.e(6912),n.e(21194),n.e(30291),n.e(39541),n.e(12913),n.e(45620),n.e(54220),n.e(19930),n.e(81768),n.e(58102),n.e(52836),n.e(26483),n.e(19687),n.e(6463),n.e(68137),n.e(50569),n.e(40925),n.e(24975),n.e(282),n.e(87250),n.e(93847),n.e(79928),n.e(7203),n.e(61349),n.e(55197),n.e(94256),n.e(76690),n.e(29669),n.e(24930),n.e(62573),n.e(33882),n.e(44763),n.e(1440),n.e(5044),n.e(31782),n.e(93449),n.e(63996),n.e(895),n.e(66559),n.e(35986),n.e(45683),n.e(78862),n.e(38536),n.e(92924),n.e(64819),n.e(67378),n.e(40186),n.e(97339),n.e(55717),n.e(63797),n.e(56352),n.e(52811),n.e(28398),n.e(21367),n.e(65351),n.e(22686),n.e(4112),n.e(31889),n.e(36009),n.e(81973),n.e(2600),n.e(77663),n.e(97832),n.e(75681)]).then(n.bind(n,887539)))),i=(0,o()._h)(r,(e=>e.AppComponents))},276324:(e,t,n)=>{n.r(t),n.d(t,{mainApp:()=>o});n(16280);async function o(e){const{minimalEnvironment:t,mainStartTime:o,prefetchInitiatedTime:r,prefetchCache:i,initializeStatsigResult:a,currentUserId:s}=e,{device:c}=t,[{setupOnBeforeUnload:l},d,{createClientEnvironment:u},{setupTransactionQueue:p},{default:m},f]=await Promise.all([Promise.resolve().then(n.bind(n,840125)),Promise.resolve().then(n.bind(n,857639)),Promise.resolve().then(n.bind(n,436026)),Promise.resolve().then(n.bind(n,589994)),Promise.resolve().then(n.bind(n,518888)),Promise.resolve().then(n.bind(n,907828))]);let v=await u({minimalEnvironment:t,prefetchCache:i,currentUserId:s});const{ElectronSqlite:g,RouterStore:h}=v;f.setupRecordCacheDebugging(c);const b=await p(v);l({device:c,TransactionQueue:b,AppUpdateStore:v.AppUpdateStore,GlobalFileUploadStore:m});const[S,{default:y}]=await Promise.all([Promise.resolve().then(n.bind(n,652393)),Promise.resolve().then(n.bind(n,406792))]);if(S.initialize(v),c.isMobileNative){const e=y.DO_NOT_USE_markLegacy("mobilenative.initialize_from_js"),[t,o,r]=await Promise.all([Promise.resolve().then(n.bind(n,324234)),Promise.resolve().then(n.bind(n,475133)),Promise.resolve().then(n.bind(n,79059))]);await t.initializeMobileNativeApp(v),Object.assign(d.clientLogglyEnvironmentData,o.getMobileNativeDeviceInfo(),r.getMobileNativeSessionInfo()),y.DO_NOT_USE_measureLegacy(e,{environment:v,data:{}})}if(c.isElectron){const e=y.mark("desktop.initialize_from_js"),t=await Promise.resolve().then(n.bind(n,874913));await t.initializeElectron({device:c,electronSqlite:g,routerStore:h});const o=await Promise.resolve().then(n.bind(n,250182)),r=await o.getDesktopDeviceInfo();Object.assign(d.clientLogglyEnvironmentData,r,{desktopVersion:c.desktopAppVersion}),y.measure(e,{environment:v})}const[w,A,k,I,C,_]=await Promise.all([Promise.resolve().then(n.bind(n,719431)),Promise.resolve().then(n.bind(n,869562)),Promise.resolve().then(n.bind(n,906537)),Promise.resolve().then(n.bind(n,604643)),Promise.resolve().then(n.bind(n,751156)),Promise.resolve().then(n.bind(n,344300))]),{setupTransactionLoadGenerator:x}=await Promise.resolve().then(n.bind(n,993893));x(v);const[{AppRoot:E},T,P,L,{CurrentUser:U},{getGhostAdminUserId:M},{default:R}]=await Promise.all([Promise.resolve().then(n.bind(n,607783)),Promise.resolve().then(n.t.bind(n,296540,19)),Promise.resolve().then(n.t.bind(n,440961,19)),Promise.resolve().then(n.t.bind(n,205338,19)),Promise.resolve().then(n.bind(n,590966)),Promise.resolve().then(n.bind(n,529543)),Promise.resolve().then(n.bind(n,217429))]);k.startListeners(c),v=await w.initialize(v),v.currentUser.id&&v.defaultRecordCache.persistedRecordCache&&_.readAndCacheOfflinePagesMemo({userId:v.currentUser.id,persistedRecordCache:v.defaultRecordCache.persistedRecordCache,tellOtherTabsToUpdate:!1}),v.updateCurrentUserId=async e=>{const t=await M(v),n={...e.environment,currentUser:new U({id:e.currentUserId,loggedInUserIds:e.userIds,adminUserId:t})};await Q(n),n.idCreator.updateCurrentUserId(e.currentUserId)},I.initialize(v),b.startLoop();const[{refreshNotionCookies:j,validateHasPermissionArgs:B,clearNotionCookiesWithNoPermission:D,clearThirdPartyCookiesAndLocalStorageWithNoPermission:N},{clearNotionLocalStorageWithNoPermission:O},q,z,W,K,{default:F},V]=await Promise.all([Promise.resolve().then(n.bind(n,529543)),Promise.resolve().then(n.bind(n,422920)),Promise.resolve().then(n.bind(n,14307)),Promise.resolve().then(n.bind(n,915086)),Promise.resolve().then(n.bind(n,410690)),Promise.resolve().then(n.bind(n,807054)),Promise.resolve().then(n.bind(n,567417)),Promise.resolve().then(n.bind(n,842677))]);Promise.all([D(v),N(v)]).then((()=>j(v))),O(),B(v);const[{TransactionQueueDependenciesImpl:$},{waitForStatsigInitialization:G},{isPrewarmedTabInitialRender:H},J]=await Promise.all([Promise.resolve().then(n.bind(n,866184)),Promise.resolve().then(n.bind(n,546369)),Promise.resolve().then(n.bind(n,807054)),Promise.resolve().then(n.bind(n,724368))]);let Z,Y;async function Q(e){const t=performance.now(),{didStatsigBootupTimeout:n}=await G({environment:v,initializeStatsigResult:a});Z??=R.checkGate({gateName:"react_18_concurrent_rendering"});const i=performance.now(),s=document.querySelector("#notion-app");if(!s)throw new Error('Could not find element with id "notion-app"');b.updateDependencies(new $(e)),C.updateConnectionState(e),q.updateEnvironment(e),d.clientLogglyEnvironmentData.userId=e.currentUser.id;const c=()=>{const e=document.getElementById("initial-loading-spinner"),a=document.getElementById("skeleton");e&&e.remove(),a&&a.remove();const s=performance.now();z.setSubMetricsAtRenderCallback({mainStartTime:o,prefetchInitiatedTime:r,statsigBootupBlockingStartTime:t,renderStartTime:i,renderEndTime:s});const c=W.getAppStartTime();c&&y.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_app_start",startTime:0,endTime:c},{environment:v,data:{sub_metrics:K.getTimeOriginToAppStartSubMetrics()}}),y.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_prefetch_initiated",startTime:0,endTime:r},{environment:v}),F.state&&y.measure({metricName:"client.migrate_sqlite",startTime:F.state.startTime,endTime:F.state.endTime},{environment:v}),y.measure({metricName:"statsig_bootup_blocking",startTime:t,endTime:i},{environment:v,data:{timed_out:n,is_prewarmed_tab:H(v)}})},l=T.createElement(E,{environment:e,onMount:Z?c:void 0});Z?(Y??=L.createRoot(s),Y.render(l)):P.render(l,s,c)}J.initializeKeyboardShortcutsStore(v),A.initialize(v),await Q(v);const{startFlushing:X}=await Promise.resolve().then(n.bind(n,459225));return X(((e,t)=>{y.measure(e,{environment:v,preboot:!0,shouldSendIfStatsigNotInitialized:!0,shouldExcludeFromTimeline:!0,data:t})})),{transactionQueue:b,environment:v}}},291606:(e,t,n)=>{n.d(t,{AC:()=>i,dE:()=>s,Nw:()=>c,tn:()=>a});var o=()=>n(2220);const r=new(n(178624).R)({key:"offline_autosync_setting",namespace:n(419494).cd,important:!0,trackingType:"necessary"});function i(){return"on"===r.getState()}function a(e){let{environment:t}=e;const n=i()?"off":"on";(0,o().u)({environment:t,event:{eventName:"offline_autosyncing_toggled",eventProperties:{toggle_status:n}}}),r.setState(n)}function s(){return r.getState()}function c(e){r.setState(e)}},309770:(e,t,n)=>{n.d(t,{P:()=>m,U:()=>p});var o=()=>n(56366),r=()=>n(231722),i=()=>n(792002),a=()=>n(301421),s=()=>n(765957),c=()=>n(24157),l=()=>n(751156),d=()=>n(755199);function u(){const e=c().default.state;if("editing"===e.mode){const t=(0,r().H7)(e.multiSelection);if(t&&(0,i().gE)(t.selection)){const e=t.store,n=a().n.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function p(){return(0,o().K8)(u,[])}function m(e){const{currentUserSettingsStore:t}=s().default.state;t&&l().createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{d().mJ({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},canUndo:!0,userId:t.id})}},313633:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var o=()=>n(401497),r=()=>n(66913),i=()=>n(197190),a=n(474848);function s(e){const{top:t,right:n,onClick:s}=e,c=(0,o().IS)((e=>({buttonBackground:{position:"absolute",top:t??12,right:n??12,width:22,height:22,borderRadius:"100%",background:e.buttonBackground},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},buttonHovered:{background:e.buttonHoveredBackground},icon:{width:14,fill:e.icon.secondary}})),[t,n]);return(0,a.jsx)("div",{style:c.buttonBackground,children:(0,a.jsx)(i().A,{style:c.button,hoveredStyle:c.buttonHovered,onClick:s,children:(0,r().V)(c.icon)})})}},323914:(e,t,n)=>{n.d(t,{c:()=>i,y:()=>r});var o=()=>n(463830);const r=new(o().A),i=new(o().A)},350648:(e,t,n)=>{n.d(t,{D2:()=>I,Ip:()=>w,Jk:()=>A,YT:()=>k,e2:()=>S,g:()=>y});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520);var o=()=>n(584262),r=()=>n(798880),i=()=>n(946141),a=()=>n(449506),s=()=>n(246826),c=()=>n(436572),l=()=>n(426116),d=()=>n(751156),u=()=>n(972435),p=()=>n(640653),m=()=>n(37433),f=()=>n(765957),v=()=>n(999830),g=()=>n(848237),h=()=>n(263928);const b=(0,n(959013).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function S(e){let{environment:t,userId:n,teamStore:o,user:r}=e;const a=o.getSpaceId();if(!a)return;await g().rU({environment:t,teamId:o.id,spaceId:a,teamUserInfo:r,isSettingDefaultTeam:!1,inviterId:n})&&(i().vo(t,{store:o,joined_role:"member",from:"team_invite_link"}),await y({environment:t,userId:n,teamStore:o}),c().D6({label:u().A.formatMessage(b.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function y(e){let{environment:t,userId:n,teamStore:r}=e;const i=f().default.state.currentUserRootStore,a=r.getSpaceId();if(!a||!i)return;const s=i.getSpaceViewStores().filter((e=>e.getSpaceId()===a))[0];await l().tR({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:i,pageVisitSource:o().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),(0,m().Qn)()?v().q.fetchUnfetchedTeams({userId:n,spaceId:a,teamTypes:new Set(["Joined"]),environment:t,callGetTeamsV2ApiFn:m().FK}):await h().J({environment:t,spaceId:a,userId:n}),g().L0({environment:t,teamStore:r,shouldScroll:!0})}async function w(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await a().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:o}})).type?(i().XQ(t,{teamId:n}),await k({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{c().D6({label:u().A.formatMessage(b.requestTeamSuccessMessage)})}))):c().D6({label:u().A.formatMessage(b.requestTeamFailureMessage)})}async function A(e){let{environment:t,teamStore:n,accessRequestStore:o,status:a}=e;const c=o.getForActorId();if(!c)return;const l=o.getRecordModel({table:r().oo,id:c});if(l){if("approved"===a){const e=[{type:"member",entity_type:"user",user_id:l.id}];if(!(await g().Zd({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}d().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().zv({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:r().oo,resolved_by_id:t.currentUser.id,status:a}})}}),i().GW(t,{store:n,resolution:a})}}async function k(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:r,userSettingsStore:i}=await(0,p().ex)({environment:t,disableRedirectUrl:!1});n?await l().tR({environment:t,spaceViewStore:n,userRootStore:r,userSettingsStore:i,pageVisitSource:o().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await l().t9({environment:t,userRootStore:r,userSettingsStore:i,pageVisitSource:o().y8.BackForward})}async function I(e){let{environment:t,teamId:n}=e;const o=await a().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===o.type)return o.data}},406533:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>r,questionMarkCircleIcon:()=>i});n(296540);var o=n(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.26 15.25",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M9.978 7.154c-.804 0-1.333.456-1.438.874a.625.625 0 0 1-1.213-.303c.28-1.121 1.44-1.82 2.65-1.82 1.365 0 2.714.905 2.714 2.298 0 .812-.49 1.477-1.13 1.872l-.755.516a.84.84 0 0 0-.381.677.625.625 0 1 1-1.25 0c0-.688.36-1.318.921-1.706l.003-.002.784-.535.014-.008c.374-.228.544-.537.544-.814 0-.459-.517-1.049-1.463-1.049m.662 6.336a.8.8 0 1 1-1.6 0 .8.8 0 0 1 1.6 0"}),(0,o.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0M10 3.625a6.375 6.375 0 1 0 0 12.75 6.375 6.375 0 0 0 0-12.75"})]})},i=(0,n(340498).wt)("questionMarkCircle",r)},422920:(e,t,n)=>{n.r(t),n.d(t,{clearNotionLocalStorageWithNoPermission:()=>i});var o=()=>n(901801),r=()=>n(948450);function i(){o().A.removeAllIfNoPermission(),r().A.removeAllIfNoPermission()}},436026:(e,t,n)=>{n.r(t),n.d(t,{createClientEnvironment:()=>se});var o=()=>n(221844),r=()=>n(711740),i=()=>n(590966),a=()=>n(396487),s=()=>n(814865),c=()=>n(609990),l=()=>n(299972),d=()=>n(110750),u=()=>n(721338),p=()=>n(138418),m=()=>n(628182),f=()=>n(874913),v=()=>n(851650);class g extends(()=>n(573442))().K{constructor(e){super({...e,mapSpaceIdToShortId:t=>e.mapSpaceIdToShortId(this.currentUserId,t)}),this.currentUserId=void 0,this.currentUserId=e.currentUserId}updateCurrentUserId(e){this.currentUserId=e}}var h=()=>n(529543),b=()=>n(520348),S=()=>n(245865),y=()=>n(165162),w=(n(16280),n(944114),n(898992),n(430670),n(803949),n(581454),()=>n(857639)),A=()=>n(388821),k=()=>n(179034),I=()=>n(651170),C=()=>n(445120),_=()=>n(15601),x=()=>n(496603),E=()=>n(502800),T=()=>n(2220);function P(e){const{environment:t,eventName:o,eventProperties:r,opts:i}=e;(0,n(679924).v)(t,o,r,{...i,sampling:(null==i?void 0:i.sampling)||{behavior:"statsig",fallbackBehavior:"statsig",statsigNotAvailableBehavior:"drop"}})}var L=()=>n(406792);let U=1;class M{constructor(e){this.connection=void 0,this.maxSize=void 0,this.getEnvironment=void 0,this.getLatency=new(n(293596).B),this.batchReadWorkers=15,this.queuedGetErrors=[],this.pendingWrites=A().RecordMapPolymorphic.create(),this.getManyFromDisk=async e=>{const t=A().RecordMapPolymorphic.create();e.forEach(((e,n)=>{let{pointer:o}=e;t.set(o,n)}));const n=await _().tB(this.connection,e),o=A().RecordMapPolymorphic.create();for(const r of n)this.setCachedRecordMap(o,r);return e.map((e=>{let{pointer:t,userId:n}=e;const r=this.getInMemory(t,n);if(r)return r;const i=o.get(t);return i&&i[n]}))},this.diskReadQueue=new(n(56322).A)({batchSize:Math.floor(n(430476).Zj/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=A().RecordMapPolymorphic.create();const t=Array.from(e).flatMap((e=>{let{value:t}=e;return t?Object.values(t):[]})),o=L().default.DO_NOT_USE_markLegacy("sqlite_record_cache.flush_writes.duration");try{await _()._D(this.connection,t);const e={status:"success"};P({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),L().default.DO_NOT_USE_measureLegacy(o,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}catch(r){w().log({level:"warning",from:"SqliteRecordCache",type:"applyRecordCacheOperationsError",error:(0,E().convertErrorToLog)(r),data:(0,I().CS)(r,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error"};P({environment:this.getEnvironment(),eventName:"sqlite_record_cache.flush_writes",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),L().default.DO_NOT_USE_measureLegacy(o,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0})}n(217429).default.checkGate({gateName:"download_for_offline"})||navigator.locks.request("sqliteRecordCacheEviction",{mode:"exclusive",ifAvailable:!0},(async e=>{if(!e)return;const t=await this.getTablesThatNeedEviction();if(0===t.length)return;const o=await(0,n(97059).w)({environment:this.getEnvironment()});await this.evictTables({tables:t,offlineRecordIds:o})}))},this.debouncedFlushWrites=x().sg(this.flushWrites,500,{maxWait:3e3}),this.throttledLogGetErrorBatched=x().nF(this.logGetErrorBatched,3e3,{leading:!1,trailing:!0}),this.connection=e.connection,this.maxSize=e.maxSize,this.getEnvironment=e.getEnvironment}getDedicatedWorkerConnection_DEBUG_ONLY(){var e,t;return null===(e=(t=this.connection).getDedicatedWorkerConnection_DEBUG_ONLY)||void 0===e?void 0:e.call(t)}set(e){const{pointer:t,value:o,importance:r,maybeStaleRecordMap:i}=e;if(void 0===t||void 0===t.id){const e=new Error("Attempting to set a record with an invalid pointer.");return w().log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:e.stack},data:{pointer:t}}),void n(449412).Fg(e)}const a=e.userId||C().m,s={pointer:t,userId:a,value:o,timestamp:Date.now(),importance:r};this.removePendingWrite(t,a,"delete"),this.enqueueWrite({type:"set",record:s,maybeStaleRecord:i})}async get(e){const{pointer:t,skipAccessWrites:n}=e,o=`get ${U}`,r=e.userId||C().m;let i;U++,this.getLatency.start(o);try{const e=this.getInMemory(t,r);if(e)return n||this.enqueueWrite({type:"access",record:e}),this.getLatency.end(o,"memory"),e.value;i=L().default.DO_NOT_USE_markLegacy("sqlite_record_cache.get_record.duration");const a=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:t,userId:r}):this.getFromDiskUnbatched(t,r));if(a){n||this.enqueueWrite({type:"access",record:a}),this.getLatency.end(o,"disk");const e={status:"success"};return P({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),L().default.DO_NOT_USE_measureLegacy(i,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}),a.value}}catch(a){if(a instanceof I().PW||a instanceof I().lh){this.queuedGetErrors.push(a),this.throttledLogGetErrorBatched();(0,y().localUserOnlyGateCheck)({gateName:"recover_from_sqlite_corruption"})||this.getEnvironment().defaultRecordCache.disablePersistedRecordCache()}else w().log({level:"warning",from:"SqliteRecordCache",type:"getError",error:(0,E().convertErrorToLog)(a),data:(0,I().CS)(a,{isBrowser:this.getEnvironment().device.isBrowser})},{forceSuppressConsoleLog:!0});const e={status:"error",sqlite_code:(0,I().xY)(a)?a.debugInfo.sqliteCode:void 0};return P({environment:this.getEnvironment(),eventName:"sqlite_record_cache.get_record",eventProperties:e,opts:{preboot:!0,sampling:{behavior:"statsig",fallbackBehavior:"custom",fallbackSampleRate:0}}}),void(i&&L().default.DO_NOT_USE_measureLegacy(i,{environment:this.getEnvironment(),data:e,shouldExcludeFromTimeline:!0}))}finally{this.getLatency.end(o,"miss")}}deleteRecord(e,t){t=t||C().m,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}async getBlocksWithParent(e){const t=Date.now(),n=e.userId||C().m,o=await _().rH(this.connection,{...e,timestamp:t,userId:n}),r=A().RecordMapPolymorphic.create(),i=x().oE(Array.from(this.pendingWrites).map((o=>{const i=o&&o.value&&n&&o.value[n];if(!i||"set"!==i.type)return;const a=i.record.value?i.record.value.value:void 0;if(!a)return;if(i.record.pointer.table!==k().ev)return;const s=a;return s.parent_id===e.parent.id&&s.parent_table===e.parent.table?(r.set(i.record.pointer,!0),i.record.timestamp<t&&(i.record.timestamp=t),i.record.value):void 0})));for(const a of o)r.get(a.pointer)||this.getInMemory(a.pointer,a.userId)||i.push(a.value);return i}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||C().m,o=await _().NJ(this.connection,{...e,timestamp:t,userId:n});return o.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),o}async getOfflinePages(e){const{userId:t,orderBy:n}=e;return await _().W9({connection:this.connection,userId:t,orderBy:n})}async getOfflineAutosyncedOrigins(e){const{userId:t}=e;return await _().M2({connection:this.connection,userId:t})}async getOfflineCollectionViewBlocksForRefetch(e){const{userId:t,limit:n}=e;return await _().PK({connection:this.connection,userId:t,limit:n})}async getAllOfflineActions(e){const{userId:t}=e;return await _().Mv({connection:this.connection,userId:t})}async getOfflineActions(e){const{impactedPageId:t,userId:n}=e;return await _().Pf({connection:this.connection,impactedPageId:t,userId:n})}async getOfflinePageMetadata(e){return await _().cz({userId:e.userId,pageId:e.pageId,connection:this.connection})}async isOnlyOfflineFromAnotherCollectionViewBlock(e){const{pageId:t,userId:n}=e;return await _().RM({connection:this.connection,pageId:t,userId:n})}async deleteOfflineActionsAndCleanUp(e){const{userId:t,impactedPageIds:n,originPageId:o}=e;await _().JP({connection:this.connection,userId:t,originPageId:o,impactedPageIds:n})}async addOfflinePageAndOfflineAction(e){const{userId:t,originPageIds:n,fromPageId:o,impactedPageId:r,autosyncTypes:i,downloadStatus:a}=e;await _().OR({connection:this.connection,userId:t,originPageIds:n,fromPageId:o,impactedPageId:r,autosyncTypes:i,downloadStatus:a})}async updateOfflinePageLastDownloadedMetadata(e){const{pageId:t,userId:n,lastDownloadedAt:o,lastDownloadedVersion:r,lastDownloadedRecordChangeTimestamp:i}=e;await _().qM({connection:this.connection,pageId:t,userId:n,lastDownloadedAt:o,lastDownloadedVersion:r,lastDownloadedRecordChangeTimestamp:i})}async getTeams(e){const{spaceId:t,userId:n,includeArchived:o=!1}=e;return await _().ZN({connection:this.connection,spaceId:t,userId:n,includeArchived:o})}async deleteOfflineActionsWithOriginPageIdAndCleanUp(e){const{originPageId:t,userId:n,autosyncType:o}=e;return await _().Li({connection:this.connection,originPageId:t,userId:n,autosyncType:o})}async removeAllOfflineAutosyncedOrigins(e){const{userId:t}=e;return await _().zv({connection:this.connection,userId:t})}async garbageCollectInlineCollections(e){const{userId:t,originPageIds:n,fromPageId:o,keepInlineCollectionViewBlockIds:r}=e;return await _().eA({connection:this.connection,userId:t,originPageIds:n,fromPageId:o,keepInlineCollectionViewBlockIds:r})}async garbageCollectCollectionPages(e){const{userId:t,fromPageId:n,keepBlockIds:o}=e;return await _().Qo({connection:this.connection,userId:t,fromPageId:n,keepBlockIds:o})}async getInlineCollectionsInOfflinePage(e){const{pageId:t,userId:n}=e;return _().ew({connection:this.connection,pageId:t,userId:n})}async setPageDownloadStatus(e){const{pageId:t,userId:n,downloadStatus:o}=e;await _().g8({connection:this.connection,pageId:t,userId:n,downloadStatus:o})}async updateOfflineMetadataLastExecutedAt(e){const{userId:t,taskType:n,lastExecutedAt:o}=e;await _().I6({connection:this.connection,userId:t,taskType:n,lastExecutedAt:o})}async getOfflineMetadataLastExecutedAt(e){const{userId:t,taskType:n}=e;return await _().TI({connection:this.connection,userId:t,taskType:n})}async reset(){this.pendingWrites=A().RecordMapPolymorphic.create(),await _().tV(this.connection)}async deleteAllRecordTables(){try{await _().ry(this.connection),await _().lg(this.connection),await _().Wr(this.connection)}catch(e){w().log({level:"error",from:"SqliteRecordCache",type:"deleteAllRecordTablesError",error:(0,E().convertErrorToLog)(e)})}}setEnvironment(e){this.getEnvironment=()=>e}async flushPendingWrites(){await this.flushWrites()}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,o=this.pendingWrites.get(t),r=o&&o[n];if(r){if("set"===r.type&&"access"===e.type){const t={type:"set",record:{...r.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===r.type&&!r.maybeStaleRecord&&r.record.value&&r.record.value.value?r.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),o=n&&n[t];if(o&&"set"===o.type)return o.record}setCacheOperationMap(e,t){const n=t,{pointer:o,userId:r}=n.record,i=e.get(o)||{};e.set(o,{...i,[r]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:o}=t,r=e.get(n)||{};e.set(n,{...r,[o]:t})}removePendingWrite(e,t,n){const o=this.pendingWrites.get(e);o&&o[t]&&o[t].type===n&&this.pendingWrites.delete(e)}logGetErrorBatched(){const e=this.getEnvironment(),t=x().$z(this.queuedGetErrors,(e=>(0,E().convertErrorToLog)(e).message));for(const[n,o]of Object.entries(t)){if(!n)break;w().log({level:"warning",from:"SqliteRecordCache",type:"getErrorBatched",error:(0,E().convertErrorToLog)(o[0]),data:{batchedData:o.map((t=>(0,I().CS)(t,{isBrowser:e.device.isBrowser})))}},{forceSuppressConsoleLog:!0})}this.queuedGetErrors=[]}async getTablesThatNeedEviction(){try{return await _().W3({connection:this.connection,maxSize:this.maxSize})}catch(e){return(0,T().u)({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"get_tables_failed"}},opts:{preboot:!0}}),w().log({level:"warning",from:"SqliteRecordCache",type:"getTablesThatNeedEvictionFailed",error:(0,E().convertErrorToLog)(e)}),[]}}async evictTables(e){const{tables:t,offlineRecordIds:n}=e;try{await _().$c({connection:this.connection,tables:t,maxSize:this.maxSize,offlineRecordIds:n}),(0,T().u)({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction",eventProperties:{}},opts:{preboot:!0}})}catch(o){(0,T().u)({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"eviction_failed"}},opts:{preboot:!0}}),w().log({level:"warning",from:"SqliteRecordCache",type:"evictionFailed",error:(0,E().convertErrorToLog)(o)})}}}var R=()=>n(206267),j=()=>n(203587),B=()=>n(763824),D=()=>n(735270);const N=[WebSocket.OPEN,WebSocket.CONNECTING];class O{constructor(){this.sqliteConnection=void 0,this.requests=new Map}async initialize(){"message-ports"===await this.getConnectionType()?await this.initializeMessagePort():await this.initializeWebSocket()}async getConnectionType(){var e;const{preferences:t}=await f().electronAppFeatures.get()||{};if("message-ports"===(null==t?void 0:t.sqliteConnectionType))return"message-ports";const n=f().getDesktopVersion();if(n&&n[0]>=4)return"message-ports";const o=navigator.userAgent.match(/Notion\/(\d+\.\d+\.\d+)/);if(o){const[,e]=o,[t]=e.split(".").map(Number);if(t>=4)return"message-ports"}return null!==(e=f().electronApi)&&void 0!==e&&e.sqliteServerEnabled?"web-sockets":null}async initializeMessagePort(){await this.initializeMessagePortConnection();try{(0,y().localUserOnlyGateCheck)({gateName:"recover_from_sqlite_corruption"})&&await this.enableCorruptionRepair()}catch(e){}try{this.sqliteConnection=await this.createSqliteConnectionManager()}catch(e){}}async createSqliteConnectionManager(){const e={execSqliteBatchV2:async e=>{let{batch:t,precondition:n}=e;return this.execSqliteBatchInnerMessagePort({id:R().JW(),batch:t,precondition:n})},execSqliteBatch:async e=>this.execSqliteBatchInnerMessagePort({id:R().JW(),batch:e}),completelyRebuildSqliteDb:async()=>this.completelyRebuildSqliteDbInnerMessagePort(R().JW())},t=await(0,j().G)(e);return new(D().i)({connection:e,type:"v2",migrations:t})}async initializeWebSocket(){await this.initializeWebSocketConnection();const e={execSqliteBatchV2:async e=>{const t=R().JW(),{batch:n,precondition:o}=e,r=JSON.stringify({id:t,batch:n,precondition:o,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,r)},execSqliteBatch:async e=>{const t=R().JW(),n=JSON.stringify({id:t,batch:e,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,n)},completelyRebuildSqliteDb:async()=>{}};this.sqliteConnection=new(D().i)({connection:e,type:"v2",migrations:await(0,j().G)(e)})}async execSqliteBatchInnerWebSockets(e,t){const n=new Promise((t=>{this.requests.set(e,t)}));this.ws.readyState===WebSocket.CLOSED&&await this.initializeWebSocket();try{this.ws.send(t)}catch(r){const e=this.ws;this.ws.onopen=function(n){e.send(t)}}const o=await n;if(o.error)throw new Error("Received SQLite error.",{cause:o.error});return o.value}async execSqliteBatchInnerMessagePort(e){const t=new Promise((t=>{this.requests.set(e.id,t)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(e);const n=await t;if(n.error)throw new Error("Received SQLite error.",{cause:n.error});return n.value}async completelyRebuildSqliteDbInnerMessagePort(e){const t={id:e,command:"completelyRebuildSqliteDb",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(t);const o=await n;if(o.error)throw new Error("completelyRebuildSqliteDb error.",{cause:o.error})}async enableCorruptionRepairInnerMessagePort(e){const t={id:e,command:"enableCorruptionRepair",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(t);const o=await n;if(o.error)throw new Error("enableCorruptionRepair error.",{cause:o.error})}async disableCorruptionRepairInnerMessagePort(e){const t={id:e,command:"disableCorruptionRepair",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(t);const o=await n;if(o.error)throw new Error("disableCorruptionRepair error.",{cause:o.error})}async restoreBackupInnerMessagePort(e){const t={id:e,command:"restoreBackup",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(t);const o=await n;if(o.error)throw new Error("restoreBackup error.",{cause:o.error})}async initializeMessagePortConnection(){return(0,B().qt)((async e=>{var t;if(null===(t=f().electronApi)||void 0===t||!t.getSqliteMeta)return;if(this.messagePort)return;const n=t=>{try{if(!t.ports.length||t.source!==window)return;this.messagePort=t.ports[0],this.messagePort.onclose=()=>{this.messagePort=void 0},this.messagePort.onmessage=async e=>{const{type:t,id:n,result:o}=e.data;if("backupAndResetDatabaseComplete"===t)return void(await this.handleBackupAndResetDatabaseComplete());const r=this.requests.get(n);r&&(this.requests.delete(n),r({value:o}))},window.removeEventListener("message",n),e()}catch(o){w().log({level:"error",from:"electronSqlite",type:"messagePortError",error:(0,E().convertErrorToLog)(o)})}};window.addEventListener("message",n);(await f().electronApi.getSqliteMeta()).error}))}async initializeWebSocketConnection(){var e;if(null===(e=f().electronApi)||void 0===e||!e.getSqliteMeta)return;const t=await f().electronApi.getSqliteMeta();if(t.error)return;if(this.ws&&N.includes(this.ws.readyState))return;const{serverProcessPort:n,authToken:o}=t.value;this.authToken=o;const r=`ws://127.0.0.1:${n}`;this.ws=new WebSocket(r),this.ws.onclose=()=>{w().log({level:"warning",from:"electronSqlite",type:"reinitializingWebsocket"}),this.initializeWebSocketConnection()},this.ws.addEventListener("message",(async e=>{const t=e.data.toString(),{type:n,id:o,result:r}=JSON.parse(t);if("backupAndResetDatabaseComplete"===n)return void(await this.handleBackupAndResetDatabaseComplete());const i=this.requests.get(o);i&&(this.requests.delete(o),i({value:r}))})),await new Promise((e=>{this.ws.onopen=()=>{e()}}))}async enableCorruptionRepair(){await this.enableCorruptionRepairInnerMessagePort(R().JW())}async disableCorruptionRepair(){await this.disableCorruptionRepairInnerMessagePort(R().JW())}async handleBackupAndResetDatabaseComplete(){try{if("message-ports"===await this.getConnectionType()?this.messagePort||await this.initializeMessagePort():this.ws||await this.initializeWebSocket(),this.sqliteConnection=await this.createSqliteConnectionManager(),!this.sqliteConnection)return;await this.sqliteConnection.ensureMigrated(),await this.restoreBackup()}catch(e){}}async restoreBackup(){await this.restoreBackupInnerMessagePort(R().JW())}}n(814603),n(147566),n(198721);var q=()=>n(681335);Error;class z{constructor(e){this.tabId=void 0,this.initializePromise=void 0,this.sharedWorkerConnection=void 0,this.dedicatedWorkerConnection=void 0,this.lockAcquired=!1,this.args=e,this.tabId=R().JW(),this.initializePromise=this.initialize(e)}async waitForInitialize(){await this.initializePromise}async execSqliteBatch(e){const{sqliteConnectionManager:t}=await this.initializePromise;return t.execSqliteBatch(e)}async completelyRebuildSqliteDb(){const{sqliteConnectionManager:e}=await this.initializePromise;return e.completelyRebuildSqliteDb()}async enableCorruptionRepair(){try{const{sharedWorkerConnection:e}=await this.initializePromise;await e.enableCorruptionRepair()}catch(e){}}async disableCorruptionRepair(){try{const{sharedWorkerConnection:e}=await this.initializePromise;await e.disableCorruptionRepair()}catch(e){}}getDedicatedWorkerConnection_DEBUG_ONLY(){return this.dedicatedWorkerConnection}async initialize(e){const{loadWorker:t,loadSharedWorker:o}=e,r=t(),i=o();this.sharedWorkerConnection??=q().LV(i.port);const a=this.sharedWorkerConnection;this.dedicatedWorkerConnection??=q().LV(r);const s=this.dedicatedWorkerConnection,c={initialize:()=>s.initialize(),execSqliteBatch:e=>s.execSqliteBatch(e),execSqliteBatchV2:e=>s.execSqliteBatchV2(e),completelyRebuildSqliteDb:()=>s.completelyRebuildSqliteDb(),handleBackupAndResetDatabaseComplete:()=>this.handleBackupAndResetDatabaseComplete()};q().p(c,i.port);try{(0,y().localUserOnlyGateCheck)({gateName:"recover_from_sqlite_corruption"})&&await a.enableCorruptionRepair()}catch(p){}var l;this.lockAcquired||(await(l=n(714681).S(this.tabId),new Promise(((e,t)=>{navigator.locks.request(l,(()=>(e(),new Promise((()=>{}))))).catch(t)}))),this.lockAcquired=!0),await a.initializeNewTab({tabId:this.tabId});const d={execSqliteBatch:e=>a.execSqliteBatch(e),execSqliteBatchV2:e=>a.execSqliteBatchV2(e),completelyRebuildSqliteDb:()=>a.completelyRebuildSqliteDb()},u=new(D().i)({connection:d,type:"v2",migrations:await(0,j().G)(d)});try{await u.ensureMigrated()}catch(p){w().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionEnsureMigratedError",error:(0,E().convertErrorToLog)(p),data:(0,I().CS)(p,{isBrowser:!0})})}return u.optimize().catch((e=>{w().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionOptimizeError",error:(0,E().convertErrorToLog)(e),data:(0,I().CS)(e,{isBrowser:!0})})})),{sqliteConnectionManager:u,sharedWorkerConnection:a}}async handleBackupAndResetDatabaseComplete(){try{this.initializePromise=this.initialize(this.args);const{sqliteConnectionManager:e,sharedWorkerConnection:t}=await this.initializePromise;if(!t)return;await e.ensureMigrated(),await t.restoreBackup()}catch(e){}}}class W{constructor(e){this.sqliteConnection=void 0,this.sqliteConnection=new z({loadWorker:()=>new Worker(new URL(n.p+n.u(75528),n.b)),loadSharedWorker:()=>new SharedWorker(new URL(n.p+n.u(33429),n.b)),currentUserId:e.currentUserId})}static maybeCreateInstance(e){const{device:t,currentUserId:n}=e;if(function(e){var t;return!(!e.isBrowser||"undefined"==typeof navigator||void 0===(null===(t=navigator.locks)||void 0===t?void 0:t.request)||"undefined"==typeof SharedWorker||"localhost"===window.location.hostname&&"3003"!==window.location.port||e.isAndroid)}(t)){K("loading");const e=new W({currentUserId:n});return e.waitForInitialize().then((()=>{K("success")}),(e=>{K("error"),w().log({level:"error",from:"clientEnvironment",type:"wasmSqliteInitializeError",error:(0,E().convertErrorToLog)(e),data:{...(0,I().CS)(e,{isBrowser:!0}),userId:n}})})),e}K("skipped-unsupported-device")}async waitForInitialize(){return await this.sqliteConnection.waitForInitialize()}async enableCorruptionRepair(){await this.sqliteConnection.enableCorruptionRepair()}async disableCorruptionRepair(){await this.sqliteConnection.disableCorruptionRepair()}}function K(e){n(961581).A.state.metricDataStore.update((t=>({...t,wasm_sqlite_initialized:e})))}var F=()=>n(757695);class V extends F().Store{getInitialState(){return{loading:!1,loaded:!1}}async loadIfNeeded(e){if(this.state.loaded||this.state.loading)return;const t=e();if(!t)return;if(0===n(919709).IcF(t).length)return;const o=n(771467).V.load();this.setState({loading:!0,loaded:!1,result:o}),this.setState({loading:!1,loaded:!0,result:await o})}getKatex(){if(this.state.loaded)return this.state.result}}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(354520),n(908872),n(737550);var $=()=>n(763884),G=()=>n(720665),H=()=>n(941541),J=()=>n(589994);class Z extends F().Store{static getCacheKey(e){return`LocalBacklinkStore2:${e}`}getInitialState(){return{}}initializeBacklinks(e){let{block:t,currentUserId:n,environment:o}=e;if(this.instanceState[t.id])return;const r=this.getCachedBacklinkState({blockId:t.id,currentUserId:n});r?this.setState({...this.instanceState,[t.id]:{state:r,loaded:!0}}):this.setState({...this.instanceState,[t.id]:{state:{backlinks:[],inaccessibleBacklinkCount:0},loaded:!1}}),Y(o,t),this.startMessageListeners(t,o)}awaitLoaded(e){return this.waitUntil((()=>{const t=this.state[e];return Boolean(t&&t.loaded)}))}destroyBacklinks(e,t){this.stopMessageListeners(e,t),delete this.instanceState[e]}getBacklinkState(e){let{blockId:t,currentUserId:n}=e;const o=this.state[t];return o?o.state:this.getCachedBacklinkState({blockId:t,currentUserId:n})||{backlinks:[],inaccessibleBacklinkCount:0}}setBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;this.setCachedBacklinkState({blockId:t,state:n,currentUserId:o});const r=this.state[t];r&&this.setState({...this.state,[t]:{...r,state:n,loaded:!0}})}updateBacklinks(e){const{createdBacklinks:t,deletedBacklinks:n,currentUserId:o}=e,r=(0,G().qt)(t),i=(0,G().qt)(n),a=r.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),s=i.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),c=new Set([...Object.keys(a),...Object.keys(s)]);return c.forEach((e=>{const t=a[e]||[],n=s[e]||[],r=this.getBacklinkState({blockId:e,currentUserId:o}),i=t.filter((e=>!r.backlinks.some((t=>x().n4(e,t))))),c=[...r.backlinks,...i].filter((e=>!n.some((t=>x().n4(e,t)))));this.setBacklinkState({blockId:e,state:{...r,backlinks:c},currentUserId:o})})),Array.from(c)}resetBacklinkState(e){let{blockIds:t,currentUserId:n}=e;for(const o of t)this.setCachedBacklinkState({blockId:o,state:{backlinks:[],inaccessibleBacklinkCount:0},currentUserId:n})}getCachedBacklinkState(e){let{blockId:t,currentUserId:n}=e;return $().K.get({userId:n,key:Z.getCacheKey(t)})}setCachedBacklinkState(e){let{blockId:t,state:n,currentUserId:o}=e;return $().K.set({userId:o,key:Z.getCacheKey(t),value:n})}async startMessageListeners(e,t){const o=n(696706).L3.fromSpaceShardRecordId(e,k().ev);J().transactionQueue.isPendingTransactionForRecord(o)&&await J().transactionQueue.drain();const r=this.instanceState[o.id];if(!r)return;let i,a=!1;const s=x().nF((n=>{let{value:o}=n;const r=i,s=o||void 0;i=s,a?r!==s&&Y(t,e):a=!0}),1e3),c=(0,n(921997).U)(o.id);r.messageStoreListenerReference=H().Ay.addListener(c,void 0,s,void 0,t)}stopMessageListeners(e,t){const n=this.instanceState[e];n&&n.messageStoreListenerReference&&(H().Ay.removeListener(n.messageStoreListenerReference,t),n.messageStoreListenerReference=void 0)}}async function Y(e,t){await J().transactionQueue.awaitRecordTransaction({id:t.id,table:k().ev});const o=(0,n(851941).dR)(t.id),r=o?{"x-notion-space-short-id":o.toString()}:t.spaceId?{"x-notion-space-id":t.spaceId}:{},i=n(449506).callMultiCellApi({eventName:"getPageBacklinks",environment:e,data:{block:t},headers:r}),a=[];let s=0;for await(const n of i)"failed"!==n.type&&(a.push(...n.data.backlinks),s+=n.data.inaccessibleBacklinkCount,e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:a,inaccessibleBacklinkCount:s},currentUserId:e.currentUser.id}))}class Q extends F().Store{getInitialState(){return{isOpen:!1,isSubMenuOverridden:!1,subMenu:void 0,menu:void 0,shouldRestoreSelectionForMenu:!0,enableShouldShowDebugging:!1,session:void 0}}clear(e){this.update((t=>({...t,menu:void 0,shouldRestoreSelectionForMenu:e})))}async clearNativeActionMenuAndRestoreSelectionIfNecessary(){var e;void 0!==(null===(e=this.state.menu)||void 0===e?void 0:e.type)&&(this.clear(!0),await B().wR(10))}}function X(e){return`PageDetailsStore:${e.type}:${e.id}`}class ee extends F().Store{getInitialState(){return{}}static getDefaultToggleState(e){return"discussion"===e.type||"backlinks"!==e.type&&void(0,n(534177).HB)(e)}getToggleState(e){const t=X(e);if(t in this.state)return this.state[t]}setToggleState(e,t){const n=X(e);this.setState({...this.state,[n]:t})}}var te=()=>n(671887),ne=()=>n(994310);const oe="spellcheckEnabled";class re{constructor(){this.enabled=void 0,this.currentLanguages=void 0;const e=ne().A.get(oe);this.setEnabled(void 0===e||e)}setEnabled(e){var t,n;(this.enabled=e,ne().A.set(oe,e),null!==(t=f().electronApi)&&void 0!==t&&t.setSpellCheckerEnabled)&&(null===(n=f().electronApi)||void 0===n||n.setSpellCheckerEnabled(e))}isEnabled(){return this.enabled}getCorrections(e){return e.dictionarySuggestions}addToDictionary(e){var t;null!==(t=f().electronApi)&&void 0!==t&&t.addToDictionary&&f().electronApi.addToDictionary(e)}setLanguages(e){var t;x().n4(this.currentLanguages,e)||(this.currentLanguages=e,null!==(t=f().electronApi)&&void 0!==t&&t.setSpellCheckerLanguages&&f().electronApi.setSpellCheckerLanguages(0===e.length?[navigator.language]:e))}async getLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=f().electronApi)&&void 0!==e&&e.getSpellCheckerLanguages){const e=await f().electronApi.getSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}async getAvailableLanguages(){var e;const t=new Intl.DisplayNames([navigator.language],{type:"language"}),n=[];if(null!==(e=f().electronApi)&&void 0!==e&&e.getAvailableSpellCheckerLanguages){const e=await f().electronApi.getAvailableSpellCheckerLanguages();for(const o of e)n.push({code:o,name:t.of(o)})}return n}}var ie=()=>n(877050);let ae=0;async function se(e){var t;const{minimalEnvironment:n,prefetchCache:w,currentUserId:A}=e,{device:k,deviceStore:I,mobileNative:C,cookieService:_}=n,x=""+ae++,E=k.isElectron&&Boolean(null===(t=f().electronApi)||void 0===t?void 0:t.sqliteServerEnabled)?await async function(e){var t;if(!e.device.isElectron||null===(t=f().electronApi)||void 0===t||!t.sqliteServerEnabled)return;const n=new O;return await n.initialize(),n}({device:k}):void 0,T=W.maybeCreateInstance({device:k,currentUserId:A}),P=new(l().A),L=new(d().Bd),U=new(p().A),R=new re,j=(null==C?void 0:C.sqliteConnection)||(null==E?void 0:E.sqliteConnection)||(null==T?void 0:T.sqliteConnection),B=j?new M({connection:j,maxSize:k.isDesktop?1e6:1e5,getEnvironment:function(){return $}}):void 0,D=new(r().L)({inMemoryRecordCache:new(o().A)({name:"default"}),persistedRecordCache:B});T&&T.waitForInitialize().catch((e=>{(0,y().localUserOnlyGateCheck)({gateName:"recover_from_sqlite_corruption"})||D.disablePersistedRecordCache()}));const N=(0,ie().OH)({device:k,RouterStore:P,ThemeStore:U}),q=k.isMobile?new Q:void 0,z=await h().getPublicDomainUserId({device:k,deviceStore:I,mobileNative:C,cookieService:_}),K=new(i().CurrentUser),F=new g({environmentName:"production",getSettings:()=>({enableIdSchema:!0}),isServerOriginated:!1,currentUserId:A,mapSpaceIdToShortId:(e,t)=>{const n=(0,b().Jn)({defaultRecordCache:D,userId:e,spaceId:t});if(n&&n.short_id_str)return Number(n.short_id_str);const o=te().D.getState();if(o&&t in o){const e=o[t];return Number(e)}}}),$={key:x,AppUpdateStore:new(a().I),device:k,deviceStore:I,WindowSizeStore:new(m().nJ)({device:k},window),KeyboardShortcutsStore:new(s().U),KeyboardShortcutStackStore:new(c().X),defaultRecordCache:D,mobileNative:C,RouterStore:P,ThemeStore:U,ThemeModeStore:N,ElectronSqlite:E,WasmSqlite:T,KatexStore:new V,LocalBacklinkStore:new Z,PageDetailsStore:new ee,updateCurrentUserId:void 0,currentUser:K,SpellCheckStore:R,NativeMobileActionBarStore:q,TextSelectionCompositionStore:new(u().P),recordSubscriptionActions:S(),prefetchCache:w,TabbedRouterStore:L,cookieService:_,publicDomainUserId:z,idCreator:F};return v().uh($),$}},467135:(e,t,n)=>{n.r(t),n.d(t,{BroadcastChannel:()=>D,OPEN_BROADCAST_CHANNELS:()=>j,beLeader:()=>Z,clearNodeFolder:()=>N,createLeaderElection:()=>X,enforceOptions:()=>O});var o=Promise.resolve(!1),r=Promise.resolve(!0),i=Promise.resolve();function a(e,t){return e||(e=0),new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function s(){return Math.random().toString(36).substring(2)}var c=0;function l(){var e=1e3*Date.now();return e<=c&&(e=c+1),c=e,e}var d={create:function(e){var t={time:l(),messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t},close:function(e){e.bc.close(),e.subFns=[]},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){try{return e.bc.postMessage(t,!1),i}catch(n){return Promise.reject(n)}},canBeUsed:function(){if("undefined"!=typeof globalThis&&globalThis.Deno&&globalThis.Deno.args)return!0;if("undefined"==typeof window&&"undefined"==typeof self||"function"!=typeof BroadcastChannel)return!1;if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0},type:"native",averageResponseTime:function(){return 150},microSeconds:l};class u{ttl;map=new Map;_to=!1;constructor(e){this.ttl=e}has(e){return this.map.has(e)}add(e){this.map.set(e,p()),this._to||(this._to=!0,setTimeout((()=>{this._to=!1,function(e){const t=p()-e.ttl,n=e.map[Symbol.iterator]();for(;;){const o=n.next().value;if(!o)return;const r=o[0];if(!(o[1]<t))return;e.map.delete(r)}}(this)}),0))}clear(){this.map.clear()}}function p(){return Date.now()}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}var f="pubkey.broadcast-channel-0-",v="messages",g={durability:"relaxed"};function h(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function b(e){e.commit&&e.commit()}function S(e,t){var n=e.transaction(v,"readonly",g),o=n.objectStore(v),r=[],i=IDBKeyRange.bound(t+1,1/0);if(o.getAll){var a=o.getAll(i);return new Promise((function(e,t){a.onerror=function(e){return t(e)},a.onsuccess=function(t){e(t.target.result)}}))}return new Promise((function(e,a){var s=function(){try{return i=IDBKeyRange.bound(t+1,1/0),o.openCursor(i)}catch(e){return o.openCursor()}}();s.onerror=function(e){return a(e)},s.onsuccess=function(o){var i=o.target.result;i?i.value.id<t+1?i.continue(t+1):(r.push(i.value),i.continue()):(b(n),e(r))}}))}function y(e){return(t=e.db,n=e.options.idb.ttl,o=Date.now()-n,r=t.transaction(v,"readonly",g),i=r.objectStore(v),a=[],new Promise((function(e){i.openCursor().onsuccess=function(t){var n=t.target.result;if(n){var i=n.value;i.time<o?(a.push(i),n.continue()):(b(r),e(a))}else e(a)}}))).then((function(t){return function(e,t){if(e.closed)return Promise.resolve([]);var n=e.db.transaction(v,"readwrite",g).objectStore(v);return Promise.all(t.map((function(e){var t=n.delete(e);return new Promise((function(e){t.onsuccess=function(){return e()}}))})))}(e,t.map((function(e){return e.id})))}));var t,n,o,r,i,a}function w(e){e.closed||A(e).then((function(){return a(e.options.idb.fallbackInterval)})).then((function(){return w(e)}))}function A(e){return e.closed?i:e.messagesCallback?S(e.db,e.lastCursorId).then((function(t){var n=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time}));return n.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),i})):i}var k={create:function(e,t){return t=m(t),function(e){var t=h(),n=f+e,o=t.open(n);return o.onupgradeneeded=function(e){e.target.result.createObjectStore(v,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){o.onerror=function(e){return t(e)},o.onsuccess=function(){e(o.result)}}))}(e).then((function(n){var o={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:s(),eMIs:new u(2*t.idb.ttl),writeBlockPromise:i,messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){o.closed=!0,t.idb.onclose&&t.idb.onclose()},w(o),o}))},close:function(e){e.closed=!0,e.db.close()},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t,A(e)},postMessage:function(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return function(e,t,n){var o={uuid:t,time:Date.now(),data:n},r=e.transaction([v],"readwrite",g);return new Promise((function(e,t){r.oncomplete=function(){return e()},r.onerror=function(e){return t(e)},r.objectStore(v).add(o),b(r)}))}(e.db,e.uuid,t)})).then((function(){var t,n;0===(t=0,n=10,Math.floor(Math.random()*(n-t+1)+t))&&y(e)})),e.writeBlockPromise},canBeUsed:function(){return!!h()},type:"idb",averageResponseTime:function(e){return 2*e.idb.fallbackInterval},microSeconds:l},I="pubkey.broadcastChannel-";function C(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(t){}return e}function _(e){return I+e}function x(){var e=C();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(n){return!1}return!0}var E={create:function(e,t){if(t=m(t),!x())throw new Error("BroadcastChannel: localstorage cannot be used");var n=s(),o=new u(t.localstorage.removeTimeout),r={channelName:e,uuid:n,eMIs:o};return r.listener=function(e,t){var n=_(e),o=function(e){e.key===n&&t(JSON.parse(e.newValue))};return window.addEventListener("storage",o),o}(e,(function(e){r.messagesCallback&&e.uuid!==n&&e.token&&!o.has(e.token)&&(e.data.time&&e.data.time<r.messagesCallbackTime||(o.add(e.token),r.messagesCallback(e.data)))})),r},close:function(e){var t;t=e.listener,window.removeEventListener("storage",t)},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){a().then((function(){var o=_(e.channelName),r={token:s(),time:Date.now(),data:t,uuid:e.uuid},i=JSON.stringify(r);C().setItem(o,i);var a=document.createEvent("Event");a.initEvent("storage",!0,!0),a.key=o,a.newValue=i,window.dispatchEvent(a),n()}))}))},canBeUsed:x,type:"localstorage",averageResponseTime:function(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120},microSeconds:l},T=l,P=new Set;var L={create:function(e){var t={time:T(),name:e,messagesCallback:null};return P.add(t),t},close:function(e){P.delete(e)},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){return setTimeout((function(){Array.from(P).forEach((function(n){n.name===e.name&&n!==e&&n.messagesCallback&&n.time<t.time&&n.messagesCallback(t)})),n()}),5)}))},canBeUsed:function(){return!0},type:"simulate",averageResponseTime:function(){return 5},microSeconds:T},U=[d,k,E];function M(e){var t=[].concat(e.methods,U).filter(Boolean);if(e.type){if("simulate"===e.type)return L;var n=t.find((function(t){return t.type===e.type}));if(n)return n;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter((function(e){return"idb"!==e.type})));var o=t.find((function(e){return e.canBeUsed()}));if(o)return o;throw new Error("No usable method found in "+JSON.stringify(U.map((function(e){return e.type}))))}var R,j=new Set,B=0,D=function(e,t){var n,o,r;this.id=B++,j.add(this),this.name=e,R&&(t=R),this.options=m(t),this.method=M(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,o=(n=this).method.create(n.name,n.options),(r=o)&&"function"==typeof r.then?(n._prepP=o,o.then((function(e){n._state=e}))):n._state=o};function N(e){var t=M(e=m(e));return"node"===t.type?t.clearNodeFolder().then((function(){return!0})):o}function O(e){R=e}function q(e,t,n){var o={time:e.method.microSeconds(),type:t,data:n};return(e._prepP?e._prepP:i).then((function(){var t=e.method.postMessage(e._state,o);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function z(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function W(e,t,n){e._addEL[t].push(n),function(e){if(!e._iL&&z(e)){var t=function(t){e._addEL[t.type].forEach((function(e){t.time>=e.time&&e.fn(t.data)}))},n=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,n)})):(e._iL=!0,e.method.onMessage(e._state,t,n))}}(e)}function K(e,t,n){e._addEL[t]=e._addEL[t].filter((function(e){return e!==n})),function(e){if(e._iL&&!z(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}D._pubkey=!0,D.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(e));return q(this,"message",e)},postInternal:function(e){return q(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};K(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,W(this,"message",t)):this._onML=null},addEventListener:function(e,t){W(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){K(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){j.delete(this),this.closed=!0;var t=this._prepP?this._prepP:i;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}};var F="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)?function(e){process.on("exit",(function(){return e()})),process.on("beforeExit",(function(){return e().then((function(){return process.exit()}))})),process.on("SIGINT",(function(){return e().then((function(){return process.exit()}))})),process.on("uncaughtException",(function(t){return e().then((function(){console.trace(t),process.exit(101)}))}))}:function(e){if("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){var t=self.close.bind(self);self.close=function(){return e(),t()}}else{if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){e()}),!0),window.addEventListener("unload",(function(){e()}),!0)}},V=new Set,$=!1;function G(e){if($||($=!0,F(H)),"function"!=typeof e)throw new Error("Listener is no function");return V.add(e),{remove:function(){return V.delete(e)},run:function(){return V.delete(e),e()}}}function H(){var e=[];return V.forEach((function(t){e.push(t()),V.delete(t)})),Promise.all(e)}function J(e,t){var n={context:"leader",action:t,token:e.token};return e.broadcastChannel.postInternal(n)}function Z(e){e.isLeader=!0,e._hasLeader=!0;var t=G((function(){return e.die()}));e._unl.push(t);var n=function(t){"leader"===t.context&&"apply"===t.action&&J(e,"tell"),"leader"!==t.context||"tell"!==t.action||e._dpLC||(e._dpLC=!0,e._dpL(),J(e,"tell"))};return e.broadcastChannel.addEventListener("internal",n),e._lstns.push(n),J(e,"tell")}var Y=function(e,t){var n=this;this.broadcastChannel=e,e._befC.push((function(){return n.die()})),this._options=t,this.isLeader=!1,this.isDead=!1,this.token=s(),this._lstns=[],this._unl=[],this._dpL=function(){},this._dpLC=!1,this._wKMC={},this.lN="pubkey-bc||"+e.method.type+"||"+e.name};Y.prototype={hasLeader:function(){var e=this;return navigator.locks.query().then((function(t){var n=t.held?t.held.filter((function(t){return t.name===e.lN})):[];return!!(n&&n.length>0)}))},awaitLeadership:function(){var e=this;if(!this._wLMP){this._wKMC.c=new AbortController;var t=new Promise((function(t,n){e._wKMC.res=t,e._wKMC.rej=n}));this._wLMP=new Promise((function(n){navigator.locks.request(e.lN,{signal:e._wKMC.c.signal},(function(){return e._wKMC.c=void 0,Z(e),n(),t})).catch((function(){}))}))}return this._wLMP},set onduplicate(e){},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this.isLeader=!1),this.isDead=!0,this._wKMC.res&&this._wKMC.res(),this._wKMC.c&&this._wKMC.c.abort("LeaderElectionWebLock.die() called"),J(this,"death")}};var Q=function(e,t){var n=this;this.broadcastChannel=e,this._options=t,this.isLeader=!1,this._hasLeader=!1,this.isDead=!1,this.token=s(),this._aplQ=i,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var o=function(e){"leader"===e.context&&("death"===e.action&&(n._hasLeader=!1),"tell"===e.action&&(n._hasLeader=!0))};this.broadcastChannel.addEventListener("internal",o),this._lstns.push(o)};function X(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=function(e,t){return e||(e={}),(e=JSON.parse(JSON.stringify(e))).fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}(t,e);var n="undefined"!=typeof navigator&&void 0!==navigator.locks&&"function"==typeof navigator.locks.request?new Y(e,t):new Q(e,t);return e._befC.push((function(){return n.die()})),e._leaderElector=n,n}Q.prototype={hasLeader:function(){return Promise.resolve(this._hasLeader)},applyOnce:function(e){var t=this;if(this.isLeader)return a(0,!0);if(this.isDead)return a(0,!1);if(this._aplQC>1)return this._aplQ;return this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then((function(){return function(){if(t.isLeader)return r;var n,o=!1,i=new Promise((function(e){n=function(){o=!0,e()}})),s=function(e){"leader"===e.context&&e.token!=t.token&&("apply"===e.action&&e.token>t.token&&n(),"tell"===e.action&&(n(),t._hasLeader=!0))};t.broadcastChannel.addEventListener("internal",s);var c=e?4*t._options.responseTime:t._options.responseTime;return J(t,"apply").then((function(){return Promise.race([a(c),i.then((function(){return Promise.reject(new Error)}))])})).then((function(){return J(t,"apply")})).then((function(){return Promise.race([a(c),i.then((function(){return Promise.reject(new Error)}))])})).catch((function(){})).then((function(){return t.broadcastChannel.removeEventListener("internal",s),!o&&Z(t).then((function(){return!0}))}))}()})).then((function(){t._aplQC=t._aplQC-1})),this._aplQ.then((function(){return t.isLeader}))},awaitLeadership:function(){return this._aLP||(this._aLP=function(e){if(e.isLeader)return i;return new Promise((function(t){var n=!1;function o(){n||(n=!0,e.broadcastChannel.removeEventListener("internal",r),t(!0))}e.applyOnce().then((function(){e.isLeader&&o()})),function t(){return a(e._options.fallbackInterval).then((function(){if(!e.isDead&&!n)return e.isLeader?void o():e.applyOnce(!0).then((function(){e.isLeader?o():t()}))}))}();var r=function(t){"leader"===t.context&&"death"===t.action&&(e._hasLeader=!1,e.applyOnce().then((function(){e.isLeader&&o()})))};e.broadcastChannel.addEventListener("internal",r),e._lstns.push(r)}))}(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this._hasLeader=!1,this.isLeader=!1),this.isDead=!0,J(this,"death")}}},517592:(e,t,n)=>{n.d(t,{A:()=>r});n(296540);var o=n(474848);const r=(0,n(340498).wt)("notionLogoStroked",{viewBox:"0 0 41 42",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M4.253 2.903h0-.01c-1.02.09-1.806.481-2.322 1.142-.5.642-.671 1.441-.671 2.21v23.228c0 1.267.47 2.316 1.416 3.577h0l.006.008 4.99 6.477h0l.005.005c.465.593.963 1.017 1.617 1.256.63.23 1.33.26 2.138.221h.01l24.652-1.49h.008c1.137-.08 2.038-.396 2.632-1.071.588-.668.746-1.543.746-2.431V9.904c0-.584-.133-1.05-.508-1.486-.27-.311-.669-.602-1.113-.925a54.305 54.305 0 01-.176-.13l-.007-.004-.005-.004-6.772-4.761c-.838-.609-1.516-1.017-2.365-1.21-.824-.187-1.75-.156-3.047-.044L4.253 2.903z",fill:"#fff",stroke:"#fff",strokeWidth:"1.5"}),(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.257 3.158L5.176 4.637c-1.62.14-2.184 1.197-2.184 2.464v21.971c0 .987.352 1.83 1.198 2.959l4.72 6.126c.776.987 1.48 1.198 2.96 1.127l23.32-1.408c1.973-.14 2.537-1.057 2.537-2.606V10.552c0-.801-.316-1.032-1.25-1.714l-.16-.117-6.41-4.507c-1.55-1.126-2.184-1.268-4.65-1.056zM12.4 10.146c-1.904.129-2.337.158-3.418-.72l-2.75-2.183c-.28-.283-.14-.635.565-.705L26.102 5.13c1.62-.141 2.466.423 3.1.916l3.311 2.394c.141.07.493.492.07.492L12.645 10.13l-.245.016zM10.179 35.06V14.074c0-.916.281-1.338 1.126-1.41l22.898-1.337c.777-.07 1.128.423 1.128 1.338v20.844c0 .916-.14 1.691-1.41 1.761l-21.91 1.268c-1.269.07-1.832-.352-1.832-1.48zm21.63-19.86c.141.635 0 1.268-.635 1.34l-1.056.21v15.492c-.916.493-1.761.775-2.466.775-1.128 0-1.41-.352-2.255-1.408l-6.905-10.845v10.493l2.185.493s0 1.267-1.763 1.267l-4.86.282c-.142-.282 0-.986.492-1.127l1.269-.351V17.947l-1.761-.142c-.141-.634.21-1.549 1.197-1.62l5.214-.351 7.187 10.986V17.1l-1.832-.21c-.14-.776.422-1.339 1.127-1.409l4.863-.283z",fill:"#222"})]})})},529649:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(463830).A)},532688:(e,t,n)=>{n.d(t,{RK:()=>i,uC:()=>a});var o=()=>n(645873);const r={Toaster:new(o().O2)("Toaster",(()=>Promise.all([n.e(94476),n.e(47381)]).then(n.bind(n,94476)))),PerfmarkTrialIneligibleToast:new(o().O2)("PerfmarkTrialIneligibleToast",(()=>Promise.all([n.e(75134),n.e(58790)]).then(n.bind(n,585731))))},i=(0,o()._h)(r.Toaster,(e=>e.Toaster)),a=(0,o()._h)(r.PerfmarkTrialIneligibleToast,(e=>e.PerfmarkTrialIneligibleToast))},537972:(e,t,n)=>{n.d(t,{Ay:()=>u,Gf:()=>m});var o=n(296540),r=()=>n(484714),i=()=>n(56366),a=()=>n(449412),s=()=>n(344300),c=()=>n(670631),l=()=>n(722038);const d=(0,n(498212).Ay)();function u(){!function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,r().v3)();(0,o.useEffect)((()=>{e&&t&&(0,s().readAndCacheOfflinePagesMemo)({userId:t,persistedRecordCache:e,tellOtherTabsToUpdate:!1})}),[e,t])}(),function(){const{defaultRecordCache:{persistedRecordCache:e},currentUser:{id:t}}=(0,r().v3)();m((0,o.useCallback)((()=>{e&&t&&(0,s().readAndCacheOfflinePages)({userId:t,persistedRecordCache:e,tellOtherTabsToUpdate:!1})}),[e,t]))}(),function(){const e=(0,i().K8)((()=>c().A.state.shouldPublishUpdate),[]),t=function(){const e=p();return(0,o.useCallback)((()=>{var t;null===(t=e.current)||void 0===t||t.postMessage({type:"update",tabId:d})}),[e])}();(0,o.useEffect)((()=>{e&&(t(),c().A.setState({...c().A.state,shouldPublishUpdate:!1}))}),[e,t])}()}function p(){const{currentUser:{id:e},device:t}=(0,r().v3)(),n=(0,l().y)(),i=t.isElectron,s=(0,o.useRef)(void 0);return(0,o.useEffect)((()=>{if(n&&i&&e)try{const t=new BroadcastChannel(`offlinePageUpdates-${e}`);return s.current=t,()=>{t.close(),s.current=void 0}}catch(t){a().Fg(t,{tags:{event:"useOfflinePageUpdatesChannel"}})}}),[n,i,e]),s}function m(e){const t=p();(0,o.useEffect)((()=>{const n=t.current;if(!n)return;const o=t=>{var n;"update"===(null===(n=t.data)||void 0===n?void 0:n.type)&&t.data.tabId!==d&&e()};return n.addEventListener("message",o),()=>{n.removeEventListener("message",o)}}),[t,e])}},574506:(e,t,n)=>{n.d(t,{t:()=>s});var o=()=>n(780054),r=()=>n(765957),i=()=>n(217429),a=()=>n(680074);function s(){if(o().A.isMobile)return!1;const{currentUserSettingsStore:e}=r().default.state;if(!e)return!1;const t=(0,a().iZ)(e);return!("number"==typeof t&&t>7)&&"on"===i().default.getEligibleGroup({experimentId:"slash_menu_tooltip",defaultGroup:"control"})}},607783:(e,t,n)=>{n.r(t),n.d(t,{AppRoot:()=>yo});var o=n(296540),r=()=>n(136590),i=()=>n(560198),a=()=>n(662303),s=()=>n(959013),c=(n(898992),n(354520),()=>n(591779)),l=()=>n(496603),d=()=>n(780054),u=()=>n(106959),p=n(474848);function m(e){const t=(0,o.useRef)(new Map),n=(0,o.useCallback)((()=>{const n=Array.from(t.current.values()).filter((e=>e.isSpawned)),o=n.length-e.maxPreferredIFrames;if(o<=0)return;const r=n.filter((e=>!e.isVisible));r.sort(((e,t)=>e.latestTimestamp-t.latestTimestamp));for(const e of r.slice(0,o))e.isSpawned=!1,e.onVisibilityChange(!1)}),[e.maxPreferredIFrames]),r=(0,o.useCallback)((e=>{for(const n of e){if(!(n.target instanceof HTMLElement))continue;const e=t.current.get(n.target);e&&(e.isVisible=n.isIntersecting,e.latestTimestamp=n.time,e.isVisible&&!e.isSpawned&&(e.isSpawned=!0,e.onVisibilityChange(!0)))}n()}),[n]),i=(0,o.useRef)(void 0!==window.IntersectionObserver?new IntersectionObserver(r):null);(0,o.useEffect)((()=>()=>{i.current&&(i.current.disconnect(),i.current=null)}),[]);const a=(0,c().ZC)(e.maxPreferredIFrames);(0,o.useEffect)((()=>{a&&e.maxPreferredIFrames<a&&n()}),[n,e.maxPreferredIFrames,a]);const s=(0,o.useMemo)((()=>({track:(e,n)=>{i.current?(t.current.set(e,{isVisible:!1,isSpawned:!1,latestTimestamp:0,onVisibilityChange:l().sg(n,50)}),i.current.observe(e)):u().mm.track(e,n)},untrack:e=>{i.current?(i.current.unobserve(e),t.current.delete(e)):u().mm.untrack(e)}})),[]);return(0,p.jsx)(u().jq.Provider,{value:s,children:e.children})}function f(e){let t=d().A.isMobile?10:50;return e.ramSizeInGB&&(t=Math.floor(2*e.ramSizeInGB)),{maxPreferredIFrames:t}}var v=()=>n(17022),g=()=>n(484714),h=()=>n(785082),b=()=>n(745875),S=()=>n(679924),y=()=>n(217429);function w(){return 1}function A(e){let{id:t,targetRenderPhase:n="all",samplePercent:r=w(),children:i}=e;const a=(0,g().v3)(),s=(0,o.useCallback)(((e,t,o,i,s,c)=>{(0,b().rQ)(r)&&("all"!==n&&t!==n||(0,S().v)(a,`${h().PX}.${e}`,{time:o,render_phase:t}))}),[a,n,r]),[c]=(0,o.useState)(v().e.withListenerIgnored((()=>y().default.checkGate({gateName:"client-performance-profiler"}))));return c?(0,p.jsx)(o.Profiler,{id:t,onRender:s,children:i}):(0,p.jsx)(p.Fragment,{children:i})}var k=()=>n(958637),I=()=>n(112995),C=()=>n(186445),_=()=>n(346);function x(){return(0,_().kg)()?(0,p.jsx)(_().MG,{}):null}var E=()=>n(852507),T=()=>n(799954),P=()=>n(987264),L=()=>n(381349),U=()=>n(874913),M=()=>n(435009),R=()=>n(994877),j=()=>n(864943),B=()=>n(204063),D=()=>n(719147),N=()=>n(21140),O=()=>n(488784),q=()=>n(763071);function z(e){var t;let{clearErrorState:n,error:o,errorId:r}=e;const i=(0,g().v3)();(0,E().w)((()=>{U().navigationReady(!1)}));const a=()=>{R().SI({environment:i,from:"page_error"})};return(0,p.jsxs)("div",{style:W,children:[(0,P().s)({width:42,height:42}),(0,p.jsxs)("div",{style:K,children:[(0,p.jsx)("div",{children:(0,p.jsx)(s().sA,{defaultMessage:"Oops! Something went wrong.",id:"router.renderErrorPage.message.part1"})}),(0,p.jsx)("div",{children:(0,p.jsx)(s().sA,{defaultMessage:"Please refresh and try again or <textlink>message support</textlink>.",id:"router.renderErrorPage.message.part2",values:{textlink:e=>(0,p.jsx)(D().A,{onClick:a,children:e})}})}),(0,q().o)()?(0,p.jsx)("div",{style:{paddingTop:8},children:(0,p.jsx)(O().VC,{error:o,sentryId:r})}):null]}),(0,p.jsxs)(N().Ye,{gap:8,children:[null!==(t=i.currentUser)&&void 0!==t&&t.isLoggedIn()?(0,p.jsx)(j().A,{size:"lg",onClick:()=>{M().oo({environment:i,url:"/home",callback:n})},focused:!0,children:(0,p.jsx)(s().sA,{id:"router.renderErrorPage.homeButton.label",defaultMessage:"Back to my content"})}):null,(0,p.jsx)(B().A,{size:"lg",onClick:()=>window.location.reload(),children:(0,p.jsx)(s().sA,{defaultMessage:"Refresh",id:"router.renderErrorPage.reloadButton.label"})})]})]})}const W={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingBottom:100,...(0,T().xH)(a().locale)},K={maxWidth:"100%",padding:"0px 16px",fontSize:14,textAlign:"center",marginTop:6,marginBottom:12,color:L().Ay.uiGray};var F=()=>n(56366),V=()=>n(401497),$=(n(944114),n(803949),n(581454),()=>n(284371)),G=()=>n(901389),H=()=>n(963589),J=()=>n(597368),Z=()=>n(364280),Y=()=>n(939740),Q=()=>n(676007),X=()=>n(505108),ee=()=>n(89924),te=()=>n(132389);function ne(e){let{items:t,selectType:n,selectAlignXAxis:o,selectedKeys:r,setSelectedKeys:i}=e;const a=t.map(((e,a)=>{const s=e.key;return(0,p.jsx)(oe,{text:e.text,description:e.description,selected:r[s]??!1,isBelowButtons:Boolean(e.showBelowButtons),isLastItem:a===t.length-1,onSelect:t=>{var o;null===(o=e.onSelect)||void 0===o||o.call(e,t),i("radio"===n?t=>{const n={...t};return Object.keys(n).forEach((t=>{n[t]=t===e.key})),n}:e=>({...e,[s]:t}))},selectType:n,selectAlignXAxis:o},s)}));return(0,p.jsxs)(Z().VP,{children:[(0,p.jsx)(te().A,{size:5}),a]})}function oe(e){let{text:t,description:n,selected:r,onSelect:i,isBelowButtons:a,selectType:s="checkbox",selectAlignXAxis:c,isLastItem:l}=e;const d=(0,o.useCallback)((()=>{"radio"===s?null==i||i(!0):null==i||i(!r)}),[s,i,r]);return(0,p.jsx)(X().a,{label:t,description:n,isSelected:r,value:"select_item",width:a?"hug":"fill",colorName:a?"secondary":"primary",style:{marginBottom:l?0:12,...a?{justifyContent:"center",border:"none"}:{}},selectType:s,selectAlignXAxis:c,onChange:d})}const re=function(){const e=(0,o.useId)(),t=(0,o.useId)(),{open:r,innerStyle:i,keepFocus:a,mode:c,message:u,debugInfo:m,description:f,items:v,selectionItems:g,showCancel:h,showCloseButton:b,renderDraftCommentIcon:S,icon:w,allowCopy:A,selectType:k,selectAlignXAxis:I}=(0,F().K8)((()=>{const{open:e,innerStyle:t,keepFocus:n,mode:o,message:r,debugInfo:i,description:a,items:s,selectionItems:c,showCancel:l,showCloseButton:d,shouldRenderDraftCommentIcon:u,icon:p,allowCopy:m,selectType:f,selectAlignXAxis:v}=J().A.state;return{open:e,innerStyle:t,keepFocus:n,mode:o,message:r,debugInfo:i,description:a,items:s,selectionItems:c,showCancel:l,showCloseButton:d,renderDraftCommentIcon:u,icon:p,allowCopy:m,selectType:f,selectAlignXAxis:v}}),[]),C=(0,o.useCallback)((()=>{G().zw();const{handleCancel:e}=J().A.state;return e&&e(),!1}),[]),_=(0,o.useCallback)((()=>{const{disableBackgroundDismiss:e}=J().A.state;e||C()}),[C]),x=(0,H().X)("update_dialog_styles"),E=(0,V().IS)((e=>{const t={width:"100%",...!x&&{marginTop:8}};return{plainButton:{...t,marginBottom:"-12px",justifyContent:"center",borderRadius:6},button:{...t,borderRadius:6},description:{color:e.text.secondary,...!x&&{paddingTop:6,paddingBottom:6},textWrap:"pretty"},debugMessage:{paddingTop:10,fontSize:12,color:e.text.tertiary,textAlign:f?"unset":"center"},overflowWrap:{overflowWrap:"break-word"},modal:{overflow:"hidden",width:"wide"===c?406:324,marginLeft:24,marginRight:24,padding:20,boxShadow:e.shadowLG,background:e.modalBackground,borderRadius:12,fontSize:16,alignItems:"center",justifyContents:"center",...i},message:{textAlign:f?"unset":"center",fontWeight:$().Wy.semibold,textWrap:"pretty"},iconContainer:{width:"100%",display:"flex",justifyContent:"center",marginBottom:10,fill:e.icon.secondary},buttonContainer:{...x?{padding:0,gap:8}:{padding:0}}}}),[f,i,c,x]),[T,P]=(0,o.useState)({});(0,o.useEffect)((()=>{const e={};null==g||g.forEach((t=>{e[t.key]=t.preSelected??!1})),P(e)}),[g]);const L=(0,o.useCallback)((()=>{const o=v.map(((e,t)=>({key:t,render:t=>"plain"===e.buttonType?(0,p.jsx)(n(493823).p,{size:"lg",ariaLabel:e.ariaLabel,hovered:t.focused,isRed:"red"===e.color,isBlue:"blue"===e.color,isGray:"gray"===e.color,style:E.plainButton,className:e.className,...t,children:e.label||"Label"}):"solid"===e.buttonType?"gray"===e.color?(0,p.jsx)(n(843189).E,{size:"lg",ariaLabel:e.ariaLabel,hovered:t.focused,style:E.button,className:e.className,...t,children:e.label||"Label"}):(0,p.jsx)(B().A,{size:"lg",ariaLabel:e.ariaLabel,hovered:t.focused,style:E.button,className:e.className,isRed:"red"===e.color,...t,children:e.label||"Label"}):(0,p.jsx)(j().A,{size:e.isSmall?"sm":"lg",ariaLabel:e.ariaLabel,hovered:t.focused,style:E.button,color:"red"===e.color?"uiRed":"blue"===e.color?"uiBlue":void 0,className:e.className,...t,children:e.label||"Label"}),action:()=>{var t;null===(t=e.onClick)||void 0===t||t.call(e),e.onAccept&&(e.onAccept(g?T:void 0),G().zw())}})));h&&o.push({key:"cancel",render:e=>(0,p.jsx)(j().A,{size:"lg",hovered:e.focused,style:E.button,...e,children:(0,p.jsx)(s().sA,{id:"genericDialogModal.cancelButton.label",defaultMessage:"Cancel"})}),action:()=>{C()}});const r=(null==g?void 0:g.filter((e=>!e.showBelowButtons)))??[],i=r.length>0?(0,p.jsx)(ne,{items:r,selectType:k,selectAlignXAxis:I,selectedKeys:T,setSelectedKeys:P}):void 0,a=(null==g?void 0:g.filter((e=>e.showBelowButtons)))??[],c=a.length>0?(0,p.jsx)(ne,{items:a,selectType:k,selectAlignXAxis:I,selectedKeys:T,setSelectedKeys:P}):void 0;let x;m&&(null!=m&&m.messagePrefix?x=`${m.messagePrefix}: ${m.message}`:d().A.isAdminMode&&(x=(0,p.jsx)(s().sA,{id:"dialogRenderer.debugMessage.messagePrefix",defaultMessage:"Debug message: {message}",values:{message:m.message}})));const L=y().default.checkGate({gateName:"update_dialog_styles"});return(0,p.jsx)(n(700180).A,{capture:!0,preventType:n(756279).A.All,children:(0,p.jsxs)("div",{style:E.overflowWrap,children:[b&&(0,p.jsx)(n(313633).A,{onClick:_}),S&&(0,p.jsx)(n(359848).h,{}),w&&(0,p.jsx)("div",{style:E.iconContainer,children:w}),A&&(0,p.jsx)(n(527606).k,{enable:!0,shortcuts:{copy:l().D_},debugName:"DialogRenderer.allowCopy"}),L?(0,p.jsxs)(n(84817).Y1,{direction:"vertical",gap:24,children:[u&&(0,p.jsx)("div",{style:E.message,id:e,children:u}),x&&(0,p.jsx)("div",{style:E.debugMessage,children:x}),f&&(0,p.jsx)("div",{style:E.description,id:t,children:f}),i&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(te().A,{size:20}),i,(0,p.jsx)(te().A,{size:8})]}),(0,p.jsx)(Y().Ay,{type:Y().Oh.Vertical,priority:1,initialFocus:0,resetFocusOnMouseOut:!0,sections:[{key:"dialog",render:e=>(0,p.jsx)(ee().A,{topBorder:!1,disableMobileBorders:!0,style:E.buttonContainer,...e}),items:o}]}),c&&c]}):(0,p.jsxs)(p.Fragment,{children:[u&&(0,p.jsx)("div",{style:E.message,id:e,children:u}),x&&(0,p.jsx)("div",{style:E.debugMessage,children:x}),f&&(0,p.jsx)("div",{style:E.description,id:t,children:f}),i&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(te().A,{size:20}),i,(0,p.jsx)(te().A,{size:8})]}),(0,p.jsx)(Y().Ay,{type:Y().Oh.Vertical,priority:1,initialFocus:0,resetFocusOnMouseOut:!0,sections:[{key:"dialog",render:e=>(0,p.jsx)(ee().A,{topBorder:!1,disableMobileBorders:!0,style:E.buttonContainer,...e}),items:o}]}),c&&(0,p.jsx)(p.Fragment,{children:c})]})]})})}),[v,h,g,k,I,T,m,E.overflowWrap,E.iconContainer,E.message,E.debugMessage,E.description,E.plainButton,E.button,E.buttonContainer,b,_,S,w,A,u,e,f,t,C]);return(0,p.jsx)(Q().a,{ariaLabelledBy:e,ariaDescribedBy:t,open:r,keepFocus:a,overlayZIndex:9999999,onDismiss:_,preventHideChildrenWhileOpening:!0,innerStyle:E.modal,render:L})};var ie=()=>n(657924),ae=()=>n(575650),se=()=>n(991699),ce=()=>n(545206),le=()=>n(331542);const de=function(){const e=(0,F().O$)(se().A);return(0,p.jsx)(Q().a,{open:e.open,render:()=>(0,p.jsx)(pe,{}),overlayZIndex:9999})};function ue(e){return{display:"flex",alignItems:"center",fontSize:14,color:e.text.secondary}}function pe(){const e=(0,V().DP)(),t=((0,g().v3)(),(0,F().O$)(se().A)),{targetRecordId:n}=t,o=(0,F().K8)((()=>function(e){return void 0!==e&&Boolean(ce().A.state[e])}(n)),[n]);return t.open?(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:180,padding:"18px 24px 20px",textAlign:"center",maxWidth:d().A.isMobile?"300px":"100%"},children:[(0,p.jsxs)("div",{style:ue(e),children:[t.message,(0,p.jsx)(le().A,{style:{marginLeft:6}})]}),o&&n&&(0,p.jsx)(ae().A,{targetRecordId:n,style:{marginTop:10}})]}):null}var me=()=>n(49210),fe=()=>n(38337),ve=()=>n(567121),ge=()=>n(948914),he=()=>n(100584),be=()=>n(877050),Se=()=>n(851650),ye=()=>n(661179);function we(){const e=(0,o.useRef)(null),t=(0,V().DP)().mode,n=(0,V().IS)((()=>({container:{display:"block",position:"fixed",visibility:"hidden",overflowY:"scroll",width:20,height:20}})),[]);return(0,o.useEffect)((()=>{const n=e.current;if(!n)return;const o=new ResizeObserver((e=>{const[n]=e,o=20-n.contentRect.width;o!==ye().A.state&&(ye().A.setState(o),Se().u7(t))}));return o.observe(n),()=>{o.unobserve(n)}}),[t]),(0,p.jsx)("div",{style:n.container,ref:e})}function Ae(e){let{children:t}=e;const n=(0,g().v3)(),r=(0,V().DP)();(0,o.useEffect)((()=>{const{mobileNative:e}=n;null==e||e.markTransitionReady({environment:n,type:"mount"})}),[n]);const i="light"===r.mode?fe().fRh:fe().Rsl,s=(0,_().kg)(),c=(0,_().n_)(),l=(0,_().lC)(),u=(0,F().K8)((()=>{var e;const t=n.RouterStore.state.route;return Boolean(null===(e=ge().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)||(0,be().Em)(t.name)}),[n]),m={inert:(0,F().K8)((()=>!d().A.isMobile&&he().A.state.openModals.size>0),[])?"true":null},f=(0,V().IS)((e=>({root:{...(0,T().xH)(a().locale),color:e.text.primary,WebkitFontSmoothing:"auto",backgroundColor:u?"rgba(0, 0, 0, 0)":e.contentBackground,transition:"height 0.1s ease",...s&&c&&l&&{height:`calc(100% - ${ve().ls}px)`}},content:{height:"100%"}})),[s,c,l,u]);return(0,p.jsxs)("div",{style:f.root,className:["notion-app-inner",i].join(" "),children:[(0,p.jsx)("div",{style:f.content,...m,children:t}),(0,p.jsx)(ie().A,{}),(0,p.jsx)(re,{}),(0,p.jsx)(de,{}),(0,p.jsx)(me().b,{}),(0,p.jsx)(we,{})]})}var ke=()=>n(9991),Ie=()=>n(554279),Ce=()=>n(172385),_e=()=>n(590265),xe=()=>n(861017),Ee=()=>n(427704),Te=()=>n(854150),Pe=()=>n(677338),Le=()=>n(734459),Ue=()=>n(502492),Me=()=>n(939768),Re=()=>n(946141),je=()=>n(915086),Be=()=>n(209660),De=()=>n(5705),Ne=()=>n(836285),Oe=()=>n(942906),qe=()=>n(755199),ze=()=>n(555267),We=()=>n(534177),Ke=()=>n(449506);var Fe=()=>n(296798);const Ve=function(e){const t=(0,V().DP)(),o={width:42,height:42,flexShrink:0,flexGrow:0};return(0,p.jsxs)("div",{style:{width:"100vw",height:"90vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[(0,p.jsx)(Fe().A,{href:Ee().JZ.root,innerStyle:{padding:8,borderRadius:4,marginBottom:2},children:"light"===t.mode?(0,n(426388).S)(o):(0,n(517592).A)(o)}),(0,p.jsx)("div",{style:{maxWidth:320,paddingLeft:18,paddingRight:18},children:e.children})]})};function $e(e){let{payload:t}=e;const n=(0,g().v3)(),[r,i]=(0,o.useState)(t?{type:"unconfirmed"}:{type:"error"}),a=(0,o.useCallback)((async()=>{if((0,S().v)(n,"button_clicked",{button_name:"unsubscribe_confirm",flow_id:void 0}),!t)return void i({type:"error"});i({type:"loading"});const e=await async function(e){let{environment:t,payload:n}=e;const o=await Ke().callApi({eventName:"unsubscribeFromEmails",environment:t,data:{payload:n}});return"success"===o.type?{type:"success",spaceName:o.data.spaceName}:{type:"error"}}({environment:n,payload:t});i("error"===e.type?{type:"error"}:{type:"confirmed",spaceName:e.spaceName})}),[n,t]),c=(0,V().IS)((()=>({confirmUnsubscribeDescription:{marginBottom:10}})),[]);switch(r.type){case"loading":return(0,p.jsx)(Ve,{children:(0,p.jsx)(s().sA,{defaultMessage:"Loadingâ€¦",id:"confirmUnsubscribePage.loadingMessage"})});case"unconfirmed":return(0,p.jsxs)(Ve,{children:[(0,p.jsx)("div",{style:c.confirmUnsubscribeDescription,children:(0,p.jsx)(s().sA,{defaultMessage:"Are you sure you want to unsubscribe from this list?",id:"unsubscribeFromEmails.workspace.confirmUnsubscribeDescription"})}),(0,p.jsx)(B().A,{size:"lg",onClick:a,children:(0,p.jsx)(s().sA,{id:"confirmUnsubscribePage.confirmButton",defaultMessage:"Unsubscribe"})})]});case"confirmed":return(0,p.jsx)(Ve,{children:(0,p.jsx)(s().sA,{defaultMessage:"You have successfully unsubscribed from emails for {workspaceName}",values:{workspaceName:(0,p.jsx)("b",{children:r.spaceName})},id:"unsubscribeFromEmails.workspace.message"})});case"error":return(0,p.jsx)(Ve,{children:(0,p.jsx)(s().sA,{id:"confirmUnsubscribePage.errorMessage",defaultMessage:"Could not unsubscribe."})});default:(0,We().HB)(r)}}var Ge=()=>n(645873);const He=new(Ge().O2)("desktopEmailConfirmPage",(()=>n.e(32568).then(n.bind(n,822821)))),Je=(0,Ge()._h)(He,(e=>e.default));var Ze=()=>n(236005),Ye=()=>n(969339),Qe=()=>n(404482);function Xe(e){const{preventFrontRedirect:t}=e,n=(0,g().v3)(),{pathname:o,search:r,hash:i}=window.location;if(!t&&(0,Qe().D8)(n,o)){const e=r.length>0?`${r}&${Ze().Kr}=1`:`?${Ze().Kr}=1`;return window.location.href=o+e+i,null}return(0,p.jsx)(Ye().C6,{isSignup:!n.currentUser.isLoggedIn()})}const et=function(e){const t={position:"absolute",top:0,left:0,bottom:0,right:0};return(0,g().v3)().currentUser.isLoggedIn()?(0,p.jsx)("div",{style:t,children:(0,p.jsx)(n(378765).A,{style:{width:"100%",height:"100%"},legacySpinnerSize:n(54362).Kh,showSpinnerTimeout:500})}):null};var tt=()=>n(688149),nt=()=>n(903659),ot=()=>n(696746),rt=()=>n(665579),it=()=>n(765957);function at(e){let{children:t}=e;const n=(0,g().v3)(),o=(0,V().DP)(),r=(0,F().K8)((()=>{var e;const{mainEditorCurrentBlockStore:t}=it().default.state,r=(0,ot().lU)(t),i=n.device.isPhone;return{width:"100vw",height:"100%",position:"relative",display:"flex",flex:1,background:Boolean(null===(e=ge().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)||(0,be().Em)(n.RouterStore.state.route.name)?"rgba(0, 0, 0, 0)":r?(0,rt().Lu)({theme:o,isPhone:i}):o.contentBackground}}),[n,o]);return(0,p.jsx)(nt().A,{style:r,children:t})}var st=()=>n(253849);function ct(){const e=(0,F().O$)(it().default),t=(0,V().IS)((e=>({container:{width:"100%",height:"100%",padding:16},notification:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",padding:16,backgroundColor:e.cardContentBackground,boxShadow:e.shadowMD,borderRadius:6},button:{width:"100%",appearance:"none",border:0,outline:0,backgroundColor:"transparent"}})),[]);return(0,o.useLayoutEffect)((()=>{U().meetingNotificationReady()}),[]),(0,p.jsxs)(at,{children:[(0,p.jsx)("div",{style:t.container,children:(0,p.jsx)("div",{style:t.notification,children:(0,p.jsx)("button",{style:t.button,onClick:()=>{U().closeMeetingNotification()},children:"Close"})})}),"rendered"===e.renderPhase?(0,p.jsx)(st().S,{}):void 0]})}const lt=function(e){let{redirect:t,callbackType:n}=e;const r=(0,V().DP)(),i=(0,g().v3)();return(0,o.useEffect)((()=>{dt({redirect:t,environment:i,callbackType:n})}),[i,t,n]),(0,p.jsxs)(Ve,{children:[(0,p.jsx)("div",{style:{color:r.text.primary},children:"nativemailredirect"===n?(0,p.jsx)(s().sA,{id:"webApp.redirectingToMailDesktop.message",defaultMessage:"Redirecting to your Notion Mail appâ€¦"}):"nativecalendarredirect"===n?(0,p.jsx)(s().sA,{id:"webApp.redirectingToCalendarDesktop.message",defaultMessage:"Redirecting to your Notion Calendar appâ€¦"}):(0,p.jsx)(s().sA,{defaultMessage:"Redirecting to your Notion appâ€¦",id:"webApp.redirectingToDesktop.message"})}),(0,p.jsx)(Fe().A,{onClick:()=>dt({redirect:t,environment:i,callbackType:n}),style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:r.text.tertiary},children:(0,p.jsx)(s().sA,{defaultMessage:"If you weren't redirected, click here.",id:"webApp.redirectingToDesktop.directLink.message"})}),(0,p.jsx)(Fe().A,{href:t,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:L().Ay.uiGray},children:(0,p.jsx)(s().sA,{defaultMessage:"Or, continue in your browser",id:"webApp.redirectingToDesktop.continueInBrowser.message"})})]})};function dt(e){let{redirect:t,environment:n,callbackType:o}=e;M().eG({url:t,environment:n,callbackType:o})}var ut=()=>n(433052),pt=()=>n(755636);function mt(){const e=(0,g().v3)();return(0,E().l)((()=>{const t=Ue().kb({schemeUrl:window.location.href,baseUrl:d().A.domainBaseUrl});pt().f({environment:e,url:t}),ut().Aj(),M().oo({environment:e,url:Ee().JZ.root,redirect:!0})})),null}var ft=()=>n(901459);function vt(){const e=(0,g().v3)(),t=(0,F().K8)((()=>C().Qr(e)),[e]),n=(0,F().K8)((()=>C().X4(e).shouldShowError),[e]),o=(0,F().O$)(it().default),r=C().tR(e);return(0,p.jsxs)(at,{children:[t&&!n&&r&&(0,p.jsx)(ft().Z,{parentStore:t,quickSearchMode:!0}),"rendered"===o.renderPhase&&(0,p.jsx)(st().S,{})]})}const gt=new(Ge().O2)("CreatorProfile",(()=>Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(42838),n.e(27634),n.e(74728),n.e(78205),n.e(49353),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(43678),n.e(15019),n.e(21194),n.e(33882),n.e(78862),n.e(11721),n.e(37160),n.e(40200)]).then(n.bind(n,716428)))),ht=(0,Ge()._h)(gt,(e=>e.CreatorProfile)),bt={CreatorProgram:new(Ge().O2)("CreatorProgram",(()=>Promise.all([n.e(34709),n.e(58251)]).then(n.bind(n,115147))))},St=(0,Ge()._h)(bt.CreatorProgram,(e=>e.CreatorProgram));var yt=()=>n(10289);const wt=new(Ge().O2)("Onboarding",(async()=>Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(22900),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(93282),n.e(43678),n.e(15019),n.e(90978),n.e(3910),n.e(77213),n.e(68137),n.e(7203),n.e(29669),n.e(34420),n.e(98942),n.e(45016)]).then(n.bind(n,220082)))),At=(0,Ge()._h)(wt,(e=>e.Onboarding)),kt=new(Ge().O2)("settingsConsole",(async()=>await Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(90825),n.e(49889),n.e(97727),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(34877),n.e(84185),n.e(32421),n.e(15315),n.e(78708),n.e(74752),n.e(6266),n.e(21194),n.e(30291),n.e(12913),n.e(52836),n.e(50569),n.e(40925),n.e(282),n.e(93847),n.e(76690),n.e(33882),n.e(44763),n.e(5044),n.e(19596)]).then(n.bind(n,506005)))),It=(0,Ge()._h)(kt,(e=>e.OrganizationSettingsConsole));var Ct=()=>n(682497);const _t=new(Ge().O2)("githubStudentPack",(()=>Promise.all([n.e(34709),n.e(54564)]).then(n.bind(n,875519)))),xt=(0,Ge()._h)(_t,(e=>e.default)),Et=new(Ge().O2)("LocalizedTemplates",(async()=>{const{default:e}=await Promise.all([n.e(58550),n.e(37353),n.e(74728),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(28271),n.e(45683),n.e(27991),n.e(13278),n.e(11721),n.e(77177),n.e(79239)]).then(n.bind(n,881532));return{LocalizedTemplates:e}})),Tt=(0,Ge()._h)(Et,(e=>e.LocalizedTemplates)),Pt={AddAnotherAccountLoginPage:new(Ge().O2)("AddAnotherAccountLoginPage",(async()=>await Promise.all([n.e(44711),n.e(35837),n.e(19687),n.e(25049),n.e(30873),n.e(20488)]).then(n.bind(n,918481))))},Lt=(0,Ge()._h)(Pt.AddAnotherAccountLoginPage,(e=>e.default));var Ut=()=>n(171510);const Mt=new(Ge().O2)("StartupsApplication",(async()=>Promise.all([n.e(34709),n.e(47057)]).then(n.bind(n,346780)))),Rt=(0,Ge()._h)(Mt,(e=>e.default)),jt={LennyApplication:new(Ge().O2)("LennyApplication",(()=>Promise.all([n.e(34709),n.e(86279)]).then(n.bind(n,254612))))},Bt=(0,Ge()._h)(jt.LennyApplication,(e=>e.LennyApplication));var Dt=()=>n(630116);const Nt=new(Ge().O2)("StudentGroupSignup",(async()=>Promise.all([n.e(34709),n.e(84969)]).then(n.bind(n,544719)))),Ot=(0,Ge()._h)(Nt,(e=>e.default));var qt=()=>n(350648),zt=()=>n(802790),Wt=()=>n(125565),Kt=()=>n(898808);const Ft=function(e){const{teamStore:t}=e,n=(0,g().v3)(),{teamName:o}=(0,F().K8)((()=>({teamName:t.getName()})),[t]),r=(0,V().IS)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:$().Wy.semibold,fontSize:20,margin:10},subtitle:{color:e.text.secondary,fontSize:18,padding:12},divider:{maxWidth:280},rightButton:{fontWeight:$().Wy.semibold,marginLeft:10}})),[]);return(0,p.jsxs)("div",{style:r.container,children:[(0,p.jsx)(Kt().x,{store:t,disabled:!0,size:55}),(0,p.jsx)("div",{style:r.title,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.page.title",defaultMessage:"You've been invited to join {teamName}",values:{teamName:o}})}),(0,p.jsx)("div",{style:r.subtitle,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.page.subtitle",defaultMessage:"You can access the content in the teamspace if you join the teamspace."})}),(0,p.jsxs)("div",{style:r.buttonContainer,children:[(0,p.jsx)(B().A,{size:"lg",onClick:async()=>{const e=n.currentUser.id;if(!e)return;const o={type:"member",entity_type:"user",user_id:e};await qt().e2({environment:n,userId:e,teamStore:t,user:o}),Re().pi(n,{store:t,selection:"yes"})},children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.joinTeam.label",defaultMessage:"Join teamspace"})}),(0,p.jsx)(j().A,{size:"lg",style:r.rightButton,onClick:async()=>{Re().pi(n,{store:t,selection:"no"}),await qt().YT({environment:n})},children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,p.jsx)(zt().A,{size:48,innerStyle:r.divider}),(0,p.jsx)(Wt().A,{isSmall:!0,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkJoinPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})};function Vt(e){const{teamStore:t,teamName:n,onRequestClick:o}=e,r=(0,g().v3)(),i=(0,V().IS)((e=>({buttonContainer:{marginTop:15,display:"flex",justifyContent:"space-between"},container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},title:{fontWeight:$().Wy.semibold,fontSize:20,margin:10},subtitle:{color:e.text.secondary,fontSize:18},divider:{maxWidth:280},rightButton:{fontWeight:$().Wy.semibold,marginLeft:10}})),[]);return(0,p.jsxs)("div",{style:i.container,children:[(0,p.jsx)(Kt().x,{store:t,disabled:!0,size:55}),(0,p.jsx)("div",{style:i.title,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.title",defaultMessage:"Request access to {teamName}",values:{teamName:n??$t()}})}),(0,p.jsx)("div",{style:i.subtitle,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.subtitle",defaultMessage:"You can access this teamspace if a teamspace owner approves your request."})}),(0,p.jsxs)("div",{style:i.buttonContainer,children:[(0,p.jsx)(B().A,{size:"lg",onClick:o,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.requestAccess.label",defaultMessage:"Request access"})}),(0,p.jsx)(j().A,{size:"lg",style:i.rightButton,onClick:async()=>{await qt().YT({environment:r})},children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.backToMyContentButton.label",defaultMessage:"Back to my content"})})]}),(0,p.jsx)(zt().A,{size:48,innerStyle:i.divider}),(0,p.jsx)(Wt().A,{isSmall:!0,children:(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.contact.message",defaultMessage:"Please contact your workspace owner for any questions."})})]})}function $t(){return(0,p.jsx)(s().sA,{id:"teamInviteLinkRequestPage.privateTeamspace.label",defaultMessage:"Private Teamspace"})}const Gt=function(e){const{teamStore:t}=e,[r,i]=(0,o.useState)(!1),{teamName:a}=(0,F().K8)((()=>({teamName:t.getName()})),[t]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Vt,{teamStore:t,teamName:a,onRequestClick:()=>i(!0)}),(0,p.jsx)(n(149257).A,{teamStore:t,teamName:a??$t(),teamId:t.id,isModalOpen:r,onDismiss:()=>i(!1)})]})};function Ht(e){const{teamAccessLevel:t,teamStore:n}=e;switch(t){case"open":return(0,p.jsx)(Ft,{teamStore:n});case"closed":case"private":return(0,p.jsx)(Gt,{teamStore:n})}}const Jt=function(e){const{teamId:t}=e,r=(0,g().v3)(),i=(0,F().K8)((()=>new(Dt().h4)(r,{table:Te().yK,id:t})),[r,t]),[{value:a}]=(0,n(187174).Yb)((async()=>await qt().D2({environment:r,teamId:t})),[r,t]);(0,o.useEffect)((()=>{!0===(null==a?void 0:a.isValidTeamRequest)&&null!=a&&a.isTeamMember&&(async()=>{var e;const t=null===(e=r.currentUser)||void 0===e?void 0:e.id;t&&i&&await qt().g({environment:r,userId:t,teamStore:i})})()}),[r,i,a]);const s=(0,V().IS)((()=>({container:{display:"flex",justifyContent:"center",height:"100%"}})),[]);return a?(0,p.jsx)("div",{style:s.container,children:a.isValidTeamRequest?(0,p.jsx)(Ht,{teamStore:i,teamAccessLevel:a.teamAccessLevel}):"nonSpaceMember"===a.invalidRequestReason?(0,p.jsx)(Ct().o,{route:{name:"teamsInvite",teamId:t},publicPageData:void 0}):(0,p.jsx)(Ct().o,{route:{name:"notFound"},publicPageData:void 0})}):null};var Zt=()=>n(662453),Yt=()=>n(650829);const Qt={chatSidebar:new(Ge().O2)("chatSidebar",(()=>Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(43678),n.e(15019),n.e(93373),n.e(2703)]).then(n.bind(n,942646)))),chatSidebarActions:new(Ge().O2)("chatSidebarActions",(async()=>await Promise.resolve().then(n.bind(n,118078)))),chatSidebarHelpers:new(Ge().O2)("chatSidebarHelpers",(async()=>await Promise.resolve().then(n.bind(n,890754))))},Xt=(0,Ge()._h)(Qt.chatSidebar,(e=>e.ChatSidebar));var en=()=>n(762014);function tn(e){return(0,p.jsx)("div",{id:"test-customer-io",style:{width:334,height:200,position:"absolute",bottom:64,right:21,zIndex:1,display:e?void 0:"none"}})}const nn=function(){const e=(0,g().v3)(),{currentUser:t}=e,n=(0,F().K8)((()=>t.isLoggedIn()),[t]),r=(0,F().K8)((()=>it().default.state.inAppCalloutStore),[]),i=(0,F().K8)((()=>"dark"!==e.ThemeStore.state.mode),[e]);(0,o.useEffect)((()=>{n&&(r.getCalloutVisibility("customer_io").canShow?i?en().A.state.suppressReason===en().e.IN_APP_CALLOUT_CONFLICT?en().A.setState({...en().A.state,isVisible:!0,suppressReason:void 0}):en().A.setState({...en().A.state,suppressReason:void 0}):en().A.setState({isVisible:!1,suppressReason:en().e.DARK_MODE}):en().A.setState({isVisible:!1,suppressReason:en().e.IN_APP_CALLOUT_CONFLICT}))}),[r,n,i]);const a=(0,F().K8)((()=>en().A.state.isVisible&&r.getCalloutVisibility("customer_io").canShow),[r]);return(0,o.useEffect)((()=>{if(a)return r.updateCalloutStatus({calloutId:"customer_io",visible:!0}),()=>{r.updateCalloutStatus({calloutId:"customer_io",visible:!1})}}),[r,a]),n?tn(!!a):null};var on=()=>n(309770),rn=()=>n(953006);const an=(0,s().YK)({pressSlashHeader:{id:"EducationTooltips.pressSlash.header",defaultMessage:"Press {slashkey} for commands"}});function sn(e){return(0,p.jsx)("div",{style:{background:L().Ay.whiteWithAlpha(.1),padding:3,paddingRight:8,paddingLeft:8,marginRight:6,marginLeft:6,borderRadius:4},children:e.char})}function cn(){const e=(0,g().v3)(),t=on().U();return(0,F().K8)((()=>{const{currentUserSettingsStore:e}=it().default.state;var t;return!e||!e.isReady()||Boolean(null===(t=e.getSettings())||void 0===t?void 0:t.pressed_slash_tooltip)}),[])||d().A.isMobile||!t?null:(0,p.jsx)(rn().k,{hideCloseButton:!0,origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,p.jsx)(s().sA,{...an.pressSlashHeader,values:{slashkey:(0,p.jsx)(sn,{char:"/"})}}),content:null,onCloseClick:()=>on().P(e)})}const ln=new(Ge().O2)("InPageFind",(async()=>Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(43678),n.e(15019),n.e(28958)]).then(n.bind(n,452148)))),dn=(0,Ge()._h)(ln,(e=>e.InPageFind)),un=new(Ge().O2)("KeyboardShortcutsModal",(()=>n.e(19512).then(n.bind(n,445326)))),pn=(0,Ge()._h)(un,(e=>e.KeyboardShortcutsModal)),mn=new(Ge().O2)("ForkPageModalWrapper",(async()=>await Promise.all([n.e(95794),n.e(28271),n.e(27761)]).then(n.bind(n,325435)))),fn=(0,Ge()._h)(mn,(e=>e.ForkPageModalWrapper)),vn=new(Ge().O2)("SecondarySidebar",(async()=>await Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(43678),n.e(15019),n.e(26942),n.e(38583),n.e(95281)]).then(n.bind(n,918048)))),gn=(0,Ge()._h)(vn,(e=>e.SecondarySidebar)),hn=new(Ge().O2)("SpaceSettings",(async()=>Promise.all([n.e(75134),n.e(9304),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(62475),n.e(3151),n.e(98629),n.e(49889),n.e(97727),n.e(22900),n.e(85128),n.e(95555),n.e(14659),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(93282),n.e(43678),n.e(15019),n.e(90978),n.e(3910),n.e(77213),n.e(6912),n.e(21194),n.e(30291),n.e(39541),n.e(12913),n.e(45620),n.e(54220),n.e(19930),n.e(81768),n.e(58102),n.e(52836),n.e(26483),n.e(19687),n.e(6463),n.e(68137),n.e(50569),n.e(40925),n.e(24975),n.e(282),n.e(87250),n.e(93847),n.e(79928),n.e(7203),n.e(61349),n.e(55197),n.e(94256),n.e(76690),n.e(29669),n.e(24930),n.e(62573),n.e(33882),n.e(44763),n.e(1440),n.e(5044),n.e(31782),n.e(93449),n.e(63996),n.e(895),n.e(66559),n.e(35986),n.e(45683),n.e(78862),n.e(38536),n.e(92924),n.e(64819),n.e(67378),n.e(40186),n.e(97339),n.e(55717),n.e(63797),n.e(56352),n.e(52811),n.e(28398),n.e(21367),n.e(65351),n.e(22686),n.e(4112),n.e(31889),n.e(36009),n.e(81973),n.e(2600),n.e(77663),n.e(97832),n.e(75681)]).then(n.bind(n,683195)))),bn=(0,Ge()._h)(hn,(e=>e.SpaceSettings));var Sn=()=>n(549500),yn=()=>n(47170),wn=()=>n(249847),An=()=>n(891360);function kn(){const e=(0,g().v3)(),t=(0,yn().O)(),n=(0,wn().T)(),r=(0,o.useCallback)((async()=>{if(!t||!n)return;const o=await Ke().callApi({eventName:"getTranscriptionUsage",environment:e,data:{spaceId:t}});if("success"===o.type){const e=o.data;"rateLimited"===e.type?An().W.setState({type:"rateLimited",retryAfterSec:e.retryAfterSec}):"available"===e.eligibility?An().W.setState({type:"available",usage:e.usage,limit:e.limit}):"unavailable"===e.eligibility?An().W.setState({type:"unavailable"}):(0,We().HB)(e.eligibility)}}),[e,t,n]);return(0,o.useEffect)((()=>{r()}),[r,t,n]),null}var In=()=>n(753035),Cn=()=>n(449789),_n=()=>n(965142);const xn=new(Ge().O2)("Marketplace",(async()=>{const{default:e}=await Promise.all([n.e(58550),n.e(37353),n.e(74728),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(28271),n.e(45683),n.e(27991),n.e(13278),n.e(11721),n.e(77177),n.e(79239)]).then(n.bind(n,395201));return{Marketplace:e}})),En=(0,Ge()._h)(xn,(e=>e.Marketplace));const Tn={WorkspaceDiscovery:new(Ge().O2)("WorkspaceDiscovery",(async()=>Promise.all([n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(22114),n.e(55072)]).then(n.bind(n,89336))))},Pn=(0,Ge()._h)(Tn.WorkspaceDiscovery,(e=>e.WorkspaceDiscovery));var Ln=()=>n(869562),Un=()=>n(644914),Mn=()=>n(749687),Rn=()=>n(430483),jn=(n(16280),()=>n(244641)),Bn=()=>n(604341);async function Dn(e,t){const n=await Ke().callApi({eventName:"stripeGetTestClock",environment:t,data:{spaceId:e}});if("success"===n.type){if("advancing"===n.data.status)throw new Error("Test clock is advancing. Please try again in a few seconds.");return n.data.epochSeconds}}async function Nn(e){const{environment:t,spaceId:n,advanceTestClockArgument:o}=e;if(o)return"number"==typeof o?o:"function"==typeof o?await async function(e){const{environment:t,spaceId:n,callback:o}=e,r=await Dn(n,t);if(r)return o(r)}({environment:t,spaceId:n,callback:o}):"object"==typeof o?await async function(e){const{environment:t,spaceId:n,durationLike:o}=e,r=await Dn(n,t);if(!r)return;const i=jn().c9.fromSeconds(r),a=jn().dw.fromDurationLike(o);return i.plus(a).toSeconds()}({environment:t,spaceId:n,durationLike:o}):void 0}var On=()=>n(726562);const qn={FullPageAIChatLoader:new(Ge().O2)("FullPageAIChatLoader",(()=>Promise.all([n.e(55373),n.e(98659),n.e(58596)]).then(n.bind(n,116882))))},zn=(0,Ge()._h)(qn.FullPageAIChatLoader,(e=>e.FullPageAIChatLoader));var Wn=()=>n(857639),Kn=()=>n(824622),Fn=()=>n(836251),Vn=()=>n(311337),$n=()=>n(26468),Gn=()=>n(362749),Hn=()=>n(817411),Jn=()=>n(155959),Zn=()=>n(227440);function Yn(){const e=(0,g().v3)(),{isPhone:t,isTablet:n}=(0,g().Y0)(),o=(0,F().K8)((()=>(0,Un().KB)(e)),[e]),r=(0,Jn().T)("supportsNativeHome"),i=(0,F().K8)((()=>(0,Vn().y)(e)),[e]);return t||n&&i?r?(0,p.jsx)(Kn().As,{}):(0,p.jsx)(Gn().Nd,{}):(0,p.jsx)(Qn,{isExpanded:o})}function Qn(e){let{isExpanded:t}=e;const n=(0,g().v3)(),r=n.device.isElectronMac,i=(0,F().K8)((()=>void 0!==C().rp(n).state),[n]),a=(0,F().K8)((()=>(0,Fn().w6)(n)),[n]),s=(0,F().K8)((()=>(0,$n().j)(n)),[n]);!function(e){const{isLoaded:t,isOnPublicPage:n,isOnPublicShareLinkPage:r}=e,i=(0,o.useRef)();(0,o.useEffect)((()=>(i.current=setTimeout((()=>{const e={level:"error",from:"SidebarContentContainer",type:"sidebarLoadingTimeout",error:{message:`Sidebar took longer than ${Xn/1e3} seconds to load.`},data:{miscDataToConvertToString:{isOnline:Zn().A.state.online,hasCurrentSpaceStore:Boolean(it().default.state.currentSpaceStore),hasCurrentSpaceViewStore:Boolean(it().default.state.currentSpaceViewStore),hasCurrentUserRootStore:Boolean(it().default.state.currentUserRootStore),hasCurrentUserSettingsStore:Boolean(it().default.state.currentUserSettingsStore),documentVisibilityState:document.visibilityState,isOnPublicPage:n,isOnPublicShareLinkPage:r}}};U().electronApi?U().logErrorForOffline(e):Wn().log(e),i.current=void 0}),Xn),()=>{i.current&&(clearTimeout(i.current),i.current=void 0)})),[n,r]),(0,o.useEffect)((()=>{t&&i.current&&(clearTimeout(i.current),i.current=void 0)}),[t])}({isLoaded:i,isOnPublicPage:a,isOnPublicShareLinkPage:s});const c=(0,o.useCallback)((()=>(0,p.jsx)(Hn().A,{skipFadeinDelay:!0})),[]),{isTablet:l}=(0,g().Y0)();return(0,p.jsx)(Gn().YZ,{isElectronMac:r,isTablet:l,isExpanded:t,renderLoading:c,forceRenderLoading:!i&&!(a||s)})}const Xn=9e4;var eo=()=>n(949054);const to={viewBox:"0 0 20 20",fittedViewBox:"1.87 3.47 16.26 12.66",directional:!0,svg:(0,p.jsx)("path",{d:"M12.231 4.969A.875.875 0 1 1 13.47 3.73l4.4 4.4a.875.875 0 0 1 0 1.238l-4.4 4.4a.875.875 0 1 1-1.238-1.238l2.906-2.906H6a2.375 2.375 0 1 0 0 4.75h1.42a.875.875 0 0 1 0 1.75H6a4.125 4.125 0 1 1 0-8.25h9.138z"})},no=(0,n(340498).wt)("arrowUTurnUpRightFill",to);var oo=()=>n(145214),ro=()=>n(704152);function io(){const e=(0,g().v3)(),t=(0,F().K8)((()=>(0,Un().KB)(e)),[e]),n=(0,F().O$)(Mn().sidebarWidthStore),[r,i]=(0,o.useState)(!1),a=(0,o.useRef)(null),c=(0,V().IS)((e=>({container:{background:t?"light"===e.mode?e.surface.wash:e.surface.elevated:void 0,height:68,position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1e3},skipLink:{position:"absolute",left:12,top:12,width:200,height:48,overflow:"hidden",zIndex:9999,padding:12,background:e.blueButtonBackground,color:"white",textAlign:"center",textDecoration:"none",borderRadius:16},buttonHoveredStyle:{background:e.blueButtonHoveredBackground},buttonPressedStyle:{background:e.blueButtonPressedBackground}})),[t]);return(0,p.jsx)(oo().A,{tag:"div",animate:{width:n,translateY:r?0:-100},style:c.container,children:(0,p.jsx)(ro().A,{style:c.skipLink,hoveredStyle:c.buttonHoveredStyle,pressedStyle:c.buttonPressedStyle,href:"#main",id:"skip-to-content",ref:a,onClick:()=>{const e=document.getElementById("main");if(e){const t=(0,eo().Kr)(e);t.length>0&&t[0].focus()}i(!1)},onFocus:()=>{i(!0)},onBlur:()=>{i(!1)},children:(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[(0,p.jsx)(s().sA,{defaultMessage:"Skip to content",id:"skipToContent.skipToContent"}),no({width:20})]})})})}const ao=(0,Ge()._h)(new(Ge().O2)("NotionBanners",(()=>Promise.all([n.e(64387),n.e(18406)]).then(n.bind(n,918406)))),(e=>e.default)),so=new(Ge().O2)("NotionModals",(()=>Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(49889),n.e(97727),n.e(22900),n.e(85128),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(43678),n.e(15019),n.e(21194),n.e(30291),n.e(12913),n.e(52836),n.e(19687),n.e(68137),n.e(50569),n.e(40925),n.e(282),n.e(87250),n.e(93847),n.e(7203),n.e(94256),n.e(76690),n.e(29669),n.e(33882),n.e(44763),n.e(5044),n.e(895),n.e(45683),n.e(78862),n.e(38536),n.e(67378),n.e(4112),n.e(36500)]).then(n.bind(n,519851)))),co=(0,Ge()._h)(so,(e=>e.default));const lo=function(e){let{routerState:t}=e;const r=(0,g().v3)();(0,o.useEffect)((()=>{var e;if(null!==(e=r.mobileNative)&&void 0!==e&&e.api.appComponentMountState)return r.mobileNative.api.appComponentMountState(!0),()=>{var e;null!==(e=r.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&r.mobileNative.api.appComponentMountState(!1)}}),[r]);const{route:i}=t,a=(0,F().O$)(it().AppStoreMainEditorCurrentBlockStore),s=(0,F().K8)((()=>n(792415).A.state.publicPageData),[]),{shouldShowSidebar:c,shouldShowFrame:l,shouldShowError:u,shouldRedirectFromHome:m}=(0,F().K8)((()=>C().X4(r)),[r]),f=(0,F().K8)((()=>"page"===i.name&&In().A.state.open&&(0,n(731320).K1)(In().A.state.blockStore)),[i.name]),v=(0,n(539412).x9)(),h=(0,F().K8)((()=>Rn().zD.isAiHomeModuleEnabled()),[]),b=(0,F().K8)((()=>{const{currentSpaceStore:e}=it().default.state,t=null==e?void 0:e.getModel();return void 0===t||t.isTranscriptionEnabled()}),[]),S=(0,F().K8)((()=>{const{device:e}=r;return"chat"!==i.name&&("marketplace"!==i.name&&("workspaceDiscovery"!==i.name&&("meet"!==i.name&&(!On().eX.state&&(!On().tA.state&&(!On().Zl.state&&(!v&&((!h||null==a||!a.isType(n(700500).xd.personalHomePage))&&Rn().zD.shouldShowAssistantInCorner(e)))))))))}),[r,i.name,v,a,h]),y=(0,F().K8)((()=>{const{device:e}=r;return!!e.isMobileNative&&("page"===i.name?Rn().zD.isXMLAssistantEnabled():void 0)}),[r,i.name]),w=(0,F().K8)((()=>c&&!(0,Un().tv)(r)&&Mn().sidebarOpenStore.state),[r,c]),A=(0,F().K8)((()=>(0,n(574506).t)()),[]),k=(0,F().K8)((()=>(0,n(68465).ZE)(void 0)),[]),I=(0,F().K8)((()=>it().default.state.renderPhase),[]),_=(0,n(255824).a)(),x=(0,n(877051).V)();!function(){const e=["local","staging","development"].includes("production"),t=(0,g().v3)();(0,o.useEffect)((()=>{e&&((0,Bn().exposeDebugValue)("refreshTestClock",(async()=>{var e;const n=null===(e=it().default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(n){const e=await Dn(n,t);if(e){const t=jn().c9.fromSeconds(e);console.log(`Test clock time is ${t.toString()} (${e} seconds)`)}}})),(0,Bn().exposeDebugValue)("advanceTestClock",(async e=>{var n;if(!e)throw new Error("advanceTestClock requires an argument. You can pass an epoch timestamp in seconds, a relative DurationLike object like { months: 2 }, or a function that takes the current epoch seconds and returns the new epoch seconds.");const o=null===(n=it().default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!o)return;const r=await Nn({environment:t,spaceId:o,advanceTestClockArgument:e});r&&await Ke().callApi({eventName:"stripeAdvanceTestClock",environment:t,data:{spaceId:o,epochSeconds:r}})})))}),[e,t])}();const E=(0,H().X)("skip_to_content_btn"),T=(0,H().X)("workflows_mini_agent");return(0,p.jsxs)(at,{children:[E?(0,p.jsx)(io,{}):void 0,c?(0,p.jsx)(Yn,{}):void 0,l&&(a||_||"team"===i.name||"meet"===i.name||"posts"===i.name)?(0,p.jsx)(On().Ay,{routerState:t}):void 0,_||"chat"!==i.name?void 0:(0,p.jsx)(zn,{route:i}),"marketplace"===i.name?(0,p.jsx)(En,{}):void 0,!x&&c?(0,p.jsx)(gn,{}):void 0,x?void 0:(0,p.jsx)(Xt,{}),f?(0,p.jsx)(fn,{}):void 0,!u&&!m||f?void 0:(0,p.jsx)(Ct().o,{route:t.route,publicPageData:s,shouldRedirectFromHome:m}),w?(0,p.jsx)(po,{}):void 0,(0,p.jsx)(nn,{}),!x&&S?(0,p.jsx)(Yt().LazyAssistantMenuPopup,{}):void 0,!x&&d().A.isMobile?(0,p.jsx)(Sn().IM,{}):void 0,!x&&b?(0,p.jsx)(kn,{}):void 0,!x&&y?(0,p.jsx)(Yt().LazyMobileAssistantPendingOperationsCollapsedElement,{}):void 0,!x&&S?(0,p.jsx)(Yt().LazyAssistantOriginElement,{}):void 0,x?void 0:(0,p.jsx)(dn,{}),!x&&k?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Zt().eE,{}),(0,p.jsx)(Zt().ZT,{})]}):void 0,A?(0,p.jsx)(cn,{}):void 0,"rendered"!==I||d().A.isMobile?null:(0,p.jsx)(n(532688).RK,{}),x?void 0:(0,p.jsx)(Sn().i6,{}),x?void 0:(0,p.jsx)(ao,{}),x?void 0:(0,p.jsx)(co,{}),!x&&T?(0,p.jsx)(n(849077).FU,{}):void 0,void 0,(0,p.jsx)(mo,{}),(0,p.jsx)(fo,{}),"workspaceDiscovery"===i.name?(0,p.jsx)(Pn,{}):void 0]})};function uo(){Ln().close()}function po(){const e=(0,g().v3)(),t=(0,F().K8)((()=>function(e){return{position:"absolute",top:0,left:(0,Un().r6)(e),right:0,bottom:0,zIndex:2}}(e)),[e]);return(0,p.jsx)("div",{style:t,onClick:uo})}function mo(){const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=(0,F().K8)((()=>{const{currentSpaceStore:e,currentUserStore:t,renderPhase:n}=it().default.state;return{currentSpaceStore:e,currentUserStore:t,renderPhase:n}}),[]);return e&&t&&"rendered"===n?(0,p.jsx)(bn,{spaceStore:e,userStore:t},`${e.id}-${null==t?void 0:t.id}`):null}function fo(){const e=(0,F().K8)((()=>Cn().W({store:_n().V})),[]),t=(0,o.useCallback)((()=>{Cn().j({store:_n().V})}),[]);return(0,p.jsx)(pn,{open:e,onDismiss:t})}function vo(){const e=(0,g().v3)();(0,o.useEffect)((()=>{!d().A.isAdminMode&&e.currentUser.isLoggedIn()&&it().default.waitUntil((()=>{const t=it().default.state.currentUserSettingsStore,n=(null==t?void 0:t.isDefined())??!1;if(t&&n){const n=t.getSettings(),o=null==n?void 0:n.disable_auto_set_timezone;n&&!o&&Oe().xw({environment:e,userSettingsStore:t})}return n}))}),[e]),(0,o.useEffect)((()=>{function t(){const{RouterStore:t,currentUser:n}=e,o=n.id;De().zd({historyId:t.state.id,currentUserId:o}),U().navigationReady(!1)}return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)}),[e]),(0,o.useEffect)((()=>{function t(t){var n,o;M().a0({currentUserId:null===(n=t.state)||void 0===n?void 0:n.currentUserId,id:null===(o=t.state)||void 0===o?void 0:o.id},e)}return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)}),[e]),(0,E().l)((()=>{U().subscribeToProtocolUrl((t=>function(e,t){bo("string"==typeof e?e:e.url,!1,!1,t)}(t,e))),U().subscribeToSettingsMenuItem(ho),U().navigationReady(!0),U().onNewWindow(((t,n)=>{M().oo({environment:e,url:n,openInNew:"tab"})}))})),(0,o.useEffect)((()=>{e.mobileNative&&e.mobileNative.subscribeToOpenLink(((t,n,o)=>bo(t,n,o,e)))}),[e]);const t=(0,F().O$)(e.RouterStore);(0,o.useEffect)((()=>{var e;"root"===t.route.name||"page"===t.route.name||"space"===t.route.name||"posts"===t.route.name||"blank"===t.route.name&&0===(null===(e=t.historyState)||void 0===e?void 0:e.index)||(je().setInitialRenderCompleted(),it().default.setState({...it().default.state,renderPhase:"rendered"}))}),[t]),(0,o.useEffect)((()=>{e.currentUser.isLoggedIn()||"page"===t.route.name||"space"===t.route.name||Ie().u4({device:e.device,event:{facebook:{eventName:"PageView",data:{content_name:window.location.href}},google:{eventName:"pageView",path:window.location.pathname}},cookieService:e.cookieService})}),[e.cookieService,e.currentUser,e.device,t.route.name]),(0,o.useEffect)((()=>{const t=it().default.state.currentUserSettingsStore;e.currentUser.isLoggedIn()&&t&&qe().Sz(e,t)}),[e]);const{device:r}=e;if(r.isNative&&xe().L7[t.route.name])return(0,p.jsx)(mt,{});if("front"===t.route.name)return(0,p.jsx)(Xe,{preventFrontRedirect:t.route.alreadyRedirected});if("root"===t.route.name)return(0,p.jsx)(et,{route:t.route});if("nativeRedirect"===t.route.name||"nativeMailRedirect"===t.route.name||"nativeCalendarRedirect"===t.route.name)return(0,p.jsx)(lt,{redirect:t.route.redirect,callbackType:"nativeMailRedirect"===t.route.name?"nativemailredirect":"nativeCalendarRedirect"===t.route.name?"nativecalendarredirect":"nativeredirect"});if("login"===t.route.name)return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Ut().AuthSyncListener,{}),(0,p.jsx)(Ye().HQ,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL})]});if("login/calendar"===t.route.name||"login/mail"===t.route.name)return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Ut().AuthSyncListener,{}),(0,p.jsx)(Ye().HQ,{isSignup:!1,email:t.route.email,redirectURL:t.route.redirectURL,addAnotherAccount:Boolean(t.route.addAnotherAccount)})]});if("addAnotherAccount"===t.route.name)return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Ut().AuthSyncListener,{}),(0,p.jsx)(Lt,{redirectURL:t.route.redirectURL})]});if("desktopEmailConfirm"===t.route.name)return(0,p.jsx)(Je,{});if("teamsInvite"===t.route.name){const{teamId:n}=t.route;return Re().WO(e,{teamId:n}),(0,p.jsx)(tt().A,{fetch:async()=>{const t=new(Dt().h4)(e,{table:Te().yK,id:n});await t.load()},render:()=>(0,p.jsx)(Jt,{teamId:n})})}if("signup"===t.route.name)return(0,p.jsx)(Ye().HQ,{isSignup:!0,email:t.route.email,referrer:t.route.referrer});if("signup/calendar"===t.route.name||"signup/mail"===t.route.name)return(0,p.jsx)(Ye().HQ,{isSignup:!0,email:t.route.email,referrer:t.route.referrer,redirectURL:t.route.redirectURL,addAnotherAccount:Boolean(t.route.addAnotherAccount)});if("unsubscribe"===t.route.name)return(0,p.jsx)($e,{payload:t.route.payload});if("onboarding"===t.route.name)return(0,p.jsx)(At,{});if("upcomingInvoice"===t.route.name)return(0,p.jsx)(yt().Y,{route:t.route});if("invoiceById"===t.route.name)return(0,p.jsx)(yt().Y,{route:t.route});if("settingsConsoleOrganization"===t.route.name){if(e.currentUser.isLoggedIn())return(0,p.jsx)(It,{organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,params:t.route.params});{const e=(0,Le().re)({organizationId:t.route.organizationId,tabRoute:t.route.tabRoute,properties:t.route.properties,queryParams:t.route.params}),n=Me().Gm({url:`${d().A.domainBaseUrl}${Ee().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(go,{url:n})}}if(t.route.name,t.route.name,"admin"===t.route.name&&d().A.isAdminMode)return(0,p.jsx)(tt().A,{fetch:()=>Promise.all([n.e(64038),n.e(4422),n.e(76690),n.e(23930),n.e(19884)]).then(n.bind(n,472008)),render:e=>{let{Admin:t}=e;return(0,p.jsx)(t,{})}});if("adminListData"===t.route.name){const{category:e}=t.route;if(d().A.isAdminMode)return(0,p.jsx)(tt().A,{fetch:()=>Promise.all([n.e(64038),n.e(4422),n.e(76690),n.e(23930),n.e(19884)]).then(n.bind(n,876452)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{category:e})}})}if("adminSingleRecord"===t.route.name&&d().A.isAdminMode){const{id:e,table:o}=t.route;return(0,p.jsx)(tt().A,{fetch:()=>Promise.all([n.e(64038),n.e(4422),n.e(76690),n.e(23930),n.e(19884)]).then(n.bind(n,364233)),render:t=>{let{AdminSingleRecord:n}=t;return(0,p.jsx)(n,{table:o,id:e})}})}if("oauthAuthorization"===t.route.name){const{responseType:e,redirectUri:o,integrationId:r,state:i,owner:a,userId:s,spaceId:c}=t.route;return(0,p.jsx)(tt().A,{fetch:()=>Promise.all([n.e(75134),n.e(58550),n.e(4422),n.e(11341),n.e(34877),n.e(84185),n.e(32421),n.e(78862),n.e(67378),n.e(75104),n.e(9647)]).then(n.bind(n,362006)),render:t=>{let{OauthAuthorization:n}=t;return(0,p.jsx)(n,{responseType:e,redirectUri:o,integrationId:r,state:i,owner:a,userId:s,spaceId:c})}})}if("passkeyAuthVerify"===t.route.name){const{callbackType:e}=t.route;return(0,p.jsx)(tt().A,{fetch:()=>Promise.all([n.e(25049),n.e(66805)]).then(n.bind(n,471283)),render:t=>{let{VerifyPasskeyRedirectPage:n}=t;return(0,p.jsx)(n,{callbackType:e})}})}if("notionCalendarAuthorization"===t.route.name){const{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:i,state:a}=t.route;return(0,p.jsx)(tt().A,{fetch:()=>n.e(58777).then(n.bind(n,215627)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{csrf:e,calendarCsrf:o,redirectUri:r,spaceId:i,state:a})}})}if("globalOauthPostLogin"===t.route.name){const{clientId:e,redirectUri:o,state:r,responseType:i,scope:a}=t.route;return(0,p.jsx)(tt().A,{fetch:()=>Promise.all([n.e(75134),n.e(75104),n.e(56353)]).then(n.bind(n,881489)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{clientId:e,redirectUri:o,csrfState:r,responseType:i,scope:a})}})}if("passkeyRegistrationVerification"===t.route.name){const{callbackType:o,csrfToken:r,attemptId:i,options:a}=t.route;return(0,p.jsx)(tt().A,{fetch:()=>n.e(67045).then(n.bind(n,407485)),render:t=>{let{AddPasskeyRedirectPage:n}=t;return(0,p.jsx)(n,{environment:e,callbackType:o,csrfToken:r,attemptId:i,options:a})}})}if("initiateExternalAuthentication"===t.route.name){const{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,integration_id:c,redirectToAuth:l}=t.route;return(0,p.jsx)(tt().A,{fetch:()=>n.e(18071).then(n.bind(n,856425)),render:t=>{let{default:n}=t;return(0,p.jsx)(n,{notion_user_id:e,notion_workspace_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,integration_id:c,redirectToAuth:l})}})}if("initiateExternalAuthenticationFromDesktop"===t.route.name){const{redirectUri:o}=t.route;if(e.currentUser.isLoggedIn())return(0,p.jsx)(tt().A,{fetch:()=>n.e(58657).then(n.bind(n,465677)),render:e=>{let{default:t}=e;return(0,p.jsx)(t,{redirectUri:o})}});{const e=Me().Gm({url:`${d().A.domainBaseUrl}${Ee().JZ.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:o}}),t=Me().Gm({url:`${d().A.domainBaseUrl}${Ee().JZ.login}`,query:{redirectURL:e}});return Pe().TR(),(0,p.jsx)(go,{url:t})}}if("myIntegrations"===t.route.name)return(0,p.jsx)(go,{url:Ee().JZ.creatorProfileIntegrations});if("inAppTemplateSubmission"===t.route.name)return(0,p.jsx)(go,{url:Ee().JZ.creatorProfileTemplates});if("inAppTemplateCreatorSubmission"===t.route.name)return(0,p.jsx)(go,{url:Ee().JZ.creatorProfile});if("creatorProfile"===t.route.name||"creatorProfileTemplates"===t.route.name||"creatorProfileIntegrations"===t.route.name||"creatorProfileAnalytics"===t.route.name||"creatorProfileCoupons"===t.route.name){if(e.currentUser.isLoggedIn())return"pointer"in t.route?(0,p.jsx)(ht,{publish:Boolean(t.route.publish),lab:Boolean(t.route.lab),botOrIntegrationPointer:t.route.pointer}):(0,p.jsx)(ht,{publish:!1,lab:!1,botOrIntegrationPointer:void 0});{const e=Me().Gm({url:`${Ee().JZ[t.route.name]}`}),n=Me().Gm({url:`${d().A.domainBaseUrl}${Ee().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(go,{url:n})}}if("localizedTemplates"===t.route.name){if(e.currentUser.isLoggedIn())return(0,p.jsx)(Tt,{});{const e=Me().Gm({url:`${Ee().JZ[t.route.name]}`}),n=Me().Gm({url:`${d().A.domainBaseUrl}${Ee().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(go,{url:n})}}if("studentGroupSignup"===t.route.name)return(0,p.jsx)(Ot,{});if("startupsApplication"===t.route.name)return(0,p.jsx)(Rt,{formType:"startups"});if("smbsApplication"===t.route.name)return(0,p.jsx)(Rt,{formType:"smb"});if("lennyApplication"===t.route.name)return(0,p.jsx)(Bt,{});if("creatorProgramApplication"===t.route.name)return(0,p.jsx)(St,{});if("githubStudentPackHome"===t.route.name)return(0,p.jsx)(xt,{});if("notFound"===t.route.name)return(0,p.jsx)(Ct().o,{route:t.route,publicPageData:void 0});if("modal"===t.route.name&&!e.currentUser.isLoggedIn()&&(t.route.templateGalleryItem||t.route.projectManagementLaunch)){const e={};return t.route.projectManagementLaunch?e.tg="gallery":t.route.templateGalleryItem&&(e.tg=t.route.templateGalleryItem),(0,p.jsx)(go,{url:Ee().JZ.login,queryParams:e})}if("chat"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,Ce().X_)(t.route),n=(0,Me().Gm)({url:`${d().A.domainBaseUrl}${Ee().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(go,{url:n})}if("meet"===t.route.name&&!e.currentUser.isLoggedIn()){const e=Ee().JZ.meet,t=(0,Me().Gm)({url:`${d().A.domainBaseUrl}${Ee().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(go,{url:t})}if("marketplace"===t.route.name&&!e.currentUser.isLoggedIn()){const e=(0,_e().YD)(d().A,t.route),n=(0,Me().Gm)({url:`${d().A.domainBaseUrl}${Ee().JZ.login}`,query:{redirectURL:e}});return(0,p.jsx)(go,{url:n})}return"quickSearch"===t.route.name?(0,p.jsx)(vt,{}):"meetingNotification"===t.route.name?(0,p.jsx)(ct,{}):"page"===t.route.name||"space"===t.route.name||"nativeTab"===t.route.name||"modal"===t.route.name||"chat"===t.route.name||"meet"===t.route.name||"marketplace"===t.route.name||"team"===t.route.name||"posts"===t.route.name||"workspaceDiscovery"===t.route.name||"blank"===t.route.name?(0,p.jsx)(lo,{routerState:t}):(0,p.jsx)(ze().A,{})}function go(e){let{url:t,queryParams:n}=e;const r=(0,g().v3)(),i=(0,o.useRef)(!1);return(0,o.useEffect)((()=>{i.current||(i.current=!0,n&&Ne().I({currentUserId:void 0,params:n}),M().oo({environment:r,url:t,redirect:!0}))}),[r,n,t]),(0,p.jsx)(ze().A,{})}function ho(e){Be().Ow({currentTab:e})}function bo(e,t,n,o){const{RouterStore:r}=o,i=Ue().Q1({url:e,protocol:d().A.protocol,baseUrl:d().A.domainBaseUrl}),a=Ue().kb({schemeUrl:i,baseUrl:d().A.domainBaseUrl}),s=xe().parseRoute({url:a,baseUrl:d().A.domainBaseUrl,publicDomainName:d().A.publicDomainName,isMobile:Boolean(d().A.isMobile),protocol:d().A.protocol,currentUrl:window.location.href});(o.device.isAndroid||t)&&De().TC({RouterStore:r,currentUserId:o.currentUser.id}),o.mobileNative&&o.mobileNative.closeInAppBrowser(),"googleAuthCallback"!==s.name&&"samlAuthCallback"!==s.name&&"passkeyAuthCallback"!==s.name?M().oo({environment:o,url:a,redirect:t,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:n},queryId:"page"===s.name?s.queryId:void 0}):M().oo({environment:o,url:a})}const So=!1;function yo(e){let{environment:t,onMount:n}=e;const c=(0,o.useRef)(!1);(0,o.useEffect)((()=>{c.current||(c.current=!0,null==n||n())}),[n]),(0,o.useEffect)((()=>{C().jx()}),[]);const l=So?o.StrictMode:o.Fragment;return(0,p.jsx)(l,{children:(0,p.jsx)(r().aw,{value:t,children:(0,p.jsx)(k().k,{children:(0,p.jsxs)(i().wX,{children:[(0,p.jsx)(s().Dk,{defaultLocale:"en-US",locale:a().locale,messages:a().D,children:(0,p.jsx)(m,{...f(t.device),children:(0,p.jsx)(I().K,{fallback:e=>(0,p.jsx)(z,{...e}),from:"Router",type:"AppCrash",children:(0,p.jsxs)(A,{id:"app",targetRenderPhase:"mount",children:[(0,p.jsx)(ke().T,{}),(0,p.jsx)(Ae,{children:(0,p.jsx)(vo,{})})]})})})}),(0,p.jsx)(x,{})]})})})})}},652393:(e,t,n)=>{n.r(t),n.d(t,{initialize:()=>a});var o=()=>n(857639),r=()=>n(780054),i=()=>n(161132);function a(e){"object"==typeof r().A&&r().A.version&&(o().clientLogglyEnvironmentData.version=r().A.version);const{device:t,currentUser:n}=e;t.isMobileNative&&(o().clientLogglyEnvironmentData.isMobileNative=!0),t.isMobile&&(o().clientLogglyEnvironmentData.isMobile=!0),t.isAndroid&&(o().clientLogglyEnvironmentData.isAndroid=!0),t.isIOS&&(o().clientLogglyEnvironmentData.isIOS=!0),t.isElectron&&(o().clientLogglyEnvironmentData.isElectron=!0),t.isChromeExtension&&(o().clientLogglyEnvironmentData.isChromeExtension=!0),o().clientLogglyEnvironmentData.os=t.os,o().clientLogglyEnvironmentData.platform=t.platform,window.navigator.userAgent&&(o().clientLogglyEnvironmentData.userAgent=window.navigator.userAgent),document.referrer&&(o().clientLogglyEnvironmentData.referrer=document.referrer),n.id&&(o().clientLogglyEnvironmentData.userId=n.id),o().clientLogglyEnvironmentData.is_experimental_build="clientExperimental"===r().A.buildTarget,o().clientLogglyEnvironmentData.is_mobile_build="clientMobile"===r().A.buildTarget,(0,i().xs)().then((e=>{e&&(o().clientLogglyEnvironmentData.storageUsageEstimate=e.usage,o().clientLogglyEnvironmentData.storageQuotaEstimate=e.quota)}))}},657924:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(296540),r=()=>n(402014),i=()=>n(38337),a=()=>n(313790),s=n(474848);function c(e){const{overlayContainerStore:t,zIndex:n}=e,c=(0,o.useCallback)((e=>{(t??a().A).containerDomNodeStore.setState(e)}),[t]);return(0,s.jsx)("div",{ref:c,className:`${i().MUV} ${i().H1c}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:n??999,pointerEvents:"none",overflow:"hidden"},onMouseMove:e=>{(0,r().SQ)({event:e,context:r().y$.SidebarMouseMove,callback:()=>{}})},children:(0,s.jsx)("div",{style:{position:"relative",zIndex:0}})})}},667193:(e,t,n)=>{n.d(t,{p:()=>a});var o=()=>n(484714),r=()=>n(56366),i=()=>n(186445);function a(){const e=(0,o().v3)();return(0,r().O$)((0,i().rp)(e))}},682497:(e,t,n)=>{n.d(t,{o:()=>i});var o=()=>n(645873);const r=new(o().O2)("PageError",(async()=>Promise.all([n.e(44711),n.e(35837),n.e(19687),n.e(44763),n.e(22114),n.e(25049),n.e(30873),n.e(66960)]).then(n.bind(n,949571)))),i=(0,o()._h)(r,(e=>e.PageError))},756581:(e,t,n)=>{n.d(t,{C:()=>l,V:()=>c});var o=()=>n(47170),r=()=>n(249847),i=()=>n(963589),a=()=>n(329304),s=()=>n(722038);function c(){const e=(0,s().y)(),t=(0,i().X)("offline_monetization"),n=(0,o().O)(),c=(0,r().T)(),l=(0,a()._X)({name:"offline_auto_sync",spaceId:n,userId:c});if(e)return t?l:{expiry:void 0,limit:{type:"none"},type:"available",upsell:void 0}}function l(){const e=c();return Boolean("available"===(null==e?void 0:e.type))}},762014:(e,t,n)=>{n.d(t,{A:()=>i,e:()=>o});let o=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class r extends(()=>n(757695))().Store{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const i=new r},817411:(e,t,n)=>{n.d(t,{A:()=>u});n(581454),n(296540);var o=()=>n(484714),r=()=>n(56366),i=()=>n(401497);const a=[[2,1,3,1],[1,0,2,0],[0,2,0,3],[3,3,0,2],[1,1,2,2]];var s=()=>n(710149),c=()=>n(948914),l=()=>n(749687),d=n(474848);function u(e){let{skipFadeinDelay:t}=e;const{isElectronMac:n}=(0,o().Y0)(),u=(0,r().O$)(c().b),m=n&&!u,f=(0,r().O$)(l().sidebarExpandedStore),v=(0,r().K8)((()=>f?l().sidebarWidthStore.state:0),[f]),g=(0,i().IS)((e=>{const t={width:20,height:20,borderRadius:4},n={height:10,minHeight:10,borderRadius:10};return{sidebar:{backgroundColor:e.surface.wash,boxShadow:e.sidebarBoxShadow,display:f?"flex":"none",minWidth:v,flexDirection:"column",padding:"12px 14px",overflow:"hidden"},heroSection:{paddingTop:m?36:0,marginBottom:22,display:"flex",alignItems:"center"},heroSectionIcon:{padding:"1px",...t,width:22,height:22},heroSectionTitle:{width:177,marginLeft:8,...n},toplevelMenu:{marginBottom:20,width:78,...n},toplevelMenuLast:{marginBottom:36,width:135,...n},sectionHeader:{marginBottom:14,width:56,...n},pageRow:{display:"flex",alignItems:"center",marginBottom:11},pageIcon:{...t},pageTitle:{marginLeft:8,...n}}}),[f,v,m]),h=(0,d.jsxs)("div",{style:g.heroSection,children:[(0,d.jsx)(s().A,{style:g.heroSectionIcon,emphasized:!0}),(0,d.jsx)(s().A,{style:g.heroSectionTitle,emphasized:!0})]}),b=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s().A,{style:g.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().A,{style:g.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().A,{style:g.toplevelMenu,emphasized:!0}),(0,d.jsx)(s().A,{style:g.toplevelMenuLast,emphasized:!0})]}),S=(0,d.jsx)(s().A,{style:g.sectionHeader,emphasized:!0}),y=a.map(((e,n)=>e.map(((e,o)=>(0,d.jsxs)("div",{style:{...!t&&p(n),...g.pageRow},children:[(0,d.jsx)(s().A,{style:g.pageIcon,emphasized:!0}),(0,d.jsx)(s().A,{style:{...g.pageTitle,width:80+20*e},emphasized:!0})]},`${n}-${o}`)))));return(0,d.jsxs)("div",{style:g.sidebar,children:[h,b,S,y]})}function p(e){return 0===e?{}:{animation:`1s ease-in ${e}s 1 normal both running fadein`}}},840125:(e,t,n)=>{n.r(t),n.d(t,{getCloseConfirmationDialogReason:()=>u,getUserControlledCloseConfirmationDialogReason:()=>d,setupOnBeforeUnload:()=>m,showConfirmationDialogEventEmitter:()=>c});n(16280);var o=()=>n(534177),r=()=>n(964345),i=()=>n(337567),a=()=>n(878423),s=()=>n(485634);const c=new(n(592328).A);let l;function d(){const e=u();switch(e){case"have_local_draft_unsaved_changes":case"dictation_in_progress":return e;case void 0:case"transaction_queue_has_tasks":case"uploading_files":case"generating_ai_completions":case"have_pending_ai_edits":case"have_pending_synced_collection_changes":return}(0,o().HB)(e)}function u(){if(!l)throw new Error("beforeUnloadHelpers.setupOnBeforeUnload() was not called!");return l()}const p="Changes you made may not be saved. Are you sure you want to quit?";function m(e){const{TransactionQueue:t,device:n,AppUpdateStore:o,GlobalFileUploadStore:d}=e;l=function(){return!t.hasTasks()||n.isMobileNative||n.isElectron||o.isMajorUpdate()?(0,i().A5)()?"have_pending_ai_edits":a().A.doesAnyCacheHaveUnsavedChanges()?"have_local_draft_unsaved_changes":d.isUploading()?"uploading_files":s().A.hasPendingSyncedCollectionChanges()?"have_pending_synced_collection_changes":r().gZ.state?"dictation_in_progress":void 0:"transaction_queue_has_tasks"},window.onbeforeunload=function(){const e=u();if(e)return c.emit(e),p}}},849077:(e,t,n)=>{n.d(t,{FU:()=>i,_s:()=>a,eV:()=>r});var o=()=>n(645873);const r=new(o().O2)("miniAgent",(()=>Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(93282),n.e(43678),n.e(15019),n.e(90978),n.e(77213),n.e(77773)]).then(n.bind(n,323367)))),i=(0,o()._h)(r,(e=>e.MiniAgentBackgroundTaskIndicator)),a=(0,o()._h)(r,(e=>e.MiniAgentObservePosition))},877050:(e,t,n)=>{n.d(t,{Em:()=>c,OH:()=>s});const o=class extends(()=>n(496506))().ComputedStore{},r=["nativeRedirect","page","space","nativeTab","onboarding","unsubscribe","unknown","uiDoc","desktopEmailConfirm","root","chat","posts","marketplace","team","gallery","settingsConsoleOrganization"],i=[...r,"login","login/calendar","signup","quickSearch","meetingNotification"],a=["meetingNotification"];function s(e){const{device:t,RouterStore:n,ThemeStore:a}=e;let s=r;return(t.isElectron||t.isElectronCalendar||t.isMobileNative)&&(s=i),new o((()=>{const e=n.state.route;return e&&s.includes(e.name)?a.state.mode:"light"}),{debugName:"ThemeModeStore"})}function c(e){return a.includes(e)}},884064:(e,t,n)=>{n.d(t,{_:()=>i});var o=()=>n(56366),r=()=>n(217429);function i(){return(0,o().K8)((()=>r().default.getConfigKey("offline_mode_sync_engine_config","update_source")),[])}},901459:(e,t,n)=>{n.d(t,{Z:()=>i});var o=()=>n(645873);const r=new(o().O2)("SearchModal",(async()=>Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(25497),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(93282),n.e(43678),n.e(15019),n.e(90978),n.e(3910),n.e(77213),n.e(5053)]).then(n.bind(n,307060)))),i=(0,o()._h)(r,(e=>e.Search))},903659:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(296540),r=()=>n(56366),i=()=>n(93658),a=n(474848);const s=function(e){const t=(0,n(484714).Y0)(),s=(0,r().K8)((()=>({initiator:n(353643).A.state.initiator,isDragging:n(861841).Ay.state.isDragging})),[]),c=(0,r().K8)((()=>i().default.state.isActive),[]),l=(0,r().K8)((()=>!!i().default.state.isActive&&i().default.state.moved?"default":s.isDragging?"-webkit-grabbing":"text"),[s.isDragging]),d=(0,o.useMemo)((()=>{let e="notion-cursor-listener";return"-webkit-grabbing"===l&&(e+=" notion-disable-local-cursor"),e}),[l]);return(0,o.useEffect)((()=>{t.isIOS&&("touch"===s.initiator||s.isDragging||c?document.body.classList.add("notion-disable-webkit-user-select"):document.body.classList.remove("notion-disable-webkit-user-select"))}),[t.isIOS,s.initiator,s.isDragging,c]),(0,a.jsx)("div",{style:{...e.style,cursor:l},className:d,children:e.children})}},933371:(e,t,n)=>{n.d(t,{X:()=>o});const o=n(757695).Store.createValue({shouldReset:!1},{name:"MobileAssistantMenuStore"})},942906:(e,t,n)=>{n.d(t,{Lj:()=>s,W2:()=>c,xw:()=>a});var o=()=>n(416504),r=()=>n(751156),i=()=>n(755199);function a(e){const{environment:t,userSettingsStore:n}=e,r=n.getSettings(),i=null==r?void 0:r.time_zone,a=(0,o().P)();i!==a&&s({environment:t,userSettingsStore:n,timeZone:a})}function s(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;r().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{i().mJ({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function c(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;r().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{i().mJ({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},987264:(e,t,n)=>{n.d(t,{s:()=>r});n(296540);var o=n(474848);const r=(0,n(340498).wt)("eyes",{viewBox:"0 0 72 72",svg:(0,o.jsx)("path",{d:"M17.0312 64.4375C26.25 64.4375 33.5625 52.9688 33.5625 36.4375C33.5625 19.9062 26.25 8.46875 17.0312 8.46875C7.8125 8.46875 0.5 19.9062 0.5 36.4375C0.5 52.9688 7.8125 64.4375 17.0312 64.4375ZM54.9688 64.4375C64.1875 64.4375 71.5 52.9688 71.5 36.4375C71.5 19.9062 64.1875 8.46875 54.9688 8.46875C45.75 8.46875 38.4375 19.9062 38.4375 36.4375C38.4375 52.9688 45.75 64.4375 54.9688 64.4375ZM10.0625 47.1875C15.125 47.1875 18.4688 43.6562 18.4688 38.3438C18.4688 33.0938 15.125 29.5625 10.0625 29.5625C7.6875 29.5625 5.71875 30.3125 4.25 31.6875C5.375 19.9375 10.6875 11.9375 17.0312 11.9062C24.25 11.875 30.125 22.0312 30.125 36.4375C30.125 50.7812 24.25 60.9688 17.0312 61C11.5312 61.0312 6.78125 54.9688 4.90625 45.5938C6.28125 46.625 8.03125 47.1875 10.0625 47.1875ZM47.9688 47.1875C53 47.1875 56.4062 43.6562 56.4062 38.3438C56.4062 33.0938 53 29.5625 47.9688 29.5625C45.5938 29.5625 43.5938 30.3438 42.1562 31.6875C43.2812 19.9375 48.5938 11.9375 54.9688 11.9375C62.1562 11.9062 68 22.0938 68 36.4375C68 50.7812 62.1562 60.9688 54.9688 60.9688C49.4375 61 44.6875 54.9375 42.7812 45.5938C44.1562 46.5938 45.9375 47.1875 47.9688 47.1875ZM45.5312 37.4062C44.4375 37.25 43.75 35.9688 44.0312 34.6562C44.3125 33.3125 45.3125 32.3438 46.375 32.5312C47.4688 32.75 48.0938 34.0312 47.8438 35.3125C47.5938 36.6562 46.5938 37.5938 45.5312 37.4062ZM7.625 37.4062C6.53125 37.25 5.84375 35.9688 6.09375 34.6562C6.375 33.3125 7.40625 32.3438 8.4375 32.5312C9.5625 32.7812 10.1875 34.0312 9.9375 35.3125C9.6875 36.6562 8.65625 37.5938 7.625 37.4062Z"})})},993893:(e,t,n)=>{n.d(t,{setupTransactionLoadGenerator:()=>c});var o=()=>n(604341),r=()=>n(319975),i=()=>n(751156),a=()=>n(765957),s=()=>n(24157);function c(e){(0,o().exposeDebugValue)("generateTransactionLoad",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const c=a().default.state.mainEditorCurrentBlockStore;if(!c)return void console.info("Cannot generateTransactionLoad: No current block");const l=c.getTitleStore();if(!l)return void console.info("Cannot generateTransactionLoad: block has no title");if("editing"!==s().default.state.mode)return void console.info("not editing anything. Click the page title.");const d=t=>{i().createAndCommit({userAction:"generateTransactionLoad.createTransaction",environment:e,canUndo:!0,perform:o=>{console.info("createAndCommit #",t);for(let i=0;i<n;i++){const n=`This is transaction #${t+1}, op ${i+1}, of load started at ${u}`;r().dw({environment:e,editorMode:"default",store:l,newValue:n,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}}})},u=new Date;if(0===o)for(let e=0;e<t;e++)d(e);else{let e=0;const n=setInterval((()=>{e<t?(d(e),e++):clearInterval(n)}),o)}}))}}}]);