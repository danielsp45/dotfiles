"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[14358],{596009:(e,n,t)=>{t.r(n),t.d(n,{arrowUpRightSquareFillIcon:()=>s,iconDefinition:()=>o});t(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"3.12 3.12 13.75 13.75",svg:(0,t(474848).jsx)("path",{d:"M5.25 3.125A2.125 2.125 0 0 0 3.125 5.25v9.5c0 1.174.951 2.125 2.125 2.125h9.5a2.125 2.125 0 0 0 2.125-2.125v-9.5a2.125 2.125 0 0 0-2.125-2.125zM7.875 7c0-.345.28-.625.625-.625H13c.345 0 .625.28.625.625v4.5a.625.625 0 1 1-1.25 0V8.509l-5.12 5.12a.625.625 0 1 1-.884-.883l5.12-5.121H8.5A.625.625 0 0 1 7.875 7"})},s=(0,t(340498).wt)("arrowUpRightSquareFill",o)},853306:(e,n,t)=>{t.d(n,{A:()=>j});t(581454);var o=t(296540),s=()=>t(662303),i=()=>t(56366),r=()=>t(401497),a=()=>t(66913),c=()=>t(284371),l=()=>t(115512),d=()=>t(141333),u=()=>t(265665),p=()=>t(484595),g=()=>t(704152),m=()=>t(864943),h=()=>t(204063),v=()=>t(125565),f=t(474848);const y=20;function x(e){var n;let{icon:a,iconStyle:u,title:p,subtitle:g,confirmText:x,confirmTextStyle:j="blue",confirmTextPerRadioOption:b,cancelText:C,hideCancelButton:w=!1,radioOptions:k,defaultSelectedRadioOption:A,onDismiss:I,onSelectRadio:M,onConfirm:T,width:N,footer:W}=e;const D=(0,t(484714).v3)(),[B,F]=(0,o.useState)(A??(null===(n=k[0])||void 0===n?void 0:n.key)),P=(0,i().uB)(void 0,t(17090).A),U=(0,i().K8)((()=>null==P?void 0:P.state.elementRef),[P]),z=(0,d().CR)(U),L=(0,d().yE)(U),E=(0,d().o7)(U),O=L>0,K=Math.ceil(L+E)<Math.floor(z),R=(0,o.useCallback)((e=>{e!==B&&(F(e),null==M||M(e))}),[M,B]),H=(0,o.useCallback)((()=>{T(B)}),[T,B]),q=(0,r().IS)((e=>{const n={marginLeft:-20,marginRight:-20,height:1,borderTop:`1px solid ${e.regularDividerColor}`,transition:"opacity 200ms"};return{container:{display:"flex",position:"relative",flexDirection:"column",justifyContent:"center",overflow:"hidden",width:`min(${N??400}px, calc(100vw - 40px))`,maxHeight:"80vh",padding:y,borderRadius:6,alignItems:"stretch"},icon:{width:36,height:36,fill:e.icon.secondary,marginBottom:6,...u},iconContainer:{width:"100%",display:"flex",justifyContent:"center"},title:{fontFamily:c().vc(s().locale).sans,fontSize:17,lineHeight:"22px",fontWeight:c().Wy.medium,textAlign:"center",marginBottom:14},subtitle:{fontFamily:c().vc(s().locale).sans,fontSize:(0,l().ny)(D,"UIRegular"),lineHeight:(0,l().ks)(D,"UIRegular"),fontWeight:c().Wy.regular,marginTop:6,marginBottom:6,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column",gap:8},topDivider:{...n,opacity:O?1:0},bottomDivider:{...n,opacity:K?1:0},scroller:{marginLeft:-20,marginRight:-20,paddingLeft:y,paddingRight:y},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{marginTop:8,justifyContent:"center"},dismissButton:{position:"absolute",top:10,right:10,zIndex:1}}}),[D,u,K,O,N]),G=(null==b?void 0:b[B])??x;return(0,f.jsxs)("div",{style:q.container,children:[(0,f.jsx)("div",{style:q.dismissButton,children:(0,f.jsx)(_,{onClick:I})}),a&&(0,f.jsx)("div",{style:q.iconContainer,children:a(q.icon)}),(0,f.jsx)(v().A,{isMultiline:!0,style:q.title,children:p}),g&&(0,f.jsx)(v().A,{isSmall:!0,style:q.subtitle,isMultiline:!0,children:g}),k.length>0&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{style:q.topDivider}),(0,f.jsx)(t(2143).H,{type:t(756279).A.Y,style:q.scroller,store:P,children:(0,f.jsx)("div",{style:q.radioContainer,children:k.map((e=>(0,f.jsx)(S,{radioItem:e,isSelected:e.key===B,onSelectRadio:R,left:e.left},e.key)))})}),(0,f.jsx)("div",{style:q.bottomDivider})]}),(0,f.jsxs)("div",{style:q.actionButtonsContainer,children:["blue"===j?(0,f.jsx)(h().A,{size:"lg",onClick:H,children:G}):"red"===j?(0,f.jsx)(h().A,{size:"lg",onClick:H,isRed:!0,children:G}):(0,f.jsx)(m().A,{size:"lg",onClick:H,children:G}),!w&&(0,f.jsx)(m().A,{size:"lg",onClick:I,style:q.cancelButton,children:C??(0,f.jsx)(t(959013).sA,{id:"radioModal.cancel",defaultMessage:"Cancel"})})]}),W]})}function _(e){let{onClick:n}=e;const t=(0,r().IS)((e=>({button:{display:"flex",justifyContent:"center",alignItems:"center",width:24,height:24,borderRadius:"100%",background:e.lightGrayButtonBackground},buttonHovered:{background:e.lightGrayButtonHoveredBackground},buttonPressed:{background:e.lightGrayButtonPressedBackground},closeIcon:{width:16,height:16,fill:e.icon.secondary}})),[]);return(0,f.jsx)(g().A,{style:t.button,hoveredStyle:t.buttonHovered,pressedStyle:t.buttonPressed,onClick:n,children:(0,a().V)(t.closeIcon)})}function S(e){let{radioItem:n,isSelected:t,onSelectRadio:o,left:s}=e;const i=(0,r().IS)((e=>({button:{display:"flex",justifyContent:"space-between",gap:10,height:"auto",minHeight:70,borderRadius:8,paddingTop:12,paddingBottom:12,paddingLeft:14,paddingRight:14-p().p,border:void 0,boxShadow:t?`inset 0 0 0 1px ${e.icon.uiBluePrimary}`:`inset 0 0 0 1px ${e.stroke.primary}`},buttonText:{display:"flex",flexDirection:"column",gap:2,...c().RC},optionTitle:{fontWeight:c().Wy.medium},optionSubtitle:{whiteSpace:"break-spaces"},left:{display:"flex",alignItems:"center",justifyContent:"center"}})),[t]);return(0,f.jsxs)(m().A,{size:"lg",onClick:()=>o(n.key),style:i.button,children:[s&&(0,f.jsx)("div",{style:i.left,children:s}),(0,f.jsxs)("div",{style:i.buttonText,children:[(0,f.jsx)(v().A,{style:i.optionTitle,children:(0,f.jsx)(u().j,{children:n.title})}),n.subtitle&&(0,f.jsx)(v().A,{isSmall:!0,isMultiline:!0,style:i.optionSubtitle,children:n.subtitle})]}),(0,f.jsx)(p().A,{isSelected:t})]})}const j=o.memo(x)},887480:(e,n,t)=>{t.d(n,{Ay:()=>s().A,yQ:()=>r});var o=()=>t(645873),s=()=>t(853306);const i=new(o().O2)("radioModalRenderer",(()=>t.e(35818).then(t.bind(t,415995)))),r=(0,o()._h)(i,(e=>e.default))},890494:(e,n,t)=>{t.d(n,{A:()=>r});t(296540);var o=()=>t(401497),s=()=>t(284371),i=t(474848);function r(e){const n=(0,o().IS)((n=>({numberCircleBaseStyle:{display:"flex",flexShrink:0,borderRadius:"100%",backgroundColor:e.isHighlighted?n.palette.uiBlue[600]:e.isLightBlueHighlighted?n.fill.uiBlueSecondary:"dark"===n.mode?n.palette.gray[300]:n.palette.gray[75],width:20,height:20,color:e.isHighlighted?"white":e.isLightBlueHighlighted?n.text.uiBluePrimary:n.palette.gray[600],textAlign:"center",alignItems:"center",justifyContent:"center",fontWeight:s().Wy.semibold,fontSize:"10px"}})),[e.isHighlighted,e.isLightBlueHighlighted]);return(0,i.jsx)("div",{style:{...n.numberCircleBaseStyle,...e.style},children:e.number})}},986235:(e,n,t)=>{t.r(n),t.d(n,{UniversalQnaModals:()=>Cs});var o=t(296540),s=()=>t(484714),i=()=>t(56366),r=()=>t(187174),a=()=>t(323714),c=()=>t(634877),l=()=>t(47170),d=()=>t(249847),u=()=>t(963589),p=()=>t(291075),g=()=>t(963702),m=()=>t(765957),h=()=>t(430483),v=()=>t(217429),f=()=>t(756315),y=()=>t(99254),x=()=>t(329304),_=()=>t(604018),S=()=>t(235195),j=()=>t(174636),b=(t(581454),()=>t(401497)),C=()=>t(654777),w=()=>t(959013),k=()=>t(284371),A=()=>t(449506),I=()=>t(874913),M=()=>t(2220),T=()=>t(704152),N=()=>t(890494),W=()=>t(676007),D=()=>t(21140),B=()=>t(836251),F=()=>t(866515),P=()=>t(51218),U=t(474848);function z(){const e=(0,s().v3)(),n=(0,b().IS)((e=>({wrapper:{width:400,gap:16,alignContent:"center"},waitingForConnectionWrapper:{gap:4},note:{fontWeight:k().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:e.text.secondary,justifyContent:"center",padding:4},buttonContainer:{justifyContent:"center"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),t=(0,i().K8)((()=>"connecting"===p().o.state.currentScreen),[]),r=(0,l().O)();(0,F().n)((async()=>{if(!r)return;if("connecting"!==p().o.state.currentScreen)return;const n=await A().callApi({eventName:"getGithubAIConnectorStatus",environment:e,data:{spaceId:r}});"success"===n.type&&n.data.isConnected&&p().o.setState({...p().o.state,currentScreen:"confirmation",externalSourceName:n.data.externalSourceName})}),1e3,!0);const a=(0,o.useCallback)((()=>[(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:n.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalQna.github.waitingForConnectionNoteHeading1",defaultMessage:"GitHub should open automatically on a new tab."},"note1-1")}),(0,U.jsx)("div",{style:n.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.github.waitingForConnectionNoteBody1",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:n.link,href:p().o.state.authUrl,target:"_blank",children:(0,U.jsx)(w().sA,{id:"universalQna.github.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:n.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.github.workspaceAdminHeading",defaultMessage:"If you are a GitHub organization administrator:"},"note2-2")}),(0,U.jsx)("div",{style:n.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.github.workspaceAdminBody",defaultMessage:"Follow GitHub's instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,U.jsxs)(D().wt,{style:{marginTop:16,gap:4},children:[(0,U.jsx)("div",{style:n.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.github.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,U.jsx)("div",{style:n.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.github.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to install the app. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[n]),c=(0,o.useCallback)((()=>{const n=(0,B().xS)("guides.aiConnectorGithub");(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_connecting_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),e.device.isElectron?I().openExternalUrl(n):window.open(n,"_blank")}),[e]),d=(0,o.useCallback)((()=>{p().o.reset(),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_connecting_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}})}),[e]);return(0,U.jsx)(W().a,{open:t,showCloseIcon:!0,onDismiss:d,render:()=>(0,U.jsxs)(D().wt,{style:n.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"github",title:(0,U.jsx)(w().sA,{id:"universalQnA.github.followInstructionsFromGithub",defaultMessage:"Follow instructions from GitHub in your browser"})}),(0,U.jsxs)(D().wt,{style:n.waitingForConnectionWrapper,children:[a().map(((e,t)=>(0,U.jsxs)(D().Ye,{gap:8,style:{marginTop:4,marginBottom:6,justifyContent:"center"},children:[(0,U.jsx)(N().A,{number:t+1}),(0,U.jsx)("div",{style:n.note,children:e})]},t))),(0,U.jsx)(D().Ye,{style:n.buttonContainer,children:(0,U.jsx)(T().A,{style:{marginTop:16,marginBottom:16,width:120,borderRadius:4},onClick:c,children:(0,U.jsxs)(D().Ye,{style:n.learnMoreButton,children:[(0,U.jsx)(w().sA,{id:"universalSearch.github.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,C().X)({width:16,height:16})]})})})]})]})})}var L=()=>t(176983),E=()=>t(453202),O=()=>t(991249),K=()=>t(162850),R=()=>t(970023),H=()=>t(436572),q=()=>t(270812);const G=(0,w().YK)({title:{defaultMessage:"Find anything across all of your apps with Notion AI",id:"NotionAIConnectorNonadminModal.title"},subtitleForAnnouncement:{defaultMessage:"Notify your workspace owner to use AI connectors.",id:"NotionAIConnectorNonadminModal.subtitleForAnnouncement"},learnMoreLink:{defaultMessage:"Learn more about",id:"NotionAIConnectorNonadminModal.learnMoreLink"},toast:{defaultMessage:"We will send a notification to your workspace owner",id:"NotionAIConnectorNonadminModal.toast"},alreadyRequestedToast:{defaultMessage:"You’ve previously notified your workspace owner - your request is in review.",id:"NotionAIConnectorNonadminModal.alreadyRequestedToast"}});function Y(){const e=(0,i().K8)((()=>E().O.state.open&&"nonadmin_request"===E().O.state.modal?{open:!0,analyticsFrom:E().O.state.analyticsFrom}:{open:!1}),[]),n=(0,o.useCallback)((()=>{E().O.setState({open:!1})}),[]);return e.open?(0,U.jsx)(J,{connector:"generic",handleClose:n,open:!0,analyticsFrom:e.analyticsFrom,setupSessionId:"none",messages:{...G,betaDisclaimer:{...R().gp.betaDisclaimer},ctaButtonLabelWithAddon:{...R().gp.ctaButtonLabelWithAddon},ctaButtonLabelWithoutAddon:{...R().gp.ctaButtonLabelWithoutAddon}}}):null}function J(e){const{open:n,handleClose:t,connector:i,analyticsFrom:r,setupSessionId:a,messages:c}=e,d=(0,w().tz)(),u=(0,s().v3)(),p=(0,L().J)(),g=(0,l().O)(),m=u.currentUser.id,h=(0,x()._X)({name:"ai_connectors",spaceId:g,userId:m}),{openModal:v,canUserRequestUpgrade:f}=(0,q().E)({type:"feature",featureAvailability:h,entrypoint:"ai_connectors_request_modal",analyticsEntrypoint:"ai_request_modal",isOptimisticUpsell:!1}),y=(0,o.useCallback)((e=>{let{source:n,upsell:o}=e;"closeButton"!==n?(r&&(0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"contact_workspace_owners",integration_type:i,setup_session_id:a,from:r}}}),o?f?(v(),t()):(t(),H().D6({label:(0,U.jsx)(w().sA,{...G.alreadyRequestedToast})})):(t(),H().D6({label:(0,U.jsx)(w().sA,{...G.toast})}))):t()}),[t,i,u,v,f,r,a]);return h?(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:()=>y({source:"closeButton",upsell:void 0}),open:n,ariaLabel:d.formatMessage(G.title),render:()=>(0,U.jsx)(K().Y,{aiConnectorsFeatureAvailability:h,calloutKey:void 0,eventName:"ai_connector_nonadmin_request_modal_shown",messages:c,onDismiss:y,connector:i,showNarrowCta:p})}):null}const Q={...R().gp,...G,...(0,w().YK)({subtitleForAnnouncement:{defaultMessage:"Upgrade your plan to use AI Connectors.",id:"NotionAIConnectorUpsellIntroModal.subtitleForAnnouncement"}})};function $(){const e=(0,s().v3)(),n=(0,L().J)(),{currentSpaceStore:t}=(0,i().O$)(m().default),r=null==t?void 0:t.id,a=e.currentUser.id,c=(0,x()._X)({name:"ai_connectors",spaceId:r,userId:a}),l=(0,w().tz)(),d=(0,i().O$)(E().O),u=d.open&&"ai_plan_upsell_admin_intro"===d.modal,p=(0,o.useCallback)((n=>{let{source:t,upsell:o}=n;E().O.setState({open:!1}),"closeButton"!==t&&o&&d.open&&"ai_plan_upsell_admin_intro"===d.modal&&(O().K(e,{from:"ai_connector_ai_upsell_intro_modal",upsell:o}),"generic"!==d.connector&&S().A.setState({...S().A.state,connectorTriggeringUpsell:d.connector,upsellTriggeredAt:Date.now()}))}),[e,d]);if(!u||!c)return null;const g=d.connector;return(0,U.jsx)(W().a,{ariaLabel:l.formatMessage(R().vK.title),open:u,render:()=>(0,U.jsx)(K().Y,{messages:Q,aiConnectorsFeatureAvailability:c,onDismiss:p,calloutKey:void 0,eventName:"ai_connector_ai_plan_upsell_intro_modal_opened",learnMoreHref:(0,B().xS)("guides.aiConnectors"),connector:g,showNarrowCta:n})})}var V=()=>t(534177),X=()=>t(915308),Z=()=>t(987267),ee=()=>t(204063);function ne(e){const n=(0,w().tz)(),{open:t,onDismiss:o,onConfirm:s,ariaLabel:i,title:r,subtitle:a,buttonLabel:c,connectorType:l}=e,d=(0,b().IS)((e=>({wrapper:{width:400,padding:"0px 20px 20px 20px"},button:{marginTop:20,width:"100%"}})),[]);return(0,U.jsx)(W().a,{ariaLabel:n.formatMessage(i),showCloseIcon:!0,onDismiss:o,open:t,render:()=>(0,U.jsxs)("div",{style:d.wrapper,children:[(0,U.jsx)(P().b,{connectorType:l,title:r,subtext:a}),(0,U.jsx)(ee().A,{size:"xl",style:d.button,onClick:s,children:c})]})})}const te=(0,w().YK)({title:{id:"universalSearch.authNeededModal.authNeededModalTitle",defaultMessage:"Authentication needed"},subtitle:{id:"universalSearch.authNeededModal.authNeededModalSubtitle",defaultMessage:"We couldn’t verify your {appName} e-mail. To get {appName} answers and results, please authenticate."},buttonLabel:{id:"universalSearch.authNeededModal.authNeededModalButtonLabel",defaultMessage:"Connect your account"}});function oe(){const{open:e,connector:n}=(0,i().K8)((()=>({open:E().O.state.open&&"auth_needed"===E().O.state.modal,connector:E().O.state.open&&"auth_needed"===E().O.state.modal?E().O.state.connector:"slack"})),[]),t=(0,s().v3)(),o=(0,l().O)(),r=(0,w().tz)();return(0,U.jsx)(ne,{ariaLabel:te.title,title:r.formatMessage(te.title,{appName:Z().w0[n]}),subtitle:r.formatMessage(te.subtitle,{appName:Z().w0[n]}),buttonLabel:r.formatMessage(te.buttonLabel),connectorType:n,onDismiss:()=>{E().O.setState({open:!1})},onConfirm:()=>(async e=>{o&&("github"===e?await X().tt({connector:e,environment:t,spaceId:o,analyticsProperties:{buttonName:"user_auth_connect",analyticsFrom:"ai_chat_scoped_search_menu"},onAuthSuccess:()=>{E().O.setState({open:!1})}}):"slack"===e?(X().tt({connector:e,environment:t,spaceId:o,analyticsProperties:{buttonName:"user_auth_connect",analyticsFrom:"ai_chat_scoped_search_menu"}}),E().O.setState({open:!1})):(0,V().HB)(e))})(n),open:e})}var se=()=>t(605777),ie=()=>t(864943),re=()=>t(125565);const ae=function(e){const{title:n,open:s,notes:i,connectorType:r,onDismiss:a,onConnect:l,onLearnMore:d,isLoading:u,overridePrimaryMessage:p,centerNotes:g,noteStyleOverrides:m,subtitle:h}=e,v=(0,w().tz)(),f=(0,b().IS)((e=>({wrapper:{width:400,paddingTop:8},dataSafetyWrapper:{width:"100%",justifyContent:"center",marginTop:8,padding:"0px 20px"},notes:{display:"flex",flexDirection:"column",marginTop:12,gap:12,font:k().Tf.sans,listStylePosition:"outside",paddingLeft:2,listStyleType:"none",...g&&{textAlign:"center",justifyContent:"center"}},note:{display:"flex",alignItems:"start",fontSize:k().J.UIRegular.desktop,lineHeight:k().K_.UIRegular.desktop,color:`${e.text.secondary}`,padding:2,gap:12,listStylePosition:"outside",marginBottom:4,...g&&{alignItems:"center",textAlign:"center",justifyContent:"center"},...m},noteIconWrapper:{display:"flex",alignItems:"center",justifyContent:"center"},noteTextWrapper:{display:"flex",flexDirection:"column",alignItems:"start",justifyContent:"center",gap:4},noteIcon:{width:20,height:20,color:e.palette.uiBlue[600]},noteTitle:{fontWeight:k().Wy.medium,textWrap:"pretty"},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"12px 20px 20px 20px",gap:6},connectButton:{width:"100%"},learnMoreButton:{width:"100%"}})),[g,m]),y=(0,o.useCallback)((()=>{const e=c().NT[r];e.setState({...e.state,currentScreen:"none"})}),[r]);return(0,U.jsx)(W().a,{ariaLabel:v.formatMessage({id:"universalSearch.integrations.introModalAriaLabel",defaultMessage:"AI connector introduction"}),showCloseIcon:!0,onDismiss:a,open:s,render:()=>(0,U.jsxs)("div",{style:f.wrapper,children:[(0,U.jsx)(P().b,{connectorType:r,title:n,subtext:h}),(0,U.jsx)(t(900615).f,{upgradeRequestAnalyticsEntrypoint:"ai_connector_modal",upgradeRequestEntrypoint:"ai_connectors_request_modal",sunsetCheckSource:"ai_connectors_modal",additionalOnClickUpgrade:y}),i&&(0,U.jsx)(D().Ye,{style:f.dataSafetyWrapper,children:(0,U.jsx)("ul",{style:f.notes,children:i.map(((e,n)=>(0,U.jsxs)("li",{style:f.note,children:[(0,U.jsx)("div",{style:f.noteIconWrapper,children:e.icon&&("function"==typeof e.icon?e.icon(f.noteIcon):e.icon)}),(0,U.jsxs)("div",{style:f.noteTextWrapper,children:[(0,U.jsx)(re().A,{isMultiline:!0,style:f.noteTitle,children:e.title}),e.description&&(0,U.jsx)(re().A,{isMultiline:!0,isSecondaryColor:!0,children:e.description})]})]},`note-${n}`)))})}),(0,U.jsxs)(D().wt,{style:f.footer,children:[(0,U.jsx)(ee().A,{size:"xl",isLoading:u,disabled:u,style:f.connectButton,onClick:l,children:p||(0,U.jsx)(w().sA,{id:"universalSearch.integration.startConnection",defaultMessage:"Start connection"})}),d&&(0,U.jsx)(ie().A,{size:"lg",iconLeading:se().bookIcon,style:f.learnMoreButton,onClick:d,children:(0,U.jsx)(w().sA,{id:"universalSearch.integrations.learnMore",defaultMessage:"Read our step-by-step guide"})})]})]})})};function ce(){const{open:e,connector:n}=(0,i().K8)((()=>({open:E().O.state.open&&"progress"===E().O.state.modal,connector:E().O.state.open&&"progress"===E().O.state.modal?E().O.state.connector:"slack"})),[]),t=Z().w0[n],o=()=>{E().O.setState({open:!1})};return(0,U.jsx)(ae,{onConnect:o,onDismiss:o,title:(0,U.jsx)(w().sA,{id:"universalSearchProgressModal.generalizedTitle",defaultMessage:"{connector} is connecting to Notion AI",values:{connector:t}}),connectorType:n,subtitle:(0,U.jsx)(w().sA,{id:"universalSearchProgressModal.subtitle",defaultMessage:"This can take up to 36hr.{br}You’ll be able to get answers soon.",values:{br:(0,U.jsx)("br",{})}}),overridePrimaryMessage:(0,U.jsx)(w().sA,{id:"universalSearchProgressModal.ctaMessage",defaultMessage:"Got it"}),centerNotes:!0,noteStyleOverrides:{fontSize:"14px"},open:e})}var le=()=>t(19575);const de={...R().gp,...(0,w().YK)({title:{defaultMessage:"Find anything across all of your apps with Notion AI",id:"NotionAIConnectorSalesAssistedRequestModal.title"},subtitleForAnnouncement:{defaultMessage:"Get search results, AI answers, summaries and more without leaving Notion.",id:"NotionAIConnectorSalesAssistedRequestModal.subtitleForAnnouncement"},notifyWorkspaceOwner:{defaultMessage:"Notify your sales representative for access",id:"NotionAIConnectorSalesAssistedRequestModal.notifyWorkspaceOwners"}})};function ue(){const e=(0,s().v3)(),{currentSpaceStore:n}=(0,i().O$)(m().default),t=null==n?void 0:n.id,r=e.currentUser.id,a=(0,x()._X)({name:"ai_connectors",spaceId:t,userId:r}),c=(0,w().tz)(),l=(0,i().O$)(E().O),d=l.open&&"sales_assisted_admin_request"===l.modal,u=(0,o.useCallback)((e=>{let{source:n}=e;E().O.setState({open:!1}),"closeButton"!==n&&l.open&&"sales_assisted_admin_request"===l.modal&&(0,le().cz)()}),[l]);if(!d||!a)return null;const p=l.connector;return(0,U.jsx)(W().a,{ariaLabel:c.formatMessage(R().vK.title),open:d,render:()=>(0,U.jsx)(K().Y,{messages:de,aiConnectorsFeatureAvailability:a,onDismiss:u,calloutKey:void 0,eventName:"ai_connector_sales_assisted_intro_modal_opened",learnMoreHref:void 0,connector:p,showNarrowCta:!1,isSalesAssisted:!0})})}var pe=()=>t(957416),ge=()=>t(331542),me=()=>t(596009),he=()=>t(340498);const ve=(0,he().wt)("keyLarge",{viewBox:"0 0 30 30",svg:(0,U.jsx)("g",{children:(0,U.jsx)("path",{d:"M15.005 2.979c.923 0 1.788.174 2.594.522.814.342 1.528.82 2.143 1.436a6.518 6.518 0 011.436 2.133c.349.806.523 1.671.523 2.594a6.229 6.229 0 01-1.24 3.774c-.821 1.12-2 2.006-3.538 2.655l2.543 2.553c.143.15.215.318.215.503a.641.641 0 01-.205.492l-2.615 2.605 1.877 1.856a.693.693 0 01.205.492.653.653 0 01-.206.502l-3.24 3.24a.593.593 0 01-.482.185.67.67 0 01-.44-.185L12.8 26.604a1.125 1.125 0 01-.247-.36 1.124 1.124 0 01-.071-.41v-9.946a6.754 6.754 0 01-2.225-1.456 6.704 6.704 0 01-1.959-4.768c0-.93.171-1.798.513-2.604a6.738 6.738 0 011.435-2.133A6.665 6.665 0 0112.38 3.49a6.707 6.707 0 012.625-.512zm0 6.06a1.65 1.65 0 001.21-.503 1.65 1.65 0 00.503-1.21c0-.478-.168-.882-.503-1.21a1.65 1.65 0 00-1.21-.502 1.64 1.64 0 00-1.22.502 1.645 1.645 0 00-.492 1.21c0 .472.164.875.492 1.21.335.335.742.503 1.22.503z"})})}),fe={viewBox:"0 0 20 20",fittedViewBox:"1.77 1.69 16.42 16.61",svg:(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)("path",{d:"M17.22 11.956a.626.626 0 0 1 .753.998l-6.377 4.815a2.65 2.65 0 0 1-3.012.125l-.18-.125-6.378-4.815-.093-.086a.626.626 0 0 1 .739-.977l.108.065 6.376 4.816.096.065a1.4 1.4 0 0 0 1.592-.065z"}),(0,U.jsx)("path",{d:"M8.403 2.232a2.65 2.65 0 0 1 3.193 0l5.553 4.192.106.085a2.2 2.2 0 0 1-.106 3.427l-5.553 4.192a2.65 2.65 0 0 1-3.193 0L2.85 9.936a2.2 2.2 0 0 1 0-3.512z"})]})},ye=(0,he().wt)("layerMultipleFill",fe);var xe=()=>t(449552);function _e(e){const n=(0,Z().G6)(e);if("notion-mail"===e){const t=Z().w0[(0,Z().uV)(e)];return(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalTitleNotionMail",defaultMessage:"Connect your {workspaceConnectorName} account using {connectorName}",values:{workspaceConnectorName:t,connectorName:n}})}return(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalTitle",defaultMessage:"To start, install the Notion AI app in {connectorName}",values:{connectorName:n}})}function Se(e){const n=(0,Z().G6)(e),t=Z().w0[(0,Z().uV)(e)],o=[{icon:me().arrowUpRightSquareFillIcon,title:(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalNewTabNoteTitle",defaultMessage:"{connectorName} will open in a new tab",values:{connectorName:n}},"newTabNoteTitle"),description:"notion-mail"===e?(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalNewTabNoteDescriptionNotionMail",defaultMessage:"Authenticate or create a Notion Mail account"},"newTabNoteDescriptionNotionMail"):(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalNewTabNoteDescription",defaultMessage:"Click “Start connection” below, then authenticate and accept terms in the new tab"},"newTabNoteDescription")},{icon:ve,title:(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalPermissionNoteTitle",defaultMessage:"{workspaceConnectorName} permissions are strictly respected",values:{workspaceConnectorName:t}},"permissionNoteTitle"),description:(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalPermissionNoteDescription",defaultMessage:"Members can only get AI answers about content they are authorized to see in {connectorName}.",values:{connectorName:n}},"permissionNoteDescription")},{icon:xe().g,title:(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalWeDoNotTrainModelNoteTitle",defaultMessage:"Notion does not train models on your {workspaceConnectorName} data",values:{workspaceConnectorName:t}},"weDoNotTrainModelNoteTitle")}],s={icon:(0,U.jsx)(P().E,{size:20}),title:(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalSharePointAndOneDriveNoteTitle",defaultMessage:"SharePoint and OneDrive content are connected through a single setup"},"sharepointAndOneDriveNoteTitle")},i={icon:ye,title:(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalJiraV2NoteTitle",defaultMessage:"We’ll help you create an Atlassian Forge App"},"jiraV2NoteTitle"),description:(0,U.jsx)(w().sA,{id:"universalQna.connector.introModalJiraV2NoteDescription",defaultMessage:"We’ll need admin information to create and connect your app. This might take a few minutes."},"jiraV2NoteDescription")};switch(e){case"sharepoint":return[s,...o];case"jira":return[i,...o.slice(1)];default:return o}}function je(e){const{connectorType:n,open:t,onClosed:o,learnMoreUrl:i}=e,r=(0,b().IS)((e=>({wrapper:{width:"100vw",height:"100vh",justifyContent:"center",alignItems:"center"},container:{gap:16,alignItems:"center"},learnMoreText:{gap:4,alignItems:"center",fontSize:14,color:e.text.secondary,justifyContent:"center"},actionsContainer:{gap:4,width:240,alignItems:"center"},learnMoreButton:{marginTop:16,borderRadius:6,width:"100%"},primaryButton:{width:"100%"},learnMoreWrapper:{width:"100%"}})),[]);return(0,s().v3)().device.isMobile?(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:o,open:t,render:()=>(0,U.jsx)(D().Ye,{style:r.wrapper,children:(0,U.jsxs)(D().wt,{style:r.container,children:[(0,U.jsx)(P().b,{connectorType:n,title:(0,U.jsx)(w().sA,{id:"universalQna.notAvailableOnMobile.heading",defaultMessage:"Connecting {appName} and Notion is only available on desktop",values:{appName:Z().w0[n]}})}),(0,U.jsxs)(D().wt,{style:r.actionsContainer,children:[(0,U.jsx)(ee().A,{style:r.primaryButton,onClick:o,children:(0,U.jsx)(w().sA,{id:"universalQna.notAvailableOnMobile.close",defaultMessage:"Got it"})}),(0,U.jsx)(D().Ye,{style:r.learnMoreWrapper,children:(0,U.jsx)(T().A,{style:r.learnMoreButton,onClick:()=>{window.open(i,"_blank")},children:(0,U.jsxs)(D().Ye,{style:r.learnMoreText,children:[(0,U.jsx)(w().sA,{id:"universalSearch.slack.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,C().X)({width:16,height:16})]})})})]})]})})}):(0,U.jsx)(U.Fragment,{})}var be=()=>t(229977);const Ce={github:{analyticsFrom:"github_ai_connector_already_connected",primedTextInput:"Find a GitHub PR/Issue/Code file about: ",contentType:"repositories"},slack:{analyticsFrom:"slack_already_connected",primedTextInput:"Search for messages in Slack: ",contentType:"conversations"},"microsoft-teams":{analyticsFrom:"microsoft_teams_ai_connector_already_connected",primedTextInput:"Search for messages in Microsoft Teams",contentType:"messages"},"google-drive":{analyticsFrom:"google_drive_already_connected",primedTextInput:"Find a Google Drive file about: ",contentType:"content"},jira:{analyticsFrom:"jira_already_connected",primedTextInput:"Find a Jira issue about: ",contentType:"issues"},gmail:{analyticsFrom:"gmail_already_connected",primedTextInput:"Find a Gmail email about: ",contentType:"email"},"google-calendar":{analyticsFrom:"google-calendar_already_connected",primedTextInput:"Find a Google Calendar event about: ",contentType:"events"},"notion-mail":{analyticsFrom:"notion-mail_already_connected",primedTextInput:"Find a Notion Mail email about: ",contentType:"emails"},sharepoint:{analyticsFrom:"sharepoint_already_connected",primedTextInput:"Search for documents in SharePoint",contentType:"content"},linear:{analyticsFrom:"linear_already_connected",primedTextInput:"Search for issues in Linear",contentType:"issues"},outlook:{analyticsFrom:"outlook_already_connected",primedTextInput:"Search for emails in Outlook",contentType:"emails"}},we=(0,w().YK)({alreadyConnected:{id:"universalQna.connector.alreadyConnected.title",defaultMessage:"{connector} is already connected to Notion AI"},tryIt:{id:"universalQna.connector.alreadyConnected.subtitle",defaultMessage:"You’re fully set up. Try asking AI about your {connector} {contentType}!"},tryAskingAQuestion:{id:"universalQna.connector.alreadyConnected.tryAskingAQuestionButton",defaultMessage:"Try asking a question"}});function ke(e){let{open:n,onDismiss:t,connector:i}=e;const r=(0,s().v3)(),a=(0,w().tz)(),c=Ce[i],l=(0,b().IS)((e=>({container:{padding:16,maxWidth:400},tryItButton:{marginTop:16}})),[]),d=(0,o.useCallback)((()=>{t(),be().assistantMenuActions.openAssistantRightHandSideMenu({environment:r,from:c.analyticsFrom,primeTextInput:c.primedTextInput})}),[r,t,c]),u=a.formatMessage(we.alreadyConnected,{connector:Z().w0[i]});return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:t,open:n,ariaLabel:u,render:()=>(0,U.jsxs)(D().wt,{style:l.container,children:[(0,U.jsx)(P().b,{titleSubtitleGap:!0,fullWidthTitle:!0,subtext:(0,U.jsx)(w().sA,{...we.tryIt,values:{connector:Z().w0[i],contentType:c.contentType}}),connectorType:i,title:(0,U.jsx)(w().sA,{...we.alreadyConnected,values:{connector:Z().w0[i]}})}),(0,U.jsx)(ee().A,{size:"lg",style:l.tryItButton,onClick:d,children:(0,U.jsx)(w().sA,{...we.tryAskingAQuestion})})]})})}function Ae(e){const{open:n}=e;return(0,U.jsx)(ke,{open:n,onDismiss:()=>{p().o.reset()},connector:"github"})}const Ie=(0,w().YK)({githubAIConnectorOauthPopupTitle:{defaultMessage:"Connect GitHub AI Connector",id:"githubAIConnector.oauthPopupTitle"}});function Me(){const e=(0,o.useMemo)((()=>_e("github")),[]),n=(0,o.useMemo)((()=>Se("github")),[]),t=(0,s().v3)(),[c,d]=(0,o.useState)("CLOSED"),u=(0,l().O)(),g=(0,i().O$)(p().o),m=(0,i().K8)((()=>p().o.state.sessionId),[]),h=(0,i().K8)((()=>p().o.state.analyticsFrom),[]),v=(0,b().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:k().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),f=(0,L().J)(),y=(0,x().P9)({name:"ai_connectors",spaceId:u,userId:t.currentUser.id}),_=(0,o.useCallback)((()=>{const e=(0,B().xS)("guides.aiConnectorGithub");(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),t.device.isElectron?I().openExternalUrl(e):window.open(e,"_blank")}),[t]),S=(0,o.useCallback)((async()=>{if(!u)return;const e=await A().callApi({eventName:"getGithubOrgAuthUrl",environment:t,data:{spaceId:u,isDesktop:t.device.isElectron,sessionId:p().o.state.sessionId}});if("success"!==e.type)return;(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:t,connector:"github",moment:"started"});const n=e.data.url;t.device.isElectron?I().openExternalUrl(n):pe().P(t,{width:800,height:600,url:n,titleMessage:Ie.githubAIConnectorOauthPopupTitle}),p().o.setState({...p().o.state,authUrl:n,currentScreen:"connecting"})}),[u,t]),[j]=(0,r().Yb)((async()=>{if(!u||"introduction"!==g.currentScreen)return;if(g.githubOrg)return{isGithubConnected:!0};const e=await A().callApi({eventName:"getGithubAIConnectorStatus",environment:t,data:{spaceId:u}});return"success"===e.type?{isGithubConnected:e.data.isConnected}:void 0}),[t,g.currentScreen,g.githubOrg,u]);(0,o.useEffect)((()=>{"introduction"===g.currentScreen?"resolved"===j.status?d("OPEN"):d("LOADING"):d("CLOSED")}),[j.status,g.currentScreen]);const C=(0,o.useRef)(!1),T=(0,o.useCallback)((()=>{p().o.reset(),(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_github_intro_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),C.current=!1}),[t]),N=(0,o.useCallback)((async()=>{await S(),(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"github_ai_connector_auth_url_open",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),p().o.setState({...p().o.state,currentScreen:"connecting"})}),[t,S]);return(0,o.useEffect)((()=>{u&&f&&"resolved"===j.status&&"introduction"===g.currentScreen&&(C.current||((0,M().u)({environment:t,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"github",setup_session_id:g.sessionId,from:g.analyticsFrom,is_space_admin:f,is_ai_eligible:y??!1}}}),C.current=!0))}),[u,t,j.status,g.sessionId,g.analyticsFrom,f,y,g.currentScreen]),u&&"CLOSED"!==c?t.device.isMobile?(0,U.jsx)(je,{connectorType:"github",open:"introduction"===g.currentScreen,onClosed:()=>{p().o.reset()},learnMoreUrl:(0,B().xS)("guides.aiConnectorGithub")}):"LOADING"===c?(0,U.jsx)(W().a,{open:"LOADING"===c,render:()=>(0,U.jsxs)(D().Ye,{style:v.loadingWrapper,children:[(0,U.jsx)(w().sA,{id:"universalQna.github.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(ge().A,{})]})}):g.isConnected?(0,U.jsx)(Ae,{open:!0}):f?(0,U.jsx)(ae,{onConnect:N,onDismiss:T,onLearnMore:_,title:e,connectorType:"github",notes:n,open:"OPEN"===c}):(0,U.jsx)(J,{connector:"github",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,a().resetAiConnectorStatus)("github"),open:"OPEN"===c,messages:R().Sn}):(0,U.jsx)(U.Fragment,{})}var Te=()=>t(262462),Ne=()=>t(843189),We=()=>t(972435);const De=function(){const e=(0,i().O$)(p().o),[n,t]=(0,o.useState)(!1),r=(0,s().v3)(),a=(0,l().O)(),c=(0,o.useCallback)((()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"close_settings",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),p().o.reset()}),[r]),d=(0,o.useCallback)((()=>{t(!1)}),[]),u=(0,b().IS)((e=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:e.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"20px 20px 20px 20px",gap:8},disconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:k().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:k().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{width:"100%"}})),[]);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:d,open:n,render:()=>(0,U.jsx)("div",{style:u.confirmWrapper,children:(0,U.jsxs)("div",{style:u.confirmContainer,children:[(0,U.jsx)("div",{style:u.confirmModalTitle,children:(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:u.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.confirmation.subTitle",defaultMessage:"Your GitHub data will be permanently deleted from Notion."})}),(0,U.jsx)("div",{style:u.confirmModalDescription,children:(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(D().wt,{style:u.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isRed:!0,style:u.confirmDisconnectButton,onClick:async()=>{a&&((0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect_confirmation",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),await A().callApi({eventName:"disconnectGithub",environment:r,data:{spaceId:a}}),p().o.reset(),t(!1),H().D6({label:We().A.getIntl().formatMessage({defaultMessage:"GitHub disconnected. This can take up to 3 hours.",id:"githubAIConnector.settings.confirmation.disconnected"}),position:"bottom"}))},children:(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(T().A,{style:u.goBackButton,onClick:d,children:(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:c,open:"settings"===e.currentScreen,render:()=>(0,U.jsxs)("div",{style:u.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"github",title:(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.settingsModalTitle",defaultMessage:"GitHub is connected to Notion AI"}),subtext:(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.canAnswerFrom",defaultMessage:"Notion AI can answer questions about your GitHub repositories."})}),(0,U.jsxs)(D().wt,{style:u.footer,children:[(0,U.jsx)(ie().A,{size:"lg",style:u.editChannelsButton,onClick:()=>{var n,t;(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"open_github_for_edit_selection",integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),window.open(`https://github.com/organizations/${null===(n=e.githubOrg)||void 0===n?void 0:n.name}/settings/installations/${null===(t=e.githubOrg)||void 0===t?void 0:t.installationId}`,"_blank")},children:(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.editRepos",defaultMessage:"Edit Selected Repositories"})}),(0,U.jsx)(Ne().E,{style:u.disconnectButton,onClick:()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect",integration_type:"github",setup_session_id:p().o.state.sessionId,from:"connection_settings"}}}),t(!0)},children:(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.disconnectGithub",defaultMessage:"Disconnect"})}),(0,U.jsx)(T().A,{style:u.learnMoreButton,onClick:()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_settings_modal",integration_type:"github",setup_session_id:p().o.state.sessionId,from:"connection_settings"}}});const e=(0,B().xS)("guides.aiConnectorGithub");window.open(e,"_blank")},children:(0,U.jsxs)(D().Ye,{style:u.learnMoreText,children:[(0,U.jsx)(w().sA,{id:"githubAIConnector.settings.learnMore",defaultMessage:"Learn more"}),(0,Te().M)(u.externalLinkIcon)]})})]})]})})]})};function Be(e){let{title:n,description:t,number:s}=e;const i=(0,b().IS)((e=>({title:{fontSize:k().J.UIRegular.desktop,color:e.text.primary,fontWeight:k().Wy.medium},body:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:e.text.secondary}})),[]);return(0,U.jsxs)(D().Ye,{gap:8,style:{marginBottom:8},children:[(0,U.jsx)(N().A,{number:s}),(0,U.jsxs)(D().wt,{gap:4,children:[(0,U.jsx)("div",{style:i.title,children:(0,U.jsx)(w().sA,{...n})}),t&&(0,U.jsx)("div",{style:i.body,children:o.isValidElement(t)?t:(0,U.jsx)(w().sA,{...t})})]})]})}var Fe=()=>t(735790);const Pe=(0,w().YK)({defaultTitle:{id:"universalQna.connectionComplete.defaultTitle",defaultMessage:"You’re done!"},defaultSubText:{id:"universalQna.connectionComplete.defaultSubText",defaultMessage:"What happens next:"},defaultPrimaryButton:{id:"universalQna.connectionComplete.defaultPrimaryButton",defaultMessage:"Got it"},connectionInProgressTitle:{id:"universalQna.connectionComplete.connectionInProgressTitle",defaultMessage:"We’re connecting your {appName} content"},defaultConnectionTime:{id:"universalQna.connectionComplete.defaultConnectionTime",defaultMessage:"This may take up to 36 hours"},defaultPermissionsWillBeRespected:{id:"universalQna.connectionComplete.defaultPermissionsWillBeRespected",defaultMessage:"{appName} permissions are strictly respected and members will only see content they have access to."},defaultNotionAiWillBeAbleToAnswerQuestions:{id:"universalQna.connectionComplete.defaultNotionAiWillBeAbleToAnswerQuestions",defaultMessage:"Notion AI will be able to search and answer questions across Notion and {appName} knowledge."}});function Ue(e){const{open:n,connectorType:t,notes:s,onDismiss:i,onPrimaryButtonClick:r,onEditSettingsClick:a,title:c,subText:l,primaryButtonText:d}=e,[u,p]=(0,o.useState)(!1),[g,m]=(0,o.useState)(!1),h=(0,w().tz)(),v=(0,b().IS)((e=>({wrapper:{width:400},notesContainer:{marginTop:24,font:k().Tf.sans,paddingLeft:20,paddingRight:20,textAlign:"left",justifyContent:"center"},buttonsContainer:{margin:20,display:"flex",flexDirection:"column",gap:8}})),[]),f=c||(0,U.jsx)(w().sA,{...Pe.defaultTitle}),y=l||(0,U.jsx)(w().sA,{...Pe.defaultSubText}),x=d||(0,U.jsx)(w().sA,{...Pe.defaultPrimaryButton});return(0,U.jsx)(W().a,{overlayZIndex:999,ariaLabel:h.formatMessage({id:"universalQnAConnectionCompleteModal.title",defaultMessage:"You’re done!"}),open:n,onDismiss:()=>{i()},render:()=>(0,U.jsxs)("div",{style:v.wrapper,children:[(0,U.jsx)(P().b,{connectorType:t,title:f,subtext:y}),(0,U.jsx)(D().wt,{gap:12,style:v.notesContainer,className:"notes-Container",children:s.map(((e,n)=>e))}),r||a?(0,U.jsxs)("div",{style:v.buttonsContainer,children:[a?(0,U.jsx)(ie().A,{iconLeading:Fe().M,isLoading:g,style:{width:"100%"},onClick:async()=>{m(!0),await a(),m(!1)},children:(0,U.jsx)(w().sA,{id:"universalSearch.connectionComplete.customizeConnectedContent",defaultMessage:"Customize connected content"})}):void 0,r?(0,U.jsx)(ee().A,{isLoading:u,style:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"},onClick:async()=>{p(!0),await r(),p(!1)},children:x}):void 0]}):void 0]})})}const ze=(0,w().YK)({durationForIngestion:{id:"githubAiConnector.connectionComplete.durationForIngestion",defaultMessage:"This may take up to 72 hours"},githubAIConnectorConnectionCompleteListpoint2:{id:"githubAIConnector.connectionComplete.listpoint2",defaultMessage:"Each member of your workspace will be prompted to authenticate to GitHub."}});const Le=function(){const e=(0,s().v3)(),n=(0,i().O$)(p().o),t=(0,o.useCallback)((n=>{p().o.setState({...p().o.getInitialState(),isPersonalAuthComplete:!1,status:"in_progress",isConnected:!0}),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`github_ai_connector_got_it_${n}_click`,integration_type:"github",setup_session_id:p().o.state.sessionId,from:p().o.state.analyticsFrom}}}),H().D6({label:(0,U.jsx)(w().sA,{id:"aiConnectors.github.acknowledge",defaultMessage:"Started syncing from GitHub. This can take up to 72 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"aiConnectors.github.startedMessageDismiss",defaultMessage:"Close"})})})}),[e]);return(0,o.useEffect)((()=>{"confirmation"===n.currentScreen&&(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"github",moment:"finished"})}),[e,n.currentScreen]),(0,U.jsx)(Ue,{open:"confirmation"===n.currentScreen,connectorType:"github",notes:[(0,U.jsx)(Be,{number:1,title:ze.durationForIngestion},"item1"),(0,U.jsx)(Be,{number:2,title:ze.githubAIConnectorConnectionCompleteListpoint2,description:{...{...Pe.defaultPermissionsWillBeRespected,values:{appName:"GitHub"}}}},"item2")],onDismiss:()=>t("dismiss"),onPrimaryButtonClick:()=>t("dismiss")})};var Ee=()=>t(771624),Oe=()=>t(693954);function Ke(e){const{notes:n,connectorType:t,openLearnMoreUrl:s,open:i,onDismiss:r,title:a,subText:c,onClickPrimaryButton:l,primaryButtonText:d,warningMessage:u}=e,[p,g]=(0,o.useState)(!1),m=(0,b().IS)((e=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12},waitingForConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},note:{fontWeight:k().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},buttonContainer:{width:"100%",marginTop:"16px"},primaryButton:{width:"100%"},learnMoreButton:{width:"100%"}})),[]),h=(0,w().tz)();return(0,U.jsx)(W().a,{ariaLabel:h.formatMessage({id:"universalSearch.waitingForConnection.ariaLabel",defaultMessage:"Authentication modal"}),showCloseIcon:!0,open:i,onDismiss:r,render:()=>(0,U.jsxs)("div",{style:m.wrapper,children:[(0,U.jsx)(P().b,{connectorType:t,title:a,subtext:c}),(0,U.jsx)(D().Ye,{style:m.selectionContainer,children:(0,U.jsx)(D().wt,{children:(0,U.jsxs)(D().wt,{style:m.waitingForConnectionWrapper,children:[n.map(((e,n)=>(0,U.jsxs)(D().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:m.note,children:e})]},n))),(0,U.jsxs)(D().wt,{style:m.buttonContainer,gap:6,children:[u,l?(0,U.jsx)(ee().A,{size:"xl",isLoading:p,disabled:p,style:m.primaryButton,onClick:async()=>{g(!0),await l(),g(!1)},children:d}):void 0,s?(0,U.jsx)(ie().A,{size:"lg",iconLeading:se().bookIcon,style:m.learnMoreButton,onClick:s,children:(0,U.jsx)(w().sA,{id:"universalSearch.integrations.learnMore",defaultMessage:"Read our step-by-step guide"})}):void 0]})]})})})]})})}function Re(e){const{connector:n,learnMoreUrl:t,troubleShootingUrl:r,staticConnectorAuthUrl:a,setConnectionStateAsConnected:d,callConnectionApi:u,screenName:p,connectorSpecificSetupNote:g,nextScreens:m,setConnectionConflictSpaceId:h}=e,[v,f]=o.useState(!1),y=(0,b().IS)((e=>({noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontweight:k().Wy.regular},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),x=(0,s().v3)(),_=(0,l().O)(),S=(0,c().nB)({connector:n,authorizationType:"workspace",existingAuthorizationUrl:a}),j=(0,Z().G6)(n),C=(0,i().O$)(c().NT[n]),{sessionId:A,currentScreen:I,analyticsFrom:T}=C,N=(0,o.useCallback)((async()=>{if(!_)return;var e;await(e=5e3,new Promise((n=>setTimeout(n,e))));const t=await u();(0,c().Vn)(n)({environment:x,spaceId:_});const o=e=>{(0,M().u)({environment:x,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:e,integration_type:n,setup_session_id:A,from:T}}})};var s,i,r,a;"success"===t.type?null!==(s=t.data)&&void 0!==s&&s.connectionSuccess?(o("auth_screen_connected"),c().NT[n].setState({...C,currentScreen:m.connectionSuccess}),d()):((e,t,s)=>{switch(e){case 401:o("auth_screen_not_connected_warning"),f(!0);break;case 403:o("info_screen_connect_not_admin_screen"),c().NT[n].setState({...C,currentScreen:m.notAdminOfConnectorAccount});break;case 400:"GOOGLE_MAPPING_EXIST"===t&&s?(o("workspace_already_connected"),c().NT[n].setState({...C,currentScreen:m.connectionConflict}),null==h||h(s)):c().NT[n].setState({...C,currentScreen:m.error});break;default:c().NT[n].setState({...C,currentScreen:m.error})}})(null==t||null===(i=t.data)||void 0===i||null===(i=i.errorResponse)||void 0===i?void 0:i.status,null==t||null===(r=t.data)||void 0===r||null===(r=r.errorResponse)||void 0===r?void 0:r.errorCode,null==t||null===(a=t.data)||void 0===a||null===(a=a.errorResponse)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.spaceId):c().NT[n].setState({...C,currentScreen:m.error})}),[T,x,A,_,n,C,d,u,m,h]),W=(0,o.useCallback)((()=>[(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:y.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.authModal.waitingForConnectionNoteHeading1",defaultMessage:"{connectorName} should open automatically on a new browser tab.",values:{connectorName:j}},"note1-1")}),(0,U.jsx)("div",{style:y.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.authModal.authWaiting",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:y.link,href:S,target:"_blank",onClick:()=>{(0,M().u)({environment:x,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:n,setup_session_id:A,from:T}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:y.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.authModal.workspaceAdminHeading",defaultMessage:"Follow {connectorName}’s setup instructions",values:{connectorName:j}},"note2-1")}),(0,U.jsx)("div",{style:y.noteBody,children:g?(0,U.jsx)(w().sA,{...g}):(0,U.jsx)(w().sA,{id:"universalSearch.authModal.workspaceAdminBody",defaultMessage:"For better AI answers, we recommend selecting the option “All users in my organization”."},"note2-2")})]},"note-2"),(0,U.jsx)(D().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:y.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.authModal.done",defaultMessage:"When you’re done, click the button below"},"note3-1")})},"note-3")]),[y,S,x,A,T,n,j,g]),B=v?(0,U.jsxs)(D().Ye,{style:y.warningContainer,children:[(0,Oe().Q)(y.icon),(0,U.jsx)("div",{style:y.warningText,children:(0,U.jsx)(w().sA,{id:"universalQnA.authScreen.warning",defaultMessage:"We couldn’t connect to {connectorName}. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{connectorName:j,TroubleshootingGuide:(0,U.jsx)("a",{style:{...y.link,color:"#D7813A"},href:r,target:"_blank",onClick:()=>{(0,M().u)({environment:x,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_opened",integration_type:n,setup_session_id:A,from:T}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.authModal.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(Ke,{title:(0,U.jsx)(w().sA,{id:"universalQnA.AuthScreen",defaultMessage:"Follow instructions from {connectorName} in your browser",values:{connectorName:j}}),open:I===p,onDismiss:()=>{f(!1),(0,M().u)({environment:x,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:n,setup_session_id:A,from:T}}}),c().NT[n].setState({...C,currentScreen:"none"})},warningMessage:B,notes:W(),openLearnMoreUrl:()=>{window.open(t)},connectorType:n,primaryButtonText:(0,U.jsx)(w().sA,{id:"universalSearch.connector.Button.finishedSetup",defaultMessage:"Confirm connection"},"note3-1"),onClickPrimaryButton:N})}t(944114);function He(e){const{connector:n,screenName:t,nextScreens:r,onStartIngestion:d,ingestionNotNeeded:u}=e,p=(0,b().IS)((e=>({link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),g=(0,s().v3)(),m=(0,l().O)(),h=(0,i().O$)(c().NT[n]),{sessionId:v,currentScreen:f,analyticsFrom:y}=h,x=f===t,S=Z().w0[n],j=(0,i().K8)((()=>(0,_().XY)(n)),[n]);(0,o.useEffect)((()=>{x&&(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:g,connector:n,moment:"finished"})}),[x,n,g]);const C=(0,o.useCallback)((()=>{(0,M().u)({environment:g,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:n,setup_session_id:v,from:y}}}),c().NT[n].setState({...h,currentScreen:"none"})}),[y,g,v,n,h]),k=(0,o.useCallback)((async()=>{if(!m)return;(0,M().u)({environment:g,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"shared_drive_settings",integration_type:n,setup_session_id:v,from:y}}});const{status:e}=await(0,c().Vn)(n)({environment:g,spaceId:m});if("success"===e){const e=(0,_().XY)(n);"in_progress"===e?c().NT[n].setState({...h,currentScreen:r.inProgress}):"not_started"===e?c().NT[n].setState({...h,currentScreen:r.notStarted}):c().NT[n].setState({...h,currentScreen:r.error})}else c().NT[n].setState({...h,currentScreen:r.error})}),[y,g,n,m,h,r,v]),A="in_progress"===j,I=(0,o.useMemo)((()=>{const e=[];return u||e.push((0,U.jsx)(Be,{number:1,title:Pe.defaultConnectionTime,description:A?void 0:(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.connectionComplete.waitingForConnectionNoteBody1",defaultMessage:"If you want to choose content, {clickHere}",values:{clickHere:(0,U.jsx)("a",{style:p.link,onClick:k,children:(0,U.jsx)(w().sA,{id:"universalSearch.connectionCompleteModal.settings",defaultMessage:"click here."})})}})})},"ingestionDelayNotice")),e.push((0,U.jsx)(Be,{number:e.length+1,title:{...{...Pe.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:S}}}},"notionAiAnswerQuestions")),e}),[S,u,A,p.link,k]);return m?(0,U.jsx)(Ue,{open:x,connectorType:n,notes:I,onPrimaryButtonClick:async()=>{if((0,M().u)({environment:g,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:n,setup_session_id:v,from:y}}}),c().NT[n].setState({...h,currentScreen:"none"}),A)return;await(null==d?void 0:d())&&function(e){H().D6({label:(0,U.jsx)(w().sA,{id:"ingestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from {connectorName}. This can take up to 36 hours.",values:{connectorName:e}}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"ingestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}(S)},onDismiss:C}):null}t(898992),t(354520);var qe=()=>t(584262),Ge=()=>t(426116);function Ye(e){const{connector:n,connectedSpaceId:t,screenName:r,nextScreens:a}=e,l=(0,w().tz)(),d=(0,i().O$)(c().NT[n]),{currentScreen:u,sessionId:p,analyticsFrom:g}=d,h=u===r,v=Z().w0[n],f=(0,s().v3)(),y=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"}})),[]),x=(0,o.useCallback)((async()=>{const e=m().default.state.currentUserRootStore;if(!e)return;(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:n,setup_session_id:p,from:g}}});const o=e.getSpaceViewStores().filter((e=>e.getSpaceId()===t))[0];await Ge().tR({environment:f,navigationType:"switchingToOrLoadingSpace",pageVisitSource:qe().y8.AIGoogleDriveQna,spaceViewStore:o,userRootStore:m().default.state.currentUserRootStore,userSettingsStore:m().default.state.currentUserSettingsStore}),c().NT[n].setState({...d,currentScreen:a.settings,analyticsFrom:"google_other_workspace",sessionId:p})}),[g,t,f,p,n,d,a]);return(0,U.jsx)(W().a,{ariaLabel:l.formatMessage({defaultMessage:"Ai Connector Connection Conflict Modal",id:"aiConnectorOnboarding.connectionConflictModal.ariaLabel"}),showCloseIcon:!0,onDismiss:()=>c().NT[n].setState({...d,currentScreen:"none"}),open:h,render:()=>(0,U.jsxs)("div",{style:y.wrapper,children:[(0,U.jsx)(P().b,{connectorType:n,title:(0,U.jsx)(w().sA,{id:"universalSearch.connectionExistModal.title",defaultMessage:"You’ve already connected {connectorName} to another Notion workspace.",values:{connectorName:v}}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.connectionExistModal.description",defaultMessage:"Currently, only one workspace can be connected to {connectorName}. To connect this workspace, please disconnect the existing connection.",values:{connectorName:v}})}),(0,U.jsx)(D().wt,{style:y.footer,children:(0,U.jsx)(ee().A,{style:y.connectButton,onClick:x,children:(0,U.jsx)(w().sA,{id:"universalSearch.connectionExistModal.navigateButton",defaultMessage:"Visit the other workspace"})})})]})})}var Je=()=>t(902006),Qe=()=>t(498474);const $e=function(e){const{onDismiss:n,onClickGotItBtn:t,open:o,title:s,descriptionMessage:i,connectorType:r,message:a}=e,c=(0,b().IS)((e=>({modal:{width:400,alignItems:"center"},contentWrapper:{padding:"0 20px 24px 20px",gap:8},messageWrapper:{gap:19},gotItButton:{width:"100%"}})),[]);return(0,U.jsx)(W().a,{showCloseIcon:!0,open:o,onDismiss:n,render:()=>(0,U.jsxs)("div",{style:c.modal,children:[(0,U.jsx)(P().b,{connectorType:r,title:s,subtext:i}),(0,U.jsxs)("div",{style:c.contentWrapper,children:[(0,U.jsx)("div",{style:c.messageWrapper,children:a}),(0,U.jsx)("div",{children:(0,U.jsx)(ie().A,{size:"lg",style:c.gotItButton,onClick:t,children:(0,U.jsx)(w().sA,{id:"aiConnectors.common.disconnectModal.confirmDisconnect",defaultMessage:"Got it"})})})]})]})})};function Ve(e){const{connector:n,showGoogleWorkspaceNote:t,postDisconnectScreenName:r,disconnectScreenName:d,settingsScreenName:u,errorScreenName:p,setStatusAsDisconnected:g}=e,m=(0,i().O$)(c().NT[n]),{analyticsFrom:h,sessionId:v,currentScreen:f}=m,y=Z().w0[n],x=(0,l().O)(),_=(0,s().v3)(),S=(0,w().tz)(),j=(0,b().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:k().Wy.regular,fontSize:14,lineHeight:"18px"},noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),C=(0,o.useCallback)((()=>{const{noteBlockWrapper:o,noteHeading:s,noteBody:i,link:r}=j,a=[];return a.push((0,U.jsxs)(D().wt,{style:o,children:[(0,U.jsx)("div",{style:s,children:(0,U.jsx)(w().sA,{id:"aiConnectors.post_disconnect_screen.note_1.heading",defaultMessage:"{workspaceConnectorDisplayName} data will be permanently deleted from Notion",values:{workspaceConnectorDisplayName:Z().w0[(0,Z().uV)(n)]}},"note1-1")}),(0,U.jsx)("div",{style:i,children:(0,Je().Gb)(n)?(0,U.jsx)(w().sA,{id:"aiConnectors.post_disconnect_screen.note_1.bodyVectorless",defaultMessage:"{connector} is now fully disconnected. You will be able to reconnect immediately if you would like.",values:{connector:Z().w0[n]}},"note1-2"):(0,U.jsx)(w().sA,{id:"aiConnectors.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},"note1-2")})]},"note-1")),t&&a.push((0,U.jsxs)(D().wt,{style:o,children:[(0,U.jsx)("div",{style:s,children:"google-drive"===n||"gmail"===n?(0,U.jsx)(w().sA,{id:"aiConnectors.post_disconnect_screen.note_2.headingForGoogle",defaultMessage:"Uninstall the Notion AI app from your Google Workspace (optional)"},"note2-1-google"):(0,U.jsx)(w().sA,{id:"aiConnectors.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your {connectorParentOrganization} workspace (optional)",values:{connectorParentOrganization:(0,Z().G6)(n)}},"note2-1")}),(0,U.jsx)("div",{style:i,children:(0,U.jsx)(w().sA,{id:"aiConnectors.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToWorkspaceAppsSettings} and uninstall the Notion AI app.",values:{marketplaceAppName:e.marketplaceAppName,NavigateToWorkspaceAppsSettings:(0,U.jsx)("a",{style:r,href:e.marketplaceAppConfigureUrl,target:"_blank",onClick:()=>{(0,M().u)({environment:_,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:n,setup_session_id:v,from:h}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.disconnect_workspace_app",defaultMessage:"{connectorSettings} {ArrowIcon}",values:{connectorSettings:(0,Z().I6)(n),ArrowIcon:(0,Qe().q)(j.icon)}})})}},"note2-2")})]},"note-2")),a}),[n,j,e,t,_,v,h]);return f===r?(0,U.jsx)($e,{onClickGotItBtn:()=>{c().NT[n].setState({...m,currentScreen:"none"})},onDismiss:()=>{c().NT[n].setState({...m,currentScreen:"none"})},open:f===r,connectorType:n,title:(0,Je().Gb)(n)?(0,U.jsx)(w().sA,{id:"aiConnectors.post_disconnect_modal.titleVectorless",defaultMessage:"{displayName} is disconnected from Notion",values:{displayName:y}}):(0,U.jsx)(w().sA,{id:"aiConnectors.post_disconnect_modal.title",defaultMessage:"{displayName} is disconnecting from Notion",values:{displayName:y}}),descriptionMessage:(0,U.jsx)(w().sA,{id:"aiConnectors.post_disconnect_modal.description",defaultMessage:"Here’s what’s next:"}),message:(0,U.jsx)("div",{style:j.notesSectionWrapper,children:C().map(((e,n)=>(0,U.jsxs)(D().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:j.note,children:e})]},n)))})}):(0,U.jsx)(W().a,{ariaLabel:S.formatMessage({id:"aiConnectors.disconnectModal.label",defaultMessage:"Disconnect {displayName} from Notion"},{displayName:y}),showCloseIcon:!0,open:f===d,onDismiss:()=>{(0,M().u)({environment:_,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_close",integration_type:n,setup_session_id:v,from:h}}}),c().NT[n].setState({...m,currentScreen:"none"})},render:()=>(0,U.jsx)("div",{style:j.confirmWrapper,children:(0,U.jsxs)("div",{style:j.confirmContainer,children:[(0,U.jsx)("div",{style:j.confirmModalTitle,children:(0,U.jsx)(w().sA,{id:"aiConnectors.disconnectModal.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:j.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{id:"aiConnectors.disconnectModal.subTitle",defaultMessage:"{workspaceConnectorDisplayName} data will be permanently deleted from Notion.",values:{workspaceConnectorDisplayName:Z().w0[(0,Z().uV)(n)]}})}),(0,U.jsx)("div",{style:j.confirmModalDescription,children:(0,Je().Gb)(n)?(0,U.jsx)(w().sA,{id:"aiConnectors.disconnectModal.descriptionVectorless",defaultMessage:"This process should be instant. You will be able to reconnect immediately if you would like."}):(0,U.jsx)(w().sA,{id:"aiConnectors.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(D().wt,{style:j.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isRed:!0,style:j.confirmDisconnectButton,disabled:c().NT[n].state.isDisconnecting??!1,onClick:async()=>{(0,M().u)({environment:_,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:n,setup_session_id:v,from:h}}}),await(async()=>{if(!x)return;const{type:e}=await(0,a().disconnectConnector)({connector:n,spaceId:x,environment:_,showToast:!0,disconnectReason:"admin_disconnect"});(0,c().Vn)(n)({environment:_,spaceId:x}),"failed"===e?c().NT[n].setState({...m,currentScreen:p}):g()})(),c().NT[n].setState({...m,currentScreen:r})},children:(0,Je().q1)(n)?(0,U.jsx)(w().sA,{id:"aiConnectors.disconnectModal.confirmDisconnectPersonal",defaultMessage:"Disconnect"}):(0,U.jsx)(w().sA,{id:"aiConnectors.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(T().A,{style:j.goBackButton,onClick:()=>{(0,M().u)({environment:_,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_back_button",integration_type:n,setup_session_id:v,from:h}}}),c().NT[n].setState({...m,currentScreen:u})},children:(0,U.jsx)(w().sA,{id:"aiConnectors.disconnectModal.goBack",defaultMessage:"Go back"})})]})]})})})}function Xe(e){const{connector:n}=e,t=(0,w().tz)(),r=(0,i().O$)(c().NT[n]),{currentScreen:a,sessionId:l,analyticsFrom:d}=r,u=(0,s().v3)(),p=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"}})),[]),g="error"===a;return(0,o.useEffect)((()=>{g&&(0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_error",integration_type:n,setup_session_id:l,from:d}}})}),[g,d,l,u,n]),(0,U.jsx)(W().a,{ariaLabel:t.formatMessage({defaultMessage:"Ai Connector Error Modal",id:"aiConnectorOnboarding.errorModal.ariaLabel"}),showCloseIcon:!0,onDismiss:()=>c().NT[n].setState({...r,currentScreen:"none"}),open:g,render:()=>(0,U.jsxs)("div",{style:p.wrapper,children:[(0,U.jsx)(P().b,{connectorType:n,title:(0,U.jsx)(w().sA,{id:"universalSearch.errorModal.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.errorModal.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(D().wt,{style:p.footer,children:(0,U.jsx)(ee().A,{style:p.connectButton,onClick:()=>{c().NT[n].setState({...r,currentScreen:"none"})},children:(0,U.jsx)(w().sA,{id:"universalSearch.error.Dismiss",defaultMessage:"Close"})})})]})})}var Ze=()=>t(96563),en=()=>t(8870),nn=()=>t(874963),tn=()=>t(385527),on=()=>t(406533),sn=()=>t(296798),rn=()=>t(887480);function an(e){const{connector:n,personalConnector:t,learnMoreHref:o,onDismiss:s,onConfirm:r}=e,a=(0,w().tz)(),l=(0,b().IS)((e=>({footer:{width:"100%",gap:4,marginTop:12},learnMoreLinkBox:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",gap:4,padding:6,borderRadius:4},questionMarkIcon:{width:16,height:16,fontWeight:k().Wy.medium,fill:e.text.grayPrimary},radioOptionIcon:{width:24,height:24},headingText:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},secondaryText:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"}})),[]),d=(0,i().K8)((()=>{var e;const n=null===(e=m().default.state.currentSpaceStore)||void 0===e?void 0:e.getMemberCountFromPublicSpaceData();return!(n&&n>1)}),[]),u=(0,i().O$)(c().NT[n]),p=(0,i().K8)((()=>{var e;return null===(e=m().default.state.currentUserStore)||void 0===e?void 0:e.getEmail()}),[]);return p?(0,U.jsx)(W().a,{open:!0,ariaLabel:a.formatMessage({id:"universalQnA.personalConnectorOptionModal.ariaLabel",defaultMessage:"Select an option to use workspace or personal connector"}),onDismiss:()=>{null==s||s()},render:()=>(0,U.jsx)(rn().Ay,{onDismiss:()=>{c().NT[n].setState({...u,currentScreen:"none"}),null==s||s()},defaultSelectedRadioOption:d?"personal":"workspace",hideCancelButton:!0,footer:(0,U.jsx)(D().Ye,{style:l.footer,children:(0,U.jsxs)(sn().A,{style:l.learnMoreLinkBox,href:o,external:!0,inline:!0,children:[(0,on().questionMarkCircleIcon)(l.questionMarkIcon),(0,U.jsx)("div",{style:l.secondaryText,children:(0,U.jsx)(w().sA,{id:"universalQnA.personalConnectorOptionModal.learnMoreLink",defaultMessage:"Learn more about these options"})})]})}),title:(0,U.jsx)(P().b,{connectorType:n,title:(0,U.jsx)(w().sA,{id:"universalQnA.personalConnectorOptionModal",defaultMessage:"Select an option to start"})}),confirmText:(0,U.jsx)(w().sA,{id:"universalQnA.personalConnectorOptionModal.confirmText",defaultMessage:"Continue"}),onConfirm:e=>{e&&r(e)},radioOptions:[{key:"workspace",title:(0,U.jsx)("div",{style:l.headingText,children:(0,U.jsx)(w().sA,{id:"universalQnA.personalConnectorOptionModal.workspaceIntegration.title",defaultMessage:"Connect {parentOrganizationName}",values:{parentOrganizationName:(0,Z().G6)(n)}})}),left:(0,nn().f)(l.radioOptionIcon),subtitle:(0,U.jsx)("div",{style:l.secondaryText,children:(0,U.jsx)(w().sA,{id:"universalQnA.personalConnectorOptionModal.workspaceIntegration.subtitle",defaultMessage:"All members with @workspace.com emails"})})},{key:"personal",title:(0,U.jsx)("div",{style:l.headingText,children:(0,U.jsx)(w().sA,{id:"universalQnA.personalConnectorOptionModal.personalIntegration.title",defaultMessage:"Connect to your individual email"})}),left:(0,tn().h)(l.radioOptionIcon),subtitle:(0,U.jsx)("div",{style:l.secondaryText,children:(0,U.jsx)(w().sA,{id:"universalQnA.personalConnectorOptionModal.personalIntegration.subtitle",defaultMessage:"Only {userEmail} will be connected, using {personalConnector} and {connector}.",values:{userEmail:p,personalConnector:Z().w0[t],connector:Z().w0[n]}})})}]})}):null}function cn(e){return`${(0,Je().aK)(e)}_connect_button`}const ln=(0,w().YK)({oauthPopupTitle:{defaultMessage:"Connect {connector} AI Connector",id:"AIConnectorIntroModal.oauthPopupTitle"}});function dn(e){const{connector:n,learnMoreUrl:t,staticAuthUrl:r}=e,d=(0,Z().tp)(n),[u,p]=(0,o.useState)((0,V().O9)(d)),g=(0,i().K8)((()=>d&&h().zD.canUseAiConnectorSearchScope(d)&&("notion-mail"!==d||!en().L.state.isNotionMailProhibited)),[d]),[m,v]=o.useState(!1),f=(0,s().v3)(),y=(0,o.useMemo)((()=>Se(n)),[n]),S=(0,o.useMemo)((()=>_e(n)),[n]),j=(0,l().O)(),b=(0,i().O$)(c().NT[n]),{currentScreen:C,analyticsFrom:w,sessionId:k}=b,A=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope(n)),[n]),T="introduction"===C,N=(0,L().J)(),W=f.currentUser.id,D=(0,x().P9)({name:"ai_connectors",spaceId:j,userId:W});(0,o.useEffect)((()=>{T||p(!0)}),[T]);const B=(0,c().nB)({connector:n,authorizationType:"workspace",existingAuthorizationUrl:r});return(0,o.useEffect)((()=>{T&&A&&(0,M().u)({environment:f,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:n,setup_session_id:k,from:w,is_space_admin:N,is_ai_eligible:D??!1}}})}),[f,w,D,T,N,k,n,A]),A&&"sharepoint"!==n?f.device.isMobile?(0,U.jsx)(je,{connectorType:n,open:T,onClosed:()=>c().NT[n].reset(),learnMoreUrl:t}):g&&u&&d&&T?(0,U.jsx)(an,{connector:n,personalConnector:d,learnMoreHref:t,onDismiss:()=>{c().NT[n].setState({...b,currentScreen:"none"})},onConfirm:e=>{if(p(!1),"workspace"!==e)return"personal"===e?(c().NT[n].setState({...b,currentScreen:"none"}),void(0,a().navigateToAIConnectorOnboarding)({connector:d,analyticsFrom:"workspace_connector_flow",sessionId:k})):void(0,V().HB)(e);p(!1)}}):N||(0,Je().q1)(n)?(0,U.jsx)(ae,{connectorType:n,notes:y,onLearnMore:()=>{window.open(t,"_blank")},onConnect:async()=>{j&&B&&(v(!0),await async function(e){const{connector:n,environment:t,spaceId:o,setupSessionId:s,from:i,authUrl:r,onConnectNotStarted:l,nextScreens:d,usesPopup:u,onNavigateToInProgressScreen:p}=e,g=c().NT[n].state;(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:n,setup_session_id:s,from:i}}}),(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:t,connector:n,moment:"started"});const m=await(0,x().Bw)(t,{name:"ai_connectors",spaceId:o,userId:t.currentUser.id});if(!(0,x().e2)(m))return void(0,Ze().pp)({connector:n,environment:t,analyticsFrom:i,connectorsFeatureAvailability:m});const{status:h}=await(0,c().Vn)(n)({environment:t,spaceId:o});if("failed"===h)return void c().NT[n].setState({...g,currentScreen:d.error});const v=(0,_().XY)(n);if("in_progress"===v)return(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_complete_screen",integration_type:n,setup_session_id:s,from:i}}}),c().NT[n].setState({...g,currentScreen:d.inProgress}),void(null==p||p());if("completed"===v)return(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen",integration_type:n,setup_session_id:s,from:i}}}),void c().NT[n].setState({...g,currentScreen:d.alreadyConnected});(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen",integration_type:n,setup_session_id:s,from:i}}}),c().NT[n].setState({...g,currentScreen:d.notStarted}),u?t.device.isElectron?I().openExternalUrl(r):pe().P(t,{width:800,height:600,url:r,titleMessage:ln.oauthPopupTitle,titleMessageValues:{connector:n}}):window.open(r,"_blank");null==l||l()}({environment:f,spaceId:j,setupSessionId:k,from:cn(n),authUrl:B,...e}),v(!1))},onDismiss:()=>{(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:n,setup_session_id:k,from:w}}}),c().NT[n].setState({...b,analyticsFrom:w,sessionId:k,currentScreen:"none"})},title:S,isLoading:m,open:T}):(0,U.jsx)(J,{connector:n,handleClose:()=>(0,a().resetAiConnectorStatus)(n),open:T,analyticsFrom:w,setupSessionId:k,messages:R().vc[n]}):null}const un={"google-drive":"Google Workspace Administrator",gmail:"Google Workspace Administrator"};function pn(e){return un[e]??""}function gn(e){const{connector:n,learnMoreUrl:t,screenName:o}=e,s=(0,w().tz)(),r=(0,i().O$)(c().NT[n]),{currentScreen:a}=r,l=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,U.jsx)(W().a,{showCloseIcon:!0,ariaLabel:s.formatMessage({defaultMessage:"Ai Connector Not External Admin",id:"aiConnectorOnboarding.notExternalAdmin.ariaLabel"}),onDismiss:()=>c().NT[n].setState({...r,currentScreen:"none"}),open:a===o,render:()=>(0,U.jsxs)("div",{style:l.wrapper,children:[(0,U.jsx)(P().b,{connectorType:n,title:(0,U.jsx)(w().sA,{id:"universalSearch.notAdmin.title",defaultMessage:"Only a {externalAdminName} can connect",values:{externalAdminName:pn(n)}}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.notAdmin.description",defaultMessage:"We can’t verify that this account is a {externalAdminName}. Please contact your admin to link Notion using their account.",values:{externalAdminName:pn(n)}})}),(0,U.jsx)(D().wt,{style:l.footer,children:(0,U.jsxs)(ee().A,{style:l.connectButton,onClick:()=>{window.open(t,"_blank")},children:[(0,U.jsx)(w().sA,{id:"universalSearch.notAdmin.learnMore",defaultMessage:"Learn more"}),(0,U.jsx)("div",{style:l.iconWrapper,children:(0,C().X)()})]})})]})})}var mn=()=>t(859428);function hn(e){const{connector:n,screenName:t,nextScreens:r,onDismiss:a,learnMoreUrl:l,settings:d}=e,u=(0,i().O$)(c().NT[n]),p=(0,L().J)(),{analyticsFrom:g,sessionId:m,currentScreen:h}=u,v=Z().w0[n],f=(0,i().K8)((()=>(0,_().XY)(n)),[n]),[y,x]=(0,o.useState)(!!d),[S,j]=(0,o.useState)(!d),C=function(e){return(0,b().IS)((n=>({wrapper:{width:400,padding:"0 24px 16px",minHeight:e?478:void 0},settingsWrapper:{justifyContent:"center",gap:12},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:n.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:k().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:k().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:14,fontWeight:k().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:k().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${n.text.secondary}`},externalLinkIcon:{width:16,height:16}})),[e])}(y),A=(0,s().v3)(),I=(0,w().tz)();return(0,U.jsx)(W().a,{ariaLabel:I.formatMessage({id:"aiConnectors.settingsModalAriaLabel",defaultMessage:"AI Connector Settings"}),showCloseIcon:!0,open:h===t,onDismiss:()=>{(0,M().u)({environment:A,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:n,setup_session_id:m,from:g}}}),null==a||a(),c().NT[n].setState({...u,currentScreen:"none"})},render:()=>(0,U.jsxs)("div",{style:C.wrapper,children:[(0,U.jsx)(P().b,{connectorType:n,title:"completed"===f?(0,U.jsx)(w().sA,{id:"aiConnectors.settingsModalTitle",defaultMessage:"{displayName} is connected to Notion AI",values:{displayName:v}}):(0,U.jsx)(w().sA,{id:"aiConnectors.settingsModalTitleNotCompleted",defaultMessage:"{displayName} is connecting to Notion AI",values:{displayName:v}}),subtext:(0,Je().q1)(n)&&p?(0,U.jsx)(w().sA,{id:"aiConnectors.settingsModalSubtext",defaultMessage:"Disconnect {connectorName} to connect your {workspaceConnectorParentName}",values:{connectorName:Z().w0[n],workspaceConnectorParentName:(0,Z().G6)((0,Z().uV)(n))}}):void 0}),y?(0,U.jsx)(D().Ye,{style:C.spinner,children:(0,U.jsx)(ge().A,{})}):(0,U.jsxs)(U.Fragment,{children:[d&&(0,U.jsx)(D().Ye,{style:C.settingsWrapper,children:d({setIsLoading:x,setIsDisconnectButtonEnabled:j})}),(0,U.jsx)(D().wt,{style:C.footer,children:S?(0,U.jsx)(vn,{connector:n,styles:C.disconnectButton,isDisconnectButtonEnabled:S,nextScreens:r}):(0,U.jsx)(mn().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(w().sA,{id:"aiConnector.disconnectDisabled.tooltip",defaultMessage:"You can cancel or modify {displayName} when the connection is complete. ",values:{displayName:v}})}),render:e=>(0,U.jsx)(vn,{connector:n,events:e,styles:C.disconnectButton,isDisconnectButtonEnabled:S,nextScreens:r})})}),l&&(0,U.jsx)(D().Ye,{style:C.learnMoreSection,children:(0,U.jsx)(T().A,{style:C.learnMoreButton,onClick:()=>{(0,M().u)({environment:A,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:n,setup_session_id:m,from:g}}}),window.open(l,"_blank")},children:(0,U.jsxs)(D().Ye,{style:C.learnMoreText,children:[(0,U.jsx)(w().sA,{id:"aiConnectors.integration.learnMore",defaultMessage:"Learn more"}),(0,Te().M)(C.externalLinkIcon)]})})})]})]})})}function vn(e){const{connector:n,styles:t,events:o,isDisconnectButtonEnabled:r,nextScreens:d}=e,u=(0,s().v3)(),p=(0,i().O$)(c().NT[n]),{sessionId:g,analyticsFrom:m}=p,h=(0,l().O)(),v=(0,i().K8)((()=>(0,_().XY)(n)),[n]);return(0,U.jsx)(Ne().E,{...o,style:t,disabled:!r,onClick:async()=>{if(h)if((0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:n,setup_session_id:g,from:m}}}),"completed"!==v){if("not_started"===v){const e=await(0,a().disconnectConnector)({connector:n,spaceId:h,environment:u,showToast:!0,disconnectReason:"admin_disconnect"});if(await(0,c().Vn)(n)({environment:u,spaceId:h}),"success"===e.type)return void c().NT[n].setState({...p,currentScreen:"none"})}c().NT[n].setState({...p,currentScreen:d.error})}else c().NT[n].setState({...p,currentScreen:d.disconnect})},children:(0,U.jsx)(w().sA,{id:"aiConnectors.settingsModal.disconnect",defaultMessage:"Disconnect"})})}function fn(){const{learnMoreUrl:e,googleAuthUrl:n}=(0,c().hP)("gmail");return(0,U.jsx)(dn,{connector:"gmail",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,staticAuthUrl:n})}function yn(){const e=(0,i().K8)((()=>Ee().X.state.currentScreen),[]);return(0,U.jsx)(ke,{connector:"gmail",open:"already_connected"===e,onDismiss:()=>{Ee().X.reset()}})}function xn(){const{learnMoreUrl:e}=(0,c().hP)("gmail");return(0,U.jsx)(gn,{connector:"gmail",screenName:"not_admin_screen",learnMoreUrl:e})}function _n(){return(0,U.jsx)(He,{connector:"gmail",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function Sn(){const e=(0,i().K8)((()=>Ee().X.state.connectionConflictSpaceId),[]);return(0,U.jsx)(Ye,{connector:"gmail",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:e??""})}function jn(){const e=(0,s().v3)(),n=(0,l().O)(),{learnMoreUrl:t,googleAuthUrl:o,troubleShootingUrl:i}=(0,c().hP)("gmail");return n?(0,U.jsx)(Re,{connector:"gmail",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:i,staticConnectorAuthUrl:o,setConnectionStateAsConnected:()=>{Ee().X.setState({...Ee().X.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})},setConnectionConflictSpaceId:e=>{Ee().X.setState({...Ee().X.state,connectionConflictSpaceId:e})},callConnectionApi:async()=>{const t=await A().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:n,connector:"gmail"}});if("success"!==t.type)return Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400}}});const o=t.data;return o.success?Promise.resolve({type:"success",data:{connectionSuccess:!0}}):"3p_connected_to_another_workspace"===o.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:400,errorCode:"GOOGLE_MAPPING_EXIST",data:{spaceId:o.alreadyConnectedSpaceId}}}}):"not_3p_admin"===o.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:403}}}):"not_connected"===o.failureReason?Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}}):void(0,V().HB)(o.failureReason)}}):null}function bn(){return(0,U.jsx)(hn,{connector:"gmail",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function Cn(){const{marketplaceAppConfigureUrl:e,marketplaceAppName:n}=(0,c().hP)("gmail");return(0,U.jsx)(Ve,{connector:"gmail",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{Ee().X.setState({...Ee().X.state,status:"not_started",isConnected:!1,isLoaded:!0})},showGoogleWorkspaceNote:!0,marketplaceAppConfigureUrl:e,marketplaceAppName:n})}function wn(){return(0,U.jsx)(Xe,{connector:"gmail",screenName:"error"})}var kn=()=>t(575922);function An(){const{learnMoreUrl:e,googleAuthUrl:n}=(0,c().hP)("google-calendar");return(0,U.jsx)(dn,{connector:"google-calendar",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,staticAuthUrl:n})}function In(){const e=(0,i().K8)((()=>kn().W.state.currentScreen),[]);return(0,U.jsx)(ke,{connector:"google-calendar",open:"already_connected"===e,onDismiss:()=>{kn().W.reset()}})}function Mn(){const{learnMoreUrl:e}=(0,c().hP)("google-calendar");return(0,U.jsx)(gn,{connector:"google-calendar",screenName:"not_admin_screen",learnMoreUrl:e})}function Tn(){return(0,U.jsx)(He,{connector:"google-calendar",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function Nn(){return(0,U.jsx)(Ye,{connector:"google-calendar",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:""})}function Wn(){const e=(0,s().v3)(),n=(0,l().O)(),{learnMoreUrl:t,googleAuthUrl:o,troubleShootingUrl:i}=(0,c().hP)("google-calendar");return n?(0,U.jsx)(Re,{connector:"google-calendar",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:i,staticConnectorAuthUrl:o,setConnectionStateAsConnected:()=>{kn().W.setState({...kn().W.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})},callConnectionApi:async()=>"success"===(await A().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:n,connector:"google-calendar"}})).type?Promise.resolve({type:"success",data:{connectionSuccess:!0}}):Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}):null}function Dn(){return(0,U.jsx)(hn,{connector:"google-calendar",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function Bn(){const{marketplaceAppConfigureUrl:e,marketplaceAppName:n}=(0,c().hP)("google-calendar");return(0,U.jsx)(Ve,{connector:"google-calendar",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{kn().W.setState({...kn().W.state,status:"not_started",isConnected:!1,isLoaded:!0})},showGoogleWorkspaceNote:!0,marketplaceAppConfigureUrl:e,marketplaceAppName:n})}function Fn(){return(0,U.jsx)(Xe,{connector:"google-calendar",screenName:"error"})}function Pn(){const e=(0,i().K8)((()=>f().d.state.currentScreen),[]);return(0,U.jsx)(ke,{open:"already_connected"===e,onDismiss:()=>{f().d.reset()},connector:"google-drive"})}function Un(){const[e,n]=o.useState(!1),t=(0,b().IS)((e=>({noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontweight:k().Wy.regular},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),r=(0,s().v3)(),c=(0,l().O)(),d=(0,i().K8)((()=>f().d.state.sessionId),[]),u=(0,i().K8)((()=>f().d.state.currentScreen),[]),p=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),g=(0,i().K8)((()=>v().default.getConfigKey("ingestion","googleDrive").googleAuthUrl),[]),m=(0,i().K8)((()=>v().default.getConfigKey("ingestion","googleDrive").troubleShootingUrl),[]),h=(0,i().K8)((()=>v().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),y=(0,o.useCallback)((async()=>{if(!c)return;var e;await(e=5e3,new Promise((n=>setTimeout(n,e))));const t=await A().callApi({eventName:"connectGoogleDriveForAIIngestion",environment:r,data:{spaceId:c}}),o=e=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:e,integration_type:"google-drive",setup_session_id:d,from:p}}})};var s,i,l;"success"===t.type?t.data.connectionSuccess?(o("auth_screen_connected"),f().d.setState({...f().d.state,currentScreen:"connection_complete_screen",availableSyncControlOptions:t.data.syncControlOptions})):((e,t,s)=>{switch(e){case 401:o("auth_screen_not_connected_warning"),n(!0);break;case 403:o("info_screen_connect_not_admin_screen"),(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"not_admin_screen",analyticsFrom:p,sessionId:d});break;case 400:"GOOGLE_MAPPING_EXIST"===t&&s?(o("workspace_already_connected"),f().d.setState({...f().d.state,connectedSpaceId:s}),(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"connection_exist_screen",analyticsFrom:p,sessionId:d})):(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:p,sessionId:d});break;default:(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:p,sessionId:d})}})(null==t||null===(s=t.data)||void 0===s||null===(s=s.errorResponse)||void 0===s?void 0:s.status,null==t||null===(i=t.data)||void 0===i||null===(i=i.errorResponse)||void 0===i?void 0:i.errorCode,null==t||null===(l=t.data)||void 0===l||null===(l=l.errorResponse)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.spaceId):(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:p,sessionId:d})}),[p,r,d,c]),x=(0,o.useCallback)((()=>[(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:t.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.waitingForConnectionNoteHeading1",defaultMessage:"Google should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:t.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.authWaiting",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:t.link,href:g,target:"_blank",onClick:()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"google-drive",setup_session_id:d,from:p}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:t.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.workspaceAdminHeading",defaultMessage:"Follow Google’s setup instructions"},"note2-1")}),(0,U.jsx)("div",{style:t.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.workspaceAdminBody",defaultMessage:"For better AI answers, we recommend selecting the option “All users in my organization”. In the next steps, you’ll be able to exclude specific Drives and can always update your selection."},"note2-2")})]},"note-2"),(0,U.jsx)(D().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:t.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.done",defaultMessage:"When you’re done, click the button below"},"note3-1")})},"note-3")]),[t,g,r,d,p]),_=e?(0,U.jsxs)(D().Ye,{style:t.warningContainer,children:[(0,Oe().Q)(t.icon),(0,U.jsx)("div",{style:t.warningText,children:(0,U.jsx)(w().sA,{id:"universalQnA.googleDrive.AuthScreen.warning",defaultMessage:"We couldn’t connect to Google. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...t.link,color:"#D7813A"},href:m,target:"_blank",onClick:()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_opened",integration_type:"google-drive",setup_session_id:d,from:p}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(Ke,{title:(0,U.jsx)(w().sA,{id:"universalQnA.googleDrive.AuthScreen",defaultMessage:"Follow instructions from Google in your browser"}),open:"auth_screen"===u,onDismiss:()=>{n(!1),(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"google-drive",setup_session_id:d,from:p}}}),(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:p,sessionId:d})},warningMessage:_,notes:x(),openLearnMoreUrl:()=>{window.open(h)},connectorType:"google-drive",primaryButtonText:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.Button.finishedSetup",defaultMessage:"Confirm connection"},"note3-1"),onClickPrimaryButton:y})}var zn=()=>t(386164),Ln=(t(672577),t(803949),()=>t(701545)),En=()=>t(802790),On=()=>t(297872),Kn=()=>t(73332);function Rn(e){const{onPrimaryButtonClick:n,setShowConfirmModal:t}=e,r=(0,s().v3)(),a=(0,i().O$)(f().d),c=(0,i().K8)((()=>f().d.state.currentScreen),[]),[l,d]=(0,o.useState)(!1),u=(0,b().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20}})),[]),p=e=>{f().d.setState({...a,currentScreen:e})};return(0,U.jsx)(W().a,{showCloseIcon:!0,open:"select_shared_drives_screen"===c,onDismiss:()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_confirm_modal_close",integration_type:"google-drive",setup_session_id:a.sessionId,from:a.analyticsFrom}}}),p("none"),t(!1)},render:()=>(0,U.jsx)("div",{style:u.confirmWrapper,children:(0,U.jsxs)("div",{style:u.confirmContainer,children:[(0,U.jsx)("div",{style:u.confirmModalTitle,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.confirmModal.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:u.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.confirmModal.subTitle",defaultMessage:"Google Drive content will be disconnected and re-connected. This can take up to 36h and AI answers will be unavailable until it’s complete."})}),(0,U.jsxs)(D().wt,{style:u.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isLoading:l,style:u.confirmDisconnectButton,disabled:a.isDisconnecting,onClick:async()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_confirm_button",integration_type:"google-drive",setup_session_id:a.sessionId,from:a.analyticsFrom}}}),d(!0),await n(),d(!1),t(!1),p("none")},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.editModal.confirmDisconnect",defaultMessage:"Confirm"})}),(0,U.jsx)(T().A,{style:u.goBackButton,onClick:()=>{(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_modal_cancel_button",integration_type:"google-drive",setup_session_id:a.sessionId,from:a.analyticsFrom}}}),t(!1)},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.editModal.cancel",defaultMessage:"Cancel"})})]})]})})})}function Hn(e){const{drive:n,styles:t,onToggle:o}=e;return(0,U.jsxs)(D().Ye,{gap:8,style:{alignItems:"center",padding:"10px 18px 6px 0px"},children:[(0,U.jsx)(Kn().T,{checked:n.checked,size:14,onClick:()=>o(n.id)}),(0,U.jsx)("div",{style:t.drivesRow,children:`${n.name}`},`${n.id}#3`)]})}function qn(e){const{styles:n,onPrimaryButtonClick:t,setShowConfirmModal:r,isFutureItemsChecked:a,setDriveCheckboxItems:c,sharedDriveCheckboxItems:d,setFutureItemsChecked:u}=e,p=(0,i().O$)(f().d),g=(0,i().K8)((()=>f().d.state.sessionId),[]),m=(0,i().K8)((()=>f().d.state.initialSyncState),[]),h=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),v=(0,i().K8)((()=>f().d.state.currentScreen),[]),y=(0,l().O)(),[x,_]=(0,o.useState)(!1),S=(0,s().v3)();if((0,o.useEffect)((()=>{const e=p.availableSyncControlOptions.filter((e=>"shared_drive"===e.type));0===e.length&&"select_shared_drives_screen"===v&&(0,M().u)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"no_shared_drives",integration_type:"google-drive",setup_session_id:g,from:h}}});const n=p.syncControlSelection;if(!n)return c(e.map((e=>({...e,checked:!0})))),void u(!0);c(e.map((e=>({...e,checked:!n.driveIds||n.driveIds.includes(e.id)})))),u(n.enableSyncingFutureUsersAndDrives)}),[h,S,p,v,c,u,g]),!y)return null;const j=d.find((e=>e.checked))||a,b=e=>{(0,M().u)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"individual_drive_checkbox",integration_type:"google-drive",setup_session_id:p.sessionId,from:p.analyticsFrom}}}),c(d.map((n=>n.id===e?{...n,checked:!n.checked}:n)))},C=d.map((e=>(0,U.jsx)(Hn,{drive:e,styles:n,onToggle:b},e.id))).filter(V().O9);return(0,U.jsxs)(D().wt,{children:[(0,U.jsx)(D().Ye,{style:n.selectionWrapper,children:(0,U.jsxs)(D().wt,{style:n.scrollContainer,children:[(0,U.jsx)(En().A,{style:{paddingBottom:4},size:4}),(0,U.jsx)(D().Ye,{style:n.rowTitle,children:(0,U.jsxs)(D().Ye,{children:[(0,U.jsx)(D().wt,{children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.allItemsTitle",defaultMessage:"Content owned by users"})}),(0,U.jsx)(D().wt,{style:{paddingLeft:200},children:(0,Ln().p)(n.checkMark)})]})}),(0,U.jsx)(D().Ye,{style:n.rowAdditionalText,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.allItemsSubtext",defaultMessage:"Includes all files owned by users selected in Google Workspace Settings"})}),(0,U.jsx)(En().A,{style:{paddingTop:10,paddingBottom:10},size:4}),(0,U.jsx)(D().Ye,{style:n.rowTitle,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrivesTitle",defaultMessage:"Content in Shared Drives"})}),(0,U.jsx)(D().Ye,{style:n.rowAdditionalText,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrivesSubtext",defaultMessage:"Includes files in Shared Drives as long as they are owned by users selected in the setting above."})}),(0,U.jsx)(D().Ye,{children:(0,U.jsx)(D().wt,{children:0===C.length?(0,U.jsx)(D().Ye,{style:{...n.rowAdditionalText,fontSize:14,paddingTop:10},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.noSharedDrivesSubtext",defaultMessage:"No Shared Drives found"})}):C})})]})}),(0,U.jsxs)(D().wt,{style:n.footer,children:[(0,U.jsxs)(D().Ye,{style:{gap:4,alignItems:"center",width:"inherit"},children:[(0,U.jsx)(Kn().T,{checked:a,size:14,onClick:()=>{(0,M().u)({environment:S,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:`future_items_checkbox_${(!a).toString()}`,integration_type:"google-drive",setup_session_id:p.sessionId,from:p.analyticsFrom}}}),u(!a)}}),(0,U.jsx)("div",{style:{fontSize:12,lineHeight:"16px",paddingBottom:2},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.allSharedDrives",defaultMessage:"Include Drives created in the future"})})]}),(0,U.jsx)(ee().A,{style:n.continueButton,isLoading:x,disabled:!j,onClick:async()=>{_(!0),"completed"!==m?(await t(),_(!1)):r(!0)},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.confirm",defaultMessage:"Confirm selection"})})]})]})}async function Gn(e){const{environment:n,spaceId:t}=e,o=m().default.state.currentUserStore,{analyticsFrom:s,sessionId:i}=f().d.state;if("success"===(await A().callApi({eventName:"startGoogleDriveSyncForAIIngestion",environment:n,data:{spaceId:t,setupSessionId:i}})).type){var r;f().d.setState({...f().d.state,initialSyncState:"in_progress",ingestionProgress:1});const e=S().A.state.appsConnectionData.filter((e=>e.id!==Je()._u));return S().A.setState({...S().A.state,appsConnectionData:[...e,{connectionStatus:"in_progress",connectionLastEditedTimestamp:Date.now(),connectionType:"google-drive",connectorEmail:(null==o?void 0:o.getEmail())||"",id:Je()._u,connectorNotionId:null==o||null===(r=o.getModel())||void 0===r?void 0:r.id}]}),(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:s,sessionId:i}),!0}return(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:s,sessionId:i}),!1}const Yn=function(){const[e,n]=(0,o.useState)(!1),t=(0,i().K8)((()=>f().d.state.currentScreen),[]),r=(0,s().v3)(),c=(0,l().O)(),d=(0,i().O$)(f().d),u=(0,b().IS)((e=>({wrapper:{width:400},scrollContainer:{overflow:"scroll",paddingRight:20,height:350},rowTitle:{fontSize:12,lineHeight:"16px",fontWeight:510,paddingBottom:4},rowAdditionalText:{fontSize:12,lineHeight:"16px",color:e.text.secondary},drivesRow:{fontSize:14,lineHeight:"18px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",height:75,boxShadow:e.shadowMD,padding:"16px 20px 16px 20px",gap:6},continueButton:{fontSize:14,fontWeight:k().Wy.semibold,width:360},selectionWrapper:{marginTop:24,paddingLeft:20,justifyContent:"center",overflow:"auto"},selection:{width:360,height:263,marginBotton:12},checkMark:{width:14,color:e.text.secondary}})),[]),p=(0,i().K8)((()=>f().d.state.sessionId),[]),g=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),[m,h]=(0,o.useState)(!0),[v,y]=(0,o.useState)([]),x=()=>{f().d.setState({...f().d.state,syncControlSelection:{driveIds:[],enableSyncingFutureUsersAndDrives:!1},availableSyncControlOptions:[]})},_=(0,o.useCallback)((async()=>{let e=!0;m&&(e=!1);const n=[];if(v.forEach((t=>{if(t.checked===e){const{checked:e,...o}=t;n.push({...o})}})),(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drive_and_user_selector_primary_button",integration_type:"google-drive",setup_session_id:d.sessionId,from:d.analyticsFrom}}}),!c)return;const t=n,o=await A().callApi({eventName:"patchSyncControlsForGoogleDriveAIIngestion",environment:r,data:{spaceId:c,exclusionList:m?t:[],inclusionList:m?[]:t}}),s="in_progress"===f().d.state.initialSyncState||"completed"===f().d.state.initialSyncState;if("failed"===o.type)return void H().D6({label:(0,U.jsx)(w().sA,{id:"googleIngestionConfirmation.ingestion.failed",defaultMessage:"Cannot edit Google shared drives now. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"googleIngestionConfirmation.ingestion.failedMessageDismiss",defaultMessage:"Close"})})});const i="success"===o.type&&o.data.syncControlsUpdated||!s&&"success"===o.type&&!o.data.syncControlsUpdated,l=s&&"success"===o.type&&!o.data.syncControlsUpdated;if(i){const e=await Gn({environment:r,spaceId:c});x(),e&&H().D6({label:(0,U.jsx)(w().sA,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}else l?(H().D6({label:(0,U.jsx)(w().sA,{id:"googleIngestionConfirmation.ingestion.skip",defaultMessage:"No change made to Google Drive Connection."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"googleIngestionConfirmation.ingestion.noConfigChangeDismiss",defaultMessage:"Close"})})}),x(),f().d.setState({...f().d.state,initialSyncState:"completed"}),(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:g,sessionId:p})):(x(),(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:g,sessionId:p}))}),[g,r,d,m,p,v,c]);return e?(0,U.jsx)(Rn,{onPrimaryButtonClick:_,setShowConfirmModal:n}):(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:()=>{(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:p,analyticsFrom:g})},open:"select_shared_drives_screen"===t,render:()=>(0,U.jsxs)("div",{style:u.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"google-drive",title:(0,U.jsx)(w().sA,{defaultMessage:"Select Drives to Connect",id:"googleAiConnector.universalQnaSharedDriveSelectorPopup.selectDrivesToConnect"})}),(0,U.jsx)(On().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)(qn,{styles:u,onPrimaryButtonClick:_,setShowConfirmModal:n,isFutureItemsChecked:m,setFutureItemsChecked:h,sharedDriveCheckboxItems:v,setDriveCheckboxItems:y})})]})})},Jn=Z().w0["google-drive"];function Qn(){const e=(0,s().v3)(),n=(0,i().K8)((()=>f().d.state.sessionId),[]),t=(0,l().O)(),r=(0,i().K8)((()=>f().d.state.initialSyncState),[]),c=(0,i().K8)((()=>f().d.state.currentScreen),[]),d=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),u=(0,o.useCallback)((()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"google-drive",setup_session_id:n,from:d}}}),(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:n})}),[d,e,n]);if((0,o.useEffect)((()=>{"connection_complete_screen"===c&&(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"google-drive",moment:"finished"})}),[e,c]),"completed"===r||!t)return(0,U.jsx)(U.Fragment,{});const p="in_progress"===r;return(0,U.jsx)(Ue,{open:"connection_complete_screen"===c,connectorType:"google-drive",notes:[(0,U.jsx)(Be,{number:1,title:{...{...Pe.connectionInProgressTitle,values:{appName:Jn}}},description:Pe.defaultConnectionTime},"item1"),(0,U.jsx)(Be,{number:2,title:{...{...Pe.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Jn}}}},"item2")],onEditSettingsClick:p?void 0:async()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"shared_drive_settings",integration_type:"google-drive",setup_session_id:n,from:d}}});const o=await A().callApi({eventName:"getGoogleDriveSyncProgress",environment:e,data:{spaceId:t},headers:(0,zn().WS)({spaceId:t})});if("success"===o.type){var s;const e=(0,_().HB)(null===(s=o.data)||void 0===s?void 0:s.status);f().d.setState({...f().d.state,initialSyncState:e}),"in_progress"===e?(0,a().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"settings"}):"not_started"===e?(0,a().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"select_shared_drives_screen"}):(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:d,sessionId:n})}else(0,a().navigateToGoogleDriveUniversalScreen)({analyticsFrom:d,sessionId:n,screenToShow:"error"})},onPrimaryButtonClick:async()=>{if((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"google-drive",setup_session_id:n,from:d}}}),!t)return;if(p)return void(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:n});await Gn({environment:e,spaceId:t})&&H().D6({label:(0,U.jsx)(w().sA,{id:"googleIngestionConfirmation.ingestion.acknowledge",defaultMessage:"Started syncing from Google drive. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"googleIngestionConfirmation.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})},onDismiss:u})}function $n(){const e=(0,i().K8)((()=>f().d.state.currentScreen),[]),n=(0,i().K8)((()=>f().d.state.sessionId),[]),t=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),r=(0,i().K8)((()=>f().d.state.connectedSpaceId),[]),c=(0,s().v3)(),l=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"}})),[]),d="connection_exist_screen"===e,u=(0,o.useCallback)((async()=>{const e=m().default.state.currentUserRootStore;if(!e)return;(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:"google-drive",setup_session_id:n,from:t}}});const o=e.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];await Ge().tR({environment:c,navigationType:"switchingToOrLoadingSpace",pageVisitSource:qe().y8.AIGoogleDriveQna,spaceViewStore:o,userRootStore:m().default.state.currentUserRootStore,userSettingsStore:m().default.state.currentUserSettingsStore}),f().d.reset(),f().d.setState({...f().d.state,currentScreen:"settings",analyticsFrom:"google_other_workspace",sessionId:n})}),[t,r,c,n]);return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:()=>(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:d,render:()=>(0,U.jsxs)("div",{style:l.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"google-drive",title:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.connectionExist.title",defaultMessage:"You’ve already connected Google Drive to another Notion workspace."}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.connectionExist.description",defaultMessage:"Currently, only one workspace can be connected to Google Drive. To connect this workspace, please disconnect the existing connection."})}),(0,U.jsx)(D().wt,{style:l.footer,children:(0,U.jsx)(ee().A,{style:l.connectButton,onClick:u,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.connectionExist.navigateButton",defaultMessage:"Visit the other workspace"})})})]})})}function Vn(){const e=(0,i().O$)(f().d),n=(0,i().K8)((()=>f().d.state.currentScreen),[]),t=(0,l().O)(),r=(0,i().K8)((()=>v().default.getConfigKey("ingestion","googleDrive").marketplaceAppConfigureUrl),[]),a=(0,i().K8)((()=>f().d.state.sessionId),[]),c=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),d=(0,s().v3)(),u=async()=>{if(!t)return;const e=await async function(e){const{environment:n,spaceId:t}=e,o=await A().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:n,data:{spaceId:t,disconnectReason:"admin_disconnect"}}),s=m().default.state.currentUserStore;if("success"===o.type&&o.data.deletionInitiated){var i;f().d.setState({...f().d.state,currentScreen:"none",isDisconnecting:!0});const e=S().A.state.appsConnectionData.filter((e=>e.id!==Je()._u));return S().A.setState({...S().A.state,appsConnectionData:[...e,{connectionStatus:"disconnecting",connectionLastEditedTimestamp:Date.now(),connectionType:"google-drive",connectorEmail:(null==s?void 0:s.getEmail())||"",id:Je()._u,connectorNotionId:null==s||null===(i=s.getModel())||void 0===i?void 0:i.id}]}),!0}return f().d.setState({...f().d.state,currentScreen:"error",isDisconnecting:!1}),!1}({environment:d,spaceId:t});e?H().D6({label:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.acknowledgeDisconnect",defaultMessage:"Started disconnecting Google Drive. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}):H().D6({label:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.disconnectError",defaultMessage:"Failed to disconnect Google Drive. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.closeSnackbarError",defaultMessage:"Close"})})})},p=n=>{f().d.setState({...e,currentScreen:n})},g=(0,b().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:k().Wy.regular,fontSize:14,lineHeight:"18px"},noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),h=(0,o.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:n,noteBody:t,link:o}=g;return[(0,U.jsxs)(D().wt,{style:e,children:[(0,U.jsx)("div",{style:n,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.heading",defaultMessage:"Google Drive data will be permanently deleted from Notion"},"note1-1")}),(0,U.jsx)("div",{style:t,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You'll only be able to reconnect after disconnecting is complete."},"note1-2")})]},"note-1"),(0,U.jsxs)(D().wt,{style:e,children:[(0,U.jsx)("div",{style:n,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Google Workspace (optional)"},"note2-1")}),(0,U.jsx)("div",{style:t,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToGoogleWorkspaceAppsSettings} and uninstall the Notion AI app.",values:{NavigateToGoogleWorkspaceAppsSettings:(0,U.jsx)("a",{style:o,href:r,target:"_blank",onClick:()=>{(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"google-drive",setup_session_id:a,from:c}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.post_disconnect_screen.disconnect_google_marketplace_app",defaultMessage:"Google Workspace {ArrowIcon}",values:{ArrowIcon:(0,Qe().q)(g.icon)}})})}},"note2-2")})]},"note-2")]}),[g,r,d,a,c]);return"post_disconnect_screen"===n?(0,U.jsx)($e,{onClickGotItBtn:()=>{p("none")},onDismiss:()=>{p("none")},open:"post_disconnect_screen"===n,connectorType:"google-drive",title:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.title",defaultMessage:"Google Drive is Disconnecting from Notion"}),descriptionMessage:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.post_disconnect_modal.description",defaultMessage:"Here's what's next:"}),message:(0,U.jsx)("div",{style:g.notesSectionWrapper,children:h().map(((e,n)=>(0,U.jsxs)(D().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:g.note,children:e})]},n)))})}):(0,U.jsx)(W().a,{showCloseIcon:!0,open:"disconnect_screen"===n,onDismiss:()=>{(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_close",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),p("none")},render:()=>(0,U.jsx)("div",{style:g.confirmWrapper,children:(0,U.jsxs)("div",{style:g.confirmContainer,children:[(0,U.jsx)("div",{style:g.confirmModalTitle,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:g.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.subTitle",defaultMessage:"Google Drive data will be permanently deleted from Notion."})}),(0,U.jsx)("div",{style:g.confirmModalDescription,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you'll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(D().wt,{style:g.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isRed:!0,style:g.confirmDisconnectButton,disabled:e.isDisconnecting,onClick:async()=>{(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),await u(),p("post_disconnect_screen")},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(T().A,{style:g.goBackButton,onClick:()=>{(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_back_button",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),p("settings")},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.disconnectModal.goBack",defaultMessage:"Go back"})})]})]})})})}function Xn(){const e=(0,i().K8)((()=>f().d.state.currentScreen),[]),n=(0,i().K8)((()=>f().d.state.sessionId),[]),t=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),r=(0,s().v3)(),c=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"}})),[]),l="error"===e;return(0,o.useEffect)((()=>{l&&(0,M().u)({environment:r,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect_error",integration_type:"google-drive",setup_session_id:n,from:t}}})}),[l,t,n,r]),(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:()=>(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:l,render:()=>(0,U.jsxs)("div",{style:c.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"google-drive",title:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(D().wt,{style:c.footer,children:(0,U.jsx)(ee().A,{style:c.connectButton,onClick:()=>{(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n})},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.error.Dismiss",defaultMessage:"Close"})})})]})})}function Zn(){const[e,n]=o.useState(!1),t=(0,s().v3)(),r=(0,o.useMemo)((()=>Se("google-drive")),[]),c=(0,o.useMemo)((()=>_e("google-drive")),[]),d=(0,l().O)(),u=(0,i().K8)((()=>f().d.state.sessionId),[]),p=(0,i().K8)((()=>f().d.state.currentScreen),[]),g=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),m=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("google-drive")),[]),y=(0,i().K8)((()=>v().default.getConfigKey("ingestion","googleDrive").learnMoreUrl),[]),S=(0,L().J)(),j=t.currentUser.id,b=(0,x().P9)({name:"ai_connectors",spaceId:d,userId:j}),C="introduction"===p;return(0,o.useEffect)((()=>{C&&m&&(0,M().u)({environment:t,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"google-drive",setup_session_id:u,from:g,is_space_admin:S,is_ai_eligible:b??!1}}})}),[g,t,b,C,S,u,m]),m?t.device.isMobile?(0,U.jsx)(je,{connectorType:"google-drive",open:C,onClosed:()=>{f().d.reset()},learnMoreUrl:y}):S?(0,U.jsx)(ae,{connectorType:"google-drive",notes:r,onLearnMore:()=>{const e=v().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;window.open(n,"_blank")},onConnect:async()=>{d&&(n(!0),await async function(e,n,t,o){var s,i;(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"google-drive",setup_session_id:t,from:o}}}),(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"google-drive",moment:"started"});const r=await(0,x().Bw)(e,{name:"ai_connectors",spaceId:n,userId:e.currentUser.id});if(!(0,x().e2)(r))return void(0,Ze().pp)({connector:"google-drive",environment:e,analyticsFrom:"google_drive_connect_button",connectorsFeatureAvailability:r});const c=await A().callApi({eventName:"getGoogleDriveSyncProgress",environment:e,data:{spaceId:n},headers:(0,zn().WS)({spaceId:n})});if("failed"===c.type)return void(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:o,sessionId:t});const l=null==c||null===(s=c.data)||void 0===s?void 0:s.status,d=(0,_().HB)(l);if(f().d.setState({...f().d.state,initialSyncState:d,ingestionProgress:null==c||null===(i=c.data)||void 0===i?void 0:i.ingestionProgress}),"success"===c.type&&"in_progress"===d)return(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_complete_screen",integration_type:"google-drive",setup_session_id:t,from:o}}}),void(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"settings",analyticsFrom:o,sessionId:t});if("success"===c.type&&"completed"===d)return(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen",integration_type:"google-drive",setup_session_id:t,from:o}}}),void(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"already_connected",analyticsFrom:o,sessionId:t});(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen",integration_type:"google-drive",setup_session_id:t,from:o}}}),(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"auth_screen",analyticsFrom:o,sessionId:t});const u=v().default.getConfigKey("ingestion","googleDrive");window.open(u.googleAuthUrl,"_blank"),A().callApi({eventName:"initiateGoogleDriveDelayedIngestion",environment:e,data:{spaceId:n,setupSessionId:t}})}(t,d,u,g),n(!1))},onDismiss:()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"google-drive",setup_session_id:u,from:g}}}),(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:g,sessionId:u})},title:c,isLoading:e,open:C}):(0,U.jsx)(J,{connector:"google-drive",handleClose:()=>(0,a().resetAiConnectorStatus)("google-drive"),open:C,analyticsFrom:g,setupSessionId:u,messages:R().Fn}):(0,U.jsx)(U.Fragment,{})}function et(){const e=(0,i().K8)((()=>f().d.state.currentScreen),[]),n=(0,i().K8)((()=>f().d.state.sessionId),[]),t=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),o=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:()=>(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:"not_admin_screen"===e,render:()=>(0,U.jsxs)("div",{style:o.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"google-drive",title:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.notAdmin.title",defaultMessage:"Only Google Workspace Administrators can connect"}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.notAdmin.description",defaultMessage:"We can't verify that this account is a Google Workspace Administrator. Please contact your admin to link Notion using their account."})}),(0,U.jsx)(D().wt,{style:o.footer,children:(0,U.jsxs)(ee().A,{style:o.connectButton,onClick:()=>{const e=v().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;window.open(n,"_blank")},children:[(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.notAdmin.learnMore",defaultMessage:"Learn more"}),(0,U.jsx)("div",{style:o.iconWrapper,children:(0,C().X)()})]})})]})})}var nt=()=>t(124858);function tt(e){const{styles:n,events:t,isEditButtonEnabled:o,navigateToScreen:r}=e,a=(0,s().v3)(),c=(0,i().O$)(f().d);return(0,U.jsx)(ie().A,{...t,size:"lg",style:n,disabled:!o,onClick:()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_drives_button",integration_type:"google-drive",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),r("select_shared_drives_screen")},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Drives"})})}function ot(e){const{styles:n,events:t,isDisconnectButtonEnabled:o,navigateToScreen:r}=e,a=(0,s().v3)(),c=(0,i().O$)(f().d),d=(0,l().O)(),u=(0,i().K8)((()=>f().d.state.initialSyncState),[]);return(0,U.jsx)(Ne().E,{...t,style:n,disabled:!o,onClick:async()=>{if(d)if((0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"google-drive",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),"completed"!==u){if("not_started"===u){if("success"===(await A().callApi({eventName:"disconnectGoogleDriveAIIngestion",environment:a,data:{spaceId:d,disconnectReason:"admin_disconnect"}})).type)return void r("none")}r("error")}else r("disconnect_screen")},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.disconnectGoogleDrive",defaultMessage:"Disconnect"})})}const st=function(){const e=(0,i().O$)(f().d),n=(0,l().O)(),t=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),c=(0,i().K8)((()=>f().d.state.currentScreen),[]),d=(0,i().K8)((()=>f().d.state.initialSyncState),[]),u=(0,i().K8)((()=>f().d.state.sessionId),[]),[p,g]=(0,o.useState)(!0),[m,h]=(0,o.useState)(!1),[y,x]=(0,o.useState)(!1),[S,j]=(0,o.useState)([]),C=(0,s().v3)();(0,r().Yb)((async()=>{if(!n||!C||"settings"!==c)return;g(!0);let e=d;if("none"===d){var o;const s=await A().callApi({eventName:"getGoogleDriveSyncProgress",environment:C,data:{spaceId:n},headers:(0,zn().WS)({spaceId:n})});if("failed"===s.type)return void(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"error",analyticsFrom:t,sessionId:u});const i=null==s||null===(o=s.data)||void 0===o?void 0:o.status;e=(0,_().HB)(i),f().d.setState({...f().d.state,initialSyncState:e})}}),[t,C,d,c,u,n]),(0,r().Yb)((async()=>{if(n&&C&&"settings"===c&&"none"!==d)if("in_progress"===d)g(!1),h(!1),x(!1);else if("completed"===d||"not_started"===d){const e=await A().callApi({eventName:"getSyncControlsForGoogleDriveAIIngestion",environment:C,data:{spaceId:n}});if("success"===(null==e?void 0:e.type)){const n=e.data;g(!1),h(!0),"not_started"===d?f().d.setState({...f().d.state,availableSyncControlOptions:n.options}):(f().d.setState({...f().d.state,availableSyncControlOptions:n.options,syncControlSelection:n.selection}),j(n.options.filter((e=>n.selection.driveIds.includes(e.id))))),f().d.state.isEditing||"in_progress"===f().d.state.initialSyncState||x(!0)}else h(!1),x(!1),H().D6({label:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.userError",defaultMessage:"Cannot disconnect Google Drive. Please contact Notion workspace admin."}),position:"bottom",style:{width:"600px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.closeSnackbarError",defaultMessage:"Close"})})})}}),[n,C,c,d]);const I=n=>{(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:n,analyticsFrom:e.analyticsFrom,sessionId:e.sessionId})},N=function(e){return(0,b().IS)((n=>({wrapper:{width:400,padding:"0 24px",minHeight:e?478:void 0},settingsWrapper:{justifyContent:"center",gap:12},googleDriveDetailsContainer:{fontSize:14,fontWeight:k().Wy.regular,color:n.text.secondary,gap:12},driveNamesContainer:{gap:2,color:n.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},moreDrivesContainer:{padding:"4px 0px 4px 0px"},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:14,fontWeight:k().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:k().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${n.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:n.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:k().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:k().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},driveItemWrapper:{width:"100%",padding:"4px 0px 4px 0px",alignItems:"center"},driveName:{fontSize:14},driveIcon:{width:20,color:n.text.secondary}})),[e])}(p);return(0,U.jsx)(W().a,{showCloseIcon:!0,open:"settings"===c,onDismiss:()=>{(0,M().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),j([]),I("none")},render:()=>{var n,t,o;return(0,U.jsxs)("div",{style:N.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"google-drive",title:"completed"===d?(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModalTitle",defaultMessage:"Google Drive is connected to Notion AI"}):(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModalTitle2",defaultMessage:"Google Drive is connecting to Notion AI"})}),p?(0,U.jsx)(D().Ye,{style:N.spinner,children:(0,U.jsx)(ge().A,{})}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(D().Ye,{style:N.settingsWrapper,children:(0,U.jsxs)(D().wt,{style:N.googleDriveDetailsContainer,children:[(0,U.jsx)(D().wt,{children:"completed"===d?(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {driveCountMessage}{futureDrivesMessage}",values:{driveCountMessage:S.length?`${S.length} Google Drives`:"Google Drive",futureDrivesMessage:null!==(n=e.syncControlSelection)&&void 0!==n&&n.enableSyncingFutureUsersAndDrives?", including future drives and users.":"."}}):(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.canAnswerFrom2",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete. "})}),(0,U.jsxs)(D().wt,{children:[(0,U.jsxs)(D().wt,{style:N.driveNamesContainer,children:[(null===(t=e.syncControlSelection)||void 0===t?void 0:t.enableSyncingFutureUsersAndDrives)&&(0,U.jsxs)(D().Ye,{style:N.driveItemWrapper,children:[(0,U.jsx)(D().wt,{style:N.driveIcon,children:(0,nt().E)({width:14,height:14})}),(0,U.jsx)(D().wt,{style:N.driveName,children:(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.includeCurrentAndFutureDrives",defaultMessage:"Includes current and future drives"})})})]}),null===(o=S.slice(0,4))||void 0===o?void 0:o.map((e=>(0,U.jsx)("div",{children:(0,U.jsxs)(D().Ye,{style:N.driveItemWrapper,children:[(0,U.jsx)(D().wt,{style:N.driveIcon,children:(0,nt().E)({width:14,height:14})}),(0,U.jsx)(D().wt,{style:N.driveName,children:`${e.name}`})]})},e.id)))]}),(0,U.jsx)(D().Ye,{style:N.moreDrivesContainer,children:S.length-4>0?(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.settingsModal.moreDrives",defaultMessage:"... and {moreDriveCount} more",values:{moreDriveCount:S.length-4}}):(0,U.jsx)(U.Fragment,{})})]})]})}),(0,U.jsxs)(D().wt,{style:N.footer,children:[y?(0,U.jsx)(tt,{styles:N.disconnectButton,isEditButtonEnabled:y,navigateToScreen:I}):(0,U.jsx)(mn().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,U.jsx)(tt,{events:e,styles:N.disconnectButton,isEditButtonEnabled:y,navigateToScreen:I})}),m?(0,U.jsx)(ot,{styles:N.disconnectButton,isDisconnectButtonEnabled:m,navigateToScreen:I}):(0,U.jsx)(mn().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(w().sA,{id:"universalSearch.googleDriveIngestion.editDrive.tooltip",defaultMessage:"You can cancel or modify your settings when the connection is complete. "})}),render:e=>(0,U.jsx)(ot,{events:e,styles:N.disconnectButton,isDisconnectButtonEnabled:m,navigateToScreen:I})})]}),(0,U.jsx)(D().Ye,{style:N.learnMoreSection,children:(0,U.jsx)(T().A,{style:N.learnMoreButton,onClick:()=>{(0,M().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"google-drive",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),(()=>{const e=v().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;n&&window.open(n,"_blank")})()},children:(0,U.jsxs)(D().Ye,{style:N.learnMoreText,children:[(0,U.jsx)(w().sA,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,Te().M)(N.externalLinkIcon)]})})})]})]})}})};function it(){const e=(0,i().K8)((()=>f().d.state.currentScreen),[]),n=(0,i().K8)((()=>f().d.state.sessionId),[]),t=(0,i().K8)((()=>f().d.state.analyticsFrom),[]),o=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"},iconWrapper:{width:16,height:16}})),[]);return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:()=>(0,a().navigateToGoogleDriveUniversalScreen)({screenToShow:"none",sessionId:n,analyticsFrom:t}),open:"service_account_not_added"===e,render:()=>(0,U.jsxs)("div",{style:o.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"google-drive",title:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.accountNotAdded.title",defaultMessage:"First, get your Google Workspace ready"}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.googleDrive.accountNotAdded.description",defaultMessage:"Before linking Google Drive with Notion, you'll need to modify a few settings in your Google Workspace."})}),(0,U.jsx)(D().wt,{style:o.footer,children:(0,U.jsxs)(ee().A,{style:o.connectButton,onClick:()=>{const e=v().default.getConfigKey("ingestion","googleDrive"),n=null==e?void 0:e.learnMoreUrl;window.open(n,"_blank")},children:[(0,U.jsx)(w().sA,{id:"universalSearch.integration.seeInstruction",defaultMessage:"See instructions"}),(0,U.jsx)("div",{style:o.iconWrapper,children:(0,C().X)()})]})})]})})}function rt(){const e=(0,i().K8)((()=>y().y.state.currentScreen),[]);return(0,U.jsx)(ke,{open:"already_connected"===e,onDismiss:()=>{y().y.reset()},connector:"jira"})}var at=()=>t(124749);function ct(){const[e,n]=o.useState(!1),t=(0,s().v3)(),r=(0,b().IS)((e=>({noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontweight:k().Wy.regular},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),c=(0,i().K8)((()=>y().y.state.currentScreen),[]),d=(0,i().K8)((()=>y().y.state.analyticsFrom),[]),u=(0,i().K8)((()=>y().y.state.sessionId),[]),p=(0,at().$)(),g=(0,l().O)(),m=(0,o.useCallback)((async()=>{if(!g)return;var e;(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"jira",setup_session_id:u,from:d}}}),await(e=5e3,new Promise((n=>setTimeout(n,e))));const o=await A().callApi({eventName:"checkNotionToJiraConnection",environment:t,data:{spaceId:g}});"success"===o.type&&o.data.isConnected?(y().y.setState({...y().y.state,currentScreen:"connection_complete_screen",jiraSiteId:o.data.jiraSiteId}),(0,a().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:d,sessionId:u})):n(!0)}),[d,t,u,g]),h=(0,i().K8)((()=>v().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl")),[]),f=(0,i().K8)((()=>v().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);if(!p||!g)return null;const x=e?(0,U.jsxs)(D().Ye,{style:r.warningContainer,children:[(0,Oe().Q)(r.icon),(0,U.jsx)("div",{style:r.warningText,children:(0,U.jsx)(w().sA,{id:"universalQnA.jira.AuthScreen.warning",defaultMessage:"We couldn’t connect to Jira. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...r.link,color:"#D7813A"},href:f,target:"_blank",onClick:()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"trouble_shooting_guide_clicked",integration_type:"jira",setup_session_id:u,from:d}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(Ke,{title:(0,U.jsx)(w().sA,{id:"universalQnA.jira.AuthScreen",defaultMessage:"Follow instructions from Jira in your browser"}),open:"check_connection"===c,onDismiss:()=>{n(!1),(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"jira",setup_session_id:u,from:d}}}),(0,a().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:d,sessionId:u})},warningMessage:x,notes:[(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:r.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.waitingForConnectionNoteHeading1",defaultMessage:"Jira should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:r.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.authWaiting2",defaultMessage:"If it doesn't, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:r.link,href:h,target:"_blank",onClick:()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"jira",setup_session_id:u,from:d}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:r.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.workspaceAdminHeading",defaultMessage:"Follow Jira’s instructions to connect"},"note2")}),(0,U.jsx)("div",{style:r.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.authWaiting",defaultMessage:"Install the Notion connector in a Jira site of your choice and return to this window"},"note1-2")})]},"note-2"),(0,U.jsx)(D().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:r.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.workspaceAdminHeading2",defaultMessage:"When you’re done, click the button below"},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open(f,"_blank")},connectorType:"jira",primaryButtonText:(0,U.jsx)(w().sA,{id:"universalSearch.jira.Button.finishedSetup",defaultMessage:"Check connection"},"note3-1"),onClickPrimaryButton:m})}var lt=()=>t(280746),dt=()=>t(751156),ut=()=>t(954191),pt=()=>t(525884),gt=()=>t(187820);function mt(e){const{connector:n,learnMoreUrl:t,from:r,to:a,subtext:l,onDismiss:d,close:u,onConfirm:p,open:g,title:m}=e,[v,f]=o.useState(!1),y=(0,s().v3)(),x=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope(n)),[n]),_=(0,b().IS)((e=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12,justifyContent:"center"},waitingForConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},note:{fontWeight:k().Wy.regular,fontSize:k().J.UIRegular.desktop,lineHeight:"18px",marginLeft:8},dismissButton:{gap:4,width:"100%",alignItems:"center",fontSize:k().J.UISmall.desktop,color:e.text.primary,justifyContent:"center"},noteHeading:{fontWeight:k().Wy.medium,fontSize:k().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:k().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},noteContainer:{backgroundColor:e.fill.blueSecondary,color:e.text.uiBluePrimary,padding:"10px",margin:"10px 20px",borderRadius:8,width:"auto"},connectorInfoContainer:{alignItems:"center",border:"1px solid",borderColor:e.pill.hover.border.white,borderRadius:6,padding:"4px 12px 4px 12px",justifyContent:"space-between"},connectorIconContainer:{justifyContent:"center"},connectorIcon:{width:24,height:24,size:24},verticalHr:{width:12,margin:"2px 0px 2px 0px",transform:"rotate(90deg)"},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"12px 20px 20px 20px",gap:6},connectButton:{width:"100%"}})),[]),S=(0,w().tz)(),j=(0,o.useCallback)((async()=>{f(!0);try{await p()}finally{f(!1)}}),[p,f]);return x?y.device.isMobile?(0,U.jsx)(je,{connectorType:n,open:g,onClosed:()=>c().NT[n].reset(),learnMoreUrl:t}):(0,U.jsx)(W().a,{ariaLabel:S.formatMessage({id:"universalSearch.pendingConnection.ariaLabel",defaultMessage:"Pending connection modal"}),showCloseIcon:null==u?void 0:u.showCloseButton,open:g,onDismiss:null==u?void 0:u.onClose,render:()=>(0,U.jsxs)("div",{style:_.wrapper,children:[(0,U.jsx)(P().b,{connectorType:n,title:m,subtext:l}),(0,U.jsx)(D().Ye,{style:_.selectionContainer,children:(0,U.jsxs)(D().wt,{style:_.waitingForConnectionWrapper,children:[(0,U.jsxs)(D().Ye,{style:_.connectorInfoContainer,children:[(0,U.jsx)(D().Ye,{style:_.connectorIconContainer,children:r.icon(_.connectorIcon)}),(0,U.jsx)(D().Ye,{children:(0,U.jsxs)(D().wt,{style:_.note,children:[(0,U.jsx)("div",{style:_.noteHeading,children:r.title||""}),(0,U.jsx)("div",{style:_.noteBody,children:r.label})]})})]}),(0,U.jsx)("div",{style:_.verticalHr,children:(0,U.jsx)("hr",{})}),(0,U.jsx)("div",{style:_.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.confirmConnection.willConnectToLabel",defaultMessage:"will connect to:"})}),(0,U.jsx)("div",{style:_.verticalHr,children:(0,U.jsx)("hr",{})}),(0,U.jsx)("div",{style:_.connectorInfoContainer,children:(0,U.jsxs)(D().Ye,{children:[(0,U.jsx)(D().wt,{style:_.connectorIconContainer,children:(0,U.jsx)(gt().B6,{disabled:!0,icon:a.icon,iconRecordCategory:"workspace",isEmptyPage:!1,title:a.title,size:_.connectorIcon.size,isLarge:!0})}),(0,U.jsxs)(D().wt,{style:_.note,children:[(0,U.jsx)("div",{style:_.noteHeading,children:a.title}),(0,U.jsx)("div",{style:_.noteBody,children:a.label})]})]})})]})}),(0,U.jsxs)(D().Ye,{style:{..._.selectionContainer,..._.noteContainer},children:[(0,U.jsx)(D().wt,{style:_.connectorIconContainer,children:(0,pt().infoCircleIcon)(_.connectorIcon)}),(0,U.jsx)(D().Ye,{style:_.note,children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.confirmConnectionNoteLabel",defaultMessage:"To connect a different Notion workspace, switch to that workspace and try again."})})]}),(0,U.jsxs)(D().wt,{style:_.footer,children:[(0,U.jsx)(ee().A,{size:"xl",isLoading:v,disabled:v,style:_.connectButton,onClick:j,children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.confirmConnection",defaultMessage:"Confirm connection"})}),(0,U.jsx)(ie().A,{size:"lg",style:_.dismissButton,onClick:d,children:(0,U.jsx)(w().sA,{id:"universalSearch.integrations.dismissConnectionButton",defaultMessage:"Dismiss"})})]})]})}):null}function ht(){const[e,n]=o.useState(!1),t=(0,s().v3)(),r=(0,i().K8)((()=>y().y.state.currentScreen),[]),c=(0,i().O$)(m().AppStoreCurrentSpaceStore),l=(0,i().K8)((()=>y().y.state.analyticsFrom),[]),d=(0,i().K8)((()=>y().y.state.sessionId),[]),u=(0,at().$)(),p=(0,i().K8)((()=>{const e=y().y.state.jiraSiteUrl.match(/^https:\/\/([a-zA-Z0-9-]+)\.atlassian\.net/);return e?e[1]:y().y.state.jiraSiteUrl}),[]),g=(0,i().O$)(m().AppStoreCurrentSpaceViewStore),h=(0,i().K8)((()=>m().default.state.currentUserSettingsStore),[]),{spaceId:f,notionIcon:x,notionSpaceName:_}=(0,i().K8)((()=>({spaceId:null==c?void 0:c.getSpaceId(),notionIcon:null==c?void 0:c.getIcon(),notionSpaceName:(null==c?void 0:c.getName())||""})),[c]),S=(0,i().K8)((()=>v().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]),j=(0,o.useCallback)((async()=>{if(!f)return;var e;(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"resume_pending_connection_button_clicked",integration_type:"jira",setup_session_id:d,from:l}}}),await(e=5e3,new Promise((n=>setTimeout(n,e))));await ut().aiQnaActions.connectSpaceToJiraSite({environment:t,spaceId:f})?(0,a().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:l,sessionId:d}):n(!0)}),[l,t,d,f]),b=(0,o.useCallback)((()=>{h&&g&&(dt().createAndCommit({userAction:"jiraAIConnector.onboarding.dismissPersonalAuthPrompt",environment:t,canUndo:!0,perform:e=>{dt().applyOperation({store:g,operation:{pointer:g.pointer,path:["settings"],command:"update",args:{...g.getSettings(),dismissed_jira_installation_pending_prompt:!0}},transaction:e})}}),(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"pending_connection_dismiss",integration_type:"jira",setup_session_id:d,from:l}}}),(0,a().navigateToJiraUniversalScreen)({screenToShow:"connection_dismiss_screen",analyticsFrom:l,sessionId:d}))}),[h,g,t,l,d]);if(!u||!c)return null;const C=(0,U.jsx)(w().sA,{id:"universalSearch.jira.confirmConnection.jiraWorkspaceLabel",defaultMessage:"Jira workspace"}),k=(0,U.jsx)(w().sA,{id:"universalSearch.jira.confirmConnection.notionWorkspaceLabel",defaultMessage:"Notion workspace"});return(0,U.jsx)(mt,{connector:"jira",close:{showCloseButton:!0,onClose:()=>{n(!1),(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"pending_connection_close",integration_type:"jira",setup_session_id:d,from:l}}}),(0,a().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:l,sessionId:d})}},open:"connection_pending_screen"===r,title:(0,U.jsx)(w().sA,{id:"universalQnA.jira.ConfirmConnectionScreen",defaultMessage:"Confirm Jira connection"}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.jira.subtext.confirmConnectionScreen",defaultMessage:"A connection was started from the Jira App Marketplace. Review details below:"}),onDismiss:b,onConfirm:j,from:{icon:lt().jiraIcon,title:p,label:C},to:{icon:x,title:_,label:k},learnMoreUrl:S})}const vt=Z().w0.jira;function ft(){const e=(0,s().v3)(),n=(0,i().K8)((()=>y().y.state.currentScreen),[]),t=(0,i().K8)((()=>y().y.state.sessionId),[]),r=(0,i().K8)((()=>y().y.state.analyticsFrom),[]),c=(0,i().K8)((()=>y().y.state.sessionId),[]),d=(0,l().O)();let u=(0,i().K8)((()=>y().y.state.jiraSiteId),[]);const p=(0,i().K8)((()=>y().y.state.jiraSyncState),[]);(0,o.useEffect)((()=>{"connection_complete_screen"===n&&(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"jira",moment:"finished"})}),[e,n]);const g="in_progress"===p;return(0,U.jsx)(Ue,{open:"connection_complete_screen"===n,onDismiss:()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"jira",setup_session_id:t,from:r}}})},connectorType:"jira",notes:[(0,U.jsx)(Be,{number:1,title:{...{...Pe.connectionInProgressTitle,values:{appName:vt}}},description:Pe.defaultConnectionTime},"item1"),(0,U.jsx)(Be,{number:2,title:{...{...Pe.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:vt}}}},"item2")],onEditSettingsClick:g?void 0:async()=>{if(!d)return;(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_settings",integration_type:"jira",setup_session_id:t,from:r}}});const n=await(0,a().getJiraAIConnectionStatusAction)({environment:e,spaceId:d});if(n){var o;const e=null===(o=n.connectionState)||void 0===o?void 0:o.status;"in_progress"===e?(0,a().navigateToJiraUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"settings"}):"not_started"===e||"pending_selection"===e?(0,a().navigateToJiraUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"select_projects"}):(0,a().navigateToJiraUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"error"})}else(0,a().navigateToJiraUniversalScreen)({analyticsFrom:r,sessionId:t,screenToShow:"error"})},onPrimaryButtonClick:async()=>{var n,o;if(!d)return;if((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"jira",setup_session_id:t,from:r}}}),g||"completed"===p)return void(0,a().navigateToJiraUniversalScreen)({analyticsFrom:r,sessionId:c,screenToShow:"none"});const s=await(0,a().getJiraAIConnectionStatusAction)({environment:e,spaceId:d});if(u=(null==s?void 0:s.jiraSiteId)??"",u){if("in_progress"===(null==s||null===(n=s.connectionState)||void 0===n?void 0:n.status)||"completed"===(null==s||null===(o=s.connectionState)||void 0===o?void 0:o.status))return H().D6({label:We().A.getIntl().formatMessage({defaultMessage:"Jira sync started. This can take up to 36 hours.",id:"jira.sync.started.background.3"}),position:"bottom"}),void(0,a().navigateToJiraUniversalScreen)({analyticsFrom:r,sessionId:c,screenToShow:"none"});await(0,a().startJiraBulkIngestionAction)({environment:e,spaceId:d,jiraSiteId:u,sessionId:c}),(0,a().navigateToJiraUniversalScreen)({analyticsFrom:r,sessionId:c,screenToShow:"none"})}else(0,a().navigateToJiraUniversalScreen)({analyticsFrom:r,sessionId:c,screenToShow:"error"})}})}const yt=(0,w().YK)({note1Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.heading",defaultMessage:"Jira data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_1.body",defaultMessage:"This process can take up to 3 hours. You'll only be able to reconnect after disconnecting is complete."},note2Heading:{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.heading",defaultMessage:"Uninstall the Notion AI app from your Jira Site (optional)"},postDisconnectTitle:{id:"universalSearch.jiraIngestion.post_disconnect_modal.title",defaultMessage:"Jira is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.jiraIngestion.post_disconnect_modal.description",defaultMessage:"Here's what's next:"},disconnectTitle:{id:"universalSearch.jiraIngestion.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.jiraIngestion.disconnectModal.subTitle",defaultMessage:"Jira data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.jiraIngestion.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you'll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.jiraIngestion.disconnectModal.goBack",defaultMessage:"Go back"}});function xt(){const e=(0,b().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:k().Wy.regular,fontSize:k().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:k().Wy.medium,fontSize:k().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:k().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[n,t]=(0,o.useState)(!1),r=(0,i().O$)(y().y),c=(0,i().K8)((()=>r.jiraSiteId),[r]),d=(0,i().K8)((()=>r.jiraSiteUrl),[r]),u=(0,i().K8)((()=>y().y.state.currentScreen),[]),p=(0,l().O)(),g=(0,i().K8)((()=>y().y.state.analyticsFrom),[]),m=(0,i().K8)((()=>y().y.state.sessionId),[]),h=(0,s().v3)(),v=async()=>{if(!p)return;const e=await async function(e){const{environment:n,spaceId:t,jiraSiteId:o}=e,s=await A().callApi({eventName:"disconnectJiraConnector",environment:n,data:{spaceId:t,jiraSiteId:o}});if("success"===s.type)return H().D6({label:We().A.getIntl().formatMessage({defaultMessage:"Started disconnecting Jira. This can take up to 3 hours.",id:"jira.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:h,spaceId:p,jiraSiteId:c});e&&y().y.setState({...r,jiraSyncState:"disconnecting",isDisconnecting:!0,currentScreen:"post_disconnect_screen"})},f=(0,o.useCallback)((()=>{const{noteBlockWrapper:n,noteHeading:t,noteBody:o,link:s}=e;return[(0,U.jsxs)(D().wt,{style:n,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(w().sA,{...yt.note1Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(w().sA,{...yt.note1Body})})]},"note-1"),(0,U.jsxs)(D().wt,{style:n,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(w().sA,{...yt.note2Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(w().sA,{id:"universalSearch.jiraIngestion.post_disconnect_screen.note_2.body",defaultMessage:"Go to your {NavigateToJiraSiteSettings} and uninstall the Notion AI app.",values:{NavigateToJiraSiteSettings:(0,U.jsx)("a",{style:s,href:`${d}/plugins/servlet/upm`,target:"_blank",onClick:()=>{(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_screen_marketplace_app_disconnect_btn",integration_type:"jira",setup_session_id:m,from:g}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.jiraIngestion.post_disconnect_screen.disconnect_jira_marketplace_app",defaultMessage:"Jira Site {ArrowIcon}",values:{ArrowIcon:(0,Qe().q)(e.icon)}})})}},"note2-2")})]},"note-2")]}),[e,d,h,m,g]);return"post_disconnect_screen"===u?(0,U.jsx)($e,{onClickGotItBtn:()=>{y().y.setState({...r,currentScreen:"none"})},onDismiss:()=>{y().y.setState({...r,currentScreen:"none"})},open:"post_disconnect_screen"===u,connectorType:"jira",title:(0,U.jsx)(w().sA,{...yt.postDisconnectTitle}),descriptionMessage:(0,U.jsx)(w().sA,{...yt.postDisconnectDescription}),message:(0,U.jsx)("div",{style:e.notesSectionWrapper,children:f().map(((n,t)=>(0,U.jsxs)(D().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:t+1}),(0,U.jsx)("div",{style:e.note,children:n})]},t)))})}):(0,U.jsx)(W().a,{showCloseIcon:!0,open:"disconnect_screen"===u,onDismiss:()=>{y().y.setState({...r,currentScreen:"none"})},render:()=>(0,U.jsx)("div",{style:e.confirmWrapper,children:(0,U.jsxs)("div",{style:e.confirmContainer,children:[(0,U.jsx)("div",{style:e.confirmModalTitle,children:(0,U.jsx)(w().sA,{...yt.disconnectTitle})}),(0,U.jsx)("div",{style:e.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{...yt.disconnectSubTitle})}),(0,U.jsx)("div",{style:e.confirmModalDescription,children:(0,U.jsx)(w().sA,{...yt.disconnectDescription})}),(0,U.jsxs)(D().wt,{style:e.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isRed:!0,style:e.confirmDisconnectButton,isLoading:n,onClick:async()=>{(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"jira",setup_session_id:m,from:g}}}),t(!0),await v(),t(!1)},children:(0,U.jsx)(w().sA,{...yt.primaryButtonLabel})}),(0,U.jsx)(T().A,{style:e.goBackButton,onClick:()=>{(0,a().navigateToJiraUniversalScreen)({screenToShow:"settings",analyticsFrom:r.analyticsFrom,sessionId:r.sessionId})},children:(0,U.jsx)(w().sA,{...yt.goBackButtonLabel})})]})]})})})}var _t=()=>t(209660);function St(e){const{notes:n,connectorType:t,open:s,onDismiss:i,title:r,subText:a,onClickPrimaryButton:c,primaryButtonText:l,warningMessage:d}=e,[u,p]=(0,o.useState)(!1),g=(0,b().IS)((e=>({wrapper:{width:400},selectionContainer:{padding:20,width:400,paddingTop:12},dismissConnectionWrapper:{display:"flex",flexDirection:"column",alignItems:"center"},buttonContainer:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",marginTop:"16px"},primaryButton:{fontSize:14,fontWeight:k().Wy.regular,width:"100%"}})),[]),m=(0,w().tz)();return(0,U.jsx)(W().a,{ariaLabel:m.formatMessage({id:"universalSearch.dismissConnection.ariaLabel",defaultMessage:"Dismiss Connection modal"}),showCloseIcon:!0,open:s,onDismiss:i,render:()=>(0,U.jsxs)("div",{style:g.wrapper,children:[(0,U.jsx)(P().b,{connectorType:t,title:r,subtext:a,disconnectFlow:!0}),(0,U.jsx)(D().Ye,{style:g.selectionContainer,children:(0,U.jsx)(D().wt,{children:(0,U.jsxs)(D().wt,{style:g.dismissConnectionWrapper,children:[n.map(((e,n)=>(0,U.jsx)(Be,{number:n+1,title:e.title,description:e.description},`note${n}`))),(0,U.jsxs)(D().Ye,{style:g.buttonContainer,children:[d,c&&(0,U.jsx)(ee().A,{isLoading:u,disabled:u,style:g.primaryButton,onClick:()=>{p(!0),c(),p(!1)},children:l})]})]})})})]})})}const jt=(0,w().YK)({connectToJiratitle:{id:"universalSearch.jira.connectToJiraLaterNoteHeading1",defaultMessage:"To connect Jira later:"},connectToJiraDescription:{id:"universalSearch.jira.connectToJiraLaterNote1",defaultMessage:"Go to your {aiConnectorSettingElem} and click on the Jira AI connector."},fullyDisconnectJiraTitle:{id:"universalSearch.jira.toDisconnectJiraCompleteHeading",defaultMessage:"To fully disconnect Jira:"},fullyDisconnectJiraDescription:{id:"universalSearch.jira.toDisconnectJiraCompleteNote",defaultMessage:"Go to your {atlassianDashboardElem} and uninstall the Notion AI app."}});function bt(){const e=(0,s().v3)(),n=(0,b().IS)((e=>({link:{display:"inline",color:e.text.secondary,textDecoration:"underline",cursor:"pointer"}})),[]),t=(0,i().K8)((()=>y().y.state.currentScreen),[]),r=(0,i().K8)((()=>h().zD.isAiSettingsTabEnabled()),[]),c=(0,i().O$)(m().AppStoreCurrentSpaceStore),l=(0,i().K8)((()=>y().y.state.analyticsFrom),[]),d=(0,i().K8)((()=>y().y.state.jiraSiteUrl),[]),u=(0,i().K8)((()=>y().y.state.sessionId),[]),p=(0,at().$)(),g=(0,o.useCallback)((()=>{(0,a().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:l,sessionId:u})}),[l,u]);if(!p||!c)return null;const v=(0,U.jsx)(T().A,{style:{...n.link,display:"inline"},hoveredStyle:{background:"transparent"},onClick:()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ai_settings_redirect",integration_type:"jira",setup_session_id:u,from:l}}}),y().y.setState({...y().y.state,currentScreen:"none"}),_t().Ow({currentTab:r?"ai":"integrations"})},children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.aiConnectorsSettingsNote1",defaultMessage:"AI Connectors Settings"})}),f=(0,U.jsx)("a",{style:n.link,href:`${d}/plugins/servlet/upm`,target:"_blank",onClick:()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_uninstall_marketplace_admin",integration_type:"jira",setup_session_id:u,from:l}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.jiraAdminMarketplace",defaultMessage:"Atlassian admin dashboard"})});return(0,U.jsx)(St,{title:(0,U.jsx)(w().sA,{id:"universalQnA.jira.DismissedConnectionScreen",defaultMessage:"Connection dismissed"}),subText:(0,U.jsx)(w().sA,{id:"universalSearch.jira.DismissedConnectionScreenLabel",defaultMessage:"Here’s what you should know:"}),open:"connection_dismiss_screen"===t,onDismiss:()=>{(0,a().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:l,sessionId:u})},notes:[{title:jt.connectToJiratitle,description:{...{...jt.connectToJiraDescription,values:{aiConnectorSettingElem:v}}}},{title:jt.fullyDisconnectJiraTitle,description:{...{...jt.fullyDisconnectJiraDescription,values:{atlassianDashboardElem:f}}}}],connectorType:"jira",primaryButtonText:(0,U.jsx)(w().sA,{id:"universalSearch.jira.Button.dismissedConnectionConfirmation",defaultMessage:"Got it"},"note3-1"),onClickPrimaryButton:g,openLearnMoreUrl:void 0})}function Ct(){const e=(0,i().K8)((()=>y().y.state.currentScreen),[]),n=(0,i().K8)((()=>y().y.state.sessionId),[]),t=(0,i().K8)((()=>y().y.state.analyticsFrom),[]),o=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"}})),[]),s="error"===e;return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:()=>(0,a().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n}),open:s,render:()=>(0,U.jsxs)("div",{style:o.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"jira",title:(0,U.jsx)(w().sA,{id:"universalSearch.jira.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.jira.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(D().wt,{style:o.footer,children:(0,U.jsx)(ee().A,{style:o.connectButton,onClick:()=>{(0,a().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:t,sessionId:n})},children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.error.Dismiss",defaultMessage:"Close"})})})]})})}function wt(){const[e,n]=o.useState(!1),t=(0,o.useMemo)((()=>Se("jira")),[]),r=(0,o.useMemo)((()=>_e("jira")),[]),c=(0,o.useRef)(!1),d=(0,s().v3)(),u=(0,l().O)(),p=(0,i().K8)((()=>y().y.state.currentScreen),[]),g=(0,i().K8)((()=>y().y.state.analyticsFrom),[]),m=(0,i().K8)((()=>y().y.state.sessionId),[]),f=(0,i().K8)((()=>h().zD.isAiConnectorEnabled("jira")),[]),_=d.currentUser.id,S=(0,x().P9)({name:"ai_connectors",spaceId:u,userId:_}),j=(0,at().$)(),b=(0,L().J)(),C="introduction"===p,w=(0,i().K8)((()=>v().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]);return(0,o.useEffect)((()=>{u&&b&&"introduction"===p&&(c.current||((0,M().u)({environment:d,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"jira",setup_session_id:m,from:g,is_space_admin:b,is_ai_eligible:S??!1}}}),c.current=!0))}),[u,d,p,m,g,b,S]),f?d.device.isMobile?(0,U.jsx)(je,{connectorType:"jira",open:C,onClosed:()=>{y().y.reset()},learnMoreUrl:w}):b?(0,U.jsx)(ae,{connectorType:"jira",notes:t,onLearnMore:()=>{window.open(w,"_blank")},onConnect:async()=>{u&&j&&await async function(e,n,t,o,s,i){(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"jira",setup_session_id:o,from:s}}}),i(!0),(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"jira",moment:"started"});const r=await(0,a().getJiraAIConnectionStatusAction)({environment:e,spaceId:t});if(r){const{connectionState:n}=r;if("not_started"===n.status){(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_screen_open",integration_type:"jira",setup_session_id:o,from:s}}});if("success"===(await A().callApi({eventName:"addNotionInfoForJiraAIConnection",environment:e,data:{spaceId:t}})).type){(0,a().navigateToJiraUniversalScreen)({screenToShow:"check_connection",analyticsFrom:s,sessionId:o});const n=v().default.getConfigKey("jira_ai_ingestion_config","jiraMarketPlaceAppUrl");n&&((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"app_install_url_opened",integration_type:"jira",setup_session_id:o,from:s}}}),window.open(n,"_blank"))}}else"pending_selection"===n.status?((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_screen_open",integration_type:"jira",setup_session_id:o,from:s}}}),(0,a().navigateToJiraUniversalScreen)({screenToShow:"connection_complete_screen",analyticsFrom:s,sessionId:o})):"in_progress"===n.status||"editing"===n.status?((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_open",integration_type:"jira",setup_session_id:o,from:s}}}),(0,a().navigateToJiraUniversalScreen)({screenToShow:"settings",analyticsFrom:s,sessionId:o})):"completed"===n.status?((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"already_connected_screen_open",integration_type:"jira",setup_session_id:o,from:s}}}),(0,a().navigateToJiraUniversalScreen)({screenToShow:"already_connected",analyticsFrom:s,sessionId:o})):(0,a().navigateToJiraUniversalScreen)({screenToShow:"error",analyticsFrom:s,sessionId:o})}i(!1)}(d,0,u,m,g,n)},onDismiss:()=>{(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_dismiss",integration_type:"jira",setup_session_id:m,from:g}}}),(0,a().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:g,sessionId:m}),c.current=!1},title:r,isLoading:e,open:C}):(0,U.jsx)(J,{connector:"jira",handleClose:()=>(0,a().resetAiConnectorStatus)("jira"),open:C,analyticsFrom:g,setupSessionId:m,messages:R().z$}):(0,U.jsx)(U.Fragment,{})}var kt=()=>t(831098),At=()=>t(496603),It=()=>t(623580),Mt=()=>t(962730);const Tt=(0,w().YK)({searchForAProject:{id:"universalQnA.jira.searchForAProject",defaultMessage:"Search for a Project"},disabledTooltip:{id:"universalSearch.jira.disabledTooltip",defaultMessage:"You can only interact after all projects are loaded"}});function Nt(){const[e,n]=o.useState(""),[t,c]=o.useState(!1),[d,u]=o.useState(!1),p=(0,i().K8)((()=>y().y.state.syncControl),[]),[g,m]=o.useState([]),[h,v]=o.useState(!0),[f,x]=o.useState(!0),[_,S]=o.useState(0),[j,C]=o.useState(!1),I=function(e){return(0,b().IS)((n=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},jiraIcon:{fill:n.blueColor,width:40,height:40},jiraSmallIcon:{fill:n.blueColor,width:18,height:18},logoSection:{padding:"20px 20px 9px 20px",gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:n.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:k().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:n.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:n.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:n.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:n.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:e?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:k().Wy.regular,color:n.text.primary},orderedList:{paddingLeft:18,fontSize:14,fontWeight:k().Wy.regular,color:n.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:k().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:n.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:n.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:n.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:n.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e])}(d),T=(0,i().K8)((()=>y().y.state.analyticsFrom),[]),N=(0,i().K8)((()=>y().y.state.sessionId),[]),B=(0,i().K8)((()=>y().y.state.jiraSiteId),[]),F=(0,i().K8)((()=>y().y.state.currentScreen),[]),z=(0,s().v3)(),L=(0,l().O)(),E=(0,i().O$)(y().y),O="completed"===(0,i().K8)((()=>y().y.state.jiraSyncState),[]),K=(0,o.useCallback)((async()=>{if(!L)return;(0,M().u)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_connect_button_clicked",integration_type:"jira",setup_session_id:N,from:T}}});let e,n=[],t=[];if(f?t=g.filter((e=>!e.checked)).map((e=>({id:e.id,name:e.name}))):n=g.filter((e=>e.checked)).map((e=>({id:e.id,name:e.name}))),c(!0),O)e=await(0,a().startJiraEditFlow)({environment:z,spaceId:L,jiraSiteId:B,inclusionList:n,exclusionList:t});else{var o,s;const i=await(0,a().getJiraAIConnectionStatusAction)({environment:z,spaceId:L});if("in_progress"===(null==i||null===(o=i.connectionState)||void 0===o?void 0:o.status)||"completed"===(null==i||null===(s=i.connectionState)||void 0===s?void 0:s.status))return H().D6({label:We().A.getIntl().formatMessage({defaultMessage:"Jira is already syncing. This can take up to 36 hours.",id:"jira.sync.started.background.2"}),position:"bottom"}),void(0,a().navigateToJiraUniversalScreen)({analyticsFrom:T,sessionId:N,screenToShow:"none"});e=await(0,a().startJiraBulkIngestionAction)({environment:z,spaceId:L,jiraSiteId:B,sessionId:N,inclusionList:n,exclusionList:t})}e?(0,a().navigateToJiraUniversalScreen)({analyticsFrom:T,screenToShow:"none",sessionId:N}):(0,a().navigateToJiraUniversalScreen)({analyticsFrom:T,screenToShow:"error",sessionId:N}),c(!1)}),[L,f,z,B,g,T,N,O]),R=(0,o.useCallback)((()=>g.find((e=>e.checked))),[g]),q=(0,o.useCallback)((e=>{const n=g.map((n=>n.id===e?{...n,checked:!n.checked}:n));m(n);const t=n.find((e=>e.checked)),o=n.find((e=>!e.checked));let s=!1;t&&o?s="partial":t&&(s=!0),v(s)}),[g]);(0,o.useEffect)((()=>{"select_projects"===F&&(0===p.inclusionList.length&&0===p.exclusionList.length?v(!0):v("partial"),x(0===p.inclusionList.length))}),[F,p]);const G=(0,o.useCallback)((()=>{v(!h),m((e=>e.map((e=>({...e,checked:!h})))))}),[h]),Y=(0,o.useCallback)((e=>{const n=g.find((n=>n.id===e));return Boolean(null==n?void 0:n.checked)}),[g]),J=(0,o.useCallback)((async e=>{if(!L)return;C(!0);const n=await A().callApi({eventName:"getJiraProjects",environment:z,data:{spaceId:L,jiraSiteId:B,startAt:e}});if("success"===n.type){m((e=>{const t=n.data.projects.map((e=>{let n=!1;return 0===p.inclusionList.length&&0===p.exclusionList.length?n=!0:p.inclusionList.length>0?n=Boolean(p.inclusionList.find((n=>n.id===e.id))):p.exclusionList.length>0&&(n=!p.exclusionList.find((n=>n.id===e.id))),{...e,checked:n}}));return(0,At().hS)([...e,...t],(e=>e.id))})),S(n.data.total);const t=e+n.data.projects.length;t>e?J(t):u(!0)}}),[z,L,B,p]),Q=(0,o.useCallback)((()=>(0,U.jsxs)(D().wt,{children:[(0,U.jsxs)(D().Ye,{style:I.channelItem,children:[(0,U.jsx)(mn().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(Kn().T,{checked:h,size:14,disabled:!d,onClick:()=>{(0,M().u)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:h?"all_projects_deselected":"all_projects_selected",integration_type:"jira",setup_session_id:E.sessionId,from:E.analyticsFrom}}}),G()}})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Tt.disabledTooltip})}),disableTooltip:d}),(0,U.jsxs)("div",{style:I.channelsText,children:[(0,kt().y)(I.jiraSmallIcon),(0,U.jsx)(w().sA,{id:"universalSearch.integration.jiraIngestion.allProjects",defaultMessage:"All projects"})]})]}),(0,U.jsx)(En().A,{style:I.divider,size:4}),(0,U.jsxs)(U.Fragment,{children:[d?(0,U.jsx)(U.Fragment,{}):(0,U.jsxs)(D().Ye,{style:I.loadingChannelsWrapper,children:[(0,U.jsx)(ge().A,{}),(0,U.jsxs)(D().wt,{children:[(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.jiraIngestion.loadedXProjects",defaultMessage:"{projectsCount} of {totalProjects} projects loaded",values:{projectsCount:g.length,totalProjects:_}})}),(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.jiraIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 projects."})})]})]}),(0,U.jsx)(D().wt,{style:I.selectionWrapper,children:(e?g.filter((n=>n.name.toLowerCase().includes(e.toLowerCase()))):g).map((e=>(0,U.jsxs)(D().Ye,{gap:8,style:I.channelItemWrapper,children:[(0,U.jsx)(mn().A,{render:n=>(0,U.jsx)("div",{...n,children:(0,U.jsx)(Kn().T,{checked:Y(e.id),disabled:!d,onClick:()=>{(0,M().u)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:Y(e.id)?"specific_project_deselected":"specific_project_selected",integration_type:"jira",setup_session_id:E.sessionId,from:E.analyticsFrom}}}),q(e.id)},size:14},`${e.id}-checkbox`)}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Tt.disabledTooltip})}),disableTooltip:d}),(0,kt().y)(I.jiraSmallIcon),(0,U.jsx)("div",{style:I.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[I,d,g,_,e,h,z,E.sessionId,E.analyticsFrom,G,Y,q]);return(0,r().Yb)((async()=>{L&&B&&"select_projects"===F&&!d&&!j&&await J(0)}),[L,J,F,B,d,j]),(0,U.jsx)(W().a,{showCloseIcon:!0,open:"select_projects"===F,onDismiss:()=>{(0,M().u)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"jira",setup_session_id:N,from:T}}}),(0,a().navigateToJiraUniversalScreen)({analyticsFrom:T,screenToShow:"none",sessionId:N})},render:()=>(0,U.jsxs)("div",{style:I.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"jira",title:(0,U.jsx)(w().sA,{id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),subtext:(0,U.jsx)(w().sA,{id:"universalQnA.jira.projectSelectionScreenSubtext",defaultMessage:"Connecting more Jira projects will give you more relevant and useful Notion AI responses"})}),(0,U.jsx)(On().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)(mn().A,{textWrap:!0,placement:Mt().W.Top,render:t=>(0,U.jsx)("div",{...t,children:(0,U.jsx)(D().Ye,{...t,style:I.searchBarWrapper,children:(0,U.jsx)(It().A,{id:"jiraUniversalQnASearchBar",style:I.searchBar,disabled:!d,placeholder:We().A.formatMessage(Tt.searchForAProject),value:e,onChange:e=>{n(e.target.value),(0,M().u)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_jira_projects",integration_type:"jira",setup_session_id:N,from:T}}})}},"jiraUniversalQnASearchBar")})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Tt.disabledTooltip})}),disableTooltip:d})}),(0,U.jsx)(D().Ye,{style:I.selectionContainer,children:(0,U.jsx)(D().wt,{style:I.selection,children:Q()})}),(0,U.jsxs)(D().wt,{style:I.footer,children:[(0,U.jsxs)(D().Ye,{style:I.futureChannelsCheckboxWrapper,children:[(0,U.jsx)(mn().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(Kn().T,{checked:f,disabled:!d,size:14,onClick:()=>{(0,M().u)({environment:z,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:f?"dont_join_future_projects":"join_future_projects",integration_type:"jira",setup_session_id:E.sessionId,from:E.analyticsFrom}}}),x(!f)}})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Tt.disabledTooltip})}),disableTooltip:d}),(0,U.jsx)("div",{style:I.channelsText,children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.jiraIngestion.allFutureProjects",defaultMessage:"Add projects created in future"})})]}),(0,U.jsx)(mn().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(ee().A,{isLoading:t,style:I.connectButton,onClick:K,disabled:!R()||!d,children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Tt.disabledTooltip})}),disableTooltip:d})]})]})})}const Wt=(0,w().YK)({settingsModalTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle",defaultMessage:"Jira is connected to Notion AI"},settingsModalPendingTitle:{id:"universalSearch.jiraIngestion.settingsModalTitle2",defaultMessage:"Jira is connecting to Notion AI"},settingModalConnectionIsPending:{id:"universalSearch.jiraIngestion.settingsModal.connectionIsPending",defaultMessage:"This can take up to 36h. You can cancel or modify your settings when the connection is complete."},tooltipText:{id:"universalSearch.jiraIngestion.settingsModal.tooltipText",defaultMessage:"You can cancel or modify your settings when the connection is complete. "},learnMoreText:{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"},editProjectsButton:{id:"universalSearch.jiraIngestion.settingsModal.editSyncControls",defaultMessage:"Edit Projects"},disconnectJira:{id:"universalSearch.jiraIngestion.settingsModal.disconnectJira",defaultMessage:"Disconnect"}});function Dt(){const[e,n]=(0,o.useState)(!0),[t,c]=(0,o.useState)([]),[d,u]=(0,o.useState)(!1),[p,g]=(0,o.useState)(0),m=(0,i().O$)(y().y),h=(0,i().K8)((()=>y().y.state.jiraSiteId),[]),f=(0,s().v3)(),x=(0,l().O)(),_=(0,i().K8)((()=>y().y.state.analyticsFrom),[]),S=(0,i().K8)((()=>y().y.state.currentScreen),[]),j=(0,i().K8)((()=>y().y.state.jiraSyncState),[]),C=(0,i().K8)((()=>v().default.getConfigKey("jira_ai_ingestion_config","learnMoreUrl")),[]),A="completed"===j;(0,r().Yb)((async()=>{if(!x||"settings"!==S)return;if(!A)return void n(!1);n(!0);const[e,t]=await Promise.all([(0,a().getJiraAIConnectionStatusAction)({environment:f,spaceId:x}),(0,a().getJiraSyncControlAction)({environment:f,spaceId:x,jiraSiteId:h})]);e&&t&&(c(t.data.sampleProjects),g(t.data.totalConnectedProjects),u(t.data.isFutureProjectsSyncEnabled),n(!1))}),[x,f,S,h,A]);const I=e=>{(0,a().navigateToJiraUniversalScreen)({screenToShow:e,analyticsFrom:m.analyticsFrom,sessionId:m.sessionId})},N=function(e){return(0,b().IS)((n=>({wrapper:{width:400,padding:"0 24px",minHeight:e?428:void 0},settingsWrapper:{justifyContent:"center",gap:12},jiraDetailsContainer:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:n.text.secondary,gap:12,paddingBottom:12},projectNameContainer:{gap:2,color:n.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",gap:8},disconnectButton:{width:"100%"},moreProjectsContainer:{padding:"4px 0px 4px 0px"},learnMoreSection:{padding:"24px 0"},learnMoreButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:k().Wy.medium,fontSize:k().J.UISmall.desktop,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${n.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:n.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:n.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,justifyContent:"center",alignItems:"center"},projectItemWrapper:{width:"100%",padding:"2px 0px 2px 0px",alignItems:"center"},projectName:{fontSize:k().J.UIRegular.desktop},projectIcon:{width:20,color:n.text.secondary},jiraIcon:{fill:n.blueColor,width:40,height:40},jiraIconSmall:{fill:n.blueColor,width:14,height:14}})),[e])}(e);return(0,U.jsx)(W().a,{showCloseIcon:!0,open:"settings"===S,onDismiss:()=>{(0,a().navigateToJiraUniversalScreen)({screenToShow:"none",analyticsFrom:_,sessionId:m.sessionId}),c([]),g(0),u(!1)},render:()=>(0,U.jsxs)("div",{style:N.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"jira",title:A?(0,U.jsx)(w().sA,{...Wt.settingsModalTitle}):(0,U.jsx)(w().sA,{...Wt.settingsModalPendingTitle})}),e?(0,U.jsx)(D().Ye,{style:N.spinner,children:(0,U.jsx)(ge().A,{})}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(D().Ye,{style:N.settingsWrapper,children:(0,U.jsxs)(D().wt,{style:N.jiraDetailsContainer,children:[(0,U.jsx)(D().wt,{children:A?(0,U.jsx)(w().sA,{id:"universalSearch.jiraIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI is connected and can answer questions with content from {jiraCountMessage}{futureProjectsMessage}",values:{jiraCountMessage:p?`${p} Jira Projects`:"Jira Project",futureProjectsMessage:d?", including future projects.":"."}}):(0,U.jsx)(w().sA,{...Wt.settingModalConnectionIsPending})}),A?(0,U.jsx)(D().wt,{children:d&&(0,U.jsxs)(D().Ye,{style:N.projectItemWrapper,children:[(0,U.jsx)(D().wt,{style:N.projectIcon,children:(0,kt().y)(N.jiraIconSmall)}),(0,U.jsx)(D().wt,{style:N.projectName,children:(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.jiraIngestion.settingsModal.includeCurrentAndFutureProjects",defaultMessage:"Includes current and future projects"})})})]})}):null,A&&t.map((e=>(0,U.jsx)("div",{children:(0,U.jsxs)(D().Ye,{style:N.projectItemWrapper,children:[(0,U.jsx)(D().wt,{style:N.projectIcon,children:(0,kt().y)(N.jiraIconSmall)}),(0,U.jsx)(D().wt,{style:N.projectName,children:e.name})]})},e.id))),A&&(0,U.jsx)(D().Ye,{style:N.moreProjectsContainer,children:p-3>0?(0,U.jsx)(w().sA,{id:"universalSearch.jiraIngestion.settingsModal.moreProjects",defaultMessage:"... and {moreProjectCount} more",values:{moreProjectCount:p-3}}):(0,U.jsx)(U.Fragment,{})})]})}),(0,U.jsxs)(D().wt,{style:N.footer,children:[A?(0,U.jsx)(Bt,{styles:N.disconnectButton,isEditButtonEnabled:!1,navigateToScreen:I}):(0,U.jsx)(mn().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(w().sA,{...Wt.tooltipText})}),render:e=>(0,U.jsx)(Bt,{events:e,styles:N.disconnectButton,isEditButtonEnabled:!1,navigateToScreen:()=>{}})}),A?(0,U.jsx)(Ft,{styles:N.disconnectButton,isDisconnectButtonEnabled:A,navigateToScreen:I}):(0,U.jsx)(mn().A,{allowHover:!0,textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:240},children:(0,U.jsx)(w().sA,{...Wt.tooltipText})}),render:e=>(0,U.jsx)(Ft,{events:e,styles:N.disconnectButton,isDisconnectButtonEnabled:A,navigateToScreen:I})})]}),(0,U.jsx)(D().Ye,{style:N.learnMoreSection,children:(0,U.jsx)(T().A,{style:N.learnMoreButton,onClick:()=>{(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_learn_more_url_click",integration_type:"jira",setup_session_id:m.sessionId,from:m.analyticsFrom}}}),window.open(C,"_blank")},children:(0,U.jsxs)(D().Ye,{style:N.learnMoreText,children:[(0,U.jsx)(w().sA,{...Wt.learnMoreText}),(0,Te().M)(N.externalLinkIcon)]})})})]})]})})}function Bt(e){const{styles:n,events:t,isEditButtonEnabled:o,navigateToScreen:r}=e,a=(0,s().v3)(),c=(0,i().O$)(y().y);return(0,U.jsx)(ie().A,{...t,size:"lg",style:n,disabled:!o,onClick:()=>{(0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_edit_projects_button",integration_type:"jira",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),r("select_projects")},children:(0,U.jsx)(w().sA,{...Wt.editProjectsButton})})}function Ft(e){const{styles:n,events:t,isDisconnectButtonEnabled:o,navigateToScreen:r}=e,a=(0,s().v3)(),c=(0,i().O$)(y().y),d=(0,l().O)();(0,i().K8)((()=>y().y.state.jiraSyncState),[]);return(0,U.jsx)(Ne().E,{...t,style:n,disabled:!o,onClick:()=>{d&&((0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"jira",setup_session_id:c.sessionId,from:c.analyticsFrom}}}),r("disconnect_screen"))},children:(0,U.jsx)(w().sA,{...Wt.disconnectJira})})}t(16280);var Pt=()=>t(212473),Ut=()=>t(479350);function zt(e){const{connector:n,screenName:t,inputFields:r,onSubmit:a,learnMoreUrl:l,troubleShootingUrl:d,headerSubText:u}=e,[p,g]=o.useState(!1),[m,h]=o.useState(!1),v=(0,b().IS)((e=>({wrapper:{width:400},contentContainer:{padding:20,paddingTop:12},inputContainer:{marginBottom:20},inputTitle:{color:e.text.secondary,fontWeight:k().Wy.medium,fontSize:k().J.UISmall.desktop,lineHeight:"16px",marginBottom:8},subtext:{fontSize:14,lineHeight:"18px",color:e.text.secondary,marginTop:4},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontWeight:k().Wy.regular},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15},buttonContainer:{width:"100%"},primaryButton:{width:"100%"},learnMoreButton:{width:"100%"}})),[]),f=(0,s().v3)(),y=(0,w().tz)(),x=(0,i().O$)(c().NT[n]),{sessionId:_,currentScreen:S,analyticsFrom:j}=x,C=(0,Z().G6)(n),A=async()=>{try{h(!0);const e=await a();g(!e)}catch(e){g(!0),(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_input_error",integration_type:n,setup_session_id:_,from:j}}})}finally{h(!1)}},I=p&&d?(0,U.jsxs)(D().Ye,{style:v.warningContainer,children:[(0,Oe().Q)(v.icon),(0,U.jsx)("div",{style:v.warningText,children:(0,U.jsx)(w().sA,{id:"universalQnA.authInputScreen.warning",defaultMessage:"We couldn’t connect to {connectorName}. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{connectorName:C,TroubleshootingGuide:(0,U.jsx)("a",{style:{...v.link,color:"#D7813A"},href:d,target:"_blank",onClick:()=>{(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_opened",integration_type:n,setup_session_id:_,from:j}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.authModal.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(W().a,{ariaLabel:y.formatMessage({id:"universalSearch.authInput.ariaLabel",defaultMessage:"Authentication Input Modal"}),showCloseIcon:!0,open:S===t,onDismiss:()=>{g(!1),(0,M().u)({environment:f,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_input_screen_dismiss",integration_type:n,setup_session_id:_,from:j}}}),c().NT[n].setState({...x,currentScreen:"none"})},render:()=>(0,U.jsxs)("div",{style:v.wrapper,children:[(0,U.jsx)(P().b,{connectorType:n,title:(0,U.jsx)(w().sA,{id:"universalQnA.AuthInputScreen",defaultMessage:"Connect {connectorName} and Notion AI",values:{connectorName:C}}),subtext:u}),(0,U.jsx)("div",{style:v.contentContainer,children:(0,U.jsxs)(D().wt,{children:[r.map(((e,n)=>(0,U.jsxs)(D().wt,{style:v.inputContainer,children:[(0,U.jsx)("div",{style:v.inputTitle,children:e.title}),(0,U.jsx)(It().A,{placeholder:e.placeholder,value:e.value,onChange:n=>e.onChange(n.target.value)}),e.subtext&&(0,U.jsx)("div",{style:v.subtext,children:e.subtext})]},n))),(0,U.jsxs)(D().wt,{style:v.buttonContainer,gap:6,children:[I,(0,U.jsx)(ee().A,{size:"xl",isLoading:m,disabled:m,style:v.primaryButton,onClick:A,children:(0,U.jsx)(w().sA,{id:"universalSearch.connector.Button.checkCredentials",defaultMessage:"Check credentials"})}),l&&(0,U.jsx)(ie().A,{size:"lg",iconLeading:se().bookIcon,style:v.learnMoreButton,onClick:()=>window.open(l),children:(0,U.jsx)(w().sA,{id:"universalSearch.integrations.learnMore",defaultMessage:"Read our step-by-step guide"})})]})]})})]})})}const Lt=(0,w().YK)({tokenPlaceholder:{id:"universalQnA.jira.authScreen.tokenPlaceholder",defaultMessage:"Paste your Admin Personal Access token here"}});function Et(){const[e,n]=(0,o.useState)(""),[t,r]=(0,o.useState)(""),a=(0,l().O)(),c=(0,s().v3)(),d=(0,w().tz)(),u=(0,i().K8)((()=>Ut().E.state.sessionId),[]),p=(0,i().K8)((()=>Ut().E.state.analyticsFrom),[]),g=(0,i().K8)((()=>v().default.getConfigKey("jira_ingestion_config_v2","learnMoreUrl")),[]),m=(0,i().K8)((()=>v().default.getConfigKey("jira_ingestion_config_v2","createTokenHelpUrl")),[]),h=(0,b().IS)((e=>({link:{color:e.text.uiBluePrimary,cursor:"pointer",textDecoration:"none",fontSize:k().J.UISmall.desktop,marginLeft:3},icon:{width:14,height:14,color:e.text.uiBluePrimary,marginTop:2}})),[]),f=[{title:(0,U.jsx)(w().sA,{id:"universalQnA.jira.authScreen.siteUrl",defaultMessage:"Jira Site URL"}),placeholder:"https://jira.atlassian.net",value:e,onChange:n},{title:(0,U.jsx)(w().sA,{id:"universalQnA.jira.authScreen.accessToken",defaultMessage:"Admin Personal Access token"}),placeholder:d.formatMessage(Lt.tokenPlaceholder),subtext:(0,U.jsx)(D().Ye,{style:{fontSize:k().J.UISmall.desktop},children:(0,U.jsx)(w().sA,{id:"universalQnA.jira.authScreen.accessToken.subtext",defaultMessage:"Find your {tokenLink} {icon}",values:{tokenLink:(0,U.jsx)("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:h.link,onClick:()=>{(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"input_subtext_link_click",integration_type:"jira",setup_session_id:u,from:p}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.jira.accessToken",defaultMessage:"access token here"})}),icon:(0,U.jsx)("span",{style:{marginLeft:4},children:(0,Pt().arrowUpRightSquareIcon)({...h.icon})})}})}),value:t,onChange:r}];return(0,U.jsx)(zt,{connector:"jira",screenName:"auth_input_screen",inputFields:f,onSubmit:async()=>{try{if((0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"jira_auth_submit",integration_type:"jira",setup_session_id:u,from:p}}}),!a)throw new Error("Space ID is required");return"failed"!==(await X().R({environment:c,spaceId:a,jiraApiToken:t,jiraSiteUrl:e})).status&&(Ut().E.setState({...Ut().E.state,currentScreen:"connection_complete_screen",jiraSyncState:"pending_selection"}),!0)}catch(n){return!1}},learnMoreUrl:g,troubleShootingUrl:g,headerSubText:(0,U.jsx)(w().sA,{id:"universalQnA.jira.authScreen.description",defaultMessage:"We’ll help you create an Atlassian Forge App with the credentials below"})})}const Ot=Z().w0.jira;function Kt(){const e=(0,i().K8)((()=>Ut().E.state.currentScreen),[]),n=(0,l().O)(),t=(0,s().v3)(),r=(0,i().K8)((()=>Ut().E.state.analyticsFrom),[]),a=(0,i().K8)((()=>Ut().E.state.sessionId),[]),c=(0,o.useCallback)((()=>{Ut().E.setState({...Ut().E.state,currentScreen:"settings"})}),[]),d=(0,o.useCallback)((async()=>{if(!n)return;await X().vq({environment:t,spaceId:n,projectSelection:{allProjects:!0,includedProjects:[],excludedProjects:[],includeFutureProjects:!0}})&&(await X().Zh({environment:t,spaceId:n,analyticsProperties:{analyticsFrom:r,buttonName:"start_ingestion",sessionId:a}}),Ut().E.setState({...Ut().E.state,currentScreen:"none"}))}),[n,t,r,a]);return(0,U.jsx)(Ue,{open:"connection_complete_screen"===e,onDismiss:()=>{},connectorType:"jira",notes:[(0,U.jsx)(Be,{number:1,title:{...{...Pe.connectionInProgressTitle,values:{appName:Ot}}},description:Pe.defaultConnectionTime},"item1"),(0,U.jsx)(Be,{number:2,title:{...{...Pe.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Ot}}}},"item2")],onEditSettingsClick:c,onPrimaryButtonClick:d})}function Rt(){const e=(0,w().tz)(),n=(0,b().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:k().Wy.regular,fontSize:k().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:k().Wy.medium,fontSize:k().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:k().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[t,r]=(0,o.useState)(!1),a=(0,i().K8)((()=>Ut().E.state.currentScreen),[]),c=(0,i().K8)((()=>Ut().E.state.analyticsFrom),[]),d=(0,i().K8)((()=>Ut().E.state.sessionId),[]),u=(0,l().O)(),p=(0,s().v3)(),g=(0,o.useCallback)((()=>{X().G({analyticsFrom:c,screenToShow:"none",sessionId:d})}),[c,d]),m=(0,o.useCallback)((()=>{}),[]),h=(0,o.useCallback)((async()=>{r(!0),u&&(await X().Rr({environment:p,spaceId:u}),X().G({analyticsFrom:c,screenToShow:"none",sessionId:d}),r(!1))}),[c,p,d,u]),v=(0,o.useCallback)((()=>{X().G({analyticsFrom:c,screenToShow:"settings",sessionId:d})}),[c,d]),f=(0,o.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:o}=n;return[(0,U.jsxs)(D().wt,{style:e,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(w().sA,{...Ht.note1Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(w().sA,{...Ht.note1Body})})]},"note-1")]}),[n]);return"post_disconnect"===a?(0,U.jsx)($e,{onClickGotItBtn:m,onDismiss:g,open:"post_disconnect"===a,connectorType:"jira",title:(0,U.jsx)(w().sA,{...Ht.postDisconnectTitle}),descriptionMessage:(0,U.jsx)(w().sA,{...Ht.postDisconnectDescription}),message:(0,U.jsx)("div",{style:n.notesSectionWrapper,children:f().map(((e,t)=>(0,U.jsx)(D().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,U.jsx)("div",{style:n.note,children:e})},t)))})}):(0,U.jsx)(W().a,{showCloseIcon:!0,open:"disconnect_screen"===a,onDismiss:g,render:()=>(0,U.jsx)("div",{style:n.confirmWrapper,children:(0,U.jsxs)("div",{style:n.confirmContainer,children:[(0,U.jsx)("div",{style:n.confirmModalTitle,children:(0,U.jsx)(w().sA,{...Ht.disconnectTitle})}),(0,U.jsx)("div",{style:n.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{...Ht.disconnectSubTitle})}),(0,U.jsx)("div",{style:n.confirmModalDescription,children:(0,U.jsx)(w().sA,{...Ht.disconnectDescription})}),(0,U.jsxs)(D().wt,{style:n.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isRed:!0,style:n.confirmDisconnectButton,isLoading:t,onClick:h,children:(0,U.jsx)(w().sA,{...Ht.primaryButtonLabel})}),(0,U.jsx)(T().A,{style:n.goBackButton,onClick:v,children:(0,U.jsx)(w().sA,{...Ht.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(Ht.disconnectModalAriaLabel)})}const Ht=(0,w().YK)({note1Heading:{id:"universalSearch.jira.postDisconnect.note_1.heading",defaultMessage:"Jira data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.jira.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.jira.postDisconnect.title",defaultMessage:"Jira is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.jira.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.jira.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.jira.disconnectModal.subTitle",defaultMessage:"Jira data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.jira.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.jira.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.jira.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.jira.disconnectModal.label",defaultMessage:"Disconnect Jira Modal"}});function qt(){return(0,U.jsx)(Xe,{connector:"jira",screenName:"error"})}t(737550);var Gt=()=>t(780054);function Yt(){const e=(0,w().tz)(),n=(0,o.useMemo)((()=>_e("jira")),[]),t=(0,o.useMemo)((()=>Se("jira")),[]),c=(0,s().v3)(),[d,u]=(0,o.useState)("CLOSED"),p=(0,l().O)(),g=(0,i().O$)(Ut().E),[m,f]=o.useState(!1),y=(0,b().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:k().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),_=(0,i().K8)((()=>Ut().E.state.analyticsFrom),[]),S=(0,i().K8)((()=>Ut().E.state.sessionId),[]),j=(0,i().K8)((()=>h().zD.isJiraForgeEnabled()),[]),C=c.currentUser.id,I=(0,x().P9)({name:"ai_connectors",spaceId:p,userId:C}),T=(0,L().J)(),N=(0,i().K8)((()=>v().default.getConfigKey("jira_ingestion_config_v2","learnMoreUrl")),[]),[B]=(0,r().Yb)((async()=>{if(!p||"introduction"!==g.currentScreen)return;const e=await A().callApi({eventName:"listAIConnectors",environment:c,data:{spaceId:p}});return"success"===e.type?{isJiraConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"jira"===e))}:void 0}),[c,g.currentScreen,p]);(0,o.useEffect)((()=>{"introduction"===g.currentScreen?"resolved"===B.status?u("OPEN"):u("LOADING"):u("CLOSED")}),[B.status,g.currentScreen]);const F=(0,o.useRef)(!1);(0,o.useEffect)((()=>{p&&T&&"resolved"===B.status&&"introduction"===g.currentScreen&&(F.current||((0,M().u)({environment:c,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"jira",setup_session_id:S,from:_,is_space_admin:T,is_ai_eligible:I??!1}}}),F.current=!0))}),[p,c,S,g.currentScreen,_,T,I,B.status]);const P=(0,o.useCallback)((()=>{Ut().E.reset(),(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_jira_intro_modal",integration_type:"jira",setup_session_id:Ut().E.state.sessionId,from:Ut().E.state.analyticsFrom}}}),F.current=!1}),[c]),z=(0,o.useCallback)((async()=>{if(!p)return;(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"info_screen_connect",integration_type:"jira",setup_session_id:Ut().E.state.sessionId,from:Ut().E.state.analyticsFrom}}}),f(!0);const e=await(0,a().updateJiraAIV2ConnectionStatus)({environment:c,spaceId:p});f(!1),"failed"!==e.status?"pending_selection"!==g.jiraSyncState?"not_started"===g.jiraSyncState&&X().G({analyticsFrom:_,sessionId:S,screenToShow:"auth_input_screen"}):X().G({analyticsFrom:_,sessionId:S,screenToShow:"connection_complete_screen"}):X().G({analyticsFrom:_,sessionId:S,screenToShow:"error"})}),[c,p,S,_,g.jiraSyncState]);return j&&p&&"CLOSED"!==d?Gt().A.isMobile?(0,U.jsx)(je,{connectorType:"jira",open:"introduction"===g.currentScreen,onClosed:()=>{Ut().E.reset()},learnMoreUrl:N}):"LOADING"===d?(0,U.jsx)(W().a,{ariaLabel:e.formatMessage({id:"jira.oauthPopupTitle.ariaLabel",defaultMessage:"Loading Jira AI connector status"}),open:"LOADING"===d,render:()=>(0,U.jsxs)(D().Ye,{style:y.loadingWrapper,children:[(0,U.jsx)(w().sA,{id:"universalQna.jira.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(ge().A,{})]})}):T?(0,U.jsx)(ae,{connectorType:"jira",notes:t,onLearnMore:()=>{window.open(N,"_blank")},onConnect:z,onDismiss:P,title:n,isLoading:m,open:"OPEN"===d}):(0,U.jsx)(J,{connector:"jira",handleClose:()=>(0,a().resetAiConnectorStatus)("jira"),open:"OPEN"===d,analyticsFrom:_,setupSessionId:S,messages:R().z$}):null}const Jt=(0,w().YK)({searchForAProject:{id:"universalQnA.jira.searchForAProject",defaultMessage:"Search for a Project"},disabledTooltip:{id:"universalSearch.jira.disabledTooltip",defaultMessage:"You can only interact after all projects are loaded"}});function Qt(){const[e,n]=o.useState(""),[t,a]=o.useState(!1),[c,d]=o.useState(!1),[u,p]=o.useState({allProjects:!0,includedProjects:[],excludedProjects:[],includeFutureProjects:!0}),[g,m]=o.useState([]),[h,v]=o.useState(!0),[f,y]=o.useState(!0),[x,_]=o.useState(0),[S,j]=o.useState(!1),C=function(e){return(0,b().IS)((n=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},jiraIcon:{fill:n.blueColor,width:40,height:40},jiraSmallIcon:{fill:n.blueColor,width:18,height:18},logoSection:{padding:"20px 20px 9px 20px",gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:n.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:k().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:n.text.secondary},footer:{width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px",flexGrow:1},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:n.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:n.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:n.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:e?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:k().Wy.regular,color:n.text.primary},orderedList:{paddingLeft:18,fontSize:14,fontWeight:k().Wy.regular,color:n.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:k().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:n.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:n.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:n.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:n.text.secondary},loadingWrapper:{alignItems:"center",gap:4}})),[e])}(c),I=(0,i().K8)((()=>Ut().E.state.analyticsFrom),[]),T=(0,i().K8)((()=>Ut().E.state.sessionId),[]),N=(0,i().K8)((()=>Ut().E.state.currentScreen),[]),B=(0,s().v3)(),F=(0,l().O)(),z=(0,w().tz)(),L=(0,i().O$)(Ut().E),E="completed"===(0,i().K8)((()=>Ut().E.state.jiraSyncState),[]),[O,K]=o.useState(!1),R=(0,o.useCallback)((async()=>{if(!F)return;(0,M().u)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"project_selection_connect_button_clicked",integration_type:"jira",setup_session_id:T,from:I}}});let e=[],n=[];f?n=g.filter((e=>!e.checked)).map((e=>e.id)):e=g.filter((e=>e.checked)).map((e=>e.id)),a(!0);await X().vq({environment:B,spaceId:F,projectSelection:{allProjects:!0===h,includedProjects:e,excludedProjects:n,includeFutureProjects:f}})?(E?await X().zn({environment:B,spaceId:F}):await X().Zh({environment:B,spaceId:F,analyticsProperties:{analyticsFrom:I,buttonName:"project_selection_connect_button_clicked",sessionId:T}}),X().G({analyticsFrom:I,screenToShow:"none",sessionId:T}),a(!1)):a(!1)}),[F,f,B,g,h,I,T,E]),H=(0,o.useCallback)((()=>{F?((0,M().u)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_jira_button_clicked",integration_type:"jira",setup_session_id:T,from:I}}}),X().G({analyticsFrom:I,screenToShow:"disconnect_screen",sessionId:T})):X().G({analyticsFrom:I,screenToShow:"none",sessionId:T})}),[F,B,I,T]),q=(0,o.useCallback)((()=>g.find((e=>e.checked))),[g]),G=(0,o.useCallback)((e=>{const n=g.map((n=>n.id===e?{...n,checked:!n.checked}:n));m(n);const t=n.find((e=>e.checked)),o=n.find((e=>!e.checked));let s=!1;t&&o?s="partial":t&&(s=!0),v(s)}),[g]);(0,o.useEffect)((()=>{"settings"===N&&(u.allProjects?v(!0):v("partial"),y(u.includeFutureProjects))}),[N,u]);const Y=(0,o.useCallback)((()=>{v(!h),m((e=>e.map((e=>({...e,checked:!h})))))}),[h]),J=(0,o.useCallback)((e=>{const n=g.find((n=>n.id===e));return Boolean(null==n?void 0:n.checked)}),[g]),Q=(0,o.useCallback)((async(e,n)=>{if(!F)return;j(!0);const t=await A().callApi({eventName:"getJiraProjectsV2",environment:B,data:{spaceId:F,startAt:e}});if("success"===t.type){m((e=>{const o=t.data.projects.map((e=>{var t,o;let s=!1;return 0===(null===(t=n.includedProjects)||void 0===t?void 0:t.length)&&0===(null===(o=n.excludedProjects)||void 0===o?void 0:o.length)?s=!0:n.includedProjects.length>0?s=Boolean(n.includedProjects.find((n=>n===e.id))):n.excludedProjects.length>0&&(s=!n.excludedProjects.find((n=>n===e.id))),{...e,checked:s}}));return(0,At().hS)([...e,...o],(e=>e.id))})),_(t.data.total);const o=e+t.data.projects.length;o<t.data.total?Q(o,n):d(!0)}}),[B,F]),$=(0,o.useCallback)((()=>(0,U.jsxs)(D().wt,{children:[(0,U.jsxs)(D().Ye,{style:C.channelItem,children:[(0,U.jsx)(mn().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(Kn().T,{checked:h,size:14,disabled:!c,onClick:()=>{(0,M().u)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:h?"all_projects_deselected":"all_projects_selected",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),Y()}})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Jt.disabledTooltip})}),disableTooltip:c}),(0,U.jsxs)("div",{style:C.channelsText,children:[(0,kt().y)(C.jiraSmallIcon),(0,U.jsx)(w().sA,{id:"universalSearch.integration.jiraIngestion.allProjects",defaultMessage:"All projects"})]})]}),(0,U.jsx)(En().A,{style:C.divider,size:4}),(0,U.jsxs)(U.Fragment,{children:[c?null:(0,U.jsxs)(D().Ye,{style:C.loadingChannelsWrapper,children:[(0,U.jsx)(ge().A,{}),(0,U.jsxs)(D().wt,{children:[(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.jiraIngestion.loadedXProjects",defaultMessage:"{projectsCount} of {totalProjects} projects loaded",values:{projectsCount:g.length,totalProjects:x}})}),(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.jiraIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 projects."})})]})]}),(0,U.jsx)(D().wt,{style:C.selectionWrapper,children:(e?g.filter((n=>n.name.toLowerCase().includes(e.toLowerCase()))):g).map((e=>(0,U.jsxs)(D().Ye,{gap:8,style:C.channelItemWrapper,children:[(0,U.jsx)(mn().A,{render:n=>(0,U.jsx)("div",{...n,children:(0,U.jsx)(Kn().T,{checked:J(e.id),disabled:!c,onClick:()=>{(0,M().u)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:J(e.id)?"specific_project_deselected":"specific_project_selected",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),G(e.id)},size:14},`${e.id}-checkbox`)}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Jt.disabledTooltip})}),disableTooltip:c}),(0,kt().y)(C.jiraSmallIcon),(0,U.jsx)("div",{style:C.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[C,c,g,x,e,h,B,L.sessionId,L.analyticsFrom,Y,J,G]);return(0,r().Yb)((async()=>{if(!E||!F||"settings"!==N)return;const e=await X().Df({environment:B,spaceId:F});e&&p(e),K(!0)}),[E,B,F,N]),(0,r().Yb)((async()=>{!F||"settings"!==N||c||S||E&&!O||await Q(0,u)}),[F,Q,N,c,S,E,O,u]),(0,U.jsx)(W().a,{showCloseIcon:!0,open:"settings"===N,ariaLabel:z.formatMessage({id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),onDismiss:()=>{(0,M().u)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"jira",setup_session_id:T,from:I}}}),X().G({analyticsFrom:I,screenToShow:"none",sessionId:T})},render:()=>(0,U.jsxs)("div",{style:C.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"jira",title:(0,U.jsx)(w().sA,{id:"universalQnA.jira.projectSelectionScreenTitle",defaultMessage:"Select projects to connect"}),subtext:(0,U.jsx)(w().sA,{id:"universalQnA.jira.projectSelectionScreenSubtext",defaultMessage:"Connecting more Jira projects will give you more relevant and useful Notion AI responses"})}),(0,U.jsx)(On().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)(mn().A,{textWrap:!0,placement:Mt().W.Top,render:t=>(0,U.jsx)("div",{...t,children:(0,U.jsx)(D().Ye,{...t,style:C.searchBarWrapper,children:(0,U.jsx)(It().A,{id:"jiraUniversalQnASearchBar",style:C.searchBar,disabled:!c,placeholder:z.formatMessage(Jt.searchForAProject),value:e,onChange:e=>{n(e.target.value),(0,M().u)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_jira_projects",integration_type:"jira",setup_session_id:T,from:I}}})}},"jiraUniversalQnASearchBar")})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Jt.disabledTooltip})}),disableTooltip:c})}),(0,U.jsx)(D().Ye,{style:C.selectionContainer,children:(0,U.jsx)(D().wt,{style:C.selection,children:$()})}),(0,U.jsxs)(D().wt,{style:C.footer,children:[(0,U.jsxs)(D().Ye,{style:C.futureChannelsCheckboxWrapper,children:[(0,U.jsx)(mn().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(Kn().T,{checked:f,disabled:!c,size:14,onClick:()=>{(0,M().u)({environment:B,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:f?"dont_join_future_projects":"join_future_projects",integration_type:"jira",setup_session_id:L.sessionId,from:L.analyticsFrom}}}),y(!f)}})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Jt.disabledTooltip})}),disableTooltip:c}),(0,U.jsx)("div",{style:C.channelsText,children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.jiraIngestion.allFutureProjects",defaultMessage:"Add projects created in future"})})]}),(0,U.jsx)(mn().A,{render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(ee().A,{isLoading:t,style:C.connectButton,onClick:R,disabled:!q()||!c,children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Jt.disabledTooltip})}),disableTooltip:c}),(0,U.jsx)(ie().A,{color:"uiRed",style:C.connectButton,disabled:!c,onClick:H,children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.disconnect",defaultMessage:"Disconnect"})})]})]})})}var $t=()=>t(46657);function Vt(){const[e,n]=o.useState(!1),[t,c]=o.useState(void 0),d=(0,s().v3)(),u=(0,l().O)(),p=(0,i().K8)((()=>$t().W.state.currentScreen),[]);(0,r().Yb)((async()=>{if(!u||"authentication_pending"!==p)return;const e=await A().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:d,data:{connector:"linear",authorizationType:"workspace",spaceId:u,sessionId:$t().W.state.sessionId,client:d.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const n=e.data.authorizationUrl;c(n)}),[d,p,u]);const g=(0,b().IS)((e=>({noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontWeight:k().Wy.regular},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),m=(0,at().$)();(0,F().n)((async()=>{if(!u)return;if("authentication_pending"!==$t().W.state.currentScreen)return;"not_started"!==await(0,a().getLinearConnectorStatus)({environment:d,spaceId:u})&&$t().W.setState({...$t().W.state,currentScreen:"confirmation"})}),2e3,!0);const h=(0,o.useCallback)((async()=>{if(!u)return;"not_started"!==await(0,a().getLinearConnectorStatus)({environment:d,spaceId:u})?(0,a().navigateToLinearUniversalScreen)({currentScreen:"confirmation"}):n(!0),(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}})}),[d,u]),v=(0,o.useCallback)((()=>{n(!1),(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_modal_dismissed",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}}),$t().W.reset()}),[d]);if(!m||!u)return null;const f=e?(0,U.jsxs)(D().Ye,{style:g.warningContainer,children:[(0,Oe().Q)(g.icon),(0,U.jsx)("div",{style:g.warningText,children:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.warning",defaultMessage:"We couldn’t connect to Linear. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...g.link,color:"#D7813A"},href:(0,B().xS)("guides.aiConnectorLinear"),target:"_blank",onClick:()=>{(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_clicked",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(Ke,{title:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.title",defaultMessage:"Follow instructions from Linear in your browser"}),open:"authentication_pending"===p,onDismiss:v,warningMessage:f,notes:[(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:g.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"Linear should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:g.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:g.link,href:t,target:"_blank",onClick:()=>{(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"retry_opening_linear_auth_url",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:g.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.followInstructions",defaultMessage:"Follow Linear’s instructions to connect"},"note2")}),(0,U.jsx)("div",{style:g.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a Linear workspace and return to this window"},"note1-2")})]},"note-2"),(0,U.jsx)(D().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:g.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,B().xS)("guides.aiConnectorLinear"),"_blank")},connectorType:"linear",primaryButtonText:(0,U.jsx)(w().sA,{id:"universalSearch.linear.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:h})}const Xt=Z().w0.linear;function Zt(){const e=(0,s().v3)(),n=(0,i().K8)((()=>$t().W.state.currentScreen),[]),t=(0,l().O)(),r=(0,o.useCallback)((()=>{t&&((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ingestion_started",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}}),H().D6({label:(0,U.jsx)(w().sA,{id:"aiConnectors.linear.acknowledge",defaultMessage:"Started syncing from Linear. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"aiConnectors.linear.startedMessageDismiss",defaultMessage:"Close"})})}),$t().W.reset())}),[t,e]);return(0,o.useEffect)((()=>{"confirmation"===n&&(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"linear",moment:"finished"})}),[e,n]),(0,U.jsx)(Ue,{open:"confirmation"===n,onDismiss:r,connectorType:"linear",notes:[(0,U.jsx)(Be,{number:1,title:{...{...Pe.connectionInProgressTitle,values:{appName:Xt}}},description:Pe.defaultConnectionTime},"item1"),(0,U.jsx)(Be,{number:2,title:{...{...Pe.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Xt}}}},"item2")],onPrimaryButtonClick:r})}const eo=(0,w().YK)({linearAIConnectorOauthPopupTitle:{defaultMessage:"Connect Linear AI Connector",id:"linearAIConnector.oauthPopupTitle"}});function no(){const e=(0,w().tz)(),n=(0,o.useMemo)((()=>_e("linear")),[]),t=(0,o.useMemo)((()=>Se("linear")),[]),c=(0,s().v3)(),[d,u]=(0,o.useState)("CLOSED"),p=(0,l().O)(),g=(0,i().O$)($t().W),m=(0,i().K8)((()=>$t().W.state.sessionId),[]),h=(0,i().K8)((()=>$t().W.state.analyticsFrom),[]),v=(0,b().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:k().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),f=(0,L().J)(),y=(0,x().P9)({name:"ai_connectors",spaceId:p,userId:c.currentUser.id}),_=(0,o.useCallback)((()=>{const e=(0,B().xS)("guides.aiConnectorLinear");(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}}),c.device.isElectron?I().openExternalUrl(e):window.open(e,"_blank")}),[c]),S=(0,o.useCallback)((async()=>{if(!p||"introduction"!==g.currentScreen)return null;const e=await A().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:c,data:{connector:"linear",authorizationType:"workspace",spaceId:p,client:c.device.isElectron?"desktop":"web",sessionId:$t().W.state.sessionId}});if("success"!==e.type)return null;const n=e.data.authorizationUrl;c.device.isElectron?I().openExternalUrl(n):pe().P(c,{width:800,height:600,url:n,titleMessage:eo.linearAIConnectorOauthPopupTitle})}),[p,c,g.currentScreen]),[j]=(0,r().Yb)((async()=>{if(!p||"introduction"!==g.currentScreen)return;const e=await A().callApi({eventName:"listAIConnectors",environment:c,data:{spaceId:p}});return"success"===e.type?{isLinearConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"linear"===e))}:void 0}),[c,g.currentScreen,p]);(0,o.useEffect)((()=>{"introduction"===g.currentScreen?"resolved"===j.status?u("OPEN"):u("LOADING"):u("CLOSED")}),[j.status,g.currentScreen]);const C=(0,o.useRef)(!1),T=(0,o.useCallback)((()=>{$t().W.reset(),(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_linear_intro_modal",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}}),C.current=!1}),[c]),N=(0,o.useCallback)((async()=>{await S(),(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"linear_ai_connector_auth_url_open",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}}),(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:c,connector:"linear",moment:"started"}),(0,a().navigateToLinearUniversalScreen)({currentScreen:"authentication_pending"})}),[c,S]);return(0,o.useEffect)((()=>{p&&f&&"resolved"===j.status&&"introduction"===g.currentScreen&&(C.current||((0,M().u)({environment:c,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"linear",setup_session_id:g.sessionId,from:g.analyticsFrom,is_space_admin:f,is_ai_eligible:y??!1}}}),C.current=!0))}),[p,c,j.status,g.sessionId,g.analyticsFrom,f,y,g.currentScreen]),p&&"CLOSED"!==d?c.device.isMobile?(0,U.jsx)(je,{connectorType:"linear",open:"introduction"===g.currentScreen,onClosed:()=>{$t().W.reset()},learnMoreUrl:(0,B().xS)("guides.aiConnectorLinear")}):"LOADING"===d?(0,U.jsx)(W().a,{ariaLabel:e.formatMessage({id:"linearAIConnector.oauthPopupTitle.ariaLabel",defaultMessage:"Loading Linear AI connector status"}),open:"LOADING"===d,render:()=>(0,U.jsxs)(D().Ye,{style:v.loadingWrapper,children:[(0,U.jsx)(w().sA,{id:"universalQna.linear.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(ge().A,{})]})}):g.isConnected?null:f?(0,U.jsx)(ae,{onConnect:N,onDismiss:T,onLearnMore:_,title:n,connectorType:"linear",notes:t,open:"OPEN"===d}):(0,U.jsx)(J,{connector:"linear",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,a().resetAiConnectorStatus)("linear"),open:"OPEN"===d,messages:R().A3}):null}function to(){const[e,n]=(0,o.useState)(!1),t=(0,s().v3)(),r=(0,l().O)(),a=(0,w().tz)(),c=(0,i().O$)($t().W),d=(0,i().K8)((()=>v().default.getConfigKey("linear_ingestion","clientId")),[]),u=(0,o.useCallback)((()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"close_settings",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}}),$t().W.reset()}),[t]),p=(0,o.useCallback)((()=>{n(!1)}),[]),g=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"20px 20px 20px 20px",gap:8},disconnectButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,width:"100%"},learnMoreButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:k().Wy.medium,fontSize:k().J.UISmall.desktop,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},editTeamsButton:{width:"100%"}})),[]);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(W().a,{ariaLabel:a.formatMessage({id:"linearAIConnector.settings.title",defaultMessage:"Linear AI Connector Settings Modal"}),ariaLabelledBy:"Linear AI Connector Settings Modal",showCloseIcon:!0,onDismiss:p,open:e,render:()=>(0,U.jsx)("div",{style:g.confirmWrapper,children:(0,U.jsxs)("div",{style:g.confirmContainer,children:[(0,U.jsx)("div",{style:g.confirmModalTitle,children:(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:g.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.confirmation.subTitle",defaultMessage:"Your Linear data will be permanently deleted from Notion."})}),(0,U.jsx)("div",{style:g.confirmModalDescription,children:(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(D().wt,{style:g.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isRed:!0,style:g.confirmDisconnectButton,onClick:async()=>{r&&((0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_button_clicked",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}}),await A().callApi({eventName:"disconnectAiConnector",environment:t,data:{spaceId:r,connector:"linear"}}),$t().W.reset(),n(!1),H().D6({label:We().A.getIntl().formatMessage({defaultMessage:"Linear disconnected. This can take up to 3 hours.",id:"linearAIConnector.settings.confirmation.disconnected"}),position:"bottom"}))},children:(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(T().A,{style:g.goBackButton,onClick:p,children:(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,U.jsx)(W().a,{ariaLabel:a.formatMessage({id:"linearAIConnector.settings.settingsModalTitle",defaultMessage:"Linear AI Connector Settings Modal"}),ariaLabelledBy:"Linear AI Connector Settings Modal",showCloseIcon:!0,onDismiss:u,open:"settings"===c.currentScreen,render:()=>(0,U.jsxs)("div",{style:g.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"linear",title:(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.linearIsConnected",defaultMessage:"Linear is connected to Notion AI"}),subtext:(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.canAnswerFrom",defaultMessage:"Notion AI can answer questions about your Linear issues and projects."})}),(0,U.jsxs)(D().wt,{style:g.footer,children:[(0,U.jsx)(ie().A,{size:"lg",style:g.editTeamsButton,onClick:()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"open_linear_for_edit_selection",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:$t().W.state.analyticsFrom}}}),window.open(`https://linear.app/settings/applications/${d}`,"_blank")},children:(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.editTeams",defaultMessage:"Edit Selected Teams"})}),(0,U.jsx)(Ne().E,{style:g.disconnectButton,onClick:()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"account_disconnect",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:"connection_settings"}}}),n(!0)},children:(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.disconnectLinear",defaultMessage:"Disconnect"})}),(0,U.jsx)(T().A,{style:g.learnMoreButton,onClick:()=>{(0,M().u)({environment:t,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_settings_modal",integration_type:"linear",setup_session_id:$t().W.state.sessionId,from:"connection_settings"}}});const e=(0,B().xS)("guides.aiConnectorLinear");window.open(e,"_blank")},children:(0,U.jsxs)(D().Ye,{style:g.learnMoreText,children:[(0,U.jsx)(w().sA,{id:"linearAIConnector.settings.learnMore",defaultMessage:"Learn more"}),(0,Te().M)(g.externalLinkIcon)]})})]})]})})]})}function oo(){const e=(0,i().K8)((()=>g().F.state.currentScreen),[]);return(0,U.jsx)(ke,{open:"already_connected_screen"===e,onDismiss:()=>{g().F.reset()},connector:"microsoft-teams"})}function so(e){const[n,t]=o.useState(!1),[c,d]=o.useState(void 0),u=(0,s().v3)(),p=(0,l().O)(),m=(0,i().K8)((()=>g().F.state.currentScreen),[]);(0,r().Yb)((async()=>{if(!p||"check_connection_screen"!==m)return;const e=await A().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:u,data:{connector:"microsoft-teams",authorizationType:"workspace",spaceId:p,sessionId:g().F.state.sessionId,client:u.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const n=e.data.authorizationUrl;d(n)}),[u,m,p]);const h=(0,b().IS)((e=>({noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontweight:k().Wy.regular},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),v=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),f=(0,i().K8)((()=>g().F.state.sessionId),[]),y=(0,at().$)();(0,F().n)((async()=>{var e;if(!p)return;if("check_connection_screen"!==g().F.state.currentScreen)return;if(await(0,a().getMicrosoftTeamsAIConnectorStatusAction)({environment:u,spaceId:p,sessionId:f}),"connected_to_another_workspace"===(null===(e=g().F.state.error)||void 0===e?void 0:e.reason))return void(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connected_to_another_workspace_screen",analyticsFrom:v,sessionId:f});"not_started"!==g().F.state.connectionStatus&&(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connection_complete_screen",analyticsFrom:v,sessionId:f})}),1e3,!0);const x=(0,o.useCallback)((async()=>{var e;if(!p)return;if((0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"microsoft-teams",setup_session_id:f,from:v}}}),await(0,a().getMicrosoftTeamsAIConnectorStatusAction)({environment:u,spaceId:p,sessionId:f}),"connected_to_another_workspace"===(null===(e=g().F.state.error)||void 0===e?void 0:e.reason))return void(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connected_to_another_workspace_screen",analyticsFrom:v,sessionId:f});"not_started"!==g().F.state.connectionStatus?(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"connection_complete_screen",analyticsFrom:v,sessionId:f}):t(!0)}),[v,u,f,p]),_=(0,o.useCallback)((()=>{t(!1),(0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_dismiss",integration_type:"microsoft-teams",setup_session_id:f,from:v}}}),(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:v,sessionId:f})}),[v,u,f]),S=(0,o.useCallback)((()=>{(0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"trouble_shooting_guide_clicked",integration_type:"microsoft-teams",setup_session_id:f,from:v}}})}),[v,u,f]),j=(0,o.useCallback)((()=>{(0,M().u)({environment:u,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"auth_screen_open_auth_url",integration_type:"microsoft-teams",setup_session_id:f,from:v}}})}),[v,u,f]);if(!y||!p)return null;const C=n?(0,U.jsxs)(D().Ye,{style:h.warningContainer,children:[(0,Oe().Q)(h.icon),(0,U.jsx)("div",{style:h.warningText,children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.warning",defaultMessage:"We couldn’t connect to Microsoft Teams. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...h.link,color:"#D7813A"},href:(0,B().xS)("guides.aiConnectorMicrosoftTeams"),target:"_blank",onClick:S,children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(Ke,{title:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.title",defaultMessage:"Follow instructions from Microsoft Teams in your browser"}),open:"check_connection_screen"===m,onDismiss:_,warningMessage:C,notes:[(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:h.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"Teams should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:h.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:h.link,href:c,target:"_blank",onClick:j,children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:h.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.followInstructions",defaultMessage:"Follow Team’s instructions to connect"},"note2")}),(0,U.jsx)("div",{style:h.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a Microsoft Teams workspace and return to this window"},"note1-2")})]},"note-2"),(0,U.jsx)(D().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:h.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,B().xS)("guides.aiConnectorMicrosoftTeams"),"_blank")},connectorType:"microsoft-teams",primaryButtonText:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:x})}var io=()=>t(493823);const ro={"google-drive":{pageVisitSource:qe().y8.AIGoogleDriveQna},"microsoft-teams":{pageVisitSource:qe().y8.AIMicrosoftTeamsQna},slack:{pageVisitSource:qe().y8.AISlackQna}},ao=(0,w().YK)({alreadyConnected:{id:"universalQna.connector.connectedToAnotherSpace.title",defaultMessage:"You’ve already connected {connector} to another Notion workspace."},subTitle:{id:"universalQna.connector.connectedToAnotherSpace.subtitle",defaultMessage:"Currently, only one workspace can be connected to {connector}. To connect this workspace, please disconnect the existing connection."},visitAnotherSpace:{id:"universalQna.connector.connectedToAnotherSpace.visitAnotherSpaceButton",defaultMessage:"Visit the other workspace"},gotIt:{id:"universalQna.connector.connectedToAnotherSpace.gotItButton",defaultMessage:"Got it"}});function co(e){let{open:n,onNavigateToSpace:t,connector:r,connectedSpaceId:a}=e;const l=(0,s().v3)(),d=(0,w().tz)(),u=ro[r],p=Z().w0[r],g=(0,i().O$)(c().NT[r]),{sessionId:h,analyticsFrom:v}=g,f=(0,b().IS)((e=>({container:{padding:16,maxWidth:400},tryItButton:{marginTop:16},gotItButton:{marginTop:16,justifyContent:"center"}})),[]),y=(0,o.useCallback)((async()=>{const e=m().default.state.currentUserRootStore;if(!e)return;const n=e.getSpaceViewStores().filter((e=>e.getSpaceId()===a))[0];n&&((0,M().u)({environment:l,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"visit_other_workspace",integration_type:r,setup_session_id:h,from:v}}}),await Ge().tR({environment:l,navigationType:"switchingToOrLoadingSpace",pageVisitSource:u.pageVisitSource,spaceViewStore:n,userRootStore:m().default.state.currentUserRootStore,userSettingsStore:m().default.state.currentUserSettingsStore}),t())}),[l,r,h,v,u.pageVisitSource,t,a]),x=(0,o.useCallback)((()=>{(0,M().u)({environment:l,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connected_to_another_space_dismiss",integration_type:r,setup_session_id:h,from:v}}}),c().NT[r].setState({...g,currentScreen:"none"})}),[v,l,h,r,g]),_=d.formatMessage(ao.alreadyConnected,{connector:p});return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:x,open:n,ariaLabel:_,render:()=>(0,U.jsxs)(D().wt,{style:f.container,children:[(0,U.jsx)(P().b,{titleSubtitleGap:!0,fullWidthTitle:!0,subtext:(0,U.jsx)(w().sA,{...ao.subTitle,values:{connector:p}}),connectorType:r,title:(0,U.jsx)(w().sA,{...ao.alreadyConnected,values:{connector:p}})}),(0,U.jsx)(ee().A,{size:"lg",style:f.tryItButton,onClick:y,children:(0,U.jsx)(w().sA,{...ao.visitAnotherSpace})}),(0,U.jsx)(io().p,{size:"lg",style:f.gotItButton,onClick:x,children:(0,U.jsx)(w().sA,{...ao.gotIt})})]})})}function lo(){const e=(0,i().K8)((()=>g().F.state.currentScreen),[]),n=(0,i().K8)((()=>{var e;return null===(e=g().F.state.error)||void 0===e?void 0:e.connectedSpaceId}),[]),t=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),s=(0,i().K8)((()=>g().F.state.sessionId),[]);return(0,o.useEffect)((()=>{"connected_to_another_workspace_screen"===e&&(n||(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:t,sessionId:s}))}),[n,t,s,e]),(0,U.jsx)(co,{open:"connected_to_another_workspace_screen"===e,connector:"microsoft-teams",setupSessionId:s,onNavigateToSpace:()=>{g().F.reset()},connectedSpaceId:n??""})}const uo=Z().w0["microsoft-teams"];function po(){const e=(0,w().tz)(),n=(0,s().v3)(),t=(0,i().K8)((()=>g().F.state.currentScreen),[]),r=(0,i().K8)((()=>g().F.state.sessionId),[]),c=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),d=(0,l().O)(),u="in_progress"===(0,i().K8)((()=>g().F.state.connectionStatus),[]),p=(0,o.useCallback)((()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"microsoft-teams",setup_session_id:r,from:c}}}),(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:c,sessionId:r})}),[c,n,r]),m=(0,o.useCallback)((async()=>{if(!d)return;(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_done",integration_type:"microsoft-teams",setup_session_id:r,from:c}}});const t=await(0,a().getMicrosoftTeamsAIConnectorStatusAction)({environment:n,spaceId:d});if(!t||!t.microsoftTenantId)return H().D6({label:e.formatMessage({defaultMessage:"Action failed. Please try again.",id:"universalSearch.microsoftTeams.connectionComplete.retryActionRequest"}),position:"bottom"}),void(0,a().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:r,currentScreen:"none"});if(["disconnecting","editing"].includes(null==t?void 0:t.connectionStatus))return H().D6({label:e.formatMessage({defaultMessage:"Failed to update the connection. Please try again later.",id:"universalSearch.microsoftTeams.connectionComplete.failedToStartSync"}),position:"bottom"}),void(0,a().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:r,currentScreen:"none"});if(["in_progress","completed"].includes(null==t?void 0:t.connectionStatus))return void(0,a().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:r,currentScreen:"none"});await(0,a().getMicrosoftTeamsSyncControlsAction)({environment:n,spaceId:d})||await(0,a().setMicrosoftTeamsSyncControlsAction)({environment:n,spaceId:d,syncControls:{syncFutureTeams:!0,teamsToExcludeFromSync:[],syncPrivateConversations:!0}});await(0,a().startMicrosoftTeamsBulkIngestionAction)({environment:n,spaceId:d,sessionId:r})?(0,a().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:r,currentScreen:"none"}):H().D6({label:e.formatMessage({defaultMessage:"Failed to start ingestion. Please try again later.",id:"universalSearch.microsoftTeams.connectionComplete.failedToStartIngestion"}),position:"bottom"})}),[d,n,c,r,e]),h=(0,o.useCallback)((async()=>{if(!d)return;(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"microsoft_teams_settings",integration_type:"microsoft-teams",setup_session_id:r,from:c}}});const e=await(0,a().getMicrosoftTeamsAIConnectorStatusAction)({environment:n,spaceId:d});if(!e||"not_started"===e.connectionStatus)return void(0,a().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:r,currentScreen:"error_screen"});const t=e.connectionStatus;"in_progress"!==t&&"editing"!==t?"pending_selection"!==t&&"completed"!==t?(0,a().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:r,currentScreen:"error_screen"}):(0,a().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:r,currentScreen:"settings"}):(0,a().navigateToMicrosoftTeamsUniversalScreen)({analyticsFrom:c,sessionId:r,currentScreen:"edit_blocked_screen"})}),[c,n,r,d]);return(0,o.useEffect)((()=>{"connection_complete_screen"===t&&(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:n,connector:"microsoft-teams",moment:"finished"})}),[n,t]),(0,U.jsx)(Ue,{open:"connection_complete_screen"===t,onDismiss:p,connectorType:"microsoft-teams",notes:[(0,U.jsx)(Be,{number:1,title:{...{...Pe.connectionInProgressTitle,values:{appName:uo}}},description:Pe.defaultConnectionTime},"item1"),(0,U.jsx)(Be,{number:2,title:{...{...Pe.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:uo}}}},"item2")],onPrimaryButtonClick:m,onEditSettingsClick:u?void 0:h})}function go(){const e=(0,w().tz)(),n=(0,b().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:k().Wy.regular,fontSize:k().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:k().Wy.medium,fontSize:k().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:k().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"}})),[]),[t,r]=(0,o.useState)(!1),c=(0,i().K8)((()=>g().F.state.currentScreen),[]),d=(0,l().O)(),u=(0,i().K8)((()=>g().F.state.microsoftTenantId),[]),p=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),m=(0,i().K8)((()=>g().F.state.sessionId),[]),h=(0,s().v3)(),v=(0,o.useCallback)((()=>{(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:p,sessionId:m})}),[p,m]),f=(0,o.useCallback)((()=>{(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:p,sessionId:m})}),[p,m]),y=(0,o.useCallback)((async()=>{if(r(!0),!d||!u)return void r(!1);(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_modal_confirm_disconnect_button",integration_type:"microsoft-teams",setup_session_id:m,from:p}}});const e=await async function(e){const{environment:n,spaceId:t,microsoftTenantId:o}=e,s=await A().callApi({eventName:"disconnectMicrosoftTeams",environment:n,data:{spaceId:t,microsoftTenantId:o}});if("success"===s.type)return H().D6({label:We().A.getIntl().formatMessage({defaultMessage:"Started disconnecting Microsoft Teams. This can take up to 3 hours.",id:"microsoftTeams.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:h,spaceId:d,microsoftTenantId:u});e&&g().F.setState({...g().F.state,connectionStatus:"disconnecting",currentScreen:"post_disconnect_screen"}),r(!1)}),[h,u,d,p,m]),x=(0,o.useCallback)((()=>{(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"settings",analyticsFrom:p,sessionId:m})}),[p,m]),_=(0,o.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:o}=n;return[(0,U.jsxs)(D().wt,{style:e,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(w().sA,{...mo.note1Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(w().sA,{...mo.note1Body})})]},"note-1")]}),[n]);return"post_disconnect_screen"===c?(0,U.jsx)($e,{onClickGotItBtn:f,onDismiss:v,open:"post_disconnect_screen"===c,connectorType:"microsoft-teams",title:(0,U.jsx)(w().sA,{...mo.postDisconnectTitle}),descriptionMessage:(0,U.jsx)(w().sA,{...mo.postDisconnectDescription}),message:(0,U.jsx)("div",{style:n.notesSectionWrapper,children:_().map(((e,t)=>(0,U.jsx)(D().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,U.jsx)("div",{style:n.note,children:e})},t)))})}):(0,U.jsx)(W().a,{showCloseIcon:!0,open:"disconnect_screen"===c,onDismiss:v,render:()=>(0,U.jsx)("div",{style:n.confirmWrapper,children:(0,U.jsxs)("div",{style:n.confirmContainer,children:[(0,U.jsx)("div",{style:n.confirmModalTitle,children:(0,U.jsx)(w().sA,{...mo.disconnectTitle})}),(0,U.jsx)("div",{style:n.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{...mo.disconnectSubTitle})}),(0,U.jsx)("div",{style:n.confirmModalDescription,children:(0,U.jsx)(w().sA,{...mo.disconnectDescription})}),(0,U.jsxs)(D().wt,{style:n.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isRed:!0,style:n.confirmDisconnectButton,isLoading:t,onClick:y,children:(0,U.jsx)(w().sA,{...mo.primaryButtonLabel})}),(0,U.jsx)(T().A,{style:n.goBackButton,onClick:x,children:(0,U.jsx)(w().sA,{...mo.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(mo.disconnectModalAriaLabel)})}const mo=(0,w().YK)({note1Heading:{id:"universalSearch.microsoftTeams.postDisconnect.note_1.heading",defaultMessage:"Teams data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.microsoftTeams.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.microsoftTeams.postDisconnect.title",defaultMessage:"Teams is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.microsoftTeams.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.microsoftTeams.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.microsoftTeams.disconnectModal.subTitle",defaultMessage:"Teams data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.microsoftTeams.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.microsoftTeams.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.microsoftTeams.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.microsoftTeams.disconnectModal.label",defaultMessage:"Disconnect Microsoft Teams Modal"}}),ho=(0,w().YK)({primedTextInput:{id:"aiConnectors.microsoftTeams.primedTextInput",defaultMessage:"Search for messages in Microsoft Teams"}});function vo(){const e=(0,w().tz)(),n=(0,s().v3)(),t=(0,i().K8)((()=>g().F.state.currentScreen),[]),r=(0,i().K8)((()=>g().F.state.sessionId),[]),c=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),l=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"}})),[]),d=(0,o.useCallback)((()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_in_progress_got_it",integration_type:"microsoft-teams",setup_session_id:r,from:c}}}),(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[c,n,r]),u=(0,o.useCallback)((()=>{(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"connection_in_progress_dismiss",integration_type:"microsoft-teams",setup_session_id:r,from:c}}}),(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[c,n,r]);return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:u,open:"edit_blocked_screen"===t,render:()=>(0,U.jsxs)("div",{style:l.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"microsoft-teams",title:(0,U.jsx)(w().sA,{id:"aiConnectors.microsoftTeams.editBlocked.title",defaultMessage:"Connection is in Progress"}),subtext:(0,U.jsx)(w().sA,{id:"aiConnectors.microsoftTeams.editBlocked.description",defaultMessage:"You’ll be able to ask questions and manage your settings soon. This can take up to 72h."})}),(0,U.jsx)(D().wt,{style:l.footer,children:(0,U.jsx)(ee().A,{style:l.connectButton,onClick:d,children:(0,U.jsx)(w().sA,{id:"aiConnectors.microsoftTeams.editBlocked.gotItButton",defaultMessage:"Got it"})})})]}),ariaLabel:e.formatMessage(ho.primedTextInput)})}function fo(){const e=(0,w().tz)(),n=(0,i().K8)((()=>g().F.state.currentScreen),[]),t=(0,i().K8)((()=>g().F.state.sessionId),[]),o=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),s=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"}})),[]);return(0,U.jsx)(W().a,{open:"error_screen"===n,showCloseIcon:!0,onDismiss:()=>(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:o,sessionId:t}),render:()=>(0,U.jsxs)("div",{style:s.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"microsoft-teams",title:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(D().wt,{style:s.footer,children:(0,U.jsx)(ee().A,{style:s.connectButton,onClick:()=>{(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:o,sessionId:t})},children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.Dismiss",defaultMessage:"Close"})})})]}),ariaLabel:e.formatMessage({id:"universalSearch.microsoftTeams.error.ariaLabel",defaultMessage:"Microsoft Teams error modal"})})}const yo=(0,w().YK)({microsoftTeamsAIConnectorOauthPopupTitle:{defaultMessage:"Connect Microsoft Teams AI Connector",id:"microsoftTeamsAIConnector.oauthPopupTitle"}});function xo(){const e=(0,s().v3)(),n=(0,L().J)(),t=(0,l().O)(),r=e.currentUser.id,c=(0,x().P9)({name:"ai_connectors",spaceId:t,userId:r}),d=(0,o.useRef)(!1),u=(0,o.useMemo)((()=>Se("microsoft-teams")),[]),p=(0,i().K8)((()=>g().F.state.currentScreen),[]),m=(0,i().K8)((()=>g().F.state.connectionStatus),[]),v=(0,i().K8)((()=>g().F.state.sessionId),[]),f=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),y=(0,i().K8)((()=>h().zD.isAiConnectorEnabled("microsoft-teams")),[]),_=(0,o.useCallback)((async()=>{if(!t)return;(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"microsoft_teams_ai_connector_auth_url_open",integration_type:"microsoft-teams",setup_session_id:v,from:f}}});const n=await A().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:e,data:{connector:"microsoft-teams",authorizationType:"workspace",spaceId:t,sessionId:v,client:e.device.isElectron?"desktop":"web"}});if("success"!==n.type)return;(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"microsoft-teams",moment:"started"});const o=n.data.authorizationUrl;e.device.isElectron?I().openExternalUrl(o):pe().P(e,{width:800,height:600,url:o,titleMessage:yo.microsoftTeamsAIConnectorOauthPopupTitle}),(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"check_connection_screen",analyticsFrom:f,sessionId:v})}),[t,e,f,v]),S=(0,o.useCallback)((()=>{(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_microsoft_teams_intro_modal",integration_type:"microsoft-teams",setup_session_id:v,from:f}}}),d.current=!1,g().F.reset()}),[f,v,e]);(0,o.useCallback)((()=>{t&&n&&"introduction"===p&&(d.current||((0,M().u)({environment:e,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"microsoft-teams",setup_session_id:v,from:f,is_space_admin:n,is_ai_eligible:c??!1}}}),d.current=!0),"completed"===m&&(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"already_connected_screen",analyticsFrom:f,sessionId:v}),"in_progress"!==m&&"editing"!==m||(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"edit_blocked_screen",analyticsFrom:f,sessionId:v}))}),[t,n,p,m,e,v,f,c]);const j=(0,o.useCallback)((()=>{const n=(0,B().xS)("guides.aiConnectorMicrosoftTeams");(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"microsoft-teams",setup_session_id:v,from:f}}}),e.device.isElectron?I().openExternalUrl(n):window.open(n,"_blank")}),[e,f,v]);return y&&t&&"introduction"===p?e.device.isMobile?(0,U.jsx)(je,{connectorType:"microsoft-teams",open:"introduction"===p,onClosed:()=>{g().F.reset()},learnMoreUrl:(0,B().xS)("guides.aiConnectorMicrosoftTeams")}):n?(0,U.jsx)(ae,{connectorType:"microsoft-teams",notes:u,onLearnMore:j,onConnect:_,onDismiss:S,title:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.intro.microsoftTeamsTitle",defaultMessage:"To start, install the Notion AI app in Microsoft Teams"}),open:"introduction"===p}):(0,U.jsx)(J,{connector:"microsoft-teams",handleClose:()=>g().F.reset(),open:"introduction"===p,analyticsFrom:f,setupSessionId:v,messages:R().Fj}):null}const _o=(0,w().YK)({primedTextInput:{id:"aiConnectors.microsoftTeams.postEdit.primedTextInput",defaultMessage:"Search for messages in Microsoft Teams"}});function So(){const e=(0,w().tz)(),n=(0,i().K8)((()=>g().F.state.currentScreen),[]),t=(0,b().IS)((e=>({wrapper:{width:400},section:{marginTop:4,marginBottom:6},note:{fontWeight:k().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},sectionContainer:{padding:20,width:400,paddingTop:12},bottomSectionContainer:{padding:20,width:400,paddingTop:0}})),[]),s=(0,o.useCallback)((()=>{(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]),r=(0,o.useCallback)((()=>{(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none"})}),[]),c=[(0,U.jsx)(D().wt,{children:(0,U.jsx)(w().sA,{id:"assistantOverflowMenu.MicrosoftTeamsIngestion.postEdit.listpoint1",defaultMessage:"Teams content is being updated according to your new selection"},"note-1-message")},"note-1"),(0,U.jsx)(D().wt,{children:(0,U.jsx)(w().sA,{id:"assistantOverflowMenu.MicrosoftTeamsIngestion.postEdit.listpoint2",defaultMessage:"This can take up to 48h and AI answers will be unavailable until it is complete."},"note-2-message")},"note-2")];return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:r,open:"post_edit_screen"===n,render:()=>(0,U.jsxs)("div",{style:t.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"microsoft-teams",title:(0,U.jsx)(w().sA,{id:"aiConnectors.microsoftTeams.postEdit.title",defaultMessage:"Update in Progress"}),subtext:(0,U.jsx)(w().sA,{id:"aiConnectors.microsoftTeams.postEdit.description",defaultMessage:"Here’s what you should know:"})}),(0,U.jsx)(D().wt,{style:t.sectionContainer,children:c.map(((e,n)=>(0,U.jsxs)(D().Ye,{gap:8,style:t.section,children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:t.note,children:e})]},n)))}),(0,U.jsx)(D().wt,{style:t.bottomSectionContainer,children:(0,U.jsx)(ee().A,{onClick:s,children:(0,U.jsx)(w().sA,{id:"aiConnectors.microsoftTeams.postEdit.primaryButton",defaultMessage:"Done"})})})]}),ariaLabel:e.formatMessage(_o.primedTextInput)})}var jo=()=>t(471095);function bo(){const[e,n]=(0,o.useState)(!0),[t,c]=(0,o.useState)(!1),[d,u]=o.useState(!0),[p,m]=(0,o.useState)(0),[h,v]=(0,o.useState)(""),[f,y]=(0,o.useState)([]),[x,_]=(0,o.useState)(!1),S=(0,b().IS)((e=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},footer:{width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:18,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px",flexGrow:1},selection:{width:"100%"},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},futureChannelsCheckboxWrapper:{gap:4,visibility:"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:e.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:170},channelItemWrapper:{marginTop:12},privateConversationIcon:{width:16,height:16}})),[]),j=(0,s().v3)(),C=(0,w().tz)(),A=(0,l().O)(),I=(0,i().K8)((()=>g().F.state.currentScreen),[]),T=(0,i().K8)((()=>g().F.state.sessionId),[]),N=(0,i().K8)((()=>g().F.state.analyticsFrom),[]),B=(0,i().K8)((()=>g().F.state.connectionStatus),[]);(0,r().Yb)((async()=>{var e;if(!A||"settings"!==I)return;if(!B)return n(!1),void(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:N,sessionId:T});if(["in_progress","disconnecting","editing"].includes(B))return n(!1),void(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:N,sessionId:T});n(!0);if(!(await(0,a().getMicrosoftTeamsAIConnectorStatusAction)({environment:j,spaceId:A})))return;const t=null===(e=await(0,a().getMicrosoftTeamsSyncControlsAction)({environment:j,spaceId:A}))||void 0===e?void 0:e.configuredSyncControls;if(!t)return;_(t.syncFutureTeams),y([]);const o=[];let s;do{const e=await(0,a().getMicrosoftTeamsTeamsAction)({environment:j,spaceId:A,cursor:s});if(!e)return;s=e.cursor,e.totalTeamCount&&m(e.totalTeamCount);for(const s of e.teams){const{id:e,name:n}=s;t.syncFutureTeams?o.push({id:e,name:n,checked:!t.teamsToExcludeFromSync.includes(e)}):o.push({id:e,name:n,checked:t.teamsToSync.includes(e)})}const n=o.find((e=>e.checked)),i=o.find((e=>!e.checked));let r=!1;n&&i?r="partial":n&&(r=!0),u(r),y([...o])}while(s);n(!1)}),[A,I,B,j,N,T]);const F=(0,o.useCallback)((e=>{const n=f.find((n=>n.id===e));return Boolean(null==n?void 0:n.checked)}),[f]),z=(0,o.useCallback)((e=>{const n=f.map((n=>n.id===e?{...n,checked:!n.checked}:n));y(n);const t=n.find((e=>e.checked)),o=n.find((e=>!e.checked));let s=!1;t&&o?s="partial":t&&(s=!0),u(s)}),[f]),L=(0,o.useCallback)((()=>{const e=!d;u(e),y((n=>n.map((n=>({...n,checked:e})))))}),[d]),E=(0,o.useCallback)((()=>f.some((e=>e.checked))),[f]),O=(0,o.useCallback)((()=>{(0,M().u)({environment:j,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"microsoft-teams",setup_session_id:T,from:N}}}),n(!0),c(!1),u(!0),m(0),v(""),y([]),_(!1),(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:N,sessionId:T})}),[N,T,j]),K=(0,o.useCallback)((async()=>{if(!A)return;(0,M().u)({environment:j,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_save_button",integration_type:"microsoft-teams",setup_session_id:T,from:N}}}),c(!0);const e=await(0,a().getMicrosoftTeamsAIConnectorStatusAction)({environment:j,spaceId:A});if(!e)return H().D6({label:C.formatMessage(Co.retryActionRequest),position:"bottom"}),void c(!1);if("completed"!==e.connectionStatus&&"pending_selection"!==e.connectionStatus)return H().D6({label:C.formatMessage(Co.alreadySyncing),position:"bottom"}),c(!1),void(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:N,sessionId:T});let n;if(x){const e={syncFutureTeams:!0,syncPrivateConversations:!0,teamsToExcludeFromSync:f.filter((e=>!e.checked)).map((e=>e.id))};n=await(0,a().setMicrosoftTeamsSyncControlsAction)({environment:j,spaceId:A,syncControls:e})}else{const e={syncFutureTeams:!1,syncPrivateConversations:!0,teamsToSync:f.filter((e=>e.checked)).map((e=>e.id))};n=await(0,a().setMicrosoftTeamsSyncControlsAction)({environment:j,spaceId:A,syncControls:e})}return n?n.syncControlsUpdated?"pending_selection"===e.connectionStatus?(c(!1),H().D6({label:C.formatMessage(Co.syncingWithNewSyncControl),position:"bottom"}),void(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:N,sessionId:T})):(c(!1),H().D6({label:C.formatMessage(Co.syncingWithNewSyncControl),position:"bottom"}),void(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"post_edit_screen",analyticsFrom:N,sessionId:T})):(H().D6({label:C.formatMessage(Co.syncControlNotUpdated),position:"bottom"}),void c(!1)):(H().D6({label:C.formatMessage(Co.retryActionRequest),position:"bottom"}),void c(!1))}),[A,j,x,N,T,C,f]),R=(0,o.useCallback)((()=>{A&&"not_started"!==B?((0,M().u)({environment:j,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_disconnect_button",integration_type:"microsoft-teams",setup_session_id:T,from:N}}}),"in_progress"===B?(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"error_screen",analyticsFrom:N,sessionId:T}):(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"disconnect_screen",analyticsFrom:N,sessionId:T})):(0,a().navigateToMicrosoftTeamsUniversalScreen)({currentScreen:"none",analyticsFrom:N,sessionId:T})}),[A,B,N,T,j]),q=(0,o.useCallback)((()=>(0,U.jsxs)(D().wt,{children:[(0,U.jsx)(mn().A,{render:n=>(0,U.jsxs)(D().Ye,{style:S.channelItem,children:[(0,U.jsx)("div",{...n,children:(0,U.jsx)(Kn().T,{disabled:t||e,checked:d,size:14,onClick:()=>{L()}})}),(0,U.jsx)("div",{style:S.channelsText,children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.settings.allTeamsToggle",defaultMessage:"All teams"})})]}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:280},children:(0,U.jsx)(w().sA,{...Co.disabledTooltip})}),disableTooltip:!(t||e)}),(0,U.jsx)(En().A,{style:S.divider,size:4}),(0,U.jsx)(U.Fragment,{children:e?(0,U.jsxs)(D().Ye,{style:S.loadingChannelsWrapper,children:[(0,U.jsx)("div",{children:(0,U.jsx)(ge().A,{})}),(0,U.jsxs)(D().wt,{children:[(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.settings.loadedXTeams",defaultMessage:"{teamsFetched} of {totalTeams} teams loaded",values:{teamsFetched:f.length,totalTeams:p}})}),(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.settings.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 teams."})})]})]}):(0,U.jsx)(D().wt,{style:S.selectionWrapper,children:(h?f.filter((e=>e.name.toLowerCase().includes(h.toLowerCase()))):f).map((e=>(0,U.jsxs)(D().Ye,{gap:8,style:S.channelItemWrapper,children:[(0,U.jsx)("div",{children:(0,U.jsx)(Kn().T,{disabled:t,checked:F(e.id),onClick:()=>{z(e.id)},size:14},`${e.id}-checkbox`)}),(0,U.jsx)("div",{style:S.channelsText,children:` ${e.name}`},`${e.id}-label`)]},e.id)))})})]})),[S,t,e,f,p,h,d,L,F,z]);return(0,U.jsx)(W().a,{open:"settings"===I,showCloseIcon:!0,onDismiss:O,render:()=>(0,U.jsxs)("div",{style:S.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"microsoft-teams",title:(0,U.jsx)(w().sA,{id:"universalSearch.microsoftTeams.settings.title",defaultMessage:"Connection Settings"})}),(0,U.jsx)(On().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)(mn().A,{textWrap:!0,placement:Mt().W.Top,render:n=>(0,U.jsx)("div",{...n,children:(0,U.jsx)(D().Ye,{style:S.searchBarWrapper,children:(0,U.jsx)(It().A,{id:"microsoftTeamsUniversalQnASearchBar",style:S.searchBar,placeholder:C.formatMessage(Co.searchBoxPlaceholder),value:h,onChange:e=>{v(e.target.value)},disabled:e},"microsoftTeamsUniversalQnASearchBar")})}),renderTooltip:()=>(0,U.jsx)(w().sA,{...Co.disabledTooltip}),disableTooltip:!e})}),(0,U.jsx)(D().Ye,{style:S.selectionContainer,children:(0,U.jsx)(D().wt,{style:S.selection,children:q()})}),(0,U.jsxs)(D().wt,{style:S.footer,children:[(0,U.jsx)(mn().A,{textWrap:!0,placement:Mt().W.Top,render:n=>(0,U.jsxs)(D().Ye,{style:S.futureChannelsCheckboxWrapper,children:[(0,U.jsx)("div",{...n,children:(0,U.jsx)(Kn().T,{disabled:t||e,checked:x,size:14,onClick:()=>{_(!x)}})}),(0,U.jsx)("div",{style:S.channelsText,children:(0,U.jsx)(w().sA,{...Co.syncFutureTeamsCheckboxLabel})})]}),renderTooltip:()=>(0,U.jsx)(w().sA,{...Co.disabledTooltip}),disableTooltip:!e}),(0,U.jsxs)(D().Ye,{style:S.futureChannelsCheckboxWrapper,children:[(0,U.jsx)("div",{children:(0,jo().i)(S.privateConversationIcon)}),(0,U.jsx)("div",{style:S.channelsText,children:(0,U.jsx)(w().sA,{...Co.syncPrivateConversationLabel})})]}),(0,U.jsx)(ee().A,{style:S.connectButton,onClick:K,disabled:t||e||!E()&&!x,children:(0,U.jsx)(w().sA,{...Co.saveButton})}),(0,U.jsx)(ie().A,{color:"uiRed",style:S.connectButton,disabled:t||e||"in_progress"===B,onClick:R,children:(0,U.jsx)(w().sA,{...Co.disconnectButton})})]})]}),ariaLabel:C.formatMessage(Co.modalAriaLabel)})}const Co=(0,w().YK)({disabledTooltip:{id:"universalSearch.microsoftTeams.settings.disabledTooltip",defaultMessage:"You can only interact after all teams are loaded"},saveButton:{id:"universalSearch.microsoftTeams.settings.settingsModal.saveChangesButtonText",defaultMessage:"Save Changes"},disconnectButton:{id:"universalSearch.microsoftTeams.settings.settingsModal.disconnectButtonText",defaultMessage:"Disconnect"},modalAriaLabel:{id:"universalSearch.microsoftTeams.settings.modalAriaLabel",defaultMessage:"Microsoft Teams error modal"},searchBoxPlaceholder:{id:"universalSearch.microsoftTeams.settings.searchBoxPlaceholder",defaultMessage:"Search for a Team"},alreadySyncing:{defaultMessage:"Microsoft Teams is already syncing. This can take up to 72 hours.",id:"universalSearch.microsoftTeams.settings.alreadySyncing"},retryActionRequest:{defaultMessage:"Action failed. Please try again.",id:"universalSearch.microsoftTeams.settings.retryActionRequest"},syncFutureTeamsCheckboxLabel:{id:"universalSearch.microsoftTeams.settings.syncFutureTeamsCheckboxLabel",defaultMessage:"Include teams created in the future"},syncPrivateConversationLabel:{id:"universalSearch.microsoftTeams.settings.syncPrivateConversationLabel",defaultMessage:"Content in private conversations will only be shown to members who have access to them. Permissions are strictly respected."},syncControlNotUpdated:{id:"universalSearch.microsoftTeams.settings.syncControlNotUpdated",defaultMessage:"No change made to Microsoft Teams Connection."},syncingWithNewSyncControl:{id:"universalSearch.microsoftTeams.settings.syncingWithNewSyncControl",defaultMessage:"Started syncing from Microsoft Teams. This can take up to 72 hours."}});function wo(){const{learnMoreUrl:e}=(0,c().hP)("notion-mail"),n=(0,s().v3)(),t=(0,l().O)(),o=(0,i().K8)((()=>{var e;const n=null===(e=m().default.state.currentUserStore)||void 0===e?void 0:e.id;return n?function(e){const{isLocal:n,userId:t}=e;return`${function(e){return e?"http://localhost:4201":"https://mail.notion.so"}(n)}/inbox#activeUserID=${t}`}({isLocal:false,userId:n}):""}),[false]);return(0,U.jsx)(dn,{connector:"notion-mail",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"connection_complete_screen",alreadyConnected:"already_connected",error:"error"},usesPopup:!1,learnMoreUrl:e,staticAuthUrl:o,onNavigateToInProgressScreen:async()=>{if(!t)return;const e=await A().callApi({eventName:"connectAiConnector",environment:n,data:{spaceId:t,connector:"notion-mail"}});"success"===e.type&&e.data.success&&en().L.setState({...en().L.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})}})}function ko(){const e=(0,i().K8)((()=>en().L.state.currentScreen),[]);return(0,U.jsx)(ke,{connector:"notion-mail",open:"already_connected"===e,onDismiss:()=>{en().L.reset()}})}function Ao(){const{learnMoreUrl:e}=(0,c().hP)("notion-mail");return(0,U.jsx)(gn,{connector:"notion-mail",screenName:"not_admin_screen",learnMoreUrl:e})}function Io(){return(0,U.jsx)(He,{connector:"notion-mail",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function Mo(){return(0,U.jsx)(Ye,{connector:"notion-mail",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:""})}function To(){const e=(0,s().v3)(),n=(0,l().O)(),{learnMoreUrl:t,notionAuthUrl:o,troubleShootingUrl:i}=(0,c().hP)("notion-mail");return n?(0,U.jsx)(Re,{connector:"notion-mail",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:i,staticConnectorAuthUrl:o,setConnectionStateAsConnected:()=>{en().L.setState({...en().L.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})},callConnectionApi:async()=>{const t=await A().callApi({eventName:"connectAiConnector",environment:e,data:{spaceId:n,connector:"notion-mail"}});return"success"===t.type&&t.data.success?Promise.resolve({type:"success",data:{connectionSuccess:!0}}):Promise.resolve({type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}}):null}function No(){return(0,U.jsx)(hn,{connector:"notion-mail",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function Wo(){return(0,U.jsx)(Ve,{connector:"notion-mail",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",setStatusAsDisconnected:()=>{en().L.setState({...en().L.state,status:"not_started",isConnected:!1,isLoaded:!0,isBackendConnected:!1})},showGoogleWorkspaceNote:!1})}function Do(){return(0,U.jsx)(Xe,{connector:"notion-mail",screenName:"error"})}var Bo=()=>t(291657);function Fo(){const{learnMoreUrl:e}=(0,c().hP)("outlook");return(0,U.jsx)(dn,{connector:"outlook",screenName:"introduction",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},learnMoreUrl:e,usesPopup:!0})}function Po(){const e=(0,i().K8)((()=>Bo().y.state.currentScreen),[]);return(0,U.jsx)(ke,{connector:"outlook",open:"already_connected"===e,onDismiss:()=>{Bo().y.reset()}})}function Uo(){const{learnMoreUrl:e}=(0,c().hP)("outlook");return(0,U.jsx)(gn,{connector:"outlook",screenName:"not_admin_screen",learnMoreUrl:e})}function zo(){return(0,U.jsx)(He,{connector:"outlook",screenName:"connection_complete_screen",nextScreens:{notStarted:"authentication",inProgress:"none",alreadyConnected:"already_connected",error:"error"},ingestionNotNeeded:!0,onStartIngestion:void 0})}function Lo(){return(0,U.jsx)(Ye,{connector:"outlook",screenName:"connection_exist_screen",nextScreens:{settings:"none"},connectedSpaceId:""})}function Eo(){const e=(0,s().v3)(),n=(0,l().O)(),{learnMoreUrl:t,troubleShootingUrl:o}=(0,c().hP)("outlook");return n?(0,U.jsx)(Re,{connector:"outlook",screenName:"authentication",nextScreens:{notAdminOfConnectorAccount:"not_admin_screen",connectionConflict:"connection_exist_screen",connectionSuccess:"connection_complete_screen",error:"error"},learnMoreUrl:t,troubleShootingUrl:o,setConnectionStateAsConnected:()=>{Bo().y.setState({...Bo().y.state,status:"authenticated",isConnected:!0,isPersonalAuthComplete:!0})},callConnectionApi:async()=>(await(0,a().updateOutlookAIConnectorStatus)({environment:e,spaceId:n}),(0,_().wd)().includes("outlook")?{type:"success",data:{connectionSuccess:!0}}:{type:"success",data:{connectionSuccess:!1,errorResponse:{status:401}}})}):null}function Oo(){return(0,U.jsx)(hn,{connector:"outlook",screenName:"settings",nextScreens:{disconnect:"disconnect_screen",error:"error"},settings:void 0})}function Ko(){return(0,U.jsx)(Ve,{connector:"outlook",postDisconnectScreenName:"post_disconnect_screen",disconnectScreenName:"disconnect_screen",settingsScreenName:"settings",errorScreenName:"error",showGoogleWorkspaceNote:!0,marketplaceAppConfigureUrl:"",marketplaceAppName:"",setStatusAsDisconnected:()=>{Bo().y.reset()}})}function Ro(){return(0,U.jsx)(Xe,{connector:"outlook",screenName:"error"})}var Ho=()=>t(92383);function qo(){const[e,n]=o.useState(!1),[t,c]=o.useState(void 0),d=(0,s().v3)(),u=(0,l().O)(),p=(0,i().K8)((()=>Ho().E.state.currentScreen),[]);(0,r().Yb)((async()=>{if(!u||"connecting"!==p)return;const e=await A().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:d,data:{connector:"sharepoint",authorizationType:"workspace",spaceId:u,sessionId:Ho().E.state.sessionId,client:d.device.isElectron?"desktop":"web"}});if("success"!==e.type)return;const n=e.data.authorizationUrl;c(n)}),[d,p,u]);const g=(0,b().IS)((e=>({noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:14,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{width:18,height:17,color:"#D7813A",marginTop:2},warningText:{fontSize:14,lineHeight:"18px",color:"#D7813A",paddingLeft:14,fontWeight:k().Wy.regular},warningContainer:{marginLeft:5,marginRight:5,marginBottom:15}})),[]),m=(0,at().$)();(0,F().n)((async()=>{if(!u)return;if("connecting"!==Ho().E.state.currentScreen)return;const e=await(0,a().getSharepointConnectorDetails)({environment:d,spaceId:u});"not_started"!==e.status&&Ho().E.setState({...Ho().E.state,currentScreen:"confirmation",connectionDetails:{status:"pending_selection",progress:0,externalSourceName:e.externalSourceName}})}),2e3,!0);const h=(0,o.useCallback)((async()=>{if(!u)return;"not_started"!==(await(0,a().getSharepointConnectorDetails)({environment:d,spaceId:u})).status?(0,a().navigateToSharepointUniversalScreen)({currentScreen:"confirmation"}):n(!0),(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_button_clicked",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}})}),[d,u]),v=(0,o.useCallback)((()=>{n(!1),(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"check_connection_modal_dismissed",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}}),Ho().E.reset()}),[d]);if(!m||!u)return null;const f=e?(0,U.jsxs)(D().Ye,{style:g.warningContainer,children:[(0,Oe().Q)(g.icon),(0,U.jsx)("div",{style:g.warningText,children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.warning",defaultMessage:"We couldn’t connect to SharePoint. Please review the instructions and try again, or check our {TroubleshootingGuide}",values:{TroubleshootingGuide:(0,U.jsx)("a",{style:{...g.link,color:"#D7813A"},href:(0,B().xS)("guides.aiConnectorSharepoint"),target:"_blank",onClick:()=>{(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"troubleshooting_guide_clicked",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.troubleShootingLink",defaultMessage:"troubleshooting guide."})})}})})]}):void 0;return(0,U.jsx)(Ke,{title:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.title",defaultMessage:"Follow instructions from SharePoint in your browser"}),open:"connecting"===p,onDismiss:v,warningMessage:f,notes:[(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:g.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.openAuthorizationUrlInNewTabTitle",defaultMessage:"SharePoint should open automatically on a new browser tab."},"note1-1")}),(0,U.jsx)("div",{style:g.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.authWaiting2",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:g.link,href:t,target:"_blank",onClick:()=>{(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"retry_opening_sharepoint_auth_url",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}})},children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:g.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.followInstructions",defaultMessage:"Follow SharePoint’s instructions to connect"},"note2")}),(0,U.jsx)("div",{style:g.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.followInstructionsDescription",defaultMessage:"Install the Notion connector in a SharePoint workspace and return to this window"},"note1-2")})]},"note-2"),(0,U.jsx)(D().wt,{style:{gap:4},children:(0,U.jsx)("div",{style:g.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.returnToNotion",defaultMessage:"Return to this window, and the process will continue automatically."},"note3")})},"note-3")],openLearnMoreUrl:()=>{window.open((0,B().xS)("guides.aiConnectorSharepoint"),"_blank")},connectorType:"sharepoint",primaryButtonText:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.checkConnection.checkConnectionButton",defaultMessage:"Check Connection"},"note3-1"),onClickPrimaryButton:h})}const Go=Z().w0.sharepoint;function Yo(){const e=(0,w().tz)(),n=(0,s().v3)(),t=(0,i().K8)((()=>Ho().E.state.currentScreen),[]),r=(0,l().O)(),c=(0,o.useCallback)((async()=>{if(!r)return;(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_settings_button_clicked",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}});const e=await(0,a().getSharepointConnectorDetails)({environment:n,spaceId:r});e?"in_progress"!==e.status&&"editing"!==e.status?"pending_selection"!==e.status&&"completed"!==e.status?(0,a().navigateToSharepointUniversalScreen)({currentScreen:"error"}):(0,a().navigateToSharepointUniversalScreen)({currentScreen:"settings"}):(0,a().navigateToSharepointUniversalScreen)({currentScreen:"edit_blocked"}):(0,a().navigateToSharepointUniversalScreen)({currentScreen:"error"})}),[r,n]),d=(0,o.useCallback)((async()=>{if(!r)return;(0,M().u)({environment:n,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"ingestion_started",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}});const t=await(0,a().getSharepointConnectorDetails)({environment:n,spaceId:r});if(!t)return H().D6({label:e.formatMessage({defaultMessage:"Action failed. Please try again.",id:"universalSearch.sharepoint.connectionComplete.retryActionRequest"}),position:"bottom"}),void Ho().E.reset();if(["disconnecting","editing"].includes(t.status))return H().D6({label:e.formatMessage({defaultMessage:"Failed to update the connection. Please try again later.",id:"universalSearch.sharepoint.connectionComplete.failedToUpdateConnection"}),position:"bottom"}),void Ho().E.reset();if(["in_progress","completed"].includes(t.status))return void Ho().E.reset();await A().callApi({eventName:"startIngestion",environment:n,data:{connector:"sharepoint",spaceId:r,setupSessionId:Ho().E.state.sessionId}})?Ho().E.reset():H().D6({label:e.formatMessage({defaultMessage:"Failed to start sync. Please try again later.",id:"universalSearch.sharepoint.connectionComplete.failedToStartSync"}),position:"bottom"})}),[r,n,e]);return(0,o.useEffect)((()=>{"confirmation"===t&&(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:n,connector:"sharepoint",moment:"finished"})}),[n,t]),(0,U.jsx)(Ue,{open:"confirmation"===t,onDismiss:d,connectorType:"sharepoint",notes:[(0,U.jsx)(Be,{number:1,title:{...{...Pe.connectionInProgressTitle,values:{appName:Go}}},description:Pe.defaultConnectionTime},"item1"),(0,U.jsx)(Be,{number:2,title:{...{...Pe.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:Go}}}},"item2")],onEditSettingsClick:c,onPrimaryButtonClick:d})}function Jo(){const e=(0,w().tz)(),n=(0,b().IS)((e=>({confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:k().J.UIRegular.desktop,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},notesSectionWrapper:{padding:"12px 12px 12px 12px",gap:13},noteBlockWrapper:{marginBottom:12,gap:8},note:{fontWeight:k().Wy.regular,fontSize:k().J.UIRegular.desktop,lineHeight:"18px"},noteHeading:{fontWeight:k().Wy.medium,fontSize:k().J.UIRegular.desktop,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:e.text.secondary,fontSize:k().J.UIRegular.desktop,lineHeight:"18px",letterSpacing:"0.2px"},link:{color:e.text.secondary,textDecoration:"underline",cursor:"pointer"},icon:{rotate:"45deg",width:12,height:12,cursor:"pointer",display:"inline",padding:0,margin:0}})),[]),[t,r]=(0,o.useState)(!1),a=(0,i().K8)((()=>Ho().E.state.currentScreen),[]),c=(0,l().O)(),d=(0,s().v3)(),u=(0,o.useCallback)((()=>{Ho().E.reset()}),[]),p=(0,o.useCallback)((()=>{Ho().E.reset()}),[]),g=(0,o.useCallback)((async()=>{if(r(!0),!c)return void r(!1);(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"disconnect_button_clicked",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}});const e=await async function(e){const{environment:n,spaceId:t}=e,o=await A().callApi({eventName:"disconnectAiConnector",environment:n,data:{spaceId:t,connector:"sharepoint"}});if("success"===o.type)return H().D6({label:We().A.getIntl().formatMessage({defaultMessage:"Started disconnecting SharePoint. This can take up to 3 hours.",id:"sharepoint.disconnect.started"}),position:"bottom",style:{width:"400px",display:"flex",justifyContent:"space-between"}}),!0;return!1}({environment:d,spaceId:c});e&&Ho().E.setState({...Ho().E.state,status:"disconnecting",currentScreen:"post_disconnect"}),r(!1)}),[d,c]),m=(0,o.useCallback)((()=>{Ho().E.setState({...Ho().E.state,currentScreen:"settings"})}),[]),h=(0,o.useCallback)((()=>{const{noteBlockWrapper:e,noteHeading:t,noteBody:o}=n;return[(0,U.jsxs)(D().wt,{style:e,children:[(0,U.jsx)("div",{style:t,children:(0,U.jsx)(w().sA,{...Qo.note1Heading})}),(0,U.jsx)("div",{style:o,children:(0,U.jsx)(w().sA,{...Qo.note1Body})})]},"note-1")]}),[n]);return"post_disconnect"===a?(0,U.jsx)($e,{onClickGotItBtn:p,onDismiss:u,open:"post_disconnect"===a,connectorType:"sharepoint",title:(0,U.jsx)(w().sA,{...Qo.postDisconnectTitle}),descriptionMessage:(0,U.jsx)(w().sA,{...Qo.postDisconnectDescription}),message:(0,U.jsx)("div",{style:n.notesSectionWrapper,children:h().map(((e,t)=>(0,U.jsx)(D().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:(0,U.jsx)("div",{style:n.note,children:e})},t)))})}):(0,U.jsx)(W().a,{showCloseIcon:!0,open:"disconnect"===a,onDismiss:u,render:()=>(0,U.jsx)("div",{style:n.confirmWrapper,children:(0,U.jsxs)("div",{style:n.confirmContainer,children:[(0,U.jsx)("div",{style:n.confirmModalTitle,children:(0,U.jsx)(w().sA,{...Qo.disconnectTitle})}),(0,U.jsx)("div",{style:n.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{...Qo.disconnectSubTitle})}),(0,U.jsx)("div",{style:n.confirmModalDescription,children:(0,U.jsx)(w().sA,{...Qo.disconnectDescription})}),(0,U.jsxs)(D().wt,{style:n.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isRed:!0,style:n.confirmDisconnectButton,isLoading:t,onClick:g,children:(0,U.jsx)(w().sA,{...Qo.primaryButtonLabel})}),(0,U.jsx)(T().A,{style:n.goBackButton,onClick:m,children:(0,U.jsx)(w().sA,{...Qo.goBackButtonLabel})})]})]})}),ariaLabel:e.formatMessage(Qo.disconnectModalAriaLabel)})}const Qo=(0,w().YK)({note1Heading:{id:"universalSearch.sharepoint.postDisconnect.note_1.heading",defaultMessage:"SharePoint data will be permanently deleted from Notion"},note1Body:{id:"universalSearch.sharepoint.postDisconnect.note_1.body",defaultMessage:"This process can take up to 3 hours. You’ll only be able to reconnect after disconnecting is complete."},postDisconnectTitle:{id:"universalSearch.sharepoint.postDisconnect.title",defaultMessage:"SharePoint is disconnecting from Notion AI"},postDisconnectDescription:{id:"universalSearch.sharepoint.postDisconnect.description",defaultMessage:"Here’s what you should know:"},disconnectTitle:{id:"universalSearch.sharepoint.disconnectModal.title",defaultMessage:"Are you sure?"},disconnectSubTitle:{id:"universalSearch.sharepoint.disconnectModal.subTitle",defaultMessage:"SharePoint data will be permanently deleted from Notion."},disconnectDescription:{id:"universalSearch.sharepoint.disconnectModal.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."},primaryButtonLabel:{id:"universalSearch.sharepoint.disconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"},goBackButtonLabel:{id:"universalSearch.sharepoint.disconnectModal.goBack",defaultMessage:"Go back"},disconnectModalAriaLabel:{id:"universalSearch.sharepoint.disconnectModal.label",defaultMessage:"Disconnect SharePoint Modal"}});function $o(){const e=(0,w().tz)(),n=(0,i().K8)((()=>Ho().E.state.currentScreen),[]),t=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"}})),[]);return(0,U.jsx)(W().a,{open:"error"===n,showCloseIcon:!0,onDismiss:()=>{Ho().E.reset()},render:()=>(0,U.jsxs)("div",{style:t.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"sharepoint",title:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.error.title",defaultMessage:"Oops! Something went wrong"}),subtext:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.error.description",defaultMessage:"Something went wrong, please try again later."})}),(0,U.jsx)(D().wt,{style:t.footer,children:(0,U.jsx)(ee().A,{style:t.connectButton,onClick:()=>{Ho().E.reset()},children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.dismissButton",defaultMessage:"Close"})})})]}),ariaLabel:e.formatMessage({id:"universalSearch.sharepoint.error.ariaLabel",defaultMessage:"SharePoint error modal"})})}function Vo(e){const{open:n}=e;return(0,U.jsx)(ke,{open:n,onDismiss:()=>{Ho().E.reset()},connector:"sharepoint"})}const Xo=(0,w().YK)({sharepointAIConnectorOauthPopupTitle:{defaultMessage:"Connect SharePoint AI Connector",id:"sharepointAIConnector.oauthPopupTitle"}});function Zo(){const e=(0,w().tz)(),n=(0,o.useMemo)((()=>_e("sharepoint")),[]),t=(0,o.useMemo)((()=>Se("sharepoint")),[]),c=(0,s().v3)(),[d,u]=(0,o.useState)("CLOSED"),p=(0,l().O)(),g=(0,i().O$)(Ho().E),m=(0,i().K8)((()=>Ho().E.state.sessionId),[]),h=(0,i().K8)((()=>Ho().E.state.analyticsFrom),[]),v=(0,b().IS)((()=>({loadingWrapper:{padding:20,fontSize:12,fontWeight:k().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]),f=(0,L().J)(),y=(0,x().P9)({name:"ai_connectors",spaceId:p,userId:c.currentUser.id}),_=(0,o.useCallback)((()=>{const e=(0,B().xS)("guides.aiConnectorSharepoint");(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"learn_more_click_intro_modal",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}}),c.device.isElectron?I().openExternalUrl(e):window.open(e,"_blank")}),[c]),S=(0,o.useCallback)((async()=>{if(!p)return;const e=await A().callApi({eventName:"getAIConnectorAuthorizationUrl",environment:c,data:{connector:"sharepoint",authorizationType:"workspace",spaceId:p,client:c.device.isElectron?"desktop":"web",sessionId:Ho().E.state.sessionId}});if("success"!==e.type)return;const n=e.data.authorizationUrl;c.device.isElectron?I().openExternalUrl(n):pe().P(c,{width:800,height:600,url:n,titleMessage:Xo.sharepointAIConnectorOauthPopupTitle}),Ho().E.setState({...Ho().E.state,authUrl:n,currentScreen:"connecting"})}),[p,c]),[j]=(0,r().Yb)((async()=>{if(!p||"introduction"!==g.currentScreen)return;const e=await A().callApi({eventName:"listAIConnectors",environment:c,data:{spaceId:p}});return"success"===e.type?{isSharepointConnected:e.data.connectedConnectors.map((e=>e.id)).some((e=>"sharepoint"===e))}:void 0}),[c,g.currentScreen,p]);(0,o.useEffect)((()=>{"introduction"===g.currentScreen?"resolved"===j.status?u("OPEN"):u("LOADING"):u("CLOSED")}),[j.status,g.currentScreen]);const C=(0,o.useRef)(!1),T=(0,o.useCallback)((()=>{Ho().E.reset(),(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_sharepoint_intro_modal",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}}),C.current=!1}),[c]),N=(0,o.useCallback)((async()=>{await S(),(0,M().u)({environment:c,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"sharepoint_ai_connector_auth_url_open",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}}),(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:c,connector:"sharepoint",moment:"started"}),Ho().E.setState({...Ho().E.state,currentScreen:"connecting"})}),[c,S]);return(0,o.useEffect)((()=>{p&&f&&"resolved"===j.status&&"introduction"===g.currentScreen&&(C.current||((0,M().u)({environment:c,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"sharepoint",setup_session_id:g.sessionId,from:g.analyticsFrom,is_space_admin:f,is_ai_eligible:y??!1}}}),C.current=!0))}),[p,c,j.status,g.sessionId,g.analyticsFrom,f,y,g.currentScreen]),p&&"CLOSED"!==d?c.device.isMobile?(0,U.jsx)(je,{connectorType:"sharepoint",open:"introduction"===g.currentScreen,onClosed:()=>{Ho().E.reset()},learnMoreUrl:(0,B().xS)("guides.aiConnectorSharepoint")}):"LOADING"===d?(0,U.jsx)(W().a,{ariaLabel:e.formatMessage({id:"sharepointAIConnector.oauthPopupTitle.ariaLabel",defaultMessage:"Loading SharePoint AI connector status"}),open:"LOADING"===d,render:()=>(0,U.jsxs)(D().Ye,{style:v.loadingWrapper,children:[(0,U.jsx)(w().sA,{id:"universalQna.sharepoint.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(ge().A,{})]})}):g.isConnected?(0,U.jsx)(Vo,{open:!0}):f?(0,U.jsx)(ae,{onConnect:N,onDismiss:T,onLearnMore:_,title:n,connectorType:"sharepoint",notes:t,open:"OPEN"===d}):(0,U.jsx)(J,{connector:"sharepoint",analyticsFrom:h,setupSessionId:m,handleClose:()=>(0,a().resetAiConnectorStatus)("sharepoint"),open:"OPEN"===d,messages:R().oO}):null}const es=(0,w().YK)({primedTextInput:{id:"aiConnectors.sharepoint.postEdit.primedTextInput",defaultMessage:"Search for content in SharePoint"}});function ns(){const e=(0,w().tz)(),n=(0,i().K8)((()=>Ho().E.state.currentScreen),[]),t=(0,b().IS)((e=>({wrapper:{width:400},section:{marginTop:4,marginBottom:6},note:{fontWeight:k().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},sectionContainer:{padding:20,width:400,paddingTop:12},bottomSectionContainer:{padding:20,width:400,paddingTop:0}})),[]),s=(0,o.useCallback)((()=>{Ho().E.reset()}),[]),r=(0,o.useCallback)((()=>{Ho().E.reset()}),[]),a=[(0,U.jsx)(D().wt,{children:(0,U.jsx)(w().sA,{id:"assistantOverflowMenu.sharepointIngestion.postEdit.listpoint1",defaultMessage:"SharePoint content will be updated according to the new selection."},"note-1-message")},"note-1"),(0,U.jsx)(D().wt,{children:(0,U.jsx)(w().sA,{id:"assistantOverflowMenu.sharepointIngestion.postEdit.listpoint2",defaultMessage:"This can take up to 72 hours and AI answers will be unavailable until it’s complete"},"note-2-message")},"note-2")];return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:r,open:"post_edit"===n,render:()=>(0,U.jsxs)("div",{style:t.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"sharepoint",title:(0,U.jsx)(w().sA,{id:"aiConnectors.sharepoint.postEdit.title",defaultMessage:"Update in Progress"}),subtext:(0,U.jsx)(w().sA,{id:"aiConnectors.sharepoint.postEdit.description",defaultMessage:"Here’s what you should know:"})}),(0,U.jsx)(D().wt,{style:t.sectionContainer,children:a.map(((e,n)=>(0,U.jsxs)(D().Ye,{gap:8,style:t.section,children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:t.note,children:e})]},n)))}),(0,U.jsx)(D().wt,{style:t.bottomSectionContainer,children:(0,U.jsx)(ee().A,{onClick:s,children:(0,U.jsx)(w().sA,{id:"aiConnectors.sharepoint.postEdit.primaryButton",defaultMessage:"Done"})})})]}),ariaLabel:e.formatMessage(es.primedTextInput)})}function ts(){const[e,n]=(0,o.useState)(!0),[t,c]=(0,o.useState)(!1),[d,u]=(0,o.useState)(""),[p,g]=(0,o.useState)([]),[m,h]=(0,o.useState)([]),[v,f]=(0,o.useState)([]),[y,x]=(0,o.useState)(!0),[_,S]=(0,o.useState)(!1),j=(0,b().IS)((e=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:530},footer:{width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px",flexGrow:1},selection:{width:"100%"},siteItem:{gap:4,alignItems:"center"},sitesText:{fontSize:12,lineHeight:"16px",display:"flex",flexDirection:"row",gap:4},divider:{marginTop:5,marginBottom:5},futureSitesCheckboxWrapper:{gap:12,visibility:"visible"},selectionWrapper:{overflowY:"scroll",maxHeight:170},siteItemWrapper:{marginTop:12}})),[]),C=(0,s().v3)(),I=(0,w().tz)(),T=(0,l().O)(),N=(0,i().K8)((()=>Ho().E.state.currentScreen),[]),B=(0,i().K8)((()=>{var e;return null===(e=Ho().E.state.connectionDetails)||void 0===e?void 0:e.status}),[]);(0,r().Yb)((async()=>{if(!T||"settings"!==N)return;if(!B)return n(!1),void Ho().E.reset();if(["in_progress","disconnecting","editing"].includes(B))return n(!1),void Ho().E.reset();n(!0);const e=await A().callApi({eventName:"getAllSharepointSites",environment:C,data:{spaceId:T}}),t=await A().callApi({eventName:"getSharepointSelection",environment:C,data:{spaceId:T}});if("failed"===e.type||"failed"===t.type)return;const o=e.data;g(t.data.includedSites),h(t.data.excludedSites),S(t.data.includeFutureSites),f(o),n(!1)}),[T,N,B,C]),(0,o.useEffect)((()=>{const e=v.filter((e=>![...p,...m].includes(e.id)));if(e.length>0){const n=_?e.map((e=>e.id)):[],t=_?[]:e.map((e=>e.id));n.length>0&&g((e=>[...e,...n])),t.length>0&&h((e=>[...e,...t]))}}),[v,_,p,m]),(0,o.useEffect)((()=>{p.length===v.length?x(!0):p.length>0?x("partial"):x(!1)}),[p,v]);const F=(0,o.useCallback)((e=>p.includes(e)),[p]),z=(0,o.useCallback)((e=>{p.includes(e)?(g((n=>n.filter((n=>n!==e)))),h((n=>[...n,e]))):(h((n=>n.filter((n=>n!==e)))),g((n=>[...n,e])))}),[p]),L=(0,o.useCallback)((()=>{p.length>0?(g([]),h(v.map((e=>e.id)))):(g(v.map((e=>e.id))),h([]))}),[p,v]),E=(0,o.useCallback)((()=>p.length>0),[p]),O=(0,o.useCallback)((()=>{(0,M().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"settings_modal_close",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}}),Ho().E.reset()}),[C]),K=(0,o.useCallback)((async()=>{if(!T)return;(0,M().u)({environment:C,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"save_settings_button_clicked",integration_type:"sharepoint",setup_session_id:Ho().E.state.sessionId,from:Ho().E.state.analyticsFrom}}}),c(!0);const e=await(0,a().getSharepointConnectorDetails)({environment:C,spaceId:T});return e?"completed"!==e.status&&"pending_selection"!==e.status?(H().D6({label:I.formatMessage(os.alreadySyncing),position:"bottom"}),c(!1),void Ho().E.reset()):(await A().callApi({eventName:"setSharepointSelection",environment:C,data:{spaceId:T,allSites:!0===y,includedSites:p,excludedSites:m,includeFutureSites:_}}),await A().callApi({eventName:"startIngestion",environment:C,data:{connector:"sharepoint",spaceId:T,setupSessionId:Ho().E.state.sessionId}}),c(!1),H().D6({label:I.formatMessage(os.syncingWithNewSyncControl),position:"bottom"}),void(0,a().navigateToSharepointUniversalScreen)({currentScreen:"post_edit"})):(H().D6({label:I.formatMessage(os.retryActionRequest),position:"bottom"}),void c(!1))}),[T,C,I,y,p,m,_]),R=(0,o.useCallback)((()=>{T?(0,a().navigateToSharepointUniversalScreen)({currentScreen:"disconnect"}):Ho().E.reset()}),[T]),q=(0,o.useCallback)((()=>(0,U.jsxs)(D().wt,{children:[(0,U.jsxs)(D().Ye,{style:j.siteItem,children:[(0,U.jsx)("div",{children:(0,U.jsx)(Kn().T,{disabled:t,checked:y,size:14,onClick:()=>{L()}})}),(0,U.jsx)("div",{style:j.sitesText,children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.settings.allSitesToggle",defaultMessage:"All sites"})})]}),(0,U.jsx)(En().A,{style:j.divider,size:4}),(0,U.jsx)(U.Fragment,{children:e?(0,U.jsxs)(D().Ye,{style:j.futureSitesCheckboxWrapper,children:[(0,U.jsx)(ge().A,{}),(0,U.jsx)("div",{style:j.sitesText,children:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.settings.loadingSites",defaultMessage:"Fetching sites. This can take up to a few minutes based on the number of sites in your account."})})]}):(0,U.jsx)(D().wt,{style:j.selectionWrapper,children:(d?v.filter((e=>(e.name||e.id).toLowerCase().includes(d.toLowerCase()))):v).map((e=>(0,U.jsxs)(D().Ye,{gap:8,style:j.siteItemWrapper,children:[(0,U.jsx)("div",{children:(0,U.jsx)(Kn().T,{disabled:t,checked:F(e.id),onClick:()=>{z(e.id)},size:14},`${e.id}-checkbox`)}),(0,U.jsx)("div",{style:j.sitesText,children:` ${e.name||e.id}`},`${e.id}-label`)]},e.id)))})})]})),[j,t,y,e,d,v,L,F,z]);return(0,U.jsx)(W().a,{open:"settings"===N,showCloseIcon:!0,onDismiss:O,render:()=>(0,U.jsxs)("div",{style:j.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"sharepoint",title:(0,U.jsx)(w().sA,{id:"universalSearch.sharepoint.settings.title",defaultMessage:"Connection Settings"})}),(0,U.jsx)(On().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)("div",{children:(0,U.jsx)(D().Ye,{style:j.searchBarWrapper,children:(0,U.jsx)(It().A,{id:"sharepointUniversalQnASearchBar",style:j.searchBar,placeholder:I.formatMessage(os.searchBoxPlaceholder),value:d,onChange:e=>{u(e.target.value)},disabled:e},"sharepointUniversalQnASearchBar")})})}),(0,U.jsx)(D().Ye,{style:j.selectionContainer,children:(0,U.jsx)(D().wt,{style:j.selection,children:q()})}),(0,U.jsxs)(D().wt,{style:j.footer,children:[(0,U.jsxs)(D().Ye,{style:j.futureSitesCheckboxWrapper,children:[(0,U.jsx)("div",{children:(0,U.jsx)(Kn().T,{disabled:t,checked:_,size:14,onClick:()=>{S(!_)}})}),(0,U.jsx)("div",{style:j.sitesText,children:(0,U.jsx)(w().sA,{...os.syncFutureSitesCheckboxLabel})})]}),(0,U.jsx)(ee().A,{style:j.connectButton,onClick:K,disabled:t||e||!E()&&!_,children:(0,U.jsx)(w().sA,{...os.saveButton})}),(0,U.jsx)(ie().A,{color:"uiRed",style:j.connectButton,disabled:t||e||"in_progress"===B,onClick:R,children:(0,U.jsx)(w().sA,{...os.disconnectButton})})]})]}),ariaLabel:I.formatMessage(os.modalAriaLabel)})}const os=(0,w().YK)({saveButton:{id:"universalSearch.sharepoint.settings.settingsModal.saveChangesButtonText",defaultMessage:"Save Changes"},disconnectButton:{id:"universalSearch.sharepoint.settings.settingsModal.disconnectButtonText",defaultMessage:"Disconnect"},modalAriaLabel:{id:"universalSearch.sharepoint.settings.modalAriaLabel",defaultMessage:"SharePoint error modal"},searchBoxPlaceholder:{id:"universalSearch.sharepoint.settings.searchBoxPlaceholder",defaultMessage:"Search for a site"},alreadySyncing:{defaultMessage:"SharePoint is already syncing. This can take up to 72 hours.",id:"universalSearch.sharepoint.settings.alreadySyncing"},retryActionRequest:{defaultMessage:"Action failed. Please try again.",id:"universalSearch.sharepoint.settings.retryActionRequest"},syncFutureSitesCheckboxLabel:{id:"universalSearch.sharepoint.settings.syncFutureSitesCheckboxLabel",defaultMessage:"Include sites created in the future"},syncingWithNewSyncControl:{id:"universalSearch.sharepoint.settings.syncingWithNewSyncControl",defaultMessage:"Started syncing from SharePoint. This can take up to 72 hours."}});var ss=()=>t(252105),is=()=>t(656633),rs=()=>t(404141);function as(){const e=(0,s().v3)(),n=(0,L().J)(),t=(0,i().O$)(m().AppStoreCurrentSpaceStore),r=null==t?void 0:t.id,c=e.currentUser.id,l=(0,x()._X)({name:"ai_connectors",spaceId:r,userId:c}),d=(0,w().tz)(),u=(0,i().K8)((()=>E().O.state.open&&"slack_announcement"===E().O.state.modal),[]),p=(0,o.useCallback)((n=>{let{source:t,upsell:o}=n;if(!m().default.state.currentSpaceViewStore||!r)return;const s=(0,is().vp)(e,r);E().O.setState({...E().O.state,open:!1}),"closeButton"!==t&&(o?s?(rs().A.setState({...rs().A.state,open:!0,openedFrom:"slack_universal_qna_announcement_modal",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0}),ss().QP(e,{from:"slack_universal_qna_announcement_modal"})):O().K(e,{from:"slack_universal_qna_announcement_modal",upsell:o}):(0,a().navigateToAIConnectorOnboarding)({analyticsFrom:"slack_universal_qna_announcement_modal",connector:"slack"}))}),[e,r]);return l?(0,U.jsx)(W().a,{ariaLabel:d.formatMessage(R().vK.title),open:u,render:()=>(0,U.jsx)(K().Y,{messages:R().vK,aiConnectorsFeatureAvailability:l,onDismiss:p,calloutKey:"ai_slack_ai_connector_announcement",eventName:"ai_slack_universal_qna_announcement_modal_shown",learnMoreHref:(0,B().xS)("guides.aiConnectorSlack"),connector:"slack",showNarrowCta:n})}):null}var cs=()=>t(921997),ls=()=>t(901389),ds=()=>t(941541);const us=(0,w().YK)({searchForAChannel:{id:"universalQnA.slack.searchForAChannel",defaultMessage:"Search for a Channel"}});function ps(){const[e,n]=o.useState(""),[t,r]=o.useState(!1),[c,d]=o.useState(!0),[u,p]=o.useState([]),g=(0,o.useRef)(!1),h=(0,s().v3)(),f=(0,l().O)(),y=(0,i().O$)(j().R),x=(0,o.useCallback)((()=>{const e=v().default.getConfigKey("ingestion","slack");window.open(null==e?void 0:e.learnMoreUrl,"_blank")}),[]),_=(0,i().K8)((()=>m().default.getState().currentUserStore),[]),I=(0,o.useCallback)((()=>{g.current=!1,r(!1),n(""),d(!0),p([])}),[]),B=(0,o.useCallback)((async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0;try{const o=await A().callApi({eventName:"getSlackPublicChannels",environment:h,data:{spaceId:e,cursor:t}});if("success"===o.type){p((e=>(0,At().hS)([...e,...o.data.channels],(e=>e.id))));const n=o.data.cursor;j().R.state.isEditing&&(d(!1),j().R.setState({...j().R.state,isEditing:!1})),n?B(e,0,n):r(!0)}else{if(n>=10)return;setTimeout((()=>{B(e,n+1,t)}),3e4)}}catch{if(n>=10)return;setTimeout((()=>{B(e,n+1,t)}),3e4)}}),[h]),F=(0,o.useCallback)((async()=>{var e;if(j().R.setState({...y,currentScreen:"confirmation"}),I(),!f)return;await A().callApi({eventName:"ingestSlackPublicData",environment:h,data:{spaceId:f,selection:y.selection,setupSessionId:y.sessionId}});const n=S().A.state.appsConnectionData.filter((e=>e.id!==Je().e5));S().A.setState({...S().A.state,appsConnectionData:[...n,{connectionStatus:"in_progress",connectionLastEditedTimestamp:Date.now(),connectionType:"slack",connectorEmail:(null==_?void 0:_.getEmail())||"",id:Je().e5,connectorNotionId:null==_||null===(e=_.getModel())||void 0===e?void 0:e.id}]}),(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"confirm_slack_public_data_ingestion",integration_type:"slack",setup_session_id:y.sessionId,from:y.analyticsFrom}}})}),[_,h,I,y,f]),z=(0,o.useCallback)((async()=>{if(!f)return;const e=j().R.state;if(!f||g.current||"data-selection"!==e.currentScreen)return;if(e.isEditing)return g.current=!0,void B(f);let n=!1;if(v().default.checkGate({gateName:"ai_connector_unification"})){var t;if("failed"===(await(0,a().updateSlackQnAConnectionState)({environment:h,spaceId:f})).status)return void j().R.setState({...e,currentScreen:"alreadyConnected"});null!==(t=j().R.state.connectedApps)&&void 0!==t&&t.includes("slack-admin")&&(n=!0)}else{const t=await A().callApi({eventName:"getConnectedAppsForUniversalQna",environment:h,data:{spaceId:f,sessionId:e.sessionId},headers:(0,zn().WS)({spaceId:f})});if("success"===t.type&&t.data.isError)return void j().R.setState({...e,currentScreen:"alreadyConnected"});"success"===t.type&&t.data.connectedApps.includes("slack-admin")&&(n=!0)}if(n){if(j().R.state.isSlackGridAiConnectorEnabled){const e=await A().callApi({eventName:"getUrlForGridSetup",environment:h,data:{spaceId:f}});return void("success"===e.type&&j().R.setState({...j().R.state,currentScreen:"confirmation",gridSetupUrl:e.data.url}))}d(!1),g.current=!0,B(f)}}),[f,g,B,h]),L=(0,o.useCallback)((e=>{let{key:n,value:t}=e;const o=j().R.state;"already_connected"!==t?"connected"===t&&z():j().R.setState({...o,currentScreen:"alreadyConnected"})}),[z]);(0,o.useEffect)((()=>{if(!f||null==_||!_.id)return;const e=ds().Ay.addListener((0,cs().Vz)({spaceId:f,connectorType:"slack",userId:_.id,sessionId:y.sessionId}),void 0,L,void 0,h);return()=>{e&&ds().Ay.removeListener(e,h)}}),[h,L,f,null==_?void 0:_.id,y.sessionId]),(0,o.useEffect)((()=>{"data-selection"===y.currentScreen&&(g.current=!1,z())}),[z,y.currentScreen]);const E=function(e,n){return(0,b().IS)((t=>({wrapper:{width:400,display:"flex",flexDirection:"column",minHeight:e?void 0:530},logoSection:{padding:"20px 20px 9px 20px",gap:8,justifyContent:"center",alignItems:"center",height:84},logos:{width:40,height:40},arrowLogo:{width:20,height:20,color:t.icon.secondary},titleWrapper:{width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center"},title:{fontSize:17,fontWeight:k().Wy.medium,lineHeight:"22px",marginBottom:"9px"},subtext:{fontSize:12,lineHeight:"14.52px",color:t.text.secondary},footer:{position:"absolute",width:"100%",justifySelf:"flex-end",boxShadow:"0px 9px 24px 0px #0F0F0F33",padding:"16px 20px 16px 20px",gap:12,bottom:0},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:360},searchBarWrapper:{justifyContent:"center"},searchBar:{width:360,padding:4},selectionContainer:{marginTop:18,marginBottom:e?24:0,width:"100%",height:"100%",justifyContent:"center",padding:"0px 20px 0px"},selection:{width:"100%"},waitingForConnection:{fontSize:12,lineHeight:"16px",color:t.text.secondary},waitingForConnectionWrapper:{gap:4},tryAgainWrapper:{marginTop:16,gap:4},tryAgainSection:{gap:4,alignItems:"center",marginBottom:16,color:t.text.secondary},tryAgainText:{fontSize:14},channelItem:{gap:4,alignItems:"center"},channelsText:{fontSize:12,lineHeight:"16px"},divider:{marginTop:5,marginBottom:5},alertIcon:{width:16,height:16},tryAgainButton:{fontSize:12,width:80},futureChannelsCheckboxWrapper:{gap:4,visibility:e?"hidden":"visible"},loadingChannelsWrapper:{alignItems:"center",gap:8,fontSize:12,color:t.text.secondary,marginTop:8},selectionWrapper:{overflowY:"scroll",maxHeight:n?170:124},loadMoreButtonWrapper:{fontSize:12,paddingTop:8,paddingBottom:4},loadMoreButtonhoveredStyle:{background:"none"},channelItemWrapper:{marginTop:12},workspaceAdministratorHeading:{fontSize:14,fontWeight:k().Wy.regular,color:t.text.primary},orderedList:{paddingLeft:18,fontSize:14,fontWeight:k().Wy.regular,color:t.text.secondary},waitingForConnectionNote:{paddingBottom:4},note:{fontWeight:k().Wy.regular,fontSize:14,lineHeight:"18px",width:330,marginLeft:8},noteHeading:{fontWeight:k().Wy.medium,fontSize:14,lineHeight:"18px"},noteBody:{fontWeight:k().Wy.regular,color:t.text.secondary,fontSize:14,lineHeight:"18px"},learnMoreButton:{gap:4,alignItems:"center",fontSize:14,color:t.text.secondary,justifyContent:"center"},buttonContainer:{justifyContent:"center"},link:{color:t.text.secondary,textDecoration:"underline",cursor:"pointer"},loadingChannels:{color:t.text.secondary},loadingWrapper:{alignItems:"center",gap:4,justifyContent:"center"}})),[e,n])}(c,t),O=(0,o.useCallback)((e=>{const{selection:n}=y;return n.allSelected?!n.excludedChannels.includes(e):!!n.selectedChannels.includes(e)}),[y]),K=(0,o.useCallback)((()=>{const{selection:e}=y;return e.allSelected?!(e.excludedChannels.length>0)||"partial":e.selectedChannels.length>0&&"partial"}),[y]),R=(0,o.useCallback)((()=>{const{selection:e}=y;return!!e.allSelected||(!!e.joinFutureChannels||e.selectedChannels.length>0)}),[y]),H=(0,o.useCallback)((()=>[(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:E.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.waitingForConnectionNoteHeading1",defaultMessage:"Slack should open automatically on a new tab."},"note1-1")}),(0,U.jsx)("div",{style:E.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.waitingForConnectionNoteBody1",defaultMessage:"If it doesn’t, {ClickHereToRetry}",values:{ClickHereToRetry:(0,U.jsx)("a",{style:E.link,href:y.authUrl,target:"_blank",children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.confirmModalNote1Retry",defaultMessage:"click here to retry"})})}},"note1-2")})]},"note-1"),(0,U.jsxs)(D().wt,{style:{gap:4},children:[(0,U.jsx)("div",{style:E.noteHeading,children:y.isSlackGridAiConnectorEnabled?(0,U.jsx)(w().sA,{id:"universalSearch.slack.grid.workspaceOrAdminHeading",defaultMessage:"If you are a Slack organization owner or administrator:"},"gridNote2-2"):(0,U.jsx)(w().sA,{id:"universalSearch.slack.workspaceAdminHeading",defaultMessage:"If you are a Slack workspace administrator:"},"note2-2")}),(0,U.jsx)("div",{style:E.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.workspaceAdminBody",defaultMessage:"Follow Slack’s instructions to connect. Return to this window, and the process will continue automatically."},"note2-3")}),(0,U.jsxs)(D().wt,{style:{marginTop:16,gap:4},children:[(0,U.jsx)("div",{style:E.noteHeading,children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.notWorkspaceAdminHeading",defaultMessage:"If you are not authorized to install external apps:"},"note2-4")}),(0,U.jsx)("div",{style:E.noteBody,children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.notWorkspaceAdminBody",defaultMessage:"Follow the instructions to request access to the connection. Then, revisit the connect menu to continue setup."},"note2-5")})]})]},"note-2")]),[y,E]),q=(0,o.useCallback)((()=>y.isEditing?(0,U.jsxs)(D().Ye,{style:E.loadingWrapper,children:[(0,U.jsx)(ge().A,{}),(0,U.jsx)("div",{style:E.loadingChannels,children:(0,U.jsx)(w().sA,{defaultMessage:"Loading channels",id:"slackChannelSelection.isLoadingChannels"})})]}):c?(0,U.jsxs)(D().wt,{style:E.waitingForConnectionWrapper,children:[H().map(((e,n)=>(0,U.jsxs)(D().Ye,{gap:8,style:{marginTop:4,marginBottom:6},children:[(0,U.jsx)(N().A,{number:n+1}),(0,U.jsx)("div",{style:E.note,children:e})]},n))),(0,U.jsx)(D().Ye,{style:E.buttonContainer,children:(0,U.jsx)(T().A,{style:{marginTop:16,width:120,borderRadius:6},onClick:x,children:(0,U.jsxs)(D().Ye,{style:E.learnMoreButton,children:[(0,U.jsx)(w().sA,{id:"universalSearch.slack.waitingForConnection.learnMore",defaultMessage:"Learn More"}),(0,C().X)({width:16,height:16})]})})})]}):(0,U.jsxs)(D().wt,{children:[(0,U.jsxs)(D().Ye,{style:E.channelItem,children:[(0,U.jsx)(Kn().T,{checked:K(),size:14,onClick:()=>{(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:y.selection.allSelected?"all_channels_deselected":"all_channels_selected",integration_type:"slack",setup_session_id:y.sessionId,from:y.analyticsFrom}}}),j().R.setState({...y,selection:{...y.selection,allSelected:!y.selection.allSelected,selectedChannels:[],excludedChannels:[]}})}}),(0,U.jsx)("div",{style:E.channelsText,children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.slackIngestion.allPublicChannels",defaultMessage:"All public channels"})})]}),(0,U.jsx)(En().A,{style:E.divider,size:4}),(0,U.jsxs)(U.Fragment,{children:[t?(0,U.jsx)(U.Fragment,{}):(0,U.jsxs)(D().Ye,{style:E.loadingChannelsWrapper,children:[(0,U.jsx)(ge().A,{}),(0,U.jsxs)(D().wt,{children:[(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.slackIngestion.loadedXChannels",defaultMessage:"{channelsCount} channels loaded...",values:{channelsCount:u.length}})}),(0,U.jsx)("div",{children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.slackIngestion.loading1000PerMinute",defaultMessage:"This can take one minute per every 1,000 public channels."})})]})]}),(0,U.jsx)(D().wt,{style:E.selectionWrapper,children:(e?u.filter((n=>n.name.includes(e))):u).map((e=>(0,U.jsxs)(D().Ye,{gap:8,style:E.channelItemWrapper,children:[(0,U.jsx)(Kn().T,{checked:O(e.id),onClick:()=>{const{selection:n}=y;(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:O(e.id)?"specific_channel_deselected":"specific_channel_selected",integration_type:"slack",setup_session_id:y.sessionId,from:y.analyticsFrom}}}),n.allSelected?n.excludedChannels.includes(e.id)?j().R.setState({...y,selection:{...n,excludedChannels:n.excludedChannels.filter((n=>n!==e.id))}}):j().R.setState({...y,selection:{...n,excludedChannels:n.excludedChannels.concat(e.id)}}):j().R.setState({...y,selection:{...n,allSelected:!1,selectedChannels:n.selectedChannels.includes(e.id)?n.selectedChannels.filter((n=>n!==e.id)):n.selectedChannels.concat(e.id),excludedChannels:[]}})},size:14},`${e.id}-checkbox`),(0,U.jsx)("div",{style:E.channelsText,children:`# ${e.name}`},`${e.id}-label`)]},e.id)))})]})]})),[y,c,E,K,e,u,t,H,x,h,O]);return(0,U.jsx)(W().a,{overlayZIndex:999,showCloseIcon:!0,onDismiss:async()=>{const{accept:e}=await ls().Gh({message:(0,U.jsx)(w().sA,{id:"universalQna.slackChannelSelection.closeConfirm",defaultMessage:"Are you sure you want to dismiss? You will lose all the progress you made."}),acceptLabel:(0,U.jsx)(w().sA,{id:"universalQna.slackChannelSelection.dismiss",defaultMessage:"Dismiss"})});e&&(j().R.reset(),I(),(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_data_selection",integration_type:"slack",setup_session_id:y.sessionId,from:y.analyticsFrom}}}))},open:"data-selection"===y.currentScreen,render:()=>(0,U.jsxs)("div",{style:E.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"slack",title:!c||y.isEditing?(0,U.jsx)(w().sA,{id:"universalQnA.slack.channelSelectionScreenTitle",defaultMessage:"Select channels to connect"}):(0,U.jsx)(w().sA,{id:"universalQnA.slack.channelSelectionWaitingScreenTitle",defaultMessage:"Follow instructions from Slack in your browser"}),subtext:!c||y.isEditing?(0,U.jsx)(w().sA,{id:"universalQnA.slack.channelSelectionScreenSubtext",defaultMessage:"Connecting more Slack channels will give you more relevant and useful Notion AI responses"}):(0,U.jsx)(U.Fragment,{})}),c?(0,U.jsx)(U.Fragment,{}):(0,U.jsx)(On().A,{capture:!0,allowEsc:!0,render:()=>(0,U.jsx)(mn().A,{textWrap:!0,placement:Mt().W.Top,render:t=>(0,U.jsx)("div",{...t,children:(0,U.jsx)(D().Ye,{...t,style:E.searchBarWrapper,children:(0,U.jsx)(It().A,{id:"slackUniversalQnASearchBar",style:E.searchBar,placeholder:We().A.formatMessage(us.searchForAChannel),value:e,onChange:e=>{n(e.target.value),(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"filter_slack_channels",integration_type:"slack",setup_session_id:y.sessionId,from:y.analyticsFrom}}})}},"slackUniversalQnASearchBar")})}),renderTooltip:()=>(0,U.jsx)("div",{style:{width:250},children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.searchBarTooltip",defaultMessage:"All channels may not have been searched. Full search will be available once all channels are loaded."})}),disableTooltip:t})}),(0,U.jsx)(D().Ye,{style:E.selectionContainer,children:(0,U.jsx)(D().wt,{style:E.selection,children:q()})}),!c&&(0,U.jsxs)(D().wt,{style:E.footer,children:[(0,U.jsxs)(D().Ye,{style:E.futureChannelsCheckboxWrapper,children:[(0,U.jsx)(Kn().T,{checked:y.selection.joinFutureChannels,size:14,onClick:()=>{(0,M().u)({environment:h,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:y.selection.joinFutureChannels?"dont_join_future_channels":"join_future_channels",integration_type:"slack",setup_session_id:y.sessionId,from:y.analyticsFrom}}}),j().R.setState({...y,selection:{...y.selection,joinFutureChannels:!y.selection.joinFutureChannels}})}}),(0,U.jsx)("div",{style:E.channelsText,children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.slackIngestion.allFuturePublicChannels",defaultMessage:"Add public channels created in future"})})]}),(0,U.jsx)(ee().A,{style:E.connectButton,onClick:F,disabled:!R(),children:(0,U.jsx)(w().sA,{id:"universalSearch.integration.connect",defaultMessage:"Connect"})})]})]})})}const gs=(0,w().YK)({instruction1:{id:"universalSearch.slack.grid.confirmModalNote1",defaultMessage:"Select your workspaces on your Slack Admin Dashboard"}}),ms=(0,w().YK)({instruction1:{id:"universalSearch.slack.confirmModalNote1",defaultMessage:"Notion AI will join your selected channels in Slack"}});const hs=function(){const e=(0,s().v3)(),n=(0,i().O$)(j().R),t=(0,o.useCallback)((()=>{const e=n.isSlackGridAiConnectorEnabled?gs:ms;return[(0,U.jsx)(Be,{number:1,title:e.instruction1},"item1"),(0,U.jsx)(Be,{number:2,title:Pe.defaultConnectionTime},"item2"),(0,U.jsx)(Be,{number:3,title:{...{...Pe.defaultNotionAiWillBeAbleToAnswerQuestions,values:{appName:"Slack"}}}},"item3")]}),[n.isSlackGridAiConnectorEnabled]),r=(0,o.useCallback)((()=>{H().D6({label:(0,U.jsx)(w().sA,{id:"slackIngestionConfirmModal.ingestion.acknowledge",defaultMessage:"Started syncing from Slack. This can take up to 36 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"slackIngestionConfirmModal.ingestion.startedMessageDismiss",defaultMessage:"Close"})})})}),[]),c=(0,o.useCallback)((()=>{if((0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:n.isSlackGridAiConnectorEnabled?"slack_grid_select_workspaces_clicked":"completion_screen_done",integration_type:"slack",setup_session_id:n.sessionId,from:n.analyticsFrom}}}),n.isSlackGridAiConnectorEnabled){const t=n.gridSetupUrl;if(!t)return;e.device.isElectron?I().openExternalUrl(t):window.open(t,"_blank")}else j().R.setState({...n,isPublicSync:!0,inProgress:!0,currentScreen:"none",ingestionProgress:1}),r()}),[e,n,r]),l=(0,o.useCallback)((()=>{j().R.reset(),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"completion_screen_dismiss",integration_type:"slack",setup_session_id:n.sessionId,from:n.analyticsFrom}}})}),[e,n.analyticsFrom,n.sessionId]);return(0,o.useEffect)((()=>{"confirmation"===n.currentScreen&&(0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:e,connector:"slack",moment:"finished"})}),[e,n.currentScreen]),(0,U.jsx)(Ue,{open:"confirmation"===n.currentScreen,connectorType:"slack",notes:t(),onDismiss:l,title:n.isSlackGridAiConnectorEnabled?(0,U.jsx)(w().sA,{id:"universalSearch.slack.heresWhatToDoNext",defaultMessage:"Here’s what to do next"}):void 0,onPrimaryButtonClick:c,primaryButtonText:n.isSlackGridAiConnectorEnabled?(0,U.jsx)(w().sA,{id:"universalSearch.integration.girdConfirmIngestion",defaultMessage:"Select Slack workspaces"}):void 0})};const vs=function(){const e=(0,i().O$)(j().R),[n,t]=(0,o.useState)(!1),a=(0,s().v3)(),c=(0,l().O)(),[d,u]=(0,o.useState)(!1),[p,g]=(0,o.useState)(!0),[h,f]=(0,o.useState)([]),[y,x]=(0,o.useState)(!1);(0,r().Yb)((async()=>{if(!c||"settings"!==e.currentScreen)return;g(!0);const n=await A().callApi({eventName:"getIngestedSlackChannels",environment:a,data:{spaceId:c}});"success"===n.type&&(g(!1),f(n.data.channels))}),[a,e.currentScreen,c]);const _=(0,o.useCallback)((()=>{const e=v().default.getConfigKey("ingestion","slack"),n=null==e?void 0:e.learnMoreUrl;n&&window.open(n,"_blank")}),[]),C=(0,o.useCallback)((()=>{j().R.reset()}),[]),N=(0,o.useCallback)((()=>{t(!1)}),[]),B=(0,o.useCallback)((async()=>{if(!c)return;u(!0);if("success"===(await A().callApi({eventName:"disconnectSlackIngestion",environment:a,data:{spaceId:c,disconnectForWorkspace:!0,disconnectReason:"admin_disconnect"}})).type){var e;j().R.setState({...j().R.state,isDisconnecting:!0});const n=S().A.state.appsConnectionData.filter((e=>e.id!==Je().e5)),o=m().default.state.currentUserStore;S().A.setState({...S().A.state,appsConnectionData:[...n,{connectionStatus:"disconnecting",connectionLastEditedTimestamp:Date.now(),connectionType:"slack",connectorEmail:(null==o?void 0:o.getEmail())||"",id:Je().e5,connectorNotionId:null==o||null===(e=o.getModel())||void 0===e?void 0:e.id}]}),H().D6({label:(0,U.jsx)(w().sA,{id:"slackIngestionConfirmModal.ingestion.acknowledgeDisconnect",defaultMessage:"Started disconnecting Slack. This can take up to 3 hours."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"slackIngestionConfirmModal.ingestion.dismissAcknowledgeDisconnect",defaultMessage:"Close"})})}),t(!1),j().R.reset()}else u(!1),H().D6({label:(0,U.jsx)(w().sA,{id:"slackIngestionConfirmModal.ingestion.disconnectError",defaultMessage:"Failed to disconnect Slack. Please try again later."}),position:"bottom",style:{width:"500px",display:"flex",justifyContent:"space-between"},right:(0,U.jsx)(T().A,{onClick:H().N2,children:(0,U.jsx)(w().sA,{id:"slackIngestionConfirmModal.ingestion.closeSnackbarError",defaultMessage:"Close"})})});u(!1)}),[a,c]),F=(0,b().IS)((e=>({wrapper:{width:400},channelDetailsContainer:{width:352,fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary},channelDetailsSubtitle:{textAlign:"center",marginBottom:"16px"},channelDetailsWrapper:{justifyContent:"center",paddingTop:"12px",paddingBottom:"12px"},channelNamesContainer:{gap:2,color:e.text.primary},footer:{justifyContent:"center",alignItems:"center",width:"100%",padding:"20px 20px 20px 20px",gap:8},disconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},moreChannelsContainer:{paddingTop:8},learnMoreButton:{fontSize:14,fontWeight:k().Wy.semibold,borderRadius:"4px",width:"100%"},learnMoreText:{fontWeight:k().Wy.medium,fontSize:12,gap:5,justifyContent:"center",alignItems:"center",padding:"4px 8px 4px 8px",color:`${e.text.secondary}`},externalLinkIcon:{width:16,height:16},confirmWrapper:{width:300,alignItems:"center"},confirmContainer:{padding:20},confirmModalTitle:{fontSize:17,fontWeight:k().Wy.semibold,color:e.text.primary,textAlign:"center"},confirmModalSubTitle:{fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},confirmModalDescription:{fontSize:14,fontWeight:k().Wy.regular,color:e.text.secondary,paddingTop:8,textAlign:"center"},goBackButton:{fontSize:14,fontWeight:k().Wy.regular,width:"100%",textAlign:"center",padding:"4px 0px 4px 0px"},confirmDisconnectButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},confirmModalActionButtons:{gap:8,paddingTop:20},spinner:{paddingTop:20,paddingBottom:40,justifyContent:"center",alignItems:"center"},editChannelsButton:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"}})),[]);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:N,open:n,render:()=>(0,U.jsx)("div",{style:F.confirmWrapper,children:(0,U.jsxs)("div",{style:F.confirmContainer,children:[(0,U.jsx)("div",{style:F.confirmModalTitle,children:(0,U.jsx)(w().sA,{id:"slackIngestionSettings.confirmation.title",defaultMessage:"Are you sure?"})}),(0,U.jsx)("div",{style:F.confirmModalSubTitle,children:(0,U.jsx)(w().sA,{id:"slackIngestionSettings.confirmation.subTitle",defaultMessage:"Your Slack data will be permanently deleted from Notion."})}),(0,U.jsx)("div",{style:F.confirmModalDescription,children:(0,U.jsx)(w().sA,{id:"slackIngestionSettings.confirmation.description",defaultMessage:"This process can take up to 3 hours, and you’ll only be able to reconnect after disconnecting is complete."})}),(0,U.jsxs)(D().wt,{style:F.confirmModalActionButtons,children:[(0,U.jsx)(ee().A,{isRed:!0,style:F.confirmDisconnectButton,disabled:d,onClick:B,children:(0,U.jsx)(w().sA,{id:"slackIngestion.confirmDisconnectModal.confirmDisconnect",defaultMessage:"Disconnect for everyone"})}),(0,U.jsx)(T().A,{style:F.goBackButton,onClick:N,children:(0,U.jsx)(w().sA,{id:"slackIngestion.confirmDisconnectModal.goBack",defaultMessage:"Go back"})})]})]})})}),(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:C,open:"settings"===e.currentScreen,render:()=>(0,U.jsxs)("div",{style:F.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"slack",title:(0,U.jsx)(w().sA,{id:"universalSearch.slack.settingsModalTitle",defaultMessage:"Slack is connected to Notion AI"}),subtext:p||e.isSlackGridAiConnectorEnabled?void 0:(0,U.jsx)(w().sA,{id:"universalSearch.slackIngestion.settingsModal.canAnswerFrom",defaultMessage:"Notion AI can answer questions about {channelsCount} public channels in Slack.",values:{channelsCount:h.length}})}),p?(0,U.jsx)(D().Ye,{style:F.spinner,children:(0,U.jsx)(ge().A,{})}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(D().Ye,{style:F.channelDetailsWrapper,children:e.isSlackGridAiConnectorEnabled?(0,U.jsx)(D().wt,{style:F.channelDetailsContainer,children:(0,U.jsx)(w().sA,{id:"slackSettings.grid.note",defaultMessage:"This Notion workspace is connected to Slack Enterprise Grid. Settings can be only configured in the Slack Admin Dashboard."})}):(0,U.jsxs)(D().wt,{style:F.channelDetailsContainer,children:[(0,U.jsx)(D().wt,{style:F.channelNamesContainer,children:h.slice(0,4).map((e=>(0,U.jsx)("div",{children:`# ${e}`},e)))}),h.length-4>0?(0,U.jsx)(D().Ye,{style:F.moreChannelsContainer,children:(0,U.jsx)(w().sA,{id:"universalSearch.slackIngestion.settingsModal.moreChannels",defaultMessage:"{moreChannelsCount} more",values:{moreChannelsCount:h.length-4}})}):(0,U.jsx)(U.Fragment,{})]})}),(0,U.jsxs)(D().wt,{style:F.footer,children:[(0,U.jsx)(ie().A,{size:"lg",disabled:y,style:F.editChannelsButton,onClick:async()=>{if(!c)return;if(e.isSlackGridAiConnectorEnabled){x(!0);const e=await A().callApi({eventName:"getUrlForGridSetup",environment:a,data:{spaceId:c}});return"success"===e.type&&(a.device.isElectron?I().openExternalUrl(e.data.url):window.open(e.data.url,"_blank")),void x(!1)}x(!0);const n=await A().callApi({eventName:"getIngestionOptions",environment:a,data:{spaceId:c}});"success"===n.type&&((0,M().u)({environment:a,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"edit_channels",integration_type:"slack",setup_session_id:e.sessionId,from:e.analyticsFrom}}}),j().R.setState({...e,currentScreen:"data-selection",selection:{allSelected:n.data.selection.allSelected,selectedChannels:n.data.selection.selectedChannels,excludedChannels:n.data.selection.excludedChannels,joinFutureChannels:n.data.selection.joinFutureChannels},isEditing:!0})),x(!1)},children:y?(0,U.jsxs)(D().Ye,{style:{alignItems:"center",gap:4,fontWeight:k().Wy.regular},children:[(0,U.jsx)(ge().A,{}),(0,U.jsx)(w().sA,{id:"slackUniversalSearch.integration.loadingPreviousSelection",defaultMessage:"Loading previous selection"})]}):e.isSlackGridAiConnectorEnabled?(0,U.jsx)(w().sA,{id:"slackUniversalSearch.integration.editTeams",defaultMessage:"Edit settings"}):(0,U.jsx)(w().sA,{id:"slackUniversalSearch.integration.editChannels",defaultMessage:"Edit channels"})}),(0,U.jsx)(Ne().E,{style:F.disconnectButton,onClick:()=>{t(!0)},children:(0,U.jsx)(w().sA,{id:"slackUniversalSearch.integration.disconnectSlack",defaultMessage:"Disconnect"})}),(0,U.jsx)(T().A,{style:F.learnMoreButton,onClick:_,children:(0,U.jsxs)(D().Ye,{style:F.learnMoreText,children:[(0,U.jsx)(w().sA,{id:"universalSearch.integration.learnMore",defaultMessage:"Learn more"}),(0,Te().M)(F.externalLinkIcon)]})})]})]})]})})]})};var fs=()=>t(640653);function ys(e){const{open:n}=e,t=(0,b().IS)((()=>({loadingWrapper:{padding:20,fontSize:k().J.UISmall.desktop,fontWeight:k().Wy.regular,justifyContent:"center",gap:8,alignItems:"center"}})),[]);return(0,U.jsx)(W().a,{showCloseIcon:!0,open:n,render:()=>(0,U.jsxs)(D().Ye,{style:t.loadingWrapper,children:[(0,U.jsx)(w().sA,{id:"aiConnectors.common.isFetchingConnection",defaultMessage:"Getting connection status"}),(0,U.jsx)(ge().A,{})]})})}function xs(){const e=(0,w().tz)(),n=(0,b().IS)((e=>({wrapper:{width:400},footer:{justifyContent:"center",alignItems:"center",width:"100%",height:60,boxShadow:e.shadowMD,padding:"20px 20px 20px 20px",gap:6},connectButton:{fontSize:14,fontWeight:k().Wy.semibold,width:"100%"}})),[]);return(0,U.jsx)(W().a,{ariaLabel:e.formatMessage({defaultMessage:"Slack AI Connector is currently facing issues and cannot be connected.",id:"slackAiConnector.facingIssues.ariaLabel"}),showCloseIcon:!0,onDismiss:()=>j().R.reset(),open:!0,render:()=>(0,U.jsxs)("div",{style:n.wrapper,children:[(0,U.jsx)(P().b,{connectorType:"slack",title:(0,U.jsx)(w().sA,{id:"slackAiConnector.facingIssues.title",defaultMessage:"Slack AI Connector is currently facing issues"}),subtext:(0,U.jsx)(w().sA,{id:"slackAiConnector.facingIssues.description",defaultMessage:"Apologies, we are currently facing issues with the Slack AI Connector and can not allow new connections. Please try again later."})}),(0,U.jsx)(D().wt,{style:n.footer,children:(0,U.jsx)(ee().A,{style:n.connectButton,onClick:()=>j().R.reset(),children:(0,U.jsx)(w().sA,{id:"slackAiConnector.facingIssues.dismiss",defaultMessage:"Close"})})})]})})}function _s(e){const{open:n}=e;return(0,U.jsx)(ke,{open:n,onDismiss:()=>{j().R.reset()},connector:"slack"})}const Ss=(0,w().YK)({slackUniversalSearchOauthPopupTitle:{id:"universalSearch.slack.slackOauthPopupTitle",defaultMessage:"Authenticate Slack"}});function js(){var e,n;const t=(0,o.useMemo)((()=>_e("slack")),[]),c=(0,o.useMemo)((()=>Se("slack")),[]),d=(0,s().v3)(),u=(0,l().O)(),p=d.currentUser.id,g=(0,x().P9)({name:"ai_connectors",spaceId:u,userId:p}),f=(0,i().K8)((()=>h().zD.state.isAiEnabled()),[]),y=(0,i().O$)(m().AppStoreCurrentSpaceStore),_=(0,i().O$)(j().R),S=(0,i().K8)((()=>v().default.getConfigKey("ingestion","slack").learnMoreUrl),[]),b=(0,i().K8)((()=>v().default.getConfigKey("ai_connectors_onboarding_blocked","currently_facing_issues")),[]),C=null==b?void 0:b.includes("slack"),[w]=(0,r().Yb)((async()=>{if(!u||"introduction"!==_.currentScreen)return;if(v().default.checkGate({gateName:"ai_connector_unification"})){const e=await(0,a().getConnectorStatus)({environment:d,spaceId:u,connector:"slack"});return void 0!==e&&"failed"!==e?{isPublicConnected:void 0!==e.details.connectionDetails}:{isPublicConnected:!1}}const e=await A().callApi({eventName:"getConnectedAppsForUniversalQna",environment:d,data:{spaceId:u},headers:(0,zn().WS)({spaceId:u})});return"success"===e.type?{isPublicConnected:e.data.connectedApps.includes("slack-admin")}:void 0}),[d,_.currentScreen,u]),k=(0,i().K8)((()=>y&&(0,fs().oT)(y)),[y]),T=(0,L().J)(),N=!y||!u||(null===(e=w.value)||void 0===e?void 0:e.isPublicConnected)||!f||!k,W="resolved"===w.status&&"introduction"===_.currentScreen,D=T?"proceed_to_slack_data_selection":"contact_workspace_owners";(0,o.useEffect)((()=>{!N&&W&&(T?(0,M().u)({environment:d,event:{eventName:"universal_qna_onboarding_modal_open",eventProperties:{integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom,is_space_admin:T,is_ai_eligible:g??!1}}}):(0,M().u)({environment:d,event:{eventName:"universal_qna_request_modal_open",eventProperties:{integration_type:"slack",from:_.analyticsFrom,is_ai_eligible:g??!1}}}))}),[d,N,_.sessionId,_.analyticsFrom,W,T,g]);const B=(0,o.useCallback)((()=>{j().R.reset(),(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"drop_off_slack_intro_modal",integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom}}})}),[d,_]);if(!u)return(0,U.jsx)(U.Fragment,{});if(!d.device.isMobile&&N){var F;const e=Boolean(null===(F=w.value)||void 0===F?void 0:F.isPublicConnected);return e?(0,U.jsx)(_s,{open:W&&e}):(0,U.jsx)(U.Fragment,{})}return d.device.isMobile?(0,U.jsx)(je,{connectorType:"slack",open:"introduction"===_.currentScreen,onClosed:()=>{j().R.reset()},learnMoreUrl:S}):!C||"introduction"!==_.currentScreen||"resolved"!==w.status||null!==(n=w.value)&&void 0!==n&&n.isPublicConnected?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(ys,{open:"introduction"===_.currentScreen&&"resolved"!==w.status}),T?(0,U.jsx)(ae,{onConnect:async()=>{if((0,a().maybeMarkAiConnectorOnboardingSurveyMomentInSettings)({environment:d,connector:"slack",moment:"started"}),!g)return(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"show_purchase_ai",integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom}}}),_t().Ow({openedFrom:"slack_qna_intro_modal",currentTab:"plans"}),void j().R.reset();j().R.setState({...j().R.state,currentScreen:"data-selection"});const e=await A().callApi({eventName:"getSlackIngestionAuthorizeUrl",environment:d,data:{spaceId:u,isAdminAuth:!0,isDesktopApp:d.device.isElectron,sessionId:_.sessionId}});"success"===e.type&&(j().R.setState({...j().R.state,authUrl:e.data.url}),d.device.isElectron?I().openExternalUrl(e.data.url):await pe().P(d,{width:800,height:600,url:e.data.url,titleMessage:Ss.slackUniversalSearchOauthPopupTitle}),(0,M().u)({environment:d,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:D,integration_type:"slack",setup_session_id:_.sessionId,from:_.analyticsFrom}}}))},onDismiss:B,onLearnMore:()=>{window.open(S,"_blank")},title:t,connectorType:"slack",notes:c,open:W}):(0,U.jsx)(J,{connector:"slack",handleClose:()=>(0,a().resetAiConnectorStatus)("slack"),open:W,analyticsFrom:_.analyticsFrom,setupSessionId:_.sessionId,messages:R().vK})]}):(0,U.jsx)(xs,{})}const bs=function(){const e=(0,s().v3)(),n=(0,i().O$)(j().R),t=(0,b().IS)((e=>({wrapper:{width:400,padding:24},logoSection:{paddingTop:"40px",paddingBottom:"16px",gap:8,justifyContent:"center",alignItems:"center"},titleWrapper:{width:"100%",justifyContent:"center",textAlign:"center"},title:{fontSize:17,fontWeight:k().Wy.medium,lineHeight:"22px",marginBottom:"24px",textWrap:"balance"},nextStepsWrapper:{width:"100%",justifyContent:"center",color:e.text.secondary},footer:{justifyContent:"center",alignItems:"center",bottom:0,width:"100%",gap:12,marginTop:12},gotIt:{fontSize:14,fontWeight:k().Wy.medium,width:"100%"},pickAnother:{fontSize:14,fontWeight:k().Wy.medium,width:"100%",textAlign:"center"}})),[]),r=(0,o.useCallback)((()=>{j().R.reset()}),[]),a=(0,o.useCallback)((()=>{j().R.setState({...j().R.getInitialState(),currentScreen:"introduction"})}),[]);return(0,U.jsx)(W().a,{showCloseIcon:!0,onDismiss:()=>{j().R.reset(),(0,M().u)({environment:e,event:{eventName:"universal_qna_button_click",eventProperties:{button_name:"slack_workspace_already_connected_modal_close",integration_type:"slack",setup_session_id:n.sessionId,from:n.analyticsFrom}}})},open:"alreadyConnected"===n.currentScreen,render:()=>(0,U.jsxs)("div",{style:t.wrapper,children:[(0,U.jsx)(D().Ye,{style:t.logoSection,children:(0,Oe().Q)({width:24,height:24})}),(0,U.jsx)(D().Ye,{style:t.titleWrapper,children:(0,U.jsx)(D().Ye,{style:t.title,children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.workspaceAlreadyConnected",defaultMessage:"Slack is already connected to another Notion workspace"})})}),(0,U.jsx)(D().Ye,{style:t.nextStepsWrapper,children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.onlyOneWorkspaceCanBeConnected",defaultMessage:"Currently, Slack can be only connected to one workspace at a time"})}),(0,U.jsxs)(D().wt,{style:t.footer,children:[(0,U.jsx)(ie().A,{size:"lg",style:t.gotIt,onClick:r,children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.gotItOneWorkspaceConnected",defaultMessage:"Got it"})}),(0,U.jsx)(T().A,{style:t.pickAnother,onClick:a,children:(0,U.jsx)(w().sA,{id:"universalSearch.slack.pickDifferentWorkspace",defaultMessage:"Pick a different Slack workspace"})})]})]})})};function Cs(){const e=(0,l().O)(),n=(0,d().T)(),t=(0,s().v3)(),b=(0,i().O$)(S().A),C=(0,x().P9)({name:"ai_connectors",spaceId:e,userId:n}),w=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("github")),[]),k=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("gmail")),[]),A=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("google-calendar")),[]),I=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("notion-mail")),[]),M=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("outlook")),[]),T=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("jira")),[]),N=(0,u().X)("jira_qna_ingestion_v2"),W=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("microsoft-teams")),[]),D=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("sharepoint")),[]),B=(0,i().K8)((()=>h().zD.canUseAiConnectorSearchScope("linear")),[]),F=(0,i().K8)((()=>m().default.getState().currentSpaceViewStore),[]);(0,o.useEffect)((()=>{"introduction"!==p().o.state.currentScreen&&p().o.reset()}),[]);const P=(0,i().K8)((()=>(0,_().wd)()),[]),L=(0,i().K8)((()=>(0,_().kB)()),[]);(0,o.useEffect)((()=>{if(F)for(const e of L)(0,a().maybeTrackSprigAiConnectorOnboardingSurvey)({environment:t,connector:e,connectedApps:P})}),[t,P,L,F]);const E=(0,u().X)("install_from_jira_marketplace");return(0,c().ts)(),(0,r().Yb)((async()=>{e&&W&&("introduction"!==g().F.state.currentScreen&&g().F.reset(),await(0,a().getMicrosoftTeamsAIConnectorStatusAction)({environment:t,spaceId:e}))}),[e,W,t]),(0,o.useEffect)((()=>{const{connectorTriggeringUpsell:e,upsellTriggeredAt:n}=b,t=v().default.getConfigKey("ingestion","upsellMaxDurationInSeconds")||36e5;if(C&&e&&n){if(Date.now()-n>t)return void S().A.reset();switch(e){case"slack":j().R.setState({...j().R.state,currentScreen:"introduction"});break;case"google-drive":f().d.setState({...f().d.state,currentScreen:"introduction"});break;case"jira":y().y.setState({...y().y.state,currentScreen:"introduction"});break;case"github":p().o.setState({...p().o.state,currentScreen:"introduction"})}S().A.reset()}}),[b,C]),(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Y,{}),(0,U.jsx)($,{}),(0,U.jsx)(ue,{}),(0,U.jsx)(ce,{}),(0,U.jsx)(oe,{}),(0,U.jsx)(as,{}),(0,U.jsx)(js,{}),(0,U.jsx)(ps,{}),(0,U.jsx)(hs,{}),(0,U.jsx)(vs,{}),(0,U.jsx)(bs,{}),(0,U.jsx)(it,{}),(0,U.jsx)(Xn,{}),(0,U.jsx)(Zn,{}),(0,U.jsx)(et,{}),(0,U.jsx)(st,{}),(0,U.jsx)(Vn,{}),(0,U.jsx)(Qn,{}),(0,U.jsx)(Pn,{}),(0,U.jsx)(Un,{}),(0,U.jsx)(Yn,{}),(0,U.jsx)($n,{}),A?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(An,{}),(0,U.jsx)(In,{}),(0,U.jsx)(Wn,{}),(0,U.jsx)(Tn,{}),(0,U.jsx)(Mn,{}),(0,U.jsx)(Nn,{}),(0,U.jsx)(Fn,{}),(0,U.jsx)(Dn,{}),(0,U.jsx)(Bn,{})]}):void 0,k?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(fn,{}),(0,U.jsx)(yn,{}),(0,U.jsx)(jn,{}),(0,U.jsx)(_n,{}),(0,U.jsx)(xn,{}),(0,U.jsx)(Sn,{}),(0,U.jsx)(wn,{}),(0,U.jsx)(bn,{}),(0,U.jsx)(Cn,{})]}):void 0,I?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(wo,{}),(0,U.jsx)(ko,{}),(0,U.jsx)(To,{}),(0,U.jsx)(Io,{}),(0,U.jsx)(Ao,{}),(0,U.jsx)(Mo,{}),(0,U.jsx)(Do,{}),(0,U.jsx)(No,{}),(0,U.jsx)(Wo,{})]}):void 0,M?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Fo,{}),(0,U.jsx)(Po,{}),(0,U.jsx)(Eo,{}),(0,U.jsx)(zo,{}),(0,U.jsx)(Uo,{}),(0,U.jsx)(Lo,{}),(0,U.jsx)(Ro,{}),(0,U.jsx)(Oo,{}),(0,U.jsx)(Ko,{})]}):void 0,w?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Me,{}),(0,U.jsx)(z,{}),(0,U.jsx)(Le,{}),(0,U.jsx)(De,{})]}):void 0,T?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(wt,{}),(0,U.jsx)(ct,{}),(0,U.jsx)(ft,{}),(0,U.jsx)(xt,{}),(0,U.jsx)(Dt,{}),(0,U.jsx)(rt,{}),(0,U.jsx)(Nt,{}),(0,U.jsx)(Ct,{}),E?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(ht,{}),(0,U.jsx)(bt,{})]}):void 0]}):void 0,N&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Yt,{}),(0,U.jsx)(Et,{}),(0,U.jsx)(Kt,{}),(0,U.jsx)(qt,{}),(0,U.jsx)(Qt,{}),(0,U.jsx)(Rt,{})]}),W?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(xo,{}),(0,U.jsx)(so,{}),(0,U.jsx)(po,{}),(0,U.jsx)(vo,{}),(0,U.jsx)(So,{}),(0,U.jsx)(fo,{}),(0,U.jsx)(oo,{}),(0,U.jsx)(bo,{}),(0,U.jsx)(go,{}),(0,U.jsx)(lo,{})]}):void 0,D?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Zo,{}),(0,U.jsx)(qo,{}),(0,U.jsx)(Yo,{}),(0,U.jsx)(ts,{}),(0,U.jsx)(Jo,{}),(0,U.jsx)($o,{}),(0,U.jsx)(ns,{})]}):void 0,B?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(no,{}),(0,U.jsx)(Vt,{}),(0,U.jsx)(Zt,{}),(0,U.jsx)(to,{})]}):void 0]})}}}]);