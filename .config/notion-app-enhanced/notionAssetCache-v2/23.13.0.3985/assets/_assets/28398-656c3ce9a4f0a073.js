"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[28398],{139466:(e,t,a)=>{a.d(t,{d:()=>m});a(296540);var s=()=>a(484714),o=()=>a(56366),n=()=>a(401497),i=()=>a(959013),r=()=>a(534177),c=()=>a(895876),l=()=>a(958378),d=()=>a(128295),p=()=>a(115512),u=a(474848);function m(e){let{spaceStore:t,collectionStore:a,menuListItemProps:o}=e;const i=(0,s().v3)(),r=(0,n().IS)((e=>({caption:{color:e.text.tertiary,fontSize:(0,p().ny)(i,"UISmall")}})),[i]);return(0,u.jsx)(l().A,{caption:(0,u.jsx)("div",{style:r.caption,children:(0,u.jsx)(g,{spaceStore:t,collectionStore:a})}),store:a,...o})}function g(e){let{spaceStore:t,collectionStore:a}=e;const n=(0,s().v3)(),l=(0,o().K8)((()=>function(e){let{environment:t,spaceStore:a,collectionStore:s}=e;const o=(0,c().X0)({collectionStore:s});switch(o){case"team":return null;case"private":return(0,u.jsx)(i().sA,{id:"moveToHelpers.privatePageCaptionPrefix",defaultMessage:"Private"});case"shared":return(0,u.jsx)(i().sA,{id:"moveToHelpers.sharedPageCaptionPrefix",defaultMessage:"Shared"});default:(0,r().HB)(o)}}({environment:n,spaceStore:t,collectionStore:a})),[n,t,a]),p=(0,o().K8)((()=>(0,d().a6)(a)),[a])&&(0,u.jsx)(d().Ay,{store:a,showFullPathInTooltip:!0});return p&&l?(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[l,(0,u.jsx)("div",{style:{paddingLeft:4,paddingRight:4},children:"/"}),p]}):p&&!l?p:(0,u.jsx)(u.Fragment,{children:l})}},258805:(e,t,a)=>{a.d(t,{wU:()=>ie,OC:()=>ce,wc:()=>X,NA:()=>Z,L2:()=>ee,aE:()=>pe,oG:()=>oe,N$:()=>re,DZ:()=>J,_B:()=>ue,R3:()=>de,nG:()=>te});a(16280),a(944114),a(517642),a(658004),a(733853),a(845876),a(432475),a(515024),a(731698),a(898992),a(354520),a(430670),a(581454),a(296540);var s=()=>a(148307),o=()=>a(484392),n=()=>a(315564),i=()=>a(689094),r=()=>a(179034),c=()=>a(959013),l=()=>a(778078),d=()=>a(496603),p=()=>a(534177),u=()=>a(264879),m=()=>a(524539),g=()=>a(751156),h=()=>a(755199),y=()=>a(895876),v=()=>a(760217),S=()=>a(89924),f=()=>a(859428),x=()=>a(453697),A=()=>a(103448),I=()=>a(186445),T=()=>a(553965),b=()=>a(776894),k=()=>a(372657),j=()=>a(37433),M=()=>a(106628),w=()=>a(962730),P=()=>a(765957),C=()=>a(832820),B=()=>a(227440),O=()=>a(188669),D=()=>a(630116),L=()=>a(519831),N=()=>a(96689),R=()=>a(854150),E=()=>a(46986),V=()=>a(56366),_=()=>a(401497),K=()=>a(958378),q=()=>a(16006),z=()=>a(299545),W=a(474848);function F(e){const{store:t,menuListItemProps:a,hidePath:s}=e,o=(0,V().K8)((()=>function(e){if((0,z()._p)(e)&&!e.canEdit())return(0,W.jsx)(c().sA,{id:"moveBlockMenu.needEditAccess.tooltip",defaultMessage:"You need “Can edit” access to “{parentName}” to move this page",values:{parentName:(0,W.jsx)(q().A,{store:e,shouldWrap:!0})}});if((0,z().$R)(e)&&!e.canAddOrRemoveTopLevelPages())return(0,W.jsx)(c().sA,{id:"moveBlockMenu.TeamSidebarLocked.tooltip",defaultMessage:"This teamspace has its sidebar locked. You must be a teamspace owner to move to this teamspace."})}(t)),[t]),n=Boolean(o),i=(0,_().IS)((e=>({disabledTooltip:{maxWidth:240},recordMenuItem:n?{color:e.text.secondary}:{}})),[n]);return(0,W.jsx)(f().A,{placement:w().W.Left,textWrap:!0,style:i.disabledTooltip,disableTooltip:!n,renderTooltip:()=>o,render:e=>(0,W.jsx)(K().A,{...(0,T().A)(a,e),disabled:n,store:t,hidePath:s,style:i.recordMenuItem})})}var H=()=>a(139466);function $(e){let{spaceStore:t,value:a,showPath:s,isCreateIn:o,onAccept:n}=e;const i=function(e){let{spaceStore:t,value:a}=e;const{type:s}=a;switch(s){case"page":return D().Bv.createChildStore(t,{table:r().ev,id:a.id});case"collection":return D().md.createChildStore(t,{table:L().Vl,id:a.id});case"space":return D().SL.createChildStore(t,{table:N().NX,id:a.id});case"team":return D().h4.createChildStore(t,{table:R().yK,id:a.id});case"space-private-pages":return;default:(0,p().HB)(s)}}({spaceStore:t,value:a});if(i){if((0,k().n6)()&&i instanceof D().md)return[{key:i.id,render:e=>(0,W.jsx)(H().d,{spaceStore:t,collectionStore:i,menuListItemProps:e}),action:()=>n(a)}];if((0,E().i$)()&&i instanceof D().Bv&&i.isCollectionView()&&i.getOwnedCollectionStores().length>1){return i.getOwnedCollectionStores().map((e=>({key:e.id,render:t=>(0,W.jsx)(F,{store:e,menuListItemProps:t,hidePath:!!o&&!s}),action:()=>n({type:"collection",id:e.id})})))}return[{key:i.id,render:e=>(0,W.jsx)(F,{store:i,menuListItemProps:e,hidePath:!!o&&!s}),action:()=>n(a)}]}}var U=()=>a(478495),G=()=>a(828048);const Y=5,J=(0,c().YK)({createSubpage:{id:"moveToOrCreateMenu.createSubpage.description",defaultMessage:"Create a new sub-page where your cursor is, inside the current block."},newPageIn:{id:"moveToOrCreateMenu.newPageIn.description",defaultMessage:"Create a new page inside any existing page, then link to it in one go."},turnInto:{id:"moveToOrCreateMenu.turnInto.description",defaultMessage:"Turn blocks into new pages inside any existing database or page."},privatePagesTitle:{defaultMessage:"Private Pages",id:"moveBlockMenu.privatePagesMenuTitle"},teamspacesTitle:{defaultMessage:"Teamspaces",id:"moveBlockMenu.teamsSection.title"},pagesTitle:{defaultMessage:"Pages",id:"moveBlockMenu.pagesSection.title"},suggestedTitle:{defaultMessage:"Suggested",id:"moveBlockMenu.suggestedSection.title"}});function Q(e,t,a,o,n,l,d){if(!l||!d)return;if(e.query)return;const p=P().default.state.mainEditorCurrentBlockStore;if(!p)return;const m=n?D().Bv.createChildStore(p,{table:r().ev,id:n}):void 0,g=u().D8(m);return g?{key:g.pageStore.id,render:e=>{const o=t=>(0,W.jsx)(v().A,{...(0,T().A)(t||{},e),icon:(0,i().W)({width:14}),title:a.length>1?(0,W.jsx)(c().sA,{id:"moveBlockMenu.currentPage.pluralAddTitle",defaultMessage:"New sub-pages"}):(0,W.jsx)(c().sA,{id:"moveBlockMenu.currentPage.singleAddTitle",defaultMessage:"New sub-page"})});return t.device.isPhone?o():(0,W.jsx)(f().A,{renderTooltip:()=>(0,W.jsx)(A().A,{imageURL:s().A.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,W.jsx)(c().sA,{...J.createSubpage})}),placement:w().W.Right,delayThreshold:0,render:e=>o(e)})},action:()=>o(g.createInValue)}:void 0}function X(e){return e.getChosenSpaceStore()??P().default.state.currentSpaceStore}function Z(e){return e.getChosenSpaceViewStore()??P().default.state.currentSpaceViewStore}function ee(e){return e.isOpen?e.queryLimit:b().p1}function te(e,t,a){var s;t(e);const o=O().Ay.getDatabaseType(),n=null===(s=P().default.state.currentSpaceStore)||void 0===s?void 0:s.id;"collection"===e.type&&n&&g().createAndCommit({userAction:"TypedMoveToMenu.handleClick",environment:a,canUndo:!0,perform:t=>{h().ee({transaction:t,databaseType:o,collectionId:e.id})}})}function ae(e,t,a,s,o){const{query:n,savedQuickAddParent:i}=e,r=X(o);if(r)return t&&!n&&"space"===i.type||"page"===i.type?$({spaceStore:r,value:i,showPath:!0,isCreateIn:a,onAccept:s}):void 0}async function se(e,t,a,s,n){if(!O().Ay.state.isOpen||"untyped"===O().Ay.state.variant||!C().c.state)throw new Error("Trying to render section when it's either not open, untyped, or typed but uninitialized (i.e. the typed databases are not fetched yet)");const i=O().Ay.getDatabaseType(),r=(0,y().$O)(i),{typedDatabases:l}=C().c.state,d=await async function(e,t,a,s,o){const{databaseType:n,query:i,searchSessionId:r}=e,c=X(o);if(!c)return[];const l=await M().T.searchActions.load();return(await l.searchCollectionsWithRecents({environment:t,query:i,limit:20,databaseType:n,parentStore:c,spaceStore:c,collectionViewBlockStore:void 0,searchSessionId:r})).results.flatMap((e=>$({spaceStore:c,value:{type:"collection",id:e,spaceId:c.id},showPath:!0,isCreateIn:a,onAccept:a?s:e=>te(e,s,t)}))).filter(p().O9)}({query:e,databaseType:i?[i]:void 0,searchSessionId:O().Ay.state.flowId},t,a,s,n);return{typedSuggestedMenuSection:{key:"suggested",render:e=>(0,W.jsx)(S().A,{...e,title:(0,W.jsx)(c().sA,{defaultMessage:"{typedItemName} databases",id:"moveBlockMenu.typedSuggestedSection.title",values:{typedItemName:(0,o().A)(r)}}),right:(0,W.jsx)(G().m,{typedItemName:r})}),items:d.slice(0,Y)},typedSuggestedResults:l}}function oe(e,t,a,s,o,i,r,d){var p;const{query:u,chosenSpaceStore:m}=e,g=P().default.state.currentSpaceStore,h=J.privatePagesTitle,y=s.formatMessage(h).replace(/<[^>]*>/g,""),S=u?null===(p=(0,l().It)(u,y))||void 0===p?void 0:p.score:void 0,f=u&&(S||0)>=l().sH;if((!u||f)&&r&&(!m||(0,U().VN)({environment:t,targets:o,chosenSpaceStore:m,forceShowPrivatePageOption:d,currentSpaceStore:g})))return{key:"private",render:e=>(0,W.jsx)(v().A,{icon:(0,W.jsx)(x().A,{size:22,userStore:(0,I()._m)(t)}),title:(0,W.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,W.jsx)("span",{children:(0,W.jsx)(c().sA,{...h})}),(0,j().zI)()>0?(0,W.jsx)("div",{style:{marginLeft:10,display:"flex",alignItems:"center"},children:(0,n().S)({width:16,height:16,fill:a.icon.secondary})}):void 0]}),...e}),action:()=>{i({type:"space-private-pages"})}}}function ne(e,t,a,s,o){if(e&&!o)return[];const n=X(s),i=Z(s);if(!n||!i)return[];let r=i.getTeamsStores();return e&&(r=(0,l().Ay)(e,r,(e=>e.getName()||""))),r.flatMap((e=>$({spaceStore:n,value:{type:"team",id:e.id,spaceId:n.id},showPath:!1,isCreateIn:t,onAccept:a}))).filter(p().O9)}function ie(e){const{allTargetsAreNavigable:t,blockResults:a,chosenSpaceStore:s,environment:o,isAddTo:n,isCreateIn:i,isTurnIntoPage:r,moveToSpaceMenuStore:l,onAccept:p,parentBlockId:u,query:m,recentPageResults:g,targets:h,templateResults:y,topLevelBlockResults:v}=e,f=[],x=new Set,A=e=>{if(!e)return!1;const{key:t}=e;return!x.has(t)&&(x.add(t),!0)},I=d().oE([Q({query:m},o,h,p,u,n,i)]);!I.length||Boolean(r)||Boolean(n)||f.push({key:"defaults",render:e=>(0,W.jsx)(S().A,{...e}),items:I});const T=d().oE([...g.slice(0,5).flatMap((e=>{let{blockId:t}=e;return $({spaceStore:s,value:{type:"page",id:t,spaceId:s.id},showPath:!Boolean(r)&&!Boolean(n),isCreateIn:i,onAccept:p})})),...a.slice(0,10).flatMap((e=>{let{blockId:t}=e;return $({spaceStore:s,value:{type:"page",id:t,spaceId:s.id},showPath:!m,isCreateIn:i,onAccept:p})})),...v.slice(0,10).flatMap((e=>{let{blockId:t}=e;return $({spaceStore:s,value:{type:"page",id:t,spaceId:s.id},showPath:!m,isCreateIn:i,onAccept:p})}))].slice(0,20).filter(A));T.length>0&&f.push({key:"blocks",render:e=>(0,W.jsx)(S().A,{...e,title:(0,W.jsx)(c().sA,{...J.suggestedTitle}),topBorder:f.length>0&&!Boolean(r)&&!Boolean(n)}),items:T});const b=d().oE(ne(m,i,p,l,t).filter(A));b.length>0&&f.push({key:"teams",render:e=>(0,W.jsx)(S().A,{...e,title:(0,W.jsx)(c().sA,{...J.teamspacesTitle}),topBorder:f.length>0}),items:b});const k=d().oE(y.slice(0,5).flatMap((e=>{let{blockId:t}=e;return $({spaceStore:s,value:{type:"page",id:t,spaceId:s.id},showPath:!0,isCreateIn:i,onAccept:p})})).filter(A));return k.length>0&&f.push({key:"templates",render:e=>(0,W.jsx)(S().A,{...e,title:n?(0,W.jsx)(c().sA,{defaultMessage:"Add from template",id:"moveBlockMenu.addFromTemplate.title"}):(0,W.jsx)(c().sA,{defaultMessage:"Move to template",id:"moveBlockMenu.moveToTemplate.title"}),topBorder:f.length>0}),items:k}),I.length&&(Boolean(r)||Boolean(n))&&f.push({key:"defaults",render:e=>(0,W.jsx)(S().A,{...e,topBorder:f.length>0}),items:I}),f}async function re(e,t,a,s,o,n,i,r){const{chosenSpaceStore:l,savedQuickAddParent:p,query:u,blockResults:m,recentPageResults:g}=e,{typedSuggestedMenuSection:h,typedSuggestedResults:y}=await se(u,t,a,s,i);if(O().Ay.state.isOpen&&"aggregated_type"===O().Ay.state.moveToContext)return[h].filter((e=>e.items.length>0));let v=k().Pk({recentPageResults:g,blockResults:m,suggestedPages:y});const f=new Set(k().rD(o));f.size>0&&(v=v.filter((e=>!f.has(e.blockId))));const x=d().hS(d().qI(d().oE([ae({query:u,savedQuickAddParent:p},n,a,s,i),...v.map((e=>{let{blockId:t}=e;return $({spaceStore:l,value:{type:"page",id:t,spaceId:l.id},showPath:!u,isCreateIn:a,onAccept:s})}))])),(e=>e.key)),A=d().oE(ne(u,a,s,i,r)).slice(0,Y),I=h.items.length>0,T={key:"teams",render:e=>(0,W.jsx)(S().A,{...e,desktopStyle:{paddingTop:I?0:6,paddingBottom:6},title:(0,W.jsx)(c().sA,{...J.teamspacesTitle})}),items:A},b=h.items.length>0&&0===T.items.length,j={key:"pages",render:e=>(0,W.jsx)(S().A,{...e,desktopStyle:{paddingTop:b?0:6,paddingBottom:6},title:(0,W.jsx)(c().sA,{...J.pagesTitle})}),items:x};return[h,T,j].filter((e=>e.items.length>0))}function ce(e){const{allTargetsAreNavigable:t,blockResults:a,chosenSpaceStore:s,environment:o,forceShowPrivatePageOption:n,intl:i,isAddTo:r,isCreateIn:l,moveToSpaceMenuStore:p,onAccept:u,query:m,recentPageResults:g,savedQuickAddParent:h,targets:y,theme:v}=e,f=function(e,t,a,s,o,n,i,r,l,p){const u=0===e.length&&t?(0,U().Fx)({spaceStore:t,targets:o}):[];return{key:"suggested",render:e=>(0,W.jsx)(S().A,{...e,title:(0,W.jsx)(c().sA,{...J.suggestedTitle})}),items:d().oE([oe({query:e,chosenSpaceStore:t},a,s,n,o,i,l,p),...u.filter((e=>k().zO(e,o))).flatMap((e=>$({spaceStore:t,value:{type:"page",id:e.id,spaceId:t.id},showPath:!1,isCreateIn:r,onAccept:i})))])}}(m,s,o,v,y,i,u,l,t,n),x=ee(O().Ay.state),A=[...g.slice(0,3),...a.slice(0,x)],I={key:"pages",render:e=>(0,W.jsx)(S().A,{...e,title:(0,W.jsx)(c().sA,{...J.pagesTitle})}),items:d().hS(d().qI(d().oE([ae({query:m,savedQuickAddParent:h},r,l,u,p),...A.map((e=>{let{blockId:t,collectionId:a}=e;return $({spaceStore:s,value:a?{type:"collection",id:a,spaceId:s.id}:{type:"page",id:t,spaceId:s.id},showPath:!m,isCreateIn:l,onAccept:u})}))])),(e=>e.key))},T={key:"teams",render:e=>(0,W.jsx)(S().A,{...e,title:(0,W.jsx)(c().sA,{...J.teamspacesTitle})}),items:d().oE(ne(m,l,u,p,t)).slice(0,10)};return[f,T,I].filter((e=>e.items.length>0))}function le(e,t){return!!t&&e.isTemplate()}function de(){return B().A.state.online}async function pe(e,t,a,s,o,n){let i,r;if(t&&de()){const a=await M().T.searchActions.load(),s=ee(O().Ay.state),r=await a.searchPageIds({environment:o,query:t,limit:s+1,spaceId:e.id,requireEditPermissions:!1,excludeTemplates:!1,source:"move_to_menu",boostRecentlyViewedPages:!0,spaceStore:n}),c=r.results.length>s;O().Ay.state.isOpen&&O().Ay.state.canLoadMore!==c&&O().Ay.setState({...O().Ay.state,canLoadMore:c}),i=r.results.map((e=>({blockId:e})))}else r=await m()._P(e,e.id);return ue({chosenSpaceStore:e,environment:o,isCreateIn:s,query:t,recentPageIds:r,searchResults:i,targets:a})}function ue(e){let{chosenSpaceStore:t,environment:a,isCreateIn:s,query:o,recentPageIds:n,searchResults:i,targets:c}=e;const l=[],d=[],p=[];let u=[];if(o&&i)for(const{blockId:m,collectionId:g}of i){const e=D().Bv.createChildStore(t.getPagesStore(),{table:r().ev,id:m});if(k().zO(e,c)){const t={blockId:e.id,collectionId:g};le(e,s)?p.push(t):l.push(t)}}else if(n){u=n.map((e=>({blockId:D().Bv.createChildStore(t.getPagesStore(),{table:r().ev,id:e}).id}))),u=u.filter((e=>{let{blockId:a}=e;const o=D().Bv.createChildStore(t.getPagesStore(),{table:r().ev,id:a});if(k().zO(o,c)){const e={blockId:o.id};return!le(o,s)||(p.push(e),!1)}}));const e=(0,I()._y)(a);for(const t of e)if(k().zO(t,c)){const e={blockId:t.id};le(t,s)?p.push(e):d.push(e)}}return{blockResults:l,topLevelBlockResults:d,templateResults:p,recentPageResults:u}}},478495:(e,t,a)=>{a.d(t,{Cr:()=>v,Fx:()=>S,VN:()=>f});a(517642),a(658004),a(733853),a(845876),a(432475),a(515024),a(731698),a(898992),a(823215),a(354520),a(581454),a(737550);var s=a(296540),o=()=>a(484714),n=()=>a(56366),i=()=>a(401497),r=()=>a(959013),c=()=>a(496603),l=()=>a(372657),d=()=>a(640653),p=()=>a(37433),u=()=>a(765957),m=()=>a(968172),g=()=>a(644434),h=()=>a(873643),y=a(474848);function v(e){const{spaceStore:t,spaceViewStore:a,targets:d,moveToPagesOnly:m,forceShowPrivatePageOption:v,onAccept:x}=e,A=(0,o().v3)(),I=(0,r().tz)(),T=(0,i().IS)((()=>({modal:{height:374,maxHeight:"70vh",paddingBottom:12},body:{width:"100%"}})),[]),{teams:b}=(0,p().S3)({fromCache:!0,includeArchived:!1,spaceStore:t}),k=(0,n().K8)((()=>{const e=a.getTeamsStores().filter((e=>e.canAddOrRemoveTopLevelPages()));return e.length>=7?e:c().hS([...e,...b],(e=>e.id)).filter((e=>e.canAddOrRemoveTopLevelPages())).slice(0,7)}),[b,a]),{teams:j}=(0,p().Sm)({spaceStore:t}),M=(0,n().K8)((()=>j.map((e=>{let{store:t}=e;return t})).filter((e=>e.canAddOrRemoveTopLevelPages())).slice(0,7)),[j]),w=(0,p().D5)(),P=(0,s.useMemo)((()=>w?M:k),[M,k,w]),C=(0,n().K8)((()=>S({spaceStore:t,targets:d})),[t,d]),B=(0,n().K8)((()=>{var e;return(null==a||null===(e=a.getWorkspacePages())||void 0===e?void 0:e.filter((e=>(0,l().zO)(e,d)&&e.canEdit())))??[]}),[a,d]),O=(0,n().O$)(u().AppStoreCurrentSpaceStore),D=(0,n().K8)((()=>{if(f({environment:A,targets:d,chosenSpaceStore:t,forceShowPrivatePageOption:v,currentSpaceStore:O}))return(0,y.jsx)(h().E,{spaceStore:t,spaceViewStore:a,store:void 0,depth:0,onAccept:x,targets:d,moveToPagesOnly:m},"MoveToModal private item")}),[A,x,d,t,a,m,v,O]);return t&&a?(0,y.jsx)("div",{style:T.modal,children:(0,y.jsx)("div",{style:T.body,children:(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,y.jsx)(g().J,{spaceStore:t,spaceViewStore:a,itemStores:C,addedItems:[D],moveToPagesOnly:m,depth:0,title:I.formatMessage({defaultMessage:"Suggested",id:"moveToModal.suggestedSection.title"}),onAccept:e.onAccept,targets:e.targets}),P&&P.length>0?(0,y.jsx)(g().J,{spaceStore:t,spaceViewStore:a,itemStores:P,moveToPagesOnly:m,depth:0,title:I.formatMessage({defaultMessage:"Teamspaces",id:"moveToModal.teamsSection.title"}),onAccept:e.onAccept,targets:e.targets}):void 0,B.length>0?(0,y.jsx)(g().J,{spaceStore:t,spaceViewStore:a,itemStores:B,moveToPagesOnly:m,depth:0,title:I.formatMessage({defaultMessage:"Workspace",id:"moveToModal.workspaceSection.title"}),onAccept:e.onAccept,targets:e.targets}):void 0]})})}):null}function S(e){let{spaceStore:t,targets:a}=e,s=m().A.getWithoutSubscribing(t.id).map((e=>{let{store:t}=e;return t})).filter((e=>(null==e?void 0:e.pathIsAccessibleAndAlive())&&!a.some((t=>"block"===t.table&&t.id===e.id))));const o=a.filter((e=>"block"===e.getParentTable())).map((e=>e.getParentId())),n=o.length===a.length,i=[...new Set(o)];return n&&1===i.length&&(s=s.filter((e=>e.id!==i[0]))),s.slice(0,7)}function f(e){let{environment:t,targets:a,chosenSpaceStore:s,forceShowPrivatePageOption:o,currentSpaceStore:n}=e;const i=(0,d().IL)(s),r=a.every((e=>e.isTopLevelPrivatePage())),c=n&&s.id!==n.id;return!i&&(o||c||!r)}},568999:(e,t,a)=>{a.d(t,{g:()=>s});const s=(0,a(340498).xh)("checkmarkCircle",{default:{loader:()=>a.e(44032).then(a.bind(a,671089))},small:{loader:()=>a.e(44032).then(a.bind(a,833243))},fill:{loader:()=>a.e(44032).then(a.bind(a,209969))},fillSmall:{loader:()=>a.e(44032).then(a.bind(a,450424))}},["check","mark","tick","confirm","approve"])},644434:(e,t,a)=>{a.d(t,{J:()=>g});a(581454),a(296540);var s=()=>a(56366),o=()=>a(401497),n=()=>a(700500),i=()=>a(496603),r=()=>a(284371),c=()=>a(805751),l=()=>a(125565),d=()=>a(372657),p=()=>a(630116),u=()=>a(873643),m=a(474848);function g(e){const{spaceStore:t,spaceViewStore:a,itemStores:g,depth:h}=e,y=(0,s().K8)((()=>{const s=g?i().oE(g.map((s=>{if(s instanceof p().h4&&s.canAddOrRemoveTopLevelPages()||s instanceof p().Bv&&(0,d().zO)(s,e.targets)&&s.canEdit()){const o=s instanceof p().Bv&&s.getType()===n().xd.alias,i=o?s.getAliasTargetStore():void 0,r=i instanceof p().Bv?i:s;return(0,m.jsx)(u().E,{spaceStore:t,spaceViewStore:a,store:r,depth:h,onAccept:e.onAccept,targets:e.targets,isAlias:o,moveToPagesOnly:e.moveToPagesOnly},s.id)}}))):[];return e.addedItems?[...e.addedItems,...s]:s}),[g,e.addedItems,e.moveToPagesOnly,e.targets,e.onAccept,t,a,h]),v=(0,o().IS)((e=>({sectionHeader:{color:e.text.secondary,fontSize:12,fontWeight:r().Wy.medium,padding:"12px 14px 4px 14px"}})),[]);return(0,m.jsxs)(c().A,{debugName:"MoveToOutliner",capture:!0,allowEsc:!0,allowLeft:!0,children:[e.title?(0,m.jsx)("div",{style:v.sectionHeader,children:(0,m.jsx)(l().A,{isSmall:!0,children:e.title})}):void 0,(0,m.jsx)("div",{children:y})]})}},828048:(e,t,a)=>{a.d(t,{C:()=>Se,m:()=>fe});a(16280),a(898992),a(823215),a(581454);var s=a(296540),o=()=>a(484714),n=()=>a(56366),i=()=>a(401497),r=()=>a(584262),c=()=>a(97789),l=()=>a(484392),d=()=>a(568999),p=()=>a(617668),u=()=>a(406533),m=()=>a(721479),g=()=>a(919709),h=()=>a(959013),y=()=>a(496603),v=()=>a(534177),S=()=>a(750660),f=()=>a(44729),x=()=>a(246826),A=()=>a(857783),I=()=>a(319975),T=()=>a(812182),b=()=>a(751156),k=()=>a(767435),j=()=>a(895876),M=()=>a(201440),w=()=>a(760217),P=()=>a(285790),C=()=>a(298697),B=()=>a(939740),O=()=>a(8980),D=()=>a(89924),L=()=>a(859428),N=()=>a(186445),R=()=>a(372657),E=()=>a(162674),V=()=>a(957963),_=()=>a(493823),K=()=>a(623580),q=()=>a(676007),z=()=>a(754002),W=()=>a(204063),F=()=>a(124749);class H extends(()=>a(757695))().Store{getInitialState(){return!1}}const $=new H;var U=a(474848);const G=(0,h().YK)({title:{id:"tasksCreateNewDatabase.modal.title",defaultMessage:"How would you like to name your private task database?"},placeholder:{id:"tasksCreateNewDatabase.modal.placeholder",defaultMessage:"{username}'s to-do list"},create:{id:"tasksCreateNewDatabase.modal.create",defaultMessage:"Create database"},cancel:{id:"tasksCreateNewDatabase.modal.cancel",defaultMessage:"Cancel"}}),Y=380,J=24;function Q(e){const{handleCreateTaskDatabase:t}=e,a=(0,h().tz)(),r=(0,F().$)(),c=(0,n().K8)((()=>null==r?void 0:r.getDisplayName(a)),[r,a]),l=(0,o().Y0)(),[d,p]=(0,s.useState)(""),u=(0,n().O$)($),m=(0,i().IS)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:`${J}px`,width:Y},editPropertyTypeIcon:{width:32,height:32,fill:e.text.tertiary},title:{color:e.text.primary,textAlign:"center"},input:{width:"100%",height:36,fontSize:16,marginTop:16,marginBottom:`${J}px`},createButton:{width:"100%",height:36,fontSize:16,marginBottom:16},cancelButton:{color:e.text.secondary,fontSize:16}})),[]),g=(0,s.useCallback)((()=>{d.trim()&&(t(d),$.setState(!1))}),[d,t]),y=(0,s.useCallback)((()=>{$.setState(!1)}),[]),v=(0,s.useCallback)((e=>{"Enter"===e.key&&g()}),[g]),S=(0,s.useCallback)((e=>{p(e.target.value)}),[p]),f=(0,s.useCallback)((()=>(0,U.jsxs)("div",{style:m.container,children:[(0,U.jsx)("div",{children:(0,V().j)(m.editPropertyTypeIcon)}),(0,U.jsx)("h3",{style:m.title,children:a.formatMessage(G.title)}),(0,U.jsx)(K().A,{value:d,onChange:S,placeholder:a.formatMessage(G.placeholder,{username:c}),style:m.input,autoFocus:!0,onKeyDown:v}),(0,U.jsx)(W().A,{style:m.createButton,onClick:g,children:a.formatMessage(G.create)}),(0,U.jsx)(_().p,{style:m.cancelButton,onClick:()=>{$.setState(!1)},children:a.formatMessage(G.cancel)})]})),[d,c,S,v,g,a,m.cancelButton,m.container,m.createButton,m.editPropertyTypeIcon,m.input,m.title]);return u?l.isPhone?(0,U.jsx)(z()._,{fullscreen:!0,renderInner:f}):(0,U.jsx)(q().a,{open:!0,showCloseIcon:!0,onDismiss:y,render:f}):null}var X=()=>a(610101),Z=()=>a(962730),ee=()=>a(765957),te=()=>a(832820),ae=()=>a(188669),se=()=>a(187174),oe=()=>a(519831),ne=()=>a(630116),ie=()=>a(449506);var re=()=>a(271372),ce=()=>a(645873),le=()=>a(963589),de=()=>a(106628),pe=()=>a(361330);function ue(e){let{environment:t,spaceStore:a,joinedTeamIds:s,parentStore:o,moveToTargets:i,overrideDatabaseType:r}=e;const c=(0,n().K8)((()=>{const e=null==a?void 0:a.id;if(e)return function(e){if(!te().c.state)return;if(e!==te().c.state.spaceId)return;return te().c.state.typedDatabases}(e)}),[null==a?void 0:a.id]),l=(0,le().X)("typed_move_to_improved_default_results"),d=(0,ce().fJ)(de().T.searchActions),[{value:p,status:u}]=(0,se().Yb)((async()=>{if(c)return c;if(!a||!o)return;const e=r??ae().Ay.getDatabaseType();if(!e)return;if("resolved"!==d.status)return;const n=d.value;let p=[];if(l){const s=((await n.searchCollectionsWithRecents({environment:t,query:"",limit:20,databaseType:[e],spaceStore:a,parentStore:a,collectionViewBlockStore:void 0,searchSessionId:ae().Ay.state.isOpen?ae().Ay.state.flowId:void 0})).results||[]).map((e=>ne().md.createChildStore(o,{table:oe().Vl,id:e})));p=(0,re().vl)({typedDatabases:s,blocksToFilterParents:i})}else{const n=await async function(e){let{environment:t,spaceId:a,databaseType:s,parentStore:o}=e;if(!a)return;const n=await ie().callApi({eventName:"getTypedDatabases",environment:t,data:{spaceId:a,databaseType:s}});return"success"===n.type?n.data.result.map((e=>ne().md.createChildStore(o,{table:oe().Vl,id:e.collectionId}))):void 0}({environment:t,spaceId:a.id,databaseType:e,parentStore:o})??[];p=(0,re().gq)({environment:t,typedDatabases:n,spaceStore:a,joinedTeamIds:s})}return te().c.setState({typedDatabases:p,spaceId:a.id}),ae().Ay.update((e=>e.isOpen&&"untyped"===e.variant?{...e,variant:"typed"}:e)),p}),[c,a,o,r,d.status,d.value,l,t,i,s],{debounce:pe().tu,throttle:pe().tu});return c?{success:!0,typedDatabases:c}:"resolved"===u&&p?{success:!0,typedDatabases:p}:{success:!1}}var me=()=>a(258805),ge=()=>a(478495),he=()=>a(139466),ye=()=>a(873643);const ve=7;function Se(e){const{spaceStore:t,spaceViewStore:a,targets:m,menuListStore:P,onAccept:L,moveToPagesOnly:V,forceShowPrivatePageOption:_,maxMenuItems:K=ve}=e,q=(0,o().v3)(),z=(0,h().tz)(),W=(0,i().DP)(),{isMyTasksFullPage:F,currentSpaceStore:H}=(0,n().K8)((()=>{const e=ee().default.state.mainEditorCurrentBlockStore,t=ee().default.state.currentSpaceStore;return{isMyTasksFullPage:Boolean(e&&(0,N().sj)(e.id)),currentSpaceStore:t}}),[]),G=(0,n().K8)((()=>a.getTeamsStores().map((e=>e.id))),[a]),Y=(0,n().K8)((()=>ae().Ay.getDatabaseType()),[]),J=(0,n().K8)((()=>R().Hc()),[]),Z=ue({environment:q,spaceStore:t,parentStore:t,joinedTeamIds:G,moveToTargets:m}),se=(0,i().IS)((e=>({modal:{maxHeight:"70vh"},loadingShimmer:{padding:16},privateMenuItem:{marginLeft:4,marginRight:4,borderRadius:4},menuItemFooterButton:{color:e.text.secondary,fill:e.icon.secondary}})),[]),oe=(0,s.useCallback)((e=>{const a={key:e.id,render:a=>(0,U.jsx)(he().d,{spaceStore:t,collectionStore:e,menuListItemProps:a}),action:()=>L({type:"collection",id:e.id,spaceId:t.id})};return a}),[t,L]),ne=(0,n().K8)((()=>Z.success?Z.typedDatabases.map((e=>oe(e))):[]),[Z,oe]);(0,s.useEffect)((()=>{0===ne.length&&ae().Ay.setState({...ae().Ay.state,variant:"untyped"})}),[ne.length]);const ie=(0,n().K8)((()=>(0,ge().VN)({environment:q,targets:m,chosenSpaceStore:t,forceShowPrivatePageOption:_,currentSpaceStore:H})),[q,_,t,m,H]),re=(0,n().K8)((()=>{const{isMobile:e}=q.device;if(e){const e=m.every((e=>e.isNavigableBlock()));return(0,me().oG)({query:"",chosenSpaceStore:t},q,W,z,m,L,e,_)}return{key:"privateMenuItem",render:e=>(0,U.jsx)("div",{style:se.privateMenuItem,children:(0,U.jsx)(ye().E,{spaceStore:t,spaceViewStore:a,store:void 0,depth:0,onAccept:L,targets:m,moveToPagesOnly:V,menuListItemProps:e,from:"moveToModalTyped"})}),action:()=>{}}}),[q,_,z,V,L,t,a,se.privateMenuItem,m,W]),ce=F?"home_tasks":"home_tile_tasks",le=(0,s.useMemo)((()=>({key:"helpMenuItem",render:()=>(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(M().CollectionTasksEmptyStateModal,{from:ce}),(0,U.jsx)(w().A,{style:se.menuItemFooterButton,icon:(0,U.jsx)(O().I,{icon:u().questionMarkCircleIcon}),focused:!1,title:(0,U.jsx)(h().sA,{defaultMessage:"Don’t see your database?",id:"moveToModalTyped.helpMenuItem.title"}),onClick:()=>{X().A.setState(!0),(0,E().bS)({environment:q,from:ce})}})]}),action:()=>{}})),[q,ce,se.menuItemFooterButton]),de=(0,s.useCallback)((e=>{let s,o;b().createAndCommit({userAction:"moveToModalTyped.handleCreateTodoList",environment:q,canUndo:!0,perform:function(n){s=x().Wv({environment:q,transaction:n,type:"collection_view",inMemoryRecordCache:q.defaultRecordCache.inMemoryRecordCache}),f().NI({childStore:s,parentStore:t,transaction:n});const i=k().initializeApp({environment:q,spaceViewStore:a,appUri:c().a6,presetUri:"notion://tasks_collection_typedDBpreset",appParentStore:t,temporaryContainerBlockStore:s,transaction:n,from:"my_tasks",skipNavigation:!0});o=null==i?void 0:i[0].getCollectionStore(),o&&I().R9({environment:q,store:o.getNameStore(),value:(0,g().x9d)(e),transaction:n}),T().HK({id:"database_creation_toast",title:z.formatMessage({id:"moveToModalTyped.databaseCreated.title",defaultMessage:"Database created"}),message:z.formatMessage({id:"moveToModalTyped.databaseCreated.message",defaultMessage:'"{name}" has been created'},{name:e}),presentationType:"persistent",iconGroup:d().g,iconGroupColorName:"greenPrimary",actions:{primary:{title:z.formatMessage({id:"moveToModalTyped.databaseCreated.openDatabase",defaultMessage:"Open database"}),onAction:()=>{A().uK({environment:q,store:null==i?void 0:i[0],pageVisitSource:r().y8.PersonalHomePage}),T().UW("database_creation_toast")}}}})}}),o&&(0,te().D)(o),S().VN({environment:q,clearSelection:!0})}),[q,z,t,a]),pe=(0,s.useMemo)((()=>({key:"createDatabaseItem",render:()=>(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Q,{handleCreateTaskDatabase:de}),(0,U.jsx)(w().A,{style:se.menuItemFooterButton,icon:(0,U.jsx)(O().I,{icon:p().plusIcon}),focused:!1,title:(0,U.jsx)(h().sA,{defaultMessage:"New private task database",id:"moveToModalTyped.createDatabaseItem.title"}),onClick:()=>{$.setState(!0)}})]}),action:()=>{}})),[de,se.menuItemFooterButton]);if(!Z.success||0===ne.length)return(0,U.jsx)("div",{style:se.loadingShimmer,children:(0,U.jsx)(C().A,{paragraphs:[{lineHeight:18,lineMargin:4,sectionWidths:[100],repeat:1,sectionMargin:0},{lineHeight:14,lineMargin:4,sectionWidths:[100,40],repeat:1,sectionMargin:-2}]})});if(!Y)throw new Error("Trying to show typed moveTo modal when database type is not available.");const Se=(0,j().$O)(Y),xe=y().oE([{key:"suggested",render:e=>(0,U.jsx)(D().A,{...e,title:J?(0,U.jsx)(h().sA,{defaultMessage:"{typedItemName} databases",id:"moveToModalTyped.suggestedMenuSection.title",values:{typedItemName:(0,l().A)(Se)}}):(0,U.jsx)(h().sA,{defaultMessage:"Where would you like to create your {typedItemName}?",id:"moveToModalTyped.suggestedMenuSection.titleNew",values:{typedItemName:Se}}),right:J?(0,U.jsx)(fe,{typedItemName:Se}):null}),items:ne.slice(0,K)},ie&&(0,v().O9)(re)&&{key:"other",render:e=>(0,U.jsx)(D().A,{...e,title:(0,U.jsx)(h().sA,{defaultMessage:"Other",id:"moveToModalTyped.otherSection.title"})}),items:[re]},!J&&{key:"create-new-footer",render:e=>(0,U.jsx)(D().A,{...e,topBorder:!0}),items:[le,pe]}]);return(0,U.jsx)("div",{style:se.modal,children:(0,U.jsx)(B().Ay,{initialFocus:0,type:B().Oh.Vertical,sections:xe||[],store:P})})}function fe(e){const{typedItemName:t}=e,a=(0,h().tz)(),{isMobile:s}=(0,o().Y0)(),n=(0,i().IS)((e=>({tooltip:{width:220},icon:{width:16,height:16,fill:e.icon.secondary},iconButton:{height:18,width:18,padding:0,marginTop:-4,marginBottom:-4,marginRight:-4}})),[]);return s?null:(0,U.jsx)(L().A,{placement:Z().W.Bottom,style:n.tooltip,textWrap:!0,renderTooltip:()=>(0,U.jsx)(h().sA,{defaultMessage:"{typedItemName} properties will be kept when moving to these locations",id:"moveTypedMenu.tooltip",values:{typedItemName:(0,l().A)(t)}}),render:e=>(0,U.jsx)(P().A,{ariaLabel:a.formatMessage({id:"moveToModalTyped.helpIcon.ariaLabel",defaultMessage:"Help icon for moving typed pages."}),icon:m().questionMarkCircleSmallIcon,iconStyle:n.icon,style:n.iconButton,...e})})}},832820:(e,t,a)=>{a.d(t,{D:()=>o,c:()=>s});const s=a(757695).Store.createValue(void 0,{name:"CachedTypedDatabasesStore"});function o(e){const t=s.state;t&&s.setState({...t,typedDatabases:[...t.typedDatabases,e]})}},873643:(e,t,a)=>{a.d(t,{E:()=>B});a(517642),a(658004),a(733853),a(845876),a(432475),a(515024),a(731698);var s=a(296540),o=()=>a(484714),n=()=>a(56366),i=()=>a(401497),r=()=>a(700500),c=()=>a(315564),l=()=>a(449552),d=()=>a(500066),p=()=>a(179034),u=()=>a(854150),m=()=>a(959013),g=()=>a(95313),h=()=>a(704152),y=()=>a(187820),v=()=>a(16006),S=()=>a(453697),f=()=>a(606273),x=()=>a(186445),A=()=>a(396301),I=()=>a(188669),T=()=>a(630116),b=()=>a(898808),k=()=>a(644434),j=a(474848);const M=100,w=14,P=24;function C(e){return(e+1)*w}function B(e){const{store:t,spaceStore:a,spaceViewStore:w,depth:B,isAlias:O,menuListItemProps:D,from:L}=e,N=(0,o().v3)(),R=(0,i().DP)(),[E,V]=s.useState(!1),_=(0,i().IS)((e=>({noChildrenLabelItem:{paddingLeft:C(B)+P,fontSize:14,paddingBottom:6.5,color:e.text.tertiary},outlinerItem:{display:"flex",flexDirection:"row",fontSize:14,height:28,paddingLeft:"moveToModalTyped"===L?C(B)-4:C(B),color:e.text.primary,alignItems:"center"},icon:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,flexGrow:0,width:22,height:18,marginRight:4,position:"relative"},button:{..."moveToModalTyped"===L?{borderRadius:4}:{}}})),[B,L]);function K(){const e=I().Ay.state,a=e.isOpen?e.flowId:void 0;V(!E),g().aM(N,{flowId:a,is_toggled:!E,destination_type:t?t.table:"private_pages"})}const q=(0,n().K8)((()=>{if(t){const e=(0,j.jsx)("div",{children:(0,d().G)({position:"absolute",width:"50%",height:"50%",right:0,bottom:0})});return t instanceof T().h4?(0,j.jsx)("div",{style:_.icon,children:(0,j.jsx)(b().x,{disabled:!0,store:t,size:18})}):(0,j.jsxs)("div",{style:_.icon,children:[(0,j.jsx)(y().B6,{icon:t.getIcon(),iconRecordCategory:(0,y().Te)(t),isEmptyPage:t.isEmptyPage(),size:18,disabled:!0}),O?e:void 0]})}return(0,j.jsx)(S().A,{size:16,userStore:(0,x()._m)(N),style:{marginLeft:3}})}),[t,_.icon,N,O]),z=(0,n().K8)((()=>t?t.table===u().yK?"private"!==t.getTeamAccessLevel()?(0,j.jsx)("div",{style:{maxWidth:"80%"},children:(0,j.jsx)(v().A,{store:t})}):(0,j.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",maxWidth:"80%"},children:[(0,j.jsx)(v().A,{store:t}),(0,l().g)({width:14,height:14,marginLeft:4,fill:R.icon.secondary})]}):(0,j.jsx)("div",{style:{maxWidth:"80%"},children:(0,j.jsx)(v().A,{store:t})}):(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center",marginLeft:7},children:[(0,j.jsx)(m().sA,{defaultMessage:"Private pages",id:"outliner.addToPrivatePages"}),(0,j.jsx)("div",{style:{marginLeft:2},children:(0,c().S)({width:14,height:14,fill:R.icon.secondary,marginLeft:4})})]})),[t,R.icon.secondary]),W=(0,n().K8)((()=>{const e=new Set([r().xd.page,r().xd.collectionViewPage,r().xd.collectionView,r().xd.alias]),a=new Set([r().xd.factory]);let s=[];return t?t instanceof T().h4?s=t.getTeamPagesStores():t instanceof T().Bv&&(s=(0,A().yD)({rootStore:t,shouldSkipItemTypes:a,shouldShowItemTypes:e})):s=w.getPrivatePages(N)??[],s}),[t,w,N]);const F=0!==W.length?(0,j.jsx)(k().J,{spaceStore:a,spaceViewStore:w,itemStores:W,depth:B+1,onAccept:e.onAccept,targets:e.targets}):(0,j.jsx)("div",{style:_.noChildrenLabelItem,children:(0,j.jsx)(m().sA,{defaultMessage:"No pages inside",id:"outliner.NoPagesInside.placeholder"})});return(0,j.jsxs)("div",{...D,children:[(0,j.jsx)(h().A,{onClick:function(){e.moveToPagesOnly&&(null==t?void 0:t.table)!==p().ev?K():t?t instanceof T().Bv?e.onAccept({type:"page",id:t.id,spaceId:a.id}):e.onAccept({type:"team",id:t.id,spaceId:a.id}):e.onAccept({type:"space-private-pages",spaceId:a.id})},style:_.button,children:(0,j.jsxs)("div",{style:_.outlinerItem,children:[(0,j.jsx)(f().f,{isSidebar:!0,fill:!0,icon:"chevron",open:E,color:R.icon.secondary,onClick:K}),q,z]})}),E&&B<M?F:void 0]})}}}]);