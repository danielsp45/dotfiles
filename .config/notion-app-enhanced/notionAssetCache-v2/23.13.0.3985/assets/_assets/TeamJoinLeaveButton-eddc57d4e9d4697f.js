"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[209],{149257:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(296540),s=()=>a(959013),r=a(474848);const o=(0,s().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const i=function(e){const{teamStore:t,teamName:i,teamId:u,isModalOpen:l,onDismiss:d}=e,[m,c]=(0,n.useState)(""),g=(0,a(484714).v3)(),p=(0,s().tz)(),v=async()=>{await a(350648).Ip({environment:g,teamId:u,message:m}),d()},S=(0,a(401497).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,r.jsx)(a(676007).a,{open:l,onDismiss:d,innerStyle:S.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:S.requestTitle,children:(0,r.jsx)(s().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:i,icon:(0,r.jsx)(a(898808).x,{style:S.icon,store:t,disabled:!0,size:22})}})}),(0,r.jsx)(a(623580).A,{textarea:!0,style:S.input,value:m,onChange:e=>{c(e.target.value)},placeholder:p.formatMessage(o.message_placeholder)}),(0,r.jsxs)("div",{style:S.footer,children:[(0,r.jsx)(a(125565).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,r.jsx)(s().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,r.jsx)(a(204063).A,{size:"lg",style:S.requestInvitesButton,onClick:v,children:(0,r.jsx)(s().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},211825:(e,t,a)=>{a.d(t,{G:()=>o});var n=()=>a(484714),s=()=>a(56366),r=()=>a(486130);function o(e){const t=(0,n().v3)().currentUser.id;return(0,s().K8)((()=>Boolean(void 0!==t&&e.isNonGuestMember(t,r()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()})))),[t,e])}},341974:(e,t,a)=>{a.r(t),a.d(t,{TeamJoinLeaveButton:()=>y});var n=a(296540),s=()=>a(484714),r=()=>a(56366),o=()=>a(401497),i=()=>a(284371),u=()=>a(640653),l=()=>a(37433),d=()=>a(515512),m=()=>a(211825),c=()=>a(959013),g=()=>a(493823),p=a(474848);const v=function(e){const{teamStore:t,from:o,navigateToTeamHomeOnJoin:i,style:u,hoveredStyle:l,icon:d,isRed:m}=e,v=(0,s().v3)(),S=(0,r().O$)(a(765957).AppStoreCurrentSpaceStore),f=(0,n.useCallback)((async()=>{S&&await a(848237).e2({environment:v,teamStore:t,currentSpaceStore:S,from:o,andNavigateToTeamHome:i??!1})}),[S,v,t,o,i]);return(0,p.jsx)(g().p,{style:u,hoveredStyle:l,onClick:f,iconLeading:d,isRed:m,children:(0,p.jsx)(c().sA,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var S=()=>a(655784);const f=function(e){const{teamStore:t,style:s,hoveredStyle:o}=e,[i,u]=(0,n.useState)(!1),l=(0,r().K8)((()=>t.getName()),[t]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(g().p,{style:s,hoveredStyle:o,onClick:()=>u(!0),children:(0,p.jsx)(c().sA,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,p.jsx)(a(149257).A,{teamStore:t,teamName:l,teamId:t.id,isModalOpen:i,onDismiss:()=>u(!1)})]})};function y(e){const{teamStore:t,style:a,hoveredStyle:n}=e,c=(0,s().v3)(),g=(0,d().Q)(),y=(0,m().G)(t),T=(0,r().K8)((()=>t.getTeamAccessLevel()),[t]),h=(0,o().IS)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:i().Wy.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...a},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...n}})),[a,n]),I=(0,r().K8)((()=>(0,l().A2)({membership:t.getRawMembership()})&&(0,u().s7)(c)),[c,t]),w=!y&&"open"===T||I,b=!y&&"closed"===T;return g?null:y?(0,p.jsx)(S().A,{...e,style:h.joinTeamButton,hoveredStyle:h.joinTeamButtonHoveredStyle}):w?(0,p.jsx)(v,{...e,style:h.joinTeamButton,hoveredStyle:h.joinTeamButtonHoveredStyle}):b?(0,p.jsx)(f,{teamStore:t,style:h.joinTeamButton,hoveredStyle:h.joinTeamButtonHoveredStyle}):null}},350648:(e,t,a)=>{a.d(t,{D2:()=>A,Ip:()=>I,Jk:()=>w,YT:()=>b,e2:()=>T,g:()=>h});a(517642),a(658004),a(733853),a(845876),a(432475),a(515024),a(731698),a(898992),a(354520);var n=()=>a(584262),s=()=>a(798880),r=()=>a(946141),o=()=>a(449506),i=()=>a(246826),u=()=>a(436572),l=()=>a(426116),d=()=>a(751156),m=()=>a(972435),c=()=>a(640653),g=()=>a(37433),p=()=>a(765957),v=()=>a(999830),S=()=>a(848237),f=()=>a(263928);const y=(0,a(959013).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function T(e){let{environment:t,userId:a,teamStore:n,user:s}=e;const o=n.getSpaceId();if(!o)return;await S().rU({environment:t,teamId:n.id,spaceId:o,teamUserInfo:s,isSettingDefaultTeam:!1,inviterId:a})&&(r().vo(t,{store:n,joined_role:"member",from:"team_invite_link"}),await h({environment:t,userId:a,teamStore:n}),u().D6({label:m().A.formatMessage(y.joinTeamSuccessMessage,{teamName:n.getName()})}))}async function h(e){let{environment:t,userId:a,teamStore:s}=e;const r=p().default.state.currentUserRootStore,o=s.getSpaceId();if(!o||!r)return;const i=r.getSpaceViewStores().filter((e=>e.getSpaceId()===o))[0];await l().tR({environment:t,spaceViewStore:i,userSettingsStore:void 0,userRootStore:r,pageVisitSource:n().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),(0,g().Qn)()?v().q.fetchUnfetchedTeams({userId:a,spaceId:o,teamTypes:new Set(["Joined"]),environment:t,callGetTeamsV2ApiFn:g().FK}):await f().J({environment:t,spaceId:o,userId:a}),S().L0({environment:t,teamStore:s,shouldScroll:!0})}async function I(e){let{environment:t,teamId:a,message:n}=e;if(!t.currentUser.id)return;"success"===(await o().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:a,message:n}})).type?(r().XQ(t,{teamId:a}),await b({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{u().D6({label:m().A.formatMessage(y.requestTeamSuccessMessage)})}))):u().D6({label:m().A.formatMessage(y.requestTeamFailureMessage)})}async function w(e){let{environment:t,teamStore:a,accessRequestStore:n,status:o}=e;const u=n.getForActorId();if(!u)return;const l=n.getRecordModel({table:s().oo,id:u});if(l){if("approved"===o){const e=[{type:"member",entity_type:"user",user_id:l.id}];if(!(await S().Zd({environment:t,teamStore:a,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}d().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{i().zv({store:n,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:s().oo,resolved_by_id:t.currentUser.id,status:o}})}}),r().GW(t,{store:a,resolution:o})}}async function b(e){let{environment:t}=e;const{lastVisitedSpaceView:a,userRootStore:s,userSettingsStore:r}=await(0,c().ex)({environment:t,disableRedirectUrl:!1});a?await l().tR({environment:t,spaceViewStore:a,userRootStore:s,userSettingsStore:r,pageVisitSource:n().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await l().t9({environment:t,userRootStore:s,userSettingsStore:r,pageVisitSource:n().y8.BackForward})}async function A(e){let{environment:t,teamId:a}=e;const n=await o().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:a}});if("success"===n.type)return n.data}},418426:(e,t,a)=>{a.d(t,{$:()=>u});a(898992),a(354520),a(581454);var n=()=>a(484714),s=()=>a(56366),r=()=>a(468006),o=()=>a(605402),i=()=>a(486130);function u(e){const t=(0,n().v3)().currentUser.id;return(0,s().K8)((()=>{if(!e.isDefined())return[];return(0,r().ri)({rawMembers:e.getRawMembership(),groupsInSpace:o().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))}).filter((a=>i()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()}).has(a.getGroupId())))}),[t,e])}},515512:(e,t,a)=>{a.d(t,{Q:()=>i});var n=()=>a(484714),s=()=>a(56366),r=()=>a(640653),o=()=>a(765957);function i(){const e=function(){const e=(0,n().v3)();return(0,s().K8)((()=>{const t=o().default.state.currentSpaceStore;if(!t)return{loading:!0};if(!r().IL(t))return{loading:!1,isUserTeamGuestOfSpace:!1};const a=o().default.state.currentSpaceViewStore;if(!a||!e.currentUser.id)return{loading:!0};const n=r().vb({userId:e.currentUser.id,spaceViewStore:a});return n.isLoaded?{loading:!1,isUserTeamGuestOfSpace:n.isTeamGuestInSpace}:{loading:!0}}),[e])}();return(0,s().K8)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},655784:(e,t,a)=>{a.d(t,{A:()=>d});a(581454);var n=a(296540),s=()=>a(484714),r=()=>a(56366),o=()=>a(959013),i=()=>a(496603),u=()=>a(418426),l=a(474848);const d=function(e){const{teamStore:t,from:d,onLeavingTeam:m,style:c,hoveredStyle:g,icon:p,isRed:v,placement:S,alignment:f,buttonInternals:y}=e,T=(0,s().v3)(),h=(0,r().O$)(a(765957).AppStoreCurrentSpaceStore),I=(0,u().$)(t),w=(0,n.useCallback)((async()=>{if(!h)return;await a(848237).JC({environment:T,teamStore:t,from:d,userGroupsInTeam:I})&&(null==m||m())}),[h,T,t,d,I,m]),b=(0,l.jsx)(o().sA,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),A=function(e){let{teamStore:t}=e;const a=(0,s().v3)(),n=a.currentUser.id,{isDefaultTeam:d}=(0,r().K8)((()=>({isDefaultTeam:t.isDefault()})),[t]),m=(0,u().$)(t),c=(0,r().K8)((()=>{if(!t.isReady())return!1;const{ownerUserIds:e,ownerGroupIds:a}=t.getAllOwnerIds();return Boolean(n&&t.isOwner(n)&&e.length+a.length===1)}),[t,n]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:a,userGroupsInTeam:n}=e;if(t)return(0,l.jsx)(o().sA,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You can’t leave this teamspace because everyone in the workspace must be a member"});if(a)return(0,l.jsx)(o().sA,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(n.length>0)return(0,l.jsx)(o().sA,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:i().oE(n.map((e=>e.name))).join()}})}({isDefaultTeam:d,isOnlyTeamOwner:c,userGroupsInTeam:m})}({teamStore:t}),j=Boolean(A),M=j?A:b;return(0,l.jsx)(a(859428).A,{style:j?{width:240}:void 0,disableTooltip:!Boolean(M),renderTooltip:e=>(0,l.jsx)("div",{...e,children:M}),textWrap:j,placement:S,alignment:f,render:e=>(0,l.jsx)(a(493823).p,{...e,style:c,hoveredStyle:g,onClick:w,disabled:j,disabledFeedback:j,iconLeading:p,isRed:v,children:y||(0,l.jsxs)(l.Fragment,{children:[(0,a(831310).o)({width:12.5,marginRight:4}),(0,l.jsx)(o().sA,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}}}]);