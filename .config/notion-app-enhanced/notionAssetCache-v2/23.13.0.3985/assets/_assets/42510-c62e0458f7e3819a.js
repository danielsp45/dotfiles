"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[42510],{94522:(e,t,n)=>{n.d(t,{Cq:()=>o});n(16280),n(898992),n(354520);function o(e){const{workflowPointer:t,threadPointer:n}=e,o=t??n;if(!o)throw new Error("No workflow definition pointer found");return o}},168345:(e,t,n)=>{n.d(t,{L:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 3.13 15.26 14.86",svg:(0,n(474848).jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})},i=(0,n(340498).wt)("comment",o)},179747:(e,t,n)=>{n.d(t,{bi:()=>y,l$:()=>w,r0:()=>v});n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(401497),a=()=>n(959013),l=()=>n(751156),s=()=>n(84817),d=()=>n(493823),c=()=>n(8178),u=()=>n(963589),f=()=>n(847),g=()=>n(691093),p=()=>n(614842),m=()=>n(981928),h=n(474848);function w(e){var t;const{blockStore:n,workflowStore:u,workflow:w}=e,v=(0,i().v3)(),y=(0,a().tz)(),x=(0,o.useCallback)((e=>{(0,g().showWorkflowEditor)({environment:v,parentStore:n,navigationState:{isOpen:!0,type:"module",id:e}})}),[v,n]),C=(0,o.useCallback)((e=>{const t=e?JSON.parse(e):void 0;l().createAndCommit({userAction:"WorkflowPageBlock.WorkflowDebugPopupContent.handleSave",environment:v,canUndo:!0,perform:e=>{(0,f().overrideWorkflowData)({workflowStore:u,workflow:t,transaction:e})}})}),[v,u]),M=(0,o.useMemo)((()=>k(w)),[w]),I=(0,r().IS)((e=>({settingHeader:{paddingLeft:16,marginBottom:2,marginTop:8},buttonContainer:{paddingLeft:12,paddingRight:12},icon:{width:20,height:20}})),[]);return(0,h.jsxs)(s().Y1,{direction:"vertical",width:"fill",height:"fill",children:[(0,h.jsx)(c().A,{divider:"full",style:I.settingHeader,children:"All modules"}),(0,h.jsx)(s().Y1,{direction:"vertical",gap:8,style:I.buttonContainer,children:null===(t=w.modules)||void 0===t?void 0:t.map((e=>(0,h.jsx)(d().p,{onClick:()=>x(e.id),iconLeading:p().d.getIcon(e.type),iconStyle:I.icon,children:p().d.getName(e,y)},e.id)))}),(0,h.jsx)(c().A,{divider:"full",style:I.settingHeader,children:"Misc tools"}),(0,h.jsx)(c().A,{divider:"full",style:I.settingHeader,children:"Full debug object"}),(0,h.jsx)(m().X,{value:M,onSave:C,language:"json"})]})}function k(e){return JSON.stringify(e,null,2)}function v(e){const{children:t}=e,[n,i]=(0,o.useState)(!1),l=(0,u().X)("workflows_debug_tools"),s=(0,r().IS)((e=>({container:{display:"flex",flexDirection:"column",gap:4,borderTop:`1px solid ${e.palette.gray[100]}`,marginTop:12,paddingTop:8}})),[]),c=(0,o.useCallback)((()=>i((e=>!e))),[]);return l?(0,h.jsxs)("div",{style:s.container,children:[(0,h.jsx)(d().p,{onClick:c,isGray:!0,children:n?(0,h.jsx)(a().sA,{defaultMessage:"Hide debug JSON",id:"workflow.editorSettings.hideDebugJson"}):(0,h.jsx)(a().sA,{defaultMessage:"View debug JSON",id:"workflow.editorSettings.viewDebugJson"})}),n&&t]}):null}function y(e){const{module:t}=e;return(0,h.jsx)(m().X,{value:k(t),language:"json",disabled:!0})}},253708:(e,t,n)=>{n.d(t,{X:()=>o});const o=(0,n(340498).xh)("arrowLeftRight",{default:{loader:()=>n.e(70959).then(n.bind(n,377114))},small:{loader:()=>n.e(70959).then(n.bind(n,398544))},fill:{loader:()=>n.e(70959).then(n.bind(n,742280))},fillSmall:{loader:()=>n.e(70959).then(n.bind(n,249871))}},["arrows","sort","arrange","organize","order","categorize","switch","swap"])},324577:(e,t,n)=>{n.d(t,{Y:()=>i});var o=()=>n(56366);function i(e){return(0,o().K8)((()=>null==e?void 0:e.getWorkflowStore()),[e])}},353731:(e,t,n)=>{n.d(t,{$:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("database",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M16.25 5v1.25c0 1.381-2.797 2.5-6.25 2.5s-6.25-1.119-6.25-2.5V5c0-1.381 2.797-2.5 6.25-2.5s6.25 1.119 6.25 2.5zM10 14.375c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753V15c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753-1.22.806-3.179 1.378-5.963 1.378zM10 10c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753v1.25c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753C14.742 9.428 12.784 10 10 10z"})})},379560:(e,t,n)=>{n.d(t,{A:()=>a});n(898992),n(354520),n(581454);var o=()=>n(765957);class i extends(()=>n(757695))().Store{getInitialState(){return{}}getCalendarMap(){var e;return null===(e=this.getStateForCurrentSpaceView())||void 0===e?void 0:e.calendars}getEvents(){var e;const t=null===(e=this.getStateForCurrentSpaceView())||void 0===e?void 0:e.events;return t?t.getOrderedValues():[]}getCalendarAndAccountIds(){const e=this.getCalendarMap();return e?e.getOrderedValues().map((e=>{let{id:t,accountId:n}=e;return{calendarId:t,accountId:n}})):[]}getStateForCurrentSpaceView(){const{currentSpaceViewStore:e}=o().default.state;if(e)return this.state[e.id]}update(e){super.update(e)}updateStateForCurrentSpaceView(e){const{currentSpaceViewStore:t}=o().default.state;t&&this.update((n=>({...n,[t.id]:e(n[t.id])})))}clearStateForCurrentSpaceView(){const{currentSpaceViewStore:e}=o().default.state;e&&this.update((t=>Object.fromEntries(Object.entries(t).filter((t=>{let[n]=t;return n!==e.id})))))}getCurrentCalendars(){var e;return null===(e=this.getStateForCurrentSpaceView())||void 0===e||null===(e=e.calendars)||void 0===e?void 0:e.getOrderedValues()}getAccount(e){var t;return null===(t=this.getStateForCurrentSpaceView())||void 0===t||null===(t=t.accounts)||void 0===t?void 0:t.get(e)}getCalendar(e){var t;return null===(t=this.getStateForCurrentSpaceView())||void 0===t||null===(t=t.calendars)||void 0===t?void 0:t.get("string"==typeof e?e:`${e.accountId}:${e.calendarId}`)}getCalendarsForAccount(e){var t;return(null===(t=this.getStateForCurrentSpaceView())||void 0===t||null===(t=t.calendars)||void 0===t?void 0:t.getOrderedValues().filter((t=>t.accountId===e)))??[]}getCurrentAccountIds(){var e;return(null===(e=this.getStateForCurrentSpaceView())||void 0===e||null===(e=e.accounts)||void 0===e?void 0:e.getOrderedValues().map((e=>e.id)))??[]}getCalendarFetchedTime(e){var t;const n="string"==typeof e?e:`${e.accountId}:${e.calendarId}`;return null===(t=this.getStateForCurrentSpaceView())||void 0===t?void 0:t.calendarsToLastFetchedTime[n]}}const r=new i;(0,n(604341).exposeDebugValue)("HomeCalendarStore",r);const a=r},383245:(e,t,n)=>{n.r(t),n.d(t,{WorkflowModuleConfiguration:()=>f,WorkflowModuleConfigurationWithEditorContext:()=>g});n(16280);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),l=()=>n(847),s=()=>n(94522),d=()=>n(912749),c=()=>n(442510),u=n(474848);function f(e){const{isInTranscript:t,module:n,removeModule:o,saveConfigVariable:i,saveModule:r,store:l,workflowDefinitionPointer:s,workflowModuleStore:d,workflowValue:f}=e,g=(0,a().IS)((e=>({container:{display:"flex",gap:4,flexDirection:"column"}})),[]),p=c().y[n.type],m=r,h=o;if(!p)throw new Error(`Module definition not found for module ${n.type}`);if(p.ModuleConfiguration){const{ModuleConfiguration:e}=p;return(0,u.jsx)("div",{style:g.container,children:(0,u.jsx)(e,{isInTranscript:t,module:n,removeModule:h,saveConfigVariable:i,saveModule:m,store:l,workflowDefinitionPointer:s,workflowModuleStore:d,workflowValue:f})})}return null}function g(e){const{blockStore:t,module:n,isInTranscript:a}=e,c=(0,i().v3)(),{workflowPointer:g,threadStore:p,workflowValue:m}=(0,d()._)(t),h=(0,r().K8)((()=>(0,s().Cq)({workflowPointer:g,threadPointer:null==p?void 0:p.pointer})),[g,p]),w=(0,r().K8)((()=>(null==t?void 0:t.getWorkflowStore())??p),[t,p]),k=(0,o.useCallback)((e=>{if(!g)throw new Error("No workflow pointer");l().removeModule({environment:c,workflowPointer:g,threadStore:p,module:e,blockStore:t})}),[c,g,p,t]),v=(0,o.useCallback)((e=>{if(!g)throw new Error("No workflow pointer");l().saveModule({environment:c,workflowPointer:g,threadStore:p,module:e,blockStore:t})}),[c,g,p,t]),y=(0,o.useCallback)((e=>{if(!g)throw new Error("No workflow pointer");l().saveConfigVariable({environment:c,workflowPointer:g,threadStore:p,value:e,blockStore:t})}),[c,g,p,t]);return h&&m&&w?(0,u.jsx)(f,{isInTranscript:a,module:n,removeModule:k,saveConfigVariable:y,saveModule:v,store:w,workflowDefinitionPointer:h,workflowValue:m}):null}},392271:(e,t,n)=>{n.d(t,{x:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("exclamation",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M7.99634 15.5659C6.96118 15.5659 5.98706 15.3682 5.07397 14.9727C4.16089 14.582 3.35522 14.0376 2.65698 13.3394C1.96362 12.6411 1.41919 11.8354 1.02368 10.9224C0.628174 10.0093 0.43042 9.03516 0.43042 8C0.43042 6.96484 0.628174 5.99072 1.02368 5.07764C1.41919 4.16455 1.96362 3.36133 2.65698 2.66797C3.35522 1.96973 4.15845 1.42285 5.06665 1.02734C5.97974 0.631836 6.95386 0.434082 7.98901 0.434082C9.02905 0.434082 10.0056 0.631836 10.9187 1.02734C11.8318 1.42285 12.6375 1.96973 13.3357 2.66797C14.0339 3.36133 14.5808 4.16455 14.9763 5.07764C15.3718 5.99072 15.5696 6.96484 15.5696 8C15.5696 9.03516 15.3718 10.0093 14.9763 10.9224C14.5808 11.8354 14.0339 12.6411 13.3357 13.3394C12.6375 14.0376 11.8318 14.582 10.9187 14.9727C10.0056 15.3682 9.03149 15.5659 7.99634 15.5659ZM7.99634 14.0718C8.84106 14.0718 9.62964 13.9155 10.3621 13.603C11.0945 13.2905 11.739 12.856 12.2957 12.2993C12.8523 11.7427 13.2869 11.0981 13.5994 10.3657C13.9119 9.6333 14.0681 8.84473 14.0681 8C14.0681 7.16016 13.9119 6.37402 13.5994 5.6416C13.2869 4.9043 12.8523 4.25732 12.2957 3.70068C11.739 3.14404 11.092 2.70947 10.3547 2.39697C9.62231 2.08447 8.83374 1.92822 7.98901 1.92822C7.14917 1.92822 6.3606 2.08447 5.62329 2.39697C4.89087 2.70947 4.24878 3.14404 3.69702 3.70068C3.14526 4.25732 2.71313 4.9043 2.40063 5.6416C2.08813 6.37402 1.93188 7.16016 1.93188 8C1.93188 8.84473 2.08813 9.6333 2.40063 10.3657C2.71313 11.0981 3.14526 11.7427 3.69702 12.2993C4.25366 12.856 4.89819 13.2905 5.63062 13.603C6.36792 13.9155 7.15649 14.0718 7.99634 14.0718ZM7.99634 9.21582C7.57153 9.21582 7.35181 9.00098 7.33716 8.57129L7.23462 5.01172C7.22485 4.79688 7.29077 4.62109 7.43237 4.48438C7.57397 4.34766 7.75708 4.2793 7.98169 4.2793C8.2063 4.2793 8.39185 4.3501 8.53833 4.4917C8.68481 4.62842 8.75317 4.80176 8.74341 5.01172L8.62622 8.57129C8.61646 9.00098 8.40649 9.21582 7.99634 9.21582ZM7.99634 11.6475C7.75708 11.6475 7.552 11.5718 7.3811 11.4204C7.21509 11.2642 7.13208 11.0713 7.13208 10.8418C7.13208 10.6123 7.21509 10.4219 7.3811 10.2705C7.552 10.1143 7.75708 10.0361 7.99634 10.0361C8.23071 10.0361 8.43091 10.1118 8.59692 10.2632C8.76782 10.4146 8.85327 10.6074 8.85327 10.8418C8.85327 11.0762 8.76782 11.269 8.59692 11.4204C8.42603 11.5718 8.22583 11.6475 7.99634 11.6475Z"})})},398208:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(296540),i=n(474848);function r(e){let{onClose:t,style:o}=e;const r=(0,n(959013).tz)(),{isMobile:a}=(0,n(484714).Y0)(),l=(0,n(401497).IS)((()=>({closeButton:{borderRadius:"100%",width:a?28:22,height:a?28:22,...o},closeButtonIconStyle:a?{width:18,height:18}:{}})),[a,o]);return(0,i.jsx)(n(285790).A,{iconStyle:l.closeButtonIconStyle,style:l.closeButton,hovered:!0,icon:n(66913).V,onClick:t,ariaLabel:r.formatMessage({id:"circleCloseButton.ariaLabel",defaultMessage:"Close"})})}const a=o.memo(r)},442510:(e,t,n)=>{n.d(t,{y:()=>Tn});n(898992),n(354520),n(581454),n(737550);var o=n(296540),i=()=>n(56366),r=()=>n(401497),a=()=>n(959013),l=()=>n(496603),s=()=>n(284371),d=()=>n(760217),c=()=>n(939740),u=()=>n(89924),f=()=>n(379560),g=()=>n(563452),p=()=>n(204063),m=(n(16280),()=>n(484714)),h=()=>n(724639),w=()=>n(874913),k=()=>n(957416),v=()=>n(780054),y=()=>n(725951),x=(n(18107),n(967357),()=>n(919709)),C=()=>n(449506),M=()=>n(398208),I=()=>n(297872),j=()=>n(623580),b=()=>n(676007),S=()=>n(21140),A=()=>n(765957),D=n(474848);const T=(0,a().YK)({authAriaLabel:{id:"workflows.authDetails.popup.ariaLabel",defaultMessage:"Authenticate modal"}});const P={calendar:{VendorSpecificAuthDetails:function(e){const{onDismiss:t,moduleId:l,workflowDefinitionPointer:d}=e,[c,u]=(0,o.useState)(!1),[f,g]=(0,o.useState)(),h=(0,m().v3)(),w=(0,r().IS)((e=>({title:{fontSize:20,margin:"0 50px 32px",textAlign:"center",fontWeight:s().Wy.medium},inputContainer:{display:"flex",flexDirection:"column",paddingLeft:20,paddingRight:20,paddingTop:5,paddingBottom:5},row:{justifyContent:"center"},errorMessage:{color:e.errorText,marginBottom:10}})),[]),k=(0,i().K8)((()=>(0,n(583238).pH)().at(0)),[]),v=(0,o.useCallback)((()=>{if(!d)return;if(u(!0),!k)return void g("No calendar bot found");const e=k.id;C().callApi({eventName:"connectAiWorkflowToCalendarAccount",environment:h,data:{moduleId:l,workflowDefinitionPointer:d,botId:e}}).then(t).catch((()=>{g("Error connecting to Calendar"),u(!1)}))}),[d,k,h,l,t]),y=(0,o.useCallback)((()=>{(0,n(645200).Op)({environment:h,spaceStore:A().default.state.currentSpaceStore,collectionViewStore:void 0,from:"homeSignupClick"})}),[h]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{style:w.title,children:(0,D.jsx)(a().sA,{id:"workflows.authDetails.title",defaultMessage:"Connect to {integrationName}",values:{integrationName:"Calendar"}})}),(0,D.jsxs)("div",{style:w.inputContainer,children:[f&&(0,D.jsx)("div",{style:w.errorMessage,children:f}),(0,D.jsx)(S().Ye,{style:w.row,children:k?(0,D.jsx)(p().A,{onClick:v,isLoading:c,children:c?"Connecting...":"Add connected calendar to app"}):(0,D.jsx)(p().A,{onClick:y,children:(0,D.jsx)(a().sA,{id:"workflows.authDetails.connectCalendarButton",defaultMessage:"Connect to Calendar"})})})]})]})}},codegen:{VendorSpecificAuthDetails:function(e){const{onDismiss:t,moduleId:n,workflowDefinitionPointer:i}=e,[l,d]=(0,o.useState)(""),[c,u]=(0,o.useState)("41"),[f,g]=(0,o.useState)(!1),[w,k]=(0,o.useState)(),v=(0,m().v3)(),y=(0,r().IS)((e=>({title:{fontSize:20,margin:"0 50px 32px",textAlign:"center",fontWeight:s().Wy.medium},inputContainer:{display:"flex",flexDirection:"column",paddingLeft:20,paddingRight:20,paddingTop:5,paddingBottom:5,gap:16},input:{marginLeft:5,marginRight:5},label:{fontSize:14,fontWeight:s().Wy.medium,marginBottom:8,color:e.text.secondary},row:{justifyContent:"center",marginTop:24},errorMessage:{color:e.errorText,marginBottom:10}})),[]),M=(0,o.useCallback)((e=>{d(x().xV3(e.target.value))}),[]),I=(0,o.useCallback)((e=>{u(x().xV3(e.target.value))}),[]),b=(0,o.useCallback)((()=>{if(!i||!l.trim())return void k("API token is required");g(!0),k(void 0);const{workflowId:e,spaceId:o}=(0,h().kI)(i),r=!n.startsWith("wm_")&&e?{type:"workflow",workflowDefinitionPointer:i,moduleId:n,apiToken:l.trim(),organizationId:c.trim()||"41"}:{type:"agent",spaceId:o,integrationId:n,apiToken:l.trim(),organizationId:c.trim()||"41"};C().callApi({eventName:"postWorkflowsCodegenConnect",environment:v,data:r}).then(t).catch((e=>{k(e instanceof Error?e.message:"Failed to connect to CodeGen"),g(!1)}))}),[t,n,i,v,l,c]),A=(0,o.useCallback)((e=>{"Enter"===e.key&&b()}),[b]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{style:y.title,children:(0,D.jsx)(a().sA,{id:"workflows.authDetails.title",defaultMessage:"Connect to {integrationName}",values:{integrationName:"CodeGen"}})}),(0,D.jsxs)("div",{style:y.inputContainer,children:[(0,D.jsxs)("div",{children:[(0,D.jsx)("div",{style:y.label,children:(0,D.jsx)(a().sA,{id:"workflows.codegen.apiToken.label",defaultMessage:"API Token"})}),(0,D.jsx)(j().A,{style:y.input,type:"password",value:l,onChange:M,onKeyDown:A,placeholder:"sk-..."})]}),(0,D.jsxs)("div",{children:[(0,D.jsx)("div",{style:y.label,children:(0,D.jsx)(a().sA,{id:"workflows.codegen.organizationId.label",defaultMessage:"Organization ID (optional)"})}),(0,D.jsx)(j().A,{style:y.input,value:c,onChange:I,onKeyDown:A,placeholder:"41"})]}),w&&(0,D.jsx)("div",{style:y.errorMessage,children:w}),(0,D.jsx)(S().Ye,{style:y.row,children:(0,D.jsx)(p().A,{onClick:b,disabled:!l.trim(),isLoading:f,children:f?"Connecting...":"Connect"})})]})]})}},notionmail:{VendorSpecificAuthDetails:function(e){const{onDismiss:t,moduleId:n,workflowDefinitionPointer:i}=e,[l,d]=(0,o.useState)(!1),[c,u]=(0,o.useState)(),f=(0,m().v3)(),g=(0,r().IS)((e=>({title:{fontSize:20,margin:"0 50px 32px",textAlign:"center",fontWeight:s().Wy.medium},inputContainer:{display:"flex",flexDirection:"column",paddingLeft:20,paddingRight:20,paddingTop:5,paddingBottom:5},row:{justifyContent:"center"},errorMessage:{color:e.errorText,marginBottom:10}})),[]),h=(0,o.useCallback)((()=>{i&&(d(!0),C().callApi({eventName:"connectAiWorkflowToNotionMailAccount",environment:f,data:{moduleId:n,workflowDefinitionPointer:i}}).then(t).catch((()=>{u("Error connecting to Notion Mail")})))}),[t,n,i,f]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{style:g.title,children:(0,D.jsx)(a().sA,{id:"workflows.authDetails.title",defaultMessage:"Connect to {integrationName}",values:{integrationName:"Notion Mail"}})}),(0,D.jsxs)("div",{style:g.inputContainer,children:[c&&(0,D.jsx)("div",{style:g.errorMessage,children:c}),(0,D.jsx)(S().Ye,{style:g.row,children:(0,D.jsx)(p().A,{onClick:h,isLoading:l,children:l?"Connecting...":"Connect"})})]})]})}},zendesk:{VendorSpecificAuthDetails:function(e){const{navigateWithModuleSpecificAuth:t}=e,[n,i]=(0,o.useState)(""),[l,d]=(0,o.useState)(!1),c=(0,r().IS)((e=>({title:{fontSize:20,margin:"0 50px 32px",textAlign:"center",fontWeight:s().Wy.medium},inputContainer:{display:"flex",flexDirection:"column",paddingLeft:20,paddingRight:20,paddingTop:5,paddingBottom:5},input:{marginLeft:5,marginRight:5,marginBottom:55},row:{justifyContent:"center"}})),[]),u=(0,o.useCallback)((e=>{i(x().xV3(e.target.value))}),[i]),f=(0,o.useCallback)((()=>{d(!0),t(n)}),[t,n]),g=(0,o.useCallback)((e=>{"Enter"===e.key&&f()}),[f]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{style:c.title,children:(0,D.jsx)(a().sA,{id:"workflows.authDetails.title",defaultMessage:"Connect to {integrationName}",values:{integrationName:"Zendesk"}})}),(0,D.jsxs)("div",{style:c.inputContainer,children:[(0,D.jsxs)(S().Ye,{children:["https://",(0,D.jsx)(j().A,{style:c.input,value:n,onChange:u,onKeyDown:g}),".zendesk.com"]}),(0,D.jsx)(S().Ye,{style:c.row,children:(0,D.jsx)(p().A,{onClick:f,disabled:!n,isLoading:l,children:l?"Authenticating...":"Authenticate"})})]})]})}}};function R(e){const{onDismiss:t,isOpen:n,moduleType:o,moduleId:i,workflowDefinitionPointer:l,navigateWithModuleSpecificAuth:s,workflowModuleStore:d}=e,{VendorSpecificAuthDetails:c}=P[o]??{},u=(0,r().IS)((e=>({container:{padding:16,display:"flex",flexDirection:"column",gap:8,minWidth:460,maxWidth:460,maxHeight:565,position:"relative"},closeButton:{position:"absolute",right:16,top:16}})),[]),f=(0,a().tz)();return c?(0,D.jsx)(b().a,{ariaLabel:f.formatMessage(T.authAriaLabel),innerStyle:u.container,onDismiss:t,open:n,preventHideChildrenWhileOpening:!0,render:()=>(0,D.jsx)(I().A,{capture:!0,render:e=>(0,D.jsxs)("div",{...e,children:[(0,D.jsx)(M().A,{onClose:t,style:u.closeButton}),(0,D.jsx)(c,{navigateWithModuleSpecificAuth:s,onDismiss:t,moduleId:i,workflowDefinitionPointer:l,workflowModuleStore:d})]})})}):null}var E=Object.defineProperty,L=Object.defineProperties,V=Object.getOwnPropertyDescriptors,N=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,z=(e,t,n)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,O=(e,t)=>{for(var n in t||(t={}))U.call(t,n)&&z(e,n,t[n]);if(N)for(var n of N(t))W.call(t,n)&&z(e,n,t[n]);return e},B=(e,t)=>L(e,V(t)),q="1.6.0",F=["token","password","secret","apiKey","authorization","auth","key","access_token"];function _(e,t=new WeakSet){if(null==e)return e;if("object"==typeof e){if(t.has(e))return"[CIRCULAR]";if(t.add(e),Array.isArray(e))return e.map((e=>_(e,t)));let n={};for(let[o,i]of Object.entries(e)){let e=F.some((e=>o.toLowerCase().includes(e.toLowerCase())));n[o]=e?"[REDACTED]":_(i,t)}return n}return e}function $(...e){if("undefined"!=typeof process&&void 0!==process.env&&"true"===process.env.PD_SDK_DEBUG){let t=e.map((e=>_(e)));console.log("[PD_SDK_DEBUG]",...t)}}var Y=class{constructor(e){var t;this.version=q,this.environment=null!=(t=e.environment)?t:"production";let{apiHost:n="api.pipedream.com",workflowDomain:o="m.pipedream.net"}=e;this.apiHost=n,this.baseApiUrl=`https://${n}/v1`,this.workflowDomain=o}getEnvironment(){return this.environment}async makeRequest(e,t={}){let n=t,{params:o,headers:i,body:r,method:a="GET",baseURL:l=this.baseApiUrl}=n,s=((e,t)=>{var n={};for(var o in e)U.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&N)for(var o of N(e))t.indexOf(o)<0&&W.call(e,o)&&(n[o]=e[o]);return n})(n,["params","headers","body","method","baseURL"]),d=new URL(`${l}${e}`);if(o)for(let[w,k]of Object.entries(o))null!=k&&d.searchParams.append(w,String(k));let c=B(O({},i),{"X-PD-SDK-Version":q,"X-PD-Environment":this.environment}),u=null;r&&(r instanceof FormData||r instanceof URLSearchParams||"string"==typeof r?u=r:(u=JSON.stringify(r),c["Content-Type"]=c["Content-Type"]||"application/json"));let f=O({method:a,headers:c},s);["POST","PUT","PATCH"].includes(a.toUpperCase())&&u&&(f.body=u);let g=await fetch(d.toString(),f),p=await g.text();if($("status: ",g.status),$("url: ",d.toString()),$("requestOptions: ",f),$("rawBody: ",p),!g.ok)throw new Error(`HTTP error! status: ${g.status}, body: ${p}`);let m=g.headers.get("Content-Type");if(m&&m.includes("application/json"))try{return JSON.parse(p)}catch(h){$("Couldn't parse json, falling back to raw",h)}return p}async makeAuthorizedRequest(e,t={}){let n=B(O({"Content-Type":"application/json"},t.headers),{Authorization:await this.authHeaders()});return this.makeRequest(e,B(O({},t),{headers:n}))}makeConnectRequest(e,t={}){let n="/connect";return this.projectId&&(n+=`/${this.projectId}`),n+=e,this.makeAuthorizedRequest(n,t)}getAccounts(e={}){return this.makeConnectRequest("/accounts",{method:"GET",params:e})}getApps(e){let t={};return null!=e&&e.q&&(t.q=e.q),null!=(null==e?void 0:e.hasActions)&&(t.has_actions=e.hasActions?"1":"0"),null!=(null==e?void 0:e.hasComponents)&&(t.has_components=e.hasComponents?"1":"0"),null!=(null==e?void 0:e.hasTriggers)&&(t.has_triggers=e.hasTriggers?"1":"0"),this.addRelationOpts(t,e),this.makeAuthorizedRequest("/apps",{method:"GET",params:t})}apps(e){return this.getApps(e)}getApp(e){let t=`/apps/${e}`;return this.makeAuthorizedRequest(t,{method:"GET"})}app(e){return this.getApp(e)}getComponents(e){let t={};null!=e&&e.app&&(t.app=e.app),null!=e&&e.q&&(t.q=e.q),this.addRelationOpts(t,e,20);let n="/components";return"trigger"===(null==e?void 0:e.componentType)?n="/triggers":"action"===(null==e?void 0:e.componentType)&&(n="/actions"),this.makeConnectRequest(n,{method:"GET",params:t})}components(e){return this.getComponents(e)}getComponent(e){let{key:t}=e,n=`/components/${t}`;return this.makeConnectRequest(n,{method:"GET"})}component({key:e}){return this.getComponent({key:e})}configureComponent(e){let{userId:t,externalUserId:n=t,componentId:o}=e,i={external_user_id:n,id:"object"==typeof o?o.key:o,prop_name:e.propName,configured_props:e.configuredProps,dynamic_props_id:e.dynamicPropsId,page:e.page,prev_context:e.prevContext,query:e.query};return this.makeConnectRequest("/components/configure",{method:"POST",body:i})}componentConfigure(e){return this.configureComponent(e)}reloadComponentProps(e){let{userId:t,externalUserId:n=t,componentId:o}=e,i={external_user_id:n,id:"object"==typeof o?o.key:o,configured_props:e.configuredProps,dynamic_props_id:e.dynamicPropsId};return this.makeConnectRequest("/components/props",{method:"POST",body:i})}componentReloadProps(e){return this.reloadComponentProps(e)}runAction(e){let{userId:t,externalUserId:n=t,actionId:o}=e,i={external_user_id:n,id:"object"==typeof o?o.key:o,configured_props:e.configuredProps,dynamic_props_id:e.dynamicPropsId};return this.makeConnectRequest("/actions/run",{method:"POST",body:i})}actionRun(e){return this.runAction(e)}deployTrigger(e){let{userId:t,externalUserId:n=t,triggerId:o}=e,i={external_user_id:n,id:"object"==typeof o?o.key:o,configured_props:e.configuredProps,dynamic_props_id:e.dynamicPropsId,webhook_url:e.webhookUrl};return this.makeConnectRequest("/triggers/deploy",{method:"POST",body:i})}triggerDeploy(e){return this.deployTrigger(e)}deleteTrigger(e){let{id:t,externalUserId:n,ignoreHookErrors:o=null}=e;return this.makeConnectRequest(`/deployed-triggers/${t}`,{method:"DELETE",params:{external_user_id:n,ignore_hook_errors:o}})}getTrigger(e){let{id:t,externalUserId:n}=e;return this.makeConnectRequest(`/deployed-triggers/${t}`,{method:"GET",params:{external_user_id:n}})}getTriggers(e){let{externalUserId:t}=e;return this.makeConnectRequest("/deployed-triggers",{method:"GET",params:{external_user_id:t}})}updateTrigger(e){let{id:t,externalUserId:n,active:o=null,configuredProps:i=null,name:r=null}=e;return this.makeConnectRequest(`/deployed-triggers/${t}`,{method:"PUT",params:{external_user_id:n},body:{active:o,configured_props:i,name:r}})}getTriggerEvents(e){let{id:t,externalUserId:n,limit:o=null}=e;return this.makeConnectRequest(`/deployed-triggers/${t}/events`,{method:"GET",params:{external_user_id:n,n:o}})}getTriggerWorkflows(e){let{id:t,externalUserId:n}=e;return this.makeConnectRequest(`/deployed-triggers/${t}/pipelines`,{method:"GET",params:{external_user_id:n}})}updateTriggerWorkflows(e){let{id:t,externalUserId:n,workflowIds:o}=e;if(!Array.isArray(o))throw new Error("workflowIds must be an array");return this.makeConnectRequest(`/deployed-triggers/${t}/pipelines`,{method:"PUT",params:{external_user_id:n},body:{workflow_ids:o}})}getTriggerWebhooks(e){let{id:t,externalUserId:n}=e;return this.makeConnectRequest(`/deployed-triggers/${t}/webhooks`,{method:"GET",params:{external_user_id:n}})}updateTriggerWebhooks(e){let{id:t,externalUserId:n,webhookUrls:o}=e;if(!Array.isArray(o))throw new Error("webhookUrls must be an array");return this.makeConnectRequest(`/deployed-triggers/${t}/webhooks`,{method:"PUT",params:{external_user_id:n},body:{webhook_urls:o}})}buildWorkflowUrl(e){let t,n=e.trim().replace(/[^\w-./:]/g,"").toLowerCase();if(!n)throw new Error("URL or endpoint ID is required");if(n.includes(".")||n.startsWith("http")){let e;try{let t=n.startsWith("http")?n:`https://${n}`;e=new URL(t)}catch(o){throw new Error(`\n          The provided URL is malformed: "${n}".\n          Please provide a valid URL.\n        `)}if(!e.hostname.endsWith(this.workflowDomain))throw new Error(`Invalid workflow domain. URL must end with ${this.workflowDomain}`);t=e.href}else{if(!/^e(n|o)[a-z0-9-]+$/i.test(n))throw new Error('\n          Invalid endpoint ID format.\n          Must contain only letters, numbers, and hyphens, and start with either "en" or "eo".\n        ');t=`https://${n}.${this.workflowDomain}`}return t}async invokeWorkflow(e,t={},n="none"){let o,{body:i,headers:r={}}=t,a=this.buildWorkflowUrl(e);switch(n){case"static_bearer_token":o=r.Authorization;break;case"oauth":o=await this.authHeaders()}return this.makeRequest("",B(O({},t),{baseURL:a,method:t.method||"POST",headers:o?B(O({},r),{Authorization:o}):r,body:i}))}async invokeWorkflowForExternalUser(e,t,n={}){if(null==t||!t.trim())throw new Error("External user ID is required");if(!e.trim())throw new Error("Workflow URL is required");if(!(await this.authHeaders()))throw new Error("OAuth or token is required for invoking workflows for external users. Please pass credentials for a valid OAuth client");let{headers:o={}}=n;return this.invokeWorkflow(e,B(O({},n),{headers:B(O({},o),{"X-PD-External-User-ID":t})}),"oauth")}addRelationOpts(e,t,n){null!=(null==t?void 0:t.limit)&&(e.limit=""+t.limit),null!=n&&!e.limit&&(e.limit=""+n),null!=t&&t.after&&(e.after=t.after),null!=t&&t.before&&(e.before=t.before)}},K=class extends Error{};var G=class extends Y{constructor(e){super(e),this.iframeId=0,this.baseURL=`https://${e.frontendHost||"pipedream.com"}`,this.iframeURL=`${this.baseURL}/_static/connect.html`,this.tokenCallback=e.tokenCallback,this.externalUserId=e.externalUserId}async token(){if(this._token&&this._tokenExpiresAt&&this._tokenExpiresAt>new Date)return this._token;if(this._tokenRequest)return this._tokenRequest;let e=this.tokenCallback,t=this.externalUserId;if(!e)throw new Error("No token callback provided");if(!t)throw new Error("No external user ID provided");return this._tokenRequest=(async()=>{let{token:n,expires_at:o}=await e({externalUserId:t});return this._token=n,this._tokenExpiresAt=new Date(o),this._tokenRequest=void 0,n})(),this._tokenRequest}refreshToken(){this._token=void 0}async connectAccount(e){var t;let n=t=>{var o,i,r,a;switch(null==(o=t.data)?void 0:o.type){case"success":null==(r=e.onSuccess)||r.call(e,{id:null==(i=t.data)?void 0:i.authProvisionId});break;case"error":null==(a=e.onError)||a.call(e,new K(t.data.error));break;case"close":this.cleanup(n)}};window.addEventListener("message",n);try{await this.createIframe(e)}catch(o){null==(t=e.onError)||t.call(e,o)}this.refreshToken()}cleanup(e){var t;null==(t=this.iframe)||t.remove(),window.removeEventListener("message",e)}async createIframe(e){let t=e.token||await this.token(),n=new URLSearchParams({token:t});if("string"!=typeof e.app)throw new K("Object app not yet supported");n.set("app",e.app),e.oauthAppId&&n.set("oauthAppId",e.oauthAppId);let o=document.createElement("iframe");o.id="pipedream-connect-iframe-"+this.iframeId++,o.title="Pipedream Connect",o.src=`${this.iframeURL}?${n.toString()}`,o.style.cssText="position:fixed;inset:0;z-index:2147483647;border:0;display:block;overflow:hidden auto",o.width="100%",o.height="100%",o.onload=()=>{this.iframe=o},document.body.appendChild(o)}async authHeaders(){if(!(await this.token()))throw new Error("No token provided");return`Bearer ${await this.token()}`}getAccounts(e){return super.getAccounts(e)}},H=()=>n(743246),Z=()=>n(262986);function J(e){const{workflowDefinitionPointer:t,workflowModuleStore:n,moduleId:i,moduleState:r,onDismiss:a}=e,l=(0,m().v3)(),[s,d]=(0,o.useState)(!1),[c,u]=(0,o.useState)();return{handleConnectClick:(0,o.useCallback)((async()=>{if(!t)return;if(!r||!("integration"in r))throw new Error("Pipedream state is missing integration - which must be set before starting auth");const e=r.integration;if(!e)throw new Error("Pipedream state is missing integration - which must be set before starting auth");d(!0),u(void 0);try{const o=await C().callApi({eventName:"postWorkflowsPipedreamCreateConnectToken",environment:l,data:{}});if("success"!==o.type)throw new Error("Failed to create connect token");const{token:r}=o.data,s=function(e={}){return new G(e)}();await s.connectAccount({app:e,token:r,onSuccess:async o=>{let{id:r}=o;try{const o=t.spaceId;let s;if(n){if(!n.isDefined())throw new Error("Workflow module store has not loaded");s={type:"agent",accountId:r,integration:e,spaceId:n.getSpaceId(),integrationId:n.id}}else{if(t.table!==H().C0)throw new Error("Workflow definition pointer is not a workflow");s={type:"workflow",accountId:r,integration:e,spaceId:o,workflowId:t.id,moduleId:i}}if("success"!==(await C().callApi({eventName:"postWorkflowsPipedreamConnect",environment:l,data:s})).type)throw new Error("Failed to save connection");d(!1),null==a||a()}catch(s){d(!1);const e=s instanceof Error?s.message:String(s);u(`Failed to save connection: ${e}`)}},onError:e=>{d(!1),u(e.message)}})}catch(o){d(!1);const e=o instanceof Error?o.message:String(o);u(e)}}),[l,i,r,t,n,a]),isLoading:s,errorMessage:c}}const Q=(0,a().YK)({titleMessage:{id:"workflows.hooks.useModuleAuthDetails.title",defaultMessage:"Authenticate"}});function X(e){const{moduleValue:t,workflowDefinitionPointer:n,workflowModuleStore:i}=e,[r,a]=(0,o.useState)(!1),l=(0,m().v3)(),{isElectron:s}=(0,m().Y0)(),d=(0,o.useCallback)((e=>{const{callbackType:o,redirectToAuth:r}=(0,y().LX)(l);let a;if(i){if(!i.isDefined())throw new Error("Workflow module store has not loaded");const{transcriptId:t}=(0,h().kI)(n);if(!t)throw new Error("Transcript ID is required");a=(0,h().nh)({callbackType:o,integrationId:i.id,moduleSpecific:e,redirectToAuth:r?"true":void 0,spaceId:i.getSpaceId(),transcriptId:t,type:"agent"},v().A.domainBaseUrl)}else{const{spaceId:i,workflowId:l,transcriptId:s}=(0,h().kI)(n);a=(0,h().nh)({callbackType:o,moduleId:t.id,moduleSpecific:e,redirectToAuth:r?"true":void 0,spaceId:i,type:"workflow",workflowId:l,transcriptId:s},v().A.domainBaseUrl)}s?w().openExternalUrl(a):k().P(l,{height:700,titleMessage:Q.titleMessage,url:a,width:610})}),[l,i,s,t.id,n]),c=J({workflowDefinitionPointer:n,workflowModuleStore:i,moduleId:t.id,moduleState:t.state}).handleConnectClick,u=(0,o.useCallback)((()=>{var e,n;e=t.type,"pipedream"===(null===(n=Z().Nh[e])||void 0===n||null===(n=n.authentication)||void 0===n?void 0:n.type)?c():!function(e){return void 0!==P[e]}(t.type)?d():a(!0)}),[t.type,d,c]),f=(0,o.useCallback)((()=>{a(!1)}),[]);return{authDetailModalArgs:{isOpen:r,moduleId:t.id,moduleType:t.type,navigateWithModuleSpecificAuth:d,onDismiss:f,workflowDefinitionPointer:n,workflowModuleStore:i},handleConnect:u}}function ee(e){const{moduleValue:t,workflowDefinitionPointer:n,workflowModuleStore:o}=e,{handleConnect:i,authDetailModalArgs:r}=X({moduleValue:t,workflowDefinitionPointer:n,workflowModuleStore:o});return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(p().A,{color:"uiBlue",onClick:i,size:"lg",children:(0,D.jsx)(a().sA,{defaultMessage:"Connect",id:"workflows.modules.workflowModuleAuthButton.connectLabel"})}),(0,D.jsx)(R,{...r})]})}var te=()=>n(340498);const ne=(0,te().xh)("arrowLeftAndRight",{default:{loader:()=>n.e(62153).then(n.bind(n,62153))},small:{loader:()=>n.e(17603).then(n.bind(n,617603))},mini:{loader:()=>n.e(46357).then(n.bind(n,846357))},large:{loader:()=>n.e(52491).then(n.bind(n,952491))}});var oe=()=>n(546806),ie=()=>n(558687),re=()=>n(84817),ae=()=>n(460292),le=()=>n(554509),se=()=>n(864943),de=()=>n(614842),ce=()=>n(183541),ue=()=>n(630116),fe=()=>n(640653);function ge(e){const{moduleValue:t}=e,{state:n}=t,o=(0,i().O$)(A().AppStoreCurrentSpaceStore),r=(0,i().K8)((()=>null==o?void 0:o.pointer),[o]),a=function(){const e=(0,m().v3)();return(0,i().K8)((()=>(0,fe().s7)(e)),[e])}(),l=(0,i().K8)((()=>{var e;if(o&&n&&"connectionPointer"in n&&(null===(e=n.connectionPointer)||void 0===e?void 0:e.table)===ce().tE)return ue().s$.createChildStore(o,n.connectionPointer)}),[o,n]),[s,d]=(0,i().K8)((()=>[null==l?void 0:l.isPersonalPermission(),(null==l?void 0:l.getScopes())??[]]),[l]);return{allowedScopes:d,isScopedConnectionPersonal:s,isWorkspaceAdmin:a,scopedExternalConnectionStore:l,spacePointer:r}}var pe=()=>n(804059),me=()=>n(236262),he=()=>n(406699),we=()=>n(285790),ke=()=>n(928600),ve=()=>n(722872),ye=()=>n(377586),xe=()=>n(463830),Ce=()=>n(691093),Me=()=>n(519143),Ie=()=>n(599813);function je(e){const{module:t,moreMenuText:n,workflowDefinitionPointer:s,removeModule:c,saveModule:f}=e,p=(0,m().v3)(),h=(0,i().uB)(void 0,xe().A),{handleConnect:w,authDetailModalArgs:k}=X({moduleValue:t,workflowDefinitionPointer:s}),v=(0,o.useCallback)((()=>{h.reset()}),[h]),y=function(e){var t;const{module:n,handleConnect:i,saveModule:s}=e,c=Z().Nh[n.type],u=n.state,f=!(!u||!("connectionPointer"in u))&&Boolean(u.connectionPointer),p=(0,o.useCallback)((()=>{s((0,g().yC)({...n,state:{}}))}),[n,s]),m=(0,r().IS)((()=>({icon:{height:16,width:16}})),[]);if(!c)return[];const h="oauth2"===(null===(t=c.authentication)||void 0===t?void 0:t.type),w="notionmail"===n.type;return h||w?l().oE([{key:"connect",action:i,render:e=>(0,D.jsx)(d().A,{...e,icon:(0,Me().D)(m.icon),title:f?(0,D.jsx)(a().sA,{id:"WorkflowModule.useModuleOauthActions.reconnect",defaultMessage:"Reconnect"}):(0,D.jsx)(a().sA,{id:"WorkflowModule.useModuleOauthActions.connect",defaultMessage:"Connect"})})},f&&{key:"disconnect",action:p,render:e=>(0,D.jsx)(d().A,{...e,icon:(0,Ie().xMarkIcon)(m.icon),isRedOnHover:!0,title:(0,D.jsx)(a().sA,{id:"WorkflowModule.useModuleOauthActions.disconnect",defaultMessage:"Disconnect"})})}]):[]}({module:t,handleConnect:w,saveModule:f}),x=(0,o.useCallback)((()=>{if(!c)return;const{mainEditorCurrentBlockStore:e}=A().default.state;if(!e||!e.isCollectionView())throw new Error("Main editor current block store is not a collection view");c(t),(0,Ce().showWorkflowEditor)({environment:p,parentStore:e,navigationState:{isOpen:!0,type:"agent"}})}),[c,t,p]),C=(0,r().IS)((()=>({trashIcon:{width:16,height:16}})),[]),M=(0,i().K8)((()=>{const e=[{key:"actions",render:e=>(0,D.jsx)(u().A,{...e}),items:[...y,{key:"remove",action:x,render:e=>(0,D.jsx)(d().A,{...e,icon:(0,me().trashIcon)(C.trashIcon),title:"Remove from app",isRedOnHover:!0})}]}];return e}),[y,x,C.trashIcon]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(be,{sections:M,moreMenuText:n,buttonPopupStore:h,onClose:v}),(0,D.jsx)(R,{...k})]})}function be(e){const{sections:t,moreMenuText:n,buttonPopupStore:o,onClose:i}=e,l=(0,a().tz)(),s=(0,m().Y0)(),d=(0,r().IS)((()=>({iconButton:{height:24,width:24,flexShrink:0,borderRadius:4},outlineButton:{},icon:{height:16,width:16}})),[]);return(0,D.jsx)(he().Ay,{originGap:0,buttonPopupStore:o,alignmentToOrigin:he().yP.Center,placementToOrigin:he().sx.Bottom,popupType:s.isMobile?ye().n.BottomSheet:ye().n.Popup,onClose:i,render:()=>{const e={menuType:ve().gu.Popup,width:250};return(0,D.jsx)(ke().A,{...e,children:(0,D.jsx)(c().Ay,{type:c().Oh.Vertical,sections:t,initialFocus:0})})},renderOrigin:e=>n?(0,D.jsx)(se().A,{...e,style:d.outlineButton,children:n}):(0,D.jsx)(we().A,{...e,ariaLabel:l.formatMessage({id:"workflowModule.more",defaultMessage:"More"}),hasBackground:!0,icon:pe().W,iconStyle:d.icon,style:d.iconButton})})}var Se=()=>n(253708);function Ae(e){const{moduleValue:t}=e,n=(0,a().tz)(),o=de().d.getIcon(t.type),i=de().d.getDescription(t,n),l=(0,r().IS)((()=>({middleIcon:{height:24,width:24},moduleDescription:{marginBlock:"1em 0",maxWidth:400,textAlign:"center"},moduleIcon:{height:32,width:32},notionIcon:{height:32,width:32}})),[]);return(0,D.jsxs)("div",{children:[(0,D.jsxs)(re().Y1,{align:"center",direction:"horizontal",gap:4,children:[(0,D.jsx)("span",{style:l.moduleIcon,children:o(l.moduleIcon)}),(0,D.jsx)(ae().Q,{iconGroup:Se().X,colorName:"secondary",variantName:"default",style:l.middleIcon}),(0,D.jsx)("span",{style:l.notionIcon,children:(0,ie().notionIcon)(l.notionIcon)})]}),(0,D.jsx)(le().D,{as:"p",styleName:"UIRegular-14px/Regular",colorName:"secondary",style:l.moduleDescription,children:i})]})}var De=()=>n(803960),Te=()=>n(765974),Pe=()=>n(534177);const Re=(0,a().YK)({scopeReadLabel:{defaultMessage:"Read",id:"workflow.module.github.scopePicker.scopeReadLabel"},scopeWriteLabel:{defaultMessage:"Write",id:"workflow.module.github.scopePicker.scopeWriteLabel"}}),Ee={read:Re.scopeReadLabel,write:Re.scopeWriteLabel};function Le(e){const{allowedScopes:t,selectedScopes:n,onMenuItemClick:o}=e,{isMobile:i}=(0,m().Y0)();return(0,D.jsx)(ke().A,{maxWidth:265,menuType:i?ve().gu.Modal:ve().gu.Popup,children:(0,D.jsx)(c().Ay,{initialFocus:0,sections:[{key:"scopes",items:t.map((e=>({key:e,action:()=>{n.includes(e)?o(n.filter((t=>t!==e))):o([...n,e])},render:t=>(0,D.jsx)(d().A,{...t,isChecked:n.includes(e),title:(0,D.jsx)(a().sA,{...Ee[e]})})}))),render:e=>(0,D.jsx)(u().A,{...e})}],type:c().Oh.Vertical})})}const Ve=(0,a().YK)({scopeMissingLabel:{defaultMessage:"MISSING SCOPE",id:"workflow.modules.scopeButton.scopeMissingLabel"},scopeReadLabel:{defaultMessage:"Read",id:"workflow.modules.scopeButton.scopeReadLabel"},scopeWriteLabel:{defaultMessage:"Write",id:"workflow.modules.scopeButton.scopeWriteLabel"},selectScopes:{defaultMessage:"No scopes",id:"workflow.modules.scopeButton.selectScopes"}}),Ne={read:Ve.scopeReadLabel,write:Ve.scopeWriteLabel};function Ue(e){const{allowedScopes:t,onMenuItemClick:n,selectedScopes:i}=e,{isMobile:l}=(0,m().Y0)(),s=(0,a().tz)(),d=(0,r().IS)((e=>({chevronDownIcon:{height:16,width:16},plainButton:{gap:4},warningIcon:{fill:e.icon.uiRedPrimary}})),[]),c=(0,o.useCallback)((e=>n(e)),[n]),u=(0,o.useMemo)((()=>{if(0===i.length)return;return s.formatList(i.map((e=>s.formatMessage(Ne[e]??Ve.scopeMissingLabel))),{style:"long",type:"conjunction"})}),[s,i]),f=(0,o.useCallback)((e=>{const t=(0,Pe().O9)(u);return(0,D.jsxs)(se().A,{...e,iconLeading:t?void 0:Te().exclamationMarkTriangleFillIcon,iconStyle:d.warningIcon,size:"lg",style:d.plainButton,children:[t?u:(0,D.jsx)(a().sA,{...Ve.selectScopes}),(0,De().arrowChevronSingleDownIcon)(d.chevronDownIcon)]})}),[u,d.chevronDownIcon,d.plainButton,d.warningIcon]);return(0,D.jsx)(he().Ay,{originGap:4,popupType:l?he().z7.BottomSheet:he().z7.Popup,render:e=>(0,D.jsx)(Le,{allowedScopes:t,onMenuItemClick:c,selectedScopes:i}),renderOrigin:f})}const We=(0,a().YK)({connected:{id:"workflowModuleConnectedView.fixConnection",defaultMessage:"Connected"}});function ze(e){let{module:t,workflowDefinitionPointer:n,removeModule:i,saveModule:l}=e;const s=de().d.getIcon(t.type),{allowedScopes:d,isScopedConnectionPersonal:c,isWorkspaceAdmin:u,scopedExternalConnectionStore:f}=ge({moduleValue:t}),p=(0,o.useCallback)((e=>{"slack"!==t.type&&"github"!==t.type||l((0,g().yC)({...t,state:{...t.state,scopes:e}}))}),[t,l]),m=(0,o.useMemo)((()=>("slack"===t.type||"github"===t.type)&&t.state&&"scopes"in t.state?t.state.scopes??[]:[]),[t.state,t.type]),h=(0,r().IS)((e=>({container:{alignItems:"center",border:`1px solid ${e.stroke.secondary}`,borderRadius:12,display:"flex",flexDirection:"column",gap:12,justifyContent:"center",marginTop:16,padding:"32px 14px",textAlign:"center"},mainText:{maxWidth:400},chevronIcon:{fill:e.icon.secondary,flex:"0 0 auto",height:14,marginLeft:5,width:14},connected:{marginTop:4},moduleIcon:{width:32,height:32},notionIcon:{width:32,height:32}})),[]),w=(0,a().tz)(),k=(0,o.useMemo)((()=>{const e=t.state;return e&&"connectionPointer"in e&&Boolean(e.connectionPointer)?de().d.getDescription(t,w):null}),[w,t]);return k?(0,D.jsxs)("div",{style:h.container,children:[(0,D.jsx)("header",{children:(0,D.jsx)(Ae,{moduleValue:t})}),(0,D.jsxs)(re().Y1,{direction:"horizontal",align:"center",gap:4,style:{flex:1},children:[(0,D.jsx)("span",{style:h.moduleIcon,children:s(h.moduleIcon)}),(0,D.jsx)(ae().Q,{iconGroup:ne,colorName:"secondary",variantName:"large",style:{height:30,width:30}}),(0,D.jsx)("span",{style:h.notionIcon,children:(0,ie().notionIcon)(h.notionIcon)})]}),(0,D.jsx)(le().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",style:h.mainText,children:k}),(0,D.jsx)("div",{style:h.connected,children:(0,D.jsx)(je,{module:t,moreMenuText:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(le().D,{styleName:"UIRegular-14px/Regular",children:(0,D.jsx)(a().sA,{...We.connected})}),(0,oe().e)(h.chevronIcon)]}),removeModule:i,saveModule:l,workflowDefinitionPointer:n})}),k&&(0,D.jsxs)(re().Y1,{align:"center",direction:"horizontal",gap:8,children:[f&&(0,D.jsx)(Ue,{allowedScopes:d,onMenuItemClick:p,selectedScopes:m}),u&&c&&(0,D.jsx)(se().A,{color:"uiBlue",onClick:()=>alert("TODO(danelliottpalmer): implement sharing to the space"),size:"lg",children:(0,D.jsx)(a().sA,{defaultMessage:"Share connection with space",id:"workflow.module.github.shareConnectionWithSpace"})})]})]}):null}var Oe=()=>n(280335),Be=()=>n(574387);const qe=(0,a().YK)({fixConnection:{id:"workflowModuleInvalidView.fixConnection",defaultMessage:"Fix connection"}});function Fe(e){let{module:t,removeModule:n,saveModule:o,workflowDefinitionPointer:l,workflowValue:s}=e;const d=(0,r().IS)((e=>({container:{alignItems:"center",border:`1px solid ${e.stroke.secondary}`,borderRadius:12,display:"flex",flexDirection:"column",gap:8,justifyContent:"center",marginTop:16,padding:"32px 14px",textAlign:"center"},mainText:{maxWidth:400},chevronIcon:{fill:e.icon.secondary,flex:"0 0 auto",height:14,marginLeft:5,width:14},fixConnection:{marginTop:8}})),[]),c=(0,a().tz)(),u=(0,i().K8)((()=>{if(t&&s&&!(0,Be().dv)({module:t,workflowValue:s}))return de().d.getMessageIfNotValid(t,c,"App")}),[t,c,s]);return u?(0,D.jsxs)("div",{style:d.container,children:[(0,D.jsx)(ae().Q,{iconGroup:Oe().Z,variantName:"large",colorName:"redPrimary",style:{height:35,width:35}}),(0,D.jsx)(le().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",style:d.mainText,children:u}),(0,D.jsx)("div",{style:d.fixConnection,children:(0,D.jsx)(je,{module:t,moreMenuText:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(le().D,{styleName:"UIRegular-14px/Regular",children:(0,D.jsx)(a().sA,{...qe.fixConnection})}),(0,oe().e)(d.chevronIcon)]}),removeModule:n,saveModule:o,workflowDefinitionPointer:l})})]}):null}function _e(e){const{module:t,isInTranscript:n,workflowValue:o,workflowDefinitionPointer:i,removeModule:r,saveModule:a,workflowModuleStore:l}=e,s=!(!t.state||!("connectionPointer"in t.state))&&Boolean(t.state.connectionPointer),d=(0,g().yC)(t),c=a,u=r;return s&&!n?(0,D.jsx)(ze,{module:d,removeModule:u,saveModule:c,workflowDefinitionPointer:i}):s||n?!s&&n?(0,D.jsx)(ee,{moduleValue:d,workflowDefinitionPointer:i,workflowModuleStore:l}):null:(0,D.jsx)(Fe,{module:d,removeModule:u,saveModule:c,workflowDefinitionPointer:i,workflowValue:o})}const $e=(0,a().YK)({getEvents:{defaultMessage:"Retrieved a Calendar event",id:"workflow.run.effect.calendar.getEvents.description"},selectAllCalendars:{defaultMessage:"Select all calendars",id:"workflow.calendar.selectAllCalendars"},propertyPickerLabel:{defaultMessage:"Calendars",id:"workflow.calendar.propertyPickerLabel"}}),Ye={triggers:{},effect:{"calendar.getEvents":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage($e.getEvents)}}},ModuleConfiguration:_e,configVariables:{calendar:{ConfigurationComponent:function(){return(0,D.jsx)("div",{children:"Calendar Configuration"})}},multipleOrAllCalendar:{ConfigurationComponent:function(e){let{variable:t,setVariable:n}=e;const g=(0,r().IS)((e=>({buttonMenuItemContent:{height:34,gap:6},buttonMenuItem:{borderRadius:4},inputLabel:{color:e.text.secondary,fontSize:s().J.UIRegular.desktop},input:{backgroundColor:e.contentBackground,paddingTop:6,paddingBottom:6}})),[]),p=(0,r().IS)((e=>({sectionMenuItem:{padding:8},propertyPickerContainer:{display:"flex",flexDirection:"column",border:`1px solid ${e.regularDividerColor}`,borderRadius:8,maxHeight:212,overflowY:"auto",marginBottom:2},selectAllCalendarsButtonTitle:{display:"flex",alignItems:"center",gap:4},selectAllCalendarsCheckboxContainer:{height:34,width:30,display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:4},selectAllCalendarsCheckbox:{cursor:"pointer"}})),[]),m=(0,i().K8)((()=>f().A.getCurrentAccountIds()),[]),h=(0,i().K8)((()=>m.map((e=>({account:f().A.getAccount(e),calendars:f().A.getCalendarsForAccount(e)})))),[m]),w=(0,o.useCallback)((()=>{null!=t&&t.allCalendars?n({allCalendars:!1,calendars:[]}):n({allCalendars:!0})}),[t,n]),k=(0,o.useCallback)((e=>{if(!t||t.allCalendars||!t.calendars)return void n({allCalendars:!1,calendars:[e]});const o=t.calendars.some((t=>t.calendarId===e.calendarId));n(o?{allCalendars:!1,calendars:t.calendars.filter((t=>t.calendarId!==e.calendarId))}:{allCalendars:!1,calendars:[...t.calendars,e]})}),[t,n]),v=(null==t?void 0:t.allCalendars)??!1,y=(0,o.useMemo)((()=>[{key:"all-calendars",render:e=>(0,D.jsx)(u().A,{...e,style:p.sectionMenuItem}),items:[{key:0,render:e=>(0,D.jsx)(d().A,{...e,style:g.buttonMenuItemContent,buttonStyle:g.buttonMenuItem,title:(0,D.jsx)("div",{style:p.selectAllCalendarsButtonTitle,children:(0,D.jsx)(a().sA,{...$e.selectAllCalendars})}),leftStyle:p.selectAllCalendarsCheckboxContainer,left:(0,D.jsx)("input",{type:"checkbox",readOnly:!0,checked:v,style:p.selectAllCalendarsCheckbox})}),action:w}]},...(0,l().oE)(h.map((e=>{let{account:n,calendars:o}=e;if(n&&0!==o.length)return{key:n.id,render:e=>(0,D.jsx)(u().A,{...e,style:p.sectionMenuItem}),items:o.map((e=>({key:e.id,action:()=>k({calendarId:e.id,accountId:n.id}),render:n=>{var o;const i=Boolean(v||!1===(null==t?void 0:t.allCalendars)&&(null===(o=t.calendars)||void 0===o?void 0:o.some((t=>e.id===t.calendarId))));return(0,D.jsx)(d().A,{...n,disabled:null==t?void 0:t.allCalendars,style:g.buttonMenuItemContent,buttonStyle:g.buttonMenuItem,title:(0,D.jsx)("div",{style:p.selectAllCalendarsButtonTitle,children:e.name}),leftStyle:p.selectAllCalendarsCheckboxContainer,left:(0,D.jsx)("input",{disabled:null==t?void 0:t.allCalendars,type:"checkbox",readOnly:!0,checked:i,style:p.selectAllCalendarsCheckbox})})}})))}})))]),[w,h,p,g,v,k,t]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("label",{style:g.inputLabel,children:(0,D.jsx)(a().sA,{...$e.propertyPickerLabel})}),(0,D.jsx)("div",{style:p.propertyPickerContainer,children:(0,D.jsx)(c().Ay,{type:c().Oh.Vertical,sections:y,initialFocus:void 0,resetFocusOnMouseOut:!0})})]})}}}};const Ke=(0,a().YK)({codegenRun:{defaultMessage:"Started a Codegen run",id:"workflow.run.effect.codegen.run.description"},codegenRunStatus:{defaultMessage:"Checked the status of a Codegen run",id:"workflow.run.effect.codegen.runStatus.description"}}),Ge={triggers:{},effect:{"codegen.run":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Ke.codegenRun)}},"codegen.runStatus":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Ke.codegenRunStatus)}}},ModuleConfiguration:_e};n(672577),n(908872);var He=()=>n(395361),Ze=()=>n(825043);const Je={triggers:{},effect:{},ModuleConfiguration:function(e){const{workflowValue:t,workflowDefinitionPointer:o,isInTranscript:i,saveConfigVariable:r}=e,{modules:a=[]}=t??{},s=a.reduce(((e,o)=>{const r=(0,n(342967).v)(t??{},o.id),a=i?Object.fromEntries((0,Pe().WP)(r).filter((e=>{let[t,o]=e;return(0,n(788060).J)(o)}))):r;return Object.keys(a).length>0&&(e[o.id]=a),e}),{}),d=Object.keys(s).map((e=>{const t=a.find((t=>t.id===e));if(!t)throw new Error(`Module ${e} not found`);return t})),c=(0,l().oE)(d.map((e=>t?(0,D.jsx)(Qe,{module:e,workflowValue:t,workflowDefinitionPointer:o,saveConfigVariable:r,moduleConfigVariables:s,shouldShowModuleName:d.length>1,isInTranscript:i},e.id):null))),u=(0,Ze().Q)(c);if(0===c.length)return null;return(0,D.jsx)(re().Y1,{direction:"vertical",gap:16,children:i?u:c})},configVariables:{string:{ConfigurationComponent:function(e){const{variable:t,setVariable:n}=e,[i,a]=(0,o.useState)(t??""),l=(0,He().Y)((e=>n(e||void 0))),s=(0,r().IS)((e=>({input:{width:"100%",boxShadow:e.inputBoxShadow,borderRadius:6,padding:"4px 10px"}})),[]),d=(0,o.useCallback)((e=>{a(e.target.value),l(e.target.value)}),[l]);return(0,D.jsx)(I().A,{capture:!0,render:e=>(0,D.jsx)("div",{...e,children:(0,D.jsx)(j().A,{value:i,onChange:d,placeholder:"Enter value...",style:s.input,showClearButton:!0,onClearButtonClick:()=>{a(""),n(void 0)}})})})}}}};function Qe(e){const{module:t,workflowValue:n,workflowDefinitionPointer:i,saveConfigVariable:l,moduleConfigVariables:s,shouldShowModuleName:d,isInTranscript:c}=e,u=s[t.id],f=(0,a().tz)(),g=(0,r().IS)((e=>({moduleSection:{marginTop:12}})),[]);if(!u)throw new Error(`No config variables found for module ${t.id}`);const p=Z().Nh[t.type],m=Tn[t.type];if(!p||!m)throw new Error(`Module definition or client definition not found for module ${t.id}`);if(!("configVariables"in m))throw new Error(`Config variables not found for module ${t.id}`);const h=m.configVariables,w=de().d.getName(t,f),k=Object.entries(u),v=(0,o.useMemo)((()=>k.map((e=>{let[o,r]=e;const a=h[r.rootType];if(!a)throw new Error(`configVariableDefinitions for ${r.rootType} is not defined`);const s=a.ConfigurationComponent;if(!s)throw new Error(`ConfigurationComponent for ${r.rootType} is not defined`);return(0,D.jsx)(Xe,{ConfigurationComponent:s,module:t,saveConfigVariable:l,variable:r,workflowDefinitionPointer:i,workflowValue:n,isInTranscript:c},o)}))),[h,k,c,t,l,i,n]),y=(0,Ze().Q)(v);return(0,D.jsxs)(re().Y1,{direction:"vertical",gap:8,style:g.moduleSection,children:[d&&(0,D.jsx)(le().D,{styleName:"UIHeading-17px/Regular",children:w}),c?y:v]},t.id)}function Xe(e){const{ConfigurationComponent:t,isInTranscript:n,module:i,saveConfigVariable:r,variable:a,workflowDefinitionPointer:l,workflowValue:s}=e,d=(0,o.useCallback)((e=>{r({...a,value:e})}),[r,a]);return(0,D.jsxs)(re().Y1,{direction:"vertical",gap:4,children:[(0,D.jsxs)(re().Y1,{direction:"vertical",children:[(0,D.jsx)(le().D,{styleName:"UIRegular-14px/Medium",children:a.key}),(0,D.jsx)(le().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:a.description})]}),(0,D.jsx)(t,{isInTranscript:n,moduleId:i.id,setVariable:d,variable:a.value,workflowDefinitionPointer:l,workflowValue:s},a.key)]})}const et=(0,a().YK)({getFileName:{defaultMessage:"Retrieved the name of a file",id:"workflow.run.effect.files.getFileName.description"},getFileContent:{defaultMessage:"Retrieved the content of a file",id:"workflow.run.effect.files.getFileContent.description"},getFileUrl:{defaultMessage:"Retrieved the URL of a file",id:"workflow.run.effect.files.getFileUrl.description"}}),tt={triggers:{},effect:{"files.getFileName":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(et.getFileName)}},"files.getFileContent":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(et.getFileContent)}},"files.getFileUrl":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(et.getFileUrl)}}}};var nt=()=>n(771111),ot=()=>n(671593),it=()=>n(802790),rt=(n(944114),()=>n(187174)),at=()=>n(253673),lt=()=>n(737693),st=()=>n(696706);const dt={calendar:void 0,codegen:void 0,config:void 0,files:void 0,github:async function(e){const{environment:t,moduleValue:n,workflowDefinitionPointer:o,workflowModuleStore:i}=e,{spaceId:r,transcriptId:a,workflowId:l}=(0,h().kI)(o),s=await C().callApi({eventName:"getViaWorkflowModuleConfigurationUtil",environment:t,data:{moduleId:n.id,spaceId:r,transcriptId:a,workflowId:l,workflowModuleId:null==i?void 0:i.id,moduleType:n.type,callArguments:{functionName:"getGithubConnections",functionArgs:[]}}});if("success"===s.type){if("getGithubConnections"!==s.data.functionName)throw new Error(`Invalid function name: ${s.data.functionName} from response for moduleId: ${n.id}`);const e=[];return s.data.functionReturn.personal.length>0&&e.push({icon:void 0,items:s.data.functionReturn.personal.map((e=>({icon:at().z,pointer:st().L3.fromPointerLike({id:e.id,table:ce().tE,spaceId:o.spaceId}),searchTitle:e.installationName,title:e.installationName}))),title:"Personal"}),s.data.functionReturn.space.length>0&&e.push({icon:void 0,items:s.data.functionReturn.space.map((e=>({icon:lt().V,pointer:st().L3.fromPointerLike({id:e.id,table:ce().tE,spaceId:o.spaceId}),searchTitle:e.installationName,title:e.installationName}))),title:"Space"}),s.data.functionReturn.available.length>0&&e.push({icon:void 0,items:s.data.functionReturn.available.map((e=>({icon:"Organization"===e.installationType?lt().V:at().z,onClick:async()=>{const o=await C().callApi({eventName:"getViaWorkflowModuleConfigurationUtil",environment:t,data:{moduleId:n.id,spaceId:r,transcriptId:a,workflowId:l,workflowModuleId:null==i?void 0:i.id,moduleType:"github",callArguments:{functionName:"createPersonalConnection",functionArgs:[{installationId:e.installationId}]}}});if("success"===o.type){if("createPersonalConnection"!==o.data.functionName)throw new Error(`Invalid function name: ${o.data.functionName} from response for moduleId: ${n.id}`);if(o.data.functionReturn.connectionPointer)return o.data.functionReturn.connectionPointer}throw new Error("Error creating personal connection")},searchTitle:e.installationName,title:e.installationName}))),title:"Available"}),{sections:e}}return{sections:[]}},mcpServer:void 0,notion:void 0,notionmail:void 0,pipedream:void 0,slack:async function(e){const{environment:t,moduleValue:n,workflowDefinitionPointer:o,workflowModuleStore:i}=e,{spaceId:r,transcriptId:a,workflowId:l}=(0,h().kI)(o),s=await C().callApi({eventName:"getViaWorkflowModuleConfigurationUtil",environment:t,data:{moduleId:n.id,spaceId:r,transcriptId:a,workflowId:l,workflowModuleId:null==i?void 0:i.id,moduleType:n.type,callArguments:{functionName:"getSlackConnections",functionArgs:[]}}});if("success"===s.type){if("getSlackConnections"!==s.data.functionName)throw new Error(`Invalid function name: ${s.data.functionName} from response for moduleId: ${n.id}`);const e=[];return s.data.functionReturn.personal.length>0&&e.push({icon:void 0,items:s.data.functionReturn.personal.map((e=>({icon:void 0,pointer:st().L3.fromPointerLike({id:e.id,table:ce().tE,spaceId:o.spaceId}),searchTitle:e.name,title:e.name}))),title:"Personal"}),s.data.functionReturn.space.length>0&&e.push({icon:void 0,items:s.data.functionReturn.space.map((e=>({icon:void 0,pointer:st().L3.fromPointerLike({id:e.id,table:ce().tE,spaceId:o.spaceId}),searchTitle:e.name,title:e.name}))),title:"Space"}),{sections:e}}return{sections:[]}},zendesk:void 0};function ct(e){const{moduleValue:t,workflowDefinitionPointer:n,workflowModuleStore:o}=e,i=(0,m().v3)(),[r,a]=(0,rt().Yb)((async()=>{const e=null==dt?void 0:dt[t.type];if(e)return await e({environment:i,moduleValue:(0,de().S)(t),workflowDefinitionPointer:n,workflowModuleStore:o});throw new Error(`No API call found for module type: ${t.type}`)}),[i,t,n,o]);return[r,a]}function ut(e){const{children:t,isDisabled:n}=e,o=(0,r().IS)((()=>({container:{opacity:n?.4:1,pointerEvents:n?"none":"auto"}})),[n]);return(0,D.jsx)(re().Y1,{align:"center",direction:"horizontal",gap:"auto",style:o.container,children:t})}function ft(e){const{children:t}=e,n=(0,r().IS)((e=>({leftColumn:{flex:"0 60%"}})),[]);return(0,D.jsx)(re().Y1,{direction:"vertical",gap:6,style:n.leftColumn,children:t})}function gt(e){const{children:t}=e;return(0,D.jsx)("div",{children:t})}var pt=()=>n(962730),mt=()=>n(818541),ht=()=>n(778078),wt=()=>n(419357),kt=()=>n(64e3);function vt(e){const{connections:t,onMenuItemClick:n,onMenuItemConnectClick:i}=e,{isMobile:r}=(0,m().Y0)(),[l,s]=(0,o.useState)(""),f=l.length>0,g=(0,o.useCallback)((e=>{s(e.target.value)}),[s]),p=(0,He().Y)(g,100),h=(0,o.useMemo)((()=>({key:"search",items:[{action:()=>{},key:"search-input",render:e=>(0,D.jsx)(wt().Ay,{...e,autoFocus:!r,onChange:p,showClearButton:!0,value:l})}],render:e=>(0,D.jsx)(u().A,{...e,isInput:!0})})),[p,r,l]),w=(0,o.useMemo)((()=>{const e=t.sections.filter((e=>e.items.length>0));return f?{sections:e.map((e=>({...e,items:(0,ht().Ay)(l,e.items,(e=>e.searchTitle))})))}:{sections:e}}),[t,f,l]),k=(0,o.useMemo)((()=>{const e=[];for(let t=0;t<w.sections.length;t++){const o=w.sections[t],i=e.length>0;0===o.items.length?e.push({key:`${t}-no-results`,items:[{key:`${t}-item-no-results`,action:()=>{},render:e=>(0,D.jsx)(kt().A,{...e,title:(0,D.jsx)(a().sA,{defaultMessage:"No connections found",id:"workflow.module.slack.connectionPickerMenu.noPersonalConnectionsResults"})})}],render:e=>(0,D.jsx)(u().A,{...e,title:o.title,topBorder:i})}):e.push({key:`${t}-no-results`,items:o.items.map(((e,o)=>({action:async()=>{let t;t="onClick"in e?await e.onClick():e.pointer,n({pointer:t,name:e.title})},key:`${t}-${o}`,render:t=>(0,D.jsx)(d().A,{...t,icon:e.icon?e.icon({height:16,width:16}):void 0,title:e.title})}))),render:e=>(0,D.jsx)(u().A,{...e,title:o.title,topBorder:i})})}return e}),[w.sections,n]),v=(0,o.useMemo)((()=>{const e=[h,...k];return e.push({key:"miscellaneous",items:[{key:"install-new-connection",action:i,render:e=>(0,D.jsx)(d().A,{...e,icon:(0,mt().V)({height:16,width:16}),title:(0,D.jsx)(a().sA,{defaultMessage:"Connect another account",id:"workflow.module.slack.connectionPickerMenu.connectAnotherAccountButtonTitle"})})},{key:"disconnect-connection",action:()=>n(void 0),render:e=>(0,D.jsx)(d().A,{...e,icon:(0,me().trashIcon)({height:16,width:16}),title:(0,D.jsx)(a().sA,{defaultMessage:"Disconnect",id:"workflow.module.slack.connectionPickerMenu.disconnectButtonTitle"})})}],render:t=>(0,D.jsx)(u().A,{...t,topBorder:e.length>0,extraTopPadding:e.length>0})}),e}),[k,n,i,h]);return(0,D.jsx)(ke().A,{maxWidth:265,menuType:r?ve().gu.Modal:ve().gu.Popup,children:(0,D.jsx)(c().Ay,{initialFocus:0,sections:v,type:c().Oh.Vertical})})}function yt(e){const{asyncConnections:t,moduleValue:n,onMenuItemClick:l,selectedScopedExternalConnectionStore:s,workflowDefinitionPointer:d,workflowModuleStore:c}=e,{isMobile:u}=(0,m().Y0)(),f=(0,i().uB)(void 0,xe().A),{handleConnect:g,authDetailModalArgs:p}=X({moduleValue:n,workflowDefinitionPointer:d,workflowModuleStore:c}),h=(0,r().IS)((e=>({chevronDownIcon:{height:16,width:16},plainButton:{gap:4},warningIcon:{fill:e.icon.uiRedPrimary}})),[]),w=(0,i().K8)((()=>null==s?void 0:s.getName()),[s]),k=(0,o.useCallback)((()=>{g(),f.reset()}),[g,f]),v=(0,o.useCallback)((e=>{l(e),f.reset()}),[l,f]);let y,x,C=!0;return"idle"===t.status||"pending"===t.status?y=e=>(0,D.jsxs)(se().A,{...e,disabled:!0,disabledFeedback:!0,isLoading:!0,size:"lg",style:h.plainButton,children:[(0,D.jsx)("span",{children:(0,D.jsx)(a().sA,{defaultMessage:"Loading connections",id:"workflow.module.slack.connectionPicker.loading"})}),(0,De().arrowChevronSingleDownIcon)(h.chevronDownIcon)]}):"resolved"===t.status?(y=e=>(0,D.jsxs)(se().A,{...e,iconLeading:(0,Pe().O9)(w)?void 0:Te().exclamationMarkTriangleFillIcon,iconStyle:h.warningIcon,size:"lg",style:h.plainButton,children:[(0,D.jsx)("span",{children:(0,Pe().O9)(w)?w:(0,D.jsx)(a().sA,{defaultMessage:"Select a connection",id:"workflow.module.slack.connectionPicker.select"})}),(0,De().arrowChevronSingleDownIcon)(h.chevronDownIcon)]}),C=!1,x=t.value):"rejected"===t.status?y=e=>(0,D.jsxs)(se().A,{...e,iconLeading:Te().exclamationMarkTriangleFillIcon,size:"lg",style:h.plainButton,children:[(0,D.jsx)("span",{children:(0,D.jsx)(a().sA,{defaultMessage:"Error loading connections",id:"workflow.module.slack.connectionPicker.error"})}),(0,De().arrowChevronSingleDownIcon)(h.chevronDownIcon)]}):(0,Pe().HB)(t),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(he().Ay,{alignmentToOrigin:pt().C.End,buttonPopupStore:f,disablePopup:C,originGap:4,popupType:u?he().z7.BottomSheet:he().z7.Popup,render:e=>x?(0,D.jsx)(vt,{connections:x,onMenuItemConnectClick:k,onMenuItemClick:v}):null,renderOrigin:y}),(0,D.jsx)(R,{...p})]})}function xt(e){const{moduleValue:t,saveModule:n,workflowDefinitionPointer:i,workflowModuleStore:r}=e,{scopedExternalConnectionStore:l}=ge({moduleValue:t}),[s,d]=ct({moduleValue:t,workflowDefinitionPointer:i,workflowModuleStore:r}),c=(0,o.useCallback)((e=>{n({...t,state:{...t.state,connectionPointer:null==e?void 0:e.pointer}})}),[t,n]);return(0,D.jsxs)(ut,{children:[(0,D.jsxs)(ft,{children:[(0,D.jsx)(le().D,{colorName:"primary",styleName:"UIRegular-14px/Regular",children:(0,D.jsx)(a().sA,{defaultMessage:"Source",id:"workflows.modules.configurationConnection.title"})}),(0,D.jsx)(le().D,{id:"languageSettings.languageSwitcher.subtitle",styleName:"UIMedium-13px/Regular",colorName:"secondary",children:(0,D.jsx)(a().sA,{defaultMessage:"The primary source of information for this connection.",id:"workflows.modules.configurationConnection.subtitle"})})]}),(0,D.jsx)(gt,{children:"resolved"===s.status&&0===s.value.sections.length?(0,D.jsx)(ee,{moduleValue:t,workflowDefinitionPointer:i,workflowModuleStore:r}):(0,D.jsx)(yt,{asyncConnections:s,moduleValue:t,onMenuItemClick:c,selectedScopedExternalConnectionStore:l,workflowDefinitionPointer:i,workflowModuleStore:r})})]})}var Ct=()=>n(843189);function Mt(e){const{onRemoveClick:t}=e;return(0,D.jsxs)(ut,{children:[(0,D.jsxs)(ft,{children:[(0,D.jsx)(le().D,{colorName:"primary",styleName:"UIRegular-14px/Regular",children:(0,D.jsx)(a().sA,{defaultMessage:"Remove connection",id:"workflows.modules.configurationRemoveModule.title"})}),(0,D.jsx)(le().D,{id:"languageSettings.languageSwitcher.subtitle",styleName:"UIMedium-13px/Regular",colorName:"secondary",children:(0,D.jsx)(a().sA,{defaultMessage:"Permanently delete this connection from the app.",id:"workflows.modules.configurationRemoveModule.subtitle"})})]}),(0,D.jsx)(gt,{children:(0,D.jsx)(Ct().E,{color:"uiRed",onClick:t,size:"lg",children:(0,D.jsx)(a().sA,{defaultMessage:"Remove",id:"workflow.modules.configurationRemoveModule.removeConnection"})})})]})}function It(e){const{isDisabled:t,moduleValue:n,saveModule:r,workflowModuleStore:l}=e,{state:s}=n,{allowedScopes:d}=ge({moduleValue:n}),c=(0,i().K8)((()=>{const e=l?l.getData():s;return e&&"scopes"in e&&Array.isArray(e.scopes)&&e.scopes.length>0?e.scopes.filter((e=>"string"==typeof e)):[]}),[l,s]),u=(0,o.useCallback)((e=>{"slack"!==n.type&&"github"!==n.type||r({...n,state:{...n.state,scopes:e}})}),[n,r]);return(0,D.jsxs)(ut,{isDisabled:t,children:[(0,D.jsxs)(ft,{children:[(0,D.jsx)(le().D,{colorName:"primary",styleName:"UIRegular-14px/Regular",children:(0,D.jsx)(a().sA,{defaultMessage:"Scopes",id:"workflows.modules.configurationScopes.title"})}),(0,D.jsx)(le().D,{id:"languageSettings.languageSwitcher.subtitle",styleName:"UIMedium-13px/Regular",colorName:"secondary",children:(0,D.jsx)(a().sA,{defaultMessage:"Adjust what this connection will be able to do.",id:"workflows.modules.configurationScopes.subtitle"})})]}),(0,D.jsx)(gt,{children:(0,D.jsx)(Ue,{allowedScopes:d,onMenuItemClick:u,selectedScopes:c})})]})}function jt(e){const{isDisabled:t}=e;return(0,D.jsxs)(ut,{isDisabled:t,children:[(0,D.jsxs)(ft,{children:[(0,D.jsx)(le().D,{colorName:"primary",styleName:"UIRegular-14px/Regular",children:(0,D.jsx)(a().sA,{defaultMessage:"Share with space",id:"workflows.modules.configurationShareWithSpace.title"})}),(0,D.jsx)(le().D,{id:"languageSettings.languageSwitcher.subtitle",styleName:"UIMedium-13px/Regular",colorName:"secondary",children:(0,D.jsx)(a().sA,{defaultMessage:"Allow other users in the space to use this connection. Only workspace admins can do this.",id:"workflows.modules.configurationShareWithSpace.subtitle"})})]}),(0,D.jsx)(gt,{children:(0,D.jsx)(Ct().E,{color:"uiBlue",onClick:()=>alert("TODO(danelliottpalmer): implement sharing to the space"),size:"lg",children:(0,D.jsx)(a().sA,{defaultMessage:"Share connection",id:"workflow.modules.configurationShareWithSpace.shareConnection"})})})]})}function bt(e){const{children:t,moduleValue:n}=e,o=(0,r().IS)((e=>({container:{alignItems:"center",border:`1px solid ${e.stroke.secondary}`,borderRadius:12,display:"flex",flexDirection:"column",gap:24,justifyContent:"center",marginBlock:16,paddingBlock:32,paddingInline:24,width:"100%"},section:{maxWidth:700,width:"100%"}})),[]);return(0,D.jsxs)("div",{style:o.container,children:[(0,D.jsx)("header",{children:(0,D.jsx)(Ae,{moduleValue:n})}),(0,D.jsx)("section",{style:o.section,children:t})]})}var St=()=>n(493823),At=()=>n(8980);function Dt(e){const{moduleValue:t,onUndoClick:n,saveModule:i,workflowDefinitionPointer:l,workflowModuleStore:s}=e,d=(0,a().tz)(),c=(0,r().IS)((e=>({wrapper:{alignItems:"center",backgroundColor:"dark"===e.mode?e.surface.elevated:e.contentBackground,border:`0.5px solid ${e.stroke.primary}`,borderRadius:10,overflow:"hidden",padding:12},label:{flex:"1 0 auto"}})),[]),{scopedExternalConnectionStore:u}=ge({moduleValue:t}),[f,g]=ct({moduleValue:t,workflowDefinitionPointer:l,workflowModuleStore:s}),p=(0,o.useCallback)((e=>{i({...t,state:{...t.state,connectionPointer:null==e?void 0:e.pointer}})}),[t,i]),m=de().d.getIcon(t.type);return(0,D.jsxs)(re().Y1,{direction:"horizontal",gap:8,height:"hug",style:c.wrapper,width:"fill",children:[(0,D.jsx)(At().I,{icon:m}),(0,D.jsx)(le().D,{colorName:"primary",styleName:"UIRegular-14px/Medium",style:c.label,children:(0,D.jsx)(a().sA,{defaultMessage:"Connect to {moduleName}",id:"workflows.modules.workflowModuleTranscriptConnections.connectLabel",values:{moduleName:de().d.getName(t,d)}})}),n?(0,D.jsx)(St().p,{isBlue:!0,onClick:n,children:(0,D.jsx)(le().D,{styleName:"UIRegular-14px/Medium",children:(0,D.jsx)(a().sA,{defaultMessage:"Undo",id:"workflows.modules.workflowModuleTranscriptConnections.undo"})})}):null,"resolved"===f.status&&0===f.value.sections.length?(0,D.jsx)(ee,{moduleValue:t,workflowDefinitionPointer:l,workflowModuleStore:s}):(0,D.jsx)(yt,{asyncConnections:f,moduleValue:t,onMenuItemClick:p,selectedScopedExternalConnectionStore:u,workflowDefinitionPointer:l,workflowModuleStore:s})]})}const Tt=(0,a().YK)({getPullRequestLoading:{defaultMessage:"Fetching a pull request for a repository",id:"workflow.run.effect.github.getPullRequestLoading.description"},getPullRequestLoaded:{defaultMessage:"Fetched a pull request for a repository",id:"workflow.run.effect.github.getPullRequestLoaded.description"},getPullRequestLoadingDynamic:{defaultMessage:"Fetching a pull request for the repository: {githubRepo}",id:"workflow.run.effect.github.getPullRequestLoadingDynamic.description"},getPullRequestLoadedDynamic:{defaultMessage:"Fetched a pull request for the repository: {githubRepo}",id:"workflow.run.effect.github.getPullRequestLoadedDynamic.description"},getUserLoaded:{defaultMessage:"Fetched a Github user",id:"workflow.run.effect.github.getUserLoaded.description"},getUserLoading:{defaultMessage:"Fetching a Github user",id:"workflow.run.effect.github.getUserLoading.description"},getUserLoadingDynamic:{defaultMessage:"Fetching the Github user: {githubUsername}",id:"workflow.run.effect.github.getUserLoadingDynamic.description"},getUserLoadedDynamic:{defaultMessage:"Fetched the Github user: {githubUsername}",id:"workflow.run.effect.github.getUserLoadedDynamic.description"},listPullRequestsLoading:{defaultMessage:"Fetching pull requests for a repository",id:"workflow.run.effect.github.listPullRequestsLoading.description"},listPullRequestsLoaded:{defaultMessage:"Fetched pull requests for a repository",id:"workflow.run.effect.github.listPullRequestsLoaded.description"},listPullRequestsLoadingDynamic:{defaultMessage:"Fetching pull requests for the repository: {githubRepo}",id:"workflow.run.effect.github.listPullRequestsLoadingDynamic.description"},listPullRequestsLoadedDynamic:{defaultMessage:"Fetched pull requests for the repository: {githubRepo}",id:"workflow.run.effect.github.listPullRequestsLoadedDynamic.description"},listOrganizationRepositoriesLoading:{defaultMessage:"Fetching repositories for an organization",id:"workflow.run.effect.github.listOrganizationRepositoriesLoading.description"},listOrganizationRepositoriesLoaded:{defaultMessage:"Fetched repositories for an organization",id:"workflow.run.effect.github.listOrganizationRepositoriesLoaded.description"},listOrganizationRepositoriesLoadingDynamic:{defaultMessage:"Fetching repositories for the organization: {githubOrganization}",id:"workflow.run.effect.github.listOrganizationRepositoriesLoadingDynamic.description"},listOrganizationRepositoriesLoadedDynamic:{defaultMessage:"Fetched repositories for the organization: {githubOrganization}",id:"workflow.run.effect.github.listOrganizationRepositoriesLoadedDynamic.description"},parseGithubUrlToParts:{defaultMessage:"Parse a Github URL to parts",id:"workflow.run.effect.github.parseGithubUrlToParts.description"}}),Pt={triggers:{},effect:{"github.getPullRequest":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t,isLoading:n,toolResultStep:o}=e;const i=null==o?void 0:o.input,r=(0,ot().Qq)(nt().sq,i);return r?n?t.formatMessage(Tt.getPullRequestLoadingDynamic,{githubRepo:r.repo}):t.formatMessage(Tt.getPullRequestLoadedDynamic,{githubRepo:r.repo}):n?t.formatMessage(Tt.getPullRequestLoading):t.formatMessage(Tt.getPullRequestLoaded)}},"github.getUser":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t,isLoading:n,toolResultStep:o}=e;const i=null==o?void 0:o.input,r=(0,ot().Qq)(nt().Hv,i);return r?n?t.formatMessage(Tt.getUserLoadingDynamic,{githubUsername:r.username}):t.formatMessage(Tt.getUserLoadedDynamic,{githubUsername:r.username}):n?t.formatMessage(Tt.getUserLoading):t.formatMessage(Tt.getUserLoaded)}},"github.listPullRequests":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t,isLoading:n,toolResultStep:o}=e;const i=null==o?void 0:o.input,r=(0,ot().Qq)(nt().jP,i);return r?n?t.formatMessage(Tt.listPullRequestsLoadingDynamic,{githubRepo:r.repo}):t.formatMessage(Tt.listPullRequestsLoadedDynamic,{githubRepo:r.repo}):n?t.formatMessage(Tt.listPullRequestsLoading):t.formatMessage(Tt.listPullRequestsLoaded)}},"github.listOrganizationRepositories":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t,isLoading:n,toolResultStep:o}=e;const i=null==o?void 0:o.input,r=(0,ot().Qq)(nt().z8,i);return r?n?t.formatMessage(Tt.listOrganizationRepositoriesLoadingDynamic,{githubOrganization:r.organization}):t.formatMessage(Tt.listOrganizationRepositoriesLoadedDynamic,{githubOrganization:r.organization}):n?t.formatMessage(Tt.listOrganizationRepositoriesLoading):t.formatMessage(Tt.listOrganizationRepositoriesLoaded)}},"github.parseGithubUrlToParts":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Tt.parseGithubUrlToParts)}}},ModuleConfiguration:function(e){const{isInTranscript:t,module:n,onUndoClick:i,removeModule:r,saveModule:a,workflowDefinitionPointer:l,workflowModuleStore:s}=e,d=(0,o.useMemo)((()=>{if(r)return function(){r(n)}}),[n,r]),{isWorkspaceAdmin:c,scopedExternalConnectionStore:u}=ge({moduleValue:n}),f=!(0,Pe().O9)(u);return(0,D.jsx)(re().Y1,{align:"center",direction:"vertical",gap:16,children:t?(0,D.jsx)(Dt,{moduleValue:n,onUndoClick:i,saveModule:a,workflowDefinitionPointer:l,workflowModuleStore:s}):(0,D.jsxs)(bt,{moduleValue:n,children:[(0,D.jsx)(xt,{moduleValue:n,saveModule:a,workflowDefinitionPointer:l,workflowModuleStore:s}),(0,D.jsx)(it().A,{size:24}),(0,D.jsx)(It,{isDisabled:f,moduleValue:n,saveModule:a,workflowModuleStore:s}),c?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(it().A,{size:24}),(0,D.jsx)(jt,{isDisabled:f})]}):null,d?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(it().A,{size:24}),(0,D.jsx)(Mt,{onRemoveClick:d})]}):null]})})}},Rt=(0,a().YK)({runTool:{defaultMessage:"Run tool with MCP server",id:"workflow.run.effect.mcpServer.runTool.description"},runToolWhileRunning:{defaultMessage:"Running tool with MCP server",id:"workflow.run.effect.mcpServer.runTool.descriptionWhileRunning"},serverUrlLabel:{defaultMessage:"Server URL",id:"workflow.module.mcpServer.serverUrl.label"},serverUrlPlaceholder:{defaultMessage:"Enter MCP server URL",id:"workflow.module.mcpServer.serverUrl.placeholder"}}),Et={triggers:{},effect:{"mcpServer.runTool":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t,isLoading:n}=e;return n?t.formatMessage(Rt.runToolWhileRunning):t.formatMessage(Rt.runTool)}}},ModuleConfiguration:e=>{var t;const{module:n,saveModule:o}=e;return(0,D.jsxs)("div",{children:[(0,D.jsx)("label",{htmlFor:"mcpserver-server-url",children:Rt.serverUrlLabel.defaultMessage}),(0,D.jsx)("input",{id:"mcpserver-server-url",type:"text",value:(null===(t=n.state)||void 0===t?void 0:t.serverUrl)||"",onChange:e=>{o({...n,state:{...n.state,serverUrl:e.target.value}})},placeholder:Rt.serverUrlPlaceholder.defaultMessage})]})}};var Lt=()=>n(353731),Vt=()=>n(244641),Nt=()=>n(597777),Ut=()=>n(548526),Wt=()=>n(131276),zt=()=>n(104636),Ot=()=>n(656134);function Bt(e){const{recurrenceTrigger:t,updateRecurrenceState:n}=e,i=(0,a().tz)(),r=(0,Ot().j)(),l=(0,o.useMemo)((()=>({frequency:t.frequency,hour:t.hour,interval:t.interval,minute:t.minute,timezone:t.timezone,..."week"===t.frequency&&{weekdays:t.weekdays},start_date:(0,Nt().Rz)(Vt().c9.local().set({hour:0,minute:0,second:0,millisecond:0}).toJSDate())})),[t]),s=l?(0,zt().LS)({intl:i,recurrence:l}):(0,D.jsx)(a().sA,{id:"RecurrenceTrigger.frequency",defaultMessage:"frequency"}),d=(0,Wt().$)({recurrence:l,disallowStart:!0,disallowEnd:!0,onChange:e=>{e&&n(e)},disabled:!1,autoFocusIfNew:!1});return(0,D.jsx)(he().Ay,{alignmentToOrigin:he().yP.End,disabled:!1,originGap:0,placementToOrigin:he().sx.Bottom,popupType:r,renderOrigin:e=>(0,D.jsx)(Ut().x,{...e,disabled:!1,isError:!1,hasActionRequired:!0,tooltipMessage:void 0,dropdownButtonType:"dropdown",children:s}),...d})}const qt=(0,a().YK)({recurrence:{defaultMessage:"Triggers every",id:"aiWorkflow.trigger.title.recurrence"}});const Ft={icon:n(918676).y,configuration:"minimal",description:qt.recurrence,ConfigurationComponent:function(e){const{blockStore:t,trigger:o,saveTrigger:i}=e,r=(0,n(324577).Y)(t);if(!o.state)throw new Error("Recurrence trigger state is required");if(!r)throw new Error("Workflow store is required");return(0,D.jsx)(Bt,{workflowStore:r,recurrenceTrigger:o.state,updateRecurrenceState:e=>{const t={...o,state:{frequency:e.frequency,hour:e.hour,interval:e.interval,minute:e.minute,timezone:e.timezone,type:"recurrence",weekdays:e.weekdays}};i(t)}})}};var _t=()=>n(584262),$t=()=>n(179034),Yt=()=>n(296798),Kt=()=>n(16006),Gt=()=>n(492414);function Ht(e){const{store:t,collectionId:n}=e,o=(0,i().K8)((()=>{if(!n)return;const e=t.getSpaceId();return e?ue().md.createChildStore(t,{id:n,table:"collection",spaceId:e}):void 0}),[n,t]),a=(0,i().K8)((()=>{if(!o)return;const e=o.getParentPointer();if(!e||e.table!==$t().ev)return;const t=ue().Bv.createChildStore(o,e);return(0,Gt().Ay)({store:t,fullyQualified:!1,pageVisitSource:_t().y8.LinkInPage})}),[o]),l=(0,r().IS)((e=>({container:{padding:"2px",borderRadius:4,margin:"-2px",overflow:"hidden"}})),[]);return o&&a?(0,D.jsx)(Yt().A,{href:a,style:l.container,children:(0,D.jsx)(Kt().A,{store:o,shouldWrap:!1})}):null}const Zt=(0,a().YK)({sendNotification:{defaultMessage:"Send notification",id:"workflows.modules.notion.sendNotification.description"},pageDiscussionCommentAdded:{defaultMessage:"When a comment is added to a page in",id:"aiWorkflow.trigger.title.notion.page.discussion.comment.added"},databasePageCreated:{defaultMessage:"When a page is created in",id:"aiWorkflow.trigger.title.notion.page.created"},databasePageUpdated:{defaultMessage:"When a page is updated in",id:"aiWorkflow.trigger.title.notion.page.updated"},databasePageDeleted:{defaultMessage:"When a page is deleted in",id:"aiWorkflow.trigger.title.notion.page.deleted"},getPageDiscussions:{defaultMessage:"Got the discussions for a page",id:"workflow.run.effect.discussions.getPageDiscussions.description"},addCommentToPage:{defaultMessage:"Added a comment to a page",id:"workflow.run.effect.discussions.addCommentToPage.description"},addCommentToDiscussion:{defaultMessage:"Added a comment to a discussion",id:"workflow.run.effect.discussions.addCommentToDiscussion.description"}});function Jt(e){const{trigger:t,blockStore:n}=e;if(!t.state)throw new Error("Trigger state is required");if(!t.state.collectionId)throw new Error("Collection ID is required in trigger state");if(!n)throw new Error("Block store is required - is this running inside of a thread?");return(0,D.jsx)(Ht,{store:n,collectionId:t.state.collectionId})}const Qt={triggers:{recurrence:Ft,"notion.page.discussion.comment.added":{icon:n(168345).L,configuration:"minimal",description:Zt.pageDiscussionCommentAdded,ConfigurationComponent:Jt},"notion.page.created":{icon:Lt().$,configuration:"minimal",description:Zt.databasePageCreated,ConfigurationComponent:Jt},"notion.page.updated":{icon:Lt().$,configuration:"minimal",description:Zt.databasePageUpdated,ConfigurationComponent:Jt},"notion.page.deleted":{icon:Lt().$,configuration:"minimal",description:Zt.databasePageDeleted,ConfigurationComponent:Jt}},effect:{"notion.sendNotification":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Zt.sendNotification)}},"notion.getPageDiscussions":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Zt.getPageDiscussions)}},"notion.addCommentToPage":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Zt.addCommentToPage)}},"notion.addCommentToDiscussion":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Zt.addCommentToDiscussion)}}}};const Xt=(0,a().YK)({notionMailEmailReceived:{defaultMessage:"When an email is received",id:"aiWorkflow.trigger.title.notionmail.email.received"}}),en={triggers:{"notionmail.email.received":{icon:n(254437).F,configuration:"minimal",description:Xt.notionMailEmailReceived}},effect:{},ModuleConfiguration:_e};const tn=(0,a().YK)({pipedreamAction:{defaultMessage:"Pipedream action",id:"aiWorkflow.trigger.title.pipedream.action"},action:{defaultMessage:"Pipedream action",id:"workflow.run.effect.pipedream.action.description"}}),nn={triggers:{"pipedream.trigger":{configuration:"minimal",description:tn.pipedreamAction,icon:n(481721).codeIcon}},effect:{"pipedream.action":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(tn.action)}}},ModuleConfiguration:_e};var on=()=>n(751109);n(823215);const rn={viewBox:"0 0 20 20",fittedViewBox:"4.12 1.37 11.76 17.26",svg:(0,D.jsx)("path",{d:"M9.558 1.558a.625.625 0 0 1 .884 0l.003.003 5.247 5.247a.625.625 0 1 1-.884.884L10 2.884 5.192 7.692a.625.625 0 1 1-.884-.884zm-.001 16.883-5.249-5.249a.625.625 0 0 1 .884-.884L10 17.116l4.808-4.808a.625.625 0 1 1 .884.884l-5.245 5.245-.005.005a.625.625 0 0 1-.885 0"})},an=(0,te().wt)("arrowChevronDoubleUpAndDown",rn);var ln=()=>n(392271),sn=()=>n(859428),dn=()=>n(628864),cn=()=>n(829e3);async function un(e){const{environment:t,externalAuthConfig:n,moduleId:o,workflowDefinitionPointer:i}=e,{workflowId:r,spaceId:a,transcriptId:l}=(0,h().kI)(i),s=await C().callApi({eventName:"getViaWorkflowModuleConfigurationUtil",environment:t,data:{workflowId:r,spaceId:a,transcriptId:l,moduleId:o,moduleType:"slack",callArguments:{functionName:"getExistingSlackChannels",functionArgs:[]}}});if("success"===s.type){if("getExistingSlackChannels"!==s.data.functionName)throw new Error("Invalid function name");cn().c.addChannelsForBot(n,s.data.functionReturn)}}function fn(e){var t,n;const{channelIds:l,isAllChannels:d,isInTranscript:c,isMultiSelectMode:u,moduleId:f,workflowDefinitionPointer:g,workflowValue:p,writeChannelIds:w}=e,k=l&&l.length>0,v=(0,i().uB)(void 0,xe().A),y=(0,o.useCallback)((()=>v.reset()),[v]),{spaceId:x}=(0,o.useMemo)((()=>(0,h().kI)(g)),[g]),M=null==p||null===(t=p.modules)||void 0===t?void 0:t.find((e=>e.id===f)),I=null==M||null===(n=M.state)||void 0===n?void 0:n.connectionPointer,j=(0,o.useMemo)((()=>I?{type:"workflow",workflowExternalScopedConnectionId:I.id}:void 0),[I]),b=(0,m().v3)(),{loadedChannelsForAccount:S,isLoading:A}=(0,dn().XN)(j),T=(0,o.useMemo)((()=>l&&l.length>=0&&l.every((e=>null==S?void 0:S.some((t=>t.id===e||t.name===e))))),[S,l]),P=(0,o.useMemo)((()=>l?l.map((e=>{const t=null==S?void 0:S.find((t=>t.id===e||t.name===e));return{id:(null==t?void 0:t.id)||e,type:(null==t?void 0:t.type)??"public",name:(null==t?void 0:t.name)??e,isMember:(null==t?void 0:t.isMember)??!1}})):void 0),[l,S]),R=(0,o.useMemo)((()=>null==P?void 0:P.filter((e=>!e.isMember))),[P]),E=(0,o.useMemo)((()=>{const e=[];if((0,Pe().O9)(R))for(const t of R)e.push((0,D.jsx)("br",{})),e.push(`#${t.name}`);return e}),[R]);o.useEffect((()=>{j&&x&&(un({environment:b,workflowDefinitionPointer:g,externalAuthConfig:j,moduleId:f}),(0,dn().Hn)({environment:b,spaceId:x,externalAuthConfig:j}))}),[b,x,j,g,f]),o.useEffect((()=>{j&&x&&l&&(un({environment:b,workflowDefinitionPointer:g,externalAuthConfig:j,moduleId:f}),async function(e){const{environment:t,externalAuthConfig:n,channelIds:o,moduleId:i,workflowDefinitionPointer:r}=e,{workflowId:a,spaceId:l,transcriptId:s}=(0,h().kI)(r),d=await C().callApi({eventName:"getViaWorkflowModuleConfigurationUtil",environment:t,data:{workflowId:a,spaceId:l,transcriptId:s,moduleId:i,moduleType:"slack",callArguments:{functionName:"getSlackChannelNames",functionArgs:[o]}}});if("success"===d.type){if("getSlackChannelNames"!==d.data.functionName)throw new Error("Invalid function name");cn().c.addChannelsForBot(n,d.data.functionReturn)}}({environment:b,workflowDefinitionPointer:g,externalAuthConfig:j,channelIds:l,moduleId:f}))}),[b,x,j,l,f,g]);const L=(0,Ot().j)(),V=(0,r().IS)((e=>({errorMessage:{fontWeight:s().Wy.bold},buttonInTranscript:{height:32},errorIcon:{color:e.icon.uiRedPrimary,cursor:"pointer",height:16,width:16},dropdownWithError:{display:"flex",alignItems:"center",justifyContent:"center",gap:4}})),[]),N=(0,o.useMemo)((()=>{const e=[];for(const t of P||[])e.push(t.name),e.push((0,D.jsx)("br",{}));return e}),[P]);if(!I)return(0,D.jsx)("div",{style:V.errorMessage,children:(0,D.jsx)(a().sA,{defaultMessage:"Log in with slack first",id:"workflows.targetPicker.slackNotConnected"})});const U=(0,D.jsx)(he().Ay,{alignmentToOrigin:he().yP.End,buttonPopupStore:v,disabled:!1,originGap:0,placementToOrigin:he().sx.Bottom,popupType:L,renderOrigin:e=>(0,D.jsx)(Ut().x,{...e,style:c?V.buttonInTranscript:{},disabled:!1,isError:!1,hasActionRequired:!k,tooltipMessage:N.length>0&&(0,D.jsx)("div",{children:N}),dropdownButtonType:"dropdown",dropdownIcon:c?an:void 0,children:d?(0,D.jsx)(a().sA,{defaultMessage:"Any channel",id:"workflows.targetPicker.anyChannel"}):T?(0,D.jsx)("span",{style:s().RC,children:null==P?void 0:P.map((e=>e.name)).join(", ")}):A?(0,D.jsx)(a().sA,{id:"workflows.targetPicker.loading",defaultMessage:"Loading channels"}):(0,D.jsx)(a().sA,{id:"workflows.targetPicker.noTarget",defaultMessage:"Select Slack channels"})}),render:()=>(0,D.jsx)(gn,{currentNotificationChannels:P,connectionPointer:I,channelIds:l,loadedChannelsForAccount:S,writeChannelIds:w,onClose:y,isAllChannels:d,isMultiSelectMode:u})});return T&&R&&R.length>0?(0,D.jsxs)("div",{style:V.dropdownWithError,children:[U,(0,D.jsx)(sn().A,{delayThreshold:0,placement:pt().W.Bottom,render:e=>(0,D.jsx)("div",{...e,children:(0,ln().x)(V.errorIcon)}),renderTooltip:()=>(0,D.jsx)(a().sA,{id:"workflows.targetPicker.channelsBotIsNotAMemberOf",defaultMessage:"Bot must be added to: {channels}",values:{channels:E}})})]}):U}function gn(e){const{connectionPointer:t,currentNotificationChannels:n,isAllChannels:i,loadedChannelsForAccount:l,isMultiSelectMode:d,writeChannelIds:u,onClose:f}=e,g=o.useCallback(((e,t)=>{const o=null==n?void 0:n.map((e=>e.id));if((null==o?void 0:o.includes(e.id))&&o)o.length>1&&u(o.filter((t=>t!==e.id)).map((e=>{const t=null==l?void 0:l.find((t=>t.id===e));return{channelId:e,channelName:(null==t?void 0:t.name)??e}})),!1);else{const t=[...o??[],e.id],n=t.length===(l||[]).length;u(t.map((e=>{const t=null==l?void 0:l.find((t=>t.id===e));return{channelId:e,channelName:(null==t?void 0:t.name)??e}})),n)}}),[n,u,l]),p=o.useCallback((()=>{i||u([],!0)}),[i,u]),m=(0,r().IS)((e=>({header:{display:"flex",alignItems:"center",margin:8,color:e.text.secondary,fontWeight:s().Wy.medium,fontSize:s().J.UISmall.desktop}})),[]);return(0,D.jsx)(dn().pj,{workflowExternalScopedConnectionPointer:t,currentNotificationChannels:n,onClose:f,onNotificationChannelSelect:g,onNotificationChannelSelectAll:p,onNewSlackAccountAdded:()=>{},isMultiSelectMode:d,shouldHideSlackAccountSection:!0,shouldShowSelectAllChannels:!0,isAllChannels:i,shouldShowImChannels:!0,renderMenu:e=>(0,D.jsx)(ke().A,{menuType:ve().gu.Popup,width:266,maxHeight:"50vh",header:(0,D.jsx)("div",{style:m.header,children:(0,D.jsx)(a().sA,{id:"workflows.selectChannelView.title",defaultMessage:"Select Slack channels"})}),children:(0,D.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:0,sections:e})})})}var pn=()=>n(690825),mn=()=>n(381138),hn=()=>n(331542),wn=()=>n(267419),kn=()=>n(62856);const vn=(0,a().YK)({anyEmoji:{id:"workflowSlackEmojiPicker.anyEmoji",defaultMessage:"Any emoji"},selectEmoji:{id:"workflowSlackEmojiPicker.selectEmoji",defaultMessage:"Select emoji(s)"},searchPlaceholder:{id:"workflowSlackEmojiPicker.selectEmoji.searchInput.placeholder",defaultMessage:"Search"}}),yn=["thumbs up","thumbs down"];function xn(e){let{isInTranscript:t,moduleId:n,trigger:l,workflowDefinitionPointer:s,writeReactions:d}=e;const c=(0,m().v3)(),{workflowId:u,spaceId:f,transcriptId:g}=(0,h().kI)(s),[p,w]=(0,o.useState)({}),[k,v]=(0,o.useState)(!0),y=(0,wn()._)(),x=(0,i().uB)(void 0,xe().A),M=(0,Ot().j)(),I=(0,o.useCallback)((()=>x.reset()),[x]),{triggerReaction:j,triggerReactions:b}=(0,o.useMemo)((()=>{var e,t;return{triggerReaction:null===(e=l.state)||void 0===e?void 0:e.reaction,triggerReactions:null===(t=l.state)||void 0===t?void 0:t.reactions}}),[l.state]);(0,o.useEffect)((()=>{(async()=>{const e=await C().callApi({eventName:"getViaWorkflowModuleConfigurationUtil",environment:c,data:{workflowId:u,spaceId:f,transcriptId:g,moduleId:n,moduleType:"slack",callArguments:{functionName:"getWorkspaceEmojis",functionArgs:[]}}});if("success"===e.type){if("getWorkspaceEmojis"!==e.data.functionName)throw new Error("Invalid function name");w(e.data.functionReturn),v(!1)}})()}),[c,n,f,g,u]);const S=(0,o.useMemo)((()=>{const e=[...b||[]];return j&&!b&&e.push(j),e}),[j,b]),A=(0,o.useMemo)((()=>{const e={};for(const n in y.emojiByName){const t=y.emojiByName[n];yn.includes(n)?e[n.replaceAll(/\s/g,"")]=t:!/\s/.test(n)&&Boolean(t)&&(e[n]=t)}const t={};for(const n in p){const o=p[n];if(o.includes("alias:")){const i=o.split("alias:")[1];t[n]=p[i]||e[i]}else t[n]=o}return{...e,...t}}),[p,y.emojiByName]),{renderedEmojis:T,tooltipNames:P}=(0,o.useMemo)((()=>{const e=[],t=[];for(const n of S){const o=Mn({allEmojis:A,emojiName:n});o&&(e.push(o),t.push(n),t.push((0,D.jsx)("br",{})))}return{renderedEmojis:e,tooltipNames:t}}),[A,S]),R=(0,r().IS)((e=>({buttonText:{color:S.length>0?e.text.primary:e.text.secondary,...t&&{height:32}}})),[S,t]);return(0,D.jsx)(he().Ay,{alignmentToOrigin:he().yP.End,buttonPopupStore:x,disabled:!1,originGap:0,placementToOrigin:he().sx.Bottom,popupType:M,renderOrigin:e=>(0,D.jsx)(Ut().x,{...e,disabled:!1,isError:!1,tooltipMessage:P.length>0&&(0,D.jsx)("div",{children:P}),dropdownButtonType:"dropdown",style:R.buttonText,children:T.length>0?(0,D.jsx)("div",{style:{display:"flex",gap:4,alignItems:"center"},children:T}):(0,D.jsx)(a().sA,{...vn.anyEmoji})}),render:e=>(0,D.jsx)(Cn,{...e,allEmojis:A,isLoading:k,triggerEmojis:S,writeReactions:d,onClose:I})})}function Cn(e){let{allEmojis:t,isLoading:n,triggerEmojis:i,writeReactions:r,onClose:l}=e;const[s,f]=(0,o.useState)(""),g=(0,a().tz)(),p=(0,kn().A)(n,500,300),m=(0,o.useMemo)((()=>{const e=[];for(const n in t)In({emojiName:n,query:s})&&e.push(n);return e}),[t,s]),h=(0,o.useRef)(null),w=(0,pn().Te)({count:m.length,getScrollElement:()=>h.current,estimateSize:()=>28,overscan:50});(0,o.useEffect)((()=>{s.length>0&&w.scrollToIndex(0)}),[w,s.length]);const k=w.getVirtualItems(),v=(0,o.useCallback)((()=>{const e=[];for(const{index:n}of k){const o=m[n];Mn({emojiName:o,allEmojis:t})&&e.push({key:o,render:e=>(0,D.jsx)(d().A,{...e,icon:Mn({emojiName:o,allEmojis:t}),desktopIconStyle:{width:8},title:`:${o}:`,isChecked:i.includes(o)}),action:()=>{i.includes(o)?r(i.filter((e=>e!==o))):r([...i,o])}})}return e}),[t,m,i,k,r]),y=(0,o.useMemo)((()=>[{key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,D.jsx)("div",{children:(0,D.jsx)(wt().Ay,{...e,inputLeft:(0,D.jsx)(wt().Zf,{icon:mn().q}),inputRight:p&&(0,D.jsx)(hn().A,{style:{marginRight:2}}),showClearButton:!0,placeholder:g.formatMessage(vn.searchPlaceholder),focusInitial:!0,value:s,onChange:e=>{f(e.target.value)}})})}],render:e=>(0,D.jsx)(u().A,{...e,title:(0,D.jsx)(a().sA,{...vn.selectEmoji})})},{key:"any-emoji-section",items:s?[]:[{key:"any-emoji",render:e=>(0,D.jsx)(d().A,{...e,desktopIconStyle:{width:8},title:g.formatMessage(vn.anyEmoji),isChecked:0===i.length}),action:()=>{r([]),l()}}],render:e=>(0,D.jsx)(u().A,{...e})},{key:"emojiResults",render:e=>(0,D.jsx)(u().A,{...e,topBorder:!0}),items:v()}]),[v,g,p,l,s,i.length,r]);return(0,D.jsx)(ke().A,{menuType:ve().gu.Popup,width:266,maxHeight:"50vh",children:(0,D.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:0,sections:y,ref:h,style:{height:w.getTotalSize()}})})}function Mn(e){let{emojiName:t,allEmojis:n}=e;const o=n[t];return o?o.includes("https")?(0,D.jsx)("img",{src:o,alt:t,height:18,width:18}):o:null}function In(e){const{emojiName:t,query:n}=e;return 0===n.length||`:${t}:`.toLocaleLowerCase().indexOf(n.trim().toLocaleLowerCase())>=0}const jn=(0,a().YK)({slackMessage:{defaultMessage:"New slack message in",id:"aiWorkflow.trigger.title.slack.message"},slackReactionAddedWithEmojiPicker:{defaultMessage:"Slack reaction {emojiPicker} added to",id:"aiWorkflow.trigger.title.slack.reaction.addedWithEmojiPicker"},slackThreadCreated:{defaultMessage:"Slack thread created in",id:"aiWorkflow.trigger.title.slack.thread.created"},slackChannelTranscriptDescription:{defaultMessage:"Pick a slack channel for {triggerName}",id:"aiWorkflow.trigger.title.slack.transcript.channel"},createThreadInChannel:{defaultMessage:"Created a new thread in a Slack channel",id:"workflow.run.effect.slack.createThreadInChannel.description"},createThreadInDirectMessage:{defaultMessage:"Created a new thread in a Slack direct message",id:"workflow.run.effect.slack.createThreadInDirectMessage.description"},replyInThread:{defaultMessage:"Replied to a Slack thread",id:"workflow.run.effect.slack.replyInThread.description"},updateMessage:{defaultMessage:"Updated a Slack message",id:"workflow.run.effect.slack.updateMessage.description"},addReactionToMessage:{defaultMessage:"Added a reaction to a Slack message",id:"workflow.run.effect.slack.addReactionToMessage.description"},removeReactionFromMessage:{defaultMessage:"Removed a reaction from a Slack message",id:"workflow.run.effect.slack.removeReactionFromMessage.description"},getThreadsInChannelSince:{defaultMessage:"Retrieved Slack threads from a channel",id:"workflow.run.effect.slack.getThreadsInChannelSince.description"},queryChannels:{defaultMessage:"Queried Slack channels",id:"workflow.run.effect.slack.queryChannels.description"},getUser:{defaultMessage:"Retrieved a Slack users information",id:"workflow.run.effect.slack.getUser.description"},findUserByEmail:{defaultMessage:"Found a Slack user by their email address",id:"workflow.run.effect.slack.findUserByEmail.description"},parseSlackMessageIdToUrl:{defaultMessage:"Parsed a Slack message ID to a URL",id:"workflow.run.effect.slack.parseSlackMessageIdToUrl.description"},getSlackUrlFromMessageId:{defaultMessage:"Retrieved a Slack URL from a message ID",id:"workflow.run.effect.slack.getSlackUrlFromMessageId.description"}});function bn(e){const{trigger:t,workflowDefinitionPointer:n,workflowValue:o,saveTrigger:i,isInTranscript:r}=e,{state:a}=t;if(!a)throw new Error("Slack trigger state is required");if(!t.moduleId)throw new Error("Slack trigger moduleId is required");return(0,D.jsx)(fn,{workflowValue:o,workflowDefinitionPointer:n,isAllChannels:Boolean(a.allChannels),isInTranscript:r,channelIds:a.channelIds,moduleId:t.moduleId,isMultiSelectMode:!0,writeChannelIds:(e,n)=>{const o={...t,state:{...a,channelIds:e.map((e=>e.channelId)),allChannels:(0,Pe().O9)(n)?n:a.allChannels}};i(o)}})}function Sn(e,t){return e.formatMessage(jn.slackChannelTranscriptDescription,{triggerName:t.name})}const An={triggers:{"slack.message":{icon:on().z,configuration:"minimal",description:jn.slackMessage,transcriptDescription:Sn,ConfigurationComponent:bn},"slack.reaction.added":{icon:on().z,configuration:"full",FullConfiguration:function(e){const{trigger:t,workflowDefinitionPointer:n,workflowValue:i,saveTrigger:r,isInTranscript:l}=e,{state:s}=t;if(!s)throw new Error("Slack trigger state is required");const d=t.moduleId;if(!d)throw new Error("Slack trigger moduleId is required");const c=o.useMemo((()=>(0,D.jsx)(xn,{isInTranscript:l,moduleId:d,trigger:t,workflowDefinitionPointer:n,workflowValue:i,writeReactions:e=>{let n=s;if(s.reaction){const{reaction:e,...t}=s;n=t}const o={...t,state:{...n,reactions:e}};r(o)}})),[l,d,r,s,t,n,i]);return(0,D.jsxs)(re().Y1,{direction:l?"vertical":"horizontal",gap:l?12:4,children:[l?c:(0,D.jsx)(a().sA,{...jn.slackReactionAddedWithEmojiPicker,values:{emojiPicker:c}}),(0,D.jsx)(fn,{channelIds:s.channelIds,isAllChannels:Boolean(s.allChannels),isInTranscript:l,isMultiSelectMode:!0,moduleId:d,workflowDefinitionPointer:n,workflowValue:i,writeChannelIds:(e,n)=>{const o={...t,state:{...s,channelIds:e.map((e=>e.channelId)),allChannels:(0,Pe().O9)(n)?n:s.allChannels}};r(o)}})]})}},"slack.thread.created":{icon:on().z,configuration:"minimal",description:jn.slackThreadCreated,transcriptDescription:Sn,ConfigurationComponent:bn}},effect:{"slack.createThreadInChannel":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.createThreadInChannel)}},"slack.createThreadInDirectMessage":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.createThreadInDirectMessage)}},"slack.replyInThread":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.replyInThread)}},"slack.updateMessage":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.updateMessage)}},"slack.addReactionToMessage":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.addReactionToMessage)}},"slack.removeReactionFromMessage":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.removeReactionFromMessage)}},"slack.getThreadsInChannelSince":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.getThreadsInChannelSince)}},"slack.queryChannels":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.queryChannels)}},"slack.getUser":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.getUser)}},"slack.findUserByEmail":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.findUserByEmail)}},"slack.parseSlackMessageUrlToId":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.parseSlackMessageIdToUrl)}},"slack.getSlackUrlFromMessageId":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(jn.getSlackUrlFromMessageId)}}},ModuleConfiguration:function(e){const{isInTranscript:t,module:n,onUndoClick:i,removeModule:r,saveModule:a,workflowDefinitionPointer:l,workflowModuleStore:s}=e,d=(0,o.useMemo)((()=>{if(r)return function(){r(n)}}),[n,r]),{isWorkspaceAdmin:c,scopedExternalConnectionStore:u}=ge({moduleValue:n}),f=!(0,Pe().O9)(u);return(0,D.jsx)(re().Y1,{align:"center",direction:"vertical",gap:16,children:t?(0,D.jsx)(Dt,{moduleValue:n,onUndoClick:i,saveModule:a,workflowDefinitionPointer:l,workflowModuleStore:s}):(0,D.jsxs)(bt,{moduleValue:n,children:[(0,D.jsx)(xt,{moduleValue:n,saveModule:a,workflowDefinitionPointer:l,workflowModuleStore:s}),(0,D.jsx)(it().A,{size:24}),(0,D.jsx)(It,{isDisabled:f,moduleValue:n,saveModule:a,workflowModuleStore:s}),c?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(it().A,{size:24}),(0,D.jsx)(jt,{isDisabled:f})]}):null,d?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(it().A,{size:24}),(0,D.jsx)(Mt,{onRemoveClick:d})]}):null]})})},configVariables:{slackChannel:{ConfigurationComponent:function(e){const{isInTranscript:t,moduleId:n,setVariable:o,variable:i,workflowDefinitionPointer:r,workflowValue:a}=e;return(0,D.jsx)(fn,{channelIds:null!=i&&i.channelId?[i.channelId]:void 0,isAllChannels:!1,isInTranscript:t,isMultiSelectMode:!1,moduleId:n,workflowDefinitionPointer:r,workflowValue:a,writeChannelIds:e=>{if(e.length>0){const t=e.find((e=>e.channelId!==(null==i?void 0:i.channelId)))??e[0];o({channelId:t.channelId,channelName:t.channelName})}else o(void 0)}})}},multipleOrAllSlackChannel:{ConfigurationComponent:function(e){var t;const{variable:n,setVariable:o,workflowValue:i,workflowDefinitionPointer:r,moduleId:a,isInTranscript:l}=e,s=null!=n&&n.allChannels||null==n||null===(t=n.channels)||void 0===t?void 0:t.map((e=>e.channelId)).filter(Boolean);return(0,D.jsx)(fn,{channelIds:s,isAllChannels:(null==n?void 0:n.allChannels)??!1,isInTranscript:l,isMultiSelectMode:!0,moduleId:a,workflowDefinitionPointer:r,workflowValue:i,writeChannelIds:(e,t)=>{o(t?{allChannels:!0}:{allChannels:!1,channels:e.map((e=>({channelId:e.channelId,channelName:e.channelName})))})}})}}}};const Dn=(0,a().YK)({zendeskTicket:{defaultMessage:"When a Zendesk ticket is created",id:"aiWorkflow.trigger.title.zendesk.ticket"},getTicket:{defaultMessage:"Retrieved a Zendesk ticket",id:"workflow.run.effect.zendesk.getTicket.description"},getComments:{defaultMessage:"Retrieved comments from a Zendesk ticket",id:"workflow.run.effect.zendesk.getComments.description"},addTicket:{defaultMessage:"Created a new Zendesk ticket",id:"workflow.run.effect.zendesk.addTicket.description"},updateTicket:{defaultMessage:"Updated a Zendesk ticket",id:"workflow.run.effect.zendesk.updateTicket.description"},addComment:{defaultMessage:"Added a comment to a Zendesk ticket",id:"workflow.run.effect.zendesk.addComment.description"}}),Tn={calendar:Ye,codegen:Ge,config:Je,files:tt,github:Pt,mcpServer:Et,notion:Qt,notionmail:en,pipedream:nn,slack:An,zendesk:{triggers:{"zendesk.ticket":{icon:n(28755).z,configuration:"minimal",description:Dn.zendeskTicket}},effect:{"zendesk.getTicket":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Dn.getTicket)}},"zendesk.getComments":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Dn.getComments)}},"zendesk.addTicket":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Dn.addTicket)}},"zendesk.updateTicket":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Dn.updateTicket)}},"zendesk.addComment":{runDefinitionType:"minimal",getDescription:e=>{let{intl:t}=e;return t.formatMessage(Dn.addComment)}}},ModuleConfiguration:_e}}},574387:(e,t,n)=>{n.d(t,{El:()=>b,dv:()=>I});n(16280),n(898992),n(354520),n(672577);var o=n(296540),i=()=>n(484714),r=()=>n(401497),a=()=>n(262986),l=()=>n(959013),s=()=>n(901389),d=()=>n(751156),c=()=>n(84817),u=()=>n(493823),f=()=>n(554509),g=()=>n(847),p=()=>n(691093),m=()=>n(614842),h=()=>n(912749),w=()=>n(383245),k=()=>n(179747),v=(n(581454),()=>n(919194)),y=n(474848);const x=(0,l().YK)({sectionTitle:{defaultMessage:"Triggers using {moduleName}",id:"workflowModuleTriggersUsedIn.sectionTitle"}});function C(e){var t;let{blockStore:n,module:o}=e;const{workflowValue:i}=(0,h()._)(n),a=(0,r().IS)((()=>({container:{marginTop:30,marginBottom:30}})),[]),s=(null==i||null===(t=i.triggers)||void 0===t?void 0:t.filter((e=>e.moduleId===o.id)))||[];return 0===s.length?null:(0,y.jsxs)(c().Y1,{style:a.container,gap:8,children:[(0,y.jsx)(f().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",children:(0,y.jsx)(l().sA,{...x.sectionTitle,values:{moduleName:o.name}})}),s.map((e=>(0,y.jsx)(v().h,{blockStore:n,trigger:e},e.id)))]})}function M(e){const{children:t,isFullWidth:n,style:o}=e,i=(0,r().IS)((()=>({container:{maxWidth:n?void 0:544,margin:"0 auto",width:"100%",...o}})),[n,o]);return(0,y.jsx)("div",{style:i.container,children:t})}function I(e){var t;const{module:n,workflowValue:o}=e;if(!o)return!0;const i=null===(t=o.modules)||void 0===t?void 0:t.find((e=>e.id===n.id));return!!i&&m().d.isValidAndConnected(i,o)}function j(e){const{icon:t,label:n,right:o,children:i}=e,a=(0,r().IS)((e=>({titleIcon:{width:20,height:20,fill:e.icon.primary}})),[]);return(0,y.jsxs)(M,{isFullWidth:!0,style:{...e.allowOverflowX&&{overflowX:"visible"},display:"flex",flexDirection:"column",gap:4},children:[(0,y.jsxs)(c().Y1,{direction:"horizontal",align:"top-left",children:[(0,y.jsxs)(c().Y1,{direction:"horizontal",align:"center-left",gap:4,style:{flex:1},children:[t?(0,y.jsx)("span",{style:a.titleIcon,children:t(a.titleIcon)}):null,n?(0,y.jsx)(f().D,{styleName:"UITitle-Medium-20px/Semibold",children:n}):null]}),(0,y.jsx)(c().Y1,{width:"hug",direction:"horizontal",gap:8,align:"center-right",style:{flex:0},children:o})]}),i]})}function b(e){var t;const{workflow:n,workflowStore:o,blockStore:i,moduleId:r}=e,a=null===(t=n.modules)||void 0===t?void 0:t.find((e=>e.id===r));return a?(0,y.jsx)(S,{workflowStore:o,blockStore:i,module:a}):null}function S(e){const{workflowStore:t,blockStore:n,module:c}=e,f=(0,i().v3)(),{workflowValue:v}=(0,h()._)(n),x=c?a().Nh[c.type]:void 0,M=m().d.getName(c,(0,l().tz)()),I=m().d.getIcon(c.type),b=(0,o.useCallback)((async()=>{if(!t||!v)return;(await s().Gh({message:(0,y.jsx)(l().sA,{defaultMessage:"Delete this module?",id:"workflow.moduleSection.deleteConfirmation.message"}),description:(0,y.jsx)(l().sA,{defaultMessage:"This module will be permanently removed from this workflow.",id:"workflow.moduleSection.deleteConfirmation.description"}),acceptLabel:(0,y.jsx)(l().sA,{defaultMessage:"Delete module",id:"workflow.moduleSection.deleteConfirmation.acceptLabel"})})).accept&&(d().createAndCommit({userAction:"WorkflowModuleSection.handleDeleteModule",environment:f,canUndo:!0,perform:e=>{var n;const o={...v,modules:null===(n=v.modules)||void 0===n?void 0:n.filter((e=>e.id!==c.id))};(0,g().overrideWorkflowData)({workflowStore:t,workflow:o,transaction:e})}}),(0,p().showWorkflowEditor)({environment:f,parentStore:n,navigationState:{isOpen:!0,type:"agent"}}))}),[f,t,v,c,n]),S=(0,r().IS)((e=>({deleteButton:{color:e.palette.red[500],fontSize:12,padding:"4px 8px"}})),[]);if(!x)return null;const A=(0,y.jsx)(u().p,{onClick:b,style:S.deleteButton,isGray:!0,children:(0,y.jsx)(l().sA,{defaultMessage:"Delete",id:"workflow.moduleSection.deleteModule"})});return(0,y.jsxs)(j,{blockStore:n,label:M,icon:I,right:A,children:[(0,y.jsx)(w().WorkflowModuleConfigurationWithEditorContext,{blockStore:n,module:c,isInTranscript:!1}),(0,y.jsx)(C,{blockStore:n,module:c}),(0,y.jsx)(k().r0,{children:(0,y.jsx)(k().bi,{module:c})})]})}},759113:(e,t,n)=>{n.r(t),n.d(t,{WorkflowTriggerConfiguration:()=>u,useTriggerDefinition:()=>c});n(898992),n(672577),n(296540);var o=()=>n(56366),i=()=>n(401497),r=()=>n(286885),a=()=>n(959013),l=()=>n(284371),s=()=>n(442510),d=n(474848);function c(e){const{workflowValue:t,trigger:n}=e;return(0,o().K8)((()=>{var e;const o=function(e,t){var n,o;const i=null==e||null===(n=e.modules)||void 0===n?void 0:n.find((e=>e.id===t.moduleId&&void 0!==t.moduleId));return i||(Object.keys(r().I.triggers).includes((null===(o=t.state)||void 0===o?void 0:o.type)??"")?{id:"notion",name:"notion",type:"notion",version:"1.0.0"}:void 0)}(t,n);if(!o||null===(e=n.state)||void 0===e||!e.type)return null;return s().y[o.type].triggers[n.state.type]}),[t,n])}function u(e){const{blockStore:t,workflowValue:n,trigger:o,isInTranscript:r,workflowDefinitionPointer:s,saveTrigger:u}=e,f=(0,i().IS)((e=>({container:{display:"flex",gap:4,flexDirection:r?"column":"row",overflow:"hidden"},title:r?{color:e.text.tertiary,fontWeight:l().Wy.medium,fontSize:14}:{fontWeight:500}})),[r]),g=c({workflowValue:n,trigger:o}),p=(0,a().tz)();if(!o.state||!g||!s)return null;if("full"===g.configuration){const{FullConfiguration:e}=g;return(0,d.jsx)("div",{style:f.container,children:(0,d.jsx)(e,{workflowValue:n,trigger:o,isInTranscript:r,workflowDefinitionPointer:s,saveTrigger:u})})}const{ConfigurationComponent:m}=g;return(0,d.jsxs)("div",{style:f.container,children:[(0,d.jsx)("div",{style:f.title,children:r&&g.transcriptDescription?g.transcriptDescription(p,o):(0,d.jsx)(a().sA,{...g.description})}),m&&(0,d.jsx)(m,{blockStore:t,workflowValue:n,trigger:o,isInTranscript:r,workflowDefinitionPointer:s,saveTrigger:u})]})}},825043:(e,t,n)=>{n.d(t,{Q:()=>i});n(898992),n(672577);var o=n(296540);function i(e){var t,n;const[i,r]=(0,o.useState)(null===(t=e[0])||void 0===t||null===(t=t.key)||void 0===t?void 0:t.toString());if(i){const t=e.find((e=>{var t;return(null===(t=e.key)||void 0===t?void 0:t.toString())===i}));if(t)return t}const a=e[0];var l;a&&(null===(n=a.key)||void 0===n?void 0:n.toString())!==i&&r(null===(l=a.key)||void 0===l?void 0:l.toString());return a}},912749:(e,t,n)=>{n.d(t,{_:()=>l});var o=()=>n(56366),i=()=>n(915671),r=()=>n(890754),a=()=>n(765957);function l(e){const t=(0,r().useCurrentThreadStore)(),n=(0,o().K8)((()=>function(e){const{blockStore:t}=e,{currentSpaceStore:n}=a().default.state;if(!n)return;const o=null==t?void 0:t.getWorkflowStore();if(!o)return;return{workflowPointer:o.pointer,workflowValue:o.getData()??i().ZB}}({blockStore:e})),[e]);return{blockStore:e,threadStore:t,...n}}},918676:(e,t,n)=>{n.d(t,{y:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("clock",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M6.541 10.919a.53.53 0 0 1-.39-.157.53.53 0 0 1-.157-.39c0-.155.053-.283.157-.383a.53.53 0 0 1 .39-.157h2.905V5.895c0-.15.053-.278.158-.383a.521.521 0 0 1 .382-.158.53.53 0 0 1 .39.158.521.521 0 0 1 .157.383v4.477a.53.53 0 0 1-.157.39.53.53 0 0 1-.39.157H6.541Zm3.452 6.207a6.789 6.789 0 0 1-2.727-.554 7.124 7.124 0 0 1-2.256-1.524 7.277 7.277 0 0 1-1.525-2.256 6.788 6.788 0 0 1-.553-2.727c0-.967.184-1.876.553-2.728a7.241 7.241 0 0 1 3.773-3.78 6.788 6.788 0 0 1 2.728-.554c.971 0 1.882.184 2.735.554.852.369 1.604.88 2.256 1.53a7.136 7.136 0 0 1 1.53 2.25c.37.852.554 1.761.554 2.728 0 .966-.184 1.875-.553 2.727a7.218 7.218 0 0 1-3.787 3.78 6.789 6.789 0 0 1-2.728.554Zm0-1.395c.789 0 1.525-.145 2.208-.437a5.678 5.678 0 0 0 1.805-1.217 5.68 5.68 0 0 0 1.217-1.804c.291-.684.437-1.42.437-2.208a5.55 5.55 0 0 0-.437-2.202 5.66 5.66 0 0 0-3.029-3.028 5.567 5.567 0 0 0-2.208-.438c-.784 0-1.52.146-2.208.438A5.6 5.6 0 0 0 5.98 6.052a5.715 5.715 0 0 0-1.21 1.811 5.55 5.55 0 0 0-.437 2.202c0 .788.146 1.524.438 2.208a5.735 5.735 0 0 0 1.21 1.804 5.598 5.598 0 0 0 4.013 1.654Z"})})},919194:(e,t,n)=>{n.d(t,{V:()=>w,h:()=>v});n(16280);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),l=n(474848);const s={viewBox:"0 0 20 20",fittedViewBox:"5.82 3.53 8.36 12.78",svg:(0,l.jsx)("path",{d:"M7.551 6.77c.184-.738 1.091-1.489 2.413-1.489 1.552 0 2.459.973 2.459 1.797 0 .495-.303 1.023-.928 1.403l-.02.012-1.248.852-.004.003c-.866.599-1.417 1.568-1.417 2.623a.875.875 0 0 0 1.75 0c0-.434.228-.883.66-1.182l1.21-.825c.996-.615 1.747-1.641 1.747-2.886 0-2.132-2.072-3.547-4.209-3.547-1.893 0-3.68 1.093-4.11 2.814a.875.875 0 1 0 1.697.425m3.443 8.289a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0"})},d=(0,n(340498).wt)("questionMarkFill",s);var c=()=>n(71634),u=()=>n(929531),f=()=>n(704152),g=()=>n(847),p=()=>n(94522),m=()=>n(912749),h=()=>n(759113);function w(e){const{children:t}=e,n=(0,c().vV)();return(0,l.jsx)("div",{style:n.wrap,children:(0,l.jsx)("div",{style:n.list,children:t})})}function k(e){const{children:t,icon:n,subtitle:i,onClick:r}=e,s=(0,a().IS)((e=>({componentWrap:{borderRadius:10},buttonWrap:{borderRadius:10},headerWrap:{alignItems:"center"}})),[]),d=(0,u().M0)({disabled:!1,hasActionMenu:!1,isActionMenuVisible:!1,overrideStyles:s}),c=(0,o.useMemo)((()=>({...d.componentWrap,...d.border})),[d.border,d.componentWrap]),g=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{style:d.headerWrap,children:[n&&(0,l.jsx)("div",{"aria-hidden":"true",style:d.iconContainer,children:(0,l.jsx)("div",{style:d.iconWrap,children:n(d.icon)})}),(0,l.jsx)("div",{style:d.titleWrap,children:t})]}),i&&(0,l.jsx)("div",{style:d.subtitleWrap,children:i})]});return r?(0,l.jsx)("div",{style:d.buttonWrap,children:(0,l.jsx)(f().A,{onClick:r,style:d.componentWrap,children:g})}):(0,l.jsx)("div",{style:c,children:g})}function v(e){const{blockStore:t,trigger:n}=e,{workflowPointer:a,threadStore:s,workflowValue:c}=(0,m()._)(t),u=(0,i().v3)(),f=(0,r().K8)((()=>(0,p().Cq)({workflowPointer:a,threadPointer:null==s?void 0:s.pointer})),[a,s]),w=(0,h().useTriggerDefinition)({workflowValue:c,trigger:n}),v=(0,o.useCallback)((e=>{if(!a)throw new Error("No workflow pointer");g().saveTrigger({environment:u,workflowPointer:a,threadStore:s,trigger:e,blockStore:t})}),[a,s,u,t]);return c&&f?(0,l.jsx)(k,{icon:(null==w?void 0:w.icon)??d,children:(0,l.jsx)(h().WorkflowTriggerConfiguration,{blockStore:t,workflowValue:c,workflowDefinitionPointer:f,trigger:n,saveTrigger:v,isInTranscript:!1})}):null}}}]);