"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[2411,4876,5834,8985,9150,28464,34208,67608,82122,84084,84358],{38e3:(e,t,o)=>{o.d(t,{$:()=>p,Q:()=>g});o(16280);var n=()=>o(179034),r=()=>o(869558),i=()=>o(44729),a=()=>o(246826),s=()=>o(751156),l=()=>o(594794),c=()=>o(972435),d=()=>o(630116),u=()=>o(435930);function p(e){const{environment:t,layoutStore:o,transaction:n,options:r}=e,{inMemoryRecordCache:s}=o,l=o.getSpaceId(),c=o.getParentPointer();if(!c||"collection"!==c.table)throw new Error("Invalid state: no collection pointer");if(!l)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const d=a().Wv({environment:t,type:"collection_view",inMemoryRecordCache:s,transaction:n});i().NI({childStore:d,parentStore:o,transaction:n});const{collectionViewStore:u}=g({environment:t,transaction:n,layoutStore:o,collectionViewBlockStore:d,options:r});return{collectionViewStore:u,collectionViewBlockStore:d}}function g(e){const{environment:t,transaction:o,layoutStore:i,collectionViewBlockStore:p,options:g}=e,{inMemoryRecordCache:m}=i,f=i.getParentPointer();if(!f||"collection"!==f.table)throw new Error("Invalid state: no collection pointer");const v=i.getSpaceId();if(!v)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const y=(0,l().JH)({environment:t,table:r().Gy,spaceId:v}),h={id:y.id,type:"page",parent_id:p.pointer.id,parent_table:n().ev,space_id:v,alive:!0,name:c().A.formatMessage(u().s.editor),format:{collection_pointer:f,hide_linked_collection_name:!0}};return null!=g&&g.viewsTabId&&(h.format={...h.format,page_layout_pointer:{...i.pointer,views_main_tab_id:g.viewsTabId}}),a().eC({environment:t,table:r().Gy,value:h,inMemoryRecordCache:m,transaction:o}),s().applyOperation({store:p,operation:{pointer:p.pointer,path:["view_ids"],command:"listBefore",args:{id:y.id}},transaction:o}),{collectionViewStore:d().pS.createChildStore(p,y)}}},59400:(e,t,o)=>{o.d(t,{nR:()=>d,m$:()=>s,m4:()=>l,Dy:()=>c,FZ:()=>p});o(296540);var n=()=>o(645873),r=o(474848);function i(e){const{shouldShowSpinner:t,collectionSettingsProps:n}=e;return(0,r.jsx)(o(735695).Ay,{collectionSettingsStore:n.collectionSettingsStore,fullHeight:n.fullHeight,hideDesktopHeader:n.hideDesktopHeader,children:t&&(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden",paddingBottom:20},children:(0,r.jsx)(o(331542).A,{})})})}const a=new(n().O2)("collectionSettings",(()=>Promise.all([o.e(75134),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(75078),o.e(25497),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(30291),o.e(19930),o.e(58102),o.e(26483),o.e(6463),o.e(40925),o.e(282),o.e(61349),o.e(62573),o.e(1440),o.e(63996),o.e(66559),o.e(35986),o.e(92924),o.e(64819),o.e(97339),o.e(55717),o.e(63797),o.e(21367),o.e(22686),o.e(99108)]).then(o.bind(o,409198)))),s=(0,n()._h)(a,(e=>e.CollectionSettings),{renderLoading:(e,t)=>(0,r.jsx)(i,{shouldShowSpinner:e,collectionSettingsProps:t})}),l=(0,n()._h)(a,(e=>e.CollectionSettingsButtonOptions)),c=(0,n()._h)(a,(e=>e.CollectionSettingsPropertyTypeMenuItem)),d=(0,n()._h)(a,(e=>e.CollectionEditButtonAutomationOption)),u=new(n().O2)("TableHeaderPropertyCreationMenu",(()=>Promise.all([o.e(75134),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(75078),o.e(25497),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(61349),o.e(35986),o.e(43935)]).then(o.bind(o,908800)))),p=(0,n()._h)(u,(e=>e.TableHeaderPropertyCreationMenu))},63467:(e,t,o)=>{o.d(t,{y:()=>d});var n=()=>o(637997),r=()=>o(267419);const i={ko:()=>o.e(2268).then(o.bind(o,224434)),es:()=>o.e(95264).then(o.bind(o,196425)),de:()=>o.e(35390).then(o.bind(o,653703)),fr:()=>o.e(3272).then(o.bind(o,94677)),pt:()=>o.e(27315).then(o.bind(o,766869)),zh:()=>o.e(69945).then(o.bind(o,516814)),ja:()=>o.e(77757).then(o.bind(o,824432)),da:()=>o.e(9423).then(o.bind(o,440761)),fi:()=>o.e(59337).then(o.bind(o,462135)),nb:()=>o.e(2040).then(o.bind(o,937314)),nl:()=>o.e(51106).then(o.bind(o,530897)),sv:()=>o.e(53631).then(o.bind(o,895222)),id:()=>o.e(69945).then(o.bind(o,516814)),th:()=>o.e(69945).then(o.bind(o,516814)),vi:()=>o.e(69945).then(o.bind(o,516814))};let a=!1,s=!1;async function l(e){for(const[o,r]of Object.entries(e.emojiLocaleKeywords)){var t;n().fB[o]={...n().fB[o],keywords:[...r,...(null===(t=n().fB[o])||void 0===t?void 0:t.keywords)||[]]}}await r().A.waitUntilLoaded(),r().A.update((t=>{let{emojiByName:o,...n}=t;return{...n,emojiByName:{...o,...e.emojiByName}}}))}async function c(){if(a)return;const[e]=o(662303).locale.split("-");e in i&&(await l(await i[e]()),a=!0)}const d=(0,o(279900).A)((async()=>{await async function(){s||(await l(await o.e(51872).then(o.bind(o,443716))),s=!0)}(),await c()}))},69447:(e,t,o)=>{o.d(t,{Lq:()=>n,WK:()=>i,nh:()=>r});const n=40,r=48,i=60},79118:(e,t,o)=>{o.d(t,{Eo:()=>h,Fz:()=>g,KI:()=>s,M4:()=>c,YW:()=>_,iY:()=>w,mO:()=>m,qE:()=>d,vm:()=>v});var n=()=>o(604995),r=()=>o(247331),i=()=>o(977345);const a=(0,o(959013).YK)({buttonAutomationCurrentUserDescription:{defaultMessage:"The user who clicked this button",id:"automations.contextValue.buttonAutomationCurrentUserDescription"},buttonAutomationCurrentUserName:{defaultMessage:"Whoever clicked",id:"automations.contextValue.buttonAutomationCurrentUserName"},buttonAutomationCurrentUserTooltip:{defaultMessage:"The person who clicked the button",id:"automations.contextValue.buttonAutomationCurrentUserTooltip"},buttonAutomationThisPageDescription:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageDescription"},buttonAutomationThisPageName:{defaultMessage:"This page",id:"automations.contextValue.buttonAutomationThisPageName"},buttonAutomationThisPageTooltip:{defaultMessage:"The page containing this button",id:"automations.contextValue.buttonAutomationThisPageTooltip"},eventAutomationCurrentUserDescription:{defaultMessage:"The user who made the edit that triggered this automation to run.",id:"automations.contextValue.eventAutomationCurrentUserDescription"},eventAutomationCurrentUserName:{defaultMessage:"Whoever triggered",id:"automations.contextValue.eventAutomationCurrentUserName"},eventAutomationCurrentUserTooltip:{defaultMessage:"The person whose action triggered this automation",id:"automations.contextValue.eventAutomationCurrentUserTooltip"},eventAutomationThisPageDescription:{defaultMessage:"The page that was edited to trigger this automation to run.",id:"automations.contextValue.eventAutomationThisPageDescription"},eventAutomationThisPageName:{defaultMessage:"Trigger page",id:"automations.contextValue.eventAutomationThisPageName"},eventAutomationThisPageTooltip:{defaultMessage:"The page that triggered this automation",id:"automations.contextValue.eventAutomationThisPageTooltip"},now:{id:"automations.triggers.now.label",defaultMessage:"Time triggered"},nowDescription:{id:"automations.triggers.now.description",defaultMessage:"The time when this automation begins to run."},nowTooltip:{id:"automations.triggers.now.tooltip",defaultMessage:"The time this automation was triggered"},pageCreator:{id:"automations.triggers.pageCreator.label",defaultMessage:"Page creator"},pageCreatorDescription:{id:"automations.triggers.pageCreator.description",defaultMessage:"The user who created the page that was edited to trigger this automation to run."},pageCreatorTooltip:{id:"automations.triggers.pageCreator.tooltip",defaultMessage:"Person who created page"},today:{id:"automations.triggers.today.label",defaultMessage:"Date triggered"},todayDescription:{id:"automations.triggers.today.description",defaultMessage:"The date when this automation begins to run."},todayTooltip:{id:"automations.triggers.today.tooltip",defaultMessage:"The date this automation was triggered"}});function s(){return(0,i().$y)({source:"global",global:"button_page"})}function l(e,t,o){return{description:o,name:e,tooltip:t,compile:(n,i)=>({description:o?n.formatMessage(o):void 0,id:s(),kind:r().FormulaContextValueKind.ContextValue,name:n.formatMessage(e),tooltipName:n.formatMessage(t),type:{collection:i,type:"block"}}),evaluate:e=>({kind:r().FormulaContextValueKind.ContextValue,id:s(),value:{type:"block",value:e}})}}const c=l(a.buttonAutomationThisPageName,a.buttonAutomationThisPageTooltip,a.buttonAutomationThisPageDescription),d=l(a.eventAutomationThisPageName,a.eventAutomationThisPageTooltip,a.eventAutomationThisPageDescription);function u(){return(0,i().$y)({source:"global",global:"current_user"})}function p(e,t,o){return{description:o,name:e,tooltip:t,compile:n=>({description:o?n.formatMessage(o):void 0,id:u(),kind:r().FormulaContextValueKind.ContextValue,name:n.formatMessage(e),tooltipName:n.formatMessage(t),type:{type:"person"}}),evaluate:e=>({id:u(),kind:r().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const g=p(a.buttonAutomationCurrentUserName,a.buttonAutomationCurrentUserTooltip,a.buttonAutomationCurrentUserDescription),m=p(a.eventAutomationCurrentUserName,a.eventAutomationCurrentUserTooltip,a.eventAutomationCurrentUserDescription);function f(){return(0,i().$y)({source:"global",global:"now"})}const v={description:a.nowDescription,name:a.now,tooltip:a.nowTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:f(),kind:r().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:f(),kind:r().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,n().KQ)(Date.now(),e)}})};function y(){return(0,i().$y)({source:"global",global:"today"})}const h={description:a.todayDescription,name:a.today,tooltip:a.todayTooltip,compile(e){return{description:this.description?e.formatMessage(this.description):void 0,id:y(),kind:r().FormulaContextValueKind.ContextValue,name:e.formatMessage(this.name),tooltipName:this.tooltip?e.formatMessage(this.tooltip):void 0,type:{type:"date"}}},evaluate:e=>({id:y(),kind:r().FormulaContextValueKind.ContextValue,value:{type:"date",value:(0,n().p6)(Date.now(),e)}})};function S(){return(0,i().$y)({source:"global",global:"page_creator"})}function b(e,t){return{description:a.pageCreatorDescription,name:e,tooltip:t,compile(o){return{description:this.description?o.formatMessage(this.description):void 0,id:S(),kind:r().FormulaContextValueKind.ContextValue,name:o.formatMessage(e),tooltipName:o.formatMessage(t),type:{type:"person"}}},evaluate:e=>({id:S(),kind:r().FormulaContextValueKind.ContextValue,value:{type:"person",value:e}})}}const _=b(a.pageCreator,a.pageCreatorTooltip),w=b(a.pageCreator,a.pageCreatorTooltip)},103966:(e,t,o)=>{o.d(t,{Z:()=>d});var n=()=>o(496603),r=()=>o(534177),i=()=>o(416504),a=()=>o(519831),s=()=>o(79118);const l={type:"button",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,contextType:i,getRecordModel:l,intl:c}=e,d=s().Fz.compile(c),u=s().vm.compile(c),p=s().Eo.compile(c),g=t.getParentPointer();let m,f;if("button_block"===i){if(e.pageBlockModel){const t=(0,o(236162).SH)({block:e.pageBlockModel,getRecordModel:l});t&&(m=s().M4.compile(c,t.pointer),f=s().YW.compile(c))}}else if("button_property"===i){const e=l(g);if((null==e?void 0:e.table)!==a().Vl)return{error:new(o(322867).N9)(`Unable to load automation parent: ${o(696706).L3.toKey(g)}`)};m=s().M4.compile(c,e.pointer),f=s().YW.compile(c)}else(0,r().HB)(i);return{value:{valueTypes:(0,n().oE)([d,u,p,m,f])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:o,executingUserTimeZone:r,thisPageBlockModel:a}=t??{},l=a?s().M4.evaluate(a.pointer):void 0,c=null==a?void 0:a.getCreatedByPointer(),d=c?s().YW.evaluate(c):void 0,u=o?s().Fz.evaluate(o):void 0,p=(0,i().P)(),g=s().vm.evaluate(r??p),m=s().Eo.evaluate(r??p);return{value:{values:(0,n().oE)([l,d,u,g,m])}}},isAvailableForContext:e=>!0};o(944114);const c={button:l,event:{type:"event",getCreatePermissions(e){const{parentPointer:t,spacePointer:o}=e;return[{minimumRole:"editor",pointer:t,type:"record_permission"},{minimumRole:"read_and_write",pointer:o,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e,n=[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}],i=t.getTrigger();if("event"===i.type){const e=i.event;(0,r().O9)(e.source)&&"filter"!==e.source.type&&(e.source.type===a().Vl||e.source.type===o(869558).Gy?n.push({minimumRole:"reader",pointer:e.source.pointer,type:"record_permission"}):(0,r().HB)(e.source))}return n},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"editor",pointer:t.getParentPointer(),type:"record_permission"},{minimumRole:"read_and_write",pointer:t.getSpacePointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{automationModel:t,intl:o}=e,r=s().mO.compile(o),i=s().iY.compile(o),l=s().vm.compile(o),c=s().Eo.compile(o),d=t.getParentPointer();let u;return d.table===a().Vl&&(u=s().qE.compile(o,d)),{value:{valueTypes:(0,n().oE)([r,i,l,c,u])}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserPointer:o,executingUserTimeZone:a,thisPageBlockModel:l}=t??{},c=l?s().qE.evaluate(l.pointer):void 0,d=o?s().mO.evaluate(o):void 0,u=(0,i().P)(),p=s().vm.evaluate(a??u),g=null==l?void 0:l.getCreatedByPointer(),m=(0,r().O9)(g)?s().iY.evaluate(g):void 0,f=s().Eo.evaluate(a??u);return{value:{values:(0,n().oE)([c,d,p,f,m])}}},isAvailableForContext:e=>e.hasAccessToSlackAction},recurrence:{type:"recurrence",getCreatePermissions(e){const{parentPointer:t}=e;return[{minimumRole:"read_and_write",pointer:t,type:"record_permission"}]},getEditPermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getManagePermissions(e){const{automationModel:t}=e;return[{minimumRole:"read_and_write",pointer:t.getParentPointer(),type:"record_permission"}]},getExecutePermissions(e){const{automationModel:t}=e;return[{minimumRole:"reader",pointer:t.getParentPointer(),type:"record_permission"}]},typecheck(e){const{intl:t}=e;return{value:{valueTypes:[s().vm.compile(t),s().Eo.compile(t)]}}},execute(e){const{formulaVariableResolution:t}=e,{executingUserTimeZone:o}=t??{},n=(0,i().P)();return{value:{values:[s().vm.evaluate(o??n),s().Eo.evaluate(o??n)]}}},isAvailableForContext(e){const{automation:t,automationActions:n,hasPremiumAutomations:i}=e;if(t.parent_table===o(179034).ev)return!0;if(t.parent_table===a().Vl){const e=o(388821).RecordMap.create();for(const t of n)e.addModel(t);return!!t.isCompleteSprintAutomation({getRecordModel:o(792071).b4_.fromRecordMap(e)})||i}(0,r().HB)(t.parent_table)}}};function d(e){return c[e]}},116499:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(757695))().Store{getInitialState(){}}const r=new n},132389:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var n=o(474848);function r(e){const t={display:"inline-block",minWidth:e.size,minHeight:e.size};return"x"===e.axis?t.minHeight=1:"y"===e.axis&&(t.minWidth=1),(0,n.jsx)("div",{style:t})}},149375:(e,t,o)=>{o.d(t,{v:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("arrowLeftThick",{viewBox:"0 0 16 16",directional:!0,svg:(0,n.jsx)("path",{d:"M1.54004 8.05762C1.54004 8.2627 1.62891 8.46094 1.78613 8.61133L6.29102 13.1162C6.45508 13.2734 6.63965 13.3486 6.82422 13.3486C7.25488 13.3486 7.5625 13.041 7.5625 12.6309C7.5625 12.4189 7.48047 12.2344 7.34375 12.1045L5.8125 10.5527L3.78906 8.70703L5.38867 8.80273H13.7012C14.1455 8.80273 14.46 8.49512 14.46 8.05762C14.46 7.61328 14.1455 7.3125 13.7012 7.3125H5.38867L3.7959 7.4082L5.8125 5.5625L7.34375 4.01074C7.48047 3.87402 7.5625 3.68945 7.5625 3.47754C7.5625 3.06738 7.25488 2.7666 6.82422 2.7666C6.63965 2.7666 6.45508 2.83496 6.27734 3.00586L1.78613 7.50391C1.62891 7.64746 1.54004 7.85254 1.54004 8.05762Z"})})},173417:(e,t,o)=>{o(16280),o(944114),o(898992),o(354520),o(672577),o(803949),o(581454),o(737550),o(814603),o(147566),o(198721);var n=()=>o(466103),r=()=>o(158489),i=()=>o(700500),a=()=>o(604995),s=()=>o(80979),l=()=>o(416504);function c(e){if(!e)return Math.floor(249e6*Math.random())+67500000001;return 67500000001+parseInt(e.substring(0,8),16)%249e6}var d=()=>o(402390),u=()=>o(436604),p=()=>o(212547),g=()=>o(696706),m=()=>o(912720),f=()=>o(179034),v=()=>o(628536),y=()=>o(234459),h=()=>o(798880),S=()=>o(245241),b=()=>o(919709),_=()=>o(973647),w=()=>o(534177),k=()=>o(683259),A=()=>o(251582),C=(o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(823215),()=>o(496603)),x=()=>o(510818),I=()=>o(970013),T=()=>o(236162),P=()=>o(792071),M=()=>o(37165),R=()=>o(185078);function E(e){return e.every((e=>{const t="element"===e.type&&["annotation","mention","equation"].includes(e.tagName);return"text"===e.type||t}))}function B(e){return void 0!==e&&"element"===e.type&&"block"===e.tagName}function V(e){return e.every((e=>"element"===e.type&&("block"===e.tagName||"text"===e.tagName||"property"===e.tagName)))}function U(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=P().Bj6.fromBlock(o),a=(0,k().vy)({textValue:i.getProperty("title"),exportArgs:n,renderers:r,fromString:e=>({type:"text",value:(0,x().Pm)(e)})});if(0===a.length&&0===i.getContentLength()&&"page"!==i.getType())return;const s=e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type});if(!E(a))throw new Error("Delineated text node children are invalid");const l={type:"element",tagName:"text",attributes:{},children:a},c={type:"element",tagName:"block",attributes:{id:s.toString()},children:[l]};if(i.getContentLength()>0){const e=n.visitedBlockIds??new Set,t=C().oE(i.getRenderableContentIds().map((t=>{if(!e.has(t))return(0,k().g8)({exportArgs:{...n,blockId:t,renderParentBlockId:i.id,visitedBlockIds:e.add(t)},renderers:r})})));if(!V(t))throw new Error("Block simple XML node children are invalid");c.children.push(...t)}if("page"===i.type&&o.properties){const t=(0,T().zN)({getRecordValue:n.getRecordValue,block:o});if(t&&t.schema)for(const[i,a]of Object.entries(t.schema)){var d;const s=(null===(d=o.properties[i])||void 0===d?void 0:d.toString())??"";a&&s&&i in o.properties&&"text"===a.type&&c.children.push(J({translateRenderer:e,propertyKey:i,inputStr:s,exportArgs:n,renderers:r,metadata:{parentCollectionId:t.id,propertyId:i}}))}}return c}}function D(e){return async(t,o)=>{if(n=t.block,!["page","text","header","sub_header","sub_sub_header","quote","bulleted_list","toggle","to_do","numbered_list","callout"].includes(n.type))return;var n;return await Promise.resolve(U(e)({...t,block:t.block}))}}function L(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=P().Bj6.fromBlock(o),a={type:"element",tagName:"block",attributes:{id:e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type}).toString()},children:[]};if(i.getContentLength()>0){const e=n.visitedBlockIds||new Set,t=C().oE(i.getRenderableContentIds().map((t=>{if(!e.has(t))return(0,k().g8)({exportArgs:{...n,blockId:t,renderParentBlockId:i.id,visitedBlockIds:e.add(t)},renderers:r})})));if(!V(t))throw new Error("Block simple XML node children are invalid");a.children.push(...t)}return a}}function O(e){return async(t,o)=>{if(n=t.block,!["transclusion_container","column","column_list","table_row"].includes(n.type))return;var n;return await Promise.resolve(L(e)({...t,block:t.block}))}}function N(e){const{block:t,exportArgs:o,renderers:n}=e,r=P().Bj6.fromBlock(t),i=r.getTransclusionReferenceTargetPointer();if(!i)return;const a=o.visitedBlockIds||new Set;return a.has(i.id)?void 0:(0,k().g8)({exportArgs:{...o,blockId:i.id,renderParentBlockId:r.id,visitedBlockIds:a.add(i.id)},renderers:n})}function j(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=P().Bj6.fromBlock(o),a=(0,k().vy)({textValue:i.getProperty("caption"),exportArgs:n,renderers:r,fromString:e=>({type:"text",value:e})}),s=e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type});if(!E(a))throw new Error("Delineated text node children are invalid");const l={type:"element",tagName:"text",attributes:{},children:a};return{type:"element",tagName:"block",attributes:{id:s.toString()},children:[l]}}}function F(e){return async(t,o)=>{if(n=t.block,!["image","video"].includes(n.type))return;var n;return await Promise.resolve(j(e)({...t,block:t.block}))}}function H(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=P().Bj6.fromBlock(o),a={type:"element",tagName:"block",attributes:{id:e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type}).toString()},children:[]};if(i.getContentLength()>0){const e=n.visitedBlockIds||new Set,t=C().oE(i.getRenderableContentIds().map((t=>{if(!e.has(t))return(0,k().g8)({exportArgs:{...n,blockId:t,renderParentBlockId:i.id,visitedBlockIds:e.add(t)},renderers:r})})));if(!V(t))throw new Error("Block simple XML node children are invalid");a.children.push(...t)}return a}}function $(e){return async(t,o)=>{if(!function(e){return"table"===e.block.type}(t))return;return await Promise.resolve(H(e)(t))}}function W(e){return async(t,o)=>await Promise.resolve(K(e)(t))}function K(e){return t=>{const{block:o,exportArgs:n,renderers:r}=t,i=P().Bj6.fromBlock(o),a=i.getProperties(),s=C().oE(Object.keys(a).map((t=>{const o=i.getProperty(t);if(!o)return;const a=(0,k().vy)({textValue:o,exportArgs:n,renderers:r,fromString:e=>({type:"text",value:(0,x().Pm)(e)})});if(!E(a))throw new Error("Property children are invalid");return{type:"element",tagName:"property",attributes:{key:e.mapBlockOrAnnotation({type:"property",key:t}).toString()},children:a}})));if(!s.length)return;return{type:"element",tagName:"block",attributes:{id:e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type}).toString()},children:s}}}function z(e){return t=>{const{annotation:o}=t,n=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),{date_format:r,time_format:i,...a}=b().K7D(o),s="date"===(l=a).type?l.start_date:"daterange"===l.type?`${l.start_date} -> ${l.end_date}`:"datetime"===l.type?`${l.start_date} ${l.start_time}`:"datetimerange"===l.type?`${l.start_date} ${l.start_time} -> ${l.end_date} ${l.end_time}`:void(0,w().HB)(l);var l;return{type:"element",tagName:"mention",attributes:{id:n.toString()},children:[{type:"text",value:s}]}}}function q(e){const{children:t}=e;return t}function G(e){return async function(t){let{block:o,exportArgs:n,renderers:r}=t;const i=e.mapBlockOrAnnotation({type:"block",id:o.id,blockType:o.type}),a=await Promise.resolve((0,k().ki)({blockModel:P().Bj6.fromBlock(o),exportArgs:n,includeEmptyCollection:!0}));if(!a||!a.length)return;const s=a[0],{collectionTitle:l,columnIds:c,collectionDescription:d,columnIdToName:u,columnIdToAiPrompt:p,collectionId:g,collectionSpaceId:m,schema:f}=s,v=l?Y(e,{collectionId:g,type:R().kl.NAME,collectionSpaceId:m},l,n,r):void 0,y=d?Y(e,{collectionId:g,type:R().kl.DESCRIPTION,collectionSpaceId:m},d,n,r):void 0,h=[];for(const w of a){const{collectionViewName:t,collectionViewId:o,collectionViewSpaceId:i}=w;if(!t)continue;const a=t?Y(e,{collectionId:g,type:R().kl.VIEW_NAME,collectionViewId:o,collectionSpaceId:m,collectionViewSpaceId:i},t,n,r):void 0;a&&h.push(a)}const S=[],b=C().oE(c.map((t=>{var o;const i=u[t];if(!i)return;const a=(0,k().vy)({textValue:[[i,[]]],exportArgs:n,renderers:r,fromString:e=>({type:"text",value:"string"==typeof e?(0,x().Pm)(e):""})});if(!E(a))throw new Error("Property children are invalid");const s={collectionId:g,type:R().kl.SCHEMA_PROPERTY_NAME,collectionSpaceId:m,propertyId:t,oldValue:i,propertySchemaType:null===(o=f[t])||void 0===o?void 0:o.type},l={type:"element",tagName:"property",attributes:{key:e.mapBlockOrAnnotation({type:"property",key:Q(s),metadata:s}).toString()},children:a},c=f[t];return c&&(0,I().DQ)(c)&&c.options&&S.push(...c.options.map((o=>Y(e,{collectionId:g,type:R().kl.SCHEMA_PROPERTY_OPTION,propertyId:t,optionId:o.id,optionColor:(0,I().lx)(c)?o.color:void 0,collectionSpaceId:m,oldValue:o.value,propertySchemaType:c.type},o.value,n,r)))),l}))),_=C().oE(c.map((t=>{var o;const i=p[t];if(!i)return;const a=(0,k().vy)({textValue:[[i,[]]],exportArgs:n,renderers:r,fromString:e=>({type:"text",value:"string"==typeof e?(0,x().Pm)(e):""})});if(!E(a))throw new Error("Property children are invalid");const s={collectionId:g,type:R().kl.SCHEMA_PROPERTY_AI_INFERENCE,collectionSpaceId:m,propertyId:t,oldValue:i,propertySchemaType:null===(o=f[t])||void 0===o?void 0:o.type};return{type:"element",tagName:"property",attributes:{key:e.mapBlockOrAnnotation({type:"property",key:Q(s),metadata:s}).toString()},children:a}})));return{type:"element",tagName:"block",attributes:{id:i.toString()},children:[...v?[v]:[],...h,...y?[y]:[],...b,...S,..._]}}}function J(e){const{translateRenderer:t,propertyKey:o,inputStr:n,exportArgs:r,renderers:i,metadata:a}=e,s=(0,k().vy)({textValue:[[n,[]]],exportArgs:r,renderers:i,fromString:e=>({type:"text",value:(0,x().Pm)(e)})});if(!E(s))throw new Error("Delineated text node children are invalid");return{type:"element",tagName:"property",attributes:{key:t.mapBlockOrAnnotation({type:"property",key:o,metadata:a}).toString()},children:s}}function Q(e){const{type:t,propertyId:o,optionId:n,optionColor:r,collectionViewId:i}=e;switch(t){case R().kl.NAME:return"collection.name";case R().kl.VIEW_NAME:return`collection.view_name.${i}`;case R().kl.DESCRIPTION:return"collection.description";case R().kl.SCHEMA_PROPERTY_NAME:return`collection.property.${o}`;case R().kl.SCHEMA_PROPERTY_OPTION:return`collection.option.${o}.${n}${r?`.${r}`:""}`;case R().kl.SCHEMA_PROPERTY_AI_INFERENCE:return`collection.property.${o}.ai_inference.prompt`;default:(0,w().HB)(t)}}function Y(e,t,o,n,r){return J({translateRenderer:e,propertyKey:Q(t),inputStr:o,exportArgs:n,renderers:r,metadata:t})}function Z(e){const{translateRenderer:t,metadata:o,textValue:n,exportArgs:r,renderers:i}=e;return function(e){const{translateRenderer:t,propertyKey:o,inputTextValue:n,exportArgs:r,renderers:i,metadata:a}=e,s=(0,k().vy)({textValue:n,exportArgs:r,renderers:i,fromString:e=>({type:"text",value:(0,x().Pm)(e)})});if(!E(s))throw new Error("Delineated text node children are invalid");return{type:"element",tagName:"property",attributes:{key:t.mapBlockOrAnnotation({type:"property",key:o,metadata:a}).toString()},children:s}}({translateRenderer:t,propertyKey:`form_question.${o.propertyId}.${o.type}`,inputTextValue:n,exportArgs:r,renderers:i,metadata:o})}function X(){throw new Error("unimplemented")}function ee(){}function te(e){const t=U(e),o=L(e),n=j(e),r=H(e),i=K(e),a=function(e){return t=>{const{annotation:o,children:n}=t,r=e.mapBlockOrAnnotation({type:"annotation",annotation:o});if(!n)return;if(!function(e){return"text"===e.type||"element"===e.type&&("annotation"===e.tagName||"mention"===e.tagName||"equation"===e.tagName)}(n))throw new Error("Annotation simple XML node children are invalid");const i=[n];return{type:"element",tagName:"annotation",attributes:{id:r.toString()},children:i}}}(e),s=function(e){return t=>{const{annotation:o,exportArgs:n}=t,r=P().b4_.fromGetRecordValueFn(n.getRecordValue),i=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),a=b().v55(o);let s="Untitled page";return r({table:f().ev,id:a})&&(s=(0,k()._z)({intl:n.intl,blockId:a,getRecordValue:n.getRecordValue,userTimeZone:n.userTimeZone})),{type:"element",tagName:"mention",attributes:{id:i.toString()},children:[{type:"text",value:s}]}}}(e),l=function(e){return t=>{const{annotation:o,exportArgs:{intl:n,getRecordValue:r}}=t,i=P().b4_.fromGetRecordValueFn(r),a=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),s=b().NcG(o),l=i({table:h().oo,id:s});let c=null==l?void 0:l.getFullName(n);return c||(c="Tim Smith"),{type:"element",tagName:"mention",attributes:{id:a.toString()},children:[{type:"text",value:c}]}}}(e),c=function(e){return t=>{const{annotation:o,exportArgs:n}=t,r=e.mapBlockOrAnnotation({type:"annotation",annotation:o});let i=(0,k().Pf)({annotation:o,exportArgs:n});return i||(i="Employee group"),{type:"element",tagName:"mention",attributes:{id:r.toString()},children:[{type:"text",value:i}]}}}(e),d=function(e){return t=>{const{annotation:o,exportArgs:n}=t,r=e.mapBlockOrAnnotation({type:"annotation",annotation:o});let i=(0,k().nZ)({annotation:o,exportArgs:n});return i||(i="Employee team"),{type:"element",tagName:"mention",attributes:{id:r.toString()},children:[{type:"text",value:i}]}}}(e),u=function(e){return t=>{var o;const{annotation:n,exportArgs:{getRecordValue:r}}=t,i=e.mapBlockOrAnnotation({type:"annotation",annotation:n}),a=P().b4_.fromGetRecordValueFn(r),s=b().T$c(n),l=(null===(o=a({table:f().ev,id:s}))||void 0===o?void 0:o.getFormatValue("original_url"))??"https://example.com";return{type:"element",tagName:"mention",attributes:{id:i.toString()},children:[{type:"text",value:l}]}}}(e),p=function(e){return t=>{const{annotation:o}=t,n=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),r=b().q1R(o).href;return{type:"element",tagName:"mention",attributes:{id:n.toString()},children:[{type:"text",value:r}]}}}(e),g=z(e),m=function(e){return t=>{const{annotation:o}=t,n=e.mapBlockOrAnnotation({type:"annotation",annotation:o}),r=b().U35(o);return{type:"element",tagName:"equation",attributes:{id:n.toString()},children:[{type:"text",value:r}]}}}(e),v=function(e){return G(e)}(e),y=function(e){return async function(t){return G(e)({...t,block:{...t.block,type:"collection_view"}})}}(e),S=function(e){return async t=>{const{block:o,exportArgs:n,renderers:r}=t;if("form"!==o.type)return;const i=P().Bj6.fromBlock(o),a=(0,k().vy)({textValue:i.getProperty("title"),exportArgs:n,renderers:r,fromString:e=>({type:"text",value:(0,x().Pm)(e)})}),s=e.mapBlockOrAnnotation({type:"block",id:i.id,blockType:i.type});if(!E(a))throw new Error("Delineated text node children are invalid");const l={type:"element",tagName:"text",attributes:{},children:a},c={type:"element",tagName:"block",attributes:{id:s.toString()},children:[l]};["description","custom_submit_button_text","custom_confirmation_screen_title","custom_confirmation_screen_body"].forEach((t=>{var o;const a=null===(o=i.getFormConfig())||void 0===o?void 0:o[t];if(!a)return;const s="string"==typeof a?(0,b().x9d)(a):a,l=(0,k().vy)({textValue:s,exportArgs:n,renderers:r,fromString:e=>({type:"text",value:(0,x().Pm)(e)})});if(!E(l))throw new Error("Property children are invalid");if(0===l.length)return;const d={type:"element",tagName:"property",attributes:{key:e.mapBlockOrAnnotation({type:"property",key:`form.${t}`,metadata:{}}).toString()},children:l};c.children.push(d)}));const d=P().b4_.fromGetRecordValueFn(n.getRecordValue),u=i.getLayoutPointer();if(!u)return c;const p=d(u);if(!p)return c;const g=p.getFormQuestionModulesForFormLayout(),m=[];return null==g||g.map((t=>{var o;const a=d({table:M().lo,id:t.formQuestionId,spaceId:i.getSpaceId()});if(!a)return;const s=a.getConfig(),l=s.propertyId,c=a.id,u={formId:i.id,questionId:c,propertyId:l},p=s.name;p&&m.push(Z({translateRenderer:e,metadata:{type:R().h5.questionName,...u},textValue:p,exportArgs:n,renderers:r}));const g=s.description;g&&m.push(Z({translateRenderer:e,metadata:{type:R().h5.questionDescription,...u},textValue:g,exportArgs:n,renderers:r}));const f=null===(o=s.propertyTypeSpecificConfig)||void 0===o||null===(o=o.checkbox)||void 0===o?void 0:o.label;f&&m.push(Z({translateRenderer:e,metadata:{type:R().h5.checkboxLabel,...u},textValue:f,exportArgs:n,renderers:r}))})),c.children.push(...m),Promise.resolve(c)}}(e),_={...{page:t,text:t,header:t,sub_header:t,sub_sub_header:t,quote:t,bulleted_list:t,toggle:t,to_do:t,numbered_list:t,callout:t,image:n,video:n,transclusion_container:o,transclusion_reference:N,column:o,column_list:o,table:r,table_row:i},...{code:ee,embed:ee,bookmark:ee,file:ee,tweet:ee,maps:ee,gist:ee,framer:ee,invision:ee,mixpanel:ee,drive:ee,figma:ee,loom:ee,pdf:ee,typeform:ee,codepen:ee,audio:ee,divider:ee,equation:ee,collection_view:ee,collection_view_page:ee,factory:ee,copy_indicator:ee,breadcrumb:ee,link_to_collection:ee,link_to_page:ee,table_of_contents:ee,whimsical:ee,miro:ee,abstract:ee,sketch:ee,excalidraw:ee,replit:ee,alias:ee,external_object_instance:ee,tab:ee,hex:ee,deepnote:ee,external_object_instance_page:ee,button:ee,ai_block:ee,drawing:ee,slide:ee,personal_home_page:ee,form:ee,post:ee,workflow:ee,transcription:ee,person_profile:ee}},w={...{page:D(e),text:D(e),header:D(e),sub_header:D(e),sub_sub_header:D(e),quote:D(e),bulleted_list:D(e),toggle:D(e),to_do:D(e),numbered_list:D(e),callout:D(e),image:F(e),video:F(e),transclusion_container:O(e),transclusion_reference:async e=>{const t=function(e){return"transclusion_reference"===e.type}(e.block)?e.block:void 0;if(t)return await Promise.resolve(N({...e,block:t}))},column:O(e),column_list:O(e),table:$(e),table_row:W(e),collection_view:v,collection_view_page:y,form:S},...{image:X,video:X,code:X,embed:X,bookmark:X,file:X,tweet:X,maps:X,gist:X,framer:X,invision:X,mixpanel:X,drive:X,figma:X,loom:X,pdf:X,typeform:X,codepen:X,audio:X,divider:X,equation:X,factory:X,copy_indicator:X,breadcrumb:X,link_to_collection:X,link_to_page:X,table_of_contents:X,transcription:X,whimsical:X,miro:X,abstract:X,sketch:X,excalidraw:X,replit:X,alias:X,external_object_instance:X,tab:X,hex:X,deepnote:X,external_object_instance_page:X,button:X,ai_block:X,drawing:X,slide:X,personal_home_page:X,post:X,workflow:X,person_profile:X}};return{blockRenderers:_,annotationRenderers:{[b().Ifu.Bold]:a,[b().Ifu.Italic]:a,[b().Ifu.Strike]:a,[b().Ifu.Code]:a,[b().Ifu.Highlight]:a,[b().Ifu.Discussion]:a,[b().Ifu.Underline]:a,[b().Ifu.Link]:a,[b().Ifu.Equation]:m,[b().Ifu.Comment]:q,[b().Ifu.Page]:s,[b().Ifu.User]:l,[b().Ifu.Group]:c,[b().Ifu.Team]:d,[b().Ifu.LinkMention]:p,[b().Ifu.Date]:g,[b().Ifu.ExternalObjectInstance]:u,[b().Ifu.Inserted]:q,[b().Ifu.SlackSpecialMention]:ee,[b().Ifu.CustomEmoji]:ee,[b().Ifu.SuggestionInsertText]:ee,[b().Ifu.SuggestionRemoveText]:ee,[b().Ifu.SuggestionAnnotate]:ee,[b().Ifu.SuggestionUnannotate]:ee,[b().Ifu.Deleted]:ee,[b().Ifu.Bot]:ee,[b().Ifu.TemporaryComment]:ee,[b().Ifu.TemporaryCursor]:ee,[b().Ifu.TemporaryEquation]:ee,[b().Ifu.TemporaryPage]:ee,[b().Ifu.TemporaryInput]:ee,[b().Ifu.TemporarySelection]:ee,[b().Ifu.TemporaryFindHighlight]:ee,[b().Ifu.TemporarySelectedFindHighlight]:ee,[b().Ifu.TemplateVariable]:ee,[b().Ifu.FormulaPageProperty]:ee,[b().Ifu.FormulaContextValue]:ee,[b().Ifu.FormulaError]:ee,[b().Ifu.Citation]:ee,[b().Ifu.TemporaryNativeMABFilter]:ee,[b().Ifu.TemporaryDictation]:ee,[b().Ifu.TemporaryHighlight]:ee,[b().Ifu.AssistantInstructionsCollection]:ee,[b().Ifu.TemporaryCommentHighlight]:ee,[b().Ifu.TemporarySuggestionUnderline]:ee,[b().Ifu.Place]:ee,[b().Ifu.TemporarySearchFilter]:ee,[b().Ifu.TitleOnly]:ee},asyncBlockRenderers:w,propertyRenderers:{title:ee,text:ee,select:ee,multi_select:ee,status:ee,relation:ee,rollup:ee,url:ee,email:ee,phone_number:ee,checkbox:ee,person:ee,number:ee,date:ee,file:ee,formula:ee,created_time:ee,last_edited_time:ee,created_by:ee,last_edited_by:ee,button:ee,auto_increment_id:ee,last_visited_time:ee,location:ee,verification:ee,place:ee}}}o(18107),o(967357);var oe=()=>o(331119);function ne(e){const{translateRenderer:t,attributes:o,expectedType:n}=e;if(!("id"in o))return{error:new Error("Expected ID attribute")};const r=parseInt(o.id);if(!(r in t.map))return{error:new Error(`Could not find ${r} in TranslateRenderer`)};const i=t.map[r];return"block"===i.type&&"block"===n?{value:{counter:r,value:{blockType:i.blockType,id:i.id}}}:"annotation"===i.type&&(0,b().Ta1)(i.annotation)&&"textAnnotation"===n||"annotation"===i.type&&(0,b().iGj)(i.annotation)&&"mentionAnnotation"===n||"annotation"===i.type&&(0,b().gir)(i.annotation)&&"equationAnnotation"===n?{value:{counter:r,value:i.annotation}}:{error:new Error(`Expected ${n}, received ${JSON.stringify(i)}.`)}}const re=A().p.mapResult(oe().W6,(e=>({value:e.value})));function ie(e){return A().p.mapResult((0,oe().U5)("text"),(t=>{const o=(0,A().$d)((0,oe().nx)("text",[de(e),se(e),le(e),re]),t.children??[]);return _().Q.isFail(o),o}))}function ae(e){return A().p.mapResult((0,oe().U5)("block"),(t=>{const o=ne({translateRenderer:e,attributes:t.attributes,expectedType:"block"});if(_().Q.isFail(o))return o;const n=(0,A().$d)(A().p.mapResult((0,oe().nx)("block",[A().p.mapResult(re,(e=>({value:[e]}))),A().p.mapResult(de(e),(e=>({value:[e]}))),A().p.mapResult(se(e),(e=>({value:[e]}))),A().p.mapResult(ce(e),(e=>({value:[e],metadata:e.metadata}))),A().p.mapResult(ae(e),(e=>({value:[e]}))),ie(e)]),(e=>({value:e.flat()}))),t.children??[]);return _().Q.isFail(n)?n:{value:{type:"block",blockType:o.value.value.blockType,id:o.value.value.id,children:n.value}}}))}function se(e){return A().p.mapResult((0,oe().U5)("mention"),(t=>{const o=ne({translateRenderer:e,attributes:t.attributes,expectedType:"mentionAnnotation"});if(_().Q.isFail(o))return o;const n=(0,A().$d)(A().p.many(re),t.children??[]);return _().Q.isFail(n)?n:{value:{type:"mention",annotation:o.value.value,text:n.value.join("")}}}))}function le(e){return A().p.mapResult((0,oe().U5)("equation"),(t=>{const o=ne({translateRenderer:e,attributes:t.attributes,expectedType:"equationAnnotation"});if(_().Q.isFail(o))return o;const n=(0,A().$d)(A().p.many(re),t.children??[]);return _().Q.isFail(n)?n:{value:{type:"equation",annotation:o.value.value}}}))}function ce(e){return A().p.mapResult((0,oe().U5)("property"),(t=>{const o=(0,oe().nx)("property",[re,de(e),se(e)]),n=function(e,t){if(!("key"in t))return{error:new Error("Expected key attribute")};const o=parseInt(t.key);if(!(o in e.map))return{error:new Error(`Could not find ${o} in TranslateRenderer`)};const n=e.map[o];return"property"!==n.type?{error:new Error(`Expected property, received ${JSON.stringify(n)}.`)}:{value:{counter:o,value:{key:n.key},metadata:n.metadata}}}(e,t.attributes);if(_().Q.isFail(n))return n;const r=(0,A().$d)(A().p.map(o,(e=>e)),t.children??[]);return _().Q.isFail(r)?r:{value:{type:"property",key:n.value.value.key,children:r.value,metadata:n.value.metadata}}}))}function de(e){return A().p.mapResult((0,oe().U5)("annotation"),(t=>{const o=ne({translateRenderer:e,attributes:t.attributes,expectedType:"textAnnotation"});if(_().Q.isFail(o))return o;const n=(0,oe().nx)("annotation",[re,de(e),se(e)]),r=(0,A().$d)(A().p.map(n,(e=>{if(function(e){return 1===e.length}(e))return e;return[e.at(0)??""]})),t.children??[]);return _().Q.isFail(r)?r:{value:{type:"annotation",annotation:o.value.value,children:r.value}}}))}function ue(e){const{annotation:t}=e;return(0,b().wmz)(t)}function pe(e){const{annotation:t}=e;return(0,b().G0H)(t[1])}function ge(e){const{annotations:t,value:o}=function e(t){const o=[t.annotation],n=t.children[0];if("string"==typeof n)return{annotations:o,value:n};if("mention"===n.type)return{annotations:o,value:n};if("annotation"===n.type){const{annotations:t,value:r}=e(n);return o.push(...t),{annotations:o,value:r}}(0,w().HB)(n)}(e);return"string"==typeof o?(0,b().Ey_)(o,t):(0,b().wmz)(o.annotation,t)}function me(e){const t=[];for(const o of e.children)"string"==typeof o?t.push((0,b().Ey_)(o)):"annotation"===o.type?t.push(ge(o)):"mention"===o.type?t.push(ue(o)):(0,w().HB)(o);return t}function fe(e){let t={};const o={},n=[];for(const r of e.children)"string"==typeof r?n.push((0,b().Ey_)(r)):"annotation"===r.type?n.push(ge(r)):"mention"===r.type?n.push(ue(r)):"property"===r.type?o[r.key]={value:me(r),metadata:r.metadata}:"equation"===r.type?n.push(pe(r)):"block"===r.type&&(t={...fe(r),...t});return{[e.id]:{value:n,blockType:e.blockType,mapping:(0,R().oQ)(e.blockType),properties:o},...t}}class ve{constructor(e){this.map=void 0,this.counter=0,this.renderers=void 0,this.hasTranslated=!1,this.renderers=te(this),this.map=e??{}}getExportArgs(e){const{pagePointer:t,intl:n,getRecordModel:r,serverOrClientConfig:i,experimentService:a,formulasModule:s}=e;return{blockId:t.id,navigableBlockId:t.id,renderParentBlockId:void 0,root:t,numberedListCache:{},bulletedListCache:{},getExportedPathToFile:e=>"",getExportedRenderAsset:e=>"",getExportedPathToPage:e=>"",getRecordValue:r.getRecordValue,getRecordModel:r,getRecordsWithParent:()=>[],userTimeZone:(0,l().P)(),intl:n,baseUrl:i.domainBaseUrl,publicDomainName:i.publicDomainBaseUrl,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,experimentService:a,collectionFeatureGates:(0,o(670913).v)({experimentService:a,actor:void 0,spaceId:t.spaceId}),formulasModule:s}}mapPageToXML(e){if(this.hasTranslated)throw new Error("Page already loaded.");this.hasTranslated=!0;const t=this.getExportArgs(e),o=(0,k().g8)({exportArgs:t,renderers:this.renderers});if(!o||!B(o))throw new Error("Failed to render page");return o}async asyncMapPageToXML(e){if(this.hasTranslated)throw new Error("Page already loaded.");this.hasTranslated=!0;const t=this.getExportArgs(e),n=await(0,k().wL)({exportArgs:t,renderers:this.renderers,ticker:new(o(863567).D)});if(!n||!B(n))throw new Error("Failed to render page");return n}parseXMLToTranslations(e){const t=(0,A().$d)(ae(this),e);if(_().Q.isSuccess(t))return fe(t.value);throw t.error}getBlocksMissingFromTranslationMap(e){const t=Object.keys(e);return Object.values(this.map).map((e=>"block"===e.type?e.id:void 0)).filter(w().O9).filter((e=>!t.includes(e)))}mapBlockOrAnnotation(e){const t=this.counter++;return this.map[t]=e,t}}var ye=()=>o(220719),he=()=>o(545285),Se=()=>o(498212),be=()=>o(449506),_e=()=>o(276470),we=()=>o(334261),ke=()=>o(295118),Ae=()=>o(246826),Ce=()=>o(72234),xe=()=>o(319975),Ie=()=>o(751156),Te=()=>o(755199),Pe=()=>o(166442),Me=()=>o(813297),Re=()=>o(780054),Ee=()=>o(862292),Be=()=>o(263711),Ve=()=>o(199058),Ue=()=>o(765957),De=()=>o(217429),Le=()=>o(712505),Oe=()=>o(630116),Ne=()=>o(148832),je=()=>o(502438),Fe=()=>o(686594),He=()=>o(618743),$e=()=>o(314648),We=()=>o(329304),Ke=()=>o(10984),ze=()=>o(954220),qe=()=>o(157857),Ge=()=>o(698331),Je=()=>o(972435),Qe=()=>o(780865),Ye=()=>o(244641),Ze=()=>o(917629),Xe=()=>o(323714),et=()=>o(299487),tt=()=>o(999544);function ot(e){const{environment:t,userAction:o,data:n}=e,r=Ue().default.state.currentUserSettingsStore;r?Ie().createAndCommit({userAction:o,environment:t,canUndo:!0,userId:r.id,perform:e=>{Te().mJ({userSettingsStore:r,data:n,transaction:e})}}):console.error("Could not find current user settings")}(0,n().exposeDebugEnvironmentValue)("messages",(function(e){const t=t=>{et().bc(e),et().X3(e,t),tt().nS(e,t)};return{resetNotionCalendarOnboarding:()=>{ot({environment:e,userAction:"debuggingHelpers.clearNotionCalendarOnboarding",data:{notion_calendar_launch_modal_phase:null,notion_calendar_launch_modal_dismissed_at:null,seen_open_in_calendar_tooltip:null}}),t("notion_calendar_launch_promo")},resetAsanaPostImportTour:()=>{ot({environment:e,userAction:"debuggingHelpers.resetAsanaPostImportTour",data:{seen_asana_post_import_tour:null}}),t("asana_post_import_tour")},resetFormsShareTooltip:()=>{ot({environment:e,userAction:"debuggingHelpers.resetFormsShareTooltip",data:{seen_forms_share_form_tooltip:null}}),t("forms_share_form_tooltip")},resetFormsAddConditionalLogicTooltip:()=>{ot({environment:e,userAction:"debuggingHelpers.resetFormsAddConditionalLogicTooltip",data:{seen_forms_add_conditional_logic_tooltip:null}}),t("forms_add_conditional_logic_tooltip")},resetDummyModal:()=>{ot({environment:e,userAction:"debuggingHelpers.resetDummyModal",data:{seen_dummy_modal:null}}),t("dummy_modal")},resetSidebarUpgradeNudge:()=>{ot({environment:e,userAction:"sidebarUpgradeNudge.markNotificationAsDismissed",data:{dismissed_sidebar_upgrade_nudge:!1}}),t("sidebar_upgrade_nudge")},forceShowMessage:t=>{const o=(0,Ze().h2)(t);o?et().UW(e,o):console.log(`Invalid static message key: ${t}`)},resetMessageExposures:()=>{et().bc(e)},tryShowMessage:(t,o)=>{const n=(0,Ze().h2)(t);if(n){const t=et().$j(e,n,o);t.error&&console.log(`Could not show ${n} because of ${t.error}`)}else console.log(`Invalid static message key: ${t}`)},resetMessage:t,resetMessageSeen:t=>{tt().nS(e,t)},resetLanguageSwitchPrompt:()=>{ot({environment:e,userAction:"debuggingHelpers.resetLanguageSwitchPrompt",data:{language_switching_prompt_dismissals:[]}}),t("language_switch_prompt")},pushOrReplaceToast:e=>{o(812182).HK(e)},resetLayoutPageEducation:()=>{ot({environment:e,userAction:"debuggingHelpers.resetLayoutPageEducation",data:{layout_info_panel_button_education_tooltip_dismissed_at:null,layout_builder_add_module_button_education_tooltip_dismissed_at:null}})},resetSlackEmbedAiConnectorTooltip:()=>{ot({environment:e,userAction:"debuggingHelpers.resetSlackEmbedAiConnectorTooltip",data:{seen_slack_embed_ai_connector_tooltip:!1}}),t("ai_slack_qna_embed_tooltip")},addDynamicCallout:t=>{et().Ez(e,t)},resetGithubAIConnectorAnnouncement:()=>{const{currentSpaceViewStore:o}=Ue().default.state;o&&(Ie().createAndCommit({environment:e,userAction:"AiGithubAIConnectorAnnouncementModal.clearGithubAIConnectorAnnouncementSeenAt",canUndo:!0,perform:e=>{Ie().applyOperation({store:o,operation:{pointer:o.pointer,path:["settings"],command:"update",args:{...o.getSettings(),ai_github_ai_connector_announcement_seen_at:null}},transaction:e})}}),t("ai_github_ai_connector_announcement"))},resetJiraUniversalQnaAnnouncement:()=>{const{currentSpaceViewStore:o}=Ue().default.state;o&&(Ie().createAndCommit({environment:e,userAction:"debuggingHelpers.resetJiraUniversalQnaAnnouncement",canUndo:!0,perform:e=>{Ie().applyOperation({store:o,operation:{pointer:o.pointer,path:["settings"],command:"update",args:{...o.getSettings(),ai_jira_universal_qna_announcement_seen_at:null}},transaction:e})}}),t("ai_jira_universal_qna_announcement"))},showAiConnectorOnboardingSurveyMoments:e=>{const{currentSpaceViewStore:t}=Ue().default.state;if(t)for(const o of["started","finished","survey_triggered"]){const t=(0,Xe().getAiConnectorOnboardingMomentInSettings)({connector:e,moment:o});if(!t)continue;const n=Ye().c9.fromMillis(t).toISO();console.log(`Connector ${e} ${o} at ${n}`)}else console.error("No space view store found!")},resetAiConnectorOnboardingSurveyMoment:(t,o)=>{const{currentSpaceViewStore:n}=Ue().default.state;n?((0,Xe().setAiConnectorOnboardingSurveyMomentInSettings)({environment:e,currentSpaceViewStore:n,connector:t,moment:o,timestamp:void 0}),console.log(`Reset ${o} for ${t}`)):console.error("No space view store found!")},rewindAiConnectorOnboardingSurveyMoments:(t,o)=>{const{currentSpaceViewStore:n}=Ue().default.state;if(n)for(const r of["started","finished","survey_triggered"]){const i=(0,Xe().getAiConnectorOnboardingMomentInSettings)({connector:t,moment:r});if(!i)continue;const a=Ye().c9.fromMillis(i).minus({days:o}).toMillis();(0,Xe().setAiConnectorOnboardingSurveyMomentInSettings)({environment:e,currentSpaceViewStore:n,connector:t,moment:r,timestamp:a});const s=Ye().c9.fromMillis(a).toISO(),l=Ye().c9.fromMillis(i).toISO();console.log(`Rewound ${r} for ${t} to ${s} (${o} days before ${l})`)}else console.error("No space view store found!")},advanceDaysSinceCalloutDismissal:t=>{const{messageKey:o,nDays:n}=t,{currentUserSettingsStore:r,currentSpaceViewStore:i}=Ue().default.state,a=Ye().c9.now().toMillis();if(r||i){if(r){const t=r.getSettings();if(t){const i=t.callout_dismissal_timestamps??[],s=new Map(i.map((e=>[e.name,e]))),l=s.get(o);l?(l.timestamp=Ye().c9.fromMillis(l.timestamp||a).minus({days:n}).toMillis(),Ie().createAndCommit({userAction:`debugHelpers.advanceDaysSinceCalloutDismissal(userSettings: ${o})`,environment:e,canUndo:!0,perform:e=>{Te().mJ({userSettingsStore:r,transaction:e,data:{callout_dismissal_timestamps:Array.from(s.values())}})}})):console.warn(`No dismissal timestamp found for "${o}" in user settings.`)}else console.error("No user settings found!")}if(i){const t=i.getSettings();if(t){const r=t.callout_dismissal_timestamps??[],s=new Map(r.map((e=>[e.name,e]))),l=s.get(o);l?(l.timestamp=Ye().c9.fromMillis(l.timestamp||a).minus({days:n}).toMillis(),Ie().createAndCommit({userAction:`debugHelpers.advanceDaysSinceCalloutDismissal(spaceView: ${o})`,environment:e,canUndo:!0,perform:e=>{Ce().AG(i,e,{callout_dismissal_timestamps:Array.from(s.values())})}})):console.warn(`No dismissal timestamp found for "${o}" in space view settings.`)}else console.error("No space view settings found!")}}else console.error("No user settings or space view store found!")},advanceDaysSinceCalloutSeen:t=>{const{messageKey:o,nDays:n}=t,{currentUserSettingsStore:r}=Ue().default.state;if(!r)return void console.error("No user settings found!");const i=r.getSettings();if(!i)return void console.error("No user settings found!");const a={...i.callout_seen_timestamps??{}};console.log("Seen record:",a),a[o]?(a[o]=Ye().c9.fromMillis(a[o]).minus({days:n}).toMillis(),console.log("New seen record:",a),Ie().createAndCommit({userAction:`debugHelpers.advanceDaysSinceCalloutSeen(messageKey: ${o})`,environment:e,canUndo:!0,perform:e=>{Te().mJ({userSettingsStore:r,transaction:e,data:{callout_seen_timestamps:a}})}})):console.warn(`No seen timestamp found for "${o}" in user settings.`)},resetAILimitNudge:()=>{ot({environment:e,userAction:"debuggingHelpers.resetAiLimitNudge",data:{addOnLimitNotifications:null}}),t("ai_limit_nudge")},checkMessageEligibility:async t=>await et().TD(e,t)}}));const nt=20;async function rt(e,t){const o=(0,Se().ZA)(t)||t,{inMemoryRecordCache:n,persistedRecordCache:r}=e.defaultRecordCache;let i;for(const a of n.data)if(a.pointer.id===o){console.log(`Found a ${a.pointer.table} record in the in-memory record cache:`,a.model,a.model.__IM_SORRY__getValue());const e=n.checkRecordForTemporaryData(a);if(e&&console.log("The record has been augmented by temporary data:",e),r&&(0,he().u)(a.pointer)){const e=await r.get({pointer:a.pointer,userId:a.userId});console.log("The record is also in the persisted record cache: ",e)}i=p().ms.fromModel(a.model)}return i||console.log("Alas, no records with the id were found in the in-memory record cache."),i}function it(e,t){return"string"==typeof e&&"string"==typeof t?Object.keys(v().jo).includes(e)?{table:e,id:(0,Se().ZA)(t)||t}:{table:t,id:(0,Se().ZA)(e)||e}:"string"!=typeof e||t?"object"==typeof e?e:t:{table:"block",id:(0,Se().ZA)(e)||e}}function at(e,t){if(t>nt)return[];const o=[],n=(null==e?void 0:e.getAutomationStores())??[];o.push(...n.map((e=>lt(e))).filter(w().O9));const r=(null==e?void 0:e.getTemplatePageStores())??[];for(const a of r){const e=a.getAutomationStore();if(e){const t=lt(e);t&&o.push(t)}o.push(...st(a,t+1))}const i=e.getSchema();for(const a of Object.values(i))if("button"===(null==a?void 0:a.type)&&(0,w().O9)(a.automation_id)){const t=lt(Oe().dn.createChildStore(e,{id:a.automation_id,spaceId:e.getSpaceId(),table:m().yB}));t&&o.push(t)}return C().hS(o,(e=>g().L3.toKey(e.automation.pointer)))}function st(e,t){if(t>nt)return[];const o=[];{const n=e.getAutomationStore();if(n){const e=lt(n);e&&o.push(e)}if(e.isCollectionView()){const n=e.getCollectionStore();n&&o.push(...at(n,t+1))}}const n=e.getContentStores();for(const r of n){const e=r.getAutomationStore();if(e){const t=lt(e);t&&o.push(t)}if(r.isCollectionView()){const e=r.getCollectionStore();e&&o.push(...at(e,t+1))}o.push(...st(r,t+1))}return C().hS(o,(e=>g().L3.toKey(e.automation.pointer)))}function lt(e){if(!e)return;const t=(null==e?void 0:e.getActionStores())??[],o=null==e?void 0:e.getCreatedByPointer(),n=(null==o?void 0:o.table)===h().oo&&(null==e?void 0:e.getRecordModel(o));return n?{automation:e,actions:t,createdBy:n,parent:e.getParentBlockStore()}:void 0}(0,n().exposeDebugEnvironmentValue)("debugging",(e=>{const t=function(e){const t=async(t,o)=>{const n=it(t,o),r=await(0,_e().e)(e,{pointer:n,version:-1,userId:e.currentUser.id});return(null==r?void 0:r.value)||void 0},n=async(t,n)=>{var r;const a=it(t,n),s=await(0,_e().e)(e,{pointer:a,version:-1,userId:e.currentUser.id}),l=null==s?void 0:s.value;if(!l)return void console.log(`Unable to find record ${(0,o(452540).jV)(a)}.`);const c=null===(r=(0,o(186445).ZO)())||void 0===r?void 0:r.pointer.spaceId;Ie().createAndCommit({environment:e,perform(t){const n=Ae().Wv({environment:e,type:i().xd.code,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,transaction:t,spaceId:c});xe().R9({environment:e,store:n.getBlockTitleStore(),transaction:t,value:[[JSON.stringify(l,null,2)]]}),o(899038).IA({blocks:[n],language:"JSON",transaction:t}),xe().R9({environment:e,store:n.getCaptionStore(),transaction:t,value:[[`${a.table} ${a.id}`]]}),o(797265).LE({environment:e,blocksToInsert:[n],target:je().default.state.stores,transaction:t,replaceEmptyTextBlock:!1})},userAction:"debuggingHelpers.editRecordJson",canUndo:!0}),console.log("Created a code block with the record source. You can make edits and, with the text cursor still in the block, use __console.updateRecordJson() to write it back to the database. Do not modify the caption.")},p=()=>{const t=je().default.state.stores[0];if(!(t instanceof Ne().B&&t.isType(i().xd.code)))return void console.log("No code block is selected!");const o=(e=>{try{return JSON.parse(e)}catch(t){return void console.error(t)}})((0,b().q4_)(t.getTitleValue()));if(!o)return void console.log("Unable to parse JSON in selected code block.");const[n,r]=(0,b().q4_)(t.getCaptionStore().getValue()).split(" ");if(!n||!r)return void console.log("Unable to parse record pointer in caption.");const a=it(n,r);Ie().createAndCommit({environment:e,perform(n){const r=(0,Oe().Oo)(t,a);if(r instanceof Ne().B){const t=o.properties;if(t){delete o.properties;const i=t.title;i&&xe().R9({environment:e,store:r.getBlockTitleStore(),value:i,transaction:n}),delete t.title,Ie().applyOperation({store:r,operation:{pointer:r.pointer,path:["properties"],command:"update",args:t},transaction:n})}}Ie().applyOperation({store:r,operation:{pointer:r.pointer,path:[],command:"update",args:o},transaction:n})},userAction:"debuggingHelpers.updateRecordJson",canUndo:!0}),console.log(`Updated ${n} ${r}. Press Cmd-Z (in Notion, not console) to undo.`)},g=async()=>{var t,o;const n=null===(t=Ue().default.state.currentSpaceStore)||void 0===t?void 0:t.getSpaceId(),r=null===(o=Ue().default.state.currentUserStore)||void 0===o?void 0:o.userId;if(!n||!r)return;const i=await(0,ze().fetchUserSignals)({spaceId:n,environment:e});void 0!==i&&(0,ze().setUserSignals)({spaceId:n,userId:r,environment:e,newSignals:i,initialize:!1})},_=()=>{var e,t;const o=null===(e=Ue().default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceId(),n=null===(t=Ue().default.state.currentUserStore)||void 0===t?void 0:t.userId;if(!o||!n)return;const r=$e().default.getUserSignals({spaceId:o,userId:n});return r?$e().USER_SIGNALS_KEYS.map((e=>[e,("similarUserRecentPages"===e?Array.from(Object.values(r[e])):r[e]).map((e=>{let{pageId:t,...o}=e;return{...o,pageId:t,page:I(f().ev,t)}}))])):void 0},k=t=>Oe().sk.createUniqueRootStore(e,t),A=(t,o)=>{var n;const r=it(t,o),i=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:r,userId:e.currentUser.id});if(void 0===(null==i?void 0:i.value))return`${r.table}: ${r.id}`;const a="type"in i.value?i.value.type:r.table;return"name"in(null==i?void 0:i.value)?`${a} ${i.value.id} ${i.value.name}`:"properties"in(null==i?void 0:i.value)&&(0,w().O9)(i.value.properties)&&"title"in i.value.properties&&(0,w().O9)(null==i?void 0:i.value.properties.title)?`${a} ${i.value.id} ${i.value.properties.title.join(" ").slice(0,30)}`:`${a} ${null==i||null===(n=i.value)||void 0===n?void 0:n.id}`},x=(t,o)=>{const n=it(t,o);return e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:n,userId:e.currentUser.id})},I=(e,t)=>{const o=it(e,t),n=x(e,t),r={title:A(e,t),raw:null==n?void 0:n.value,parent:void 0,id:o,children:[]};var i,a;void 0!==(null==n?void 0:n.value)&&"parent_table"in(null==n?void 0:n.value)&&"parent_id"in(null==n?void 0:n.value)&&n.value.parent_id&&(r.parent=it(null===(i=n.value)||void 0===i?void 0:i.parent_id,null===(a=n.value)||void 0===a?void 0:a.parent_table));if(null!=n&&n.value&&"content"in(null==n?void 0:n.value)){var s;const e=(null==n||null===(s=n.value)||void 0===s?void 0:s.content)||[];for(const t of e){const e=it(t,"block"),n=x(t,"block"),i={title:A(t,"block"),raw:null==n?void 0:n.value,parent:o,id:e,children:[]};r.children.push(i)}}return r},T=()=>{var e;const t=null===(e=V())||void 0===e?void 0:e.id;if(t)return I(t,"block");console.error("Not opening")},P=(e,t)=>`${Re().A.adminUrl}/__admin/${e}/${t}`,M=(e,t)=>{window.open(P(e,t))},R=()=>{if(0!==je().default.state.stores.length)return je().default.state.stores.forEach((e=>{M(f().ev,e.id)}));console.error("No selected block")},E=()=>{Ue().default.state.currentSpaceStore?M(o(96689).NX,Ue().default.state.currentSpaceStore.id):console.error("No current space")},B=()=>{var e;const t=null===(e=V())||void 0===e?void 0:e.id;t?M(f().ev,t):console.error("Not opening")},V=()=>Le().default.state.open?(console.warn("Returning peek view page, if you want the underlying page, please close it and try again"),Le().default.state.targetStore):Ue().default.state.mainEditorCurrentBlockStore?Ue().default.state.mainEditorCurrentBlockStore:void console.error("No current mainEditorCurrentBlockStore"),U=t=>{if(!t.isTabbedPageLayout())return void console.error("Current layout is not a tabbed page layout, make it tabbed before using this function to add duplicate content tab");const n=t.getViewsModuleCollectionViewBlockStore();if(!n)return void console.error("No collection view block store found");const r=`view_tab_duplicate_${c()}`;Ie().createAndCommit({userAction:"debuggingHelpers.addDuplicateContentTabToCurrentLayout",environment:e,canUndo:!0,perform(i){(0,o(38e3).Q)({environment:e,layoutStore:t,transaction:i,collectionViewBlockStore:n,options:{viewsTabId:r}})}})},D=()=>{var t;if(!Ue().default.state.mainEditorCurrentBlockStore)return void console.error("No current mainEditorCurrentBlockStore");const o=Ue().default.state.mainEditorCurrentBlockStore.getAssociatedCollectionStore()||Ue().default.state.mainEditorCurrentBlockStore.getCollectionStore();if(!o)return void console.error("Cannot find collection store to remove Page sections from");const n=o.getFormat(),r=((null===(t=n.property_visibility)||void 0===t?void 0:t.filter((e=>"section"===e.visibility)))||[]).map((e=>e.property));Ie().createAndCommit({userAction:"debuggingHelpers.addRelationsGroupModuleToCurrentLayout",environment:e,canUndo:!0,perform(t){we().LK({store:o,pageSectionFormats:[],transaction:t,environment:e}),r.forEach((e=>{we().D7({property:e,visibility:"show",store:o,format:n,transaction:t})}))}})},L=t=>{const{visibility:o,section:n}=t,r=Ue().default.state.mainEditorCurrentBlockStore;if(!o||!n)return void console.error("No visibility or section provided");if(!r)return;const i=r.getAssociatedCollectionStore()||r.getCollectionStore(),a=(null==i?void 0:i.getFormat())||r.getFormat();we().OD({environment:e,store:i||r,pageSection:n,visibility:o,format:a})},O=()=>{var e,t;const o=null===(e=V())||void 0===e?void 0:e.getCreatedById(),n=null===(t=V())||void 0===t?void 0:t.getCreatedByTable();if(o&&n)return x(o,n);console.error("no created_by_id or created_by_table for this page")},N=()=>{var e;const t=O(),o=null==t||null===(e=t.value)||void 0===e?void 0:e.id;o?M(h().oo,o):console.error("no current page Creator, not opening")},j=function(t){var o;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;const a="string"==typeof t?{query:{text:t,filters:(0,S().N2)(),sort:{field:"relevance"}},limit:20,debug:n}:t;return{environment:e,input:a,spaceId:null===(o=Ue().default.state.currentSpaceStore)||void 0===o?void 0:o.id,publicAccessPermissionAncestorBlockId:Qe().Er(e).publicAccessPermissionAncestorBlockId,searchExperimentOverrides:i,forcedClusterPattern:r,source:"debugging"}},F=async function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const i="string"==typeof t?{query:{text:t,filters:(0,S().N2)(),sort:{field:"relevance"}},limit:20,debug:o}:t,a=Ue().default.state.currentSpaceStore,{query:s,limit:l}=i;if(!a)return;const c=be().callApi({eventName:"search",environment:e,data:{type:S().Vz.CollectionsInSpace,query:s.text.trim(),spaceId:a.id,limit:l,filters:S().N2({excludeTemplates:!0,requireEditPermissions:!0}),sort:{field:"relevance"},debug:o,searchExperimentOverrides:r,forcedClusterPattern:n}}),d=await c;return"success"===d.type?d.data:d},H={id:"root0000-0000",table:"block"},$=e=>{var t;if(void 0!==(null==e||null===(t=e.value)||void 0===t?void 0:t.parent_id))return it(e.value.parent_id,e.value.parent_table)},W=e=>{const t=new(o(795727).A);e.map((e=>{const o=it(e.id,e.table),n=A(e.id,e.table),r=x(e.id,e.table),i={title:n,parent:$(r),id:o,raw:null==r?void 0:r.value,children:[]};t.set(o,i)}));const n={title:"root",parent:void 0,id:H,raw:void 0,children:[]};return e.map((e=>{const o=it(e.id,e.table),r=t.get(o);var i;void 0!==(null==r?void 0:r.parent)&&t.has(r.parent)?null===(i=t.get(r.parent))||void 0===i||i.children.push(r):void 0!==r?n.children.push(r):n.children.push({title:"Failed to load Record",parent:void 0,id:o,raw:void 0,children:[]})})),n},K=()=>{if(!De().default.isStatsigEnabled())throw new Error("Failed to override: Statsig not enabled");if(!Fe().A.isInitialized())throw new Error("Failed to override: Statsig not initialized")},z=()=>{var e;return null===(e=V())||void 0===e?void 0:e.getSpaceId()},q=()=>{var e;return null===(e=Ue().default.state.currentUserStore)||void 0===e?void 0:e.id},G=async t=>{const o=z(),n=q(),r=`${"production"}-main-usw2-0001`,i=await be().callApi({eventName:"getSpacesInitial",environment:e,data:{},headers:{[u().tx]:r}});if(o&&n&&"success"===i.type){const e=i.data.fanoutData,t=(null==e?void 0:e.filter((e=>{let{request:t}=e;return t.users[n].some((e=>{let{spaceId:t}=e;return t===o}))})))||[];return t.length>0?t[0].headers[u().tx]:void 0}},J=()=>{const e=V();if(e)return st(e,0)},Q=()=>{var t;const n=null===(t=Ue().default.state.currentSpaceStore)||void 0===t?void 0:t.id,r=e.currentUser.id;if(n&&r)return(0,o(90634).hj)({spaceId:n,userId:r})},Y=async(t,n)=>{var r,i;const a=await Ee().T.formulas.load(),s=V(),c=null==s?void 0:s.getModel();if(!s||!c||!c.isPageBlock())return;const u=s.getRecordModel,p=u({id:t,spaceId:s.getSpaceId(),table:m().yB});if(!p)return;const g=(0,o(68465).t1)(e),f=p.getActionPointers().map((e=>u(e))).filter(w().O9);if(f.length!==p.getActionIds().length)return;const v=Ue().default.state,y=(0,We().zD)(e,{name:"slack_automation_action",spaceId:null===(r=v.currentSpaceStore)||void 0===r?void 0:r.id,userId:null===(i=v.currentUserStore)||void 0===i?void 0:i.id});return(0,o(310109).typecheckAutomation)("button_block"===n?{actionModels:f,automationModel:p,assistantFeatureGate:g,checkExperimentGate:e=>De().default.checkGate({gateName:e}),contextType:n,formulasModule:a,getRecordModel:u,intl:(0,d()._z)(),isSubscribed:(0,Ke().y4)(),pageBlockModel:c,userTimeZone:(0,l().P)(),valueTypes:[],env:"production",hasAccessToSlackAction:y}:{actionModels:f,automationModel:p,assistantFeatureGate:g,checkExperimentGate:e=>De().default.checkGate({gateName:e}),contextType:n,formulasModule:a,getRecordModel:u,intl:(0,d()._z)(),isSubscribed:(0,Ke().y4)(),userTimeZone:(0,l().P)(),valueTypes:[],env:"production",hasAccessToSlackAction:y})},Z=async t=>{var n,r;const a=V();if(!a)throw new Error("Could not get current page");const s=Oe().dn.createChildStore(a,{id:t,table:m().yB,spaceId:a.getSpaceId()}),[l,c,d]=await Promise.all([Ee().T.formulas.load(),Me().QV.automationTypecheck.load(),Me().QV.automationActionRegistry.load()]),u=Ue().default.state,p=(0,We().zD)(e,{name:"premium_automations",spaceId:null===(n=u.currentSpaceStore)||void 0===n?void 0:n.id,userId:null===(r=u.currentUserStore)||void 0===r?void 0:r.id});if(s.isTriggerType("button")){const n=s.getParentStore();if(!n)throw new Error("Could not get parent store");if(n instanceof Ne().B){var g;if(!n.isType(i().xd.button))throw new Error("Unexpected parent for button block automation");if(!a.isPageBlock())throw new Error("Current page must be a page block for button analysis");return(0,qe().jl)({environment:e,automationActionRegistryModule:d,automationStore:s,automationTypecheckModule:c,blockStore:n,currentUserId:null===(g=e.currentUser)||void 0===g?void 0:g.id,isLoggedIn:e.currentUser.isLoggedIn(),formulasModule:l,intl:Je().A.getIntl(),isSubscribed:p,pageStore:a,parentRecordStore:s,type:"button_block"})}{var f;const r=Object.entries(n.getSchema()).find((e=>{let[,o]=e;return"button"===(null==o?void 0:o.type)&&o.automation_id===t}));if(!r)throw new Error("Could not find property schema for button automation");const[i,a]=r;if("button"!==(null==a?void 0:a.type))throw new Error("Expected button property schema");const u=new(o(414834).A)(e);return u.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:n}),(0,qe().jl)({environment:e,automationActionRegistryModule:d,automationStore:s,automationTypecheckModule:c,collectionContextStore:u,currentUserId:null===(f=e.currentUser)||void 0===f?void 0:f.id,formulasModule:l,intl:Je().A.getIntl(),isLoggedIn:e.currentUser.isLoggedIn(),isSubscribed:p,parentRecordStore:s,propertyId:i,propertySchema:a,type:"button_property"})}}if((0,Ge().$X)(s))return(0,qe().sl)({environment:e,automationActionRegistryModule:d,automationTypecheckModule:c,automationStore:s,contextType:(0,Ge().H8)((0,ye().o9)(s.getTriggerType(),"Could not get trigger type")),formulasModule:l,intl:Je().A.getIntl(),isSubscribed:p});throw new Error("Unexpected automation type")},X=t=>{const o=Ue().default.state.currentUserSettingsStore,n=null==o?void 0:o.getSettings();if(!o||!n)return void console.error("Could not find current user settings");const r=e=>e?(0,a().K1)({date:e,daysToAdd:-t}):e;Ie().createAndCommit({userAction:"debuggingHelpers.advanceAssistantOnboardingNDays",environment:e,canUndo:!0,userId:o.id,perform:e=>{Te().mJ({userSettingsStore:o,data:{last_exposed_to_ai_qna_at:r(n.last_exposed_to_ai_qna_at),last_used_ai_writer_at:r(n.last_used_ai_writer_at),ai_assistant_onboarding_phase_last_set_at:r(n.ai_assistant_onboarding_phase_last_set_at),ai_assistant_tutorial_dismissed_at:r(n.ai_assistant_tutorial_dismissed_at),ai_sales_assisted_extra_notification_seen_at:r(n.ai_sales_assisted_extra_notification_seen_at),qna_reminders_shown_at:(0,w().O9)(n.qna_reminders_shown_at)?n.qna_reminders_shown_at.map((e=>(0,a().K1)({date:e,daysToAdd:-t}))):void 0},transaction:e})}})},ee=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetNotionAiSidebarNewBadge",environment:e,canUndo:!0,userId:t.id,perform:e=>{Te().mJ({userSettingsStore:t,data:{ai_sidebar_item_new_badge_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},te=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetAiSearchModalItemDismissed",environment:e,canUndo:!0,userId:t.id,perform:e=>{Te().mJ({userSettingsStore:t,data:{ai_search_modal_item_dismissed_by_user_without_ai_at:null},transaction:e})}}):console.error("Could not find current user settings")},oe=()=>{const t=Ue().default.state.currentSpaceViewStore;t&&Ie().createAndCommit({userAction:"SidebarPersonalHomeSettings.markWelcomeAnimationAsSeen",environment:e,canUndo:!0,perform:e=>{const o=t.getSettingsStore().getKeyStore("personal_home").getKeyStore("seen_welcome_animation");Ae().KY({store:o,transaction:e,value:!1})}})},ne=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetHomeSidebarNewBadge",environment:e,canUndo:!0,perform:e=>{Te().mJ({userSettingsStore:t,data:{personal_home_sidebar_item_clicked_at:null},transaction:e})}}):console.error("Could not find current user settings")},re=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetFeedViewNewButtonClicked",environment:e,canUndo:!0,perform:e=>{Te().mJ({userSettingsStore:t,data:{feed_view_new_button_clicked_at:null},transaction:e})}}):console.error("Could not find current user settings")},ie=()=>{const t=Ue().default.state.currentSpaceViewStore;t?Ie().createAndCommit({environment:e,userAction:"debuggingHelpers.resetDatabaseAISummaryDismiss",canUndo:!0,perform:e=>{Ce().AG(t,e,{dismissed_db_page_summary_suggestion:0})}}):console.error("Could not find current space view")},ae=()=>{const t=Ue().default.state.currentSpaceViewStore;t?Ie().createAndCommit({userAction:"githubAIConnector.onboarding.dismissPersonalAuthPrompt",environment:e,canUndo:!0,perform:e=>{t&&Ie().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),dismissed_github_personal_auth_prompt:!1}},transaction:e})}}):console.error("Could not find current user settings")},se=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.clearQnAOnboarding",environment:e,canUndo:!0,userId:t.id,perform:e=>{var o;Te().mJ({userSettingsStore:t,data:{ai_qna_intro_onboarding_phase:null,last_exposed_to_ai_qna_at:null,last_used_ai_writer_at:null,qna_reminders_shown_at:null,ai_assistant_onboarding_phase:null,ai_assistant_tooltips_onboarding_phase:null,ai_onboarding_phase:null,ai_assistant_onboarding_phase_last_set_at:null,ai_sales_assisted_extra_notification_seen_at:null,ai_assistant_tutorial_dismissed_at:null,assistant_summarize_this_page_shown_at:void 0,ai_qna_abandoned_search_reminder_shown_at:void 0,callout_dismissal_timestamps:((null===(o=t.getSettings())||void 0===o?void 0:o.callout_dismissal_timestamps)??[]).filter((e=>"ai_assistant_announcement"!==e.name))},transaction:e})}}):console.error("Could not find current user settings")},le=()=>{const{currentSpaceViewStore:t}=Ue().default.state;t&&Ie().createAndCommit({environment:e,userAction:"AiSlackQnaNotificationTooltip.clearSlackQnaAnnouncementSeenAt",canUndo:!0,perform:e=>{Ie().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),slack_universal_qna_announcement_seen_at:null}},transaction:e})}})},ce=()=>{const{currentSpaceViewStore:t}=Ue().default.state;t&&Ie().createAndCommit({environment:e,userAction:"JiraConnectionPending.clearJiraConnectionPending",canUndo:!0,perform:e=>{Ie().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),dismissed_jira_installation_pending_prompt:!1}},transaction:e})}})},de=()=>{const{currentSpaceViewStore:t}=Ue().default.state;t&&Ie().createAndCommit({environment:e,userAction:"JiraUserAuthLogin.clearJiraUserAuthLogin",canUndo:!0,perform:e=>{Ie().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),dismissed_jira_user_auth_prompt:!1}},transaction:e})}})},ue=()=>{const{currentSpaceViewStore:t}=Ue().default.state;t&&Ie().createAndCommit({environment:e,userAction:"JiraSelectProjects.clearJiraSelectProjects",canUndo:!0,perform:e=>{Ie().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),dismissed_jira_select_projects_prompt:!1}},transaction:e})}})},pe=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetTwoWayLimitAddRelationConfirmationDialog",environment:e,canUndo:!0,userId:t.id,perform:e=>{Te().mJ({userSettingsStore:t,data:{relation_limit_confirmation_dialog_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},ge=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetAiPageTranslationPassiveSuggestions",environment:e,canUndo:!0,userId:t.id,perform:e=>{Te().mJ({userSettingsStore:t,data:{ai_page_translation_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},me=()=>{const{currentSpaceViewStore:t}=Ue().default.state;t&&Ie().createAndCommit({environment:e,userAction:"AiGoogleDriveQnaNotificationTooltip.clearGoogleDriveQnaAnnouncementSeenAt",canUndo:!0,perform:e=>{Ie().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),google_drive_universal_qna_announcement_seen_at:null}},transaction:e})}})},fe=()=>{const t=Ue().default.state.currentSpaceStore,o=Ue().default.state.currentSpaceViewStore;t&&o?Ie().createAndCommit({userAction:"debuggingHelpers.resetAssistantLeapSettings",environment:e,canUndo:!0,perform:e=>{Ae().zv({store:t,data:{settings:{...t.getSettings(),enable_ai_training:void 0}},transaction:e}),Ie().applyOperation({store:o,operation:{pointer:o.pointer,path:["settings"],command:"update",args:{...o.getSettings(),has_user_seen_leap_modal:!1}},transaction:e})}}):console.error("Could not find current space")},he=()=>{const t=Ue().default.state.currentSpaceViewStore;t?Ie().createAndCommit({userAction:"slackAIConnector.onboarding.dismissPersonalAuthPrompt",environment:e,canUndo:!0,perform:e=>{t&&Ie().applyOperation({store:t,operation:{pointer:t.pointer,path:["settings"],command:"update",args:{...t.getSettings(),dismissed_slack_personal_auth_prompt:!1}},transaction:e})}}):console.error("Could not find current user settings")},Ye=()=>{const{RouterStore:t}=e,o=Ue().default.state.currentSpaceStore;if(!o)return;const n=t.state.route;let r;if("chat"===n.name?r=n.threadId:"page"===n.name&&(r=(0,Se().ZA)(n.chatThreadId)),!r)return;const i=Oe().Ei.createChildStore(o,{id:r,spaceId:o.id,table:y().To});return{thread:i,messages:i.getMessageStores()}},Ze=()=>{const{thread:e}=Ye()??{};return e?e.getTranscript():[]},Xe=()=>{const{thread:e}=Ye()??{};if(!e)return[];return Pe().Kd.getOrCreateClientAIChatThreadStore(e.id).state.temporarySteps},et=()=>{const{thread:e}=Ye()??{};return(0,o(805126).A3)({threadStore:e,clientStore:Pe().Kd}).steps},tt=()=>{const t=Ze(),o=new Map;for(const n of t)if("agent-inference"===n.type&&"string"!=typeof n.value){for(const r of n.value)if("tool_use"===r.type){const n=JSON.parse(r.content),i=()=>{const o=Ye();if(o)return be().callApi({environment:e,eventName:"runAgentTool",data:{toolName:r.name,transcript:t,input:r.content,threadId:o.thread.id,spaceId:o.thread.getSpaceId()}})};o.set(r.id,{id:r.id,input:n,replay:i})}}else if("agent-tool-result"===n.type&&n.toolCallId){const e=o.get(n.toolCallId);e&&(e.result=n.result??n.error)}else if("agent-debug-error"===n.type&&n.fromToolCallId){const e=o.get(n.fromToolCallId);e&&(e.result=n)}return[...o.values()]},ot=()=>(0,r().XY)(Ze()),nt=()=>{const e=Ze();return(0,r().YO)({transcript:e}).toJson()},at=()=>{var t,o,n,r,i;const{RouterStore:a}=e,s=a.state.route;if("page"!==s.name)return;const l=s.collectionViewId;if(!l)return void console.error("Must run this from a Form view");const c=null===(t=x(l,"collection_view"))||void 0===t?void 0:t.value;if(!c||"form_editor"!==c.type)return void console.error("Must run this from a Form view");const d=(null===(o=c.format)||void 0===o||null===(o=o.form_block_pointer)||void 0===o?void 0:o.id)??"",u=null===(n=x(d,"block"))||void 0===n?void 0:n.value;if(!u)return void console.error("Can't load form block");const p=(null===(r=u.format)||void 0===r||null===(r=r.form_layout_pointer)||void 0===r?void 0:r.id)??"",g=null===(i=x(p,"layout"))||void 0===i?void 0:i.value;g?(console.log("Form editor view: \n"),console.log(c),console.log("Form block: \n"),console.log(u),console.log("Form layout: \n"),console.log(g)):console.error("Can't load form layout")},lt=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetJiraOnboardingTourLaunch",environment:e,canUndo:!0,userId:t.id,perform:e=>{Te().mJ({userSettingsStore:t,data:{tutorials:{"jira-sync-onboarding":"all-projects-tooltip"},jira_sync_onboarding_tour_state:"notSeen",seen_jira_sync_source_tooltip:!1},transaction:e})}}):console.error("Could not find current user settings")},ct=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetImproveJiraSyncPopup",environment:e,canUndo:!0,userId:t.id,perform:e=>{Te().mJ({userSettingsStore:t,data:{seen_improve_jira_sync_popup:null},transaction:e})}}):console.error("Could not find current user settings")},dt=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetJiraSetupGuide",environment:e,canUndo:!0,userId:t.id,perform:e=>{Te().mJ({userSettingsStore:t,data:{jira_sync_guide_dismissed_at:null},transaction:e})}}):console.error("Could not find current user settings")},ut=async()=>{const{currentSpaceStore:t,currentSpaceViewStore:n}=Ue().default.state;if(t){const r=await(0,o(448433).h)({environment:e,currentSpaceStore:t,currentSpaceViewStore:n}),i=new Map;return r.getAllBlocks().forEach((e=>{e.block.source.forEach((t=>{const o=i.get(t)||[];o?i.set(t,[...o,e.block]):i.set(t,[e.block])}))})),{...r,groupedPages:i}}},pt=async()=>{var t;const o=null===(t=e.defaultRecordCache.persistedRecordCache)||void 0===t?void 0:t.getDedicatedWorkerConnection_DEBUG_ONLY();if(!o)throw new Error("Browser SQLite is not active here!");await o.completelyRebuildSqliteDb(),console.log("Browser SQLite DB successfully reset!")},gt=async()=>{try{var t;await(null===(t=e.defaultRecordCache.persistedRecordCache)||void 0===t?void 0:t.reset()),o(670631).A.reset()}catch(n){console.error("Error resetting SQLite:",n)}finally{console.log("SQLite reset successfully")}},mt=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unread_and_read",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US";const r=z();if(r){const i=await be().callApi({eventName:"getNotificationsForInbox",environment:e,data:{spaceId:r,size:o,type:t,locale:n}});console.log(i)}else console.log("no space id")},ft=t=>{const n=o(388821).RecordMapWithRole.create();for(const[o,r]of Object.entries(t)){if(!v().bI(o)||!Array.isArray(r))throw new Error(`Not a table: ${o}. Argument should be like { block: [id1, id2], collection: [...], ... }`);for(const t of r){const r={table:o,id:t},i=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:r,userId:e.currentUser.id});i&&n.setValueAndRole(r,i.value,i.role)}}return n},vt=e=>ft(e).toRecordMap(),yt=()=>{const t=V();t&&(0,o(198874).l)({environment:e,pageStore:t,duplicateTo:"private_pages",triggeredFrom:"debugging_helper"})},ht=()=>{const t=V();if(!t)return;const n=(new ve).mapPageToXML({pagePointer:t.getSpaceShardedPointer(),intl:(0,d()._z)(),getRecordModel:e.defaultRecordCache.inMemoryRecordCache.makeGetRecordModelFn(e.currentUser.id),serverOrClientConfig:{domainBaseUrl:Re().A.domainBaseUrl,publicDomainBaseUrl:Re().A.publicDomainName},experimentService:De().default,formulasModule:s()});return(0,o(412412)._o)(n)},St=async t=>await(0,o(883777).p)({environment:e,chatTranscriptStorageStep:t,chatStartTimestamp:Date.now(),makeActiveSession:!0}),bt=()=>{const t=Ue().default.state.currentUserSettingsStore;t?Ie().createAndCommit({userAction:"debuggingHelpers.resetAssistantSuggestionExposure",environment:e,canUndo:!0,userId:t.id,perform:e=>{Te().mJ({userSettingsStore:t,data:{ai_suggested_skill_exposure_tracker:null},transaction:e})}}):console.error("Could not find current user settings")},_t=()=>{console.error("Mock connector statuses are not enabled in production")},wt=()=>{ke().ZC.setState(!1)},kt=(t,o)=>{if(ke().ZC.state)try{ke().Wh(e,t,o),console.log("Setting mock connector status for",t,o)}catch(n){console.error(n)}else console.error("Mock connector statuses are not enabled")},At=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2500;ke().jx(e,t).catch((e=>{console.error(e)})).finally((()=>{console.log("Mock connector statuses run through complete.")}))},Ct=e=>{(0,He().Py)(e),console.info(`[Info] Debugging for feature gate ${e} turned on. This will print evaluations every time when the gate is checked on the client.`)},xt=e=>{(0,He().JK)(e),console.info(`[Info] Debugging for ${e?"":"all "}feature gate ${e?e+" ":""}turned off.`)},It=e=>{(0,He().XL)(e),console.info(`[Info] Debugging for experiment ${e} turned on. This will print evaluations every time when the experiment is checked on the client.`)},Tt=e=>{(0,He().Bu)(e),console.info(`[Info] Debugging for ${e?"":"all "}experiment ${e?e+" ":""}turned off.`)},Pt=()=>{He().LX.setState({isStatsigUserDiffDebuggingEnabled:!0}),console.info("[Info] Debugging for statsig user diff turned on. This will print statsig user every time when the statsig user is changed.")},Mt=()=>{He().LX.setState({isStatsigUserDiffDebuggingEnabled:!1}),console.info("[Info] Debugging for statsig user diff turned off.")};return{getRecordFromApi:t,getRecordFromCache:x,getAdminUrl:P,getSelectedBlocks:()=>je().default.state.stores,openInAdmin:M,openSelectedBlocksInAdmin:R,openCurrentPageCreatorInAdmin:N,getCurrentPage:V,getCurrentLayoutStore:()=>{var e,t;const n=Be().g.state.isOpen&&"layout-editor"===Be().g.state.mode&&Be().g.state.collectionStore;if(n){var r,i;const e=null===(r=o(878423).A.state.caches[o(342).oB])||void 0===r?void 0:r.inMemoryRecordCache;return null===(i=n.getLayoutStore())||void 0===i?void 0:i.clone(e)}const a=null===(e=Ue().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.getAssociatedLayoutStore();if(a)return a;const s=n?[n]:(null===(t=Ue().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getOwnedAndLinkedCollectionStores())??[];if(0===s.length)return void console.error("Collection pages use layouts, but can't find a collection page in the main editor.");const l=s.map((e=>e.getLayoutStore())).filter(w().O9);if(0!==l.length)return l.length>1&&console.error("Multiple layout stores found, returning first one"),l[0];console.error("This collection doesn't have a layout in main editor.")},addDuplicateContentTabToCurrentLayout:U,removeAllCollectionPageSections:D,setPageSectionVisibility:L,getCurrentNormalizedPropertyGroups:()=>{if(!Ue().default.state.mainEditorCurrentBlockStore)return void console.error("No current mainEditorCurrentBlockStore");const e=Ue().default.state.mainEditorCurrentBlockStore.getAssociatedCollectionStore()||Ue().default.state.mainEditorCurrentBlockStore.getCollectionStore();if(e)return e.getNormalizedPropertyGroups();console.error("Property groups are stored on collections but can't find collection in main editor.")},openCurrentPageInAdmin:B,openCurrentSpaceInAdmin:E,quickFind:function(e){const t=j(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0),o=Qe().Uc(t);return o&&o.then((e=>"success"===e.type?e.data:e))},quickFindRequest:function(e){return j(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1",arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)},quickFindCollections:F,getCurrentPageDetail:T,getHomeBlockIdsForUser:Q,getRecordStore:k,getRecordDetail:I,getRecordTitle:A,getRecordTree:W,overrideStatsigLocalExperiment:(e,t)=>{K(),Fe().A.updateLocalOverrideConfig(e,t)},overrideStatsigLocalFeatureGate:(e,t)=>{K(),Fe().A.updateLocalOverrideGate(e,"true"===t||!0===t)},removeAllStatsigLocalOverrides:()=>{K(),Fe().A.removeAllLocalOverrides()},getCurrentSpaceId:z,getCurrentUserId:q,getAutomationsForSelectedBlocks:()=>je().default.state.stores.map((e=>st(e,0))).filter(w().O9),getAutomationsForCurrentPage:J,getCurrentThread:Ye,getCurrentThreadSteps:Ze,getCurrentTemporarySteps:Xe,getCurrentSteps:et,getCurrentThreadToolUses:tt,getCurrentThreadOperations:ot,getCurrentThreadRecordMap:nt,debugCompileAutomation:Y,getAutomationAnalysis:Z,generateTutorialData:(e,t,o)=>{const n="production";if("development"!==n&&"local"!==n)return;const r=o??Ue().default.state.mainEditorCurrentBlockStore,i=null==r?void 0:r.getType(),a=null==r?void 0:r.getProperties(),s=null==r?void 0:r.getFormat();if(!(r&&i&&a&&s))return void console.log(`Missing one of these: ${JSON.stringify({rootBlockStore:r,type:i,properties:a,format:s})}`);function l(e,t){const o=t.getContentStores();return C().Bq(o.map(((t,o)=>{const n=t.getType(),r=t.getProperties(),i=t.getFormat();if(!n||!r||!i)return;return[{uri:`${e}/${o}`,type:"block",parentUri:e,parentType:"block",blockValue:{type:n,properties:r,format:i}},...l(`${e}/${o}`,t)]}))).filter(w().O9)}const c=[{uri:e,type:"block",parentUri:t,parentType:"collection",blockValue:{type:i,properties:a,format:s}},...l(e,r)];function d(t){const o=t.replace(e,"").split("/");return C().xQ(e)+o.join("_")}const u={},p=c.map((t=>{const o=t.uri;return JSON.stringify(t,((n,r)=>{if("uri"===n||"parentUri"===n)return["<<<START>>>","`",r.replace(e,"${uri}"),"`","<<<END>>>"].join("");if("title"===n&&Array.isArray(r)&&"image"!==t.blockValue.type){const e=[];for(const[t,n]of r.entries()){if(n.length>1&&"a"===n[1][0][0])return n;const r=d(`${o}/${t}`),i=[["<<<START>>>",`LocalizationHelper.formatMessage(messages.${r})`,"<<<END>>>"].join(""),...n.slice(1)];u[r]={defaultMessage:n[0],id:r,description:"Page template's content"},e.push(i)}return e}return r}))})).map((e=>e.replace(/"<<<START>>>/g,"").replace(/<<<END>>>"/g,"").replace(/<<<QUOTE>>>/g,'"')));return`\n\t\t\tconst messages = defineMessages({\n\t\t\t\t${(0,w().WP)(u).map((e=>{let[t,o]=e;return`"${t}": {\n\t\t\t\t\t\t\t\t\tid: "${o.id}",\n\t\t\t\t\t\t\t\t\tdefaultMessage: \`${o.defaultMessage}\`,\n\t\t\t\t\t\t\t\t\tdescription: "${o.description}",\n\t\t\t\t\t\t\t\t}`})).join(",\n")}\n\t\t\t})\n\t\t\tconst uri = "${e}"\n\t\t\treturn [\n\t\t\t\t${p.join(", ")}\n\t\t\t]`},setHomeTemplatesPersona:e=>{const t=[...Ve().U7.map((e=>({personaValue:{type:"function",persona:e},key:`function - ${e}`}))),...Ve().mh.map((e=>({personaValue:{type:"space_intent",persona:e},key:`space_intent - ${e}`}))),...Ve().Ol.map((e=>({personaValue:{type:"space_type",persona:e},key:`space_type - ${e}`})))],n=t.find((t=>t.key===e));n?o(769705).A.setState(n.personaValue):console.error("input must be one of the following values",t.map((e=>e.key)))},setHomeLearnUserType:e=>{const t={isMultiplayer:e.isMultiplayer??!1,isNewAccount:e.isNewAccount??!1,isWorkspaceOwner:e.isWorkspaceOwner??!1,isOnTrial:e.isOnTrial??!1,persona:e.persona};o(116499).A.setState(t)},advanceAssistantOnboardingNDays:X,printAllFormsDataModel:at,resetJiraOnboardingTourLaunch:lt,resetImproveJiraSyncPopup:ct,resetJiraSetupGuide:dt,getAllUserSignals:_,loadAllUserSignals:g,getLocalSearchableCache:ut,saveFileFromOpfs:async e=>{const t=await navigator.storage.getDirectory(),o=await(await t.getFileHandle(e)).getFile(),n=document.createElement("a");n.href=URL.createObjectURL(o),n.download=e,n.click()},resetBrowserSqlite:pt,resetSqliteForOffline:gt,resetNotionAiSidebarNewBadge:ee,resetAiSearchModalItemDismissed:te,resetWelcomeHomeAnimation:oe,resetHomeSidebarNewBadge:ne,resetFeedViewNewButtonClicked:re,resetDatabaseAISummaryDismiss:ie,getNotificationsforInbox:mt,createRecordMapWithRole:ft,createRecordMap:vt,findId:rt.bind(null,e),editRecordJson:n,updateRecordJson:p,duplicateTranslatedPage:yt,loadAssistantChatTranscriptStorageStep:St,resetGithubPersonalAuthPrompt:ae,resetSlackPersonalAuthPrompt:he,getTranslatedPageXml:ht,resetAssistantSuggestionExposure:bt,resetGoogleDriveOnboarding:me,resetSlackOnboarding:le,resetAssistantOnboarding:se,resetAssistantLeapSettings:fe,resetTwoWayLimitAddRelationConfirmationDialog:pe,resetAiPageTranslationPassiveSuggestions:ge,getCurrentCellId:G,turnOnMockConnectorStatuses:_t,setMockConnectorStatus:kt,runThroughAllMockConnectorStatuses:At,turnOffMockConnectorStatuses:wt,resetJiraConnectionPending:ce,resetJiraUserAuthLogin:de,resetJiraSelectProjects:ue,enableDebuggingForFeatureGate:Ct,disableDebuggingForFeatureGate:xt,enableDebuggingForExperiment:It,disableDebuggingForExperiment:Tt,enableDebuggingForStatsigUserDiff:Pt,disableDebuggingForStatsigUserDiff:Mt}}(e);for(const[n,r]of Object.entries(t))(0,o(604341).exposeDebugValue)(n,r);return t}))},175116:(e,t,o)=>{o.d(t,{ET:()=>l,Ks:()=>c,RI:()=>s,p2:()=>a});o(16280);var n=o(296540);const r="collectionContextStore",i=(0,o(446943).C)({displayName:r,legacyContextKey:r,modernContextDefaultValue:void 0}),a=i.context,s=i.Provider;function l(){const e=n.useContext(a);if(void 0===e)throw new Error(`No context provided: ${r}`);return e}function c(){return n.useContext(a)}},198874:(e,t,o)=>{o.d(t,{l:()=>w});o(16280),o(898992),o(803949);var n=()=>o(584262),r=()=>o(179034),i=()=>o(534177),a=()=>o(896628),s=()=>o(910302),l=()=>o(44729),c=()=>o(857783),d=()=>o(185544),u=()=>o(319975),p=()=>o(751156),g=()=>o(2220),m=()=>o(568131),f=()=>o(450486),v=()=>o(765957),y=()=>o(430483),h=()=>o(77246),S=()=>o(630116),b=()=>o(611371),_=()=>o(825726);function w(e){try{const{pageStore:t,environment:o,duplicateTo:r,triggeredFrom:u}=e,{currentUserStore:S,currentSpaceStore:_,currentSpaceViewStore:w}=v().default.state;if(!y().zD.isFullPageTranslateEnabled())throw new Error("Invalid call to duplicateTranslatedPage: full page translate is not enabled");if(!S||!_||!w)throw new Error("Cannot duplicate translated page: missing required stores");if(!(0,b().EF)(o))throw new Error("Cannot duplicate translated page: user cannot create page");const A=h().Uv.getStateForBlock(t.id);if(!A)throw new Error("Cannot duplicate translated page: no editor mode state");if("translate_locked"!==A.mode||"active"!==A.status)throw new Error("Cannot duplicate translated page: invalid editor mode state");const C=async e=>{const{duplicateStore:r,duplicateBlockResultStatusPromise:i}=e;try{"success"===(await i).status&&(r.isLocked()&&p().createAndCommit({userAction:"fullPageTranslationActions.duplicateTranslatedPage.unlockPage",environment:o,canUndo:!0,perform:e=>{a()._l({environment:o,store:r,isLocked:!1,transaction:e})}}),c().uK({environment:o,store:r,pageVisitSource:n().y8.SavePageTranslationCopy}),s().DL({pageStore:t,environment:o,triggeredFrom:"navigation"}))}catch(l){throw new Error("Error duplicating translated page",{cause:l})}};if((0,g().u)({environment:o,event:{eventName:"duplicate_translated_page",eventProperties:{duplicate_to:r,triggered_from:u,page_id:t.id}}}),"parent"===r){const e=t.getParentStore();if("block"!==(null==e?void 0:e.table)&&"team"!==(null==e?void 0:e.table)&&"space"!==(null==e?void 0:e.table)&&"collection"!==(null==e?void 0:e.table))throw new Error("Cannot duplicate translated page: invalid parent store table");const n=p().createAndCommit({userAction:"fullPageTranslationActions.duplicateTranslatedPageToParent",environment:o,canUndo:!0,perform:n=>{const{blockStores:r,onComplete:a}=m().duplicateBlock({environment:o,stores:[t],transaction:n,targetSpaceId:_.id,preferDuplicateLocation:"local",options:{addCopyName:!1,allowRedundancy:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!t.isInsideTemplate(),returnRecordIdMap:!0}}),s=r[0],c={type:"append",after:t.id};switch(e.table){case"team":(0,f().moveToTeamImpl)({transaction:n,currentSpaceViewStore:w,teamStore:e,targets:[s],environment:o,location:c,action:"move",value:{type:"team",id:e.id,spaceId:_.id}});break;case"block":l().NI({parentStore:e,childStore:s,transaction:n,after:c.after});break;case"space":d().yM({environment:o,spaceStore:_,spaceViewStore:w,pageStore:s,isPrivate:!0,location:c,transaction:n});break;case"collection":l().X$({childStore:s,parentStore:e,transaction:n});break;default:(0,i().HB)(e)}const u=a.then((e=>("success"===e.status&&e.recordIdMap&&k({environment:o,blockToTranslateStore:s,applyTranslationMap:A.translationMap,recordIdMap:e.recordIdMap}),e)));return{duplicateStore:s,duplicateBlockResultStatusPromise:u}}}).performResult;return C(n),n.duplicateStore}if("private_pages"===r){const e=p().createAndCommit({userAction:"fullPageTranslationActions.duplicateTranslatedPageToPrivatePages",environment:o,canUndo:!0,perform:e=>{const{blockStores:n,onComplete:r}=m().duplicateBlock({environment:o,stores:[t],transaction:e,targetSpaceId:_.id,preferDuplicateLocation:"local",options:{addCopyName:!1,allowRedundancy:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!t.isInsideTemplate(),returnRecordIdMap:!0}}),i=n[0];d().yM({environment:o,spaceStore:_,spaceViewStore:w,pageStore:i,isPrivate:!0,location:{type:"prepend"},transaction:e});const a=r.then((e=>("success"===e.status&&e.recordIdMap&&k({environment:o,blockToTranslateStore:i,applyTranslationMap:A.translationMap,recordIdMap:e.recordIdMap}),e)));return{duplicateStore:i,duplicateBlockResultStatusPromise:a}}}).performResult;return C(e),e.duplicateStore}(0,i().HB)(r)}catch(t){(0,_().l)(t)}}function k(e){const{environment:t,blockToTranslateStore:o,applyTranslationMap:n,recordIdMap:a}=e,l=s().Js({translationMap:n,recordIdMap:a});p().createAndCommit({userAction:"serverDuplicate.applyTranslationMap",environment:t,canUndo:!0,perform(e){for(const[n,a]of Object.entries(l)){const s=S().Bv.createChildStore(o,{table:r().ev,id:n,spaceId:o.getSpaceId()});let l;if("title"===a.mapping)l=s.getBlockTitleStore();else if("caption"===a.mapping)l=s.getPropertyStore("caption");else{if("unmapped"===a.mapping)continue;if("properties"===a.mapping){Object.entries(a.properties??{}).forEach((o=>{let[n,r]=o;const i=s.getPropertyStore(n);u().R9({environment:t,store:i,value:r.value,transaction:e})}));continue}(0,i().HB)(a.mapping)}u().R9({environment:t,store:l,value:a.value,transaction:e})}}})}},199058:(e,t,o)=>{o.d(t,{Az:()=>S,Lt:()=>c,Ol:()=>l,U7:()=>a,mh:()=>s});o(944114),o(898992),o(354520);var n=()=>o(534177),r=()=>o(765957);const i=10,a=["creative","internal_communication","eng","product_design","project_or_program_management","product","marketing","sales_or_success","support","finance","hr","it_admin","knowledge_management","operations","educator","student"],s=["life","work","school"],l=["singleplayer","multiplayer"];function c(e){let{userPersonaValue:t,userUseCases:o,spaceSurveyData:r}=e;const i=[m(t),...f({userUseCases:o}),...v({spaceSurveyData:r}),y({workspaceType:p()})].filter(n().O9);let a;for(const n of i)a=a?u(a,n):n;return void 0===a?{type:"space_type",persona:"singleplayer"}:a}const d={space_type:0,space_intent:1,function:2};function u(e,t){return d[e.type]>=d[t.type]?e:t}function p(){const{currentSpaceStore:e}=r().default.state,t=null==e?void 0:e.getModel(),o=null==e?void 0:e.getMemberCountFromPublicSpaceData();return t&&o?o<=1?"singleplayer":o<i?"multiplayer_small":"multiplayer":"singleplayer"}const g={student:{type:"function",persona:"student"},educator:{type:"function",persona:"educator"},creative:{type:"function",persona:"creative"},finance:{type:"function",persona:"finance"},internal_communication:{type:"function",persona:"internal_communication"},project_or_program_management:{type:"function",persona:"project_or_program_management"},it_admin:{type:"function",persona:"it_admin"},knowledge_management:{type:"function",persona:"knowledge_management"},marketing:{type:"function",persona:"marketing"},eng:{type:"function",persona:"eng"},hr:{type:"function",persona:"hr"},product:{type:"function",persona:"product"},product_design:{type:"function",persona:"product_design"},sales:{type:"function",persona:"sales_or_success"},support:{type:"function",persona:"support"},operations:{type:"function",persona:"operations"},founder_or_ceo:void 0,other:void 0,unfilled:void 0};function m(e){return e?g[e]:void 0}function f(e){let{userUseCases:t}=e;const o=[];for(const r of t??[])switch(r){case"personal_notes_to_dos":o.push({type:"space_intent",persona:"life"});continue;case"team_docs_knowledge_base":case"team_project_management":o.push({type:"space_intent",persona:"work"});continue;case"ai":case"docs":case"wikis":case"notes":case"project":case"goals":case"other":continue;default:(0,n().HB)(r)}return o}function v(e){let{spaceSurveyData:t}=e;const o=[],r=function(e){var t;let{spaceSurveyData:o}=e;const r=null==o||null===(t=o.intent)||void 0===t?void 0:t.value;if(r)switch(r){case"personal":case"life":return"life";case"team":case"work":return"work";case"school":return"school";default:(0,n().HB)(r)}}({spaceSurveyData:t});if(r&&o.push({type:"space_intent",persona:r}),null!=t&&t.use_cases)for(const i of t.use_cases.value)switch(i){case"personal_notes_to_dos":o.push({type:"space_intent",persona:"life"});continue;case"team_docs_knowledge_base":case"team_project_management":o.push({type:"space_intent",persona:"work"});continue;case"ai":case"docs":case"wikis":case"notes":case"project":case"goals":case"other":continue;default:(0,n().HB)(i)}return o}function y(e){let{workspaceType:t}=e;if(!t)return;return h({workspaceType:t})?{type:"space_type",persona:"multiplayer"}:{type:"space_type",persona:"singleplayer"}}function h(e){let{workspaceType:t}=e;switch(t){case"multiplayer":case"multiplayer_small":return!0;case"singleplayer":return!1;default:(0,n().HB)(t)}}function S(){return h({workspaceType:p()})}},255824:(e,t,o)=>{o.d(t,{a:()=>i});var n=()=>o(56366);const r=new(o(496506).ComputedStore)((()=>o(263711).g.state.isOpen),{debugName:"IsInPageViewModeStore"});function i(){return(0,n().O$)(r)}},256863:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(56366),r=()=>o(824862),i=o(474848);const a=function(e){const{botValue:t,botStore:a,showActiveDot:s,style:l,size:c}=e,d=(0,o(959013).tz)(),u=(0,n().K8)((()=>{if(a){const e=a.getIcon();if(e)return{pointer:{table:r().GP,id:a.id,spaceId:a.getSpaceId()},icon:e}}else if(null!=t&&t.icon)return{pointer:{table:r().GP,id:t.id,spaceId:t.space_id},icon:t.icon}}),[a,t]),p=(0,n().K8)((()=>(null==a?void 0:a.getDisplayName(d))??(0,o(799288).Hg)(t)),[a,t,d]),{activeDotStyle:g}=(0,o(401497).IS)((e=>({activeDotStyle:{height:10,width:10,backgroundColor:e.palette.green[400],border:"2px solid white",borderRadius:"50%",position:"absolute",left:11,top:11}})),[]);return(0,i.jsxs)("div",{style:l,children:[(0,i.jsx)(o(187820).B6,{icon:u,title:p,size:c||18,disabled:!0,isEmptyPage:!1,useInvertedColors:!0}),s?(0,i.jsx)("div",{style:g}):void 0]})}},271084:(e,t,o)=>{o.d(t,{k:()=>r});o(581454);class n extends(()=>o(757695))().Store{getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}getSortedUserIds(){return Object.entries(this.state||{}).sort(((e,t)=>{let[o,n]=e,[r,i]=t;return i-n})).map((e=>{let[t,o]=e;return t}))}}const r=new n;(0,o(604341).exposeDebugValue)("UserSimilarityStore",r)},279900:(e,t,o)=>{function n(e){let t,o,n;return async function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t?(n=i,o||(o=t.then((()=>(o=void 0,t=e(...n),t))),o)):(t=e(...i),t)}}o.d(t,{A:()=>n})},310109:(e,t,o)=>{o.r(t),o.d(t,{getAllContextValues:()=>y,getContextValueForActionById:()=>S,getContextValuesForAction:()=>h,typecheckAutomation:()=>f,typecheckAutomationAsync:()=>v});o(944114),o(898992),o(581454),o(737550);var n=()=>o(496603),r=()=>o(973647),i=()=>o(534177),a=()=>o(999515),s=()=>o(977345),l=()=>o(81768),c=()=>o(638458),d=()=>o(322867),u=()=>o(281994),p=()=>o(648651),g=()=>o(103966);function*m(e){const{actionModels:t,automationModel:o,contextType:m,formulasModule:f,runtimeStats:v}=e,y={valueTypes:e.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}},h=performance.now();let S,b,_;if("button_block"===m||"button_property"===m){if(!o.isButtonType())return{error:new(d().N9)(`Automation trigger (${o.getTriggerType()}) does not match context type (${m}).`)};const t=o.getTrigger();_=(0,g().Z)(o.getTriggerType()).typecheck(e,t)}else if("event"===m){if(!o.isEventType())return{error:new(d().N9)(`Automation trigger (${o.getTriggerType()}) does not match context type (${m}).`)};const t=o.getTrigger();_=(0,g().Z)(o.getTriggerType()).typecheck(e,t)}else if("recurrence"===m){if(!o.isRecurrenceType())return{error:new(d().N9)(`Automation trigger (${o.getTriggerType()}) does not match context type (${m}).`)};const t=o.getTrigger();_=(0,g().Z)(o.getTriggerType()).typecheck(e,t)}else(0,i().HB)(e);if(r().Q.isFail(_))return _;y.valueTypes.push(...n().o8(_.value.valueTypes));for(const i of t){S=void 0,v&&(S=p().hs.getOrCreateAction(v,i.pointer,i.getType()));const t=(0,l().getActionRegistryItem)(i.getType());if(!t){b={error:new(d().oM)({actionId:i.id,message:`Unsupported action type: ${i.getType()}`})};break}const g=performance.now(),m=(0,c().Q)({automationModel:o,formulasModule:f,formulaValueTypes:y.valueTypes}),h=(0,u().HI)(yield*t.resolveExecutionDependencies(m,i));yield*a().q.fetchRecords(h.map((e=>e.pointer))),S&&(S.totalDependencies=h.length,S.getDependenciesDurationMs=Math.trunc(performance.now()-g));const _=t.typecheck(e,i),w=n().o8(y.valueTypes);if(y.actionInputValueTypes[i.id]=w,r().Q.isFail(_)){b=_;break}for(const e of _.value.valueTypes??[]){y.valueTypes.some((t=>(0,s().oH)(e,t)))||y.valueTypes.push(e)}_.value.validationFailures&&_.value.validationFailures.length>0&&(y.actionValidationFailures[i.id]=_.value.validationFailures)}const w=Math.trunc(performance.now()-h);return v&&(v.typecheckStartTime=h,v.typecheckDurationMs=w,v.typecheckSuccess=!(0,i().O9)(b)),b??{value:y}}function f(e){return a().q.runSync(e.getRecordModel,m(e))}async function v(e){return await a().q.runAsync(e.loadRecordModel,m(e))}function y(e){return r().Q.isFail(e)?[]:e.value.valueTypes.slice(0)}function h(e,t){return r().Q.isFail(e)?[]:e.value.actionInputValueTypes[t]??[]}function S(e,t,o){const n=h(e,t);return(0,s().IV)(n,o)}},320865:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var n=o(474848);const r=function(){return(0,n.jsx)(o(678553).Ay,{title:(0,n.jsx)(o(331542).A,{})})}},380048:(e,t,o)=>{o.d(t,{I:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("chevronLeft",{viewBox:"0 0 16 16",directional:!0,svg:(0,n.jsx)("path",{d:"M3.61816 8.06445C3.61816 8.29688 3.70703 8.49512 3.8916 8.67285L9.22363 13.8887C9.36719 14.0391 9.55859 14.1143 9.77734 14.1143C10.2217 14.1143 10.5703 13.7725 10.5703 13.3213C10.5703 13.1025 10.4814 12.9043 10.3311 12.7539L5.52539 8.06445L10.3311 3.375C10.4814 3.21777 10.5703 3.01953 10.5703 2.80078C10.5703 2.35645 10.2217 2.01465 9.77734 2.01465C9.55859 2.01465 9.36719 2.08984 9.22363 2.24023L3.8916 7.45605C3.70703 7.63379 3.625 7.83203 3.61816 8.06445Z"})})},398217:(e,t,o)=>{o.d(t,{Jv:()=>v,Rl:()=>y,mA:()=>f});var n=o(296540),r=()=>o(484714),i=()=>o(56366),a=()=>o(401497),s=()=>o(970013),l=()=>o(743176),c=()=>o(780054),d=()=>o(68465),u=()=>o(159588),p=()=>o(963589),g=o(474848);const m=function(){return(0,g.jsx)(o(464708).A,{color:"purple",style:{marginLeft:6,padding:"1px 4px",display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,marginTop:1},content:(0,g.jsx)(o(959013).sA,{defaultMessage:"AI",id:"database.property.aiAutofillEnabledIndicator"})})};const f=n.memo((function(e){const{propertySchema:t,showIcon:n,showDragIcon:r,hideName:i,badge:s,style:l,iconStyle:d,iconSize:p,dragHandleStyle:m,className:f,labelSizeVariant:v}=e,h=c().A.isMobile?16:14,S=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",lineHeight:"120%",minWidth:0,fontSize:h,...l},iconWrapper:{display:"grid",justifyContent:"center",alignItems:"center",marginRight:i?void 0:"small"===v||r?4:c().A.isMobile?9:6,...d},dragHandle:{gridColumn:1,gridRow:1,opacity:r?1:0,transition:`opacity ${u().bM}`},itemIcon:{gridColumn:1,gridRow:1,opacity:r?0:1,transition:`opacity ${u().bM}`},dragIcon:{fill:e.icon.secondary}})),[h,i,d,v,r,l]);return(0,g.jsxs)("div",{className:f,style:S.container,children:[n&&(0,g.jsxs)("div",{style:S.iconWrapper,children:[(0,g.jsx)("div",{style:S.itemIcon,children:(0,g.jsx)(y,{propertySchema:t,iconSize:p,iconStyle:d})}),(0,g.jsx)("div",{style:S.dragHandle,children:(0,g.jsx)(o(57232).A,{style:m,iconSize:12,iconStyle:S.dragIcon})})]}),!i&&(0,g.jsx)("div",{style:{...o(284371).RC},children:t.name}),s]})}));function v(e){const{propertySchema:t}=e,o=(0,r().v3)();return(0,i().K8)((()=>(0,d().O0)(o)&&s().$M(t)&&s().om(t)),[o,t])?(0,g.jsx)(m,{}):null}function y(e){const{propertySchema:t,iconSize:o,iconStyle:n}=e,r=(0,a().DP)(),i=(0,p().X)("nds_default_property_noticon"),s=c().A.isMobile?18:16;return(0,g.jsx)(l().zB,{type:t.type,icon:t.icon,size:o||s,theme:r,style:n,isDefaultNoticonEnabled:i})}},413267:(e,t,o)=>{o.d(t,{b:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("thinCheck",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},435930:(e,t,o)=>{o.d(t,{s:()=>a});const n={id:"pageLayoutEditor.property",defaultMessage:"Property",description:"Label for the property section in the page layout editor"},r={id:"pageLayoutEditor.titleWithIcon",defaultMessage:"Heading",description:"Label for the titleWithIcon section in the page layout editor"},i={id:"pageLayoutEditor.collectionView",defaultMessage:"Database View",description:"Label for the form submit button section in the form page layout editor"},a=(0,o(959013).YK)({cover:{id:"pageLayoutEditor.cover",defaultMessage:"Cover"},properties:{id:"pageLayoutEditor.properties",defaultMessage:"Property group"},inlinePageSections:{id:"pageLayoutEditor.inlinePageSections",defaultMessage:"Inline Page Sections"},expandedBacklinks:{id:"pageLayoutEditor.expandedBacklinks",defaultMessage:"Backlinks"},discussions:{id:"pageLayoutEditor.discussions",defaultMessage:"Page Comments"},editor:{id:"pageLayoutEditor.editor",defaultMessage:"Content"},tabs:{id:"pageLayoutEditor.tabs",defaultMessage:"Tabs"},transcript:{id:"pageLayoutEditor.transcript",defaultMessage:"Transcript"},bottomControls:{id:"pageLayoutEditor.bottomControls",defaultMessage:"Bottom Controls"},selectAModulePrompt:{id:"pageLayoutEditor.selectAModuleTitle",defaultMessage:"Select a module to configure"},deleteModuleButton:{id:"pageLayoutEditor.deleteModuleButton",defaultMessage:"Delete"},views:{id:"pageLayoutEditor.views",defaultMessage:"Views"},viewsMain:{id:"pageLayoutEditor.views",defaultMessage:"Views"},relationsGroup:{id:"pageLayoutEditor.relationsGroup",defaultMessage:"Relations group"},formTitle:{id:"pageLayoutEditor.formTitle",defaultMessage:"Form Title"},formQuestion:{id:"pageLayoutEditor.formQuestion",defaultMessage:"Form Question"},formSubmit:{id:"pageLayoutEditor.formSubmit",defaultMessage:"Form Submit"},placeholder:{id:"pageLayoutEditor.placeholder",defaultMessage:"New"},recentActivity:{id:"pageLayoutEditor.recentActivity",defaultMessage:"Recent activity"},collaborators:{id:"pageLayoutEditor.collaborators",defaultMessage:"Top collaborators"},teamspaces:{id:"pageLayoutEditor.teamspaces",defaultMessage:"Teamspaces"},normalizedTitleWithIcon:r,titleWithIcon:r,deleted_property:n,property_number:n,property_title:n,property_person:n,property_file:n,property_text:n,property_checkbox:n,property_url:n,property_email:n,property_phone_number:n,property_created_by:n,property_last_edited_by:n,property_button:n,property_select:n,property_multi_select:n,property_status:n,property_date:n,property_created_time:n,property_last_edited_time:n,property_last_visited_time:n,property_relation:n,property_rollup:n,property_formula:n,property_auto_increment_id:n,property_location:n,property_verification:n,property_place:n,property:n,collectionView:i,collectionViewV2:i})},450486:(e,t,o)=>{o.r(t),o.d(t,{moveToTeamImpl:()=>l});var n=()=>o(496603),r=()=>o(534177),i=()=>o(44729),a=()=>o(955930),s=()=>o(375078);function l(e){let{transaction:t,currentSpaceViewStore:o,teamStore:l,targets:c,location:d,environment:u}=e;const p=o.getTeamsStores(),g=l.getTeamPagesStore();s().maybeTurnCollectionViewIntoCollectionViewPage({environment:u,blocks:c,transaction:t});for(const s of c){const e=n().I6(p,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(s.id)}));(null==e?void 0:e.id)!==l.id&&("append"===d.type?i().NI({parentStore:g,childStore:s,after:d.after,transaction:t}):"prepend"===d.type?i().Ti({parentStore:g,childStore:s,before:d.before,transaction:t}):(0,r().HB)(d),e&&a().Ex({teamStore:e,store:s,transaction:t}))}return l}},454531:(e,t,o)=>{o.d(t,{W:()=>f});var n=()=>o(780054),r=()=>o(972435),i=()=>o(867772),a=()=>o(681810),s=()=>o(901389),l=()=>o(896628),c=()=>o(383594),d=()=>o(675925),u=()=>o(751156),p=()=>o(892632);const g=1500,m=(0,o(959013).YK)({pageCover:{defaultMessage:"Page cover",id:"pageCover.title"},fileTypeCaption:{defaultMessage:"Images wider than {idealImageWidth} pixels work best.",id:"pageCover.fileType.caption"},uploadFailed:{defaultMessage:"Upload failed",id:"pageCover.errorDialogMessage.uploadFailed"},preparing:{defaultMessage:"Preparing...",id:"pageCover.status.preparing"},downloading:{defaultMessage:"Downloading...",id:"pageCover.status.downloading"},embedTitle:{defaultMessage:"Link",id:"pageCover.embedType.title"},embedPlaceholder:{defaultMessage:"Paste an image link…",id:"pageCover.embedType.placeholder"},embedCaption:{defaultMessage:"Works with any image from the web.",id:"pageCover.embedType.caption"},embedSubmit:{defaultMessage:"Submit",id:"pageCover.embedType.buttonText"}});function f(e){let{environment:t,intl:o,store:n,rect:r,from:i}=e;c().W(t,{originGap:3,originRect:r,isSmallWidth:!1,popupWidth:540,maxHeight:485,title:o.formatMessage(m.pageCover),onDelete:()=>{!function(e){let{environment:t,store:o}=e;c().I(),u().createAndCommit({userAction:"PageCover.handleDelete",environment:t,canUndo:!0,perform:e=>{l().PT({store:o,transaction:e})}})}({environment:t,store:n})},currentTab:"gallery",tabs:[{type:"gallery",onChange:e=>{let{url:o,position:r}=e;(0,d().o)(t,{action:"edit_cover",block_type:"page",from:i},(e=>{y({environment:t,store:n,url:{originUrl:o},position:r}),e()}))}},{type:"file",fileUpload:!1,imageUpload:!0,videoUpload:!1,caption:o.formatMessage(m.fileTypeCaption,{idealImageWidth:g}),onUpload:e=>{(0,d().o)(t,{action:"edit_cover",block_type:"page",from:i},(r=>{var i;c().I(),p().QM({environment:t,file:e[0],bucket:"secure",record:(null===(i=n.getCoverStore())||void 0===i?void 0:i.pointer)??n.pointer,isFileBlock:!1,reportRichUploadMetrics:!0,onStart:h,onProgress:S,onComplete:e=>{var o;o={environment:t,store:n,url:{originUrl:e}},v({...o,position:.5})},onError:()=>{s().f1(o.formatMessage(m.uploadFailed))}}),r()}))}},{type:"embed",title:o.formatMessage(m.embedTitle),inputPlaceholder:o.formatMessage(m.embedPlaceholder),caption:o.formatMessage(m.embedCaption),buttonText:o.formatMessage(m.embedSubmit),onChange:e=>{(0,d().o)(t,{action:"edit_cover",block_type:"page",from:i},(o=>{var r;r={environment:t,store:n,url:e},v({...r,position:.5}),c().I(),o()}))}},{type:"unsplash",onChange:e=>{let{url:o,position:r}=e;(0,d().o)(t,{action:"edit_cover",block_type:"page",from:i},(e=>{y({environment:t,store:n,url:{originUrl:o},position:r}),e()}))}}]})}async function v(e){const{environment:t,store:o,url:n,position:s}=e,{serverCommitResult:c}=u().createAndCommit({userAction:"PageCover.updatePageCover",environment:t,canUndo:!0,perform:e=>{l().fg({store:o,url:n,position:s||.5,transaction:e})}});await c,a().A.state.loadingMode===i().vS&&a().A.setState({loadingMode:i().Gi,dataURL:a().A.state.dataURL,uploadProgress:t.device.isMobileNative?void 0:100,progressText:r().A.formatMessage(m.downloading)})}function y(e){v(e),n().A.isMobile&&c().I()}function h(e){const{file:t,name:o,size:n}=e;if(c().I(),a().A.setState({loadingMode:i().Wc,file:t,name:o,size:n}),t.type.indexOf("image")>=0)if(t instanceof File){const e=new FileReader;e.onload=e=>{a().A.state.loadingMode===i().Wc&&a().A.setState({...a().A.state,loadingMode:i().vS,uploadProgress:0,dataURL:e.target.result})},e.readAsDataURL(t)}else a().A.state.loadingMode===i().Wc&&a().A.setState({...a().A.state,loadingMode:i().vS,dataURL:t.dataURL,progressText:r().A.formatMessage(m.preparing)});else a().A.state.loadingMode===i().Wc&&a().A.setState({...a().A.state,loadingMode:i().vS,progressText:r().A.formatMessage(m.preparing)})}function S(e){const{progressPercent:t,progressText:o}=e;a().A.state.loadingMode===i().vS&&a().A.setState({...a().A.state,uploadProgress:t,progressText:o})}},458366:(e,t,o)=>{o.d(t,{B2:()=>P,F1:()=>A,Kc:()=>w,NN:()=>T,UY:()=>_,br:()=>I,lA:()=>C,lh:()=>k,pi:()=>h,w_:()=>b,zP:()=>S});o(898992),o(737550);var n=()=>o(584262),r=()=>o(443239),i=()=>o(970013),a=()=>o(713998),s=()=>o(882262),l=()=>o(415566),c=()=>o(177256),d=()=>o(72135),u=()=>o(919709),p=()=>o(496603),g=()=>o(534177),m=()=>o(939768),f=()=>o(720665),v=()=>o(492414),y=()=>o(972435);function h(e){return Boolean(e.state.isOpen&&e.state.collectionsBulkActionsToolbarStore)}function S(e){switch(e){case"table":return"table";case"board":return"board";case"list":return"list";case"gallery":return"gallery";case"feed":return"feed";case"relation":case"relation_section":return"relation_section";case"timeline":return"timeline";case"calendar":return"calendar";case"page":return"page_properties";case"compact_page":return"compact_page";case"mini":return"mini_peek";case"form_editor":case"form_viewer":case"property_module":return"property_module";default:(0,g().HB)(e)}}function b(e){return{backgroundImage:`linear-gradient(\n\t\tto right,\n\t\t${e.darkDividerColor} 0%,\n\t\t${e.darkDividerColor} 100%\n\t)`,backgroundRepeat:"repeat-x",backgroundPosition:"0 100%",backgroundSize:"100% 1px"}}function _(e){const{store:t,property:o,propertySchema:r}=e,i=null==r?void 0:r.type;if("title"===i)return(0,v().Ay)({store:t,fullyQualified:!1,pageVisitSource:n().y8.LinkInPage});{const e=t.getPropertyValue(o);return a().UY(i,e)}}function w(e){let t=(0,u().k4p)(e);if(!t||""===t.trim()||t.trim().includes(" "))return{domain:void 0,restOfUrl:void 0};t=t.trim();let o=m().qg(t),n=o.host;if(o.protocol&&n||(o=m().qg(`http://${t}`),n=o.host),!n)return{domain:void 0,restOfUrl:void 0};n&&(n=n.replace(/^www./i,""));const r=t.toLowerCase().indexOf(n.toLowerCase());if(-1===r)return{domain:void 0,restOfUrl:void 0};n=t.slice(r,r+n.length);return{domain:n,restOfUrl:t.slice(r+n.length)}}function k(e){const{numberValue:t,numberFormat:o,numberShowAs:n}=e;if(!(p().yr(t)||f().pN(t)||"bar"!==(null==n?void 0:n.type)&&"ring"!==(null==n?void 0:n.type))){const e=y().A.getIntl();return"percent"===o?d().ZV(t,"percent",e):`${t} / ${n.maxValue}`}}function A(e){const{property:t,collectionStore:o}=e,n=o.isSyncedCollection();return Boolean(n)&&(0,r().u)(t)}function C(e,t){switch(e){case"side_peek":return{icon:c().A,tooltip:y().A.formatMessage(x.openInSidePeekTooltip),caption:t?"":y().A.formatMessage(x.openAsPageTitle)};case"center_peek":return{icon:l().q,tooltip:y().A.formatMessage(x.openInCenterPeekTooltip),caption:t?"":y().A.formatMessage(x.openAsPageTitle)};case"full_page":return{icon:s().m,tooltip:y().A.formatMessage(x.openAsPageTooltip),caption:t?"":y().A.formatMessage(x.openAsPageTitle)};default:(0,g().HB)(e)}}const x=(0,o(959013).YK)({openAsPageTitle:{defaultMessage:"Open",id:"database.actionButton.openAsPageTitle"},openAsPageTooltip:{defaultMessage:"Open as page",id:"database.actionButton.openAsPageTooltip"},openInCenterPeekTooltip:{defaultMessage:"Open in center peek",id:"database.actionButton.openInCenterPeekTooltip"},openInSidePeekTooltip:{defaultMessage:"Open in side peek",id:"database.actionButton.openInSidePeekTooltip"}});function I(e){const{store:t,additionalStores:o,collectionContextStore:n}=e,r=t.getAssociatedCollectionStore();return!("collectionTypedView"!==(null==n?void 0:n.contextType)||!r)&&o.some((e=>{var t;return(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.id)!==r.id}))}function T(e){return"form_editor"===e||"form_viewer"===e}function P(e){return Boolean(e&&!i().dA.includes(e.type))}},465364:(e,t,o)=>{o.d(t,{$N:()=>M,D5:()=>R,GB:()=>I,M9:()=>C,Pt:()=>P,eW:()=>T,jo:()=>B,v7:()=>x});o(944114),o(898992),o(803949),o(581454);var n=()=>o(244641),r=()=>o(787626),i=()=>o(713998),a=()=>o(597777),s=()=>o(604995),l=()=>o(416504),c=()=>o(519831),d=()=>o(496603),u=()=>o(534177),p=()=>o(299709),g=()=>o(317001),m=()=>o(520861),f=()=>o(878060),v=()=>o(44729),y=()=>o(246826),h=()=>o(319975),S=()=>o(519839),b=()=>o(695625),_=()=>o(397248),w=()=>o(217429),k=()=>o(630116),A=()=>o(747671);function C(e){const{environment:t,droppedStores:o,duplicate:i,calendarBy:d,transaction:u,collectionContextStore:f,duplicateActions:y}=e,h=n().c9.fromMillis(e.startOfDay);let b=!0;for(const n of o){const t=e.collectionStore?e.collectionStore:(0,S().Dj)({store:n,collectionContextStore:f});if(n.getParentTable()===c().Vl||!t){b=!1;break}v().X$({childStore:n,parentStore:t,transaction:u})||(b=!1)}const _=(0,m().T)({environment:t,droppedStores:o,duplicate:i,transaction:u,collectionStore:e.collectionStore,duplicateActions:y});for(const n of _){const o=e.collectionStore?e.collectionStore:(0,S().Dj)({store:n,collectionContextStore:f});if(!o)continue;const i=o.getMappedProperty(d),c=n.getPropertyStore(i),m=(0,r().b)(c.getValue())||s().Ec((0,l().P)()),v=s().kW(m,(0,l().P)()),y=h.toFormat(s().tr);let _;if("date"===v.type||"datetime"===v.type)_={...v,start_date:y};else{const e=s().AA(v,(0,l().P)());if(!e.end)return;const t={...v,start_date:y},o=s().AA(t,(0,l().P)()).start.diff(e.start,"days"),n=e.end.plus(o).toFormat(s().tr);_={...v,start_date:y,end_date:n}}const w=s().kW(_,a().$K(m)||(0,l().P)());(0,g().j)({environment:t,store:n,collectionStore:o,collectionContextStore:f,shouldCoerce:!0,groupsPointer:[],transaction:u,alreadyMovedToCollection:b}),R({environment:t,type:"dateValue",propertyId:i,store:n,transaction:u,dateValue:w}),(0,p().E)({environment:t,collectionContextStore:f,block_id:n.id,property:i,property_type:"date",from:"calendar"})}}function x(e){const{calendarStore:t,direction:o,targetStore:n}=e;t.setState({...t.state,isDragging:!0,targetStore:n,direction:o,temporaryValue:void 0})}function I(e){const{calendarStore:t,x:o,y:i,calendarBy:c}=e,u=t.state;if(u.isDragging){const e=(0,r().b)(u.targetStore.getPropertyStore(c).getValue());if(!e)return;const p=s().kW(e,(0,l().P)()),g=u.temporaryValue||e,m=s().kW(g,(0,l().P)()),f=[];u.dayStoreMap.forEach(((e,t)=>{f.push({store:e,timestamp:t})}));const v=f.find((e=>{let{store:t}=e;const n=b().T.getRectFromStore(t);return Boolean(n&&_().ux(n,o,i))}));let y;if(v){const e=n().c9.fromMillis(v.timestamp),t=e.endOf("day"),o=e.toFormat(s().tr);if(p){const r=s().AA(p,(0,l().P)());if(u.direction===A().Q.Left)if(n().IX.fromDateTimes(e,t).contains(r.start))y=p;else{let e;e="datetimerange"===p.type||"daterange"===p.type?{...p,start_date:o,end_date:p.end_date}:"datetime"===p.type?{type:"datetimerange",start_date:o,start_time:p.start_time,end_date:p.start_date,end_time:p.start_time,time_zone:p.time_zone,reminder:p.reminder}:{type:"daterange",start_date:o,end_date:p.start_date,reminder:p.reminder};const t=s().AA(e,(0,l().P)());y=!r.end&&t.start>r.start||r.end&&t.start>r.end?m:e}else if(r.end?n().IX.fromDateTimes(e,t).contains(r.end):n().IX.fromDateTimes(e,t).contains(r.start))y=p;else{let e;e="date"===p.type?{...p,type:"daterange",end_date:o}:"datetime"===p.type?{...p,type:"datetimerange",end_date:o,end_time:"00:00"}:{...p,end_date:o};const t=s().AA(e,(0,l().P)());y=t.end&&t.end<t.start?m:e}}}if(y&&!d().n4(m,y)){const e=s().kW(y,a().$K(g)||(0,l().P)());t.setState({...u,temporaryValue:e})}}}function T(e){const{environment:t,calendarStore:o,calendarBy:n,transaction:r}=e,i=o.state;i.isDragging&&i.temporaryValue&&(R({type:"dateValue",environment:t,dateValue:i.temporaryValue,propertyId:n,store:i.targetStore,transaction:r}),o.setState({...o.state,isDragging:!1}))}function P(e){const{calendarStore:t}=e,o=t.state;o.isDragging&&t.setState({...o,isDragging:!1})}function M(e){const{environment:t,store:o,collectionStore:r,collectionContextStore:a,startDayOfWeek:c,transaction:d}=e,u=a.dateRangeStartStore.state,p=(0,l().P)(),m=a.normalizedQueryStore.state;if(!m||!m.calendar_by)return;const f=(null==r?void 0:r.getMappedProperty(m.calendar_by))??m.calendar_by,v=s().hp(u,c,p),h=v.startOf("month"),S=v.endOf("month"),b=n().c9.now().startOf("day");let _;return _=n().IX.fromDateTimes(h,S).contains(b)?s().p6(b.valueOf(),p):s().p6(s().iB(u,c,p).valueOf(),p),y().zv({store:o.getPropertiesStore(),data:{[f]:i().m5(_)},transaction:d}),(0,g().j)({environment:t,store:o,collectionStore:r,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:d}),o}function R(e){const{environment:t,store:o,propertyId:n,transaction:r}=e;let a;"timestamp"===e.type?a=s().p6(e.timestampMs.valueOf(),(0,l().P)()):"dateValue"===e.type?a=e.dateValue:(0,u().HB)(e);const c=o.getPropertyValue(n);if(a&&function(e){const{propertyId:t,oldDateValue:o,newPersistedDate:n,store:r}=e;if(o||!n||void 0!==n.reminder)return!1;if(!w().default.checkGate({gateName:"adoption_reminder_collection_default"}))return!1;const i=E(t,r);if(void 0===i)return!1;return!0}({propertyId:n,oldDateValue:c,newPersistedDate:a,store:o})){const e=E(n,o);void 0!==e&&(a={...a,reminder:e})}const d=i().m5(a);y().zv({store:o.getPropertiesStore(),data:{[n]:d},transaction:r}),f().O({environment:t,store:o,dateProperty:{id:n,oldValue:c,newValue:d}})}function E(e,t){const o=t.getAssociatedCollectionStore();if(!o)return;const n=o.getSchema();if(!n)return;const r=n[e];return r&&"date"===r.type?r.default_reminder:void 0}function B(e){const{environment:t,collectionStore:o,calendarBy:n,store:r,insertStores:i,collectionContextStore:a,transaction:s}=e,l=r.getPropertyStore(n).getValue();for(const c of i)(0,g().j)({environment:t,store:c,collectionStore:o,collectionContextStore:a,shouldCoerce:!0,groupsPointer:[],transaction:s}),h().R9({environment:t,store:c.getPropertyStore(n),value:l,transaction:s});return i.map((e=>k().Bv.createChildStore(o,e.pointer)))}},477293:(e,t,o)=>{o.d(t,{r:()=>i});var n=()=>o(56366),r=()=>o(217429);function i(e){let{disableExposureLogging:t,disableEventTrailLogging:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n().K8)((()=>r().default.getEligibleGroup({experimentId:e,defaultGroup:"control",disableExposureLogging:t,disableEventTrailLogging:o})),[e,t,o])}},520861:(e,t,o)=>{o.d(t,{T:()=>r});o(944114),o(898992),o(908872);var n=()=>o(415651);function r(e){const{environment:t,collectionStore:o,duplicate:r,droppedStores:i,transaction:a,duplicateActions:s}=e,{movedStores:l,reparentedStores:c}=i.reduce(((e,t)=>(r||t.getAssociatedCollectionId()!==(null==o?void 0:o.id)?e.reparentedStores.push(t):e.movedStores.push(t),e)),{movedStores:[],reparentedStores:[]});return[...l,...n().MS({environment:t,droppedStores:c,duplicate:r,transaction:a,resolveTemplateVariables:!1,duplicateActions:s})]}},525432:(e,t,o)=>{o.d(t,{Bd:()=>s,DN:()=>m,II:()=>S,R8:()=>h,U9:()=>y,VM:()=>v,ZF:()=>p,ZI:()=>d,bf:()=>c,jx:()=>u,wW:()=>f,xO:()=>l});o(16280),o(296540);var n=()=>o(651124),r=()=>o(959013),i=()=>o(712505),a=o(474848);let s=function(e){return e[e.ViewSettings=0]="ViewSettings",e[e.FilterBar=1]="FilterBar",e[e.TopbarFilterPopup=2]="TopbarFilterPopup",e[e.TopbarSortPopup=3]="TopbarSortPopup",e[e.TopbarFollowPopup=4]="TopbarFollowPopup",e[e.MobileSheet=5]="MobileSheet",e}({});const l=480,c=320;function d(e){const{timelineViewTab:t,collectionContextStore:o}=e,r=u({collectionContextStore:o}),i=p({collectionContextStore:o});return"timeline"===r?"timeline"===t?"timeline_properties":i?"timeline_table_properties":void 0:(0,n().u9)(u({collectionContextStore:o}))}function u(e){var t;const{collectionContextStore:o}=e,n=null===(t=o.collectionViewStore())||void 0===t?void 0:t.getType();if(!n)throw new Error("View type was not defined.");return n}function p(e){const{collectionContextStore:t}=e,o=t.normalizedFormatStore.state;return Boolean(o.timeline_show_table)}const g=600;function m(e,t,o){const n=o||0,r=e.settingsStore.state;if(r.open&&!0!==r.hideSettingsPopup)return f(e,t,n)}function f(e,t,o){const n=o||0,r=e.settingsStore.state,a=u({collectionContextStore:e});return r.open&&"form_editor"===a||t||i().default.isSidePeekOpen()||e.isInHomeWidgetStore.state||e.isInlineViewStore.state||n<=g?"popup":"sidebar"}function v(e){let{hasOnlyLinkedDataSources:t,isCollectionViewPageWithContent:o,locked:n}=e;return o?n?(0,a.jsx)(r().sA,{defaultMessage:"Unlock wiki",id:"action.unlockWikiName.name"}):(0,a.jsx)(r().sA,{defaultMessage:"Lock wiki",id:"action.lockWikiName.name"}):t?n?(0,a.jsx)(r().sA,{defaultMessage:"Unlock views",id:"database.viewSettings.mainTab.unlockViews.title"}):(0,a.jsx)(r().sA,{defaultMessage:"Lock views",id:"database.viewSettings.mainTab.lockViews.title"}):n?(0,a.jsx)(r().sA,{defaultMessage:"Unlock database",id:"database.viewSettings.mainTab.unlockDatabase.title"}):(0,a.jsx)(r().sA,{defaultMessage:"Lock database",id:"database.viewSettings.mainTab.lockDatabase.title"})}let y=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e}({});const h=6;function S(e){let{currentViewType:t,isPlaceholderExternalCollection:o,collectionContextStore:n,allowedActions:r,settingsHeaderSizeObserver:i}=e;return"page"!==t&&"form_editor"!==t&&(!o&&(!!n.shouldAllowNewItemCreation()&&(!(r&&!r.includes("addItem"))&&!(i&&i.rect.state.width>c))))}},544862:(e,t,o)=>{o.d(t,{A:()=>k});var n=o(296540),r=()=>o(484714),i=()=>o(56366),a=()=>o(959013),s=()=>o(896628),l=()=>o(454531),c=()=>o(751156),d=()=>o(478726),u=()=>o(227440),p=()=>o(867772),g=()=>o(681810),m=()=>o(608581),f=()=>o(145214),v=()=>o(704152),y=()=>o(807683),h=()=>o(401497),S=()=>o(534177),b=o(474848);function _(e){let{src:t,placeholderSrc:o,placeholderBehavior:r,imageStyle:i,containerStyle:a,onLoadComplete:s,testId:l}=e;const[c,d]=(0,n.useState)(!0);let u;switch(r){case"force-show-placeholder":u=!0;break;case"force-show-src":u=!1;break;case"show-placeholder-if-loading-src":u=!!o&&(c||void 0===t);break;default:(0,S().HB)(r)}const p=(0,h().IS)((()=>{const e={gridColumn:1,gridRow:1};return{container:{display:"grid",...a},srcWrapper:{...u&&{display:"none"},...e},placeholderWrapper:{pointerEvents:"none",...e}}}),[a,u]);(0,n.useEffect)((()=>{void 0!==t&&d(!0)}),[t]);const g=(0,n.useCallback)((e=>{d(!1),null==s||s()}),[s]);return(0,b.jsxs)("div",{style:p.container,children:[(0,b.jsx)(y().Ay,{src:t,onLoad:g,style:i,placeholderStyle:p.srcWrapper,placeholderLoadedStyle:p.srcWrapper,testId:l}),o&&(0,b.jsx)(y().Ay,{src:o,style:i,placeholderStyle:p.placeholderWrapper,placeholderLoadedStyle:p.placeholderWrapper})]})}var w=()=>o(453101);const k=function(e){let{store:t,disabled:a,paddingRight:l,paddingLeft:d,height:u,proxyWidth:m}=e;const f=(0,r().v3)(),v=(0,r().Y0)(),h=(0,i().uB)(void 0,o(454305).A),S=(0,i().K8)((()=>a||"suggest"===o(77246).Uv.getMode(t)||(0,o(600871).aD)(v)),[a,t,v]),w=(0,i().K8)((()=>t.getCover()),[t]),k=(0,i().O$)(g().A),[x,I]=(0,n.useState)(void 0);if(!w)return null;const T=k.loadingMode!==p().pF&&k.loadingMode!==p().Wc;return(0,b.jsx)(o(801678).A,{mouseStore:h,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:n,reset:r}=e;c().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,canUndo:!0,perform:e=>{s().yY({store:t,coverPosition:n,transaction:e}),r()}})}(e,t,f),renderControl:e=>{let{handleRepositionClick:o,handleSavePositionClick:n,handleCancelClick:r,isVisible:i,isRepositioning:a}=e;return(0,b.jsx)(C,{handleRepositionClick:o,handleSavePositionClick:n,handleCancelClick:r,isVisible:i,isRepositioning:a,lastProxiedUrl:x,store:t,disabled:S,paddingRight:l,paddingLeft:d,mouseStore:h})},source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:u,maxHeight:280,cursor:"default"},preventClickPropagation:!0,render:e=>(0,b.jsxs)(n.Fragment,{children:[(0,b.jsx)(o(360083).A,{url:w.cover,isAuthenticated:!0,permissionRecord:w.pointer,width:m,onFinishedLoadingProxyUrl:I,render:(t,o)=>{const n={width:"100%",height:u,maxHeight:280,objectFit:"cover",opacity:T?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},r={width:"100%",height:u,maxHeight:280};return(0,b.jsx)(_,{src:o,placeholderSrc:T?k.dataURL:void 0,placeholderBehavior:T?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:r,imageStyle:n,onLoadComplete:A,testId:"pageCover"})}}),T&&(0,b.jsxs)("div",{style:y().fd,children:[(0,b.jsx)(o(331542).A,{size:"md",style:{marginRight:4}}),(0,b.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:void 0!==k.uploadProgress?(0,b.jsx)(o(773382).A,{percentage:k.uploadProgress}):k.progressText?(0,b.jsx)("span",{children:k.progressText}):null})]})]})})};function A(){g().A.reset()}function C(e){let{isVisible:t,isRepositioning:o,handleCancelClick:s,handleRepositionClick:c,handleSavePositionClick:y,lastProxiedUrl:h,store:S,disabled:_,paddingRight:k,paddingLeft:A,mouseStore:C}=e;const x=(0,r().v3)(),I=(0,a().tz)(),T=(0,n.useCallback)((e=>function(e,t,o,n,r){r.reset();const i=e.target.getBoundingClientRect();l().W({environment:t,intl:o,store:n,rect:i,from:"page_header"})}(e,x,I,S,C)),[x,I,S,C]),P=(0,i().K8)((()=>g().A.state.loadingMode),[]),M=(0,i().K8)((()=>function(e){let t;return t=Boolean(e.isFullWidth())?"100%":d().x6,t}(S)),[S]),{device:R}=x,E=(0,i().O$)(u().e);if(_||P!==p().pF||!E)return null;const{isMobile:B}=R;return(0,b.jsx)(f().A,{animate:{width:M,opacity:t?1:0},style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,b.jsxs)(m().A,{isVisible:t,position:"bottom",style:{marginRight:k,marginLeft:A},children:[!o&&(0,b.jsx)(v().A,{style:{borderRight:B?"none":void 0,...w().k},onClick:T,children:(0,b.jsx)(a().sA,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!o&&!B&&(0,b.jsx)(v().A,{style:{...w().k,borderRight:"none"},onClick:e=>c(e,h),children:(0,b.jsx)(a().sA,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),o&&!B&&(0,b.jsx)(v().A,{style:w().k,onClick:y,children:(0,b.jsx)(a().sA,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),o&&!B&&(0,b.jsx)(v().A,{style:{...w().k,borderRight:"none"},onClick:s,children:(0,b.jsx)(a().sA,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})}},551619:(e,t,o)=>{o.d(t,{Hy:()=>R,NV:()=>P,O9:()=>B,Rg:()=>E,Sm:()=>U,dK:()=>D,f7:()=>V,l8:()=>L,n$:()=>O,no:()=>N,sx:()=>M});var n=()=>o(402014),r=()=>o(484714),i=()=>o(792485),a=()=>o(56366),s=()=>o(700500),l=()=>o(651124),c=()=>o(519831),d=()=>o(620689),u=()=>o(591197),p=()=>o(835066),g=()=>o(780054),m=()=>o(964345),f=()=>o(68465),v=()=>o(504836),y=()=>o(478726),h=()=>o(747100),S=()=>o(963589),b=()=>o(665579),_=()=>o(765957),w=()=>o(525569),k=()=>o(217429),A=()=>o(375447),C=()=>o(66496),x=()=>o(548821),I=()=>o(712505),T=()=>o(302022);function P(e){(0,n().SQ)({event:e,context:n().y$.EditorMouseDown,callback:()=>{}})}function M(e){(0,n().SQ)({event:e,context:n().y$.Click,callback:()=>{}})}function R(e){return(0,a().K8)((()=>Boolean(T().A.state.pageMap[e.id])||C().A.state.pages.has(e.id)),[e.id])}function E(e,t){const o=(0,r().v3)(),n=(0,i().S)(),s=R(e),l=(0,a().K8)((()=>{var o,n;return t===x().Rr.Frame?Boolean(null===(o=_().default.state.currentLoadingContainerStore)||void 0===o?void 0:o.state.ready):t===x().Rr.PeekView&&I().default.state.open?Boolean(null===(n=I().default.state.loadingContainerStore)||void 0===n?void 0:n.state.ready):t===x().Rr.CollectionPageView||t===x().Rr.CollectionPageViewFullScreen?e.isReady():void 0}),[t,e]),c=V(e);return(0,a().K8)((()=>{if(!l)return!1;const t=o.currentUser.isLoggedIn(),r=n&&n.publicEditModeStore.state;return Boolean(e&&e.isDefined()&&!e.isNonEditableState()&&e.canEdit()&&!e.hasContent()&&t&&(!(null!=r&&r.hasPublicPermission)||"edit"===(null==r?void 0:r.permission))&&!s&&!c&&(!(0,f().ZE)(r)||"completionPopup"!==w().default.state.type))}),[o.currentUser,c,l,n,s,e])}function B(e,t){const o=(0,r().v3)(),n=(0,i().S)(),{isTablet:s}=(0,r().Y0)(),l=(0,S().X)("tablet_refresh_template_pills_gate");return(0,a().K8)((()=>{if(t===x().Rr.SitePreview)return!1;if(g().A.isMobile&&(!s||!l))return!1;if(!o.currentUser.isLoggedIn())return!1;const r=n&&n.publicEditModeStore.state;if(null!=r&&r.hasPublicPermission&&"edit"!==(null==r?void 0:r.permission))return!1;if(e.getContentLength()>1)return!1;if(!e.canEdit()||e.isNonEditableState())return!1;const i=e.getContentStores()[0];if(i&&!i.isEmptyTextBlock())return!1;if(e.getAssociatedCollectionStore())return!1;const a=m().gZ.state,c=m().Di.state;if(a&&e.id===c)return!1;return!((0,y().L5)(t)?u().VY.state:u().u3.state)}),[o,n,e,t,s,l])}function V(e){return(0,a().K8)((()=>{if(e.isCollectionView()){const t=e.getCollectionStoreIfSingleSource();return!!t&&t.isSyncedCollection()}return e.isType(s().xd.externalObjectInstancePage)}),[e])}function U(e){return(0,a().K8)((()=>{if(!(0,v().vL)())return!1;const t=e.getParentStore();if((null==t?void 0:t.table)===c().Vl){return!!t.getFormatStore().getKeyStore("external_collection_type").getValue()}return!1}),[e])}function D(e){return(0,a().K8)((()=>{if(!(0,v().pB)())return!1;var t;return!!e.isCollectionView()&&((null===(t=e.getCollectionStore())||void 0===t?void 0:t.getFormatStore().getKeyStore("external_collection_type").getValue())??!1)}),[e])}function L(e){return(0,a().K8)((()=>{if(!k().default.checkGate({gateName:"csvimport_faster_navigate_to_page_enabled"}))return!1;var t;return!!e.isCollectionView()&&(null===(t=e.getCollectionStore())||void 0===t?void 0:t.getFormatStore().getKeyStore("static_import_collection_type").getValue())===l().IE.CsvImport}),[e])}function O(e){const t=(0,r().v3)(),{device:o,WindowSizeStore:n}=t,i=(0,a().K8)((()=>{const e=n.state.height,o=g().A.isMobile&&A().Ay.state.open?e:0;return d().C6(t)+o}),[t,n]);return(0,a().K8)((()=>"home-phone"===e?b().q3:o.isTablet?380:o.isIOS?Math.max(350,i):g().A.isMobile?400:"side-peek"===e||"center-peek"===e?h().ln:"home"===e?b().wH:"30vh"),[o,i,e])}function N(e){const t=(0,r().v3)(),o=(0,a().K8)((()=>(0,p().dC)(t,e)),[t,e]);return(0,a().K8)((()=>o&&!e.isFullWidth()?(0,p().Zy)(t,(0,h().cq)(e),(0,h().RX)(e)):0),[t,o,e])}},591197:(e,t,o)=>{o.d(t,{VY:()=>s,ZJ:()=>i,u3:()=>a});var n=()=>o(496506);class r extends(()=>o(757695))().Store{getInitialState(){return{popupRenderedInPage:!1,popupRenderedInPeekView:!1}}}const i=new r,a=new(n().ComputedStore)((()=>!1!==i.state.popupRenderedInPage),{debugName:"AssistantWriterRenderedInPageStore"}),s=new(n().ComputedStore)((()=>!1!==i.state.popupRenderedInPeekView),{debugName:"AssistantWriterRenderedInPeekViewStore"})},608581:(e,t,o)=>{o.d(t,{A:()=>u});o(898992),o(354520),o(581454),o(941795);var n=o(296540),r=()=>o(401497),i=()=>o(955825),a=()=>o(284371),s=()=>o(780054),l=()=>o(963575),c=o(474848);function d(e){const{button:t,isLast:o}=e,s=(0,r().IS)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:a().Wy.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return n.cloneElement(t,{...(0,i().AH)(t.props.style,s.button,o&&s.buttonLast),hoveredStyle:(0,i().AH)(s.buttonHovered,o&&s.buttonLast).style,pressedStyle:s.buttonPressed})}const u=function(e){let{children:t,isVisible:u,position:p,style:g}=e;const m=(0,r().IS)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.shadowSM,display:"flex",whiteSpace:"nowrap",borderRadius:l().A.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:s().A.isMobile?"auto":"none",opacity:s().A.isMobile?1:0,fontFamily:a().vc(o(662303).locale).sans,position:"absolute",right:l().A.horizontal.small,bottom:l().A.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:l().A.vertical.small,bottom:void 0}})),[]),f=n.Children.toArray(t).filter(o(534177).O9),v=f.length;return(0,c.jsx)(o(145214).A,{animate:{opacity:u?1:0},...(0,i().AH)(m.container,g,u&&m.containerHover,"top"===p&&m.containerTop),children:f.map(((e,t)=>{const r=t===v-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===o(859428).A&&n.isValidElement(e))return n.cloneElement(e,{render:(t,o)=>{const n=e.props.render(t,o);return(0,c.jsx)(d,{isLast:r,button:n},e.key)}});if(e.type===o(704152).A&&n.isValidElement(e))return(0,c.jsx)(d,{isLast:r,button:e},e.key)}}))})}},612900:(e,t,o)=>{o.d(t,{u:()=>i});var n=()=>o(645873);const r=new(n().O2)("PulsingWrapper",(async()=>o.e(45248).then(o.bind(o,673962)))),i=(0,n().jQ)(r,(e=>e.PulsingWrapper),{renderLoading:(e,t)=>t.children})},665579:(e,t,o)=>{o.d(t,{$L:()=>s,BZ:()=>d,EC:()=>m,EI:()=>b,E_:()=>x,Ed:()=>p,Fq:()=>y,Lu:()=>w,Mk:()=>g,O0:()=>C,UO:()=>I,V$:()=>A,VQ:()=>f,Xx:()=>_,Xy:()=>c,YS:()=>v,_g:()=>S,dd:()=>u,pW:()=>l,q3:()=>a,wH:()=>i});var n=()=>o(496603),r=()=>o(534177);const i=160,a=40,s=24,l=20,c=600,d=270,u=405,p=480,g=500,m=void 0,f=16,v=10,y=8,h=(o(69447).nh,{backdropFilter:"blur(48px)",WebkitBackdropFilter:"blur(48px)"}),S=4;function b(e){return{icon:e.icon.secondary,text:e.text.secondary}}function _(e){return{width:48,height:48,fill:e.icon.tertiary}}function w(e){let{theme:t,isPhone:o}=e;return o?t.personalHomeBackgroundPhone:t.surface.page}const k=1;function A(e){let{isPhone:t,theme:o}=e;return{zIndex:1,position:"relative",display:"flex",flexDirection:"column",borderRadius:12,background:o.home.tile.background,boxShadow:x({isPhone:t,theme:o}),...h}}function C(e){let{mode:t}=e;switch(t){case"dark":return 0;case"light":return k;default:return(0,r().ub)(t),0}}function x(e){let{isPhone:t,theme:o,borderOnly:r}=e;if("dark"===o.mode)return"unset";o.mode;const i=C({mode:o.mode});return(0,n().oE)([r||t?void 0:"0 12px 32px rgba(0, 0, 0, 0.02)",`0 0 0 ${i}px rgba(0, 0, 0, 0.05)`]).join(", ")}function I(e){const{isPhone:t,theme:o,borderOnly:n}=e;return{unhoveredBoxShadow:x({isPhone:t,theme:o,borderOnly:n}),hoveredBoxShadow:"light"===o.mode?["0 12px 32px rgba(0, 0, 0, 0.03)","0 0 0 1px rgba(0, 0, 0, 0.085)"].join(", "):o.homeShadow.card.hovered}}},681810:(e,t,o)=>{o.d(t,{A:()=>n});const n=new(o(867772).Ay)},701751:(e,t,o)=>{o.d(t,{p:()=>i});o(296540);var n=o(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"3.97 1.94 14.91 15.66",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M10.55 12.808a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 1 0 1.1 0z"}),(0,n.jsx)("path",{d:"M15.4 1.95a3.48 3.48 0 0 0-3.48 3.48v1.92H6.4a2.425 2.425 0 0 0-2.425 2.425v5.4A2.425 2.425 0 0 0 6.4 17.6h7.2a2.425 2.425 0 0 0 2.425-2.425v-5.4A2.425 2.425 0 0 0 13.6 7.35h-.43V5.43a2.23 2.23 0 1 1 4.46 0v2.095a.625.625 0 1 0 1.25 0V5.43a3.48 3.48 0 0 0-3.48-3.48M5.225 9.775c0-.649.526-1.175 1.175-1.175h7.2c.649 0 1.175.526 1.175 1.175v5.4c0 .649-.526 1.175-1.175 1.175H6.4a1.175 1.175 0 0 1-1.175-1.175z"})]})},i=(0,o(340498).wt)("lockOpen",r)},735695:(e,t,o)=>{o.d(t,{Ay:()=>x,iZ:()=>k,vE:()=>w});var n=o(296540),r=()=>o(804773),i=()=>o(401497),a=()=>o(149375),s=()=>o(66913),l=()=>o(959013),c=()=>o(284371),d=()=>o(686526),u=()=>o(704152),p=()=>o(285790),g=()=>o(928600),m=()=>o(480095),f=()=>o(554509),v=()=>o(780054),y=()=>o(722872),h=()=>o(253579),S=()=>o(255824),b=o(474848);const _=(0,l().YK)({back:{defaultMessage:"Back",id:"collectionsSettingsMenu.back"}}),w=290,k=400;function A(e){let{children:t,title:o,desktopTitleType:n,settingsStackLength:r,handleClose:d,handleBackArrowClick:g,hideDesktopHeader:m,hasBackStack:v}=e;const y=(0,S().a)(),h=(0,l().tz)(),w=(0,i().IS)((e=>({hiddenDesktopHeaderDiv:{height:0},nonHiddenDesktopHeaderDiv:{display:"flex",alignItems:y?"top":"center",padding:y?"0px 14px 6px 14px":"14px 16px 6px 16px",height:y?void 0:42},arrowButton:{marginRight:8,marginLeft:-2,height:22},arrowIcon:{width:16,height:16},title:{flexGrow:1,fontWeight:y?c().Wy.medium:c().Wy.semibold,fontSize:y?16:14,lineHeight:y?"24px":void 0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:18,height:18,flexShrink:0},closeButtonHover:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.text.secondary}})),[y]),k=!y;return(0,b.jsxs)(b.Fragment,{children:[m?(0,b.jsx)("div",{style:w.hiddenDesktopHeaderDiv}):(0,b.jsxs)("div",{style:w.nonHiddenDesktopHeaderDiv,children:[(r>1||v)&&(0,b.jsx)(p().A,{icon:a().v,style:w.arrowButton,iconStyle:w.arrowIcon,onClick:g,ariaLabel:h.formatMessage(_.back)}),"sectionHeader"===n?(0,b.jsx)(f().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",customStyles:{flexGrow:1},children:o}):(0,b.jsx)("span",{style:w.title,children:o}),k&&(0,b.jsx)(u().A,{onClick:d,style:w.closeButton,hoveredStyle:w.closeButtonHover,children:(0,s().V)(w.closeIcon)})]}),t]})}function C(e,t){let{children:i,footer:a,header:s,unconstrainedWidth:l,desktopWidth:c,title:u,desktopTitleType:p,collectionSettingsStore:f,fullHeight:_,hideDesktopHeader:k,menuScrollerStyle:C,innerContentWrapperStyle:x,disableScroller:I,handleBackArrowClick:T,hasBackStack:P,handleClose:M}=e;const R=(0,o(175116).Ks)(),E=(0,y().Tf)(),B=(0,S().a)(),{currentTab:V,settingsStackLength:U,hideHeader:D}=(0,o(56366).K8)((()=>{const e=f.state;return{currentTab:(0,o(940371).S)(f),settingsStackLength:e.stack.length,hideHeader:e.hideSettingsHeader}}),[f]),L=(0,n.useCallback)((()=>{var e;T?T():d().yl({collectionSettingsStore:f,keepPreviousRef:"form_editor"===(null==R||null===(e=R.collectionViewStore())||void 0===e?void 0:e.getType())})}),[T,f,R]),O=(0,n.useCallback)((e=>{M?M(e):d().os({collectionSettingsStore:f})}),[M,f]),N=(0,n.useCallback)((e=>{(0,h().rW)(e.target)||(0,h().iX)(e.target)||(0,h().u2)(e.target)||o(263711).g.state.isOpen||O(e)}),[O]);if(!V)return null;let j;if(v().A.isMobile)j={disableScroller:I,menuType:y().gu.Modal,title:u,left:U>1?(0,b.jsx)(m().MobileModalBackButton,{}):void 0,onClickLeft:U>1?L:void 0,scrollerStyle:C,innerRef:t,right:E?void 0:(0,b.jsx)(m().DoneMenuText,{}),onClickRight:E?void 0:O};else{const e=l||c?void 0:B?280:w;j={disableScroller:I,menuType:y().gu.Popup,minWidth:B?280:w,width:c,maxHeight:_?"100%":"80vh",...e&&{maxWidth:e},onClickOutside:N,scrollerStyle:{flexGrow:0,...C},header:!D&&(0,b.jsx)(A,{settingsStackLength:U,handleClose:O,handleBackArrowClick:L,hasBackStack:P,hideDesktopHeader:k,title:u,desktopTitleType:p,children:s}),paddingTop:D?6:0,footer:a,innerRef:t}}const F=(0,b.jsxs)(b.Fragment,{children:[v().A.isMobile&&s,i,v().A.isMobile&&a]});return _?(0,b.jsx)(r().Y,{direction:"vertical",children:(0,b.jsx)(g().A,{...j,children:F})}):(0,b.jsx)(o(297872).A,{capture:!0,allowMobileAutoScroll:!0,allowEsc:!0,render:e=>(0,b.jsx)(r().Y,{direction:"vertical",children:(0,b.jsx)(g().A,{...j,...e,children:(0,b.jsx)("div",{style:x,children:F})})})})}const x=(0,n.forwardRef)(C)},735790:(e,t,o)=>{o.d(t,{M:()=>i});o(296540);var n=o(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.25 15.25 11.5",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M3 7.375h6.829a2.501 2.501 0 0 0 4.842 0H17a.625.625 0 1 0 0-1.25h-2.329a2.501 2.501 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25M12.25 5.5a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5"}),(0,n.jsx)("path",{fillRule:"evenodd",d:"M7.75 15.75a2.5 2.5 0 0 0 2.421-1.875H17a.625.625 0 1 0 0-1.25h-6.829a2.5 2.5 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25h2.329A2.5 2.5 0 0 0 7.75 15.75m0-1.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"})]})},i=(0,o(340498).wt)("sliders",r)},742117:(e,t,o)=>{o.d(t,{V:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("chevronRight",{viewBox:"0 0 16 16",directional:!0,svg:(0,n.jsx)("path",{d:"M12.375 8.06445C12.375 7.83203 12.2861 7.63379 12.1084 7.45605L6.77637 2.24023C6.62598 2.08984 6.44141 2.01465 6.22266 2.01465C5.77832 2.01465 5.42285 2.35645 5.42285 2.80078C5.42285 3.01953 5.51172 3.21777 5.66211 3.375L10.4746 8.06445L5.66211 12.7539C5.51855 12.9043 5.42285 13.1025 5.42285 13.3213C5.42285 13.7725 5.77832 14.1143 6.22266 14.1143C6.44141 14.1143 6.62598 14.0391 6.77637 13.8887L12.1084 8.67285C12.293 8.49512 12.375 8.29688 12.375 8.06445Z"})})},747671:(e,t,o)=>{o.d(t,{Q:()=>n,a:()=>r});let n=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class r extends(()=>o(757695))().Store{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}}},748539:(e,t,o)=>{o.d(t,{f:()=>n});const n=new(o(645873).O2)("pageCovers",(async()=>{const{pageCovers:e}=await o.e(40198).then(o.bind(o,519737));return e}))},769705:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(757695))().Store{getInitialState(){}}const r=new n},801678:(e,t,o)=>{o.d(t,{A:()=>m});var n=o(296540),r=()=>o(662303),i=()=>o(56366),a=()=>o(959013),s=()=>o(381349),l=()=>o(496603),c=()=>o(284371),d=()=>o(720665),u=()=>o(145214),p=o(474848);const g={isRepositioning:!1};const m=function(e){const t=(0,n.useRef)(null),r=(0,o(484714).v3)(),[a,s]=(0,n.useState)(g),c=(0,n.useCallback)((()=>{s(g)}),[]),{renderControl:u,onFlushTemporaryPosition:m,style:v,source:y,store:h}=e,{isRepositioning:S,image:b,startDragRenderedPosition:_,startDragImageScreenHeight:w}=a,k=(0,i().K8)((()=>0===o(502438).default.state.stores.length),[]),[A,C]=(0,n.useState)(!1),x=(0,i().uB)(e.mouseStore,o(454305).A),I=(0,i().K8)((()=>x.state.mouseEntered),[x]),T=(0,o(401497).IS)((()=>({dragContainer:{width:"100%",cursor:S?"move":"inherit"},container:{position:"relative",width:"100%",zIndex:1}})),[S]),P=(0,i().K8)((()=>function(e,t,o){return(0,l().Et)(o)?o:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,l().Et)(e))return e}const o=.5;if(t.isCollectionView()){const e=t.getCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,d().pN)(t)?o:t}}const n=t.getFormat(),r=n.page_cover_position;if((0,l().Et)(r))return r;return o}(e,t)}(y,h,a.temporaryPosition)),[a.temporaryPosition,y,h]);(0,n.useEffect)((()=>{const e=e=>{const o=t.current;o&&!o.contains(e.target)&&S&&m({imagePosition:P,reset:()=>{x.reset(),c()}})};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)}),[P,S,x,m,c]),S&&!k&&c();const M=(0,n.useMemo)((()=>(0,l().nF)((e=>{x.setState({...x.state,mouseEntered:!0})}),100)),[x]),R=(0,n.useMemo)((()=>(0,l().sg)((e=>{x.setState({...x.state,mouseEntered:!1})}),100)),[x]),E=(0,n.useCallback)(((e,t)=>{o(778417).IU({environment:r});const n=new Image;n.onload=()=>{s((e=>({...e,isRepositioning:!0,image:n})))},t&&(n.src=t)}),[r]),B=(0,n.useCallback)((e=>{m({imagePosition:P,reset:()=>{c()}})}),[P,m,c]),V=(0,n.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o(819121).p)(t)&&C(!0)}),[]),U=(0,n.useCallback)((()=>{C(!0)}),[]),D=(0,n.useCallback)((e=>{if(b&&S){const e=t.current;if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/b.width*b.height;s((e=>({...e,startDragImageScreenHeight:t,startDragRenderedPosition:P})))}}}),[b,P,S]),L=(0,n.useCallback)((e=>{if(S){const t=e.diffY/(w||0)+(_||0);s((e=>({...e,temporaryPosition:(0,l().LI)((0,o(40845).A)(t,0,1),4)})))}}),[S,w,_]),O=(0,n.useCallback)((()=>{s((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),N=(0,i().K8)((()=>u({handleRepositionClick:E,handleSavePositionClick:B,handleCancelClick:c,isVisible:I||A||S,isRepositioning:S})),[E,B,A,S,I,u,c]),j=(0,o(79043).A)(Boolean(e.preventClickPropagation));return(0,p.jsxs)("div",{ref:t,onFocus:V,onBlur:U,onMouseEnter:M,onMouseMove:M,onMouseLeave:R,...j,...(0,o(955825).AH)(T.container,v),children:[(0,p.jsx)(o(603820).A,{onDraggableDragStart:D,onDraggableDragMove:L,onDraggableDragEnd:O,onDraggableDragCancel:O,disabled:!S,render:t=>(0,p.jsx)("div",{style:T.dragContainer,...t,children:e.render({imagePosition:P,isRepositioning:S})})}),(0,p.jsx)(f,{small:e.small,isRepositioning:S}),N]})};function f(e){let{small:t,isRepositioning:o}=e;if(t)return null;const n={background:s().Ay.blackWithAlpha(.4),borderRadius:4,color:s().Ay.white,fontSize:12,fontFamily:c().vc(r().locale).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,p.jsx)(u().A,{visible:o,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:n,children:(0,p.jsx)(a().sA,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}},867772:(e,t,o)=>{o.d(t,{Ay:()=>l,Gi:()=>i,Wc:()=>n,pF:()=>a,vS:()=>r});const n="loadingLocalImage",r="uploading",i="downloading",a="loaded";class s extends(()=>o(757695))().Store{getInitialState(){return{loadingMode:a}}}const l=s},882262:(e,t,o)=>{o.d(t,{m:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.23 3.23 13.54 13.53",svg:(0,o(474848).jsx)("path",{d:"M4.485 8.86V5.369l4.073 4.073a.625.625 0 0 0 .884-.884L5.369 4.485h3.49a.625.625 0 1 0 0-1.25h-5a.625.625 0 0 0-.624.625v5a.625.625 0 0 0 1.25 0m10.146 6.655-4.07-4.07a.625.625 0 0 1 .884-.884l4.07 4.07V11.14a.625.625 0 1 1 1.25 0v5c0 .345-.28.625-.625.625h-5a.625.625 0 1 1 0-1.25z"})},r=(0,o(340498).wt)("arrowExpandDiagonal",n)},937199:(e,t,o)=>{o.d(t,{LH:()=>i,Op:()=>r,bi:()=>l,sf:()=>s,v$:()=>a});o(16280);var n=o(296540);const r=(0,n.createContext)(null);function i(){const e=(0,n.useContext)(r);if(!e)throw new Error("usePageLayoutEditorContext must be used inside BaseLayoutEditorContext.Provider");return e}function a(){return(0,n.useContext)(r)}r.displayName="BaseLayoutEditorContext";const s=(0,n.createContext)(null);function l(){const e=(0,n.useContext)(s);if(!e)throw new Error("usePageLayoutEditorContext must be used inside PageLayoutEditorContextProvider");return e}s.displayName="PageLayoutEditorContext"},954220:(e,t,o)=>{o.r(t),o.d(t,{computeSimilarUserRecentPagesState:()=>p,fetchUserSignals:()=>v,initializeAndLoadAllUserSignals:()=>m,refreshAndBroadcastSimilarUserSignals:()=>g,setUserSignals:()=>f});o(944114),o(898992),o(803949),o(581454);var n=()=>o(386164),r=()=>o(496603),i=()=>o(449506),a=()=>o(187778),s=()=>o(217429),l=()=>o(20199),c=()=>o(314648);const d=5*o(720665).Xb;function u(e){const t=s().default.getEligibleGroup({experimentId:e,parameter:"editedPagesLookbackDays",defaultGroup:"control"});return void 0===t||"control"===t?"1":t}function p(e){const t={};return e.forEach((e=>{let{userId:o,recentPages:n,similarity:i}=e;if(!n.length)return;const a=r().$z(n,(e=>{let{pageId:t}=e;return t}));Object.entries(a).forEach((e=>{let[n,r]=e;const a=r.map((e=>{let{visitedAt:t}=e;return t})).sort(((e,t)=>t-e));t[n]||(t[n]={pageId:n,sortedSimilarUserSignals:[]}),t[n].sortedSimilarUserSignals.push({userId:o,similarity:i,visitedAt:a})}))})),Object.values(t).forEach((e=>{e.sortedSimilarUserSignals.sort(((e,t)=>t.similarity-e.similarity))})),t}async function g(e){var t;const{spaceId:o,userId:n,environment:r}=e,i=await v({spaceId:o,environment:r,signalsOverride:[{name:"similarUserRecentPages",includeRecords:!0},{name:"similarUsersEditedPages",includeRecords:!0,lookbackDays:1}]});void 0!==i&&(f({spaceId:o,userId:n,environment:r,newSignals:i,initialize:!1}),await(null===(t=l().A.state.broadcastChannel)||void 0===t?void 0:t.postMessage({type:"userSignals",data:i})))}async function m(e){const{spaceId:t,userId:o,environment:n,refreshTimer:r=d}=e,i=await v({spaceId:t,environment:n});if(void 0===i)return;f({spaceId:t,userId:o,environment:n,newSignals:i,initialize:!0});var a;"on"===s().default.getEligibleGroup({experimentId:"search_refresh_user_signals",defaultGroup:"control"})?(await c().default.waitUntil((()=>Boolean(c().default.getUserSignals({spaceId:t,userId:o})))),null===(a=l().A.state.broadcastChannel)||void 0===a||a.addEventListener("message",(e=>{"userSignals"===e.type&&f({spaceId:t,userId:o,environment:n,newSignals:e.data,initialize:!1})})),await l().A.waitUntil((()=>Boolean(l().A.state.elector))),l().A.state.elector.awaitLeadership().then((()=>{c().default.update((e=>{e.refreshIntervalId&&window.clearInterval(e.refreshIntervalId);const i=window.setInterval((async()=>{await g({spaceId:t,userId:o,environment:n})}),r);return{...e,refreshIntervalId:i}}))}))):c().default.update((e=>{e.refreshIntervalId&&window.clearTimeout(e.refreshIntervalId);const i=window.setTimeout((async()=>{const e=await v({spaceId:t,environment:n});void 0!==e&&f({spaceId:t,userId:o,environment:n,newSignals:e,initialize:!1})}),r);return{...e,refreshIntervalId:i}}))}function f(e){const{spaceId:t,userId:o,environment:n,newSignals:r,initialize:i}=e;r&&(c().default.setUserSignals({spaceId:t,userId:o,userSignals:r,initialize:i}),a().G(n,i?"userSignalsInitialization":"userSignalsReload"))}async function v(e){const{spaceId:t,environment:o,signalsOverride:a}=e,s=u("search-local-edited-pages-max"),l=u("search-local-sim-users-edited-pages-max"),d=parseInt(l),g=parseInt(s),m=await i().callApi({eventName:"getUserSignals",environment:o,data:{spaceId:t,signals:a??[{name:"similarUserRecentPages",includeRecords:!0},{name:"topPages7dPageView",includeRecords:!0},{name:"editedPages",includeRecords:!0,lookbackDays:g},{name:"similarUsersEditedPages",includeRecords:!0,lookbackDays:d}]},headers:(0,n().WS)({cellId:void 0,recordId:void 0,spaceId:t})});if("success"!==m.type)return;const f=a?r().Up((0,c().getInitialUserSignalsState)(),a.map((e=>e.name))):(0,c().getInitialUserSignalsState)();return m.data.signals.forEach((e=>{if("error"===e.status)return;const t=e.name;switch(t){case"similarUserRecentPages":f.similarUserRecentPages=p(e.data);break;case"recentPages":f.recentPages=e.data;break;case"topPages7dPageView":f.topPages7dPageView=e.data;break;case"similarUsersEditedPages":f.similarUsersEditedPages=e.data;break;case"editedPages":f.editedPages=e.data}})),f}},990402:(e,t,o)=>{o.d(t,{m:()=>r});var n=()=>o(46986);function r(e){return("workflow"===e.getType()||e.isCollectionView()&&e.getWorkflowStore())&&e.canEdit()&&!e.isSystemBlock()&&(0,n().re)()}}}]);