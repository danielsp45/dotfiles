"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[10408],{656301:(e,t,i)=>{i.r(t),i.d(t,{CustomEmojiSettings:()=>X});i(898992),i(354520),i(581454);var o=()=>i(690825),n=i(296540),s=()=>i(662303),r=()=>i(484714),a=()=>i(56366),d=()=>i(401497),l=()=>i(869190);const c=(0,i(340498).xh)("emojiFace",{default:{loader:()=>i.e(81638).then(i.bind(i,424139))},small:{loader:()=>i.e(81638).then(i.bind(i,709837))},fill:{loader:()=>i.e(81638).then(i.bind(i,619207))},fillSmall:{loader:()=>i.e(81638).then(i.bind(i,336830))}},["emoji","face","emotion","expression","smile"]);var m=()=>i(381138),u=()=>i(959013),g=()=>i(534177),j=()=>i(284371),h=()=>i(751156),p=()=>i(704152),f=()=>i(802790),x=()=>i(623580),y=()=>i(460292),C=()=>i(864943),A=()=>i(204063),E=()=>i(859428),v=()=>i(448664),w=()=>i(843878),S=()=>i(8178),b=()=>i(792361),M=()=>i(317182),k=()=>i(87878),I=()=>i(962730),T=()=>i(423219),B=()=>i(797162),z=()=>i(217429),_=()=>i(885067),F=()=>i(568625),L=()=>i(315564),O=()=>i(173019),D=()=>i(735384),K=()=>i(901389),W=()=>i(760217),R=()=>i(406699),N=()=>i(285790),P=()=>i(928600),Y=()=>i(939740),G=()=>i(89924),U=()=>i(722872),$=()=>i(553965);var V=i(474848);function q(e){const t=(0,u().tz)(),i=(0,d().IS)((e=>({editButtonIcon:{width:18,height:18},lockedIcon:{width:24,height:18,fill:e.icon.secondary}})),[]),o=(0,n.useRef)(null);if(!(0,a().K8)((()=>e.store.canEdit()),[e.store]))return(0,V.jsx)(E().A,{renderTooltip:()=>(0,V.jsx)(u().sA,{id:"customEmojiEditPopup.cantEditCustomEmoji",defaultMessage:"You don't have permission to edit this emoji"}),placement:I().W.Bottom,render:e=>(0,V.jsx)("div",{style:i.lockedIcon,...e,children:(0,L().S)()})});const s=t.formatMessage({id:"customEmojiEditPopup.editCustomEmoji",defaultMessage:"Edit"});return(0,V.jsx)(R().Ay,{alignmentToOrigin:I().C.End,renderOrigin:e=>(0,V.jsx)(E().A,{renderTooltip:()=>s,placement:I().W.Bottom,render:t=>(0,V.jsx)(N().A,{...(0,$().A)(t,e),ariaLabel:s,icon:F().L,iconStyle:i.editButtonIcon,ref:o})}),popupType:R().z7.Popup,render:t=>(0,V.jsx)(H,{...e,parent:t,iconButtonRef:o})})}function H(e){const{parent:t,store:i,iconButtonRef:o}=e,n=(0,r().v3)(),s=(0,u().tz)(),a=[{key:"edit",render:e=>(0,V.jsx)(Q,{...e}),action:()=>{var e;B().A.setState({open:!0,isEditing:!0,entrypoint:"settings",originRect:null===(e=o.current)||void 0===e?void 0:e.getBoundingClientRect(),store:i}),t.close()}},{key:"delete",render:e=>(0,V.jsx)(J,{...e}),action:async()=>{(await K().Gh({message:s.formatMessage({id:"customEmoji.delete.confirmation.title",defaultMessage:"Delete this emoji?"}),description:s.formatMessage({id:"customEmoji.delete.confirmation.description",defaultMessage:"This will delete it for everyone in your workspace"}),acceptLabel:s.formatMessage({id:"customEmoji.delete.confirmation.accept",defaultMessage:"Delete"}),acceptColor:"red",mode:"wide"})).accept&&function(e){const{environment:t,store:i}=e,o=i.getModel();o&&h().createAndCommit({environment:t,userAction:"customEmojiActions.delete",canUndo:!0,perform:e=>{h().applyOperation({transaction:e,store:i,operation:o.ops.delete()})}})}({environment:n,store:i}),t.close()}}];return(0,V.jsx)(P().A,{menuType:U().gu.Popup,width:180,children:(0,V.jsx)(Y().Ay,{initialFocus:void 0,type:Y().Oh.Vertical,sections:[{key:0,render:e=>(0,V.jsx)(G().A,{...e}),items:a}]})})}function J(e){return(0,V.jsx)(W().A,{...e,icon:(0,D().I)({width:14,height:14}),title:(0,V.jsx)(u().sA,{id:"customEmoji.settings.delete",defaultMessage:"Delete"})})}function Q(e){return(0,V.jsx)(W().A,{...e,icon:(0,O().r)({width:14,height:14}),title:(0,V.jsx)(u().sA,{id:"customEmoji.settings.edit",defaultMessage:"Edit"})})}function X(e){const{spaceStore:t}=e,i=(0,r().v3)(),o=(0,a().K8)((()=>{var e;return(null===(e=T().A.getData(i,{spaceId:t.id}))||void 0===e?void 0:e.pointers)??[]}),[i,t.id]),s=(0,a().K8)((()=>t.canAdmin()),[t]),d=(0,a().K8)((()=>t.getSetting("custom_emoji_creation_only_admin")??!1),[t]),[l,c]=(0,n.useState)(""),m=s||!d;return(0,V.jsx)(w().Ay,{children:(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,V.jsx)("div",{style:{marginBottom:4},children:(0,V.jsx)(S().A,{large:!0,divider:"full",children:(0,V.jsx)(u().sA,{id:"emoji.heading.title",defaultMessage:"Emoji"})})}),s&&(0,V.jsx)(oe,{spaceStore:t,customEmojiCreationOnlyAdmin:d}),0===o.length?(0,V.jsx)(te,{canCreateCustomEmoji:m}):(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(ee,{searchFilter:l,setSearchFilter:c,canCreateCustomEmoji:m,customEmojiCount:o.length}),(0,V.jsx)(Z,{searchFilter:l,customEmojiPointers:o})]})]})})}function Z(e){const t=(0,d().IS)((()=>({column:{paddingRight:4,paddingLeft:4,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},imageColumn:{width:"10%"},nameColumn:{width:"40%"},addedByColumn:{width:"25%"},dateAddedColumn:{width:"20%"},editColumn:{width:"5%"}})),[]),{customEmojiPointers:i,searchFilter:r}=e,[c,m]=(0,n.useState)("desc"),j=(0,a().K8)((()=>i.map((e=>{const t=(0,k().nA)({parentStore:void 0,pointer:e});if(null!=t&&t.getAlive())return t}))),[i]),h=(0,u().tz)(),f=(0,a().K8)((()=>(r.length?j.filter((e=>{var t;const i=(null==e||null===(t=e.getCreatedByStore())||void 0===t?void 0:t.getDisplayName(h))??"";return`${(null==e?void 0:e.getName())??""} ${i}`.toLowerCase().includes(r.toLowerCase())})):j).filter(g().O9).sort(((e,t)=>"asc"===c?e.getCreatedTime()-t.getCreatedTime():t.getCreatedTime()-e.getCreatedTime()))),[j,h,r,c]),x=(0,n.useRef)(null),y=(0,o().Te)({count:f.length,getScrollElement:()=>x.current,estimateSize:()=>46,overscan:5});(0,n.useEffect)((()=>{f.length>0&&y.scrollToIndex(0)}),[y,r,f]);const C=y.getVirtualItems(),A=[{key:"image",header:(0,V.jsx)(u().sA,{id:"customEmojis.settings.table.header.image",defaultMessage:"Image"}),style:{...t.column,...t.imageColumn}},{key:"name",header:(0,V.jsx)(u().sA,{id:"customEmojis.settings.table.header.name",defaultMessage:"Name"}),style:{...t.column,...t.nameColumn}},{key:"addedBy",header:(0,V.jsx)(u().sA,{id:"customEmojis.settings.table.header.addedBy",defaultMessage:"Added by"}),style:{...t.column,...t.addedByColumn}},{key:"dateAdded",header:(0,V.jsxs)(p().A,{ignoreLocalHoverState:!0,onClick:()=>{m("asc"===c?"desc":"asc")},style:{display:"flex",alignItems:"center"},children:[(0,V.jsx)(u().sA,{id:"customEmojis.settings.table.header.dateAdded",defaultMessage:"Date added"}),(0,V.jsx)(b().X,{up:"asc"===c})]}),style:{...t.column,...t.dateAddedColumn}},{key:"edit",header:(0,V.jsx)(V.Fragment,{}),style:{...t.column,...t.editColumn}}];return(0,V.jsx)("div",{style:{height:"100%",width:"100%",overflowY:"auto"},ref:x,children:(0,V.jsx)(M().A,{tableBodyStyle:{height:y.getTotalSize(),width:"100%",position:"relative",transform:"translateZ(0)"},columns:A,rows:C.map((e=>function(e,t){function i(){return(0,V.jsx)(v().A,{size:24,emojiStore:e})}function o(){const t=(0,a().K8)((()=>e.getName()),[]);return(0,V.jsx)("span",{children:t})}function n(){const i=(0,a().K8)((()=>{const i=e.getCreatedByStore();return null==i?void 0:i.getDisplayName(t)}),[]);return(0,V.jsx)("span",{children:i})}function r(){const t=(0,a().K8)((()=>e.getCreatedTime()),[]);return(0,V.jsx)("span",{children:(0,l().W_)(t,"medium",s().locale)})}return{key:e.id,columns:[(0,V.jsx)(i,{},e.id),(0,V.jsx)(o,{},e.id),(0,V.jsx)(n,{},e.id),(0,V.jsx)(r,{},e.id),(0,V.jsx)(q,{store:e},e.id)]}}(f[e.index],h))),rowStyle:e=>{let{rowIndex:t}=e;return{position:"absolute",top:0,left:0,width:"100%",height:C[t].size,transform:`translateY(${C[t].start}px)`,display:"flex",alignItems:"center"}},cellStyle:e=>{let{columnIndex:t}=e;return A[t].style}})})}function ee(e){const{searchFilter:t,setSearchFilter:i,canCreateCustomEmoji:o,customEmojiCount:n}=e,s=(0,d().IS)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:o?"space-between":"end",marginBottom:20,gap:"16px 8px",flexWrap:"wrap"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.icon.secondary},searchInput:{flex:"1 1 100px",maxWidth:250,minWidth:100},tooltip:{width:240,textWrap:"wrap"}})),[o]),r=(0,u().tz)(),l=(0,a().K8)((()=>z().default.getConfigKey("custom_emojis_config","limit")),[]),c=n>=l;return(0,V.jsxs)("div",{style:s.container,children:[o&&(0,V.jsx)(E().A,{style:s.tooltip,placement:I().W.Bottom,alignment:I().C.Start,disableTooltip:!c,renderTooltip:()=>(0,V.jsx)(u().sA,{id:"customEmoji.settings.customEmojiLimit.error",defaultMessage:"Your workspace has reached the custom emoji limit of {customEmojiLimit}",values:{customEmojiLimit:l.toLocaleString()}}),render:e=>(0,V.jsx)(A().A,{...e,onClick:ie,disabled:c,children:(0,V.jsx)(u().sA,{id:"customEmoji.settings.addEmoji",defaultMessage:"Add emoji"})})}),(0,V.jsx)(x().A,{placeholder:r.formatMessage({id:"customEmoji.settings.search",defaultMessage:"Search by name or added by"}),left:(0,m().q)(s.searchIcon),showClearButton:!0,format:x().C.Small,value:t,onChange:e=>{i(e.target.value)},style:s.searchInput})]})}function te(e){const{canCreateCustomEmoji:t}=e,i=(0,d().IS)((e=>({container:{display:"flex",marginTop:100,justifyContent:"center",alignItems:"center",flexDirection:"column",gap:12},text:{maxWidth:200,fontWeight:j().Wy.regular,textAlign:"center",fontSize:j().J.UISmall.desktop,fontFamily:j().Tf.sans,color:e.text.secondary}})),[]);return(0,V.jsxs)("div",{style:i.container,children:[(0,V.jsx)(y().Q,{iconGroup:c,variantName:"default",colorName:"tertiary",overrideSize:()=>64}),(0,V.jsx)("span",{style:i.text,children:(0,V.jsx)(u().sA,{id:"customEmoji.empty.title",defaultMessage:"Custom emoji are available for everyone in your workspace"})}),t&&(0,V.jsx)(C().A,{size:"lg",onClick:ie,children:(0,V.jsx)(u().sA,{id:"customEmoji.empty.addEmoji",defaultMessage:"Add emoji"})})]})}function ie(e){const t=e.target;B().A.setState({open:!0,isEditing:!1,entrypoint:"settings",originRect:t.getBoundingClientRect()})}function oe(e){const{spaceStore:t,customEmojiCreationOnlyAdmin:i}=e,o=(0,r().v3)(),n=(0,d().IS)((e=>({divider:{color:e.regularDividerColor,marginTop:20,marginBottom:20}})),[]);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(_().y,{title:(0,V.jsx)(u().sA,{id:"customEmojis.settings.customEmojiCreationOnlyAdmin.title",defaultMessage:"Limit custom emoji creation to workspace owners"}),description:(0,V.jsx)(u().sA,{id:"customEmojis.settings.customEmojiCreationOnlyAdmin.caption",defaultMessage:"Existing emoji can still be edited or deleted by their creator"}),selected:i,onChange:()=>{h().createAndCommit({userAction:"customEmojis.settings.toggleCustomEmojiCreationOnlyAdmin",environment:o,canUndo:!0,perform:e=>{h().applyOperation({transaction:e,store:t,operation:{pointer:t.pointer,path:["settings","custom_emoji_creation_only_admin"],command:"set",args:!i}})}})}}),(0,V.jsx)(f().A,{size:1,style:n.divider,dividerColor:n.divider.color})]})}}}]);