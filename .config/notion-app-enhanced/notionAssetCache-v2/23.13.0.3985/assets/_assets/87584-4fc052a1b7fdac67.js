"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[87584],{27716:(e,n,t)=>{t.d(n,{Ft:()=>A,HN:()=>M,MA:()=>v,Sk:()=>P,Yn:()=>I,e9:()=>m,eJ:()=>k,su:()=>y});t(944114),t(898992),t(672577),t(737550);var i=()=>t(326215),o=()=>t(762433),r=()=>t(47273),l=()=>t(979340),a=()=>t(959013),s=()=>t(972435),u=()=>t(324561);const c=(0,a().YK)({cancellationError:{id:"midtermSubscriptionHelpers.cancellationFailed",defaultMessage:"There was an error attempting to cancel your pending changes. Please try again."},unableToCancelError:{id:"midtermSubscriptionHelpers.unableToCancel",defaultMessage:"We cannot cancel your scheduled changes right now. Please contact support for more help."},cancellationSuccess:{id:"midtermSubscriptionHelpers.cancellationSucceeded",defaultMessage:"Pending changes have been canceled"},invalidSubscriptionId:{id:"midtermSubscriptionHelpers.invalidSubscriptionId",defaultMessage:"Unable to cancel your pending changes. Something was wrong with your pending subscription changes."}});function d(e){return(0,l().dL)(e)?"free":(0,l().wb)(e)?"education":(0,l().sP)(e)?"singlePlayerPlus":(0,l().$P)(e)?"plus":(0,l().tL)(e)?"business":(0,l().OX)(e)?"enterprise":"legacy"}const p=(0,a().YK)({freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}}),g={free:{planTitle:p.freePlan},singlePlayerPlus:{planTitle:p.plusPlan},education:{planTitle:p.educationPlusPlan},plus:{planTitle:p.plusPlan},business:{planTitle:p.businessPlan},enterprise:{planTitle:p.enterprisePlan},legacy:{planTitle:p.legacyPlan}},f=(0,a().YK)({notionAI:{defaultMessage:"Notion AI",id:"notionAI.title"},removeAI:{defaultMessage:"Remove AI",id:"notionAI.remove.title"}}),b=(0,a().YK)({month:{defaultMessage:"Monthly billing",id:"billingInterval.monthly"},year:{defaultMessage:"Annual billing",id:"billingInterval.annual"}});function m(){return s().A.formatMessage(c.unableToCancelError)}function v(){return s().A.formatMessage(c.cancellationSuccess)}function h(e){var n;const t=null==e||null===(n=e.subscription)||void 0===n?void 0:n.pending;if(!t)return;const i=(0,o().PP)(e),l=(0,o().lQ)(e);return{oldTier:(0,r().Gf)(i)??"free",newTier:(0,r().Gf)(l)??"free",oldAIAddOn:(0,r().V_)(i).find((e=>"ai"===e)),newAIAddOn:(0,r().V_)(l).find((e=>"ai"===e)),oldInterval:(0,r().yw)(i),newInterval:(0,r().yw)(l),phaseOneEndDate:t.startDate}}function P(e){const n=h(e);return!(!n||!n.newInterval)&&n.oldInterval!==n.newInterval}function M(e){const n=h(e);return!!n&&n.oldTier!==n.newTier}function y(e){const n=h(e),t=[];if(!n)return{scheduledChanges:t,periodEndDate:null};const{newTier:i,oldTier:o,oldAIAddOn:r,newAIAddOn:l,oldInterval:a,newInterval:u,phaseOneEndDate:c}=n;var p,m;return o!==i&&t.push(function(e,n){const t=d(e),i=s().A.formatMessage(g[t].planTitle);if(!n)return"";const o=d(n);return`${i} → ${s().A.formatMessage(g[o].planTitle)}`}(o,i)),r!==l&&t.push((p=r,m=l,`${s().A.formatMessage(p?f.notionAI:f.removeAI)} → ${s().A.formatMessage(m?f.notionAI:f.removeAI)}`)),a!==u&&t.push(function(e,n){return e&&n?`${s().A.formatMessage("month"===e?b.month:b.year)} → ${s().A.formatMessage("month"===n?b.month:b.year)}`:""}(a,u)),{scheduledChanges:t,periodEndDate:c}}function A(e,n){if(!e)return;const t=(0,o().PP)(e).items,i=(0,o().lQ)(e).items;var r;return(0,o().HO)(t,i).some((e=>{let[t,i]=e;return(0,o().IE)(t??i)===n&&t&&!i}))?null===(r=e.subscription)||void 0===r||null===(r=r.pending)||void 0===r?void 0:r.startDate:void 0}function k(e){let{billingData:n}=e;const t=(0,u().a9)(n);if(!t)return!1;if((0,o().et)(n))return!1;const i=(0,o().bO)(t),r=(0,o().N8)(null==t?void 0:t.subscription);return!i&&!r}function I(e){const n=(0,o().V9)(e),t=(0,o().ji)(e).length>0;return!n||(!i().xd.includes(n)||!(!t||!i().iV.includes(n)))}},47273:(e,n,t)=>{t.d(n,{DS:()=>o,Fe:()=>u,GB:()=>l,Gf:()=>d,V_:()=>c,j1:()=>s,j8:()=>r,yp:()=>p,yw:()=>a});var i=()=>t(762433);function o(e){return(0,i().Fq)({subscription:e})}function r(e){return(0,i().Ry)({clock:void 0,subscription:e,trial:void 0})}function l(e){let{subscriptionState:n,logFunction:t,spaceId:o}=e;const r=g(n);return(0,i().yB)({billingData:{clock:void 0,subscription:r,trial:void 0},logFunction:t,spaceId:o})}function a(e){return(0,i().q8)({subscription:e})}function s(e){return(0,i().V9)({clock:void 0,subscription:g(e),trial:void 0})}function u(e){return(0,i().d$)({clock:void 0,subscription:g(e),trial:void 0})}function c(e){return(0,i().ji)({clock:void 0,subscription:g(e),trial:void 0})}function d(e){return(0,i().AI)({clock:void 0,subscription:g(e),trial:void 0})}function p(e,n){return(0,i().KH)({clock:void 0,subscription:g(e),trial:void 0},n)}function g(e){return e?{...e,trialEnd:void 0}:void 0}},787584:(e,n,t)=>{t.r(n),t.d(n,{default:()=>S});t(296540);var i=()=>t(484714),o=()=>t(56366),r=()=>t(807778),l=()=>t(852507);const a=(0,t(340498).xh)("blockLimit",{default:{loader:()=>t.e(77704).then(t.bind(t,477704))},small:{loader:()=>t.e(46014).then(t.bind(t,546014))},mini:{loader:()=>t.e(69062).then(t.bind(t,469062))},large:{loader:()=>t.e(31414).then(t.bind(t,531414))}});var s=()=>t(959013),u=()=>t(252105),c=()=>t(246826),d=()=>t(751156),p=()=>t(179030),g=()=>t(47170),f=()=>t(176983),b=()=>t(765957),m=()=>t(991249),v=()=>t(27716),h=()=>t(134217),P=()=>t(714300),M=()=>t(749240),y=t(474848);const A=(0,s().YK)({overFreeBlockLimitLong:{id:"subscriptionActions.overFreeBlockLimit.longMessage",defaultMessage:"You are over the block limit for the Free plan"},overFreeBlockLimitMobileNative:{id:"subscriptionActions.overFreeBlockLimit.mobileNative",defaultMessage:"Your free blocks have been used up. Unfortunately, unlimited blocks cannot be purchased on mobile."},upgradeForUnlimited:{id:"subscriptionActions.upgradeForUnlimitedBlocks.longMessage",defaultMessage:"Upgrade for unlimited"},upgradePlan:{id:"subscriptionActions.upgradePlan",defaultMessage:"Upgrade plan"},gracePeriodMessage:{id:"subscriptionActions.gracePeriodMessage",defaultMessage:"You have {dayCount, plural, one {1 day} other {{dayCount} days}} left to upgrade"},overFreeBlockLimitShort:{id:"subscriptionActions.overFreeBlockLimitShort",defaultMessage:"You've used all of this workspace's free blocks"}});function k(){const{isMobileNative:e}=(0,i().Y0)(),n=(0,i().v3)(),t=(0,o().O$)(b().AppStoreCurrentSpaceStore),r=(0,o().O$)(M().subscriptionDataStoreInstance),a=(0,f().J)();return(0,l().l)((()=>{const e=null==t?void 0:t.pointer.spaceId;if(e&&a){var i;const o=null===(i=t.getSettings())||void 0===i?void 0:i.reach_block_limit_time;!o&&r&&h().V$(n,r,e)&&d().createAndCommit({userAction:"OverFreeBlockLimitBanner.initialMount",environment:n,canUndo:!0,perform:e=>{c().zv({store:t,data:{settings:{...t.getSettings(),reach_block_limit_time:Date.now()}},transaction:e})}}),u().ab(n,{reach_block_limit_time:o??Date.now(),eligible_for_trial:!1})}})),e?(0,y.jsx)(w,{}):(0,y.jsx)(I,{})}function I(){const e=(0,s().tz)(),n=(0,i().v3)(),t=(0,o().K8)((()=>(0,r().Km)(n)),[n]),l=(0,g().O)(),u=(0,P().l)({spaceId:l}),c=(0,o().K8)((()=>(0,v().eJ)({billingData:u})),[u]),d=(0,o().K8)((()=>function(e,n){if(!n)return e.formatMessage(A.overFreeBlockLimitLong);const t=(0,r().PK)();return t>0?e.formatMessage(A.gracePeriodMessage,{dayCount:t}):e.formatMessage(A.overFreeBlockLimitShort)}(e,t)),[t,e]),f=(0,o().K8)((()=>function(e){if(!e)return"red";return(0,r().PK)()>0?"yellow":"red"}(t)),[t]),b=[{label:t?e.formatMessage(A.upgradePlan):e.formatMessage(A.upgradeForUnlimited),onClick:()=>{m().K(n,{from:"block_limit_banner",upsell:{type:"product",product:"plus",limit:{type:"none"},trialability:"none"}})}}];return(0,y.jsx)(p().l,{label:d,display:"full-width",tint:f,iconGroup:a,actions:c?b:[]})}function w(){const e=(0,s().tz)().formatMessage(A.overFreeBlockLimitMobileNative);return(0,y.jsx)(p().l,{label:e,display:"full-width",tint:"red"})}function S(){const e=(0,i().v3)();return(0,o().K8)((()=>(0,r().Km)(e)),[e])?(0,y.jsx)("div",{style:{position:"sticky",left:0,right:"100%",width:"100%"},children:(0,y.jsx)(k,{})}):(0,y.jsx)(k,{})}}}]);