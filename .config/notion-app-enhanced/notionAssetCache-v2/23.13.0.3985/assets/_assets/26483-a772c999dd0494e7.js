"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[26483],{653417:(e,t,o)=>{o.r(t),o.d(t,{TooltipWithSubtitle:()=>m,automationErrorMessages:()=>d,getErrorMessagesForActionValidationFailure:()=>f,getValidationErrorsForAction:()=>y,useErrorComponentForAction:()=>g,useRequiresSubscriptionUpgradeError:()=>T});o(898992),o(354520),o(296540);var i=()=>o(56366),r=()=>o(401497),n=()=>o(236262),a=()=>o(959013),s=()=>o(496603),l=()=>o(973647),u=()=>o(534177),c=()=>o(546461),p=o(474848);const d=(0,a().YK)({missingTargetDatabase:{id:"clientAutomationHelpers.errorMessages.missingTargetDatabase",defaultMessage:"Missing a target database"},missingNotificationCollectionPointer:{id:"clientAutomationHelpers.errorMessages.missingNotificationCollectionPointer",defaultMessage:"Missing database for property target"},missingNotificationTarget:{id:"clientAutomationHelpers.errorMessages.missingNotificationTarget",defaultMessage:"Missing notification recipients"},missingRecipients:{id:"clientAutomationHelpers.errorMessages.missingRecipients",defaultMessage:"Missing notification recipients"},missingEmailSubject:{id:"clientAutomationHelpers.errorMessages.missingEmailSubject",defaultMessage:"Missing email subject"},missingEmailBody:{id:"clientAutomationHelpers.errorMessages.missingEmailBody",defaultMessage:"Missing notification email body"},missingNotificationMessage:{id:"clientAutomationHelpers.errorMessages.missingNotificationMessage",defaultMessage:"Missing notification message"},missingNotificationPropertyId:{id:"clientAutomationHelpers.errorMessages.missingPropertyId",defaultMessage:"Missing target property"},missingNotificationFormulaValue:{id:"clientAutomationHelpers.errorMessages.missingFormulaValue",defaultMessage:"Missing recipients"},invalidNotificationFormulaValue:{id:"clientAutomationHelpers.errorMessages.invalidFormulaValue",defaultMessage:"Invalid recipients"},invalidNotificationPropertyId:{id:"clientAutomationHelpers.errorMessages.invalidPropertyId",defaultMessage:"Invalid property type"},deletedNotificationPropertyId:{id:"clientAutomationHelpers.errorMessages.deletedPropertyId",defaultMessage:"Property was deleted"},missingTargetPage:{id:"clientAutomationHelpers.errorMessages.missingTargetPage",defaultMessage:"Missing a target"},invalidTemplatePage:{id:"clientAutomationHelpers.errorMessages.invalidTemplatePage",defaultMessage:"Invalid template."},noActions:{id:"clientAutomationHelpers.errorMessages.noActions",defaultMessage:"This button has no actions"},createPageButtonError:{id:"clientAutomationHelpers.errorMessages.createPageButtonError",defaultMessage:"Add page is missing a target database"},collectionInTrashButtonError:{id:"clientAutomationHelpers.errorMessages.collectionInTrashButtonError",defaultMessage:"Target database is in trash"},collectionNotFoundButtonError:{id:"clientAutomationHelpers.errorMessages.collectionNotFoundButtonError",defaultMessage:"Target database not found"},blockInTrashButtonError:{id:"clientAutomationHelpers.errorMessages.blockInTrashButtonError",defaultMessage:"Target block is in trash"},createPageButtonTemplateError:{id:"clientAutomationHelpers.errorMessages.createPageWithTemplateError",defaultMessage:"Add page has an invalid template"},openPageOrUrlButtonError:{id:"clientAutomationHelpers.errorMessages.openPageFormOrUrlButtonError",defaultMessage:"Open page, form, or URL is missing a target"},updatePagesButtonError:{id:"clientAutomationHelpers.errorMessages.editPagesButtonError",defaultMessage:"Edit pages is missing a target database"},slackNotificationAuthenticationError:{id:"clientAutomationHelpers.errorMessages.slackNotificationError",defaultMessage:"Slack notification is missing an authentication."},slackNotificationTargetError:{id:"clientAutomationHelpers.errorMessages.slackNotificationTargetError",defaultMessage:"Slack notification is missing a target channel."},sendGmailNotificationMissingAuthenticationError:{id:"clientAutomationHelpers.errorMessages.sendGmailNotificationMissingAuthenticationError",defaultMessage:"Gmail notification is missing an authentication."},sendGmailNotificationInvalidAuthenticationError:{id:"clientAutomationHelpers.errorMessages.sendGmailNotificationInvalidAuthenticationError",defaultMessage:"Requires a re-authentication with Gmail"},missingRequiredRecordError:{id:"clientAutomationHelpers.errorMessages.missingRequiredRecordError",defaultMessage:"Action is missing access to a record"},invalidConfig:{id:"clientAutomationHelpers.errorMessages.invalidConfig",defaultMessage:"Unsupported settings"},invalidFormulaParseError:{id:"clientAutomationHelpers.errorMessages.invalidFormulaParseError",defaultMessage:"Formula contains a parsing error"},invalidFormulaTypeError:{id:"clientAutomationHelpers.errorMessages.invalidFormulaTypeError",defaultMessage:"Formula contains a type error"},invalidFormulaMissingReturnType:{id:"clientAutomationHelpers.errorMessages.invalidFormulaMissingReturnType",defaultMessage:"Formula does not have a return type"},invalidSendWebhookActionUrl:{id:"clientAutomationHelpers.errorMessages.invalidSendWebhookActionUrl",defaultMessage:"URL is invalid"},invalidSendWebhookActionCustomHeaderField:{id:"clientAutomationHelpers.errorMessages.invalidSendWebhookActionCustomHeaderField",defaultMessage:"Custom header field is invalid"},tooManyCustomHeaders:{id:"clientAutomationHelpers.errorMessages.tooManyCustomHeaders",defaultMessage:"Too many custom headers"},missingTargetVariable:{id:"clientAutomationHelpers.errorMessages.missingTargetVariable",defaultMessage:"Unable to find target variable"},crossSpaceRelation:{id:"clientAutomationHelpers.errorMessages.crossSpaceRelation",defaultMessage:"Cross-workspace features are restricted in automations and will not work"},crossSpacePropertyInFilter:{id:"clientAutomationHelpers.errorMessages.crossSpacePropertyInFilter",defaultMessage:"Filter contains a cross-workspace property"},invalidFormulaCrossSpace:{id:"clientAutomationHelpers.errorMessages.invalidFormulaCrossSpace",defaultMessage:"Cross-workspace features are restricted in automations and will not work"},requiresSubscription:{id:"clientAutomationHelpers.errorMessages.requiresSubscription",defaultMessage:"Upgrade plan or delete this step to enable the automation"},requiresSubscriptionButton:{id:"clientAutomationHelpers.errorMessages.requiresSubscriptionButton",defaultMessage:"Upgrade plan or delete connected steps to enable the button"},generalErrorMessage:{id:"clientAutomationHelpers.errorMessages.generalErrorMessage",defaultMessage:"Fix any errors or delete this step to enable this automation"},actionIncompleteErrorMessage:{id:"clientAutomationHelpers.errorMessages.actionIncompleteErrorMessage",defaultMessage:"Add a property to edit or delete this step to enable this automation"},destinationInTrashTooltip:{id:"clientAutomationHelpers.errorMessages.destinationInTrashTooltip",defaultMessage:"Restore destination or delete step to enable this automation"},destinationMissingTooltip:{id:"clientAutomationHelpers.errorMessages.destinationMissingTooltip",defaultMessage:"Add destination or delete step to enable this automation"},destinationNotFoundTooltip:{id:"clientAutomationHelpers.errorMessages.destinationNotFoundTooltip",defaultMessage:"Change destination or delete step to enable this automation"},notificationMissingCollectionPointer:{id:"clientAutomationHelpers.errorMessages.notificationMissingCollectionPointer",defaultMessage:"Change destination or delete step to enable this automation"},notificationMissingTarget:{id:"clientAutomationHelpers.errorMessages.notificationMissingTarget",defaultMessage:"Add a recipient or delete step to enable this automation"},notificationMissingRecipients:{id:"clientAutomationHelpers.errorMessages.notificationMissingRecipients",defaultMessage:"Add a recipient or delete step to enable this automation"},notificationMissingEmailSubject:{id:"clientAutomationHelpers.errorMessages.notificationMissingEmailSubject",defaultMessage:"Add an email subject or delete step to enable this automation"},notificationMissingEmailBody:{id:"clientAutomationHelpers.errorMessages.notificationMissingEmailBody",defaultMessage:"Add an email body or delete step to enable this automation"},notificationMissingMessage:{id:"clientAutomationHelpers.errorMessages.notificationMissingNotificationMessage",defaultMessage:"Add an email message or delete step to enable this automation"},notificationMissingPropertyId:{id:"clientAutomationHelpers.errorMessages.notificationMissingPropertyId",defaultMessage:"Change the target property or delete step to enable this automation"},notificationMissingFormulaValue:{id:"clientAutomationHelpers.errorMessages.notificationMissingFormulaValue",defaultMessage:"Add a recipient or delete step to enable this automation"},sendGmailMissingAccount:{id:"clientAutomationHelpers.errorMessages.sendGmailMissingAccount",defaultMessage:"Select an account to send from or delete step to enable this automation"},sendGmailMissingRecipients:{id:"clientAutomationHelpers.errorMessages.sendGmailMissingRecipients",defaultMessage:"Add recipients or delete step to enable this automation"},sendGmailMissingSubject:{id:"clientAutomationHelpers.errorMessages.sendGmailMissingSubject",defaultMessage:"Add email subject or delete step to enable this automation"},sendGmailMissingBody:{id:"clientAutomationHelpers.errorMessages.sendGmailMissingBody",defaultMessage:"Add email body or delete step to enable this automation"},templateInTrashTooltip:{id:"clientAutomationHelpers.errorMessages.templateInTrashTooltip",defaultMessage:"Restore template, select new template or delete step to enable this automation"},templateInTrashButtonError:{id:"clientAutomationHelpers.errorMessages.templateInTrashButtonError",defaultMessage:"Selected template is in trash"}});function f(e){const{failure:t}=e;if("create_page"===t.actionType){if("empty_config"===t.type)return{forAction:d.destinationMissingTooltip,forButtonTooltip:d.createPageButtonError};if("collection_not_found"===t.type)return{forAction:d.destinationNotFoundTooltip,forButtonTooltip:d.collectionNotFoundButtonError};if("missing_required_config"===t.type){if("collection"===t.key)return{forAction:d.destinationMissingTooltip,forButtonTooltip:d.createPageButtonError};(0,u().HB)(t)}else{if("invalid_optional_config"===t.type)return{forAction:d.invalidTemplatePage,forButtonTooltip:d.createPageButtonTemplateError};if("collection_in_trash"===t.type)return{forAction:d.destinationInTrashTooltip,forButtonTooltip:d.collectionInTrashButtonError,forActionIcon:n().trashIcon};if("template_in_trash"===t.type)return{forAction:d.templateInTrashTooltip,forButtonTooltip:d.templateInTrashButtonError,forActionIcon:n().trashIcon};if("invalid_formula_parse_error"===t.type)return{forAction:d.invalidFormulaParseError,forButtonTooltip:d.invalidFormulaParseError,forButtonSubtitleTooltip:void 0};if("invalid_formula_type_error"===t.type)return{forAction:d.invalidFormulaTypeError,forButtonTooltip:d.invalidFormulaTypeError,forButtonSubtitleTooltip:void 0};if("invalid_formula_missing_return_type"===t.type)return{forAction:d.invalidFormulaMissingReturnType,forButtonTooltip:d.invalidFormulaMissingReturnType,forButtonSubtitleTooltip:void 0};if("cross_space_relation"===t.type)return{forAction:d.crossSpaceRelation,forButtonTooltip:d.crossSpaceRelation,forButtonSubtitleTooltip:void 0};if("invalid_formula_cross_space"===t.type)return{forAction:d.invalidFormulaCrossSpace,forButtonTooltip:d.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};(0,u().HB)(t)}}else if("update_pages"===t.actionType)if("missing_required_config"===t.type){if("target"===t.key)return{forAction:d.destinationMissingTooltip,forButtonTooltip:d.updatePagesButtonError};if("property"===t.key)return{forAction:d.actionIncompleteErrorMessage,forButtonTooltip:d.updatePagesButtonError};(0,u().HB)(t)}else{if("collection_in_trash"===t.type)return{forAction:d.destinationInTrashTooltip,forButtonTooltip:d.collectionInTrashButtonError,forActionIcon:n().trashIcon};if("block_in_trash"===t.type)return{forAction:d.blockInTrashButtonError,forButtonTooltip:d.blockInTrashButtonError};if("invalid_formula_parse_error"===t.type)return{forAction:d.invalidFormulaParseError,forButtonTooltip:d.invalidFormulaParseError,forButtonSubtitleTooltip:void 0};if("invalid_formula_type_error"===t.type)return{forAction:d.invalidFormulaTypeError,forButtonTooltip:d.invalidFormulaTypeError,forButtonSubtitleTooltip:void 0};if("invalid_formula_missing_return_type"===t.type)return{forAction:d.invalidFormulaMissingReturnType,forButtonTooltip:d.invalidFormulaMissingReturnType,forButtonSubtitleTooltip:void 0};if("missing_target_variable"===t.type)return{forAction:d.missingTargetVariable,forButtonTooltip:d.missingTargetVariable,forButtonSubtitleTooltip:void 0};if("cross_space_relation"===t.type)return{forAction:d.crossSpaceRelation,forButtonTooltip:d.crossSpaceRelation,forButtonSubtitleTooltip:void 0};if("invalid_formula_cross_space"===t.type)return{forAction:d.invalidFormulaCrossSpace,forButtonTooltip:d.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};if("cross_space_property_in_filter"===t.type)return{forAction:d.crossSpacePropertyInFilter,forButtonTooltip:d.crossSpacePropertyInFilter,forButtonSubtitleTooltip:void 0};(0,u().HB)(t)}else if("open_page"===t.actionType)if("missing_required_config"===t.type){if("target"===t.key)return{forAction:d.destinationNotFoundTooltip,forButtonTooltip:d.openPageOrUrlButtonError};(0,u().HB)(t)}else(0,u().HB)(t);else if("slack_notification"===t.actionType)if("missing_required_config"===t.type){if("external_bot_id"===t.key)return{forAction:d.slackNotificationAuthenticationError,forButtonTooltip:d.slackNotificationAuthenticationError};if("target"===t.key)return{forAction:d.slackNotificationTargetError,forButtonTooltip:d.slackNotificationTargetError};(0,u().HB)(t)}else if("missing_required_value"===t.type){if("external_bot_id"===t.key)return{forAction:d.slackNotificationAuthenticationError,forButtonTooltip:d.slackNotificationAuthenticationError};(0,u().HB)(t)}else{if("requires_subscription_upgrade"===t.type)return{forAction:d.requiresSubscription,forButtonTooltip:d.requiresSubscriptionButton};(0,u().HB)(t)}else if("send_in_app_notification"===t.actionType)if("missing_required_config"===t.type){if("target"===t.key)return{forAction:d.notificationMissingTarget,forButtonTooltip:d.missingNotificationTarget};if("notification_message"===t.key)return{forAction:d.notificationMissingMessage,forButtonTooltip:d.missingNotificationMessage};if("collectionPointer"===t.key)return{forAction:d.notificationMissingCollectionPointer,forButtonTooltip:d.missingNotificationCollectionPointer};if("propertyId"===t.key)return{forAction:d.notificationMissingPropertyId,forButtonTooltip:d.missingNotificationPropertyId};if("formulaValue"===t.key)return{forAction:d.notificationMissingFormulaValue,forButtonTooltip:d.missingNotificationFormulaValue};(0,u().HB)(t)}else if("invalid_required_config"===t.type){if("propertyId"===t.key)return{forAction:d.invalidNotificationPropertyId,forButtonTooltip:d.invalidNotificationPropertyId};if("formulaValue"===t.key)return{forAction:d.invalidNotificationFormulaValue,forButtonTooltip:d.invalidNotificationFormulaValue};(0,u().HB)(t)}else if("deleted_required_config"===t.type){if("propertyId"===t.key)return{forAction:d.notificationMissingPropertyId,forButtonTooltip:d.deletedNotificationPropertyId};(0,u().HB)(t)}else{if("invalid_formula_parse_error"===t.type)return{forAction:d.invalidFormulaParseError,forButtonTooltip:d.invalidFormulaParseError};if("invalid_formula_type_error"===t.type)return{forAction:d.invalidFormulaTypeError,forButtonTooltip:d.invalidFormulaTypeError};if("invalid_formula_missing_return_type"===t.type)return{forAction:d.invalidFormulaMissingReturnType,forButtonTooltip:d.invalidFormulaMissingReturnType};if("invalid_formula_cross_space"===t.type)return{forAction:d.invalidFormulaCrossSpace,forButtonTooltip:d.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};(0,u().HB)(t)}else if("send_gmail_notification"===t.actionType)if("missing_required_config"===t.type){if("to"===t.key)return{forAction:d.sendGmailMissingRecipients,forButtonTooltip:d.missingRecipients};if("email_subject"===t.key)return{forAction:d.sendGmailMissingSubject,forButtonTooltip:d.missingEmailSubject};if("email_body"===t.key)return{forAction:d.sendGmailMissingBody,forButtonTooltip:d.missingEmailBody};if("formulaValue"===t.key)return{forAction:d.missingNotificationFormulaValue,forButtonTooltip:d.missingNotificationFormulaValue};if("external_bot_id"===t.key)return{forAction:d.sendGmailMissingAccount,forButtonTooltip:d.sendGmailNotificationMissingAuthenticationError};(0,u().HB)(t)}else if("invalid_required_config"===t.type){if("to"===t.key)return{forAction:d.invalidNotificationFormulaValue,forButtonTooltip:d.invalidNotificationFormulaValue};if("cc"===t.key)return{forAction:d.invalidNotificationFormulaValue,forButtonTooltip:d.invalidNotificationFormulaValue};if("bcc"===t.key)return{forAction:d.invalidNotificationFormulaValue,forButtonTooltip:d.invalidNotificationFormulaValue};if("reply_to"===t.key)return{forAction:d.invalidNotificationFormulaValue,forButtonTooltip:d.invalidNotificationFormulaValue};if("external_bot_id"===t.key)return{forAction:d.sendGmailNotificationInvalidAuthenticationError,forButtonTooltip:d.sendGmailNotificationInvalidAuthenticationError};(0,u().HB)(t)}else{if("invalid_formula_parse_error"===t.type)return{forAction:d.invalidFormulaParseError,forButtonTooltip:d.invalidFormulaParseError};if("invalid_formula_type_error"===t.type)return{forAction:d.invalidFormulaTypeError,forButtonTooltip:d.invalidFormulaTypeError};if("invalid_formula_missing_return_type"===t.type)return{forAction:d.invalidFormulaMissingReturnType,forButtonTooltip:d.invalidFormulaMissingReturnType};if("invalid_formula_cross_space"===t.type)return{forAction:d.invalidFormulaCrossSpace,forButtonTooltip:d.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};if("requires_subscription_upgrade"===t.type)return{forAction:d.requiresSubscription,forButtonTooltip:d.requiresSubscriptionButton};(0,u().HB)(t)}else if("define_variables"===t.actionType){if("invalid_formula_parse_error"===t.type)return{forAction:d.invalidFormulaParseError,forButtonTooltip:d.invalidFormulaParseError,forButtonSubtitleTooltip:void 0};if("invalid_formula_type_error"===t.type)return{forAction:d.invalidFormulaTypeError,forButtonTooltip:d.invalidFormulaTypeError,forButtonSubtitleTooltip:void 0};if("invalid_formula_missing_return_type"===t.type)return{forAction:d.invalidFormulaMissingReturnType,forButtonTooltip:d.invalidFormulaMissingReturnType,forButtonSubtitleTooltip:void 0};if("invalid_formula_cross_space"===t.type)return{forAction:d.invalidFormulaCrossSpace,forButtonTooltip:d.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};(0,u().HB)(t)}else if("http_request"===t.actionType){if("invalid_url"===t.type)return{forAction:d.invalidSendWebhookActionUrl,forButtonTooltip:d.invalidSendWebhookActionUrl};if("empty_custom_header_field"===t.type)return{forAction:d.invalidSendWebhookActionCustomHeaderField,forButtonTooltip:d.invalidSendWebhookActionCustomHeaderField};if("requires_subscription_upgrade"===t.type)return{forAction:d.requiresSubscription,forButtonTooltip:d.requiresSubscriptionButton};if("too_many_custom_headers"===t.type)return{forAction:d.tooManyCustomHeaders,forButtonTooltip:d.tooManyCustomHeaders};(0,u().HB)(t)}else if("modal_confirmation"===t.actionType){if("invalid_formula_parse_error"===t.type)return{forAction:d.invalidFormulaParseError,forButtonTooltip:d.invalidFormulaParseError};if("invalid_formula_type_error"===t.type)return{forAction:d.invalidFormulaTypeError,forButtonTooltip:d.invalidFormulaTypeError};if("invalid_formula_missing_return_type"===t.type)return{forAction:d.invalidFormulaMissingReturnType,forButtonTooltip:d.invalidFormulaMissingReturnType};if("invalid_formula_cross_space"===t.type)return{forAction:d.invalidFormulaCrossSpace,forButtonTooltip:d.invalidFormulaCrossSpace,forButtonSubtitleTooltip:void 0};(0,u().HB)(t)}else if("publish_site"===t.actionType)if("missing_required_config"===t.type){if("target"===t.key)return{forAction:d.missingTargetDatabase,forButtonTooltip:d.updatePagesButtonError};(0,u().HB)(t)}else{if("missing_target_variable"===t.type)return{forAction:d.missingTargetVariable,forButtonTooltip:d.missingTargetVariable,forButtonSubtitleTooltip:void 0};if("invalid_context_value_type"===t.type)return{forAction:d.invalidFormulaTypeError,forButtonTooltip:d.invalidFormulaTypeError};(0,u().HB)(t)}else(0,u().HB)(t)}function g(e){const{actionId:t,shouldShow:o,errorKey:r,errorKeys:n}=e,{typecheckResult:l}=(0,c().YC)();return(0,i().K8)((()=>{if(!o||!l)return{errorMessage:void 0,errorIcon:void 0,errorMessageDescriptor:void 0};let e=y(l,t);(r||n)&&(e=e.filter((e=>"key"in e&&(e.key===r||(null==n?void 0:n.includes(e.key))))));const i=(0,s().$1)(e);if(!i)return{errorMessage:void 0,errorIcon:void 0,errorMessageDescriptor:void 0};const u=f({failure:i});return{errorMessage:(0,p.jsx)(m,{content:(0,p.jsx)(a().sA,{...u.forAction})}),errorIcon:u.forActionIcon,errorMessageDescriptor:u.forAction}}),[o,l,t,r,n])}function m(e){const{content:t,subtitle:o}=e,i=(0,r().IS)((e=>({wrap:{display:"flex",flexDirection:"column",alignItems:"center"},subtitle:{color:e.text.contrastSecondary}})),[]);return(0,p.jsxs)("div",{style:i.wrap,children:[(0,p.jsx)("div",{children:t}),o&&(0,p.jsx)("div",{style:i.subtitle,children:o})]})}function y(e,t){return l().Q.isFail(e)?[]:e.value.actionValidationFailures[t]??[]}function T(e){const{shouldShow:t,actionId:o}=e,{typecheckResult:r}=(0,c().YC)();return(0,i().K8)((()=>{if(!t||!r)return;const e=y(r,o).filter((e=>"requires_subscription_upgrade"===e.type)),i=(0,s().$1)(e);if(!i)return;const n=f({failure:i});return(0,p.jsx)(a().sA,{...n.forAction})}),[t,r,o])}},726483:(e,t,o)=>{o.d(t,{A8:()=>h,B0:()=>V,EN:()=>P,EZ:()=>R,Gz:()=>I,Qn:()=>B,RN:()=>k,TT:()=>E,_T:()=>q,aS:()=>C,bI:()=>b,iX:()=>N,l:()=>H,rc:()=>F});o(16280),o(898992),o(823215),o(354520),o(581454),o(737550);var i=o.n(o(844751)),r=()=>o(422540),n=()=>o(352271),a=()=>o(289915),s=()=>o(970013),l=()=>o(537012),u=()=>o(977345),c=()=>o(206267),p=()=>o(273900),d=()=>o(519831),f=()=>o(919709),g=()=>o(496603),m=()=>o(973647),y=()=>o(534177),T=()=>o(653417),_=()=>o(217429),v=()=>o(630116),M=()=>o(329304),A=()=>o(852353),S=()=>o(731320);function B(e){const{automationStore:t,collectionStore:o,typecheckResult:i}=e,n=o.getSchema(),a=t.getKeyStore("properties").getKeyStore("name").getValue();if(null==a||!a.trim())return!1;if(!(0,r().aE)({automationTrigger:t.getTrigger(),collectionSchema:n}))return!1;const s=t.getActionStores().filter((e=>e.isDefined()));return 0!==s.length&&s.every((e=>b({actionStore:e,collectionStore:o,typecheckResult:i})))}function b(e){const{actionStore:t,collectionStore:o,typecheckResult:i}=e;if((0,T().getValidationErrorsForAction)(i,t.id).length>0)return!1;if(t.isType("slack_notification"))return(0,y().O9)(t.getConfigStore().getKeyStore("external_bot_id").getValue())&&(0,y().O9)(t.getConfigStore().getKeyStore("target").getValue());if(t.isType("send_gmail_notification")){const e=t.getConfigStore(),o=e.getKeyStore("to").getValue(),i=e.getKeyStore("email_subject").getValue(),r=e.getKeyStore("email_body").getValue();return!(!i||!r||(0,f().w9s)(i.value)||(0,f().w9s)(r.value))&&!(!(o&&o.value&&o.value.value)||g().Im(o.value.value))}if(t.isType("update_pages")){const e=t.getConfigStore().getKeyStore("target").getValue(),n=t.getConfigStore().getKeyStore("properties").getValue()??[];if(!(0,y().O9)(e)||0===n.length)return!1;if("collection"===e.type){const t=v().md.createChildStore(o,e.collection).getSchema();if(n.some((e=>(0,r().PP)({property:e,collectionSchema:t})||(0,r().TK)({collectionSchema:t,property:e,type:"action"}))))return!1}else if("variable"===e.type){const a=(0,u().y5)(e.id);if("global"===a.source&&"button_page"===a.global){const e=o.getSchema();if(n.some((t=>(0,r().PP)({property:t,collectionSchema:e})||(0,r().TK)({collectionSchema:e,property:t,type:"action"}))))return!1}else{if(m().Q.isFail(i))return!1;const o=(0,u().IV)(i.value.valueTypes,e.id),a=o?h(o,t):void 0;if(!a)return!1;const s=a.getSchema();if(n.some((e=>(0,r().PP)({property:e,collectionSchema:s})||(0,r().TK)({collectionSchema:s,property:e,type:"action"}))))return!1}}else{if("page"===e.type)return!1;(0,y().HB)(e)}return!0}if(t.isType("create_page")){const e=t.getConfigStore().getKeyStore("collection").getValue();if(!(0,y().O9)(e))return!1;const i=v().md.createChildStore(o,e).getSchema();return!(t.getConfigStore().getKeyStore("properties").getValue()??[]).some((e=>(0,r().PP)({property:e,collectionSchema:i})||(0,r().TK)({collectionSchema:i,property:e,type:"action"})))}if(t.isType("send_in_app_notification")){const e=t.getConfigStore(),o=e.getKeyStore("target").getValue(),i=e.getKeyStore("notification_message").getValue();if(!o||!i||(0,f().w9s)(i.value))return!1;switch(o.type){case"property":if(!o.propertyId||!o.collectionPointer)return!1;break;case"formula":if(!o.value||!o.value.value||g().Im(o.value.value))return!1}return!0}if(t.isType("define_variables"))return!0;if(t.isType("http_request"))return!0;if(t.isType("publish_site")){const e=t.getConfigStore().getKeyStore("target").getValue();return!!(0,y().O9)(e)}throw new Error(`isActionStoreComplete not implemented for ${t.getType()}`)}function h(e,t){let o;return"block"===e.type.type&&e.type.collection?o=v().md.createChildStore(t,e.type.collection):"array"===e.type.type&&"block"===e.type.of.type&&e.type.of.collection&&(o=v().md.createChildStore(t,e.type.of.collection)),o}function F(e){const{collectionStore:t}=e;if(!t||(0,S().qe)(t)||(0,S().X6)(t))return!1;const o=(0,M().zD)(t.environment,{name:"premium_automations",spaceId:t.getSpaceId(),userId:t.userId});if(!(0,M().zD)(t.environment,{name:"slack_automation_action",spaceId:t.getSpaceId(),userId:t.userId}))return!1;if((t.getFormat().automation_ids??[]).length>=n().tu&&!o)return!1;const i=t.pointer,r=t.getSpaceId();return(0,l().rM)({targetTriggerType:"event",targetParentPointer:i,targetSpaceId:r}).every((e=>{let{pointer:o,minimumRequiredRole:i}=e;const r=t.getRecordRole(o);return!!r&&(0,p().q_)(r,i)}))}function E(e){const{automationStore:t,actionStores:o,collectionStore:i}=e,r=t.getParentStore();if(!r||(0,S().qe)(r)||(0,S().X6)(i))return!1;const n=t.getMinimumFieldsForPermissions();if(!n)return!1;if(!o.every((e=>e.isDefined())))return!1;const a=o.some((e=>!e.isType("slack_notification")));if(!(0,M().zD)(i.environment,{name:"premium_automations",spaceId:i.getSpaceId(),userId:i.userId})&&a)return!1;return(0,l().Ls)({automationValue:n,actionValues:o.map((e=>({config:e.getConfig(),type:e.getType()})))}).every((e=>{let{pointer:o,minimumRequiredRole:i}=e;const r=t.getRecordRole(o);return!!r&&(0,p().q_)(r,i)}))}function I(e){const{automationStore:t,collectionStore:o}=e,i=t.getParentStore();if(!i||(0,S().qe)(i)||(0,S().X6)(o))return!1;const r=t.getMinimumFieldsForPermissions();if(!r)return!1;return(0,l().yx)(r).every((e=>{let{pointer:o,minimumRequiredRole:i}=e;const r=t.getRecordRole(o);return!!r&&(0,p().q_)(r,i)}))}function H(e){const{automationStore:t,collectionStore:o}=e;if(!t.isTriggerType("event"))return!1;const i=t.getEventConfiguration();if(!i||void 0===i.source||i.source.type===d().Vl||"filter"===i.source.type)return!1;const r=v().pS.createChildStore(o,i.source.pointer);return function(e){const t=k(e),o=P(e);return(0,y().O9)(t)||(0,y().O9)(o)}({collectionSchema:o.getSchema(),collectionViewStore:r})}function P(e){var t;const{collectionViewStore:o,collectionSchema:i}=e,r=o.getPropertyFiltersStore().getValue()??[],n=null===(t=o.getQuery(i))||void 0===t?void 0:t.filter,l={operator:"and",filters:(0,a().rg)({propertyFilters:r,combinatorFilter:n,schema:i})},u=(0,a().CU)(l,(e=>{if((0,a().yX)(e)){const t=i[e.property];return!!t&&(0,s().CH)(o.getSpaceId(),t,i)}return!1}));if(u)return(0,a().yX)(u)?u.property:void 0}function k(e){var t;const{collectionViewStore:o,collectionSchema:i}=e,n=o.getPropertyFiltersStore().getValue()??[],s=null===(t=o.getQuery(i))||void 0===t?void 0:t.filter,l={operator:"and",filters:(0,a().rg)({propertyFilters:n,combinatorFilter:s,schema:i})},u=(0,a().CU)(l,(e=>{if((0,a().yX)(e)){const t=i[e.property];return!!t&&!(0,r().Kj)(t)}return!1}));if(u)return(0,a().yX)(u)?u.property:(0,a().LB)(u)?u.timestamp:void 0}function C(e){if("collectionTypedView"===e.contextType)return!1;const t=e.collectionStore();return!!t&&(!(t.isExternallyImportedAndSyncedCollection()||t.isSyncedCollection()&&!_().default.checkGate({gateName:"support_synced_database_automations"}))&&void 0===e.viewsModuleContextStore.state)}function N(e){const{collectionSchema:t,propertyIds:o,searchTerm:r}=e;if(!r)return o.slice(0);const n=new Map,a=o.map((e=>{const o=t[e],i=o?`${o.name} ${A().dC[o.type]}`:"";return n.set(e,i),i})),s=i().filter(r,a).map((e=>{let{original:t}=e;return t}));return o.filter((e=>s.includes(n.get(e)??"")))}function V(e){return{pagesAdded:!1,pagePropertiesEdited:{type:"none"},source:{pointer:e.getSpaceShardedPointer(),type:d().Vl}}}function R(e){const{automationId:t,automationName:o,collectionStore:i,userId:r}=e;return function(e){const{actionIds:t,automationId:o,collectionStore:i,eventConfiguration:r,lastEditedTime:n,properties:a,userId:s}=e,l=Date.now();return{action_ids:t,alive:!0,created_by_id:s,created_by_table:"notion_user",created_time:l,id:o,last_edited_by_id:s,last_edited_by_table:"notion_user",last_edited_time:n??l,parent_id:i.id,parent_table:d().Vl,properties:a??{},space_id:i.getSpaceId(),status:"active",trigger:{event:r,id:c().JW(),type:"event"},version:1}}({actionIds:[],automationId:t,collectionStore:i,eventConfiguration:V(i),properties:{name:o},userId:r})}function q(e){const{tab:t}=e;return!!t&&("automationSettings"===t.type||"mobileCreateAutomation"===t.type||"mobileEditAutomation"===t.type||"mobileEditButtonAutomation"===t.type)}}}]);