"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[6463],{170356:(e,t,o)=>{o.d(t,{NS:()=>p,Pq:()=>f,Z3:()=>d,sw:()=>u});o(296540);var n=()=>o(484714),r=()=>o(297872),l=()=>o(928600),i=()=>o(678553),a=()=>o(480095),s=()=>o(722872),c=o(474848);const d=8,p=8,u=32,x={height:u+d-2,paddingTop:d-2};function f(e){let{title:t,helpButton:o,onCancel:i,desktopMinWidth:d,desktopMaxWidth:p,desktopWidth:u,children:x}=e;const{device:f}=(0,n().v3)();return(0,c.jsx)(r().A,{capture:!0,allowEsc:!0,allowUndo:!0,render:e=>{let n;return n=f.isMobile?{menuType:s().gu.Modal,title:t,right:(0,c.jsx)(a().DoneMenuText,{}),onClickRight:i,...e}:{menuType:s().gu.Popup,...d&&{minWidth:d},...p&&{maxWidth:p},...u&&{width:u},...e},(0,c.jsx)(l().A,{...n,header:t&&(0,c.jsx)(h,{title:t,helpButton:o}),children:x})}})}function h(e){let{title:t,helpButton:o}=e;return(0,n().v3)().device.isMobile?null:(0,c.jsx)(i().Ay,{style:x,title:t,right:o})}},653048:(e,t,o)=>{o.d(t,{Ay:()=>Q,Rf:()=>J,tF:()=>q});o(898992),o(354520),o(581454);var n=o(296540),r=()=>o(484714),l=()=>o(56366),i=()=>o(401497),a=()=>o(764880),s=()=>o(289915),c=()=>o(970013),d=()=>o(713998),p=()=>o(784892),u=()=>o(597777),x=()=>o(681873),f=()=>o(799829),h=()=>o(437607),g=()=>o(959013),m=()=>o(534177),y=()=>o(284371),v=()=>o(436696),S=()=>o(755022),j=()=>o(170356),C=()=>o(780054),b=()=>o(205098),w=()=>o(722872),M=()=>o(685889),A=()=>o(963589),V=()=>o(630116),T=()=>o(870988),F=()=>o(859794),_=()=>o(448061),P=()=>o(972435),I=()=>o(44935),k=()=>o(297872),R=()=>o(623580),O=()=>o(419357),z=o(474848);const B=(0,g().YK)({value:{defaultMessage:"Value",id:"database.filterAndSort.propertyValueInput.placeholder"}});function G(e){let{value:t,onChange:o}=e;const{device:l}=(0,r().v3)(),a=(0,n.useRef)(null),[s,c]=(0,n.useState)(!1),d=(0,n.useCallback)((()=>c(!0)),[c]),p=(0,n.useCallback)((()=>c(!1)),[c]),u=(0,n.useCallback)((e=>{o(e.target.value)}),[o]),x=(0,n.useCallback)((()=>{if(a.current){var e;(null===(e=window)||void 0===e?void 0:e.document.activeElement)===a.current&&a.current.blur(),p()}}),[p]),f=(0,i().IS)((e=>({focused:{background:e.buttonHoveredBackground},unfocused:{background:"transparent"}})),[]),h=t||"";return(0,z.jsx)("div",{style:{display:"flex",margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},onClick:d,children:l.isMobile?(0,z.jsx)(O().Ay,{value:h,onChange:u,placeholder:P().A.formatMessage(B.value),onBlur:p,rightMobileEditLabel:(0,z.jsx)(g().sA,{defaultMessage:"Edit",id:"database.filterAndSort.mobileEditButton.label"})}):(0,z.jsx)(I().H,{action:d,render:e=>(0,z.jsx)("div",{ref:e.ref,onMouseEnter:e.onMouseEnter,style:{...e.focused&&!s?f.focused:f.unfocused,margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,z.jsx)(k().A,{capture:s,render:e=>(0,z.jsx)("div",{...e,style:{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,z.jsx)(R().A,{focus:s,ref:a,value:h,onChange:u,placeholder:P().A.formatMessage(B.value),onBlur:p,onCancel:x,style:{marginRight:8,paddingLeft:6,paddingRight:0,width:80,height:30,...{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},minWidth:T().G$}})})})})})})}var D=()=>o(760217),U=()=>o(406699),Y=()=>o(73332),K=()=>o(933117),L=()=>o(448693),$=()=>o(27356),X=()=>o(654734),H=()=>o(272630),W=()=>o(566081),E=()=>o(903400),N=()=>o(399762);const Z=(0,g().YK)({dateTitle:{defaultMessage:"Date",id:"database.filterMenu.mobileDateSelectMenu.title"},emptyPlaceholder:{defaultMessage:"Empty",id:"database.filterMenu.dateSelectMenu.emptyPlaceholder"}});function q(e){return e?(0,z.jsx)(g().sA,{defaultMessage:"Select one person",id:"database.personPropertyValue.selectPerson.searchPlaceholderWithLimit"}):(0,z.jsx)(g().sA,{defaultMessage:"Select one or more people",id:"database.personPropertyValue.selectPerson.searchPlaceholder"})}function J(e){return e?(0,z.jsx)(g().sA,{defaultMessage:"Select one group",id:"database.personPropertyValue.selectGroup.searchPlaceholderWithLimit"}):(0,z.jsx)(g().sA,{defaultMessage:"Select one or more groups",id:"database.personPropertyValue.selectGroup.searchPlaceholder"})}const Q=function(e){let{schema:t,property:n,parentStore:l,filter:i,collectionViewId:a,filterValueType:c,onChange:d,collectionContextStore:p,collectionViewType:u}=e;const x=(0,r().v3)(),f=(0,g().tz)(),h=(0,z.jsx)("span",{});if("date"===c)return(0,s().nM)(i)?(0,s().fZ)(i)?h:(0,s().Cw)(i)?(0,z.jsx)(se,{intl:f,parentStore:l,schema:t,collectionViewId:a,property:n,onChange:d,collectionContextStore:p,collectionViewType:u,filter:i}):(0,z.jsx)(ae,{intl:f,collectionViewId:a,property:n,schema:t,parentStore:l,onChange:d,collectionContextStore:p,collectionViewType:u,filter:i}):h;if("text"===c){if(!(0,s().YH)(i))return h;const e=i;if((0,s().fZ)(e))return h;if("string_has_no_alphabet_prefix"===e.operator)return null;const t=e.value;return(0,z.jsx)(G,{value:t.value,onChange:t=>{const o={type:"exact",value:t},n={...e,value:o};d(n)}})}if("number"===c){if(!(0,s().My)(i))return h;const e=i;if((0,s().fZ)(e))return h;const t=e.value;return(0,z.jsx)(G,{value:void 0===t.value?"":t.value.toString(),onChange:t=>{const n={type:"exact",value:(0,o(668766).q)(t,f)},r={...e,value:n};d(r)}})}if("checkbox"===c){if(!(0,s().Ui)(i)||!a)return h;const e=i,o=e.value;return(0,z.jsx)(U().Ay,{popupType:x.device.isMobile?U().z7.SlideUp:U().z7.Popup,renderOrigin:e=>(0,z.jsx)(oe,{operatorValue:o,events:e}),render:o=>(0,z.jsx)(F().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:F().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:p})})}if("select"===c||"multi_select"===c||"status"===c){if(!((0,s().v0)(i)||(0,s().as)(i)||(0,s().H$)(i))||!a)return h;const e=i;if((0,s().fZ)(e))return h;const o=t[n];if(!o)return h;const r=(0,s().v0)(e)?(0,s().Zl)(e):(0,s().as)(e)?(0,s().SM)(e):(0,s().Wc)(o,(0,s().V6)(e));return(0,z.jsx)(U().Ay,{popupType:x.device.isMobile?U().z7.SlideUp:U().z7.Popup,renderOrigin:e=>(0,z.jsx)(ie,{schema:t,property:n,operatorValues:r,events:e}),render:o=>(0,z.jsx)(F().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:F().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:p})})}if("location"===c){if(!(0,s().G)(i))return h;const e=i,o=(0,s().GK)(e);return(0,z.jsx)(U().Ay,{popupType:x.device.isMobile?U().z7.SlideUp:U().z7.Popup,renderOrigin:e=>(0,z.jsx)(re,{parentStore:l,operatorValues:o,events:e}),render:o=>(0,z.jsx)(F().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:F().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:p})})}if("relation"===c){if(!(0,s().Pq)(i)||!a)return h;const e=i;if((0,s().fZ)(e))return h;const o=(0,s().Rh)(e);return(0,z.jsx)(U().Ay,{popupType:x.device.isMobile?U().z7.SlideUp:U().z7.Popup,renderOrigin:e=>(0,z.jsx)(pe,{parentStore:l,operatorValues:o,events:e,schema:t,property:n}),render:o=>(0,z.jsx)(F().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:F().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:p})})}if("person"===c){if(!(0,s().I_)(i)||!a)return h;const e=i;if((0,s().fZ)(e))return h;const o=(0,s().Wf)(e);return(0,z.jsx)(U().Ay,{popupType:x.device.isMobile?U().z7.SlideUp:U().z7.Popup,renderOrigin:e=>(0,z.jsx)(de,{parentStore:l,operatorValues:o,events:e}),render:o=>(0,z.jsx)(F().td,{collectionViewId:a,propertyFilter:{property:n,filter:e},schema:t,onChange:e=>{d(e)},onClose:o.close,parentStore:l,context:F().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:p})})}if("file"===c){if(!(0,s().B6)(i))return h;const e=i;if((0,s().fZ)(e))return h;(0,m().HB)(e)}if("verification"===c)return(0,s().uU)(i)?(0,z.jsx)(U().Ay,{popupType:x.device.isMobile?U().z7.SlideUp:U().z7.Popup,renderOrigin:e=>(0,z.jsx)(ne,{operatorValues:(0,s().ms)(i),events:e}),render:e=>(0,z.jsx)(F().td,{collectionViewId:a,propertyFilter:{property:n,filter:i},schema:t,onChange:e=>{d(e)},onClose:e.close,parentStore:l,context:F().mL.AdvancedFilter,allowRelativePersonFilter:!1,collectionContextStore:p})}):h;if("place"===c){if(!(0,s().Ol)(i))return h;const e=i;if((0,s().fZ)(e))return h;(0,m().HB)(e)}(0,m().HB)(c)};function ee(){return{maxWidth:T().tv}}function te(e){return{paddingTop:e?6:void 0,overflow:"hidden"}}function oe(e){let{operatorValue:t,events:o}=e;const n=null==t?void 0:t.value;return(0,z.jsx)(H().A,{...o,disableMargins:!0,placeholder:(0,z.jsx)(g().sA,{defaultMessage:"Select a value",id:"database.filterOperatorValue.checkboxPlaceholder.title"}),title:"boolean"==typeof n&&(0,z.jsx)(Y().T,{checked:n,size:16,disabled:!0})})}function ne(e){let{operatorValues:t,events:o}=e;const n=t.filter((e=>{let{value:t}=e;return Boolean(t)})).map(b().w0);return(0,z.jsx)(H().A,{...o,disableMargins:!0,placeholder:(0,z.jsx)(g().sA,{defaultMessage:"Select an option",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.placeholder"}),title:n.length&&(0,z.jsx)("span",{children:(0,x().A)(n,(e=>(0,z.jsx)("span",{style:{whiteSpace:"pre"},children:(0,z.jsx)(g().sA,{defaultMessage:", ",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.commaSeparator"})},e)))})})}function re(e){let{operatorValues:t,events:o,parentStore:n}=e;return(0,z.jsx)(H().A,{...o,disableMargins:!0,desktopStyle:ee(),innerStyle:te(t.length>0),placeholder:(0,z.jsx)(g().sA,{defaultMessage:"Select a location",id:"databaseLocationOperators.selectPlaceholder"}),title:t.length>0&&t.map((e=>e.value&&(0,z.jsx)("div",{style:{margin:"0 10px 6px 0"},children:(0,z.jsx)(_().A,{collectionStore:V().md.createChildStore(n,{table:"collection",id:e.value})})},e.value)))})}function le(e){let{operatorValue:t,events:o,isRange:n,schema:r,property:l}=e;const i=r[l],a=i&&"date"===i.type?i.date_format:void 0;let s;if("exact"===t.type&&t.value)if((0,u().$P)(t.value))s=t.value;else if((0,u().jS)(t.value)){const e=(0,u().dq)(t.value);e&&(s=e.value)}return(0,z.jsx)(H().A,{...o,placeholder:n?(0,z.jsx)(g().sA,{defaultMessage:"Select a range",id:"database.filterAndSort.dateRangePropertyValue.placeholder"}):(0,z.jsx)(g().sA,{defaultMessage:"Select a date",id:"database.filterAndSort.datePropertyValue.placeholder"}),desktopStyle:{minWidth:165},title:s&&(0,z.jsx)("span",{style:{...y().RC},children:(0,z.jsx)(X().A,{value:s,dateFormat:a||u().vz})}),disableMargins:!0})}function ie(e){let{operatorValues:t,events:o,schema:n,property:l}=e;const i=(0,r().v3)(),{device:a}=i,s=n[l],u=s&&((0,c().lx)(s)||"status"===s.type)&&s.options||[];return(0,z.jsx)(H().A,{...o,disableMargins:!0,desktopStyle:ee(),innerStyle:te(t.length>0),placeholder:(0,z.jsx)(g().sA,{defaultMessage:"Select an option",id:"collections.operatorValueSelect.placeholder"}),title:t.length>0&&(0,z.jsx)(z.Fragment,{children:t.map((e=>{if(void 0===e.value)return null;const t=(0,d().jy)(u,e.value);return t?(0,z.jsx)(N().O,{format:a.isMobile?p().NY.Large:p().NY.Medium,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!1},e.value):null}))})})}function ae(e){let{filter:t,intl:o,collectionViewId:n,property:l,schema:i,parentStore:a,onChange:c,collectionContextStore:d,collectionViewType:p}=e;const u=(0,A().X)("db_ux_mobile"),{isPhone:x}=(0,r().Y0)(),f=(0,r().v3)();if(!n)return null;const h={menuTitle:o.formatMessage(Z.dateTitle),items:s().ty,getKey:e=>"relative"===e.type?e.value:e.type,selectedItem:t.value,onSelect:e=>{const o={...t,value:e};c(o),d?(0,v().X)({environment:f,collectionContextStore:d,action:"set_filter_value_type"}):(0,S().D)(f,{view_type:p,action:"set_filter_value_type"})},renderItem:e=>(0,z.jsx)(D().A,{title:(0,b().RR)(e.value),...e}),renderOrigin:e=>(0,z.jsx)(H().A,{...e,disableMargins:!0,placeholder:o.formatMessage(Z.emptyPlaceholder),title:(0,b().RR)(t.value)})},m=t.value;if("exact"===m.type){const e=(0,z.jsx)(g().sA,{id:"collectionFilterMenuFilterOperatorValue.date.exact.order",defaultMessage:"{exact}{dateValue}",values:{exact:(0,z.jsx)(K().A,{...h,menuTypeOverride:(0,w().PK)(x,u)},"date-filter-value-type"),dateValue:(0,z.jsx)(U().Ay,{popupType:f.device.isMobile?U().z7.SlideUp:U().z7.Popup,renderOrigin:e=>(0,z.jsx)(le,{schema:i,property:l,operatorValue:m,events:e,isRange:!1}),render:e=>(0,z.jsx)(F().td,{collectionViewId:n,propertyFilter:{property:l,filter:t},schema:i,onChange:e=>{c(e)},onClose:e.close,parentStore:a,context:F().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:d})})}}),o=f.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:j().NS,width:"100%"}:void 0;return(0,z.jsx)("div",{style:o,children:e})}return(0,z.jsx)(K().A,{...h,menuTypeOverride:(0,w().PK)(x,u)},"date-filter-value-type")}function se(e){let{filter:t,intl:o,parentStore:n,schema:l,collectionViewId:i,property:a,onChange:c,collectionContextStore:d,collectionViewType:p}=e;const u=(0,A().X)("db_ux_mobile"),{isPhone:x}=(0,r().Y0)(),f=(0,r().v3)();if(!i)return null;const h={menuTitle:o.formatMessage(Z.dateTitle),items:(0,s().jw)(),getKey:e=>(0,s().q5)(e),selectedItem:t.value,onSelect:e=>{const o={...t,value:e};c(o),d?(0,v().X)({environment:f,collectionContextStore:d,action:"set_filter_value_type"}):(0,S().D)(f,{view_type:p,action:"set_filter_value_type"})},renderItem:e=>(0,z.jsx)(D().A,{title:(0,b().kz)(e.value),...e}),renderOrigin:e=>(0,z.jsx)(H().A,{...e,disableMargins:!0,placeholder:o.formatMessage(Z.emptyPlaceholder),title:(0,b().kz)(t.value)})},m=t.value;if("exact"===m.type){const e=(0,z.jsx)(g().sA,{id:"collectionFilterMenuFilterOperatorValue.dateRange.exact.order",defaultMessage:"{dateValue}",values:{exact:(0,z.jsx)(K().A,{...h,menuTypeOverride:(0,w().PK)(x,u)},"date-filter-value-type"),dateValue:(0,z.jsx)(U().Ay,{popupType:f.device.isMobile?U().z7.SlideUp:U().z7.Popup,renderOrigin:e=>(0,z.jsx)(le,{schema:l,property:a,operatorValue:m,events:e,isRange:!0}),render:e=>(0,z.jsx)(F().td,{collectionViewId:i,propertyFilter:{property:a,filter:t},schema:l,onChange:e=>{c(e)},onClose:e.close,parentStore:n,context:F().mL.AdvancedFilter,allowRelativePersonFilter:!0,collectionContextStore:d})})}}),o=f.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:j().NS,width:"100%"}:void 0;return(0,z.jsx)("div",{style:o,children:e})}return"relative"!==m.type||"custom"!==m.value&&"surrounding"!==m.value?(0,z.jsx)(K().A,{...h,menuTypeOverride:(0,w().PK)(x,u)},"date-filter-value-type"):(0,z.jsx)(E().i,{renderAsQueryDropdown:f.device.isMobile,filter:m,onUpdate:e=>{const o={...t,value:e};c(o),d?(0,v().X)({environment:f,collectionContextStore:d,action:"set_filter_value_type"}):(0,S().D)(f,{view_type:p,action:"set_filter_value_type"})}})}function ce(e){var t;let{operatorValue:o,parentStore:n}=e;const i=(0,r().v3)(),{device:s}=i,c=(0,l().K8)((()=>o.value&&("relative"!==o.type||"me"!==o.value)&&(0,a().Pu)(o.value)?(0,a().xC)({pointer:o.value,getRecordValue:n.getRecordValue}):void 0),[o,n]),d=(0,A().X)("group_mentions_in_person_property_values");if(!o.value)return null;if("me"!==o.value&&o.value.table===h().n&&d){const e=(0,h().bj)({spacePermissionGroupId:o.value.id,spaceId:o.value.spaceId});return(0,z.jsx)($().UISpacePermissionGroupToken,{parentStore:n,groupPointer:e,isSingle:!1,shouldShrink:!1,format:C().A.isMobile?L().t_.Format.Large:L().t_.Format.Medium,showRemoveButton:!1},e.id)}return"relative"===o.type&&"me"===o.value?(0,z.jsx)("span",{style:{marginTop:1,marginRight:10,marginBottom:6},children:(0,z.jsx)(g().sA,{defaultMessage:"Me",id:"database.filterAndSort.firstPersonPropertyValue.title"},"relative")}):c?(0,z.jsx)(L().Ay,{actor:c,isSingle:!1,shouldShrink:!1,format:s.isMobile?L().t_.Format.Large:L().t_.Format.Medium,showRemoveButton:!1,hasPersonHoverCard:!1},null===(t=c.asActor)||void 0===t?void 0:t.id):null}function de(e){let{operatorValues:t,events:o,parentStore:n}=e;return(0,z.jsx)(H().A,{...o,placeholder:q(void 0),disableMargins:!0,desktopStyle:ee(),innerStyle:te(t.length>0),title:t.length>0&&t.map((e=>{var t;return(0,z.jsx)(ce,{operatorValue:e,parentStore:n},`${e.type}__${"me"===e.value?"me":null===(t=e.value)||void 0===t?void 0:t.id}`)}))})}function pe(e){let{operatorValues:t,events:o,parentStore:n,schema:a,property:s}=e;const d=(0,i().DP)(),u=(0,r().v3)(),{device:x}=u,h=a[s],y=(0,l().K8)((()=>{if(h&&(0,c().nC)(h))return(0,M().LQ)(h,n)}),[h,n]);return(0,z.jsx)(H().A,{...o,disableMargins:!0,desktopStyle:ee(),innerStyle:te(t.length>0),placeholder:(0,z.jsx)(g().sA,{defaultMessage:"Select a page",id:"databaseRelationOperators.selectPlaceholder"}),title:t.length>0&&t.map(((e,t)=>{if(!e.value)return null;const o=e.type,r={isSingle:!1,shouldShrink:!1,format:x.isMobile?p().NY.Large:p().NY.Medium};if("exact"===o)return(0,z.jsx)(W().A,{blockId:e.value,parentStore:n,...r},e.value);if("relative"===o){if("builtin"===e.value.type)return y?(0,z.jsx)(p().Ay,{value:(0,z.jsx)(g().sA,{...f().n$[y][e.value.variable].messageDescriptor}),backgroundColor:"transparent",theme:d,...r},t):null;if("current_page_in_related_collection"===e.value.type)return(0,z.jsx)(p().Ay,{value:(0,z.jsx)(g().sA,{defaultMessage:"This page",id:"database.filterAndSort.currentPagePropertyValue.title"}),backgroundColor:"transparent",theme:d,...r},t)}else(0,m().HB)(o)}))})}},870988:(e,t,o)=>{o.d(t,{tY:()=>de,tv:()=>ce,G$:()=>se});o(944114),o(898992),o(354520),o(430670),o(581454);var n=o(296540),r=()=>o(484714),l=()=>o(401497),i=()=>o(289915),a=()=>o(3284),s=()=>o(668725),c=()=>o(30626),d=()=>o(764781),p=()=>o(617668),u=()=>o(904789),x=()=>o(236262),f=()=>o(959013),h=()=>o(496603),g=()=>o(534177),m=()=>o(436696),y=()=>o(755022),v=()=>o(170356),S=()=>o(873050),j=()=>o(205098),C=()=>o(722872),b=()=>o(962730),w=()=>o(377586),M=()=>o(463830),A=()=>o(274652),V=(o(737550),()=>o(56366)),T=()=>o(713998),F=()=>o(329199),_=()=>o(780054),P=()=>o(553965),I=()=>o(963589),k=()=>o(760217),R=()=>o(933117),O=()=>o(859428),z=()=>o(125565),B=()=>o(272630),G=o(474848);function D(e){const t=(0,I().X)("db_ux_mobile"),{filter:o}=e,n=(0,f().tz)(),{isPhone:l}=(0,r().Y0)(),a={width:190,menuTitle:n.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.mobileDateFilterModeMenu.title"}),items:i().$N,selectedItem:(0,i().CY)(o),getKey:e=>e,onSelect:t=>{const n={...o,use_end:(0,i().Zt)(t)};e.onChange(n)},renderItem:e=>(0,G.jsx)(O().A,{renderTooltip:()=>(0,j().WG)(e.value),render:t=>(0,G.jsx)(k().A,{title:(0,j().h0)(e.value),...(0,P().A)(e,t)}),placement:b().W.Right,textWrap:!0,style:{width:"260px"}}),renderOrigin:e=>(0,G.jsx)(B().A,{...e,placeholder:n.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.dateFilterModeMenu.label"}),title:(0,G.jsx)(z().A,{isMobile:_().A.isMobile,children:(0,j().h0)((0,i().CY)(o))}),disableMargins:!0,desktopStyle:{width:"100px"}})};return(0,G.jsx)(R().A,{...a,menuTypeOverride:(0,C().PK)(l,t)},"date-filter-mode")}var U=()=>o(568063);const Y=(0,f().j4)((function(e){const t=(0,I().X)("db_ux_mobile"),{isPhone:o}=(0,r().Y0)(),n=(0,r().v3)(),{filterValueType:l,filter:a,intl:s}=e,c=(0,i().U6)(l),d={width:190,menuTitle:s.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.mobileComparatorValueMenu.title"}),items:c,selectedItem:a.operator,getKey:e=>e,onSelect:t=>{const o=(0,j().iI)(l,a,t,"combinator");e.onChange(o),e.collectionContextStore?(0,m().X)({environment:n,collectionContextStore:e.collectionContextStore,action:"set_filter_comparator"}):(0,y().D)(n,{view_type:e.collectionViewType,action:"set_filter_comparator"})},renderItem:e=>(0,G.jsx)(k().A,{title:(0,j().J)(e.value),...e}),renderOrigin:e=>(0,G.jsx)(B().A,{...e,placeholder:s.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.comparatorMenuDropdownButton.label"}),title:(0,G.jsx)(z().A,{isMobile:n.device.isMobile,children:(0,j().J)(a.operator)}),disableMargins:!0})};return(0,G.jsx)(R().A,{...d,menuTypeOverride:(0,C().PK)(o,t)},"comparator")}));var K=()=>o(653048);const L=(0,f().YK)({setFilter:{defaultMessage:"Set filter",id:"database.filterMenu.rollupPropertyValue.mobileMenu.title"}});const $=(0,f().j4)((function(e){const t=(0,r().v3)();if((0,i().s1)(e.filter))return(0,G.jsx)(H,{intl:e.intl,onChange:e.onChange,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,property:e.property,schema:e.schema,parentStore:e.parentStore,collectionViewId:e.collectionViewId,filter:e.filter});const o=(0,i().HF)({schema:e.schema,property:e.property,getRecordModel:e.parentStore.getRecordModel});if(!(0,i().$S)(o,e.filter)){const t=(0,j().xt)(o);return(0,G.jsxs)(n.Fragment,{children:[(0,G.jsx)(Y,{filterValueType:o,filter:t,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),(0,G.jsx)(K().Ay,{filterValueType:o,filter:t,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})]})}const l=(0,G.jsx)(f().sA,{...j().Jk[o],values:{property:(0,G.jsx)(f().sA,{id:"collectionFilterMenuFilter.property.name",defaultMessage:"Property"}),operator:(0,G.jsx)(Y,{filterValueType:o,filter:e.filter,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,onChange:e.onChange}),operatorValue:(0,G.jsx)(K().Ay,{filterValueType:o,filter:e.filter,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})}});return t.device.isMobile?l:(0,G.jsx)("div",{style:{alignItems:"center",display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:e.isArrayFilter?void 0:"span 2",gridColumnGap:`${v().NS}px`,gridTemplateRows:`${v().sw}px`,gridTemplateColumns:"[value-start] max-content auto [value-end operator-start] auto"},children:l})})),X=$;function H(e){let{filter:t,intl:o,onChange:l,collectionContextStore:a,collectionViewType:s,property:c,schema:d,parentStore:p,collectionViewId:u}=e;const{isPhone:x}=(0,r().Y0)(),f=(0,I().X)("db_ux_mobile"),h=(0,r().v3)(),g={menuTitle:o.formatMessage(L.setFilter),items:i().$X,getKey:e=>e,selectedItem:t.operator,onSelect:e=>{const o={...t,operator:e};l(o),a?(0,m().X)({environment:h,collectionContextStore:a,action:"set_rollup_set_filter"}):(0,y().D)(h,{view_type:s,action:"set_rollup_set_filter"})},renderItem:e=>(0,G.jsx)(k().A,{title:(0,j().wE)(e.value,o),...e}),renderOrigin:e=>(0,G.jsx)(B().A,{...e,placeholder:o.formatMessage(L.setFilter),title:(0,j().wE)(t.operator,o),disableMargins:!0,desktopStyle:{minWidth:70}})},{targetProperty:S,targetCollectionSchema:b}=(0,V().K8)((()=>{var e;if("rollup"===(null==d||null===(e=d[c])||void 0===e?void 0:e.type)){const e=(0,U().eY)({schema:d,property:c,getRecordModel:p.getRecordModel});return"person"===(null==e?void 0:e.rollupType)?{targetProperty:void 0,targetCollectionSchema:void 0}:{targetProperty:null==e?void 0:e.targetProperty,targetCollectionSchema:null==e?void 0:e.targetCollectionSchema}}return{targetProperty:c,targetCollectionSchema:d}}),[c,d,p]);if(!S||!b)return(0,G.jsx)("div",{style:{gridColumnEnd:"span 2"}});const w=(0,G.jsxs)(n.Fragment,{children:[(0,G.jsx)(R().A,{...g,menuTypeOverride:(0,C().PK)(x,f)},"set_filter"),(0,G.jsx)($,{collectionViewId:u,filter:t.subfilter,schema:b,property:S,parentStore:p,collectionContextStore:a,collectionViewType:s,onChange:e=>{const o={...t,subfilter:e};l(o)},isArrayFilter:!0})]});return h.device.isMobile?w:(0,G.jsx)("div",{style:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:"span 2",gridColumnGap:`${v().NS}px`,gridTemplateColumns:"max-content",gridTemplateRows:`${v().sw}px`},children:w})}var W=()=>o(406699);const E=function(e){let{schema:t,propertyFilter:l,parentStore:a,index:s,collectionContextStore:c,collectionViewType:d,onChange:p,filterOperator:u,collectionViewId:x}=e;const h=(0,r().v3)(),g=(0,T()._g)({schema:t,property:l.property}),v=(0,V().K8)((()=>(0,i().tn)(t,l.property,l.filter,a.getRecordModel)),[a,l,t]);if(!g)return null;if(!v)return null;const S=(0,i().nM)(l.filter)&&(0,i().gc)(l.filter)&&(0,i().qK)(g),C=S?{width:"120px",marginRight:"4px"}:{},b=(0,G.jsxs)(n.Fragment,{children:[(0,G.jsx)(W().Ay,{popupType:_().A.isMobile?W().z7.SlideUp:W().z7.Popup,renderOrigin:e=>(0,G.jsx)(o(992510).A,{...e,propertySchema:g,disableMargins:!0,textWrapperStyle:{width:"100%",...C}}),render:e=>(0,G.jsx)(o(150987).A,{isRelationProperty:!1,schema:t,onAccept:e=>function(e,t,o,n,r,l,a,s,c){const{property:d,filter:p}=n,u=o[d],x=o[e],f={property:e,filter:p},h=x&&(0,i().tn)(o,e,p,r.getRecordModel),g=x&&"relation"===x.type&&d!==e,v=u&&("created_by"===u.type||"last_edited_by"===u.type)&&x&&"person"===x.type,S=(0,i().I_)(p)&&!(0,i().fZ)(p)&&(0,i().Wf)(p).some((e=>"exact"===e.type&&e.value&&"bot"===e.value.table));(!h||g||v&&S||!(0,F().hs)(f,o))&&(f.filter=(0,j().SN)({schema:o,property:e,getRecordModel:r.getRecordModel}));null==c||c(l,f),a?(0,m().X)({environment:t,collectionContextStore:a,action:"set_filter_property"}):(0,y().D)(t,{view_type:s,action:"set_filter_property"})}(e,h,t,l,a,s,c,d,p),onClose:e.close,allowProperty:T().ah})}),S&&(0,G.jsx)(D,{filter:l.filter,onChange:e=>{const t={...l,filter:e};null==p||p(s,t)}})]});return(0,G.jsxs)(n.Fragment,{children:[u,_().A.isMobile?b:(0,G.jsx)("div",{style:{display:"flex"},children:b}),(0,G.jsx)(f().sA,{id:"collectionFilterMenuRow.propertyConjunction.label",defaultMessage:" "}),(0,G.jsx)(X,{filter:l.filter,schema:t,property:l.property,parentStore:a,collectionViewId:x,collectionContextStore:c,collectionViewType:d,onChange:e=>{const t={...l,filter:e};null==p||p(s,t)},isArrayFilter:!1})]})};function N(){return(0,G.jsx)(f().sA,{defaultMessage:"Add filter rule",id:"database.filterMenu.addFilterRuleButtonTitle"})}const Z=(0,f().YK)({operatorPlaceholder:{defaultMessage:"Operator",id:"database.filterMenu.operatorPlaceholder"}});const q=(0,f().j4)((function(e){const{intl:t,filterOperator:o,onChange:n,disableMargins:l}=e,{isPhone:a}=(0,r().Y0)(),s=(0,I().X)("db_ux_mobile"),c={width:"auto",menuTitle:t.formatMessage({defaultMessage:"Operator",id:"database.filterMenu.filterOperatorMenu.title"}),items:i().Ak,getKey:e=>e,selectedItem:o,onSelect:n,renderItem:e=>(0,G.jsx)(k().A,{title:(0,j().Az)(e.value,t),caption:(0,j().YL)(e.value,t),...e}),renderOrigin:e=>(0,G.jsx)(B().A,{...e,title:o&&(0,j().Az)(o,t),placeholder:t.formatMessage(Z.operatorPlaceholder),disableMargins:l})};return(0,G.jsx)(R().A,{...c,menuTypeOverride:(0,C().PK)(a,s)},"operator")}));var J=()=>o(44935),Q=()=>o(285790),ee=()=>o(928600),te=()=>o(939740),oe=()=>o(480095),ne=()=>o(8980),re=()=>o(89924);const le=60,ie=120,ae=110,se=170,ce=400;function de(e){const{combinatorFilter:t,index:o,level:l,schema:a,onChange:s,parentStore:c,collectionContextStore:d,collectionViewType:p,collectionViewId:u}=e,x=(0,r().Y0)(),f=(0,n.useRef)([]),h=(t.filters??[]).flatMap((e=>(0,i().LB)(e)?[]:[e]));return(0,G.jsxs)(n.Fragment,{children:[Fe(t,l)?void 0:(0,G.jsx)("div",{style:x.isMobile?void 0:{display:"grid",gridTemplateColumns:`\n             [boolean-start] ${le}px\n             [boolean-end property-start] minmax(min-content, ${ie}px)\n             [property-end operator-start] ${ae}px\n             [operator-end value-start] auto\n             [value-end menu-start] ${v().sw}px\n             [menu-end]\n        `,gridAutoRows:`minmax(${v().sw}px, auto)`,gridColumnGap:v().NS,gridRowGap:v().Z3,padding:`${v().Z3}px ${v().NS}px 0 ${v().NS}px`,justifyItems:"stretch",alignItems:"start"},children:h.map(((o,n)=>(0,G.jsx)(pe,{childFilter:o,newIndex:n,schema:a,level:l,combinatorFilter:t,onChange:s,index:e.index,collectionContextStore:d,collectionViewType:p,buttonPopupStores:f.current,parentStore:c,collectionViewId:u},n)))}),(0,G.jsx)(ge,{schema:a,level:l,combinatorFilter:t,onChange:s,index:o,buttonPopupStores:f.current,collectionContextStore:d,collectionViewType:p})]})}function pe(e){const{childFilter:t,newIndex:o,...n}=e,l=(0,r().Y0)();return(0,i().dU)(t)?l.isMobile?(0,G.jsx)(he,{childFilter:t,newIndex:o,...n}):(0,G.jsx)(fe,{childFilter:t,newIndex:o,...n}):(0,i().yX)(t)?l.isMobile?(0,G.jsx)(xe,{childFilter:t,newIndex:o,...n}):(0,G.jsx)(ue,{childFilter:t,newIndex:o,...n}):null}function ue(e){const{newIndex:t,childFilter:o}=e;return(0,G.jsxs)(n.Fragment,{children:[(0,G.jsx)(E,{index:t,propertyFilter:o,schema:e.schema,filterOperator:(0,G.jsx)(Oe,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),parentStore:e.parentStore,onChange:(t,o)=>ke(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},t),(0,G.jsx)(me,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function xe(e){const{childFilter:t,newIndex:o}=e;return(0,G.jsxs)(n.Fragment,{children:[(0,G.jsx)(Oe,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,G.jsxs)(re().A,{title:(0,G.jsx)(f().sA,{defaultMessage:"Filter {index}",id:"database.filterMenu.filterIndex",values:{index:o+1}}),children:[(0,G.jsx)(E,{index:o,propertyFilter:t,schema:e.schema,filterOperator:null,parentStore:e.parentStore,onChange:(t,o)=>ke(t,o,e.combinatorFilter,e.onChange,e.index),collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId},o),(0,G.jsx)(me,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function fe(e){const{newIndex:t,childFilter:o}=e,r=(0,l().IS)((e=>({wrapperStyles:{gridColumn:"property-start / value-end",...Ie(e)}})),[]);return(0,G.jsxs)(n.Fragment,{children:[(0,G.jsx)(Oe,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:t}),(0,G.jsx)("div",{style:r.wrapperStyles,children:(0,G.jsx)(de,{index:t,level:e.level+1,combinatorFilter:o,onChange:(t,o)=>ke(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})}),(0,G.jsx)(me,{filter:o,indexToChange:t,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]},t)}function he(e){const{childFilter:t,newIndex:o}=e,r=(t.filters||[]).length,l=(0,G.jsx)(f().sA,{defaultMessage:"Filter Group {index}",id:"database.filterMenu.filterGroupIndex",values:{index:o+1}});return(0,G.jsxs)(n.Fragment,{children:[(0,G.jsx)(Oe,{combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,newIndex:o}),(0,G.jsxs)(re().A,{title:l,children:[(0,G.jsx)(W().Ay,{buttonPopupStore:Ce(o,e.buttonPopupStores),popupType:W().z7.SlideUp,renderOrigin:o=>(0,G.jsx)(k().A,{focused:!1,...o,showExtensionArrow:!0,right:r.toString(),title:(0,j().Dz)({filter:t,schema:e.schema})}),render:n=>(0,G.jsx)(ee().A,{menuType:C().gu.Modal,title:l,left:(0,G.jsx)(oe().BackMenuText,{}),onClickLeft:n.close,children:(0,G.jsx)(de,{index:o,level:e.level+1,combinatorFilter:t,onChange:(t,o)=>ke(t,o,e.combinatorFilter,e.onChange,e.index),parentStore:e.parentStore,schema:e.schema,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId})})}),(0,G.jsx)(me,{filter:t,indexToChange:o,level:e.level,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType,buttonPopupStores:e.buttonPopupStores})]})]},o)}function ge(e){const t=(0,r().v3)(),o=(0,r().Y0)(),{schema:n,level:i,combinatorFilter:a,onChange:c,index:d,buttonPopupStores:p,collectionContextStore:u,collectionViewType:x}=e,f=(0,l().IS)((()=>({buttonMenuItemStyles:{height:32}})),[]);return o.isMobile?(0,G.jsxs)(re().A,{topBorder:Fe(a,i),children:[(0,G.jsx)(_e,{props:{onClick:()=>Re(t,n,a,c,d,u,x)}}),Ae(e.level)&&(0,G.jsx)(Pe,{props:{onClick:()=>Se(t,n,a,c,d,u,x,p)}})]}):Ae(i)?(0,G.jsx)(re().A,{topBorder:Fe(a,i),children:(0,G.jsx)(W().Ay,{alignmentToOrigin:b().C.Start,popupType:w().n.Popup,renderOrigin:e=>(0,G.jsx)(J().H,{action:()=>e.onClick(),render:t=>{const{focused:o,...n}=t;return(0,G.jsx)(A().o,{...e,...n,focused:o,color:"secondary",style:f.buttonMenuItemStyles,title:(0,G.jsxs)("div",{children:[(0,G.jsx)(N,{}),(0,s().b)({width:10,marginLeft:6,display:"inline"})]})})}}),render:e=>(0,G.jsx)(te().Ay,{type:te().Oh.Vertical,initialFocus:0,sections:[{key:"actions",render:e=>(0,G.jsx)(re().A,{...e}),items:[{key:"add_filter",render:e=>(0,G.jsx)(_e,{props:e}),action:o=>{e.close(),Re(t,n,a,c,d,u,x)}},{key:"add_filter_group",render:e=>(0,G.jsx)(Pe,{props:e}),action:o=>{e.close(),Se(t,n,a,c,d,u,x,p)}}]}]})})}):(0,G.jsx)(re().A,{topBorder:Fe(a,i),children:(0,G.jsx)(J().H,{action:()=>Re(t,e.schema,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType),render:e=>{const{focused:o,...r}=e;return(0,G.jsx)(A().o,{...r,focused:e.focused,color:"secondary",style:f.buttonMenuItemStyles,onClick:()=>Re(t,n,a,c,d,u,x),title:(0,G.jsx)(N,{})})}})})}function me(e){const t=(0,r().Y0)(),o=(0,f().tz)();return t.isMobile?(0,G.jsx)(ye,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:void 0,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType}):(0,G.jsx)(W().Ay,{popupType:w().n.Popup,renderOrigin:e=>(0,G.jsx)(J().H,{action:()=>e.onClick(),render:e=>(0,G.jsx)(Q().A,{...e,hovered:e.focused,style:{width:"100%",height:32},icon:c()._,ariaLabel:o.formatMessage({id:"collections.CollectionFilterCombinatorGrid.RowActions.threeDotActionMenu",defaultMessage:"Edit filter actions"})})}),render:t=>(0,G.jsx)(ye,{filter:e.filter,indexToChange:e.indexToChange,level:e.level,parent:t,combinatorFilter:e.combinatorFilter,onChange:e.onChange,index:e.index,buttonPopupStores:e.buttonPopupStores,collectionContextStore:e.collectionContextStore,collectionViewType:e.collectionViewType})})}function ye(e){const{filter:t,indexToChange:o,parent:n}=e,l=(0,r().v3)(),s=(0,r().Y0)(),c=(0,i().dU)(t),p=c?(0,G.jsx)(f().sA,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterGroupMenuTitle"}):(0,G.jsx)(f().sA,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterMenuTitle"}),u=c?(0,G.jsx)(f().sA,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterGroupMenuTitle"}):(0,G.jsx)(f().sA,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterMenuTitle"}),g=[{key:"delete",action:()=>{var t,r,l,i,a;n&&n.close(),t=o,r=e.buttonPopupStores,l=e.combinatorFilter,i=e.onChange,a=e.index,Te((e=>e.splice(t,1)),l,i,a),Ce(t,r).reset(),r.splice(t,1)},render:e=>(0,G.jsx)(k().A,{...e,icon:(0,G.jsx)(ne().I,{icon:x().trashIcon}),isRedOnHover:!0,title:p})},{key:"duplicate",action:()=>{n&&n.close(),function(e,t,o,n,r,l,i){Te((t=>{const o=t[e];if(o){const n={...o};t.splice(e,0,n)}}),t,o,n),r?(0,m().X)({environment:i,collectionContextStore:r,action:"add_filter_group"}):(0,y().D)(i,{view_type:l,action:"duplicate_filter"})}(o,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType,l)},render:e=>(0,G.jsx)(k().A,{...e,icon:(0,G.jsx)(ne().I,{icon:d().V}),title:u})}];if((0,i().yX)(t)&&Ae(e.level)&&g.push({key:"turn_into_group",action:()=>{n&&n.close(),ve(l,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,G.jsx)(k().A,{...e,icon:(0,G.jsx)(ne().I,{icon:a().arrowSquarePathUpDownIcon}),title:(0,G.jsx)(f().sA,{defaultMessage:"Turn into group",id:"database.filterMenu.turnIntoGroupMenuTitle"})})}),(0,i().dU)(t)&&t.filters&&1===t.filters.length){const r=(0,i().dU)(t.filters[0])?(0,G.jsx)(f().sA,{defaultMessage:"Unwrap group",id:"database.filterMenu.unwrapGroupMenuTitle"}):(0,G.jsx)(f().sA,{defaultMessage:"Turn into filter",id:"database.filterMenu.turnIntoFilterMenuTitle"});g.push({key:"turn_into_filter",action:()=>{n&&n.close(),function(e,t,o,n,r,l,a,s){const c=h().$1(t.filters||[]);c&&!(0,i().LB)(c)&&ke(e,c,n,r,l);a?(0,m().X)({environment:o,collectionContextStore:a,action:"turn_into_filter"}):(0,y().D)(o,{view_type:s,action:"turn_into_filter"})}(o,t,l,e.combinatorFilter,e.onChange,e.index,e.collectionContextStore,e.collectionViewType)},render:e=>(0,G.jsx)(k().A,{...e,icon:(0,G.jsx)(ne().I,{icon:a().arrowSquarePathUpDownIcon}),title:r})})}const v=be(t);return(0,i().dU)(t)&&e.level+v+1<3&&g.push({key:"wrap_in_group",action:()=>{n&&n.close(),ve(l,o,t,e.combinatorFilter,e.onChange,e.index,e.buttonPopupStores,e.collectionContextStore,e.collectionViewType)},render:e=>(0,G.jsx)(k().A,{...e,icon:(0,G.jsx)(ne().I,{icon:a().arrowSquarePathUpDownIcon}),title:(0,G.jsx)(f().sA,{defaultMessage:"Wrap in group",id:"database.filterMenu.wrapInGroupMenuTitle"}),caption:(0,G.jsx)(f().sA,{defaultMessage:"Create a filter group around this",id:"database.filterMenu.wrapInGroupMenuCaption"})})}),(0,G.jsx)(te().Ay,{initialFocus:s.isMobile?void 0:0,type:te().Oh.Vertical,sections:[{key:"actions",render:s.isMobile?e=>(0,G.jsx)("div",{...e}):e=>(0,G.jsx)(re().A,{...e}),items:g}]})}function ve(e,t,o,n,r,l,i,a,s){ke(t,{operator:Me(n),filters:[o]},n,r,l),je(t,i),a?(0,m().X)({environment:e,collectionContextStore:a,action:"turn_into_filter_group"}):(0,y().D)(e,{view_type:s,action:"turn_into_filter_group"})}function Se(e,t,o,n,r,l,i,a){const s=Ve(t,o),c={operator:Me(o),filters:[s]};je(Te((e=>e.push(c)),o,n,r)-1,a),l?(0,m().X)({environment:e,collectionContextStore:l,action:"add_filter_group"}):(0,y().D)(e,{view_type:i,action:"add_filter_group"})}function je(e,t){Ce(e,t).setState({open:!0})}function Ce(e,t){for(;t.length<e+1;){const e=new(M().A);t.push(e)}return t[e]}function be(e){if((0,i().dU)(e)){const t=(e.filters||[]).filter(i().dU);return 1+(h().T9(t.map(be))||0)}return 0}function we(e){const{operator:t,lowercase:o}=e;return"or"===t?o?(0,G.jsx)(f().sA,{id:"collectionFilterCombinatorGrid.filterOperator.or.lowercase",defaultMessage:"or"}):(0,G.jsx)(f().sA,{id:"collectionFilterCombinatorGrid.filterOperator.or",defaultMessage:"Or"}):"and"===t?o?(0,G.jsx)(f().sA,{id:"collectionFilterCombinatorGrid.filterOperator.and.lowercase",defaultMessage:"and"}):(0,G.jsx)(f().sA,{id:"collectionFilterCombinatorGrid.filterOperator.and",defaultMessage:"And"}):(0,g().HB)(t)}function Me(e){return"or"===e.operator?"and":"or"}function Ae(e){return e<2}function Ve(e,t){const o=(t.filters||[]).filter(i().yX),n=o[o.length-1];return n?h().mg(n):(0,S().MI)(e)}function Te(e,t,o,n){const r=[...t.filters||[]],l=e(r);return o(n,{...t,filters:r}),l}function Fe(e,t){return(0,i().U0)(e)&&0===t}function _e(e){let{props:t}=e;const o=(0,G.jsx)(ne().I,{icon:p().plusIcon});return(0,G.jsx)(k().A,{focused:!1,...t,icon:o,title:(0,G.jsx)(N,{})})}function Pe(e){let{props:t}=e;const o=(0,G.jsx)(ne().I,{icon:u().R});return(0,G.jsx)(k().A,{focused:!1,...t,icon:o,title:(0,G.jsx)(f().sA,{defaultMessage:"Add filter group",id:"database.filterMenu.addFilterGroup2ButtonTitle"}),caption:(0,G.jsx)(f().sA,{defaultMessage:"A group to nest more filters",id:"database.filterMenu.addFilterGroupButtonCaption"})})}function Ie(e){return{background:e.filterGroupBackground,borderRadius:6,boxShadow:`0 0 0 1px ${e.filterGroupBorder}`,margin:1,alignSelf:"stretch"}}function ke(e,t,o,n,r){Te((o=>o.splice(e,1,t)),o,n,r)}function Re(e,t,o,n,r,l,i){const a=Ve(t,o);Te((e=>e.push(a)),o,n,r),l?(0,m().X)({environment:e,collectionContextStore:l,action:"add_filter"}):(0,y().D)(e,{view_type:i,action:"add_filter"})}function Oe(e){let{newIndex:t,combinatorFilter:o,onChange:n,index:l,collectionContextStore:i,collectionViewType:a}=e;const s=(0,r().v3)(),c=o.operator,{device:d}=s,p={justifySelf:"end"},u={...p,lineHeight:"32px",paddingRight:4};if(0===t)return d.isMobile?null:(0,G.jsx)(z().A,{style:u,children:(0,G.jsx)(f().sA,{defaultMessage:"Where",id:"database.filterMenu.where"})});if(1===t){const e=(0,G.jsx)(q,{disableMargins:!0,filterOperator:c,onChange:e=>function(e,t,o,n,r,l,i){n(r,{...o,operator:e}),l?(0,m().X)({environment:t,collectionContextStore:l,action:"set_filter_operator"}):(0,y().D)(t,{view_type:i,action:"set_filter_operator"})}(e,s,o,n,l,i,a)});return s.device.isMobile?(0,G.jsx)(re().A,{children:e}):(0,G.jsx)("div",{style:p,children:e})}return d.isMobile?null:(0,G.jsx)(z().A,{style:u,children:(0,G.jsx)(we,{operator:c})})}},904789:(e,t,o)=>{o.d(t,{R:()=>l});o(296540);var n=o(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.51 15.51",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M12 8.875c.345 0 .625.28.625.625v1.875H14.5a.625.625 0 1 1 0 1.25h-1.875V14.5a.625.625 0 1 1-1.25 0v-1.875H9.5a.625.625 0 1 1 0-1.25h1.875V9.5c0-.345.28-.625.625-.625"}),(0,n.jsx)("path",{d:"M4.5 2.375A2.125 2.125 0 0 0 2.375 4.5V12c0 1.174.951 2.125 2.125 2.125h1.625v1.625c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-7.5a2.125 2.125 0 0 0-2.125-2.125h-1.625V4.5A2.125 2.125 0 0 0 12 2.375zm8.375 3.75H8.25A2.125 2.125 0 0 0 6.125 8.25v4.625H4.5A.875.875 0 0 1 3.625 12V4.5c0-.483.392-.875.875-.875H12c.483 0 .875.392.875.875zm-5.5 2.125c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"})]})},l=(0,o(340498).wt)("squareOnSquarePlus",r)}}]);