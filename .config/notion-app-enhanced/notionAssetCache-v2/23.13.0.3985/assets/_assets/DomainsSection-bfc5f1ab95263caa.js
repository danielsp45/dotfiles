"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[56859],{67805:(e,t,i)=>{i.d(t,{X:()=>o,c:()=>l});i(898992),i(672577);var s=()=>i(68263),n=()=>i(731320),a=()=>i(765957),r=()=>i(217429);function o(e,t){return e.sort(((e,i)=>{const s=e.store.canAdmin();if(s===i.store.canAdmin()){var n,a;const s=null===(n=e.publishedMetadata.publishedBy)||void 0===n?void 0:n.id,r=e.publishedMetadata.publishedTime,o=null===(a=i.publishedMetadata.publishedBy)||void 0===a?void 0:a.id,l=i.publishedMetadata.publishedTime;if(t){if(s===t&&o===t&&r&&l)return l-r;if(s===t)return-1;if(o===t)return 1}return r&&l?l-r:0}return s?-1:1}))}function l(e){const{environment:t,store:i}=e,o=r().default.checkGate({gateName:"allow_disable_sites_banner"});if(!i.pathIsAccessibleAndAlive())return!1;if(!n().i0(i).find((e=>(0,s().W8)(e.permissionItem))))return!1;const l=a().default.getState().currentSpaceStore;if(null!=l&&l.getSettings().hide_sites_banner&&o)return!1;return!n().qb(t,i)}},157529:(e,t,i)=>{i.d(t,{A:()=>f});var s=i(296540),n=()=>i(56366),a=()=>i(401497),r=()=>i(584262),o=()=>i(926401),l=()=>i(500066),d=()=>i(296798),c=()=>i(187820),u=()=>i(16006),h=()=>i(492414),p=()=>i(553965),b=()=>i(915019),m=()=>i(404141),g=i(474848);function f(e){const{store:t,style:i,hideIcon:f}=e,y=(0,n().K8)((()=>{if(t)return{icon:t.getIcon(),isEmptyPage:t.isEmptyPage(),url:(0,h().J8)({store:t,pageVisitSource:r().y8.SiteSettings})}}),[t]),v=(0,s.useCallback)((e=>{e.metaKey||m().A.setState({...m().A.state,open:!1})}),[]),S=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden",cursor:"default"},emptyPageIcon:{height:18,width:18,fill:e.palette.gray[500]},iconContainer:{position:"relative",width:20,height:20,marginRight:4},linkBox:{borderRadius:3,maxWidth:"100%"},linkIcon:{position:"absolute",width:10,height:10,right:0,bottom:0},pageRecordContainer:{display:"flex",alignItems:"center",paddingTop:2,paddingBottom:2,paddingRight:4,paddingLeft:4,...i},pageTitle:{wordBreak:"break-word",borderBottom:"0.05em solid rgba(55,53,47,.25)"}})),[i]);if(!t||!y)return null;const A=(0,g.jsxs)("div",{style:S.pageRecordContainer,children:[!f&&(0,g.jsxs)("div",{style:S.iconContainer,children:[y.icon?(0,g.jsx)(c().B6,{icon:y.icon,store:t,disabled:!0,size:16,isEmptyPage:y.isEmptyPage,emojiSize:20}):(0,o().n)(S.emptyPageIcon),(0,l().G)(S.linkIcon)]}),(0,g.jsx)(u().A,{store:t,style:S.pageTitle})]});return(0,g.jsx)("div",{style:S.container,children:(0,g.jsx)(b().A,{store:t,render:e=>(0,g.jsx)(d().A,{href:null==y?void 0:y.url,style:S.linkBox,...(0,p().A)(e,{onClick:v}),children:A})})})}},558410:(e,t,i)=>{i.d(t,{A:()=>a});i(898992),i(354520);var s=()=>i(496603);class n extends(()=>i(757695))().Store{getInitialState(){return{sites:{},sortAscending:!0,sortColumn:void 0}}initializeSiteResultsForSpace(e,t){this.state.sites[e]=t,this.emit()}getSortedSitesForSpace(e,t){const{sortAscending:n,sortColumn:a}=this.state,r=this.state.sites[e];if(r)switch(a){case"page":return s().My(r,(e=>i(919709).q4_(e.store.getTitleValue()).toLowerCase()),n?"asc":"desc");case"published-by":return s().My(r,(e=>{const s=e.publishedMetadata.publishedBy,n=s?i(630116).sk.createChildStore(e.store,s):void 0;return null==n?void 0:n.getDisplayName(t).toLowerCase()}),n?"asc":"desc");case"published-date":return s().My(r,(e=>e.publishedMetadata.publishedTime),n?"asc":"desc");default:return r}}removeSiteFromSpace(e,t){const i=this.state.sites[e];i&&(this.state.sites[e]=i.filter((e=>e.store.id!==t)),this.emit())}resetSitesForSpace(e){this.state.sites[e]=void 0}}const a=new n},716979:(e,t,i)=>{i.d(t,{EL:()=>x,KD:()=>A,Ss:()=>v,l2:()=>C,n0:()=>w,rw:()=>S});i(16280),i(944114),i(898992),i(354520),i(296540);var s=()=>i(388821),n=()=>i(179034),a=()=>i(959013),r=()=>i(763824),o=()=>i(449506),l=()=>i(901389),d=()=>i(106628),c=()=>i(321172),u=()=>i(437487),h=()=>i(227440),p=()=>i(630116),b=()=>i(250484),m=()=>i(67805),g=()=>i(558410),f=i(474848);const y=50;function v(e){g().A.resetSitesForSpace(e.id)}async function S(e,t){const{spaceStore:i,currentUserId:a,limit:l}=t;if(!i.id)return;const[d]=await Promise.all([o().callApi({eventName:"getPublishedPagesForUser",environment:e,data:{spaceId:i.id,limit:l||y,fetchPublishedMetadata:!0}}),(0,r().wR)(1500)]);if("failed"===d.type)throw new Error("Failed to fetch published pages.");if(d.data.recordMap){const e=[],t=s().RecordMapWithRole.create(d.data.recordMap),r=d.data.publishedEdits;for(const{model:s}of t)if(s&&s.table===n().ev){const t=p().Bv.createChildStore(i,{table:n().ev,id:s.id}),a=r[t.id],o=a&&a.authors?a.authors[0]:void 0,l={publishedTime:null==a?void 0:a.timestamp,publishedBy:o};e.push({store:t,publishedMetadata:l})}let o=e;return a&&(o=m().X(e,a)),g().A.initializeSiteResultsForSpace(i.id,o),o}}async function A(e,t){const{spaceStore:i}=t,s=e.currentUser.id,n=await S(e,{spaceStore:i,currentUserId:s});return n?n.filter((e=>{var t;return(null===(t=e.publishedMetadata.publishedBy)||void 0===t?void 0:t.id)===s})):[]}function w(e){c().Tk(e),u().Ay.setState({...u().Ay.state,display:u().pP.Publish,tab:u().QC.Publish})}async function x(e){return new Promise(((t,i)=>{l().ui({message:(0,f.jsx)("div",{style:{textAlign:"center"},children:(0,f.jsx)(a().sA,{id:"sites.confirmUnpublish.title",defaultMessage:"Unpublish this site?"})}),description:(0,f.jsx)("div",{style:{textAlign:"center"},children:(0,f.jsx)(a().sA,{id:"sites.confirmUnpublish.caption",defaultMessage:"{pageTitle} will no longer be live on the web.",values:{pageTitle:e}})}),keepFocus:!0,items:[{label:(0,f.jsx)(a().sA,{id:"sites.confirmUnpublish.confirm",defaultMessage:"Unpublish"}),color:"red",onAccept:()=>t(!0)}],showCancel:!0})}))}async function C(e,t){if(!h().A.state.online)return[];const i=await d().T.searchActions.load();return await i.searchPublicPages({environment:t,query:e,source:"public_home_page_menu",limit:b().ZK})}},915019:(e,t,i)=>{i.d(t,{A:()=>o});var s=i(296540),n=()=>i(962730),a=i(474848);function r(e){let{store:t,...r}=e;const o=(0,s.useCallback)((e=>(0,a.jsx)(i(791194).yf,{store:t,events:e})),[t]);return(0,a.jsx)(i(859428).A,{noStyle:!0,delayThreshold:400,placement:n().W.Bottom,alignment:n().C.Start,renderTooltip:o,...r})}const o=s.memo(r)}}]);