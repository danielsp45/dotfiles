"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[64819],{14959:(e,t,o)=>{o.d(t,{u:()=>i});var n=()=>o(751735);function i(e,t){const{r:o,g:i,b:r}=(null==e?void 0:e.info.accent_color)||{r:0,g:0,b:0},a=`rgba(${o},${i},${r},${"dark"===t?.6:1})`;return{background:a,hoveredBackground:(0,n().e$)(a,.4),pressedBackground:(0,n().e$)(a,.9)}}},66486:(e,t,o)=>{o.d(t,{W:()=>Z,D:()=>Q});o(898992),o(672577),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(708685),s=()=>o(568063),c=()=>o(977345),d=()=>o(668725),p=()=>o(72135),u=()=>o(959013),m=()=>o(381349),g=()=>o(534177),f=()=>o(284371),y=()=>o(901952),h=()=>o(751156),S=()=>o(312296),x=()=>o(704152),v=()=>o(406699),b=()=>o(623580),C=()=>o(897119),A=()=>o(78901),w=()=>o(162010),j=()=>o(89924),M=()=>o(946548),T=()=>o(859428),_=()=>o(763884),P=()=>o(778078),k=()=>o(780054),I=()=>o(972435),R=()=>o(722872),B=()=>o(970585),D=()=>o(760217),O=()=>o(419357),K=()=>o(928600),F=()=>o(939740),L=o(474848);const V="LastUsedCurrency",H=o(757695).Store.createClass("",{name:"NumberFormatFilterStore"});function z(e){const{collectionContextStore:t,collectionStore:o,property:a,schema:l,onClose:s}=e,c=(0,i().v3)(),d=(0,u().tz)(),m=(0,r().uB)(void 0,B().A),g=(0,r().uB)(void 0,H),f=(0,n.useCallback)((e=>{g.setState(e.target.value),m.setState({...m.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[g,m]),x=(0,r().O$)(g),v=(0,r().K8)((()=>function(e){const{environment:t,collectionContextStore:o,collectionStore:n,property:i,schema:r,numberFormatFilterStore:a,onClose:l}=e,s=_().K.get({userId:t.currentUser.id,key:V}),c=(0,P().Ay)(a.state,(0,p().RQ)(s),(e=>e));return c.map((e=>{const a=(0,p().gL)(I().A.getIntl(),e),s=(0,p().D9)(e),c=s?`${a} (${s})`:a,d={key:e,render:e=>(0,L.jsx)(D().A,{...e,title:c}),action:()=>function(e){const{newFormat:t,collectionContextStore:o,collectionStore:n,property:i,schema:r,environment:a,onClose:l}=e,s=r[i];if(!s)return;if("number"!==s.type&&"formula"!==s.type)return;const c={...s,number_format:t,..."percent"===t&&void 0!==(null==s?void 0:s.show_as)?{show_as:{...null==s?void 0:s.show_as,maxValue:1}}:{}};"number"===s.type&&(0,p().SL)(t)&&_().K.set({userId:a.currentUser.id,key:V,value:t});h().createAndCommit({userAction:"NumberFormatMenu.handleNumberFormatChange",environment:a,canUndo:!0,perform:e=>{(0,S().F)({environment:a,collectionStore:n,update:{[i]:c},transaction:e})}}),(0,y().V)({environment:a,collectionContextStore:o,property:i,from:"view_settings",action:"number_change_format",number_format:t}),null==l||l()}({newFormat:e,collectionContextStore:o,collectionStore:n,property:i,schema:r,environment:t,onClose:l})};return d}))}({environment:c,collectionStore:o,collectionContextStore:t,property:a,schema:l,numberFormatFilterStore:g,onClose:s})),[t,c,o,a,l,g,s]);let b;b=k().A.isMobile?{menuType:R().gu.ActionSheet}:{menuType:R().gu.Popup};const C=!k().A.isMobile&&(0,L.jsx)(j().A,{isInput:!0,children:(0,L.jsx)(O().Ay,{value:x,onChange:f,focus:!0,focusAfterAnimation:!0,placeholder:d.formatMessage({defaultMessage:"Filter formatsâ€¦",id:"blockPropertyValue.filterForNumberFormats.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0})});return(0,L.jsx)(K().A,{...b,header:C,children:(0,L.jsx)(F().Ay,{type:F().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,L.jsx)(j().A,{...e}),items:v}],store:m})})}var W=()=>o(893952),N=()=>o(175116),Y=()=>o(722372),q=()=>o(255824),E=()=>o(962730),U=()=>o(463830),G=()=>o(497222),$=()=>o(828973);function Z(e){const{collectionContextStore:t,property:o,source:i}=e,{propertySchema:a,numberFormat:d,numberPrecision:u}=(0,r().K8)((()=>{const e=t.collectionStore();if(!e)return{};const n=t.normalizedSchemaStore.state[o];if(!n)return{};if("number"===n.type)return{propertySchema:n,numberFormat:n.number_format??p().C4,numberPrecision:n.number_precision??p().pS};if("formula"===n.type)return"number"===(0,l().getFormulaPropertySchemaResultType)(n)?{propertySchema:n,numberFormat:n.number_format??p().C4,numberPrecision:n.number_precision??p().pS}:n.formula2&&"number"===(0,c().pg)(n.formula2.result_type).type?{propertySchema:n,numberFormat:n.number_format??p().C4,numberPrecision:p().pS}:{};if("rollup"===n.type){var i;if(n.aggregation&&"show_unique"!==n.aggregation){var r;const i=null===(r=(0,s().eY)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===r?void 0:r.targetPropertySchema;if(void 0===(null==i?void 0:i.type))return{};const a=(0,Y().o_)(n.aggregation,(0,Y().o_)(n.aggregation,"number_format"in i?i.number_format:void 0));return a?{propertySchema:n,numberFormat:a,numberPrecision:p().pS}:{}}const a=null===(i=(0,s().eY)({property:o,schema:t.normalizedSchemaStore.state,getRecordModel:e.getRecordModel}))||void 0===i?void 0:i.targetPropertySchema;if("number"===(null==a?void 0:a.type)||"formula"===(null==a?void 0:a.type)&&"number"===(0,l().getFormulaPropertySchemaBaseResultType)(a))return{propertySchema:n,numberFormat:a.number_format??p().C4,numberPrecision:p().pS}}return{}}),[t,o]),m="rollup"!==(null==a?void 0:a.type),g=(0,n.useMemo)((()=>"formula"===(null==a?void 0:a.type)&&"number"!==(0,l().getFormulaPropertySchemaResultType)(a)),[a]),f="rollup"!==(null==a?void 0:a.type)&&!g;return a?(0,L.jsxs)(L.Fragment,{children:[m&&(0,L.jsx)(J,{numberFormat:d,property:o}),f&&(0,L.jsx)(X,{numberPrecision:u,property:o}),(0,L.jsx)(ee,{property:o,propertySchema:a,numberFormat:d,source:i})]}):null}function J(e){const{numberFormat:t,property:o}=e,a=(0,u().tz)(),{isMobile:l}=(0,i().Y0)(),s=(0,N().ET)(),c=(0,r().uB)(void 0,U().A),d=(0,r().K8)((()=>s.collectionStore()),[s]),m=(0,r().O$)(s.normalizedSchemaStore),g=(0,n.useCallback)((e=>(0,L.jsx)(G().A,{title:(0,L.jsx)(u().sA,{defaultMessage:"Number format",id:"database.viewSettings.numberOptions.numberFormat"}),right:(0,L.jsx)("span",{style:{...f().RC},children:(0,p().gL)(a,p().PA.find((e=>e===t))??p().C4)}),showChevron:!0,rotateChevron:c.state.open,...e})),[c,a,t]),y=(0,n.useCallback)((e=>d?(0,L.jsx)(z,{collectionContextStore:s,collectionStore:d,property:o,schema:m,onClose:e.close}):null),[s,d,o,m]);return(0,L.jsx)(v().Ay,{popupType:l?C().nl.BottomSheet:C().nl.Popup,alignmentToOrigin:v().yP.End,bottomSheetInitialState:"half",renderOrigin:g,render:y,buttonPopupStore:c})}function X(e){const{numberPrecision:t,property:o}=e,a=(0,u().tz)(),s=(0,i().v3)(),c=(0,N().ET)(),d=(0,r().K8)((()=>c.collectionStore()),[c]),m=(0,r().O$)(c.normalizedSchemaStore),g=(0,n.useMemo)((()=>{const e=m[o];if(!e)return;const t="formula"===e.type&&"number"===(0,l().getFormulaPropertySchemaResultType)(e);return"number"===e.type||t?e:void 0}),[o,m]),f=(0,n.useMemo)((()=>p().iv.map((e=>({key:e,type:"button",title:Q(a,e)})))),[a]),x=(0,n.useCallback)((e=>{if(!d||!g)return;const t={...g,number_precision:e};h().createAndCommit({userAction:"NumberFormatMenu.handleNumberPrecisionChange",environment:s,canUndo:!0,perform:e=>{(0,S().F)({environment:s,collectionStore:d,update:{[o]:t},transaction:e})}}),(0,y().V)({environment:s,collectionContextStore:c,property:o,from:"view_settings",action:"number_change_precision",number_precision:e})}),[c,d,s,o,g]),v=(0,n.useCallback)((()=>(0,L.jsx)(u().sA,{defaultMessage:"Round to a specified number of decimal places. The underlying remains unchanged.",id:"database.viewSettings.numberOptions.numberPrecision.tooltip"})),[]),b=(0,n.useCallback)((e=>(0,L.jsx)($().A,{...e,title:(0,L.jsx)(u().sA,{defaultMessage:"Decimal places",id:"database.viewSettings.numberOptions.numberPrecision"}),selectedKey:t,options:f,onChange:x})),[x,t,f]);return(0,L.jsx)(T().A,{placement:E().W.Right,textWrap:!0,renderTooltip:v,render:b})}function Q(e,t){switch(t){case"precision_uncapped":return e.formatMessage({id:"collection.numberFormat.precisionUncapped",defaultMessage:"Default"});case"precision_0":return e.formatMessage({id:"collection.numberFormat.precision0",defaultMessage:"0"});case"precision_1":return e.formatMessage({id:"collection.numberFormat.precision1",defaultMessage:"1"});case"precision_2":return e.formatMessage({id:"collection.numberFormat.precision2",defaultMessage:"2"});case"precision_3":return e.formatMessage({id:"collection.numberFormat.precision3",defaultMessage:"3"});case"precision_4":return e.formatMessage({id:"collection.numberFormat.precision4",defaultMessage:"4"});case"precision_5":return e.formatMessage({id:"collection.numberFormat.precision5",defaultMessage:"5"});default:(0,g().HB)(t)}}function ee(e){const{property:t,propertySchema:o,numberFormat:r,source:l}=e,{show_as:s}=o,c=(0,i().v3)(),p=(0,a().DP)(),g=(0,N().ET)(),C=(0,n.useRef)({color:(null==s?void 0:s.color)??"green",maxValue:(null==s?void 0:s.maxValue)??100,showValue:(null==s?void 0:s.showValue)??!0}),T=(0,q().a)(),_="tableHeaderMenu"===l,P={type:(null==s?void 0:s.type)??"number",color:(null==s?void 0:s.color)??C.current.color,maxValue:(null==s?void 0:s.maxValue)??C.current.maxValue,showValue:(null==s?void 0:s.showValue)??C.current.showValue},k=(0,a().IS)((e=>({card:{boxSizing:"content-box",height:36,flex:1,margin:1,boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.text.secondary,borderRadius:6,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",paddingLeft:12,paddingRight:12,paddingTop:6,paddingBottom:6,cursor:"pointer",background:T?e.cardContentBackground:void 0},cardHoveredStyle:{background:T?e.cardContentBackground:void 0},cardPressedStyle:{background:T?e.cardContentBackground:void 0},selectedCard:{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor},cardVisual:{height:20,marginBottom:4,width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},cardText:{lineHeight:1,fontSize:12},showAsTypeOption:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginLeft:T?12:_?8:16,marginRight:_?8:16,marginTop:6,gap:6},allExtraOptions:{backgroundColor:T?e.cardContentBackground:e.palette.gray[30],boxShadow:T?`0 0 0 1px ${e.regularDividerColor}`:void 0,borderRadius:5,marginTop:12,marginLeft:T?12:_?8:16,marginRight:_?8:16,paddingTop:12,paddingBottom:12,maxHeight:1e3,transition:"max-height 0.5s ease-in-out",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",gap:8},extraOptionStyle:{display:"flex",flexDirection:"row",alignItems:"center",paddingLeft:16,paddingRight:16,gap:16,height:28,width:"100%"},applyToAllViews:{marginTop:12,marginLeft:_?10:18,marginRight:_?10:18,fontSize:12,color:e.text.tertiary,paddingBottom:_?6:0}})),[T,_]),I=(0,n.useCallback)((e=>{const n=g.collectionStore();o&&n&&(h().createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:c,canUndo:!0,perform:i=>{(0,S().F)({environment:c,collectionStore:n,update:{[t]:{...o,show_as:e}},transaction:i})}}),(0,y().V)({environment:c,collectionContextStore:g,property:t,from:"view_settings",action:"number_change_show_as",number_show_as:(null==e?void 0:e.type)??"number"}))}),[g,c,t,o]),R=(0,n.useMemo)((()=>[{key:"number",visual:(0,L.jsx)("div",{style:{fontSize:16,fontWeight:f().Wy.medium},children:"42"}),text:(0,L.jsx)(u().sA,{defaultMessage:"Number",id:"database.viewSettings.numberOptions.showAsNumber"})},{key:"bar",visual:(0,L.jsx)(A().z,{percentage:50,filledColor:"bar"===P.type?p.blueColor:p.palette.translucentGray[500],unfilledColor:"bar"===P.type?p.palette.uiBlue[300]:p.palette.translucentGray[300],style:{width:"100%"}}),text:(0,L.jsx)(u().sA,{defaultMessage:"Bar",id:"database.viewSettings.numberOptions.showAsBar"})},{key:"ring",visual:(0,L.jsx)(w().C,{size:20,percentage:40,filledColor:"ring"===P.type?p.blueColor:p.palette.translucentGray[500],unfilledColor:"ring"===P.type?p.palette.uiBlue[300]:p.palette.translucentGray[300],style:{width:"100%"}}),text:(0,L.jsx)(u().sA,{defaultMessage:"Ring",id:"database.viewSettings.numberOptions.showAsRing"})}]),[P.type,p.blueColor,p.palette]),B=(0,L.jsx)("div",{style:k.showAsTypeOption,children:R.map((e=>{const t=P.type===e.key;return(0,L.jsxs)(x().A,{onClick:()=>{const t="number"===e.key?void 0:{type:e.key,color:P.color,maxValue:"percent"===r?1:P.maxValue,showValue:P.showValue};void 0!==t&&(C.current=t),I(t)},style:{...k.card,...t?k.selectedCard:{}},hoveredStyle:k.cardHoveredStyle,pressedStyle:k.cardPressedStyle,children:[(0,L.jsx)("div",{style:k.cardVisual,children:e.visual}),(0,L.jsx)("div",{style:k.cardText,children:e.text})]},e.key)}))}),D=e=>{const t="number"!==P.type?{...P,type:P.type,...e}:void 0;void 0!==t&&(C.current=t),I(t)},O="number"!==P.type?(0,L.jsxs)("div",{style:k.extraOptionStyle,children:[(0,L.jsx)("div",{style:{flex:6,fontSize:14},children:(0,L.jsx)(u().sA,{defaultMessage:"Color",id:"database.viewSettings.numberOptions.color"})}),(0,L.jsx)("div",{style:{display:"flex",flexWrap:"wrap",flex:6,gap:7},children:(0,L.jsx)(v().Ay,{popupType:c.device.isMobile?v().z7.BottomSheet:v().z7.Popup,bottomSheetInitialState:"half",renderOrigin:e=>(0,L.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"end"},...e,children:(0,L.jsx)(W().A,{color:P.color,focused:!1,buttonStyle:{width:"auto",marginLeft:0,marginRight:0,borderRadius:6,color:p.text.tertiary},style:{minHeight:36},right:(0,d().b)({width:12,height:12})})}),render:e=>{const t=m().tS.map((t=>(0,L.jsx)(W().A,{color:t,isChecked:t===P.color,focused:!1,style:{width:"100%"},onClick:()=>{D({color:t}),e.close()}},t)));return(0,L.jsx)("div",{style:{minWidth:150,paddingTop:8,paddingBottom:8},children:t})}})})]}):null,K="number"!==P.type?"percent"!==r&&(0,L.jsxs)("div",{style:k.extraOptionStyle,children:[(0,L.jsx)("div",{style:{flex:6,fontSize:14},children:(0,L.jsx)(u().sA,{defaultMessage:"Divide by",id:"database.viewSettings.numberOptions.divideBy"})}),(0,L.jsx)("div",{style:{flex:6},children:(0,L.jsx)(b().A,{value:P.maxValue.toString(),onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,""),o=parseFloat(t);!isNaN(o)&&o>0&&D({maxValue:o})},inputStyle:{textAlign:"right"}})})]}):null,F="number"!==P.type?(0,L.jsxs)("div",{style:k.extraOptionStyle,children:[(0,L.jsx)("div",{style:{flex:6,fontSize:14},children:(0,L.jsx)(u().sA,{defaultMessage:"Show number",id:"database.viewSettings.numberOptions.showValue"})}),(0,L.jsx)("div",{style:{flex:6,display:"flex",justifyContent:"flex-end"},children:(0,L.jsx)(M().A,{on:P.showValue,onClick:()=>{D({showValue:!P.showValue})},disabled:!1})})]}):null,V=Boolean(O||K||F)?(0,L.jsxs)("div",{style:k.allExtraOptions,children:[O,K,F]}):null;return(0,L.jsxs)(j().A,{title:(0,L.jsx)(u().sA,{defaultMessage:"Show as",id:"database.viewSettings.numberPercentOptions.showAs"}),topBorder:!0,disableMobileBorders:!0,children:[B,V,!T&&(0,L.jsx)("div",{style:k.applyToAllViews,children:(0,L.jsx)(u().sA,{id:"database.CollectionSettings.NumberOptions.applyAllViews",defaultMessage:"Changes apply to all views showing this property."})})]})}},68913:(e,t,o)=>{o.r(t),o.d(t,{alarmIcon:()=>r,iconDefinition:()=>i});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"1.91 0.78 16.18 16.85",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M5.791 1.886a.625.625 0 1 0-.801-.96L2.138 3.31a.625.625 0 1 0 .802.96zm4.834 3.839a.625.625 0 1 0-1.25 0v3.65H6.4a.625.625 0 0 0 0 1.25H10c.345 0 .625-.28.625-.625z"}),(0,n.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0M14.13 1.006a.625.625 0 0 0 .079.88l2.851 2.383a.625.625 0 1 0 .802-.96L15.01.927a.625.625 0 0 0-.88.079"})]})},r=(0,o(340498).wt)("alarm",i)},95441:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const i=function(e){const{title:t,href:i,analyticsFrom:r}=e,a=(0,o(484714).v3)();return(0,n.jsx)(o(187485).A,{href:i,onClick:()=>o(148024).FH(a,{from:r}),external:!0,children:(0,n.jsx)(o(497222).A,{icon:o(406533).questionMarkCircleIcon,title:t,isGray:!0})})}},107440:(e,t,o)=>{o.d(t,{A:()=>k});var n=o(296540),i=()=>o(395361),r=()=>o(484714),a=()=>o(56366),l=()=>o(401497),s=()=>o(835243),c=()=>o(187174),d=()=>o(689094),p=()=>o(519831),u=()=>o(959013),m=()=>o(381349),g=()=>o(284371),f=()=>o(901952),y=()=>o(449506),h=()=>o(235191),S=()=>o(901389),x=()=>o(751156),v=()=>o(419357),b=()=>o(331542),C=()=>o(204063),A=()=>o(16006),w=()=>o(132389),j=()=>o(125565),M=()=>o(972435),T=()=>o(227440),_=o(474848);const P=(0,u().YK)({autoIncrementIdPrefixPlaceholder:{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPlaceholder"},duplicatePrefixNameError:{defaultMessage:"{prefixName} isn't available for use.",id:"database.viewSettings.propertyTab.duplicatePrefixNameError"}});function k(e){const{uniqueIdProperty:t,prefixValue:o,collectionContextStore:m}=e,b=(0,r().v3)(),k=(0,a().K8)((()=>m.collectionStore()),[m]),[R,B]=(0,n.useState)(o??""),[D,O]=(0,n.useState)(!0),[K,F]=(0,n.useState)(),L=!(0,a().O$)(T().e),V=(0,n.useCallback)((()=>{O(!0),F(void 0)}),[O,F]),H=(0,n.useCallback)((e=>{O(!0),F(M().A.formatMessage(P.duplicatePrefixNameError,{prefixName:`"${e}"`}))}),[]),z=(0,n.useCallback)(((e,t,o)=>{const n=o.collectionStore();n&&(O(!1),y().callApi({eventName:"setRecordKey",environment:b,data:{spaceId:n.getSpaceId(),table:n.table,key:e,id:n.id}}).then((n=>{O(!0),200!==n.status?H(e):(0,f().V)({environment:b,collectionContextStore:o,property:t,from:"view_settings",action:"unique_id_change_collection_key"})})).catch((()=>H(e))))}),[b,H]),W=(0,n.useCallback)((async e=>{if(!k)return!1;const t=await y().callApi({eventName:"isRecordKeyAvailable",environment:b,data:{spaceId:k.getSpaceId(),table:k.table,key:e.trim()}});return"success"===t.type&&t.data.isAvailable}),[k,b]),N=(0,i().U)((e=>{W(e).then((t=>{t||H(e),O(!0)})).catch((()=>H(e)))}),500),[Y]=(0,c().Yb)((async()=>{if(k)return y().callApi({eventName:"suggestRecordKey",environment:b,data:{spaceId:k.getSpaceId(),table:p().Vl,id:k.id,shouldSetSuccessfullySuggestedRecord:!1}})}),[k,b]);(0,n.useEffect)((()=>{var e;if(!o&&"resolved"===Y.status)return"success"===(null===(e=Y.value)||void 0===e?void 0:e.type)&&Y.value.data?(F(void 0),void B(Y.value.data.key)):void 0}),[o,Y]),(0,n.useEffect)((()=>()=>{N.cancel()}),[N]);const q=(0,n.useCallback)((e=>{const t=e.target.value.toUpperCase();B(t),V(),t&&t!==o&&((0,s().n4)(t)||F(M().A.formatMessage(s().DZ.prefixInvalidError)),O(!1),N(t))}),[V,o,N]),E=(0,n.useCallback)((()=>{N.flush()}),[N]),U=(0,n.useCallback)((e=>{const n=null==k?void 0:k.getRecordKeyStore();e!==o&&!K&&n&&k&&null!=t&&t.propertySchema?z(e,null==t?void 0:t.propertyId,m):O(!0)}),[k,o,K,t,z,m]),G=(0,n.useCallback)((()=>{const e=m.collectionStore();e&&x().createAndCommit({userAction:"CollectionSettingsAutoIncrementIdPropertyCreateNewIdProperty",environment:b,canUndo:!0,perform:t=>{const o=h().IL({environment:b,collectionStore:e,collectionViewArgs:void 0,propertyType:"auto_increment_id",transaction:t});z(R,o,m)}})}),[m,b,R,z]),$=(0,n.useCallback)((e=>{if(!k)return;const t=[{label:(0,_.jsx)(u().sA,{id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit",defaultMessage:"Update ID Prefix"}),color:"red",onAccept:()=>U(e)}];S().ui({message:(0,_.jsx)("span",{children:(0,_.jsx)(u().sA,{id:"database.viewSettings.propertyTab.changePrefixConfirmationMessage",defaultMessage:"Updating the prefix will stop 3rd party automations that rely on this ID (e.g., GitHub PR status automation).",values:{databaseName:(0,_.jsx)(A().A,{style:{display:"inline",fontWeight:g().Wy.medium},shouldWrap:!0,store:k})}})}),showCancel:!0,keepFocus:!0,items:t})}),[k,U]),Z=(0,n.useCallback)((e=>{o?$(e):U(e)}),[o,U,$]),J=(0,n.useCallback)((()=>t?t&&!o?(0,_.jsxs)(_.Fragment,{children:[(0,d().W)({width:14,height:14}),(0,_.jsx)(w().A,{size:4}),(0,_.jsx)(u().sA,{defaultMessage:"Add ID prefix",id:"database.viewSettings.propertyTab.autoIncrementIdCreatePrefix"})]}):(0,_.jsx)(u().sA,{defaultMessage:"Update ID Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixSubmit"}):(0,_.jsxs)(_.Fragment,{children:[(0,d().W)({width:14,height:14}),(0,_.jsx)(w().A,{size:4}),(0,_.jsx)(u().sA,{defaultMessage:"Add ID property",id:"database.viewSettings.propertyTab.autoIncrementIdCreateProperty"})]})),[o,t]),X=(0,l().IS)((e=>({prefixInputOuterStyle:{color:void 0===o?e.text.tertiary:e.text.primary},actionButton:{display:"flex",justifyContent:"center",marginTop:8,padding:8},subtext:{paddingLeft:8}})),[o]);return(0,_.jsxs)(_.Fragment,{children:[!L&&(0,_.jsx)(v().Ay,{left:(0,_.jsx)(j().A,{children:(0,_.jsx)(u().sA,{defaultMessage:"Prefix",id:"database.viewSettings.propertyTab.autoIncrementIdPrefix"})}),value:R,inputOuterStyle:X.prefixInputOuterStyle,style:{gap:18},onChange:q,onBlur:E,placeholder:P.autoIncrementIdPrefixPlaceholder.defaultMessage,onSubmit:()=>Z(R.trim()),focusInitial:!1,selectAll:!1,disabled:!1}),(0,_.jsx)("div",{style:X.subtext,children:K||!D?(0,_.jsx)(I,{prefixName:R,hasRequestCompleted:D,errorMessage:K}):L?(0,_.jsx)(j().A,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:16,marginLeft:16},children:(0,_.jsx)(u().sA,{defaultMessage:"Prefix is not available offline.",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixOffline"})}):(0,_.jsx)(j().A,{isSmall:!0,isSecondaryColor:!0,children:(0,_.jsx)(u().sA,{defaultMessage:"{prefixWithHyphen}1, {prefixWithHyphen}2, {prefixWithHyphen}3, ...",id:"database.viewSettings.propertyTab.autoIncrementIdPrefixPreview",values:{prefixWithHyphen:R?`${R}-`:""}})})}),(0,_.jsx)("div",{style:X.actionButton,children:(0,_.jsx)(C().A,{size:"md",style:{width:"100%"},onClick:()=>{t?Z(R.trim()):G()},disabled:R===o||Boolean(K)||!D||L,children:J()})})]})}function I(e){const{errorMessage:t,hasRequestCompleted:o}=e;return(0,_.jsx)(j().A,{isMultiline:!0,style:{...o?{color:m().Ay.red}:{}},isSecondaryColor:!o,children:o&&t?t:(0,_.jsx)("div",{style:{paddingTop:3,paddingBottom:3},children:(0,_.jsx)(b().A,{legacySize:14})})})}},109129:(e,t,o)=>{o.d(t,{V:()=>p});o(296540);var n=()=>o(484714),i=()=>o(665589),r=()=>o(959013),a=()=>o(901952),l=()=>o(751156),s=()=>o(312296),c=()=>o(35091),d=o(474848);function p(e){let{collectionContextStore:t,property:o,propertySchema:p}=e;const u=(0,n().v3)();return(0,d.jsx)(c().A,{title:(0,d.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,d.jsx)(r().sA,{defaultMessage:"Show full URL",id:"database.viewSettings.propertyTab.toggleShowFullUrl"})}),icon:i().l,showChevron:!1,switcherProps:{on:Boolean(p.show_full_url),noColor:!1},onClick:()=>function(e,t,o,n){const i=t.collectionStore();if(!n||!i||"url"!==n.type)return;const r=!Boolean(n.show_full_url);l().createAndCommit({userAction:"CollectionSettingsProperty.handleNumberShowAsChange",environment:e,canUndo:!0,perform:t=>{(0,s().F)({environment:e,collectionStore:i,update:{[o]:{...n,show_full_url:r}},transaction:t})}}),(0,a().V)({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:r?"url_toggle_show_full_on":"url_toggle_show_full_off"})}(u,t,o,p)})}},112282:(e,t,o)=>{o.d(t,{s:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.97 2.37 12.06 15.26",svg:(0,o(474848).jsx)("path",{d:"M9.792 2.41a.6.6 0 0 0-.234.148l-5.4 5.4a.625.625 0 1 0 .884.884l4.333-4.333V17a.625.625 0 1 0 1.25 0V4.509l4.333 4.333a.625.625 0 1 0 .884-.884l-5.4-5.4a.62.62 0 0 0-.65-.147"})},i=(0,o(340498).wt)("arrowStraightUp",n)},115552:(e,t,o)=>{o.d(t,{A:()=>c});o(581454),o(296540);var n=()=>o(401497),i=()=>o(284371),r=()=>o(115512),a=()=>o(704152),l=o(474848);const s={tall:80,short:50};function c(e){const{disabled:t,options:o,selectedOption:c,onOptionSelected:d,height:p}=e,u=(0,n().IS)((e=>({cardContainer:{paddingLeft:8,paddingRight:8,display:"flex",justifyContent:"space-between",alignItems:"center",columnGap:8},cardUnselected:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1,flexBasis:82,minWidth:0,color:e.palette.gray[500]},cardSelected:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1,flexBasis:82,minWidth:0,color:e.palette.gray[500]},cardButtonBase:{height:s[p],width:"100%",borderRadius:6,borderStyle:"solid",transition:"border-color 0.3s, box-shadow 0.3s",display:"flex",justifyContent:"center",alignItems:"center",color:t?e.icon.tertiary:void 0,background:e.surface.elevated},cardButtonHovered:{background:e.surface.elevated,...(0,r().nl)({width:2,color:e.stroke.uiBlueSecondary})},cardButtonSelected:(0,r().nl)({width:2,color:e.blueColor}),cardButtonUnselected:(0,r().nl)({width:1,color:"dark"===e.mode?e.palette.gray[400]:e.palette.gray[100]}),cardLabelBase:{...i().RC,marginTop:6,fontSize:12,lineHeight:"14px",maxWidth:"100%",color:t?e.icon.tertiary:void 0},cardLabelSelected:{fontWeight:i().Wy.semibold,color:e.palette.gray[900]},iconBase:{height:24,width:24,color:t?void 0:e.icon.secondary},iconSelected:{color:e.blueColor,fill:e.blueColor},imageBase:{maxHeight:s[p],opacity:t?.5:1},imageSelected:{opacity:1}})),[t,p]),m=o.available.map((e=>{const n=o.appearance[e],i=e===c;return(0,l.jsxs)("div",{style:i?u.cardSelected:u.cardUnselected,children:[(0,l.jsx)(a().A,{style:{...u.cardButtonBase,...i?u.cardButtonSelected:u.cardButtonUnselected},hoveredStyle:u.cardButtonHovered,pressedStyle:u.cardButtonHovered,ignoreLocalHoverState:i,disabled:t,onClick:()=>{d(e)},children:n.icon?n.icon.function({...u.iconBase,height:n.icon.size,width:n.icon.size,...i?u.iconSelected:{}}):(0,l.jsx)("img",{src:n.image.src,style:{width:n.image.width,height:n.image.height,...u.imageBase,...i?u.imageSelected:{}}})}),(0,l.jsx)("div",{style:{...u.cardLabelBase,...i?u.cardLabelSelected:{}},children:n.label})]},e)}));return(0,l.jsx)("div",{style:u.cardContainer,children:m})}},158797:(e,t,o)=>{o.d(t,{A:()=>be});o(898992),o(672577);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(617871),s=()=>o(14959),c=()=>o(959013),d=()=>o(534177),p=()=>o(901389),u=()=>o(510683),m=()=>o(374562),g=()=>o(895876),f=()=>o(493823),y=()=>o(89924),h=()=>o(132389),S=()=>o(176983),x=()=>o(53137),v=()=>o(107440),b=(o(944114),o(354520),o(430670),o(803949),o(581454),()=>o(970013)),C=()=>o(743176),A=()=>o(784892),w=()=>o(638681);const j={pull_request_review_edited:!0,pull_request_review_submitted:!0,pull_request_review_requested:!0,pull_request_review_request_removed:!0,pull_request_closed:!0,pull_request_opened:!0,pull_request_reopened:!0,pull_request_converted_to_draft:!0,pull_request_edited:!0,pull_request_assigned:!0,pull_request_labeled:!0,pull_request_unlabeled:!0},M={pull_request_review_comment_created:!0,issue_comment_created:!0},T={installation_deleted:!0,installation_suspend:!0,installation_unsuspend:!0,...j,...M},_={pull_request_opened:!0,pull_request_review_requested:!0,pull_request_review_submitted:!0,pull_request_closed:!0};w().literals(...(0,d().uv)({pull_request:!0,pull_request_review:!0,pull_request_review_comment:!0,installation:!0,issue_comment:!0})),w().literals(...(0,d().uv)(T)),w().literals(...(0,d().uv)(M));var P=()=>o(452951),k=()=>o(689094),I=()=>o(735384),R=()=>o(901952),B=()=>o(235191),D=()=>o(751156),O=()=>o(312296),K=()=>o(760217),F=()=>o(406699),L=()=>o(811979),V=()=>o(802790),H=()=>o(928600),z=()=>o(939740),W=()=>o(480095),N=()=>o(204063),Y=()=>o(859428),q=()=>o(399762),E=()=>o(175116),U=()=>o(972435),G=()=>o(722872),$=()=>o(685889),Z=()=>o(497222),J=()=>o(35091),X=o(474848);const Q=14,ee=(0,c().YK)({autoUpdate:{defaultMessage:"Auto-update",id:"collectionSettingsGithubAutomationConfig.statusPicker.autoUpdate"},when:{defaultMessage:"when PR is",id:"collectionSettingsGithubAutomationConfig.statusPicker.when"},addStatusDescription:{defaultMessage:"Add a status property to set up automations.",id:"collectionSettingsGithubAutomationConfig.addStatusDescription"},addStatusButton:{defaultMessage:"Add status property",id:"collectionSettingsGithubAutomationConfig.statusPicker.addStatusButton"},newStatusPropertyButton:{defaultMessage:"New status",id:"collectionSettingsGithubAutomationConfig.statusPicker.newStatusPropertyButton"},pull_request_opened:{defaultMessage:"Opened",id:"collectionSettingsGithubAutomationConfig.pullRequestOpened"},pull_request_review_requested:{defaultMessage:"Review requested",id:"collectionSettingsGithubAutomationConfig.pullRequestReviewRequested"},pull_request_review_submitted:{defaultMessage:"Approved",id:"collectionSettingsGithubAutomationConfig.pullRequestApproved"},pull_request_closed:{defaultMessage:"Merged",id:"collectionSettingsGithubAutomationConfig.pullRequestMerged"},noAutomations:{defaultMessage:"None",id:"collectionSettingsGithubAutomationConfig.noAutomation"},removeStatusOption:{defaultMessage:"Clear",id:"collectionSettingsGithubAutomationConfig.removeStatusOption"},linkbackAndActivitySectionHeader:{defaultMessage:"Linkbacks & Activity",id:"collectionSettingsGithubAutomationConfig.linkbacksAndActivityHeading"},linkBacksToggle:{defaultMessage:"Linkbacks in GitHub",id:"collectionSettingsGithubAutomationConfig.linkBacksToggle"},linkBacksToggleDescription:{defaultMessage:"Enable linkback comments to the linked page on GitHub",id:"collectionSettingsGithubAutomationConfig.linkBacksToggleDescription"},activityCommentsToggle:{defaultMessage:"Activity Comments",id:"collectionSettingsGithubAutomationConfig.activityCommentsToggle"},activityCommentsToggleDescription:{defaultMessage:"Show GitHub activity as comments on the linked page",id:"collectionSettingsGithubAutomationConfig.activityCommentsToggleDescription"}}),te={pull_request_opened:U().A.formatMessage(ee.pull_request_opened),pull_request_review_requested:U().A.formatMessage(ee.pull_request_review_requested),pull_request_review_submitted:U().A.formatMessage(ee.pull_request_review_submitted),pull_request_closed:U().A.formatMessage(ee.pull_request_closed)},oe=U().A.formatMessage(ee.noAutomations),ne={pull_request_opened:null,pull_request_review_requested:null,pull_request_review_submitted:null,pull_request_closed:null},ie={github_linkbacks:!0,activity_comments:!1};function re(e){const{gitHubProperty:t,selectedStatusProperty:o,setSelectedStatusProperty:a,intl:l}=e,s=(0,i().v3)(),c=(0,E().ET)(),p=(0,i().Y0)(),u=ce(),m=(0,r().K8)((()=>{const e=(0,$().Jq)(c,t);if(e&&(0,b().UU)(e))return e}),[c,t]),g=(0,r().K8)((()=>{const e=c.normalizedSchemaStore.state;return(0,d().WP)(e).flatMap((e=>{let[t,o]=e;return o&&(0,b().DD)(o)?[{id:t,schema:o}]:[]}))}),[c.normalizedSchemaStore]),f=(0,r().K8)((()=>m&&(0,b().UU)(m)&&(0,d().O9)(m.connectedRelation.automationSettings)?m.connectedRelation.automationSettings:ie),[m]);(0,n.useEffect)((()=>{C(f)}),[f]),(0,n.useEffect)((()=>{if(!o&&g.length>0){if(null!=m&&m.connectedRelation.automation)for(const t of g)if(m.connectedRelation.automation[t.id])return void a(t);const e=g[0];a(e)}}),[g,m,o,a]);const[S,x]=(0,n.useState)(ne),[v,C]=(0,n.useState)(ie),w=(0,n.useCallback)((e=>{const o=c.collectionStore();if(!o||!m||!(0,b().nC)(m))return;const n=m.connectedRelation;n.automationSettings=e;const i={...m,connectedRelation:{...n}};D().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:s,canUndo:!0,perform:e=>{(0,O().F)({environment:s,collectionStore:o,update:{[t]:i},transaction:e})}}),C(e)}),[c,s,t,m]);(0,n.useEffect)((()=>{var e,t;o&&m&&(0,b().UU)(m)&&null!==(e=m.connectedRelation.automation)&&void 0!==e&&e[o.id]?x(null===(t=m.connectedRelation.automation)||void 0===t?void 0:t[o.id]):x(ne)}),[m,o]);const j=(0,n.useCallback)((e=>{const n=c.collectionStore();if(!(n&&o&&m&&(0,b().nC)(m)))return;const i=m.connectedRelation;if(!i||!o.id)return;i.automation={...i.automation,...e};const r={...m,connectedRelation:{...i}};(0,R().V)({environment:s,collectionContextStore:c,property:o.id,from:"github_pull_requests_property",action:"configure_github_pr_automation",githubAutomationConfigured:e}),D().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomation",environment:s,canUndo:!0,perform:e=>{(0,O().F)({environment:s,collectionStore:n,update:{[t]:r},transaction:e})}})}),[c,o,m,s,t]),M=(0,r().K8)((()=>o&&o.schema.options?o.schema.options:[]),[o]),T=(0,r().K8)((()=>{const e={};return M.forEach((t=>{e[t.id]=t})),e}),[M]),k=(0,r().K8)((()=>{var e,t;const n=null==o||null===(e=o.schema)||void 0===e?void 0:e.groups,i=null==o||null===(t=o.schema)||void 0===t?void 0:t.options;return n&&i?n.map((e=>{const t=i.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(d().O9):[]}),[o]);function B(e,t){const n=k.map((t=>{let{group:n,groupOptions:i}=t;const r=i.map((t=>({key:t.id,render:e=>(0,X.jsx)(K().A,{...e,focused:e.focused,isTokenTitle:!0,title:(0,X.jsx)(q().q,{format:A().NY.Small,value:t.value,color:t.color,showRemoveButton:!1,groupColor:n.color,isSingle:!0})}),action:()=>{const n={...S,[e]:t.id};o&&(j({[o.id]:n}),x(n))}}))).filter(d().O9);return{key:n.name,render:e=>(0,X.jsx)(y().A,{...e,title:n.name,topBorder:e.index>0}),items:r}}));if(S[e]){function i(){const n={...S,[e]:null};o&&(j({[o.id]:n}),x(n)),t.close()}const r={key:"removeOptionSection",render:e=>(0,X.jsx)(y().A,{...e,topBorder:!0}),items:[{key:"removeOptionButton",render:e=>(0,X.jsx)(K().A,{...e,focused:!1,title:l.formatMessage(ee.removeStatusOption),left:(0,I().I)({width:12}),onClick:i}),action:e=>{i()}}]};n.push(r)}return n}return(0,X.jsxs)(X.Fragment,{children:[o?(0,X.jsx)(y().A,{topBorder:!1,disableDesktopPadding:!0,disableMobilePadding:!0,title:(0,X.jsx)(le,{selectedStatusProperty:o,setSelectedStatusProperty:a,existingStatusProperties:g,intl:l}),children:(0,d().uv)(_).map((e=>(0,X.jsx)(L().A,{focused:!1,placementToOrigin:F().sx.Top,alignmentToOrigin:F().yP.End,popupType:p.isMobile?F().z7.SlideUp:F().z7.Popup,render:t=>{const o=p.isMobile?{menuType:G().gu.Modal,right:(0,X.jsx)(W().DoneMenuText,{}),onClickRight:t.close}:{menuType:G().gu.Popup,width:150};return(0,X.jsx)(H().A,{...o,children:(0,X.jsx)(z().Ay,{type:z().Oh.Vertical,sections:B(e,t),initialFocus:void 0,onAccept:t.close})})},renderOrigin:t=>{const n=S[e];let i=(0,X.jsx)("div",{style:u.noneText,children:oe});if(n){const e=T[n];if(e){var r;const t=null==o||null===(r=o.schema)||void 0===r||null===(r=r.groups)||void 0===r||null===(r=r.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(n)})))||void 0===r?void 0:r.color;i=(0,X.jsx)(q().q,{format:A().NY.Small,showRemoveButton:!1,isSingle:!0,value:e.value,color:e.color,groupColor:t})}}return(0,X.jsx)(Z().A,{...t,focused:!1,icon:()=>(0,X.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap"},children:[te[e],(0,X.jsx)(h().A,{size:8}),(0,P().Z)(u.automationMenuItemArrow)]}),title:(0,X.jsx)("div",{style:{width:"100%",display:"inline-flex",justifyContent:"flex-end"},children:i}),showChevron:!0,chevronStyle:{margin:0}})}},e)))}):(0,X.jsx)(ae,{setSelectedStatusProperty:a,intl:l}),(0,X.jsx)(y().A,{topBorder:!0,disableDesktopPadding:!0,disableMobilePadding:!0,title:l.formatMessage(ee.linkbackAndActivitySectionHeader),children:[(0,X.jsx)(Y().A,{renderTooltip:()=>l.formatMessage(ee.linkBacksToggleDescription),render:e=>(0,X.jsx)(J().A,{...e,title:l.formatMessage(ee.linkBacksToggle),onClick:()=>{w({...v,github_linkbacks:!v.github_linkbacks})},switcherProps:{on:v.github_linkbacks}})},"github_linkbacks"),(0,X.jsx)(Y().A,{renderTooltip:()=>l.formatMessage(ee.activityCommentsToggleDescription),render:e=>(0,X.jsx)(J().A,{...e,title:l.formatMessage(ee.activityCommentsToggle),onClick:()=>{w({...v,activity_comments:!v.activity_comments})},switcherProps:{on:v.activity_comments}})},"activity_comments")]})]})}function ae(e){const{setSelectedStatusProperty:t,intl:o}=e,n=(0,i().v3)(),r=(0,E().ET)(),a=ce();return(0,X.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,X.jsx)(V().A,{size:"100%",innerStyle:a.addStatusDivider}),(0,X.jsx)("div",{style:a.addStatusDescription,children:o.formatMessage(ee.addStatusDescription)}),(0,X.jsxs)(N().A,{style:a.addStatusButton,onClick:e=>{e.stopPropagation(),se(n,r,t)},children:[(0,k().W)({width:14}),(0,X.jsx)(h().A,{size:4}),o.formatMessage(ee.addStatusButton)]}),(0,X.jsx)(h().A,{size:4})]})}function le(e){const{selectedStatusProperty:t,setSelectedStatusProperty:o,existingStatusProperties:n,intl:r}=e,l=(0,i().v3)(),s=(0,E().ET)(),c=(0,i().Y0)(),p=ce(),u=(0,a().DP)(),m=n.map((e=>{const{id:t,schema:n}=e;return{key:t,action:()=>{o(e)},render:t=>(0,X.jsx)(K().A,{...t,icon:(0,X.jsx)(C().zB,{size:Q,theme:u,icon:e&&e.schema.icon,type:"status"}),title:n.name})}})).filter(d().O9),g={key:"newStatusProperty",action:()=>{se(l,s,o)},render:e=>(0,X.jsx)(K().A,{...e,icon:(0,k().W)(p.statusPickerIcon),title:r.formatMessage(ee.newStatusPropertyButton)})};return(0,X.jsxs)("div",{style:p.statusPickerWrapper,children:[(0,X.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[r.formatMessage(ee.autoUpdate),c.isMobile&&(0,X.jsx)(h().A,{size:4}),(0,X.jsx)(F().Ay,{placementToOrigin:F().sx.Bottom,alignmentToOrigin:F().yP.Start,popupType:c.isMobile?F().z7.SlideUp:F().z7.Popup,renderOrigin:e=>(0,X.jsx)(K().A,{...e,title:t.schema.name,focused:!1,style:p.statusPickerButtonCore,textWrapperStyle:p.statusPickerButtonTextWrapper,left:(0,X.jsx)(C().zB,{size:Q,theme:u,icon:t.schema.icon,type:"status"}),leftStyle:{marginLeft:2},showExtensionArrow:!0,extensionArrowStyle:p.statusPickerExtensionArrow}),render:e=>{const t=c.isMobile?{menuType:G().gu.ActionSheet}:{menuType:G().gu.Popup,width:150};return(0,X.jsx)(H().A,{...t,children:(0,X.jsx)(z().Ay,{type:z().Oh.Vertical,sections:[{key:0,render:e=>(0,X.jsx)(y().A,{...e}),items:[...m,g]}],initialFocus:0,onAccept:e.close})})}})]}),c.isMobile&&(0,X.jsx)(h().A,{size:4}),r.formatMessage(ee.when)]})}function se(e,t,o){const n=t.collectionStore();n&&D().createAndCommit({userAction:"CollectionSettingsConfigureGithubAutomationCreateNewStatusProperty",environment:e,canUndo:!0,perform:i=>{const r=B().IL({environment:e,collectionStore:n,collectionViewArgs:void 0,propertyType:"status",transaction:i}),a=(0,$().Jq)(t,r);a&&(0,b().DD)(a)&&o({id:r,schema:a})}})}function ce(){const e=(0,i().Y0)().isMobile;return(0,a().IS)((t=>({addStatusDivider:{borderColor:t.tableDividerColor},addStatusDescription:{width:"calc(100% - 24px)",padding:e?"16px 8px":"14px 0px",fontSize:e?16:12,color:t.text.tertiary},addStatusButton:{width:"calc(100% - 24px)",display:"inline-flex",alignItems:"center",justifyContent:"center"},noneText:{color:t.text.tertiary},automationMenuItemArrow:{width:12,fill:t.icon.tertiary,stroke:t.icon.tertiary,strokeOpacity:.5,strokeWidth:2},statusPickerWrapper:{display:"inline-flex",alignItems:"center",flexWrap:"wrap",rowGap:2,marginBottom:e?10:void 0},statusPickerButtonTextWrapper:{margin:"0px 4px",fontSize:12},statusPickerButtonCore:{minHeight:e?28:20,borderRadius:5,maxWidth:e?150:100},statusPickerIcon:{width:Q,height:Q},statusPickerExtensionArrow:{transform:"rotate(180deg)",marginRight:2}})),[e])}var de=()=>o(283860);const pe=(0,c().YK)({connect:{defaultMessage:"Connect to GitHub (Workspace)",id:"database.viewSettings.githubConfigTab.connect"},connectDescriptionAdmin:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) connection.",id:"database.viewSettings.githubConfigTab.connectDescriptionAdmin"},authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.githubConfigTab.authError"},tabDescriptionNoIdPrefix:{defaultMessage:"This feature requires a prefixed ID property to link GitHub PRs to Notion {pluralItemName}.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoIdPrefix"},tabDescriptionNoStatus:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title.",id:"database.viewSettings.githubConfigTab.tabDescriptionNoStatus"},tabDescription:{defaultMessage:"Link PRs by adding the {singleItemName} ID to the PR title. Set up automated status updates in Notion based on PR status changes.",id:"database.viewSettings.githubConfigTab.tabDescription"}});function ue(e){let{collectionContextStore:t,intl:o}=e;const n=ve(),{hoveredBackground:a,pressedBackground:l}=xe(),s=(0,S().J)(),c=(0,i().v3)(),d=Se(),g=function(e){return(0,r().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSpaceId()}),[e])}(t);return(0,X.jsxs)(y().A,{disableMobileBorders:!0,mobileStyle:n.previewContentContainer,style:n.previewContentContainer,children:[(0,X.jsx)("img",{src:"/images/external_integrations/github-icon.png",style:{width:36,height:36}}),(0,X.jsx)("p",{style:n.connectDescription,children:s?(0,m().Jb)().description:o.formatMessage(pe.connectDescriptionAdmin)}),(0,X.jsx)(f().p,{style:n.connectButton,hoveredStyle:{background:a},pressedStyle:{background:l},disabled:!s,disabledFeedback:!s,onClick:async e=>{if(e.preventDefault(),g&&d)try{await u().Jq({environment:c,spaceId:g,integration:d,from:"connected_relation_property_menu"})}catch(t){const e=o.formatMessage(pe.authError);p().f1(e)}},children:o.formatMessage(pe.connect)}),(0,X.jsx)(h().A,{size:4})]})}function me(e){let{collectionContextStore:t}=e;const o=ve(),{isMobile:n}=(0,i().Y0)(),r=he(t);return(0,X.jsxs)(y().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:o.previewContentContainer,style:o.previewContentContainer,children:[(0,X.jsx)(h().A,{size:n?16:8}),(0,X.jsx)(de().A,{width:"calc(100% - 24px)",uniqueIdPrefix:null==r?void 0:r.prefix})]})}function ge(e){let{collectionContextStore:t,intl:o,selectedStatusProperty:n}=e;const i=(0,r().K8)((()=>t.databaseType),[t]),a=he(t),l=ve(),s=(0,g().$O)(i),c=(0,g().oj)(i);let d;return d=a&&a.prefix?n?o.formatMessage(pe.tabDescription,{singleItemName:s}):o.formatMessage(pe.tabDescriptionNoStatus,{singleItemName:s}):o.formatMessage(pe.tabDescriptionNoIdPrefix,{pluralItemName:c}),(0,X.jsx)(y().A,{disableMobileBorders:!0,disableMobilePadding:!0,mobileStyle:l.tabDescription,style:l.tabDescription,children:d})}function fe(e){let{collectionContextStore:t}=e;const o=he(t);return o&&o.prefix?null:(0,X.jsx)(v().A,{collectionContextStore:t,uniqueIdProperty:o&&{propertyId:o.id,propertySchema:o.schema},prefixValue:null==o?void 0:o.prefix})}function ye(e){let{collectionContextStore:t,selectedStatusProperty:o,setSelectedStatusProperty:n,property:i,intl:r}=e;const a=he(t);return a&&a.prefix?(0,X.jsx)(re,{selectedStatusProperty:o,setSelectedStatusProperty:n,gitHubProperty:i,intl:r}):null}function he(e){return(0,r().K8)((()=>{var t,o;const n=null===(t=e.collectionStore())||void 0===t||null===(t=t.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),i=null===(o=e.collectionStore())||void 0===o?void 0:o.getSchema(),r=i&&(0,d().WP)(i).find((e=>{let[,t]=e;return t&&"auto_increment_id"===t.type}));if(r){const[e,t]=r;if(t&&"auto_increment_id"===t.type)return{id:e,schema:t,prefix:n}}}),[e])}function Se(){return(0,r().K8)((()=>x().A.integrations.state.find((e=>e.id===l().ob))),[])}function xe(){const e=Se(),t=(0,a().DP)();return(0,r().K8)((()=>(0,s().u)(e,t.mode)),[e,t.mode])}function ve(){const{isMobile:e}=(0,i().Y0)(),{background:t}=xe();return(0,a().IS)((o=>({previewContentContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},connectButton:{fontSize:14,maxWidth:"calc(100% - 24px)",height:void 0,color:o.text.contrastPrimary,background:t,whiteSpace:"normal",padding:8,textAlign:"center"},connectDescription:{maxWidth:"calc(100% - 24px)",color:o.text.tertiary,fontSize:14,textAlign:"center"},tabDescription:{padding:e?18:14,fontSize:e?16:12,color:o.text.tertiary}})),[e,t])}const be=(0,c().j4)((function(e){const{collectionContextStore:t,property:o,intl:i}=e,[a,s]=(0,n.useState)(void 0);return(0,r().K8)((()=>{const e=x().A.bots.state.find((e=>e.integration_id===l().ob));return Boolean(e)}),[])?(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(me,{collectionContextStore:t}),(0,X.jsx)(ge,{collectionContextStore:t,intl:i,selectedStatusProperty:a}),(0,X.jsx)(fe,{collectionContextStore:t}),(0,X.jsx)(ye,{collectionContextStore:t,selectedStatusProperty:a,setSelectedStatusProperty:s,property:o,intl:i})]}):(0,X.jsx)(ue,{collectionContextStore:t,intl:i})}))},181922:(e,t,o)=>{o.d(t,{g:()=>a});var n=()=>o(302107),i=()=>o(972435),r=()=>o(901389);function a(e){const{collectionContextStore:t,propertyId:o,propertySchema:a,handlePropertyTypeChange:l}=e,s=t.collectionStore();if(s)if(a&&(0,n().dR)({propertyId:o,propertyType:a.type,permissionItems:s.getPermissionItems()})){const e=[{label:i().A.formatMessage(n().DZ.changePropertyTypeWarningButtonLabel),color:"red",onAccept:l}];r().ui({showCancel:!0,keepFocus:!1,message:i().A.formatMessage(n().DZ.changePropertyTypeWarningMessage),description:i().A.formatMessage(n().DZ.changePropertyTypeWarningDescription),mode:"wide",items:e})}else l()}},208698:(e,t,o)=>{o.d(t,{$:()=>s});var n=o(296540),i=()=>o(484714),r=()=>o(959013),a=()=>o(383594),l=()=>o(486666);function s(e){const{iconButton:t,onDelete:o}=e,s=(0,i().v3)(),c=(0,r().tz)();return(0,n.useCallback)((e=>{if(!(t&&e.target instanceof Element))return;const{onSubmit:n,enforceIconColor:i}=t;a().W(s,{originRect:e.target.getBoundingClientRect(),originGap:3,popupHeight:l().GF,popupWidth:l().jv,showArrow:!0,title:c.formatMessage({defaultMessage:"Icon",id:"mediaPicker.tabs.icon"}),currentTab:"icon",tabs:[{type:"icon",enforceIconColor:i,onChange:(e,t)=>{n(e),t&&t.keepVisible||a().I()}}],onDelete:()=>{null==o||o(),n(),a().I()}})}),[s,t,c,o])}},283860:(e,t,o)=>{o.d(t,{A:()=>d});o(296540);var n=()=>o(484714),i=()=>o(401497),r=()=>o(148307),a=()=>o(959013),l=()=>o(284371),s=()=>o(132389),c=o(474848);function d(e){const t=(0,a().tz)(),o=function(e){const{isMobile:t}=(0,n().Y0)(),o=t?18:14,r=1,a=6,s=20;return(0,i().IS)((t=>({githubContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:e||"90%",padding:s,border:`${r}px solid ${t.tableDividerColor}`,borderRadius:a,borderBottomRightRadius:6,cursor:"default"},githubPrTitleRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:`calc(100% + ${s}px)`,overflow:"hidden"},githubPrTitle:{display:"inline-flex",fontSize:o,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",background:t.whiteButtonBackground,padding:"2px 4px",borderTopLeftRadius:5,borderBottomLeftRadius:5,borderLeft:`2px solid ${t.blueColor}`,borderTop:`2px solid ${t.blueColor}`,borderBottom:`2px solid ${t.blueColor}`,width:"100%"},githubTask:{background:"light"===t.mode?t.palette.blue[50]:t.palette.blue[400]},githubPrInfoRow:{display:"inline-flex"},githubPrInfoPill:{display:"flex",flexDirection:"row",alignItems:"center",width:"fit-content",padding:"4px 10px",borderRadius:"2em",background:"#238636",flexShrink:0,...l().RC},githubPrInfoOpenText:{color:"white",fontSize:o-2,fontWeight:500},githubPrInfoMergeInto:{display:"inline-flex",alignItems:"center",fontSize:o-2,color:t.text.tertiary,...l().RC},githubPrInfoMain:{padding:"0px 4px",fontFamily:l().Tf.githubMono,background:t.cardPressedBackground,borderRadius:a,color:t.text.primary,verticalAlign:"text-bottom",...l().RC}})),[o,e])}(e.width),d=(0,c.jsx)("div",{id:"github-preview-github-pr-title-row",style:o.githubPrTitleRow,children:(0,c.jsxs)("div",{id:"github-preview-github-pr-title-wrapper",style:o.githubPrTitle,children:[(0,c.jsx)(s().A,{size:2}),"[",(0,c.jsxs)("div",{id:"github-preview-github-pr-task",style:o.githubTask,children:[e.uniqueIdPrefix||t.formatMessage(p.idPrefix),e.uniqueIdValue?`-${e.uniqueIdValue}`:"-1"]}),"]",(0,c.jsx)(s().A,{size:2}),t.formatMessage(p.prTitle)]})}),u=(0,c.jsxs)("div",{id:"github-preview-github-pr-info-row",style:o.githubPrInfoRow,children:[(0,c.jsxs)("div",{id:"github-preview-github-open-pr-pill",style:o.githubPrInfoPill,children:[(0,c.jsx)("img",{src:r().A.images.externalIntegrations.githubPullOpenIconWhitePng,style:{width:16,height:16}}),(0,c.jsx)(s().A,{size:2}),(0,c.jsx)("div",{style:o.githubPrInfoOpenText,children:t.formatMessage(p.open)})]}),(0,c.jsx)(s().A,{size:8}),(0,c.jsx)("div",{id:"github-preview-github-merge-into-main",style:o.githubPrInfoMergeInto,children:(0,c.jsxs)("span",{style:o.githubPrInfoMergeInto,children:[t.formatMessage(p.mergeInto),(0,c.jsx)(s().A,{size:4}),(0,c.jsx)("span",{style:o.githubPrInfoMain,children:t.formatMessage(p.main)})]})})]});return(0,c.jsxs)("div",{id:"github-preview-github-container",style:o.githubContainer,children:[d,(0,c.jsx)(s().A,{size:12}),u]})}const p=(0,a().YK)({idPrefix:{defaultMessage:"TASK",id:"database.viewSettings.githubConfigTab.preview.idPrefix"},prTitle:{defaultMessage:"GitHub PR Title",id:"database.viewSettings.githubConfigTab.preview.prTitle"},open:{defaultMessage:"Open",id:"database.viewSettings.githubConfigTab.preview.open"},mergeInto:{defaultMessage:"Merge into",id:"database.viewSettings.githubConfigTab.preview.mergeInto"},main:{defaultMessage:"main",id:"database.viewSettings.githubConfigTab.preview.main"}})},419167:(e,t,o)=>{o.d(t,{Ay:()=>_,GI:()=>M,Ve:()=>k,am:()=>T,jD:()=>P});var n=o(296540),i=()=>o(56366),r=()=>o(401497),a=()=>o(869190),l=()=>o(651124),s=()=>o(116089),c=()=>o(340498),d=()=>o(72135),p=()=>o(959013),u=()=>o(534177),m=()=>o(416726),g=()=>o(312540),f=()=>o(497222),y=()=>o(877568),h=()=>o(227440),S=()=>o(217429),x=()=>o(807778),v=()=>o(329304),b=()=>o(135221),C=()=>o(8980),A=()=>o(859428),w=o(474848);const j=36e5;function M(e){let{autofillFeatureAvailability:t}=e;const o=(0,i().K8)((()=>(0,x().Le)()),[])?(0,w.jsx)(p().sA,{...g().fillAllPagesMessages.fillAllPagesAddAiMessage}):(0,w.jsx)(p().sA,{...g().fillAllPagesMessages.fillAllPagesAddOnMessage});return(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,w.jsx)(p().sA,{...g().fillAllPagesMessages.fillAllPagesTooltip})}),!(0,v().e2)(t)&&(0,w.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:o})]})}function T(e){let{updateAiInferencesTaskStatus:t,iconStyle:o,progressIconStyle:n}=e;return(0,y()._)({taskRunningState:t})?(0,w.jsx)("div",{style:n,children:(0,w.jsx)(b().A,{})}):(0,w.jsx)("div",{style:{display:"flex",alignItems:"center",height:"100%"},children:(0,w.jsx)(C().I,{icon:s().x,style:o})})}function _(e){let{updateAiInferencesTaskStatus:t}=e;const o=(0,p().tz)(),l=(0,i().K8)((()=>S().default.checkGate({gateName:"autofill_all_pages_use_new_endpoint"})?(0,w.jsx)(p().sA,{defaultMessage:"Autofill this view",id:"aiAutofill.fillAllPagesInView.buttonTitle"}):(0,w.jsx)(p().sA,{defaultMessage:"Autofill all pages",id:"aiAutofill.fillAllPages.buttonTitle"})),[]),s=(0,n.useMemo)((()=>{switch(t.status){case"requested":return(0,w.jsx)(p().sA,{defaultMessage:"Requested Autofill",id:"AiAutofill.fillAllPages.requested"});case"notRunning":case"error":return l;case"running":const e=0!==t.lastEditedTime&&Date.now()-t.lastEditedTime>j;return t.numPagesFilled>=t.numPagesRequested||e?l:(0,w.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",gap:"4px"},children:[(0,w.jsx)(p().sA,{defaultMessage:"{numPagesRequested, plural, one {Autofilling {numPagesFilled} of {numPagesRequested} page} other {Updating {numPagesFilled} of {numPagesRequested} pages}}",id:"aiAutofill.fillallPages.updatingAllPagesWithProgress",values:{numPagesFilled:(0,d().ZV)(t.numPagesFilled,"compact",o),numPagesRequested:(0,d().ZV)(t.numPagesRequested,"compact",o)}}),0!==t.lastEditedTime&&(0,w.jsx)("div",{style:{fontSize:"12px"},children:(0,w.jsx)(p().sA,{defaultMessage:"Last edited: {lastEditedTime}",id:"aiAutofill.fillallPages.lastEditedTime",values:{lastEditedTime:(0,a().W_)(t.lastEditedTime,"month_day_time",o.locale)}})})]});default:(0,u().HB)(t)}}),[l,o,t]),c=(0,r().IS)((()=>({textWrapper:{display:"flex",alignItems:"center",overflow:"hidden"}})),[]);return(0,w.jsx)("div",{style:c.textWrapper,children:s})}function P(e){let{updateAiInferencesTaskStatus:t}=e;const o=(0,r().IS)((e=>({inner:{background:e.palette.purple[400],height:"100%",transition:"width .5s"},outer:{background:e.palette.gray[100],height:3,borderRadius:2,minWidth:120,overflow:"hidden",marginTop:8}})),[]);switch(t.status){case"notRunning":case"requested":case"error":return null;case"running":break;default:(0,u().HB)(t)}const{numPagesFilled:n,numPagesRequested:i}=t;return 0===i||n===i?null:(0,w.jsx)("div",{style:o.outer,role:"progressbar",children:(0,w.jsx)("div",{style:{...o.inner,width:100*Math.min(n/i,1)+"%"}})})}function k(e){const{environment:t,collectionContextStore:o,property:r,propertySchema:a,autofillFeatureAvailability:s,isAutofillSetupEnabled:d}=e,u=!(0,i().O$)(h().e),S=(0,i().K8)((()=>{const e=o.collectionStore();return e?(0,l().Ts)(e.getFormat(),r):{status:"notRunning"}}),[o,r]),x=(0,n.useCallback)((async e=>{const n=o.collectionStore(),i=o.collectionViewStore();n&&a&&i&&((0,v().e2)(e)?await g().autofillPropertyForCollection({environment:t,collectionStore:n,propertySchema:a,property:r,collectionViewStore:i}):g().triggerAiAutofillUpsell({environment:t,from:"ai_autofill_fill_all_pages",upsell:e.upsell}))}),[t,a,r,o]),b=(0,y()._)({taskRunningState:S});return(0,w.jsx)(A().A,{disableTooltip:(0,v().e2)(s),renderTooltip:()=>u?(0,w.jsx)(p().sA,{...m().AY.aiUnavailableOfflineTooltip}):(0,w.jsx)(M,{autofillFeatureAvailability:s}),render:e=>(0,w.jsx)(f().A,{icon:e=>(0,w.jsx)(T,{updateAiInferencesTaskStatus:S,iconStyle:e,progressIconStyle:{width:c().Ev.sm,marginTop:4,marginLeft:4,marginRight:2}}),title:(0,w.jsx)(_,{updateAiInferencesTaskStatus:S}),caption:b&&"requested"!==S.status&&(0,w.jsx)(P,{updateAiInferencesTaskStatus:S}),focused:!1,onClick:()=>x(s),disabled:b||!d||u,...e})})}},471095:(e,t,o)=>{o.d(t,{i:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.97 1.95 12.05 15.66",svg:(0,o(474848).jsx)("path",{d:"M6 5.95a4 4 0 1 1 8 0v1.433a2.426 2.426 0 0 1 2.025 2.392v5.4A2.425 2.425 0 0 1 13.6 17.6H6.4a2.425 2.425 0 0 1-2.425-2.425v-5.4c0-1.203.876-2.201 2.025-2.392zm6.75 1.4v-1.4a2.75 2.75 0 1 0-5.5 0v1.4zm-2.2 5.458a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"})},i=(0,o(340498).wt)("lockFill",n)},513489:(e,t,o)=>{o.d(t,{Z:()=>y,o:()=>h});var n=o(296540),i=()=>o(484714),r=()=>o(970013),a=()=>o(965134),l=()=>o(959013),s=()=>o(901952),c=()=>o(751156),d=()=>o(312296),p=()=>o(852353),u=o(474848);function m(e,t,o){return"1"===e?"relation"===t?o&&!0===o?(0,u.jsx)(l().sA,{defaultMessage:"1 item",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.connectedRelation"}):(0,u.jsx)(l().sA,{defaultMessage:"1 page",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne.relation"}):(0,u.jsx)(l().sA,{defaultMessage:"1 {type}",id:"database.viewSettings.collectionPropertyLimitHelpers.limitOne",values:{type:p().dC[t]}}):"no_limit"===e?(0,u.jsx)(l().sA,{defaultMessage:"No limit",id:"database.viewSettings.collectionPropertyLimitHelpers.noLimit"}):void 0}function g(e,t,o){return{key:e,type:"button",title:m(e,t,o)}}var f=()=>o(828973);function y(e){const{property:t,propertySchema:o,collectionContextStore:a}=e,l=(0,i().v3)(),p=(0,n.useCallback)((e=>{const n=a.collectionStore();if(!n||!(0,r().sO)(o))return;const i={...o,limit:Number(e)?1:void 0};c().createAndCommit({userAction:"CollectionSettingsLimitOptions.handleLimitChange",environment:l,canUndo:!0,perform:e=>{(0,d().F)({environment:l,collectionStore:n,update:{[t]:i},transaction:e})}});const p=Number(e)?`${o.type}_toggle_limit_on`:`${o.type}_toggle_limit_off`;(0,s().V)({environment:l,collectionContextStore:a,property:t,from:"view_settings",action:p})}),[a,l,t,o]);return(0,r().sO)(o)?"relation"===o.type&&o.connectedRelation?(0,u.jsx)(h,{propertyType:o.type,connectedRelation:!0,selectedKey:o.limit?"1":"no_limit",onChange:p}):(0,u.jsx)(h,{propertyType:o.type,selectedKey:o.limit?"1":"no_limit",onChange:p}):null}function h(e){const{propertyType:t,selectedKey:o,connectedRelation:n,onChange:i}=e;return(0,u.jsx)(f().A,{icon:a().i,title:(0,u.jsx)(l().sA,{defaultMessage:"Limit",id:"database.viewSettings.collectionPropertyLimitHelpers.limit"}),selectedKey:o,popupStyle:{minWidth:190},options:[g("1",t,n),g("no_limit",t)],onChange:i})}},645395:(e,t,o)=>{o.d(t,{j:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("properties",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.91602 4.83789C2.44238 4.83789 2.87305 4.40723 2.87305 3.87402C2.87305 3.34766 2.44238 2.91699 1.91602 2.91699C1.38281 2.91699 0.952148 3.34766 0.952148 3.87402C0.952148 4.40723 1.38281 4.83789 1.91602 4.83789ZM5.1084 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.1084C4.74609 3.22461 4.45898 3.51172 4.45898 3.87402C4.45898 4.23633 4.74609 4.52344 5.1084 4.52344ZM1.91602 9.03516C2.44238 9.03516 2.87305 8.60449 2.87305 8.07129C2.87305 7.54492 2.44238 7.11426 1.91602 7.11426C1.38281 7.11426 0.952148 7.54492 0.952148 8.07129C0.952148 8.60449 1.38281 9.03516 1.91602 9.03516ZM5.1084 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H5.1084C4.74609 7.42188 4.45898 7.70898 4.45898 8.07129C4.45898 8.43359 4.74609 8.7207 5.1084 8.7207ZM1.91602 13.2324C2.44238 13.2324 2.87305 12.8018 2.87305 12.2686C2.87305 11.7422 2.44238 11.3115 1.91602 11.3115C1.38281 11.3115 0.952148 11.7422 0.952148 12.2686C0.952148 12.8018 1.38281 13.2324 1.91602 13.2324ZM5.1084 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H5.1084C4.74609 11.6191 4.45898 11.9062 4.45898 12.2686C4.45898 12.6309 4.74609 12.918 5.1084 12.918Z"})})},653259:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(959013),i=()=>o(381349),r=()=>o(125565),a=o(474848);function l(e){return(0,a.jsx)(r().A,{isMultiline:!0,style:{paddingTop:8,marginLeft:16,marginRight:16,color:i().Ay.red,...e.styles},children:(0,a.jsx)(n().sA,{id:"database.viewSettings.propertyTab.duplicatePropertyNameError",defaultMessage:"A property named {propertyName} already exists in this database.",values:{propertyName:e.propertyName}})})}},656704:(e,t,o)=>{o.d(t,{y:()=>r});var n=()=>o(597777);const i=(0,o(959013).YK)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function r(e){const{reminder:t,shouldShowTime:o,intl:r,formatTime:a}=e;if(n().DG(t)){if(n().fc(t)){const{unit:e,value:n,time:l}=t,s=a({start_time:l,time_format:"LT",humanReadable:!0,intl:r}),c=o?`(${s})`:"";return 0===n?r.formatMessage(i.onTheDay,{formattedTimeText:c}):"day"===e?r.formatMessage(i.daysBefore,{formattedTimeText:c,numberOfDays:n}):"year"===e?r.formatMessage(i.yearsBefore,{formattedTimeText:c,numberOfYears:n}):"month"===e?r.formatMessage(i.monthsBefore,{formattedTimeText:c,numberOfMonths:n}):r.formatMessage(i.weeksBefore,{formattedTimeText:c,numberOfWeeks:n})}{const{unit:e,value:o}=t;return 0===o?r.formatMessage(i.atTimeOf):"hour"===e?r.formatMessage(i.hoursBefore,{numberOfHours:o}):r.formatMessage(i.minutesBefore,{numberOfMinutes:o})}}return r.formatMessage(i.none)}},755735:(e,t,o)=>{o.d(t,{B:()=>a});var n=o(296540),i=()=>o(419357),r=o(474848);const a=n.forwardRef((function(e,t){const{placeholder:a,focusInitial:l,selectAll:s,disabled:c,inputOuterStyle:d,iconButton:p,inputRightButton:u,initialValue:m,onBlur:g,onSubmit:f,onChange:y,maxLength:h,textWrapperStyle:S,textarea:x}=e,[v,b]=(0,n.useState)((()=>m||"")),C=(0,n.useCallback)((()=>{g(v)}),[v,g]),A=(0,n.useCallback)((()=>{f(v)}),[v,f]),w=(0,n.useCallback)((e=>{const t=e.target.value;b(t),null==y||y(t)}),[y]),j=(0,o(208698).$)({iconButton:p}),M=(0,o(336811).O)();(0,n.useEffect)((()=>()=>{M.current&&m!==v&&g(v)}),[m,v,M,g]);const T=(0,o(401497).IS)((()=>({iconButton:{opacity:c?.4:void 0},textWrapper:{opacity:c?.4:void 0,...S}})),[c,S]);return(0,r.jsx)(i().Ay,{ref:t,focusInitial:l,autoFocus:!!l||void 0,selectAll:s,value:v,onChange:w,onBlur:C,onSubmit:A,placeholder:a,disabled:c,textWrapperStyle:T.textWrapper,maxlength:h,inputOuterStyle:d,left:p?(0,r.jsx)(i().KF,{iconLeading:p.iconLeading,iconStyle:p.iconStyle,onClick:j,disabled:c,style:T.iconButton,backgroundColor:p.backgroundColor}):null,showClearButton:!1,inputRight:u,textarea:x})}))},854593:(e,t,o)=>{o.d(t,{q:()=>h});o(944114),o(296540);var n=()=>o(302107),i=()=>o(959013),r=()=>o(284371),a=()=>o(521358),l=()=>o(16006),s=()=>o(972435),c=()=>o(685889),d=()=>o(470928),p=()=>o(290966),u=()=>o(204067),m=()=>o(27732),g=()=>o(901389),f=()=>o(751156),y=o(474848);async function h(e){const{environment:t,collectionContextStore:o,property:h,handleDeleteAccept:S}=e,x=o.collectionStore();if(!x)return;if(x.isTypedProperty(h)){if(await a().nD({environment:t,property:h,collectionContextStore:o,theme:e.theme,from:e.from}))return}const v=(0,u().R5)({environment:t,collectionStore:x,propertyId:h});if(v.length>0){if((0,p().E_)({environment:t,collectionStore:x,propertyId:h,compoundTemplateInstancesToDelete:v,collectionContextStore:o,from:e.from}))return}else if(((0,d().k$)(h)||(0,d().Do)({collectionStore:x,propertyId:h}))&&(0,d().aF)(x)&&(0,d().Io)()){if((0,p().I5)({environment:t,collectionStore:x,propertyId:h,collectionContextStore:o,from:e.from}))return}const b=o.normalizedSchemaStore.state,C=b[h],A=c().pg(o,C);await(null==A?void 0:A.load());const w=A&&c().D5(o,h,A),j=A&&c().uf(A),M=A&&x.id===A.id,T=[{label:(0,y.jsx)(i().sA,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:S}];let _,P;if(w&&x&&j&&!M&&T.push({label:(0,y.jsx)(i().sA,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{f().createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,canUndo:!0,perform:e=>{if(C&&"relation"===C.type&&C.property&&A){const o=C.property,n=A.getSchema();m().C4({environment:t,collectionStore:A,propertySchema:n[o],property:o,targetPropertyID:void 0,autoRelate:x.isSyncedCollection()&&!A.isSyncedCollection()?{enabled:!1}:C.autoRelate,transaction:e})}m().t$({environment:t,collectionStore:x,property:h,transaction:e})}})}}),"auto_increment_id"===(null==C?void 0:C.type))_=c().me(b)?(0,y.jsx)(i().sA,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,y.jsx)(i().sA,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==C?void 0:C.type)){const e=c().AX(b);if(e){const t=e.connectedRelation.automation;t&&t[h]&&(_=(0,y.jsx)(i().sA,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else A&&j&&!M&&w?_=(0,y.jsx)(i().sA,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,y.jsx)(l().A,{style:{display:"inline",fontWeight:r().Wy.medium},store:A})}}):C&&(0,n().dR)({propertyId:h,propertyType:C.type,permissionItems:x.getPermissionItems()})&&(P=s().A.formatMessage(n().DZ.deletePropertyTypeWarningMessage),_=s().A.formatMessage(n().DZ.deletePropertyTypeWarningDescription));g().ui({message:P||(0,y.jsx)("span",{children:(0,y.jsx)(i().sA,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property from {databaseName}? It will be removed from all views.",values:{databaseName:(0,y.jsx)(l().A,{style:{display:"inline",fontWeight:r().Wy.bold},shouldWrap:!0,store:x})}})}),description:_,showCancel:!0,keepFocus:!0,items:T,mode:"wide"})}},860037:(e,t,o)=>{o.d(t,{A:()=>h});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(401497),a=()=>o(584262),l=()=>o(73337),s=()=>o(959013),c=()=>o(284371),d=()=>o(296798),p=()=>o(187820),u=()=>o(16006),m=()=>o(492414),g=()=>o(263711),f=()=>o(497222),y=o(474848);function h(e){const{isSelfRelation:t,collectionStore:o,showAs:h,disabled:S,onClick:x}=e,v=(0,i().K8)((()=>Boolean(o)),[o]),b=(0,i().K8)((()=>null==o?void 0:o.getIcon()),[o]),C=(0,i().K8)((()=>{if(t)return;const e=null==o?void 0:o.getParentBlockStore();return e&&(0,m().Ay)({store:e,pageVisitSource:a().y8.LinkInPage})}),[o,t]),A=(0,n().Y0)(),w=(0,r().IS)((e=>({linkBox:{display:"flex",alignItems:"center"},linkTitle:{color:e.text.primary,fontWeight:c().Wy.semibold,fontSize:14,marginLeft:4*(A.isRetina?.5:1),wordBreak:"break-word",...c().RC},chevronTitle:{display:"inline",wordBreak:"break-word",...c().RC}})),[A]),j=(0,i().K8)((()=>g().g.state.isOpen&&"layout-editor"===g().g.state.mode),[]),M=(0,y.jsx)(p().B6,{icon:b,iconRecordCategory:"collection",isEmptyPage:!1,size:20,disabled:!0});return(0,y.jsx)(f().A,{icon:l().P,title:(0,y.jsx)(s().sA,{defaultMessage:"Related to",id:"database.viewSettings.editRelation.targetLink.title"}),showChevron:"chevron"===h,onClick:x,disabled:S,right:t?(0,y.jsx)(s().sA,{defaultMessage:"This database",id:"database.viewSettings.editRelation.selfRelationTarget.title"}):"link"===h&&C?(0,y.jsxs)(d().A,{external:j,href:C,innerStyle:w.linkBox,children:[M,(0,y.jsx)(u().A,{store:o,underline:!0,style:w.linkTitle,maxLength:15})]}):v?(0,y.jsxs)(y.Fragment,{children:[M,(0,y.jsx)(u().A,{store:o,style:w.chevronTitle})]}):(0,y.jsx)(s().sA,{defaultMessage:"No target",id:"database.viewSettings.editRelation.noTarget.title"}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}})}},864913:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(296540),i=()=>o(959013),r=o(474848);function a(e){let{setAiInference:t,aiInference:a,disabled:l}=e;const s=(0,n.useRef)(o(206267).JW()),c=()=>{if(!a)return;const e={...a,add_options:!a.add_options};t(e)};return(0,r.jsx)(o(859428).A,{renderTooltip:()=>(0,r.jsx)(i().sA,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.description",defaultMessage:"New options are created based on property name & page details"}),placement:o(962730).W.Bottom,render:e=>(0,r.jsx)(o(497222).A,{title:(0,r.jsx)(i().sA,{id:"collectionSettingsAiAutofillAddOptionsToggle.title.text",defaultMessage:"Generate new options"}),showChevron:!1,right:(0,r.jsx)(o(946548).A,{inputId:s.current,on:Boolean(null==a?void 0:a.add_options),onClick:c,disabled:!1,noColor:!1}),onClick:c,disabled:Boolean(l),textWrapperStyle:{minWidth:"auto"},...e})})}const l=n.memo(a)},871114:(e,t,o)=>{o.d(t,{o:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.12 4.12 15.76 12.16",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M16.625 8A2.625 2.625 0 0 0 14 5.375h-1.42a.625.625 0 1 1 0-1.25H14a3.875 3.875 0 0 1 0 7.75H4.259l3.333 3.333a.625.625 0 0 1-.884.884l-4.4-4.4a.625.625 0 0 1 0-.884l4.4-4.4a.625.625 0 0 1 .884.884l-3.333 3.333H14A2.625 2.625 0 0 0 16.625 8"})},i=(0,o(340498).wt)("arrowUTurnDownLeft",n)},875909:(e,t,o)=>{o.d(t,{oX:()=>Ao,t_:()=>eo,lI:()=>_o});o(16280),o(944114),o(898992),o(354520),o(672577),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(970013),s=()=>o(713998),c=()=>o(742117),d=()=>o(89849),p=()=>o(471095),u=()=>o(105819),m=()=>o(236262),g=()=>o(798880),f=()=>o(959013),y=()=>o(381349),h=()=>o(534177),S=()=>o(59400),x=()=>o(901952),v=()=>o(436696),b=()=>o(966759),C=()=>o(235191),A=()=>o(686526),w=()=>o(854593),j=()=>o(896628),M=()=>o(4319),T=()=>o(751156),_=()=>o(272200),P=()=>o(313892),k=()=>o(895876),I=()=>o(324587),R=()=>o(831566),B=()=>o(797535),D=()=>o(312296),O=()=>o(654062),K=()=>o(519839),F=()=>o(419167),L=()=>o(864913),V=()=>o(8980),H=()=>o(89924),z=()=>o(859428),W=()=>o(798174),N=()=>o(852353),Y=()=>o(673730),q=()=>o(495159),E=()=>o(68465),U=()=>o(972435),G=()=>o(722872),$=()=>o(836251),Z=()=>o(963589),J=()=>o(148307),X=()=>o(340498),Q=o(474848);const ee=(0,X().wt)("numbers",{viewBox:"0 0 22 12",svg:(0,Q.jsx)("path",{d:"M2.91732 11V2.50293H2.80795L0.299156 4.32129V3.02246L2.92416 1.13574H4.14779V11H2.91732ZM6.73438 11V10.1523L10.0703 6.54297C10.4896 6.08724 10.8177 5.71126 11.0547 5.41504C11.2917 5.11426 11.458 4.8431 11.5537 4.60156C11.6494 4.36003 11.6973 4.0957 11.6973 3.80859V3.79492C11.6973 3.44857 11.6221 3.13867 11.4717 2.86523C11.3213 2.5918 11.1071 2.37533 10.8291 2.21582C10.5511 2.05632 10.2184 1.97656 9.83105 1.97656C9.43913 1.97656 9.09505 2.05859 8.79883 2.22266C8.5026 2.38216 8.27246 2.60775 8.1084 2.89941C7.94434 3.18652 7.8623 3.52376 7.8623 3.91113L7.85547 3.9248L6.67969 3.91797L6.66602 3.91113C6.67057 3.3278 6.81185 2.81055 7.08984 2.35938C7.36784 1.90365 7.75065 1.54818 8.23828 1.29297C8.72591 1.0332 9.28418 0.90332 9.91309 0.90332C10.4873 0.90332 11.0046 1.02409 11.4648 1.26562C11.9251 1.5026 12.2874 1.82845 12.5518 2.24316C12.8206 2.65788 12.9551 3.13184 12.9551 3.66504V3.67871C12.9551 4.05241 12.889 4.41243 12.7568 4.75879C12.6292 5.10514 12.4014 5.49023 12.0732 5.91406C11.7451 6.33333 11.2826 6.85059 10.6855 7.46582L8.13574 10.0977L8.44336 9.53027V10.0977L8.14258 9.89258H13.1191V11H6.73438ZM18.276 11.1641C17.597 11.1641 17.0046 11.0479 16.4987 10.8154C15.9928 10.583 15.5918 10.264 15.2956 9.8584C15.0039 9.4528 14.8353 8.99023 14.7897 8.4707L14.7829 8.38867H15.9655L15.9723 8.45703C16.0042 8.7806 16.1182 9.06543 16.3141 9.31152C16.5146 9.55762 16.7812 9.7513 17.1139 9.89258C17.4512 10.0293 17.8385 10.0977 18.276 10.0977C18.709 10.0977 19.0872 10.0225 19.4108 9.87207C19.7389 9.72168 19.9941 9.51432 20.1764 9.25C20.3587 8.98112 20.4499 8.6735 20.4499 8.32715V8.31348C20.4499 7.70736 20.2471 7.24251 19.8415 6.91895C19.4404 6.59082 18.8936 6.42676 18.2008 6.42676H16.9635V5.3877H18.1462C18.5381 5.3877 18.8844 5.31478 19.1852 5.16895C19.486 5.01855 19.7207 4.81576 19.8893 4.56055C20.0579 4.30078 20.1423 4.00684 20.1423 3.67871V3.66504C20.1423 3.31868 20.0693 3.02474 19.9235 2.7832C19.7777 2.54167 19.5635 2.3571 19.2809 2.22949C19.0029 2.10189 18.6634 2.03809 18.2624 2.03809C17.875 2.03809 17.5286 2.10417 17.2233 2.23633C16.9225 2.36393 16.681 2.5485 16.4987 2.79004C16.3164 3.03158 16.207 3.31868 16.1706 3.65137L16.1637 3.71973H14.9811L14.988 3.65137C15.0426 3.11361 15.2113 2.64421 15.4938 2.24316C15.7809 1.84212 16.1592 1.52995 16.6286 1.30664C17.1025 1.08333 17.6471 0.97168 18.2624 0.97168C18.8913 0.97168 19.4381 1.08105 19.903 1.2998C20.3724 1.514 20.7347 1.8125 20.9899 2.19531C21.2497 2.57357 21.3796 3.01335 21.3796 3.51465V3.52832C21.3796 3.93392 21.2907 4.29395 21.113 4.6084C20.9352 4.92285 20.6891 5.1849 20.3747 5.39453C20.0602 5.60417 19.6979 5.75228 19.2878 5.83887V5.86621C20.0078 5.92546 20.5889 6.16927 21.0309 6.59766C21.4775 7.02148 21.7008 7.58431 21.7008 8.28613V8.2998C21.7008 8.84668 21.5527 9.33659 21.2565 9.76953C20.9603 10.2025 20.5547 10.5443 20.0397 10.7949C19.5247 11.041 18.9368 11.1641 18.276 11.1641Z"})}),te=(0,X().wt)("numbersBold",{viewBox:"0 0 39 19",svg:(0,Q.jsx)("path",{d:"M5.05697 18V3.98438H4.96322L0.627281 6.97266V4.19531L5.04525 1.08984H8.03353V18H5.05697ZM11.8711 18V15.9375L17.7656 10.1484C18.5156 9.41406 19.0859 8.80859 19.4766 8.33203C19.8672 7.84766 20.1367 7.41406 20.2852 7.03125C20.4336 6.64844 20.5078 6.25 20.5078 5.83594V5.80078C20.5078 5.29297 20.3906 4.84375 20.1562 4.45312C19.9219 4.0625 19.5938 3.75781 19.1719 3.53906C18.7578 3.3125 18.2734 3.19922 17.7188 3.19922C17.1016 3.19922 16.5547 3.32812 16.0781 3.58594C15.6016 3.83594 15.2266 4.17969 14.9531 4.61719C14.6875 5.04688 14.5508 5.53906 14.543 6.09375L14.5312 6.16406H11.7188L11.707 6.09375C11.707 5.05469 11.9688 4.13672 12.4922 3.33984C13.0234 2.53516 13.7422 1.90625 14.6484 1.45312C15.5547 1 16.582 0.773438 17.7305 0.773438C18.8555 0.773438 19.8477 0.984375 20.707 1.40625C21.5742 1.82031 22.25 2.39453 22.7344 3.12891C23.2266 3.85547 23.4727 4.68359 23.4727 5.61328V5.64844C23.4727 6.30469 23.3516 6.92578 23.1094 7.51172C22.875 8.08984 22.4727 8.72266 21.9023 9.41016C21.332 10.0898 20.5469 10.9141 19.5469 11.8828L14.8477 16.3594L15.8789 14.4961V16.3594L14.8594 15.5273H23.7305V18H11.8711ZM32.0094 18.293C30.7751 18.293 29.6969 18.0898 28.7751 17.6836C27.8532 17.2695 27.1227 16.6992 26.5837 15.9727C26.0446 15.2461 25.736 14.4102 25.6579 13.4648L25.6462 13.3242H28.529L28.5407 13.4414C28.6032 13.9023 28.779 14.3125 29.068 14.6719C29.3649 15.0312 29.7633 15.3164 30.2633 15.5273C30.7633 15.7305 31.3454 15.832 32.0094 15.832C32.6657 15.832 33.236 15.7227 33.7204 15.5039C34.2126 15.2773 34.5915 14.9688 34.8571 14.5781C35.1305 14.1797 35.2673 13.7227 35.2673 13.207V13.1836C35.2673 12.293 34.9587 11.6094 34.3415 11.1328C33.7243 10.6562 32.8766 10.418 31.7985 10.418H29.7946V8.16797H31.7282C32.3532 8.16797 32.8962 8.05859 33.3571 7.83984C33.8258 7.62109 34.1891 7.32422 34.4469 6.94922C34.7048 6.56641 34.8337 6.12891 34.8337 5.63672V5.61328C34.8337 5.09766 34.7204 4.66016 34.4938 4.30078C34.2751 3.94141 33.9508 3.66797 33.5212 3.48047C33.0993 3.28516 32.5876 3.1875 31.986 3.1875C31.3923 3.1875 30.8649 3.28516 30.404 3.48047C29.9508 3.67578 29.5876 3.95312 29.3141 4.3125C29.0407 4.67188 28.8766 5.09766 28.8219 5.58984L28.8102 5.69531H26.0094L26.0212 5.56641C26.1071 4.60547 26.404 3.76953 26.9118 3.05859C27.4274 2.33984 28.1149 1.78516 28.9743 1.39453C29.8415 0.996094 30.8454 0.796875 31.986 0.796875C33.1501 0.796875 34.1618 0.984375 35.0212 1.35938C35.8805 1.72656 36.5446 2.24219 37.0133 2.90625C37.4899 3.5625 37.7282 4.33203 37.7282 5.21484V5.23828C37.7282 5.93359 37.5719 6.55078 37.2594 7.08984C36.9548 7.62109 36.5329 8.0625 35.9938 8.41406C35.4626 8.76562 34.8571 9.01172 34.1774 9.15234V9.21094C35.4274 9.32812 36.4313 9.74219 37.1891 10.4531C37.9469 11.1562 38.3258 12.0938 38.3258 13.2656V13.2891C38.3258 14.2656 38.0602 15.1328 37.529 15.8906C36.9977 16.6484 36.2555 17.2383 35.3024 17.6602C34.3571 18.082 33.2594 18.293 32.0094 18.293Z"})});var oe=()=>o(284371),ne=()=>o(115552),ie=()=>o(33218),re=()=>o(937199);function ae(){const{layoutStore:e,currentModuleSelection:t,collectionStore:n}=(0,re().LH)(),i=(0,r().K8)((()=>{if("existing_module"===(null==t?void 0:t.type))return e.getModuleById(t.moduleId)}),[t,e]),a=(0,r().K8)((()=>{if((0,o(778781).gx)(i))return null==n?void 0:n.getSchemaStore().getKeyStore(i.propertyId).getValue()}),[n,i]);if(!i||!a)return null;switch(i.type){case"property_person":case"property_created_by":case"property_last_edited_by":return(0,Q.jsx)(de,{module:i,options:le,heightVariant:"tall"});case"property_formula":return(0,o(708685).isNumberFormulaPropertySchema)(a)?(0,Q.jsx)(de,{module:i,options:ce,heightVariant:"short"}):null;case"property_number":return(0,Q.jsx)(de,{module:i,options:ce,heightVariant:"short"});case"property_file":return(0,Q.jsx)(de,{module:i,options:se,heightVariant:"short"});case"property_place":return(0,Q.jsx)(de,{module:i,options:pe,heightVariant:"short"});default:return null}}const le={available:["large","compact"],appearance:{compact:{label:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.person.display.compact",defaultMessage:"Compact"}),image:{src:J().A.images.layouts.configuration.personCompactPng,width:100,height:41}},large:{label:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.person.display.large",defaultMessage:"Large"}),image:{src:J().A.images.layouts.configuration.personMediumPng,width:82,height:56}}}},se={available:["landscape","portrait","square"],appearance:{landscape:{label:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.file.display.landscape",defaultMessage:"Landscape"}),image:{src:J().A.images.layouts.configuration.fileLandscapePng,width:192,height:128}},portrait:{label:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.file.display.portrait",defaultMessage:"Portrait"}),image:{src:J().A.images.layouts.configuration.filePortraitPng,width:192,height:128}},square:{label:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.file.display.square",defaultMessage:"Square"}),image:{src:J().A.images.layouts.configuration.fileSquarePng,width:192,height:128}}}},ce={available:["large","small"],appearance:{large:{label:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.number.display.large",defaultMessage:"Large"}),icon:{function:te,size:42}},small:{label:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.number.display.small",defaultMessage:"Small"}),icon:{function:ee,size:22}}}};function de(e){let{module:t,options:o,heightVariant:r}=e;const l=(0,i().v3)(),{layoutStore:s}=(0,re().LH)(),c=(0,n.useCallback)((e=>{const o=s.getModel(),n=null==o?void 0:o.getPageModuleAreaById(t.id);if(!n||!o)return;const i={...t,style:e};T().createAndCommit({environment:l,perform(e){(0,ie().UQ)({environment:l,transaction:e,layoutStore:s,position:{area:n,moduleId:i.id},updatedModule:i})},canUndo:!0,userAction:"BuilderLayoutModules.setDisplayStyle"})}),[l,s,t]),d=(0,a().IS)((e=>({container:{margin:"10px 8px"},label:{fontSize:oe().J.UISmall.desktop,fontWeight:oe().Wy.medium,margin:"0px 8px 6px 8px",color:e.text.secondary}})),[]);return(0,Q.jsxs)("div",{style:d.container,children:[(0,Q.jsx)("p",{style:d.label,children:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.person.display.title",defaultMessage:"Style"})}),(0,Q.jsx)(ne().A,{disabled:!1,options:o,selectedOption:t.style,onOptionSelected:c,height:r})]})}const pe={available:["map","text"],appearance:{map:{label:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.place.display.map",defaultMessage:"Map"}),image:{src:J().A.images.blocks.mapsPng,width:40,height:40}},text:{label:(0,Q.jsx)(f().sA,{id:"PropertyTypeSpecificModuleConfiguration.place.display.text",defaultMessage:"Text"}),image:{src:J().A.images.blocks.textPng["en-US"],width:40,height:40}}}};var ue=()=>o(255824),me=()=>o(962730),ge=()=>o(463830),fe=()=>o(227440),ye=()=>o(411671),he=()=>o(630116),Se=()=>o(329304),xe=()=>o(939656),ve=()=>o(406699),be=()=>o(897119),Ce=()=>o(497222);const Ae=n.memo((function(e){let{collectionContextStore:t,collectionSettingsStore:a,property:l}=e;const s=(0,i().v3)(),{isMobile:c}=(0,i().Y0)(),d=(0,r().uB)(void 0,ge().A),p=(0,n.useCallback)((e=>{const n=t.collectionStore();if(!n)return null;const i=t.normalizedSchemaStore.state[l];if("formula"!==(null==i?void 0:i.type))return;const r=Boolean(n.getDatabaseType()&&n.isTypedProperty(l)),c=null==a?void 0:a.getState().fromBlockStore;return(0,Q.jsx)(o(645873).u2,{dependency:o(862292).T.formulas,children:t=>(0,Q.jsx)(o(490696).C,{handleClose:e.close,property:l,getRecordModel:n.getRecordModel,propertySchema:i,collectionStore:n,handleSave:e=>function(e,t){const{newValue:o,newType:n,propertySchema:i,property:r,collectionStore:a}=e,l=o?{...i,formula2:{code:o,result_type:n},version:"v2"}:{...i,formula2:void 0,version:"v2"};T().createAndCommit({userAction:"CollectionFormulaOptions.handleFormulaChange",environment:t,canUndo:!0,perform:e=>{(0,D().F)({environment:t,collectionStore:a,update:{[r]:l},transaction:e})}})}(e,s),formulas:t,disabled:r,blockStore:c,analyticsFrom:"view_settings"})})}),[t,a,s,l]);return(0,Q.jsx)(ve().Ay,{popupType:c?be().nl.BottomSheet:be().nl.Popup,alignmentToOrigin:ve().yP.End,renderOrigin:e=>(0,Q.jsx)(Ce().A,{title:(0,Q.jsx)(f().sA,{defaultMessage:"Edit formula",id:"database.viewSettings.formulaOptions.title"}),showChevron:!0,icon:u().pencilLineIcon,rotateChevron:d.state.open,...e}),render:p,buttonPopupStore:d})}));var we=()=>o(66486),je=()=>o(107440),Me=()=>o(662303),Te=()=>o(656704),_e=()=>o(597777),Pe=()=>o(869190),ke=()=>o(971404),Ie=()=>o(68913),Re=()=>o(274570),Be=()=>o(42583),De=()=>o(217429),Oe=()=>o(828973);function Ke(e){let{collectionContextStore:t,property:o}=e;const n=(0,f().tz)(),a=(0,i().v3)(),l=(0,r().K8)((()=>Fe(t,o)),[t,o]),s=(0,r().K8)((()=>t.getPropertyFormat(o)),[t,o]),c=(0,r().K8)((()=>"date"===(null==l?void 0:l.type)&&De().default.checkGate({gateName:"adoption_reminder_collection_default"})),[null==l?void 0:l.type]);if(!l)return null;const d=c&&"date"===l.type,p=(null==s?void 0:s.date_format)||l.date_format||_e().vz,u=function(e){const t=Le();for(const o in t)if(t[o]===e)return o;return"12h"}((null==s?void 0:s.time_format)||l.time_format||_e().CE),m="date"===l.type?function(e,t){if(void 0!==(null==t?void 0:t.default_reminder))return t.default_reminder;if(void 0!==e.default_reminder)return e.default_reminder;return}(l,s):void 0;return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(Oe().A,{icon:Be().D,title:(0,Q.jsx)(f().sA,{defaultMessage:"Date format",id:"database.viewSettings.dateOptions.dateFormat"}),selectedKey:p,popupStyle:{minWidth:190},options:_e().wJ.map((e=>({key:e,type:"button",title:n.formatMessage(_e().xz[e])}))),onChange:e=>function(e,t,o,n){const i="collectionTypedView"===o.contextType;if(i){const i=o.formatStore();if(!i)return;const r=o.getPropertyFormatKey();if(!r)return;T().createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvDateFormatChange",environment:t,canUndo:!0,perform:t=>{C().a5({formatStore:i,formatKey:r,property:n,update:{date_format:e},transaction:t})}})}else{const i=o.collectionStore(),r=Fe(o,n);if(!i||!r)return;const a={...r,date_format:e};T().createAndCommit({userAction:"CollectionSettingsDateOptions.handleDateFormatChange",environment:t,canUndo:!0,perform:e=>{(0,D().F)({environment:t,collectionStore:i,update:{[n]:a},transaction:e})}})}(0,x().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"date_change_format"})}(e,a,t,o)}),(0,Q.jsx)(Oe().A,{icon:Re().clockIcon,title:(0,Q.jsx)(f().sA,{defaultMessage:"Time format",id:"database.viewSettings.dateOptions.timeFormat"}),selectedKey:u,popupStyle:{minWidth:190},options:_e().ZD.map((e=>({key:e,type:"button",title:n.formatMessage(_e().px[e])}))),onChange:e=>function(e,t,o,n){const i=Le()[e],r="collectionTypedView"===o.contextType;if(r){const e=o.formatStore();if(!e)return;const r=o.getPropertyFormatKey();if(!r)return;T().createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsvClockFormatChange",environment:t,canUndo:!0,perform:t=>{C().a5({formatStore:e,formatKey:r,property:n,update:{time_format:i},transaction:t})}})}else{const e=o.collectionStore(),r=Fe(o,n);if(!e||!r)return;const a={...r,time_format:i};T().createAndCommit({userAction:"CollectionSettingsDateOptions.handleClockFormatChange",environment:t,canUndo:!0,perform:o=>{(0,D().F)({environment:t,collectionStore:e,update:{[n]:a},transaction:o})}})}(0,x().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"date_change_time_format"})}(e,a,t,o)}),d?(0,Q.jsx)(Oe().A,{icon:Ie().alarmIcon,title:(0,Q.jsx)(f().sA,{defaultMessage:"Notifications",id:"database.viewSettings.dateOptions.reminder"}),selectedKey:m,popupStyle:{minWidth:190},options:_e().vK.map((e=>{const t=(0,Te().y)({reminder:e,shouldShowTime:!1,intl:n,formatTime:Pe().fU});return{key:(0,_e().Mb)(e)?void 0:e,type:"button",title:t}})),onChange:e=>{!function(e,t,o,n){const i="collectionTypedView"===o.contextType;if(i){const i=o.formatStore();if(!i)return;const r=o.getPropertyFormatKey();if(!r)return;T().createAndCommit({userAction:"CollectionSettingsDateOptions.handleMsVDefaultDateTimeReminderChange",environment:t,canUndo:!0,perform:t=>{C().a5({formatStore:i,formatKey:r,property:n,update:{default_reminder:e},transaction:t})}})}else{const i=o.collectionStore(),r=Fe(o,n);if(!i||!r)return;const a={...r,default_reminder:e};T().createAndCommit({userAction:"CollectionSettingsDateOptions.handleDefaultDateTimeReminderChange",environment:t,canUndo:!0,perform:e=>{(0,D().F)({environment:t,collectionStore:i,update:{[n]:a},transaction:e})}})}}(e,a,t,o)}}):null]})}function Fe(e,t){const o=e.normalizedSchemaStore.state[t];if(o)return"date"===o.type||"created_time"===o.type||"last_edited_time"===o.type||"last_visited_time"===o.type?o:void 0}function Le(){return(0,ke().X)(Me().locale).time}var Ve=()=>o(91451),He=()=>o(788621);function ze(e){const{collectionContextStore:t,property:o,propertySchema:r}=e,a=(0,i().v3)(),l=(0,n.useCallback)((e=>{const n={...r,default:"created_by"===e?"created_by":void 0},i=t.collectionStore();i&&((0,R().p)({environment:a,collectionStore:i,performTransaction:t=>{T().applyOperation({store:(0,he().Oo)(i,i.pointer),operation:{pointer:i.pointer,command:"update",path:["schema",o],args:{default:e}},transaction:t})}}),T().createAndCommit({userAction:"CollectionSettingsDefaultPersonPicker.handleChange",environment:a,canUndo:!0,perform:e=>{(0,D().F)({environment:a,collectionStore:i,update:{[o]:n},transaction:e})}}))}),[t,a,o,r]);return(0,Q.jsx)(Oe().A,{icon:He().personCircleIcon,title:(0,Q.jsx)(f().sA,{defaultMessage:"Default",id:"CollectionSettingsDefaultPersonPicker.default.title"}),selectedKey:r.default?"created_by":"no_default",popupStyle:{minWidth:190},options:[{key:"no_default",type:"button",title:(0,Q.jsx)(f().sA,{defaultMessage:"No default",id:"CollectionSettingsDefaultPersonPicker.options.noDefault"})},{key:"created_by",type:"button",title:(0,Q.jsx)(f().sA,{defaultMessage:"Created by",id:"CollectionSettingsDefaultPersonPicker.options.creator"}),icon:(0,Ve().z)({width:16})}],onChange:l})}var We=()=>o(158797),Ne=()=>o(95441),Ye=()=>o(513489),qe=()=>o(913687),Ee=()=>o(630053),Ue=()=>o(685889),Ge=(o(737550),()=>o(617871)),$e=()=>o(925907),Ze=()=>o(645395),Je=()=>o(2220),Xe=()=>o(331542),Qe=()=>o(534239);const et=(0,f().YK)({linkPreviewDescription:{defaultMessage:"Salesforce URLs will be auto-converted as a Salesforce property with live preview on hover.",id:"database.viewSettings.salesforceConfigTab.linkPreviewDescription"},databaseActionsTitle:{defaultMessage:"Database actions",id:"database.viewSettings.connectedRelationSettings.databaseActions"},addPropertiesTitle:{defaultMessage:"Add properties",id:"database.viewSettings.connectedRelationSettings.addPropertiesTitle"},databaseActionsDisabledWhileSyncing:{defaultMessage:"Cannot edit while syncing",id:"database.viewSettings.connectedRelationSettings.databaseActionsDisabledWhileSyncing"},urlPropertyRequiredPrimaryText:{defaultMessage:"URL property required",id:"database.viewSettings.salesforceConfigTab.urlPropertyRequiredPrimaryText"},urlPropertyRequiredSecondaryText:{defaultMessage:"Create an URL column first to auto-populate this Salesforce property",id:"ConnectedRelationActionsObjectSelection.urlPropertyRequiredSecondaryText"}});function tt(e){const{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:a,environment:s}=e,c=(0,r().K8)((()=>{if(a&&(0,l().UU)(a)&&a.connectedRelation.integration_id===Ge().mn)return a.collection_pointer}),[a]),{format:d,loading:p}=(0,Qe().e8)(c,{debugName:"CollectionSettingsDatabaseActionsConfig"}),u=(0,r().K8)((()=>{var e;return d?{hasError:Boolean(d.error),isSyncing:Boolean(null===(e=d.sync_state)||void 0===e?void 0:e.syncing)}:null}),[d]);return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(ot,{}),p?(0,Q.jsx)(Xe().A,{}):(0,Q.jsx)(nt,{disabled:Boolean(null==u?void 0:u.isSyncing),collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:a,environment:s})]})}function ot(){const e=it(),t=(0,f().tz)();return(0,Q.jsxs)(H().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:e.previewContentContainer,children:[(0,Q.jsxs)("div",{style:e.tabDescription,children:[" ","Preview"]}),(0,Q.jsx)("div",{children:(0,Q.jsx)("img",{src:J().A.images.externalIntegrations.salesforceLinkpreviewPng,style:e.previewContentContainer,alt:"Paste Salesforce URLs to create a Salesforce property."})}),(0,Q.jsx)("div",{style:e.tabDescription,children:t.formatMessage(et.linkPreviewDescription)})]})}function nt(e){let{collectionContextStore:t,property:o,connectedRelationPatternName:n,integrationId:i,propertySchema:l,environment:s,disabled:c}=e;const d=it(),p=(0,f().tz)(),u=t.settingsStore,m=(0,a().DP)(),g=(0,r().K8)((()=>{var e;const o=null==t||null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema();return o&&Object.values(o).some((e=>e&&"url"===e.type))}),[t]);return(0,Q.jsx)(H().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:d.previewContentContainer,topBorder:!0,title:p.formatMessage(et.databaseActionsTitle),children:(0,Q.jsx)(z().A,{disableTooltip:!c,renderTooltip:e=>(0,Q.jsx)("div",{...e,style:Y().Q$,children:p.formatMessage(et.databaseActionsDisabledWhileSyncing)}),render:e=>(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(Ce().A,{...e,showChevron:!0,title:p.formatMessage(et.addPropertiesTitle),icon:Ze().j,disabled:c,onClick:()=>{const e=t.collectionStore();(0,Je().u)({environment:s,event:{eventName:"salesforce_actions",eventProperties:{actionType:"add_properties_clicked",collectionId:null==e?void 0:e.id,integrationId:i}}}),A().a2({collectionSettingsStore:u,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:o,connectedRelationPatternName:n,integrationId:i,rootPropertySchema:l}})}}),(0,Q.jsx)(z().A,{placement:me().W.Left,textWrap:!0,style:{maxWidth:218,padding:"4px 8px"},disableTooltip:g,renderTooltip:()=>(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)("div",{style:{fontWeight:510,marginBottom:4},children:p.formatMessage(et.urlPropertyRequiredPrimaryText)}),(0,Q.jsx)("div",{style:{fontWeight:400,color:m.text.secondary},children:p.formatMessage(et.urlPropertyRequiredSecondaryText)})]}),render:e=>(0,Q.jsx)(Ce().A,{...e,showChevron:!0,title:(0,Q.jsx)(f().sA,{defaultMessage:"Populate property",id:"database.viewSettings.salesforceConfigTab.populateProperty"}),icon:$e().n,disabled:c||!g,onClick:()=>{A().a2({collectionSettingsStore:u,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationCopyUrl",rootPropertyId:o,connectedRelationPatternName:n,integrationId:i,rootPropertySchema:l}})}})})]})})})}function it(){const{isMobile:e}=(0,i().Y0)();return(0,a().IS)((t=>({previewContentContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:"100%",paddingLeft:10,paddingRight:10,cursor:"default"},tabDescription:{padding:e?18:10,fontSize:e?16:12,color:t.text.tertiary}})),[e])}var rt=()=>o(765957),at=()=>o(27732),lt=()=>o(896427);function st(e){const{collectionContextStore:t,property:o,targetCollectionStore:a}=e,l=(0,i().v3)(),s=(0,f().tz)(),c=(0,r().K8)((()=>t.collectionStore()),[t]),d=(0,r().K8)((()=>t.contextType),[t]),[p,u]=(0,n.useState)(void 0),m=Boolean(a&&(null==c?void 0:c.id)===a.id),g=(0,n.useCallback)((()=>{if(!p)return;const{hasInverseRelation:e,inverseName:n,autoRelate:i}=p;T().createAndCommit({userAction:"CollectionSettingsRelationOptions.handleEditRelation",environment:l,canUndo:!0,perform:r=>{at().Go({environment:l,collectionContextStore:t,property:o,hasInverseRelation:e,inverseName:n,autoRelate:i,intl:s,transaction:r})}}),(0,x().V)({environment:l,collectionContextStore:t,property:o,from:"collectionPage"===d?"page_properties":"view_settings",action:"relation_edit",is_self_relation:m,has_inverse:e,auto_relate:null==i?void 0:i.enabled}),u(void 0)}),[p,l,t,o,d,m,s]);return(0,Q.jsx)(lt().Ay,{collectionContextStore:t,targetCollectionStore:a,property:o,temporaryInverseState:p,setTemporaryInverseState:u,onSubmit:g})}const ct=(0,X().wt)("linkedRelationDark",{viewBox:"0 0 36 32",svg:(0,Q.jsxs)("g",{children:[(0,Q.jsx)("path",{fill:"#fff",d:"M3.5 5.5a2 2 0 100-4 2 2 0 000 4zm0 1.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM8 3a.5.5 0 000 1h6.313a2.5 2.5 0 012.5 2.5v19a3.5 3.5 0 003.5 3.5h6.48l-1.147 1.146a.5.5 0 00.708.708l2-2a.5.5 0 000-.708l-2-2a.5.5 0 00-.708.708L26.793 28h-6.48a2.5 2.5 0 01-2.5-2.5v-19a3.5 3.5 0 00-3.5-3.5H8z",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"32.5",cy:"28.5",r:"3.5",fill:"#fff",opacity:"0.5"}),(0,Q.jsx)("path",{fill:"#564328",d:"M8 16a7 7 0 017-7h6a7 7 0 110 14h-6a7 7 0 01-7-7z"}),(0,Q.jsx)("path",{fill:"#CA984D",d:"M17.607 19.531c-.32 0-.544-.048-.671-.144a.477.477 0 01-.192-.41c0-.253.076-.517.227-.793.153-.276.373-.536.66-.778a3.514 3.514 0 011.043-.59 3.902 3.902 0 011.367-.226c.508 0 .965.075 1.371.226a3.46 3.46 0 011.04.59c.288.242.51.502.663.778.154.276.23.54.23.793 0 .18-.064.316-.195.41-.127.096-.351.144-.671.144h-4.872zm2.438-3.636a1.44 1.44 0 01-.79-.23 1.705 1.705 0 01-.57-.622 1.785 1.785 0 01-.214-.875 1.701 1.701 0 01.793-1.473c.24-.15.5-.226.78-.226.285 0 .545.074.782.222.24.149.431.352.574.61.146.255.22.541.22.86 0 .325-.074.619-.22.882-.143.26-.334.467-.574.621-.237.154-.497.23-.781.23zm-6.668 3.636c-.263 0-.45-.053-.559-.16-.109-.104-.164-.252-.164-.445 0-.266.068-.535.203-.809a2.6 2.6 0 01.579-.762c.252-.231.554-.419.906-.562a3.14 3.14 0 011.187-.215c.354 0 .67.047.95.14.28.092.53.206.746.345a3.022 3.022 0 00-.575.593 2.852 2.852 0 00-.375.676 1.87 1.87 0 00-.128.656c0 .211.052.392.156.543h-2.926zm2.152-3.547c-.247 0-.475-.066-.683-.199a1.5 1.5 0 01-.5-.543 1.565 1.565 0 01-.188-.762 1.475 1.475 0 01.691-1.281 1.24 1.24 0 01.68-.199c.245 0 .472.065.68.195.21.128.379.304.504.528.125.221.187.471.187.75 0 .284-.062.54-.187.77a1.5 1.5 0 01-.5.542c-.208.133-.436.2-.684.2z"})]})}),dt=(0,X().wt)("linkedRelationLight",{viewBox:"0 0 36 32",svg:(0,Q.jsxs)("g",{children:[(0,Q.jsx)("path",{fill:"#91918E",d:"M3.5 5.5a2 2 0 100-4 2 2 0 000 4zm0 1.5a3.5 3.5 0 100-7 3.5 3.5 0 000 7zM9 3a.5.5 0 000 1h5.313a2.5 2.5 0 012.5 2.5v19a3.5 3.5 0 003.5 3.5h6.48l-1.147 1.146a.5.5 0 00.708.708l2-2a.5.5 0 000-.708l-2-2a.5.5 0 00-.708.708L26.793 28h-6.48a2.5 2.5 0 01-2.5-2.5v-19a3.5 3.5 0 00-3.5-3.5H9z",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"32.5",cy:"28.5",r:"3.5",fill:"#91918E",opacity:"0.5"}),(0,Q.jsx)("path",{fill:"#FBF3DB",d:"M8 16a7 7 0 017-7h6a7 7 0 110 14h-6a7 7 0 01-7-7z"}),(0,Q.jsx)("path",{fill:"#CB912F",d:"M17.607 19.531c-.32 0-.544-.048-.671-.144a.477.477 0 01-.192-.41c0-.253.076-.517.227-.793.153-.276.373-.536.66-.778a3.514 3.514 0 011.043-.59 3.902 3.902 0 011.367-.226c.508 0 .965.075 1.371.226a3.46 3.46 0 011.04.59c.288.242.51.502.663.778.154.276.23.54.23.793 0 .18-.064.316-.195.41-.127.096-.351.144-.671.144h-4.872zm2.438-3.636a1.44 1.44 0 01-.79-.23 1.705 1.705 0 01-.57-.622 1.785 1.785 0 01-.214-.875 1.701 1.701 0 01.793-1.473c.24-.15.5-.226.78-.226.285 0 .545.074.782.222.24.149.431.352.574.61.146.255.22.541.22.86 0 .325-.074.619-.22.882-.143.26-.334.467-.574.621-.237.154-.497.23-.781.23zm-6.668 3.636c-.263 0-.45-.053-.559-.16-.109-.104-.164-.252-.164-.445 0-.266.068-.535.203-.809a2.6 2.6 0 01.579-.762c.252-.231.554-.419.906-.562a3.14 3.14 0 011.187-.215c.354 0 .67.047.95.14.28.092.53.206.746.345a3.022 3.022 0 00-.575.593 2.852 2.852 0 00-.375.676 1.87 1.87 0 00-.128.656c0 .211.052.392.156.543h-2.926zm2.152-3.547c-.247 0-.475-.066-.683-.199a1.5 1.5 0 01-.5-.543 1.565 1.565 0 01-.188-.762 1.475 1.475 0 01.691-1.281 1.24 1.24 0 01.68-.199c.245 0 .472.065.68.195.21.128.379.304.504.528.125.221.187.471.187.75 0 .284-.062.54-.187.77a1.5 1.5 0 01-.5.542c-.208.133-.436.2-.684.2z"})]})}),pt=(0,X().wt)("unlinkedRelationDark",{viewBox:"0 0 36 32",svg:(0,Q.jsxs)("g",{children:[(0,Q.jsx)("path",{fill:"#fff",d:"M4 17.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM4 19a4 4 0 100-8 4 4 0 000 8z",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"32",cy:"15",r:"4",fill:"#fff",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"12",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"16",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"20",cy:"15",r:"1",fill:"#fff",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"24",cy:"15",r:"1",fill:"#fff",opacity:"0.5"})]})}),ut=(0,X().wt)("unlinkedRelationLight",{viewBox:"0 0 36 32",svg:(0,Q.jsxs)("g",{children:[(0,Q.jsx)("path",{fill:"#91918E",d:"M4 17.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM4 19a4 4 0 100-8 4 4 0 000 8z",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"32",cy:"15",r:"4",fill:"#91918E",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"12",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"16",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"20",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"}),(0,Q.jsx)("circle",{cx:"24",cy:"15",r:"1",fill:"#91918E",opacity:"0.5"})]})});var mt=()=>o(901389),gt=()=>o(493823),ft=()=>o(760217),yt=()=>o(204063),ht=()=>o(107683),St=()=>o(125565),xt=()=>o(898486),vt=()=>o(716108);function bt(e){const{collectionContextStore:t,property:o,propertySchema:l}=e,s=(0,f().tz)(),c=(0,i().v3)(),d=(0,i().Y0)(),p=(0,r().K8)((()=>t.collectionStore()),[t]),u=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return(0,xe().k7)(e,l)}),[t,l]),m=(0,r().K8)((()=>{var e;return Boolean(null===(e=l.permissions_data)||void 0===e?void 0:e.shared_by_enabled)}),[l]),g="dark"===(0,a().eP)(),y=g?pt:ut,h=g?ct:dt,S=(0,r().K8)((()=>null==p?void 0:p.getName()),[p]),x=(0,r().K8)((()=>null==u?void 0:u.getName()),[u]),v=p&&u&&p.id===u.id,b=(0,r().K8)((()=>{const e=p&&p.getSharingEnabledRelationId();return Boolean(e&&e!==o)}),[p,o]);let C;b?C="hasAnotherSharingEnabledProperty":v&&(C="isSelfRelation");const[A,w]=(0,n.useState)(!1),[j,M]=(0,n.useState)(!1),_=(0,r().K8)((()=>{const e={limit:!1,twoWayRelation:!1};if(!p)return e;if(1!==l.limit&&(e.limit=!0),u){Ue().D5(t,o,u)&&(e.twoWayRelation=!0)}return e}),[p,l,t,o,u]),[P,k]=(0,n.useState)([]);(0,n.useEffect)((()=>{if(!j){const e=[];_.limit&&e.push("limit"),_.twoWayRelation&&e.push("twoWayRelation"),k(e)}}),[_,j]);const I=(0,n.useCallback)((async e=>{if(!p)return;const t=l.property,n=(null==l?void 0:l.permissions_data)??{},i={...l,limit:1,autoRelate:void 0,permissions_data:{...n,shared_by_enabled:e}},{serverCommitResult:r}=T().createAndCommit({userAction:"CollectionSettingsShareBy.handleShareByChange",environment:c,canUndo:!0,perform:e=>{(0,D().F)({environment:c,collectionStore:p,update:{[o]:i},transaction:e}),u&&t&&at().t$({environment:c,collectionStore:u,property:t,transaction:e})}});try{await r}catch(a){if(a instanceof vt().rS&&a.clientData){const e=(0,xt().Yu)(a.clientData),t=(0,xt().t4)(s,e);t&&mt().f1(t)}}}),[p,l,c,o,u,s]),R=(0,n.useCallback)((e=>{p&&(e&&P.length>0?w(!0):I(e))}),[p,P,I]),B=(0,n.useCallback)((()=>{w(!1)}),[]),O=(0,n.useCallback)((async()=>{M(!0);try{await I(!0)}finally{M(!1),w(!1)}}),[I]),K=(0,a().IS)((e=>({disabled:{opacity:.5,pointerEvents:"none"},container:{marginLeft:14,marginRight:16,marginBottom:12},buttonTitle:{fontSize:d.isMobile?17:14,fontWeight:400,lineHeight:d.isMobile?"24px":"20px",textWrap:"wrap",overflow:"auto"},buttonDefault:{marginTop:12,paddingTop:d.isMobile?16:12,paddingBottom:d.isMobile?16:12,borderRadius:8,boxShadow:`0 0 0 1px ${e.selectLightGray[200]}`,gap:6},buttonSelected:{boxShadow:`0 0 0 2px ${e.blueColor}`},icon:{width:d.isMobile?54:36,height:d.isMobile?48:32},disabledReasonContent:{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12,borderRadius:10,backgroundColor:e.tint.uiYellow,color:e.text.uiYellowPrimary,fontSize:12,textWrap:"pretty"},modalContainer:{padding:20,paddingBottom:12,width:d.isMobile?void 0:400},modalHeader:{display:"flex",flexDirection:"column"},modalHeaderIconContainer:{display:"flex",justifyContent:"center"},modalHeaderTitle:{display:"flex",justifyContent:"center",marginTop:8,fontSize:17,fontWeight:590,lineHeight:"22px",textAlign:"center",color:e.text.primary},modalHeaderDescription:{display:"flex",justifyContent:"center",marginTop:8,fontSize:14,lineHeight:"20px",color:e.text.secondary,textAlign:"center",textWrap:"pretty"},modalList:{display:"flex",marginTop:24,flexDirection:"column",alignItems:"flex-start",alignSelf:"stretch",fontSize:14,boxShadow:`0 0 0 1px ${e.selectLightGray[100]}`,borderRadius:10},modalListItem:{borderBottom:`1px solid ${e.selectLightGray[100]}`},modalListItemContent:{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12}})),[d.isMobile]);return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(H().A,{topBorder:!0,disableMobileBorders:!0,disableDesktopPadding:!0,disableMobilePadding:!0,mobileTitleStyle:{marginTop:12},mobileStyle:{paddingBottom:6},title:(0,Q.jsx)(St().A,{isSmall:!0,isSecondaryColor:!0,isMobile:d.isMobile,children:(0,Q.jsx)(f().sA,{id:"collectionSettings.relationSharingSwitcher.header",defaultMessage:"Share settings through relation"})}),children:[C&&(0,Q.jsx)("div",{style:K.container,children:(0,Q.jsx)("div",{style:K.disabledReasonContent,children:s.formatMessage(Ct.disabledReasons[C])})}),(0,Q.jsxs)("div",{style:{...K.container,...v&&K.disabled,...b&&K.disabled},children:[(0,Q.jsx)(ft().A,{focused:!1,left:y(K.icon),title:(0,Q.jsx)(f().sA,{id:"collectionSettings.relationSharingSwitcher.unlinkedTitle",defaultMessage:"{collectionName} and {relationName} have separate share settings",values:{collectionName:S,relationName:x}}),titleStyle:K.buttonTitle,style:{...K.buttonDefault,...!m&&K.buttonSelected},onClick:()=>R(!1)}),(0,Q.jsx)(ft().A,{focused:!1,left:h(K.icon),title:(0,Q.jsx)(f().sA,{id:"collectionSettings.relationSharingSwitcher.linkedTitle",defaultMessage:"{collectionName} inherit share settings from related {relationName}",values:{collectionName:S,relationName:x}}),titleStyle:K.buttonTitle,style:{...K.buttonDefault,...m&&K.buttonSelected},onClick:()=>R(!0)})]})]}),(0,Q.jsx)(ht().s,{showCloseIcon:!0,isOpen:A,onDismiss:()=>{w(!1)},render:()=>(0,Q.jsxs)("div",{style:K.modalContainer,children:[(0,Q.jsxs)("div",{style:K.modalHeader,children:[(0,Q.jsx)("div",{style:K.modalHeaderIconContainer,children:h({width:36,height:32,marginLeft:4})}),(0,Q.jsx)("div",{style:K.modalHeaderTitle,children:s.formatMessage(Ct.header.title)}),(0,Q.jsx)("div",{style:K.modalHeaderDescription,children:s.formatMessage(Ct.header.description)})]}),(0,Q.jsx)("div",{style:K.modalList,children:P.map(((e,t,o)=>(0,Q.jsx)("div",{style:{...K.modalListItem,borderBottom:t+1===o.length?"none":K.modalListItem.borderBottom},children:(0,Q.jsx)("div",{style:K.modalListItemContent,children:s.formatMessage(Ct.issues[e],{title:e=>(0,Q.jsx)("span",{style:{fontWeight:590},children:e}),description:e=>(0,Q.jsx)("div",{style:{marginTop:4},children:e})})})},e)))}),(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",flexDirection:"column",marginTop:24,gap:8},children:[(0,Q.jsx)(yt().A,{size:"lg",onClick:O,isLoading:j,disabled:j,children:(0,Q.jsx)(f().sA,{id:"collectionSettings.relationSharingSwitcher.changes.applyChanges",defaultMessage:"Apply changes"})}),(0,Q.jsx)(gt().p,{onClick:B,size:"lg",isGray:!0,disabled:j,style:{justifyContent:"center"},children:(0,Q.jsx)(f().sA,{id:"collectionSettings.relationSharingSwitcher.changes.cancel",defaultMessage:"Cancel"})})]})]})})]})}const Ct={header:(0,f().YK)({title:{id:"collectionSettings.relationSharingSwitcher.changes.modalHeaderTitle",defaultMessage:"Turn on permission sharing"},description:{id:"collectionSettings.relationSharingSwitcher.changes.modalHeaderDescription",defaultMessage:"To enable permission sharing through a relation, the following changes are required."}}),issues:(0,f().YK)({limit:{id:"collectionSettings.relationSharingSwitcher.changes.setLimitToOne",defaultMessage:"<title>Limit to one page</title><description>Permissions can only be inherited from one related page. For existing pages that have more than one related page, only the first page will be kept.</description>"},twoWayRelation:{id:"collectionSettings.relationSharingSwitcher.changes.removeTwoWayRelation",defaultMessage:"<title>Remove the two-way relation</title><description>Only one-way relations are supported at this time.</description>"}}),disabledReasons:(0,f().YK)({hasAnotherSharingEnabledProperty:{id:"collectionSettings.relationSharingSwitcher.disabledReasons.hasAnotherSharingEnabledProperty",defaultMessage:"Sharing is already enabled through another relation."},isSelfRelation:{id:"collectionSettings.relationSharingSwitcher.disabledReasons.isSelfRelation",defaultMessage:"Can't change share settings for a self-relation."}})};var At=()=>o(860037);function wt(e){const{collectionContextStore:t,property:o}=e,n=(0,i().v3)(),a=(0,r().K8)((()=>t.collectionStore()),[t]),c=(0,r().K8)((()=>Ue().Jq(t,o)),[t,o]),d=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return(0,xe().k7)(e,c)}),[t,c]),p=Boolean(d&&(null==a?void 0:a.id)===d.id),u=(0,r().K8)((()=>{var e;return(0,Ee().Sf)({experimentService:De().default,actor:{table:g().oo,id:n.currentUser.id??""},spaceId:(null===(e=rt().default.state.currentSpaceStore)||void 0===e?void 0:e.id)??""})}),[n.currentUser]),m=c&&(0,l().UU)(c)?c.connectedRelation:void 0,{isConnectedRelationDatabaseActionsSupported:f,connectedRelationPatternName:y,integrationId:h}=(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state[o],n=null==e?void 0:e.name,i=(0,s().Dz)(e);return{isConnectedRelationDatabaseActionsSupported:(0,s().Mn)(i)&&De().default.checkGate({gateName:"connected_relations_database_actions_enabled"}),connectedRelationPatternName:n,integrationId:i}}),[t,o]);if(!d)return null;const S=c&&!(0,s().H6)(c)&&!(0,s().KF)(c);return(0,Q.jsxs)(Q.Fragment,{children:[S&&(0,Q.jsx)(At().A,{isSelfRelation:p,collectionStore:d,showAs:"link",disabled:!0}),S&&(0,Q.jsx)(Ye().Z,{collectionContextStore:t,propertySchema:c,property:o}),f&&y&&h&&(0,Q.jsx)(tt,{collectionContextStore:t,property:o,connectedRelationPatternName:y,integrationId:h,propertySchema:c,environment:n}),!Boolean(m)&&(0,Q.jsx)(st,{collectionContextStore:t,property:o,targetCollectionStore:d}),u&&c&&(0,l().nC)(c)&&(0,Q.jsx)(bt,{collectionContextStore:t,property:o,propertySchema:c})]})}var jt=()=>o(689094),Mt=()=>o(596359),Tt=()=>o(831194),_t=()=>o(439264),Pt=()=>o(285790),kt=()=>o(419357),It=()=>o(545805),Rt=()=>o(784892),Bt=()=>o(814777),Dt=()=>o(399762),Ot=()=>o(175116);function Kt(e){var t;const o=(0,i().v3)(),l=(0,a().DP)(),{isMobile:s}=(0,i().Y0)(),{property:c,option:d,statusGroup:p,propertySchema:u,isDefault:m,disabled:g}=e,y=(0,Ot().ET)(),h=(0,r().K8)((()=>{var e;return null===(e=y.collectionStore())||void 0===e?void 0:e.id}),[y]),S=(0,r().uB)(void 0,ge().A),x=(0,r().K8)((()=>S.state.open),[S]),v=(0,n.useCallback)((()=>{S.setState({open:!0})}),[S]),b=(0,n.useCallback)((()=>{S.setState({open:!1})}),[S]),C=(0,n.useCallback)((e=>{const t=y.collectionStore();t&&(0,R().p)({environment:o,collectionStore:t,performTransaction:o=>{for(const n of e)T().applyOperation({store:(0,he().Oo)(t,n.pointer),operation:n,transaction:o})}})}),[y,o]),A=(0,a().IS)((()=>({defaultText:{fontSize:12,fontWeight:500,textTransform:"uppercase"}})),[]);return h?(0,Q.jsx)(Bt().h,{open:x,origin:(0,Q.jsx)(z().A,{renderTooltip:e=>(0,Q.jsxs)("div",{...e,style:Y().Q$,children:[(0,Q.jsx)("div",{children:d.value}),(0,Q.jsx)("div",{style:{color:l.text.contrastSecondary},children:d.description})]}),placement:me().W.Left,disableTooltip:!(null!==(t=d.description)&&void 0!==t&&t.length),render:e=>{var t,o;return(0,Q.jsx)(Ce().A,{...e,showDragHandle:!s,showChevron:!0,disabled:g,rotateChevron:x,title:"status"===u.type?(0,Q.jsx)(Dt().q,{format:s?Rt().NY.Large:Rt().NY.Medium,value:d.value,color:d.color,hideTooltip:Boolean(null===(t=d.description)||void 0===t?void 0:t.length),tooltipPlacement:me().W.Left,showRemoveButton:!1,isSingle:!0,groupColor:null==p?void 0:p.color}):(0,Q.jsx)(Dt().O,{format:s?Rt().NY.Large:Rt().NY.Medium,value:d.value,color:d.color,hideTooltip:Boolean(null===(o=d.description)||void 0===o?void 0:o.length),tooltipPlacement:me().W.Left,showRemoveButton:!1,isSingle:!0}),right:m?(0,Q.jsx)("span",{style:A.defaultText,children:(0,Q.jsx)(f().sA,{id:"database.statusProperty.default",defaultMessage:"Default"})}):void 0,onClick:v})}}),option:d,property:c,propertySchema:u,statusGroup:p,collectionId:h,analyticsFrom:"view_settings",alignmentToOrigin:me().C.End,onChange:C,onClose:b}):null}const Ft=o(757695).Store.createClass(void 0,{name:"InputGroupIndexStore"});const Lt=function(e){let{collectionContextStore:t,property:a,disabled:s,aIAutofillOption:c}=e;const d=(0,i().v3)(),p=(0,r().uB)(void 0,Ft),u=(0,Z().X)("collections_status_missing_options_fix"),[m,g]=(0,n.useState)({inputValue:"",focus:!1}),y=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),h=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().app_config_uri}),[t]),S=(0,r().K8)((()=>Ht(t,a)),[t,a]),v=(0,r().O$)(p);if(!y||!S)return null;if("status"===S.type){const e=S.groups??[];if(0===e.length)return null;const o=S.options??[],n=e.map((e=>{const t=o.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return{group:e,groupOptions:t}})),i=S.defaultOption,r=[...n[0].groupOptions.map((e=>e.value))];for(const{group:t,groupOptions:a}of n.slice(1))r.push({key:`group-header-${t.name}`,draggable:!1}),r.push(...a.map((e=>e.value)));const l=(0,P().s6)(h,y,a)?{tooltipCaption:(0,Q.jsx)(f().sA,{defaultMessage:"These options are core to the property and cannot be changed.",id:"database.viewSettings.selectOptions.disabledGroupMessage"})}:void 0,c=(r,c)=>{if(r.startsWith("group-header-")){const e=r.substring(13),o=n.findIndex((t=>{let{group:o}=t;return o.name===e})),{group:i,groupOptions:c}=n[o];return(0,Q.jsxs)(Vt,{title:(0,Q.jsx)(Tt().RS,{disableGroup:l,group:i,showIcon:!1}),right:(0,Q.jsx)(zt,{collectionContextStore:t,property:a,onClick:e=>Nt(g,p,o),isVisible:!m.focus}),disabled:s,children:[v===o&&(0,Q.jsx)(Yt,{collectionContextStore:t,property:a,input:m,setInput:g,inputGroupIndexStore:p}),!m.focus&&0===c.length&&(0,Q.jsx)(qt,{setInput:g,inputGroupIndexStore:p,groupIndex:o})]})}{const t=o.find((e=>e.value===r));if(!t)return null;const n=e.find((e=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return(0,Q.jsx)(Kt,{option:t,statusGroup:n,propertySchema:S,property:a,isDefault:t.value===i,disabled:s},t.value)}};return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(Vt,{title:(0,Q.jsx)(Tt().RS,{disableGroup:l,group:n[0].group}),right:(0,Q.jsx)(zt,{collectionContextStore:t,property:a,onClick:()=>Nt(g,p,0),isVisible:!m.focus}),disabled:s,children:[0===v&&(0,Q.jsx)(Yt,{collectionContextStore:t,property:a,input:m,setInput:g,inputGroupIndexStore:p}),!m.focus&&0===n[0].groupOptions.length&&(0,Q.jsx)(qt,{setInput:g,inputGroupIndexStore:p,groupIndex:0})]}),(0,Q.jsx)(_t().Ay,{direction:"vertical",keys:r,renderKey:c,onDrop:e=>Wt(e,d,a,t,u),disabled:s})]})}{const e=S.options??[],n=e.map((e=>e.value)),i=S.auto_sort_options||"manual";return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(Oe().A,{icon:o(582684).C,title:(0,Q.jsx)(f().sA,{defaultMessage:"Sort",id:"database.viewSettings.selectOptions.autoSort"}),selectedKey:i,options:[{key:"manual",type:"button",title:(0,Q.jsx)(f().sA,{defaultMessage:"Manual",id:"database.viewSettings.selectOptions.autoSort.none"})},{key:"alphabetical",type:"button",title:(0,Q.jsx)(f().sA,{defaultMessage:"Alphabetical",id:"database.viewSettings.selectOptions.autoSort.alphabetical"})},{key:"reverse_alphabetical",type:"button",title:(0,Q.jsx)(f().sA,{defaultMessage:"Reverse alphabetical",id:"database.viewSettings.selectOptions.autoSort.reverseAlphabetical"})}],onChange:e=>function(e,t,o,n){const i=o.collectionStore(),r=o.normalizedSchemaStore.state,a=Ht(o,n);if(!i||!a)return;if(!(0,l().lx)(a))return;const s=[{pointer:i.pointer,command:"update",path:["schema",n],args:{auto_sort_options:e}}];"alphabetical"!==e&&"reverse_alphabetical"!==e||s.push(...(0,K().d4)({collectionId:i.id,property:n,propertySchema:a,schema:r,isAscending:"alphabetical"===e})||[]);(0,R().p)({environment:t,collectionStore:i,performTransaction:e=>{for(const t of s)T().applyOperation({store:(0,he().Oo)(i,t.pointer),operation:t,transaction:e})}}),(0,x().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"select_change_auto_sort_options"})}(e,d,t,a),popupStyle:{minWidth:190}},"autoSortMenuItem"),c,(0,Q.jsxs)(Vt,{title:(0,Q.jsx)(f().sA,{defaultMessage:"Options",id:"database.viewSettings.selectOptions.title"}),right:(0,Q.jsx)(zt,{collectionContextStore:t,property:a,onClick:()=>Nt(g,p),isVisible:!m.focus&&n.length>0}),disabled:s,children:[(0,Q.jsx)(Yt,{collectionContextStore:t,property:a,input:m,setInput:g,inputGroupIndexStore:p}),!m.focus&&0===n.length&&(0,Q.jsx)(qt,{setInput:g,inputGroupIndexStore:p})]},"sectionHeader"),n.length>0&&(0,Q.jsx)(_t().Ay,{direction:"vertical",keys:n,renderKey:t=>{const o=e.find((e=>e.value===t));return o?(0,Q.jsx)(Kt,{option:o,property:a,propertySchema:S,isDefault:!1,statusGroup:void 0,disabled:s},o.value):null},onDrop:e=>Wt(e,d,a,t)})]})}};function Vt(e){let{title:t,right:o,children:n,disabled:i,overrideStyle:r}=e;const a=(0,G().Tf)()?{mobileStyle:{borderRadius:0},disableMobilePadding:!0,mobileTitleStyle:{paddingTop:12,paddingBottom:4,minHeight:44}}:{};return(0,Q.jsx)(H().A,{topBorder:!0,title:t,desktopTitleStyle:{height:20},right:!i&&o,style:{width:"100%",paddingBottom:0,...r},...a,children:!i&&n})}function Ht(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&((0,l().lx)(o)||"status"===o.type))return o}function zt(e){let{onClick:t,collectionContextStore:o,property:n,isVisible:i}=e;const a=(0,f().tz)();return(0,r().K8)((()=>Ht(o,n)),[o,n])?(0,Q.jsx)(Pt().A,{icon:jt().W,onClick:t,style:{width:20,height:20,visibility:i?void 0:"hidden"},disabled:!i,ariaLabel:a.formatMessage({defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.addOption"})}):null}function Wt(e,t,o,n,i){const r=n.normalizedSchemaStore.state,a=n.collectionStore();a&&(Mt().gc({newValues:e,property:o,schema:r,collectionStore:a,environment:t,isCollectionsStatusMissingOptionsFixEnabled:i}),(0,x().V)({environment:t,collectionContextStore:n,property:o,from:"view_settings",action:"select_options_reorder"}))}function Nt(e,t,o){e({focus:!0,inputValue:""}),void 0!==o&&t.setState(o)}function Yt(e){let{collectionContextStore:t,property:o,input:r,setInput:s,inputGroupIndexStore:c}=e;const d=(0,i().v3)(),p=(0,f().tz)(),u=(0,Z().X)("collections_status_missing_options_fix"),m=(0,n.useCallback)((e=>{null==e||e.stopPropagation(),function(e,t,o,n,i,r,a){const s=t.collectionStore(),c=Ht(t,o);if(!c||!s)return;const d=c.options||[],p=n.inputValue.trim();if(p)if("status"===c.type){const t=r.state;let n;if(void 0!==t&&(n=d.find((e=>{var o;return null===(o=c.groups)||void 0===o||null===(o=o[t].optionIds)||void 0===o?void 0:o.includes(e.id)}))),void 0===t||void 0!==n)Mt().Uk({modification:{type:"keyedObjectListBefore",beforeOption:n,newValue:p},property:o,propertySchema:c,options:d,environment:e,collectionStore:s,groupIndex:t,isCollectionsStatusMissingOptionsFixEnabled:a});else{let n;for(let e=t-1;e>=0;e--){var u;const t=null===(u=c.groups)||void 0===u?void 0:u[e];if(t&&(n=d.find((e=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})),void 0!==n))break}Mt().Uk({modification:{type:"keyedObjectListAfter",afterOption:n,newValue:p},property:o,propertySchema:c,options:d,environment:e,collectionStore:s,groupIndex:t,isCollectionsStatusMissingOptionsFixEnabled:a})}}else!(0,l().lx)(c)||"alphabetical"!==c.auto_sort_options&&"reverse_alphabetical"!==c.auto_sort_options?Mt().Uk({modification:{type:"keyedObjectListBefore",newValue:p},property:o,propertySchema:c,options:d,environment:e,collectionStore:s}):Mt().Uk({modification:{type:"autoSortInsert",newValue:p},property:o,propertySchema:c,options:d,environment:e,collectionStore:s});i({focus:!0,inputValue:""}),(0,x().V)({environment:e,collectionContextStore:t,property:o,from:"view_settings",action:"select_add_option",option_value_char_count:p.length})}(d,t,o,r,s,c,u)}),[d,t,o,r,s,c,u]),g=(0,n.useCallback)((e=>function(e,t){t({focus:!0,inputValue:e.target.value.replace(/,/g,"")})}(e,s)),[s]),y=(0,n.useCallback)((()=>function(e,t,o){o({focus:!1,inputValue:e.device.isPhone?t.inputValue:""})}(d,r,s)),[d,r,s]),h=(0,ue().a)(),S=(0,a().IS)((e=>({inputOuterStyle:h?{backgroundColor:e.white}:{},inputMenuItem:{marginTop:2,marginBottom:8}})),[h]);return r.focus?(0,Q.jsx)(It().A,{debugName:"CollectionSettingsSelectOptions",capture:!0,onEsc:y,children:(0,Q.jsx)(kt().Ay,{value:r.inputValue,focus:!0,placeholder:p.formatMessage({defaultMessage:"Type a new optionâ€¦",id:"database.viewSettings.selectOptions.newSelectOption.inputPlaceholder"}),style:S.inputMenuItem,inputOuterStyle:S.inputOuterStyle,onChange:g,onBlur:y,onSubmit:m,mobileKeyboardOnDismiss:m})}):null}function qt(e){let{groupIndex:t,setInput:o,inputGroupIndexStore:n}=e;return(0,Q.jsx)(ft().A,{icon:(0,jt().W)({width:14}),focused:!1,title:(0,Q.jsx)(f().sA,{defaultMessage:"Add an option",id:"database.viewSettings.selectOptions.noOptions"}),style:{width:"100%"},onClick:()=>Nt(o,n,t)})}var Et=()=>o(263178),Ut=()=>o(974967);const Gt=(0,f().YK)({statusShowAsLabel:{id:"database.viewSettings.statusOptions.showAs",defaultMessage:"Show as"},displayAsLabel:{id:"database.viewSettings.statusOptions.displayAs",defaultMessage:"Display as"},statusCheckboxLabel:{id:"database.viewSettings.statusOptions.showAs.checkbox",defaultMessage:"Checkbox"},statusSelectLabel:{id:"database.viewSettings.statusOptions.showAs.selectOptionLabel",defaultMessage:"Select"}});function $t(e){let{collectionContextStore:t,property:o,disabled:n}=e;const l=(0,i().v3)(),s=(0,Z().X)("db_ux_properties"),c=(0,a().IS)((e=>({icon:{width:16,height:16,fill:e.icon.secondary}})),[]),[p,u]=(0,r().K8)((()=>{var e;return[Zt(t,o),(null===(e=t.getPropertyFormat(o))||void 0===e?void 0:e.statusShowAs)??"select"]}),[t,o]);if(!p)return null;const m=[{key:"checkbox",type:"button",title:U().A.formatMessage(Gt.statusCheckboxLabel),icon:(0,Et().S)(c.icon)},{key:"select",type:"button",title:U().A.formatMessage(Gt.statusSelectLabel),icon:(0,Ut().n)(c.icon)}];return(0,Q.jsx)(Oe().A,{icon:d().eyeIcon,title:s?U().A.formatMessage(Gt.displayAsLabel):U().A.formatMessage(Gt.statusShowAsLabel),selectedKey:u,popupStyle:{minWidth:190},options:m,onChange:e=>function(e,t,o,n){const i=o.formatStore();if(!i)return;const r=o.getPropertyFormatKey();if(!r)return;T().createAndCommit({userAction:"CollectionSettingsStatusOptions.handleShowAsChange",environment:t,canUndo:!0,perform:t=>{C().a5({formatStore:i,formatKey:r,property:n,update:{statusShowAs:e,visible:!0},transaction:t})}}),(0,x().V)({environment:t,collectionContextStore:o,property:n,from:"view_settings",action:"status_change_format"})}(e,l,t,o),disabled:n})}function Zt(e,t){const o=e.normalizedSchemaStore.state[t];if(o&&"status"===o.type)return o}var Jt=()=>o(35091),Xt=()=>o(109129),Qt=()=>o(611520);const eo=n.memo((function(e){const{collectionContextStore:t,collectionSettingsStore:l,formatKey:c,property:d,selectNameInitial:p,titleOverride:u}=e,[m,g]=(0,n.useState)(!1),[y,h]=(0,n.useState)(""),v=(0,i().v3)(),b=(0,n.useRef)(null),A=(0,f().tz)(),w=(0,a().DP)(),j=(0,Z().X)("nds_default_property_noticon"),M=(0,Z().X)("db_ux_chrome"),{collectionStore:_,isMultiSourceView:k}=(0,r().K8)((()=>({collectionStore:t.collectionStore(),isMultiSourceView:"collectionTypedView"===t.contextType})),[t]),I=(0,r().O$)(t.normalizedSchemaStore),{isTypedProperty:R,databaseType:B}=(0,r().K8)((()=>_?{isTypedProperty:_.isTypedProperty(d),databaseType:_.getDatabaseType()}:{isTypedProperty:!1,databaseType:void 0}),[_,d]),O=(0,r().K8)((()=>(0,s()._g)({schema:I,property:d})),[d,I]),K=(0,r().K8)((()=>ro({property:d,formatKey:c,collectionContextStore:t})),[t,c,d]),F=(0,r().K8)((()=>(0,N().fE)({property:d,collectionContextStore:t,newValue:y})),[t,y,d]),L=(0,r().K8)((()=>{var e;const n=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!n&&(0,o(696746).Nh)(n)}),[t]),V=(0,r().K8)((()=>Boolean(_&&B&&P().jP((0,o(617254).appConfigs)(),B,d,_))),[_,B,d]),z=(0,r().K8)((()=>{var e;const o=t.collectionViewStore();return!!o&&(Boolean((null===(e=ro({property:d,formatKey:c,collectionContextStore:t}))||void 0===e?void 0:e.wrap)||o.getFormat().table_wrap)&&"timeline"!==o.getType())}),[t,c,d]),W=(0,r().uB)(void 0,ge().A),q=(0,ue().a)();(0,n.useEffect)((()=>{!function(e,t,n){const i=t.collectionViewStore();if(!i||"table"!==i.getType())return;const r=o(344482).A.findTableHeaderCell(t,e);if(!r)return;const a=r.getNode();if(!a||!n)return;const l=(0,o(953418).T8)(a);if(!l)return;const s=n.getBoundingClientRect(),c=a.getBoundingClientRect().right+20-s.left;l.scrollLeft=l.scrollLeft+c}(d,t,b.current),O&&h(O.name||"")}),[t,d,O]);const E=(0,n.useCallback)((e=>{(0,xe().Fc)({collectionContextStore:t,environment:v,inputValue:y,name:e,property:d})}),[t,v,y,d]),G=(0,n.useCallback)((e=>{g(!m),e.stopPropagation()}),[m]),$=(0,n.useCallback)((e=>{!function(e){var t;const{description:o,environment:n,collectionContextStore:i,property:r}=e,a=i.collectionStore(),l=null==a||null===(t=a.getSchema())||void 0===t?void 0:t[r];if(!a||void 0===l||o===l.description)return;T().createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:n,canUndo:!0,perform:e=>{(0,D().F)({environment:n,collectionStore:a,update:{[r]:{...l,description:o}},transaction:e})}}),(0,x().V)({environment:n,collectionContextStore:i,property:r,from:"view_properties",action:"set_description"})}({collectionContextStore:t,description:e,environment:v,property:d})}),[t,v,d]),J=(0,n.useCallback)((e=>{h(e)}),[]);if(!O)return null;const X=!(0,s().di)(O),ee=k,te=k||(0,s().Jf)({property:d,propertySchema:O,isTypedProperty:R}),oe=O.description;return(0,Q.jsxs)(o(735695).Ay,{...e,title:u||(_?(0,Q.jsx)(f().sA,{defaultMessage:"Edit property",id:"database.viewSettings.propertyTab.title"}):(0,Q.jsx)(f().sA,{defaultMessage:"View property",id:"database.viewSettings.propertyTab.title.viewProperty"})),footer:(0,Q.jsx)(To,{collectionContextStore:t,formatKey:c,property:d,collectionSettingsStore:l,wrapProperty:z,propertySchema:O,propertyFormat:K,isRequiredTypedProperty:V,databaseType:B}),ref:b,children:[(0,Q.jsxs)(H().A,{isInput:!0,style:q?{margin:"0 2px"}:void 0,children:[(0,Q.jsx)(o(755735).B,{disabled:ee,initialValue:O.name||"",placeholder:U().A.formatMessage(qe().A.inputPlaceholder),onBlur:E,onSubmit:E,focusInitial:p,selectAll:p,iconButton:{iconLeading:e=>(0,Q.jsx)(o(743176).zB,{type:O.type,icon:O.icon,size:16,theme:w,style:e,isDefaultNoticonEnabled:j}),iconStyle:{fill:o(278238).l8[w.mode].gray},...q?{backgroundColor:w.white}:void 0,enforceIconColor:"gray",onSubmit:e=>function(e,t,o,n){const i=o.collectionStore();if(!i)return;C().yC({environment:e,collectionStore:i,collectionContextStore:o,property:t,icon:n,from:"view_settings"})}(v,d,t,e)},inputOuterStyle:q?{backgroundColor:w.white}:void 0,inputRightButton:L?null:(0,Q.jsx)(o(539148).S,{description:oe,showTooltip:!m,onClick:G,addDescriptionText:A.formatMessage(Y().Mo.addPropertyDescriptionTooltip),editDescriptionText:A.formatMessage(Y().Mo.editPropertyDescriptionTooltip)}),onChange:J}),F&&(0,Q.jsx)(o(653259).A,{propertyName:y})]}),m&&(0,Q.jsx)(o(705602).y,{initialDescription:oe,handleSaveDescription:$}),(0,Q.jsxs)(H().A,{extraPadding:M,children:[X&&(0,Q.jsx)(S().Dy,{disabled:te,isTypedProperty:R,collectionUri:B,collectionContextStore:t,formatKey:c,propertyTypeButtonPopupStore:W,property:d}),"button"===O.type&&(0,Q.jsx)(S().nR,{collectionSettingsStore:l,collectionContextStore:t,property:d,source:"collectionSettingsMenu"}),k?(0,Q.jsxs)(Q.Fragment,{children:["status"===O.type&&(0,Q.jsx)(lo,{collectionSettingsStore:l,collectionContextStore:t,property:d}),("date"===O.type||"created_time"===O.type||"last_edited_time"===O.type)&&(0,Q.jsx)(co,{collectionContextStore:t,property:d})]}):(0,Q.jsx)(_o,{collectionContextStore:t,property:d,propertySchema:O,source:"collectionSettingsMenu"})]}),q&&(0,Q.jsx)(ae,{})]})}));function to(e,t,o,n){const i=ro({property:n,formatKey:o,collectionContextStore:t}),r=t.collectionViewStore(),a=t.normalizedFormatStore.state,l=(0,xe().Jq)({collectionContextStore:t,property:n});if(!l)return;if(!(i&&r&&o&&l))return;const s=no({formatKey:o,collectionContextStore:t}).map((e=>e.property===i.property?{...i,visible:!i.visible}:e)),c={...a,[o]:s};T().createAndCommit({userAction:"CollectionSettingsProperty.handleToggleVisibilityClick",environment:e,canUndo:!0,perform:a=>{(0,O().F)({collectionViewStore:r,update:{format:c},transaction:a});const l=ao({property:n,formatKey:o,collectionContextStore:t});M().sp({environment:e,collectionContextStore:t,currentIndex:l,entrypoint:"CollectionSettingsProperty",transaction:a,propertyAction:i.visible?"hide":"show"})}}),(0,v().X)({environment:e,collectionContextStore:t,action:"toggle_property_visibility",original_view_type:r.getType(),property_type:l.type})}async function oo(e,t,o,n,i,r){await w().q({environment:e,collectionContextStore:o,property:n,handleDeleteAccept:()=>function(e,t,o,n,i){const r=o.normalizedSchemaStore.state,a=o.collectionStore(),l=(0,s()._g)({schema:r,property:t});l&&(a&&T().createAndCommitAsync({environment:e,userAction:"CollectionSettingsProperty.handleDeleteAccept",waitForServerCommit:!1,perform:async n=>{await C().PF({environment:e,collectionStore:a,schema:r,property:t,transaction:n});const l=ao({property:t,formatKey:i,collectionContextStore:o});M().sp({environment:e,collectionContextStore:o,currentIndex:l,entrypoint:"CollectionSettingsProperty",transaction:n,propertyAction:"delete"})}}),A().yl({collectionSettingsStore:n}),(0,v().X)({environment:e,collectionContextStore:o,action:"delete_property",property_type:null==l?void 0:l.type}),(0,b().i)({environment:e,collectionContextStore:o,property_type:l.type,from:"view_settings",property:t}))}(e,n,o,i,r),theme:t,from:"view_settings"})}function no(e){const{formatKey:t,collectionContextStore:o}=e;if(!t)return[];var n;if("collection_page_properties"===t)return(null===(n=o.collectionStore())||void 0===n?void 0:n.getFormat().collection_page_properties)??[];return o.normalizedFormatStore.state[t]||[]}function io(e){const t=e.getViewType();if(!t)throw new Error("View type was not defined.");return t}function ro(e){const{collectionContextStore:t,formatKey:o,property:n}=e,i=no({formatKey:o,collectionContextStore:t});return null==i?void 0:i.find((e=>e.property===n))}function ao(e){const{collectionContextStore:t,formatKey:o,property:n}=e,i=no({formatKey:o,collectionContextStore:t});if(0===i.length)return-1;return i.filter((e=>e.visible)).findIndex((e=>e.property===n))}function lo(e){let{collectionSettingsStore:t,collectionContextStore:o,property:n}=e;const i=(0,r().K8)((()=>{var e;return P().s6(null===(e=o.collectionStore())||void 0===e?void 0:e.getDatabaseType(),o.normalizedSchemaStore.state,n)}),[o,n]);return(0,Q.jsxs)(Q.Fragment,{children:[i?null:(0,Q.jsx)($t,{collectionContextStore:o,property:n,disabled:i}),(0,Q.jsx)(Lt,{collectionSettingsStore:t,collectionContextStore:o,property:n,disabled:i,aIAutofillOption:null})]})}function so(e){let{collectionContextStore:t,collectionSettingsStore:o,property:n}=e;return(0,Q.jsx)(Ae,{collectionContextStore:t,collectionSettingsStore:o,property:n})}function co(e){let{collectionContextStore:t,property:o}=e;return(0,Q.jsx)(Ke,{collectionContextStore:t,property:o})}function po(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state[o];return e&&(0,l().UU)(e)}),[t,o]),i=(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state[o];return(0,s().di)(e)}),[t,o])?(0,Q.jsx)(We().A,{collectionContextStore:t,property:o}):(0,Q.jsx)(wt,{collectionContextStore:t,property:o}),a=n?(0,Q.jsx)(Qt().uo,{collectionContextStore:t,property:o,compact:!0}):null;return(0,Q.jsxs)(Q.Fragment,{children:[i,a]})}function uo(e){let{collectionContextStore:t,property:o,source:n}=e;const i=(0,r().K8)((()=>(0,xe().Jq)({collectionContextStore:t,property:o})),[t,o]);return i&&("number"===i.type||"formula"===i.type||"rollup"===i.type)?(0,Q.jsx)(we().W,{collectionContextStore:t,property:o,source:n}):null}function mo(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,xe().Jq)({collectionContextStore:t,property:o})),[t,o]),i=(0,r().K8)((()=>t.collectionStore()),[t]);return n&&"url"===n.type&&i?(0,Q.jsx)(Xt().V,{collectionContextStore:t,property:o,propertySchema:n}):null}function go(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,xe().Jq)({collectionContextStore:t,property:o})),[t,o]);return n&&"person"===n.type?(0,Q.jsx)(ze,{collectionContextStore:t,propertySchema:n,property:o}):null}function fo(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,xe().Jq)({collectionContextStore:t,property:o})),[t,o]);return n&&"button"===n.type?(0,Q.jsx)(S().m4,{collectionContextStore:t,propertySchema:n,propertyId:o}):null}function yo(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,xe().Jq)({collectionContextStore:t,property:o})),[t,o]);return n?(0,Q.jsx)(Ye().Z,{collectionContextStore:t,propertySchema:n,property:o}):null}function ho(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().K8)((()=>(0,xe().Jq)({collectionContextStore:t,property:o})),[t,o]),i=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionStore())||void 0===e?void 0:e.getRecordKeyStore();return null==o?void 0:o.getRecordKey()}),[t]);return n&&"auto_increment_id"===n.type?(0,Q.jsx)(je().A,{uniqueIdProperty:{propertyId:o,propertySchema:n},prefixValue:i,collectionContextStore:t}):null}function So(e){let{collectionContextStore:t,property:o}=e;return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(yo,{collectionContextStore:t,property:o}),(0,Q.jsx)(go,{collectionContextStore:t,property:o})]})}function xo(e){const{environment:t,property:o,propertySchema:i,collectionSettingsStore:a,collectionContextStore:s,collectionStore:d,buttonPopupParent:p}=e,u=(0,r().K8)((()=>(0,l().om)(i)),[i]),m=(0,r().K8)((()=>(0,E().jq)(t,ye().A.getMode(t,d),d)),[t,d]),g=(0,n.useMemo)((()=>{const e=i.name.trim(),t=N().dC[i.type],o=new RegExp(`${t}(?:\\s?\\d+)?`);return!e||o.test(e)}),[i.name,i.type]),h=(0,n.useCallback)((()=>{if(!d||!i||!(0,l().lx)(i))return;const e=(0,l().RM)(i);if(!e)return;const n=[];if(u)_().trackAiAutofillSettingsAction(t,{type:"remove_ai_inference",ai_inference_type:u.type,collection_id:d.id}),n.push({pointer:d.pointer,command:"set",path:["schema",o,e],args:void 0});else{const r={type:i.type,auto_update_on_edit:!1,add_options:!1};_().trackAiAutofillSettingsAction(t,{type:"set_ai_inference",ai_inference_type:r.type,collection_id:d.id}),n.push({pointer:d.pointer,command:"set",path:["schema",o,e],args:r})}(0,R().p)({environment:t,collectionStore:d,performTransaction:e=>{for(const t of n)T().applyOperation({store:(0,he().Oo)(d,t.pointer),operation:t,transaction:e})}})}),[u,d,t,o,i]),S=(0,n.useCallback)((e=>{if(!i||!d||!(0,l().$M)(i))return;const n=(0,l().RM)(i);if(!n)return;const r={pointer:d.pointer,command:"set",path:["schema",o,n],args:e};(0,R().p)({environment:t,collectionStore:d,performTransaction:e=>{T().applyOperation({store:(0,he().Oo)(d,r.pointer),operation:r,transaction:e})}})}),[d,t,o,i]),x=(0,r().K8)((()=>io(s)),[s]);return m&&"form_editor"!==x?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(Vt,{disabled:!0,overrideStyle:{marginTop:6,paddingTop:6}},"aiSectionHeader"),(0,Q.jsx)(z().A,{disableTooltip:!g,placement:me().W.Left,renderTooltip:e=>(0,Q.jsx)(f().sA,{...e,defaultMessage:"Update the property name to use AI autofill",id:"database.collectionsettings.autofilloptions.disableswitch.tooltip",description:"User needs to change the property name from the default name to turn on autofill"}),render:e=>(0,Q.jsx)(Jt().A,{...e,title:(0,Q.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,Q.jsx)(f().sA,{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"})}),showChevron:!1,switcherProps:{on:Boolean(u),noColor:!1},onClick:h,disabled:!m||g}),style:{whiteSpace:"break-spaces"}}),u&&!g&&("select"===u.type||"multi_select"===u.type)&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(L().A,{setAiInference:S,aiInference:u,disabled:!m}),(0,Q.jsx)(Ce().A,{title:(0,Q.jsxs)("div",{style:{display:"flex",alignItems:"center",lineHeight:1.2,color:y().Ay.uiGray},children:[(0,Q.jsx)(f().sA,{id:"database.collectionsettings.aiAutofillOptions.more",defaultMessage:"More"}),(0,c().V)({fill:y().Ay.uiGray,width:12,height:12,marginLeft:4})]}),disabled:!1,onClick:()=>{null==p||p.close(),A().a2({collectionSettingsStore:a,item:{type:"propertyAiAutofill",propertySchema:i,property:o}})}})]})]}):null}function vo(e){const{environment:t,property:o,propertySchema:n,collectionContextStore:i,collectionStore:a}=e,s=(0,r().K8)((()=>null==a?void 0:a.getSpaceId()),[a]),c=(0,Se()._X)({name:"collection_property_autofill",spaceId:s,userId:t.currentUser.id,amount:"unknown"}),d=(0,r().K8)((()=>{const e=i.collectionStore();return e&&(0,E().jq)(t,ye().A.getMode(t,e),e)}),[t,i]);return(0,r().K8)((()=>(0,l().lx)(n)&&n.select_ai_inference),[n])&&c?(0,Q.jsx)(F().Ve,{environment:t,collectionContextStore:i,collectionStore:a,property:o,propertySchema:n,autofillFeatureAvailability:c,isAutofillSetupEnabled:Boolean(d)}):null}function bo(e){let{propertySchema:t,collectionSettingsStore:o,collectionContextStore:n,property:a,buttonPopupParent:l}=e;const s=(0,i().v3)(),c=(0,r().K8)((()=>n.collectionStore()),[n]);return c?(0,Q.jsx)(Lt,{collectionSettingsStore:o,collectionContextStore:n,property:a,disabled:!1,aIAutofillOption:(0,Q.jsx)(xo,{environment:s,collectionStore:c,collectionSettingsStore:o,collectionContextStore:n,property:a,propertySchema:t,buttonPopupParent:l})}):null}function Co(e){let{collectionContextStore:t,property:o}=e;const n=(0,r().O$)(t.normalizedSchemaStore)[o];let i;return i=(0,s().di)(n)?(0,Q.jsx)(Ne().A,{href:(0,$().xS)("guides.githubRelation"),title:(0,Q.jsx)(f().sA,{defaultMessage:"Learn about GitHub Pull Requests",id:"database.viewSettings.propertyTab.githubPrRelation.learnMoreButton.title"}),analyticsFrom:"view_settings_property_github_pr_relation"}):(0,Q.jsx)(Ne().A,{href:(0,$().xS)("guides.relations"),title:(0,Q.jsx)(f().sA,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"}),(0,Q.jsx)(H().A,{topBorder:!0,children:i})}function Ao(e){let{collectionContextStore:t,property:o,collectionSettingsStore:n,source:i}=e;const a=(0,r().K8)((()=>(0,xe().Jq)({collectionContextStore:t,property:o})),[t,o]),s=(0,r().K8)((()=>io(t)),[t]),c=!(0,r().O$)(fe().e);if(!a||"text"!==a.type||"form_editor"===s)return null;const d=(0,l().om)(a);let p;return d&&(0,l().UH)(d.type)?"summarize"===d.type?p=q().VT.autofillSummary:"extract"===d.type?p=q().VT.autofillExtract:"custom"===d.type?p=q().VT.autofillCustom:"translate"===d.type?p=q().VT.autofillTranslate:(0,h().HB)(d):p=qe().A.autofillOffLabel,(0,Q.jsx)(Ce().A,{title:(0,Q.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,Q.jsx)(f().sA,{defaultMessage:"AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.open"})}),source:i,icon:u().pencilLineIcon,showChevron:!0,right:U().A.formatMessage(p),onClick:()=>function(e,t,o){const n=(0,xe().Jq)({collectionContextStore:t,property:o});t.collectionStore()&&n&&A().a2({collectionSettingsStore:e,item:{type:"propertyAiAutofill",propertySchema:n,property:o}})}(n,t,o),disabled:c})}function wo(e){let{property:t,collectionContextStore:o}=e;const n=(0,i().v3)(),a=(0,r().K8)((()=>o.collectionStore()),[o]),l=(0,r().K8)((()=>(0,N().Kc)(o)),[o]),s=(0,r().K8)((()=>Boolean((null==a?void 0:a.getDatabaseType())&&(null==a?void 0:a.isTypedProperty(t)))),[a,t]);return a?(0,Q.jsx)(W().R,{disabled:s,context:"viewSettings",property:t,schema:l,analyticsFrom:"view_settings",parentStore:a,onChange:e=>function(e,t,o,n){const i=n.collectionStore();i&&T().createAndCommit({userAction:"CollectionSettingsProperty.handleRollupPropertyMenuChange",environment:t,canUndo:!0,perform:n=>{(0,D().F)({environment:t,collectionStore:i,update:{[o]:e.propertySchema},transaction:n})}})}(e,n,t,o)}):null}function jo(e){let{isRequiredTypedProperty:t,databaseType:o,collectionContextStore:n,property:r,collectionSettingsStore:l,formatKey:s}=e;const c=(0,a().DP)(),d=(0,i().v3)();return(0,Q.jsx)(z().A,{disableTooltip:!t,placement:me().W.Left,renderTooltip:e=>(0,k().eF)(o,e),render:e=>(0,Q.jsx)(Ce().A,{...e,isRed:!0,disabled:t,onClick:()=>oo(d,c,n,r,l,s),icon:()=>t?(0,Q.jsx)("div",{...e,style:{display:"inline-flex"},children:(0,Q.jsx)(V().I,{icon:p().i})}):(0,Q.jsx)(V().I,{icon:m().trashIcon}),title:(0,Q.jsx)(f().sA,{defaultMessage:"Delete property",id:"database.viewSettings.propertyTab.deleteButton.title"}),caption:d.device.isMobile&&t?(0,k().eF)(o):null})})}function Mo(e){let{}=e;return(0,Q.jsx)(Ne().A,{href:(0,$().xS)("guides.databaseProperties"),title:(0,Q.jsx)(f().sA,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"})}function To(e){let{propertySchema:t,propertyFormat:a,isRequiredTypedProperty:c,databaseType:p,collectionContextStore:u,formatKey:m,property:y,collectionSettingsStore:S,wrapProperty:x}=e;const b=(0,i().v3)(),C=(0,G().Tf)(),w=(0,n.useCallback)((()=>function(e,t,o,n,i){const r=ro({property:n,formatKey:o,collectionContextStore:t}),a=t.collectionViewStore(),l=t.normalizedFormatStore.state,s=(0,xe().Jq)({collectionContextStore:t,property:n});s&&r&&a&&o&&s&&(M().Nv({currentValue:i,environment:e,property:n,collectionViewStore:a,format:l,formatKey:o}),(0,v().X)({environment:e,collectionContextStore:t,action:"toggle_property_wrap",original_view_type:a.getType(),property_type:s.type}))}(b,u,m,y,x)),[b,u,m,y,x]),_=(0,r().K8)((()=>u.collectionStore()),[u]),P=(0,r().K8)((()=>io(u)),[u]),k=(0,ue().a)(),R=(0,Z().X)("db_ux_customize_views"),D=(0,Z().X)("db_ux_chrome"),O=(0,r().K8)((()=>!D&&m&&("title"!==y||(0,K().O)({viewType:P,format:u.normalizedFormatStore.state}))&&"page"!==P),[m,y,P,u,D]),F=(0,r().K8)((()=>(!D||!R)&&(m&&(0,K().hc)({viewType:P,property:y}))),[m,y,P,D,R]),L=(0,r().K8)((()=>S.state.hideDuplicatePropertyOption),[S]),V=(0,l().vB)(t)&&Boolean(_)&&!k&&"form_editor"!==P&&!L,z=l().cN.includes(t.type)&&_&&!k&&"form_editor"!==P,W="form_editor"===P;return F||V||z||W?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(H().A,{topBorder:!0,disableMobilePadding:!C,extraPadding:D,children:[F&&a&&(0,Q.jsx)(Jt().A,{icon:o(871114).o,title:(0,Q.jsx)(f().sA,{defaultMessage:"Wrap in view",id:"database.viewSettings.propertyTab.wrapInViewButton.title"}),switcherProps:{on:x,disallowTabbing:!0},onClick:w}),_&&(0,Q.jsx)(vo,{environment:b,collectionStore:_,collectionContextStore:u,property:y,propertySchema:t}),O&&a&&(null!=a&&a.visible?(0,Q.jsx)(Ce().A,{icon:o(566910).e,title:(0,Q.jsx)(f().sA,{defaultMessage:"Hide in view",id:"database.viewSettings.propertyTab.hideInViewButton.title"}),onClick:()=>to(b,u,m,y)}):(0,Q.jsx)(Ce().A,{icon:d().eyeIcon,title:(0,Q.jsx)(f().sA,{defaultMessage:"Show in view",id:"database.viewSettings.propertyTab.showInViewButton.title"}),onClick:()=>to(b,u,m,y)})),V&&(0,Q.jsx)(Ce().A,{icon:o(764781).V,title:(0,Q.jsx)(f().sA,{defaultMessage:"Duplicate property",id:"database.viewSettings.propertyTab.duplicateButton.title"}),onClick:()=>async function(e,t,o,n,i){const r=no({formatKey:i,collectionContextStore:o}),a=o.normalizedSchemaStore.state,l=o.collectionStore(),c=null==l?void 0:l.getSpaceId();if(!l||!c)return;const d=(0,s()._g)({schema:a,property:t});if(!d)return;const p=l.getNormalizedPropertyGroups(),u=await(0,K().W4)({environment:e,schema:a,property:t,properties:r,propertyGroups:p,parentStore:l,spaceId:c});if(!u)return;const m=e.currentUser.id,f=m?{id:m,table:g().oo}:void 0,y=o.collectionViewStore();T().createAndCommit({userAction:"CollectionSettingsProperty.handleDuplicateClick",environment:e,canUndo:!0,perform:n=>{(0,h().O9)(u.automationUpdate)&&I().duplicateAutomation({actorPointer:f,environment:e,sourceAutomationStore:u.automationUpdate.sourceAutomationStore,targetAutomationId:u.automationUpdate.targetAutomationId,transaction:n});const r={...a,[u.newProperty]:u.newPropertySchema},s={...l.getFormat(),collection_page_properties:u.newProperties,property_groups:u.newPropertyGroups};(0,B().I)({environment:e,collectionStore:l,update:{schema:r,format:s},transaction:n});const c=ao({property:t,formatKey:i,collectionContextStore:o});M().sp({environment:e,collectionContextStore:o,currentIndex:c,entrypoint:"CollectionSettingsProperty",transaction:n,propertyAction:"duplicate"}),i&&y&&j().zA({stores:[y],update:{[i]:u.newProperties},transaction:n})}}),A().os({collectionSettingsStore:n}),(0,v().X)({environment:e,collectionContextStore:o,action:"duplicate_property",original_view_type:null==y?void 0:y.getType(),property_type:d.type})}(b,y,u,S,m)}),z&&(0,Q.jsx)(jo,{collectionContextStore:u,property:y,collectionSettingsStore:S,formatKey:m,isRequiredTypedProperty:c,databaseType:p}),W&&(0,Q.jsx)(Mo,{})]}),"formula"===t.type&&(0,Q.jsx)(H().A,{topBorder:!0,children:(0,Q.jsx)(Ne().A,{href:(0,$().xS)("guides.formulas"),title:(0,Q.jsx)(f().sA,{defaultMessage:"Learn about formulas",id:"database.viewSettings.propertyTab.formulas.learnMoreButton.title"}),analyticsFrom:"view_settings_property_formula"})}),"relation"===t.type&&(0,Q.jsx)(Co,{collectionContextStore:u,property:y}),"rollup"===t.type&&(0,Q.jsx)(H().A,{topBorder:!0,children:(0,Q.jsx)(Ne().A,{href:(0,$().xS)("guides.relations"),title:(0,Q.jsx)(f().sA,{defaultMessage:"Learn about rollups",id:"database.viewSettings.propertyTab.rollups.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]}):null}function _o(e){let{property:t,propertySchema:o,collectionContextStore:a,source:s,buttonPopupParent:c}=e;const d=(0,i().v3)(),p=a.settingsStore,u=(0,r().K8)((()=>(0,E().O0)(d)),[d]);return(0,n.useMemo)((()=>"button"===o.type),[o.type])?null:(0,Q.jsxs)(Q.Fragment,{children:[u&&"text"===o.type&&(0,Q.jsx)(Ao,{collectionContextStore:a,property:t,collectionSettingsStore:p,source:s}),(0,l().lx)(o)&&(0,Q.jsx)(bo,{collectionSettingsStore:p,collectionContextStore:a,property:t,propertySchema:o,buttonPopupParent:c}),"status"===o.type&&(0,Q.jsx)(lo,{collectionSettingsStore:p,collectionContextStore:a,property:t}),"formula"===o.type&&(0,Q.jsx)(so,{collectionContextStore:a,collectionSettingsStore:p,property:t}),"rollup"===o.type&&(0,Q.jsx)(wo,{property:t,collectionContextStore:a}),("date"===o.type||"created_time"===o.type||"last_edited_time"===o.type)&&(0,Q.jsx)(co,{collectionContextStore:a,property:t}),"relation"===o.type&&(0,Q.jsx)(po,{collectionContextStore:a,property:t}),"person"===o.type&&(0,Q.jsx)(So,{collectionContextStore:a,property:t}),(0,Q.jsx)(uo,{collectionContextStore:a,property:t,source:s}),(0,Q.jsx)(mo,{collectionContextStore:a,property:t}),"auto_increment_id"===o.type&&(0,Q.jsx)(ho,{collectionContextStore:a,property:t}),"button"===o.type&&(0,Q.jsx)(fo,{collectionContextStore:a,property:t})]})}},877568:(e,t,o)=>{o.d(t,{_:()=>i});var n=()=>o(534177);function i(e){const{taskRunningState:t}=e;switch(t.status){case"requested":return!0;case"running":return t.numPagesFilled<t.numPagesRequested;case"error":case"notRunning":return!1;default:(0,n().HB)(t)}}},896427:(e,t,o)=>{o.d(t,{EB:()=>B,Ay:()=>R,DZ:()=>O});var n=o(296540),i=()=>o(484714),r=()=>o(56366),a=()=>o(401497),l=()=>o(665589),s=()=>o(133033),c=()=>o(340498),d=()=>o(68263),p=()=>o(959013),u=()=>o(496603),m=()=>o(901952),g=()=>o(406699),f=()=>o(811979),y=()=>o(419357),h=()=>o(204063),S=()=>o(16006),x=()=>o(89924),v=()=>o(574036),b=()=>o(859428),C=()=>o(125565),A=()=>o(780054),w=()=>o(685889),j=()=>o(806401),M=()=>o(962730),T=()=>o(463830),_=()=>o(487941),P=o(474848);function k(e){const{temporaryAutoRelateState:t,handleAutoRelateToggle:o,collectionStore:n,targetCollectionStore:i,autoRelate:l}=e,c=(0,r().K8)((()=>(null==n?void 0:n.getFormat().bot_id)||i.getFormat().bot_id),[n,i]),d=!!c,u=(0,a().IS)((e=>({helpIcon:{width:16,fill:e.icon.tertiary,marginLeft:6}})),[]),m=(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[(0,P.jsx)(p().sA,{defaultMessage:"Automatically Relate",id:"database.viewSettings.setupRelationTab.autoRelate.title"}),!A().A.isMobile&&(0,P.jsx)(b().A,{render:e=>(0,P.jsx)("div",{...e,children:(0,s().$)(u.helpIcon)}),style:{width:200},placement:M().W.Bottom,textWrap:!0,renderTooltip:()=>(0,P.jsx)(p().sA,{defaultMessage:"Relations will automatically populate based on links found in page properties.",id:"database.viewSettings.setupRelationTab.autoRelateTooltip"})})]});return d?(0,P.jsx)(v().A,{title:m,on:t?t.enabled:!!l&&(null==l?void 0:l.enabled),focused:!1,onClick:()=>o(c),textWrapperStyle:{opacity:1}}):null}var I=()=>o(497222);function R(e){const{collectionContextStore:t,property:o,targetCollectionStore:l,temporaryInverseState:c,setTemporaryInverseState:u,mode:y="edit",onSubmit:x,shouldEnforceTwoWayRelation:R}=e,K=(0,i().v3)(),F=(0,p().tz)(),L=(0,r().uB)(void 0,T().A),V=(0,r().K8)((()=>o?w().Jq(t,o):void 0),[t,o]),H=(0,j().D)(V),z=(0,r().K8)((()=>t.collectionStore()),[t]),W=(0,r().K8)((()=>t.contextType),[t]),N=Boolean((null==z?void 0:z.id)===l.id),Y=(0,r().K8)((()=>Boolean(o?w().D5(t,o,l):void 0)),[t,o,l]),q=(0,r().K8)((()=>{if("relation"!==(null==V?void 0:V.type))return"";const e=V.property;if(!e||e===o)return"";const t=l.getRole();if(!t||!d().Tt(t))return"";const n=l.getSchema()[e];return(null==n?void 0:n.name)||""}),[l,o,V]),E=(0,r().K8)((()=>"relation"===(null==V?void 0:V.type)&&V.autoRelate?V.autoRelate:{enabled:!1}),[V]),U=(0,r().K8)((()=>Boolean(w().uf(l))),[l]),G=(0,r().K8)((()=>Boolean((null==z?void 0:z.getDatabaseType())&&o&&(null==z?void 0:z.isTypedProperty(o)))),[z,o]),$=(0,n.useMemo)((()=>c?c.hasInverseRelation:Y),[c,Y]),Z=(0,n.useMemo)((()=>c?c.inverseName:q),[c,q]),J=(0,n.useMemo)((()=>c?c.autoRelate:E),[c,E]),X=(0,n.useCallback)((()=>{o&&(0,m().V)({environment:K,collectionContextStore:t,property:o,from:"collectionPage"===W?"page_properties":"view_settings",action:$?"relation_toggle_inverse_off":"relation_toggle_inverse_on",is_self_relation:N})}),[o,t,K,W,N,$]),Q=(0,n.useCallback)((()=>null!=z&&z.isSyncedCollection()?J:$?{enabled:!1}:J),[z,J,$]),ee=(0,n.useCallback)((()=>{u({hasInverseRelation:!0,inverseName:Z,autoRelate:Q()}),X()}),[u,Z,X,Q]),te=(0,n.useCallback)((()=>{u({hasInverseRelation:!1,inverseName:void 0,autoRelate:Q()}),X()}),[u,X,Q]),oe=Boolean(H||!U||G||R),ne=(0,n.useCallback)((e=>{u({hasInverseRelation:!0,inverseName:e.target.value,autoRelate:J})}),[u,J]),ie=(0,n.useCallback)((e=>{const n=null!=J&&J.enabled?{enabled:!1}:{enabled:!0,bot_id:e};u({hasInverseRelation:$,inverseName:Z,autoRelate:n}),o&&(0,m().V)({environment:K,collectionContextStore:t,property:o,from:"collectionPage"===W?"page_properties":"view_settings",action:n.enabled?"auto_relation_toggle_on":"auto_relation_toggle_off"})}),[o,u,t,W,Z,$,J,K]),re=(0,a().IS)((e=>({container:{width:A().A.isMobile?"100%":250,paddingBottom:A().A.isMobile?16:8,paddingLeft:A().A.isMobile?8:4,paddingRight:A().A.isMobile?8:4,marginTop:8},helpIcon:{width:16,fill:e.icon.tertiary,marginLeft:6},disabled:{opacity:.5,pointerEvents:"none"}})),[]),ae=(0,r().uB)(void 0,_().A),le=(0,r().K8)((()=>ae.state.hovered||ae.state.focused),[ae]),se=(0,n.useMemo)((()=>!U||G?F.formatMessage(O.errors.cannotEditTargetDatabase):N?F.formatMessage(O.tooltips.selfRelationInverseTooltip):F.formatMessage(O.tooltips.inverseRelationTooltip,{databaseName:(0,P.jsx)(S().A,{shouldWrap:!0,style:{display:"inline"},store:l})})),[U,G,F,N,l]),ce=(0,n.useMemo)((()=>(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"pre"},children:[F.formatMessage(O.generic.title),!A().A.isMobile&&(0,P.jsx)(b().A,{placement:M().W.Bottom,textWrap:!0,style:{width:200},store:ae,render:e=>(0,P.jsx)("div",{...e,children:(0,s().$)(re.helpIcon)}),renderTooltip:()=>se})]})),[F,re.helpIcon,se,ae]);return z?(0,P.jsxs)(P.Fragment,{children:["create"===y&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(B,{currentInverseState:$,disableInverseRelation:te,enableInverseRelation:ee,handleAutoRelateToggle:ie,temporaryInverseState:c,collectionStore:z,targetCollectionStore:l,isTwoWayToggleDisabled:oe,isNameDisabled:oe,menuTitle:ce,autoRelate:E,isSelfRelation:N,inverseRelationName:q,handleInverseNameChange:ne}),(0,P.jsx)(h().A,{style:{display:"flex",margin:"6px 12px 0px 12px"},onClick:x,children:F.formatMessage(O.create.addRelation)})]}),"edit"===y&&(0,P.jsx)(f().A,{focused:!1,disabled:oe,popupType:A().A.isMobile?g().z7.SlideUp:g().z7.Popup,alignmentToOrigin:g().yP.End,placementToOrigin:g().sx.Bottom,isFullWidthOnMobile:!0,buttonPopupStore:L,onClose:x,renderOrigin:e=>(0,P.jsx)(b().A,{placement:M().W.Bottom,textWrap:!0,style:{width:200},forceVisibleState:!le&&void 0,disableTooltip:!H,render:t=>(0,P.jsx)("div",{...t,children:(0,P.jsx)(I().A,{...e,showChevron:!0,rotateChevron:L.state.open,title:ce,disabled:oe,right:$?F.formatMessage(O.generic.on):F.formatMessage(O.generic.off)})}),renderTooltip:()=>H&&F.formatMessage(O.tooltips.disabledTwoWayRelationTooltip)}),render:e=>(0,P.jsxs)("div",{style:re.container,children:[(0,P.jsx)(v().A,{textWrapperStyle:{overflow:"hidden",display:"inline-flex"},focused:!1,disabled:oe,on:$,title:F.formatMessage(O.edit.enable),titleStyle:{display:"inline-flex"},onClick:e=>{$?te():ee()}}),(0,P.jsxs)("div",{style:$?void 0:re.disabled,children:[(0,P.jsx)(k,{handleAutoRelateToggle:ie,temporaryAutoRelateState:null==c?void 0:c.autoRelate,collectionStore:z,autoRelate:E,targetCollectionStore:l}),(0,P.jsx)(D,{collectionStore:z,targetCollectionStore:l,isSelfRelation:N,temporaryInverseState:c,inverseRelationName:q,disabled:oe,onChange:ne,title:(0,P.jsx)(C().A,{isSecondaryColor:!0,isSmall:!0,children:F.formatMessage(O.edit.propertyNameLabel)})})]})]})})]}):null}function B(e){const{currentInverseState:t,disableInverseRelation:o,enableInverseRelation:n,handleAutoRelateToggle:i,temporaryInverseState:r,collectionStore:a,targetCollectionStore:s,isTwoWayToggleDisabled:d,isNameDisabled:u,menuTitle:m,autoRelate:g,isSelfRelation:f,inverseRelationName:y,handleInverseNameChange:h}=e,S=(0,p().tz)();return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(v().A,{icon:(0,l().l)({width:c().Ev.default,height:c().Ev.default}),textWrapperStyle:{overflow:"hidden",display:"inline-flex"},focused:!1,on:t,disabled:d,title:m,titleStyle:{display:"inline-flex"},onClick:()=>{t?o():n()}}),t&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(k,{handleAutoRelateToggle:i,temporaryAutoRelateState:null==r?void 0:r.autoRelate,collectionStore:a,autoRelate:g,targetCollectionStore:s}),(0,P.jsx)(D,{collectionStore:a,targetCollectionStore:s,isSelfRelation:f,temporaryInverseState:r,inverseRelationName:y,disabled:u,onChange:h,title:(0,P.jsx)(C().A,{isSmall:!0,isSecondaryColor:!0,children:f?S.formatMessage(O.create.selfRelationPropertyNameHeader):S.formatMessage(O.create.relationPropertyNameHeader)})})]})]})}function D(e){const{collectionStore:t,targetCollectionStore:o,isSelfRelation:n,temporaryInverseState:i,inverseRelationName:a,disabled:l,onChange:s,title:c}=e,d=(0,p().tz)(),m=(0,r().K8)((()=>null!=t&&t.isDefined()?w().zF(d,{sourceCollection:t.getModel(),isSelfRelation:n,targetCollectionStore:o,createUnique:!0}):d.formatMessage(O.placeholders.relatedToTarget)),[t,d,n,o]);return(0,P.jsx)(x().A,{title:c,noTextOverflow:!0,children:(0,P.jsx)(y().Ay,{value:(null==i?void 0:i.inverseName)||a,placeholder:m,onChange:s,onBlur:u().D_,onSubmit:u().D_,focusInitial:!0,selectAll:!1,disabled:l})})}const O={generic:(0,p().YK)({on:{id:"database.viewSettings.setupRelationTab.generic.on",defaultMessage:"On"},off:{id:"database.viewSettings.setupRelationTab.generic.off",defaultMessage:"Off"},title:{id:"database.viewSettings.setupRelationTab.generic.title",defaultMessage:"Two-way relation"}}),create:(0,p().YK)({addRelation:{id:"database.viewSettings.setupRelationTab.create.relation.add",defaultMessage:"Add relation"},addRelationInverse:{id:"database.viewSettings.setupRelationTab.create.relation.inverse.add",defaultMessage:"Show onÂ {databaseName}"},addSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.addSelfRelationInverse",defaultMessage:"Separate directions {icon}"},relationPropertyNameHeader:{id:"database.viewSettings.setupRelationTab.create.relation.inverse.propertyNameHeader",defaultMessage:"Related property name"},selfRelationPropertyNameHeader:{id:"database.viewSettings.setupRelationTab.create.selfRelation.inverse.propertyNameHeader",defaultMessage:"Inverse related property name"}}),edit:(0,p().YK)({modalTitle:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.modalTitle",defaultMessage:"Related property settings"},enable:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.enable",defaultMessage:"Enable"},propertyNameLabel:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.propertyNameLabel",defaultMessage:"Related property name"},addRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.add",defaultMessage:"Show onÂ {databaseName}"},editRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.edit",defaultMessage:"Edit relation on {databaseName}"},saveRelationInverse:{id:"database.viewSettings.setupRelationTab.relation.inverse.save",defaultMessage:"Save"},removeRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.relation.inverse.remove",defaultMessage:"Remove property"},addSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.add",defaultMessage:"Add inverse property"},editSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.edit",defaultMessage:"Edit inverse property"},renameSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.rename",defaultMessage:"Rename"},saveSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.save",defaultMessage:"Save"},removeSelfRelationInverse:{id:"database.viewSettings.setupRelationTab.edit.selfRelation.inverse.remove",defaultMessage:"Remove property"}}),tooltips:(0,p().YK)({inverseRelationTooltip:{id:"database.viewSettings.setupRelationTab.relation.inverse.tooltip",defaultMessage:"Manage property on {databaseName} showing backlinks to the current database"},selfRelationInverseTooltip:{id:"database.viewSettings.setupRelationTab.selfRelation.inverse.tooltip",defaultMessage:"Manage separate properties for each direction of a two-way relation. Useful for modeling Parent task/Sub-tasks, Blocked by/Blocking, and more."},disabledTwoWayRelationTooltip:{id:"database.viewSettings.setupRelationTab.relation.inverse.disabled.tooltip",defaultMessage:"Two-way relations cannot be enabled when share settings are inherited through this relation."}}),errors:(0,p().YK)({cannotEditTargetDatabase:{id:"database.viewSettings.setupRelationTab.inverseDisabledWarning.title",defaultMessage:"Cannot edit target database."}}),placeholders:(0,p().YK)({relatedToTarget:{id:"database.viewSettings.setupRelationTab.relation.inverse.placeholder",defaultMessage:"Related to target"}})}},939656:(e,t,o)=>{o.d(t,{Fc:()=>u,Jq:()=>d,k7:()=>p});var n=()=>o(970013),i=()=>o(235191),r=()=>o(751156),a=()=>o(852353),l=()=>o(342),s=()=>o(878423),c=()=>o(630116);function d(e){let{collectionContextStore:t,property:o}=e;return(0,a().Kc)(t)[o]}function p(e,t){var o;if("relation"!==(null==t?void 0:t.type))return;const i=null===(o=s().A.state.caches[l().oB])||void 0===o?void 0:o.inMemoryRecordCache,r=(0,n().Nv)(t),a=r&&e?c().md.createChildStore(e,r):void 0;return i?null==a?void 0:a.clone(i):a}function u(e){const{name:t,environment:o,property:n,collectionContextStore:l,inputValue:s}=e;if((0,a().fE)({property:n,collectionContextStore:l,newValue:s}))return;const c=l.collectionStore();if(!c)return;const d=c.getSchema()[n];d&&d.name!==t&&r().createAndCommit({userAction:"ButtonBuilderModal.handlePropertyNameSubmit",environment:o,canUndo:!0,perform:e=>{i().YO({collectionStore:c,property:n,name:t,transaction:e})}})}},971404:(e,t,o)=>{o.d(t,{V:()=>r,X:()=>a});var n=()=>o(597777);const i={"de-DE":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"da-DK":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"fi-FI":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"nb-NO":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"nl-NL":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"sv-SE":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"en-US":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"es-ES":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"es-LA":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"fr-FR":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"pt-BR":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"ko-KR":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"YYYY[ë…„] MMMM"},"zh-CN":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"YYYY[å¹´]MMM"},"zh-TW":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"YYYY[å¹´]MMM"},"ja-JP":{time:{"12h":"A h:mm","24h":"H:mm",hidden:n().jk},month:"YYYY[å¹´]MMM"},"vi-VN":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"th-TH":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"id-ID":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},"en-GB":{time:{"12h":"LT","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"},pseudo:{time:{"12h":"A h:mm","24h":"H:mm",hidden:n().jk},month:"MMMM YYYY"}},r=["de-DE","fr-FR"];function a(e){return i[e]}}}]);