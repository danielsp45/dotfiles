"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[7520,65213],{243670:(e,t,n)=>{n.d(t,{J7:()=>i,V9:()=>c,XF:()=>u,r0:()=>d,tk:()=>a,tz:()=>l});n(581454);var r=()=>n(244641),s=()=>n(762433);const o={0:"onboardingIntro",1:"intro",3:"inviteMembers",5:"connectWorkspace",8:"createTeamspaces",11:"verifyPages",14:"samlSSO",17:"storeRecords",20:"notionAi"},i=Object.fromEntries((0,n(534177).WP)(o).map((e=>{let[t,n]=e;return[n,Number(t)]})));function a(e){if(e in o)return o[e]}function l(e,t,n){const s=r().c9.fromMillis(e.endDateMs),o=n??r().c9.now();return o<s&&s.diff(o).as("days")<=t}function c(e,t){const n=r().c9.fromMillis(e.endDateMs);return(t??r().c9.now())>n}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,s().DS)(e);if(!e)return;const n=(0,s().i5)(e);return n?Math.floor(null==n?void 0:n.startOf("day").diff(t.startOf("day"),"days").days):void 0}function u(e,t){const n=r().c9.fromMillis(e.endDateMs);return(t??r().c9.now()).hasSame(n,"day")}},271084:(e,t,n)=>{n.d(t,{k:()=>s});n(581454);class r extends(()=>n(757695))().Store{getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}getSortedUserIds(){return Object.entries(this.state||{}).sort(((e,t)=>{let[n,r]=e,[s,o]=t;return o-r})).map((e=>{let[t,n]=e;return t}))}}const s=new r;(0,n(604341).exposeDebugValue)("UserSimilarityStore",s)},529803:(e,t,n)=>{n.d(t,{A:()=>s});class r extends(()=>n(757695))().Store{}const s=new r},624199:(e,t,n)=>{n.d(t,{L3:()=>o,Sp:()=>a,iJ:()=>s,uE:()=>i});var r=()=>n(757695);const s=r().Store.createValue({open:!1,openedFrom:void 0},{name:"SelfServeBusinessTrialStartModalStore"}),o=r().Store.createValue({open:!1,openedFrom:void 0,recentPageStores:[],verifiedPageStores:[],teamStores:[],workspaceUserStores:[],connectedApps:[],numAiMeetingMinutes:0,modalState:"initial"},{name:"SelfServeBusinessTrialEndingModalStore"}),i=r().Store.createValue({open:!1,openedFrom:void 0,connectedApps:[],teamStores:[],pageStores:[],onSecondaryButtonClick:void 0},{name:"SelfServeBusinessTrialLossAversionModalStore"}),a=r().Store.createValue({open:!1,connectedApps:[],teamStores:[],pageStores:[]},{name:"SelfServeBusinessTrialExplorePlanStore"})},922442:(e,t,n)=>{n.r(t),n.d(t,{closeSelfServeBusinessTrialEndingModal:()=>y,closeSelfServeBusinessTrialExplorePlanModal:()=>w,closeSelfServeBusinessTrialLossAversionModal:()=>T,closeSelfServeBusinessTrialStartModal:()=>m,createSelfServeBusinessTrial:()=>B,determineMessageEligibility:()=>E,determineShouldShowTrialEndingModal:()=>A,getBusinessTrialUsingOffersReceived:()=>D,openSelfServeBusinessTrialEndingModal:()=>g,openSelfServeBusinessTrialExplorePlanModal:()=>h,openSelfServeBusinessTrialLossAversionModal:()=>M,openSelfServeBusinessTrialStartModal:()=>v,updateSelfServeBusinessTrialEndingModalState:()=>b});n(16280);var r=()=>n(244641),s=()=>n(386164),o=()=>n(762433),i=()=>n(323063),a=()=>n(166386),l=()=>n(461946),c=()=>n(449506),d=()=>n(243670),u=()=>n(981046),S=()=>n(624199),f=()=>n(753735),p=()=>n(411341);function v(e){S().iJ.setState({open:!0,...e})}function m(){S().iJ.update((e=>({...e,open:!1})))}function g(e){S().L3.update((()=>({modalState:"initial",...e,open:!0})))}function b(e){S().L3.update((t=>({...t,modalState:e})))}function y(){S().L3.update((e=>({...e,open:!1,modalState:"initial"})))}function M(e){S().uE.setState({...e,open:!0})}function T(){S().uE.update((e=>({...e,open:!1})))}function h(e){S().Sp.setState({open:!0,...e})}function w(){S().Sp.update((e=>({...e,open:!1})))}async function B(e){const{billingData:t,environment:n,spaceStore:s,from:a,memberCount:c,prices:d}=e;if(!s||!a||!t||void 0===c)return{success:!1,error:"Invalid arguments"};const S=e.nowForTesting??r().c9.now(),f=c,v={product:"business",interval:"month",currency:u().A.state.selectedCurrencyCode??"USD"},m={items:[{price:(0,i().vk)(d,v),quantity:f}],trialEnd:S.plus({days:l().WL})},g=(0,o().oD)(t)?"stacked_business_trial":"business_reverse";try{return await(0,p().updateSubscription)({environment:n,spaceStore:s,from:a,desiredState:m,trialData:{id:g,from:a}}),{success:!0,error:void 0}}catch(b){return{success:!1,error:b instanceof Error?b.message:void 0}}}async function D(e){const{billingData:t,environment:n,currentSpaceStore:r}=e,i=r.getSpaceId();if(!t||!(0,o().TB)(t))return;const a=await c().callApi({eventName:"getCustomerOffersReceived",environment:n,data:{spaceId:i},headers:(0,s().WS)({cellId:void 0,spaceId:i})});return"failed"!==a.type?(0,l().F$)(a.data):void 0}async function E(e,t){const{billingData:n,environment:r,currentSpaceStore:s}=t;if(!n)return!1;const i=(0,o().DS)(n),a=await D({environment:r,billingData:n,currentSpaceStore:s});if(!a)return!1;const c=(0,l().yL)(a);if(!c)return!1;const u=Math.floor(i.startOf("day").diff(c.startOf("day"),"days").days),S=d().J7[e];return("onboardingIntro"!==e||0!==u||"onboarding"===(null==a?void 0:a.entrypoint))&&u===S}function A(e){var t;const{billingData:n,businessTrialOffer:s,currentSpaceViewStore:i}=e;if(!n)return!1;const c=null===(t=i.getSettings())||void 0===t?void 0:t.business_trial_ending_modal_last_shown_at,u=(0,o().DS)(n);return!function(e,t){if(!e)return!1;const n=r().c9.fromMillis(e);return n.startOf("day").equals(t.startOf("day"))}(c,u)&&("business"!==(0,o().AW)(n)&&"enterprise"!==(0,o().AW)(n)&&(!(0,f().z2)({billingData:n,claimedOffers:[s]})&&(!(!s||(0,a().nb)(s))&&((0,d().tz)(s,l().x5,u)||(0,d().XF)(s,u)||(0,d().V9)(s,u)))))}}}]);