"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[22686],{3197:(e,t,o)=>{o.d(t,{t:()=>a});var n=o(296540),i=()=>o(183558),r=()=>o(248064),l=()=>o(384130),s=()=>o(937199);function a(e){const{setModuleSelection:t,layoutStore:o}=(0,s().LH)(),a=(0,r().h)(),{dismissTooltip:c}=(0,l().J)();return(0,n.useCallback)((()=>{var n;"form"===(null===(n=o.getModel())||void 0===n?void 0:n.getLayoutType())&&"form_conditional_modules"!==e.area?a({layoutModule:{type:"placeholder",id:(0,i().Ay)()},position:e.afterModuleId?{type:"module_relative",area:e.area,direction:"below",relativeToModuleId:e.afterModuleId}:void 0}):(t({type:"new_module",isDragging:!1,..."views_main_tab_modules"===e.area?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:e.area}}),"page_main"===e.area&&c())}),[o,e,a,t,c])}},7667:(e,t,o)=>{o.d(t,{A:()=>m});o(898992),o(737550),o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(959013),l=()=>o(534177),s=()=>o(901389),a=()=>o(751156),c=()=>o(254497),d=()=>o(312296),u=()=>o(519839),p=()=>o(175116),g=o(474848);function m(){const e=(0,p().Ks)(),t=(0,n().v3)(),o=(0,i().K8)((()=>null==e?void 0:e.settingsStore),[e]);return function(n){if(!o||!n||!e)return;const i=e.collectionStore();if((0,l().O9)(i)){const e=u().KA({deletedSchema:i.getDeletedSchema(),property:n});if(e){var p;if("verification"===(null===(p=i.getDeletedSchema()[n])||void 0===p?void 0:p.type)){const e=i.getSchema(),t=Object.keys(e).some((t=>{var o;return"verification"===(null===(o=e[t])||void 0===o?void 0:o.type)}));if(t)return void s().ui({message:(0,g.jsx)(r().sA,{id:"deletedPropertyMenu.cannotRestoreDuplicateProperty.modal.verification",defaultMessage:"You can only have one verification property."}),showCancel:!1,keepFocus:!0,items:[{label:(0,g.jsx)(r().sA,{id:"deletedPropertyMenu.cannotRestoreDuplicateProperty.modal.dismissButton",defaultMessage:"Dismiss"}),onAccept:()=>{}}]})}a().createAndCommit({userAction:"deletedPropertyMenu.handleRestoreDeletedPropertyClick",environment:t,canUndo:!0,perform:o=>{(0,d().F)({environment:t,collectionStore:i,update:e.updateSchema,transaction:o}),(0,c().E)({collectionStore:i,update:e.updateDeletedSchema,transaction:o})}})}}}}},38e3:(e,t,o)=>{o.d(t,{$:()=>p,Q:()=>g});o(16280);var n=()=>o(179034),i=()=>o(869558),r=()=>o(44729),l=()=>o(246826),s=()=>o(751156),a=()=>o(594794),c=()=>o(972435),d=()=>o(630116),u=()=>o(435930);function p(e){const{environment:t,layoutStore:o,transaction:n,options:i}=e,{inMemoryRecordCache:s}=o,a=o.getSpaceId(),c=o.getParentPointer();if(!c||"collection"!==c.table)throw new Error("Invalid state: no collection pointer");if(!a)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const d=l().Wv({environment:t,type:"collection_view",inMemoryRecordCache:s,transaction:n});r().NI({childStore:d,parentStore:o,transaction:n});const{collectionViewStore:u}=g({environment:t,transaction:n,layoutStore:o,collectionViewBlockStore:d,options:i});return{collectionViewStore:u,collectionViewBlockStore:d}}function g(e){const{environment:t,transaction:o,layoutStore:r,collectionViewBlockStore:p,options:g}=e,{inMemoryRecordCache:m}=r,S=r.getParentPointer();if(!S||"collection"!==S.table)throw new Error("Invalid state: no collection pointer");const f=r.getSpaceId();if(!f)throw new Error("Cannot add collection view to views main module -- Invalid state: no space id");const y=(0,a().JH)({environment:t,table:i().Gy,spaceId:f}),h={id:y.id,type:"page",parent_id:p.pointer.id,parent_table:n().ev,space_id:f,alive:!0,name:c().A.formatMessage(u().s.editor),format:{collection_pointer:S,hide_linked_collection_name:!0}};return null!=g&&g.viewsTabId&&(h.format={...h.format,page_layout_pointer:{...r.pointer,views_main_tab_id:g.viewsTabId}}),l().eC({environment:t,table:i().Gy,value:h,inMemoryRecordCache:m,transaction:o}),s().applyOperation({store:p,operation:{pointer:p.pointer,path:["view_ids"],command:"listBefore",args:{id:y.id}},transaction:o}),{collectionViewStore:d().pS.createChildStore(p,y)}}},39039:(e,t,o)=>{o.d(t,{gZ:()=>h,j7:()=>S,tx:()=>y});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(401497),l=()=>o(534177),s=()=>o(374562),a=()=>o(313892),c=()=>o(760217),d=()=>o(972435),u=()=>o(760578),p=o(474848);const g=(0,o(959013).YK)({property:{id:"customizeMenu.propertyMetadataDescription",defaultMessage:"Adds {dependencyCount, plural, one {# property} other {# properties}} to {databaseName}"},view:{id:"customizeMenu.viewMetadataDescription",defaultMessage:"Adds {dependencyCount, plural, one {# view} other {# views}} to {databaseName}"}}),m={property:g.property,collection_view:g.view,collection:void 0,sub_external_collection:void 0,collection_view_block:void 0,page_template:void 0,block:void 0,database_template:void 0};function S(e){const{collectionContextStore:t,buttonMenuItemProps:o,feature:l,caption:s,onClick:a,isDisabled:d,icon:u,right:g}=e,m=(0,n().Y0)(),S=(0,i().K8)((()=>t.databaseType),[t]),y=(0,r().IS)((()=>({menuItem:{display:"flex",paddingTop:m.isMobile?12:6,paddingBottom:m.isMobile?12:6,alignItems:"center",opacity:d?.4:void 0},featureName:{fontSize:m.isMobile?16:13},featureCaption:{fontSize:m.isMobile?14:12,overflow:"hidden",color:"gray",whiteSpace:"nowrap",textOverflow:"ellipsis"},featureTextWrapper:{lineHeight:m.isMobile?"20px":"18px"}})),[m,d]);return(0,p.jsx)(c().A,{...o,style:y.menuItem,icon:u,dontShrinkIcon:!0,title:(0,p.jsxs)("div",{style:y.featureTextWrapper,children:[(0,p.jsx)("div",{style:y.featureName,children:f(l,S)}),(0,p.jsx)("div",{style:y.featureCaption,children:s})]}),disabled:d,onClick:a,right:!d&&g})}function f(e,t){if("notion://tasks/sub_task_feature"===e.uri){const{values:e,...o}=(0,u().mv)({feature:"subitem",databaseType:t});return d().A.formatMessage(o,e)}return e.name}function y(e,t){if("notion://tasks/sub_task_feature"===e.uri){const{values:e,...o}=(0,u().I_)({feature:"subitem",databaseType:t});return d().A.formatMessage(o,e)}return e.description}function h(e,t){if(e.uri!==(0,s().md)().uri&&e.uri!==(0,s().J4)().uri&&((0,a().lK)(e)||(0,a().u1)(e))){const o={property:0,collection_view:0,collection:0,sub_external_collection:0,collection_view_block:0,page_template:0,block:0,database_template:0};for(const t of e.dependencies)t.type in o&&o[t.type]++;let n="";for(const e of(0,l().uv)(m))if(o[e]>0){const i=m[e];if(!i)continue;n+=`${d().A.formatMessage(i,{dependencyCount:o[e],databaseName:t})}\n`}return n}}},50170:(e,t,o)=>{o.d(t,{u:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("collectionList",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.08716 5.15576C2.64087 5.15576 3.08911 4.70752 3.08911 4.15381C3.08911 3.6001 2.64087 3.15186 2.08716 3.15186C1.53345 3.15186 1.08521 3.6001 1.08521 4.15381C1.08521 4.70752 1.53345 5.15576 2.08716 5.15576ZM5.29736 4.85254H14.2161C14.605 4.85254 14.9148 4.54272 14.9148 4.15381C14.9148 3.76489 14.605 3.45508 14.2161 3.45508H5.29736C4.90845 3.45508 4.59863 3.7583 4.59863 4.15381C4.59863 4.54272 4.90186 4.85254 5.29736 4.85254ZM2.08716 9.24927C2.64087 9.24927 3.08911 8.80103 3.08911 8.24731C3.08911 7.6936 2.64087 7.24536 2.08716 7.24536C1.53345 7.24536 1.08521 7.6936 1.08521 8.24731C1.08521 8.80103 1.53345 9.24927 2.08716 9.24927ZM5.29736 8.94604H14.2161C14.605 8.94604 14.9148 8.64282 14.9148 8.24731C14.9148 7.8584 14.605 7.54858 14.2161 7.54858H5.29736C4.90845 7.54858 4.59863 7.8584 4.59863 8.24731C4.59863 8.63623 4.90186 8.94604 5.29736 8.94604ZM2.08716 13.3428C2.64087 13.3428 3.08911 12.8945 3.08911 12.3408C3.08911 11.7937 2.64087 11.3389 2.08716 11.3389C1.53345 11.3389 1.08521 11.7937 1.08521 12.3408C1.08521 12.8945 1.53345 13.3428 2.08716 13.3428ZM5.29736 13.0396H14.2161C14.605 13.0396 14.9148 12.7363 14.9148 12.3408C14.9148 11.9519 14.605 11.6487 14.2161 11.6487H5.29736C4.90845 11.6487 4.59863 11.9519 4.59863 12.3408C4.59863 12.7297 4.90186 13.0396 5.29736 13.0396Z"})})},58488:(e,t,o)=>{o.d(t,{I:()=>a});o(296540);var n=()=>o(56366),i=()=>o(348241),r=()=>o(175116),l=()=>o(937199),s=o(474848);function a(e){const{children:t}=e,o=(0,r().ET)(),a=(0,n().O$)(o.formsBaseLayoutEditorContextValueStore),c=(0,n().O$)(o.formsSpecificLayoutEditorContextValueStore);return a&&c?(0,s.jsx)(l().Op.Provider,{value:a,children:(0,s.jsx)(i().zi.Provider,{value:c,children:t})}):null}},63667:(e,t,o)=>{o.d(t,{k:()=>m});o(296540);var n=()=>o(56366),i=()=>o(401497),r=()=>o(713998),l=()=>o(743176),s=()=>o(859428),a=()=>o(852353),c=()=>o(553965),d=()=>o(962730),u=()=>o(937199),p=()=>o(478573),g=o(474848);function m(e){const{propertyId:t}=e,{collectionStore:o}=(0,u().LH)(),m=(0,i().DP)(),S=(0,n().K8)((()=>{if(!o)return;const e=o.getSchema();return(0,r()._g)({schema:e,property:t})}),[o,t]);if(!S)return null;const f=S.type;return(0,g.jsx)(s().A,{textWrap:!0,placement:d().W.Left,renderTooltip:()=>e.tooltip,disableTooltip:!e.tooltip,render:t=>(0,g.jsx)(p().A,{...(0,c().A)(t,e),icon:(0,g.jsx)(l().zB,{size:16,theme:m,icon:S.icon,type:f}),name:S.name,subText:a().dC[f],disabled:e.disabled})})}},94701:(e,t,o)=>{o.r(t),o.d(t,{checkmarkFillIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.66 3.66 12.68 12.68",svg:(0,o(474848).jsx)("path",{d:"M15.913 3.787a.875.875 0 0 1 .3 1.2L9.658 15.914a.875.875 0 0 1-1.415.119l-4.37-5.098a.875.875 0 0 1 1.329-1.14l3.58 4.177 5.93-9.884a.875.875 0 0 1 1.2-.3"})},i=(0,o(340498).wt)("checkmarkFill",n)},95347:(e,t,o)=>{o.d(t,{C5:()=>te,Dj:()=>q,NE:()=>ee,Ro:()=>Z,ff:()=>J,hw:()=>X,jk:()=>Y,rD:()=>D,wG:()=>L});o(944114),o(898992),o(823215),o(354520),o(672577),o(803949),o(581454),o(737550);var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(401497),s=()=>o(66689),a=()=>o(128914),c=()=>o(455348),d=()=>o(959013),u=()=>o(209199),p=()=>o(496603),g=()=>o(154017),m=()=>o(686526),S=()=>o(36629),f=()=>o(751156),y=()=>o(767435),h=()=>o(617254),x=()=>o(248823),v=()=>o(328327),C=()=>o(326224),b=()=>o(117293),w=()=>o(374562),j=()=>o(646668),A=()=>o(313892),_=()=>o(334955),I=()=>o(180762),M=()=>o(972435),k=()=>o(71304),T=()=>o(963589),P=()=>o(765957),B=()=>o(666429),V=()=>o(455338),F=()=>o(234675),E=()=>o(739222);const R=(0,d().YK)({databaseNamePlaceholder:{id:"customizeMenu.databaseNamePlaceholder",defaultMessage:"database"}});function D(e){return(0,r().K8)((()=>{var t;if(!e)return;const o=null===(t=e.collectionStore())||void 0===t?void 0:t.getDatabaseType();return o?(0,A().lS)((0,h().appConfigs)(),o):void 0}),[e])}function K(e){const{collectionFormat:t,feature:o}=e,n=t.app_config_uri;return o.collectionUri===n&&o.dependencies.some((e=>"property"===e.type&&e.collectionUri===n&&(0,a().LE)(e.uri)))}function O(e){const{environment:t,collectionStore:o,collectionFormat:n,collectionViewBlockStore:i,feature:r}=e;if(1!==r.dependencies.length||"collection_view"!==r.dependencies[0].type)return!1;if(r.uri===(0,w().Bd)().uri)return!1;const l=r.dependencies[0];return l.collectionViewBlockUri===i.getFormat().app_config_uri&&l.collectionUri===n.app_config_uri&&(0,A().Hb)({environment:t,viewDependency:l,collectionStore:o})}function L(e,t){const o=(0,i().v3)(),n=D(e),l=[(0,w().md)(),(0,w().J4)(),...j().v],a=(0,E().bz)(e);return(0,r().K8)((()=>{var t,i;if(!n){return Q([...l,...a],s().iH)}const r=null===(t=e.collectionStore())||void 0===t?void 0:t.getFormat(),c=null===(i=e.collectionStore())||void 0===i?void 0:i.getSchema(),d=e.collectionStore(),u=e.collectionViewBlockStore();if(!(r&&c&&d&&u))return[];const g={};n.allFeatures.forEach((e=>{(0,A().$n)(e)&&e.variants.every((e=>Boolean(n.allFeatures.find((t=>t.uri===e&&(0,A().lK)(t)&&K({collectionFormat:r,feature:t}))))))&&(g[e.uri]=e.variants)}));const m=Object.values(g).flat(),S=[];for(const e of n.allFeatures)if(!S.find((t=>t.uri===e.uri)))if(!m.find((t=>t===e.uri))&&(0,A().lK)(e)){const t=K({collectionFormat:r,feature:e}),n=O({environment:o,collectionStore:d,collectionFormat:r,collectionViewBlockStore:u,feature:e});(t||n)&&S.push(e)}else(0,A().$n)(e)&&Boolean(g[e.uri])&&S.push(e);const f=[...l,...a,...S];return Q(p().hS(f,"uri"),e.databaseType)}),[n,e,l,a,o])}const z=p().Bj((()=>({[(0,w().md)().uri]:1,[(0,w().J4)().uri]:2,[E().YX.uri]:3,[(0,j().nr)().uri]:4,[(0,j().uo)().uri]:5,[(0,j().Rh)().uri]:6,[(0,j().rr)().uri]:7,[E().iF]:8,[E().Bm]:9,[E().js]:10,[E().nu]:11}))),N=p().Bj((()=>({[(0,w().qK)().uri]:1,[(0,w().md)().uri]:2,[(0,w().J4)().uri]:3,[E().YX.uri]:4,[(0,w().mh)().uri]:5,[(0,w().e3)().uri]:6,[(0,w().AG)().uri]:7,[(0,j().nr)().uri]:8,[(0,j().uo)().uri]:9,[(0,j().Rh)().uri]:10,[(0,j().rr)().uri]:11,[(0,w().Bd)().uri]:12,[(0,w().wB)().uri]:13,[(0,w().Q2)().uri]:14,[(0,w().bM)().uri]:15,[(0,w().kr)().uri]:16,[(0,w().Xq)().uri]:17,[E().RH.uri]:18,[E().Bm]:19,[E().iF]:20,[E().js]:21,[E().nu]:22}))),U=p().Bj((()=>({[(0,C().uj)().uri]:1,[(0,w().md)().uri]:2,[(0,w().J4)().uri]:3,[(0,C().KS)().uri]:4,[(0,j().nr)().uri]:5,[(0,j().uo)().uri]:6,[(0,j().Rh)().uri]:7,[(0,j().rr)().uri]:8,[(0,C().XP)().uri]:9,[(0,C().EQ)().uri]:10,[(0,C().t_)().uri]:11,[(0,C().$k)().uri]:12,[(0,C().Tb)().uri]:13,[E().Bm]:14,[E().js]:15,[E().nu]:16}))),W=p().Bj((()=>({[E().RH.uri]:1,[(0,b().HS)().uri]:2,[(0,w().md)().uri]:3,[(0,w().J4)().uri]:4,[(0,C().KS)().uri]:5,[(0,j().nr)().uri]:6,[(0,j().uo)().uri]:7,[(0,j().Rh)().uri]:8,[(0,j().rr)().uri]:9,[(0,b().f9)().uri]:10,[E().Bm]:11,[E().js]:12,[E().nu]:13}))),H=p().Bj((()=>({[(0,w().md)().uri]:1,[(0,w().J4)().uri]:2,[(0,v().$$)().uri]:3,[(0,v().mU)().uri]:4,[(0,v().PA)().uri]:5,[(0,v().Ub)().uri]:6,[(0,v().mU)().uri]:7,[(0,v().AN)().uri]:8,[(0,j().nr)().uri]:9,[(0,j().uo)().uri]:10,[(0,j().Rh)().uri]:11,[(0,j().rr)().uri]:12,[E().Bm]:13,[E().js]:14,[E().nu]:15}))),$=p().Bj((()=>({[(0,w().md)().uri]:1,[(0,w().J4)().uri]:2,[(0,x().ft)().uri]:3,[(0,x().Li)().uri]:4,[(0,j().nr)().uri]:7,[(0,j().uo)().uri]:8,[(0,j().Rh)().uri]:9,[(0,j().rr)().uri]:10,[E().Bm]:11,[E().js]:12,[E().nu]:13}))),G=p().Bj((()=>({[s().iH]:z(),[s().dC]:N(),[s().Tw]:U(),[s().av]:W(),[s().TC]:H(),[s().yH]:$()})));function Q(e,t){if(!t)return e;const o=G()[t];return o?e.filter((e=>void 0!==o[e.uri])).sort(((e,t)=>(o[e.uri]??1/0)-(o[t.uri]??1/0))):e}function Z(e,t){const o=D(e);return(0,r().K8)((()=>{const n=e.collectionStore(),i=e.collectionViewBlockStore(),r=[],l=[];if(!n||!i)return{addedFeatures:r,suggestedFeatures:l};for(const s of t)q({collectionContextStore:e,feature:s,appConfig:o})?r.push(s):l.push(s);return{addedFeatures:r,suggestedFeatures:l}}),[t,o,e])}function q(e){const{collectionContextStore:t,feature:o,appConfig:n}=e;if((0,F().l)(o))return o.isFeatureAdded(o,t);if((0,A().lK)(o)||(0,A().u1)(o))return Y({collectionContextStore:t,feature:o});return J(o,null==n?void 0:n.allFeatures).some((e=>Y({collectionContextStore:t,feature:e})))}function Y(e){const{collectionContextStore:t,feature:o}=e,n=t.collectionStore();if(o.uri===(0,w().md)().uri)return Boolean(t.currentSubitemFormatStoreForCollectionStore.state);if(o.uri===(0,w().J4)().uri){const e=(0,_().QZ)({feature:"timeline_arrows_by",collectionContextStore:t});return Boolean(e)}const i=c().u9.derivePropertyUris((null==n?void 0:n.getSchema())??{},null==n?void 0:n.getPropertyMapping());return o.dependencies.some((e=>{const o="property"===e.type&&function(e){var t;const{collectionContextStore:o,dependency:n,propertyUris:i}=e,r=null===(t=o.collectionStore())||void 0===t?void 0:t.getDatabaseType();if(n.collectionUri===r)return(0,a().LE)(n.uri)&&i.has(n.uri);if((0,a().XA)(n.collectionUri))return(0,a().M7)(n.uri)&&i.has(n.uri);return!1}({dependency:e,collectionContextStore:t,propertyUris:i}),n="collection_view"===e.type&&function(e){var t;const{collectionContextStore:o,dependency:n}=e,i=o.collectionViewBlockStore(),r=null===(t=o.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_config_uri;if(!i||!r)return!1;var l,s;return n.collectionUri===r?n.collectionViewBlockUri===i.getFormat().app_config_uri&&n.uri in((null===(l=i.getFormat())||void 0===l?void 0:l.app_uri_map)??{}):!!(0,a().XA)(n.collectionUri)&&n.uri in((null===(s=i.getFormat())||void 0===s?void 0:s.app_uri_map)??{})}({dependency:e,collectionContextStore:t});return o||n}))}function J(e,t){return p().oE(e.variants.map((e=>{const o=null==t?void 0:t.find((t=>t.uri===e));if(o&&(0,A().lK)(o))return o})))}function X(e,t){const o=(0,i().v3)(),l=function(e){const t=(0,i().v3)(),o=D(e),l=(0,r().O$)(P().AppStoreCurrentSpaceViewStore),s=(0,r().K8)((()=>e.collectionViewBlockStore()),[e]);return(0,n.useCallback)(((n,i)=>{if(!s||!o||!l)return;const r=s.getParentStore();if(!r||"block"!==r.table&&"space"!==r.table&&"team"!==r.table)return;if(1!==n.dependencies.length)return;const a=n.dependencies[0];f().createAndCommit({userAction:"CollectionViewSuggestedViews.createView",environment:t,canUndo:!0,perform:c=>{var d;y().applyTypedFeatures({environment:t,spaceViewStore:l,appParentStore:r,appUri:o.uri,features:[{type:"simple",featureUri:n.uri}],appCollectionViewBlockStores:[s],createOrModify:"modify",transaction:c});const u=((null===(d=s.getFormat())||void 0===d?void 0:d.app_uri_map)??{})[a.uri];(0,I().t)({environment:t,collectionContextStore:e,collectionViewId:u,isFullScreen:e.isFullScreenStore.state,isRootChild:e.isRootChildStore.state,isInPeekRenderer:e.isInPeekRendererStore.state}),(0,g().b)({environment:t,collectionContextStore:e,view_type:a.value.type,view_config_uri:n.uri,feature:{id:u,from:i,type:n.uri},from:"addButton"})}})}),[s,o,l,t,e])}(e),s=(0,T().X)("db_ux_chrome")?"more_settings":"customize_menu";return(0,n.useCallback)((async n=>{if(n.uri===(0,w().md)().uri)m().a2({collectionSettingsStore:t,item:{type:"subitemV2",from:s}});else if(n.uri===(0,w().J4)().uri)m().a2({collectionSettingsStore:t,item:{type:"dependencies",from:s}});else{const t=n.dependencies[0];"collection_view"===t.type||"collection_view_block"===t.type||"sub_external_collection"===t.type?(l(n,s),B().Ay.setState({...B().Ay.state,shouldReset:!1}),(0,V().t)({featureName:n.name})):(await S().h3({environment:o,feature:n,collectionContextStore:e,addFeatureFrom:s}),(0,V().t)({featureName:n.name}))}}),[o,e,t,l,s])}function ee(){return(0,l().IS)((()=>({featureIconWrapper:{height:28,width:28,padding:"6px 0px",borderRadius:4},featureIcon:{width:16,height:16,alignItems:"center",margin:"auto"}})),[])}function te(e){const t=(0,i().v3)(),o=(0,d().tz)();return(0,r().K8)((()=>{var n;const i=(null===(n=P().default.state.currentUserSettingsStore)||void 0===n||null===(n=n.getSettings())||void 0===n?void 0:n.preferred_locale)||u().q;if("ja-JP"===i||"ko-KR"===i)return"";const r=e.collectionStore();return null!=r&&r.getName()?(0,k().tS)({environment:t,intl:o,store:r,untitledFallback:R.databaseNamePlaceholder}):M().A.formatMessage(R.databaseNamePlaceholder)}),[t,o,e])}},131849:(e,t,o)=>{o.d(t,{a:()=>l});var n=()=>o(484714),i=()=>o(56366),r=()=>o(486130);function l(e){const t=(0,n().v3)();return(0,i().K8)((()=>{if(t.currentUser.id&&e)return e.isMemberOrGuest(t.currentUser.id,r()._.getSpacePermissionGroupIds({userId:t.currentUser.id,spaceId:e.getSpaceId()}))}),[t.currentUser.id,e])}},139108:(e,t,o)=>{o.d(t,{F:()=>a});o(296540);var n=()=>o(401497),i=()=>o(66913),r=()=>o(284371),l=()=>o(704152),s=o(474848);function a(e){const{title:t,icon:o,style:a,children:c,right:d,showCloseButton:u,onClose:p}=e,g=(0,n().DP)(),m=(0,s.jsx)(l().A,{onClick:p,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16},children:(0,i().V)({width:14,fill:g.text.secondary})});return(0,s.jsxs)("div",{style:{padding:"12px 16px",margin:"4px 12px",fontSize:12,background:g.palette.orange[50],borderRadius:6,...a},children:[t&&(0,s.jsxs)("div",{style:{display:"flex",marginBottom:2,alignItems:"center"},children:[o,(0,s.jsx)("div",{style:{fontWeight:r().Wy.medium,flexGrow:1,...r().RC},children:t}),u?m:d]}),c]})}},147361:(e,t,o)=>{o.d(t,{r:()=>T});o(581454);var n=o(296540),i=()=>o(401497),r=()=>o(955825),l=()=>o(496603),s=()=>o(534177),a=()=>o(690471),c=()=>o(259464);o(16280);class d{constructor(){this.stiffness=50,this.damping=10,this.precision=.001,this.currentValue=0,this.endValue=0,this.velocity=0}isAtRest(){return Math.abs(this.endValue-this.currentValue)<=this.precision}setEndValue(e){this.endValue=e;const t=this.isAtRest();return t&&this.setAtRest(),t}jumpToEnd(){this.currentValue=this.endValue}step(e){let t=e;do{let e;t>d.timestep?(t-=d.timestep,e=d.timestep):(e=t,t=0);const[o,n]=this.rk4(this.currentValue,this.velocity,e);this.velocity=n,this.currentValue=o}while(t>0);const o=this.isAtRest();return o&&this.setAtRest(),o}setAtRest(){this.currentValue=this.endValue,this.velocity=0}rk4(e,t,o){const n=e,i=t,r=this.computeAccel(n,i,0),l=e+.5*i*o,s=t+.5*r*o,a=this.computeAccel(l,s,o/2),c=e+.5*s*o,d=t+.5*a*o,u=this.computeAccel(c,d,o/2),p=e+d*o,g=t+u*o;return[e+o/6*(i+2*s+2*d+g),t+o/6*(r+2*a+2*u+this.computeAccel(p,g,o))]}computeAccel(e,t,o){return this.stiffness*d.stiffnessMultiplier*(this.endValue-e)-this.damping*d.dampingMultiplier*t}}d.stiffnessMultiplier=1e-5,d.dampingMultiplier=.005,d.timestep=1e3/60;const u=d;function*p(e,t){const o=new u;for(o.currentValue=e,o.endValue=t,o.stiffness=35;;){const e=yield o.currentValue;if(o.step(e)){yield o.currentValue;break}}}function*g(e,t,o){let n=0;for(;n<o;){n+=(yield e+n/o*(t-e))}}function*m(e){for(const[t,o]of l().yU(e,e.slice(1)))(0,s().O9)(t)&&(0,s().O9)(o)&&(yield*p(t,o))}function*S(e,t){let o=0;for(;!(0,s().O9)(t)||o<t;){o+=(yield e)}}function*f(e){let t=0;for(;;){const o={};for(const n of(0,s().uv)(e)){const i=e[n].next(t);if(i.done)return;o[n]=i.value}t=yield o}}var y=()=>o(402838),h=o(474848);const x="inactive-task-filter",v="active-task-filter",C="mouse-cursor-filter",b=80,w=24,j=8,A=10,_=264,I=110,M=b/2;function*k(e){yield*f({x:e,opacity:S(1)})}function T(e){const{mode:t}=e,o=(0,i().IS)((e=>({wrap:{margin:"0px 10px",border:`1px solid ${e.regularDividerColor}`,borderRadius:6,alignItems:"center",position:"relative",height:I+2}})),[1]),r=(0,n.useRef)(null),l=(0,y().s)(r),s=l?l.width-2:_;return(0,h.jsx)("div",{style:o.wrap,ref:r,children:(0,h.jsx)(P,{mode:t,sceneWidth:s})})}function P(e){const{mode:t,sceneWidth:o}=e,d=(0,i().IS)((e=>({svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:a().cC},invalidArrow:{stroke:e.collectionInvalidDependencyArrow},svgContainer:{position:"absolute",width:"100%",height:"100%",backgroundColor:e.palette.gray[30]}})),[]),u=(0,n.useMemo)((()=>({none:function*(){for(;;)yield*k(m([o/2,o/2+b/2+b/4,o/2-b/2-b/4,o/2]))},preserve_gap:function*(){for(;;)yield*k(m([o/2,o/2+b/2,o/2-b/2,o/2]))},consume_gap:function*(){for(;;){yield*k(m([o/2,o/2-b/2,o/2+b/2,o/2+b]));const e=500;yield*f({x:S(o/2+b),opacity:g(1,0,e)}),yield*f({x:S(o/2),opacity:g(0,1,e)})}}})),[o]),{x:p,opacity:y}=function(e){const t=(0,n.useMemo)((()=>e()),[e]),[o,i]=(0,n.useState)((()=>{const e=t.next(0);if(e.done)throw new Error("Generator must provide at least one result");return e.value}));return(0,n.useEffect)((()=>{const e=t.next(0);e.done||i(e.value);let o=Date.now(),n=0;return n=requestAnimationFrame((function e(){n=requestAnimationFrame(e);const r=Date.now(),l=r-o;o=r;const s=t.next(l);s.done||i(s.value)})),()=>cancelAnimationFrame(n)}),[t]),o}(u[t??"none"]),x={x:o/2-2*b,y:A},v={x:p-b/2,y:A+w+j},C={x:o/2+b,y:A+2*(w+j)},_={x:v.x+b/2,y:v.y+w/2};return(0,s().O9)(t)&&("consume_gap"===t?(x.x=Math.min(x.x,v.x-b),C.x=Math.max(C.x,v.x+b)):"preserve_gap"===t?(x.x=x.x+p-o/2,C.x=C.x+p-o/2):(0,s().HB)(t)),(0,h.jsxs)("svg",{style:d.svgContainer,children:[l().y1(o/2-2*b,o,M).map(((e,t)=>(0,h.jsx)(V,{startPoint:{x:e,y:0},endPoint:{x:e,y:I}},t))),(0,h.jsx)(c().A,{startPoint:{x:v.x+b,y:v.y+w/2},endPoint:{x:C.x-2,y:C.y+w/2},...(0,r().AH)(d.svgArrowTheme,v.x+b>C.x?d.invalidArrow:void 0,{opacity:y}),showArrowHead:!0}),(0,h.jsx)(c().A,{startPoint:{x:x.x+b,y:x.y+w/2},endPoint:{x:v.x-2,y:v.y+w/2},...(0,r().AH)(d.svgArrowTheme,v.x<x.x+b?d.invalidArrow:void 0,{opacity:y}),showArrowHead:!0}),(0,h.jsx)(B,{point:x,opacity:y}),(0,h.jsx)(B,{point:v,active:!0,opacity:y}),(0,h.jsx)(B,{point:C,opacity:y}),(0,h.jsx)(F,{point:_,opacity:y}),(0,h.jsx)(E,{})]})}function B(e){const{point:t,active:o,opacity:n}=e,r=(0,i().DP)(),l=o?"dark"===r.mode?"#28456C":"#E7F3F8":r.buttonBackground;return(0,h.jsx)("g",{transform:`translate(${t.x-4},${t.y-2})`,opacity:n,children:(0,h.jsx)("rect",{filter:`url(#${o?v:x})`,width:b,height:w,x:"4",y:"2",fill:l,rx:"3"})})}function V(e){const{startPoint:t,endPoint:o}=e,n=(0,i().DP)(),r="dark"===n.mode?n.palette.gray[300]:"#E3E2E0";return(0,h.jsx)("line",{x1:t.x,y1:t.y,x2:o.x,y2:o.y,stroke:r,strokeDasharray:"3 4"})}function F(e){const{point:t,opacity:o}=e;return(0,h.jsxs)("g",{filter:`url(#${C})`,transform:`translate(${t.x},${t.y})`,opacity:o,children:[(0,h.jsx)("path",{fill:"#32302C",d:"M14 12.25h-3.334l2.193 5.294-2.309.956-2.194-5.294L6 15.563l-.75-.75V3.94l1.06-.44L14 11.19v1.06z"}),(0,h.jsx)("path",{stroke:"#fff",fill:"#32302C",strokeWidth:"0.5",d:"M14 12.5h.25v-1.413l-.073-.073-7.69-7.69-.12-.12-.154.065-1.059.44L5 3.775v11.142l.073.073.75.75.177.177.177-.177 2.092-2.091 2.05 4.948.096.23.23-.095 2.31-.956.231-.096-.096-.231-2.05-4.948H14z"})]})}function E(){return(0,h.jsxs)("defs",{children:[(0,h.jsxs)("filter",{id:x,width:b+8,height:w+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_7659"}),(0,h.jsx)("feOffset",{}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_7659"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"effect1_dropShadow_637_7659",result:"effect2_dropShadow_637_7659"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_7659",result:"shape"})]}),(0,h.jsxs)("filter",{id:v,width:b+8,height:w+8,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_5084"}),(0,h.jsx)("feOffset",{}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.2 0 0 0 0 0.494118 0 0 0 0 0.662745 0 0 0 0.2 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_5084"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,h.jsx)("feBlend",{in2:"effect1_dropShadow_637_5084",result:"effect2_dropShadow_637_5084"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_5084",result:"shape"})]}),(0,h.jsxs)("filter",{id:C,width:"17.75",height:"24.244",x:"0.75",y:"0.91",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,h.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,h.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,h.jsx)("feOffset",{dy:"2"}),(0,h.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,h.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,h.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.2 0"}),(0,h.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_4925"}),(0,h.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_637_4925",result:"shape"})]})]})}},148079:(e,t,o)=>{o.d(t,{A:()=>d});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(401497),l=()=>o(413267),s=()=>o(959013),a=()=>o(250202),c=o(474848);function d(e){const{menuProps:t,property:o,defaultProperty:n,isChecked:r,propertySchema:l,collectionContextStore:s,handleDefaultPropertySelect:d,handlePropertySelect:p,...g}=e,m=(0,i().O$)(s.permissionScopesStore);return(0,c.jsx)(a().G,{...t,disabled:!m.canConfigureBlock,propertySchema:l,format:a().e.Name,onClick:()=>d(o),right:(0,c.jsx)(u,{property:o,isChecked:o===n,collectionContextStore:s,defaultProperty:void 0})})}function u(e){const{property:t,defaultProperty:o,isChecked:a,collectionContextStore:d}=e,u=(0,n().WS)(),p=(0,i().K8)((()=>{var e;return null===(e=d.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[d]),g=(0,r().IS)((e=>({defaultText:{color:e.text.secondary,fontSize:12,fontWeight:500,textTransform:"uppercase",marginRight:4}})),[]);return(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,c.jsx)("div",{style:{...g.defaultText},children:t===o&&(0,c.jsx)(s().sA,{defaultMessage:"Default",id:"database.viewSettings.setViewPropertyDefault.defaultProperty.tag",values:{databaseName:p}})}),a&&(0,c.jsx)("div",{style:{...u?{marginLeft:"auto",marginRight:20,minWidth:0,flexShrink:0}:{marginLeft:"auto",marginRight:12,minWidth:0,flexShrink:0},width:u?16:14,flexShrink:0},children:(0,l().b)()})]})}},167068:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(296540),i=o(474848);function r(e){let{...t}=e;const n=(0,o(959013).tz)(),r=(0,o(401497).IS)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:24,width:24},threeDotIcon:{width:12,height:12,fill:e.icon.secondary}})),[]),l=n.formatMessage({defaultMessage:"View options",id:"PersonalHomePanel.moreDropdownButton.tooltip"});return(0,i.jsx)(o(704152).A,{ariaLabel:l,style:r.buttonStyle,...t,children:(0,o(30626)._)(r.threeDotIcon)})}const l=n.memo(r)},184966:(e,t,o)=>{o.d(t,{H2:()=>C,Nm:()=>j,TM:()=>v,tt:()=>b});o(944114),o(809678),o(898992),o(581454),o(737550);var n=()=>o(134025),i=()=>o(142748),r=()=>o(433847),l=()=>o(68263),s=()=>o(798880),a=()=>o(116225),c=()=>o(896628),d=()=>o(722101),u=()=>o(44729),p=()=>o(246826),g=()=>o(751156),m=()=>o(2220),S=()=>o(186445),f=()=>o(765957),y=()=>o(630116),h=()=>o(659915),x=()=>o(747444);function v(e){const{environment:t,collectionStore:o,publishingEnabled:n,transaction:i}=e;g().createAndCommitOrAppend({environment:t,perform:e=>{c().zA({stores:[o],update:{publishing_enabled:n},transaction:e})},userAction:"Posts.setPublishingEnabled",canUndo:!0,transaction:i})}function C(e){const{environment:t,collectionStore:o,followingEnabled:n,transaction:i}=e;g().createAndCommitOrAppend({environment:t,perform:e=>{c().zA({stores:[o],update:{following_enabled:n},transaction:e})},userAction:"Posts.setFollowingEnabled",canUndo:!0,transaction:i})}function b(e){const{environment:t,draftPostStore:o,onSubmitPost:l,from:d}=e,p=t.currentUser.id;o&&p&&(o.isPublishedDraft()||(!function(e){const{environment:t,postStore:o}=e;g().createAndCommit({environment:t,perform:e=>(o.getContentStores().toReversed().some((t=>{if(!(0,h().o)(t))return!0;u().zz({childStore:t,parentStore:o,transaction:e})})),o),userAction:"PostChannel.trimPostDraft",canUndo:!1})}({environment:t,postStore:o}),function(e){const{environment:t,draftPostStore:o,userId:l}=e;if(!o.isDefined()||o.isPublishedDraft())return;const a=(0,i().Yn)(o.getParentPointer(),o.getRecordModel),d=(0,r().wD)(a).map((e=>({...e,role:w(e.role,"comment_only")})));d.push({type:"restricted_permission"}),d.push({type:"user_permission",user_id:l,role:"editor"}),g().createAndCommit({environment:t,perform:e=>(g().applyOperation({store:o,operation:n().op.update({pointer:o.pointer,path:[],args:{alive:!0,created_by_id:l,created_by_table:s().oo,created_time:Date.now(),last_edited_time:Date.now()}}),transaction:e}),g().applyOperation({store:o,operation:n().op.set({pointer:o.pointer,path:["permissions"],args:d}),transaction:e}),c().zA({stores:[o],update:{draft_status:"published"},transaction:e}),o),userAction:"PostChannel.publishDraft",canUndo:!1}).performResult}({environment:t,draftPostStore:o,userId:p}),null==l||l(),x().A.setState({isOpen:!1}),(0,m().u)({environment:t,event:{eventName:"post_created",eventProperties:{block_id:o.id,parent_collection_id:o.getParentId(),from:d}}}),a().u4({name:"post_created"})))}function w(e,t){if(!e)return e;const o="string"==typeof e&&e in l().TE?l().TE[e]:void 0;if(!o)return e;return o>l().TE[t]?t:e}function j(e){var t,o;const{environment:n,collectionStore:i}=e,r=null===(t=(0,S()._m)(n))||void 0===t?void 0:t.id,l=null===(o=f().default.state.currentSpaceStore)||void 0===o?void 0:o.id;if(!r||!l||!i)return;return g().createAndCommit({environment:n,perform:e=>{null!=i&&i.isPublishingEnabled()||v({environment:n,collectionStore:i,publishingEnabled:!0,transaction:e});const t=p().Wv({environment:n,transaction:e,type:"page",inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache});u().X$({childStore:t,parentStore:i,transaction:e});const o=p().Wv({environment:n,transaction:e,type:"text",inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache}),r=y().Bv.createChildStore(t,o.pointer);return p().zv({store:r,transaction:e,data:{alive:!0,parent_id:t.id,parent_table:t.table}}),d().BC({parentStore:t.getContentStore(),appendStore:r,transaction:e}),t},userAction:"PostChannel.createEmptyPostStore",canUndo:!1}).performResult}},197730:(e,t,o)=>{o.d(t,{Sk:()=>l,we:()=>r,yQ:()=>i});var n=()=>o(534177);const i=["small","medium","large","extra_large"];function r(e){switch(e){case"small":return 300;case"medium":return 400;case"large":return 600;case"extra_large":return 800;default:(0,n().HB)(e)}}function l(e){var t;return(null==e||null===(t=e.map_config)||void 0===t?void 0:t.height)||"medium"}},210314:(e,t,o)=>{o.d(t,{u:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("unsync",{viewBox:"0 0 30 30",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M19.768 23.295l1.353 1.351a11.298 11.298 0 01-6.118 1.81c-5.862 0-10.781-4.538-11.387-10.254h-1.55c-.809 0-1.011-.55-.573-1.168l2.516-3.572c.37-.527.91-.516 1.269 0l2.515 3.583c.427.606.225 1.157-.572 1.157H5.536a9.496 9.496 0 009.467 8.344c1.74 0 3.366-.454 4.765-1.251zM10.233 6.723l-1.361-1.36a11.26 11.26 0 016.131-1.818c5.851 0 10.782 4.548 11.388 10.265h1.539c.808 0 1.021.539.572 1.167l-2.504 3.572c-.37.528-.91.516-1.27 0l-2.515-3.583c-.427-.617-.224-1.156.573-1.156h1.673a9.503 9.503 0 00-9.456-8.356 9.55 9.55 0 00-4.77 1.27z"}),(0,n.jsx)("path",{d:"M27.067 28.551c.41.41 1.094.41 1.49 0 .41-.41.41-1.08 0-1.49L2.937 1.454a1.06 1.06 0 00-1.505 0c-.396.396-.396 1.08 0 1.49l25.635 25.607z"})]})})},234675:(e,t,o)=>{o.d(t,{R:()=>n,l:()=>i});const n="custom_component";function i(e){return!("dependencies"in e)&&e.collectionUri===n}},245500:(e,t,o)=>{var n=()=>o(645873);const i={WorkflowTemplatesBuilderNotInProd:new(n().O2)("WorkflowTemplateBuilderNotInProd",(async()=>await Promise.all([o.e(92845),o.e(48486),o.e(46414),o.e(65881),o.e(94611)]).then(o.bind(o,228474)))),CollectionItemNameConfigMenuItemNotInProd:new(n().O2)("CollectionItemNameConfigMenuItemNotInProd",(async()=>await o.e(12062).then(o.bind(o,120364))))};(0,n()._h)(i.WorkflowTemplatesBuilderNotInProd,(e=>e.WorkflowTemplatesBuilderNotInProd)),(0,n()._h)(i.CollectionItemNameConfigMenuItemNotInProd,(e=>e.CollectionItemNameConfigMenuItemNotInProd))},248064:(e,t,o)=>{o.d(t,{h:()=>a});var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(978846),s=()=>o(937199);function a(){const{layoutStore:e,currentModuleSelection:t,setModuleSelection:o,sessionId:a}=(0,s().LH)(),c=(0,i().v3)(),d=(0,r().K8)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e]),u="form"===d?"form_layout_schema":"new_module"===(null==t?void 0:t.type)?t.area:void 0;return(0,n.useCallback)((n=>{const{layoutModule:i,transaction:r}=n;if(!e.getModel()||!u||"form_conditional_modules"===u)return;let s;if("form"===d)s=n.position??{type:"area_relative",area:"form_layout_schema",location:"end_moveable"};else{if("new_module"!==(null==t?void 0:t.type))return;if("form_conditional_modules"===t.area)return;s="views_main_tab_modules"===t.area?{type:"area_relative",area:t.area,viewId:t.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:t.area,location:"end_moveable"}}(0,l().UQ)({environment:c,sessionId:a,layoutStore:e,position:s,module:i,transaction:r,isPropertyCreation:!1}),o({type:"existing_module",moduleId:i.id,isDragging:!1})}),[u,t,c,e,d,a,o])}},274609:(e,t,o)=>{o.d(t,{L:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("historyBack",{viewBox:"0 0 14 14",directional:!0,svg:(0,n.jsx)("polygon",{points:"2.85893 7.74676 8.05608 12.9439 7 14 0.528042 7.52804 0 7 0.528042 6.47196 7 0 8.05608 1.05608 2.85893 6.25324 14 6.25324 14 7.74676"})})},334955:(e,t,o)=>{o.d(t,{Me:()=>h,QZ:()=>v,Tv:()=>x,lk:()=>C});var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(959013),s=()=>o(534177),a=()=>o(436696),c=()=>o(908447),d=()=>o(235191),u=()=>o(27732),p=()=>o(60867),g=()=>o(896628),m=()=>o(751156),S=()=>o(717989),f=()=>o(685889),y=()=>o(926203);function h(e){const{collectionContextStore:t,feature:o}=e,n=(0,l().tz)();return{initialPropertyName:(0,r().K8)((()=>{const e=t.collectionStore();if(null!=e&&e.isDefined()){const i=t.normalizedSchemaStore.state;return f().$H(n,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:i,createUnique:!0,from:o})}return n.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[t,n,o])}}function x(e){const{feature:t,collectionContextStore:o,onPropertySelect:x}=e,v=(0,i().v3)(),C=(0,l().tz)(),{initialPropertyName:b}=h({collectionContextStore:o,feature:t}),w=(0,n.useCallback)((e=>{const{collectionViewStore:o,newProperty:n,transaction:i}=e;"timeline_arrows_by"===t&&S().Tq({collectionViewStore:o,newProperty:n,transaction:i})}),[t]),j=(0,r().O$)(o.normalizedSchemaStore),A=(0,n.useCallback)((()=>f().qw(o,j)),[o,j]),_=(0,n.useCallback)((e=>{const{relationPropertyId:n,transaction:i}=e;"subitem"===t?p().zt({environment:v,collectionContextStore:o,relationPropertyId:n,transaction:i}):"timeline_arrows_by"===t?S().L_({collectionContextStore:o,relationPropertyId:n,transaction:i}):(0,s().HB)(t)}),[o,v,t]),I=(0,n.useCallback)((e=>{const{featureType:t,from:n}=e,i=o.collectionStore(),r=i,l=o.collectionViewStore();if(!i||!r)return;const{performResult:a}=m().createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:v,canUndo:!0,perform:n=>{const s=d().IL({environment:v,collectionStore:i,collectionViewArgs:l?{collectionViewStore:l,format:l.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:n});return u().cT({environment:v,collectionContextStore:o,collectionStore:i,property:s,propertyName:b,targetCollectionStore:r,hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:C,transaction:n,from:t}),l&&(w({collectionViewStore:l,newProperty:s,transaction:n}),_({relationPropertyId:s,transaction:n})),"timeline_arrows_by"===t&&(0,y().Wf)({environment:v,intl:C,collectionStore:i,transaction:n,newConfig:e.dateShiftingConfig}),s}});let p;"subitem"===t?p="notion://tasks/sub_task_feature":"timeline_arrows_by"===t?p="notion://tasks/task_dependencies_feature":(0,s().HB)(t),(0,c().Z)({environment:v,collectionContextStore:o,from:t,property_type:"relation",feature:{id:a,from:n,type:p}})}),[o,v,b,C,_,w]),M=(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;m().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:v,canUndo:!0,perform:t=>{w({collectionViewStore:n,newProperty:e,transaction:t}),_({relationPropertyId:e,transaction:t})}}),x(e),"subitem"===t?i="update_default_subitem":"timeline_arrows_by"===t?i="update_default_timeline_arrows_by":(0,s().HB)(t),(0,a().X)({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:v,collectionContextStore:o})}),[o,v,x,t,w,_]);return{handlePropertySelect:(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;m().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:v,canUndo:!0,perform:t=>{w({collectionViewStore:n,newProperty:e,transaction:t})}}),x(e),"subitem"===t?i="update_subitem":"timeline_arrows_by"===t?i="update_timeline_arrows_by":(0,s().HB)(t),(0,a().X)({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:v,collectionContextStore:o})}),[o,v,x,t,w]),handleDefaultPropertySelect:M,handleAddRelation:I,getProperties:A,clearCollectionViewSubitemDisplayMode:(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&m().createAndCommit({userAction:"actionRegistry.clearCollectionViewSubitemDisplayMode",environment:v,canUndo:!0,perform:t=>{g().zA({stores:[e],update:{subitem_display_mode:void 0},transaction:t})}})}),[o,v])}}function v(e){const{feature:t,collectionContextStore:o}=e;let n,i;var r,l;if("subitem"===t)i=null===(r=o.collectionStore())||void 0===r?void 0:r.getFormatStore().getKeyStore("subitem_property").getValue(),n="flattened"===(null===(l=o.collectionViewStore())||void 0===l?void 0:l.getFormat().subitem_display_mode)?void 0:i;else if("timeline_arrows_by"===t){var a;n=o.currentArrowsByFormatStore.state,i=null===(a=o.collectionStore())||void 0===a?void 0:a.getFormatStore().getKeyStore("collection_default_arrows_by").getValue()}else(0,s().HB)(t);const c=o.normalizedSchemaStore.state,d=f().uu(o,c);(0,s().O9)(n)&&!d.includes(n)&&(n=void 0),(0,s().O9)(i)&&!d.includes(i)&&(i=void 0);const u=n??i;if(u){var p;const e=Boolean(n),r="hidden"!==(null===(p=o.collectionViewStore())||void 0===p?void 0:p.getFormat().subitem_display_mode),l="subitem"===t?r:e;return{property:u,isDefault:u===i,enabledOnView:e,enabledOnCollection:Boolean(i),supportedInView:(0,y().v9)({feature:t,viewType:o.getViewType()}),isVisibleInView:l}}}function C(e){const{feature:t,collectionContextStore:o}=e;return(0,r().K8)((()=>v({feature:t,collectionContextStore:o})),[o,t])}},338862:(e,t,o)=>{o.d(t,{N:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"3.24 1.67 9.51 12.3",svg:(0,o(474848).jsx)("path",{d:"M4.825 4.85a3.175 3.175 0 1 1 6.35 0v1.061a1.95 1.95 0 0 1 1.575 1.914v4.2a1.95 1.95 0 0 1-1.95 1.95H5.2a1.95 1.95 0 0 1-1.95-1.95v-4.2c0-.949.677-1.74 1.575-1.914zm1.1 1.025h4.15V4.85a2.075 2.075 0 0 0-4.15 0zm2.525 4.299a1.05 1.05 0 1 0-.9 0v.976a.45.45 0 0 0 .9 0z"})},i=(0,o(340498).wt)("lockFillSmall",n)},340643:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(56366),i=()=>o(959013),r=()=>o(436696),l=()=>o(686526),s=o(474848);const a=function(e){let{collectionContextStore:t,collectionSettingsStore:a}=e;const c=(0,o(484714).v3)(),d=(0,i().tz)(),u=(0,n().O$)(t.permissionScopesStore),p=(0,n().K8)((()=>!u.canConfigureBlock||"collectionTypedView"===t.contextType),[t,u]),{viewName:g,viewType:m}=(0,n().K8)((()=>{var e,o;return{viewName:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getName(),viewType:null===(o=t.collectionViewStore())||void 0===o?void 0:o.getType()}}),[t]),S=!(0,n().O$)(o(227440).e);if(p||!m)return null;let f=(0,s.jsx)(i().sA,{defaultMessage:"Duplicate view",id:"database.viewSettings.mainTab.duplicateButton.title"});return"chart"===m?f=(0,s.jsx)(i().sA,{defaultMessage:"Duplicate chart",id:"database.viewSettings.mainTab.duplicateButton.title.chart"}):g&&(f=(0,s.jsx)(i().sA,{defaultMessage:"Duplicate {viewName}",id:"database.viewSettings.mainTab.duplicateButton.title.viewName",values:{viewName:g}})),(0,s.jsx)(o(497222).A,{icon:o(764781).V,title:f,onClick:()=>function(e,t,o,n){const i=t.collectionViewStore();i&&(l().vr({environment:e,collectionContextStore:t,collectionViewStore:i,collectionSettingsStore:o,intl:n,from:"view_settings_duplicate"}),(0,r().X)({environment:e,collectionContextStore:t,action:"click_duplicate",original_view_type:i.getType()}))}(c,t,a,d),disabled:S})}},346705:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(757695))().Store{getInitialState(){return{isModalOpen:!1,collectionContextStore:void 0}}}const i=new n},353731:(e,t,o)=>{o.d(t,{$:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("database",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M16.25 5v1.25c0 1.381-2.797 2.5-6.25 2.5s-6.25-1.119-6.25-2.5V5c0-1.381 2.797-2.5 6.25-2.5s6.25 1.119 6.25 2.5zM10 14.375c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753V15c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753-1.22.806-3.179 1.378-5.963 1.378zM10 10c-2.784 0-4.744-.569-5.963-1.378-.187.237-.287.49-.287.753v1.25c0 1.381 2.797 2.5 6.25 2.5s6.25-1.119 6.25-2.5v-1.25c0-.262-.103-.516-.287-.753C14.742 9.428 12.784 10 10 10z"})})},361173:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,infoCircleFillSmallIcon:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"1.94 1.95 12.11 12.11",svg:(0,o(474848).jsx)("path",{d:"M1.95 8a6.05 6.05 0 1 1 12.1 0 6.05 6.05 0 0 1-12.1 0m5-1.425a.55.55 0 0 0 0 1.1h.5v2.4h-.5a.55.55 0 1 0 0 1.1h2.1a.55.55 0 0 0 0-1.1h-.5v-2.95a.55.55 0 0 0-.55-.55zM8.6 5.2a.7.7 0 1 0-1.4 0 .7.7 0 0 0 1.4 0"})},i=(0,o(340498).wt)("infoCircleFillSmall",n)},364871:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(56366),i=()=>o(959013),r=()=>o(436696),l=()=>o(686526),s=o(474848);const a=function(e){let{collectionContextStore:t,collectionSettingsStore:a}=e;const c=(0,o(484714).v3)(),{collectionViewBlockStore:d,permissionScopes:u,viewType:p,viewName:g}=(0,n().K8)((()=>{var e,o;return{collectionViewBlockStore:t.collectionViewBlockStore(),permissionScopes:t.permissionScopesStore.state,viewType:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType(),viewName:null===(o=t.collectionViewStore())||void 0===o?void 0:o.getName()}}),[t]),m=(0,n().K8)((()=>{const e=1===(null==d?void 0:d.getCollectionViewIds().length),o=t.isEditableHomeCollectionStore.state;return!u.canConfigureBlock||"collectionTypedView"===t.contextType||e&&!o}),[t,d,u.canConfigureBlock]);if(!d||m||!p)return null;let S=(0,s.jsx)(i().sA,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteTheOnlyViewButton.title"});return"chart"===p?S=(0,s.jsx)(i().sA,{defaultMessage:"Delete chart",id:"database.viewSettings.mainTab.deleteButton.title.chart"}):g&&(S=(0,s.jsx)(i().sA,{defaultMessage:"Delete {viewName}",id:"database.viewSettings.mainTab.deleteButton.title.viewName",values:{viewName:g}})),(0,s.jsx)(o(497222).A,{icon:o(236262).trashIcon,title:S,isRed:!0,onClick:()=>function(e,t,o){const n=t.collectionViewStore();n&&(l().nl({environment:e,collectionContextStore:t,collectionViewStore:n,collectionSettingsStore:o,from:"view_settings"}),(0,r().X)({environment:e,collectionContextStore:t,action:"click_delete",original_view_type:n.getType()}))}(c,t,a)})}},384130:(e,t,o)=>{o.d(t,{J:()=>d});var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(751156),s=()=>o(755199),a=()=>o(186445),c=()=>o(765957);function d(){return function(e){let{userSettingsDismissibleKey:t}=e;const o=(0,i().v3)(),d=(0,r().K8)((()=>c().default.state.currentUserSettingsStore),[]),u=(0,r().K8)((()=>{const e=null==d?void 0:d.getSettings();return!e||Boolean(e[t])}),[t,d]),p=(0,r().K8)((()=>{const e=(0,a()._m)(o),t=null==d?void 0:d.getSettings();return Boolean(e)&&Boolean(t)&&!o.device.isMobile&&!u}),[o,d,u]),g=n.useCallback((()=>{d&&!u&&p&&l().createAndCommit({environment:o,userAction:"LayoutInfoPanelButtonEducationTooltip.dismiss",canUndo:!1,perform:e=>{s().mJ({userSettingsStore:d,transaction:e,data:{[t]:Date.now()}})}})}),[o,p,t,d,u]);return{shouldShowTooltip:p,dismissTooltip:g}}({userSettingsDismissibleKey:"layout_builder_add_module_button_education_tooltip_dismissed_at"})}},390518:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var n=()=>o(331542),i=o(474848);function r(){return(0,i.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:200,overflow:"hidden"},children:(0,i.jsx)(n().A,{})})}},395859:(e,t,o)=>{o.d(t,{A:()=>h,X:()=>f});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(148307),l=()=>o(919709),s=()=>o(959013),a=()=>o(436696),c=()=>o(896628),d=()=>o(319975),u=()=>o(751156),p=()=>o(654062),g=()=>o(943919),m=()=>o(186445),S=o(474848);const f=(0,s().YK)({viewNamePlaceholderMessage:{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNamePlaceholder.title"},formNamePlaceholderMessage:{defaultMessage:"Form name",id:"database.viewSettings.mainTab.formNamePlaceholder.title"},addDescriptionTooltip:{defaultMessage:"Add view description",id:"database.viewSettings.mainTab.addDescriptionTooltip.title"},editDescriptionTooltip:{defaultMessage:"Edit view description",id:"database.viewSettings.mainTab.editDescriptionTooltip.title"}});function y(e,t,o){const n=o.collectionViewBlockStore(),i=o.collectionViewStore();if(!n||!i||!i.isDefined())return;const r=(0,m().sj)(n.id);i.getName()!==e&&u().createAndCommit({userAction:"CollectionSettingsViewMain.handleViewNameSubmit",environment:t,canUndo:!0,perform:t=>{if((0,p().F)({collectionViewStore:i,update:{name:e},transaction:t}),r){const o=(0,l().x9d)(e);d().R9({environment:n.environment,store:n.getBlockTitleStore(),value:o,transaction:t})}}}),(0,a().X)({environment:t,collectionContextStore:o,action:"rename",original_view_type:i.getType()})}const h=function(e){const{collectionViewStore:t,collectionContextStore:l,selectViewNameInitial:d,showViewDescriptionStore:p,topBorder:h,sectionStyle:x}=e,v=(0,n().v3)(),C=(0,s().tz)(),b=(0,o(401497).DP)(),w=(0,n().Y0)(),j=(0,i().K8)((()=>t.getType()),[t]),A=(0,i().K8)((()=>t.getName()),[t]),{description:_,collection_view_icon:I}=(0,i().K8)((()=>t.getFormat()),[t]),M=(0,i().O$)(p),k=(0,i().O$)(l.permissionScopesStore),T=(0,i().O$)(l.isEditableHomeCollectionStore),P=(0,i().K8)((()=>t.getAppConfigUri()),[t]),B=!P||(0,o(313892).$h)(P),V=(0,o(963589).X)("db_ux_chrome");return(0,S.jsx)(o(89924).A,{title:!V&&w.isMobile&&(0,S.jsx)(s().sA,{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),topBorder:h,style:x,children:(0,S.jsx)("div",{style:{marginTop:h?5:void 0},children:(0,S.jsx)(o(755735).B,{initialValue:A||"",placeholder:C.formatMessage("form_editor"===j?f.formNamePlaceholderMessage:f.viewNamePlaceholderMessage),onBlur:e=>y(e,v,l),onSubmit:e=>y(e,v,l),focusInitial:d,selectAll:d,disabled:!k.canConfigureBlock||!B,iconButton:{iconLeading:e=>(0,S.jsx)(o(745266).h,{color:"gray",viewIcon:I,viewType:j}),iconStyle:{fill:o(278238).l8[b.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore(),i=t.collectionViewBlockStore();if(!i||!n||!n.isDefined())return;const l=(0,m().sj)(i.id);u().createAndCommit({userAction:"CollectionSettingsViewMain.handleViewIconSubmit",environment:e,canUndo:!0,perform:e=>{if(l){const t=o||r().A.images.appPackages.taskDbIconSvg;(0,g().o)({collectionViewStore:n,icon:t,transaction:e}),c().zA({stores:[i],update:{page_icon:t},transaction:e})}else(0,g().o)({collectionViewStore:n,icon:o,transaction:e})}}),(0,a().X)({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(v,l,e)},inputRightButton:T||"form_editor"===j?null:(0,S.jsx)(o(539148).S,{description:_,showTooltip:!M,onClick:()=>p.setState(!M),addDescriptionText:C.formatMessage(f.addDescriptionTooltip),editDescriptionText:C.formatMessage(f.editDescriptionTooltip),disabled:!k.canConfigureBlock})})})})}},397089:(e,t,o)=>{o.d(t,{Ak:()=>A,IM:()=>j,jB:()=>w});o(898992),o(672577),o(581454),o(296540);var n=()=>o(908006),i=()=>o(56366),r=()=>o(401497),l=()=>o(857639),s=()=>o(742117),a=()=>o(179034),c=()=>o(96689),d=()=>o(854150),u=()=>o(534177),p=()=>o(686526),g=()=>o(521358),m=()=>o(374562),S=()=>o(313892),f=()=>o(878665),y=()=>o(180762),h=()=>o(553965),x=()=>o(234675),v=()=>o(39039),C=()=>o(95347),b=o(474848);function w(e){var t,o;const{collectionContextStore:n,feature:l,itemProps:a,icon:c,onClick:d}=e,u=(0,i().K8)((()=>n.databaseType),[n]),p=function(e,t){var o;const n=function(e){const{collectionContextStore:t,feature:o}=e,n=(0,C().rD)(t);return(0,i().K8)((()=>{if((0,x().l)(o))return;if((0,S().lK)(o))return o.dependencies.find((e=>"property"===e.type));if((0,S().u1)(o))return o.dependencies.find((e=>"property"===e.type));const e=(0,C().ff)(o,null==n?void 0:n.allFeatures).find((e=>(0,C().jk)({collectionContextStore:t,feature:e})));return null==e?void 0:e.dependencies.find((e=>"property"===e.type))}),[n,t,o])}({collectionContextStore:e,feature:t}),r=(0,i().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t?void 0:t.getSchema()}),[e]),l=(0,i().K8)((()=>{var t;return null===(t=e.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.app_uri_map}),[e]);if(!n||"property"!==n.type)return;const s=(null==l?void 0:l[n.uri])??n.uri,a=null==r?void 0:r[s];switch(null==a?void 0:a.type){case"select":case"multi_select":case"status":return null===(o=a.options)||void 0===o?void 0:o.map((e=>e.value)).join(", ");default:return}}(n,l),g=(0,r().IS)((e=>({addedIconStyle:{width:12,fill:e.icon.tertiary,marginLeft:6,transition:"transform 200ms ease-in-out"}})),[]),m=(0,v().tx)(l,u),y=p??m;return(0,b.jsx)(f().A,{showImage:!0,caption:m,tooltipImage:null===(t=l.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=l.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,b.jsx)(v().j7,{collectionContextStore:n,feature:l,caption:y,buttonMenuItemProps:{...(0,h().A)(a,e)},icon:c,right:(0,s().V)(g.addedIconStyle),onClick:d})})}function j(e){const{environment:t,feature:o,collectionContextStore:i,collectionSettingsStore:r,appConfig:s}=e;if(o.uri===(0,m().md)().uri)return()=>p().a2({collectionSettingsStore:r,item:{type:"subitemV2",from:"customize_menu"}});if(o.uri===(0,m().J4)().uri)return()=>p().a2({collectionSettingsStore:r,item:{type:"dependencies",from:"customize_menu"}});if((0,S().lK)(o)||(0,S().u1)(o)){if(0===o.dependencies.length)return()=>{l().log({level:"error",from:"FeaturesList",type:"FeatureWithNoDependencies",error:{miscDataString:`Feature ${o.name} has no dependencies.`}})};const e=o.dependencies[0],s=i.collectionStore();if(o.isAi)return()=>{const t=e.uri,o=null==s?void 0:s.getSchema()[t],n=i.settingsStore;p().a2({collectionSettingsStore:n,item:{type:"property",property:t,formatKey:i.getPropertyFormatKey()}}),"text"===(null==o?void 0:o.type)&&p().a2({collectionSettingsStore:n,item:{type:"propertyAiAutofill",propertySchema:o,property:t}})};if((0,S().lK)(o)&&("collection_view"===e.type||"collection_view_block"===e.type||"sub_external_collection"===e.type))return async()=>{await async function(e){const{feature:t,collectionContextStore:o,environment:i,collectionSettingsStore:r}=e;if(1!==t.dependencies.length)return;const l=t.dependencies[0];if("collection_view"===l.type){const e=o.collectionViewStore(),t=o.collectionViewBlockStore();if(!e||!t)return;const s=null==t?void 0:t.getParentStore();if(!s||s.table!==c().NX&&s.table!==a().ev&&s.table!==d().yK)return;const u=(await(0,g().QQ)({environment:i,collectionViewBlockStore:t,appParentStore:s})).find((e=>{var t;return(null===(t=e.getFormat())||void 0===t?void 0:t.app_config_uri)===l.collectionViewBlockUri})),m=(0,S().cc)({collectionViewBlockStore:u,dependencyUri:l.uri});if(!m)return;(0,y().t)({environment:i,collectionContextStore:o,collectionViewId:m.id,isFullScreen:o.isFullScreenStore.state,isRootChild:o.isRootChildStore.state,isInPeekRenderer:o.isInPeekRendererStore.state}),n().default.afterNextFlush((()=>{p().Ow({collectionContextStore:o,collectionSettingsStore:r})}))}}({feature:o,collectionContextStore:i,environment:t,collectionSettingsStore:r})};if("property"===e.type){var f;const t=((null==s||null===(f=s.getFormat())||void 0===f?void 0:f.app_uri_map)??{})[e.uri]??e.uri;return()=>{A({collectionContextStore:i,property:t})}}return()=>{l().log({level:"error",from:"FeaturesList",type:"UnsupportedFeatureDependency",error:{miscDataString:`Feature ${o.name} has an unsupported dependency type: ${e.type}`}})}}if((0,S().$n)(o)){const e=(0,C().ff)(o,null==s?void 0:s.allFeatures);return 0===e.length?()=>{l().log({level:"error",from:"FeaturesList",type:"UnsupportedFeatureWithVariants",error:{miscDataString:`Feature ${o.name} has no variants.`}})}:()=>{1===e[0].dependencies.length&&A({collectionContextStore:i,property:e[0].dependencies[0].uri})}}(0,u().HB)(o)}function A(e){const{collectionContextStore:t,property:o}=e;p().a2({collectionSettingsStore:t.settingsStore,item:{type:"property",property:o,formatKey:t.getPropertyFormatKey()}})}},403217:(e,t,o)=>{o.d(t,{z:()=>a});o(296540);var n=()=>o(614525),i=()=>o(364871),r=()=>o(340643),l=()=>o(448701),s=o(474848);function a(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l().z,{collectionContextStore:t}),(0,s.jsx)(n().A,{collectionContextStore:t}),(0,s.jsx)(r().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,s.jsx)(i().A,{collectionContextStore:t,collectionSettingsStore:o})]})}},404637:(e,t,o)=>{o.d(t,{GS:()=>go,gt:()=>ao,CJ:()=>uo,is:()=>To,Ct:()=>vo});o(16280),o(898992),o(354520);var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(401497),s=()=>o(584262),a=()=>o(785285),c=()=>o(651124),d=()=>o(955363),u=()=>o(47218),p=()=>o(582684),g=()=>o(933152),m=()=>o(202017),S=()=>o(465505),f=()=>o(89849),y=()=>o(566910),h=()=>o(212727),x=()=>o(200582),v=()=>o(594088),C=()=>o(406533),b=()=>o(871151),w=()=>o(969523),j=()=>o(959013),A=()=>o(496603),_=()=>o(534177),I=()=>o(284371),M=()=>o(208459),k=()=>o(436696),T=()=>o(989992),P=()=>o(686526),B=()=>o(980151),V=()=>o(435009),F=()=>o(751156),E=()=>o(837570),R=()=>o(654062),D=()=>o(637558),K=()=>o(914873),O=()=>o(315564),L=()=>o(139108),z=()=>o(125565),N=o(474848);function U(e){const{style:t}=e,o=(0,l().DP)(),n=(0,i().WS)(),r=(0,N.jsx)("div",{style:{marginTop:1},children:(0,O().S)({width:14,marginRight:8,height:void 0})}),s=(0,N.jsx)(z().A,{style:{color:o.text.primary,lineHeight:I().K_.UISmall.desktop},isSmall:!0,children:(0,N.jsx)(j().sA,{defaultMessage:"You're a content editor",id:"database.viewSettings.mainTab.contentOnlyEditorPill.title"})});return(0,N.jsx)(L().F,{icon:r,title:s,style:n?{backgroundColor:o.surface.wash,boxShadow:o.shadow2XS,margin:void 0,borderRadius:void 0,...t}:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",...t},showCloseButton:!1,children:(0,N.jsx)(z().A,{style:{marginLeft:22},isSmall:!0,isMultiline:!0,children:(0,N.jsx)(j().sA,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"})})})}var W=()=>o(201440),H=()=>o(901389),$=()=>o(722872),G=()=>o(760217),Q=()=>o(406699),Z=()=>o(285790),q=()=>o(928600),Y=()=>o(939740),J=()=>o(89924);(0,j().YK)({learn:{id:"CollectionTaskTypeBadge.MoreMenu.LearnMore.title",defaultMessage:"Learn more"}});var X=()=>o(497222),ee=()=>o(175116),te=()=>o(897119);const oe=n.memo((function(e){let{handleAddItemClick:t,store:s,disableTemplatesDropdown:a}=e;const{isMobile:c}=(0,i().Y0)(),d=(0,ee().ET)(),u=(0,r().K8)((()=>d.settingsStore),[d]),p=(0,i().v3)(),g=(0,n.useRef)(null),m=(0,n.useCallback)((e=>{P().Ub({environment:p,handleAddItemClick:t,buttonRef:g,event:e})}),[p,t,g]),S=(0,l().IS)((e=>({newPageIcon:{fill:e.icon.uiBluePrimary},desktopTitle:{color:e.text.uiBluePrimary,fontWeight:I().Wy.medium}})),[]),f=(0,n.useCallback)((e=>{a?m(e):t(e),P().os({collectionSettingsStore:u})}),[a,m,t,u]);return(0,N.jsx)(o(472765).m,{store:s,popupType:c?te().nl.BottomSheet:te().nl.Popup,renderOrigin:e=>(0,N.jsx)(o(704152).A,{ref:g,ignoreLocalHoverState:!0,children:(0,N.jsxs)(J().A,{children:[(0,N.jsx)(X().A,{icon:o(480034).q,iconStyle:S.newPageIcon,title:(0,N.jsx)(j().sA,{defaultMessage:"New page",id:"database.collectionViewAddItemButton.newPageButton.title"}),showChevron:!1,desktopTitleStyle:S.desktopTitle,onClick:f}),!a&&(0,N.jsx)(X().A,{icon:o(920495).pageIcon,title:(0,N.jsx)(j().sA,{defaultMessage:"Page templates",id:"database.collectionViewAddItemButton.pageTemplatesButton.title"}),showChevron:!0,onClick:e.onClick})]})}),placementToOrigin:Q().sx.Left})}));var ne=()=>o(8980),ie=()=>o(780054),re=()=>o(152077),le=()=>o(95347),se=()=>o(186445),ae=()=>o(852353),ce=()=>o(726483),de=()=>o(492414),ue=()=>o(972435),pe=()=>o(760578),ge=()=>o(37433),me=()=>o(963589),Se=()=>o(287940),fe=()=>o(955450),ye=()=>o(162674),he=()=>o(885749),xe=()=>o(665579),ve=()=>o(610101),Ce=()=>o(765957),be=()=>o(227440),we=()=>o(559378),je=()=>o(411671),Ae=()=>o(691093),_e=()=>o(46986),Ie=()=>o(334955),Me=()=>o(647702),ke=()=>o(487605),Te=()=>o(705602),Pe=()=>o(132409),Be=()=>o(735695),Ve=()=>o(812480),Fe=()=>o(614525),Ee=()=>o(364871),Re=()=>o(236262),De=()=>o(797265);const Ke=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().v3)(),{collectionViewBlockStore:l,permissionScopes:s,isLinkedCollectionView:a}=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return{collectionViewBlockStore:e,permissionScopes:t.permissionScopesStore.state,isLinkedCollectionView:null==e?void 0:e.isLinkedCollectionView()}}),[t]),c=(0,r().K8)((()=>s.canConfigureBlock),[s.canConfigureBlock]),d=(0,r().K8)((()=>1===(null==l?void 0:l.getCollectionViewIds().length)),[l]);if(!l||!c)return null;const u=a&&d?(0,N.jsx)(j().sA,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteLinkedDatabaseWithOneViewButton.title"}):a?(0,N.jsx)(j().sA,{defaultMessage:"Delete all views",id:"database.viewSettings.mainTab.deleteLinkedDatabaseWithMultipleViewsButton.title"}):(0,N.jsx)(j().sA,{defaultMessage:"Delete database",id:"database.viewSettings.mainTab.deleteDatabaseButton.title"});return(0,N.jsx)(X().A,{icon:Re().trashIcon,title:u,isRed:!0,onClick:()=>function(e,t,o){var n;const i=t.collectionViewBlockStore();if(!i)return;const r=i.isLinkedCollectionView();(0,k().X)({environment:e,collectionContextStore:t,action:"click_delete_database",original_view_type:null===(n=t.collectionViewStore())||void 0===n?void 0:n.getType()}),H().ui({showCancel:!0,keepFocus:!1,message:r?(0,N.jsx)(j().sA,{defaultMessage:"Are you sure you want to delete this linked view?",id:"database.viewSettings.mainTab.deleteLinkedDatabaseConfirm.text"}):(0,N.jsx)(j().sA,{defaultMessage:"Are you sure you want to delete this database?",id:"database.viewSettings.mainTab.deleteDatabaseConfirm.text"}),items:[{label:(0,N.jsx)(j().sA,{defaultMessage:"Delete",id:"database.viewSettings.deleteDatabaseButton.text"}),color:"red",onAccept:async()=>{await De().Af({environment:e,blocks:[i],shouldCheckSuggestEdit:!0})}}]})}(n,t)})};var Oe=()=>o(340643),Le=()=>o(704640),ze=()=>o(395859),Ne=()=>o(542984),Ue=()=>o(594952),We=()=>o(617668),He=()=>o(836251),$e=()=>o(937199),Ge=()=>o(3197),Qe=()=>o(112698),Ze=()=>o(807778),qe=()=>o(329304),Ye=()=>o(404520),Je=()=>o(95441),Xe=()=>o(58488);function et(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,r().K8)((()=>t.collectionViewStore()),[t]),i=(0,r().K8)((()=>{if(!n)throw new Error("No CollectionViewStore found");return n.getFormBlockStore()}),[n]),l=(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return!!e&&e.getCollectionViewIds().length>1}),[t]);return n&&i?(0,N.jsxs)(Xe().I,{children:[(0,N.jsxs)(J().A,{children:[(0,N.jsx)(tt,{}),(0,N.jsx)(go,{collectionSettingsStore:o,collectionContextStore:t}),(0,N.jsx)(ot,{collectionSettingsStore:o})]}),(0,N.jsxs)(J().A,{topBorder:!0,children:[l&&(0,N.jsx)(nt,{collectionSettingsStore:o,collectionContextStore:t,collectionViewStore:n,formBlockStore:i}),(0,N.jsx)(it,{})]})]}):null}function tt(){const{canEditLayout:e}=(0,$e().LH)(),t=(0,Ge().t)({area:"form_layout_schema"});return(0,N.jsx)(X().A,{icon:We().plusIcon,title:(0,N.jsx)(j().sA,{id:"formEditSettings.newQuestion.title",defaultMessage:"New question"}),onClick:t,disabled:!e})}function ot(e){let{collectionSettingsStore:t}=e;const{userId:o,spaceId:n}=(0,r().K8)((()=>{var e,t;return{userId:null===(e=Ce().default.state.currentUserStore)||void 0===e?void 0:e.id,spaceId:null===(t=Ce().default.state.currentSpaceStore)||void 0===t?void 0:t.id}}),[]),i=(0,r().K8)((()=>(0,Ze().P4)()),[]),l=(0,qe()._X)({name:"form_customization",spaceId:n,userId:o}),s="unavailable"===(null==l?void 0:l.type)&&l.upsell;return(0,N.jsx)(X().A,{onClick:()=>{P().a2({collectionSettingsStore:t,item:{type:"formCustomizeSettings"}})},icon:Ue().I,title:(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",height:20,gap:5},children:[(0,N.jsx)(j().sA,{defaultMessage:"Customize form",id:"formEditSettings.customizeForm.title"}),s&&(i?(0,N.jsx)(Ye().R,{display:"icon",upsell:l.upsell,source:"forms_customize_settings"}):(0,N.jsx)(Qe().B,{upsell:l.upsell,analyticsName:"forms_customize_settings"}))]}),showChevron:!0})}function nt(e){let{collectionContextStore:t,collectionSettingsStore:o,collectionViewStore:r,formBlockStore:l}=e;const{canEditLayout:s}=(0,$e().LH)(),a=(0,i().v3)(),c=(0,n.useCallback)((async()=>{await P().nl({environment:a,collectionContextStore:t,collectionViewStore:r,collectionSettingsStore:o,additionalBlocksToDelete:[l],from:"view_settings"})}),[a,t,r,o,l]);return(0,N.jsx)(X().A,{icon:Re().trashIcon,title:(0,N.jsx)(j().sA,{id:"formEditSettings.deleteForm.title",defaultMessage:"Delete form"}),onClick:c,disabled:!s})}function it(){return(0,N.jsx)(Je().A,{title:(0,N.jsx)(j().sA,{defaultMessage:"Learn about forms",id:"formEditSettings.learnAboutForms.title"}),href:(0,He().xS)("guides.forms"),analyticsFrom:"form_edit_settings"})}var rt=()=>o(448701),lt=(o(430670),o(581454),()=>o(62616)),st=()=>o(423938),at=()=>o(180762),ct=()=>o(239529),dt=()=>o(811979),ut=()=>o(480095),pt=()=>o(554509),gt=()=>o(463830),mt=()=>o(334003),St=()=>o(259476),ft=()=>o(599813),yt=()=>o(179034),ht=()=>o(750660),xt=()=>o(246826),vt=()=>o(436572),Ct=()=>o(745266),bt=()=>o(519839),wt=()=>o(187820),jt=()=>o(859428),At=()=>o(921855),_t=()=>o(697650),It=()=>o(776894),Mt=()=>o(554060),kt=()=>o(630116),Tt=()=>o(272600),Pt=(o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(672577),()=>o(414360));function Bt(e){var t;let{collectionContextStore:o,collectionStore:n}=e;return(null===(t=o.collectionViewBlockStore())||void 0===t||null===(t=t.getCollectionViewStores())||void 0===t?void 0:t.filter((e=>{const t=e.getCollectionSource();return"collection"===(null==t?void 0:t.type)&&t.id===n.id})))??[]}var Vt=()=>o(663247);function Ft(e){let{icon:t}=e;const o=(0,l().IS)((e=>({aliasIcon:{position:"absolute",width:14,height:14,right:-2,bottom:-2}})),[]);return(0,N.jsxs)("div",{style:{position:"relative"},children:[t,(0,N.jsx)(Et,{iconFn:Vt().arrowDiagonalUpRightFillIcon,baseStyles:o.aliasIcon})]})}function Et(e){let{iconFn:t,baseStyles:o}=e;const n=(0,l().IS)((e=>({icon:{...o,fill:"dark"===e.mode?e.text.primary:"#3E3C38"},iconBorder:{...o,stroke:e.surface.elevated,strokeWidth:3,strokeLinejoin:"round"}})),[o]);return(0,N.jsxs)(N.Fragment,{children:[t(n.iconBorder),t(n.icon)]})}const Rt=20;function Dt(e){let{collectionContextStore:t,collectionStore:o,onCloseParentMenu:s,...a}=e;const c=(0,j().tz)(),d=(0,i().v3)(),u=(0,_e().x6)(),p=(0,_e().Xl)(),g=(0,r().K8)((()=>{var e;return(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id)===o.getParentId()}),[t,o]),m=(0,r().K8)((()=>Bt({collectionContextStore:t,collectionStore:o})),[t,o]),S=(0,r().K8)((()=>{var e;return((null===(e=t.collectionViewBlockStore())||void 0===e||null===(e=e.getCollectionViewStores())||void 0===e?void 0:e.length)??0)===m.length}),[t,m]),f=(0,r().K8)((()=>Bt({collectionContextStore:t,collectionStore:o})),[t,o]),{canConfigureCollection:y,canConfigureBlock:h}=(0,r().K8)((()=>{const{state:e}=t.permissionScopesStore;return{canConfigureCollection:e.canConfigureCollection,canConfigureBlock:e.canConfigureBlock}}),[t]),{icon:x,name:v}=(0,r().K8)((()=>{const e=(0,N.jsx)(wt().B6,{icon:o.getIcon(),iconRecordCategory:"collection",disabled:!0,isEmptyPage:!1,size:20});return{icon:g?e:(0,N.jsx)(Ft,{icon:e}),name:(0,_t().Qo)({collectionStore:o,intl:c,isWorkflowsContainerWithCreationEnabled:u})}}),[o,c,g,u]),C=p&&u&&g&&y&&!S,b=u&&g&&y&&!S,w=u&&!g&&h&&!S&&m.length>0,A=C||b||w,_=(0,n.useCallback)((()=>{vt().D6({label:c.formatMessage({id:"manageDataSourcesMenu.moveDataSourceErrorMessage",defaultMessage:"Data source moving is not yet supported"})})}),[c]),M=(0,n.useCallback)((e=>{let{value:n,environment:i}=e;if("page"===n.type){const e=kt().Bv.createChildStore(o,{table:yt().ev,id:n.id,spaceId:n.spaceId||o.getSpaceId()});if(e.isCollectionView())return void function(e){const{environment:t,collectionStore:o,collectionContextStore:n,selectedCollectionViewBlockStore:i}=e;F().createAndCommit({userAction:"DataSourceMenuItem.moveDataSourceToCollectionViewBlock",environment:t,canUndo:!0,perform:e=>{const r=n.collectionViewBlockStore();r&&F().applyOperation({store:r,operation:{pointer:r.pointer,command:"keyedObjectListRemove",path:["format","collection_pointers"],args:{remove:o.pointer}},transaction:e}),xt().zv({store:o,data:{parent_id:i.id,parent_table:i.table},transaction:e}),(0,Tt().p)({collectionViewBlockStore:i,collectionPointer:o.pointer,transaction:e});const l={type:"moveToBlock",blockStore:i};vt().D6({label:(0,It().lD)({environment:t,movedItems:[],pageDescriptorOverride:(0,At().r4)(o.getName(),o),moveToLocation:l}),right:(0,N.jsx)(Mt().F,{moveToLocation:l,movedItems:[]})})}})}({environment:i,collectionContextStore:t,selectedCollectionViewBlockStore:e,collectionStore:o})}_()}),[t,o,_]),k=(0,n.useRef)(null),T=(0,n.useCallback)((()=>{var e;ie().A.isMobile?_():(s(),ht().L1({environment:d,collectionStore:o,originRect:null===(e=k.current)||void 0===e?void 0:e.getBoundingClientRect(),moveToContext:"manage_data_sources",onAccept:M}))}),[d,o,s,M,_]),P=(0,l().IS)((e=>({wrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",...A?{paddingRight:2}:{}},titleAndIcon:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,marginRight:8},title:{...I().RC},trashAndNumViews:{display:"flex",flexDirection:"row",alignItems:"center",gap:8},rightIcon:{fill:e.icon.secondary,width:20,height:20},viewsTooltipContent:{maxWidth:150,display:"flex",flexDirection:"column",gap:2}})),[A]);return(0,N.jsx)(G().A,{style:P.wrapper,...a,titleStyle:P.titleAndIcon,title:(0,N.jsxs)(N.Fragment,{children:[x,(0,N.jsx)("span",{style:P.title,children:v})]}),rightStyle:P.trashAndNumViews,right:(0,N.jsxs)(N.Fragment,{children:[0===f.length?null:(0,N.jsx)(jt().A,{delayThreshold:400,render:e=>(0,N.jsx)("div",{...e,children:(0,N.jsx)(pt().D,{colorName:"tertiary",children:(0,N.jsx)(j().sA,{id:"manageDataSourcesMenu.nViews",defaultMessage:"{numViews, select, 1 {1 view} other {{numViews} views}}",values:{numViews:f.length<100?f.length:"99+"}})})}),renderTooltip:e=>(0,N.jsxs)("div",{style:P.viewsTooltipContent,...e,children:[f.slice(0,Rt).map((e=>(0,N.jsx)(Kt,{viewStore:e},e.id))),f.length<=Rt?null:(0,N.jsx)(pt().D,{children:(0,N.jsx)(j().sA,{id:"manageDataSourcesMenu.plusMoreViews",defaultMessage:"{numViews, plural, one {+1 more} other {+{numViews} more}}",values:{numViews:f.length-Rt}})})]})}),C?(0,N.jsx)(jt().A,{delayThreshold:400,renderTooltip:()=>(0,N.jsx)(j().sA,{id:"manageDataSourcesMenu.moveDataSourceTooltip",defaultMessage:"Move data source to another database"}),render:e=>(0,N.jsx)(Z().A,{...e,ref:k,icon:mt().F,iconStyle:P.rightIcon,ariaLabel:c.formatMessage({id:"manageDataSourcesMenu.moveDataSourceAriaLabel",defaultMessage:"Move data source"}),onClick:T})}):void 0,b?(0,N.jsx)(Z().A,{icon:St().trashSmallIcon,iconStyle:P.rightIcon,ariaLabel:c.formatMessage({id:"manageDataSourcesMenu.deleteDataSourceAriaLabel",defaultMessage:"Delete data source"}),onClick:()=>{vt().D6({label:c.formatMessage({id:"manageDataSourcesMenu.deleteDataSourceErrorMessage",defaultMessage:"Database deletion is not yet supported"})})}}):void 0,w?(0,N.jsx)(jt().A,{delayThreshold:400,renderTooltip:()=>(0,N.jsx)(j().sA,{id:"manageDataSourcesMenu.deleteViewsTooltip",defaultMessage:"Delete {numViews, select, 1 {linked view} other {{numViews} linked views}}",values:{numViews:m.length}}),render:e=>(0,N.jsx)(Z().A,{...e,icon:ft().xMarkIcon,iconStyle:P.rightIcon,ariaLabel:c.formatMessage({id:"manageDataSourcesMenu.deleteViewsAriaLabel",defaultMessage:"Delete linked views"}),onClick:()=>{const e=t.collectionViewBlockStore();e&&function(e){var t;let{environment:o,collectionContextStore:n,collectionViewBlockStore:i,collectionStore:r}=e;const l=Bt({collectionContextStore:n,collectionStore:r}),s=new Set(l.map((e=>e.id))),a=i.getCollectionViewStores().find((e=>!s.has(e.id)));if(!a)return;const c=null===(t=n.collectionViewStore())||void 0===t?void 0:t.id,d=c&&s.has(c);F().createAndCommit({userAction:"collectionSettingsActions.handleDeleteCollectionViews",environment:o,canUndo:!0,perform:e=>{for(const t of l)(0,Pt().T)({collectionViewBlockStore:i,collectionViewStore:t,transaction:e})}}),d&&(0,at().t)({environment:o,collectionContextStore:n,collectionViewId:a.id,isFullScreen:n.isFullScreenStore.state,isInPeekRenderer:n.isInPeekRendererStore.state,isRootChild:n.isRootChildStore.state})}({environment:d,collectionContextStore:t,collectionViewBlockStore:e,collectionStore:o})}})}):null]})})}function Kt(e){let{viewStore:t}=e;const{viewType:o,icon:n,name:i}=(0,r().K8)((()=>{const e=t.getType();return{viewType:e,icon:t.getFormat().collection_view_icon,name:(0,bt().OO)({collectionViewName:t.getName(),collectionViewType:e})}}),[t]),s=(0,l().IS)((e=>({viewsTooltipRow:{display:"flex",flexDirection:"row",alignItems:"center",gap:8},name:{...I().RC}})),[]);return(0,N.jsxs)("div",{style:s.viewsTooltipRow,children:[(0,N.jsx)(Ct().h,{color:"lightGray",viewType:o,viewIcon:n,size:16}),(0,N.jsx)("div",{style:s.name,children:i})]})}function Ot(e){var t;let{collectionStore:o,collectionContextStore:n}=e;return(null===(t=n.collectionViewBlockStore())||void 0===t?void 0:t.id)===o.getParentId()}function Lt(e){let{collectionContextStore:t}=e;const o=(0,r().K8)((()=>{var e;return(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getOwnedCollectionStores())??[]}),[t]),n=(0,r().K8)((()=>{var e;return(0,A().hS)((null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getCollectionViewStores())??[],(e=>{var t;return null===(t=e.getCollectionStore())||void 0===t?void 0:t.id})).flatMap((e=>{const o=e.getCollectionStore();if(!o)return[];return!Ot({collectionStore:o,collectionContextStore:t})?[o]:[]}))}),[t]),i=(0,r().K8)((()=>t.permissionScopesStore.state.canConfigureBlock),[t]),l=(0,r().uB)(void 0,gt().A),s=(0,r().K8)((()=>l.state.open),[l]),a=(0,N.jsx)(j().sA,{defaultMessage:"Manage data sources",id:"database.viewSettings.mainTab.manageDataSources.title"});return(0,N.jsx)(dt().A,{focused:!1,buttonPopupStore:l,alignmentToOrigin:Q().yP.End,placementToOrigin:Q().sx.Bottom,popupType:ie().A.isMobile?Q().z7.BottomSheet:Q().z7.Popup,bottomSheetInitialState:"half",renderOrigin:e=>(0,N.jsx)(X().A,{showChevron:!0,icon:lt().c,title:a,rotateChevron:s,...e}),render:e=>(0,N.jsx)(zt,{title:a,collectionContextStore:t,canConfigureBlock:i,dataSources:o,linkedDatabases:n,onClose:e.close})})}function zt(e){let{title:t,collectionContextStore:o,canConfigureBlock:r,dataSources:l,linkedDatabases:a,onClose:c}=e;const d=(0,i().v3)(),u=(0,_e().x6)(),p=(0,n.useCallback)(((e,t)=>{var n;if(ie().A.isMobile&&P().os({collectionSettingsStore:o.settingsStore}),!Ot({collectionStore:e,collectionContextStore:o}))return void(0,ct().S)({environment:d,collectionStore:e,event:t,pageVisitSource:s().y8.ManageDataSourcesMenu});if(e.id===(null===(n=o.collectionStore())||void 0===n?void 0:n.id))return;const i=Bt({collectionContextStore:o,collectionStore:e})[0];i&&(0,at().t)({environment:d,collectionContextStore:o,collectionViewId:i.id,isFullScreen:o.isFullScreenStore.state,isInPeekRenderer:o.isInPeekRendererStore.state,isRootChild:o.isRootChildStore.state})}),[o,d]),g=(0,n.useMemo)((()=>{const e=r&&u?{key:"AddDatabase",render:e=>(0,N.jsx)(G().A,{title:(0,N.jsx)(pt().D,{colorName:"secondary",children:(0,N.jsx)(j().sA,{defaultMessage:"Add data source",id:"manageDataSourcesMenu.addDatabase.title"})}),icon:(0,N.jsx)(ne().I,{icon:We().plusIcon,color:"secondary"}),...e}),action:()=>(0,st().n)({environment:d,collectionContextStore:o})}:void 0,t=r&&u?{key:"LinkExisting",render:e=>(0,N.jsx)(G().A,{title:(0,N.jsx)(pt().D,{colorName:"secondary",children:(0,N.jsx)(j().sA,{defaultMessage:"Link existing database",id:"manageDataSourcesMenu.linkExisting.title"})}),icon:(0,N.jsx)(ne().I,{icon:We().plusIcon,color:"secondary"}),...e}),action:()=>F().createAndCommit({environment:d,userAction:"createNewViewFromManageDataSourcesMenu",canUndo:!0,perform:e=>(0,st().Z)({environment:d,collectionContextStore:o,newViewType:"table",transaction:e,settingsDestination:"linkToDatabase"})})}:void 0;return(0,A().oE)([{key:"manageDataSources",render:e=>(0,N.jsx)(J().A,{topBorder:!1,disableMobileBorders:!0,title:(0,N.jsx)(j().sA,{defaultMessage:"Source",id:"manageDataSourcesMenu.manageDataSources.sources.title"}),mobileTitleStyle:{fontSize:14},desktopTitleStyle:0===a.length?{marginBottom:2}:void 0,...e}),items:(0,A().oE)([...l.map((e=>({key:e.id,render:t=>(0,N.jsx)(Dt,{collectionContextStore:o,collectionStore:e,onCloseParentMenu:c,...t}),action:t=>{let{event:o}=t;return p(e,o)}}))),e])},{key:"linkedDatabases",render:e=>(0,N.jsx)(J().A,{topBorder:!0,disableMobileBorders:!0,style:{marginBottom:0},title:(0,N.jsx)(j().sA,{defaultMessage:"Linked",id:"manageDataSourcesMenu.manageDataSources.linked.title"}),mobileTitleStyle:{fontSize:14},desktopTitleStyle:0===a.length?{marginBottom:2}:void 0,...e}),items:(0,A().oE)([...a.map((e=>({key:e.id,render:t=>(0,N.jsx)(Dt,{collectionContextStore:o,collectionStore:e,onCloseParentMenu:c,...t}),action:t=>{let{event:o}=t;return p(e,o)}}))),t])}])}),[r,o,l,d,p,a,u,c]),m=(0,n.useMemo)((()=>ie().A.isMobile?{title:t,menuType:$().gu.Modal,right:(0,N.jsx)(ut().DoneMenuText,{}),onClickRight:c}:{menuType:$().gu.Popup,width:268,maxHeight:"70vh"}),[t,c]);return(0,N.jsx)(q().A,{...m,children:(0,N.jsx)(Y().Ay,{type:Y().Oh.Vertical,initialFocus:void 0,sections:g})})}var Nt=()=>o(197730);const Ut=(0,j().YK)({small:{defaultMessage:"Small",id:"database.viewSettings.layoutTab.mapHeight.small"},medium:{defaultMessage:"Medium",id:"database.viewSettings.layoutTab.mapHeight.medium"},large:{defaultMessage:"Large",id:"database.viewSettings.layoutTab.mapHeight.large"},extra_large:{defaultMessage:"Extra large",id:"database.viewSettings.layoutTab.mapHeight.extra_large"}}),Wt=(0,j().YK)({mapStyle:{defaultMessage:"Style",id:"database.viewSettings.mapTab.mapStyle.title"}}),Ht=n.memo((function(e){let{collectionSettingsStore:t}=e;const s=(0,i().v3)(),a=(0,j().tz)(),c=(0,ee().ET)(),d=(0,r().K8)((()=>c.collectionViewStore()),[c]),u=(0,r().O$)(c.isInHomeWidgetStore),p=(0,r().K8)((()=>{var e;const t=null===(e=c.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!t&&(0,se().sj)(t)}),[c]),g=(0,n.useMemo)((()=>p?{feature:"tasks",from:"tasks_more_menu"}:{feature:"custom_db",from:"custom_db_more_menu"}),[p]),m=(0,n.useCallback)((()=>{Ce().default.state.currentSpaceViewStore&&B().WO({environment:s,currentSpaceViewStore:Ce().default.state.currentSpaceViewStore,...g})}),[s,g]),S=!(0,r().O$)(c.permissionScopesStore).canConfigureBlock,f=(0,l().IS)((()=>({layoutSection:{paddingTop:0,paddingBottom:4},heightSection:{paddingTop:4},heightSectionMobile:{boxShadow:"none"},titleStyle:{opacity:S?.4:void 0}})),[S]);return d?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(J().A,{extraPadding:!0,style:f.layoutSection,children:(0,N.jsx)(vo,{collectionContextStore:c,collectionSettingsStore:t})}),(0,N.jsx)(J().A,{extraPadding:!0,topBorder:!0,style:f.heightSection,title:a.formatMessage(Wt.mapStyle),mobileStyle:f.heightSectionMobile,desktopTitleStyle:f.titleStyle,mobileTitleStyle:f.titleStyle,children:(0,N.jsx)(Gt,{collectionContextStore:c,disabled:S})}),(0,N.jsx)($t,{collectionContextStore:c,collectionSettingsStore:t,disabled:S}),(0,N.jsxs)(J().A,{extraPadding:!0,topBorder:!0,children:[(0,N.jsx)(o(403217).z,{collectionContextStore:c,collectionSettingsStore:t}),u?(0,N.jsx)(X().A,{icon:y().e,title:a.formatMessage(he().u.hide),showChevron:!1,onClick:m}):null]})]}):null}));function $t(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n}=e;return(0,N.jsxs)(J().A,{extraPadding:!0,topBorder:!0,children:[(0,N.jsx)(Ne().A,{collectionContextStore:t,collectionSettingsStore:o,disabled:n}),(0,N.jsx)(Le().A,{collectionContextStore:t,collectionSettingsStore:o,disabled:n})]})}function Gt(e){let{collectionContextStore:t,disabled:l}=e;const s=(0,i().v3)(),a=(0,j().tz)(),c=(0,r().K8)((()=>(0,Nt().Sk)(t.normalizedFormatStore.state)),[t]),d=(0,n.useCallback)((e=>{const n=t.collectionViewStore();n&&F().createAndCommit({userAction:"MapSettingsMain.handleMapHeightChange",environment:s,canUndo:!0,perform:t=>{o(896628).zA({stores:[n],update:{map_config:{height:e}},transaction:t})}})}),[t,s]),u=(0,n.useMemo)((()=>Nt().yQ.map((e=>({key:e,type:"button",title:a.formatMessage(Ut[e])})))),[a]);return(0,N.jsx)(o(828973).A,{title:(0,N.jsx)(j().sA,{defaultMessage:"Height",id:"database.viewSettings.layoutTab.mapHeight.title"}),collectionContextStore:t,selectedKey:c,popupStyle:{minWidth:190},options:u,onChange:d,disabled:l})}var Qt=()=>o(589531),Zt=()=>o(3284),qt=()=>o(457056),Yt=()=>o(589407),Jt=()=>o(18953),Xt=()=>o(446966),eo=()=>o(374562),to=()=>o(739222),oo=()=>o(479e3),no=()=>o(731320);function io(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,i().Y0)(),l=!(0,r().O$)(be().e),s=lo({collectionContextStore:t})||l,a=(0,r().uB)(void 0,gt().A),c=(0,r().O$)(a),d=(0,N.jsx)(j().sA,{defaultMessage:"More settings",id:"database.viewSettings.mainTab.moreSettingsButton.title"});return(0,N.jsx)(dt().A,{focused:!1,buttonPopupStore:a,alignmentToOrigin:Q().yP.End,placementToOrigin:Q().sx.Bottom,popupType:n.isMobile?Q().z7.BottomSheet:Q().z7.Popup,bottomSheetInitialState:"half",renderOrigin:e=>(0,N.jsx)(X().A,{...e,icon:Yt().L,title:d,showChevron:!0,rotateChevron:c.open,disabled:s}),render:e=>(0,N.jsx)(ro,{title:d,collectionContextStore:t,collectionSettingsStore:o,onClose:e.close})})}function ro(e){let{title:t,collectionContextStore:o,collectionSettingsStore:l,onClose:s}=e;const{isMobile:a}=(0,i().Y0)(),c=function(e){let{collectionContextStore:t,collectionSettingsStore:o,onClose:l}=e;const s=(0,i().v3)(),a=(0,le().rD)(t),c=(0,r().K8)((()=>t.databaseType),[t]),d=(0,eo().md)(),u=(0,eo().J4)(),{canHaveSprints:p,canTurnIntoTasks:g}=(0,r().K8)((()=>({canHaveSprints:(0,to().cM)(t),canTurnIntoTasks:(0,to().Y7)(t,a)})),[t,a]),m=(0,r().K8)((()=>(0,to().YQ)(to().YX,t)),[t]),S=(0,le().hw)(t,o),f=(0,oo().$F)({collectionContextStore:t,from:"customize_database_button_in_more_settings_menu"}),y=(0,n.useCallback)((()=>{P().a2({collectionSettingsStore:o,item:{type:"sprintSettings",from:"more_settings"}})}),[o]),h=(0,n.useMemo)((()=>m?(0,to().tQ)({environment:s,collectionContextStore:t}):()=>(0,to().$M)({environment:s,collectionContextStore:t})),[m,s,t]),x=(0,n.useCallback)((e=>(0,le().Dj)({collectionContextStore:t,feature:e,appConfig:a})?(0,N.jsx)(j().sA,{defaultMessage:"On",id:"database.viewSettings.mainTab.featureStatusLabel.on"}):null),[t,a]),v=(0,n.useMemo)((()=>({key:"sprints",render:e=>(0,N.jsx)(X().A,{icon:Jt().H,title:to().RH.name,right:x(to().RH),showChevron:!0,menuListItemProps:e}),action:y})),[y,x]),C=(0,n.useMemo)((()=>({key:"tasks",render:e=>(0,N.jsx)(X().A,{icon:Zt().arrowSquarePathUpDownIcon,title:m?(0,N.jsx)(j().sA,{defaultMessage:"Undo Task database",id:"database.viewSettings.mainTab.undoTaskDatabaseButton.title"}):(0,N.jsx)(j().sA,{defaultMessage:"Turn into Tasks",id:"database.viewSettings.mainTab.turnIntoTasksButton.title"}),showChevron:!0,menuListItemProps:e}),action:()=>{h(),l()}})),[h,m,l]),b=(0,n.useMemo)((()=>(0,A().oE)([{key:"subItems",render:e=>(0,N.jsx)(X().A,{icon:Xt().E,title:(0,N.jsx)(j().sA,{...(0,pe().mv)({feature:"subitem",databaseType:c})}),right:x(d),showChevron:!0,menuListItemProps:e}),action:()=>S(d)},{key:"dependencies",render:e=>(0,N.jsx)(X().A,{icon:qt().o,title:u.name,right:x(u),showChevron:!0,menuListItemProps:e}),action:()=>S(u)},p?v:void 0,{key:"connections",render:e=>(0,N.jsx)(oo().lP,{collectionContextStore:t,collectionSettingsStore:o,menuListItemProps:e}),action:()=>P().a2({collectionSettingsStore:o,item:{type:"connectionFeatures"}})},{key:"customizeLayout",render:e=>(0,N.jsx)(oo().NS,{collectionContextStore:t,menuListItemProps:e}),action:f},g?C:void 0,{key:"publishing",render:e=>(0,N.jsx)(oo().GD,{collectionContextStore:t}),action:()=>{}},{key:"following",render:e=>(0,N.jsx)(oo().EK,{collectionContextStore:t}),action:()=>{}}])),[p,g,t,o,c,u,x,S,f,v,d,C]);return b}({collectionContextStore:o,collectionSettingsStore:l,onClose:s}),d=(0,n.useMemo)((()=>[{key:"moreSettings",render:e=>(0,N.jsx)(J().A,{...e}),items:c}]),[c]),u=(0,n.useMemo)((()=>a?{title:t,menuType:$().gu.Modal,right:(0,N.jsx)(ut().DoneMenuText,{}),onClickRight:s}:{menuType:$().gu.Popup,width:250}),[a,t,s]);return(0,N.jsx)(q().A,{...u,children:(0,N.jsx)(Y().Ay,{type:Y().Oh.Vertical,sections:d,initialFocus:void 0,resetFocusOnMouseOut:!0})})}function lo(e){let{collectionContextStore:t}=e;return(0,r().K8)((()=>{const e=t.permissionScopesStore.state;if(!(e.canConfigureCollection||e.canConfigureBlock))return!0;const o=t.collectionStore();return!o||((0,no().qe)(o)||(0,no().X6)(o))}),[t])}const so=o(757695).Store.createClass(!1,{name:"ShowViewDescriptionStore"});function ao(e){const{collectionContextStore:t,collectionViewStore:o,selectViewNameInitial:l,collectionSettingsStore:s,handleAddItemClick:a}=e,{isMobile:c}=(0,i().Y0)(),d=(0,i().v3)(),u=(0,r().uB)(void 0,so),p=(0,r().O$)(t.isInHomeWidgetStore),g=(0,re().lU)(),m="PersonalHome"===g||"TeamHome"===g,S=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,se().sj)(o)}),[t]),f=(0,n.useCallback)((e=>function(e,t,o,n){const i=null==n?void 0:n.getFormat().description;if(!n||e===i)return;F().createAndCommit({userAction:"CollectionSettingsViewMain.handleDescriptionChange",environment:t,canUndo:!0,perform:t=>{(0,R().F)({collectionViewStore:n,update:{format:{...n.getFormat(),description:e}},transaction:t})}}),(0,k().X)({environment:t,collectionContextStore:o,action:"set_description"})}(e,d,t,o)),[d,t,o]),y=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),h=(0,r().K8)((()=>o.isDefined()),[o]),{description:x}=(0,r().K8)((()=>o.getFormat()),[o]),v=(0,r().K8)((()=>o.getType()),[o]),C=(0,r().O$)(u),b=(0,r().K8)((()=>"viewsMain"===t.viewsModuleContextStore.getViewModuleType()),[t]),w=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),A=(0,me().X)("db_ux_chrome"),_=(0,r().K8)((()=>{const e=s.state.showAddItemButton;return!!(a&&e&&A&&w)}),[a,s,A,w]),I=(0,r().K8)((()=>t.isMultiSourceView),[t]);if(!h||!y)return null;const M=(0,N.jsx)(ze().A,{collectionViewStore:o,collectionContextStore:t,showViewDescriptionStore:u,selectViewNameInitial:l,topBorder:_,sectionStyle:{marginTop:_&&!I?5:void 0}});if("page"===v)return(0,N.jsxs)(Be().Ay,{...e,title:A?(0,N.jsx)(j().sA,{...Fo.viewSettings}):(0,N.jsx)(j().sA,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:[M,C&&(0,N.jsx)(Te().y,{initialDescription:x,handleSaveDescription:f})]});let T;if("chart"===v)T=(0,N.jsx)(ke().X,{collectionSettingsStore:s});else if("map"===v)T=(0,N.jsx)(Ht,{collectionSettingsStore:s});else if("form_editor"===v)T=(0,N.jsx)(et,{collectionContextStore:t,collectionSettingsStore:s});else{if(m)return(0,N.jsx)(Bo,{collectionContextStore:t,collectionSettingsStore:s});if(p)return(0,N.jsx)(Po,{collectionContextStore:t,collectionSettingsStore:s,viewNameInput:M,addItemSection:_&&a&&w?(0,N.jsx)(oe,{handleAddItemClick:a,store:w,disableTemplatesDropdown:I}):null});T=A?(0,N.jsx)(Mo,{collectionContextStore:t,collectionSettingsStore:s,isConfiguringViewsMainModule:b,isMyTasks:S}):(0,N.jsx)(ko,{collectionContextStore:t,collectionSettingsStore:s,isMyTasks:S,isConfiguringViewsMainModule:b})}let P=Fo.viewSettings;return"form_editor"===v?P=Fo.formSettings:c&&(P=Fo.mobileSettings),(0,N.jsxs)(Be().Ay,{...e,title:A?(0,N.jsx)(j().sA,{...P}):"form_editor"===v?(0,N.jsx)(j().sA,{defaultMessage:"Form options",id:"database.viewSettings.formTab.title"}):(0,N.jsx)(j().sA,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),hideDesktopHeader:_,desktopTitleType:!A||S||"chart"===v||"map"===v||"form_editor"===v?"mainTitle":"sectionHeader",children:[(0,N.jsx)(uo,{collectionContextStore:t}),_&&a&&w&&(0,N.jsx)(oe,{handleAddItemClick:a,store:w,disableTemplatesDropdown:I}),M,C&&(0,N.jsx)(Te().y,{initialDescription:x,handleSaveDescription:f}),T]})}function co(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function uo(e){let{collectionContextStore:t}=e;return(0,r().K8)((()=>{const e=t.collectionViewBlockStore();return e&&"content_only_editor"!==e.getRole()}),[t])?null:(0,N.jsx)(U,{})}function po(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,r().O$)(o.currentSubitemFormatStoreForCollectionStore),i=(0,r().K8)((()=>o.databaseType),[o]),l=(0,r().K8)((()=>(0,Ie().QZ)({feature:"subitem",collectionContextStore:o})),[o]),s=(0,r().K8)((()=>function(e,t){const o=t.permissionScopesStore.state,n=(0,_().O9)(e),i=o.canConfigureBlock;return n||i}(n,o)),[o,n]),a=(0,r().K8)((()=>function(e){let t;return t=e?pe().Ic.relationFeatureOnMessage:pe().Ic.relationFeatureOffMessage,ue().A.formatMessage(t)}(l)),[l]);return(0,N.jsx)(X().A,{icon:v().A,title:(0,N.jsx)(j().sA,{...(0,pe().mv)({feature:"subitem",databaseType:i})}),showChevron:!0,right:a,onClick:()=>{P().a2({collectionSettingsStore:t,item:{type:"subitemV2",from:"view_options"}})},disabled:!s})}function go(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().v3)(),l=(0,r().K8)((()=>(0,ce().aS)(t)),[t]),s=(0,r().O$)(t.aliveAutomationCountStore),a=(0,r().K8)((()=>(0,ce().rc)({collectionStore:t.collectionStore()})),[t]),c=!(0,r().O$)(be().e),d=0===s&&c;return l?(0,N.jsx)(X().A,{icon:x().m,onClick:()=>{const e=M().H(o);!a||s>0?P().a2({collectionSettingsStore:o,item:{source:"collection_view_settings",type:"automationSettings",from:e}}):E().h({environment:n,mode:"create_automation",collectionContextStore:t,collectionSettingsStore:o,from:e})},right:s>0?s:void 0,showChevron:!0,title:(0,N.jsx)(j().sA,{defaultMessage:"Automations",id:"database.viewSettings.mainTab.automations.title"}),disabled:d}):null}function mo(e){const t=(0,fe().K)({collectionContextStore:e}),o=(0,me().X)("notion_calendar_db_integration_non_time_views"),n=(0,me().X)("notion_calendar_db_integration_view_settings_entrypoint");return t&&o&&n?(0,N.jsx)(Se().A,{collectionContextStore:e,entrypoint:"view_settings"}):null}function So(e){let{parentStore:t}=e;const o=(0,i().v3)();return(0,N.jsx)(X().A,{showChevron:!1,icon:S().P,onClick:()=>(0,Ae().showWorkflowEditor)({environment:o,parentStore:t}),right:(0,N.jsx)(ne().I,{icon:d().arrowDiagonalUpRightIcon,color:"secondary",size:18}),title:(0,N.jsx)(j().sA,{defaultMessage:"Builder mode",id:"database.viewSettings.mainTab.builderMode.title"})})}function fo(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,l=(0,i().v3)(),s=(0,r().K8)((()=>co(t)),[t]),a="board"===s?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},c=(0,r().O$)(t.normalizedSchemaStore),d=(0,r().O$)(t.normalizedFormatStore)[a.groupByKey],u=(0,r().O$)(t.permissionScopesStore);return!("calendar"===s||"feed"===s)?(0,N.jsx)(X().A,{icon:"board"===s?w().q:b().p,title:(0,N.jsx)(j().sA,{defaultMessage:"Group",id:"database.viewSettings.mainTab.groupButton.title"}),showChevron:!0,right:(0,Ve().hU)(d?c[d.property]:void 0),onClick:()=>{var e;(0,k().X)({environment:l,collectionContextStore:t,action:"click_group",original_view_type:s,property_type:d?null===(e=c[d.property])||void 0===e?void 0:e.type:void 0}),t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),P().a2({collectionSettingsStore:o,item:d?{type:"group",...a}:{type:"groupByProperty",...a}})},disabled:n||!d&&!u.canConfigureBlock}):null}function yo(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,l=(0,i().v3)(),s=(0,r().K8)((()=>co(t)),[t]),a=(0,r().O$)(t.normalizedSchemaStore),c=(0,r().O$)(t.normalizedFormatStore).collection_group_by,d={groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},u=(0,r().O$)(t.permissionScopesStore);return"board"===s?(0,N.jsx)(X().A,{icon:b().p,title:(0,N.jsx)(j().sA,{defaultMessage:"Sub-group",id:"database.viewSettings.mainTab.subGroupButton.title"}),showChevron:!0,right:(0,Ve().hU)(c?a[c.property]:void 0),onClick:()=>{var e;(0,k().X)({environment:l,collectionContextStore:t,action:"click_subgroup",original_view_type:s,property_type:c?null===(e=a[c.property])||void 0===e?void 0:e.type:void 0}),t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),P().a2({collectionSettingsStore:o,item:c?{type:"group",...d}:{type:"groupByProperty",...d}})},disabled:n||!c&&!u.canConfigureBlock}):null}function ho(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,i=(0,r().K8)((()=>co(t)),[t]),l=(0,r().O$)(t.normalizedFormatStore).conditional_color_rules,s=(0,r().O$)(t.permissionScopesStore);return(0,a().fu)(i)?(0,N.jsx)(X().A,{icon:g().M,title:(0,N.jsx)(j().sA,{defaultMessage:"Color",id:"database.viewSettings.mainTab.colorButton.title"}),showChevron:!0,onClick:()=>{P().a2({collectionSettingsStore:o,item:l&&l.length>0?{type:"conditionalColors"}:{type:"createConditionalColor"}})},disabled:n||!s.canConfigureBlock}):null}const xo="layout";function vo(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,l=(0,i().v3)(),{isPulsing:s,collectionViewStore:a,collectionViewType:c}=(0,r().K8)((()=>{const e=t.collectionViewStore();return{collectionViewStore:e,collectionViewType:null==e?void 0:e.getType(),isPulsing:Boolean(o.getState().isOnboardingFeedView)}}),[t,o]);return a&&c?(0,N.jsx)(X().A,{disabled:n,icon:ae().ZU[c],title:(0,N.jsx)(j().sA,{defaultMessage:"Layout",id:"database.viewSettings.mainTab.layoutButton.title"}),showChevron:!0,right:ae().to[c],onClick:()=>{(0,k().X)({environment:l,collectionContextStore:t,action:"click_layout"}),P().a2({collectionSettingsStore:o,item:{type:xo}})},isPulsing:s}):null}function Co(e){const{collectionContextStore:t,collectionSettingsStore:o,disabled:n=!1}=e,l=(0,i().v3)(),s=(0,r().O$)(t.normalizedFormatStore),a=(0,r().K8)((()=>co(t)),[t]),d=(0,r().K8)((()=>(0,c().u9)(a)),[a]);if("chart"===a||"map"===a||"form_editor"===a)return(0,N.jsx)(N.Fragment,{});const u=((d?s[d]:void 0)||[]).filter((e=>Boolean(e.visible))).length;return(0,N.jsx)(X().A,{icon:m().n,disabled:n,title:(0,N.jsx)(j().sA,{defaultMessage:"Properties",id:"database.viewSettings.mainTab.propertiesButton.title"}),showChevron:!0,right:(0,N.jsx)(j().sA,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.mainTab.propertiesButton.propertiesShown.title",values:{propertiesShown:u}}),onClick:()=>{(0,k().X)({environment:l,collectionContextStore:t,action:"click_properties"}),P().a2({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"timeline"}})}})}function bo(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,i().v3)(),l=(0,r().O$)(t.normalizedFormatStore),s=(0,r().K8)((()=>co(t)),[t]),a=(0,r().K8)((()=>(0,c().u9)(s)),[s]);if("chart"===s||"map"===s||"form_editor"===s)return null;const d=((a?l[a]:void 0)??[]).filter((e=>Boolean(e.visible))).length;return(0,N.jsx)(X().A,{icon:f().eyeIcon,title:(0,N.jsx)(j().sA,{defaultMessage:"Property visibility",id:"database.viewSettings.mainTab.propertyVisibilityButton.title"}),showChevron:!0,right:d,onClick:()=>{(0,k().X)({environment:n,collectionContextStore:t,action:"click_show_hide_properties"}),P().a2({collectionSettingsStore:o,item:{type:"propertyVisibility",timelineViewTab:"timeline"}})}})}function wo(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,i().v3)(),l=(0,r().K8)((()=>{const e=t.permissionScopesStore.state;return!(0,Me().K)({collectionContextStore:t,permissionScopes:e})}),[t]);return(0,N.jsx)(X().A,{icon:m().n,title:(0,N.jsx)(j().sA,{defaultMessage:"Edit properties",id:"database.viewSettings.mainTab.editPropertiesButton.title"}),disabled:l,showChevron:!l,onClick:()=>{(0,k().X)({environment:n,collectionContextStore:t,action:"click_edit_properties"}),P().a2({collectionSettingsStore:o,item:{type:"editProperties",timelineViewTab:"timeline"}})}})}function jo(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const l=(0,i().v3)(),s=(0,r().O$)(t.normalizedSchemaStore),a=(0,r().O$)(t.currentSortsStore),c=(0,n.useCallback)((()=>{(0,k().X)({environment:l,collectionContextStore:t,action:"click_sort"}),0===a.length?P().a2({collectionSettingsStore:o,item:{type:"createSort"}}):P().a2({collectionSettingsStore:o,item:{type:"sort"}})}),[t,l,o,a.length]);return(0,N.jsx)(X().A,{icon:p().C,title:(0,N.jsx)(j().sA,{...Qt().D.sortTitle}),showChevron:!0,right:(0,N.jsx)(D().v,{currentSorts:a,schema:s}),onClick:c})}function Ao(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,r().O$)(t.permissionScopesStore),i=(0,r().K8)((()=>t.collectionStore()),[t]),l=(0,r().K8)((()=>null==i?void 0:i.isSyncedCollection()),[i]),s=(0,r().K8)((()=>t.contextType),[t]);return(0,r().K8)((()=>n.canConfigureCollection),[n])||l||"collectionTypedView"===s?null:(0,N.jsx)(po,{collectionSettingsStore:o,collectionContextStore:t})}function _o(e){const t=(0,i().v3)(),o=(0,r().K8)((()=>{const e=Ce().default.state.mainEditorCurrentBlockStore;return Boolean(e&&(0,se().sj)(e.id))}),[]),n=(0,r().K8)((()=>{if(!(0,ge().$H)())return!1;const t=e.collectionContextStore.collectionViewBlockStore();return!(!t||!(0,se().sj)(t.id))}),[e.collectionContextStore]),s=(0,l().IS)((e=>({icon:Io(e).iconStyles,title:Io(e).menuItemStyles})),[]);if(!n)return null;const a=o?"home_tasks":"home_tile_tasks";return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(W().CollectionTasksEmptyStateModal,{from:a}),(0,N.jsx)(X().A,{showChevron:!1,icon:C().questionMarkCircleIcon,iconStyle:s.icon,title:(0,N.jsx)(j().sA,{defaultMessage:"Don’t see your tasks?",id:"tasksEmptyState.noDatabases.title"}),textWrapperStyle:s.title,onClick:()=>{ve().A.setState(!0),(0,ye().bS)({environment:t,from:a})}})]})}function Io(e){const t=(0,xe().EI)(e);return{menuItemStyles:{color:t.text},iconStyles:{fill:t.icon}}}function Mo(e){let{collectionContextStore:t,collectionSettingsStore:o,isConfiguringViewsMainModule:n,isMyTasks:l}=e;const{isPhone:s}=(0,i().Y0)(),a=(0,me().X)("db_ux_phone_remove_bar"),c=(0,me().X)("conditional_coloring_collection_views"),d=(0,_e().Y4)(),u=(0,r().K8)((()=>{if(d){var e;const o=t.collectionViewBlockStore();if(null!=o&&o.hasMultipleOwnedOrLinkedCollections()||null!=o&&null!==(e=o.getLinkedCollectionStores())&&void 0!==e&&e.length)return(0,N.jsx)(j().sA,{...Fo.dataSourceSettings})}return(0,N.jsx)(j().sA,{...Fo.databaseSettings})}),[d,t]),p=function(e){const t=(0,i().v3)(),o=(0,r().K8)((()=>e.collectionViewBlockStore()),[e]),n=(0,r().K8)((()=>null==o?void 0:o.canAdmin()),[o]);if((0,K().N)(t,e)&&o&&n)return(0,N.jsx)(So,{parentStore:o})}(t),g=function(e){if((0,_e().Y4)())return(0,N.jsx)(Lt,{collectionContextStore:e})}(t),m=(0,rt().R)({collectionContextStore:t}),S=mo(t),f=(0,A().oE)([g,d?m:void 0,p,S]),y=!n&&f.length>0;return(0,N.jsxs)(N.Fragment,{children:[l&&(0,N.jsx)(J().A,{extraPadding:!0,style:{paddingTop:0},children:(0,N.jsx)(vo,{collectionContextStore:t,collectionSettingsStore:o})}),(0,N.jsxs)(J().A,{extraPadding:!0,style:l?void 0:{paddingTop:0},topBorder:l,children:[l?(0,N.jsx)(Co,{collectionContextStore:t,collectionSettingsStore:o}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(vo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(bo,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,N.jsx)(Le().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(jo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(fo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(yo,{collectionContextStore:t,collectionSettingsStore:o}),c?(0,N.jsx)(ho,{collectionContextStore:t,collectionSettingsStore:o}):null,!l&&(0,N.jsx)(Fe().A,{collectionContextStore:t})]}),l?(0,N.jsxs)(J().A,{extraPadding:!0,topBorder:!0,children:[(0,N.jsx)(rt().z,{collectionContextStore:t}),(0,N.jsx)(Fe().A,{collectionContextStore:t}),(0,N.jsx)(_o,{collectionContextStore:t})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(J().A,{title:u,topBorder:!0,extraPadding:!0,style:{marginTop:4},desktopTitleStyle:{paddingTop:4},mobileTitleStyle:{fontSize:14},children:[(0,N.jsx)(Ne().A,{collectionContextStore:t,collectionSettingsStore:o,disabled:n}),!d&&m,(0,N.jsx)(wo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(go,{collectionContextStore:t,collectionSettingsStore:o}),!n&&(0,N.jsx)(io,{collectionContextStore:t,collectionSettingsStore:o})]}),s&&a&&(0,N.jsx)(Vo,{collectionContextStore:t,collectionSettingsStore:o}),y&&(0,N.jsx)(J().A,{topBorder:!0,extraPadding:!0,style:{marginTop:4},children:f})]})]})}function ko(e){let{collectionContextStore:t,collectionSettingsStore:o,isMyTasks:n,isConfiguringViewsMainModule:i}=e;const r=(0,me().X)("delete_database_from_view_settings")&&!i,l=(0,me().X)("conditional_coloring_collection_views"),s=mo(t);return(0,N.jsxs)(N.Fragment,{children:[ie().A.isMobile?(0,N.jsxs)(J().A,{topBorder:!0,children:[(0,N.jsx)(Ne().A,{collectionContextStore:t,collectionSettingsStore:o,disabled:i}),(0,N.jsx)(vo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(Co,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(Le().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(jo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(fo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(yo,{collectionContextStore:t,collectionSettingsStore:o}),l?(0,N.jsx)(ho,{collectionContextStore:t,collectionSettingsStore:o}):null,(0,N.jsx)(Ao,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(go,{collectionContextStore:t,collectionSettingsStore:o})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(J().A,{children:[(0,N.jsx)(Ne().A,{collectionContextStore:t,collectionSettingsStore:o,disabled:i}),(0,N.jsx)(vo,{collectionContextStore:t,collectionSettingsStore:o})]}),(0,N.jsxs)(J().A,{topBorder:!0,children:[(0,N.jsx)(Co,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(Le().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(jo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(fo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(yo,{collectionContextStore:t,collectionSettingsStore:o}),l?(0,N.jsx)(ho,{collectionContextStore:t,collectionSettingsStore:o}):null,(0,N.jsx)(Ao,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(go,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(Pe().A,{collectionContextStore:t})]})]}),(0,N.jsx)(To,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsxs)(J().A,{topBorder:!0,children:[(0,N.jsx)(rt().z,{collectionContextStore:t}),(0,N.jsx)(Fe().A,{collectionContextStore:t}),(0,N.jsx)(Oe().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(Ee().A,{collectionContextStore:t,collectionSettingsStore:o}),n&&(0,N.jsx)(_o,{collectionContextStore:t}),r&&(0,N.jsx)(Ke,{collectionContextStore:t,collectionSettingsStore:o})]}),s&&(0,N.jsx)(J().A,{topBorder:!0,children:s})]})}function To(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,le().C5)(t),i=(0,l().IS)((e=>({title:{display:"flex",alignItems:"center"}})),[]),s=lo({collectionContextStore:t}),a=!(0,r().O$)(be().e);return(0,N.jsx)(J().A,{topBorder:!0,children:(0,N.jsx)(X().A,{icon:h().gearIcon,title:(0,N.jsx)("div",{style:i.title,children:(0,N.jsx)("div",{style:I().RC,children:(0,N.jsx)(j().sA,{defaultMessage:"Customize {databaseName}",id:"database.viewSettings.mainTab.customizeButton.title",values:{databaseName:n}})})}),caption:(0,N.jsx)("div",{children:(0,N.jsx)(j().sA,{defaultMessage:"Change settings, add new features",id:"database.viewSettings.mainTab.customizeButton.caption"})}),shouldWrapCaption:!0,showChevron:!0,onClick:()=>{P().a2({collectionSettingsStore:o,item:{type:"customize"}})},disabled:s||a})})}function Po(e){let{collectionContextStore:t,collectionSettingsStore:o,viewNameInput:s,addItemSection:a}=e;const c=(0,i().v3)(),d=(0,j().tz)(),u=(0,me().X)("conditional_coloring_collection_views"),p=(0,l().IS)((()=>({container:{minWidth:Be().vE},nameInput:{paddingBottom:0}})),[]),g=(0,r().K8)((()=>{var e;const o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!o&&(0,se().sj)(o)}),[t]),m=(0,n.useMemo)((()=>g?{feature:"tasks",from:"tasks_more_menu"}:{feature:"custom_db",from:"custom_db_more_menu"}),[g]);return(0,N.jsxs)("div",{style:p.container,children:[a,(0,N.jsx)(J().A,{style:p.nameInput,children:s}),(0,N.jsx)(J().A,{children:(0,N.jsx)(vo,{collectionContextStore:t,collectionSettingsStore:o})}),(0,N.jsxs)(J().A,{topBorder:!0,children:[(0,N.jsx)(Co,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(Le().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(jo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(fo,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(yo,{collectionContextStore:t,collectionSettingsStore:o}),u?(0,N.jsx)(ho,{collectionContextStore:t,collectionSettingsStore:o}):null]}),(0,N.jsxs)(J().A,{topBorder:!0,children:[!g&&(0,N.jsx)(Ne().A,{collectionContextStore:t,collectionSettingsStore:o}),!g&&(0,N.jsx)(Ee().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(X().A,{icon:y().e,title:d.formatMessage(he().u.hide),showChevron:!1,onClick:()=>{Ce().default.state.currentSpaceViewStore&&B().WO({environment:c,currentSpaceViewStore:Ce().default.state.currentSpaceViewStore,...m})}}),g&&(0,N.jsx)(_o,{collectionContextStore:t})]})]})}function Bo(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,l().IS)((()=>({container:{minWidth:Be().vE}})),[]);return(0,N.jsx)("div",{style:n.container,children:(0,N.jsxs)(J().A,{topBorder:!0,children:[(0,N.jsx)(Le().A,{collectionContextStore:t,collectionSettingsStore:o}),(0,N.jsx)(jo,{collectionContextStore:t,collectionSettingsStore:o})]})})}function Vo(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const l=(0,i().v3)(),a=(0,r().K8)((()=>co(t)),[t]),c=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),d=(0,n.useCallback)((()=>{if(!c)return;const e=(0,de().Ay)({store:c,fullyQualified:!1,pageVisitSource:s().y8.Expand,demoSettingsStore:we().A});(0,T().p)(l,{view_type:a}),P().os({collectionSettingsStore:o}),V().oo({environment:l,url:e})}),[c,l,a,o]),p=(0,r().O$)(t.isFullScreenStore),g=(0,r().K8)((()=>c&&"view"===je().A.getMode(l,c).permission),[l,c]);return p||g?null:(0,N.jsx)(J().A,{children:(0,N.jsx)(X().A,{icon:u().arrowExpandDiagonalBottomLeftToTopRightIcon,title:(0,N.jsx)(j().sA,{...Qt().D.openFullscreenButton}),onClick:d})})}const Fo={databaseSettings:{defaultMessage:"Database settings",id:"database.viewSettings.mainTab.databaseSectionTitle",description:"Title of the database-related section of the collection settings menu."},dataSourceSettings:{defaultMessage:"Data source settings",id:"database.viewSettings.mainTab.dataSourceSectionTitle",description:"Title of the data source-related section of the collection settings menu."},formSettings:{defaultMessage:"Form settings",id:"database.viewSettings.formTab.title",description:"Title of the form-related section of the collection settings menu."},viewSettings:{defaultMessage:"View settings",id:"database.viewSettings.mainTab.viewSectionTitle",description:"Title of the view-related section of the collection settings menu."},mobileSettings:{defaultMessage:"Settings",id:"database.viewSettings.mainTab.mobileTitle",description:"Title of the mobile version of the main collection settings menu."}}},409198:(e,t,o)=>{o.r(t),o.d(t,{ChartSettingsMain:()=>j().X,CollectionEditButtonAutomationOption:()=>X,CollectionSettings:()=>n()._,CollectionSettingsButtonOptions:()=>b,CollectionSettingsPropertyTypeMenuItem:()=>q});var n=()=>o(578565),i=o(296540),r=()=>o(56366),l=()=>o(912720),s=()=>o(959013),a=()=>o(246826),c=()=>o(813297),d=()=>o(390518),u=()=>o(546461),p=()=>o(911724),g=()=>o(840094),m=()=>o(845715),S=()=>o(633904),f=()=>o(419357),y=()=>o(89924),h=()=>o(972435),x=()=>o(735695),v=o(474848);const C=(0,s().YK)({inputPlaceholder:{defaultMessage:"Type a name for this button...",id:"database.buttonProperty.label.inputPlaceholder"}});function b(e){const{collectionContextStore:t,propertySchema:o}=e,n=(0,r().K8)((()=>t.collectionStore()),[t]),s=(0,r().K8)((()=>null==n?void 0:n.getSpaceId()),[n]),a=(0,i.useMemo)((()=>{const e=o.automation_id;if(e&&s)return{id:e,spaceId:s,table:l().yB}}),[o.automation_id,s]);return(0,m().K)(n,a)?(0,v.jsx)(w,{...e}):(0,v.jsx)(d().A,{})}function w(e){const{collectionContextStore:t,propertySchema:o,propertyId:n}=e,[l,d]=(0,i.useState)([]),m=(0,r().O$)(t.permissionScopesStore),b=(0,r().K8)((()=>t.collectionStore()),[t]),w=(0,r().K8)((()=>null==b?void 0:b.getSpaceId()),[b]),{maybePersistedAutomationStore:j,maybePersistedTransactionActions:A}=(0,S().t)({automationId:o.automation_id,spaceId:w,defaultValue:void 0,persist:!0}),_=(0,r().K8)((()=>null==j?void 0:j.getTrigger()),[j]),I=(0,g().Qj)({automationStore:j,propertyId:n,propertySchema:o,collectionContextStore:t}),M=(0,r().K8)((()=>{var e;return"sufficient"===(null==I||null===(e=I.state)||void 0===e?void 0:e.executionPermissionStatus)}),[I]),k=(0,r().K8)((()=>(null==j?void 0:j.getNameStore().getValue())??""),[j]),T=(0,i.useCallback)((e=>{if(!j)return;const t=e.currentTarget.value;A.createAndCommit({userAction:"CollectionSettingsButtonOptions.setName",perform:e=>{a().KY({store:j.getNameStore(),transaction:e,value:t})}})}),[j,A]),P=(0,i.useCallback)((e=>{d((t=>[...t,e.id]))}),[]);return b&&j&&_&&"button"===_.type?(0,v.jsx)(u().u,{automationStore:j,contextType:"button_property",children:(0,v.jsxs)(p().v,{value:{collectionStore:b,disabled:!M,editorPlacement:{type:"inline"},editorWidth:x().vE,maybePersistedTransactionActions:A,onActionAdded:P,suppressActionErrors:l,hideDragHandle:!1},children:[(0,v.jsx)(y().A,{topBorder:!0,title:(0,v.jsx)(s().sA,{id:"database.buttonProperty.label",defaultMessage:"Label"}),children:(0,v.jsx)(f().Ay,{disabled:!m.canConfigureCollection,placeholder:h().A.formatMessage(C.inputPlaceholder),value:k,onChange:T})}),(0,v.jsx)(y().A,{style:{paddingInline:12},children:(0,v.jsx)(c().U3,{areActionsEditable:!0,areTriggersEditable:!1})})]})}):null}var j=()=>o(487605),A=()=>o(484714),_=()=>o(401497),I=()=>o(970013),M=()=>o(713998),k=()=>o(743176),T=()=>o(3284),P=()=>o(338862),B=()=>o(284371),V=()=>o(901952),F=()=>o(235191),E=()=>o(686526),R=()=>o(36629),D=()=>o(181922),K=()=>o(751156),O=()=>o(895876),L=()=>o(8980),z=()=>o(187820),N=()=>o(16006),U=()=>o(132389),W=()=>o(859428),H=()=>o(852353),$=()=>o(963589),G=()=>o(962730),Q=()=>o(939656),Z=()=>o(497222);function q(e){const{collectionContextStore:t,collectionUri:o,disabled:n,formatKey:l,isTypedProperty:a,property:c,propertyTypeButtonPopupStore:d}=e,u=(0,A().v3)(),p=(0,$().X)("nds_default_property_noticon"),g=(0,_().DP)(),m=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),S=(0,r().K8)((()=>(0,Q().Jq)({property:c,collectionContextStore:t})),[t,c]),f=(0,r().K8)((()=>(0,Q().k7)(m,S)),[m,S]),y=(0,r().K8)((()=>null==f?void 0:f.getIcon()),[f]),h=t.settingsStore,x=(0,i.useCallback)((e=>{const o=t.collectionStore();o&&((0,V().V)({environment:u,collectionContextStore:t,property:c,new_property_type:(0,I().v2)(e),from:"view_settings",action:"change_type"}),"relation"===e?E().a2({collectionSettingsStore:h,item:{type:"selectRelationSource",property:c,formatKey:l}}):(K().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:u,canUndo:!0,perform:t=>{F().Hj({environment:u,collectionStore:o,property:c,type:e,transaction:t})}}),E().yl({collectionSettingsStore:h}),(0,I().hN)(e)&&R().pG({propertyType:e,propertyId:c,collectionContextStore:t}),d.reset()))}),[t,h,u,l,c,d]),C=(0,i.useCallback)((e=>{const{propertyType:o}=e;D().g({environment:u,collectionContextStore:t,propertyId:c,propertySchema:S,handlePropertyTypeChange:()=>x(o)})}),[u,c,S,x,t]),b=(0,i.useCallback)((()=>{if(!S)return;t.collectionStore()&&E().a2({collectionSettingsStore:h,item:{type:"propertyType",propertySchema:S,onAccept:C}})}),[t,h,C,S]),w=(0,M().H6)(S)||(0,M().KF)(S),j=(0,_().IS)((e=>({container:{color:n?e.darkTextColor:void 0,display:"flex",alignItems:"center"},title:{display:"inline",wordBreak:"break-word",...B().RC},typeText:{color:n?e.darkTextColor:void 0}})),[n]),q=(0,i.useCallback)((e=>S?a&&o?(0,v.jsx)(s().sA,{...e,defaultMessage:"{type} type is required for this property in {databaseType}.",id:"database.viewSettings.propertyTab.restrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property.",values:{type:H().dC[S.type],databaseType:(0,O()._V)(o)}}):(0,v.jsx)(s().sA,{...e,defaultMessage:"This property’s type cannot be changed.",id:"database.viewSettings.propertyTab.untypedRestrictedProperty",description:"A tooltip to educate the users on why they can't change the type of this property."}):null),[o,a,S]);return S?(0,v.jsx)(W().A,{placement:G().W.Left,disableTooltip:!n,renderTooltip:q,render:e=>(0,v.jsx)(Z().A,{...e,disabled:n,rotateChevron:d.state.open,icon:T().arrowSquarePathUpDownIcon,title:(0,v.jsx)(s().sA,{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"}),showChevron:!0,right:(0,v.jsxs)(v.Fragment,{children:[n?(0,v.jsx)("div",{...e,children:(0,v.jsx)(L().I,{icon:P().N,size:"sm",color:"secondary"})}):p?void 0:(0,v.jsx)(k().zB,{type:S.type,icon:void 0,size:16,theme:g}),(0,v.jsx)(U().A,{size:4}),w?(0,v.jsxs)("div",{style:j.container,children:[(0,v.jsx)(z().B6,{icon:y,iconRecordCategory:"collection",isEmptyPage:!1,size:20,disabled:!0}),(0,v.jsx)(N().A,{store:f,style:j.title})]}):(0,v.jsx)("span",{style:j.typeText,children:H().dC[S.type]})]}),onClick:b})}):null}var Y=()=>o(105819),J=()=>o(837570);function X(e){const{collectionSettingsStore:t,collectionContextStore:o,property:n,source:i}=e,l=(0,A().v3)(),a=(0,r().K8)((()=>(0,Q().Jq)({collectionContextStore:o,property:n})),[o,n]);return(0,v.jsx)(Z().A,{title:(0,v.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,v.jsx)(s().sA,{id:"database.collectionsettings.button.editAutomationLabel",defaultMessage:"Edit automation"})}),disabled:!1,source:i,showChevron:!0,icon:Y().pencilLineIcon,onClick:()=>{a&&"button"===a.type&&J().h({environment:l,mode:"edit_button_property",collectionSettingsStore:t,collectionContextStore:o,propertyId:n,propertySchema:a})}})}},444091:(e,t,o)=>{o.d(t,{A:()=>te,a:()=>ee});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(401497),s=()=>o(187174),a=()=>o(513416),c=()=>o(738418),d=()=>o(381138),u=()=>o(84262),p=()=>o(462853),g=()=>o(959013),m=()=>o(381349),S=()=>o(778078),f=()=>o(534177),y=()=>o(939768),h=()=>o(559926),x=()=>o(449506),v=()=>o(884107),C=()=>o(686526),b=()=>o(901389),w=()=>o(633457),j=()=>o(56394),A=()=>o(760217),_=()=>o(419357),I=()=>o(331542),M=()=>o(939740),k=()=>o(204063),T=()=>o(2143),P=()=>o(89924),B=()=>o(859428),V=()=>o(572088),F=()=>o(476492),E=()=>o(972435),R=()=>o(553965),D=()=>o(817126),K=()=>o(962730),O=()=>o(756279),L=()=>o(765957),z=()=>o(53137),N=()=>o(284371),U=()=>o(125565),W=o(474848);function H(e){const{onClick:t,integration:o,accountName:n}=e,i=(0,l().IS)((e=>({accountSelection:{padding:"8px",borderTop:`1px solid ${e.regularDividerColor}`,cursor:"pointer"},accountSelectionLabel:{fontWeight:N().Wy.medium,paddingLeft:4,paddingTop:4}})),[]);return(0,W.jsx)("div",{style:i.accountSelection,children:(0,W.jsxs)("div",{onClick:t,children:[(0,W.jsx)(U().A,{isSecondaryColor:!0,isSmall:!0,style:i.accountSelectionLabel,children:(0,W.jsx)(g().sA,{id:"collectionSettingsCreateExternalViewPicker.currentAccountSection.label",defaultMessage:"Connected to {integration}",values:{integration:o.name}})}),(0,W.jsx)(B().A,{renderTooltip:()=>(0,W.jsx)("span",{children:n}),placement:K().W.Left,textWrap:!0,render:t=>(0,W.jsx)(A().A,{showExtensionArrow:!0,focused:!1,...(0,R().A)(t||{},e),title:n,icon:(0,W.jsx)("img",{style:{width:18},src:o.info.icon})})})]})})}var $=()=>o(14959),G=()=>o(510683),Q=()=>o(493823),Z=()=>o(187820),q=()=>o(47170),Y=()=>o(444768),J=()=>o(735695);function X(e){const{collectionContextStore:t,integration:o}=e,n=(0,l().DP)(),s=(0,r().K8)((()=>t.collectionStore()),[t]),a=(0,r().K8)((()=>null==s?void 0:s.getIcon()),[s]),c=(0,i().v3)(),d=(0,q().O)(),u=(0,l().IS)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},authenticationBody:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:"0px 16px 16px 16px",textAlign:"center"},settingsMenuSubHeading:{display:"inline",fontSize:14,margin:"4px 20px 20px 20px",color:e.text.secondary,textAlign:"center"},settingsMenuAuthenticationButton:{fontSize:14,height:32,color:e.text.contrastPrimary}})),[]),{background:p,hoveredBackground:m,pressedBackground:S}=(0,$().u)(o,n.mode);return(0,W.jsx)(J().Ay,{...e,title:(0,W.jsx)(g().sA,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateHeader.title",values:{integration:o.name}}),children:(0,W.jsx)("div",{style:u.settingsMenu,children:(0,W.jsxs)("div",{style:u.authenticationBody,children:[(0,W.jsx)(Z().B6,{disabled:!0,bucket:"secure",store:s,icon:a,iconRecordCategory:"collection",size:40,isEmptyPage:!1,style:{marginBottom:6}}),(0,W.jsx)("div",{style:u.settingsMenuSubHeading,children:(0,W.jsx)(g().sA,{defaultMessage:"Link your {integration} account for richer content previews and seamless imports.",id:"collectionSettingsCreateExternalViewPicker.authenticateBody.title",values:{integration:o.name}})}),(0,W.jsx)(Q().p,{onClick:()=>{d&&(G().Jq({environment:c,integration:o,spaceId:d,from:"placeholder_root_external_collection_view_block"}),Y().A.reset())},style:{background:p,...u.settingsMenuAuthenticationButton},hoveredStyle:{background:m},pressedStyle:{background:S},children:(0,W.jsx)(g().sA,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateButton.title",values:{integration:o.name}})})]})})})}function ee(e){const{collectionSettingsStore:t,collectionContextStore:o,externalAuthentication:n}=e,i=(0,r().K8)((()=>o.collectionStore()),[o]),l=(0,r().K8)((()=>{if(!i)return;const e=i.getFormat().integration_id;return z().A.integrations.state.find((t=>t.id===e))}),[i]),s=(0,r().K8)((()=>!!l&&(0,V().jw)(l.id).length>0),[l]),a=(0,r().K8)((()=>{var e;return null===(e=L().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]);if(!l)return null;if(!i)return null;if(!a)return null;const c=s?(0,W.jsx)(ie,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:l,externalAuthentication:n}):(0,W.jsx)(X,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:l}),d=(0,p().l)(null==l?void 0:l.id);return d?(0,W.jsx)(te,{featureName:d,children:c}):c}function te(e){const{children:t,featureName:o}=e,n=(0,D().G9)({featureName:o});return(0,u().e2)(n)?t:null}function oe(e){var t;return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.collection})).find((t=>{let{regex:o}=t;return new RegExp(o).test(e.url)}))}const ne=(0,g().YK)({all:{id:"collectionSettingsCreateExternalViewPicker.filters.all",defaultMessage:"All"},issues:{id:"collectionSettingsCreateExternalViewPicker.filters.issues",defaultMessage:"Issues"},pull_requests:{id:"collectionSettingsCreateExternalViewPicker.filters.pullRequests",defaultMessage:"Pull Requests"},board:{id:"collectionSettingsCreateExternalViewPicker.filters.boards",defaultMessage:"Boards"},project:{id:"collectionSettingsCreateExternalViewPicker.filters.projects",defaultMessage:"Projects"},Releases:{id:"collectionSettingsCreateExternalViewPicker.filters.releases",defaultMessage:"Releases"},"Pull Request":{id:"collectionSettingsCreateExternalViewPicker.filters.PullRequests",defaultMessage:"Pull Requests"},Issues:{id:"collectionSettingsCreateExternalViewPicker.filters.Issues",defaultMessage:"Issues"}});function ie(e){const{integration:t,collectionContextStore:o,collectionSettingsStore:u,externalAuthentication:p}=e,[D,L]=(0,n.useState)(""),N=(0,r().K8)((()=>{const e=z().A.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]),U=(0,r().K8)((()=>p||(N.length?N[0]:null)),[N,p]),[$,G]=(0,n.useState)(!1),[Q,Z]=(0,n.useState)(null),q=(0,l().IS)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},syncSourceButton:{width:"100%",display:"flex",justifyContent:"center"},noResults:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.text.secondary},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:m().Ay.white,background:m().Ay.blue,borderRadius:6,padding:10,boxShadow:e.shadowMD,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},syncingData:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.text.secondary},filterContainer:{position:"relative",flexGrow:0,overflow:"hidden"},filterContainerScroller:{display:"flex",alignItems:"center",padding:"8px 12px"}})),[]),Y=(0,r().K8)((()=>o.collectionStore()),[o]),ee=(0,r().K8)((()=>o.collectionViewBlockStore()),[o]),te=(0,i().v3)(),[{value:ie,status:re}]=(0,s().Yb)((async()=>{if(!U)return;const e=U.parent_id;return x().callApi({eventName:"listExternalCollections",environment:te,data:{bot_id:e}})}),[te,U]),le="success"===(null==ie?void 0:ie.type)&&"data"in ie.data?ie.data.data:[],se="success"===(null==ie?void 0:ie.type)&&"error"in ie.data?ie.data.error:null,ae=le.filter((e=>!Q||e.type===Q)),ce=ae.length?(0,S().Ay)(D,ae,(e=>e.title)):[],de=Array.from(new Set(le.map((e=>e.type)))),ue=oe({integration:t,url:D}),pe=async e=>{if(G(!0),!Y||!ee)return;const n=e||D,i=oe({integration:t,url:n});if(!i)return G(!1),void b().ui({items:[{label:(0,W.jsx)(g().sA,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:async()=>{const e=await v().R.clipboardActions.load();e.copyString({environment:te,stringValue:JSON.stringify({botId:null==U?void 0:U.parent_id,url:n},null,2),copiedMessage:e.clipboardMessages.copiedToClipboard})}},{label:(0,W.jsx)(g().sA,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:(0,W.jsx)(g().sA,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const r=(0,V().jw)(t.id);await w().jW({environment:te,url:n,botIds:r.map((e=>e.id)),externalCollectionStore:Y,externalCollectionViewBlockStore:ee,integrationId:t.id});const{host:l}=(0,y().qg)(n);h().lR(te,{...(0,F().sl)(o),integrationId:t.id,type:"collection",entity:i.name,domain:l||"",from:"external_picker_settings"}),C().R8({collectionSettingsStore:u,item:{type:"shareSyncedView",integrationName:t.name,integrationIcon:t.info.icon}}),G(!1)};if(!Y||!ee)return null;const ge=de.length>1?(0,W.jsx)("div",{style:q.filterContainer,children:(0,W.jsxs)(T().H,{type:O().A.X,style:q.filterContainerScroller,children:[(0,W.jsx)(j().A,{title:(0,W.jsx)("span",{children:E().A.formatMessage(ne.all)}),on:!(0,f().Pe)(Q),hideChevron:!0,onClick:()=>{Z(null)}},"all"),de.map((e=>(0,W.jsx)(j().A,{title:(0,W.jsx)("span",{children:E().A.formatMessage(ne[e])}),on:Q===e,hideChevron:!0,onClick:()=>{Z((t=>t===e?null:e))}},e)))]})}):null,me=ue?(0,W.jsx)("div",{style:q.syncSourceButton,children:(0,W.jsx)(k().A,{size:"lg",onClick:()=>{pe()},disabled:!1,children:(0,W.jsx)(g().sA,{id:"collectionSettingsCreateExternalViewPicker.syncSourceButton.label",defaultMessage:"Sync Source"})})}):null,Se=ue||le.length&&ce.length?null:(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("div",{style:q.noResults,children:(0,W.jsx)(g().sA,{id:"collectionSettingsCreateExternalViewPicker.noResults.text",defaultMessage:"No results"})}),(0,W.jsxs)("div",{style:q.suggestionBox,children:[(0,c().G)({marginRight:8,width:14,height:14}),(0,W.jsx)(g().sA,{defaultMessage:"Try different search or paste any {integration} URL",id:"collectionSettingsCreateExternalViewPicker.noResults.help",values:{integration:t.name}})]})]}),fe=le.length&&ce.length?(0,W.jsx)(M().Ay,{type:M().Oh.Vertical,initialFocus:0,sections:[{key:"collections",items:ce.map((e=>{const t={key:e.url,render:t=>(0,W.jsx)(B().A,{renderTooltip:()=>(0,W.jsx)("span",{children:e.title}),placement:K().W.Left,textWrap:!0,render:o=>(0,W.jsx)(A().A,{...(0,R().A)(o||{},t),title:e.title,icon:(0,W.jsx)("img",{style:{width:18},src:e.icon}),caption:e.parent.title})}),action:t=>{"stopPropagation"in t.event&&t.event.stopPropagation(),pe(e.url)}};return t})),render:e=>(0,W.jsx)(P().A,{...e,disableMobilePadding:!0})}]}):null,ye="pending"===re||"idle"===re||$;if(!U||se&&(se.status===a().nG.UNAUTHORIZED||se.status===a().nG.FORBIDDEN))return(0,W.jsx)(X,{collectionContextStore:o,collectionSettingsStore:u,integration:t});const he="rejected"===re||"failed"===(null==ie?void 0:ie.type)||se,xe=(0,W.jsx)(H,{onClick:()=>{C().a2({collectionSettingsStore:u,item:{type:"selectAccountForExternalSource",integration:t,onAccountSelect:e=>{C().a2({collectionSettingsStore:u,item:{type:"createSyncedViewSource",externalAuthentication:e}})}}})},integration:t,accountName:U.account_name});return(0,W.jsx)(J().Ay,{...e,footer:me||$?null:xe,title:(0,W.jsx)(g().sA,{defaultMessage:"Select from {integration}",id:"collectionSettingsCreateExternalViewPicker.title",values:{integration:t.name}}),header:!ye&&"resolved"===re&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(_().Ay,{inputLeft:(0,W.jsx)(_().Zf,{icon:d().q}),onSubmit:()=>{ue&&pe()},style:q.settingsMenuSearchBox,focusInitial:!0,value:D,onChange:e=>{L(e.target.value)},placeholder:"Search source or paste a link..."}),ue?null:ge]}),children:(0,W.jsxs)("div",{style:q.settingsMenu,children:[he&&(0,W.jsx)("div",{style:q.errorMessage,children:(0,W.jsx)(g().sA,{id:"collectionSettingsCreateExternalViewPicker.error.unknown",defaultMessage:"Something went wrong.",values:{integration:t.name}})}),ye&&($?(0,W.jsxs)("div",{style:q.syncingData,children:[(0,W.jsx)("span",{children:(0,W.jsx)(g().sA,{id:"collectionSettingsCreateExternalViewPicker.settingUpSync",defaultMessage:"Setting up sync..."})}),(0,W.jsx)(I().A,{style:{alignSelf:"center"}})]}):(0,W.jsxs)("div",{style:q.syncingData,children:[(0,W.jsx)("span",{children:(0,W.jsx)(g().sA,{id:"collectionSettingsCreateExternalViewPicker.loadingData",defaultMessage:"Loading available sources..."})}),(0,W.jsx)(I().A,{style:{alignSelf:"center"}})]})),!ye&&"resolved"===re&&(0,W.jsxs)(W.Fragment,{children:[me,Se,fe]})]})})}},446966:(e,t,o)=>{o.d(t,{E:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.16 3.72 15.57 12.55",svg:(0,o(474848).jsx)("path",{d:"M9.5 9.374a.625.625 0 1 0 0 1.25h7.6a.625.625 0 1 0 0-1.25zm-2-5a.625.625 0 1 0 0 1.25H17a.625.625 0 1 0 0-1.25zM10.876 15c0-.346.28-.626.625-.626h5.6a.625.625 0 1 1 0 1.25h-5.6a.625.625 0 0 1-.625-.625M2.215 4.263c-.148-.237.035-.535.33-.535h2.287c.294 0 .477.298.33.535L4.016 6.094a.395.395 0 0 1-.658 0zm2.329 4.465c-.294 0-.477.298-.329.535l1.144 1.831a.395.395 0 0 0 .658 0l1.144-1.831c.148-.237-.035-.535-.329-.535zm1.671 5.535c-.148-.237.035-.535.33-.535h2.287c.294 0 .477.298.33.535l-1.145 1.831a.395.395 0 0 1-.658 0z"})},i=(0,o(340498).wt)("listToggleIndent",n)},448701:(e,t,o)=>{o.d(t,{R:()=>g,z:()=>m});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(90907),l=()=>o(701751),s=()=>o(436696),a=()=>o(222299),c=()=>o(525432),d=()=>o(497222),u=o(474848);function p(e){let{collectionContextStore:t}=e;const o=t.collectionViewBlockStore();if(void 0!==t.viewsModuleContextStore.state||!o)return!1;const n=null==o?void 0:o.getCollectionViewSourceCollectionStore();return n?n.canEditCollection():null==o?void 0:o.canEditCollection()}function g(e){let{collectionContextStore:t}=e;if((0,i().K8)((()=>p({collectionContextStore:t})),[t]))return(0,u.jsx)(m,{collectionContextStore:t})}function m(e){let{collectionContextStore:t}=e;const o=(0,n().v3)(),g=(0,i().K8)((()=>t.collectionViewBlockStore()),[t]),m=(0,i().K8)((()=>null==g?void 0:g.isLocked()),[g]),S=(0,i().K8)((()=>p({collectionContextStore:t})),[t]),f=(0,i().K8)((()=>null==g?void 0:g.isCollectionViewPageWithContent()),[g]),y=(0,i().K8)((()=>0===((null==g?void 0:g.getOwnedCollectionStores())??[]).length),[g]);return g&&S?(0,u.jsx)(d().A,{icon:m?l().p:r().h,title:(0,c().VM)({hasOnlyLinkedDataSources:y,isCollectionViewPageWithContent:f,locked:m}),onClick:()=>function(e,t){const o=t.collectionViewBlockStore();if(!o)return;a().X6({environment:e,store:o,lock:!o.isLocked()}),(0,s().X)({environment:e,collectionContextStore:t,action:"click_toggle_lock"})}(o,t)}):null}},455338:(e,t,o)=>{o.d(t,{G:()=>s,t:()=>a});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(581454);var n=o.n(o(844751)),i=(o(296540),()=>o(959013)),r=()=>o(436572),l=o(474848);function s(e,t){const o=new Map,i=t.map((e=>{const t=[e.name,e.description].join(" ");return o.set(e.name,t),t})),r=new Set(n().filter(e,i).map((e=>{let{original:t}=e;return t})));return t.filter((e=>{const t=o.get(e.name);return t&&r.has(t)}))}function a(e){const{featureName:t}=e;r().D6({label:(0,l.jsx)(i().sA,{id:"database.viewSettings.customizeMenu.successToastAfterFeatureAddition",defaultMessage:"Added {featureName} to this database.",values:{featureName:t}})})}},478573:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(296540),i=()=>o(21140),r=o(474848);const l=n.forwardRef(((e,t)=>{const{icon:n,name:l,subText:s,disabled:a,...c}=e,d=(0,o(401497).IS)((e=>({iconContainer:{background:"light"===e.mode?e.white:e.palette.translucentGray[100],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.mode?e.palette.gray[100]:e.palette.translucentGray[300],minWidth:32,width:32,height:32,borderRadius:4,overflow:"hidden"},buttonMenuItem:{padding:6},subText:{color:e.text.tertiary,fontSize:12}})),[]);return(0,r.jsx)(o(760217).A,{...c,disabled:a,disabledFeedback:a,buttonStyle:{margin:0,width:"100%"},style:d.buttonMenuItem,itemMarginLeft:0,ref:t,title:(0,r.jsxs)(i().Ye,{gap:8,alignItems:"center",children:[(0,r.jsx)(i().Ye,{style:d.iconContainer,alignItems:"center",justifyContent:"center",children:n}),(0,r.jsxs)(i().wt,{children:[(0,r.jsx)("span",{children:l}),s?(0,r.jsx)("span",{style:d.subText,children:s}):null]})]})})}));l.displayName="AddPageLayoutModuleMenuButton"},479e3:(e,t,o)=>{o.d(t,{lP:()=>_,IB:()=>b,EK:()=>A,NS:()=>w,GD:()=>j,$F:()=>I});var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(401497),s=o(474848);const a={viewBox:"0 0 20 20",fittedViewBox:"2.12 3.02 15.83 14.41",svg:(0,s.jsx)("path",{d:"M7.663 5.794a2.77 2.77 0 1 1-5.539 0 2.77 2.77 0 0 1 5.539 0m-1.25 0a1.52 1.52 0 1 0-3.039 0 1.52 1.52 0 0 0 3.039 0m2.497-.55a.55.55 0 0 0 0 1.1h.098a.55.55 0 1 0 0-1.1zm2.054 0a.55.55 0 1 0 0 1.1h.098a.55.55 0 0 0 0-1.1zm2.602 4.328a.55.55 0 0 0-.952-.55l-.049.083a.55.55 0 0 0 .952.552zm-6.208-.551a.55.55 0 0 0-.952.551l.049.085a.55.55 0 0 0 .952-.552zm5.182 2.324a.55.55 0 0 0-.952-.552l-.05.085a.55.55 0 1 0 .953.551zm-4.156-.552a.55.55 0 1 0-.951.552l.048.084a.55.55 0 1 0 .952-.551zm6.722-2.23a2.77 2.77 0 1 0 0-5.538 2.77 2.77 0 0 0 0 5.538m0-1.25a1.52 1.52 0 1 1 0-3.038 1.52 1.52 0 0 1 0 3.038m-2.336 7.343a2.77 2.77 0 1 1-5.54 0 2.77 2.77 0 0 1 5.54 0m-1.25 0a1.52 1.52 0 1 0-3.04 0 1.52 1.52 0 0 0 3.04 0"})},c=(0,o(340498).wt)("integration",a);var d=()=>o(167170),u=()=>o(920495),p=()=>o(582094),g=()=>o(959013),m=()=>o(686526),S=()=>o(497222),f=()=>o(404637),y=()=>o(89924),h=()=>o(963589),x=()=>o(447934),v=()=>o(400851),C=()=>o(184966);function b(e){const{collectionContextStore:t,collectionSettingsStore:o,showTopBorder:n,children:r}=e,a=(0,i().Y0)(),c=(0,l().IS)((()=>({header:{fontSize:a.isMobile?14:12},section:{marginBottom:6}})),[a]);return(0,s.jsxs)(y().A,{topBorder:n,title:(0,s.jsx)("div",{style:c.header,children:(0,s.jsx)(g().sA,{id:"database.viewSettings.customizeMenu.advanced.title",defaultMessage:"Advanced"})}),style:c.section,children:[(0,s.jsx)(f().GS,{collectionContextStore:t,collectionSettingsStore:o}),(0,s.jsx)(_,{collectionContextStore:t,collectionSettingsStore:o}),(0,s.jsx)(w,{collectionContextStore:t}),(0,s.jsx)(j,{collectionContextStore:t}),(0,s.jsx)(A,{collectionContextStore:t}),!1,r]})}function w(e){let{collectionContextStore:t,menuListItemProps:o}=e;const n=(0,i().v3)(),l=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),a=I({collectionContextStore:t,from:"customize_database_button_in_customize_menu"}),c=(0,v().X)({environment:n,blockStore:l,from:"collectionSettingsMenu"});return l&&c?(0,s.jsx)(S().A,{icon:d()._,onClick:a,showChevron:!0,title:(0,s.jsx)(g().sA,{defaultMessage:"Customize page layout",id:"database.viewSettings.customizeMenu.customizeLayout"}),menuListItemProps:o}):null}function j(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),l=(0,h().X)("posts_generic_db_publishing"),a=(0,r().K8)((()=>t.collectionStore()),[t]),c=(0,r().K8)((()=>null==a?void 0:a.isPublishingEnabled()),[a]),d=(0,n.useCallback)((()=>{a&&C().TM({environment:o,collectionStore:a,publishingEnabled:!c})}),[o,a,c]);return a&&l?(0,s.jsx)(S().A,{icon:u().pageIcon,onClick:d,title:c?(0,s.jsx)(g().sA,{defaultMessage:"Disable publishing",id:"database.viewSettings.customizeMenu.disablePublishing"}):(0,s.jsx)(g().sA,{defaultMessage:"Enable publishing",id:"database.viewSettings.customizeMenu.enablePublishing"})}):null}function A(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),l=(0,h().X)("posts_generic_db_publishing"),a=(0,r().K8)((()=>t.collectionStore()),[t]),c=(0,r().K8)((()=>{var e;return(null==a||null===(e=a.getFormat())||void 0===e?void 0:e.following_enabled)??!1}),[a]),d=(0,r().K8)((()=>null==a?void 0:a.isPublishingEnabled()),[a]),u=(0,n.useCallback)((()=>{a&&C().H2({environment:o,collectionStore:a,followingEnabled:!c})}),[o,a,c]);return a&&l?(0,s.jsx)(S().A,{icon:p().personCropCircleBadgePlusIcon,onClick:u,disabled:!d,title:c?(0,s.jsx)(g().sA,{defaultMessage:"Disable following",id:"database.viewSettings.customizeMenu.disableFollowing"}):(0,s.jsx)(g().sA,{defaultMessage:"Enable following",id:"database.viewSettings.customizeMenu.enableFollowing"})}):null}function _(e){const{collectionSettingsStore:t,menuListItemProps:o}=e;return(0,s.jsx)(S().A,{icon:c,onClick:()=>m().a2({collectionSettingsStore:t,item:{type:"connectionFeatures"}}),showChevron:!0,title:(0,s.jsx)(g().sA,{defaultMessage:"Connections",id:"database.viewSettings.customizeMenu.connections.title"}),menuListItemProps:o})}function I(e){let{collectionContextStore:t,from:o}=e;const r=(0,i().v3)();return(0,n.useCallback)((()=>{const e=t.collectionStore(),n=t.collectionViewBlockStore();n&&e&&(0,x().nh)({environment:r,blockStore:n,collectionStore:e,collectionViewStore:t.collectionViewStore(),from:o})}),[t,r,o])}},487605:(e,t,o)=>{o.d(t,{X:()=>Vo});var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(401497),s=()=>o(282339),a=()=>o(901610),c=()=>o(566910),d=()=>o(959013),u=()=>o(89924),p=()=>o(175116),g=()=>o(765957),m=()=>o(322638),S=(o(16280),o(581454),()=>o(804773)),f=()=>o(340498),y=o(474848);const h=(0,f().wt)("collectionChartDonutSelected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M12.75 3.03079C17.1223 3.39148 20.6085 6.87768 20.9692 11.25H18.4069C18.0637 8.28709 15.7129 5.93628 12.75 5.59314V3.03079Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),x=(0,f().wt)("collectionChartDonutSelectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M22.328 13.902A2.049 2.049 0 0121.7 14h-.923a8.978 8.978 0 01-2.283 4.23A9 9 0 1110 3.223v-.922c0-.22.034-.43.098-.628C5.207 2.567 1.5 6.85 1.5 12c0 5.799 4.701 10.5 10.5 10.5 2.978 0 5.667-1.24 7.577-3.23a10.475 10.475 0 002.751-5.368z"}),(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M10 5.866A6.45 6.45 0 1018.134 14h-.384c-.406 0-.78-.116-1.094-.315A4.953 4.953 0 0112 16.95a4.95 4.95 0 01-1.685-9.606A2.034 2.034 0 0110 6.25v-.384z"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M12.75 3.03a9.002 9.002 0 018.22 8.22h-2.563a6.453 6.453 0 00-5.657-5.657V3.031z"}),(0,y.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M20.97 11.25a9.002 9.002 0 00-8.22-8.22v2.563a6.453 6.453 0 015.657 5.657h2.562zm1.53.696a.8.8 0 01-.8.804h-3.95a.8.8 0 01-.8-.794 4.95 4.95 0 00-4.906-4.906.8.8 0 01-.794-.8V2.3a.8.8 0 01.804-.8c5.756.03 10.417 4.69 10.446 10.446z",clipRule:"evenodd"})]})}),v=(0,f().wt)("collectionChartDonutUnselected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{d:"M22.328 13.9022C22.1304 13.9657 21.9195 14 21.7 14H20.7771C20.4098 15.6195 19.6057 17.0728 18.4945 18.2307C16.8557 19.9384 14.5524 21 12 21C7.02944 21 3 16.9706 3 12C3 7.71682 5.99202 4.13247 10 3.22301V2.29999C10 2.08048 10.0343 1.86948 10.0978 1.67186C5.2069 2.56685 1.5 6.85052 1.5 12C1.5 17.799 6.20101 22.5 12 22.5C14.9776 22.5 17.6668 21.2596 19.5768 19.2693C20.9699 17.8176 21.9504 15.965 22.328 13.9022Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M10 5.86607C7.41679 6.70778 5.55 9.13588 5.55 12C5.55 15.5622 8.43776 18.45 12 18.45C13.7922 18.45 15.4148 17.7181 16.5829 16.5387C17.2814 15.8334 17.8186 14.9669 18.1337 14H17.75C17.3441 14 16.9702 13.8837 16.6561 13.6848C16.4095 14.3661 16.0175 14.9779 15.5171 15.4832C14.6192 16.3898 13.3757 16.95 12 16.95C9.26619 16.95 7.05 14.7338 7.05 12C7.05 9.85773 8.41088 8.03331 10.3153 7.34407C10.1163 7.02989 10 6.65601 10 6.24999V5.86607Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.9692 11.25C20.6085 6.87768 17.1223 3.39148 12.75 3.0308L12.75 5.59315C15.7129 5.93628 18.0637 8.28709 18.4069 11.25L20.9692 11.25ZM22.4999 11.9459C22.5021 12.3866 22.146 12.75 21.7 12.75L17.75 12.75C17.3019 12.75 16.9535 12.3866 16.9498 11.9562C16.9265 9.25722 14.7428 7.07349 12.0438 7.05019C11.6134 7.04647 11.25 6.69813 11.25 6.25L11.25 2.3C11.25 1.85404 11.6134 1.49791 12.0541 1.50013C17.8102 1.52919 22.4708 6.18979 22.4999 11.9459Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),C=(0,f().wt)("collectionChartDonutUnselectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M22.328 13.902A2.049 2.049 0 0121.7 14h-.923a8.978 8.978 0 01-2.283 4.23A9 9 0 1110 3.223v-.922c0-.22.034-.43.098-.628C5.207 2.567 1.5 6.85 1.5 12c0 5.799 4.701 10.5 10.5 10.5 2.978 0 5.667-1.24 7.577-3.23a10.475 10.475 0 002.751-5.368z"}),(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",d:"M10 5.866A6.45 6.45 0 1018.134 14h-.384c-.406 0-.78-.116-1.094-.315A4.953 4.953 0 0112 16.95a4.95 4.95 0 01-1.685-9.606A2.034 2.034 0 0110 6.25v-.384z"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M20.97 11.25a9.002 9.002 0 00-8.22-8.22v2.563a6.453 6.453 0 015.657 5.657h2.562zm1.53.696a.8.8 0 01-.8.804h-3.95a.8.8 0 01-.8-.794 4.95 4.95 0 00-4.906-4.906.8.8 0 01-.794-.8V2.3a.8.8 0 01.804-.8c5.756.03 10.417 4.69 10.446 10.446z",clipRule:"evenodd"})]})}),b=(0,f().wt)("collectionChartHorizontalBarSelected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M20.25 20H4.75V18H20.25V20Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),w=(0,f().wt)("collectionChartHorizontalBarSelectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M4.75 6h10.5V4H4.75v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h11.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795H4.045zM4.75 13h6.5v-2h-6.5v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h7.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795h-7.91z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M20.25 20H4.75v-2h15.5v2z"}),(0,y.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M4.75 20h15.5v-2H4.75v2zm-.7 1.5a.8.8 0 01-.8-.8v-3.4a.8.8 0 01.8-.8h16.9a.8.8 0 01.8.8v3.4a.8.8 0 01-.8.8H4.05z",clipRule:"evenodd"})]})}),j=(0,f().wt)("collectionChartHorizontalBarUnselected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6L15.25 6V4L4.75 4V6ZM4.045 7.5C3.60594 7.5 3.25 7.14407 3.25 6.705L3.25 3.295C3.25 2.85593 3.60593 2.5 4.045 2.5L15.955 2.5C16.3941 2.5 16.75 2.85593 16.75 3.295V6.705C16.75 7.14407 16.3941 7.5 15.955 7.5L4.045 7.5Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 13H11.25V11H4.75V13ZM4.045 14.5C3.60594 14.5 3.25 14.1441 3.25 13.705L3.25 10.295C3.25 9.85593 3.60593 9.5 4.045 9.5H11.955C12.3941 9.5 12.75 9.85593 12.75 10.295V13.705C12.75 14.1441 12.3941 14.5 11.955 14.5H4.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 20H20.25V18H4.75V20ZM4.05 21.5C3.60818 21.5 3.25 21.1418 3.25 20.7L3.25 17.3C3.25 16.8582 3.60817 16.5 4.05 16.5H20.95C21.3918 16.5 21.75 16.8582 21.75 17.3V20.7C21.75 21.1418 21.3918 21.5 20.95 21.5H4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),A=(0,f().wt)("collectionChartHorizontalBarUnselectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M4.75 6h10.5V4H4.75v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h11.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795H4.045zM4.75 13h6.5v-2h-6.5v2zm-.705 1.5a.795.795 0 01-.795-.795v-3.41c0-.44.356-.795.795-.795h7.91c.44 0 .795.356.795.795v3.41c0 .44-.356.795-.795.795h-7.91z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M4.75 20h15.5v-2H4.75v2zm-.7 1.5a.8.8 0 01-.8-.8v-3.4a.8.8 0 01.8-.8h16.9a.8.8 0 01.8.8v3.4a.8.8 0 01-.8.8H4.05z",clipRule:"evenodd"})]})}),_=(0,f().wt)("collectionChartLineSelected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02037 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),I=(0,f().wt)("collectionChartLineSelectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.25 1.35A.75.75 0 013 2.1V21h18.9a.75.75 0 010 1.5H2.4a.9.9 0 01-.9-.9V2.1a.75.75 0 01.75-.75z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M20.282 8.822c-.29.572-.704 1.323-1.209 2.05-.51.734-1.086 1.408-1.69 1.86-.603.45-1.155.624-1.666.532-.678-.122-.993-.645-1.49-1.626l-.043-.085c-.426-.846-1.045-2.073-2.517-2.339-1.074-.194-2.044.218-2.832.808-.787.588-1.47 1.409-2.023 2.205a19.077 19.077 0 00-1.316 2.228c-.66 1.306.693 1.955 1.339.677.29-.572.704-1.322 1.209-2.05.51-.734 1.086-1.408 1.69-1.86.602-.45 1.154-.624 1.666-.532.678.123.993.646 1.49 1.626l.043.086c.426.845 1.045 2.072 2.517 2.338 1.074.194 2.044-.218 2.832-.807.787-.589 1.47-1.41 2.023-2.206A19.086 19.086 0 0021.621 9.5c.65-1.285-.765-1.812-1.339-.677z",clipRule:"evenodd"})]})}),M=(0,f().wt)("collectionChartLineUnselected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.25 1.34999C2.66421 1.34999 3 1.68578 3 2.09999V21H21.9C22.3142 21 22.65 21.3358 22.65 21.75C22.65 22.1642 22.3142 22.5 21.9 22.5H2.4C1.90295 22.5 1.5 22.097 1.5 21.6V2.09999C1.5 1.68578 1.83579 1.34999 2.25 1.34999Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.282 8.82193C19.9925 9.39441 19.578 10.1448 19.073 10.8721C18.5636 11.606 17.9871 12.2798 17.3833 12.7313C16.7803 13.1822 16.2283 13.3564 15.7165 13.264C15.0386 13.1416 14.7238 12.6188 14.2275 11.6384C14.2133 11.6103 14.1988 11.5816 14.1841 11.5525C13.7578 10.7068 13.1391 9.47987 11.6666 9.21412C10.5932 9.02038 9.62328 9.43236 8.8352 10.0216C8.04796 10.6103 7.36417 11.4307 6.81155 12.2267C6.25441 13.0293 5.80504 13.8446 5.49617 14.4554C4.83609 15.7605 6.1888 16.4095 6.83472 15.1323C7.12425 14.5598 7.5388 13.8095 8.04375 13.0821C8.55321 12.3482 9.12966 11.6744 9.73347 11.2229C10.3364 10.7721 10.8884 10.5979 11.4002 10.6903C12.0781 10.8126 12.393 11.3355 12.8892 12.3158C12.9035 12.344 12.9179 12.3727 12.9326 12.4018C13.359 13.2474 13.9776 14.4744 15.4501 14.7401C16.5236 14.9339 17.4935 14.5219 18.2816 13.9326C19.0688 13.344 19.7526 12.5236 20.3052 11.7275C20.8623 10.925 21.3117 10.1096 21.6206 9.49889C22.2706 8.21371 20.8559 7.68723 20.282 8.82193Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),k=(0,f().wt)("collectionChartLineUnselectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.25 1.35A.75.75 0 013 2.1V21h18.9a.75.75 0 010 1.5H2.4a.9.9 0 01-.9-.9V2.1a.75.75 0 01.75-.75z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M20.282 8.822c-.29.572-.704 1.323-1.209 2.05-.51.734-1.086 1.408-1.69 1.86-.603.45-1.155.624-1.666.532-.678-.122-.993-.645-1.49-1.626l-.043-.085c-.426-.846-1.045-2.073-2.517-2.339-1.074-.194-2.044.218-2.832.808-.787.588-1.47 1.409-2.023 2.205a19.077 19.077 0 00-1.316 2.228c-.66 1.306.693 1.955 1.339.677.29-.572.704-1.322 1.209-2.05.51-.734 1.086-1.408 1.69-1.86.602-.45 1.154-.624 1.666-.532.678.123.993.646 1.49 1.626l.043.086c.426.845 1.045 2.072 2.517 2.338 1.074.194 2.044-.218 2.832-.807.787-.589 1.47-1.41 2.023-2.206A19.086 19.086 0 0021.621 9.5c.65-1.285-.765-1.812-1.339-.677z",clipRule:"evenodd"})]})}),T=(0,f().wt)("collectionChartVerticalBarSelected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{d:"M18.75 20.25V4.75H21.25V20.25H18.75Z",fill:"#2383E2",fillOpacity:"0.15"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.8"})]})}),P=(0,f().wt)("collectionChartVerticalBarSelectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.75 9.75v10.5h2.5V9.75h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v11.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795V9.045zm9.5 4.705v6.5h2.5v-6.5h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v7.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795v-7.91z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.25",d:"M18.75 20.25V4.75h2.5v15.5h-2.5z"}),(0,y.jsx)("path",{fill:"#2383E2",fillRule:"evenodd",d:"M18.75 4.75v15.5h2.5V4.75h-2.5zm-1.5-.7a.8.8 0 01.8-.8h3.9a.8.8 0 01.8.8v16.9a.8.8 0 01-.8.8h-3.9a.8.8 0 01-.8-.8V4.05z",clipRule:"evenodd"})]})}),B=(0,f().wt)("collectionChartVerticalBarUnselected",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 9.75V20.25H5.25V9.75H2.75ZM1.25 9.045C1.25 8.60594 1.60593 8.25 2.045 8.25H5.955C6.39407 8.25 6.75 8.60593 6.75 9.045V20.955C6.75 21.3941 6.39407 21.75 5.955 21.75H2.045C1.60593 21.75 1.25 21.3941 1.25 20.955V9.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.75 13.75V20.25H13.25V13.75H10.75ZM9.25 13.045C9.25 12.6059 9.60593 12.25 10.045 12.25H13.955C14.3941 12.25 14.75 12.6059 14.75 13.045V20.955C14.75 21.3941 14.3941 21.75 13.955 21.75H10.045C9.60593 21.75 9.25 21.3941 9.25 20.955V13.045Z",fill:"#C7C6C4"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18.75 4.75V20.25H21.25V4.75H18.75ZM17.25 4.05C17.25 3.60818 17.6082 3.25 18.05 3.25H21.95C22.3918 3.25 22.75 3.60817 22.75 4.05V20.95C22.75 21.3918 22.3918 21.75 21.95 21.75H18.05C17.6082 21.75 17.25 21.3918 17.25 20.95V4.05Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),V=(0,f().wt)("collectionChartVerticalBarUnselectedDark",{viewBox:"0 0 24 24",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M2.75 9.75v10.5h2.5V9.75h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v11.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795V9.045zm9.5 4.705v6.5h2.5v-6.5h-2.5zm-1.5-.705c0-.44.356-.795.795-.795h3.91c.44 0 .795.356.795.795v7.91c0 .44-.356.795-.795.795h-3.91a.795.795 0 01-.795-.795v-7.91z",clipRule:"evenodd"}),(0,y.jsx)("path",{fill:"#2383E2",fillOpacity:"0.8",fillRule:"evenodd",d:"M18.75 4.75v15.5h2.5V4.75h-2.5zm-1.5-.7a.8.8 0 01.8-.8h3.9a.8.8 0 01.8.8v16.9a.8.8 0 01-.8.8h-3.9a.8.8 0 01-.8-.8V4.05z",clipRule:"evenodd"})]})});var F=()=>o(534177),E=()=>o(704152),R=()=>o(859428),D=()=>o(962730);const K={light:{column:{unselected:B,selected:T},bar:{unselected:j,selected:b},line:{unselected:M,selected:_},donut:{unselected:v,selected:h}},dark:{column:{unselected:V,selected:P},bar:{unselected:A,selected:w},line:{unselected:k,selected:I},donut:{unselected:C,selected:x}}};function O(e){let{chartConfig:t,disabled:o}=e;const n=(0,i().Y0)(),s=(0,l().DP)(),a=(0,r().K8)((()=>{if(!t)return;const e=t.type;if("placeholder"===e)throw new Error("Should not happen");return e}),[t]);return(0,y.jsx)("div",{style:{display:"flex",...n.isMobile?{marginTop:0,background:s.surface.elevated,padding:10}:{marginLeft:4,marginRight:4}},children:(0,F().uv)(K.light).map((e=>(0,y.jsx)(L,{chartType:e,currentlySelectedChartType:a,disabled:o},e)))})}function L(e){let{chartType:t,currentlySelectedChartType:o,disabled:s}=e;const a=(0,p().ET)(),c=(0,i().v3)(),u=(0,i().Y0)(),g=(0,d().tz)(),f=(0,l().DP)(),{itemRef:h,isTabbable:x,onKeyDown:v}=(0,S().e)(),C=(0,l().IS)((e=>({button:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,fontSize:11,borderRadius:u.isMobile?8:6,margin:6,padding:6,boxShadow:u.isMobile?`0 0 0 1.5px ${e.regularDividerColor}`:`0 0 0 1px ${e.regularDividerColor}`,position:"relative",width:"calc(20% - 12px)",height:0,paddingTop:0,paddingBottom:"calc(20% - 12px)",...u.isMobile?{width:50,height:50,paddingBottom:void 0}:{},...u.isMobile?{background:e.popoverBackground}:{}},selectedButton:{...u.isMobile?{background:e.popoverBackground}:{},boxShadow:`0 0 0 2px ${e.blueColor}`},icon:{width:24,height:24,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",...u.isMobile?{width:30,height:30}:{}}})),[u]),b=(0,r().O$)(a.normalizedSchemaStore),w=(0,n.useCallback)((e=>{const t=a.collectionViewStore(),o=null==t?void 0:t.getChartConfig();t&&o&&(0,m().QJ)(e,o,c,t,a,b)}),[a,c,b]),j="dark"===f.mode?"dark":"light";let A=K[j][t].unselected(C.icon);return t===o&&(A=K[j][t].selected(C.icon)),(0,y.jsx)(R().A,{placement:D().W.Top,alignment:D().C.Center,renderTooltip:e=>g.formatMessage(m().FZ[t]),render:e=>(0,n.createElement)(E().A,{...e,ref:h,key:t,style:{...C.button,...t===o&&C.selectedButton},onClick:()=>{w(t)},onKeyDown:v,disallowTabbing:!x,disabled:s||t===o,disabledFeedback:s,ariaLabel:g.formatMessage(m().FZ[t])},A)})}o(944114),o(898992),o(672577),o(803949);var z=()=>o(594013),N=()=>o(100594),U=()=>o(499755),W=()=>o(67657),H=()=>o(921598),$=()=>o(713998);const G={viewBox:"0 0 20 20",fittedViewBox:"2.37 0.12 17.5 17.51",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{d:"M12.25.125a.625.625 0 0 0-.625.625v7a.625.625 0 0 0 .625.625h7c.345 0 .625-.28.625-.625A7.625 7.625 0 0 0 12.25.125m.625 7v-5.72a6.38 6.38 0 0 1 5.72 5.72z"}),(0,y.jsx)("path",{d:"M10 2.375A7.625 7.625 0 1 0 17.625 10 .625.625 0 0 0 17 9.375h-6.375V3A.625.625 0 0 0 10 2.375M3.625 10c0-3.31 2.523-6.03 5.75-6.345V10a.625.625 0 0 0 .625.625h6.345A6.376 6.376 0 0 1 3.625 10"})]})},Q=(0,f().wt)("chartPieCutout",G);var Z=()=>o(765974),q=()=>o(979251),Y=()=>o(496603),J=()=>o(284371),X=()=>o(436696),ee=()=>o(246826),te=()=>o(751156),oe=()=>o(476492),ne=()=>o(656881),ie=(o(354520),o(737550),o.n(o(844751))),re=()=>o(743176),le=()=>o(965134),se=()=>o(760217),ae=()=>o(406699),ce=()=>o(811979),de=()=>o(419357),ue=()=>o(928600),pe=()=>o(939740),ge=()=>o(64e3),me=()=>o(662971),Se=()=>o(722372),fe=()=>o(525432),ye=()=>o(722872),he=()=>o(553965),xe=()=>o(463830),ve=()=>o(497222);const Ce="search-item",be="default",we="aggregate",je="distinct",Ae={main_property:[be],aggregation_property:[be,we,je],y_axis_stacked_groups:[be]},_e=["sum","average","min","max","median"];function Ie(e){return"unique"===e||"sum"===e||"average"===e||"min"===e||"max"===e||"median"===e}function Me(e){switch(e.type){case"none":case"record_count":return e.type;case"property_group":{const t=e.groupByOption??"undefined";return`group:${e.property}-${t}`}case"aggregation":return`aggregation:${e.property}-${e.aggregation??"undefined"}`;default:(0,F().HB)(e)}}function ke(e){const{collectionContextStore:t,selectedProperty:o,properties:s,callsite:a,handlePropertySelect:c,originProps:p,disabled:g,rightStyle:S,...f}=e,h=(0,i().v3)(),x=(0,i().Y0)(),v=(0,d().tz)(),[C,b]=n.useState(""),w=(0,r().uB)(void 0,xe().A),j=(0,r().O$)(w),A=(0,r().O$)(t.normalizedSchemaStore),_=(0,r().K8)((()=>s.length>fe().R8),[s.length]),I=(0,r().K8)((()=>{const e=Y().$z(s,(e=>e.sectionName));return Ae[a].map((t=>{const o=e[t]??[];return[...o.filter((e=>"none"===e.key.type)),...o.filter((e=>"none"!==e.key.type)).sort(((e,t)=>e.name<t.name?-1:e.name>t.name?1:0))]}))}),[s,a]),M=(0,r().K8)((()=>{if(C.length>0){return I.map((e=>ie().filter(C,e,{extract:e=>e.name}).map((e=>{let{original:t}=e;return t}))))}return I}),[C,I]),k=(0,l().IS)((e=>({propertyIcon:{theme:e,fill:e.icon.primary}})),[]);function T(){if(!o)return(0,y.jsx)(d().sA,{...m().G_.none});const e=e=>{for(let t=0;t<e.length;t++){const n=e[t];if(Me(n.key)===Me(o))return n}},t=e(s);if(t)return"property_group"===t.key.type&&t.sectionName===je?(0,y.jsx)("span",{style:J().RC,children:`${t.name} (${(0,m().TQ)({aggregation:{property:t.key.property,aggregator:"unique"},databaseType:void 0,intl:v})})`}):(0,y.jsx)("span",{style:J().RC,children:t.name});const n=(t=>{for(let o=0;o<t.length;o++){const n=t[o];if(n.subMenuItems){const t=e(n.subMenuItems);if(t)return{subMenuItem:t,menuItem:n}}}})(s);return n?(0,y.jsx)("span",{style:J().RC,children:`${n.menuItem.name} (${n.subMenuItem.name})`}):(0,y.jsx)(d().sA,{...m().G_.none})}function P(e){const{key:t,name:n,subMenuItems:i}=e;let r;if("record_count"===t.type)r=(0,le().i)({width:16,height:16,marginRight:-2});else if("property_group"===t.type){const e=(0,$()._g)({schema:A,property:t.property});r=e?(0,y.jsx)(re().zB,{type:e.type,icon:e.icon,size:16,theme:k.propertyIcon.theme,style:{fill:k.propertyIcon.fill}}):void 0}if(i&&i.length>0){return{key:n,render:(e,t)=>(0,y.jsx)(me().A,{...e,onFocus:t.onFocus,renderOrigin:(e,t)=>(0,y.jsx)(se().A,{...e,ref:t,title:n,icon:r}),renderExtension:(e,o)=>{let n;return n=x.isMobile?{menuType:ye().gu.ActionSheet}:{menuType:ye().gu.Popup,width:200},(0,y.jsx)(ue().A,{...n,...e,children:(0,y.jsx)(pe().Ay,{type:pe().Oh.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,y.jsx)(u().A,{...e}),items:Y().oE(null==i?void 0:i.map(P))}],onAccept:t.onAccept})})}}),action:()=>null}}const l=o&&Me(o)===Me(t);let s=n;"aggregation"===t.type&&(s="value"===t.aggregation?v.formatMessage(m().bg.chartAggregateByValues):"unique"===t.aggregation?v.formatMessage(Te.distinctValues):Se().zY[t.aggregation]);const a={key:n,render:e=>(0,y.jsx)(se().A,{...e,title:s,icon:r,isChecked:l}),action:t=>{c(e)}};return a}return(0,y.jsx)(ce().A,{focused:!1,buttonPopupStore:w,alignmentToOrigin:ae().yP.End,placementToOrigin:ae().sx.Bottom,popupType:x.isMobile?ae().z7.SlideUp:ae().z7.Popup,onClose:()=>{b((()=>""))},renderOrigin:e=>(0,y.jsx)(ve().A,{...(0,he().A)(e,f),showChevron:!0,rotateChevron:j.open,icon:p.icon,title:p.title,right:T(),disabled:g,rightStyle:S}),render:e=>{const t=h.device.isMobile?{menuType:ye().gu.ActionSheet}:{menuType:ye().gu.Popup,width:250,maxHeight:400},o=[];if(_){const e={key:Ce,items:[{key:Ce,render:(e,t)=>(0,y.jsx)(de().Ay,{...e,value:C,onChange:e=>{b((()=>e.target.value))},focusInitial:!0,placeholder:v.formatMessage({id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.searchPlaceholder",defaultMessage:"Search properties..."})}),action:e=>{}}],showNoResultMessage:!0,render:e=>(0,y.jsx)(u().A,{isInput:!0,...e})};o.push(e)}if(M.some((e=>e.length>0)))M.forEach((e=>{if(0===e.length)return;const t=e[0].sectionName,n={key:t,items:e.map(P).filter(F().O9),render:e=>(0,y.jsx)(u().A,{...e,topBorder:t!==be})};o.push(n)}));else{const e=v.formatMessage(m().bg.noResultsMenuItem),t={key:e,items:[{key:`${e}-item`,action:()=>{},render:e=>(0,y.jsx)(ge().A,{title:(0,y.jsx)(d().sA,{...m().bg.noResultsMenuItem})})}],render:e=>(0,y.jsx)(u().A,{...e})};o.push(t)}return(0,y.jsx)(ue().A,{...t,children:(0,y.jsx)(pe().Ay,{initialFocus:0,type:pe().Oh.Vertical,sections:o,onAccept:t=>{t.key!==Ce&&e.close()}})})}})}const Te=(0,d().YK)({distinctValues:{id:"database.viewSettings.ChartSettingsPropertySearchMenuItem.distinctValues",defaultMessage:"Distinct values"}});function Pe(e){var t;const{environment:o,menuItem:n,chartConfig:i,collectionSchema:r,collectionViewStore:l,collectionContextStore:s,mainPropertyId:c}=e,{key:d,sectionName:u}=n,p=(0,z().o_)({property:c,collectionSchema:r,hideEmptyGroups:"donut"===i.type||Boolean(null===(t=i.chartFormat)||void 0===t?void 0:t.axisHideEmptyGroups)});if(!p)return;let g=(0,Y().mg)(i);const m="groups_reducer"===g.dataConfig.type?g.dataConfig.groupBy:p;if(m){if("property_group"===d.type){if(u!==je)return;"donut"===g.type?g.dataConfig={type:"groups_reducer",groupBy:m,aggregationConfig:{aggregation:{aggregator:"unique",property:d.property}}}:g=(0,N().CN)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"groups_reducer",groupBy:m,aggregation:{aggregator:"unique",property:d.property}})}"donut"===g.type?"record_count"===d.type?g.dataConfig={type:"groups_reducer",groupBy:m,aggregationConfig:{aggregation:{aggregator:"count"}}}:"aggregation"===d.type&&("value"===d.aggregation?g.dataConfig={type:"results_reducer",nameProperty:c,valueProperty:d.property}:g.dataConfig={type:"groups_reducer",groupBy:m,aggregationConfig:{aggregation:{aggregator:d.aggregation,property:d.property}}}):"record_count"===d.type?g=(0,N().CN)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"groups_reducer",groupBy:m,aggregation:{aggregator:"count"}}):"aggregation"===d.type&&(g="value"===d.aggregation?(0,N().CN)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"results_reducer",groupBy:m,valueProperty:d.property}):(0,N().CN)({chartConfig:g,xAxisPropertyId:c,newDataConfigType:"groups_reducer",groupBy:m,aggregation:{aggregator:d.aggregation,property:d.property}})),te().createAndCommit({userAction:(0,a().m)(g)?"chartSettings.setYAxis":"chartSettings.setDonutSlice",environment:o,canUndo:!0,perform:e=>{ee().zv({store:l.getFormatStore().getKeyStore("chart_config"),data:g,transaction:e})}}),(0,X().X)({environment:o,collectionContextStore:s,action:(0,a().m)(g)?"charts_y_axis_what_to_show":"charts_donut_slice_value",charts_analytics_context:(0,oe().nL)(s)})}}var Be=()=>o(812480);function Ve(e){let{chartConfig:t,chartError:o,disabled:a}=e;const c=(0,i().v3)(),u=(0,p().ET)(),g=(0,d().tz)(),S=(0,l().IS)((e=>({errorIcon:{...(0,m().FE)(e),width:f().Ev.default,height:f().Ev.default}})),[]),h=(0,m().k1)(),x=(0,r().K8)((()=>u.collectionViewStore()),[u]),v=(0,r().O$)(u.normalizedSchemaStore),C=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),b=(0,r().K8)((()=>{if("groups_reducer"===(null==C?void 0:C.type)){const e=C.groupBy;return(0,H().sj)(e)||(0,H().Ik)(e)?{type:"property_group",property:e.property,groupByOption:e.groupBy}:{type:"property_group",property:C.groupBy.property}}if("results_reducer"===(null==C?void 0:C.type))return{type:"property_group",property:C.nameProperty}}),[C]),w=o&&(0,s().lc)(o)?()=>(0,Z().exclamationMarkTriangleFillIcon)(S.errorIcon):q().j,j=(0,r().K8)((()=>{const e=(0,F().WP)(v),t=[];return e.forEach((e=>{let[o,n]=e;if(n)if((0,H().iF)(n.type))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:H().PC.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Be().eD[e]),sectionName:be})))});else if((0,N().zn)(n))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:H().BI.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Be().WK[e]),sectionName:be})))});else{if(!(0,H().Eg)(n))return;t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be})}})),t}),[v,g]),A=n.useCallback((e=>{var o;const{key:n}=e,{property:i,groupByOption:r}=n;if(!t||!x)return;const l=v[i],s=(0,z().o_)({property:i,collectionSchema:v,hideEmptyGroups:!0});if(!l||!s)return;const a=Object.keys(v),d="results_reducer"===t.dataConfig.type?t.dataConfig.valueProperty:a.find((e=>{const t=v[e];return Boolean(t&&(0,z().Iw)(t))})),p={aggregator:"count"},g=Y().mg(t);if(l&&(0,z().tH)(l)&&d)g.dataConfig={type:"results_reducer",nameProperty:i,valueProperty:d};else if(r){const e=(0,N().xS)({property:i,propertySchema:l,groupByOption:r,hideEmptyGroups:!0});e&&(g.dataConfig={type:"groups_reducer",groupBy:e,aggregationConfig:{aggregation:p}})}else if(s){const e="groups_reducer"===t.dataConfig.type?t.dataConfig.aggregationConfig.aggregation:p;g.dataConfig={type:"groups_reducer",groupBy:s,aggregationConfig:{aggregation:e}};const o="formula"===s.type?s.groupBy.sort:s.sort;g.chartFormat={...t.chartFormat,mainSort:l&&(0,U().e0)(l)?U().S0.yDescending:(0,U().gN)(o)}}(0,m().Qn)({environment:c,collectionContextStore:u,chartConfig:g,sort:null===(o=g.chartFormat)||void 0===o?void 0:o.mainSort}),te().createAndCommit({userAction:"chartSettings.setDonutGroupBy",environment:c,canUndo:!0,perform:e=>{ee().zv({store:x.getFormatStore().getKeyStore("chart_config"),data:g,transaction:e})}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_donut_property",charts_analytics_context:(0,oe().nL)(u)})}),[v,x,c,t,u]);return(0,y.jsx)(R().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,s().lc)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,y.jsx)(ke,{...e,collectionContextStore:u,selectedProperty:b,properties:j,handlePropertySelect:A,originProps:{title:(0,y.jsx)("span",{children:(0,y.jsx)(d().sA,{...m().bg.chartWhatToShow})}),icon:w},callsite:"main_property",disabled:a,rightStyle:h.whatToShowRightText})})}function Fe(e){let{chartConfig:t,chartError:o,disabled:a}=e;const c=(0,d().tz)(),u=(0,i().v3)(),g=(0,p().ET)(),S=(0,l().IS)((e=>({errorIcon:{...(0,m().FE)(e),width:f().Ev.default,height:f().Ev.default,marginLeft:4}})),[]),h=(0,m().k1)(),x=(0,r().K8)((()=>g.collectionViewStore()),[g]),v=(0,r().K8)((()=>g.databaseType),[g]),C=(0,r().O$)(g.normalizedSchemaStore),b=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),w=(0,r().K8)((()=>{if(b)return"groups_reducer"===b.type?b.groupBy.property:b.nameProperty}),[b]),j=(0,r().K8)((()=>w?C[w]:void 0),[w,C]),A=(0,r().K8)((()=>{if(b)if("groups_reducer"===b.type){const e=null==b?void 0:b.aggregationConfig.aggregation;if((0,W().Iq)(e))return{type:"record_count"};if(Ie(e.aggregator)){const t=(0,$()._g)({schema:C,property:e.property});if(!t)return;return(0,N().JW)(t)||"unique"!==e.aggregator?{type:"aggregation",property:e.property,aggregation:e.aggregator}:{type:"property_group",property:e.property}}}else if("results_reducer"===b.type&&b.valueProperty)return{type:"aggregation",property:b.valueProperty,aggregation:"value"}}),[C,b]),_=(0,r().K8)((()=>{if(!b||!j)return[];const e=[];(0,F().WP)(C).forEach((t=>{let[o,n]=t;if(!n||o===w||!(0,H().Eg)(n))return;const i=[];(0,z().Iw)(n)&&(0,z().tH)(j)&&i.push({key:{type:"aggregation",property:o,aggregation:"value"},name:c.formatMessage(m().bg.chartAggregateByValues),sectionName:we});const r=(0,N().JW)(n);if(r){_e.forEach((e=>{const t={aggregator:e,property:o},n={key:{type:"aggregation",property:o,aggregation:e},name:(0,m().TQ)({aggregation:t,databaseType:v,intl:c})||"",sectionName:we};i.push(n)}));const e={key:{type:"aggregation",property:o,aggregation:"unique"},name:(0,m().TQ)({aggregation:{aggregator:"unique",property:o},databaseType:v,intl:c})||"",sectionName:we};i.push(e)}const l={key:{type:"property_group",property:o},name:n.name,sectionName:r?we:je,subMenuItems:i};e.push(l)}));return[{key:{type:"record_count"},name:(0,m().TQ)({aggregation:{aggregator:"count"},databaseType:v,intl:c})||"",sectionName:"default"},...e]}),[b,j,C,v,c,w]),I=(0,r().K8)((()=>o&&(0,s().dG)(o)?()=>(0,Z().exclamationMarkTriangleFillIcon)(S.errorIcon):Q),[o,S.errorIcon]),M=n.useCallback((e=>{x&&t&&w&&Pe({environment:u,menuItem:e,chartConfig:t,collectionSchema:C,collectionViewStore:x,collectionContextStore:g,mainPropertyId:w})}),[t,C,x,u,w,g]);return(0,y.jsx)(R().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,s().dG)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,y.jsx)(ke,{...e,collectionContextStore:g,selectedProperty:o?void 0:A,properties:_,handlePropertySelect:M,originProps:{title:(0,y.jsx)("span",{style:J().RC,children:(0,y.jsx)(d().sA,{...m().bg.chartSliceDonutAggregation})}),icon:I},callsite:"aggregation_property",disabled:a,rightStyle:h.donutSliceValueRightText})})}var Ee=()=>o(496506),Re=(o(964979),o(814603),o(147566),o(198721),()=>o(148307)),De=()=>o(620586),Ke=()=>o(252051),Oe=()=>o(972435),Le=()=>o(884107),ze=()=>o(901389),Ne=()=>o(436572);function Ue(e){return{width:Ke().o0+Ke().eq+Ke().PB,height:Ke().p0+Ke().jQ+Ke().PB}}async function We(e){const{environment:t,previewCanvas:o,chartStore:n}=e,{chart:i,responsiveChartOptions:r,exportBackgroundColor:l}=n.state;if(o)if("png"===e.format){const c=o.toDataURL("image/png");if("copy"===e.type){const d=await Le().R.clipboardActions.load();async function u(){const e=await fetch(c);return await e.blob()}const p=new ClipboardItem({"image/png":u()});try{await navigator.clipboard.write([p]),Ne().D6({label:Oe().A.formatMessage(d.clipboardMessages.copiedImageToClipboard)})}catch(a){ze().f1(Oe().A.formatMessage(d.clipboardMessages.copyImageError))}}else if(t.device.isMobileNative){var s;null===(s=t.mobileNative)||void 0===s||s.showLightBoxV2({url:c,downloadName:`${Oe().A.formatMessage(Ke().jV.chart)}.png`,type:"image",from:"chart",state:"url_ready"})}else{const g=document.createElement("a");g.href=c,g.download=`${Oe().A.formatMessage(Ke().jV.chart)}.png`,g.click()}}else if("svg"===e.format){if("copy"===e.type)return;null==i||i.exportChartLocal({type:"image/svg+xml",filename:Oe().A.formatMessage(Ke().jV.chart)},{...(0,Ke().j2)(l),...r??{}})}else(0,F().HB)(e.format)}var He=()=>o(331542),$e=()=>o(480095),Ge=()=>o(864943),Qe=()=>o(204063),Ze=()=>o(532564),qe=()=>o(898486),Ye=()=>o(47170),Je=()=>o(62856),Xe=()=>o(329304);const et=290,tt=8,ot=14;const nt=function(e){const t=(0,d().tz)(),n=(0,i().Y0)();return n.isMobile&&n.isAndroid?null:(0,y.jsx)(ce().A,{focused:!1,popupType:n.isMobile?ae().z7.SlideUp:ae().z7.Popup,placementToOrigin:D().W.Top,alignmentToOrigin:D().C.Center,render:e=>(0,y.jsx)(it,{menuParent:e}),renderOrigin:n=>(0,y.jsx)(ve().A,{...n,showChevron:!0,disabled:e.disabled,title:t.formatMessage(Ke().jV.exportChart),icon:o(820579).f})})};function it(e){var t;const o=(0,i().v3)(),s=(0,d().tz)(),a=(0,Ze().V)(),c=(0,p().ET)(),g=(0,Ye().O)(),m=(0,Xe().P9)({name:"watermarkless_chart_export",spaceId:g,userId:null===(t=o.currentUser)||void 0===t?void 0:t.id}),S=n.useRef(null),{isLoading:f,hasError:h,exportDisabled:x}=(0,r().K8)((()=>({isLoading:"loading"===a.state.previewCanvasState,hasError:"error"===a.state.previewCanvasState,exportDisabled:"loading"===a.state.previewCanvasState||"error"===a.state.previewCanvasState})),[a]),v=(0,r().K8)((()=>De().Q1.filter((e=>!(!m&&"none"===e)))),[m]),C=(0,l().IS)((e=>{const t=o.device.isMobile;return{copyButton:{height:t?36:32,fontSize:t?16:14},downloadButton:{height:t?36:32,fontSize:t?16:14,display:"flex",justifyContent:"center",marginTop:8,background:e.contentBackground}}}),[o]),b=o.device.isMobile?{menuType:ye().gu.Modal,title:s.formatMessage(Ke().jV.exportChart),right:(0,y.jsx)($e().DoneMenuText,{}),onClickRight:e.menuParent.close}:{menuType:ye().gu.Popup,width:et},w=[{key:"preview",render:e=>(0,y.jsx)(rt,{...e,previewCanvasRef:S,isLoading:f,hasError:h}),items:[]},{key:"background",render:e=>(0,y.jsx)(u().A,{...e,title:s.formatMessage(Ke().jV.exportChartBackground),mobileTitleStyle:{lineHeight:void 0},disableMobileBorders:!0,children:(0,y.jsx)("div",{style:{display:"flex",justifyContent:"space-between",paddingLeft:ot+3,paddingRight:ot+3,paddingTop:tt,paddingBottom:tt},children:e.children})}),items:v.map((e=>({key:e,render:t=>(0,y.jsx)(st,{menuListItemProps:t,disabled:x,colors:v,color:e}),action:()=>{a.setState({...a.state,exportBackgroundColor:e})}})))},{key:"export",render:e=>(0,y.jsx)(u().A,{...e,topBorder:!0,disableMobileBorders:!0,children:(0,y.jsx)("div",{style:{display:"flex",flexDirection:"column",padding:"8px 14px",paddingTop:8},children:e.children})}),items:[{key:"copyPng",render:e=>(0,y.jsx)(Qe().A,{...e,style:C.copyButton,disabled:x,children:s.formatMessage(Ke().jV.copyPng)}),action:async()=>{await We({environment:o,previewCanvas:S.current,chartStore:a,type:"copy",format:"png"}),(0,X().X)({environment:o,collectionContextStore:c,action:"charts_export_copy_png",charts_analytics_context:(0,oe().nL)(c)})}},{key:"downloadPng",render:e=>(0,y.jsx)(Ge().A,{...e,size:"lg",style:C.downloadButton,disabled:x,disabledFeedback:x,children:s.formatMessage(Ke().jV.downloadPng)}),action:async()=>{await We({environment:o,previewCanvas:S.current,chartStore:a,type:"download",format:"png"}),(0,X().X)({environment:o,collectionContextStore:c,action:"charts_export_download_png",charts_analytics_context:(0,oe().nL)(c)})}},{key:"downloadSvg",render:e=>o.device.isMobile?null:(0,y.jsx)(Ge().A,{...e,size:"lg",style:C.downloadButton,disabled:x,disabledFeedback:x,children:s.formatMessage(Ke().jV.downloadSvg)}),action:async()=>{await We({environment:o,previewCanvas:S.current,chartStore:a,type:"download",format:"svg"})}}]}];return(0,y.jsx)(ue().A,{...b,children:(0,y.jsx)(pe().Ay,{initialFocus:0,type:pe().Oh.Vertical,sections:w})})}function rt(e){const t=(0,d().tz)(),o=(0,l().DP)(),i=(0,Ze().V)(),s=(0,r().K8)((()=>i.state.exportBackgroundColor),[i]),a=(0,Je().A)(!0,Ke().Yp,0,!1);n.useEffect((()=>{const t=new(Ee().ComputedStore)((()=>({chart:i.state.chart,exportBackgroundColor:i.state.exportBackgroundColor,responsiveChartOptions:i.state.responsiveChartOptions})),{debugName:"chartDrawingStateStore"});function n(){const n=e.previewCanvasRef.current;n&&function(e,t,o,n){const{chart:i,responsiveChartOptions:r,exportBackgroundColor:l}=t;o((()=>{}));const s=e.getContext("2d");if(!i||!s)return;let a;setTimeout((()=>{o((e=>void 0===e?"loading":e))}),Ke().Yp);try{a=i.getSVG({...(0,Ke().j2)(l),...r??{}})}catch(y){return console.error(y),void o((()=>"error"))}const c=new Blob([a],{type:"image/svg+xml;charset=utf-8"}),d=URL.createObjectURL(c),u=new Image,p=new Image,g=new Image,m=new Promise(((e,t)=>{"gradient"===l?(u.onload=()=>e(u),u.onerror=()=>t(new Error("Failed to load gradient image")),u.src="light"===n.mode?Re().A.images.charts.chartsExportGradientLightPng:Re().A.images.charts.chartsExportGradientDarkPng):e(u)})),S=new Promise(((e,t)=>{p.onload=()=>e(p),p.onerror=()=>t(new Error("Failed to load chart image")),p.src=`data:image/svg+xml;charset=utf-8;base64,${btoa(unescape(encodeURIComponent(a)))}`})),f=new Promise(((e,t)=>{g.onload=()=>e(g),g.onerror=()=>t(new Error("Failed to load chart image")),g.src="light"===n.mode?Re().A.images.charts.chartsExportLogoLightPng:Re().A.images.charts.chartsExportLogoDarkPng}));Promise.all([m,S,f]).then((t=>{let[i,r,a]=t;URL.revokeObjectURL(d);const c=Ue();if(e.width=c.width*Ke().Zz,e.height=c.height*Ke().Zz,s.scale(Ke().Zz,Ke().Zz),"gradient"===l?s.drawImage(i,0,0,e.width,e.height):"none"===l?(s.fillStyle=n.contentBackground,s.fillRect(0,0,e.width,e.height)):(s.fillStyle=(0,De().NF)(n,l,!1),s.fillRect(0,0,e.width,e.height)),"none"!==l&&(s.strokeStyle=n.regularDividerColor,s.fillStyle=n.contentBackground,s.shadowColor="dark"===n.mode?"rgba(0, 0, 0, 0.25)":"rgba(0, 0, 0, 0.07)",s.shadowBlur=24,s.shadowOffsetY=8,s.beginPath(),s.roundRect(Ke().iq,Ke().XC,e.width/Ke().Zz-Ke().eq,e.height/Ke().Zz-Ke().jQ,12),s.stroke(),s.fill(),s.shadowColor="transparent"),"none"!==l){const e=Oe().A.formatMessage(Ke().jV.madeWithNotion);s.font=`14px ${J().Tf.sans}`;const t=c.width/2+Ke().ev+Ke().kC,o=c.height-Ke().XC/2;s.textAlign="center",s.textBaseline="middle",s.fillStyle=n.text.tertiary,s.fillText(e,t,o);const i=s.measureText(e),r=c.width/2-i.width/2,l=o-Ke().kC/2;s.drawImage(a,0,0,a.width,a.height,r,l,Ke().kC,Ke().kC)}"none"===l?s.drawImage(r,Ke().AI,Ke().AI):s.drawImage(r,Ke().iq+Ke().AI,Ke().XC+Ke().AI),o((()=>"success"))})).catch((()=>{o((()=>"error"))}))}(n,t.state,i.updatePreviewState,o)}return n(),t.addListener(n),()=>{t.removeListener(n)}}),[e.previewCanvasRef,i,o]);const c=(0,l().IS)((t=>{const o=et-2*ot,n=Ue(),i=o*(n.height/n.width);return{container:{width:`calc(100% - ${2*ot})`,height:e.isLoading||e.hasError?i:void 0,display:"flex",alignItems:"center",justifyContent:"center",marginTop:tt,marginLeft:ot,marginRight:ot,border:`1px solid ${t.regularDividerColor}`,borderRadius:6,fontSize:12,color:t.text.tertiary},canvas:{width:"100%",borderRadius:6,display:e.isLoading||e.hasError?"none":"block"}}}),[e.hasError,e.isLoading,s]);return(0,y.jsx)(u().A,{title:t.formatMessage(Ke().jV.exportChartPreview),disableMobileBorders:!0,mobileTitleStyle:{lineHeight:void 0},children:(0,y.jsxs)("div",{style:c.container,children:[(0,y.jsx)("canvas",{style:c.canvas,ref:e.previewCanvasRef}),a&&e.isLoading&&(0,y.jsx)(He().A,{}),e.hasError&&(0,y.jsx)("span",{children:t.formatMessage(qe().k1.generic_error)})]})})}const lt=10;function st(e){const t=(0,d().tz)(),o=(0,Ze().V)(),n=(0,i().Y0)(),s=(0,r().K8)((()=>e.color===o.state.exportBackgroundColor),[o,e.color]),a=(0,l().IS)((t=>({button:{position:"relative",width:`calc((100%  / ${e.colors.length}) - ${lt}px)`,height:n.isMobile?36:28,borderRadius:4,boxShadow:`0 0 0 2px ${t.popoverBackground}, 0 0 0 3px ${t.regularDividerColor}`,background:(0,De().NF)(t,e.color,!1)},selectedButton:{boxShadow:`0 0 0 2px ${t.popoverBackground}, 0 0 0 4px ${t.blueColor}`},hoveredStyle:{background:(0,De().NF)(t,e.color,!0)},pressedStyle:{background:(0,De().NF)(t,e.color,!1)}})),[n.isMobile,e.color,e.colors.length]);return(0,y.jsx)(E().A,{...e.menuListItemProps,style:{...a.button,...s?a.selectedButton:{}},hoveredStyle:a.hoveredStyle,pressedStyle:a.pressedStyle,ariaLabel:t.formatMessage((0,De().nH)(e.color)),disabled:e.disabled,disabledFeedback:e.disabled})}var at=()=>o(757695),ct=()=>o(622317),dt=()=>o(708685),ut=()=>o(582684),pt=()=>o(686526),gt=()=>o(75544),mt=()=>o(622281),St=()=>o(941814),ft=()=>o(818367);const yt=(0,d().YK)({alphabetical:{defaultMessage:"{propertyName} A → Z",id:"charts.settings.sort.alphabetical"},reverseAlphabetical:{defaultMessage:"{propertyName} Z → A",id:"charts.settings.sort.reverseAlphabetical"},chronological:{defaultMessage:"Old → New",id:"charts.settings.sort.chronological"},reverseChronological:{defaultMessage:"New → Old",id:"charts.settings.sort.reverseChronological"},lowHigh:{defaultMessage:"{propertyName} Low → High",id:"charts.settings.sort.lowHigh"},highLow:{defaultMessage:"{propertyName} High → Low",id:"charts.settings.sort.highLow"},ascending:{defaultMessage:"{propertyName} Ascending",id:"charts.settings.sort.ascending"},descending:{defaultMessage:"{propertyName} Descending",id:"charts.settings.sort.descending"},manual:{defaultMessage:"Manual",id:"charts.settings.sort.manual"},advanced:{defaultMessage:"Advanced",id:"charts.settings.sort.advanced"}});function ht(e,t){const o=null==e?void 0:e.type;if(!o)return t?yt.ascending:yt.descending;if(t)switch(o){case"formula":switch((0,dt().getFormulaPropertySchemaResultType)(e)){case"date":return yt.chronological;case"text":return yt.alphabetical;case"number":return yt.lowHigh;default:return yt.ascending}case"title":case"text":case"url":case"email":case"phone_number":case"relation":case"created_by":case"last_edited_by":return yt.alphabetical;case"date":case"created_time":case"last_edited_time":case"last_visited_time":return yt.chronological;case"number":return yt.lowHigh;default:return yt.ascending}switch(o){case"formula":switch((0,dt().getFormulaPropertySchemaResultType)(e)){case"date":return yt.reverseChronological;case"text":return yt.reverseAlphabetical;case"number":return yt.highLow;default:return yt.descending}case"title":case"text":case"url":case"email":case"phone_number":case"relation":case"created_by":case"last_edited_by":return yt.reverseAlphabetical;case"date":case"created_time":case"last_edited_time":case"last_visited_time":return yt.reverseChronological;case"number":return yt.highLow;default:return yt.descending}}var xt=()=>o(247788),vt=()=>o(396671),Ct=()=>o(963589),bt=()=>o(596369),wt=()=>o(828973);function jt(e){let{chartConfig:t,chartError:o,disabled:l,sortType:s}=e;const c=(0,i().v3)(),u=(0,p().ET)(),g=(0,d().tz)(),S=(0,xt().x)({chartConfig:t,chartError:o,collectionContextStore:u}),{collectionViewStore:f,databaseType:h,collectionSettingsStore:x,numberOfSorts:v}=(0,r().K8)((()=>({collectionViewStore:u.collectionViewStore(),databaseType:u.databaseType,collectionSettingsStore:u.settingsStore,numberOfSorts:u.currentSortsStore.state.length})),[u]),C=(0,r().O$)(u.normalizedSchemaStore),b=(0,m().uB)(t,C),{stackedPropertySchema:w,stackedGroupBy:j}=(0,r().K8)((()=>{var e;if("results_reducer"===(null==t?void 0:t.dataConfig.type)||"donut"===(null==t?void 0:t.type))return{stackedPropertySchema:void 0,stackedGroupBy:void 0};const o=null==t||null===(e=t.dataConfig.aggregationConfig.stackOptions)||void 0===e?void 0:e.groupBy,n=null==o?void 0:o.property;return n?{stackedPropertySchema:(0,$()._g)({schema:C,property:n}),stackedGroupBy:o}:{stackedPropertySchema:void 0,stackedGroupBy:void 0}}),[t,C]),A="stacked"===s?w:b,_=(0,r().K8)((()=>!A||"formula"!==A.type||(0,N().Yp)(A)),[A]),I=(0,r().K8)((()=>{var e,o;if(null!=t&&null!==(e=t.chartFormat)&&void 0!==e&&e.mainSort&&"main"===s)return t.chartFormat.mainSort;if("groups_reducer"===(null==t||null===(o=t.dataConfig)||void 0===o?void 0:o.type)){var n;const e="stacked"===s&&j?j:null==t||null===(n=t.dataConfig)||void 0===n?void 0:n.groupBy,o=(0,H().Kq)(e);return"formula"===e.type&&"formula"===(null==b?void 0:b.type)?(0,N().Yp)(b)||(0,N().Yp)(b)?(0,U().gN)(o):N().Rb[s]:(0,U().gN)(o)}return N().Rb[s]}),[t,b,s,j]),M=(0,m().Zv)(t,C),k=(0,r().K8)((()=>{var e;if("groups_reducer"===(null==t||null===(e=t.dataConfig)||void 0===e?void 0:e.type)){const e=null==t?void 0:t.dataConfig.aggregationConfig.aggregation;return(0,m().TQ)({aggregation:e,databaseType:h,intl:g})}return null==M?void 0:M.name}),[t,h,g,M]),T=(0,m().k1)(),P=n.useCallback(((e,o)=>{if(!(f&&t&&b&&_))return;const n=Y().mg(t);if("stacked"===s&&"groups_reducer"===n.dataConfig.type&&(0,a().m)(n)){var i;const t=null===(i=n.dataConfig.aggregationConfig.stackOptions)||void 0===i?void 0:i.groupBy;t&&("formula"===t.type?t.groupBy.sort=_t(e,t.groupBy.type):t.sort=_t(e,t.type))}if("main"===s&&(n.chartFormat={...n.chartFormat,mainSort:e},"groups_reducer"===n.dataConfig.type&&n.dataConfig.groupBy)){const t=n.dataConfig.groupBy;"formula"===t.type?t.groupBy.sort=_t(e,t.groupBy.type):t.sort=_t(e,t.type)}(0,m().Qn)({environment:c,collectionContextStore:u,chartConfig:n,sort:e}),te().createAndCommit({userAction:"chartSettings.setMainSort",environment:c,canUndo:!0,perform:e=>{ee().zv({store:f.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_x_axis_sort",charts_analytics_context:(0,oe().nL)(u)}),e!==U().S0.manual&&o&&o.close(),e===U().S0.resultsAdvanced&&(0===v?pt().a2({collectionSettingsStore:x,item:{type:"createSort"}}):pt().a2({collectionSettingsStore:x,item:{type:"sort"}}))}),[f,t,b,_,s,c,u,v,x]);if(!_||!A)return null;const B=[];B.push({key:U().S0.xAscending,type:"button",title:g.formatMessage(ht(A,!0),{propertyName:A.name})}),B.push({key:U().S0.xDescending,type:"button",title:g.formatMessage(ht(A,!1),{propertyName:A.name})});const V=[];V.push({key:U().S0.yAscending,type:"button",title:g.formatMessage(yt.lowHigh,{propertyName:k})}),V.push({key:U().S0.yDescending,type:"button",title:g.formatMessage(yt.highLow,{propertyName:k})});const F=[];"groups_reducer"===(null==t?void 0:t.dataConfig.type)&&null!=A&&A.type&&(0,m().Iq)(A)&&F.push({key:U().S0.manual,type:"button",title:g.formatMessage(yt.manual)});return!("checkbox"===(null==A?void 0:A.type)||"person"===(null==A?void 0:A.type)||"formula"===(null==A?void 0:A.type)&&("checkbox"===(0,dt().getFormulaPropertySchemaResultType)(A)||"person"===(0,dt().getFormulaPropertySchemaResultType)(A)))&&F.push(...B),"stacked"!==s&&(0,U().e0)(A)&&F.push(...V),"results_reducer"===(null==t?void 0:t.dataConfig.type)&&F.push({key:U().S0.resultsAdvanced,type:"button",title:g.formatMessage(yt.advanced)}),(0,y.jsx)(wt().A,{title:(0,y.jsx)(d().sA,{...m().bg.chartSortBy}),selectedKey:I,options:F,icon:ut().C,iconStyle:{transform:"main"===s?"rotate(-90deg)":void 0},onChange:P,disabled:l,disableParentClose:!0,rightStyle:T.sortByRightText,children:S&&t&&(0,y.jsx)(At,{groupedChartReducer:S,sortType:s,chartConfig:t})})}function At(e){let{groupedChartReducer:t,sortType:o,chartConfig:n}=e;const i=(0,p().ET)(),l=(0,Ct().X)("collection_group_reducer_visible"),s="v2"===t.version?{...t,returnHiddenGroups:!0}:t,c="stacked"===o?"chart_subgroups":"collection_groups",d=(0,r().K8)((()=>{var e;return null===(e=n.chartFormat)||void 0===e?void 0:e.mainSort}),[n]),u=(0,r().K8)((()=>{const e=i.normalizedFormatStore.state,t=(0,H().H2)(e,"chart_config",c);return l&&"stacked"===o?(0,H().H2)(e,"chart_config","chart_subgroups"):t}),[i.normalizedFormatStore,c,l,o]),g=(0,r().K8)((()=>"main"===o?(0,St().hk)():(0,St().H4)()),[o]),m=(0,r().K8)((()=>at().Store.createClass(g,{name:"GroupsLimitStore"})),[g]),S=(0,r().uB)(void 0,m),f=(0,r().K8)((()=>(0,ft().x)()),[]),h=(0,gt().A)({id:"chart_subgroups"===c?ct().VQ:ct().Ri,reducer:s,collectionContextStore:i,debounceWait:f}),x=(0,r().K8)((()=>{var e;if(!h||!(0,a().m)(n)||"groups_reducer"!==n.dataConfig.type)return!1;const t=(0,mt().AY)({groupedDataConfig:n.dataConfig,hideEmptyGroups:Boolean(null===(e=n.chartFormat)||void 0===e?void 0:e.axisHideEmptyGroups),mainSort:d});return"datetime"===t||"linear"===t}),[h,n,d]),v=(0,r().K8)((()=>{if(h&&("main"!==o||"manual"!==d))return(0,mt().CL)({chartConfig:n,sortType:o,groupedChartReducerResults:h})}),[h,o,d,n]),[C,b]=(0,vt().d)({collectionContextStore:i,groupBy:l&&"stacked"===o?void 0:u,subGroupBy:l&&"stacked"===o?u:void 0,groupsFormatKey:c,reducerResult:h,groupsLimit:g,renderGroupsFromAggregationArgs:v,removeUncategorized:x}),w=(0,r().K8)((()=>{const e=u?(0,H().Kq)(u):void 0;return"manual"!==(null==e?void 0:e.type)||"main"===o&&("y-ascending"===d||"y-descending"===d)}),[d,u,o]);return u?l?(0,y.jsx)(bt().L,{collectionContextStore:i,groupBy:u,groupByKey:"chart_config",groupsFormatKey:"stacked"===o?"chart_subgroups":"collection_groups",groupsDisplayState:C,disableReorder:w}):(0,y.jsx)(Be().Rb,{collectionContextStore:i,groupsFormatKey:"stacked"===o?"chart_subgroups":"collection_groups",groupByKey:"chart_config",groupsLimitStore:S,groupsDisplayState:C,disableHideAll:!0,disableLoadMore:!0,disableReorder:w}):null}function _t(e,t){switch(e){case U().S0.manual:return{type:"manual"};case U().S0.xAscending:return{type:"ascending"};case U().S0.xDescending:return{type:"descending"};case U().S0.yAscending:case U().S0.yDescending:default:return(0,H()._o)(t)||"number"===t?{type:"ascending"}:{type:"manual"}}}var It=()=>o(638045),Mt=()=>o(202017);const kt=(0,f().wt)("chartGridLine",{viewBox:"0 0 20 20",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("circle",{cx:"4",cy:"10",r:"1"}),(0,y.jsx)("circle",{cx:"8",cy:"10",r:"1"}),(0,y.jsx)("circle",{cx:"12",cy:"10",r:"1"}),(0,y.jsx)("circle",{cx:"16",cy:"10",r:"1"})]})}),Tt={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.69 15.25 11.18",svg:(0,y.jsx)("path",{d:"M14.424 5.248c1.181-1.18 3.201-.344 3.201 1.326V14c0 1.036-.84 1.875-1.875 1.875H4.25A1.875 1.875 0 0 1 2.375 14v-1.959c0-.497.198-.974.55-1.326l2.54-2.54a1.875 1.875 0 0 1 2.65 0l1.25 1.25c.244.243.64.243.884 0zm1.951 1.326a.625.625 0 0 0-1.067-.442l-4.175 4.176a1.875 1.875 0 0 1-2.652 0L7.232 9.059a.625.625 0 0 0-.884 0l-2.54 2.54a.63.63 0 0 0-.183.442V14c0 .345.28.625.625.625h11.5c.345 0 .625-.28.625-.625z"})},Pt=(0,f().wt)("graphArea",Tt),Bt={viewBox:"0 0 20 20",fittedViewBox:"2.51 3.18 14.97 13.63",svg:(0,y.jsx)("path",{d:"M8.455 16.066c-.367.422-.855.747-1.473.747-.838 0-1.426-.584-1.83-1.227-.414-.658-.743-1.54-1.028-2.484-.28-.925-.53-1.957-.777-2.968l-.02-.084c-.255-1.046-.505-2.066-.782-2.962a.625.625 0 1 1 1.194-.37c.29.94.55 1.998.802 3.036l.017.067c.249 1.024.493 2.028.763 2.92.277.92.568 1.67.889 2.18.329.523.59.642.772.642.136 0 .308-.063.53-.318q.344-.394.683-1.226c.45-1.109.817-2.605 1.198-4.167l.008-.035c.371-1.52.757-3.103 1.246-4.306.246-.606.537-1.163.898-1.577.367-.422.855-.747 1.473-.747.837 0 1.422.586 1.824 1.228.412.657.74 1.54 1.024 2.482.276.913.526 1.93.77 2.929l.03.123c.256 1.046.508 2.066.788 2.961a.625.625 0 1 1-1.193.373c-.294-.94-.555-1.998-.81-3.037l-.026-.109c-.247-1.01-.489-1.998-.755-2.878-.278-.92-.568-1.67-.887-2.18-.33-.526-.587-.641-.765-.641-.136 0-.309.062-.53.317q-.345.394-.683 1.226c-.45 1.109-.817 2.605-1.198 4.167l-.008.035c-.371 1.52-.757 3.103-1.246 4.306-.247.606-.537 1.163-.898 1.577"})},Vt=(0,f().wt)("lineCurve",Bt);var Ft=()=>o(594952);const Et={viewBox:"0 0 20 20",fittedViewBox:"2.55 2.37 15.08 15.06",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("path",{d:"M11 5.938a1 1 0 1 1-2 0 1 1 0 0 1 2 0m1.166 1.896A1 1 0 1 0 13.58 6.42a1 1 0 0 0-1.415 1.414M14.063 11a1 1 0 1 1 0-2 1 1 0 0 1 0 2M7.834 7.835A1 1 0 1 0 6.42 6.42a1 1 0 0 0 1.414 1.415"}),(0,y.jsx)("path",{d:"M2.988 7a7.627 7.627 0 1 1 8.853 10.4l-.042.01-.042.005c-1.061.115-2.019-.829-1.804-1.962l.262-1.38a1.188 1.188 0 0 0-1.282-1.402l-2.025.199c-2.848.28-5.044-2.462-4.148-5.18l.185-.563.015-.05.012-.04zm1.164.457-.02.062-.185.562c-.613 1.86.89 3.737 2.84 3.546l2.023-.2a2.437 2.437 0 0 1 2.633 2.881l-.261 1.38c-.05.262.16.493.408.487a6.375 6.375 0 1 0-7.438-8.718"})]})},Rt=(0,f().wt)("paintPalette",Et);var Dt=()=>o(922189);const Kt={viewBox:"0 0 20 20",fittedViewBox:"4.12 2.37 11.75 15.25",svg:(0,y.jsx)("path",{d:"M15.875 4.5a2.125 2.125 0 0 0-2.125-2.125h-7.5A2.125 2.125 0 0 0 4.125 4.5v11c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125zm-2.125-.875c.483 0 .875.392.875.875v4.875h-9.25V4.5c0-.483.392-.875.875-.875zm-8.375 7h9.25V15.5a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"})},Ot=(0,f().wt)("rectangleSplit2Vertical",Kt);var Lt=()=>o(467248);const zt={viewBox:"0 0 20 20",fittedViewBox:"1.62 4.12 16.75 11.76",svg:(0,y.jsx)("path",{d:"M11.72 4.403a.625.625 0 1 0-1.04.694l2.804 4.205v3.223a.625.625 0 0 0 1.25 0V9.21l2.742-4.113a.625.625 0 0 0-1.04-.694L14.078 7.94zm-7.543.037a.625.625 0 1 0-1.016.729l2.504 3.496-2.504 3.496a.625.625 0 1 0 1.016.728l2.257-3.151 2.257 3.15a.625.625 0 1 0 1.016-.727L7.203 8.665l2.504-3.496a.625.625 0 1 0-1.016-.728L6.434 7.59zM2.25 14.625a.625.625 0 1 0 0 1.25h.005a.625.625 0 0 0 0-1.25zm1.933 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.937 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.938 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.937 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.938 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.937 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.938 0a.625.625 0 1 0 0 1.25h.01a.625.625 0 0 0 0-1.25zm1.937 0a.625.625 0 1 0 0 1.25h.005a.625.625 0 0 0 0-1.25z"})},Nt=(0,f().wt)("textXYunderline",zt);var Ut=()=>o(966098),Wt=()=>o(946548),Ht=()=>o(755735),$t=()=>o(35091);const Gt=1e3;function Qt(e){var t;let{collectionViewStore:o,chartConfig:r,disabled:s}=e;const a=(0,i().v3)(),c=(0,p().ET)(),u=(0,l().DP)(),g=(0,n.useCallback)((e=>{var t;const o=null===(t=(0,De().BV)(e,u))||void 0===t?void 0:t.slice(0,5);return{key:e,type:"button",title:(0,y.jsx)(d().sA,{...m().pP[e]}),caption:o?(0,y.jsx)("div",{style:{display:"flex"},children:null==o?void 0:o.map((e=>(0,y.jsx)("div",{style:{background:e,borderRadius:2,width:12,height:12,marginRight:3,marginTop:1}},e)))}):null,captionInline:!0,captionStyle:{marginLeft:"auto"},inlineSpacerStyle:{display:"none"}}}),[u]),S=(0,n.useMemo)((()=>[N().kq.map(g),N().VY.map(g)]),[g]),f=(null===(t=r.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto",h=(0,l().IS)((()=>({icon:{width:20,height:20,marginLeft:2}})),[]);return(0,y.jsx)(wt().A,{disabled:s,title:(0,y.jsx)(d().sA,{...m().Zr.chartColor}),selectedKey:f,sections:S,icon:Rt,iconStyle:h.icon,hideCheck:!0,onChange:e=>{if(!e)return;const t=(0,Y().mg)(r);t.chartFormat||(t.chartFormat={}),t.chartFormat.colorTheme=e,(0,De().Pi)(e)||(t.chartFormat.weightColorValue=!1),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:a,canUndo:!0,perform:e=>{ee().zv({store:o.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),(0,X().X)({environment:a,collectionContextStore:c,action:"charts_style_color"})}})}function Zt(e){const t=(0,i().Y0)(),o=(0,r().uB)(void 0,xe().A);return(0,y.jsx)(ce().A,{focused:!1,popupType:t.isMobile?ae().z7.SlideUp:ae().z7.Popup,alignmentToOrigin:ae().yP.End,placementToOrigin:ae().sx.Bottom,buttonPopupStore:o,renderOrigin:t=>(0,y.jsx)(ve().A,{...t,showChevron:!0,title:(0,y.jsx)(d().sA,{...m().bg.chartMoreStyle}),rotateChevron:o.state.open,icon:Ft().I,disabled:e.disabled}),render:t=>(0,y.jsx)(qt,{parent:t,collectionViewStore:e.collectionViewStore,chartConfig:e.chartConfig,disabled:e.disabled})})}function qt(e){const{collectionViewStore:t,chartConfig:o,disabled:n}=e,{isMobile:s}=(0,i().Y0)(),c=(0,p().ET)(),d=(0,r().O$)(c.normalizedSchemaStore),g=(0,r().K8)((()=>{var e;if((0,a().m)(o))return"groups_reducer"===(null==o||null===(e=o.dataConfig)||void 0===e?void 0:e.type)?(0,$()._g)({schema:d,property:o.dataConfig.groupBy.property}):void 0}),[o,d]),m=[],S={key:"default",items:[{key:"chartHeight",render:(e,i)=>(0,y.jsx)(Yt,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"groupStyle",render:(e,i)=>(0,a().m)(o)&&"groups_reducer"===o.dataConfig.type&&o.dataConfig.aggregationConfig.stackOptions?(0,y.jsx)(Jt,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"gridLine",render:(e,i)=>(0,a().m)(o)?(0,y.jsx)(Xt,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"axisLabel",render:(e,i)=>(0,a().m)(o)?(0,y.jsx)(to,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"axisAvatarStyle",render:(e,i)=>(0,a().m)(o)&&g&&(0,N().fn)(g)?(0,y.jsx)(eo,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"donutValue",render:e=>"donut"!==o.type?null:(0,y.jsx)(ro,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"colorByValue",render:e=>{var i;const r=null===(i=o.chartFormat)||void 0===i?void 0:i.colorTheme;return"line"===o.type||!r||r&&!(0,De().Pi)(r)?null:(0,y.jsx)(so,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n})},action:()=>{}},{key:"smoothLine",render:e=>"line"!==o.type?null:(0,y.jsx)(no,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"areaFill",render:e=>"line"!==o.type?null:(0,y.jsx)(io,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"legend",render:e=>(0,y.jsx)(ao,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"dataLabels",render:e=>(0,a().m)(o)&&(0,N().D5)(o)?(0,y.jsx)(uo,{...e,collectionViewStore:t,chartConfig:o,disabled:n}):null,action:()=>{}},{key:"donutDataLabels",render:(e,i)=>"donut"!==o.type?null:(0,y.jsx)(po,{menuListItemProps:e,parent:i,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}},{key:"valueLabel",render:e=>{var i;return"donut"!==o.type||null!==(i=o.chartFormat)&&void 0!==i&&i.donutHideValue?null:(0,y.jsx)(lo,{menuListItemProps:e,collectionViewStore:t,chartConfig:o,disabled:n})},action:()=>{}},{key:"caption",render:e=>(0,y.jsx)(co,{...e,collectionViewStore:t,chartConfig:o,disabled:n}),action:()=>{}}],render:e=>(0,y.jsx)(u().A,{...e})};m.push(S);const f=s?{menuType:ye().gu.ActionSheet}:{menuType:ye().gu.Popup,width:280,maxHeight:400},h=(0,l().IS)((()=>({menuList:{paddingTop:8,paddingBottom:8}})),[]);return(0,y.jsx)(ue().A,{...f,children:(0,y.jsx)(pe().Ay,{initialFocus:void 0,type:pe().Oh.Vertical,sections:m,resetFocusOnMouseOut:!0,style:h.menuList})})}function Yt(e){const{chartConfig:t,collectionViewStore:o}=e,l=(0,i().v3)(),s=(0,i().Y0)(),a=(0,r().K8)((()=>{var e;const o=null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.height;return o||N().bg.medium}),[t]),c=(0,n.useCallback)((e=>{const n=(0,Y().mg)(t);n.chartFormat||(n.chartFormat={}),n.chartFormat.height=e,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:l,canUndo:!0,perform:e=>{ee().zv({store:o.getFormatStore(),data:{chart_config:n},transaction:e})}})}),[t,o,l]),p=(0,n.useMemo)((()=>(0,F().WP)(m().WG).map((e=>{let[t,o]=e;const n=a===t;return{key:t,render:e=>(0,y.jsx)(se().A,{...e,title:(0,y.jsx)(d().sA,{...o}),isChecked:n}),action:()=>{c(t)}}}))),[a,c]);return(0,y.jsx)(me().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:e=>(0,y.jsx)(ve().A,{...e,showChevron:!0,title:(0,y.jsx)(d().sA,{...m().Zr.chartHeight}),icon:It().t,right:a?(0,y.jsx)(d().sA,{...m().WG[a]}):null}),renderExtension:(t,o)=>{const n=oo({title:(0,y.jsx)(d().sA,{...m().Zr.chartHeight}),device:s,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().A,{...n,children:(0,y.jsx)(pe().Ay,{type:pe().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"chartHeight",render:e=>(0,y.jsx)(u().A,{...e}),items:p}]})})}})}function Jt(e){const{chartConfig:t,collectionViewStore:o}=e,l=(0,i().v3)(),s=(0,i().Y0)(),a=(0,r().K8)((()=>{var e;const o=null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.axisGroupStyle;return o||N().PC.normal}),[t]),c=(0,n.useCallback)((e=>{const n=(0,Y().mg)(t);n.chartFormat||(n.chartFormat={axisGroupStyle:N().PC.normal}),n.chartFormat.axisGroupStyle=e,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:l,canUndo:!0,perform:e=>{ee().zv({store:o.getFormatStore(),data:{chart_config:n},transaction:e})}})}),[t,o,l]),p=(0,n.useMemo)((()=>(0,F().WP)(m().TP).map((e=>{let[t,o]=e;const n=a===t;return{key:t,render:e=>(0,y.jsx)(se().A,{...e,title:(0,y.jsx)(d().sA,{...o}),isChecked:n}),action:()=>{c(t)}}}))),[a,c]);return(0,y.jsx)(me().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:e=>(0,y.jsx)(ve().A,{...e,showChevron:!0,title:(0,y.jsx)(d().sA,{...m().Zr.chartGroupStyle}),icon:Ot,right:a?(0,y.jsx)(d().sA,{...m().TP[a]}):null}),renderExtension:(t,o)=>{const n=oo({title:(0,y.jsx)(d().sA,{...m().Zr.chartGroupStyle}),device:s,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().A,{...n,children:(0,y.jsx)(pe().Ay,{type:pe().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"groupStyles",render:e=>(0,y.jsx)(u().A,{...e}),items:p}]})})}})}function Xt(e){const t=(0,i().v3)(),o=(0,p().ET)(),l=(0,i().Y0)(),s=(0,r().K8)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisGridLine;return o||"horizontal"}),[e.chartConfig]),a=(0,n.useCallback)((n=>{const i=(0,Y().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={axisGridLine:N().JQ.horizontal}),i.chartFormat.axisGridLine=n,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_grid_line"})}),[e.chartConfig,t,e.collectionViewStore,o]),c=(0,n.useMemo)((()=>(0,F().WP)(m().G_).map((e=>{let[t,o]=e;const n=s===t;return{key:t,render:e=>(0,y.jsx)(se().A,{...e,title:(0,y.jsx)(d().sA,{...o}),isChecked:n}),action:()=>{a(t)}}}))),[s,a]);return(0,y.jsx)(me().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,y.jsx)(ve().A,{...t,showChevron:!0,title:(0,y.jsx)(d().sA,{...m().Zr.chartGridLine}),right:s?(0,y.jsx)(d().sA,{...m().G_[s]}):null,icon:kt,disabled:e.disabled}),renderExtension:(t,o)=>{const n=oo({title:(0,y.jsx)(d().sA,{...m().Zr.chartGridLine}),device:l,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().A,{...n,children:(0,y.jsx)(pe().Ay,{type:pe().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"gridStyles",render:e=>(0,y.jsx)(u().A,{...e}),items:c}]})})}})}function eo(e){const t=(0,i().v3)(),o=(0,i().Y0)(),l=(0,m().k1)(),s=(0,r().K8)((()=>{var t;return(null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisAvatar)||N().GL.avatar}),[e.chartConfig]),a=(0,n.useCallback)((o=>{const n=(0,Y().mg)(e.chartConfig);n.chartFormat||(n.chartFormat={axisAvatar:N().GL.avatar}),n.chartFormat.axisAvatar=o,te().createAndCommit({userAction:"chartSettings.updateAxisAvatarFormat",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:n,transaction:t})}})}),[e.chartConfig,e.collectionViewStore,t]),c=(0,n.useMemo)((()=>(0,F().WP)(m().RO).map((e=>{let[t,o]=e;const n=s===t;return{key:t,render:e=>(0,y.jsx)(se().A,{...e,title:(0,y.jsx)(d().sA,{...o}),isChecked:n}),action:()=>{a(t)}}}))),[s,a]);return(0,y.jsx)(me().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,y.jsx)(ve().A,{...t,showChevron:!0,title:(0,y.jsx)(d().sA,{...m().Zr.chartAxisAvatarFormat}),right:s?(0,y.jsx)("span",{style:J().RC,children:(0,y.jsx)(d().sA,{...m().RO[s]})}):null,rightStyle:l.avatarStyle,icon:Dt().personCircleFillIcon,disabled:e.disabled}),renderExtension:(t,n)=>{const i=oo({title:(0,y.jsx)(d().sA,{...m().Zr.chartAxisName}),device:o,onClickRight:n.close,popupEvents:t});return(0,y.jsx)(ue().A,{...i,children:(0,y.jsx)(pe().Ay,{type:pe().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"avatarStyles",render:e=>(0,y.jsx)(u().A,{...e}),items:c}]})})}})}function to(e){const t=(0,i().v3)(),o=(0,p().ET)(),l=(0,i().Y0)(),s=(0,r().K8)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.axisLabel;return o||N().tG.none}),[e.chartConfig]),a=(0,r().K8)((()=>"bar"===e.chartConfig.type),[e.chartConfig]),c=(0,n.useMemo)((()=>a?s===N().tG.x_axis?m().Le.y_axis:s===N().tG.y_axis?m().Le.x_axis:m().Le[s]:m().Le[s]),[a,s]),g=(0,n.useCallback)((n=>{const i=(0,Y().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={axisLabel:N().tG.none}),i.chartFormat.axisLabel=n,te().createAndCommit({userAction:"chartSettings.updateAxisLabel",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_axis_label"})}),[e.chartConfig,e.collectionViewStore,t,o]),S=(0,n.useMemo)((()=>{let e=(0,F().WP)(m().Le);if(a){const t=[];for(const[o,n]of e)o===N().tG.x_axis?t.push([N().tG.y_axis,n]):o===N().tG.y_axis?t.push([N().tG.x_axis,n]):t.push([o,n]);e=t}return e.map((e=>{let[t,o]=e;const n=s===t;return{key:t,render:e=>(0,y.jsx)(se().A,{...e,title:(0,y.jsx)(d().sA,{...o}),isChecked:n}),action:()=>{g(t)}}}))}),[a,s,g]);return(0,y.jsx)(me().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,y.jsx)(ve().A,{...t,showChevron:!0,title:(0,y.jsx)(d().sA,{...m().Zr.chartAxisName}),right:c?(0,y.jsx)(d().sA,{...c}):null,icon:Nt,disabled:e.disabled}),renderExtension:(t,o)=>{const n=oo({title:(0,y.jsx)(d().sA,{...m().Zr.chartAxisName}),device:l,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().A,{...n,children:(0,y.jsx)(pe().Ay,{type:pe().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"gridStyles",render:e=>(0,y.jsx)(u().A,{...e}),items:S}]})})}})}function oo(e){return e.device.isMobile?{menuType:ye().gu.ActionSheet,...e.popupEvents}:{menuType:ye().gu.Popup,width:200,...e.popupEvents}}function no(e){const t=(0,i().v3)(),o=(0,p().ET)(),r=(0,n.useMemo)((()=>{var t;return Boolean(null===(t=e.chartConfig)||void 0===t||null===(t=t.chartFormat)||void 0===t?void 0:t.smoothLine)}),[e.chartConfig]),l=(0,n.useCallback)((()=>{var n;const i=(0,Y().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={smoothLine:!1}),i.chartFormat.smoothLine=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.smoothLine),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_smooth_line"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,y.jsx)($t().A,{...e.menuListItemProps,title:(0,y.jsx)(d().sA,{...m().Zr.chartSmoothLine}),showChevron:!1,switcherProps:{on:r},icon:Vt,onClick:l,disabled:e.disabled})}function io(e){const t=(0,i().v3)(),o=(0,p().ET)(),r=(0,n.useMemo)((()=>{var t;return!(null!==(t=e.chartConfig)&&void 0!==t&&null!==(t=t.chartFormat)&&void 0!==t&&t.hideLineFillArea)}),[e.chartConfig]),l=(0,n.useCallback)((()=>{var n;const i=(0,Y().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={hideLineFillArea:!1}),i.chartFormat.hideLineFillArea=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.hideLineFillArea),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_area_fill"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,y.jsx)($t().A,{...e.menuListItemProps,title:(0,y.jsx)(d().sA,{...m().Zr.chartLineFillArea}),showChevron:!1,switcherProps:{on:r},icon:Pt,onClick:l,disabled:e.disabled})}function ro(e){var t;const o=(0,i().v3)(),r=(0,p().ET)(),{collectionViewStore:l,chartConfig:s,disabled:a}=e,c=(0,n.useMemo)((()=>{var e;return!(null!=s&&null!==(e=s.chartFormat)&&void 0!==e&&e.donutHideValue)}),[null==s||null===(t=s.chartFormat)||void 0===t?void 0:t.donutHideValue]),u=(0,n.useCallback)((()=>{var e;const t=(0,Y().mg)(s);t.chartFormat||(t.chartFormat={donutHideValue:!1}),t.chartFormat.donutHideValue=!(null!==(e=s.chartFormat)&&void 0!==e&&e.donutHideValue),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:o,canUndo:!0,perform:e=>{ee().zv({store:l.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),(0,X().X)({environment:o,collectionContextStore:r,action:"charts_style_donut_value"})}),[s,l,o,r]);return(0,y.jsx)($t().A,{...e.menuListItemProps,title:(0,y.jsx)(d().sA,{...m().Zr.chartShowDonutValue}),showChevron:!1,switcherProps:{on:c},icon:le().i,onClick:u,disabled:a})}function lo(e){var t;const o=(0,i().v3)(),r=(0,d().tz)(),s=(0,p().ET)(),{collectionViewStore:a,chartConfig:c,disabled:u}=e,g=(0,n.useMemo)((()=>{var e;return null==c||null===(e=c.chartFormat)||void 0===e?void 0:e.valueLabel}),[null==c||null===(t=c.chartFormat)||void 0===t?void 0:t.valueLabel]),S=(0,n.useCallback)((e=>{const t=(0,Y().mg)(c);t.chartFormat||(t.chartFormat={valueLabel:void 0}),t.chartFormat.valueLabel=e,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:o,canUndo:!0,perform:e=>{ee().zv({store:a.getFormatStore().getKeyStore("chart_config"),data:t,transaction:e})}}),(0,X().X)({environment:o,collectionContextStore:s,action:"charts_style_value_label"})}),[c,a,o,s]),f=(0,l().IS)((()=>({inputContainer:{padding:"4px 0",marginLeft:34,marginRight:4}})),[]);return(0,y.jsx)("div",{style:f.inputContainer,children:(0,y.jsx)(Ht().B,{initialValue:g||"",placeholder:r.formatMessage(m().Zr.chartValueLabelPlaceholder),onBlur:S,onChange:S,onSubmit:S,disabled:u})})}function so(e){const t=(0,i().v3)(),o=(0,p().ET)(),l=(0,r().K8)((()=>{var t;return(null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.weightColorValue)??!1}),[e.chartConfig]),s=(0,n.useCallback)((()=>{var n;const i=(0,Y().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={weightColorValue:!1}),i.chartFormat.weightColorValue=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.weightColorValue),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_weight_color_value"})}),[t,e.chartConfig,e.collectionViewStore,o]);return(0,y.jsx)($t().A,{...e.menuListItemProps,title:(0,y.jsx)(d().sA,{...m().Zr.chartWeightColorValue}),showChevron:!1,switcherProps:{on:l},icon:Ut().E,onClick:s,disabled:e.disabled})}function ao(e){const t=(0,i().v3)(),o=(0,p().ET)(),l=(0,mt().hu)(e.chartConfig),s=(0,r().K8)((()=>{var t;return!(null!==(t=e.chartConfig.chartFormat)&&void 0!==t&&t.hideLegend||l)}),[e.chartConfig,l]),a=(0,n.useCallback)((()=>{var n;const i=(0,Y().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={hideLegend:!1}),i.chartFormat.hideLegend=!(null!==(n=e.chartConfig.chartFormat)&&void 0!==n&&n.hideLegend),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_legend_toggle"})}),[t,e.chartConfig,e.collectionViewStore,o]);return l?null:(0,y.jsx)($t().A,{...e.menuListItemProps,title:(0,y.jsx)(d().sA,{...m().Zr.chartLegend}),showChevron:!1,switcherProps:{on:s},icon:Mt().n,onClick:a,disabled:e.disabled})}function co(e){let{collectionViewStore:t,chartConfig:o,disabled:s}=e;const a=(0,d().tz)(),c=(0,i().v3)(),u=(0,p().ET)(),{showCaption:g,caption:S}=(0,r().K8)((()=>{var e,t;return"placeholder"===o.type?{showCaption:!1,caption:""}:{showCaption:(null===(e=o.chartFormat)||void 0===e?void 0:e.showCaption)??!1,caption:(null===(t=o.chartFormat)||void 0===t?void 0:t.caption)??""}}),[o]),f=(0,n.useCallback)((()=>{const e=t.getChartFormatStore();e&&(te().createAndCommit({userAction:"chartSettings.setChartFormat.showCaption",environment:c,canUndo:!0,perform:t=>{ee().zv({store:e,data:{showCaption:!g},transaction:t})}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_style_show_caption"}))}),[t,c,u,g]),h=(0,n.useCallback)((e=>{const o=t.getChartFormatStore();o&&(te().createAndCommit({userAction:"chartSettings.setChartFormat.updateCaption",environment:c,canUndo:!0,perform:t=>{ee().zv({store:o,data:{caption:e},transaction:t})}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_style_update_caption"}))}),[u,t,c]),x=(0,l().IS)((()=>({captionInputContainer:{padding:"4px 0",marginLeft:34,marginRight:4}})),[]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ve().A,{title:(0,y.jsx)(d().sA,{...m().Zr.chartCaption}),showChevron:!1,right:(0,y.jsx)(Wt().A,{on:g,onClick:f,disabled:s}),icon:Lt().i,onClick:f,disabled:s}),(0,y.jsx)("div",{style:x.captionInputContainer,children:(0,y.jsx)(Ht().B,{initialValue:S,placeholder:a.formatMessage(m().Zr.chartCaptionPlaceholder),onBlur:h,onChange:h,onSubmit:h,disabled:s,textarea:!0,maxLength:Gt})})]})}function uo(e){let{collectionViewStore:t,chartConfig:o,disabled:l}=e;const s=(0,i().v3)(),a=(0,p().ET)(),c=(0,r().K8)((()=>(0,N().q_)(o)),[o]),u=(0,n.useCallback)((()=>{const e=(0,Y().mg)(o);e.chartFormat||(e.chartFormat={axisShowDataLabels:!0}),e.chartFormat.axisShowDataLabels=!c,te().createAndCommit({userAction:"chartSettings.setChartFormat.dataLabels",environment:s,canUndo:!0,perform:o=>{ee().zv({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}}),(0,X().X)({environment:s,collectionContextStore:a,action:"charts_style_data_labels"})}),[o,t,s,c,a]);return(0,y.jsx)(ve().A,{title:(0,y.jsx)(d().sA,{...m().Zr.chartDataLabels}),showChevron:!1,right:(0,y.jsx)(Wt().A,{on:c,onClick:u,disabled:l}),icon:le().i,onClick:u,disabled:l})}function po(e){const t=(0,i().v3)(),o=(0,p().ET)(),l=(0,i().Y0)(),s=(0,m().k1)(),a=(0,r().K8)((()=>{var t;const o=null===(t=e.chartConfig.chartFormat)||void 0===t?void 0:t.donutDataLabels;return o||N().D0.none}),[e.chartConfig]),c=(0,n.useCallback)((n=>{const i=(0,Y().mg)(e.chartConfig);i.chartFormat||(i.chartFormat={donutDataLabels:N().D0.none}),i.chartFormat.donutDataLabels=n,te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:t,canUndo:!0,perform:t=>{ee().zv({store:e.collectionViewStore.getFormatStore().getKeyStore("chart_config"),data:i,transaction:t})}}),(0,X().X)({environment:t,collectionContextStore:o,action:"charts_style_donut_data_labels"})}),[e.chartConfig,t,e.collectionViewStore,o]),g=(0,n.useMemo)((()=>(0,F().WP)(m().zH).map((e=>{let[t,o]=e;const n=a===t;return{key:t,render:e=>(0,y.jsx)(se().A,{...e,title:(0,y.jsx)(d().sA,{...o}),isChecked:n}),action:()=>{c(t)}}}))),[a,c]);return(0,y.jsx)(me().A,{...e.menuListItemProps,openOnFocus:!0,onFocus:e.parent.onFocus,renderOrigin:t=>(0,y.jsx)(ve().A,{...t,showChevron:!0,title:(0,y.jsx)(d().sA,{...m().Zr.chartDataLabels}),right:a?(0,y.jsx)("div",{style:{...s.donutDataLabelsRightText,...J().RC},children:(0,y.jsx)(d().sA,{...m().zH[a]})}):null,icon:le().i,disabled:e.disabled}),renderExtension:(t,o)=>{const n=oo({title:(0,y.jsx)(d().sA,{...m().Zr.chartDataLabels}),device:l,onClickRight:o.close,popupEvents:t});return(0,y.jsx)(ue().A,{...n,children:(0,y.jsx)(pe().Ay,{type:pe().Oh.Vertical,initialFocus:0,onAccept:e.parent.onAccept,sections:[{key:"donutDataLabelsStyle",render:e=>(0,y.jsx)(u().A,{...e}),items:g}]})})}})}var go=()=>o(457056),mo=()=>o(896628);function So(e){let{chartConfig:t,chartError:o,disabled:a}=e;const c=(0,i().v3)(),u=(0,p().ET)(),g=(0,d().tz)(),S=(0,l().IS)((e=>({errorIcon:{...(0,m().FE)(e),width:f().Ev.default,height:f().Ev.default}})),[]),h=(0,m().k1)(),x=(0,r().K8)((()=>u.collectionViewStore()),[u]),v=(0,r().O$)(u.normalizedSchemaStore),C=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),b=(0,r().K8)((()=>{if("groups_reducer"===(null==C?void 0:C.type)){const e="formula"===C.groupBy.type?C.groupBy.groupBy:C.groupBy;return(0,H().sj)(e)||(0,H().Ik)(e)?{type:"property_group",property:C.groupBy.property,groupByOption:e.groupBy}:{type:"property_group",property:C.groupBy.property}}if("results_reducer"===(null==C?void 0:C.type))return{type:"property_group",property:C.nameProperty}}),[C]),w=o&&(0,s().lc)(o)?()=>(0,Z().exclamationMarkTriangleFillIcon)(S.errorIcon):go().o,j=(0,r().K8)((()=>{const e=(0,F().WP)(v),t=[];return e.forEach((e=>{let[o,n]=e;if(n)if((0,H().iF)(n.type))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:H().PC.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Be().eD[e]),sectionName:be})))});else if((0,N().zn)(n))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:H().BI.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:g.formatMessage(Be().WK[e]),sectionName:be})))});else{if(!(0,H().Eg)(n))return;t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be})}})),t}),[v,g]),A=n.useCallback((e=>{var o,n;const{key:i}=e,{property:r,groupByOption:l}=i;if(!t||!x)return;const s=(0,$()._g)({schema:v,property:r}),a=(0,z().o_)({property:r,collectionSchema:v,hideEmptyGroups:Boolean(null===(o=t.chartFormat)||void 0===o?void 0:o.axisHideEmptyGroups)});if(!s||!a)return;const d=Object.keys(v),p="results_reducer"===t.dataConfig.type?t.dataConfig.valueProperty:d.find((e=>{const t=v[e];return Boolean(t&&(0,z().Iw)(t))})),g={aggregator:"count"};let S=Y().mg(t);if((0,z().tH)(s)&&p)S=(0,N().CN)({chartConfig:S,xAxisPropertyId:r,newDataConfigType:"results_reducer",valueProperty:p,groupBy:a});else if(l){var f;const e=(0,N().xS)({property:r,propertySchema:s,groupByOption:l,hideEmptyGroups:Boolean(null===(f=S.chartFormat)||void 0===f?void 0:f.axisHideEmptyGroups)});e&&(S=(0,N().CN)({chartConfig:S,xAxisPropertyId:r,newDataConfigType:"groups_reducer",groupBy:e,aggregation:g}))}else if(a){const e={aggregator:"count"};S=(0,N().CN)({chartConfig:S,xAxisPropertyId:r,newDataConfigType:"groups_reducer",groupBy:a,aggregation:e})}(0,m().Qn)({environment:c,collectionContextStore:u,chartConfig:S,sort:null===(n=S.chartFormat)||void 0===n?void 0:n.mainSort}),te().createAndCommit({userAction:"chartSettings.setXAxis",environment:c,canUndo:!0,perform:t=>{ee().zv({store:x.getFormatStore().getKeyStore("chart_config"),data:S,transaction:t}),"week"===e.key.groupByOption&&mo().Jo(x,t)}}),(0,X().X)({environment:c,collectionContextStore:u,action:"charts_x_axis_what_to_show",charts_analytics_context:(0,oe().nL)(u)})}),[t,x,v,c,u]);return(0,y.jsx)(R().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,s().lc)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,y.jsx)(ke,{...e,collectionContextStore:u,selectedProperty:b,properties:j,handlePropertySelect:A,originProps:{title:(0,y.jsx)("span",{children:(0,y.jsx)(d().sA,{...m().bg.chartWhatToShow})}),icon:w},callsite:"main_property",disabled:a,rightStyle:h.whatToShowRightText})})}function fo(e){let{collectionViewStore:t,chartConfig:o,disabled:l}=e;const s=(0,i().v3)(),a=(0,p().ET)(),u=(0,r().K8)((()=>{var e;return Boolean(null==o||null===(e=o.chartFormat)||void 0===e?void 0:e.axisHideEmptyGroups)}),[o]),g=n.useCallback((()=>{if(!o)return;const e=Y().mg(o);e.chartFormat={...e.chartFormat,axisHideEmptyGroups:!u},"groups_reducer"===e.dataConfig.type&&(e.dataConfig.groupBy.hideEmptyGroups=!u),te().createAndCommit({userAction:"chartSettings.setChartConfig",environment:s,canUndo:!0,perform:o=>{ee().zv({store:t.getFormatStore().getKeyStore("chart_config"),data:e,transaction:o})}}),(0,X().X)({environment:s,collectionContextStore:a,action:"charts_x_axis_hide_empty_groups",charts_analytics_context:(0,oe().nL)(a)})}),[o,t,s,u,a]);return(0,y.jsx)($t().A,{title:(0,y.jsx)(d().sA,{...m().Zr.chartHideEmptyGroups}),switcherProps:{on:u},onClick:g,icon:c().e,disabled:l})}const yo={viewBox:"0 0 20 20",fittedViewBox:"3.72 2.12 12.16 14.76",directional:!0,svg:(0,y.jsx)("path",{d:"M15.25 15.625a.625.625 0 1 1 0 1.25h-5a2.125 2.125 0 0 1-2.125-2.125V4.259L4.792 7.592a.625.625 0 1 1-.884-.884l4.4-4.4a.625.625 0 0 1 .884 0l4.4 4.4a.625.625 0 1 1-.884.884L9.375 4.259V14.75c0 .483.392.875.875.875z"})},ho=(0,f().wt)("arrowTurnLeftUp",yo),xo=(0,f().wt)("collectionChartCumulative",{viewBox:"0 0 16 16",svg:(0,y.jsxs)("g",{children:[(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.25 8C1.25 7.44772 1.69772 7 2.25 7H3.75C4.30228 7 4.75 7.44772 4.75 8V12C4.75 12.5523 4.30228 13 3.75 13H2.25C1.69772 13 1.25 12.5523 1.25 12V8ZM3.75 8L2.25 8V12H3.75V8Z"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.25 6C6.25 5.44772 6.69772 5 7.25 5H8.75C9.30228 5 9.75 5.44772 9.75 6V12C9.75 12.5523 9.30228 13 8.75 13H7.25C6.69772 13 6.25 12.5523 6.25 12V6ZM8.75 6L7.25 6V12H8.75V6Z"}),(0,y.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11.25 4C11.25 3.44772 11.6977 3 12.25 3H13.75C14.3023 3 14.75 3.44772 14.75 4V12C14.75 12.5523 14.3023 13 13.75 13H12.25C11.6977 13 11.25 12.5523 11.25 12V4ZM13.75 4L12.25 4V12H13.75V4Z"})]})}),vo=(0,f().wt)("decimals",{viewBox:"0 0 20 20",svg:(0,y.jsx)("g",{children:(0,y.jsx)("path",{d:"M15.124 14.287c-2.033 0-3.244-1.65-3.244-4.296 0-2.633 1.222-4.278 3.244-4.278 2.017 0 3.234 1.633 3.234 4.273s-1.205 4.301-3.234 4.301m0-1.205c1.114 0 1.749-1.137 1.749-3.09 0-1.931-.646-3.074-1.749-3.074-1.108 0-1.759 1.148-1.759 3.068 0 1.954.64 3.096 1.76 3.096Zm-7.461 1.205c-2.033 0-3.245-1.65-3.245-4.296 0-2.633 1.223-4.278 3.245-4.278 2.017 0 3.234 1.633 3.234 4.273s-1.206 4.301-3.234 4.301m0-1.205c1.114 0 1.748-1.137 1.748-3.09 0-1.931-.645-3.074-1.748-3.074-1.108 0-1.76 1.148-1.76 3.068 0 1.954.64 3.096 1.76 3.096m-5.198 1.103a.81.81 0 0 1-.823-.823c0-.457.36-.823.823-.823.457 0 .817.366.817.823a.81.81 0 0 1-.817.823"})})});var Co=()=>o(446966),bo=()=>o(72135),wo=()=>o(673900),jo=()=>o(374136),Ao=()=>o(66486);function _o(e){let{chartConfig:t,chartError:o,disabled:a}=e;const c=(0,d().tz)(),u=(0,i().v3)(),g=(0,p().ET)(),S=(0,l().IS)((e=>({errorIcon:{...(0,m().FE)(e),width:18,height:18,marginLeft:4}})),[]),f=(0,m().k1)(),h=(0,r().K8)((()=>g.collectionViewStore()),[g]),x=(0,r().K8)((()=>g.databaseType),[g]),v=(0,r().O$)(g.normalizedSchemaStore),C=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),b=(0,r().K8)((()=>{if(C)return"groups_reducer"===C.type?C.groupBy.property:C.nameProperty}),[C]),w=(0,r().K8)((()=>b?(0,$()._g)({schema:v,property:b}):void 0),[b,v]),j=(0,r().K8)((()=>{if(C)if("groups_reducer"===C.type){const e=C.aggregationConfig.aggregation;if((0,W().Iq)(e))return{type:"record_count"};if(Ie(e.aggregator)){const t=(0,$()._g)({schema:v,property:e.property});if(!t)return;return(0,N().JW)(t)||"unique"!==e.aggregator?{type:"aggregation",property:e.property,aggregation:e.aggregator}:{type:"property_group",property:e.property}}}else if("results_reducer"===C.type&&C.valueProperty)return{type:"aggregation",property:C.valueProperty,aggregation:"value"}}),[v,C]),A=(0,r().K8)((()=>{if(!C||!w)return[];const e=[];(0,F().WP)(v).forEach((t=>{let[o,n]=t;if(!n||o===b||!(0,H().Eg)(n))return;const i=[];(0,z().Iw)(n)&&(0,z().tH)(w)&&i.push({key:{type:"aggregation",property:o,aggregation:"value"},name:c.formatMessage(m().bg.chartAggregateByValues),sectionName:we});const r=(0,N().JW)(n);if(r){_e.forEach((e=>{const t={aggregator:e,property:o},n={key:{type:"aggregation",property:o,aggregation:e},name:(0,m().TQ)({aggregation:t,databaseType:x,intl:c})||"",sectionName:we};i.push(n)}));const e={key:{type:"aggregation",property:o,aggregation:"unique"},name:(0,m().TQ)({aggregation:{aggregator:"unique",property:o},databaseType:x,intl:c})||"",sectionName:we};i.push(e)}const l={key:{type:"property_group",property:o},name:n.name,sectionName:r?we:je,subMenuItems:i};e.push(l)}));return[{key:{type:"record_count"},name:(0,m().TQ)({aggregation:{aggregator:"count"},databaseType:x,intl:c})||"",sectionName:be},...e]}),[C,w,v,x,c,b]),_=(0,r().K8)((()=>o&&(0,s().dG)(o)?()=>(0,Z().exclamationMarkTriangleFillIcon)(S.errorIcon):ho),[o,S.errorIcon]),I=n.useCallback((e=>{h&&t&&b&&Pe({environment:u,menuItem:e,chartConfig:t,collectionSchema:v,collectionViewStore:h,collectionContextStore:g,mainPropertyId:b})}),[t,g,v,h,u,b]);return(0,y.jsx)(R().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,s().dG)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,y.jsx)(ke,{...e,collectionContextStore:g,selectedProperty:o&&!(0,s().xG)(o)?void 0:j,properties:A,handlePropertySelect:I,originProps:{title:(0,y.jsx)("span",{children:(0,y.jsx)(d().sA,{...m().bg.chartWhatToShow})}),icon:_},callsite:"aggregation_property",disabled:a,rightStyle:f.whatToShowRightText})})}function Io(e){let{chartConfig:t,chartError:o,disabled:a}=e;const c=(0,d().tz)(),u=(0,i().v3)(),g=(0,p().ET)(),S=(0,l().IS)((e=>({errorIcon:{...(0,m().FE)(e),width:f().Ev.default,height:f().Ev.default,marginLeft:4}})),[]),h=(0,m().k1)(),x=(0,r().O$)(g.normalizedSchemaStore),v=(0,r().K8)((()=>g.collectionViewStore()),[g]),C=(0,r().K8)((()=>{var e,o,n,i,r;if(!t||"groups_reducer"!==(null===(e=t.dataConfig)||void 0===e?void 0:e.type))return;const l=t.dataConfig.aggregationConfig,s="formula"===(null===(o=l.stackOptions)||void 0===o?void 0:o.groupBy.type)?null===(n=l.stackOptions)||void 0===n?void 0:n.groupBy.groupBy:null===(i=l.stackOptions)||void 0===i?void 0:i.groupBy,a=null===(r=l.stackOptions)||void 0===r?void 0:r.groupBy.property;return s&&a?(0,H().sj)(s)||(0,H().Ik)(s)?{type:"property_group",property:a,groupByOption:s.groupBy}:{type:"property_group",property:a}:{type:"none"}}),[t]),b=(0,r().K8)((()=>{const e=(0,F().WP)(x),t=[],o={key:{type:"none"},name:Oe().A.formatMessage(m().bg.noneMenuItem),sectionName:be};return t.push(o),e.forEach((e=>{let[o,n]=e;if(n)if((0,H().iF)(n.type))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:H().PC.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:c.formatMessage(Be().eD[e]),sectionName:be})))});else if((0,N().zn)(n))t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be,subMenuItems:H().BI.map((e=>({key:{type:"property_group",property:o,groupByOption:e},name:c.formatMessage(Be().WK[e]),sectionName:be})))});else{if(!(0,H().Eg)(n))return;t.push({key:{type:"property_group",property:o},name:n.name,sectionName:be})}})),t}),[x,c]),w=(0,r().K8)((()=>o&&(0,s().ic)(o)?()=>(0,Z().exclamationMarkTriangleFillIcon)(S.errorIcon):Ot),[o,S.errorIcon]),j=n.useCallback(((e,o)=>{var n,i;const r=(0,$()._g)({schema:x,property:e});if(!v||!r||!t||"groups_reducer"!==(null===(n=t.dataConfig)||void 0===n?void 0:n.type))return;const l=(0,N().xS)({property:e,propertySchema:r,groupByOption:o,hideEmptyGroups:!0});if(!l||!(0,H().rj)(l.type))return;const s=Y().mg(t);if("groups_reducer"!==s.dataConfig.type)return;const a=t.dataConfig.aggregationConfig;let c;if(s.dataConfig.aggregationConfig={...a,stackOptions:{groupBy:l}},"bar"===t.type||"column"===t.type)c=N().PC.normal;else if("line"===t.type){var d;c=null!==(d=t.chartFormat)&&void 0!==d&&d.axisCumulative?N().PC.normal:N().PC.side_by_side}const p=null===(i=t.chartFormat)||void 0===i?void 0:i.axisGroupStyle;s.chartFormat={...s.chartFormat,axisGroupStyle:p||c},te().createAndCommit({userAction:"chartSettings.setYAxisStackBy",environment:u,canUndo:!0,perform:e=>{ee().zv({store:v.getFormatStore().getKeyStore("chart_config"),data:s,transaction:e}),"week"===o&&mo().Jo(v,e)}}),(0,X().X)({environment:u,collectionContextStore:g,action:"charts_y_axis_group_by",charts_analytics_context:(0,oe().nL)(g)})}),[x,t,v,u,g]),A=n.useCallback((()=>{var e;if(!t||"groups_reducer"!==(null===(e=t.dataConfig)||void 0===e?void 0:e.type))return;const o=t.dataConfig.aggregationConfig;v&&te().createAndCommit({userAction:"chartSettings.clearYAxisStackBy",environment:u,canUndo:!0,perform:e=>{if(o){const n=Y().mg(t);if("groups_reducer"!==n.dataConfig.type)return;n.dataConfig.aggregationConfig={...o,stackOptions:void 0},ee().zv({store:v.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}})}),[v,t,u]),_=n.useCallback((e=>{const{key:t}=e;if("none"===t.type)A();else{const{property:e,groupByOption:o}=t;j(e,o)}}),[A,j]);return(0,y.jsx)(R().A,{textWrap:!0,placement:D().W.Left,disableTooltip:!o||!(0,s().ic)(o),renderTooltip:e=>o?(0,y.jsx)("span",{...e,children:(0,ne().y)(o)}):null,render:e=>(0,y.jsx)(ke,{...e,collectionContextStore:g,selectedProperty:C,properties:b,handlePropertySelect:_,originProps:{title:(0,y.jsx)("span",{style:J().RC,children:(0,y.jsx)(d().sA,{...m().bg.chartGroupBy})}),icon:w},callsite:"y_axis_stacked_groups",disabled:a,rightStyle:h.groupByRightText})})}function Mo(e){let{chartConfig:t,disabled:o}=e;const l=(0,i().v3)(),s=(0,p().ET)(),a=(0,r().K8)((()=>s.collectionViewStore()),[s]),c=(0,r().K8)((()=>{var e;return Boolean(null==t||null===(e=t.chartFormat)||void 0===e?void 0:e.axisCumulative)}),[t]),u=(0,n.useCallback)((()=>{var e,o;if(!a||!t)return;const n=Y().mg(t),i=!(null!==(e=n.chartFormat)&&void 0!==e&&e.axisCumulative);n.chartFormat={...n.chartFormat,axisCumulative:i};const r=Boolean("groups_reducer"===n.dataConfig.type&&(null===(o=n.dataConfig)||void 0===o||null===(o=o.aggregationConfig)||void 0===o||null===(o=o.stackOptions)||void 0===o?void 0:o.groupBy));"line"===t.type&&r&&i&&(n.chartFormat={...n.chartFormat,axisGroupStyle:N().PC.normal}),te().createAndCommit({userAction:"chartSettings.setCumulative",environment:l,canUndo:!0,perform:e=>{ee().zv({store:a.getFormatStore().getKeyStore("chart_config"),data:n,transaction:e})}}),(0,X().X)({environment:l,collectionContextStore:s,action:"charts_y_axis_cumulative",charts_analytics_context:(0,oe().nL)(s)})}),[t,a,l,s]);return t&&!(0,mt().CS)(t)?null:(0,y.jsx)($t().A,{title:(0,y.jsx)(d().sA,{...m().bg.chartCumulative}),switcherProps:{on:c},onClick:u,icon:xo,iconStyle:{height:18},disabled:o})}function ko(e){const{chartConfig:t,disabled:o}=e,s=null==t?void 0:t.chartFormat,a=(0,i().v3)(),c=(0,i().Y0)(),g=(0,d().tz)(),S=(0,r().uB)(void 0,xe().A),f=(0,p().ET)(),h=(0,r().K8)((()=>f.collectionViewStore()),[f]),x=void 0!==(null==s?void 0:s.yAxisMin)||void 0!==(null==s?void 0:s.yAxisMax),[v,C]=(0,n.useState)(void 0!==(null==s?void 0:s.yAxisMin)&&void 0!==(null==s?void 0:s.yAxisMax)&&s.yAxisMin>s.yAxisMax),[b,w]=(0,n.useState)(void 0!==(null==s?void 0:s.yAxisMin)&&void 0!==(null==s?void 0:s.yAxisMax)&&s.yAxisMin>s.yAxisMax),j=(0,n.useCallback)((e=>{if(!h||!t)return;var o,n;if("yAxisMin"in e&&"yAxisMax"in e){if(e.yAxisMin===(null===(o=t.chartFormat)||void 0===o?void 0:o.yAxisMin)&&e.yAxisMax===(null===(n=t.chartFormat)||void 0===n?void 0:n.yAxisMax))return}else if("yAxisMin"in e){var i;if(e.yAxisMin===(null===(i=t.chartFormat)||void 0===i?void 0:i.yAxisMin))return}else if("yAxisMax"in e){var r;if(e.yAxisMax===(null===(r=t.chartFormat)||void 0===r?void 0:r.yAxisMax))return}if("yAxisMin"in e){const t=void 0!==e.yAxisMin&&void 0!==(null==s?void 0:s.yAxisMax)&&e.yAxisMin>s.yAxisMax;if(C(t),t)return;void 0===e.yAxisMin&&C(!1)}if("yAxisMax"in e){const t=void 0!==e.yAxisMax&&void 0!==(null==s?void 0:s.yAxisMin)&&e.yAxisMax<s.yAxisMin;if(w(t),t)return;void 0===e.yAxisMax&&w(!1)}const l=h.getAxisChartFormatStore();l&&(te().createAndCommit({userAction:"chartSettings.setYAxisRange",environment:a,canUndo:!0,perform:t=>{ee().zv({store:l,data:Y().LG(e,(e=>void 0===e?null:e)),transaction:t})}}),(0,X().X)({environment:a,collectionContextStore:f,action:"charts_y_axis_range",charts_analytics_context:(0,oe().nL)(f)}))}),[t,null==s?void 0:s.yAxisMax,null==s?void 0:s.yAxisMin,f,h,a]),A=(0,n.useCallback)((e=>j({yAxisMin:e})),[j]),_=(0,n.useCallback)((e=>j({yAxisMax:e})),[j]),I=(0,n.useCallback)((()=>j({yAxisMin:void 0,yAxisMax:void 0})),[j]),M=(0,l().IS)((e=>({container:{paddingBottom:16},icon:{transform:"bar"===(null==t?void 0:t.type)?"rotate(90deg)":void 0},title:{display:"flex",justifyContent:"space-between",width:"100%"},resetButton:{float:"right",color:e.blueColor,cursor:"pointer"},inputContainer:{display:"flex",paddingLeft:14,paddingRight:14},separator:{color:e.text.secondary,margin:"0 8px"}})),[null==t?void 0:t.type]);return(0,y.jsx)(ce().A,{focused:!1,popupType:c.isMobile?ae().z7.SlideUp:ae().z7.Popup,alignmentToOrigin:ae().yP.End,placementToOrigin:ae().sx.Bottom,buttonPopupStore:S,renderOrigin:e=>(0,y.jsx)(ve().A,{...e,showChevron:!0,title:(0,y.jsx)(d().sA,{...m().bg.chartYAxisRange}),rotateChevron:S.state.open,icon:It().t,iconStyle:M.icon,disabled:o,right:(0,y.jsx)(d().sA,{...x?m().bg.chartYAxisRangeCustom:m().bg.chartYAxisRangeAuto})}),render:()=>(0,y.jsx)(u().A,{topBorder:!1,disableMobileBorders:!0,title:(0,y.jsx)("div",{style:M.title,children:(0,y.jsx)(d().sA,{...m().bg.chartYAxisRangeMenu})}),right:x?(0,y.jsx)(E().A,{style:M.resetButton,onClick:I,children:(0,y.jsx)(d().sA,{...m().bg.chartYAxisRangeReset})}):void 0,style:M.container,children:(0,y.jsxs)("div",{style:M.inputContainer,children:[(0,y.jsx)(wo().v,{value:null==s?void 0:s.yAxisMin,onBlur:A,onKeyDown:A,inputProps:{placeholder:g.formatMessage(m().bg.chartYAxisRangeMinPlaceholder),errorOutline:v}}),(0,y.jsx)("span",{style:M.separator,children:"-"}),(0,y.jsx)(wo().v,{value:null==s?void 0:s.yAxisMax,onBlur:_,onKeyDown:_,inputProps:{placeholder:g.formatMessage(m().bg.chartYAxisRangeMaxPlaceholder),errorOutline:b}})]})})})}function To(e){const{chartConfig:t,disabled:o}=e,s=null==t?void 0:t.chartFormat,a=(0,i().v3)(),c=(0,d().tz)(),u=(0,p().ET)(),g=(0,r().K8)((()=>u.collectionViewStore()),[u]),m=(0,r().O$)(u.normalizedSchemaStore),S=(0,r().K8)((()=>null==t?void 0:t.dataConfig),[t]),f=(0,r().K8)((()=>{if(S&&"results_reducer"===S.type)return S.valueProperty}),[S]),h=(0,r().K8)((()=>{if(f)return(0,$()._g)({schema:m,property:f})}),[f,m]),x=(0,r().K8)((()=>h?(0,jo().i5)(h):void 0),[h]),v=(0,n.useMemo)((()=>{const e=bo().iv.map((e=>({key:e,type:"button",title:(0,Ao().D)(c,e)})));return x&&"precision_uncapped"!==x?[...e,{key:"precision_from_number_property",type:"button",title:c.formatMessage({id:"collection.chartYAxisSettings.fromNumberProperty",defaultMessage:"Use property value ({value})"},{value:bo().Qq[x]})}]:e}),[c,x]),C=(0,n.useCallback)((e=>{if(!g||!t)return;const o=g.getAxisChartFormatStore();o&&(te().createAndCommit({userAction:"chartSettings.setYAxisPrecision",environment:a,canUndo:!0,perform:t=>{ee().zv({store:o,data:{numberPrecisionOverride:e},transaction:t})}}),(0,X().X)({environment:a,collectionContextStore:u,action:"charts_y_axis_precision",charts_analytics_context:(0,oe().nL)(u)}))}),[t,u,g,a]),b=(0,l().IS)((()=>({icon:{height:18}})),[]);return(0,y.jsx)(R().A,{placement:D().W.Right,textWrap:!0,renderTooltip:()=>(0,y.jsx)(d().sA,{defaultMessage:"Rounding defaults to 2 decimal places. Use this setting to override.",id:"database.chartSettings.numberOptions.numberPrecision.tooltip"}),render:e=>(0,y.jsx)(wt().A,{...e,icon:vo,iconStyle:b.icon,title:(0,y.jsx)(d().sA,{defaultMessage:"Decimal places",id:"database.chartSettings.numberOptions.numberPrecision"}),selectedKey:(null==s?void 0:s.numberPrecisionOverride)??bo().pS,options:v,onChange:C,disabled:o})})}function Po(e){let{disabled:t}=e;const o=(0,i().v3)(),l=(0,p().ET)(),s=(0,r().K8)((()=>l.collectionStore()),[l]),a=(0,r().K8)((()=>{var e;return Boolean(null==s||null===(e=s.getFormat())||void 0===e?void 0:e.subitem_property)}),[s]),c=(0,r().K8)((()=>l.collectionViewStore()),[l]),u=(0,r().K8)((()=>null==c?void 0:c.getFormat()),[c]),g=(0,r().K8)((()=>"flattened"===(null==u?void 0:u.subitem_display_mode)),[u]),S=(0,n.useCallback)((()=>{const e=null==c?void 0:c.getFormatStore();if(!e)return;const t="flattened"===(null==u?void 0:u.subitem_display_mode)?void 0:"flattened";te().createAndCommit({userAction:"chartSettings.setCountSubitems",environment:o,canUndo:!0,perform:o=>{ee().KY({store:e.getKeyStore("subitem_display_mode"),transaction:o,value:t})}}),(0,X().X)({environment:o,collectionContextStore:l,action:"charts_set_subitems",charts_analytics_context:(0,oe().nL)(l)})}),[c,o,l,u]);return a?(0,y.jsx)($t().A,{title:(0,y.jsx)(d().sA,{...m().bg.chartIncludeSubitems}),switcherProps:{on:g},onClick:S,icon:Co().E,iconStyle:{height:18},disabled:t}):null}var Bo=()=>o(34423);const Vo=n.memo((function(e){let{collectionSettingsStore:t}=e;const l=(0,i().v3)(),S=(0,d().tz)(),f=(0,p().ET)(),h=(0,r().O$)(f.normalizedSchemaStore),x=(0,r().K8)((()=>f.collectionViewStore()),[f]),v=(0,r().K8)((()=>f.normalizedFormatStore.state.chart_config),[f.normalizedFormatStore]),{canViewChart:C}=(0,o(714185).f)({collectionContextStore:f}),b=!C,w=(0,r().K8)((()=>{const e=(0,s().ye)({chartConfig:v,collectionSchema:h});if(void 0!==e)return e;return x?f.chartErrorStore.getState().get(x.id):void 0}),[v,f.chartErrorStore,h,x]),j=(0,r().O$)(f.isInHomeWidgetStore),A=(0,r().K8)((()=>{var e;const t=null===(e=f.collectionViewBlockStore())||void 0===e?void 0:e.id;return!!t&&(0,o(186445).sj)(t)}),[f]),_=(0,n.useMemo)((()=>A?{feature:"tasks",from:"tasks_more_menu"}:{feature:"custom_db",from:"custom_db_more_menu"}),[A]),I=!(0,r().O$)(f.permissionScopesStore).canConfigureBlock||b,M=Oo(I);return x&&h&&v&&"placeholder"!==v.type?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(u().A,{extraPadding:!0,style:{paddingTop:0,paddingBottom:4},children:(0,y.jsx)(o(404637).Ct,{collectionContextStore:f,collectionSettingsStore:t})}),(0,y.jsx)(u().A,{extraPadding:!0,topBorder:!0,style:{paddingBottom:4},title:S.formatMessage(m().bg.chartType),mobileStyle:{boxShadow:"none"},desktopTitleStyle:M.disabled,mobileTitleStyle:M.disabled,children:(0,y.jsx)(O,{chartConfig:v,disabled:I})}),"donut"===v.type?(0,y.jsx)(Eo,{chartConfig:v,chartError:w,disabled:I}):null,(0,a().m)(v)?"bar"===v.type?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Do,{chartConfig:v,chartError:w,disabled:I,useXAxisLabel:!0}),(0,y.jsx)(Ro,{collectionViewStore:x,chartConfig:v,chartError:w,disabled:I,useYAxisLabel:!0})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(Ro,{collectionViewStore:x,chartConfig:v,chartError:w,disabled:I}),(0,y.jsx)(Do,{chartConfig:v,chartError:w,disabled:I})]}):null,(0,y.jsx)(Ko,{collectionContextStore:f,chartConfig:v,paywallDisabled:Boolean(b)}),(0,y.jsx)(Fo,{collectionContextStore:f,collectionSettingsStore:t,paywallDisabled:Boolean(b)}),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(u().A,{extraPadding:!0,topBorder:!0,children:[(0,y.jsx)(nt,{chartConfig:v,disabled:I}),(0,y.jsx)(o(403217).z,{collectionContextStore:f,collectionSettingsStore:t}),j&&(0,y.jsx)(ve().A,{icon:c().e,title:S.formatMessage(o(885749).u.hide),showChevron:!1,onClick:()=>{g().default.state.currentSpaceViewStore&&o(980151).WO({environment:l,currentSpaceViewStore:g().default.state.currentSpaceViewStore,..._})}})]}),(0,y.jsx)(u().A,{extraPadding:!0,topBorder:!0,children:(0,y.jsx)(o(95441).A,{href:(0,o(836251).xS)("guides.charts"),title:(0,y.jsx)(d().sA,{...m().bg.chartHelp}),analyticsFrom:"view_settings_charts_help"})})]})]}):null}));function Fo(e){const{collectionContextStore:t,collectionSettingsStore:n,paywallDisabled:i}=e;return(0,y.jsxs)(u().A,{extraPadding:!0,topBorder:!0,children:[(0,y.jsx)(o(542984).A,{collectionContextStore:t,collectionSettingsStore:n,disabled:i}),(0,y.jsx)(o(704640).A,{collectionContextStore:t,collectionSettingsStore:n,disabled:i})]})}function Eo(e){const t=Oo(e.disabled);return(0,y.jsxs)(u().A,{extraPadding:!0,style:{paddingTop:4,paddingBottom:4},title:(0,y.jsx)(d().sA,{...m().bg.chartData}),desktopTitleStyle:t.disabled,mobileTitleStyle:t.disabled,children:[(0,y.jsx)(Ve,{...e}),(0,y.jsx)(Fe,{...e}),(0,y.jsx)(jt,{...e,sortType:"main"}),(0,y.jsx)(Po,{disabled:e.disabled})]})}function Ro(e){const{collectionViewStore:t,useYAxisLabel:o,...n}=e,i=Oo(e.disabled),l=(0,r().K8)((()=>{if("groups_reducer"===e.chartConfig.dataConfig.type)return e.chartConfig.dataConfig.groupBy}),[e.chartConfig.dataConfig]);return(0,y.jsxs)(u().A,{extraPadding:!0,title:o?(0,y.jsx)(d().sA,{...m().bg.chartYAxis}):(0,y.jsx)(d().sA,{...m().bg.chartXAxis}),style:{paddingTop:4,paddingBottom:4},desktopTitleStyle:i.disabled,mobileTitleStyle:i.disabled,children:[(0,y.jsx)(So,{...n}),l?(0,y.jsx)(Bo().T,{groupBy:l}):null,(0,y.jsx)(jt,{...n,sortType:"main"}),(0,y.jsx)(fo,{...e})]})}function Do(e){var t,o;const{useXAxisLabel:n,disabled:i}=e,l=Oo(i),s=(0,r().K8)((()=>{var t;if("results_reducer"===e.chartConfig.dataConfig.type)return;return null===(t=e.chartConfig.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy}),[e.chartConfig.dataConfig]),a=(0,r().K8)((()=>{var t;const o=null===(t=e.chartConfig)||void 0===t?void 0:t.dataConfig;return"results_reducer"===(null==o?void 0:o.type)||"groups_reducer"===(null==o?void 0:o.type)&&("max"===o.aggregationConfig.aggregation.aggregator||"min"===o.aggregationConfig.aggregation.aggregator||"median"===o.aggregationConfig.aggregation.aggregator||"average"===o.aggregationConfig.aggregation.aggregator||"sum"===o.aggregationConfig.aggregation.aggregator)}),[null===(t=e.chartConfig)||void 0===t?void 0:t.dataConfig]);return(0,y.jsxs)(u().A,{extraPadding:!0,title:n?(0,y.jsx)(d().sA,{...m().bg.chartXAxis}):(0,y.jsx)(d().sA,{...m().bg.chartYAxis}),style:{paddingTop:4,paddingBottom:4},desktopTitleStyle:l.disabled,mobileTitleStyle:l.disabled,children:[(0,y.jsx)(_o,{...e}),a&&(0,y.jsx)(To,{...e}),"groups_reducer"!==(null===(o=e.chartConfig)||void 0===o||null===(o=o.dataConfig)||void 0===o?void 0:o.type)?null:(0,y.jsx)(Io,{...e}),s?(0,y.jsx)(Bo().T,{groupBy:s}):null,s?(0,y.jsx)(jt,{...e,sortType:"stacked"}):null,(0,y.jsx)(Mo,{...e}),(0,y.jsx)(ko,{...e}),(0,y.jsx)(Po,{disabled:e.disabled})]})}function Ko(e){let{collectionContextStore:t,chartConfig:o,paywallDisabled:n}=e;const i=(0,r().K8)((()=>t.collectionViewStore()),[t]),l=(0,r().O$)(t.permissionScopesStore),s=(0,r().K8)((()=>!o||!l.canConfigureBlock||n),[o,l.canConfigureBlock,n]),a=Oo(s);return i&&o&&"placeholder"!==o.type?(0,y.jsxs)(u().A,{extraPadding:!0,style:{paddingTop:4},title:(0,y.jsx)(d().sA,{...m().bg.chartStyle}),desktopTitleStyle:a.disabled,mobileTitleStyle:a.disabled,children:[(0,y.jsx)(Qt,{collectionViewStore:i,chartConfig:o,disabled:s}),(0,y.jsx)(Zt,{collectionViewStore:i,chartConfig:o,disabled:s})]}):null}function Oo(e){return(0,l().IS)((()=>({disabled:{opacity:e?.4:void 0}})),[e])}},536308:(e,t,o)=>{o.r(t),o.d(t,{formEditorActions:()=>n()});var n=()=>o(958102)},546754:(e,t,o)=>{o.d(t,{N:()=>a,u:()=>s});o(296540);var n=()=>o(496603),i=()=>o(645873),r=o(474848);const l=new(i().O2)("builder-modals",(()=>Promise.all([o.e(75134),o.e(16471),o.e(96346),o.e(62475),o.e(3151),o.e(98629),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(56952),o.e(25497),o.e(74562),o.e(27711),o.e(4422),o.e(24587),o.e(6912),o.e(30291),o.e(54220),o.e(82122),o.e(28464),o.e(19930),o.e(81768),o.e(26483),o.e(6463),o.e(282),o.e(31276),o.e(40863),o.e(63996),o.e(63797),o.e(79665)]).then(o.bind(o,80524)))),s=(0,i()._h)(l,(e=>e.AutomationBuilderModal),{renderLoading:()=>(0,r.jsx)(c,{})}),a=(0,i()._h)(l,(e=>e.ButtonBuilderModal),{renderLoading:()=>(0,r.jsx)(c,{})});function c(){return(0,r.jsx)(o(401634).i,{handleOnDismiss:n().lQ,canSave:!1,handleOnSave:n().lQ,mode:"loading",children:(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden"},children:(0,r.jsx)(o(331542).A,{})})})}},554840:(e,t,o)=>{o.d(t,{e:()=>N,a:()=>z});o(898992),o(354520);var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(401497),s=()=>o(955363),a=()=>o(959013),c=()=>o(534177),d=()=>o(284371),u=()=>o(406699),p=()=>o(928600),g=()=>o(897119),m=()=>o(722872),S=()=>o(760578),f=()=>o(463830),y=(o(944114),o(581454),o.n(o(844751))),h=()=>o(651124),x=()=>o(390066),v=()=>o(30626),C=()=>o(496603),b=()=>o(736767),w=()=>o(760217),j=()=>o(419357),A=()=>o(939740),_=()=>o(89924),I=()=>o(250202),M=()=>o(852353),k=()=>o(972435),T=()=>o(970585),P=o(474848);const B=2,V=(0,a().YK)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertySelect.inputPlaceholder"}});function F(e){const{currentProperty:t,getGroupedProperties:o,onAccept:s,renderProperty:d,inputPlaceholder:u,schema:p,format:g,defaultShowPropertyGroupCount:m}=e,S=(0,i().Y0)(),f=(0,r().uB)(void 0,T().A),A=(0,r().K8)((()=>o()),[o]),[I,F]=(0,n.useState)(!1),[D,K]=(0,n.useState)(""),O=(0,x().L)(g,p,void 0,h().jf.Page).collection_page_properties||[],L=(0,n.useCallback)((e=>{K(e.target.value),f.setState({...f.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}}),F(!1)}),[f]),z=(0,l().IS)((e=>({dotsIcon:{width:16,fill:e.text.secondary,marginLeft:4,marginRight:2},showMoreButton:{color:e.text.secondary}})),[]),N=C().Ul(A,(e=>Math.min(...e.map((e=>O.findIndex((t=>t.property===e))))))),U=[{key:"input",comp:(0,P.jsx)(_().A,{children:(0,P.jsx)(j().Ay,{focusInitial:!S.isMobile||void 0,focus:!S.isMobile||void 0,value:D,onChange:L,placeholder:u||k().A.formatMessage(V.inputPlaceholder)})})}];if(D){const e=N.map((e=>e.filter((e=>{const t=p[e],o=t?`${t.name} ${M().dC[t.type]}`:"";return Boolean(y().match(D,o))})))).filter((e=>e.length>0));if(0===e.length)U.push({key:"noResults",comp:(0,P.jsx)(b().A,{caption:(0,P.jsx)(a().sA,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});else{const o=[{key:"results",render:e=>(0,P.jsx)(_().A,{...e}),items:e.flat().map((e=>R({onAccept:s,property:e,schema:p,currentProperty:t,renderProperty:d}))).filter(c().O9)}];U.push(E({sections:o,menuListStore:f}))}}else{const e=m||B;let o,n;if(!I&&N.length>e){o=N.slice(0,e);const t=C().cz(N.slice(e).map((e=>e.length)));n={key:"show_more",render:e=>(0,P.jsx)(w().A,{...e,icon:(0,v()._)(z.dotsIcon),style:z.showMoreButton,title:(0,P.jsx)(a().sA,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:t}})}),action:()=>{F(!0)}}}else o=N;const i=o.map(((e,i)=>({key:e.join("-"),render:e=>(0,P.jsx)(_().A,{...e,topBorder:0!==i}),items:e.map((e=>R({onAccept:s,property:e,schema:p,currentProperty:t,renderProperty:d}))).concat(i===o.length-1?[n]:[]).filter(c().O9)})));U.push(E({sections:i,menuListStore:f}))}return(0,P.jsx)(P.Fragment,{children:U.map((e=>{let{key:t,comp:o}=e;return(0,P.jsx)(n.Fragment,{children:o},t)}))})}function E(e){const{menuListStore:t,sections:o}=e;return{key:"properties",comp:(0,P.jsx)(A().Ay,{type:A().Oh.Vertical,initialFocus:0,sections:o,store:t})}}function R(e){const{schema:t,currentProperty:o,onAccept:n,renderProperty:i,property:r}=e,l=t[r];if(!l)return;return{key:r,render:e=>{const t=r===o;return i?i(e,r,t,l):(0,P.jsx)(I().G,{...e,propertySchema:l,format:I().e.Name,isChecked:t})},action:()=>{n(r)}}}var D=()=>o(497222),K=()=>o(380468),O=()=>o(148079),L=()=>o(334955);function z(e){const{currentPropertyId:t,feature:o,collectionContextStore:n,permissionScopes:i,onPropertySelect:l,buttonPopupStore:d,disabled:u}=e,p=(0,a().tz)(),g=(0,r().K8)((()=>{var e,t;return"subitem"===o?null===(e=n.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:"timeline_arrows_by"===o?null===(t=n.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void(0,c().HB)(o)}),[o,n]),m=(0,r().K8)((()=>n.databaseType),[n]),{handleDefaultPropertySelect:f,handlePropertySelect:y,getProperties:h}=(0,L().Tv)({collectionContextStore:n,feature:o,onPropertySelect:l}),x=(0,S().uX)({feature:o,databaseType:m});return(0,P.jsx)(U,{intl:p,icon:s().arrowDiagonalUpRightIcon,caption:(0,P.jsx)(a().sA,{...x}),collectionContextStore:n,buttonPopupStore:d,shouldGroupProperties:!0,getGroupedProperties:h,currentProperty:t,disabled:u,onAccept:i.canConfigureBlock&&i.canConfigureCollection?y:()=>{},renderProperty:(e,t,i,r)=>(0,P.jsx)(O().A,{version:"v2",feature:o,menuProps:e,property:t,defaultProperty:g,isChecked:i,propertySchema:r,collectionContextStore:n,handleDefaultPropertySelect:f,handlePropertySelect:y})})}function N(e){const{currentPropertyId:t,collectionContextStore:o,onPropertyChanged:i,disabled:l,title:s}=e,d=(0,a().tz)(),u=(0,r().uB)(void 0,f().A),p=(0,r().O$)(o.normalizedSchemaStore),g=(0,n.useCallback)((()=>Object.keys(p).filter((e=>{const t=p[e];return"date"===(null==t?void 0:t.type)})).filter(c().O9)),[p]);return(0,P.jsx)(U,{intl:d,buttonPopupStore:u,title:s,collectionContextStore:o,shouldGroupProperties:!1,getProperties:g,currentProperty:t,disabled:l,onAccept:e=>{e&&i(e),u.setState({open:!1})}})}function U(e){const{currentProperty:t,icon:o,caption:n,buttonPopupStore:s,collectionContextStore:c,disabled:S,title:f,shouldGroupProperties:y}=e,h=(0,i().Y0)(),x=(0,r().K8)((()=>{var e;return(null===(e=c.collectionStore())||void 0===e?void 0:e.getFormat())??{}}),[c]),v=(0,r().O$)(c.normalizedSchemaStore),C=(0,l().IS)((e=>({caption:{fontSize:h.isMobile?d().J.UISmall.mobile:d().J.UISmall.desktop,color:e.text.secondary,margin:"0 12px 12px 14px"}})),[h]),b=(0,r().K8)((()=>s.state.open),[s]),w=(0,r().K8)((()=>h.isPhone?{menuType:m().gu.ActionSheet}:{menuType:m().gu.Popup,width:300}),[h.isPhone]);return(0,P.jsxs)(P.Fragment,{children:[n&&(0,P.jsx)("div",{style:C.caption,children:n}),(0,P.jsx)(u().Ay,{popupType:h.isPhone?g().nl.SlideUp:g().nl.Popup,alignmentToOrigin:u().yP.End,placementToOrigin:u().sx.Bottom,disabled:S,originGap:0,renderOrigin:e=>{var n;return(0,P.jsx)(D().A,{title:f??(0,P.jsx)(a().sA,{id:"database.viewSettings.relationFeatures.propertyPicker.default.title",defaultMessage:"Property"}),showChevron:!0,right:t?(0,P.jsx)("span",{style:d().RC,children:null===(n=v[t])||void 0===n?void 0:n.name}):void 0,rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},rotateChevron:b,disabled:S,icon:o,...e})},render:t=>(0,P.jsx)(p().A,{...w,children:y?(0,P.jsx)(F,{...e,getGroupedProperties:e.getGroupedProperties,format:x,schema:v}):(0,P.jsx)(K().A,{getProperties:e.getProperties,currentProperty:e.currentProperty,onAccept:e.onAccept,format:x,schema:v})}),buttonPopupStore:s})]})}},578565:(e,t,o)=>{o.d(t,{_:()=>Og});var n=o(296540),i=()=>o(402014),r=()=>o(484714),l=()=>o(56366),s=()=>o(498212),a=()=>o(679924),c=()=>o(217429);function d(e,t){(0,a().v)(e,"view_settings",t),c().default.logEvent("view_settings",t.menu,t)}var u=()=>o(686526),p=()=>o(896628),g=()=>o(751156),m=()=>o(546754),S=(o(581454),()=>o(401497)),f=()=>o(959013),y=()=>o(735695),h=()=>o(785285),x=()=>o(617668),v=()=>o(992437),C=()=>o(380468),b=()=>o(406699),w=()=>o(554509),j=()=>o(864943),A=()=>o(204063);o(898992),o(354520);function _(e){const{conditionalColorRule:t,collectionContextStore:o,transaction:n,newColorRule:i}=e,r=o.collectionViewStore(),l=o.normalizedFormatStore.state.conditional_color_rules;if(!r||!l)return;const s=[...l],a=s.findIndex((e=>e.id===t.id));-1!==a&&(s[a]={...s[a],...i},p().zA({stores:[r],update:{conditional_color_rules:s},transaction:n}))}var I=()=>o(206267),M=()=>o(205098);var k=o(474848);function T(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const i=(0,l().O$)(t.normalizedSchemaStore),s=(0,l().O$)(t.normalizedFormatStore),a=(0,r().v3)(),c=(0,l().K8)((()=>!s.conditional_color_rules||0===s.conditional_color_rules.length),[s]),d=(0,l().K8)((()=>t.collectionViewStore()?(0,h().Mz)({schema:i}):[]),[t,i]),m=(0,n.useCallback)((e=>{var n;if(!e)return;const r=(null===(n=t.collectionViewBlockStore())||void 0===n?void 0:n.getRecordModel)??v().b.constant(void 0),l=function(e){const{propertyId:t,schema:o,getRecordModel:n}=e,i=(0,M().SN)({property:t,schema:o,getRecordModel:n});return{id:(0,I().JW)(),conditional_filter:{property:t,filter:i},properties_to_color:{type:"all"}}}({propertyId:e,schema:i,getRecordModel:r});l&&(c&&function(e){u().dP({collectionSettingsStore:e,item:{type:"conditionalColors"}})}(o),g().createAndCommit({userAction:"AddConditionalColorRuleButton.handlePropertyAccept",environment:a,canUndo:!0,perform:e=>{!function(e){const{collectionContextStore:t,conditionalColorRule:o,transaction:n}=e,i=t.collectionViewStore();if(!i)return;const r=[...t.normalizedFormatStore.state.conditional_color_rules??[],o];p().zA({stores:[i],update:{conditional_color_rules:r},transaction:n})}({collectionContextStore:t,conditionalColorRule:l,transaction:e})}}))}),[t,o,a,c,i]),S=c?A().A:j().A,y={width:"100%",justifyContent:"center",padding:"6px 12px"};return(0,k.jsx)(b().Ay,{popupType:b().z7.Popup,sameWidthAsOrigin:!0,originGap:4,renderOrigin:e=>(0,k.jsx)(S,{...e,iconLeading:x().plusIcon,iconStyle:{width:16,height:16},style:y,children:(0,k.jsx)(w().D,{styleName:"UIRegular-14px/Regular",colorName:c?"contrastPrimary":"primary",children:c?(0,k.jsx)(f().sA,{defaultMessage:"New color setting",id:"database.viewSettings.createConditionalColorTab.newColorSetting"}):(0,k.jsx)(f().sA,{defaultMessage:"Add another",id:"database.viewSettings.conditionalColorsTab.addAnother"})})}),render:e=>(0,k.jsx)(C().A,{schema:i,format:s,getProperties:()=>d,onAccept:t=>{m(t),e.close()}})})}var P=()=>o(395361),B=()=>o(859794),V=()=>o(803960),F=()=>o(29037),E=()=>o(381349),R=()=>o(491073),D=()=>o(493823),K=()=>o(802790),O=()=>o(780054),L=()=>o(463830);function z(e){let{ruleColor:t,onColorChange:o}=e;const n=(0,l().uB)(void 0,L().A),i="match_property_value"===(null==t?void 0:t.type),r="custom"===(null==t?void 0:t.type)?t.color:"default_background",s=(0,l().K8)((()=>n.state.open),[n]),a=(0,S().IS)((e=>({colorMenuButton:{display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",gap:8,padding:4,height:24},matchOptionButton:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",padding:"16px 12px",borderRadius:4},matchOptionButtonHovered:{cursor:"pointer",background:e.background.weak},checkIcon:{width:14,height:14,fill:e.icon.primary,marginLeft:"auto",display:"flex",alignItems:"center"},colorGrid:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:4,padding:"12px"},chevronIcon:{width:12,fill:e.icon.tertiary,transform:s?void 0:"rotate(-90deg)",transition:"transform 0.2s ease"}})),[s]);return(0,k.jsx)(b().Ay,{popupType:O().A.isMobile?b().z7.BottomSheet:b().z7.Popup,buttonPopupStore:n,renderOrigin:e=>(0,k.jsxs)("div",{...e,style:a.colorMenuButton,children:[i?(0,k.jsx)(w().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:(0,k.jsx)(f().sA,{defaultMessage:"Match option",id:"CollectionSettingsViewConditionalColorRule.matchOption"})}):(0,k.jsx)(R().Kc,{color:r,isHovered:!1,selected:!1,overrideStyles:{width:16,height:16,borderRadius:4}}),(0,V().arrowChevronSingleDownIcon)(a.chevronIcon)]}),render:e=>(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(D().p,{style:a.matchOptionButton,onClick:()=>{o("match_property_value"),e.close()},hoveredStyle:a.matchOptionButtonHovered,children:[(0,k.jsx)(w().D,{styleName:"UIRegular-14px/Regular",colorName:"primary",children:(0,k.jsx)(f().sA,{defaultMessage:"Match option",id:"CollectionSettingsViewConditionalColorRule.matchOption"})}),s&&i&&(0,F().checkmarkIcon)(a.checkIcon)]}),(0,k.jsx)(K().A,{size:1,colorName:"weak",type:"horizontal",style:{padding:"0px 12px"}}),(0,k.jsx)("div",{style:a.colorGrid,children:E().AQ.map((t=>{const n=t===r&&!i;return(0,k.jsx)(R().Ay,{color:t,style:{width:"100%"},onClick:()=>{o(t),e.close()},focused:n,shouldShowUpdatedColorPicker:!0},t)}))})]})})}function N(e){const{collectionContextStore:t,conditionalColorRule:o}=e,i=(0,l().O$)(t.normalizedSchemaStore),s=(0,l().K8)((()=>t.collectionViewStore()),[t]),a=(0,r().v3)(),c=(0,S().IS)((e=>({container:{background:e.surface.wash,display:"flex",flexDirection:"column",alignItems:"stretch",borderRadius:10,border:`1px solid ${e.surface.wash}`,width:"100%"},row:{display:"flex",alignItems:"center",padding:"0px 12px 4px 12px",marginTop:"-4px"}})),[]),d=(0,n.useCallback)((()=>{g().createAndCommit({userAction:"CollectionSettingsViewConditionalColorRule.handleDeleteConditionalColorRule",environment:a,canUndo:!0,perform:e=>{!function(e){const{conditionalColorRule:t,collectionContextStore:o,transaction:n}=e,i=o.collectionViewStore(),r=o.normalizedFormatStore.state.conditional_color_rules;if(!i||!r)return;const l=r.filter((e=>e.id!==t.id));p().zA({stores:[i],update:{conditional_color_rules:l},transaction:n})}({collectionContextStore:t,conditionalColorRule:o,transaction:e})}})}),[t,a,o]),u=(0,n.useCallback)((e=>{const n={conditional_filter:{property:o.conditional_filter.property,filter:e}};g().createAndCommit({userAction:"CollectionSettingsViewConditionalColorRule.handleFilterValueChange",environment:a,canUndo:!0,perform:e=>{_({collectionContextStore:t,conditionalColorRule:o,transaction:e,newColorRule:n})}})}),[t,a,o]),m=(0,P().Y)(u,250),y=(0,n.useCallback)((e=>{const n={background:"match_property_value"===e?{type:"match_property_value"}:{type:"custom",color:e}};g().createAndCommit({userAction:"CollectionSettingsViewConditionalColorRule.handleColorChange",environment:a,canUndo:!0,perform:e=>{_({collectionContextStore:t,conditionalColorRule:o,transaction:e,newColorRule:n})}})}),[t,a,o]);return i&&s?(0,k.jsxs)("div",{style:c.container,children:[(0,k.jsx)(B().td,{propertyFilter:o.conditional_filter,schema:i,parentStore:s,userCanConfigureFilters:!0,allowRelativePersonFilter:!1,context:B().mL.ConditionalColorRule,onDelete:d,onChange:u,onChangeDebounced:m}),(0,k.jsxs)("div",{style:c.row,children:[(0,k.jsx)(w().D,{styleName:"UIRegular-14px/Regular",colorName:"primary",style:{flex:1},children:(0,k.jsx)(f().sA,{defaultMessage:"Card background",id:"CollectionSettingsViewConditionalColorRule.cardBackground"})}),(0,k.jsx)(z,{ruleColor:o.background,onColorChange:y})]})]}):null}function U(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,l().K8)((()=>t.normalizedFormatStore.state.conditional_color_rules),[t.normalizedFormatStore]),i=(0,S().IS)((()=>({container:{padding:"12px 16px",display:"flex",flexDirection:"column",alignItems:"flex-start",gap:12,alignSelf:"stretch"}})),[]);return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Conditional colors",id:"database.viewSettings.conditionalColorsTab.title"}),children:(0,k.jsxs)("div",{style:i.container,children:[null==n?void 0:n.map((e=>(0,k.jsx)(N,{collectionContextStore:t,conditionalColorRule:e},e.id))),(0,k.jsx)(T,{collectionContextStore:t,collectionSettingsStore:o})]})})}var W=()=>o(148307);function H(e){const{collectionSettingsStore:t,collectionContextStore:o}=e,n=(0,S().IS)((e=>({descriptionContainer:{margin:"16px 0"},container:{display:"flex",flexDirection:"column",margin:"12px 16px"},previewImage:{maxWidth:"100%",height:"auto",borderRadius:6,border:`1px solid ${e.stroke.secondary}`}})),[]);return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Color",id:"database.viewSettings.createConditionalColorTab.title"}),children:(0,k.jsxs)("div",{style:n.container,children:[(0,k.jsx)("img",{src:W().A.images.tooltips.collectionSettings.conditionalColorPreviewPng,style:n.previewImage,alt:"Conditional color preview showing how calendar tiles can be colored based on property values"}),(0,k.jsx)("div",{style:n.descriptionContainer,children:(0,k.jsx)(w().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:(0,k.jsx)(f().sA,{defaultMessage:"Customize page colors to easily distinguish categories, highlight overdue events, and bring clarity to your timeline.",id:"database.viewSettings.createConditionalColorTab.description"})})}),(0,k.jsx)(T,{collectionContextStore:o,collectionSettingsStore:t})]})})}var $=()=>o(623580),G=()=>o(545805),Q=()=>o(645873);const Z=new(Q().O2)("database-automations",(()=>Promise.all([o.e(75134),o.e(16471),o.e(96346),o.e(62475),o.e(3151),o.e(98629),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(56952),o.e(25497),o.e(74562),o.e(27711),o.e(4422),o.e(24587),o.e(6912),o.e(30291),o.e(54220),o.e(82122),o.e(28464),o.e(19930),o.e(81768),o.e(26483),o.e(6463),o.e(282),o.e(31276),o.e(40863),o.e(63996),o.e(63797),o.e(79665)]).then(o.bind(o,439442)))),q=(0,Q()._h)(Z,(e=>e.CollectionSettingsAutomationsView)),Y=new(Q().O2)("CollectionSettingsCustomizeMenu",(()=>o.e(66592).then(o.bind(o,23272)))),J=(0,Q()._h)(Y,(e=>e.CollectionSettingsCustomizeMenu)),X=new(Q().O2)("CollectionSettingsCustomizeMenuPrototype",(()=>o.e(39778).then(o.bind(o,14192)))),ee=(0,Q()._h)(X,(e=>e.CollectionSettingsCustomizeMenuPrototype)),te=new(Q().O2)("CustomizeMenuConnectionsSettings",(()=>o.e(91795).then(o.bind(o,655533)))),oe=(0,Q()._h)(te,(e=>e.CustomizeMenuConnectionsSettings));var ne=()=>o(388487),ie=()=>o(965998),re=()=>o(769145),le=()=>o(284371),se=()=>o(187485),ae=()=>o(89924),ce=()=>o(765957),de=(o(16280),o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(823215),o(672577),o(908872),o(737550),()=>o(970013)),ue=()=>o(743176),pe=()=>o(617871),ge=()=>o(857639),me=()=>o(187174),Se=()=>o(940563),fe=()=>o(361173),ye=()=>o(388693),he=()=>o(778078),xe=()=>o(973647),ve=()=>o(235191),Ce=()=>o(803074),be=()=>o(2220),we=()=>o(346615),je=()=>o(704152),Ae=()=>o(331542),_e=()=>o(939740),Ie=()=>o(859428),Me=()=>o(673730);function ke(e){const{title:t,items:o,handleSelect:i,isSelectAll:l,sectionCallout:s,selectAllTooltipContent:a,isSectionItemsLoading:c,disableSelectAll:d}=e,[u,p]=n.useState(!0),{isMobile:g}=(0,r().Y0)(),m=e.disableCollapse??!1,f=(0,S().IS)((e=>({sectionMargin:{padding:"4px 6px 4px 6px"},sectionTitleContainer:{display:"flex",padding:"4px",borderRadius:6,gap:2,alignItems:"center"},sectionMenuDesktopTitleStyle:{padding:0,margin:0,alignItems:"center"},arrow:{width:g?14:12,height:g?14:12,transition:"transform 200ms ease-out",transform:`rotateZ(${u?0:-90}deg)`,fill:"inherit",opacity:1,marginTop:2},menuList:{paddingTop:0,paddingBottom:0}})),[g,u]);return o.length?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ae().A,{style:{...f.sectionMargin},desktopTitleStyle:f.sectionMenuDesktopTitleStyle,title:(0,k.jsxs)(je().A,{style:f.sectionTitleContainer,onClick:()=>p(!u),disabled:m,children:[t,!m&&(0,we().p)(f.arrow),c&&(0,k.jsx)(Ae().A,{style:{alignSelf:"right"}})]}),right:!d&&o.length&&u&&!c&&(0,k.jsx)(Ie().A,{renderTooltip:e=>(0,k.jsx)("div",{...e,style:Me().Q$,children:a}),render:e=>(0,k.jsx)("div",{...e,children:(0,k.jsx)(Te,{onClick:i,isSelectAll:l})}),disableTooltip:!a})}),u&&(0,k.jsxs)(k.Fragment,{children:[s,(0,k.jsx)(_e().Ay,{style:f.menuList,type:_e().Oh.Vertical,initialFocus:0,sections:[{key:"collapsableSectionMenuList",render:e=>(0,k.jsx)(ae().A,{topBorder:!1,...e}),items:o}]})]})]}):null}function Te(e){return(0,k.jsx)(D().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:le().J.UISmall.desktop,height:"fit-content",padding:"4px"},onClick:e.onClick,children:e.isSelectAll?(0,k.jsx)(f().sA,{id:"database.viewSettings.collapsableSection.selectAll",defaultMessage:"Select all"}):(0,k.jsx)(f().sA,{id:"database.viewSettings.collapsableSection.unselectAll",defaultMessage:"Unselect all"})})}var Pe=()=>o(760217),Be=()=>o(419357),Ve=()=>o(710149),Fe=()=>o(8980),Ee=()=>o(73332),Re=()=>o(125565),De=()=>o(53137),Ke=()=>o(399275),Oe=(o(803949),()=>o(638681)),Le=()=>o(527328);const ze={name:"User",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/User\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)?(\\?(?<queryParams>[^\\s#]*))?$",sample_urls:["https://notion.lightning.force.com/lightning/r/User/0055b00000MWTaJAAX/view","https://notion.lightning.force.com/lightning/r/user/0055b00000MWTaJAAX/view"],additional_types:{connectedRelation:!0},attributes:Le().eV.attributes,connected_relation_properties:{title:{name:"Name",type:"title"},Id:{name:"Id",type:"text"},CreatedDate:{name:"Created Date",type:"date"},LastModifiedDate:{name:"Last Modified Date",type:"date"},Email:{name:"Email",type:"email"},SmallPhotoUrl:{name:"Avatar URL",type:"url"},NotionUser:{name:"Notion User",type:"relation",uri:"notion://user-defined-collection/salesforce:User"}},connected_relation_sub_schemas:{"notion://user-defined-collection/salesforce:User":{title:{name:"Name",type:"title"}}}},Ne={name:"Report",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Report\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)?(\\?(?<queryParams>[^\\s#]*))?$",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Report/00O5b000000Xr5jEAC/view","https://notionlabs-abc-dev-ed.develop.lightning.force.com/lightning/r/Report/00O5b000000Xr5jEAC/view?queryParamsAny=test"],attributes:Le().eV.attributes},Ue=[{name:"Account",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Account\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Account/001bm000004etjTAAQ/view","https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Account/001bm000004euUDAAY/view"],attributes:Le().eV.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:{...Le().eV.connected_relation_properties,Type:{name:"Type",type:"text"},AccountNumber:{name:"Account Number",type:"text"},AnnualRevenue:{name:"Annual Revenue",type:"number"},Website:{name:"Website",type:"url"},Phone:{name:"Phone",type:"phone_number"},Description:{name:"Description",type:"text"},ParentId:{uri:"notion://user-defined-collection/salesforce:Account",name:"Parent Account",type:"relation"},OwnerId:{uri:"notion://user-defined-collection/salesforce:User",name:"Account Owner",type:"relation"},mapped_OwnerId:{name:"Mapped Account Owner",uri:"notion://user-defined-collection/salesforce:User",type:"person",source_property_id:"Email"}},connected_relation_sub_schemas:Le().eV.connected_relation_sub_schemas},{name:"Contact",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Contact\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Contact/003bm000004etjTAAQ/view","https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Contact/003bm000004euUDAAY/view"],attributes:Le().eV.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:{...Le().eV.connected_relation_properties,Phone:{name:"Phone",type:"phone_number"},Email:{name:"Email",type:"email"},AccountId:{uri:"notion://user-defined-collection/salesforce:Account",name:"Account",type:"relation"}},connected_relation_sub_schemas:Le().eV.connected_relation_sub_schemas},{name:"Opportunity",regex:"^(https?:\\/\\/)?(?<instanceUrl>[a-z0-9-]+\\.[\\w.]+\\.force\\.com)\\/lightning\\/r\\/Opportunity\\/(?<recordId>[a-zA-Z0-9]+)\\/(?<action>[a-zA-Z0-9_]+)",sample_urls:["https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Opportunity/006bm000004etjTAAQ/view","https://notionlabs-dev-ed.develop.lightning.force.com/lightning/r/Opportunity/006bm000004euUDAAY/view"],attributes:Le().eV.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:{...Le().eV.connected_relation_properties,Amount:{name:"Amount",type:"number"},CloseDate:{name:"Close Date",type:"date"},StageName:{name:"Stage",type:"text"},AccountId:{uri:"notion://user-defined-collection/salesforce:Account",name:"Account",type:"relation"},OwnerId:{name:"Owner",uri:"notion://user-defined-collection/salesforce:User",type:"relation"},mapped_OwnerId:{name:"Mapped Opportunity Owner",uri:"notion://user-defined-collection/salesforce:User",type:"person",source_property_id:"Email"}},connected_relation_sub_schemas:Le().eV.connected_relation_sub_schemas},ze],We=(Le().eV,Ue.map((e=>({name:e.name,additional_types:e.additional_types,connected_relation_properties:e.connected_relation_properties,connected_relation_sub_schemas:e.connected_relation_sub_schemas}))),Oe().string());Oe().object({required:{Name:Oe().string(),Id:We,CreatedById:We},optional:{UserName:Oe().string(),SmallPhotoUrl:Oe().nullable(Oe().string()),Alias:Oe().nullable(Oe().string()),Email:Oe().nullable(Oe().string()),IsActive:Oe().boolean(),ProfileId:Oe().nullable(We),UserType:Oe().nullable(Oe().string())}}),Oe().union([Oe().object({required:{scope:Oe().string(),signature:Oe().string(),access_token:Oe().string(),refresh_token:Oe().string(),instance_url:Oe().string(),id:Oe().string(),token_type:Oe().string(),issued_at:Oe().string()},optional:{id_token:Oe().string(),refresh_token:Oe().string(),state:Oe().string()}})]),Oe().object({required:{sub:Oe().string(),user_id:Oe().string(),organization_id:Oe().string(),preferred_username:Oe().string(),name:Oe().string(),email:Oe().string()},optional:{nickname:Oe().string(),email_verified:Oe().boolean(),given_name:Oe().string(),family_name:Oe().string(),zoneinfo:Oe().string(),photos:Oe().object({optional:{},required:{picture:Oe().string(),thumbnail:Oe().string()}}),profile:Oe().string(),picture:Oe().string(),address:Oe().object({optional:{country:Oe().string()},required:{}}),urls:Oe().record(Oe().string(),Oe().string()),active:Oe().boolean(),user_type:Oe().string(),language:Oe().string(),locale:Oe().string(),utcOffset:Oe().number(),updated_at:Oe().string()}});var He=()=>o(583835);const $e=(0,He().Dv)("resyncExternalCollection");var Ge=()=>o(449506),Qe=()=>o(36629),Ze=()=>o(357625),qe=()=>o(543665);async function Ye(e){const{environment:t,objectName:o,objectLabel:n,collectionContextStore:i,intl:r}=e,l=De().A.state;if(!l.loaded)return[];const s=null==i?void 0:i.collectionStore(),a=null==s?void 0:s.getSpaceId();if(!a)return;const c=null==s?void 0:s.getSpacePointer();ge().log({level:"info",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Received request to create Salesforce connected relation property",miscDataToConvertToString:{objectName:o,objectLabel:n,spaceId:a,collectionPointer:c}}});const d=l.integrations.find((e=>e.id===pe().mn));if(!d)return;const u=De().A.bots.state.find((e=>e.integration_id===pe().mn));if(!u)return;const p=u.id,g=await Ge().callApi({eventName:"describeSalesforceObject",environment:t,data:{spaceId:a,objectName:o,botId:p}});if("success"!==(null==g?void 0:g.type))return ge().log({level:"error",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Describe Salesforce object failed while creating Salesforce connected relation property",miscDataToConvertToString:{objectName:o,objectLabel:n,spaceId:a,collectionPointer:c,error:g.error}}}),void(0,be().u)({environment:t,event:{eventName:"salesforce_actions",eventProperties:{integrationId:pe().mn,actionType:"create_connected_relation_property",status:"failed",collectionId:null==s?void 0:s.id}}});const m=function(e){const{describeObjectResponse:t,objectName:o}=e;let n={},i={};return t.forEach((e=>{if("Name"!==e.name){if("created_by"!==e.type&&"last_edited_by"!==e.type&&"created_time"!==e.type&&"last_edited_time"!==e.type&&"rollup"!==e.type&&"formula"!==e.type)if("relation"===e.type){if(e.referenceTo){var t;const o=e.referenceTo,r=e.custom?e.label:e.relationshipName||e.label;n[e.name]={name:r,type:e.type,uri:`notion://user-defined-collection/salesforce:${o}`},"User"!==o&&"Group"!==o||(n[`mapped_${e.name}`]={name:`${r} (Notion User)`,type:"person",uri:"notion://user-defined-collection/salesforce:User",source_property_id:"Email"}),null!==(t=Le().eV.connected_relation_sub_schemas)&&void 0!==t&&t[`notion://user-defined-collection/salesforce:${o}`]||(i[`notion://user-defined-collection/salesforce:${o}`]={title:{name:"Name",type:"title"}})}}else if("select"===e.type||"multi_select"===e.type){var o;n[e.name]={name:e.label,type:e.type,options:null===(o=e.picklistValues)||void 0===o?void 0:o.map((e=>({id:e.label,value:e.value})))}}else"person"===e.type?n[e.name]={name:e.label,type:e.type,uri:"notion://user-defined-collection/salesforce:User",source_property_id:"Email"}:n[e.name]={name:e.label,type:e.type}}else n.title={name:e.label,type:"title"}})),n={...Le().eV.connected_relation_properties,...n},i={...Le().eV.connected_relation_sub_schemas,...i},{value:{name:o,regex:(0,Le().fh)(o),attributes:Le().eV.attributes,additional_types:{connectedRelation:!0},connected_relation_properties:n,connected_relation_sub_schemas:i}}}({describeObjectResponse:g.data.properties,objectName:o});if(xe().Q.isFail(m))return ge().log({level:"error",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Failed to get connected relation pattern while creating Salesforce connected relation property",miscDataToConvertToString:{objectName:o,objectLabel:n,spaceId:a,collectionPointer:c,error:m.error}}}),(0,be().u)({environment:t,event:{eventName:"salesforce_actions",eventProperties:{integrationId:pe().mn,actionType:"create_connected_relation_property",status:"failed",collectionId:null==s?void 0:s.id}}}),{error:new Error(m.error)};const S={name:`${d.name} ${n}`,pattern:m.value,integration:d};await Qe().XO({environment:t,connectedRelationProperty:S,collectionContextStore:i,intl:r,from:"new_property",propertyGroupId:void 0,propertyLimit:"no_limit",skipDatabaseActions:!0}),ge().log({level:"info",from:"salesforceConnectedRelationActions",type:"createSalesforceConnectedRelationProperty",data:{message:"Successfully created Salesforce connected relation property",miscDataToConvertToString:{objectName:o,objectLabel:n,spaceId:a,collectionPointer:c}}}),(0,be().u)({environment:t,event:{eventName:"salesforce_actions",eventProperties:{integrationId:pe().mn,actionType:"create_connected_relation_property",details:{objectName:o},status:"success",collectionId:null==s?void 0:s.id}}})}async function Je(e){const{environment:t,collectionStore:o,propertiesToBeAdded:n,integrationId:i,rootPropertySchema:r,skipExternalCollectionUpdate:l}=e,s=(0,de().Nv)(r);if(s&&i===pe().mn){const e=c().default.checkGate({gateName:"salesforce_caching"});if(n.length&&e){var a;const e=De().A.bots.state.find((e=>e.integration_id===i));if(!e)return;const r=new(qe().m)(t,s);await r.load();const c=null===(a=r.getFormat())||void 0===a?void 0:a.pattern_name;if(!c)return;const d={};for(const t of n)d[t.metadata.name]=t.metadata;const u=(0,Ze().UT)(t,$e,{spaceId:o.getSpaceId(),botId:e.id,integrationId:i,key:null==c?void 0:c.toLowerCase(),metadata:d,externalCollectionId:r.id,skipMetadataUpdate:!1,skipResyncCollection:l},{spaceIds:[]});for await(const t of u)break}}}var Xe=()=>o(254526),et=()=>o(534239),tt=()=>o(532940);function ot(e){const{collectionSettingsStore:t,title:o,description:n}=e,i=(0,S().IS)((e=>({errorSection:{padding:"0px 4px"},borderedContainer:{borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.secondary,margin:"2px 8px"},header:{fontWeight:le().Wy.regular,color:e.text.primary,fontSize:le().J.UIRegular.desktop,marginTop:6},captionText:{fontSize:le().J.UISmall.desktop,color:e.text.secondary,fontWeight:le().Wy.regular,textAlign:"center",marginTop:6}})),[]);return(0,k.jsx)(y().Ay,{...e,collectionSettingsStore:t,title:o,handleClose:()=>{u().os({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6},children:(0,k.jsx)(ae().A,{disableMobileBorders:!0,style:i.errorSection,children:(0,k.jsx)(nt,{title:(0,k.jsx)(f().sA,{defaultMessage:"Failed to load",id:"GenericErrorComponentForConnectedRelation.errorLoading"}),description:n,styles:{wrapper:{...i.borderedContainer,padding:16},header:i.header,description:i.captionText},children:(0,k.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,k.jsx)(je().A,{style:{margin:"12px auto 0 auto",paddingTop:4,paddingRight:16,paddingBottom:4,paddingLeft:16,gap:4,borderRadius:6,borderWidth:1,border:"1px solid var(--stroke-primary, #54483126)",textAlign:"center"},onClick:()=>{},children:(0,k.jsx)(w().D,{styleName:"UIRegular-14px/Regular",children:(0,k.jsx)(f().sA,{defaultMessage:"Try again",id:"GenericErrorComponentForConnectedRelation.tryAgain"})})})})})})})}function nt(e){const{title:t,description:o,children:n,styles:i}=e,r=(0,S().IS)((e=>({header:{fontWeight:le().Wy.medium,fontSize:17,textAlign:"center",marginTop:8},iconGroup:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gridColumnGap:10,marginBottom:9},icon:{height:36,width:36}})),[]);return(0,k.jsxs)("div",{style:null==i?void 0:i.wrapper,children:[(0,k.jsx)("div",{style:{...r.iconGroup,...null==i?void 0:i.iconGroup},children:(0,tt().exclamationMarkTriangleIcon)(r.icon)}),(0,k.jsx)("div",{style:{...r.header,...null==i?void 0:i.header},children:t}),(0,k.jsx)("div",{style:null==i?void 0:i.description,children:o}),n]})}var it=()=>o(484392),rt=()=>o(338862),lt=()=>o(824862),st=()=>o(843189),at=()=>o(674582),ct=()=>o(630116),dt=()=>o(859004);function ut(e){let{integrationIconUrl:t,integrationIcon:o,currentSpaceStore:i,flowId:l,renderActions:s,captionText:a,forceUserReAuth:c=!1}=e;const d=(0,r().v3)(),u=(0,S().IS)((e=>({borderedContainer:{borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.secondary},header:{fontWeight:le().Wy.medium,color:e.text.primary,fontSize:le().J.UIRegular.desktop,marginTop:6},captionText:{fontSize:le().J.UISmall.desktop,color:e.text.secondary,fontWeight:le().Wy.regular,textAlign:"center",marginTop:6},siteButton:{padding:"4px",borderRadius:6,display:"flex",justifyContent:"space-between"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:le().J.UIRegular.desktop},siteNameSecondaryText:{fontSize:le().J.UISmall.desktop,color:e.text.secondary,fontWeight:le().Wy.regular,textAlign:"left",whiteSpace:"nowrap"},lockedIcon:{width:15,height:15}})),[]),{status:p,userAccessAuthentication:g}=pt({currentSpaceStore:i}),m=(0,n.useMemo)((()=>"not_connected"===p||"no_user_access"===p||"connected"===p&&c?(0,k.jsx)(at().m,{integrationIconUrl:t,integrationIcon:o,styles:{wrapper:{...u.borderedContainer,padding:20},header:u.header},title:(0,k.jsx)(f().sA,{defaultMessage:"Authenticate Salesforce",id:"database.viewSettings.collectionSettingsExternalSource.connectToSalesforce.headline"}),description:(0,k.jsx)("div",{style:u.captionText,children:a}),children:(0,k.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,k.jsx)(st().E,{color:"uiBlue",style:{margin:"12px auto 0 auto"},onClick:()=>{(0,dt().Tp)({environment:d,spaceId:(null==i?void 0:i.id)??"",from:"source_picker_connect_another_account",flowId:l,authType:"no_user_access"===p||"connected"===p&&c?"user":"admin"})},children:(0,k.jsx)(w().D,{styleName:"UIRegular-14px/Regular",children:c?(0,k.jsx)(f().sA,{defaultMessage:"Re-authenticate Salesforce",id:"database.viewSettings.collectionSettingsExternalSource.reAuthToSalesforce"}):(0,k.jsx)(f().sA,{defaultMessage:"Connect to Salesforce",id:"database.viewSettings.collectionSettingsExternalSource.connectToSalesforce"})})})})}):"connected"===p?(0,k.jsx)("div",{style:u.captionText,children:(0,k.jsx)("div",{style:{...u.borderedContainer,padding:4},children:(0,k.jsxs)(je().A,{style:u.siteButton,disallowTabbing:!0,disabled:!0,children:[(0,k.jsxs)("div",{style:u.siteButtonTextContainer,children:[t?gt({iconStyle:{width:18,height:18},srcUrl:t}):o,(0,k.jsxs)("div",{style:{display:"flex",flexFlow:"column",alignItems:"flex-start",gap:1,flexShrink:1},children:[(0,k.jsx)("span",{style:u.siteNameText,children:(0,it().A)(null==g?void 0:g.account_name)}),(0,k.jsx)("span",{style:u.siteNameSecondaryText,children:(0,it().A)(null==g?void 0:g.account_key)})]})]}),(0,k.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,rt().N)(u.lockedIcon)})]})})}):null),[p,c,t,o,u.borderedContainer,u.header,u.captionText,u.siteButton,u.siteButtonTextContainer,u.siteNameText,u.siteNameSecondaryText,u.lockedIcon,a,d,null==i?void 0:i.id,l,null==g?void 0:g.account_name,null==g?void 0:g.account_key]);return(0,k.jsxs)(k.Fragment,{children:[m,null==s?void 0:s(p)]})}function pt(e){const{currentSpaceStore:t}=e;return(0,l().K8)((()=>{if(!t)return{status:"not_connected",userAccessAuthentication:void 0};const e=De().A.state;if(!e.loaded)return{status:"not_connected",userAccessAuthentication:void 0};const o=e.bots.filter((e=>{let{integration_id:t}=e;return t===pe().mn}));if(0===o.length)return{status:"not_connected",userAccessAuthentication:void 0};const n=ct().vK.createChildStore(t,{table:lt().GP,id:o[0].id,spaceId:t.id}),{status:i,userAccessAuthentication:r}=(0,Xe().i_)(n);return{status:i,userAccessAuthentication:r}}),[t])}function gt(e){const{iconStyle:t,srcUrl:o,altString:n}=e;return(0,k.jsx)("img",{style:t,src:o,alt:n})}function mt(e){const{currentSpaceStore:t,collectionSettingsStore:o}=e,n=O().A.isMobile,i=(0,S().IS)((e=>({authStatus:{padding:"0px 4px"},headline:{marginLeft:12,fontSize:n?le().J.UISmall.mobile:le().J.UISmall.desktop,color:e.text.secondary}})),[n]);return(0,k.jsxs)(y().Ay,{...e,collectionSettingsStore:o,handleClose:()=>{u().os({collectionSettingsStore:o})},menuScrollerStyle:{paddingBottom:6},children:[(0,k.jsx)(ae().A,{disableMobileBorders:!0,children:(0,k.jsx)("p",{style:i.headline,children:(0,k.jsx)(f().sA,{defaultMessage:"To add Salesforce objects or properties, authenticate with your Salesforce account",id:"database.viewSettings.salesforceConnectedRelationReAuth.description"})})}),(0,k.jsx)(ae().A,{disableMobileBorders:!0,style:i.authStatus,children:(0,k.jsx)(ut,{captionText:(0,k.jsx)(f().sA,{defaultMessage:"Link your Salesforce account to add Salesforce objects and properties to your database",id:"database.viewSettings.salesforceConnectedRelationReAuth.captionText"}),integrationIcon:(0,re().salesforceIcon)({width:48,height:48}),currentSpaceStore:t,flowId:"",forceUserReAuth:!0})})]})}const St=(0,f().YK)({inputPlaceholder:{defaultMessage:"Search property",id:"database.viewSettings.ConnectedRelationActionsAddProperties.inputPlaceholder"},addColumn:{defaultMessage:"Add properties",id:"database.viewSettings.ConnectedRelationActionsAddProperties.addColumn"},Next:{defaultMessage:"Next",id:"database.viewSettings.ConnectedRelationActionsAddProperties.Next"},addProperties:{defaultMessage:"Add properties",id:"ConnectedRelationActionsAddProperties.addProperties"},genericErrorDescription:{defaultMessage:"We were unable to fetch any Salesforce properties, please try again",id:"ConnectedRelationActionsAddProperties.genericErrorDescription"}}),ft=[64,51,73,95,45,67,45,91,52];function yt(e){const{collectionSettingsStore:t,collectionContextStore:o,rootPropertySchema:i,rootPropertyId:s,integrationId:a,skipDatabaseActions:d}=e,[p,m]=n.useState(""),[h,x]=n.useState([]),v=(0,l().K8)((()=>{var e;return null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[o]),C=(0,l().K8)((()=>{const e=De().A.state;if(!e.loaded)return;const t=e.bots,o=a===pe().mn?t.find((e=>e.integration_id===pe().Iy)):t.find((e=>e.integration_id===a)),n=e.integrations.find((e=>e.id===a));return o&&n?{bot:o,integration:n}:void 0}),[a]),b=(0,l().K8)((()=>{var e;return null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSpacePointer()}),[o]),w=(0,S().DP)(),j=(0,r().v3)(),A=(0,f().tz)(),_=(0,S().IS)((()=>({shimmerRow:{display:"flex",cursor:"pointer",alignItems:"center",gap:6,height:24,marginTop:4,marginLeft:16,borderRadius:4},leftShimmer:{height:14,width:14,borderRadius:6},rightShimmer:{height:14,borderRadius:6}})),[]),I=(0,l().O$)(ce().AppStoreCurrentSpaceStore),M=(0,l().K8)((()=>{if(i&&(0,de().UU)(i))return i.collection_pointer}),[i]),{collectionHasUrlProperty:T}=(0,l().K8)((()=>{var e;const t=null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSchema();return{collectionHasUrlProperty:t&&Object.values(t).some((e=>e&&"url"===e.type))}}),[o]),{format:P,loading:B}=(0,et().e8)(M,{debugName:"ConnectedRelationActionsAddProperties"}),V=(0,l().K8)((()=>(null==P?void 0:P.pattern_name)??null),[P]),[{status:F,value:E,error:R}]=(0,me().Yb)((async()=>{var e;if(!(v&&V&&C&&C.bot))return null;const t=V.replace(C.integration.name,""),n=await Ce().Nf({environment:j,objectName:t,spaceId:v,bot:null==C?void 0:C.bot,connected_relation_properties:null==C||null===(e=C.integration.info.original_url_patterns)||void 0===e||null===(e=e.find((e=>e.name===V)))||void 0===e?void 0:e.connected_relation_properties});if(xe().Q.isFail(n))throw new Error(n.error);const i=n.value,r=o.collectionStore();if(r&&i){const e=ht({collectionStore:r,rootPropertyId:s}).map((e=>e.attributeName));return{properties:i.map((t=>({...t,isSelected:!!e.includes(t.id)}))),patternName:V}}}),[j,v,V,o,s,C]);(0,n.useEffect)((()=>{"resolved"===F&&E&&x(E.properties)}),[F,E]);const D=(0,l().K8)((()=>(0,Xe().Rg)({experimentStore:c().default,integrationId:a})),[a]),K=(0,n.useMemo)((()=>h.filter((e=>e.isAlreadySynced||e.isSelected)).reduce(((e,t)=>{var o,n;return e+=1,"relation"!==t.type||"User"!==(null===(o=t.metadata)||void 0===o?void 0:o.referenceTo)&&"Group"!==(null===(n=t.metadata)||void 0===n?void 0:n.referenceTo)||(e+=1),e}),0)+1),[h]),O=h.length?(0,he().Ay)(p,h,(e=>e.name)):[],L=(0,n.useCallback)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"toggle";x((o=>o.map((o=>e.includes(o.id)?{id:o.id,name:o.name,isSelected:"toggle"===t?!o.isSelected:"selectAll"===t,type:o.type,metadata:o.metadata,isAlreadySynced:o.isAlreadySynced}:o))))}),[]),z=(0,n.useCallback)((e=>({key:e.id,render:()=>(0,k.jsx)(Pe().A,{focused:!1,style:{},onClick:()=>{L([e.id])},title:(0,k.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,k.jsx)("div",{children:(0,k.jsx)(Ee().T,{size:14,checked:e.isSelected,onClick:()=>{L([e.id])},style:{borderRadius:2}})}),icon:(0,k.jsx)(ue().zB,{type:e.type??"text",icon:void 0,size:16,theme:w})}),action:()=>{}})),[L,w]),N=O.filter((e=>e.isAlreadySynced)).slice(0,50),U=O.filter((e=>!e.metadata.custom)),W=O.filter((e=>e.metadata.custom)),H=h.filter((e=>e.isSelected)).length,$=(0,l().K8)((()=>{const e=null==o?void 0:o.collectionStore();if(!e)return H;const t=ht({collectionStore:e,rootPropertyId:s}).map((e=>e.attributeName));return h.filter((e=>e.isSelected&&!t.includes(e.id))).length}),[h,o,s,H]),G=(0,n.useCallback)((async e=>{if(e.stopPropagation(),!i||!(0,de().UU)(i))return;const n=o.collectionStore();if(!n)return;const r=function(e){const{environment:t,collectionContextStore:o,allProperties:n,rootPropertyId:i,integrationId:r}=e,l=o.collectionStore();if(!l)return;const s=o.collectionViewStore(),a=o.getPropertyFormatKey();if(!a)return;const c=n.filter((e=>e.isSelected)),d=ht({collectionStore:l,rootPropertyId:i}),u=d.map((e=>e.attributeName)),p=c.filter((e=>!u.includes(e.id))),m=d.filter((e=>!c.some((t=>t.id===e.attributeName))));(p.length||m.length)&&g().createAndCommit({userAction:"CollectionSettingsConnectedRelationActionsAddProperties",environment:t,canUndo:!0,perform:e=>{if(p.length&&ve().UM({environment:t,collectionStore:l,transaction:e,propertiesToBeAdded:p,collectionViewArgs:s?{collectionViewStore:s,format:s.getFormat(),formatKey:a}:void 0,rootPropertyId:i,integrationId:r}),m.length){const o=l.getSchema();for(const n of m)ve().BJ({environment:t,transaction:e,collectionStore:l,schema:o,property:n.id})}}});return ge().log({level:"info",from:"ConnectedRelationActionsAddProperties",type:"updateCollectionSchema",data:{miscDataToConvertToString:{propertiesToBeAddedCount:p.length,propertiesToBeDeletedCount:m.length,collectionPointer:l.getSpacePointer(),rootPropertyId:i,totalProperties:n.length}}}),(0,be().u)({environment:t,event:{eventName:"salesforce_actions",eventProperties:{integrationId:r,actionType:"added_properties_for_connected_relation",details:p.map((e=>({fieldName:e.name,propertyType:e.type}))),collectionId:l.id}}}),{propertiesToBeAdded:p}}({environment:j,collectionContextStore:o,allProperties:h,rootPropertyId:s,integrationId:a});if(d){var l;r&&r.propertiesToBeAdded.length&&await Je({environment:j,collectionStore:n,propertiesToBeAdded:r.propertiesToBeAdded,rootPropertyId:s,integrationId:a,skipExternalCollectionUpdate:!0,rootPropertySchema:i});const e=null==o||null===(l=o.collectionStore())||void 0===l?void 0:l.getSchema();e&&Object.values(e).some((e=>e&&"url"===e.type))?u().a2({collectionSettingsStore:t,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationCopyUrl",rootPropertyId:s,integrationId:a,rootPropertySchema:i}}):u().os({collectionSettingsStore:t})}else if(u().os({collectionSettingsStore:t}),r&&r.propertiesToBeAdded.length){const e=ht({collectionStore:n,rootPropertyId:s}),t=[s,...e.map((e=>e.id))],o=Object.fromEntries(t.map((e=>[e,"Loading"])));Ke().d.addCollectionProperties(n.id,o);try{await Je({environment:j,collectionStore:n,propertiesToBeAdded:r.propertiesToBeAdded,rootPropertyId:s,integrationId:a,rootPropertySchema:i,skipExternalCollectionUpdate:!1})}catch(c){ge().log({level:"error",from:"ConnectedRelationActionsAddProperties",type:"updateConnectedRelationFieldSelectionFailed",data:{miscDataToConvertToString:{error:c,rootPropertyId:s,integrationId:a,collectionPointer:b,syncProperties:t}}})}finally{Ke().d.removeCollectionProperties(n.id,new Set(t))}}}),[h,o,b,t,j,a,s,i,d]);return I?vt(R)?(0,k.jsx)(mt,{currentSpaceStore:I,collectionSettingsStore:t,title:A.formatMessage(St.addProperties)}):R?(0,k.jsx)(ot,{collectionSettingsStore:t,title:A.formatMessage(St.addProperties),description:A.formatMessage(St.genericErrorDescription)}):(0,k.jsx)(y().Ay,{...e,title:A.formatMessage(St.addProperties),header:(0,k.jsx)(xt,{inputValue:p,integrationName:"Salesforce",onChange:m}),footer:"resolved"===F&&E&&(0,k.jsx)(Ct,{selectedPropertiesCount:H,totalPropertiesCount:K,newPropertiesCount:$,patternName:V,propertyCountLimits:D,onClick:G,iconTrailing:d&&T?Se().P:void 0,children:d&&T?(0,k.jsx)(f().sA,{...St.Next}):(0,k.jsx)(f().sA,{...St.addColumn})}),handleClose:()=>{u().os({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6,flexGrow:1},fullHeight:e.fullHeight,children:(0,k.jsxs)("div",{style:{height:"100%",flexGrow:1},children:[(B||"pending"===F)&&(0,k.jsx)("div",{children:(0,k.jsx)("div",{children:ft.map(((e,t)=>(0,k.jsxs)("div",{style:{..._.shimmerRow},children:[(0,k.jsx)(Ve().A,{style:{..._.leftShimmer}}),(0,k.jsx)(Ve().A,{style:{..._.rightShimmer,width:e}})]},t)))})}),"resolved"===F&&(0,k.jsxs)(k.Fragment,{children:[N.length>5&&(0,k.jsx)(ke,{title:(0,k.jsx)(f().sA,{defaultMessage:"Suggested properties",id:"database.viewSettings.ConnectedRelationActionsAddProperties.suggestedPropertiesTitle"}),disableSelectAll:!1,isSelectAll:N.every((e=>e.isSelected)),handleSelect:()=>{N.every((e=>e.isSelected))?L(N.map((e=>e.id)),"deselectAll"):L(N.map((e=>e.id)),"selectAll")},items:N.map(z)},"Suggested Properties"),(0,k.jsx)(ke,{title:(0,k.jsx)(f().sA,{defaultMessage:"{propertyCount, plural, one {{propertyCount} standard property} other {{propertyCount} standard properties}}",id:"database.viewSettings.ConnectedRelationActionsAddProperties.standardPropertiesTitle",values:{propertyCount:U.length}}),disableSelectAll:!0,items:U.map(z)},"Standard Properties"),(0,k.jsx)(ke,{title:(0,k.jsx)(f().sA,{defaultMessage:"{propertyCount, plural, one {{propertyCount} custom property} other {{propertyCount} custom properties}}",id:"database.viewSettings.ConnectedRelationActionsAddProperties.OptionalPropertiesTitle",values:{propertyCount:W.length}}),disableSelectAll:!0,items:W.map(z)},"Custom Properties")]})]})}):null}function ht(e){const{collectionStore:t,rootPropertyId:o}=e,n=t.getSchema(),i=[];for(const c in n){var r;if("rollup"===(null===(r=n[c])||void 0===r?void 0:r.type)){var l,s;if((null===(l=n[c])||void 0===l?void 0:l.relation_property)===o)i.push({id:c,attributeName:null===(s=n[c])||void 0===s||null===(s=s.target_property)||void 0===s?void 0:s.trim()})}else{var a;const e=null===(a=n[c])||void 0===a?void 0:a.derived_property_record_metadata;(null==e?void 0:e.pointer_property_uri)===o&&i.push({id:c,attributeName:null==e?void 0:e.external_object_attribute})}}return i}function xt(e){const t=O().A.isMobile,o=(0,f().tz)();return(0,k.jsxs)(ae().A,{children:[(0,k.jsx)(Re().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?le().J.UISmall.mobile:le().J.UISmall.desktop},children:(0,k.jsx)(f().sA,{defaultMessage:"Add {integrationName} properties as a column directly to this database.",id:"database.viewSettings.ConnectedRelationActionsAddProperties.description",values:{integrationName:e.integrationName}})}),(0,k.jsx)(Be().Ay,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:o.formatMessage(St.inputPlaceholder)})]})}function vt(e){return(null==e?void 0:e.message)===Xe().y$.reauthenticationRequired}function Ct(e){let{totalPropertiesCount:t,newPropertiesCount:o,selectedPropertiesCount:n,patternName:i,propertyCountLimits:r,children:l,...s}=e;const a=(0,S().IS)((e=>({buttonWrapper:{borderColor:"none",borderTop:"1px solid var(--Stroke-Deemphasized, #E3E2E080)",background:e.surface.page,borderTopWidth:1,paddingTop:12,paddingRight:14,paddingBottom:12,paddingLeft:14,gap:8,boxShadow:"inset 0px 1px 0px -1px rgba(15, 15, 15, 0.05)"},button:{width:"100%",border:"none",height:32,fontWeight:le().Wy.medium,paddingRight:12,paddingLeft:12,gap:4},limitExceededErrorMessage:{marginTop:4,fontSize:le().J.UISmall.desktop,color:e.text.uiYellowPrimary,textAlign:"center",fontWeight:le().Wy.regular},selectedPropertiesCountMessage:{fontSize:le().J.UIRegular.desktop,color:e.text.secondary,textAlign:"center",fontWeight:le().Wy.regular,marginBottom:8},selectedPropertiesCountWarning:{display:"inline-flex",alignItems:"start",gap:4,fontSize:le().J.UISmall.desktop,color:e.text.secondary,textAlign:"left",fontWeight:le().Wy.regular,backgroundColor:e.surface.wash,borderRadius:6,padding:8,marginBottom:4},infoIconStyle:{color:e.text.secondary,marginTop:2}})),[]),c=t>=r.workspaceLimit,d=n>=r.singleDatabaseLimit;return(0,k.jsxs)("div",{style:a.buttonWrapper,children:[o>0&&!c&&!d&&(0,k.jsx)("div",{style:a.selectedPropertiesCountMessage,children:(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{defaultMessage:"{newPropertiesCount, plural, one {{newPropertiesCount} new property will be added} other {{newPropertiesCount} new properties will be added}}",id:"ConnectedRelationActionsAddProperties.newPropertiesCountMessage",values:{newPropertiesCount:o}})})}),!c&&!d&&n>r.warningThreshold&&(0,k.jsxs)("div",{style:a.selectedPropertiesCountWarning,children:[(0,k.jsx)(Fe().I,{icon:fe().infoCircleFillSmallIcon,size:14,style:a.infoIconStyle}),(0,k.jsx)(f().sA,{defaultMessage:"Choose fewer than {limit} properties for the best performance",id:"ConnectedRelationActionsAddProperties.tooManyPropertiesWarning",values:{limit:r.warningThreshold}})]}),(0,k.jsx)(A().A,{style:a.button,disabled:c||d,...s,children:l}),d&&i&&(0,k.jsx)("div",{style:a.limitExceededErrorMessage,children:(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{defaultMessage:"This Salesforce database has reached the <bold>maximum of {limit}</bold> synced properties",id:"ConnectedRelationActionsAddProperties.salesforceDbMaxPropertiesReached",values:{limit:r.singleDatabaseLimit,bold:e=>(0,k.jsx)("strong",{children:e})}})})}),c&&i&&(0,k.jsx)("div",{style:a.limitExceededErrorMessage,children:(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{defaultMessage:"Your workspace has reached the <bold>maximum of {limit}</bold> synced properties for {object}",id:"ConnectedRelationActionsAddProperties.workspaceMaxPropertiesReached",values:{limit:ye().rM,bold:e=>(0,k.jsx)("strong",{children:e}),object:i}})})})]})}const bt=(0,He().Dv)("bulkCreateConnectedProperty");var wt=()=>o(828973),jt=()=>o(972435);const At=(0,f().YK)({copyColumn:{defaultMessage:"Populate property",id:"ConnectedRelationActionsCopyUrl.populateProperty"},skipStep:{defaultMessage:"Skip step",id:"ConnectedRelationActionsCopyUrl.skipStep"}});function _t(e){const{collectionSettingsStore:t,collectionContextStore:o,integrationId:i}=e,[s,a]=(0,n.useState)(null),c=(0,r().v3)(),d=(0,f().tz)(),p=(0,l().K8)((()=>{var e;const t=null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSchema();if(!t)return[];const n=[];for(const[o,i]of Object.entries(t)){i&&"url"===i.type&&n.push({id:o,...i})}return n}),[o]);(0,n.useEffect)((()=>{var e;a((null===(e=p[0])||void 0===e?void 0:e.id)||null)}),[p]);const g=(0,S().IS)((e=>({buttonWrapper:{borderColor:"none",borderTop:"1px solid var(--Stroke-Deemphasized, #E3E2E080)",background:e.surface.page,borderTopWidth:1,paddingTop:12,paddingRight:14,paddingBottom:12,paddingLeft:14,gap:8,boxShadow:"inset 0px 1px 0px -1px rgba(15, 15, 15, 0.05)",display:"flex",flexDirection:"column"},button:{width:"100%",height:32,border:"none",fontWeight:le().Wy.medium,paddingLeft:12,gap:4,paddingRight:12},skipStepButton:{width:"100%",height:32,fontWeight:le().Wy.medium,backgroundColor:"transparent",borderColor:e.lightGrayButtonBackground,borderWidth:1,borderStyle:"solid",color:e.text.secondary,background:"transparent",border:"1px solid var(--stroke-primary, #54483126)",gap:6}})),[]);return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Populate property",id:"ConnectedRelationActionsCopyUrl.titleForCopyUrlTab"}),header:(0,k.jsx)(Mt,{}),handleClose:()=>{u().os({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6,flexGrow:1},fullHeight:e.fullHeight,footer:(0,k.jsxs)("div",{style:g.buttonWrapper,children:[(0,k.jsx)(A().A,{style:g.skipStepButton,hoveredStyle:g.skipStepButton,onClick:e=>{e.stopPropagation(),u().os({collectionSettingsStore:t})},children:jt().A.formatMessage(At.skipStep)}),(0,k.jsx)(A().A,{style:g.button,onClick:async n=>{n.stopPropagation(),u().os({collectionSettingsStore:t});const r=De().A.bots.state.find((e=>e.integration_id===i));if(!r)return;const l=r.id,a=o.collectionStore();if(!a)return;const d=(0,Xe().K6)({collectionStore:a,rootPropertyId:e.property}),p=[e.property,...d.map((e=>e.id))],g=Object.fromEntries(p.map((e=>[e,"Loading"])));Ke().d.addCollectionProperties(a.id,g);try{const t=s&&a?(0,Ze().UT)(c,bt,{spaceId:a.getSpaceId(),botId:l,collectionId:a.id,integrationId:e.integrationId,sourceColumnId:s,destinationColumnId:e.property},{spaceIds:[]}):null;if(t)for await(const o of t)"in_progress"!==o.taskStatus&&"success"!==o.taskStatus&&("failure"!==o.taskStatus&&"dead"!==o.taskStatus&&"timeout_before_execution"!==o.taskStatus&&"retryable_failure"!==o.taskStatus||o.error&&ge().log({level:"error",from:"ConnectedRelationActionsCopyUrl",type:"bulkCreateConnectedPropertyFailed",data:{miscDataToConvertToString:{error:o.error,spaceId:a.getSpaceId(),botId:l,collectionId:a.id,integrationId:e.integrationId,sourceColumnId:s,destinationColumnId:e.property,taskStatus:o.taskStatus}}}))}catch(m){ge().log({level:"error",from:"ConnectedRelationActionsCopyUrl",type:"bulkCreateConnectedPropertyFailed",data:{miscDataToConvertToString:{error:m,spaceId:a.getSpaceId(),botId:l,collectionId:a.id,integrationId:e.integrationId,sourceColumnId:s,destinationColumnId:e.property,syncProperties:p}}})}finally{Ke().d.removeCollectionProperties(a.id,new Set(p))}},children:d.formatMessage(At.copyColumn)})]}),children:(0,k.jsxs)("div",{style:{height:"100%",flexGrow:1},children:[(0,k.jsx)(wt().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Select property",id:"ConnectedRelationActionsCopyUrl.selectProperty"}),selectedKey:s||"select",popupStyle:{minWidth:190},options:[...null==p?void 0:p.map((e=>e?{key:e.id,type:"button",title:e.name}:void 0)).filter((e=>void 0!==e))],onChange:e=>{a(e)}}),(0,k.jsx)(It,{})]})})}function It(){const{isMobile:e}=(0,r().Y0)(),t=(0,S().IS)((t=>({previewContentContainer:{display:"flex",alignSelf:"center",flexDirection:"column",width:"100%",paddingLeft:10,paddingRight:10,cursor:"default"},tabDescription:{padding:e?18:10,fontSize:e?16:12,color:t.text.tertiary}})),[e]);return(0,k.jsxs)(ae().A,{disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,mobileStyle:t.previewContentContainer,children:[(0,k.jsxs)("div",{style:t.tabDescription,children:[" ","Preview"]}),(0,k.jsx)("div",{children:(0,k.jsx)("img",{src:W().A.images.externalIntegrations.salesforceCopyUrlPng,style:t.previewContentContainer,alt:"Salesforce Copy URL"})})]})}function Mt(e){const{isMobile:t}=(0,r().Y0)();return(0,k.jsx)(ae().A,{children:(0,k.jsx)(Re().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?le().J.UISmall.mobile:le().J.UISmall.desktop},children:(0,k.jsx)(f().sA,{defaultMessage:"Select the column you wish to copy. Copied columns will be auto-converted as a Salesforce property with live preview on hover",id:"database.viewSettings.ConnectedRelationActionsCopyUrl.description"})})})}var kt=()=>o(497222),Tt=()=>o(553965),Pt=()=>o(962730);const Bt=(0,f().YK)({inputPlaceholder:{defaultMessage:"Search object",id:"database.viewSettings.ConnectedRelationActionsObjectSelection.inputPlaceholder"},filterSalesforceObjects:{defaultMessage:"Salesforce",id:"ConnectedRelationActionsObjectSelection.filterObjects"},genericErrorDescription:{defaultMessage:"We were unable to fetch any Salesforce objects, please try again",id:"ConnectedRelationActionsObjectSelection.genericErrorDescription"}});function Vt(e){const{collectionSettingsStore:t,collectionContextStore:o}=e,[i,s]=n.useState(""),a=(0,r().v3)(),c=(0,f().tz)(),d=(0,S().DP)(),p=(0,l().K8)((()=>{var e;return null==o||null===(e=o.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[o]),g=(0,l().K8)((()=>{const e=De().A.state;if(!e.loaded)return;const t=e.integrations.find((e=>e.id===pe().mn));return t?t.info.icon:void 0}),[]),m=(0,l().K8)((()=>{const e=De().A.state;if(!e.loaded)return;const t=e.bots.find((e=>e.integration_id===pe().Iy));return t?t.id:void 0}),[]),h=(0,S().IS)((e=>({shimmerRow:{display:"flex",cursor:"pointer",alignItems:"center",gap:6,height:24,marginTop:4,marginLeft:16,borderRadius:4},leftShimmer:{height:14,width:14,borderRadius:6},rightShimmer:{height:14,borderRadius:6}})),[]),[{status:x,value:v,error:C}]=(0,me().Yb)((async()=>{if(!p||!m)throw new Error("Not loaded");const e=await async function(e){const{environment:t,spaceId:o,botId:n}=e,i=await Ge().callApi({eventName:"listSalesforceObjects",environment:t,data:{spaceId:o,botId:n}});return i&&"success"===(null==i?void 0:i.type)?{value:null==i?void 0:i.data}:{error:null==i?void 0:i.error}}({environment:a,spaceId:p,botId:m});if(xe().Q.isFail(e))throw e.error;const t=e.value;if(t.requiresReauthentication)throw new Error(Xe().y$.reauthenticationRequired);if(t.sObjects.length>0)return t.sObjects.map((e=>({name:e.name,label:e.label})))}),[p,a,m]),[{status:b,value:w}]=(0,me().Yb)((async()=>{var e;const t=null===(e=o.collectionStore())||void 0===e?void 0:e.getSchema(),n=new Map;if(t)for(const[o,l]of Object.entries(t)){var i;if(l&&(0,de().UU)(l)&&(null===(i=l.connectedRelation)||void 0===i?void 0:i.integration_id)===pe().mn){var r;const e=(0,de().Nv)(l);if(!e)continue;const t=new(qe().m)(a,e);await t.load();const i=null==t||null===(r=t.getFormat())||void 0===r?void 0:r.pattern_name;i&&n.set(i,{property:l,id:o})}}return n}),[a,o]),j=(0,l().O$)(ce().AppStoreCurrentSpaceStore);return j?vt(C)?(0,k.jsx)(mt,{currentSpaceStore:j,collectionSettingsStore:t,title:c.formatMessage(Bt.filterSalesforceObjects)}):"rejected"===x||"rejected"===b?(0,k.jsx)(ot,{collectionSettingsStore:t,title:jt().A.formatMessage(Bt.filterSalesforceObjects),description:c.formatMessage(Bt.genericErrorDescription)}):(0,k.jsxs)(y().Ay,{...e,title:c.formatMessage(Bt.filterSalesforceObjects),header:(0,k.jsx)(Ft,{inputValue:i,integrationName:"Salesforce",onChange:s}),handleClose:()=>{u().os({collectionSettingsStore:t})},menuScrollerStyle:{paddingBottom:6},children:[("pending"===x||"pending"===b||"Not loaded"===(null==C?void 0:C.message))&&[64,51,73,95,45,67,45,91,52].map(((e,t)=>(0,k.jsxs)("div",{style:{...h.shimmerRow},children:[(0,k.jsx)(Ve().A,{style:{...h.leftShimmer}}),(0,k.jsx)(Ve().A,{style:{...h.rightShimmer,width:e}})]},t))),"resolved"===x&&"resolved"===b&&v&&(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:0,sections:[{key:"objects",render:e=>(0,k.jsx)(ae().A,{...e,title:"Salesforce objects"}),items:v.filter((e=>e.label.toLowerCase().includes(i.toLowerCase()))).sort(((e,t)=>w.has(e.name)&&!w.has(t.name)?-1:!w.has(e.name)&&w.has(t.name)?1:0)).map((e=>({key:e.name,render:t=>(0,k.jsx)(Ie().A,{placement:Pt().W.Left,textWrap:!0,style:{maxWidth:240},disableTooltip:!w.has(e.name),renderTooltip:()=>(0,k.jsx)(f().sA,{defaultMessage:"This object is already connected to a property in this collection.",id:"ConnectedRelationActionsObjectSelection.alreadyConnected"}),render:o=>(0,k.jsx)(kt().A,{...(0,Tt().A)(t,o),showChevron:!0,title:e.label,icon:()=>(0,k.jsx)(ue().zB,{type:"text",icon:g,size:16,theme:d})})}),action:async()=>{if(w.has(e.name)){var t;const n=o.collectionStore(),i=null==n?void 0:n.getSchema(),r=w.get(e.name),l=null==r||null===(t=r.property)||void 0===t||null===(t=t.connectedRelation)||void 0===t?void 0:t.integration_id,s=null==r?void 0:r.id;if(!s)return;const c=null==i?void 0:i[s];u().a2({collectionSettingsStore:o.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:s,integrationId:pe().mn,rootPropertySchema:c,skipDatabaseActions:!1}}),(0,be().u)({environment:a,event:{eventName:"salesforce_actions",eventProperties:{actionType:"add_properties_clicked",integrationId:l,collectionId:null==n?void 0:n.id}}})}else await Ye({environment:a,objectName:e.name,objectLabel:e.label,collectionContextStore:o,intl:c})}})))}]})]}):null}function Ft(e){return(0,k.jsx)(ae().A,{children:(0,k.jsx)(Be().Ay,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:jt().A.formatMessage(Bt.inputPlaceholder)})})}function Et(e){const{collectionSettingsStore:t,collectionContextStore:o,tabSettings:{source:n,rootPropertyId:i,rootPropertySchema:s,integrationId:a,skipDatabaseActions:c}}=e,d=(0,l().O$)(ce().AppStoreCurrentSpaceStore),u=pt({currentSpaceStore:d}),p=(0,l().K8)((()=>null==o?void 0:o.collectionStore()),[o]),g=(0,r().v3)();return"connected"!==u.status?d&&p?(0,k.jsx)(Rt,{collectionSettingsStore:t,integrationId:a,currentSpaceStore:d,collectionStore:p,environment:g}):null:"connectedRelationAddProperties"===n&&i&&s?(0,k.jsx)(yt,{rootPropertyId:i,integrationId:a,rootPropertySchema:s,skipDatabaseActions:c,...e}):"ConnectedRelationObjectSelection"===n?(0,k.jsx)(Vt,{integrationId:a,...e}):"connectedRelationCopyUrl"===n&&i?(0,k.jsx)(_t,{integrationId:a,property:i,...e}):null}function Rt(e){const{currentSpaceStore:t,collectionSettingsStore:o}=e,{isMobile:n}=(0,r().Y0)(),i=(0,S().IS)((e=>({headline:{fontSize:n?le().J.UISmall.mobile:le().J.UISmall.desktop,color:e.text.secondary}})),[n]);return(0,k.jsx)(y().Ay,{...e,collectionSettingsStore:o,title:(0,k.jsx)(f().sA,{defaultMessage:"Salesforce Authentication",id:"database.viewSettings.salesforceAuth.title"}),handleClose:()=>{u().os({collectionSettingsStore:o})},menuScrollerStyle:{paddingBottom:6},footer:(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(se().A,{className:"notion-print-ignore",href:"https://dev.notion.so/notion/24d0b4fbb2e04972bb22ee8104002ade?v=17eb35e6e67f80c4b497000c1a8c589d&pvs=4",external:!0,children:(0,k.jsx)(D().p,{iconLeading:ie().M,isLightGray:!0,style:{width:"100%",padding:12,border:"none"},children:(0,k.jsx)(f().sA,{defaultMessage:"Provide feedback",id:"database.viewSettings.collectionSettingsExternalSource.feedbackLink"})})})}),children:(0,k.jsxs)("div",{style:{padding:"0px 12px"},children:[(0,k.jsx)(ae().A,{disableMobileBorders:!0,children:(0,k.jsx)("div",{style:i.headline,children:(0,k.jsx)(f().sA,{defaultMessage:"To add Salesforce objects or properties, you need to authenticate with your Salesforce account",id:"database.viewSettings.salesforceAuth.description"})})}),(0,k.jsx)(K().A,{size:4,isHidden:!0}),(0,k.jsx)(ae().A,{disableMobileBorders:!0,children:(0,k.jsx)(ut,{captionText:(0,k.jsx)(f().sA,{defaultMessage:"Link your Salesforce account to add Salesforce objects and properties to your database",id:"database.viewSettings.salesforceAuth.captionText"}),integrationIcon:(0,re().salesforceIcon)({width:48,height:48}),currentSpaceStore:t,flowId:""})})]})})}var Dt=()=>o(94701),Kt=()=>o(668725),Ot=()=>o(436572),Lt=()=>o(939656),zt=()=>o(928600),Nt=()=>o(504836),Ut=()=>o(722872),Wt=()=>o(377586),Ht=()=>o(666803);function $t(e){return[30,90,180,270,365].includes(e)}function Gt(e){const{collectionSettingsStore:t,collectionContextStore:o,action:i,selectedProjectKeys:s,selectedProperties:a}=e,c=(0,r().v3)(),d=(0,r().Y0)(),{isSetupComplete:p,botId:g,spaceId:m,collectionStore:h,syncWindow:x}=(0,l().K8)((()=>{var e,t;const n=o.collectionStore(),i=(null==n||null===(e=n.getFormat())||void 0===e||null===(e=e.sync_state)||void 0===e||null===(e=e.filter_config)||void 0===e?void 0:e.sync_window)??365;return{isSetupComplete:Boolean(null==n||null===(t=n.getFormat())||void 0===t||null===(t=t.sync_state)||void 0===t?void 0:t.last_synced_at),botId:null==n?void 0:n.getFormat().bot_id,spaceId:null==n?void 0:n.getSpaceId(),collectionStore:n,syncWindow:$t(i)?i:365}}),[o]),[v,C]=(0,n.useState)(x),w=!p,j=(0,l().K8)((()=>{var e;const t=null==h?void 0:h.getFormat(),n=null==h?void 0:h.getSchema(),i=o.collectionViewBlockStore();return"notion://projects_collection"===(null==t?void 0:t.app_config_uri)?null===(e=(0,Lt().k7)(i,null==n?void 0:n["notion://projects/project_to_task_relation"]))||void 0===e?void 0:e.id:null==h?void 0:h.id}),[o,h]),A=(0,l().K8)((()=>{var e;return null==h||null===(e=h.getFormat())||void 0===e?void 0:e.synced_collection_external_url}),[h]),_=(0,l().O$)(Ht().Ay),M=(0,l().K8)((()=>{const e=_.flowId||I().JW();return _.flowId||Ht().Ay.setState({..._,flowId:e}),e}),[_]),T=(0,l().K8)((()=>Boolean(De().A.externalAuthentications.state.find((e=>e.id===g&&e.user_id===c.currentUser.id)))),[g,c]),{isMobile:P}=(0,r().Y0)(),B=(0,S().IS)((e=>({snackbarCta:{color:e.text.contrastPrimary,marginLeft:16},titleContainer:{display:"flex",flexDirection:"row",gap:"8px"},stepText:{color:e.text.secondary},filterContainer:{padding:12,marginBottom:12},dropdownLabel:{color:e.text.secondary,fontSize:le().J.UISmall.desktop,fontWeight:le().Wy.medium,marginBottom:8},dropdownButton:{width:"100%",padding:"6px 8px",color:e.text.primary,fontSize:le().J.UIRegular.desktop,display:"inline-flex",justifyContent:"space-between",alignItems:"center",borderRadius:4,border:`1px solid ${e.stroke.secondary}`},dropdownIcon:{width:10,marginLeft:4,fill:e.icon.tertiary},checkIcon:{width:14},infoLabel:{color:e.text.tertiary,marginTop:8,marginBottom:12,fontSize:P?le().J.UISmall.mobile:le().J.UISmall.desktop}})),[P]),V=[{key:30,name:"In the last month"},{key:90,name:"In the last 3 months"},{key:180,name:"In the last 6 months"},{key:270,name:"In the last 9 months"},{key:365,name:"In the last year"}];return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsxs)("div",{style:B.titleContainer,children:[w&&(0,k.jsx)("div",{style:B.stepText,children:(0,k.jsx)(f().sA,{defaultMessage:"Step 3",id:"database.viewSettings.collectionSettingsExternalListFilters.step3Title"})}),(0,k.jsx)(f().sA,{defaultMessage:"Filter issues",id:"database.viewSettings.collectionSettingsExternalListFilters.title"})]}),header:(0,k.jsx)(Qt,{}),handleClose:()=>{u().os({collectionSettingsStore:t})},footer:(0,k.jsx)(Zt,{onSubmit:async()=>{if(!(h&&g&&m))return;const{projectCollectionPointer:e,taskCollectionPointer:o}=(0,Nt().Be)(h);if(!e||!o)return;const n=t.state.stack.find((e=>"externalProjectsSyncSettings"===e.type&&"external_list_projects"===e.source));Ot().D6({label:(0,k.jsx)(f().sA,{defaultMessage:"Started syncing from Jira. You’ll be notified when the sync is complete",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.title"}),right:(0,k.jsx)(D().p,{onClick:Ot().N2,style:B.snackbarCta,children:(0,k.jsx)(f().sA,{defaultMessage:"Close",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.close"})}),position:"bottom"}),await Ge().callApi({eventName:"syncJiraProjects",environment:c,data:{botId:g,projectKeys:s,spaceId:m,properties:a,projectCollectionPointer:e,taskCollectionPointer:o,onlyUpdateProperties:!n,flowId:M,filterConfig:{syncWindow:v}}}),n?(0,be().u)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"sync_projects_and_properties",flowId:M,identifier:A,botId:g,collectionId:j,isSyncOwner:T}}}):(0,be().u)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"sync_properties",flowId:M,identifier:A,botId:g,collectionId:j,isSyncOwner:T}}}),Ht().Ay.setState({...Ht().Ay.state,flowId:void 0}),u().os({collectionSettingsStore:t})},action:i,isSetupComplete:p}),fullHeight:!0,menuScrollerStyle:{paddingBottom:6},children:(0,k.jsxs)("div",{style:B.filterContainer,children:[(0,k.jsx)(Re().A,{style:B.dropdownLabel,children:(0,k.jsx)(f().sA,{defaultMessage:"Issues created or modified",id:"database.viewSettings.collectionSettingsExternalListFilters.timeWindowLabel"})}),(0,k.jsx)(b().Ay,{popupType:d.isMobile?Wt().n.BottomSheet:Wt().n.Popup,renderOrigin:e=>{var t;return(0,k.jsxs)(D().p,{...e,style:B.dropdownButton,children:[null===(t=V.find((e=>e.key===v)))||void 0===t?void 0:t.name,(0,Kt().b)(B.dropdownIcon)]})},render:e=>{const t=[{key:"time-window-section",render:e=>(0,k.jsx)(ae().A,{...e}),items:V.map((t=>({key:t.key,action:()=>{C($t(t.key)?t.key:x),e.close()},render:e=>(0,k.jsx)(Pe().A,{...e,title:t.name,right:v===t.key?(0,k.jsx)("div",{style:B.checkIcon,children:(0,Dt().checkmarkFillIcon)()}):void 0})})))}];return(0,k.jsx)(zt().A,{menuType:Ut().gu.Popup,width:200,children:(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,sections:t,initialFocus:void 0})})}}),(0,k.jsx)(Re().A,{isMultiline:!0,style:B.infoLabel,children:(0,k.jsx)(f().sA,{defaultMessage:"If an issue in this timeframe has a parent outside it, we’ll still sync the parent.",id:"database.viewSettings.collectionSettingsExternalListFilters.infoLabel"})})]})})}function Qt(){const{isMobile:e}=(0,r().Y0)(),t=(0,S().IS)((t=>({description:{marginLeft:8,fontSize:e?le().J.UISmall.mobile:le().J.UISmall.desktop,marginBottom:-4}})),[e]);return(0,k.jsx)(ae().A,{children:(0,k.jsx)(Re().A,{isSecondaryColor:!0,isMultiline:!0,style:t.description,children:(0,k.jsx)(f().sA,{defaultMessage:"Select a timeframe to sync issues that were created or modified during that period.",id:"database.viewSettings.collectionSettingsExternalListFilters.description"})})})}function Zt(e){const t=(0,S().IS)((e=>({wrapper:{padding:12,borderTop:`1px solid ${e.tableHomeDividerColor}`},button:{width:"100%",border:"none",fontWeight:le().Wy.medium},buttonWrapper:{width:"100%"}})),[]),o=e.action===de().Sh.SyncProjects?(0,k.jsx)("div",{style:t.buttonWrapper,children:(0,k.jsx)(A().A,{style:t.button,onClick:e.onSubmit,children:e.isSetupComplete?(0,k.jsx)(f().sA,{defaultMessage:"Sync projects",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncProjectsButton"}):(0,k.jsx)(f().sA,{defaultMessage:"Start Jira sync",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.startJiraSyncButton"})})}):(0,k.jsx)("div",{style:t.buttonWrapper,children:(0,k.jsx)(A().A,{style:t.button,onClick:e.onSubmit,children:(0,k.jsx)("div",{style:{textOverflow:"ellipsis",overflow:"hidden"},children:(0,k.jsx)(f().sA,{defaultMessage:"Sync filtered issues",id:"database.viewSettings.collectionSettingsExternalListFilters.syncFilteredIssues"})})})});return(0,k.jsx)("div",{style:t.wrapper,children:o})}var qt=()=>o(278238),Yt=()=>o(442277),Jt=()=>o(133033),Xt=()=>o(282883),eo=()=>o(496603),to=()=>o(763824),oo=()=>o(901389),no=()=>o(510683),io=()=>o(635676),ro=()=>o(836251),lo=()=>o(963589),so=()=>o(404141),ao=()=>o(10984);const co=(0,f().YK)({inputPlaceholder:{defaultMessage:"Search for a project...",id:"database.viewSettings.collectionSettingsExternalListProjects.inputPlaceholder"},fetchingProjects:{defaultMessage:"Loading projects from Jira...",id:"database.viewSettings.collectionSettingsExternalListProjects.fetchingProjects"},fetchingProjectsFailed:{defaultMessage:"We’re experiencing temporary issues with Jira’s APIs. Please try again in a sometime.",id:"database.viewSettings.collectionSettingsExternalListProjects.fetchingProjectsFailed"},defaultLoadingMessage:{defaultMessage:"Loading...",id:"database.viewSettings.collectionSettingsExternalListProjects.loading"},somethingWentWrong:{defaultMessage:"Something went wrong. Please try again!",id:"database.viewSettings.collectionSettingsExternalListProjects.somethingWentWrong"},authInProgress:{defaultMessage:"Authenticating with Jira...",id:"database.viewSettings.collectionSettingsExternalListProjects.authInProgress"},authFailed:{defaultMessage:"Authentication failed, try again!",id:"database.viewSettings.collectionSettingsExternalListProjects.authFailed"},noAccessToSite:{defaultMessage:"If you have multiple Jira sites, make sure you’re authenticating into {site}",id:"database.viewSettings.collectionSettingsExternalListProjects.noAccessToSite"}});function uo(e){switch(e){case"fetchingProjects":return co.fetchingProjects;case"somethingWentWrong":return co.somethingWentWrong;case"fetchingProjectsFailed":return co.fetchingProjectsFailed;case"authFailed":return co.authFailed;case"authInProgress":return co.authInProgress;case"noAccessToSite":return co.noAccessToSite;default:return co.defaultLoadingMessage}}function po(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,[i,s]=n.useState(""),[a,c]=n.useState(!1),[d,p]=n.useState([]),[g,m]=n.useState(!1),[h,x]=n.useState(0),[v,C]=n.useState(!1),[b,w]=n.useState([]),[A,_]=n.useState([]),[M,T]=n.useState([]),[P,B]=n.useState({show:!1}),[V,F]=n.useState(!1),[R,K]=n.useState({show:!1}),[O,L]=n.useState(""),z=(0,r().v3)(),N=(0,l().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[t]),U=(0,l().O$)(ce().AppStoreCurrentSpaceStore),W=(0,l().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().bot_id}),[t]),[{value:H}]=(0,me().Yb)((async()=>{if(W&&N)return Ge().callApi({eventName:"getExternalConnectionMetaInfo",environment:z,data:{botId:W,spaceId:N}})}),[z,W,N]);(0,n.useEffect)((()=>{"success"===(null==H?void 0:H.type)&&"data"in H&&L(H.data.email)}),[H]);const $=(0,l().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().synced_collection_external_url}),[t]),G=(0,l().K8)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.synced_collection_instance_type)??"Cloud"}),[t]),Q="DataCenter"===G?"jira-dc":"jira",Z=(0,l().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.external_collection_type}),[t]),q=(0,l().K8)((()=>{var e,o;const n=null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat();return Boolean(null==n||null===(o=n.sync_state)||void 0===o?void 0:o.last_synced_at)}),[t]),Y=(0,lo().X)("jira_sync_import_filters"),J=!q&&Y,X=(0,l().O$)(Ht().Ay),{projectCollectionPointer:ee,taskCollectionPointer:te}=(0,l().K8)((()=>(0,Nt().Be)(t.collectionStore())),[t]),oe=(0,l().K8)((()=>{if(W&&U){return ct().vK.createChildStore(U,{table:lt().GP,id:W,spaceId:U.id}).getLastEditedById()}return null}),[W,U]),ne=(0,l().K8)((()=>(null==U?void 0:U.userId)===oe),[oe,U]),ie=(0,l().K8)((()=>{const e=Ht().Ay.state.flowId||I().JW();return Ht().Ay.setState({...Ht().Ay.state,flowId:e}),e}),[]),re=(0,l().K8)((()=>X.projectKeys),[X]),[{value:ae}]=(0,me().Yb)((async()=>N&&W&&ee?(B({show:!0,type:"fetchingProjects"}),"DataCenter"===G&&(0,Nt().ru)()?Ge().callStreamApi({eventName:"streamProjectsForJiraSite",environment:z,data:{botId:W,spaceId:N,projectCollectionPointer:ee}}):Ge().callApi({eventName:"getProjectsForJiraSite",environment:z,data:{botId:W,spaceId:N,projectCollectionPointer:ee}})):null),[z,ee,N,W,G]),ue=(0,l().K8)((()=>ao().dL()),[]);(0,n.useEffect)((()=>{ue&&h>100?(m(!0),(0,be().u)({environment:z,event:{eventName:"external_sync_setup_action",eventProperties:{integration:Q,actionType:"issues_free_limit_exceeded",flowId:ie,issueCount:h,isSyncOwner:ne}}})):m(!1)}),[z,ie,ue,h,ne,Q]);const ge=(0,n.useCallback)((e=>{const{jiraProjects:t,permittedProjects:o,existingImportedProjectKeys:n}=e;T(n);const i=o.map((e=>e.key));w(i);const r=[...t.filter((e=>{let{isPrivate:t}=e;return!t})).sort(((e,t)=>{var o,n;return t.insight&&e.insight?null!==(o=t.insight)&&void 0!==o&&o.lastIssueUpdateTime&&null!==(n=e.insight)&&void 0!==n&&n.lastIssueUpdateTime?new Date(t.insight.lastIssueUpdateTime).getTime()-new Date(e.insight.lastIssueUpdateTime).getTime():t.insight.totalIssueCount-e.insight.totalIssueCount:1})),...t.filter((e=>{let{isPrivate:t}=e;return t})).sort(((e,t)=>{const o=i.includes(e.key),n=i.includes(t.key);return o&&n?0:o?-1:1}))];let l=0;r.forEach((e=>{var t;n.includes(e.key)&&(l+=(null===(t=e.insight)||void 0===t?void 0:t.totalIssueCount)??0)})),_(r),x(l);const s=eo().sb([...n,...re||[]]);n.length&&c(!0),s&&p(s)}),[re]),Se=(0,n.useCallback)((async e=>{const{response:t}=e;let n=!1;try{for await(const e of t){if("error"===e.type){if(B({show:!1}),F(!1),"code"in e){if(!("SITE_NOT_FOUND"!==e.code&&"NO_USER_BOT_FOUND"!==e.code&&"INVALID_BOT"!==e.code||ne))return void C(!0);if("TOKEN_EXPIRED"===e.code)return void u().yl({collectionSettingsStore:o})}return void K({show:!0,type:"fetchingProjectsFailed"})}if(!n){c(!0),T(e.existingImportedProjectKeys);const t=eo().sb([...e.existingImportedProjectKeys,...re||[]]);p(t),n=!0,B({show:!1})}_((t=>eo().Mp([...t,...e.permittedProjects],((e,t)=>e.key===t.key)))),w((t=>eo().sb([...t,...e.permittedProjects.map((e=>e.key))])))}}finally{F(!1)}}),[re,ne,o]);(0,n.useEffect)((()=>{if("success"!==(null==ae?void 0:ae.type)&&"failed"!==(null==ae?void 0:ae.type)||("Cloud"!==G&&(0,Nt().ru)()||B({show:!1}),"failed"===(null==ae?void 0:ae.type)&&K({show:!0,type:"fetchingProjectsFailed"})),"success"===(null==ae?void 0:ae.type)&&"data"in ae&&"object"==typeof ae.data)if("code"in ae.data){if("TOKEN_EXPIRED"===ae.data.code)u().yl({collectionSettingsStore:o});else if(!ne){const{code:e}=ae.data;"SITE_NOT_FOUND"===e?(C(!0),K({show:!0,type:"noAccessToSite"})):"NO_USER_BOT_FOUND"!==e&&"INVALID_BOT"!==e||C(!0),(0,be().u)({environment:z,event:{eventName:"external_sync_auth",eventProperties:{integration:Q,actionType:"member_auth_render",flowId:ie}}})}}else{const e=ae.data;Symbol.asyncIterator in e?(F(!0),Se({response:e})):ge(e)}}),[ae,ne,ge,Se,z,ie,G,Q,o]);const fe=Z?io().l[Z]:"",ye=(0,l().K8)((()=>{const e=Ht().Ay.state;return e.isMemberAuthSuccessForDataCenter&&!e.open&&"DataCenter"===e.instanceValue&&e.site&&"dc-auth"===e.type}),[]);(0,me().Yb)((async()=>{if(!ne&&ee&&N&&W&&ye&&(0,Nt().Zf)()&&(0,Nt().ru)()){C(!1),B({show:!0,type:"fetchingProjects"}),_([]),F(!0);try{const e=await Ge().callStreamApi({eventName:"streamProjectsForJiraSite",environment:z,data:{botId:W,spaceId:N,projectCollectionPointer:ee}});"success"===e.type&&"data"in e&&"object"==typeof e.data&&await Se({response:e.data})}catch(e){F(!1),K({show:!0,type:"fetchingProjectsFailed"})}}}),[W,N,ee,z,Se,ye,ne]);const ve=(0,S().IS)((e=>{const t="dark"===e.mode;return{fetchingProjects:{width:"100%",height:"100%",paddingBottom:10,display:"flex",justifyContent:"center",alignItems:"center",fontSize:14,paddingLeft:8,paddingRight:8,color:e.text.secondary,textAlign:"center"},projectIcon:{width:20,height:20,borderRadius:4,..."Cloud"===G&&{marginBottom:14}},connectAccountWrapper:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",margin:12,padding:12,flexDirection:"column",gap:8},connectAccountCTA:{borderRadius:6},connectAccountDescription:{fontSize:le().J.UIRegular.desktop,textAlign:"center",color:e.text.secondary},errorMessage:{display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",height:"100%",color:E().Ay.red,paddingLeft:8,paddingRight:8,fontSize:le().J.UIRegular.desktop},authErrorMessage:{fontSize:le().J.UIRegular.desktop,color:e.text.secondary,marginBottom:12,textAlign:"center"},permittedProjectItemTitle:{fontSize:le().J.UISmall.desktop,fontWeight:le().Wy.medium},permittedProjectItemCaption:{fontSize:le().J.UISmall.desktop,color:qt().l8.dark.gray,fontWeight:le().Wy.regular},disabledItem:{color:e.text.secondary,fill:e.icon.secondary,opacity:.4},sectionMargin:{margin:"0px 14px"},projectVisibilityCallout:{fontSize:le().J.UISmall.desktop,...!t&&{backgroundColor:E().Ay.EmailLinkBackground},padding:"6px 8px",marginBottom:6,borderRadius:6,color:e.text.secondary},privateProjectCallout:{width:"-webkit-fill-available",padding:"0px 16px",color:e.text.secondary,marginLeft:4,marginRight:4},helpIcon:{width:12,height:12,display:"inline-block"},menuListItem:{paddingTop:"0px",paddingBottom:"0px"},checkBox:{borderRadius:2,..."Cloud"===G&&{marginBottom:14}},deskTopIcon:{..."Cloud"===G&&{alignSelf:"center"}},stepText:{color:e.text.secondary},titleContainer:{display:"flex",flexDirection:"row",gap:"8px"}}}),[G]);if(!W||!N)return null;const Ce=A.length?(0,he().Ay)(i,A,(e=>e.name)):[],we=e=>{const t=e.key;var o,n;d.includes(t)?(p(d.filter((e=>e!==t))),x(h-((null===(o=e.insight)||void 0===o?void 0:o.totalIssueCount)??0))):(p([...d,t]),x(h+((null===(n=e.insight)||void 0===n?void 0:n.totalIssueCount)??0)))},je=()=>{const e=A.filter((e=>Be(e.key)));if(d.length===e.length)p([]),x(0);else{let e=0;p(A.filter((e=>Be(e.key))).map((t=>{var o;return e+=(null===(o=t.insight)||void 0===o?void 0:o.totalIssueCount)??0,t.key}))),x(e)}},_e=()=>{let e=0;const t=A.filter((e=>!M.includes(e.key)&&Be(e.key))).map((t=>{var o;return e+=(null===(o=t.insight)||void 0===o?void 0:o.totalIssueCount)??0,t.key})),o=d.filter((e=>!t.includes(e)));if(t.every((e=>d.includes(e))))p(o),x(h-e);else{p([...o,...t]);let e=0;for(const t of d){const o=A.find((e=>e.key===t));var n;if(o)e+=(null===(n=o.insight)||void 0===n?void 0:n.totalIssueCount)??0}x(e)}},Te=()=>{const e=d.filter((e=>!M.includes(e)));M.every((e=>d.includes(e)))?p(e):p([...e,...M]);let t=0;for(const n of d){const e=A.find((e=>e.key===n));var o;if(e)t+=(null===(o=e.insight)||void 0===o?void 0:o.totalIssueCount)??0}x(t)},Be=e=>b.includes(e),Ve=$&&(0,it().A)((0,Nt().ay)($)),Fe=Ce.map((e=>({key:e.id,render:()=>(0,k.jsx)(Ie().A,{disableTooltip:Be(e.key),renderTooltip:e=>(0,k.jsx)("div",{...e,style:Me().Q$,children:Ne}),render:t=>(0,k.jsx)(Pe().A,{...t,style:ve.menuListItem,focused:!1,buttonStyle:Be(e.key)?{}:ve.disabledItem,disabled:!Be(e.key),onClick:()=>{we(e)},title:(0,k.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,k.jsx)("div",{children:(0,k.jsx)(Ee().T,{size:14,disabled:!Be(e.key),checked:d.includes(e.key),onClick:()=>{we(e)},style:ve.checkBox})}),icon:(0,k.jsx)("img",{src:e.avatarUrls["48x48"],style:ve.projectIcon,alt:e.name}),desktopIconStyle:ve.deskTopIcon,caption:e.insight&&(0,k.jsx)("div",{children:e.isPrivate?(0,k.jsx)(f().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.allProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,k.jsx)(f().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.allProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),Re=Ce.filter((e=>M.includes(e.key))).map((e=>({key:e.id,render:()=>(0,k.jsx)(Ie().A,{disableTooltip:Be(e.key),renderTooltip:e=>(0,k.jsx)("div",{...e,style:Me().Q$,children:Ne}),render:t=>(0,k.jsx)(Pe().A,{...t,style:ve.menuListItem,focused:!1,buttonStyle:Be(e.key)?{}:ve.disabledItem,disabled:!Be(e.key),onClick:()=>{we(e)},title:(0,k.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,k.jsx)("div",{children:(0,k.jsx)(Ee().T,{size:14,disabled:!Be(e.key),checked:d.includes(e.key),onClick:()=>{we(e)},style:ve.checkBox})}),icon:(0,k.jsx)("img",{src:e.avatarUrls["48x48"],style:ve.projectIcon,alt:e.name}),desktopIconStyle:ve.deskTopIcon,caption:e.insight&&(0,k.jsx)("div",{children:e.isPrivate?(0,k.jsx)(f().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,k.jsx)(f().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),Ke=Ce.filter((e=>!M.includes(e.key))).map((e=>({key:e.id,render:()=>(0,k.jsx)(Ie().A,{disableTooltip:Be(e.key),renderTooltip:e=>(0,k.jsx)("div",{...e,style:Me().Q$,children:Ne}),render:t=>(0,k.jsx)(Pe().A,{...t,style:ve.menuListItem,focused:!1,buttonStyle:Be(e.key)?{}:ve.disabledItem,disabled:!Be(e.key),onClick:()=>{we(e)},title:(0,k.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,k.jsx)("div",{children:(0,k.jsx)(Ee().T,{size:14,disabled:!Be(e.key),checked:d.includes(e.key),onClick:()=>{we(e)},style:ve.checkBox})}),desktopIconStyle:ve.deskTopIcon,icon:(0,k.jsx)("img",{src:e.avatarUrls["48x48"],style:ve.projectIcon,alt:e.name}),caption:e.insight&&(0,k.jsx)("div",{children:e.isPrivate?(0,k.jsx)(f().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}} (Private)",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsIssueCountPrivate",values:{issues:e.insight.totalIssueCount}}):(0,k.jsx)(f().sA,{defaultMessage:"{issues, plural, one {{issues} issue} other {{issues} issues}}",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsIssueCountNotPrivate",values:{issues:e.insight.totalIssueCount}})})})}),action:()=>{}}))),Oe=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:ve.permittedProjectItemTitle,children:(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.userTooltipTitleForPrivatePages",defaultMessage:"Only some private projects can be synced to Notion"})}),(0,k.jsx)("div",{style:ve.permittedProjectItemCaption,children:ne?(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.owner.userTooltipCaptionForPrivatePages",defaultMessage:"{site} sync was set up with the Jira account {email}. You can only sync projects they have access to. Click to view the help center",values:{email:O,site:Ve||"This"}}):(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.member.userTooltipCaptionForPrivatePages",defaultMessage:"{site} sync was set up with the Jira account {email}. You can only sync projects that both have access to. Click to view the help center",values:{email:O,site:Ve||"This"}})})]}),Le=()=>(0,k.jsxs)("div",{style:{...ve.sectionMargin,...ve.projectVisibilityCallout},children:[(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCallout",defaultMessage:"Syncing these projects will make them visible to everyone with access to this database "}),(0,k.jsx)(Ie().A,{renderTooltip:e=>(0,k.jsxs)("div",{...e,style:Me().Q$,children:[(0,k.jsx)("div",{style:ve.permittedProjectItemTitle,children:(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCalloutTooltip.title",defaultMessage:"To restrict access, create a new Jira sync database"})}),(0,k.jsx)("div",{style:ve.permittedProjectItemCaption,children:(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.projectVisibilityCalloutTooltip.description",defaultMessage:"Use the Share menu to choose who can access the database, then sync your private projects"})})]}),alignment:Pt().C.Start,render:e=>(0,k.jsx)("div",{...e,style:{display:"inline",position:"relative",top:2},children:(0,k.jsx)("span",{children:(0,Jt().$)(ve.helpIcon)})})})]}),ze=()=>(0,k.jsx)(Ie().A,{renderTooltip:e=>(0,k.jsx)("div",{...e,style:Me().Q$,children:Oe}),render:e=>(0,k.jsx)(D().p,{...e,style:ve.privateProjectCallout,children:(0,k.jsxs)(se().A,{className:"notion-print-ignore",href:(0,ro().xS)("guides.externalImportAndSync"),external:!0,children:[(0,Jt().$)({...ve.helpIcon,marginRight:6}),(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects..privateProjectNotFound",defaultMessage:"Can’t find a private project?"})]})})}),Ne=ne?(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.tooltipMessageForPrivatePages",defaultMessage:"You don’t have access to this project in Jira"}):Oe;async function Ue(){K({show:!1});const e="DataCenter"===G?pe().Fv:pe().me,t=De().A.integrations.state.find((t=>{let{id:o}=t;return o===e}));if(!t||!N)return;(0,be().u)({environment:z,event:{eventName:"external_sync_auth",eventProperties:{integration:Q,actionType:"member_auth_initiated",flowId:ie}}}),e===pe().Fv&&Ht().Ay.setState({...Ht().Ay.state,site:$});const n=z.device.isElectron?await async function(e,t){const o=await no().Jq({environment:z,integration:e,spaceId:t,from:"connected_apps_settings"});B({show:!0,type:"authInProgress"});const n=De().A.externalAuthentications.state,i=performance.now()+6e4,r=to().yX(),l=setInterval((()=>{const e=performance.now();i<e?r.resolve(void 0):De().A.externalAuthentications.state.length>n.length&&r.resolve("success")}),1e3);return await r.promise,clearInterval(l),B({show:!1}),o}(t,N):await no().Jq({environment:z,integration:t,spaceId:N,from:"connected_apps_settings"});if("DataCenter"!==G||ne)if(C(!1),n&&xe().Q.isSuccess(n)){if(!W||!ee)return;if((0,be().u)({environment:z,event:{eventName:"external_sync_auth",eventProperties:{integration:Q,flowId:ie,status:"success",actionType:"member_auth_status"}}}),B({show:!0,type:"fetchingProjects"}),"DataCenter"===G&&(0,Nt().ru)()&&ne){_([]);try{const e=await Ge().callStreamApi({eventName:"streamProjectsForJiraSite",environment:z,data:{botId:W,spaceId:N,projectCollectionPointer:ee}});"success"===e.type&&"data"in e&&"object"==typeof e.data&&(F(!0),Se({response:e.data}))}catch(r){K({show:!0,type:"fetchingProjectsFailed"})}}else{var i;const e=await Ge().callApi({eventName:"getProjectsForJiraSite",environment:z,data:{botId:W,spaceId:N,projectCollectionPointer:ee,userBotId:null===(i=n.value)||void 0===i||null===(i=i.externalAuthentication)||void 0===i?void 0:i.id}});B({show:!1}),"success"===e.type?"code"in e.data?"SITE_NOT_FOUND"===e.data.code?(C(!0),oo().ui({message:(0,k.jsx)(So,{site:$,integrationIconUrl:fe,connectAccount:Ue}),showCancel:!1,keepFocus:!0,innerStyle:{width:320,padding:18},items:[]}),(0,be().u)({environment:z,event:{eventName:"external_sync_auth",eventProperties:{integration:Q,actionType:"member_auth_render",flowId:ie}}})):"NO_USER_BOT_FOUND"===e.data.code?(C(!0),K({type:"somethingWentWrong",show:!0}),(0,be().u)({environment:z,event:{eventName:"external_sync_auth",eventProperties:{integration:Q,actionType:"member_auth_render",flowId:ie}}})):"TOKEN_EXPIRED"===e.data.code?u().yl({collectionSettingsStore:o}):K({type:"fetchingProjectsFailed",show:!0}):ge(e.data):K({type:"fetchingProjectsFailed",show:!0})}}else C(!0),K({type:"authFailed",show:!0}),(0,be().u)({environment:z,event:{eventName:"external_sync_auth",eventProperties:{integration:Q,flowId:ie,status:"failed",actionType:"member_auth_status"}}})}return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsxs)("div",{style:ve.titleContainer,children:[J&&(0,k.jsx)("div",{style:ve.stepText,children:(0,k.jsx)(f().sA,{defaultMessage:"Step 1",id:"database.viewSettings.collectionSettingsExternalListProjects.step1Title"})}),(0,k.jsx)(f().sA,{defaultMessage:"{title}",id:"database.viewSettings.collectionSettingsExternalListProjects.title",values:{title:q?"Synced projects":"Select projects"}})]}),header:!P.show&&!v&&!R.show&&(0,k.jsx)(go,{inputValue:i,onChange:s}),handleClose:()=>{Ht().Ay.setState({...X,projectKeys:[],site:void 0,isMemberAuthSuccessForDataCenter:!1}),u().os({collectionSettingsStore:o})},footer:!P.show&&!v&&!R.show&&(0,k.jsx)(mo,{onActionButtonClick:()=>{const e={};A.forEach((t=>{var o;t.insight&&(d.includes(t.key)&&(e[t.key]=(null===(o=t.insight)||void 0===o?void 0:o.totalIssueCount)??0))})),u().a2({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:de().Sh.SyncProjects,selectedProjectKeys:d,projectIssueCounts:e}}),Ht().Ay.setState({...Ht().Ay.state,projectKeys:[]}),(0,be().u)({environment:z,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:Q,actionType:"select_properties_cta_click",flowId:ie,identifier:$,botId:W,collectionId:null==te?void 0:te.id,isSyncOwner:ne}}})},disabled:!a&&0===d.length,selectedProjectKeysLength:d.length,isSetupComplete:q,shouldShowUpgradePlan:g,flowId:ie,isSyncOwner:ne,integrationType:Q}),fullHeight:!0,menuScrollerStyle:{paddingBottom:6,...v||R.show?{height:"100%"}:{}},children:P.show?(0,k.jsxs)("div",{style:ve.fetchingProjects,children:[(0,k.jsx)("span",{children:jt().A.formatMessage(uo(P.type))}),(0,k.jsx)(Ae().A,{style:{alignSelf:"center"}})]}):v?(0,k.jsxs)("div",{style:ve.connectAccountWrapper,children:[R.show&&(0,k.jsx)("div",{style:ve.authErrorMessage,children:jt().A.formatMessage(uo(R.type),{site:(0,Xt().nH)($||"")})}),(0,k.jsxs)(j().A,{size:"lg",onClick:Ue,style:ve.connectAccountCTA,children:[(0,k.jsx)("img",{style:{width:14,height:15,marginRight:8},src:fe,alt:Q}),(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.connectAccountCTA",defaultMessage:"Authenticate your access"})]}),(0,k.jsx)("div",{style:ve.connectAccountDescription,children:(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.connectAccountDescription",defaultMessage:"Connect your Jira account to view and sync projects"})})]}):R.show?(0,k.jsx)("div",{style:ve.errorMessage,children:jt().A.formatMessage(uo(R.type))}):a?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ke,{title:(0,k.jsx)(f().sA,{defaultMessage:"{existingSyncedProjectsCount, plural, one {{existingSyncedProjectsCount} synced project} other {{existingSyncedProjectsCount} synced projects}}",id:"database.viewSettings.collectionSettingsExternalListProjects.syncedProjectsTitle",values:{existingSyncedProjectsCount:M.length}}),isSectionItemsLoading:V,isSelectAll:!M.every((e=>d.includes(e))),items:Re,handleSelect:Te},"syncedProjects"),(0,k.jsx)(ke,{title:(0,k.jsx)(f().sA,{defaultMessage:"{unsyncedProjectsCount, plural, one {{unsyncedProjectsCount} unsynced project} other {{unsyncedProjectsCount} unsynced projects}}",id:"database.viewSettings.collectionSettingsExternalListProjects.unsyncedProjectsTitle",values:{unsyncedProjectsCount:A.length-M.length}}),isSectionItemsLoading:V,isSelectAll:!A.filter((e=>!M.includes(e.key))).map((e=>e.key)).every((e=>d.includes(e))),sectionCallout:Le(),items:Ke,handleSelect:_e},"unsyncedProjects"),ze()]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ke,{title:(0,k.jsx)(f().sA,{defaultMessage:"{buttonText}",id:"database.viewSettings.collectionSettingsExternalListProjects.selectedProjectsTitleForInitialSync",values:{buttonText:d.length===A.length?`All ${A.length} Projects`:`${d.length.toString()} of ${A.length.toString()} projects`}}),isSectionItemsLoading:V,handleSelect:je,items:Fe,sectionCallout:Le(),isSelectAll:d.length!==A.length,disableCollapse:!0},"allProjects"),ze()]})})}function go(e){const{isMobile:t}=(0,r().Y0)();return(0,k.jsxs)(ae().A,{children:[(0,k.jsx)(Re().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?le().J.UISmall.mobile:le().J.UISmall.desktop},children:(0,k.jsx)(f().sA,{defaultMessage:"Whenever a synced project is updated in Jira, those updates will appear in Notion",id:"database.viewSettings.collectionSettingsExternalListProjects.description"})}),(0,k.jsx)(Be().Ay,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:jt().A.formatMessage(co.inputPlaceholder)})]})}function mo(e){const t=(0,r().v3)(),o=(0,S().IS)((e=>({wrapper:{padding:12,borderTop:`1px solid ${e.tableHomeDividerColor}`},wrapperInner:{borderColor:"none"},button:{width:"100%",border:"none",fontWeight:le().Wy.medium},syncDescription:{fontSize:le().J.UISmall.desktop,color:e.text.secondary,marginBottom:8,textAlign:"center"},error:{color:"#D44C47"}})),[]);return(0,k.jsx)("div",{style:o.wrapper,children:(0,k.jsx)("div",{style:o.wrapperInner,children:e.shouldShowUpgradePlan?(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{style:{...o.syncDescription,...o.error},children:(0,k.jsx)(f().sA,{defaultMessage:"Your Free Notion plan allows up to 100 synced issues. Choose fewer projects or upgrade to sync unlimited issues.",id:"database.viewSettings.collectionSettingsExternalListProjects.upgradePlanContext"})}),(0,k.jsx)(A().A,{style:o.button,onClick:()=>{so().A.setState({open:!0,openedFrom:"jira_sync_2",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0}),(0,be().u)({environment:t,event:{eventName:"external_sync_setup_action",eventProperties:{integration:e.integrationType,actionType:"plan_upgrade_cta_click",flowId:e.flowId,isSyncOwner:e.isSyncOwner}}})},disabled:e.disabled,children:(0,k.jsx)(f().sA,{defaultMessage:"Upgrade",id:"database.viewSettings.collectionSettingsExternalListProjects.Upgrade"})})]}):(0,k.jsxs)(k.Fragment,{children:[!e.isSetupComplete&&(0,k.jsx)("div",{style:o.syncDescription,children:(0,k.jsx)(f().sA,{defaultMessage:"{projects, plural, one {{projects} project will be synced} other {{projects} projects will be synced}}",id:"database.viewSettings.collectionSettingsExternalListProjects.projectsToBeSynced",values:{projects:e.selectedProjectKeysLength}})}),(0,k.jsxs)(A().A,{style:o.button,onClick:e.onActionButtonClick,disabled:e.disabled,children:[(0,k.jsx)("div",{style:{textOverflow:"ellipsis",overflow:"hidden"},children:(0,k.jsx)(f().sA,{defaultMessage:"Select properties to sync ",id:"database.viewSettings.collectionSettingsExternalListProjects.selectProperties"})}),(0,Yt().B)({width:14,height:14,marginLeft:6})]})]})})})}function So(e){const{isMobile:t}=(0,r().Y0)(),o=(0,S().IS)((e=>({title:{fontWeight:le().Wy.medium,marginRight:4,marginBottom:6},caption:{marginBottom:24},siteButtonContainer:{gap:2,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:e.stroke.secondary,marginBottom:24},siteButton:{padding:"4px 30px 4px 8px",borderRadius:6,gap:8,display:"flex"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:t?le().J.UIRegular.mobile:le().J.UIRegular.desktop,fontWeight:le().Wy.regular,lineHeight:"18px",letterSpacing:"0.15px",color:e.text.primary},siteNameSecondaryText:{fontSize:t?le().J.UISmall.mobile:le().J.UISmall.desktop,color:e.text.secondary,fontWeight:le().Wy.regular,textAlign:"left",lineHeight:t?le().K_.UISmall.mobile:le().K_.UISmall.desktop},logo:{width:20,height:20,marginTop:6},siteWrapper:{display:"flex",flexFlow:"column",gap:1,alignItems:"flex-start"}})),[t]);return(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{style:o.title,children:(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.title",defaultMessage:"Authentication Failed"})}),(0,k.jsx)(Re().A,{isSecondaryColor:!0,isMultiline:!0,style:o.caption,children:(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.description",defaultMessage:"If you have multiple Jira sites, make sure you’re authenticating into this one:"})}),(0,k.jsx)("div",{style:o.siteButtonContainer,children:(0,k.jsx)(je().A,{style:o.siteButton,disallowTabbing:!0,disabled:!0,children:(0,k.jsxs)("div",{style:o.siteButtonTextContainer,children:[(0,k.jsx)("img",{style:o.logo,src:e.integrationIconUrl,alt:e.site}),(0,k.jsxs)("div",{style:o.siteWrapper,children:[(0,k.jsx)("span",{style:o.siteNameText,children:(0,it().A)((0,Nt().ay)(e.site||""))}),(0,k.jsx)("span",{style:o.siteNameSecondaryText,children:e.site})]})]})})}),(0,k.jsx)(A().A,{style:{width:"100%",marginBottom:8},onClick:()=>{e.connectAccount(),oo().zw()},children:(0,k.jsx)(f().sA,{defaultMessage:"Try again",id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.tryAgainCTA"})}),(0,k.jsx)(D().p,{onClick:()=>{oo().zw()},style:{width:"100%",justifyContent:"center"},children:(0,k.jsx)(Re().A,{isSecondaryColor:!0,children:(0,k.jsx)(f().sA,{defaultMessage:"Cancel",id:"database.viewSettings.collectionSettingsExternalListProjects.siteMismatchPopup.cancenCTA"})})})]})}var fo=()=>o(123423);const yo=(0,f().YK)({inputPlaceholder:{defaultMessage:"Search for a property...",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.inputPlaceholder"}}),ho=o(488173).UY,xo=["attachment","issuetype"],vo=["description","comment"],Co=["updated","labels","issuelinks","creator","subtasks","reporter","watches","created"],bo=new Map([["user","person"],["attachment","file"],["array","multi_select"],["option","select"],["option-with-child","select"],["number","number"],["datetime","date"],["date","date"],["priority","select"],["issuetype","select"],["string","text"],["default","text"]]),wo=100;function jo(e){const{collectionSettingsStore:t,collectionContextStore:o,action:i,selectedProjectKeys:a}=e,[c,d]=n.useState(""),[p,g]=n.useState([]),m=(0,S().DP)(),[h,x]=n.useState(!1),v=(0,r().v3)(),C=(0,l().K8)((()=>o.collectionStore()),[o]),b=(0,l().K8)((()=>null==C?void 0:C.getFormat()),[C]),w=(0,l().K8)((()=>null==C?void 0:C.getSchema()),[C]),j=(0,lo().X)("jira_sync_import_filters"),A=(0,l().K8)((()=>{const e=o.collectionViewBlockStore();return"notion://projects_collection"===(null==b?void 0:b.app_config_uri)?(0,Lt().k7)(e,null==w?void 0:w["notion://projects/project_to_task_relation"]):C}),[o,w,b,C]),_=(0,l().K8)((()=>null==A?void 0:A.getSchema()),[A]),M=(0,l().K8)((()=>null==A?void 0:A.id),[A]),T=(0,l().K8)((()=>null==C?void 0:C.getSpaceId()),[C]),P=(0,l().K8)((()=>{var e;return null==C||null===(e=C.getFormat())||void 0===e?void 0:e.synced_collection_external_url}),[C]),B=(0,l().K8)((()=>null==C?void 0:C.getFormat().bot_id),[C]),V=(0,l().K8)((()=>p.filter((e=>e.isSelected)).length),[p]),F=(0,l().K8)((()=>{var e;const t=null==C?void 0:C.getFormat();return Boolean(null==t||null===(e=t.sync_state)||void 0===e?void 0:e.last_synced_at)}),[C]),E=(0,l().O$)(Ht().Ay),R=(0,l().K8)((()=>{const e=E.flowId||I().JW();return E.flowId||Ht().Ay.setState({...E,flowId:e}),e}),[E]),K=(0,l().K8)((()=>Boolean(De().A.externalAuthentications.state.find((e=>e.id===B&&e.user_id===v.currentUser.id)))),[B,v]),O=(0,n.useCallback)((e=>{const t=p.map((t=>{const o=e.find((e=>e.id===t.id));var n;return o&&!vo.includes(o.id)?{...t,isProjectLevel:"PROJECT"===(null===(n=o.scope)||void 0===n?void 0:n.type)}:t})),o=e.filter((e=>!t.find((t=>t.id===e.id))&&!vo.includes(e.id))).filter((e=>{let{schema:t}=e;return Boolean(t)})).map((e=>{var t;const o=xo.includes(e.id),n=(0,s().gB)(`${M}:${e.id}`),i=Boolean(null==_?void 0:_[n]);return{id:e.id,name:e.name,isSelected:o||i,isRequired:o,currentlySyncing:o||i,type:(r=null==e?void 0:e.schema,r?"watches"===r.type||"array"===r.type&&"user"===r.items?"person":"array"===r.type&&"attachment"===r.items?"file":bo.get((null==r?void 0:r.type)??"default"):"text"),isProjectLevel:"PROJECT"===(null===(t=e.scope)||void 0===t?void 0:t.type),isPopular:Co.includes(e.id)};var r}));return[...t,...o]}),[p,M,_]),L=(0,n.useCallback)((e=>{g(e);e.filter((e=>e.isSelected)).length>100&&(0,be().u)({environment:v,event:{eventName:"external_sync_setup_action",eventProperties:{integration:"jira",actionType:"properties_limit_exceeded",flowId:R,identifier:P,botId:B,collectionId:M,isSyncOwner:K}}})}),[v,P,B,M,R,K]),[{value:z}]=(0,me().Yb)((async()=>T&&P&&B?await Ge().callApi({eventName:"getFieldsForJiraIssues",environment:v,data:{spaceId:T,site:P,botId:B}}):null),[v,T,P,B]);(0,n.useEffect)((()=>{if(!h&&"success"===(null==z?void 0:z.type)&&"data"in z)if("code"in z.data)"TOKEN_EXPIRED"===z.data.code&&u().yl({collectionSettingsStore:t});else{const e=O(z.data.fields.sort(((e,t)=>{var o,n,i,r,l;return xo.includes(e.id)&&!xo.includes(t.id)?-1:!xo.includes(e.id)&&xo.includes(t.id)?1:xo.includes(e.id)&&xo.includes(t.id)||null!==(o=e.schema)&&void 0!==o&&o.customId&&null!==(n=t.schema)&&void 0!==n&&n.customId||!(null!==(i=e.schema)&&void 0!==i&&i.customId||null!==(r=t.schema)&&void 0!==r&&r.customId)?e.name.toLocaleLowerCase()>t.name.toLocaleLowerCase()?1:-1:null!==(l=e.schema)&&void 0!==l&&l.customId?1:-1})));x(!0),L(e)}}),[z,h,L,O,t]),(0,n.useEffect)((()=>{const e=[];_&&Object.entries(_).forEach((t=>{let[o,n]=t;if(("relation"!==(null==n?void 0:n.type)||null==n||!n.connectedRelation)&&(null!=n&&n.derived_property_record_metadata||ho.has(o))){var i;const t="title"===o?"Task Name (Summary)":(null==n?void 0:n.name)??ho.get(o)??"",r=(null==n||null===(i=n.derived_property_record_metadata)||void 0===i?void 0:i.external_object_attribute)??ho.get(o)??"";e.push({id:r,name:t,isSelected:!0,currentlySyncing:!0,isRequired:ho.has(o)||xo.includes(r),type:null==n?void 0:n.type})}})),g((t=>eo().hS([...t,...e],"id")))}),[_]);const N=(0,S().IS)((e=>({disabledItem:{color:e.text.secondary,fill:e.icon.secondary,opacity:.4},snackbarCta:{color:e.text.contrastPrimary,marginLeft:16},titleContainer:{display:"flex",flexDirection:"row",gap:"8px"},stepText:{color:e.text.secondary}})),[]),U=p.length?(0,he().Ay)(c,p,(e=>e.name)):[],W=e=>{L(p.map((t=>t.id===e.id?{id:e.id,name:e.name,isRequired:e.isRequired,isSelected:!e.isSelected,currentlySyncing:e.currentlySyncing,type:e.type,isPopular:e.isPopular,isProjectLevel:e.isProjectLevel}:t)))},H=U.filter((e=>e.isRequired||e.isPopular)).map((e=>({key:e.id,render:()=>(0,k.jsx)(Pe().A,{focused:!1,style:e.isRequired?N.disabledItem:{},onClick:()=>{W(e)},disabled:e.isRequired,title:(0,k.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,k.jsx)("div",{children:(0,k.jsx)(Ee().T,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{W(e)},style:{borderRadius:2}})}),icon:(0,k.jsx)(ue().zB,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}}))),$=U.filter((e=>!e.isRequired&&e.isProjectLevel)),G=U.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))),Q=$.map((e=>({key:e.id,render:()=>(0,k.jsx)(Pe().A,{focused:!1,onClick:()=>{W(e)},title:(0,k.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,k.jsx)("div",{children:(0,k.jsx)(Ee().T,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{W(e)},style:{borderRadius:2}})}),icon:(0,k.jsx)(ue().zB,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}}))),Z=G.map((e=>({key:e.id,render:()=>(0,k.jsx)(Pe().A,{focused:!1,onClick:()=>{W(e)},title:(0,k.jsx)("div",{style:{textTransform:"capitalize"},children:e.name}),left:(0,k.jsx)("div",{children:(0,k.jsx)(Ee().T,{size:14,checked:e.isSelected,disabled:e.isRequired,onClick:()=>{W(e)},style:{borderRadius:2}})}),icon:(0,k.jsx)(ue().zB,{type:e.type??"text",icon:void 0,size:16,theme:m})}),action:()=>{}})));return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)("div",{style:N.titleContainer,children:F?(0,k.jsx)(f().sA,{defaultMessage:"Synced properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.titleForSyncedPropertiesTab"}):(0,k.jsxs)(k.Fragment,{children:[j&&(0,k.jsx)("div",{style:N.stepText,children:(0,k.jsx)(f().sA,{defaultMessage:"Step 2",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.step2Title"})}),(0,k.jsx)(f().sA,{defaultMessage:"Select properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.titleForSelectPropertiesTab"})]})}),header:(0,k.jsx)(Ao,{inputValue:c,onChange:d}),handleClose:()=>{u().os({collectionSettingsStore:t})},footer:(0,k.jsx)(_o,{action:i,onSubmit:async()=>{if(!(C&&B&&T))return;const{projectCollectionPointer:o,taskCollectionPointer:n}=(0,Nt().Be)(C);if(!o||!n)return;const i=t.state.stack.find((e=>"externalProjectsSyncSettings"===e.type&&"external_list_projects"===e.source)),r=p.filter((e=>e.isSelected)).map((e=>e.id));if(xo.forEach((e=>{r.includes(e)||r.push(e)})),j&&!F)return u().a2({collectionSettingsStore:t,item:{type:"externalProjectsSyncSettings",source:"external_list_filters",action:de().Sh.SyncProjects,selectedProjectKeys:a,selectedProperties:r}}),void(0,be().u)({environment:v,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"select_filters_cta_click",flowId:R,botId:B,collectionId:M,isSyncOwner:K}}});Ot().D6({label:(0,k.jsx)(f().sA,{defaultMessage:"Started syncing from Jira. You’ll be notified when the sync is complete",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.title"}),right:(0,k.jsx)(D().p,{onClick:Ot().N2,style:N.snackbarCta,children:(0,k.jsx)(f().sA,{defaultMessage:"Close",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.snackbar.close"})}),position:"bottom"}),await Ge().callApi({eventName:"syncJiraProjects",environment:v,data:{botId:B,projectKeys:a,projectIssueCounts:e.projectIssueCounts,spaceId:T,properties:r,projectCollectionPointer:o,taskCollectionPointer:n,onlyUpdateProperties:!i,flowId:R}}),i?(0,be().u)({environment:v,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"sync_projects_and_properties",flowId:R,identifier:P,botId:B,collectionId:M,isSyncOwner:K}}}):(0,be().u)({environment:v,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:"jira",actionType:"sync_properties",flowId:R,identifier:P,botId:B,collectionId:M,isSyncOwner:K}}}),Ht().Ay.setState({...Ht().Ay.state,flowId:void 0}),u().os({collectionSettingsStore:t})},isSetupComplete:F,selectedPropertiesCount:V}),fullHeight:!1,menuScrollerStyle:{paddingBottom:6},children:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ke,{title:(0,k.jsx)(f().sA,{defaultMessage:"{standardPropertyCount, plural, one {{standardPropertyCount} standard property} other {{standardPropertyCount} standard properties}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.standardPropertiesTitle",values:{standardPropertyCount:p.filter((e=>e.isRequired||e.isPopular)).length}}),isSelectAll:!p.filter((e=>e.isPopular||e.isRequired)).every((e=>e.isSelected)),items:H,handleSelect:()=>{p.filter((e=>e.isPopular||e.isRequired)).every((e=>e.isSelected))?L(p.map((e=>e.isPopular&&!e.isRequired?{...e,isSelected:!1}:e))):L(p.map((e=>e.isPopular&&!e.isRequired?{...e,isSelected:!0}:e)))},isSectionItemsLoading:!h},"requiredProperties"),(0,k.jsx)(ke,{title:(0,k.jsx)(f().sA,{defaultMessage:"{projectLevelOptionalPropertyCount, plural, one {{projectLevelOptionalPropertyCount} project property} other {{projectLevelOptionalPropertyCount} project properties}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.projectLevelOptionalPropertiesTitle",values:{projectLevelOptionalPropertyCount:Q.length.toString()}}),handleSelect:()=>{p.filter((e=>e.isProjectLevel&&!e.isPopular&&!e.isRequired)).every((e=>e.isSelected))?L(p.map((e=>!e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!1}))):L(p.map((e=>!e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!0})))},items:Q,isSelectAll:!p.filter((e=>e.isProjectLevel&&!e.isPopular&&!e.isRequired)).every((e=>e.isSelected)),selectAllTooltipContent:(0,k.jsx)(f().sA,{defaultMessage:"Syncing all properties may lead to worse performance. Try syncing only properties that are in use",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.warningMessageForProjectLevelProperties"}),isSectionItemsLoading:!h},"projectProperties"),(0,k.jsx)(ke,{title:(0,k.jsx)(f().sA,{defaultMessage:"{siteLevelPropertiesCount, plural, one {{siteLevelPropertiesCount} site property} other {{siteLevelPropertiesCount} site properties}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.siteLevelPropertiesTitle",values:{siteLevelPropertiesCount:Z.length.toString()}}),items:Z,handleSelect:()=>{p.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))).every((e=>e.isSelected))?L(p.map((e=>e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!1}))):L(p.map((e=>e.isProjectLevel||e.isPopular||e.isRequired?e:{...e,isSelected:!0})))},isSelectAll:!p.filter((e=>!(e.isProjectLevel||e.isPopular||e.isRequired))).every((e=>e.isSelected)),selectAllTooltipContent:(0,k.jsx)(f().sA,{defaultMessage:"Syncing all properties may lead to worse performance. Try syncing only properties that are in use",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.warningMessageForProjectLevelProperties"}),isSectionItemsLoading:!h},"siteProperties")]})})}function Ao(e){const{isMobile:t}=(0,r().Y0)();return(0,k.jsxs)(ae().A,{children:[(0,k.jsx)(Re().A,{isSecondaryColor:!0,isMultiline:!0,style:{marginLeft:12,marginBottom:12,fontSize:t?le().J.UISmall.mobile:le().J.UISmall.desktop},children:(0,k.jsx)(f().sA,{defaultMessage:"Select which Jira properties will be synced as Notion properties in the issues database",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.description"})}),(0,k.jsx)(Be().Ay,{focusInitial:!0,value:e.inputValue,onChange:t=>{e.onChange(t.target.value)},placeholder:jt().A.formatMessage(yo.inputPlaceholder)})]})}function _o(e){const t=(0,S().IS)((e=>({wrapper:{padding:12,borderTop:`1px solid ${e.tableHomeDividerColor}`},buttonWrapper:{borderColor:"none"},button:{width:"100%",border:"none",fontWeight:le().Wy.medium},syncDescription:{paddingTop:8,fontSize:le().J.UISmall.desktop,color:e.text.secondary,marginBottom:8,textAlign:"center"},error:{color:"#D44C47"}})),[]),o=e.selectedPropertiesCount>wo,n=(0,lo().X)("jira_sync_import_filters"),i=e.action===de().Sh.SyncProjects?(0,k.jsx)("div",{style:t.buttonWrapper,children:(0,k.jsx)(A().A,{style:t.button,onClick:e.onSubmit,disabled:o,children:e.isSetupComplete?(0,k.jsx)(f().sA,{defaultMessage:"Sync projects",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncProjectsButton"}):n?(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,k.jsx)(f().sA,{defaultMessage:"Select issue filters",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.selectIssueFiltersButton"}),(0,fo().g)({width:16,height:16,marginLeft:6})]}):(0,k.jsx)(f().sA,{defaultMessage:"Start Jira sync",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.startJiraSyncButton"})})}):(0,k.jsx)("div",{style:t.buttonWrapper,children:(0,k.jsx)(A().A,{style:t.button,onClick:e.onSubmit,disabled:o,children:(0,k.jsx)("div",{style:{textOverflow:"ellipsis",overflow:"hidden"},children:(0,k.jsx)(f().sA,{defaultMessage:"Sync additional properties",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.syncAdditionalProperties"})})})});return(0,k.jsxs)("div",{style:t.wrapper,children:[!e.isSetupComplete&&!o&&(0,k.jsx)("div",{style:t.syncDescription,children:(0,k.jsx)(f().sA,{defaultMessage:"{propertiesCount, plural, one {{propertiesCount} property will be synced} other {{propertiesCount} properties will be synced}}",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.selectProperties",values:{propertiesCount:e.selectedPropertiesCount}})}),o&&(0,k.jsx)("div",{style:{...t.syncDescription,...t.error},children:(0,k.jsx)(f().sA,{defaultMessage:"You selected {selectedProperties} properties. The maximum allowed is 100",id:"database.viewSettings.collectionSettingsExternalListTaskProperties.propertiesLimit",values:{selectedProperties:e.selectedPropertiesCount}})}),i]})}var Io=()=>o(662303),Mo=()=>o(66689),ko=()=>o(869190),To=()=>o(519143),Po=()=>o(663640),Bo=()=>o(170350),Vo=()=>o(112710),Fo=()=>o(645395),Eo=()=>o(406533),Ro=()=>o(704654),Do=()=>o(664133),Ko=()=>o(611520),Oo=()=>o(16006),Lo=()=>o(280746);function zo(){const e=(0,r().v3)(),t=(0,l().K8)((()=>"dark"===e.ThemeStore.state.mode),[e]),o=(0,S().IS)((e=>({icon:{height:18,width:18,marginTop:2,marginRight:2,fill:t?e.primaryBlack:e.blueColor}})),[t]);return(0,k.jsx)(k.Fragment,{children:(0,Lo().jiraIcon)(o.icon)})}var No=()=>o(748768),Uo=()=>o(574036);function Wo(e){var t,o;let{taskCollectionStore:n,projectCollectionStore:i,externalSyncStore:s,currentSpaceStore:a}=e;const c="enterprise"===(0,l().K8)((()=>{if(a)return a.getSubscriptionTier()}),[a]),d=(0,l().K8)((()=>null==n?void 0:n.getFormat()),[n]),u=Boolean(null==d||null===(t=d.sync_state)||void 0===t?void 0:t.syncing),p=(0,l().K8)((()=>u||!(null!=s&&s.shouldAllowUserToEditSyncedCollection())),[u,s]),g=Boolean(null==d||null===(o=d.sync_state)||void 0===o?void 0:o.enable_two_way_sync),m=(0,r().v3)();return c?(0,k.jsx)(Uo().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"2-way sync",id:"database.viewSettings.collectionSettingsExternalSource.twoWaySync.switchName"}),caption:(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalSource.twoWaySync.caption",defaultMessage:"Allows editing in Notion and automatically syncs changes to JIRA"}),on:g,focused:!1,onClick:()=>{No().toggleTwoWaySyncOnCollection({environment:m,taskCollectionStore:n,projectCollectionStore:i})},disabled:p,textWrapperStyle:{opacity:1}}):null}var Ho=()=>o(991249);function $o(e){let{integrationIconUrl:t,currentSpaceStore:o}=e;const{isMobile:n}=(0,r().Y0)(),i=(0,r().v3)(),s=(0,S().IS)((e=>({upgradeToEnterpriseContainer:{margin:"6px 8px",padding:"12px",borderRadius:6,backgroundColor:e.surface.wash},upgradeToEnterpriseButton:{width:"100%",marginTop:6,padding:"3px 0px",backgroundColor:e.whiteButtonBackground,color:e.text.primary,borderRadius:6,textAlign:"center",border:`1px solid ${e.stroke.primary}`,fontWeight:le().Wy.medium,fontSize:n?le().J.UIRegular.mobile:le().J.UIRegular.desktop},upgradeToEnterpriseTextContainer:{display:"flex",alignItems:"center",margin:"0px 12px",gap:6},upgradeToEnterpriseIcon:{width:14,height:14},upgradeToEnterpriseText:{fontSize:n?le().J.UISmall.mobile:le().J.UISmall.desktop,color:e.text.primary,fontWeight:le().Wy.regular},hoveredStyle:{backgroundColor:e.whiteButtonHoveredBackground}})),[n]);return"enterprise"===(0,l().K8)((()=>{if(o)return o.getSubscriptionTier()}),[o])?null:(0,k.jsxs)("div",{style:s.upgradeToEnterpriseContainer,children:[(0,k.jsxs)("div",{style:s.upgradeToEnterpriseTextContainer,children:[(0,k.jsx)("img",{style:s.upgradeToEnterpriseIcon,src:t}),(0,k.jsx)("div",{style:s.upgradeToEnterpriseText,children:(0,k.jsx)(f().sA,{defaultMessage:"Jira 2-way sync is now available",id:"database.viewSettings.collectionSettingsExternalSource.twoWaySyncAvailable"})})]}),(0,k.jsx)(je().A,{style:s.upgradeToEnterpriseButton,hoveredStyle:s.hoveredStyle,onClick:()=>{(0,Ho().K)(i,{from:"workspace_connections",upsell:{type:"product",product:"enterprise",limit:{type:"none"},trialability:"none"}})},children:(0,k.jsx)(f().sA,{defaultMessage:"Upgrade to Enterprise",id:"database.viewSettings.collectionSettingsExternalSource.upgradeToEnterprise"})})]})}var Go=()=>o(640653),Qo=()=>o(994641);const Zo=(0,f().YK)({SourceHeading:{defaultMessage:"Source",id:"database.viewSettings.collectionSettingsExternalSource.sourceHeading"},CollectionSettingsExternalSourceTitle:{defaultMessage:"Select data to sync",id:"database.viewSettings.collectionSettingsExternalSource.tabTitle"},JiraSyncExternalSourceDescription:{id:"database.viewSettings.collectionSettingsExternalSource.description",defaultMessage:"To set up a Jira synced database, you’ll need to choose projects and properties to sync"},SalesforceReportExternalSourceDescription:{id:"database.viewSettings.collectionSettingsExternalSource.salesforceReportDescription",defaultMessage:"To add a Salesforce report, you’ll need to authenticate with your Salesforce account"},importInProgressToolTip:{id:"database.viewSettings.collectionSettingsExternalSource.tooltipForInProgressImport",defaultMessage:"Cannot be edited while sync is in progress"},accountDisconnectedTooltip:{id:"database.viewSettings.collectionSettingsExternalSource.accountDisconnectedTooltip",defaultMessage:"Account has been disconnected"},jiraSyncSourceDisabledTooltip:{id:"database.viewSettings.collectionSettingsExternalSource.sourceDisabledTooltip",defaultMessage:"Workspace owner has disabled edits for this Jira site"},collectionSettingsExternalSourceLastSynced:{defaultMessage:"Last synced {lastSyncedAt}",id:"database.viewSettings.collectionSettingsExternalSource.lastSynced"},collectionSettingsSyncFailed:{defaultMessage:"Sync has failed please re-authenticate",id:"database.viewSettings.collectionSettingsExternalSource.syncFailed"},collectionSettingsSyncInProgress:{defaultMessage:"{integration} sync in progress...",id:"database.viewSettings.collectionSettingsExternalSource.syncInProgress"},collectionSettingsSyncFailedNoPermissionToGetUser:{defaultMessage:"The connected Jira account {jiraAccountName} doesn’t have permission to load users. Please update the token permissions and try again",id:"database.viewSettings.collectionSettingsExternalSource.syncFailedNoPermissionToGetUser"},collectionSettingsSyncFailedNoPermissionToGetProjects:{defaultMessage:"The connected Jira account {jiraAccountName} doesn’t have permission to load some projects. Please update the token permissions and try again",id:"database.viewSettings.collectionSettingsExternalSource.syncFailedNoPermissionToGetProjects"},collectionSettingsSyncFailedNoPermissionToRegisterWebhook:{defaultMessage:"The connected Jira account {jiraAccountName} doesn’t have permission to register a webhook. Please update the token permissions and try again",id:"database.viewSettings.collectionSettingsExternalSource.syncFailedNoPermissionToRegisterWebhook"},collectionSettingsJiraSyncHelpLink:{id:"jiraSync.helpCenter",defaultMessage:"Learn about Jira sync"},reconnectButtonText:{id:"database.viewSettings.collectionSettingsExternalSource.reconnectButtonText",defaultMessage:"Re-authenticate Jira"},propertyLimitWarning:{defaultMessage:"{propertyNames} {hasHave} hit the 1,000-option limit. New options won’t sync. Reduce options or unsync the {fieldFields} to resolve",id:"database.viewSettings.collectionSettingsExternalSource.propertyLimitWarning"}}),qo=12;function Yo(e){const{collectionSettingsStore:t,collectionContextStore:o}=e,{collectionFormat:i,propertySchema:r,externalCollectionType:s,currentCollectionStore:a}=(0,l().K8)((()=>{var e;const t=o.collectionStore();return{collectionFormat:null==t?void 0:t.getFormat(),propertySchema:null==t?void 0:t.getSchema(),externalCollectionType:null==t||null===(e=t.getFormat())||void 0===e?void 0:e.external_collection_type,currentCollectionStore:t}}),[o]),c=(0,l().O$)(o.externalSyncStore),d=(0,n.useMemo)((()=>"Salesforce"===s?Jo:Xo),[s]);return i&&r&&s&&a&&c&&function(e){return void 0!==(null==e?void 0:e.external_collection_type)}(i)?(0,k.jsx)(d,{collectionSettingsStore:t,collectionContextStore:o,externalCollectionFormat:i,propertySchema:r,externalCollectionType:s,currentCollectionStore:a,externalSyncStore:c}):null}function Jo(e){var t;const o=(0,f().tz)(),n=(0,r().v3)(),{collectionSettingsStore:i,externalCollectionFormat:s,currentCollectionStore:a,externalCollectionType:c}=e,d=ln(),p=(0,l().O$)(ce().AppStoreCurrentSpaceStore),{flowId:g,report_sync_state:m}=(0,l().K8)((()=>({flowId:Qo().A.getFlowId(),report_sync_state:"report"===Qo().A.state.type?Qo().A.state:void 0})),[]),S=c?io().l[c]:"";return(0,k.jsx)(y().Ay,{collectionSettingsStore:e.collectionSettingsStore,title:c,fullHeight:!0,handleClose:()=>{u().os({collectionSettingsStore:i})},children:(0,k.jsxs)("div",{style:{padding:"0px 12px"},children:[(0,k.jsx)(ae().A,{disableMobileBorders:!0,children:(0,k.jsx)("div",{style:{...d.collectionSettingsExternalSourceTitle},children:(0,k.jsx)(f().sA,{...Zo.SalesforceReportExternalSourceDescription})})}),(0,k.jsxs)(ae().A,{title:(0,k.jsx)(f().sA,{...Zo.SourceHeading}),style:d.sourceSectionTitle,desktopTitleStyle:{padding:0,marginBottom:6},children:[(0,k.jsx)(ut,{integrationIconUrl:S,currentSpaceStore:p,flowId:g,captionText:(0,k.jsx)(f().sA,{defaultMessage:"Link your Salesforce account to sync a Salesforce Report",id:"database.viewSettings.collectionSettingsExternalSource.connectToSalesforce.description"}),renderActions:e=>{var t,o;if("connected"===e)return(0,k.jsx)(A().A,{style:{margin:"8px"},onClick:()=>{dt().X9({environment:n,collectionStore:a,from:"external_object_instance_block"})},disabled:!(null!=s&&s.synced_collection_external_url)||!0===(null==s||null===(t=s.sync_state)||void 0===t?void 0:t.syncing)||"in_progress"===(null==m?void 0:m.status),children:"in_progress"===(null==m?void 0:m.status)||!0===(null==s||null===(o=s.sync_state)||void 0===o?void 0:o.syncing)?(0,k.jsx)(f().sA,{...Zo.collectionSettingsSyncInProgress,values:{integration:(0,it().A)(null==s?void 0:s.external_collection_type)}}):(0,k.jsx)(f().sA,{defaultMessage:"Sync now",id:"database.viewSettings.collectionSettingsExternalSource.syncNow"})})}}),(null==s||null===(t=s.sync_state)||void 0===t?void 0:t.last_synced_at)&&(0,k.jsx)("div",{style:{...d.lastSyncText,marginTop:4},children:(0,k.jsx)(f().sA,{...Zo.collectionSettingsExternalSourceLastSynced,values:{lastSyncedAt:`${(0,ko().jE)(s.sync_state.last_synced_at,Io().locale,o)}`}})})]}),(null==s?void 0:s.error)&&(0,k.jsx)(ae().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Sync Error",id:"database.viewSettings.collectionSettingsExternalSource.syncError"}),style:d.sourceSectionTitle,desktopTitleStyle:{marginBottom:0,padding:0},children:(0,k.jsx)("div",{style:{...d.lastSyncText,marginTop:4},children:(0,k.jsx)(f().sA,{defaultMessage:"Last sync error: {error}",id:"database.viewSettings.collectionSettingsExternalSource.lastSyncError",values:{error:s.error.status_code}})})}),(0,k.jsx)(K().A,{size:1,style:{marginTop:8,marginBottom:4}}),(0,k.jsx)(se().A,{className:"notion-print-ignore",href:"https://dev.notion.so/notion/24d0b4fbb2e04972bb22ee8104002ade?v=17eb35e6e67f80c4b497000c1a8c589d&pvs=4",external:!0,style:{marginLeft:4,marginRight:4},children:(0,k.jsx)(D().p,{iconLeading:ie().M,isLightGray:!0,style:{width:"100%"},children:(0,k.jsx)(f().sA,{defaultMessage:"Provide feedback",id:"database.viewSettings.collectionSettingsExternalSource.feedbackLink"})})})]})})}function Xo(e){var t,o,n,i,s,a,c;const{collectionSettingsStore:d,collectionContextStore:p,externalCollectionFormat:g,propertySchema:m,externalCollectionType:S,currentCollectionStore:h,externalSyncStore:x}=e,{bot_id:v}=g,C=(0,f().tz)(),b=ln(),w=(0,r().v3)(),j=(0,l().O$)(ce().AppStoreCurrentSpaceStore),A="DataCenter"===(0,l().K8)((()=>(null==g?void 0:g.synced_collection_instance_type)??"Cloud"),[g])?"jira-dc":"jira",_=(0,l().K8)((()=>h.getSchema()),[h]),I=S?io().l[S]:"",M=(0,l().K8)((()=>{const e=p.collectionViewBlockStore();return(0,Lt().k7)(e,(0,Nt().UJ)(null==g?void 0:g.app_config_uri)?null==m?void 0:m[Mo().K4.ProjectToTaskRelation]:null==m?void 0:m[Mo().yx.TaskToProjectRelation])}),[p,m,g]),T=(0,l().K8)((()=>Ht().Ay.getFlowId()),[]),P=(0,l().K8)((()=>Boolean(De().A.externalAuthentications.state.find((e=>e.id===(null==g?void 0:g.bot_id)&&e.user_id===w.currentUser.id)))),[g,w]),B=(0,l().K8)((()=>{const e=De().A.externalAuthentications.state.find((e=>e.id===v));return null==e?void 0:e.account_name}),[v]),V=(0,l().K8)((()=>(0,Nt().CS)()),[]),F=(0,l().K8)((()=>{if(v&&j){const e=ct().vK.createChildStore(j,{table:lt().GP,id:v,spaceId:j.id});return!e.isDefined()||Boolean(e.getAlive())}return!0}),[v,j]),E=(0,l().K8)((()=>{var e;return F&&(null==g||null===(e=g.error)||void 0===e||null===(e=e.metadata)||void 0===e?void 0:e.reason)}),[F,g]),R=(0,l().K8)((()=>{var e;switch(null==g||null===(e=g.error)||void 0===e||null===(e=e.metadata)||void 0===e?void 0:e.reason){case"NO_PERMISSION_TO_GET_USER":return(0,k.jsx)(f().sA,{...Zo.collectionSettingsSyncFailedNoPermissionToGetUser,values:{jiraAccountName:B}});case"NO_PERMISSION_TO_GET_ISSUES":case"NO_PERMISSION_TO_GET_PROJECTS":return(0,k.jsx)(f().sA,{...Zo.collectionSettingsSyncFailedNoPermissionToGetProjects,values:{jiraAccountName:B}});case"NO_PERMISSION_TO_REGISTER_SYSTEM_WEBHOOK":return(0,k.jsx)(f().sA,{...Zo.collectionSettingsSyncFailedNoPermissionToRegisterWebhook,values:{jiraAccountName:B}});default:return null}}),[g,B]),{propertyLimitWarning:O}=(0,l().K8)((()=>{var e;if(null==g||null===(e=g.sync_state)||void 0===e||!e.last_synced_at)return{propertyLimitWarning:null};const t=function(e){const t={};for(const[n,i]of Object.entries(e))if(i&&("select"===i.type||"multi_select"===i.type)){var o;((null===(o=i.options)||void 0===o?void 0:o.length)??0)>=1e3&&(t[n]=i.name??n)}return t}(_);if(0===Object.keys(t).length)return{propertyLimitWarning:null};const o=Object.values(t);return{propertyLimitWarning:(0,k.jsx)(sn,{propertyNames:o,styles:b.syncFailedText})}}),[null==g||null===(t=g.sync_state)||void 0===t?void 0:t.last_synced_at,_,b.syncFailedText]);if(!M)return null;const L=(0,Nt().UJ)(null==g?void 0:g.app_config_uri),z=Boolean((null==g?void 0:g.sync_state)&&(null==g||null===(o=g.sync_state)||void 0===o?void 0:o.last_synced_at));return(0,k.jsxs)(y().Ay,{collectionSettingsStore:d,title:C.formatMessage(Zo.CollectionSettingsExternalSourceTitle),fullHeight:!0,handleClose:()=>{Ht().Ay.setState({...Ht().Ay.state,projectKeys:[]}),u().os({collectionSettingsStore:d})},children:[(0,k.jsx)("div",{style:{padding:"0px 4px"},children:V?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)($o,{integrationIconUrl:I,currentSpaceStore:j}),(0,k.jsx)(Wo,{taskCollectionStore:L?M:h,projectCollectionStore:L?h:M,externalSyncStore:x,currentSpaceStore:j})]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ae().A,{disableMobileBorders:!0,children:(0,k.jsx)("div",{style:b.collectionSettingsExternalSourceTitle,children:(0,k.jsx)(f().sA,{...Zo.JiraSyncExternalSourceDescription})})}),(0,k.jsx)("div",{style:b.preview,children:en({projectCollectionStore:L?h:M,taskCollectionStore:L?M:h,integrationIconUrl:I})})]})}),(0,k.jsxs)(ae().A,{title:(0,k.jsx)(f().sA,{...Zo.SourceHeading}),style:b.sourceSectionTitle,desktopTitleStyle:{marginBottom:0},children:[(0,k.jsx)("div",{style:b.siteButtonContainer,children:(0,k.jsx)(je().A,{style:b.siteButton,disallowTabbing:!0,disabled:!0,children:(0,k.jsxs)("div",{style:b.siteButtonTextContainer,children:[(0,k.jsx)(on,{hasSyncFailed:Boolean(E||!F),isSyncing:Boolean(null==g||null===(n=g.sync_state)||void 0===n?void 0:n.syncing),integrationIconSrcUrl:I}),(0,k.jsxs)("div",{style:{display:"flex",flexFlow:"column",gap:1},children:[(0,k.jsx)("span",{style:b.siteNameText,children:(0,it().A)((0,Nt().ay)((null==g?void 0:g.synced_collection_external_url)||""))}),(0,k.jsx)("span",{style:b.siteNameSecondaryText,children:null==g?void 0:g.synced_collection_external_url})]})]})})}),F&&(null==g||null===(i=g.sync_state)||void 0===i?void 0:i.last_synced_at)&&!(null!=g&&null!==(s=g.sync_state)&&void 0!==s&&s.syncing)&&!(null!=g&&null!==(a=g.error)&&void 0!==a&&null!==(a=a.metadata)&&void 0!==a&&a.reason)&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:b.lastSyncText,children:(0,k.jsx)(f().sA,{...Zo.collectionSettingsExternalSourceLastSynced,values:{lastSyncedAt:`${(0,ko().jE)(g.sync_state.last_synced_at,Io().locale,C)}`}})}),O]}),F&&(null==g||null===(c=g.sync_state)||void 0===c?void 0:c.syncing)&&(0,k.jsx)("div",{style:b.lastSyncText,children:(0,k.jsx)(f().sA,{...Zo.collectionSettingsSyncInProgress,values:{integration:(0,it().A)(null==g?void 0:g.external_collection_type)}})}),E&&(0,k.jsx)("div",{style:b.syncFailedText,children:R}),!F&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:b.syncFailedText,children:(0,k.jsx)(f().sA,{...Zo.collectionSettingsSyncFailed})}),(0,k.jsxs)(st().E,{color:"uiBlue",onClick:()=>{Do().jh({environment:w,from:"sync_header",action:"add_account"})},style:b.reconnectButton,children:[(0,k.jsx)(zo,{}),(0,k.jsx)(f().sA,{...Zo.reconnectButtonText})]})]})]}),(0,k.jsx)(Ko().G2,{featureName:"jira-dc"===A?"collection_synced_database_jira_datacenter":"collection_synced_database_jira",source:"collection_synced_database"}),(0,k.jsx)(nn,{taskCollectionStore:L?M:h,collectionSettingsStore:d,isSetupComplete:z,flowId:T,isSyncOwner:P,isActiveSync:F}),(0,k.jsx)(K().A,{size:1,style:{marginTop:16,marginBottom:16}}),(0,k.jsx)(se().A,{style:{display:"flex",marginLeft:4,marginRight:4},className:"notion-print-ignore",href:(0,ro().xS)("guides.externalImportAndSync"),external:!0,onClick:()=>{(0,be().u)({environment:w,event:{eventName:"external_sync_setup_action",eventProperties:{integration:A,actionType:"learn_more_cta_click",flowId:T,collectionId:L?M.id:h.id,botId:null==g?void 0:g.bot_id,identifier:null==g?void 0:g.synced_collection_external_url,isSyncOwner:P}}})},children:(0,k.jsx)(D().p,{iconLeading:Eo().questionMarkCircleIcon,iconStyle:{width:16,height:16},isGray:!0,style:b.learnMoreText,children:(0,k.jsx)(f().sA,{...Zo.collectionSettingsJiraSyncHelpLink})})})]})}function en(e){const{projectCollectionStore:t,taskCollectionStore:o,integrationIconUrl:n}=e,i=(0,r().v3)(),s=(0,l().K8)((()=>"dark"===i.ThemeStore.state.mode),[i]),a=(0,S().IS)((e=>({iconContainer:{display:"flex",alignItems:"center"},sourceIcon:{width:26,height:26,padding:5,borderRadius:6,gap:10,borderColor:e.stroke.primary,borderStyle:"solid",borderWidth:1,boxShadow:"0px 2px 4px 0px #161D1B05",...!s&&{background:`linear-gradient(0deg, ${e.text.contrastPrimary}, ${e.text.contrastPrimary})`}},taskArrow:{width:87,height:26,top:26},projectArrow:{width:87,height:26,top:2,border:1},arrowContainer:{display:"flex",flexFlow:"column",justifyContent:"center"},collectionIconContainer:{display:"flex",flexFlow:"column",justifyContent:"space-around",gap:12},collectionIcon:{width:88,padding:"4px 6px 6px 6px",borderRadius:6,gap:6,display:"flex",alignItems:"center",borderColor:e.stroke.primary,borderWidth:1,borderStyle:"solid",...!s&&{background:`linear-gradient(0deg, ${e.text.contrastPrimary}, ${e.text.contrastPrimary})`}},title:{fontSize:qo,fontWeight:le().Wy.medium,lineHeight:le().K_.UISmall.desktop,letterSpacing:0,color:e.text.primary}})),[s]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:a.iconContainer,children:tn({iconStyle:a.sourceIcon,srcUrl:n})}),(0,k.jsxs)("div",{style:a.arrowContainer,children:[tn({iconStyle:a.projectArrow,srcUrl:W().A.images.externalIntegrations.externalAppToProjectsArrowPng}),tn({iconStyle:a.taskArrow,srcUrl:W().A.images.externalIntegrations.externalAppToTasksArrowPng})]}),(0,k.jsxs)("div",{style:a.collectionIconContainer,children:[(0,k.jsxs)("div",{style:a.collectionIcon,children:[rn(Vo().a,n),(0,k.jsx)(Oo().A,{store:t,style:a.title})]}),(0,k.jsxs)("div",{style:a.collectionIcon,children:[rn(Ro().E,n),(0,k.jsx)(Oo().A,{store:o,style:a.title})]})]})]})}function tn(e){const{iconStyle:t,srcUrl:o,altString:n}=e;return(0,k.jsx)("img",{style:t,src:o,alt:n})}function on(e){const{hasSyncFailed:t,isSyncing:o,integrationIconSrcUrl:n,altString:i}=e,r=(0,S().IS)((e=>({syncIcon:{width:20,height:20,position:"relative",color:t?e.icon.uiYellowPrimary:e.blueColor}})),[t]);return t?(0,Po().i)(r.syncIcon):o?(0,To().D)(r.syncIcon):(0,k.jsx)("img",{style:r.syncIcon,src:n,alt:i})}function nn(e){let{taskCollectionStore:t,collectionSettingsStore:o,isSetupComplete:n,flowId:i,isSyncOwner:s,isActiveSync:a}=e;const c=(0,r().v3)(),d=(0,l().K8)((()=>t.getSchema()),[t]),p=(0,l().K8)((()=>{var e;return null===(e=t.getFormat().sync_state)||void 0===e?void 0:e.syncing}),[t]),g=(0,l().O$)(ce().AppStoreCurrentSpaceStore),m=(0,l().K8)((()=>t.getFormat().bot_id),[t]),S=(0,l().K8)((()=>t.getFormat().synced_collection_external_url),[t]),y=(0,l().K8)((()=>(0,Go().p4)(g)),[g]),h=(0,l().K8)((()=>(0,Nt().Zf)()),[]),x=(0,l().K8)((()=>(0,Nt().X7)()),[]),v=(0,l().K8)((()=>t.getFormat().synced_collection_instance_type),[t]),C="DataCenter"===v?"jira-dc":"jira",b=(0,lo().X)("jira_sync_import_filters"),w=(0,l().K8)((()=>{var e;return null===(e=t.getFormat().sync_state)||void 0===e?void 0:e.filter_config}),[t]),j=(0,l().K8)((()=>(0,Nt().yX)()),[])&&!y&&"Cloud"===v||"DataCenter"===v&&(!x||!y&&!h);let _=0;for(const r in d){var I;null!==(I=d[r])&&void 0!==I&&I.derived_property_record_metadata&&_++}let M=jt().A.formatMessage(Zo.accountDisconnectedTooltip);return Boolean(p)?M=jt().A.formatMessage(Zo.importInProgressToolTip):j&&(M=jt().A.formatMessage(Zo.jiraSyncSourceDisabledTooltip)),n?(0,k.jsx)(ae().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Data synced from Jira",id:"database.viewSettings.collectionSettingsExternalSource.titleStringForSyncedData"}),children:(0,k.jsx)(Ie().A,{disableTooltip:!Boolean(p)&&a&&!j,renderTooltip:e=>(0,k.jsx)("div",{...e,style:Me().Q$,children:M}),render:e=>(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(kt().A,{...e,icon:Vo().a,disabled:Boolean(p)||!a||j,onClick:()=>{u().a2({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_projects"}}),(0,be().u)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:C,actionType:"select_projects_cta_click",flowId:i,identifier:S,botId:m,collectionId:t.id,isSyncOwner:s}}})},showChevron:!0,title:(0,k.jsx)(f().sA,{defaultMessage:"Projects",id:"database.viewSettings.collectionSettingsExternalSource.projects"})}),(0,k.jsx)(kt().A,{...e,icon:Fo().j,disabled:Boolean(p)||!a||j,onClick:()=>{u().a2({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_task_properties",action:de().Sh.SyncAdditionalProperties,selectedProjectKeys:[],projectIssueCounts:{}}}),(0,be().u)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:C,actionType:"select_properties_cta_click",flowId:i,identifier:S,botId:m,collectionId:t.id,isSyncOwner:s}}})},right:(0,k.jsx)(f().sA,{id:"database.viewSettings.collectionSettingsExternalSource.syncedPropertiesCount",defaultMessage:"{syncedPropertiesCountString}",values:{syncedPropertiesCountString:_.toString()}}),showChevron:!0,title:(0,k.jsx)(f().sA,{defaultMessage:"Task Properties",id:"database.viewSettings.collectionSettingsExternalSource.taskProperties"})}),b&&w&&(0,k.jsx)(kt().A,{...e,icon:Bo().S,disabled:Boolean(p)||!a||j,onClick:()=>{u().a2({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_filters",action:de().Sh.SyncAdditionalProperties,selectedProjectKeys:[],selectedProperties:[]}}),(0,be().u)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:C,actionType:"select_filters_cta_click",flowId:i,identifier:S,botId:m,collectionId:t.id,isSyncOwner:s}}})},showChevron:!0,title:(0,k.jsx)(f().sA,{defaultMessage:"Filters",id:"database.viewSettings.collectionSettingsExternalSource.filters"})})]})})}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ae().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Step 1",id:"database.viewSettings.collectionSettingsExternalSource.setupProjects"}),children:(0,k.jsx)("div",{style:{margin:"6px 14px 0px"},children:(0,k.jsx)(A().A,{style:{width:"100%"},onClick:()=>{u().a2({collectionSettingsStore:o,item:{type:"externalProjectsSyncSettings",source:"external_list_projects"}}),(0,be().u)({environment:c,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:C,actionType:"select_projects_cta_click",flowId:i,identifier:S,botId:m,collectionId:t.id,isSyncOwner:s}}})},disabled:j,children:(0,k.jsx)(f().sA,{defaultMessage:"Select projects to sync",id:"database.viewSettings.collectionSettingsExternalSource.syncProjectsButton"})})})}),(0,k.jsx)(ae().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Step 2",id:"database.viewSettings.collectionSettingsExternalSource.setupProperties"}),children:(0,k.jsx)("div",{style:{margin:"6px 14px 0px"},children:(0,k.jsx)(A().A,{style:{width:"100%"},disabled:!0,children:(0,k.jsx)(f().sA,{defaultMessage:"Select properties to sync",id:"database.viewSettings.collectionSettingsExternalSource.syncPropertiesButton"})})})})]})}function rn(e,t){const o=(0,r().v3)(),n=(0,l().K8)((()=>"dark"===o.ThemeStore.state.mode),[o]),i=(0,S().IS)((e=>({sourceIcon:{width:10,height:10,padding:2,borderRadius:3,gap:10,position:"absolute",borderColor:e.stroke.primary,borderStyle:"solid",borderWidth:1,right:-3,bottom:-3,boxShadow:"0px 2px 4px 0px #161D1B05",...!n&&{background:`linear-gradient(0deg, ${e.text.contrastPrimary}, ${e.text.contrastPrimary})`},display:"flex",alignItems:"center",justifyContent:"center"},baseIcon:{height:14,width:14,color:e.icon.secondary}})),[n]);return(0,k.jsxs)("div",{style:{position:"relative"},children:[e(i.baseIcon),(0,k.jsx)("div",{style:i.sourceIcon,children:tn({iconStyle:{height:5,width:5},srcUrl:t})})]})}function ln(){const{isMobile:e}=(0,r().Y0)();return(0,S().IS)((t=>({collectionSettingsExternalSourceTitle:{fontSize:e?le().J.UISmall.mobile:le().J.UISmall.desktop,color:t.text.secondary},preview:{padding:"12px 36px 12px 30px",background:t.surface.wash,display:"flex",justifyContent:"flex-start",marginLeft:14,marginRight:14,borderRadius:6,marginBottom:24},container:{marginLeft:12,marginRight:12},lastSyncText:{fontSize:e?le().J.UISmall.mobile:le().J.UISmall.desktop,color:t.text.secondary,fontWeight:le().Wy.regular,textAlign:"left",lineHeight:le().K_.UISmall.desktop,marginTop:6},syncFailedText:{fontSize:e?le().J.UISmall.mobile:le().J.UISmall.desktop,fontWeight:le().Wy.regular,textAlign:"left",marginLeft:8,lineHeight:le().K_.UISmall.desktop,marginBottom:6,marginTop:6,color:t.icon.uiYellowPrimary},reconnectButton:{width:"-webkit-fill-available",marginLeft:8,marginRight:8,marginTop:8,gap:4},captionText:{fontSize:e?le().J.UISmall.mobile:le().J.UISmall.desktop,color:t.text.secondary,fontWeight:le().Wy.regular,textAlign:"left"},sourceSectionTitle:{textAlign:"left",color:t.text.secondary,paddingTop:0,paddingLeft:4,paddingRight:4},siteButtonContainer:{margin:"0px 8px",gap:2,borderRadius:6,borderStyle:"solid",borderWidth:1,borderColor:t.stroke.secondary},siteButton:{padding:"6px 8px",borderRadius:6,display:"flex"},siteButtonTextContainer:{gap:8,display:"flex"},siteNameText:{fontSize:e?le().J.UIRegular.mobile:le().J.UIRegular.desktop,fontWeight:le().Wy.regular,lineHeight:le().K_.UIRegular.desktop,letterSpacing:"0.15px",color:t.text.primary},siteNameSecondaryText:{fontSize:e?le().J.UISmall.mobile:le().J.UISmall.desktop,color:t.text.secondary,fontWeight:le().Wy.regular,textAlign:"left",maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",lineHeight:e?le().K_.UISmall.mobile:le().K_.UISmall.desktop},lockedIcon:{width:14,height:14,color:t.icon.secondary},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:t.text.secondary,fontSize:12,margin:0},learnMoreText:{width:"100%",paddingLeft:8,paddingRight:8,color:t.text.secondary}})),[e])}function sn(e){let{propertyNames:t,styles:o}=e,n="";return n=1===t.length?t[0]:`${t[0]} and ${t.length-1} other`,(0,k.jsx)("div",{style:o,children:(0,k.jsx)(f().sA,{...Zo.propertyLimitWarning,values:{propertyNames:n,hasHave:1===t.length?"has":"have",fieldFields:1===t.length?"field":"fields"}})})}function an(e){const{collectionSettingsStore:t,collectionContextStore:o,tabSettings:n}=e;if("external_source"===n.source)return(0,k.jsx)(Yo,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_projects"===n.source)return(0,k.jsx)(po,{collectionSettingsStore:t,collectionContextStore:o});if("external_list_task_properties"===n.source){const{action:e,selectedProjectKeys:i,projectIssueCounts:r}=n;return(0,k.jsx)(jo,{collectionSettingsStore:t,collectionContextStore:o,action:e,selectedProjectKeys:i,projectIssueCounts:r})}if("external_list_filters"===n.source){const{action:e,selectedProjectKeys:i,selectedProperties:r}=n;return(0,k.jsx)(Gt,{collectionSettingsStore:t,collectionContextStore:o,action:e,selectedProjectKeys:i,selectedProperties:r})}return null}var cn=()=>o(244641),dn=()=>o(589982),un=()=>o(563884),pn=()=>o(340498);const gn=(0,pn().wt)("checkboxSquareCheckedDotted",{viewBox:"0 0 16 16",svg:(0,k.jsx)("path",{d:"M3.243 2.712a.648.648 0 00.465.191.664.664 0 00.478-.191.636.636 0 00.199-.465.652.652 0 00-.199-.479.652.652 0 00-.478-.198.636.636 0 00-.465.198.664.664 0 00-.191.479.65.65 0 00.19.465zm2.14 0a.656.656 0 00.471.191c.183 0 .34-.064.472-.191a.626.626 0 00.205-.465.641.641 0 00-.205-.479.644.644 0 00-.472-.198.664.664 0 00-.663.677c0 .178.064.332.192.465zm2.14 0A.664.664 0 008 2.903c.182 0 .34-.064.471-.191a.636.636 0 00.199-.465.652.652 0 00-.199-.479A.644.644 0 008 1.57a.664.664 0 00-.67.677c0 .178.064.332.191.465zm2.146 0c.132.127.29.191.471.191a.641.641 0 00.472-.191.637.637 0 00.198-.465.652.652 0 00-.198-.479.63.63 0 00-.472-.198.644.644 0 00-.471.198.652.652 0 00-.199.479.64.64 0 00.199.465zm2.14 0a.68.68 0 00.478.191.633.633 0 00.465-.191.636.636 0 00.198-.465.652.652 0 00-.198-.479.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.479c0 .178.066.332.198.465zm1.476 1.47a.65.65 0 00.472.198.63.63 0 00.471-.199.644.644 0 00.199-.471.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.139c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.63.63 0 00-.471-.199.644.644 0 00-.472.199.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.146c.132.133.29.199.472.199a.63.63 0 00.471-.199.644.644 0 00.199-.471.652.652 0 00-.199-.479.63.63 0 00-.471-.198.634.634 0 00-.472.205.656.656 0 00-.191.472c0 .182.063.34.19.471zm0 2.147c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.471.62.62 0 00-.471-.205.634.634 0 00-.472.205.656.656 0 00-.191.471c0 .183.063.34.19.472zm0 2.14c.132.132.29.198.472.198a.63.63 0 00.471-.198.644.644 0 00.199-.472.644.644 0 00-.199-.472.63.63 0 00-.471-.198.644.644 0 00-.472.198.656.656 0 00-.191.472c0 .182.063.34.19.472zm-1.477 1.476a.667.667 0 00.479.198.622.622 0 00.465-.198.636.636 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.479.198.652.652 0 00-.198.478c0 .178.066.333.198.465zm-2.14 0a.667.667 0 00.48.198.622.622 0 00.464-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.622.622 0 00-.465-.198.652.652 0 00-.478.198.652.652 0 00-.199.478c0 .178.067.333.199.465zm-2.146 0a.66.66 0 00.486.198.622.622 0 00.464-.198.637.637 0 00.199-.465.652.652 0 00-.199-.478.636.636 0 00-.464-.198.664.664 0 00-.677.677c0 .177.064.332.191.464zm-2.14 0c.133.132.29.198.472.198a.652.652 0 00.479-.198.637.637 0 00.198-.465.652.652 0 00-.198-.478.652.652 0 00-.479-.198.664.664 0 00-.663.677c0 .177.064.332.192.464zm-2.14 0c.133.132.29.198.473.198.182 0 .34-.066.471-.198a.637.637 0 00.199-.465.652.652 0 00-.199-.478.644.644 0 00-.471-.198.664.664 0 00-.663.677c0 .177.063.332.19.464zm-1.476-1.476a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.472zm0-2.14a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.612.612 0 00-.465-.205.634.634 0 00-.472.205.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.147a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.652.652 0 00-.198-.479.622.622 0 00-.465-.198.634.634 0 00-.472.205.644.644 0 00-.198.472c0 .182.064.34.191.471zm0-2.146a.652.652 0 00.479.198.622.622 0 00.465-.198.644.644 0 00.198-.472.644.644 0 00-.198-.471.622.622 0 00-.465-.199.644.644 0 00-.472.199.644.644 0 00-.198.471c0 .183.064.34.191.472zm0-2.14a.652.652 0 00.479.199.622.622 0 00.465-.199.644.644 0 00.198-.471.63.63 0 00-.198-.472.622.622 0 00-.465-.198.644.644 0 00-.472.198.644.644 0 00-.198.472c0 .182.064.34.191.471zm5.161 6.973a.7.7 0 00.342.082c.255 0 .456-.116.602-.349l3.056-4.778a1.27 1.27 0 00.116-.219.587.587 0 00.054-.239.506.506 0 00-.191-.41.661.661 0 00-.43-.157c-.215 0-.393.116-.534.348l-2.7 4.327L5.97 8.146a.713.713 0 00-.252-.225.567.567 0 00-.28-.069.568.568 0 00-.425.185.599.599 0 00-.17.43c0 .155.059.308.177.458l1.614 1.97c.095.113.193.2.293.259z",clipRule:"evenodd"})}),mn=(0,pn().wt)("cursorArrowClickRays",{viewBox:"0 0 16 16",svg:(0,k.jsx)("path",{d:"M7.997 3.766a.604.604 0 01-.595-.595V1.175c0-.322.274-.595.595-.595.328 0 .602.273.602.595V3.17a.606.606 0 01-.602.595zM4.948 4.955a.594.594 0 01-.84 0L2.705 3.54a.607.607 0 010-.84.607.607 0 01.84.006l1.402 1.408a.594.594 0 010 .841zm6.023.068a.607.607 0 010-.84l1.422-1.415a.598.598 0 01.834 0 .602.602 0 010 .847l-1.409 1.408a.602.602 0 01-.847 0zm-3.514 7.725l.062-5.462c.006-.253.266-.349.437-.17l3.74 3.834c.184.198.054.445-.199.458l-1.476.062 1.23 2.843a.241.241 0 01-.11.329l-.683.266c-.123.055-.26-.013-.314-.137l-1.17-2.891-1.038 1.046c-.178.17-.486.089-.479-.178zM3.779 7.997a.606.606 0 01-.601.595H1.175a.604.604 0 01-.595-.595c0-.321.274-.595.595-.595h2.003c.328 0 .601.274.601.595zm8.45 0c0-.321.273-.595.594-.595h1.996c.329 0 .602.274.602.595a.606.606 0 01-.602.595h-1.996a.604.604 0 01-.595-.595zm-7.212 2.98a.594.594 0 010 .841l-1.409 1.409a.616.616 0 01-.847-.007.614.614 0 01.007-.841l1.408-1.402c.232-.225.622-.225.84 0z"})});var Sn=()=>o(353731),fn=()=>o(643381);const yn=(0,pn().wt)("rightArrowEmpty",{viewBox:"0 0 22 18",directional:!0,svg:(0,k.jsx)("path",{d:"M21.582 8.955c0-.332-.117-.693-.498-1.055L13.379.693C12.86.205 12.539 0 12.06 0c-.683 0-1.171.537-1.171 1.191v3.692h-7.92c-1.543 0-2.442.879-2.442 2.392v3.37c0 1.513.899 2.392 2.442 2.392h7.92v3.73c0 .655.488 1.143 1.152 1.143.479 0 .87-.195 1.338-.635L21.084 10c.371-.352.498-.723.498-1.045zm-1.758 0c0 .059-.02.107-.097.186l-6.963 6.582a.219.219 0 01-.166.087c-.079 0-.137-.058-.137-.146v-3.78c0-.224-.098-.322-.322-.322h-9.15c-.626 0-.987-.36-.987-.996V7.354c0-.635.361-.997.986-.997h9.15c.225 0 .323-.097.323-.322V2.158c0-.078.059-.137.146-.137.059 0 .118.04.166.079l6.954 6.67c.068.068.097.126.097.185z"})});var hn=()=>o(420713),xn=()=>o(735384),vn=()=>o(781697),Cn=()=>o(139108),bn=()=>o(897119),wn=()=>o(799829),jn=()=>o(179034),An=()=>o(950914),_n=()=>o(919709),In=()=>o(534177),Mn=()=>o(450859),kn=()=>o(778708);var Tn=()=>o(96689),Pn=()=>o(854150),Bn=()=>o(313892),Vn=()=>o(601734);const Fn="https://www.notion.so/help/sprints",En=[1,2,3,4,5,6,7,8],Rn={1:{key:"one_week",value:1},2:{key:"two_weeks",value:2},3:{key:"three_weeks",value:3},4:{key:"four_weeks",value:4},5:{key:"five_weeks",value:5},6:{key:"six_weeks",value:6},7:{key:"seven_weeks",value:7},8:{key:"eight_weeks",value:8}},Dn={MO:"Monday",TU:"Tuesday",WE:"Wednesday",TH:"Thursday",FR:"Friday",SA:"Saturday",SU:"Sunday"},Kn=(0,f().YK)({sprintsMenuTitle:{id:"sprintSettingsMenu.label",defaultMessage:"Sprints"},setupSprintsTitle:{id:"sprintSettingsMenu.setupSprints.label",defaultMessage:"Set up sprints"},setupSprintsCaption:{id:"sprintSettingsMenu.setupSprints.caption",defaultMessage:"Use sprints to regularly tackle a group of tasks in a recurring, set amount of time."},setupSprintsTeamspaceStatement:{id:"sprintSettingsMenu.setupSprintsTeamspaceStatement.caption",defaultMessage:"We'll also add to your teamspace:"},setupSprintsSprintBoardPageStatement:{id:"sprintSettingsMenu.setupSprintsSprintBoardPageStatement.caption",defaultMessage:"<bold>Sprint board</bold>: To manage tasks and plan your work"},setupSprintsSprintsDatabaseStatement:{id:"sprintSettingsMenu.setupSprintsSprintsDatabaseStatement.caption",defaultMessage:"<bold>Sprints database</bold>: To keep a historical record of what you accomplished"},manual:{id:"sprintSettingsMenu.manual.label",defaultMessage:"Manual"},automatic:{id:"sprintSettingsMenu.automatic.label",defaultMessage:"Auto"},off:{id:"sprintSettingsMenu.off.label",defaultMessage:"Off"},completeSprintNextSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.label",defaultMessage:"Move to next sprint"},completeSprintNextSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.selected.label",defaultMessage:"Next sprint"},completeSprintBacklogActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.label",defaultMessage:"Move to backlog"},completeSprintBacklogActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.selected.label",defaultMessage:"Backlog"},completeSprintKeepInCurrentSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.label",defaultMessage:"Keep in current sprint"},completeSprintKeepInCurrentSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.selected.label",defaultMessage:"Current sprint"},automatedSprintsToggleTitle:{id:"sprintSettingsMenu.automatedSprintsToggle.label",defaultMessage:"Automated sprints"},automatedSprintsToggleCaption:{id:"sprintSettingsMenu.automatedSprintsToggle.caption",defaultMessage:"Sprints complete automatically before the start of the next sprint."},duration:{id:"sprintSettingsMenu.duration.label",defaultMessage:"Duration"},durationMenuOptionText:{id:"sprintSettingsMenu.duration.option.label",defaultMessage:"{durationValue, plural, one {1 week} other {{durationValue} weeks}}"},startOn:{id:"sprintSettingsMenu.startOn.label",defaultMessage:"Start on"},weekdayOption:{id:"sprintSettings.weekdayOption.label",defaultMessage:"{weekdayName}s"},incompleteTasks:{id:"sprintSettingsMenu.incompleteTasks.label",defaultMessage:"Incomplete tasks"},turnOnSprints:{id:"sprintSettingsMenu.turnOnSprints.button.label",defaultMessage:"Turn on sprints"},turnOffSprints:{id:"sprintSettingsMenu.turnOffSprints.button.label",defaultMessage:"Turn off sprints"},turnOffSprintsModalTitle:{id:"sprintSettingsMenu.turnOffSprints.modal.title.label",defaultMessage:"Turn off sprints?"},turnOffSprintsModalNoSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.default.description",defaultMessage:"This will delete your sprints database and its linked views."},turnOffSprintsModalWithSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.withSprintBoards.description",defaultMessage:"This will delete your sprint board(s), sprints database and its linked views."},turnOffAndDeleteModalButton:{id:"sprintSettingsMenu.turnOffAndDeleteModal.button.label",defaultMessage:"Turn off and delete"},learnSprintsTitle:{id:"sprintSettingsMenu.learnSprints.button.label",defaultMessage:"Learn about sprints"},manageSprintFromThisView:{id:"sprintSettingsMenu.manageSprintFromThisView.label",defaultMessage:"Manage sprint from this view"},manageSprintFromThisViewModalTitle:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.title.label",defaultMessage:"Manage sprint from this view?"},manageSprintFromThisViewModalButton:{id:"sprintSettingsMenu.manageSprintFromThisView.button.label",defaultMessage:"Update view"},manageSprintFromThisViewModalAutomaticSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.automaticSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint."},manageSprintFromThisViewModalManualSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.manualSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint and a button to complete sprints will be displayed."},sprintStartDateToday:{id:"sprintSettingsMenu.sprintStartDateToday",defaultMessage:"Next sprint starts <time>today</time>}"},sprintStartDateFuture:{id:"sprintSettingsMenu.sprintStartDateFuture",defaultMessage:"Next sprint starts in {days} {days, plural, one {day} other {days}} <time>({formattedDate}</time>)"},sprintStartDateShouldStartPast:{id:"sprintSettingsMenu.sprintStartDateShouldStartPast",defaultMessage:"Next sprint should have started {days} {days, plural, one {day} other {days}} ago <time>({formattedDate})</time>"},sprintStartDateShouldStartToday:{id:"sprintSettingsMenu.sprintStartDateShouldStartToday",defaultMessage:"Next sprint should start <time>today</time>"},sprintStartDateShouldStartFuture:{id:"sprintSettingsMenu.sprintStartDateShouldStartFuture",defaultMessage:"Next sprint should start in {days} {days, plural, one {day} other {days}} <time>({formattedDate})</time>"}}),On={complete_sprint_and_move_incomplete_tasks_to_next_sprint:{menuOptionText:Kn.completeSprintNextSprintActionMenuOptionText,selectedText:Kn.completeSprintNextSprintActionSelectedText},complete_sprint_and_move_incomplete_tasks_to_backlog:{menuOptionText:Kn.completeSprintBacklogActionMenuOptionText,selectedText:Kn.completeSprintBacklogActionSelectedText},complete_sprint:{menuOptionText:Kn.completeSprintKeepInCurrentSprintActionMenuOptionText,selectedText:Kn.completeSprintKeepInCurrentSprintActionSelectedText}};function Ln(e){return(0,k.jsx)(f().sA,{...On[e.completeSprintAction].menuOptionText})}function zn(e){return(0,k.jsx)(f().sA,{...On[e.completeSprintAction].selectedText})}function Nn(e){const{weekday:t}=e;return(0,k.jsx)(f().sA,{...Kn.weekdayOption,values:{weekdayName:Dn[t]}})}function Un(e){return Rn[e]}function Wn(e){const{sprintDurationValue:t}=e;return(0,k.jsx)(f().sA,{...Kn.durationMenuOptionText,values:{durationValue:Rn[t].value}})}function Hn(e){const{numOfSprintBoards:t}=e;return t>0?(0,k.jsx)(f().sA,{...Kn.turnOffSprintsModalWithSprintBoardsDescription}):(0,k.jsx)(f().sA,{...Kn.turnOffSprintsModalNoSprintBoardsDescription})}function $n(e){const{automaticSprintCompletionEnabled:t}=e;return t?(0,k.jsx)(f().sA,{...Kn.manageSprintFromThisViewModalAutomaticSprintCompletionDescription}):(0,k.jsx)(f().sA,{...Kn.manageSprintFromThisViewModalManualSprintCompletionDescription})}function Gn(e){const{collectionContextStore:t,collectionSettingsStore:o,from:i}=e,{sprintSettingsConfig:s,currentSprintDateRange:a,sprintSettingsPermissionsContext:c,sprintSettingsConfigUpdater:d,turnOffSprints:u,turnOnSprints:p,automaticSprintCompletionEnabled:m,canManageSprintFromThisView:S,manageSprintFromThisView:f}=function(e){var t;const{collectionContextStore:o,from:i}=e,s=(0,r().v3)(),a=(0,l().K8)((()=>o.sprintSettingsContextStore.state),[o.sprintSettingsContextStore]),c=(0,l().K8)((()=>null==a?void 0:a.permissionsContext),[a]),d=(0,l().K8)((()=>{var e;return Boolean(null==a||null===(e=a.automationContext)||void 0===e?void 0:e.automationStore.isActive())}),[null==a||null===(t=a.automationContext)||void 0===t?void 0:t.automationStore]),u=(0,l().K8)((()=>{var e;return o.collectionStore()===(null==a?void 0:a.taskCollectionStore)&&(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri)!==Mo().Lu}),[o,null==a?void 0:a.taskCollectionStore]),[p,m]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{!async function(){if(m(void 0),!a)return;const{sprintCollectionViewBlockStore:e,sprintCollectionStore:t}=a;if(!e||!t)return;const o=t.getSchema(),n=wn().n$[Mo().av].current.reducer,i=await Mn().mA(s,{source:"automation",parentRecordStore:e,collectionPointer:t.getSpaceShardedPointer(),filter:n.getCombinatorFilter(o),limit:1});xe().Q.isFail(i)||m(i.value.blockIds[0])}()}),[s,a]);const S=(0,l().K8)((()=>{const e=null==a?void 0:a.sprintCollectionViewBlockStore;if(e&&p)return ct().Bv.createChildStore(e,{id:p,table:jn().ev,spaceId:e.getSpaceId()})}),[p,null==a?void 0:a.sprintCollectionViewBlockStore]),f=(0,l().K8)((()=>{if(!S)return;const e=S.getPropertyValue(Mo().Hx.Dates);if(!e)return;const t=(0,_n().Cok)(e)[0];return t&&"daterange"===t.type?t:void 0}),[S]),y=(0,l().K8)((()=>{var e,t,o;if(!a)return;const n=(null===(e=a.automationContext)||void 0===e||null===(e=e.automationActionStore.getConfig())||void 0===e?void 0:e.complete_sprint_action)??An().AL.actionConfig.complete_sprint_action,i=Boolean(null===(t=a.automationContext)||void 0===t?void 0:t.automationStore.isActive()),r=null===(o=a.automationContext)||void 0===o?void 0:o.automationStore.getRecurrence();return{autoCompleteSprints:i,actionConfig:{complete_sprint_action:n},recurrenceConfig:{interval:(null==r?void 0:r.interval)??An().AL.recurrenceConfig.interval,weekdays:(null==r?void 0:r.weekdays)??An().AL.recurrenceConfig.weekdays}}}),[a]),h=(0,l().K8)((()=>(0,In().O9)(S)&&(0,In().O9)(y)),[S,y]),x=n.useCallback((e=>{h&&g().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:s,canUndo:!0,perform:t=>{a&&a.sprintCollectionStore&&a.automationContext&&S&&kn().e_({environment:s,transaction:t,automationStore:a.automationContext.automationStore,currentSprintBlockStore:S,newDuration:e})}})}),[h,S,s,a]),v=n.useCallback((e=>{h&&g().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:s,canUndo:!0,perform:t=>{a&&a.sprintCollectionStore&&a.automationContext&&S&&kn().g4({environment:s,transaction:t,automationStore:a.automationContext.automationStore,currentSprintBlockStore:S,newWeekday:e})}})}),[h,S,s,a]),C=n.useCallback((e=>{h&&g().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:s,canUndo:!0,perform:t=>{a&&a.sprintCollectionStore&&a.automationContext&&S&&kn().U2({environment:s,transaction:t,automationStore:a.automationContext.automationStore,actionStore:a.automationContext.automationActionStore,currentSprintBlockStore:S,newAutocompleteStatus:e})}})}),[h,S,s,a]),b=n.useCallback((e=>{h&&g().createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:s,canUndo:!0,perform:t=>{a&&a.sprintCollectionStore&&a.automationContext&&kn().qy({transaction:t,actionStore:a.automationContext.automationActionStore,newRemainingTasksBehavior:e})}})}),[h,s,a]),w=n.useCallback((async()=>{await kn().c({environment:s,collectionContextStore:o,from:i})}),[s,o,i]),j=n.useCallback((async e=>{a&&await kn().eN({environment:s,collectionContextStore:o,sprintSettingsContext:a,sprintBoardViewBlockIds:e})}),[o,s,a]),A=n.useCallback((()=>{a&&kn().Zk({environment:s,collectionContextStore:o,currentViewBlockStore:a.currentCollectionViewBlockStore,taskCollectionViewBlockStore:a.taskCollectionViewBlockStore})}),[o,s,a]);return{sprintSettingsConfig:y,sprintSettingsPermissionsContext:c,turnOnSprints:w,turnOffSprints:j,automaticSprintCompletionEnabled:d,canManageSprintFromThisView:u,currentSprintDateRange:f,manageSprintFromThisView:A,sprintSettingsConfigUpdater:{canUpdateSprintSettingsConfig:h,handleSprintDurationChange:x,handleSprintStartWeekdayChange:v,handleSprintAutoCompleteChange:C,handleSprintRemainingTasksBehaviorChange:b}}}({collectionContextStore:t,collectionSettingsStore:o,from:i});if(!c||!c.canEdit||!s)return null;let y;return y=c.sprintsEnabled?(0,k.jsx)(Qn,{...e,updateSprintSettingsConfig:d,onTurnOffSprints:u,automaticSprintCompletionEnabled:m,currentSprintDateRange:a,canManageSprintFromThisView:S,onManageSprintFromThisView:f,sprintSettingsConfig:s}):(0,k.jsx)(Zn,{...e,onTurnOnSprints:p}),y}function Qn(e){const{sprintSettingsConfig:t,automaticSprintCompletionEnabled:o,currentSprintDateRange:n,canManageSprintFromThisView:i,updateSprintSettingsConfig:r,collectionContextStore:l,onTurnOffSprints:s,onManageSprintFromThisView:a}=e,c=ci(),d=[];return d.push((0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(ae().A,{topBorder:!0,disableMobileBorders:!0,children:[i&&(0,k.jsx)(oi,{automaticSprintCompletionEnabled:o,manageSprintFromThisView:a}),(0,k.jsx)(ti,{turnOffSprints:s,collectionContextStore:l})]},"turn-off-sprints-section"),(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(se().A,{href:Fn,external:!0,children:(0,k.jsx)(kt().A,{icon:Jt().$,iconStyle:c.icon,title:(0,k.jsx)(f().sA,{...Kn.learnSprintsTitle}),isGray:!0})})})]})),(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{...Kn.sprintsMenuTitle}),footer:d,children:[(0,k.jsx)(qn,{automaticSprintCompletionEnabled:o,currentSprintDateRange:n}),(0,k.jsxs)(ae().A,{children:[(0,k.jsx)(ii,{onChange:r.handleSprintDurationChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,k.jsx)(ri,{onChange:r.handleSprintStartWeekdayChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,k.jsx)(li,{onChange:r.handleSprintRemainingTasksBehaviorChange,disabled:!r.canUpdateSprintSettingsConfig,sprintSettingsConfig:t})]}),(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(ni,{onChange:r.handleSprintAutoCompleteChange,sprintSettingsConfig:t})})]})}function Zn(e){const{onTurnOnSprints:t}=e,o=ci(),n=[];return n.push((0,k.jsx)(ae().A,{disableMobileBorders:!0,children:(0,k.jsx)("div",{style:o.buttonWrap,children:(0,k.jsx)(A().A,{style:o.button,onClick:async()=>{await t()},size:"lg",children:(0,k.jsx)(f().sA,{...Kn.turnOnSprints})})})},"turn-on-sprints-section")),(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{...Kn.setupSprintsTitle}),footer:n,children:(0,k.jsxs)(ae().A,{disableMobileBorders:!0,children:[(0,k.jsx)(Yn,{}),(0,k.jsx)(Jn,{}),(0,k.jsx)(Xn,{})]})})}function qn(e){const{automaticSprintCompletionEnabled:t,currentSprintDateRange:o}=e,n=ci();if(!o)return null;const i=cn().c9.fromISO(o.end_date).plus({days:1});return(0,k.jsx)(Cn().F,{style:n.sprintStartDateHeader,children:(0,k.jsxs)("div",{style:n.sprintStartDateHeaderWrap,children:[yn(n.sprintStartDateHeaderIcon),(0,k.jsx)(ai,{nextSprintStartDate:i,automaticSprintCompletionEnabled:t})]})})}function Yn(){const e=ci();return(0,k.jsx)("div",{style:{...e.menuDescriptionContainer,...e.menuDescriptionText},children:(0,k.jsx)(f().sA,{...Kn.setupSprintsCaption})})}function Jn(){const e=ci();return(0,k.jsx)("div",{style:e.mediaWrap,children:(0,k.jsx)("img",{src:W().A.images.appPackages.sprintsTurnOnPreviewPng,style:e.media})})}function Xn(){const e=ci(),t=t=>(0,k.jsx)("span",{style:e.boldText,children:t});return(0,k.jsxs)("div",{style:e.disclaimerWrap,children:[(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{...Kn.setupSprintsTeamspaceStatement})}),(0,k.jsx)(ei,{text:(0,k.jsx)(f().sA,{...Kn.setupSprintsSprintBoardPageStatement,values:{bold:t}}),icon:hn().l}),(0,k.jsx)(ei,{text:(0,k.jsx)(f().sA,{...Kn.setupSprintsSprintsDatabaseStatement,values:{bold:t}}),icon:Sn().$})]})}function ei(e){const{text:t,icon:o}=e,n=ci();return(0,k.jsxs)("div",{style:n.disclaimerSubitem,children:[(0,k.jsx)("div",{children:o(n.disclaimerSubitemIcon)}),(0,k.jsx)("div",{children:t})]})}function ti(e){const{collectionContextStore:t,turnOffSprints:o}=e,n=(0,r().v3)(),i=(0,l().K8)((()=>t.sprintSettingsContextStore.state),[t.sprintSettingsContextStore]),[{value:s}]=(0,me().Yb)((async()=>{if(null==i||!i.taskCollectionStore||null==i||!i.taskCollectionViewBlockStore)return;const e=await async function(e){var t;const{environment:o,collectionStore:n,collectionViewBlockStore:i}=e,{appConfigs:r}=await Vn().Aw.load(),l=i.getSpaceId(),s=i.getParentStore(),a=null===(t=n.getFormat())||void 0===t?void 0:t.app_config_uri,c=a&&(0,Bn().lS)(r(),a);if(!s||s.table!==Tn().NX&&s.table!==jn().ev&&s.table!==Pn().yK||!c)return;const d=await Ge().callApi({eventName:"getSprintBoardViewBlocks",environment:o,data:{spaceId:l,taskCollectionId:n.id,parentId:s.id,parentTable:s.table}});return"success"===(null==d?void 0:d.type)?d.data.result:[]}({environment:n,collectionStore:i.taskCollectionStore,collectionViewBlockStore:i.taskCollectionViewBlockStore});return e}),[n,null==i?void 0:i.taskCollectionStore,null==i?void 0:i.taskCollectionViewBlockStore]),a=ci();return(0,k.jsx)(kt().A,{icon:xn().I,title:(0,k.jsx)(f().sA,{...Kn.turnOffSprints}),isRed:!0,iconStyle:a.icon,onClick:()=>{oo().ui({description:(0,k.jsx)(Hn,{numOfSprintBoards:s?s.length:0}),message:(0,k.jsx)("div",{style:a.modalTitle,children:(0,k.jsx)(f().sA,{...Kn.turnOffSprintsModalTitle})}),innerStyle:a.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,k.jsx)(f().sA,{...Kn.turnOffAndDeleteModalButton}),color:"red",onAccept:async()=>{await o(s??[])}}]})}})}function oi(e){const{automaticSprintCompletionEnabled:t,manageSprintFromThisView:o}=e,n=ci();return(0,k.jsx)(kt().A,{icon:mn,title:(0,k.jsx)(f().sA,{...Kn.manageSprintFromThisView}),iconStyle:n.icon,onClick:()=>{oo().ui({description:(0,k.jsx)($n,{automaticSprintCompletionEnabled:t}),message:(0,k.jsx)("div",{style:n.modalTitle,children:(0,k.jsx)(f().sA,{...Kn.manageSprintFromThisViewModalTitle})}),innerStyle:n.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,k.jsx)(f().sA,{...Kn.manageSprintFromThisViewModalButton}),color:"blue",onAccept:o}]})}})}function ni(e){const{onChange:t,sprintSettingsConfig:o}=e,n=ci();return(0,k.jsx)(Uo().A,{title:(0,k.jsx)(f().sA,{...Kn.automatedSprintsToggleTitle}),caption:(0,k.jsx)(f().sA,{...Kn.automatedSprintsToggleCaption}),focused:!1,on:o.autoCompleteSprints,onClick:()=>{t(!o.autoCompleteSprints)},style:{alignItems:void 0},icon:(0,fn().l)(n.icon),shouldWrapCaption:!0})}function ii(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=Un(o.recurrenceConfig.interval),r=En.map((e=>Un(e)));return(0,k.jsx)(si,{title:(0,k.jsx)(f().sA,{...Kn.duration}),right:(0,k.jsx)(Wn,{sprintDurationValue:i.value}),icon:dn().u,getMenuItems:e=>r.map((o=>{const r={key:o.key,render:e=>(0,k.jsx)(Pe().A,{...e,disabled:n,title:(0,k.jsx)(Wn,{sprintDurationValue:o.value}),isChecked:o.key===i.key}),action:()=>{t(o.value),e.close()}};return r})),showChevron:!0})}function ri(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.recurrenceConfig.weekdays[0],r=["SU","MO","TU","WE","TH","FR","SA"];return(0,k.jsx)(si,{title:(0,k.jsx)(f().sA,{...Kn.startOn}),icon:un().k,right:(0,k.jsx)(Nn,{weekday:i}),getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,k.jsx)(Pe().A,{...e,disabled:n,title:(0,k.jsx)(Nn,{weekday:o}),isChecked:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function li(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.actionConfig.complete_sprint_action,r=["complete_sprint_and_move_incomplete_tasks_to_next_sprint","complete_sprint_and_move_incomplete_tasks_to_backlog","complete_sprint"];return(0,k.jsx)(si,{title:(0,k.jsx)(f().sA,{...Kn.incompleteTasks}),right:(0,k.jsx)(zn,{completeSprintAction:i}),icon:gn,getMenuItems:e=>r.map((o=>{const r={key:o,render:e=>(0,k.jsx)(Pe().A,{...e,disabled:n,title:(0,k.jsx)(Ln,{completeSprintAction:o}),isChecked:o===i}),action:()=>{t(o),e.close()}};return r})),showChevron:!0})}function si(e){const{getMenuItems:t}=e,o=(0,r().Y0)(),n=ci(),i=(0,vn().e)({width:250});return(0,k.jsx)(b().Ay,{popupType:o.isMobile?bn().nl.SlideUp:bn().nl.Popup,alignmentToOrigin:b().yP.End,placementToOrigin:b().sx.Bottom,renderOrigin:t=>(0,k.jsx)(kt().A,{...e,iconStyle:n.icon,...t}),render:e=>(0,k.jsx)(zt().A,{...i,children:(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,sections:[{key:0,render:e=>(0,k.jsx)(ae().A,{enableActionSheetTitle:!0,...e}),items:t(e)}],initialFocus:0})})})}function ai(e){const{nextSprintStartDate:t,automaticSprintCompletionEnabled:o}=e,n=cn().c9.local().startOf("day"),i=t.diff(n,"days").days,r=t.toLocaleString({weekday:"short",month:"short",day:"numeric"}),l=e=>(0,k.jsx)("time",{dateTime:t.toISODate(),children:e});return o?0===i?(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{...Kn.sprintStartDateToday,values:{time:l}})}):(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{...Kn.sprintStartDateFuture,values:{time:l,days:i,formattedDate:r}})}):i<0?(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{...Kn.sprintStartDateShouldStartPast,values:{time:l,days:Math.abs(i),formattedDate:r}})}):0===i?(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{...Kn.sprintStartDateShouldStartToday,values:{time:l}})}):(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{...Kn.sprintStartDateShouldStartFuture,values:{time:l,days:i,formattedDate:r}})})}function ci(){const e=(0,r().Y0)();return(0,S().IS)((t=>({icon:{width:16,height:"auto"},menuDescriptionContainer:{margin:"0px 12px"},menuDescriptionText:{fontSize:e.isMobile?le().J.UISmall.mobile:le().J.UISmall.desktop,color:t.text.secondary,fontWeight:le().Wy.regular,marginLeft:14},button:{width:"100%"},buttonWrap:{margin:"0px 12px"},disclaimerWrap:{margin:"0px 12px",fontSize:e.isMobile?le().J.UIRegular.mobile:le().J.UIRegular.desktop,color:t.text.secondary,fontWeight:le().Wy.regular},disclaimerSubitem:{display:"flex",padding:"0px 10px",margin:"7px 0px",gap:7},disclaimerSubitemIcon:{color:t.icon.tertiary,width:20,height:20,marginTop:e.isMobile?3:1},boldText:{color:t.text.primary,fontWeight:le().Wy.semibold},mediaWrap:{margin:"0px 12px"},media:{margin:"15px 0px 10px 0px",width:"100%",border:`1px solid ${t.glass.wash}`,borderRadius:"5px"},mediaIcon:{width:40,height:40,color:t.icon.tertiary},modalTitle:{fontWeight:le().Wy.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalReferencedPageName:{color:t.darkTextColor,fontWeight:le().Wy.semibold},sprintStartDateHeaderWrap:{display:"flex",flexDirection:"row",alignItems:"start",gap:"8px",color:t.text.secondary},sprintStartDateHeaderIcon:{width:16,height:"auto",marginBlockStart:3},sprintStartDateHeader:{background:t.surface.wash}})),[e])}var di=()=>o(756279),ui=()=>o(940371),pi=()=>o(988950),gi=()=>o(541801),mi=()=>o(204067),Si=()=>o(265793),fi=(o(18107),o(967357),()=>o(908006)),yi=()=>o(851979),hi=()=>o(987555),xi=()=>o(738418),vi=()=>o(708830),Ci=()=>o(60867),bi=()=>o(895876),wi=()=>o(519839),ji=()=>o(175116),Ai=()=>o(873050);var _i=()=>o(405417),Ii=()=>o(760578),Mi=()=>o(685889),ki=()=>o(93549),Ti=()=>o(807831),Pi=()=>o(606273);function Bi(e){const{propertyName:t,subitemsDisplayMode:o,inversePropertyName:n}=e,i=(0,S().IS)((e=>({togglePreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:"4px",alignItems:"center",fontWeight:le().Wy.medium,backgroundColor:e.palette.gray[30],padding:"9px 0"}})),[]);return(0,k.jsx)(ae().A,{disableMobileBorders:!0,children:(0,k.jsx)("div",{style:i.togglePreviewOutsideBorder,children:(r=o,"disabled"===r?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Vi,{isLast:!1,itemEmoji:Di,title:n}),(0,k.jsx)(Vi,{isLast:!1,itemEmoji:Ki,title:t}),(0,k.jsx)(Vi,{isLast:!0,itemEmoji:Ki,title:t})]}):"flattened"===r?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Vi,{isLast:!1,itemEmoji:Di,title:n}),(0,k.jsx)(Vi,{isLast:!1,itemEmoji:Ki,title:t,right:(0,k.jsx)(Ri,{parentPropertyName:n})}),(0,k.jsx)(Vi,{isLast:!0,itemEmoji:Ki,title:t,right:(0,k.jsx)(Ri,{parentPropertyName:n})})]}):"hidden"===r?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Vi,{isLast:!1,itemEmoji:Di,title:n,right:(0,k.jsx)(Ei,{count:2})}),(0,k.jsx)(Vi,{isLast:!1,itemEmoji:Oi,title:n}),(0,k.jsx)(Vi,{isLast:!0,itemEmoji:Li,title:n,right:(0,k.jsx)(Ei,{count:1})})]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Vi,{isLast:!1,itemEmoji:Di,title:n,left:(0,k.jsx)(Fi,{indented:!1})}),(0,k.jsx)(Vi,{isLast:!1,itemEmoji:Ki,title:t,left:(0,k.jsx)(Fi,{indented:!0})}),(0,k.jsx)(Vi,{isLast:!0,itemEmoji:Ki,title:t,left:(0,k.jsx)(Fi,{indented:!0})})]}))})});var r}function Vi(e){let{isLast:t,itemEmoji:o,title:n,left:i,right:r}=e;const l=(0,S().IS)((e=>({previewItem:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderBottom:t?void 0:`1px solid ${e.regularDividerColor}`}})),[t]);return(0,k.jsxs)("div",{style:l.previewItem,children:[i,(0,k.jsxs)("span",{style:{marginRight:"5px"},children:[" ",o]}),n,r]})}function Fi(e){let{indented:t}=e;const o=(0,S().DP)();return(0,k.jsx)(Pi().f,{isSidebar:!1,open:!1,fill:!0,onClick:()=>{},style:{color:o.icon.primary,marginLeft:t?"24px":void 0,height:20},disabled:!0})}function Ei(e){let{count:t}=e;const o=(0,S().IS)((e=>({subitemCountIndicator:{display:"inline-flex",alignItems:"center",paddingLeft:8,paddingRight:4,verticalAlign:"text-top"},subitemIcon:{color:e.icon.secondary,width:14,height:14,marginRight:4},innerText:{color:e.text.tertiary,fontWeight:le().Wy.medium,fontSize:le().J.UISmall.desktop}})),[]);return(0,k.jsxs)("span",{style:o.subitemCountIndicator,children:[(0,Ti().V)(o.subitemIcon),(0,k.jsx)("span",{style:o.innerText,children:t})]})}function Ri(e){let{parentPropertyName:t}=e;const o=(0,S().IS)((e=>({parentItemIcon:{color:e.icon.secondary,width:14,height:14,marginRight:4},parentWrapper:{paddingLeft:8,display:"inline-flex",alignItems:"center"},parentTitle:{textOverflow:"ellipsis",overflow:"hidden",color:e.text.tertiary,fontWeight:le().Wy.medium,fontSize:le().J.UISmall.desktop,whiteSpace:"nowrap"}})),[]);return(0,k.jsxs)("span",{style:o.parentWrapper,children:[(0,ki().j)(o.parentItemIcon),(0,k.jsx)("span",{style:o.parentTitle,children:t})]})}const Di="🐔",Ki="🐣",Oi="🐮",Li="🐷";var zi=()=>o(147361),Ni=()=>o(926203),Ui=()=>o(334955);function Wi(e){const{collectionContextStore:t,collectionSettingsStore:o,feature:i,from:s}=e,a=(0,f().tz)(),c=(0,r().Y0)(),d=(0,l().O$)(t.normalizedSchemaStore),p=(0,l().K8)((()=>t.databaseType),[t]),g=(0,l().K8)((()=>t.collectionStore()),[t]),m=(0,Ui().lk)({collectionContextStore:t,feature:i}),h=null==m?void 0:m.property,x=(0,n.useMemo)((()=>wi().HG(d)),[d]),v=(0,l().O$)(t.permissionScopesStore),C=(0,l().K8)((()=>{var e;return h&&(null===(e=d[h])||void 0===e?void 0:e.name)}),[d,h]),b=(0,l().K8)((()=>t.collectionViewStore()),[t]),w=(0,l().K8)((()=>null==b?void 0:b.getFormat()),[b]),j=(null==w?void 0:w.subitem_display_mode)??"show",A=(0,l().K8)((()=>{const e=h&&d[h];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=d[o])||void 0===t?void 0:t.name:void 0}}),[h,d]),_=(0,l().K8)((()=>{const e=t.collectionStore();return null!=e&&e.isDefined()?Mi().zF(a,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:i}):a.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[t,a,i]),I=(0,l().K8)((()=>Boolean(g&&function(e){const{collectionContextStore:t,collectionStore:o}=e,n=o.getFormat().collection_default_arrows_by,i=t.currentArrowsByFormatStore.state;return!(0,In().O9)(i)||i===n}({collectionContextStore:t,collectionStore:g}))),[t,g]),M=(0,l().uB)(void 0,L().A),T=(0,n.useCallback)((e=>{e&&M.setState({open:!1})}),[M]),{initialPropertyName:P}=(0,Ui().Me)({collectionContextStore:t,feature:i}),B=(0,Ui().Tv)({collectionContextStore:t,onPropertySelect:T,feature:i}),{handleAddRelation:V,handleDefaultPropertySelect:F,clearCollectionViewSubitemDisplayMode:E}=B,R=(0,S().IS)((e=>({container:{marginLeft:12,marginRight:12},captionText:{fontSize:c.isMobile?le().J.UISmall.mobile:le().J.UISmall.desktop,color:e.text.secondary,fontWeight:le().Wy.regular,marginLeft:14},subitemsPreviewContainer:{marginBottom:6,marginLeft:2}})),[c]);if(!g)return null;let D;if("subitem"===i)if(m)D=(0,k.jsxs)(ae().A,{disableMobileBorders:!0,children:[(0,k.jsx)("div",{style:R.subitemsPreviewContainer,children:(0,k.jsx)(Bi,{propertyName:C||P,inversePropertyName:A||_,subitemsDisplayMode:j})}),(0,k.jsx)(Ji,{databaseType:p,permissionScopes:v}),(0,k.jsx)(K().A,{size:12,style:{marginTop:4,marginBottom:4}}),(0,k.jsx)(Ni().Eg,{collectionSettingsStore:o,feature:i,permissionScopes:v}),(0,k.jsx)(Ni().Xm,{feature:i,databaseType:p,permissionScopes:v,propertyName:C,relationPropertyId:h,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:F,inversePropertyName:A,clearCollectionViewSubitemDisplayMode:E})]});else{const e=()=>{V({featureType:"subitem",from:s}),u().yl({collectionSettingsStore:o}),fi().default.afterNextFlush((()=>{const e=t.subitemTreeStore.getState(),o=t.resultsInViewOrder(1).at(0),n=(0,vi().Qe)(e.children,(e=>e.value.store===o));if(n){const e=n.map((e=>e.value.store.pointer)),o=(0,_i().kY)(e);Ci().QK({collectionContextStore:t,pathKey:o})}}))};D=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Bi,{propertyName:C||P,inversePropertyName:A||_,subitemsDisplayMode:j}),(0,k.jsx)(Ni().pz,{feature:i,permissionScopes:v,databaseType:p,handleAddRelation:e})]})}else"timeline_arrows_by"===i?D=m?(0,k.jsxs)(k.Fragment,{children:[I?(0,k.jsx)($i,{collectionContextStore:t,firstDatePropertyId:x,permissionScopes:v}):(0,k.jsx)(Hi,{collectionContextStore:t,databaseType:p}),(0,k.jsxs)(ae().A,{topBorder:!0,children:[(0,k.jsx)(Ni().Eg,{collectionSettingsStore:o,feature:i,permissionScopes:v}),(0,k.jsx)(Qi,{feature:i,databaseType:p,featuredRelationProperty:m,actions:B,permissionScopes:v}),(0,k.jsx)(Ni().Xm,{feature:i,databaseType:p,permissionScopes:v,relationPropertyId:h,propertyName:C,inversePropertyName:A,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:F})]})]}):(0,k.jsx)(Gi,{databaseType:p,collectionContextStore:t,firstDatePropertyId:x,handleAddRelation:V,permissionScopes:v,from:s}):(0,In().HB)(i);const O=(0,Ii().mv)({feature:i,databaseType:p}),z=(0,Ii().I_)({feature:i,databaseType:p});return(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{...O}),children:[(0,k.jsx)(ae().A,{disableMobileBorders:!0,children:(0,k.jsx)("div",{style:{...R.container,...R.captionText},children:(0,k.jsx)(f().sA,{...z})})}),D]})}function Hi(e){const{collectionContextStore:t,databaseType:o}=e,n=(0,r().WS)(),i=(0,S().IS)((e=>({wrap:{boxShadow:e.shadow2XS,...n?{backgroundColor:e.surface.wash,margin:void 0,borderRadius:void 0}:{background:"rgba(196, 196, 196, 0.13)",marginTop:14,marginBottom:20}},iconWithMessage:{display:"flex",gap:8},icon:{width:14,height:14,position:"relative",top:1,color:e.text.secondary}})),[n]),s=(0,l().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),a=(0,Ii().qC)({currentDateShiftConfig:s,databaseType:o});return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ae().A,{title:(0,k.jsx)(f().sA,{...Ii().Ic.dateShiftingSectionCaption}),children:(0,k.jsx)(zi().r,{mode:null==s?void 0:s.mode})}),(0,k.jsx)(Cn().F,{style:i.wrap,showCloseButton:!1,children:(0,k.jsxs)("div",{style:i.iconWithMessage,children:[(0,xi().G)(i.icon),(0,k.jsx)(Re().A,{isSmall:!0,isMultiline:!0,children:(0,k.jsx)(f().sA,{...a})})]})})]})}function $i(e){const{collectionContextStore:t,firstDatePropertyId:o,permissionScopes:i}=e,s=(0,r().v3)(),a=(0,f().tz)(),c=(0,l().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),d=(0,n.useCallback)((e=>{const o=t.collectionStore();o&&g().createAndCommit({userAction:"FeatureEnabledDependenciesSection.handleConfigChange",environment:s,canUndo:!0,perform:t=>{(0,Ni().Wf)({collectionStore:o,environment:s,intl:a,newConfig:e,transaction:t})}})}),[t,s,a]),u=(0,n.useMemo)((()=>({configWithoutDates:c,...c?{datePropertyId:c.date_property,endDatePropertyId:c.end_date_property}:{datePropertyId:o}})),[c,o]);return(0,k.jsx)(Ni().aH,{collectionContextStore:t,currentConfig:u,disabled:!i.canConfigureBlock||!i.canConfigureCollection,onConfigChange:d})}function Gi(e){const{collectionContextStore:t,handleAddRelation:o,firstDatePropertyId:i,permissionScopes:r,databaseType:s,from:a}=e,[c,d]=(0,n.useState)({datePropertyId:i,configWithoutDates:{mode:Ni().qd,avoid_weekends:Ni().$g}}),p=(0,l().K8)((()=>t.settingsStore),[t]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Ni().aH,{collectionContextStore:t,currentConfig:c,disabled:!r.canConfigureBlock||!r.canConfigureCollection,onConfigChange:d}),(0,k.jsx)(Ni().pz,{feature:"timeline_arrows_by",permissionScopes:r,databaseType:s,handleAddRelation:()=>{o({featureType:"timeline_arrows_by",dateShiftingConfig:c,from:a}),u().yl({collectionSettingsStore:p})}})]})}function Qi(e){const{feature:t,featuredRelationProperty:o,actions:n,permissionScopes:i,databaseType:l}=e,s=(0,r().Y0)(),a=(0,S().IS)((()=>({eyeHideIcon:{width:20,height:s.isMobile?24:12,marginLeft:3}})),[s]);if(!o.supportedInView)return null;const c=o.enabledOnView,d=o.isVisibleInView,u=d?{icon:hi().T,iconStyle:a.eyeHideIcon}:{icon:yi().h};return(0,k.jsx)(kt().A,{...u,onClick:()=>{n.handlePropertySelect(c?void 0:o.property)},title:(0,k.jsx)(f().sA,{...(0,Ii().WI)({feature:t,isOn:d,databaseType:l})}),disabled:!i.canConfigureBlock})}function Zi(e){const{subitemDisplayMode:t,collectionViewType:o,intl:n,databaseType:i}=e;if("show"===t||void 0===t)switch(o){case"board":case"calendar":case"gallery":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.onCard",defaultMessage:"Card property"});case"table":case"list":case"timeline":case"page":return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.nestedInToggle",defaultMessage:"Nested in toggle"});default:return n.formatMessage({id:"getTitleForSubitemDisplayModeMenuItem.default",defaultMessage:"Default view"})}else{if("hidden"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.hideSubitems",defaultMessage:"Parents only"},{items:(0,bi().oj)(i,!0)});if("flattened"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.flattenedList",defaultMessage:"Flattened list"});if("disabled"===t)return n.formatMessage({id:"subitemDisplayModeMenuItemTitle.disabled",defaultMessage:"Disabled"});(0,In().HB)(t)}}const qi=["show","hidden","flattened","disabled"];function Yi(e){const{intl:t,collectionViewType:o,databaseType:n}=e;return qi.map((e=>({key:e,type:"button",title:Zi({intl:t,collectionViewType:o,subitemDisplayMode:e,databaseType:n})})))}function Ji(e){const{databaseType:t,permissionScopes:o}=e,i=(0,f().tz)(),s=(0,ji().ET)(),c=(0,l().K8)((()=>s.collectionViewStore()),[s]),d=(0,l().K8)((()=>null==c?void 0:c.getFormat()),[c]),u=(null==d?void 0:d.subitem_display_mode)??"show",m="show"===u,S=(0,r().v3)(),y=n.useCallback((e=>{const t=s.getPropertyFormatKey(),o=(0,_i().r6)(s),n=null==o?void 0:o.property,i=null==o?void 0:o.inverse;c&&t&&n&&i&&e!==u&&g().createAndCommit({userAction:"actionRegistry.updateCollectionViewSubitemDisplayMode",environment:S,canUndo:!0,perform:o=>{const r=c.getType();if(("board"===r||"gallery"===r||"calendar"===r)&&ve().a5({formatStore:c,formatKey:t,property:n,update:{visible:"show"===e},transaction:o}),"hidden"===u){var l;const e=null==d||null===(l=d.property_filters)||void 0===l?void 0:l.filter((e=>e.id!==Ai().Oe));p().zA({stores:[c],update:{property_filters:e},transaction:o})}if("hidden"===e){const e={property:i,filter:{operator:"is_empty"}},t=(null==d?void 0:d.property_filters)||[];p().zA({stores:[c],update:{property_filters:[...t,{id:Ai().Oe,filter:e}]},transaction:o})}p().zA({stores:[c],update:{subitem_display_mode:e},transaction:o})}})}),[s,c,S,d,u]);(0,n.useEffect)((()=>{(0,a().v)(S,"configure_subitem_display_mode",{userAction:m?"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.flattened":"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.show"})}),[m,S]);const h=(0,l().K8)((()=>(null==c?void 0:c.getType())??"table"),[c]);return"chart"===h||"form_editor"===h||"feed"===h||"map"===h||"chat"===h?(0,k.jsx)(k.Fragment,{}):(0,k.jsx)(wt().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Show as",id:"SubitemDisplayModeMenuItem.menuItemTitle"}),collectionContextStore:s,selectedKey:u,options:Yi({collectionViewType:h,intl:i,databaseType:t}),onChange:e=>y(e),disabled:!o.canConfigureBlock})}var Xi=()=>o(762631),er=()=>o(436696),tr=()=>o(4319),or=()=>o(946548),nr=()=>o(878665);const ir="box1-filter",rr="box2-filter";function lr(e){const{propertyName:t,inversePropertyName:o}=e,n=(0,S().DP)(),i=(0,S().IS)((e=>({svgWrap:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:6,alignItems:"center",position:"relative",height:112,backgroundColor:e.palette.gray[30],display:"flex",justifyContent:"center"}})),[]);return(0,k.jsx)(ae().A,{disableMobileBorders:!0,children:(0,k.jsx)("div",{style:i.svgWrap,children:(0,k.jsxs)("svg",{width:"266",height:"116",fill:"none",children:[(0,k.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M124 20h.426c7.703 0 17.307-.002 25.029 1.93 3.979.994 8.078 2.638 11.248 5.575C164.082 30.635 166 34.868 166 40c0 8.001-6.095 12.917-11.524 15.932-5.553 3.086-12.74 5.481-19.23 7.644l-.349.116c-6.919 2.307-13.074 4.381-17.546 6.866C112.655 73.166 112 75 112 76c0 1.868.582 2.885 1.453 3.692 1.08 1.001 2.981 1.982 6.002 2.737C125.59 83.963 132.773 84 141 84"}),(0,k.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M125 32c8.227 0 15.41.037 21.545 1.57 3.021.756 4.922 1.737 6.002 2.738.871.807 1.453 1.824 1.453 3.692 0 .999-.655 2.834-5.351 5.443-4.472 2.484-10.627 4.558-17.546 6.865l-.349.116c-6.49 2.163-13.677 4.558-19.23 7.644C106.095 63.084 100 67.998 100 76c0 5.132 1.918 9.365 5.297 12.495 3.17 2.937 7.269 4.581 11.248 5.576C124.267 96 133.871 96 141.574 96H142"}),(0,k.jsx)("path",{fill:n.palette.gray[30],d:"M157 27h16v18h-16zM92 70h16v18H92z"}),(0,k.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M136 88l5-4-5-4"}),(0,k.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M130 36l-5-4 5-4"}),(0,k.jsxs)("g",{filter:`url(#${ir})`,children:[(0,k.jsx)("rect",{width:"100",height:"28",x:"24",y:"12",fill:n.buttonBackground,rx:"3"}),(0,k.jsx)("text",{x:"67",y:"31",fill:"#000",children:"🌱"})]}),(0,k.jsxs)("g",{filter:`url(#${rr})`,children:[(0,k.jsx)("rect",{width:"100",height:"28",x:"142",y:"76",fill:n.buttonBackground,rx:"3"}),(0,k.jsx)("text",{x:"185",y:"95",fill:"#000",children:"🌳"})]}),(0,k.jsx)(sr,{x:"161",y:"26",width:"100",height:"16",textStyles:{fontSize:12,fontWeight:590,color:n.text.primary},children:t}),(0,k.jsx)(sr,{x:"15",y:"69",width:"90",height:"16",textStyles:{color:n.text.tertiary,fontSize:12,fontWeight:500,textAlign:"right"},children:o}),(0,k.jsxs)("defs",{children:[(0,k.jsxs)("filter",{id:ir,width:"108",height:"36",x:"20",y:"10",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,k.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,k.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,k.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,k.jsx)("feOffset",{}),(0,k.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,k.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,k.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,k.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,k.jsx)("feOffset",{dy:"2"}),(0,k.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,k.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,k.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,k.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,k.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]}),(0,k.jsxs)("filter",{id:rr,width:"108",height:"36",x:"138",y:"74",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,k.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,k.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,k.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,k.jsx)("feOffset",{}),(0,k.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,k.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,k.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,k.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,k.jsx)("feOffset",{dy:"2"}),(0,k.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,k.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,k.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,k.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,k.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]})]})]})})})}function sr(e){const{children:t,textStyles:o,...n}=e;return(0,k.jsx)("foreignObject",{...n,children:(0,k.jsx)("div",{style:{...le().RC,...n.width?{width:Number(n.width)}:{},...o},children:t})})}var ar=()=>o(554840);function cr(e){var t;const{collectionContextStore:o,feature:i}=e,r=(0,f().tz)(),s=(0,l().K8)((()=>o.collectionStore()),[o]),a=(0,l().O$)(o.normalizedSchemaStore),c=(0,l().O$)(o.permissionScopesStore),d=null===(t=(0,Ui().lk)({collectionContextStore:o,feature:i}))||void 0===t?void 0:t.property,u=(0,l().K8)((()=>{var e;return d&&(null===(e=a[d])||void 0===e?void 0:e.name)}),[d,a]),p=(0,l().K8)((()=>{var e;return"table"===(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getType())}),[o]),g=(0,l().K8)((()=>{const e=d&&a[d];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=a[o])||void 0===t?void 0:t.name:void 0}}),[d,a]),m=(0,l().K8)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?Mi().zF(r,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:i}):r.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,r,i]),h=(0,l().uB)(void 0,L().A),{initialPropertyName:x}=(0,Ui().Me)({collectionContextStore:o,feature:i}),v=(0,n.useCallback)((e=>{e&&h.setState({open:!1})}),[h]),C=(0,S().IS)((()=>({previewContainer:{marginLeft:2}})),[]);if(!s)return null;let b;return"subitem"===i?b=(0,k.jsx)(Bi,{propertyName:u||x,inversePropertyName:g||m,subitemsDisplayMode:"show"}):"timeline_arrows_by"===i?b=(0,k.jsx)(lr,{propertyName:u||x,inversePropertyName:g||m}):(0,In().HB)(i),(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{...Ii().Ic.advancedSettings}),children:[(0,k.jsx)("div",{style:C.previewContainer,children:b}),(0,k.jsxs)(ae().A,{disableMobileBorders:!0,children:[(0,k.jsx)(ar().a,{currentPropertyId:d,feature:i,onPropertySelect:v,buttonPopupStore:h,collectionContextStore:o,permissionScopes:c,disabled:!c.canConfigureCollection}),"subitem"===i&&p&&(0,k.jsx)(dr,{collectionContextStore:o,permissionScopes:c})]})]})}function dr(e){const{collectionContextStore:t,permissionScopes:o}=e,i=(0,f().tz)(),s=(0,r().v3)(),a=(0,l().K8)((()=>"title"===t.normalizedFormatStore.state.table_subitem_toggle_column),[t]),c=!o.canConfigureBlock,d=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(tr().jP({environment:s,collectionViewStore:e,currentValue:t.normalizedFormatStore.state.table_subitem_toggle_column}),(0,er().X)({environment:s,collectionContextStore:t,action:"toggle_table_subitem_toggle_on_title"}))}),[t,s]);return(0,k.jsx)(nr().A,{showImage:o.canConfigureBlock,caption:i.formatMessage(Ii().Ic.toggleNestingOnTitleMenuItemTooltip),tooltipImage:W().A.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,k.jsx)(kt().A,{...e,icon:()=>(0,Xi().U)({width:pn().Ev.sm,height:pn().Ev.sm,marginLeft:4,marginRight:2}),onClick:d,title:(0,k.jsx)(f().sA,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,k.jsx)(or().A,{disallowTabbing:!0,on:a,disabled:c,onClick:d}),disabled:c})})}var ur=()=>o(689094);function pr(e){const{integration:t,collectionSettingsStore:o,collectionContextStore:n,onAccountSelect:i}=e,s=(0,S().IS)((()=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"}})),[]),a=(0,r().v3)(),c=(0,l().K8)((()=>{var e;return null===(e=n.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[n]),d=(0,l().K8)((()=>{const e=De().A.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]);return t&&c?(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Choose an account",id:"collectionSettingsAccountPicker.title"}),footer:gr({environment:a,integration:t,spaceId:c}),children:(0,k.jsx)("div",{style:s.settingsMenu,children:(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:0,sections:[{key:"externalAuthentications",items:d.map((e=>{const n={key:e.id,render:o=>(0,k.jsx)(Ie().A,{renderTooltip:()=>(0,k.jsx)("span",{children:e.account_name}),placement:Pt().W.Left,textWrap:!0,render:n=>(0,k.jsx)(Pe().A,{...(0,Tt().A)(n||{},o),title:e.account_name,icon:(0,k.jsx)("img",{style:{width:18},src:t.info.icon}),focused:o.focused})}),action:()=>{u().yl({collectionSettingsStore:o}),i(e)}};return n})),render:e=>(0,k.jsx)(ae().A,{...e})}]})})}):null}function gr(e){const t=e.environment.device.isMobileBrowser;return(0,k.jsx)(ae().A,{topBorder:!0,children:t?void 0:mr(e)})}function mr(e){return(0,k.jsx)(kt().A,{...e,icon:ur().W,title:(0,k.jsx)(f().sA,{id:"collectionSettingsAccountPicker.addAccount",defaultMessage:"Connect another account"}),isGray:!0,onClick:async()=>{await no().Jq({...e,from:"source_picker_connect_another_account"})}})}var Sr=()=>o(444091),fr=o.n(o(844751)),yr=()=>o(757695),hr=()=>o(430171),xr=()=>o(95441);const vr=(0,f().YK)({searchPlaceholder:{defaultMessage:"Search for a property...",id:"database.viewSettings.databaseProperties.searchPlaceholder"}}),Cr=yr().Store.createClass("",{name:"InputStore"});function br(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,i=(0,r().v3)(),s=(0,S().DP)(),a=(0,l().O$)(t.normalizedSchemaStore),c=(0,l().O$)(t.permissionScopesStore),d=(0,l().uB)(void 0,Cr),p=(0,l().O$)(d),g=(0,n.useMemo)((()=>{const e=p.toLowerCase();return e?Object.entries(a).filter((t=>{let[o,n]=t;return!!n&&fr().test(e,n.name.toLowerCase())})):Object.entries(a)}),[a,p]),m=c.canConfigureCollection&&!c.isExternallyImportedAndSyncedCollection,h=(0,n.useCallback)((()=>{(0,hr().c)({environment:i,collectionContextStore:t})}),[i,t]),x=(0,n.useCallback)((e=>{u().a2({collectionSettingsStore:o,item:{type:"property",property:e,formatKey:void 0}})}),[o]),v=(0,S().IS)((e=>({title:{display:"flex",alignItems:"center"},propertiesContainer:{paddingTop:8,paddingBottom:8},propertyIcon:{fill:e.icon.primary}})),[]);return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)("div",{style:v.title,children:(0,k.jsx)(f().sA,{defaultMessage:"Properties",id:"database.viewSettings.databaseProperties.title"})}),header:(0,k.jsx)(ae().A,{children:(0,k.jsx)(Be().Ay,{placeholder:jt().A.formatMessage(vr.searchPlaceholder),value:p,onChange:e=>d.setState(e.target.value)})}),footer:(0,k.jsxs)(ae().A,{topBorder:!0,children:[m&&(0,k.jsx)(kt().A,{icon:ur().W,title:(0,k.jsx)(f().sA,{defaultMessage:"New property",id:"database.viewSettings.databaseProperties.newProperty"}),isGray:!0,onClick:h}),(0,k.jsx)(xr().A,{href:(0,ro().xS)("guides.databaseProperties"),title:(0,k.jsx)(f().sA,{defaultMessage:"Learn about properties",id:"database.viewSettings.databaseProperties.learnMoreButton.title"}),analyticsFrom:"database_settings_properties"})]}),children:(0,k.jsx)("div",{style:v.propertiesContainer,children:g.map((e=>{let[t,o]=e;return o?(0,k.jsx)(kt().A,{icon:e=>(0,k.jsx)(ue().zB,{type:o.type,icon:o.icon,size:16,style:{...e,...v.propertyIcon},theme:s}),title:o.name,onClick:()=>x(t),showChevron:!0},t):null}))})})}var wr=()=>o(568625),jr=()=>o(657222),Ar=()=>o(863330),_r=()=>o(884107),Ir=()=>o(409902),Mr=()=>o(745266),kr=()=>o(31902),Tr=()=>o(285790),Pr=()=>o(479e3),Br=()=>o(691093),Vr=()=>o(46986),Fr=()=>o(404637);const Er=(0,f().YK)({copySuccessMessage:{defaultMessage:"Link to database copied to clipboard",id:"database.viewSettings.databaseSettings.copyLinkSnackBarItem.title"},deleteButtonLabel:{defaultMessage:"Delete",id:"database.viewSettings.databaseSettings.deleteDatabaseButton.title"},detachButtonLabel:{defaultMessage:"Detach",id:"database.viewSettings.databaseSettings.detachDatabaseButton.title"},cancelButtonLabel:{defaultMessage:"Cancel",id:"database.viewSettings.databaseSettings.cancelButton.title"}});function Rr(e){return(0,l().K8)((()=>(0,Vr().Ux)()),[])?(0,k.jsx)(Kr,{...e}):(0,k.jsx)(Dr,{...e})}function Dr(e){const t=(0,r().v3)(),o=(0,S().IS)((()=>({title:{display:"flex",alignItems:"center"}})),[]),n=(0,l().K8)((()=>{const t=e.collectionContextStore.collectionViewBlockStore();if(!t)return;const o=e.collectionContextStore.collectionStore();if(!o)return;const n=o.getSchemaStore().getValue(),i=t.getCollectionViewStores().filter((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===o.id})),r=o.getAutomationStores(),l=o.getParentId()===t.id;return{collectionViewBlockStore:t,collectionStore:o,schema:n,views:i,automations:r,isSourceDatabase:l}}),[e.collectionContextStore]);if(!n)return null;const i=n.isSourceDatabase?(0,k.jsx)(f().sA,{defaultMessage:"Delete database",id:"database.viewSettings.databaseSettings.deleteDatabaseButton.confirm"}):(0,k.jsx)(f().sA,{defaultMessage:"Detach database",id:"database.viewSettings.databaseSettings.detachDatabaseButton.confirm"});return(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)("div",{style:o.title,children:(0,k.jsx)(f().sA,{defaultMessage:"Database options",id:"database.viewSettings.databaseSettings.title"})}),children:[(0,k.jsxs)(ae().A,{children:[(0,k.jsx)(kt().A,{icon:Fo().j,showChevron:!0,title:(0,k.jsx)(f().sA,{defaultMessage:"Properties",id:"database.viewSettings.databaseSettings.properties"}),onClick:()=>{u().a2({collectionSettingsStore:e.collectionSettingsStore,item:{type:"databaseProperties"}})}}),(0,k.jsx)(Fr().GS,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore}),(0,k.jsx)(Pr().lP,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore}),(0,k.jsx)(Fr().is,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore})]}),(0,k.jsxs)(ae().A,{topBorder:!0,children:[(0,k.jsx)(kt().A,{icon:jr().w,title:(0,k.jsx)(f().sA,{defaultMessage:"Copy link to database",id:"database.viewSettings.databaseSettings.copyLinkButton.title"}),onClick:async()=>{const e=await _r().R.clipboardActions.load();await e.copyString({environment:t,stringValue:window.location.href,copiedMessage:e.clipboardMessages.copiedLinkToClipboard}),Ot().D6({label:jt().A.formatMessage(Er.copySuccessMessage)})}}),(0,k.jsx)(kt().A,{icon:xn().I,isRed:!0,title:i,onClick:async()=>{if(!n)return;const{collectionStore:e,collectionViewBlockStore:o,isSourceDatabase:r}=n,l=r?(0,k.jsx)(f().sA,{defaultMessage:"{databaseCount, plural, one {# database} other {# databases}}, {propertyCount, plural, one {# property} other {# properties}}, {viewCount, plural, one {# view} other {# views}}, {automationCount, plural, one {# automation} other {# automations}} will be deleted",id:"database.viewSettings.databaseSettings.deleteDatabaseButton.confirmDescription",values:{databaseCount:1,propertyCount:Object.keys(n.schema??{}).length,viewCount:n.views.length,automationCount:n.automations.length}}):(0,k.jsx)(f().sA,{defaultMessage:"{viewCount, plural, one {# view} other {# views}} will be deleted. The database will not be deleted.",id:"database.viewSettings.databaseSettings.detachDatabaseButton.confirmDescription",values:{viewCount:n.views.length}}),{accept:s}=await oo().Gh({message:i,description:l,acceptLabel:jt().A.formatMessage(r?Er.deleteButtonLabel:Er.detachButtonLabel),cancelLabel:jt().A.formatMessage(Er.cancelButtonLabel),cancelButtonType:"plain",cancelColor:"gray"});s&&(g().createAndCommit({environment:t,userAction:"CollectionSettingsDatabaseSettings.handleDeleteDatabase",canUndo:!0,perform:t=>{(0,Ir().h)({collectionViewBlockStore:o,collectionStore:e,transaction:t})}}),(0,Br().showWorkflowEditor)({environment:t,parentStore:o,navigationState:{isOpen:!0,type:"agent"}}))}})]})]})}function Kr(e){const t=(0,l().K8)((()=>{const t=e.collectionContextStore.collectionViewBlockStore();if(!t)return;const o=e.collectionContextStore.collectionStore();if(!o)return;const n=o.getSchemaStore().getValue(),i=t.getCollectionViewStores().filter((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===o.id})),r=o.getAutomationStores(),l=o.getParentId()===t.id;return{collectionViewBlockStore:t,collectionStore:o,schema:n,views:i,automations:r,isSourceDatabase:l}}),[e.collectionContextStore]);return t?(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Settings",id:"databaseSettingsV2.title"}),children:[(0,k.jsx)(ae().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Views",id:"databaseSettingsV2.viewSection.title"}),children:t.views.map((e=>(0,k.jsx)(Or,{collectionViewStore:e},e.id)))}),(0,k.jsx)(Lr,{collectionStore:t.collectionStore,collectionContextStore:e.collectionContextStore})]}):null}function Or(e){let{collectionViewStore:t}=e;const o=(0,r().v3)(),{viewName:n,viewType:i,viewIcon:s}=(0,l().K8)((()=>({viewName:t.getName(),viewType:t.getType(),viewIcon:t.getFormat().collection_view_icon})),[t]);if(!i)throw new Error(`View type not found for ${t.id}`);return(0,k.jsx)(kt().A,{title:(0,k.jsx)(kr().A,{collectionViewType:i,collectionViewName:n}),icon:()=>(0,k.jsx)(Mr().h,{color:"regular",viewType:i,viewIcon:s}),onClick:()=>{const{mainEditorCurrentBlockStore:e}=ce().default.state;if(!e||!e.isCollectionView())throw new Error("Main editor current block store is not a collection view");(0,Br().showWorkflowEditor)({environment:o,parentStore:e,navigationState:{isOpen:!0,type:"preview",collectionViewId:t.id}})}})}function Lr(e){const t=(0,f().tz)(),{collectionStore:o,collectionContextStore:i}=e,s=(0,r().v3)(),a=(0,l().K8)((()=>{var e;const t=(null===(e=o.getModel())||void 0===e?void 0:e.getNormalizedSchema())??{};return Object.entries(t).filter((e=>void 0!==e[1]))}),[o]),c=(0,S().DP)(),d=(0,S().IS)((e=>({sectionTitleContainer:{display:"flex",alignItems:"center",gap:4},propertyItem:{height:36,paddingTop:8,paddingBottom:8,paddingLeft:12,display:"flex",alignItems:"center",justifyContent:"flex-start",gap:8},expandButtonIcon:{minWidth:18,minHeight:18,width:18,height:18,color:e.icon.secondary},expandButtonText:{color:e.text.secondary}})),[]),p=(0,n.useCallback)((()=>{u().a2({collectionSettingsStore:i.settingsStore,item:{type:"propertyType",onAccept:e=>{const{propertyType:t,isSuggestedProperty:o,propertyName:n,propertyIcon:r,selectOptions:l}=e;Qe().nZ({environment:s,collectionContextStore:i,propertyType:t,isSuggestedProperty:o,propertyName:n,propertyIcon:r,selectOptions:l,from:"database_settings"})}}})}),[i,s]),g=(0,n.useCallback)((e=>{u().a2({collectionSettingsStore:i.settingsStore,item:{type:"property",property:e,formatKey:void 0}})}),[i]),[m,y]=(0,n.useState)(!1),h=m?a:a.slice(0,5),x=m||h.length===a.length?null:(0,k.jsx)(Pe().A,{title:(0,k.jsx)(f().sA,{id:"WorkflowEditorDatabase.DatabaseProperties.expand",defaultMessage:"{count, plural, one {# more property} other {# more properties}}",values:{count:a.length-5}}),icon:(0,wr().L)(),focused:!1,onClick:()=>y(!0),style:d.propertyItem,desktopIconStyle:d.expandButtonIcon,desktopTitleStyle:d.expandButtonText});return(0,k.jsx)(ae().A,{title:(0,k.jsxs)("div",{style:d.sectionTitleContainer,children:[(0,k.jsx)(f().sA,{id:"WorkflowEditorDatabase.DatabaseDetails.properties",defaultMessage:"Properties"}),(0,k.jsx)(Tr().A,{icon:Ar().plusSmallIcon,ariaLabel:t.formatMessage({id:"WorkflowEditorDatabase.DatabaseDetails.access.add",defaultMessage:"Add"}),onClick:p,style:{width:20,height:20}})]}),children:(0,k.jsxs)("div",{children:[h.map(((e,t)=>{let[o,n]=e;return(0,k.jsx)(kt().A,{icon:e=>(0,k.jsx)(ue().zB,{type:n.type,icon:n.icon,size:18,theme:c,style:{fill:c.icon.primary}}),title:n.name,onClick:()=>g(o)},o)})),x]})})}var zr=()=>o(259476),Nr=()=>o(912720),Ur=()=>o(821062),Wr=()=>o(813297),Hr=()=>o(254497),$r=()=>o(678553),Gr=()=>o(525432),Qr=()=>o(447934);const Zr=(0,f().YK)({delete:{defaultMessage:"Delete",id:"database.deletedProperties.delete"},undo:{defaultMessage:"Undo",id:"database.deletedProperties.undo"},permanentlyDeleteAll:{defaultMessage:"Permanently delete all",id:"database.deletedProperties.permanentlyDeleteAll"}});function qr(e){let{collectionSettingsStore:t,collectionContextStore:i,timelineViewTab:s}=e;const a=(0,r().v3)(),c=(0,S().DP)(),d=(0,l().O$)(i.normalizedDeletedSchemaStore),p=(0,lo().X)("nds_default_property_noticon"),m=(0,f().tz)(),h=(0,o(7667).A)(),x=(0,n.useCallback)((e=>{h(e);const o=(0,Gr().ZI)({timelineViewTab:s,collectionContextStore:i});u().yl({collectionSettingsStore:t}),u().a2({collectionSettingsStore:t,item:{type:"property",property:e,formatKey:o}})}),[i,t,h,s]),v=(0,lo().X)("db_ux_chrome"),C=(0,n.useMemo)((()=>Object.entries(d).map((e=>{let[t,o]=e;if(o)return{propertyId:t,propertySchema:o}})).filter(In().O9)),[d]),b=(0,n.useCallback)((()=>0===C.length?(0,k.jsx)(ae().A,{children:(0,k.jsx)($r().Ay,{title:(0,k.jsx)(f().sA,{defaultMessage:"No results",id:"database.viewSettings.deletedPropertiesTab.noResults"})})}):(0,k.jsx)(ae().A,{extraPadding:v,children:C.map((e=>{let{propertyId:t,propertySchema:n}=e;return(0,k.jsx)($r().Ay,{title:(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,k.jsx)(ue().zB,{type:n.type,icon:n.icon,size:16,theme:c,style:{fill:c.icon.primary},isDefaultNoticonEnabled:p}),(0,k.jsx)("span",{style:{marginLeft:6,maxWidth:200,...le().RC},children:n.name})]}),right:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Tr().A,{icon:o(613601).arrowUTurnUpLeftSmallIcon,iconStyle:{width:pn().Ev.sm,height:pn().Ev.sm},ariaLabel:m.formatMessage(Zr.undo),onClick:()=>x(t)}),(0,k.jsx)(Tr().A,{icon:zr().trashSmallIcon,iconStyle:{width:pn().Ev.sm,height:pn().Ev.sm},ariaLabel:m.formatMessage(Zr.delete),onClick:()=>{!async function(e,t,o){const{automationActions:n}=await Wr().QV.automations.load();oo().ui({message:(0,k.jsx)(f().sA,{id:"database.viewSettings.deletedPropertiesTab.permanentlyDeleteProperty.modal.prompt",defaultMessage:"Are you sure you want to delete this property?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,k.jsx)(f().sA,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:async()=>{const i=t.collectionStore();if(i){const t=i.getLayoutStore();await(null==t?void 0:t.load()),g().createAndCommit({userAction:"CollectionSettingsDeletedProperties.handlePermanentlyDeleteDeletedPropertyClick",environment:o,canUndo:!0,perform:r=>{Jr(e,o,i,r,n.deleteAutomation,t),(0,Hr().E)({collectionStore:i,update:{[e]:null},transaction:r})}})}}}]})}(t,i,a)}})]})},t)}))})),[i,C,a,x,p,v,c,m]),w=(0,n.useCallback)((()=>0===C.length?null:(0,k.jsx)(ae().A,{topBorder:!0,extraPadding:!0,children:(0,k.jsx)(kt().A,{title:m.formatMessage(Zr.permanentlyDeleteAll),icon:zr().trashSmallIcon,isGray:!0,onClick:()=>{!async function(e,t,o){const{automationActions:n}=await Wr().QV.automations.load();oo().ui({message:(0,k.jsx)(f().sA,{id:"database.viewSettings.deletedPropertiesTab.permanentlyDeleteAll.modal.prompt",defaultMessage:"Are you sure you want to permanently delete all properties?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,k.jsx)(f().sA,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:async()=>{const i=t.collectionStore();if(!i)return;const r=i.getLayoutStore();await(null==r?void 0:r.load()),g().createAndCommit({userAction:"CollectionSettingsDeletedProperties.handlePermanentlyDeleteAllPropertiesClick",environment:o,canUndo:!0,perform:t=>{const l={};e.forEach((e=>{const{propertyId:s}=e;Jr(s,o,i,t,n.deleteAutomation,r),l[s]=null})),(0,Hr().E)({collectionStore:i,update:l,transaction:t})}})}}]})}(C,i,a)}})})),[C,i,a,m]);return(0,k.jsx)(y().Ay,{collectionSettingsStore:t,title:(0,k.jsx)(f().sA,{defaultMessage:"Deleted properties",id:"database.viewSettings.propertyTab.deletedTitle"}),footer:w(),children:b()})}const Yr=n.memo(qr,Ur().A);function Jr(e,t,o,n,i,r){r&&(0,Qr().HD)({environment:t,layoutStore:r,property:e,transaction:n});const l=function(e,t){const o=e.getDeletedSchema(),n=o[t];if((0,In().O9)(n)&&(0,de().nu)(n)&&n.automation_id)return ct().dn.createChildStore(e,{id:n.automation_id,spaceId:e.getSpaceId(),table:Nr().yB})}(o,e);l&&i({automationStore:l,environment:t,transaction:n})}var Xr=()=>o(221844),el=()=>o(852507),tl=()=>o(118884),ol=()=>o(30626),nl=()=>o(760077),il=()=>o(736767),rl=()=>o(852353),ll=()=>o(493260),sl=()=>o(970585);const al=(0,f().YK)({inputPlaceholder:{defaultMessage:"Search for a view…",id:"database.viewSettings.duplicateExistingViewTab.inputPlaceholder"}}),cl=7;function dl(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,i=(0,r().v3)(),s=(0,r().Y0)(),a=(0,S().DP)(),c=(0,n.useMemo)((()=>new(Xr().A)({name:"CollectionSettingsDuplicateExistingView"})),[]),d=(0,l().uB)(void 0,sl().A),[p,g]=(0,n.useState)(""),[m,y]=(0,n.useState)(!0),h=(0,n.useRef)({lastDuplicatedViewId:void 0,didAccept:!1,wentBack:!1,initialViewType:void 0,preselectedViewPointer:void 0}),x=(0,l().O$)(t.collectionSettingsDuplicateExistingViewLimitStore),v=(0,lo().X)("duplicate_existing_view_store"),C=(0,n.useMemo)((()=>v?x:m),[v,x,m]),b=(0,n.useCallback)((e=>{v?t.collectionSettingsDuplicateExistingViewLimitStore.setState(e):y(e)}),[t.collectionSettingsDuplicateExistingViewLimitStore,v]),w=(0,n.useCallback)(((e,o)=>{if(e.id===h.current.lastDuplicatedViewId&&o)return;h.current.lastDuplicatedViewId=e.id;const n=t.collectionViewStore();if(!n)return;let r=n;o&&(r=n.clone(c)),(0,nl().U)({viewToDuplicateStore:e,collectionContextStore:t,collectionViewStore:n,environment:i,temporaryStore:r})}),[t,i,c]);(0,el().w)((()=>{const e=t.collectionViewStore();if(!e)return;const o=(0,ll().v)(e.id);h.current.preselectedViewPointer=null==o?void 0:o.viewPointer,i.defaultRecordCache.inMemoryRecordCache.addCacheOverride(c),h.current.initialViewType=e.getType()})),(0,tl().X)((()=>{const e=h.current;if(i.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(c),!e.didAccept&&!e.wentBack){const{viewStores:o}=pl(t,p,C),n=o.find((t=>t.id===e.lastDuplicatedViewId));if(!n)return;w(n,!1)}}));const j=(0,n.useCallback)((e=>{if(void 0===e)return h.current.lastDuplicatedViewId=void 0,void c.clearCache();w(e,!0)}),[w,c]),A=(0,P().Y)(j,500);(0,l().K8)((()=>{const e=d.state;if(s.isMobile||void 0===e.focus.indexLocal)return;const o=p.length>0;if(!o&&0===e.focus.section||o&&1===e.focus.section)return void A(void 0);const n=pl(t,p,C).viewStores,i=e.focus.indexLocal;if(i<0||i>=n.length)return;const r=n[i];A(r)}),[t,s.isMobile,A,p,C,d]);const _=(0,n.useCallback)((e=>{i.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(c),(0,er().X)({environment:i,collectionContextStore:t,action:"click_duplicate_view"}),w(e,!1),u().R8({collectionSettingsStore:o,item:{type:"main",selectViewNameInitial:!0}}),h.current.didAccept=!0,b(!0)}),[t,o,w,i,b,c]),I=(0,n.useCallback)((()=>{(0,er().X)({environment:i,collectionContextStore:t,action:"click_new_empty_view"}),u().os({collectionSettingsStore:o}),u().a2({collectionSettingsStore:o,item:{type:"createView"}}),h.current.didAccept=!0,b(!0)}),[t,o,i,b]),{viewStores:M,showMore:T}=(0,l().K8)((()=>pl(t,p,C)),[t,p,C]),B=(0,l().K8)((()=>{var e;return function(e){const{theme:t,viewStores:o,showMore:n,preselectedViewPointerId:i,onDuplicateViewAccept:r,onShowMore:l}=e,s=eo().oE(o.map((e=>{const t=e.getType(),o=e.getFormat().collection_view_icon;if(!t||"page"===t)return;const n=e.getName(),l=e.id,s={key:l,render:e=>(0,k.jsx)(Pe().A,{...e,title:(0,k.jsx)(kr().A,{collectionViewType:t,collectionViewName:n}),icon:(0,k.jsx)(Mr().h,{color:"regular",viewIcon:o,viewType:t,style:{marginRight:4,marginLeft:2}}),isChecked:i===l}),action:()=>{r(e)}};return s})));if(n>0){const e={key:"showMore",render:e=>(0,k.jsx)(Pe().A,{...e,icon:(0,ol()._)({width:16,height:16,color:t.text.secondary}),style:{color:t.text.secondary},title:(0,k.jsx)(f().sA,{defaultMessage:"Show {showMore} more",id:"database.viewSettings.duplicateExistingViewTab.showMore.title",values:{showMore:n}})}),action:()=>{l()}};s.push(e)}return s}({viewStores:M,showMore:T,preselectedViewPointerId:null===(e=h.current.preselectedViewPointer)||void 0===e?void 0:e.id,onDuplicateViewAccept:_,onShowMore:()=>{b(!1)},theme:a})}),[_,b,T,a,M]),V=(0,l().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getName()}),[t]),F=(0,n.useCallback)((e=>{g(e),d.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}}),b(!0)}),[d,b]),E=(0,n.useCallback)((()=>{h.current.wentBack=!0,u().yl({collectionSettingsStore:o})}),[o]);return(0,k.jsx)(ul,{collectionSettingsStore:o,collectionName:V,inputValue:p,onInputValueChange:F,menuListItems:B,showMore:T,initialViewType:h.current.initialViewType,menuListStore:d,onNewEmptyViewClick:I,onBackArrowClick:E})}function ul(e){const{collectionSettingsStore:t,collectionName:o,inputValue:i,menuListItems:l,showMore:s,initialViewType:a,menuListStore:c,onNewEmptyViewClick:d,onBackArrowClick:u,onInputValueChange:p}=e,g=(0,r().Y0)(),m=(0,S().IS)((e=>({plusIconStyle:{color:e.icon.secondary}})),[]),h=(0,n.useMemo)((()=>{const e=a?rl().to[a].toLocaleLowerCase():void 0;return e?(0,k.jsx)(f().sA,{defaultMessage:"New {viewType} view",id:"database.viewSettings.createViewTab.newView1",values:{viewType:e}}):(0,k.jsx)(f().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView2"})}),[a]),v=(0,n.useMemo)((()=>({key:"emptyViewSection",items:[{key:"emptyViewMenuItem",render:e=>(0,k.jsx)(kt().A,{...e,icon:x().plusIcon,iconStyle:m.plusIconStyle,title:h}),action:d}],render:e=>(0,k.jsx)(ae().A,{topBorder:i.length>0,...e})})),[h,i.length,d,m.plusIconStyle]);return(0,k.jsxs)(y().Ay,{collectionSettingsStore:t,title:(0,k.jsx)(f().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"}),handleBackArrowClick:u,children:[s>0||i?(0,k.jsx)(ae().A,{children:(0,k.jsx)(Be().Ay,{focusInitial:!g.isMobile||void 0,value:i,onChange:e=>{p(e.target.value)},placeholder:jt().A.formatMessage(al.inputPlaceholder),showClearButton:!0})}):null,(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:0,sections:eo().oE([i.length?void 0:v,{key:"results",render:e=>0===l.length?(0,k.jsx)(il().A,{caption:(0,k.jsx)(f().sA,{defaultMessage:"No results",id:"database.viewSettings.duplicateExistingViewTab.noResultsTitle"})}):(0,k.jsx)(ae().A,{title:o?(0,k.jsx)(f().sA,{defaultMessage:"Views on {collectionName}",id:"database.viewSettings.duplicateExistingViewTab.viewsTitle",values:{collectionName:o}}):(0,k.jsx)(f().sA,{defaultMessage:"Existing views",id:"database.viewSettings.duplicateExistingViewTab.viewsTitleExistingViews"}),...e}),items:l},i.length?v:void 0]),store:c})]})}function pl(e,t,o){const n=e.collectionViewBlockStore(),i=e.collectionStore(),r=e.collectionViewStore();if(!n||!i||!r)return{viewStores:[],showMore:0};const l=i.getParentBlockStore();if(!n||!l)return{viewStores:[],showMore:0};let s=(0,wi().Mf)({collectionStore:i,sourceCollectionViewBlockStore:l,currentCollectionViewBlockStore:n,currentCollectionViewStore:r,constraints:(0,ll().v)(r.id)}),a=0;return t?s=s.filter((e=>(0,wi().As)(e,t))):o&&(a=s.length-cl,s=s.slice(0,cl)),{viewStores:s,showMore:a}}var gl=()=>o(158797),ml=()=>o(875909),Sl=()=>o(362750),fl=()=>o(612740),yl=()=>o(116089),hl=()=>o(236262),xl=()=>o(416726),vl=()=>o(583289),Cl=()=>o(495262),bl=()=>o(272200),wl=()=>o(312540),jl=()=>o(419167),Al=()=>o(364280),_l=()=>o(135221),Il=()=>o(186445),Ml=()=>o(68465),kl=()=>o(71304),Tl=()=>o(937199),Pl=()=>o(227440),Bl=()=>o(411671),Vl=()=>o(807778),Fl=()=>o(329304),El=()=>o(864913),Rl=()=>o(84262),Dl=()=>o(35091);const Kl=(0,f().YK)({autoUpdateExplanationMessage:{defaultMessage:"Keep values updated with the latest edits to pages",id:"database.CollectionSettingsPropertyAiAutofill.autoUpdateExplanationMessage"},onlyWithAiAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"database.CollectionSettingsPropertyAiAutofill.onlyWithAiAddOnMessage"},onlyWithAiUpgradeMessage:{defaultMessage:"Only with upgraded Notion AI",id:"database.CollectionSettingsPropertyAiAutofill.onlyWithAiUpgradeMessage"},updateOnPageEdits:{defaultMessage:"Auto-update on page edits",id:"database.viewSettings.propertyTab.aiAutofill.updateOnPageEdits"}});function Ol(e){let{collectionContextStore:t,environment:o,setAiInference:i,aiInference:r,autofillFeatureAvailability:l}=e;const s=(0,n.useRef)(I().JW()),a=(0,lo().X)("packaging_changes_05_13_2025"),c=(0,n.useCallback)((()=>{if(!t.collectionStore())return;if(!r)return;if(!((0,Fl().e2)(l)||null!=r&&r.auto_update_on_edit))return void wl().triggerAiAutofillUpsell({environment:o,from:"ai_autofill_on_page_edit",upsell:l.upsell});const e={...r,auto_update_on_edit:!r.auto_update_on_edit};i(e)}),[t,r,l,i,o]);return r?(0,k.jsx)(Ie().A,{renderTooltip:()=>(0,k.jsxs)("div",{style:{width:a?169:159},children:[(0,k.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,k.jsx)(f().sA,{...Kl.autoUpdateExplanationMessage})}),(0,Rl().Vi)(l,(()=>(0,k.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:a?(0,k.jsx)(f().sA,{...Kl.onlyWithAiUpgradeMessage}):(0,k.jsx)(f().sA,{...Kl.onlyWithAiAddOnMessage})})))]}),render:e=>(0,k.jsx)(Dl().A,{title:(0,k.jsx)(f().sA,{...Kl.updateOnPageEdits}),showChevron:!1,switcherProps:{inputId:s.current,on:Boolean(r.auto_update_on_edit),noColor:!1},onClick:c,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})}):null}var Ll=()=>o(693954),zl=()=>o(805751),Nl=()=>o(255824);const Ul=(0,f().YK)({extractPromptSectionTitle:{defaultMessage:"What key info to extract?",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptSectionTitle"},customPromptSectionTitle:{defaultMessage:"What to generate?",id:"database.viewSettings.propertyTab.aiAutofill.customPromptSectionTitle"},extractPromptInputPlaceholder:{defaultMessage:"e.g. “Key topics in bullets” or “People mentioned on the page”",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptInputPlaceholder"},customPromptInputPlaceholder:{defaultMessage:"Tell AI what to generate from page content and properties…",id:"database.viewSettings.propertyTab.aiAutofill.customPromptInputPlaceholder"}});function Wl(e){var t;let{environment:o,aiInference:i,setAiInference:r,collectionContextStore:s,isAutofillSetupEnabled:a,shouldShowUserPromptIsInvalidError:c,setShouldShowUserPromptIsInvalidError:d}=e;const u=function(e){if(!e)return;switch(e.type){case"summarize":case"translate":return;case"extract":return{aiInferenceType:e.type,sectionTitle:Ul.extractPromptSectionTitle,inputPlaceholder:Ul.extractPromptInputPlaceholder,value:e.prompt};case"custom":case"select":case"multi_select":return{aiInferenceType:e.type,sectionTitle:Ul.customPromptSectionTitle,inputPlaceholder:Ul.customPromptInputPlaceholder,value:e.prompt};default:(0,In().HB)(e)}}(i),p=(0,l().K8)((()=>{var e;return(0,rl().hn)({environment:o,spaceId:null===(e=s.collectionStore())||void 0===e?void 0:e.getSpaceId(),userId:o.currentUser.id})}),[o,s]),g=(0,n.useCallback)((e=>{if(s.collectionStore()&&u)switch(e.target.value&&e.target.value.length<=Sl().oV?d(!1):e.target.value.length>Sl().oV&&d(!0),u.aiInferenceType){case"extract":case"custom":r({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??p});break;case"select":case"multi_select":r({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??p,add_options:((null==i?void 0:i.type)===u.aiInferenceType&&(null==i?void 0:i.add_options))??!1});break;case"summarize":case"translate":return;default:(0,In().HB)(u.aiInferenceType)}}),[i,s,p,u,r,d]),m=(0,Nl().a)(),y=(0,S().IS)((e=>({inputOuterStyle:{margin:o.device.isMobile?"8px 0":0,border:c?"1px solid red":void 0,backgroundColor:m?e.white:void 0}})),[o.device.isMobile,m,c]);return u?(0,k.jsxs)(ae().A,{title:jt().A.formatMessage(u.sectionTitle),isInput:!0,style:{marginTop:-4},children:[(0,k.jsx)(zl().A,{debugName:"CollectionSettingsAiAutofillPromptInput",capture:!0,allowEsc:!0,children:(0,k.jsx)(Be().Ay,{inputOuterStyle:y.inputOuterStyle,type:"text",value:u.value||"",onChange:g,placeholder:jt().A.formatMessage(u.inputPlaceholder),textarea:!0,disabled:!a,autosize:!0,autosizeMinHeight:100,autosizeMaxHeight:600},u.aiInferenceType)}),c&&(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:12,fontSize:12},children:[(0,Ll().Q)({width:12,height:12,fill:"#D34F43"}),(0,k.jsx)("div",{style:{color:"#D34F43",paddingLeft:4},children:((null===(t=u.value)||void 0===t?void 0:t.length)??0)>Sl().oV?(0,k.jsx)(f().sA,{defaultMessage:"Instruction is too long",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.exceedsMaxLength"}):(0,k.jsx)(f().sA,{defaultMessage:"Required",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.required"})})]})]}):null}function Hl(e){const{collectionContextStore:t,isAutofillSetupEnabled:o,draftAiInference:n,setDraftAiInference:i,environment:r,shouldShowUserPromptIsInvalidError:l,setShouldShowUserPromptIsInvalidError:s,autofillFeatureAvailability:a}=e;return n?"select"!==n.type&&"multi_select"!==n.type?null:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(ae().A,{style:{marginBottom:10},children:[(0,k.jsx)(Ol,{collectionContextStore:t,environment:r,setAiInference:i,aiInference:n,autofillFeatureAvailability:a}),(0,k.jsx)(El().A,{setAiInference:i,aiInference:n})]}),n&&(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(Wl,{environment:r,aiInference:n,setAiInference:i,collectionContextStore:t,isAutofillSetupEnabled:o,shouldShowUserPromptIsInvalidError:l,setShouldShowUserPromptIsInvalidError:s})})]}):null}var $l=()=>o(474587),Gl=()=>o(831310),Ql=()=>o(742117),Zl=()=>o(64e3),ql=()=>o(495159);const Yl=new(L().A),Jl=(0,f().YK)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},whatToTranslate:{defaultMessage:"What to translate?",id:"CollectionSettingsPropertyAiAutofill.translateProperty.propertySelector"},translateTo:{defaultMessage:"Translate to",id:"CollectionSettingsPropertyAiAutofill.translateProperty.languageSelector"},selectorSearchPlaceholder:{defaultMessage:"Search",id:"CollectionSettingsPropertyAiAutofill.selectorOption.searchbar.placeholder"},allProperties:{defaultMessage:"All properties",id:"CollectionSettingsPropertyAiAutofill.selectorOption.allProperties.checkbox"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function Xl(e){const{collectionContextStore:t,propertySchema:o,previousPromptByAiInferenceType:i,isAutofillSetupEnabled:r,draftAiInference:s,setDraftAiInference:a,environment:c,propertyId:d,collectionSchema:u,shouldShowUserPromptIsInvalidError:p,setShouldShowUserPromptIsInvalidError:g,autofillFeatureAvailability:m}=e,f=(0,S().DP)(),y=(0,n.useMemo)((()=>[new(L().A),new(L().A)]),[]),h=(0,n.useMemo)((()=>function(e){var t;let{environment:o,aiInference:n,collectionSchema:i,setAiInference:r,property:l,theme:s,optionsButtonPopupStores:a}=e;if(!n||!(0,de().UH)(n.type))return[];switch(n.type){case"summarize":case"extract":case"custom":return[];case"translate":const e=eo().oE((0,In().uv)(i).map((e=>{if(e===l)return;const t=i[e];if(t&&(0,$l().jm)(t)){var o;if("text"===t.type&&"translate"===(null===(o=t.ai_inference)||void 0===o?void 0:o.type))return;return{id:e,option:t.name,icon:(0,k.jsx)(ue().zB,{icon:t.icon,type:t.type,theme:s,size:16})}}}))),o=e.findIndex((e=>"title"===e.id));if(o&&o>0){const t=e[o];e.splice(o,1),e.unshift(t)}for(;a.length<2;)a.push(new(L().A));return[{type:"multi",options:e,selectedIds:(null===(t=n.targetProperties)||void 0===t?void 0:t.length)>0?n.targetProperties:["title"],setSelectedIds:e=>{r({...n,targetProperties:e})},selectorTitle:Jl.whatToTranslate,selectAllTitle:Jl.allProperties,buttonPopupStore:a[0]},{type:"single",options:$l().nP.map((e=>{let{key:t,name:o}=e;return{id:t,option:jt().A.formatMessage(o)}})),selectedId:n.toLanguage,onSelect:e=>{r({...n,toLanguage:e})},selectorTitle:Jl.translateTo,buttonPopupStore:a[1]}];default:(0,In().HB)(n)}}({environment:c,aiInference:s,collectionSchema:u,setAiInference:a,property:d,theme:f,optionsButtonPopupStores:y})),[c,s,u,a,d,f,y]),x=(0,l().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[t]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(ae().A,{style:{marginBottom:10,display:"flex",gap:8},children:[(0,k.jsx)(es,{spaceId:x,propertySchema:o,previousPromptByAiInferenceType:i,draftAiInference:s,setDraftAiInference:a,environment:c}),(0,de().bB)(s,"text")&&(0,k.jsx)(Ol,{collectionContextStore:t,environment:c,setAiInference:a,aiInference:s,autofillFeatureAvailability:m})]}),(0,de().bB)(s,"text")&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(Wl,{environment:c,aiInference:s,setAiInference:a,collectionContextStore:t,isAutofillSetupEnabled:r,shouldShowUserPromptIsInvalidError:p,setShouldShowUserPromptIsInvalidError:g})}),(0,k.jsx)(os,{environment:c,optionProps:h})]})]})}function es(e){let{spaceId:t,propertySchema:o,previousPromptByAiInferenceType:i,draftAiInference:s,setDraftAiInference:a,environment:c}=e;const d=(0,l().K8)((()=>(0,rl().hn)({environment:c,userId:c.currentUser.id,spaceId:t})),[c,t]),u=(0,n.useCallback)((e=>{var t,n,r,l,s,c,u,p;if(!o||!(0,de().$M)(o)||!e)return;let g;switch(e){case"summarize":g={type:e,auto_update_on_edit:d};break;case"translate":g={type:e,auto_update_on_edit:d,targetProperties:(null===(t=o.ai_inference)||void 0===t?void 0:t.type)===e?null===(n=o.ai_inference)||void 0===n?void 0:n.targetProperties:["title"],toLanguage:(null===(r=o.ai_inference)||void 0===r?void 0:r.type)===e?null===(l=o.ai_inference)||void 0===l?void 0:l.toLanguage:"english"};break;case"extract":g={type:e,prompt:(null===(s=o.ai_inference)||void 0===s?void 0:s.type)===e?null===(c=o.ai_inference)||void 0===c?void 0:c.prompt:i[e]??"",auto_update_on_edit:d};break;case"custom":g={type:e,prompt:(null===(u=o.ai_inference)||void 0===u?void 0:u.type)===e?null===(p=o.ai_inference)||void 0===p?void 0:p.prompt:i[e]??"",auto_update_on_edit:d};break;default:(0,In().HB)(e)}a(g)}),[d,i,o,a]),p=(0,S().DP)(),{isMobile:g}=(0,r().Y0)(),m=(0,S().IS)((e=>({checkedIcon:{fill:e.icon.primary,height:g?16:12,width:g?16:12},buttonOutlineStyle:{borderTop:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,paddingTop:12,paddingBottom:12}})),[g]);return o&&(0,de().$M)(o)?(0,k.jsx)(kt().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Fill with",id:"CollectionSettingsPropertyAiAutofill.ClosedSelector.Title"}),right:(0,k.jsx)(b().Ay,{originGap:8,popupType:c.device.isMobile?b().z7.BottomSheet:b().z7.Popup,buttonPopupStore:Yl,render:e=>{const t={key:"section",render:e=>(0,k.jsx)(ae().A,{...e}),items:eo().oE(Object.keys(ql().vr.text).map(((t,o,n)=>{if((0,de().UH)(t))return{key:t,render:e=>{const i=ql().vr.text[t];return(0,k.jsx)(kt().A,{focused:!1,buttonStyle:g?{...m.buttonOutlineStyle,borderBottom:o===n.length-1?`1px solid ${p.outlineButtonBorder}`:void 0}:void 0,onClick:e.onClick,title:(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:g?18:void 0},children:[i.svg({height:g?20:16,width:g?24:16,fill:p.aiPurpleColor,marginRight:6}),jt().A.formatMessage(i.name)]}),right:(null==s?void 0:s.type)===t&&(0,Gl().o)(m.checkedIcon)})},action:()=>{e.close(),u(t)}}})))};return(0,k.jsx)(zt().A,{menuType:Ut().gu.Popup,minWidth:260,maxWidth:"100vw",children:(0,k.jsx)(_e().Ay,{style:{marginTop:g?8:void 0},type:_e().Oh.Vertical,initialFocus:0,sections:[t]})})},renderOrigin:e=>(0,k.jsx)("div",{...e,style:{userSelect:"none"},children:(0,k.jsx)(ts,{aiActionType:null==s?void 0:s.type})})})}):null}function ts(e){let{aiActionType:t}=e;const o=t&&(0,de().UH)(t)?ql().vr.text[t]:{name:Jl.noAiAutofillSelected,svg:()=>null},{isMobile:n}=(0,r().Y0)(),i=(0,S().IS)((e=>({wrapper:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:n?18:14,paddingLeft:15,paddingBottom:0},selectedOptionWrapper:{color:e.icon.tertiary},selectedOptionSvg:{height:16,width:16,marginRight:2},selectedOptionText:{color:e.text.tertiary,paddingLeft:4},selectedOptionChevron:{color:e.icon.tertiary,paddingLeft:4}})),[n]);return(0,k.jsxs)("div",{style:i.wrapper,children:[(0,k.jsx)("div",{style:i.selectedOptionWrapper,children:o.svg(i.selectedOptionSvg)}),(0,k.jsx)("div",{style:i.selectedOptionText,children:(0,k.jsx)(f().sA,{...o.name})}),(0,k.jsx)("div",{style:i.selectedOptionChevron,children:(0,Ql().V)({height:12,width:12})})]})}function os(e){let{environment:t,optionProps:o}=e;return o&&o.length>0?(0,k.jsx)(ae().A,{title:jt().A.formatMessage(Jl.optionsSectionTitle),isInput:!0,style:{marginTop:-4},children:o.map(((e,o)=>"multi"===e.type?(0,k.jsx)(ns,{environment:t,options:e.options,selectedIds:e.selectedIds,setSelectedIds:e.setSelectedIds,selectorTitle:e.selectorTitle,selectAllTitle:e.selectAllTitle,buttonPopupStore:e.buttonPopupStore},o):(0,k.jsx)(is,{environment:t,options:e.options,selectedId:e.selectedId,onSelect:e.onSelect,selectorTitle:e.selectorTitle,buttonPopupStore:e.buttonPopupStore},o)))}):null}function ns(e){let{environment:t,options:o,selectedIds:i,setSelectedIds:r,selectorTitle:s,selectAllTitle:a,buttonPopupStore:c}=e;const[d,u]=(0,n.useState)(""),p=(0,S().DP)(),g=o.filter((e=>i.includes(e.id))),m=(0,l().K8)((()=>eo().sb(eo().Ul(o.map((e=>e.id)))).join(",")===eo().sb(eo().Ul(i)).join(",")),[o,i]),y=e=>{i.includes(e)?r(i.filter((t=>t!==e))):r(eo().sb([...i,e]))},h=()=>{i.length<o.length?r(o.map((e=>e.id))):r(["title"])},x=(0,k.jsx)(ae().A,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,k.jsx)(Be().Ay,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:d,onChange:e=>{u(e.target.value)},placeholder:jt().A.formatMessage(Jl.selectorSearchPlaceholder)})});return(0,k.jsx)(b().Ay,{popupType:t.device.isMobile?b().z7.SlideUp:b().z7.Popup,buttonPopupStore:c,render:e=>{const t=o.filter((e=>{var t;const o=null===(t=e.option)||void 0===t?void 0:t.toLowerCase();return-1!==(null==o?void 0:o.indexOf(d.toLowerCase()))})).map((e=>{let{id:t,option:o,icon:n}=e;return{key:t,render:e=>(0,k.jsx)(Pe().A,{focused:!1,onClick:e.onClick,left:(0,k.jsx)(Ee().T,{checked:i.includes(t),size:14,onClick:e=>{y(t)}}),icon:n,title:o}),action:()=>{y(t)}}})),n={key:"section",render:e=>(0,k.jsx)(ae().A,{...e,topBorder:!0}),items:t},r={key:"all-items",render:e=>(0,k.jsx)(ae().A,{...e}),items:[{key:"all-items",render:e=>(0,k.jsx)(Pe().A,{focused:!1,onClick:()=>{h()},left:(0,k.jsx)(Ee().T,{checked:m,size:14,onClick:()=>{h()}}),title:jt().A.formatMessage(a)}),action:()=>{h()}}]};return(0,k.jsxs)(zt().A,{menuType:Ut().gu.Popup,minWidth:260,maxWidth:"100vw",children:[x,0===t.length?(0,k.jsx)(ae().A,{children:(0,k.jsx)(Zl().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:void 0,sections:[r,n]})]})},renderOrigin:e=>(0,k.jsx)(kt().A,{title:jt().A.formatMessage(s),showChevron:!0,right:(0,k.jsx)("div",{style:{color:p.text.tertiary,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:eo().oE(g.map((e=>{let{id:t,option:o,icon:n}=e;return o}))).join(", ")}),rightStyle:{flexShrink:1},rotateChevron:c.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}function is(e){let{environment:t,options:o,selectedId:i,onSelect:r,selectorTitle:l,buttonPopupStore:s}=e;const[a,c]=(0,n.useState)(""),d=o.find((e=>e.id===i)),u=(0,S().DP)(),p=(0,k.jsx)(ae().A,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,k.jsx)(Be().Ay,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:a,onChange:e=>{c(e.target.value)},placeholder:jt().A.formatMessage(Jl.selectorSearchPlaceholder)})});return(0,k.jsx)(b().Ay,{popupType:t.device.isMobile?b().z7.SlideUp:b().z7.Popup,buttonPopupStore:s,render:e=>{const t=o.filter((e=>{var t;return-1!==(null===(t=e.option)||void 0===t?void 0:t.toLowerCase().indexOf(a.toLowerCase()))})).map((t=>{let{id:o,option:n,icon:l}=t;return{key:o,render:e=>(0,k.jsx)(Pe().A,{focused:!1,onClick:e.onClick,icon:l,title:n,isChecked:o===i}),action:()=>{e.close(),r(o)}}})),n={key:"section",render:e=>(0,k.jsx)(ae().A,{...e}),items:t};return(0,k.jsxs)(zt().A,{menuType:Ut().gu.Popup,minWidth:260,maxWidth:"100vw",children:[p,0===t.length?(0,k.jsx)(ae().A,{children:(0,k.jsx)(Zl().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:void 0,sections:[n]})]})},renderOrigin:e=>(0,k.jsx)(kt().A,{title:jt().A.formatMessage(l),showChevron:!0,right:d&&(0,k.jsxs)(k.Fragment,{children:[d.icon,(0,k.jsx)("div",{style:{color:u.text.tertiary,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:d.option})]}),rightStyle:{flexShrink:1},rotateChevron:s.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}const rs=(0,f().YK)({removeAutofillButton:{defaultMessage:"Turn off AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.removeAutofillButton"},toggleFillWithAiSectionLabel:{defaultMessage:"Actions",id:"database.viewSettings.propertyTab.aiAutofill.actionsSectionLabel"}});function ls(e){const{property:t,collectionContextStore:o,collectionSettingsStore:i}=e,s=(0,l().K8)((()=>o.normalizedSchemaStore.state[t]),[t,o.normalizedSchemaStore]),a=(0,l().K8)((()=>o.collectionStore()),[o]),c=(0,l().K8)((()=>o.normalizedSchemaStore.getState()),[o]),d=s&&(0,de().$M)(s)?(0,de().om)(s):void 0,p=(0,r().v3)(),m=(0,f().tz)(),S=as(),h=(0,l().K8)((()=>{const e=o.collectionStore();return e&&(0,Ml().jq)(p,Bl().A.getMode(p,e),e)}),[p,o]),x=yr().Store.createValue({stage:"not_started"},{name:"tryAutofillStore"});(0,n.useEffect)((()=>{var e,n;if("page"===o.getViewType())return;if(!1!==(null===(e=o.getPropertyFormat(t))||void 0===e?void 0:e.visible))return;const i=new(Xr().A)({name:"CollectionSettingsPropertyAiAutofill"});p.defaultRecordCache.inMemoryRecordCache.addCacheOverride(i);const r=null===(n=o.formatStore())||void 0===n?void 0:n.clone(i),l=o.getPropertyFormatKey();return r&&l&&g().createAndCommit({userAction:"CollectionSettingsPropertyAiAutofill.open",environment:p,canUndo:!0,perform:e=>{ve().a5({formatStore:r,formatKey:l,property:t,update:{visible:!0},transaction:e})}}),()=>{p.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i)}}),[o,p,t]);const v=(0,n.useRef)({}),C=(0,l().K8)((()=>{var e;return(0,rl().hn)({environment:p,spaceId:null===(e=o.collectionStore())||void 0===e?void 0:e.getSpaceId(),userId:p.currentUser.id})}),[p,o]),[b,w]=(0,n.useState)(s&&wl().getDefaultAiInference(s,C)),[j,_]=(0,n.useState)(!1),I=(0,n.useCallback)((()=>{const e=o.collectionStore();if(!e||!s||!(0,de().$M)(s))return;const n=(0,de().om)(s);n&&"prompt"in n&&(v.current={...v.current,[n.type]:n.prompt}),wl().saveOrRemovePropertyAiInference({environment:p,propertySchema:s,collectionStore:e,property:t,draftAiInference:b})}),[o,s,b,t,p]),M=(0,l().K8)((()=>{const e=o.collectionStore();return e?(0,kl().tS)({environment:p,intl:m,store:e}):(0,fl().L)(m)}),[o,p,m]),T=(0,l().K8)((()=>"page"===o.getViewType()),[o]),P=(0,n.useCallback)((async()=>{if(s&&(0,de().$M)(s)&&eo().n4(b,(0,de().om)(s)))u().os({collectionSettingsStore:i});else if(b){var e;if("prompt"in b)if((0,de().qD)(b)&&0===(null===(e=b.prompt)||void 0===e?void 0:e.length)||(0,In().O9)(b.prompt)&&b.prompt.length>Sl().oV)return void _(!0);(null==d||!d.auto_update_on_edit)&&null!=b&&b.auto_update_on_edit&&C&&s?await vl().U({sourceAction:"auto_update",propertyName:s.name,collectionName:M})&&I():I()}}),[M,i,d,b,I,C,s]),B=(0,n.useCallback)((()=>{const e=o.collectionStore();e&&d&&s&&(wl().saveOrRemovePropertyAiInference({environment:p,propertySchema:s,collectionStore:e,property:t,draftAiInference:null}),u().yl({collectionSettingsStore:i}))}),[o,d,p,s,t,i]),V=s&&(0,de().$M)(s)&&eo().n4(b,(0,de().om)(s)),F=(0,n.useCallback)((async()=>new Promise((e=>{oo().ui({showCancel:!1,keepFocus:!1,message:(0,k.jsxs)(Al().VP,{alignItems:"center",gap:8,children:[(0,yl().x)(S.confirmDiscardChangesDialogIconStyle),(0,k.jsx)("div",{style:S.confirmDiscardChangesDialogMessageStyle,children:(0,k.jsx)(f().sA,{defaultMessage:"Do you want to discard changes for AI autofill?",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.message"})})]}),items:[{label:(0,k.jsx)(f().sA,{defaultMessage:"Discard",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.acceptLabel"}),color:"red",onAccept:()=>e(!0)},{label:(0,k.jsx)(f().sA,{defaultMessage:"Continue editing",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.cancelLabel"}),onAccept:()=>e(!1)}]})}))),[S]),E=(0,n.useCallback)((async()=>{(V||await F())&&u().yl({collectionSettingsStore:i})}),[V,i,F]),R=(0,n.useCallback)((async()=>{(V||await F())&&u().os({collectionSettingsStore:i})}),[V,i,F]),{spaceId:D,userId:K}=(0,l().K8)((()=>{var e,t;return{spaceId:null===(e=ce().default.state.currentSpaceStore)||void 0===e?void 0:e.id,userId:null===(t=ce().default.state.currentUserStore)||void 0===t?void 0:t.id}}),[]),O=(0,Fl()._X)({name:"collection_property_autofill",spaceId:D,userId:K,amount:"unknown"});return s&&(0,de().$M)(s)&&a?(0,k.jsx)(G().A,{debugName:"CollectionSettingsPropertyAiAutofill",capture:!0,onEsc:R,children:(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Fill “{propertyName}” with AI",id:"database.viewSettings.propertyTab.aiAutofill.title",values:{propertyName:s.name}}),handleBackArrowClick:E,handleClose:R,children:[!h&&(0,k.jsx)(ae().A,{style:S.menuItemStyle,children:(0,k.jsx)(f().sA,{defaultMessage:"You don't have permission to set up AI autofill on this database.",id:"database.viewSettings.propertyTab.aiAutofill.noSetupPermission"})}),O&&"text"===s.type&&(0,k.jsx)(Xl,{collectionContextStore:o,propertySchema:s,previousPromptByAiInferenceType:v.current,isAutofillSetupEnabled:Boolean(h),draftAiInference:b,setDraftAiInference:w,environment:p,propertyId:t,collectionSchema:c,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:_,autofillFeatureAvailability:O}),O&&(0,de().lx)(s)&&(0,k.jsx)(Hl,{collectionContextStore:o,isAutofillSetupEnabled:Boolean(h),draftAiInference:b,setDraftAiInference:w,environment:p,shouldShowUserPromptIsInvalidError:j,setShouldShowUserPromptIsInvalidError:_,autofillFeatureAvailability:O}),(0,de().bB)(b,s.type)&&(0,k.jsxs)(ae().A,{children:[(0,k.jsx)(ss,{environment:p,isAutofillSetupEnabled:h,collectionContextStore:o,tryAutofillStore:x,propertySchema:s,property:t,aiInference:b}),(0,k.jsx)(A().A,{style:{...S.buttonStyle,margin:"8px 12px 12px 12px",display:V?"none":"flex"},onClick:P,disabled:!h,children:V?(0,k.jsx)(f().sA,{defaultMessage:"Done",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonAllSaved"}):(0,k.jsx)(f().sA,{defaultMessage:"Save changes",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonWithChanges"})})]}),(0,k.jsxs)(ae().A,{topBorder:!0,title:p.device.isMobile&&jt().A.formatMessage(rs.toggleFillWithAiSectionLabel),children:[O&&(0,de().bB)(d,s.type)&&(0,k.jsxs)(k.Fragment,{children:[!T&&(0,k.jsx)(jl().Ve,{environment:p,collectionContextStore:o,collectionStore:a,property:t,propertySchema:s,autofillFeatureAvailability:O,isAutofillSetupEnabled:Boolean(h)}),(0,k.jsx)(kt().A,{icon:hl().trashIcon,isRed:!0,focused:!1,title:jt().A.formatMessage(rs.removeAutofillButton),onClick:B,disabled:!h})]}),(0,k.jsx)(xr().A,{href:(0,ro().xS)("guides.aiAutofill"),title:(0,k.jsx)(f().sA,{defaultMessage:"Learn about AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.learnMoreLink"}),analyticsFrom:"collection_ai_autofill_menu"})]})]})}):null}function ss(e){let{environment:t,isAutofillSetupEnabled:o,collectionContextStore:i,tryAutofillStore:r,propertySchema:s,property:a,aiInference:c}=e;const[d,u]=(0,n.useState)(I().JW()),p=(0,n.useRef)(I().JW()),g=(0,l().K8)((()=>r.state.stage),[r]),m=(0,l().K8)((()=>{const e=i.contextType;if("collectionPage"===e)return{type:"page",candidateBlockStores:eo().oE([(0,Il().ao)()])};if("collectionTypedView"===e||"collectionView"===e)return{type:"collection",candidateBlockStores:i.resultsInViewOrder(5)};throw new Error(`Unexpected context type: ${e}`)}),[i]),S=(0,n.useCallback)((()=>{var e;bl().trackAiAutofillAction(t,{ai_inference_type:c.type,type:"undo_from_collection_settings",inference_id:d,collection_id:null===(e=i.collectionStore())||void 0===e?void 0:e.id,session_id:p.current}),"not_started"!==g&&(Cl().tN({environment:t}),r.setState({stage:"not_started"}))}),[t,c,d,i,g,r]),y=!(0,l().O$)(Pl().e),{spaceId:h,userId:x}=(0,l().K8)((()=>{var e;return{spaceId:null===(e=i.collectionStore())||void 0===e?void 0:e.getSpaceId(),userId:i.getCurrentUserId()}}),[i]),v=(0,Fl()._X)({name:"collection_property_autofill",spaceId:h,userId:x,amount:5}),C=(0,In().EI)(m.candidateBlockStores),b=as({isTryAutofillEnabled:o&&C}),w=Boolean((0,n.useContext)(Tl().sf)),j=(0,l().K8)((()=>(0,Vl().Le)()),[]);if(t.device.isMobile||w)return null;let A;return A=(0,Fl().e2)(v)?C?"collection"===m.type?(0,k.jsx)(f().sA,{defaultMessage:"Updates the first {maxPages} pages. You can undo changes anytime.",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollectionDescription",values:{maxPages:5}}):(0,k.jsx)(f().sA,{defaultMessage:'Updates "{propertyName}" on this page. You can undo changes anytime.',id:"database.viewSettings.propertyTab.aiAutofill.tryOnPageDescription",values:{propertyName:s.name}}):(0,k.jsx)(f().sA,{defaultMessage:"Add more pages or remove filters to try AI on this view.",id:"database.viewSettings.propertyTab.tryAutofillDisabledDescription"}):j?(0,k.jsx)(f().sA,{defaultMessage:"Upgrade Notion AI to try AI on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryAutofillDisableAIUpsellDescription"}):(0,k.jsx)(f().sA,{defaultMessage:"Get the AI add-on to try AI on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryAutofillDisabledDescription"}),(0,k.jsx)("div",{style:{margin:"8px 12px"},children:(0,k.jsxs)(Al().fI,{gap:8,children:[(0,k.jsx)(D().p,{disabled:!o||!C,style:{...b.buttonStyle,...b.undoButtonStyle,..."not_started"===g&&{display:"none"}},onClick:S,children:(0,k.jsx)(f().sA,{defaultMessage:"Undo",id:"database.viewSettings.propertyTab.aiAutofill.undoButton"})}),(0,k.jsx)(Ie().A,{renderTooltip:()=>y?(0,k.jsx)("div",{children:(0,k.jsx)(f().sA,{...xl().AY.aiUnavailableOfflineTooltip})}):(0,k.jsx)("div",{children:A}),render:e=>(0,k.jsx)(D().p,{...e,disabled:!o||!C||y||!(0,Fl().e2)(v),style:{...b.buttonStyle,...b.tryButtonStyle},hoveredStyle:b.tryButtonHoveredStyle,pressedStyle:b.tryButtonPressedStyle,onClick:async()=>{if(!v||(0,Fl().e2)(v)){if((0,In().EI)(m.candidateBlockStores)){const e=I().JW();u(e),r.setState({stage:"in_progress"}),await wl().autofillPropertyForBlocks({environment:t,stores:m.candidateBlockStores,property:a,propertySchema:s,aiInferenceOverride:c,userEventForAnalytics:"generate_from_try_on_view_button",sessionIdForAnalytics:p.current,collectionContextStore:i,from:"ai_autofill_settings"}),r.setState({stage:"complete"})}}else wl().triggerAiAutofillUpsell({environment:t,from:"ai_autofill_try_on_view",upsell:v.upsell})},children:"in_progress"===g?(0,k.jsx)(_l().A,{}):(0,k.jsxs)(k.Fragment,{children:[(0,yl().x)({width:16,..."not_started"!==g&&{display:"none"}}),"not_started"!==g?(0,k.jsx)(f().sA,{defaultMessage:"Try again",id:"database.viewSettings.propertyTab.aiAutofill.tryAgain"}):"collection"===m.type?(0,k.jsx)(f().sA,{defaultMessage:"Try on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollection"}):(0,k.jsx)(f().sA,{defaultMessage:"Try on this page",id:"database.viewSettings.propertyTab.aiAutofill.tryOnPage"})]})})})]})})}function as(e){const t=(0,S().DP)();return(0,S().IS)((()=>({buttonStyle:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8},menuItemStyle:{fontSize:13,borderRadius:6,background:t.palette.purple[50],color:t.palette.purple[500],margin:"8px 12px",padding:"8px 12px"},undoButtonStyle:{border:`1px solid ${t.palette.gray[100]}`,flex:1},tryButtonStyle:{fontWeight:500,flex:1,background:null!=e&&e.isTryAutofillEnabled?"light"===t.mode?t.palette.purple[50]:t.palette.purple[200]:t.palette.gray[75],color:null!=e&&e.isTryAutofillEnabled?t.aiPurpleColor:t.palette.gray[400]},fillAllPagesWandIconStyle:{fill:t.aiPurpleColor},tryButtonHoveredStyle:{background:t.palette.purple[100]},tryButtonPressedStyle:{background:t.palette.purple[200]},confirmDiscardChangesDialogIconStyle:{width:32,height:32,fill:t.aiPurpleColor,paddingTop:8},confirmDiscardChangesDialogMessageStyle:{textAlign:"center",fontWeight:500}})),[t,null==e?void 0:e.isTryAutofillEnabled])}o(430670);var cs=()=>o(806080),ds=()=>o(617254),us=()=>o(921855),ps=()=>o(135986),gs=()=>o(208698);function ms(e){const{collectionContextStore:t,collectionSettingsStore:o,onAccept:i,propertySchema:s,disableSuggestions:a,propertyGroupId:c}=e,{isDesktop:d}=(0,r().Y0)(),u=(0,f().tz)(),p=(0,S().DP)(),g=(0,lo().X)("db_ux_properties"),[m,h]=(0,n.useState)(""),[x,v]=(0,n.useState)(null==s?void 0:s.icon),C=(0,n.useCallback)((e=>{const{propertyType:t,isSuggestedProperty:o,propertyName:n}=e;i(g?{propertyType:t,isSuggestedProperty:o,propertyName:m.length>0?m:n,propertyIcon:x}:{propertyType:t,isSuggestedProperty:o,propertyName:n})}),[g,i,m,x]),b=function(e){const{collectionContextStore:t,propertySchema:o,onAccept:i,userInput:s,disableSuggestions:a,propertyGroupId:c}=e,d=(0,r().v3)(),u=(0,f().tz)(),p=(0,lo().X)("db_ux_properties"),[g,m]=(0,n.useState)(p?"":s),y=p?g:s,[h,x]=(0,n.useState)(!1),v=(0,n.useCallback)((e=>{m(e.target.value)}),[m]),C=(0,n.useCallback)((()=>{x((e=>!e))}),[x]),[b,w]=(0,n.useState)(!1),j=!(0,l().O$)(Pl().e),A=(0,l().K8)((()=>{var e;if(!t)return;const o=null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.app_config_uri;return o?(0,Bn().lS)((0,ds().appConfigs)(),o):void 0}),[t]),{hasAiEnabled:_,showAiSuggestions:I}=(0,ps().xv)({environment:d,collectionContextStore:t,appConfig:A}),M=(0,ps().L7)({collectionContextStore:t,onAccept:i}),T=(0,ps().Re)({environment:d,propertySchema:o,onAccept:i,collectionContextStore:t,section:"all"}),P=(0,ps().p1)({}),B=(0,n.useMemo)((()=>({...T,...P})),[T,P]),V=(0,ps().D1)({collectionContextStore:t,propertySchema:o,propertyGroupId:c,propertyName:s}),[F,E]=(0,ps().b9)({collectionContextStore:t}),R=y.length>0,D=(0,n.useCallback)((e=>e.splice(0,b?1/0:ps().A$)),[b]),K=(0,n.useCallback)((e=>{let t;return t=R||b?e:D(e),fr().filter(y,t).filter((e=>!(R&&(B.hasOwnProperty(e.original)||null!=V&&V.hasOwnProperty(e.original)||null!=E&&E.hasOwnProperty(e.original))))).map((e=>e.original.toString()))}),[R,b,y,B,V,E,D]),O=(0,ps().ds)({hasAiEnabled:_,showAiSuggestions:I,collectionContextStore:t,propertySchema:o,onAccept:i,disableSuggestions:a,getFilteredSuggestedItemKeys:K}),L=(0,n.useMemo)((()=>{if("loading"===O)return[];if(p){const e=Object.values(O);return e.length>4?e.slice(0,4):e}return K((0,In().uv)(O)).flatMap((e=>O[e]))}),[O,K,p]),z=(0,n.useMemo)((()=>fr().filter(y,(0,In().uv)(M)).flatMap((e=>M[e.original]))),[M,y]),N=(0,n.useMemo)((()=>{const e=e=>void 0!==B[e.original]?[B[e.original]]:Object.values(B).find((t=>t.searchKeys.includes(e.original)))??[],t=Object.values(B).flatMap((e=>e.searchKeys));return(0,cs().s)(fr().filter(y,t).flatMap(e))}),[y,B]),U=(0,n.useMemo)((()=>V?fr().filter(y,(0,In().uv)(V)).flatMap((e=>V[e.original])):[]),[V,y]),W=(0,n.useMemo)((()=>{if(!F)return{};const e={};return(0,In().uv)(F).forEach((t=>{const o=fr().filter(y,(0,In().uv)(F[t])).flatMap((e=>F[t][e.original]));o.length>0&&(e[t]=o)})),e}),[F,y]),H=!p&&!b&&(0,In().uv)(O).length>ps().A$,$=(0,S().IS)((e=>({titleContainer:{display:"flex",alignItems:"center"},desktopTitleStyle:p?{marginBottom:0,paddingBottom:0,marginTop:2}:{},searchInputSectionStyle:{paddingBottom:0,marginBottom:p?4:0},standardSectionStyle:p?{paddingTop:0}:{paddingTop:4}})),[p]),G=p?(0,k.jsx)("span",{style:$.titleContainer,children:(0,k.jsx)("span",{children:u.formatMessage(ps().DZ.suggestedSectionTitle)})}):u.formatMessage(ps().DZ.suggestedSectionTitle),Q=(0,ps().D9)({hasMoreSuggestions:H,filteredSuggestedPropertyItems:L,hasSearchInput:R,showAiSuggestions:I,setIsShowingMoreSuggestions:w,disableSuggestions:Boolean(a||o),isLoading:"loading"===O,title:G,from:"collectionSettings"}),Z=(0,ps().HJ)({filteredAiDerivedPropertyItems:z}),q=(0,ps().bi)({searchProperties:{searchInput:y,showSearchInput:h,handleSearchInputChange:v,handleToggleSearchInput:C},titleText:u.formatMessage(ps().DZ.typesSectionTitle),desktopTitleStyle:$.desktopTitleStyle,desktopStyle:$.searchInputSectionStyle,topBorder:Q.items.length>0&&p}),Y=(0,ps().Dm)({title:p?void 0:u.formatMessage(ps().DZ.typesSectionTitle),filteredStandardPropertyItems:N,key:"standard",desktopStyle:$.standardSectionStyle}),J=(0,ps().bj)({filteredConnectedPropertyItems:U}),X=(0,ps().f1)({filteredConnectedPropertyItemsPerIntegration:W}),ee=(0,n.useMemo)((()=>{if(p)return{key:"custom",render:()=>null,items:[]};if(o||!y.length)return{key:"custom",render:()=>null,items:[]};const e=D((0,In().uv)(O));return M.hasOwnProperty(y.toLowerCase())||null!=e&&e.includes(y.toLowerCase())||null!=B&&B.hasOwnProperty(y.toLowerCase())||null!=V&&V.hasOwnProperty(y.toLowerCase())||null!=E&&E.hasOwnProperty(y.toLowerCase())?{key:"custom",render:()=>null,items:[]}:{key:"custom",render:e=>(0,k.jsx)(ae().A,{...e,title:u.formatMessage(ps().DZ.selectToAddNewProperty)}),items:[(0,ps().xl)({collectionContextStore:t,onAccept:i,propertyType:"text",propertyName:s,disablePropertyTooltip:!0,intl:u,isSuggestedProperty:!1,isOffline:j})]}}),[p,o,y,D,O,M,B,V,E,t,i,s,u,j]),te=(0,n.useMemo)((()=>[Q,p?void 0:Z,p?q:void 0,Y,...X,J,ee].filter(In().O9)),[Q,q,p,Z,Y,X,J,ee]);return te}({collectionContextStore:t,collectionSettingsStore:o,propertySchema:s,onAccept:C,disableSuggestions:a,userInput:m,propertyGroupId:c}),w=(0,l().K8)((()=>{const e=null==t?void 0:t.collectionStore();if(e)return(0,us().r4)(e.getName(),e)}),[t]),j=(0,l().O$)(t.permissionScopesStore),A=(0,Nl().a)(),_=(0,n.useCallback)((e=>{h(e.target.value)}),[h]),I=(0,n.useCallback)((()=>{g&&C({propertyType:"text",isSuggestedProperty:!1,propertyName:m})}),[C,m,g]),M=(0,n.useMemo)((()=>({enforceIconColor:"gray",backgroundColor:A?p.white:void 0,iconStyle:{fill:qt().l8[p.mode].gray},iconLeading:e=>(0,k.jsx)(ue().zB,{type:"text",icon:x,size:16,theme:p,style:e}),onSubmit:e=>{v(e)}})),[x,p,A]),T=(0,gs().$)({iconButton:M,onDelete:()=>{v(void 0)}}),P=(0,S().IS)((e=>({inputOuterStyle:A?{backgroundColor:e.white}:{},inputContainer:{padding:"0px 8px"}})),[A]);return null!=j&&j.isExternallyImportedAndSyncedCollection?null:(0,k.jsxs)(y().Ay,{...e,title:s?u.formatMessage(ps().DZ.changePropertyType):d&&w?u.formatMessage(ps().DZ.newPropertyWithDatabaseName,{databaseName:w}):u.formatMessage(ps().DZ.newProperty),children:[(0,k.jsx)(ae().A,{isInput:!0,children:g?(0,k.jsx)(Be().Ay,{focusInitial:!O().A.isMobile||void 0,focus:!O().A.isMobile||void 0,autoFocus:!O().A.isMobile||void 0,value:m,onChange:_,inputOuterStyle:P.inputOuterStyle,style:P.inputContainer,placeholder:u.formatMessage(ps().DZ.propertyNameInputPlaceholder),left:(0,k.jsx)(Be().KF,{iconLeading:M.iconLeading,iconStyle:M.iconStyle,onClick:T})}):(0,k.jsx)(Be().Ay,{focusInitial:!O().A.isMobile||void 0,focus:!O().A.isMobile||void 0,autoFocus:!O().A.isMobile||void 0,value:m,onChange:_,inputOuterStyle:P.inputOuterStyle,placeholder:g?u.formatMessage(ps().DZ.propertyNameInputPlaceholder):u.formatMessage(s?ps().DZ.searchToChangePlaceholder:ps().DZ.searchPlaceholder)})}),(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,sections:b,disableInitialScroll:!0,initialFocus:void 0,resetInitialFocusOnSectionChange:!1,onEmptyEnter:I})]})}var Ss=()=>o(228927),fs=()=>o(768627);const ys=(0,pn().wt)("emojiRecents",{viewBox:"0 0 28 28",svg:(0,k.jsx)("path",{d:"M14 22.4297C9.58594 22.4297 5.92969 18.7812 5.92969 14.3594C5.92969 9.94531 9.57812 6.28906 13.9922 6.28906C18.4141 6.28906 22.0703 9.94531 22.0703 14.3594C22.0703 18.7812 18.4141 22.4297 14 22.4297ZM14 20.8438C17.5938 20.8438 20.4844 17.9531 20.4844 14.3594C20.4844 10.7656 17.5859 7.88281 13.9922 7.88281C10.3984 7.88281 7.52344 10.7656 7.52344 14.3594C7.52344 17.9531 10.4062 20.8438 14 20.8438ZM10.0469 15.3281C9.69531 15.3281 9.42969 15.0547 9.42969 14.7109C9.42969 14.3594 9.69531 14.0938 10.0469 14.0938H13.375V9.58594C13.375 9.24219 13.6484 8.96875 13.9922 8.96875C14.3438 8.96875 14.6172 9.24219 14.6172 9.58594V14.7109C14.6172 15.0547 14.3438 15.3281 13.9922 15.3281H10.0469Z"})});var hs=()=>o(370873),xs=()=>o(835607),vs=()=>o(858141),Cs=()=>o(323086),bs=()=>o(314660),ws=()=>o(594013),js=()=>o(901610),As=()=>o(519831),_s=()=>o(720665),Is=()=>o(246826);function Ms(e){var t,o,n;const{collectionContextStore:i,collectionStore:r,transaction:l}=e,s=i.collectionViewStore();if(!s||!r.isDefined())return;const a=wi().e2(r),c=null===(t=r.getFormat())||void 0===t?void 0:t.collection_default_arrows_by,d=i.collectionStore(),u=(null==d?void 0:d.pointer.id)!==r.pointer.id,p=r.getSchema();let g=s.getChartConfig();u&&"chart"===s.getType()&&g&&"placeholder"!==g.type&&(g=function(e){let{chartConfig:t,collectionSchema:o}=e;return(0,js().m)(t)?(0,ws().EZ)({collectionSchema:o,axisChartType:t.type}):"donut"===t.type?(0,ws().ZS)({collectionSchema:o}):(0,ws().EZ)({collectionSchema:o,axisChartType:"column"})}({chartConfig:g,collectionSchema:p}));const m={table_properties:null==a||null===(o=a.getFormat())||void 0===o?void 0:o.table_properties,collection_pointer:{table:As().Vl,id:r.id,spaceId:r.getSpaceId()},chart_config:g,timeline_arrows_by:c?{property:c}:void 0,table_subitem_toggle_column:"title"},S=null==i?void 0:i.normalizedSchemaStore.state;Is().zv({store:s,data:(0,_s().g_)({format:m,query2:{sort:null==a||null===(n=a.getQuery(S))||void 0===n?void 0:n.sort}}),transaction:l})}function ks(e){const{collectionContextStore:t,transaction:o,source:n}=e,i=t.collectionViewStore();if(i&&(p().zA({stores:[i],update:{collection_view_source:n},transaction:o}),"collection"===n.type)){const e=ct().md.createChildStore(i,{table:As().Vl,id:n.id,spaceId:n.spaceId});if(!e.isDefined())return;Ms({collectionContextStore:t,collectionStore:e,transaction:o});if(!t.collectionViewBlockStore())return}}function Ts(e){const t=(0,r().v3)(),o=(0,lo().X)("sidebar_library"),{isMobile:i}=t.device,l=(0,S().IS)((e=>({icon:{color:e.icon.secondary,width:i?24:20,height:i?24:20}})),[i]),s=(0,n.useCallback)((o=>{const n=e.collectionViewStore();n&&g().createAndCommit({userAction:"CreateViewSourceMenuBody.allPagesOption",environment:t,canUndo:!0,perform:t=>{ks({collectionContextStore:e,source:{type:o,spaceId:n.getSpaceId()},transaction:t}),(0,bs().f)({collectionViewStore:n,update:{filter:void 0,sort:[],aggregations:void 0},transaction:t});const i=e.settingsStore;u().os({collectionSettingsStore:i})}})}),[e,t]);return(0,n.useMemo)((()=>{if(!o)return;return{key:"browse",items:[{key:"created-by-me",render:e=>(0,k.jsx)(Pe().A,{...e,title:jt().A.formatMessage(Cs().WB.messages.createdByMe),icon:(0,hs().p)(l.icon)}),action:()=>{s("createdByMe")}},{key:"recents",render:e=>(0,k.jsx)(Pe().A,{...e,title:jt().A.formatMessage(Cs().WB.messages.recents),icon:ys(l.icon)}),action:()=>{s("recents")}},{key:"mentioned-me",render:e=>(0,k.jsx)(Pe().A,{...e,title:jt().A.formatMessage(Cs().WB.messages.mentionsMe),icon:ys(l.icon)}),action:()=>{s("mentionsMe")}},{key:"shared-with-me",render:e=>(0,k.jsx)(Pe().A,{...e,title:jt().A.formatMessage(Cs().WB.messages.sharedWithMe),icon:(0,xs().peopleIcon)(l.icon)}),action:()=>{s("sharedWithMe")}},{key:"my-pages",render:e=>(0,k.jsx)(Pe().A,{...e,title:jt().A.formatMessage(Cs().WB.messages.myPages),icon:(0,vs().p)(l.icon)}),action:()=>{s("myPages")}}],render:e=>(0,k.jsx)(ae().A,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Browse",id:"database.collectionSettings.useBrowseCollections.browse"}),...e})}}),[l.icon,s,o])}var Ps=()=>o(591779),Bs=()=>o(245241),Vs=()=>o(135599),Fs=()=>o(106628),Es=()=>o(361330);function Rs(e){let{numShimmers:t=5}=e;const o=(0,S().IS)((e=>({container:{maxHeight:253},shimmerContainer:{height:45,margin:"0 14px 0px 18px",display:"flex",alignItems:"center"},circleContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginRight:5,marginTop:5,alignSelf:"flex-start"},circle:{width:16,height:16,borderRadius:12,backgroundColor:e.lightDividerColor},sourceContainer:{flex:"1 1 auto",marginTop:6,marginLeft:8,alignSelf:"flex-start"},title:{height:9,width:"40%",borderRadius:8,backgroundColor:e.lightDividerColor},location:{marginTop:9,height:9,width:"60%",borderRadius:8,backgroundColor:e.lightDividerColor},showMoreContainer:{margin:"-2px 14px 0px 18px",display:"flex",alignItems:"center"},showMore:{marginTop:3,height:9,width:"40%",borderRadius:8,backgroundColor:e.lightDividerColor}})),[]),n=eo().Hn(t,(e=>(0,k.jsxs)("div",{style:o.shimmerContainer,children:[(0,k.jsx)("div",{style:o.circleContainer,children:(0,k.jsx)(Ve().A,{style:o.circle})}),(0,k.jsxs)("div",{style:o.sourceContainer,children:[(0,k.jsx)(Ve().A,{style:o.title}),(0,k.jsx)(Ve().A,{style:o.location})]})]},e))),i=(0,k.jsxs)("div",{style:o.showMoreContainer,children:[(0,k.jsx)("div",{style:o.circleContainer,children:(0,k.jsx)(Ve().A,{style:o.circle})}),(0,k.jsx)("div",{style:o.sourceContainer,children:(0,k.jsx)(Ve().A,{style:o.showMore})})]});return(0,k.jsxs)("div",{style:o.container,children:[n,i]})}var Ds=()=>o(697650);const Ks=[];function Os(e){let{collectionContextStore:t,suggestionConfig:o,inputValue:n}=e;const i=(0,f().tz)(),r=(0,Vr().Y4)(),s=(0,Vr().x6)(),a=(0,l().K8)((()=>function(e){let{collectionContextStore:t,suggestionConfig:o}=e;if("noSuggestions"===o.type)return[];const n="viewModuleTab"===o.type?o.collectionParentCollectionViewBlockStore:null==t?void 0:t.collectionViewBlockStore();if(!n)return[];if(n.getCollectionPointerIfSingleSource())return[];return n.getOwnedAndLinkedCollectionStores()}({collectionContextStore:t,suggestionConfig:o})),[t,o]),c=(0,l().K8)((()=>function(e){let{suggestedCollections:t,inputValue:o,suggestionConfig:n,intl:i,isWorkflowsContainerWithCreationEnabled:r}=e;const l=t.filter((e=>e.id!==function(e){switch(e.type){case"sourceView":case"relation":return e.currentValue;case"viewModuleTab":case"newView":case"noSuggestions":return;default:(0,In().HB)(e)}}(n))).filter((e=>e.canRead()));return(0,he().Ay)(o,l,(e=>(0,Ds().Qo)({collectionStore:e,intl:i,isWorkflowsContainerWithCreationEnabled:r})),{minThreshold:he().qR})}({suggestedCollections:a,inputValue:n,suggestionConfig:o,intl:i,isWorkflowsContainerWithCreationEnabled:s})),[a,n,o,i,s]);return r?c:Ks}const Ls=5,zs=20,Ns=20;function Us(e){const{input:t,handleAcceptExistingCollection:o,hideSearchTitle:i,collectionContextStore:s,collectionStore:a,parentStore:c,context:d,suggestionConfig:u,searchResultsItemsLimit:p=zs,isSearchSurfacesHookEnabled:g=!1,showLoadMoreResultsButton:m=!1,requireEditPermissions:f=!1}=e,y=Os({collectionContextStore:s,suggestionConfig:u,inputValue:t}),h=(0,r().v3)(),[x,v]=(0,n.useState)(Ls),C=(0,n.useRef)(!1);(0,Ps().ZC)(t)!==t&&(C.current=!1),(0,n.useEffect)((()=>{g||(t.length>0&&x===Ls?v(zs):0===t.length&&x===zs&&v(Ls))}),[t.length,g,x]);const{results:b,isResultsLoading:w,searchSessionId:j,fetchAdditionalServerResultsOnChange:A,hasMoreResults:_,searchSessionFlowNumber:I}=(0,Vs().W)({query:t,limit:p,source:"collection_settings_source",type:Bs().Vz.CollectionsInSpace,options:{disable:!g}}),M=(0,n.useRef)(0),T=I+M.current,[P]=(0,me().Yb)((async()=>{if(g)return;const e=await $s({query:t,limit:x},c,h,j,s,f);return M.current+=1,e}),[g,t,x,c,h,j,s,f],{debounce:Es().tu}),B=(0,S().IS)((e=>({showMoreButton:{color:e.text.secondary,fill:e.icon.secondary}})),[]),V=(0,l().K8)((()=>P&&"pending"===P.status||w),[w,P]),{resultsSectionItems:F,hasResults:E}=(0,l().K8)((()=>{if("rejected"===P.status)return{resultsSectionItems:[],hasResults:!1};const{results:e,showMore:n}=P.value??{results:[],showMore:0},i=g?b.flatMap((e=>e.store.getOwnedCollectionStores())):e.map((e=>qe().m.createChildStore(c,{table:As().Vl,id:e}))),r=new Set(y),l=(0,eo().oE)(i).filter((e=>{if(r.has(e))return!1;if(d===Qs.Source){const t=e.getParentBlockStore();return(null==t?void 0:t.id)!==c.id}return!f||e.canEditCollection()})),u=l.map(((e,n)=>({key:e.id,render:t=>(0,k.jsx)(Ws,{...t,itemCollectionStore:e,selfCollectionStore:a,collectionContextStore:s,context:d}),action:i=>{o(e),(0,be().u)({environment:h,event:{eventName:"source_collection_search_item_click",eventProperties:{index:y.length+n,search_session_id:j,source:"source",using_secondary_search_surfaces_hook:g,query_length:t.length,reciprocal_rank:1/(n+1),search_session_flow_number:T,total_results:y.length+l.length}}})}})));if(V&&u.push({key:"loading",render:e=>(0,k.jsx)("div",{style:{paddingTop:h.device.isMobile?10:0},children:(0,k.jsx)(Rs,{numShimmers:Math.min(p,5)})}),action:()=>{}}),!g&&n>0&&!V){const e={key:"showMore",render:e=>(0,k.jsx)(Pe().A,{...e,buttonStyle:B.showMoreButton,icon:(0,ol()._)({width:16,height:16}),title:jt().A.formatMessage(Gs.showMore,{showMore:n})}),action:()=>v((e=>e+Ns))};u.push(e)}else if(g&&(0===t.length||m)&&!V&&!C.current&&_&&A){const e={key:"showMore",render:e=>(0,k.jsx)(Pe().A,{...e,buttonStyle:B.showMoreButton,icon:(0,ol()._)({width:16,height:16}),title:jt().A.formatMessage(Gs.showMoreWithoutCount)}),action:()=>{A(p),C.current=!0}};u.push(e)}return u.length>0?{resultsSectionItems:u,hasResults:!0}:{resultsSectionItems:[{key:"noResults",render:e=>(0,k.jsx)(il().A,{caption:jt().A.formatMessage(Gs.noResults),style:{marginLeft:1},...e}),action:()=>{}}],hasResults:!1}}),[P.status,P.value,g,b,y,V,t.length,m,_,A,c,d,f,a,s,o,h,j,T,p,B.showMoreButton]),R=y.map(((e,n)=>({key:`suggested-${e.id}`,render:t=>(0,k.jsx)(Ws,{...t,itemCollectionStore:e,selfCollectionStore:a,collectionContextStore:s,context:d}),action:()=>{o(e),(0,be().u)({environment:h,event:{eventName:"source_collection_search_item_click",eventProperties:{index:n,search_session_id:j,source:"source",using_secondary_search_surfaces_hook:g,query_length:t.length,reciprocal_rank:1/(n+1),search_session_flow_number:T,total_results:y.length+F.length}}})}}))),D=(0,n.useMemo)((()=>R.length>0?{key:"suggested",items:R,render:e=>(0,k.jsx)(ae().A,{title:jt().A.formatMessage(Gs.suggestedDatabases),...e})}:void 0),[R]),K=(0,n.useMemo)((()=>({key:"results",items:F,render:e=>(0,k.jsx)(ae().A,{title:!i&&jt().A.formatMessage(Gs.existingDatabases),...e})})),[i,F]);return{suggestedSection:D,resultsSection:K,fetchMoreResults:!V&&A?A:void 0,searchSessionFlowNumber:T,searchSessionId:j,hasResults:E}}const Ws=n.forwardRef((function(e,t){const{itemCollectionStore:n,selfCollectionStore:i,collectionContextStore:r,context:s,...a}=e,c=(0,l().K8)((()=>{var e;if(s===Qs.Relation)return(null==i?void 0:i.id)??(null==r||null===(e=r.collectionViewStore())||void 0===e||null===(e=e.getCollectionStore())||void 0===e?void 0:e.id)}),[s,i,r]);return(0,k.jsx)(o(958378).A,{...a,store:n,right:c===n.id?(0,k.jsx)(Hs,{}):void 0})}));function Hs(){const e=(0,f().tz)();return(0,k.jsx)(Ie().A,{renderTooltip:()=>e.formatMessage(Gs.thisDatabase),render:e=>(0,k.jsx)("div",{...e,children:(0,xi().G)({width:14,height:14})})})}async function $s(e,t,o,n,i,r){const{query:l,limit:s}=e,{currentSpaceStore:a}=ce().default.state,c=null==i?void 0:i.collectionViewBlockStore(),d=await Fs().T.searchActions.load(),u=await d.searchCollectionsWithRecents({environment:o,collectionViewBlockStore:c,parentStore:t,spaceStore:a,query:l,limit:s,requireEditPermissions:r,searchSessionId:n});return{results:u.results,showMore:Math.max(0,u.total-u.results.length)}}const Gs=(0,f().YK)({showMore:{defaultMessage:"Show {showMore} more",id:"database.viewSettings.searchCollections.showMore.title"},noResults:{defaultMessage:"No results",id:"database.viewSettings.searchCollections.noResults.title"},existingDatabases:{defaultMessage:"Existing databases",id:"database.viewSettings.createViewTab.existingDatabases"},suggestedDatabases:{defaultMessage:"Suggested",id:"database.viewSettings.searchCollections.suggestedDatabases"},showMoreWithoutCount:{defaultMessage:"Show more",id:"database.viewSettings.searchCollections.showMore.titleWithoutCount"},thisDatabase:{defaultMessage:"This database",id:"database.viewSettings.searchCollections.thisDatabase.tooltip"}});let Qs=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e}({});const Zs=(0,f().YK)({linkedInputPlaceholder:{defaultMessage:"Link to a database…",id:"database.viewSettings.searchCollections.linkedInputPlaceholder"},linkedOrSourceInputPlaceholder:{defaultMessage:"Link or create a database…",id:"database.viewSettings.searchCollections.linkedOrSourceInputPlaceholder"},automationInputPlaceholder:{id:"automations.databasePicker.automationInputPlaceholder",defaultMessage:"Select a database…"}}),qs=yr().Store.createClass("",{name:"InputStore"}),Ys=n.memo((function(e){const{collectionContextStore:t,context:o,parentStore:i,onAccept:s,inputStore:a,requireEditPermissions:d,collectionStore:u,suggestionConfig:p}=e,g=(0,r().v3)(),m=(0,r().Y0)(),S=(0,l().uB)(a,qs),f=(0,l().uB)(void 0,sl().A),y=(0,n.useRef)(0),h=(0,l().O$)(S),{suggestedSection:x,resultsSection:v,fetchMoreResults:C,searchSessionId:b,searchSessionFlowNumber:w}=Us({input:h,handleAcceptExistingCollection:s,collectionContextStore:t,parentStore:i,context:o,requireEditPermissions:d,collectionStore:u,suggestionConfig:p}),j=Ts(t);(0,n.useEffect)((()=>{y.current=w}),[w]);const A=(0,l().K8)((()=>"on"===c().default.getEligibleGroup({experimentId:"search_surfaces_collection_search",defaultGroup:"unassigned"})),[]);(0,n.useEffect)((()=>((0,be().u)({environment:g,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:b,using_secondary_search_surfaces_hook:A,source:"relation"}}}),()=>{(0,be().u)({environment:g,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:b,source:"relation",using_secondary_search_surfaces_hook:A,search_session_flow_number:y.current}}})})),[g,A,b]);const _=(0,l().K8)((()=>null==t?void 0:t.getCollectionViewBlockSourceState()),[t]);let I=Zs.linkedOrSourceInputPlaceholder;return"linked"===_||o===Qs.Relation?I=Zs.linkedInputPlaceholder:o!==Qs.Source&&(I=Zs.automationInputPlaceholder),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ae().A,{isInput:!0,children:(0,k.jsx)(Be().Ay,{focusInitial:!m.isMobile||void 0,value:h,onChange:e=>{S.setState(e.target.value),f.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:jt().A.formatMessage(I),showClearButton:!0})}),(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:0,sections:[x,v,j].filter(In().O9),store:f}),A?(0,k.jsx)(Ss().A,{onChange:(e,t)=>{C&&e<fs().A.incrementScrollOffset&&C()}}):null]})}),Ur().A);function Js(e){const{collectionContextStore:t,collectionSettingsStore:o,property:i,initialPropertyName:s,formatKey:a,propertyGroupId:c}=e,d=(0,r().v3)(),p=(0,n.useMemo)((()=>yr().Store.createValue("")),[]),g=(0,l().K8)((()=>t.collectionViewBlockStore()),[t]),m=(0,l().K8)((()=>{var e;const t=(0,ui().S)(o);if("setupRelation"===(null==t?void 0:t.type))return null===(e=t.targetCollectionPointer)||void 0===e?void 0:e.id}),[o]),S=(0,n.useMemo)((()=>({type:"relation",currentValue:m})),[m]),h=(0,n.useCallback)((e=>{if(!t.collectionStore())return;(0,er().X)({environment:d,collectionContextStore:t,action:"select_relation_source"});const{stack:n}=o.state,r=n.length<2?void 0:n[n.length-2];r&&"setupRelation"===r.type&&u().yl({collectionSettingsStore:o}),u().dP({collectionSettingsStore:o,item:{type:"setupRelation",property:i,initialPropertyName:s,formatKey:a,propertyGroupId:c,targetCollectionPointer:e.pointer}})}),[t,d,o,i,s,a,c]),x=(0,n.useCallback)((()=>{u().os({collectionSettingsStore:o})}),[o]);return g?(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Related to",id:"database.viewSettings.selectNewRelationSourceTab.title"}),handleClose:x,children:(0,k.jsx)(Ys,{collectionContextStore:t,onAccept:h,parentStore:g,context:Gr().U9.Relation,inputStore:p,suggestionConfig:S})}):null}function Xs(e){const{collectionContextStore:t,collectionSettingsStore:o,module:i}=e,r=(0,n.useMemo)((()=>yr().Store.createValue("")),[]),{collectionStore:s}=(0,Tl().bi)(),a=(0,l().K8)((()=>t.collectionViewBlockStore()),[t]),c=(0,n.useCallback)((e=>{u().dP({collectionSettingsStore:o,item:{type:"setupViewsModule",targetCollectionPointer:e.pointer,module:i}})}),[o,i]),d=(0,l().K8)((()=>{var e;return{type:"viewModuleTab",currentValue:null===(e=t.collectionStore())||void 0===e?void 0:e.id,collectionParentCollectionViewBlockStore:null==s?void 0:s.getParentCollectionViewBlockStore()}}),[t,s]);return a?(0,k.jsx)(y().Ay,{...e,handleClose:()=>u().os({collectionSettingsStore:o}),children:(0,k.jsx)(Ys,{collectionContextStore:t,onAccept:c,parentStore:a,context:Gr().U9.Relation,inputStore:r,collectionStore:s,suggestionConfig:d})}):null}var ea=()=>o(908447),ta=()=>o(27732),oa=()=>o(717989),na=()=>o(878377),ia=()=>o(395963),ra=()=>o(896427),la=()=>o(513489),sa=()=>o(860037);function aa(e){const{collectionContextStore:t,collectionSettingsStore:o,formatKey:i,property:s,initialPropertyName:a,propertyGroupId:c,targetCollectionPointer:d,from:m}=e,h=(0,r().v3)(),x=(0,f().tz)(),v=(0,l().K8)((()=>t.collectionStore()),[t]),C=(0,l().K8)((()=>{const e=t.collectionViewBlockStore();return function(e){const{targetCollectionPointer:t,collectionStore:o,collectionViewBlockStore:n}=e;if(!t)return;if(o&&o.pointer===t)return o;return n?ct().md.createChildStore(n,t):void 0}({targetCollectionPointer:d,collectionStore:v,collectionViewBlockStore:e})}),[t,v,d]),b=(0,l().K8)((()=>s?Mi().Jq(t,s):void 0),[t,s]),w=Boolean(v&&C&&v.id===C.id),j=Boolean("relation"===(null==b?void 0:b.type)&&b.connectedRelation),A=Boolean("subitem"===m),_=Boolean("timeline_arrows_by"===m),I=A||_,M=(0,l().K8)((()=>t.contextType),[t]),T=(0,l().K8)((()=>{if(void 0!==a&&""!==a&&a!==rl().dC.relation)return a;const e=null==v?void 0:v.getSchema();return void 0===(null==b?void 0:b.name)&&C&&e?Mi().$H(x,{targetCollectionStore:C,isSelfRelation:w,sourceSchema:e,createUnique:!0,from:m}):(null==b?void 0:b.name)||""}),[a,v,null==b?void 0:b.name,C,x,w,m]),[P,B]=(0,n.useState)(T),[V,F]=(0,n.useState)("no_limit"),[E,R]=(0,n.useState)({hasInverseRelation:I,inverseName:void 0,autoRelate:{enabled:!1}}),D=(0,S().IS)((()=>({relationOptions:{marginTop:10}})),[]),K=(0,n.useCallback)((()=>{u().a2({collectionSettingsStore:o,item:{type:"selectRelationSource",property:s,formatKey:i}})}),[o,s,i]),O=(0,n.useCallback)((()=>{if(!E)return;const{hasInverseRelation:e,inverseName:n,autoRelate:r}=E,l=t.collectionStore(),a=t.collectionViewStore();if(!l||!C)return;const{performResult:d}=g().createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:h,canUndo:!0,perform:o=>{const d=s??ve().IL({environment:h,collectionStore:l,collectionViewArgs:a&&i?{collectionViewStore:a,format:a.getFormat(),formatKey:i}:void 0,propertyType:"relation",transaction:o});if(ta().cT({environment:h,collectionContextStore:t,collectionStore:l,property:d,propertyName:P,targetCollectionStore:C,hasInverseRelation:e,inverseName:n,autoRelate:r,propertyLimit:V,intl:x,transaction:o,from:m}),c&&d&&(0,ia().En)({collectionStore:l,groupId:c,propertyId:d,transaction:o}),a){var u;const e=(null===(u=a.getFormat().table_properties)||void 0===u?void 0:u.find((e=>e.property===d)))??{property:d,visible:!0};p().zA({stores:[a],update:{table_properties:[...a.getFormat().table_properties??[],e]},transaction:o})}return"subitem"===m&&a?Ci().zt({environment:h,collectionContextStore:t,relationPropertyId:d,transaction:o}):"timeline_arrows_by"===m&&a&&(oa().Tq({collectionViewStore:a,newProperty:d,transaction:o}),oa().L_({collectionContextStore:t,relationPropertyId:d,transaction:o})),d}});"subitem"===m||"timeline_arrows_by"===m?(u().yl({collectionSettingsStore:o}),u().a2({collectionSettingsStore:o,item:{type:"main"}})):u().n1({collectionSettingsStore:o,property:d,formatKey:i}),(0,ea().Z)({environment:h,collectionContextStore:t,from:"collectionPage"===M?"page_properties":"view_settings",property_type:"relation"}),(0,na().FrL)()&&u().os({collectionSettingsStore:t.settingsStore})}),[E,t,C,h,m,M,s,i,c,P,V,x,o]),L=(0,n.useCallback)((e=>{B(e.target.value)}),[B]),z=(0,n.useCallback)((e=>{F(e)}),[F]);return(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"New relation",id:"database.viewSettings.setupRelationTab.title"}),children:[(0,k.jsxs)(ae().A,{isInput:!0,children:[(0,k.jsx)(Be().Ay,{value:P,placeholder:x.formatMessage({defaultMessage:"Property name",id:"database.viewSettings.setupRelationTab.propertyNamePlaceholder"}),onChange:L,onBlur:eo().lQ,onSubmit:eo().lQ,focusInitial:!0,selectAll:!1}),(0,k.jsxs)("div",{style:D.relationOptions,children:[(0,k.jsx)(sa().A,{isSelfRelation:w,collectionStore:C,showAs:"chevron",onClick:K,disabled:A}),m?null:(0,k.jsx)(la().o,{selectedKey:V,propertyType:"relation",onChange:z}),C&&!j?(0,k.jsx)(ra().Ay,{collectionContextStore:t,targetCollectionStore:C,property:s,mode:"create",temporaryInverseState:E,setTemporaryInverseState:R,onSubmit:O,shouldEnforceTwoWayRelation:I}):null]})]}),(0,k.jsx)(ae().A,{children:(0,k.jsx)(xr().A,{href:(0,ro().xS)("guides.relations"),title:(0,k.jsx)(f().sA,{id:"database.viewSettings.propertyTab.relations.learnMoreButton.title",defaultMessage:"Learn about relations"}),analyticsFrom:"view_settings_property_relation"})})]})}var ca=()=>o(416504),da=()=>o(154017),ua=()=>o(180762),pa=()=>o(187820),ga=()=>o(626318);function ma(e){const{collectionContextStore:t,collectionSettingsStore:o,targetCollectionPointer:i,module:s}=e,a=(0,f().tz)(),{isMobile:c}=(0,r().Y0)(),{layoutStore:d,setModuleSelection:p}=(0,Tl().LH)(),{collectionStore:m}=(0,Tl().bi)(),h=(0,r().v3)(),x=(0,l().K8)((()=>d.inMemoryRecordCache),[d]),v=(0,l().K8)((()=>{if(!i)return;if(m&&m.pointer===i)return m;const e=t.collectionViewBlockStore();return e?ct().md.createChildStore(e,i):void 0}),[t,m,i]),C=(0,l().K8)((()=>null==v?void 0:v.canEditCollection()),[v]),b=Boolean(m&&v&&m.id===v.id),w=(0,l().K8)((()=>{var e;return null==v||null===(e=v.getModel())||void 0===e?void 0:e.getRenderTitle({getRecordModel:null==m?void 0:m.getRecordModel,intl:a,userTimeZone:(0,ca().P)()})}),[v,m,a]),j=(null==v?void 0:v.id)!==(null==m?void 0:m.id),[_,I]=(0,n.useState)(w??""),[M,T]=(0,n.useState)({hasInverseRelation:j,inverseName:void 0,autoRelate:{enabled:!1}}),[P,B]=(0,n.useState)(!1),V=(0,n.useCallback)((()=>{u().a2({collectionSettingsStore:o,item:{type:"selectViewsModuleSource",module:s}})}),[o,s]),F=(0,n.useCallback)((()=>{B((e=>!e))}),[]),E=(0,n.useCallback)((()=>{T((e=>({...e,hasInverseRelation:!1})))}),[]),R=(0,n.useCallback)((()=>{T((e=>({...e,hasInverseRelation:!0})))}),[]),D=(0,n.useCallback)((e=>{var t;const o=null!=M&&null!==(t=M.autoRelate)&&void 0!==t&&t.enabled?{enabled:!1}:{enabled:!0,bot_id:e};T((t=>({...t,autoRelate:{enabled:Boolean(o),bot_id:e}})))}),[M]),K=(0,n.useCallback)((e=>{T((t=>({...t,inverseName:e.target.value})))}),[]),O=(0,n.useCallback)((()=>{const e=null==t?void 0:t.collectionViewBlockStore();if(!e)throw new Error("Views module block not found");const{performResult:n}=g().createAndCommit({userAction:"CollectionSettingsSetupViewsModule.handleAddView",environment:h,canUndo:!0,perform:o=>{let n;if(P&&m){const e=ve().IL({environment:h,collectionStore:m,collectionViewArgs:void 0,propertyType:"relation",transaction:o}),{inverseRelationPropertyId:i}=ta().cT({environment:h,collectionContextStore:t,collectionStore:m,property:e,propertyName:_,targetCollectionStore:v??m,hasInverseRelation:M.hasInverseRelation,inverseName:M.inverseName,autoRelate:M.autoRelate,intl:a,transaction:o,propertyLimit:"no_limit"})??{};n=i??e}const i=(0,ga().Bj)({environment:h,transaction:o,collectionViewBlockStore:e,targetCollectionPointer:null==v?void 0:v.pointer,viewName:_,relationPropertyId:n,inMemoryRecordCache:x});return p({type:"existing_module",moduleId:s.id,isDragging:!1}),{collectionViewPointer:i}}});u().os({collectionSettingsStore:o});const{collectionViewPointer:i}=n??{};i&&(fi().default.afterNextFlush((()=>{t&&((0,ua().t)({environment:h,collectionContextStore:t,collectionViewId:i.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),u().Ow({collectionContextStore:t,collectionSettingsStore:t.settingsStore,closeOnEscape:!1}))})),t&&(0,da().b)({environment:h,collectionContextStore:t,view_type:"table",from:"viewsMain",is_in_page_builder:!0})),u().os({collectionSettingsStore:o})}),[t,h,o,P,m,_,v,M,a,x,p,s.id]),L=(0,l().K8)((()=>null==v?void 0:v.getIcon()),[v]),z=(0,S().IS)((e=>({chevronTitle:{marginLeft:4,display:"inline",wordBreak:"break-word",alignSelf:"center",...le().RC},relationMenuTitle:{display:"flex",alignItems:"center",whiteSpace:"pre"},helpIcon:{width:16,fill:e.icon.tertiary,marginLeft:6},tooltip:{maxWidth:285,width:"max-content",overflowWrap:"break-word",textWrap:"wrap",whiteSpace:"pre-line"},tooltipSecondary:{color:e.text.contrastSecondary}})),[]),N=P&&v&&C;return(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"New view",id:"database.viewSettings.setupViewTab.title"}),children:[(0,k.jsx)(ae().A,{isInput:!0,children:(0,k.jsx)(Be().Ay,{value:_||"",placeholder:P?a.formatMessage({defaultMessage:"View & relation name",id:"database.viewSettings.mainTab.viewNameAndRelationNameSection.title"}):a.formatMessage({defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),onChange:e=>I(e.target.value),onBlur:eo().lQ,onSubmit:eo().lQ,focusInitial:!0,selectAll:!1})}),(0,k.jsxs)(ae().A,{children:[(0,k.jsx)(kt().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"View of",id:"database.viewSettings.setupViewsModule.viewOf.title"}),showChevron:!0,onClick:V,disabled:!1,right:b?(0,k.jsx)(f().sA,{defaultMessage:"This database",id:"database.viewSettings.editRelation.selfRelationTarget.title"}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(pa().B6,{icon:L,iconRecordCategory:"collection",isEmptyPage:!1,size:20,disabled:!0}),(0,k.jsx)(Oo().A,{store:v,style:z.chevronTitle})]}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0}}),(0,k.jsx)(Uo().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Add new relation",id:"database.viewSettings.addRelationToggle"}),on:P,onClick:F,focused:!1,disabled:!C})]}),N&&(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(ra().EB,{currentInverseState:Boolean(null==M?void 0:M.hasInverseRelation),disableInverseRelation:E,enableInverseRelation:R,handleAutoRelateToggle:D,temporaryInverseState:M,collectionStore:m,targetCollectionStore:v,isTwoWayToggleDisabled:!b,isNameDisabled:!1,menuTitle:(0,k.jsxs)("div",{style:z.relationMenuTitle,children:[a.formatMessage(ra().DZ.generic.title),!c&&(0,k.jsx)(Ie().A,{placement:Pt().W.Bottom,textWrap:!0,style:z.tooltip,render:e=>(0,k.jsx)("div",{...e,children:(0,Jt().$)(z.helpIcon)}),renderTooltip:()=>(0,k.jsxs)(k.Fragment,{children:[b?a.formatMessage(Sa.selfTwoWayRelationTooltip):a.formatMessage(Sa.nonSelfTwoWayRelationTooltip),!b&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("br",{}),(0,k.jsx)("span",{style:z.tooltipSecondary,children:(0,k.jsx)(f().sA,{...Sa.nonSelfTwoWayRelationTooltipSecondary})})]})]})})]}),autoRelate:null==M?void 0:M.autoRelate,isSelfRelation:b,inverseRelationName:(null==M?void 0:M.inverseName)??"",handleInverseNameChange:K})}),(0,k.jsx)(ae().A,{children:(0,k.jsx)(A().A,{style:{display:"flex",margin:"0px 8px 8px 8px"},onClick:O,disabled:0===_.length,children:P?(0,k.jsx)(f().sA,{...Sa.addViewAndRelationButton}):(0,k.jsx)(f().sA,{...Sa.addViewButton})})})]})}const Sa=(0,f().YK)({addViewButton:{defaultMessage:"Add view",id:"database.viewSettings.addViewButton"},addViewAndRelationButton:{defaultMessage:"Add view & relation",id:"database.viewSettings.addViewAndRelationButton"},selfTwoWayRelationTooltip:{defaultMessage:"Manage separate properties for each direction of a two-way relation.",id:"database.viewSettings.selfTwoWayRelationTooltip"},nonSelfTwoWayRelationTooltip:{defaultMessage:"Manage separate properties for each direction of a two-way relation.",id:"database.viewSettings.nonSelfTwoWayRelationTooltip"},nonSelfTwoWayRelationTooltipSecondary:{defaultMessage:"This setting is required for relations of linked databases in tabbed views.",id:"database.viewSettings.nonSelfTwoWayRelationTooltipSecondary"}});var fa=()=>o(68263),ya=()=>o(848538);var ha=()=>o(579627),xa=()=>o(21140),va=()=>o(484595);function Ca(e){let{collectionSettingsStore:t,collectionContextStore:i,integrationName:s,integrationIcon:c,fullHeight:d}=e;const p=(0,r().v3)(),m=(0,S().IS)((e=>({promptTitle:wa(e)})),[]),[h,x]=(0,n.useState)(!1),v=(0,l().K8)((()=>i.collectionViewBlockStore()),[i]),C=(0,l().K8)((()=>null==v?void 0:v.getSpaceStore()),[v]),[{value:b}]=(0,me().Yb)((async()=>{if(!v||!C)return{numberOfGuests:void 0,numberOfUsers:void 0,isPublic:void 0};const e=(0,o(731320).i0)(v).map((e=>e.permissionItem));let t=!1,n=!1;for(const o of e)fa().FP(o)?t=!0:fa().Lg(o)&&!fa().$I(o.role)&&(n=!0);const i=eo().oE(await(0,to().lX)(e,10,(async e=>{if("user_permission"===e.type){const t=(0,o(646736).dp)(C,e.user_id);return await t.load(),t}})));let r;if(n){r=await(0,Go().Pu)({environment:p,spaceId:C.id})??1}else r=i.filter((e=>{const t=e.getMembershipType();return t&&(0,ya().MN)(t)})).length;const l=i.filter((e=>{const t=e.getMembershipType();return t&&(0,ya().P)(t)})).length;return{numberOfGuests:l,numberOfUsers:r+l,isPublic:t}}),[v,p,C]),{numberOfGuests:w,numberOfUsers:j,isPublic:_}=(0,n.useMemo)((()=>b??{numberOfGuests:void 0,numberOfUsers:void 0,isPublic:void 0}),[b]);(0,n.useEffect)((()=>{_||1!==j||u().os({collectionSettingsStore:t})}),[t,_,j]);const I=(0,n.useCallback)((()=>{v&&(h&&function(e){const{environment:t,store:o}=e,n=t.currentUser.id;if(!n)return;g().createAndCommit({userAction:"CollectionSettingsSyncedContentShare.restrictAccessToSyncedContent",environment:t,canUndo:!0,perform:e=>{ha().wW({environment:t,store:o,shouldInherit:!1,transaction:e,permissionItem:{type:"user_permission",user_id:n,role:"editor"}})}})}({environment:p,store:v}),function(e,t){(0,a().v)(e,"set_database_sync_permissions",t)}(p,{type:h?"restrict":"share"}),u().os({collectionSettingsStore:t}))}),[t,v,p,h]);if(!v)return null;const M=(0,k.jsx)("div",{style:m.promptTitle,children:(0,k.jsx)(f().sA,{id:"CollectionSettingsSyncedContentShare.header",defaultMessage:"Share synced content with"})}),T=(0,k.jsxs)(k.Fragment,{children:[0!==w?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(f().sA,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithGuests",defaultMessage:"{numberOfUsers} people (including you {numberOfGuests, plural, one {and {numberOfGuests} guest} other {and {numberOfGuests} guests}})",values:{numberOfUsers:j,numberOfGuests:w}})," "]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(f().sA,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithoutGuests",defaultMessage:"{numberOfUsers} people (including you)",values:{numberOfUsers:j}})," "]}),_&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(f().sA,{id:"CollectionSettingsSyncedContentShare.option.share.caption.sharedWithPublic",defaultMessage:"and those with the link"})," "]}),(0,k.jsx)(f().sA,{id:"CollectionSettingsSyncedContentShare.option.share.caption.accessToIntegration",defaultMessage:"will get access to content synced from {integrationName}",values:{integrationName:s}})]}),P=(0,k.jsx)(xa().Ye,{style:{marginTop:10},children:(0,k.jsx)(A().A,{style:{flex:"0 0 100%"},size:"lg",onClick:I,children:(0,k.jsx)(f().sA,{id:"CollectionSettingsSyncedContentShare.continueButton",defaultMessage:"Continue"})})}),B=(0,k.jsx)(xa().Ye,{style:{paddingBottom:24},alignItems:"center",justifyContent:"center",children:(0,k.jsx)("img",{style:{width:40},src:c})}),V=(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:void 0,sections:[{key:"grant_permissions",items:[{key:"allow",action:()=>null,render:e=>(0,k.jsx)(Pe().A,{...e,textWrapperStyle:{textAlign:"left"},title:(0,k.jsx)(f().sA,{id:"CollectionSettingsSyncedContentShare.option.share.title",defaultMessage:"Anyone on this page"}),shouldWrapCaption:!0,caption:T,icon:(0,k.jsx)(va().A,{isSelected:!h}),onClick:()=>{x(!1)}})},{key:"restrict",action:()=>null,render:e=>(0,k.jsx)(Pe().A,{...e,textWrapperStyle:{textAlign:"left"},title:(0,k.jsx)(f().sA,{id:"CollectionSettingsSyncedContentShare.option.restrict.title",defaultMessage:"Only you"}),shouldWrapCaption:!0,caption:(0,k.jsx)(f().sA,{id:"CollectionSettingsSyncedContentShare.option.restrict.caption",defaultMessage:"You'll need to share with others using the share menu"}),icon:(0,k.jsx)(va().A,{isSelected:h}),onClick:()=>{x(!0)}})}],render:e=>(0,k.jsx)(ae().A,{...e})}]});return(0,k.jsx)(y().Ay,{collectionSettingsStore:t,fullHeight:d,children:(0,k.jsxs)(xa().Ye,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0px 16px 16px 16px"},flexDirection:"column",children:[B,(0,k.jsxs)("div",{children:[M,V]}),P]})})}const ba=n.memo(Ca,Ur().A);function wa(e){return{color:e.text.primary,fontWeight:le().Wy.semibold,fontSize:14}}var ja=()=>o(187899),Aa=()=>o(589531);function _a(e){const{context:t,collectionSettingsStore:o,collectionContextStore:i}=e,s=(0,r().v3)(),a=(0,l().O$)(i.normalizedSchemaStore),c=(0,l().O$)(i.normalizedFormatStore),d=(0,l().O$)(i.permissionScopesStore),p=(0,l().K8)((()=>(0,Ai().S2)(i)),[i]),g=(0,l().K8)((()=>{const e=i.collectionViewStore();return e?(0,Ai().LQ)({schema:a,filters:Ta(i),getRecordModel:e.getRecordModel}):[]}),[i,a]),m=(0,l().K8)((()=>i.contextType),[i]),S=(0,n.useCallback)((e=>{if(!e)return;const n=ja().m({property:e,collectionContextStore:i,environment:s,schema:a});n&&function(e,t,o,n,i){if((0,er().X)({environment:i,collectionContextStore:t,action:"create_property_filter"}),o===Gr().Bd.FilterBar||o===Gr().Bd.TopbarFilterPopup){Ma(t,n);const o=t.getFilterBarItemSettingsStore(e);u().R8({collectionSettingsStore:o,item:{type:"filter"}})}else if(o===Gr().Bd.ViewSettings){ka(n);const o=t.getFilterOptionsItemSettingsStore(e);u().R8({collectionSettingsStore:o,item:{type:"filter"}})}}(n,i,t,o,s)}),[i,o,t,s,a]),h=(0,n.useCallback)((()=>{ja().x1({collectionContextStore:i,environment:s}),function(e,t,o,n){(0,er().X)({environment:n,collectionContextStore:e,action:"create_combinator_filter"}),t===Gr().Bd.FilterBar||t===Gr().Bd.TopbarFilterPopup?(Ma(e,o),u().R8({collectionSettingsStore:e.filterBarCombinatorFilterSettingsStore,item:{type:"filter"}})):t===Gr().Bd.ViewSettings&&(ka(o),u().R8({collectionSettingsStore:e.filterOptionsCombinatorFilterSettingsStore,item:{type:"filter"}}))}(i,t,o,s)}),[i,o,t,s]);return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Add filter",id:"database.viewSettings.createFilterTab.title"}),footer:d.canConfigureBlock&&"collectionSettings"!==m&&(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(kt().A,{icon:p>0?Bo().S:x().plusIcon,isGray:!0,title:p>0?(0,k.jsx)(f().sA,{...Aa().D.advancedFilterTitle}):(0,k.jsx)(f().sA,{...Aa().D.addAdvancedFilterTitle}),right:p>0&&(0,k.jsx)(f().sA,{...Aa().D.advancedFilterRulesCount,values:{ruleCount:p}}),onClick:h})}),children:(0,k.jsx)(C().A,{schema:a,format:c,getProperties:()=>g.map((e=>e.property)),onAccept:S,inputPlaceholder:jt().A.formatMessage(Aa().D.inputPlaceholder)})})}const Ia=n.memo(_a,Ur().A);function Ma(e,t){e.filtersBarOpenStore.setState(!0),u().yl({collectionSettingsStore:t})}function ka(e){u().R8({collectionSettingsStore:e,item:{type:"main"}}),u().a2({collectionSettingsStore:e,item:{type:"filters"}})}function Ta(e){return e.currentPropertyFiltersStore.state}const Pa=(0,f().YK)({inputPlaceholder:{defaultMessage:"Sort by…",id:"database.viewSettings.createSortTab.inputPlaceholder"}});const Ba=function(e){const{context:t,collectionContextStore:n,collectionSettingsStore:i}=e,s=(0,r().v3)(),a=(0,f().tz)(),c=(0,l().O$)(n.normalizedSchemaStore),d=(0,l().O$)(n.normalizedFormatStore),p=(0,l().K8)((()=>Va(n)),[n]);return(0,k.jsx)(y().Ay,{...e,collectionSettingsStore:i,title:(0,k.jsx)(f().sA,{defaultMessage:"New sort",id:"database.viewSettings.createSortTab.title"}),children:(0,k.jsx)(C().A,{schema:c,format:d,getProperties:()=>Object.entries(c).filter((e=>{let[t,n]=e;return!p.find((e=>e.property===t))&&(0,o(244149).oH)(n)})).map((e=>{let[t]=e;return t})),onAccept:e=>function(e,t,o,n,i){var r;if(!e)return;const l=o.collectionViewStore(),s=o.normalizedSchemaStore.state;if(!l||!s)return;const a=null===(r=s[e])||void 0===r?void 0:r.type;(0,er().X)({environment:t,collectionContextStore:o,action:"create_sort_accept",original_view_type:l.getType(),property_type:a});const c={property:e,direction:"ascending"},d=[...Va(o),c];if(ja().IU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,sorts:{value:d}}}),n===Gr().Bd.TopbarSortPopup||n===Gr().Bd.FilterBar){o.filtersBarOpenStore.setState(!0),u().yl({collectionSettingsStore:i});const{filterBarSortSettingsStore:e}=o;u().R8({collectionSettingsStore:e,item:{type:"sort"}})}else n===Gr().Bd.ViewSettings?(u().R8({collectionSettingsStore:i,item:{type:"main"}}),u().a2({collectionSettingsStore:i,item:{type:"sort"}})):n===Gr().Bd.MobileSheet&&u().a2({collectionSettingsStore:i,item:{type:"sort"}})}(e,s,n,t,i),inputPlaceholder:a.formatMessage(Pa.inputPlaceholder)})})};function Va(e){return e.currentSortsStore.state}var Fa=()=>o(476492),Ea=()=>o(406792);const Ra=function(e){const{collectionContextStore:t,context:n,collectionSettingsStore:i}=e,s=(0,r().v3)(),a=(0,l().K8)((()=>t.collectionViewStore()),[t]),c=(0,l().O$)(t.normalizedSchemaStore),d=(0,l().K8)((()=>function(e){return e.currentCombinatorFilterStore.state}(t)),[t]),p=(0,l().K8)((()=>null==a?void 0:a.getType()),[a]);return a&&d&&p?(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Advanced filter",id:"database.viewSettings.filterTab.title"}),unconstrainedWidth:!0,children:[(0,k.jsx)(o(44935).i,{children:(0,k.jsx)(o(870988).tY,{index:0,level:0,combinatorFilter:d,schema:c,onChange:(e,o)=>function(e,t,o,n,i,r){var l,s;const a=null===(l=n.remoteResultStore.state)||void 0===l?void 0:l.sizeHint,c=Ea().default.DO_NOT_USE_markLegacy("collections.update_filter_lag");Ea().default.DO_NOT_USE_measureAfterNextFlushLegacy(c,{environment:o,getData:()=>Fa().K6({from:"combinator_filter",collectionContextStore:n,sizeHintAtStart:a})}),ja().IU({environment:o,collectionContextStore:n,temporaryState:{...n.temporaryStateStore.state,combinatorFilter:{value:t}}}),0===(null===(s=t.filters)||void 0===s?void 0:s.length)&&r===Gr().Bd.MobileSheet&&u().yl({collectionSettingsStore:i});(0,er().X)({environment:o,collectionContextStore:n,action:"update_combinator_filter"})}(0,o,s,t,i,n),collectionContextStore:t,collectionViewType:p,collectionViewId:a.id,parentStore:a})}),(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(kt().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Delete filter",id:"database.viewSettings.filterTab.deleteFilterButton.title"}),isRed:!0,icon:hl().trashIcon,onClick:()=>function(e,t,o,n){ja().IU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,combinatorFilter:{value:void 0}}}),o===Gr().Bd.FilterBar?u().os({collectionSettingsStore:n}):o===Gr().Bd.MobileSheet&&u().yl({collectionSettingsStore:n});(0,er().X)({environment:e,collectionContextStore:t,action:"delete_combinator_filter"})}(s,t,n,i)})})]}):null};var Da=()=>o(300089),Ka=()=>o(57232),Oa=()=>o(615950),La=()=>o(289915),za=()=>o(222334),Na=()=>o(582684),Ua=()=>o(212727),Wa=()=>o(866913),Ha=()=>o(704452),$a=()=>o(637558),Ga=()=>o(700251),Qa=()=>o(838364);function Za(e){const{collectionSettingsStore:t,collectionContextStore:o,viewType:n}=e,i=(0,l().K8)((()=>(0,Ai().tG)(o)),[o]),r=(0,l().K8)((()=>(0,Ai().S2)(o)),[o]),s=(0,l().K8)((()=>{switch(n){case"filterAndSort":return(0,Ai().ye)(o)||(0,Ai().gv)(o);case"filter":return(0,Ai().ye)(o);default:(0,In().HB)(n)}}),[o,n]),a=(0,k.jsx)(Ya,{collectionSettingsStore:t,collectionContextStore:o,activeFilterCount:r}),c=(0,k.jsx)(Ja,{collectionContextStore:o}),d=(0,S().IS)((()=>({menuScroller:{paddingBottom:Qa().Hc}})),[]);return(0,k.jsx)(y().Ay,{collectionSettingsStore:t,title:i>0?(0,k.jsx)(f().sA,{...Aa().D.numberOfFiltersTitle,values:{numberOfFilters:i}}):(0,k.jsx)(f().sA,{...Aa().D.noFiltersTitle}),menuScrollerStyle:d.menuScroller,children:(0,k.jsxs)("div",{children:[s?(0,k.jsx)(Oa().Ay,{context:tc(n),collectionContextStore:o}):null,"filterAndSort"===n&&(0,k.jsx)(qa,{collectionContextStore:o,collectionSettingsStore:t}),r>0?(0,k.jsxs)(k.Fragment,{children:[a,c]}):(0,k.jsxs)(k.Fragment,{children:[c,a]})]})})}function qa(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const i=(0,r().v3)(),s=(0,l().O$)(o.normalizedSchemaStore),a=(0,l().O$)(o.currentSortsStore),c=a.length>0,d=(0,l().K8)((()=>Boolean(o.localStateDiffStore.state.sorts)),[o]),p=ec({isActive:c}),g=(0,n.useCallback)((()=>{(0,er().X)({environment:i,collectionContextStore:o,action:"click_sort"}),u().a2({collectionSettingsStore:t,item:{type:c?"sort":"createSort"}})}),[c,o,i,t]);return(0,k.jsx)(ae().A,{children:(0,k.jsx)(Pe().A,{title:(0,k.jsx)(f().sA,{...Aa().D.sortTitle}),titleStyle:p.title,icon:(0,k.jsxs)("div",{style:p.iconContainer,children:[(0,Na().C)(p.icon),d&&(0,k.jsx)("div",{style:p.diffDot})]}),rightStyle:p.right,right:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:p.filterValue,children:(0,k.jsx)($a().v,{currentSorts:a,schema:s})}),(0,za().arrowChevronSingleRightIcon)(p.chevronIcon)]}),onClick:g,focused:!1})})}function Ya(e){let{collectionSettingsStore:t,collectionContextStore:o,activeFilterCount:i}=e;const s=(0,r().v3)(),a=i>0,c=(0,l().K8)((()=>Boolean(o.localStateDiffStore.state.combinatorFilter)),[o]),d=ec({isActive:a}),p=(0,n.useCallback)((()=>{(0,er().X)({environment:s,collectionContextStore:o,action:"click_combinator_filter"}),ja().x1({collectionContextStore:o,environment:s}),u().a2({collectionSettingsStore:t,item:{type:"filter"}})}),[o,s,t]);return(0,k.jsx)(ae().A,{children:(0,k.jsx)(Pe().A,{title:(0,k.jsx)(f().sA,{...Aa().D.advancedFilterTitle}),titleStyle:d.title,icon:(0,k.jsxs)("div",{style:d.iconContainer,children:[(0,Ua().gearIcon)(d.icon),c?(0,k.jsx)("div",{style:d.diffDot}):null]}),rightStyle:d.right,right:(0,k.jsxs)(k.Fragment,{children:[a&&(0,k.jsx)("div",{style:d.filterValue,children:(0,k.jsx)(f().sA,{...Aa().D.advancedFilterRulesCount,values:{ruleCount:i}})}),(0,za().arrowChevronSingleRightIcon)(d.chevronIcon)]}),onClick:p,focused:!1})})}function Ja(e){let{collectionContextStore:t}=e;const o=(0,r().v3)(),i=(0,f().tz)(),s=(0,l().O$)(t.normalizedSchemaStore),a=(0,l().O$)(t.normalizedFormatStore),c=(0,l().K8)((()=>t.collectionViewStore()),[t]),d=(0,l().K8)((()=>{if(!c)return[];const e=t.currentPropertyFiltersStore.state;return[...new Set([...e.map((e=>e.filter)),...(0,Ai().LQ)({schema:s,filters:e,getRecordModel:c.getRecordModel})])].map((e=>e.property))}),[c,s,t]),p=(0,n.useCallback)((e=>{var n;if(!e)return;const i=ja().m({property:e,collectionContextStore:t,environment:o,schema:s});if(!i)return;(0,er().X)({environment:o,collectionContextStore:t,action:"click_property_filter",original_view_type:void 0,property_type:null===(n=s[e])||void 0===n?void 0:n.type});const r=t.getFilterOptionsItemSettingsStore(i);u().R8({collectionSettingsStore:r,item:{type:"filter"}})}),[t,o,s]),g=(0,Ga().y$)(),m=(0,S().IS)((e=>({leftIcon:{fill:e.icon.secondary,marginLeft:6,marginRight:6,width:g,height:g}})),[g]);return(0,k.jsx)(C().A,{schema:s,format:a,getProperties:()=>d,onAccept:p,disableSortByPageFormat:!0,inputPlaceholder:i.formatMessage(Aa().D.propertyInputPlaceholder),inputLeft:(0,k.jsx)(Fe().I,{icon:Bo().S,style:m.leftIcon}),renderProperty:(e,o,n,i)=>c?(0,k.jsx)(Xa,{schema:s,collectionViewStore:c,collectionContextStore:t,property:o,propertySchema:i,onClick:e.onClick,focused:!1}):null})}function Xa(e){const{propertySchema:t,schema:o,collectionViewStore:i,collectionContextStore:s,property:a}=e,c=(0,r().v3)(),{name:d,type:p,icon:g}=t,[m,f,y]=(0,l().K8)((()=>{const e=s.currentPropertyFiltersStore.state.find((e=>e.filter.property===a));return[e,null==e?void 0:e.filter,null==e?void 0:e.id]}),[s,a]),h=Boolean(y&&(0,Ai().vu)(y)),x=f&&!(0,La().t_)(f),v=(0,l().K8)((()=>{if(!y)return!1;const e=s.localStateDiffStore.state;return e.filters.updated.includes(y)||e.filters.added.includes(y)&&x}),[s,y,x]),C=Boolean((null==t?void 0:t.icon)&&(0,qt().T8)(t.icon)),b=ec({isActive:Boolean(x),isCustomIcon:C}),w=(0,S().DP)(),j=(0,l().K8)((()=>m?s.getFilterOptionsItemSettingsStore(m):null),[s,m]),A=(0,n.useCallback)((()=>{j&&(ja().H2({environment:c,collectionContextStore:s}),u().os({collectionSettingsStore:j}))}),[j,c,s]),_=(0,l().K8)((()=>!!j&&j.state.open),[j]),I=(0,n.useCallback)((()=>j&&m?(0,k.jsx)(Wa().q,{collectionContextStore:s,collectionSettingsStore:j,collectionViewStore:i,context:Da().aV.SettingsFilters,filter:m,schema:o}):null),[s,j,m,i,o]),M=(0,n.useCallback)((()=>(0,k.jsx)(Pe().A,{title:d,titleStyle:b.title,icon:(0,k.jsxs)("div",{style:b.iconContainer,children:[(0,k.jsx)(ue().zB,{icon:g,type:p,size:b.icon.width,theme:w,style:b.icon}),v&&(0,k.jsx)("div",{style:b.diffDot})]}),disabled:h,rightStyle:b.right,right:(0,k.jsxs)(k.Fragment,{children:[x&&(0,k.jsx)(Ha().A,{propertyFilter:f,schema:o,valueOnly:!0,parentStore:i,style:b.filterValue}),!h&&(0,za().arrowChevronSingleRightIcon)(b.chevronIcon)]}),...e})),[i,v,g,x,h,d,f,e,o,b,w,p]);return(0,k.jsx)(bn().Ay,{popupType:Wt().n.BottomSheet,open:_,trapFocus:!0,onDismiss:A,render:I,origin:M()})}function ec(e){let{isActive:t,isCustomIcon:o}=e;const n=(0,Ga().y$)({type:o?"custom":"system"});return(0,S().IS)((e=>({icon:{fill:t?e.icon.uiBluePrimary:void 0,marginLeft:2,marginRight:2,width:n},iconContainer:{position:"relative"},title:{color:t?e.text.uiBluePrimary:e.text.primary,marginRight:4,...le().RC},right:{display:"flex",alignItems:"center",justifyContent:"end",color:e.text.tertiary,fill:e.icon.tertiary,maxWidth:"50%"},filterValue:{...le().RC},chevronIcon:{width:20,fill:e.icon.tertiary,marginLeft:4},diffDot:{position:"absolute",top:-1,right:-1,background:e.icon.orangePrimary,border:`1px solid ${e.contentBackground}`,width:8,height:8,borderRadius:8}})),[t,n])}function tc(e){switch(e){case"filterAndSort":return Oa().$J.SettingsFiltersAndSort;case"filter":return Oa().$J.SettingsFilters;default:(0,In().HB)(e)}}function oc(e){const{isMobile:t}=(0,r().Y0)();return(0,lo().X)("db_ux_mobile_filter_sheet")&&t?(0,k.jsx)(Za,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore,viewType:"filter"}):(0,k.jsx)(nc,{...e})}const nc=n.memo((function(e){const{isMobile:t}=(0,r().Y0)(),{collectionSettingsStore:s,collectionContextStore:a}=e,c=(0,r().v3)(),[d,p,g,m]=(0,l().K8)((()=>[a.currentPropertyFiltersStore.state,a.currentPropertyFiltersStore.state.map((e=>e.id)),a.permissionScopesStore.state,(0,Ai().I6)(a)]),[a]),h=(0,o(396182).I)(),x=(0,l().K8)((()=>(0,o(37489).H)(a)?a.currentCombinatorFilterStore.state:void 0),[a]),v=(0,n.useCallback)((e=>{u().os({collectionSettingsStore:a.filterOptionsCombinatorFilterSettingsStore}),d.filter((t=>!e||t.id!==e)).forEach((e=>{const t=a.getFilterOptionsItemSettingsStore(e);u().os({collectionSettingsStore:t})}))}),[a,d]);(0,n.useEffect)((()=>{t||v()}),[t]);const C=(0,S().IS)((e=>({menuItem:{color:e.text.secondary},menuItemIcon:{width:14,marginLeft:4,marginRight:4,fill:e.icon.secondary},mobile:{paddingTop:8,background:e.contentBackground}})),[]);return(0,k.jsx)("div",{onClick:e=>{(0,i().SQ)({event:e,context:i().y$.Click,callback:v})},children:(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Filters",id:"database.viewSettings.filtersTab.title"}),footer:m&&(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(ic,{collectionContextStore:a})}),unconstrainedWidth:!0,children:(0,k.jsxs)(ae().A,{children:[(p.length>0||x)&&(0,k.jsxs)("div",{style:c.device.isMobile?C.mobile:void 0,children:[x&&(0,k.jsx)(lc,{collectionContextStore:a}),rc(c)?(0,k.jsx)(o(439264).Ay,{direction:"vertical",keys:p,renderKey:e=>{const t=p.indexOf(e);return(0,k.jsx)(sc,{collectionContextStore:a,filter:d[t],onClick:v})},onDrop:e=>function(e,t,o){const n=o.collectionViewBlockStore();if(!n)return;const i=o.currentPropertyFiltersStore.state,r=eo().oE(e.map((e=>i.find((t=>t.id===e)))));ja().IU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,propertyFilters:{value:r}}}),(0,er().X)({environment:t,collectionContextStore:o,action:"reorder_filters"})}(e,c,a),onDragEnd:()=>h("CollectionSettingsViewDesktopFilters","CollectionSettingsViewDesktopFilters/onDragEnd"),disabled:!g.canConfigureBlock}):p.map((e=>{const t=p.indexOf(e);return(0,k.jsx)(sc,{collectionContextStore:a,filter:d[t],onClick:v},e)}))]}),(0,k.jsx)(Pe().A,{focused:!1,icon:(0,ur().W)(C.menuItemIcon),style:C.menuItem,title:(0,k.jsx)(f().sA,{defaultMessage:"Add filter",id:"database.viewSettings.filtersTab.newFilter.title"}),onClick:()=>{v(),function(e,t,o){(0,er().X)({environment:e,collectionContextStore:o,action:"click_new_filter"}),u().a2({collectionSettingsStore:t,item:{type:"createFilter"}}),o.filtersBarOpenStore.setState(!0)}(c,s,a)}})]})})})}));function ic(e){let{collectionContextStore:t}=e;return(0,k.jsx)(Oa().Ay,{context:Oa().$J.SettingsFilters,collectionContextStore:t})}function rc(e){return!e.device.isMobile}function lc(e){let{collectionContextStore:t}=e;const n=(0,r().v3)();return(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[rc(n)&&(0,k.jsx)(Ka().A,{iconSize:12,style:{marginLeft:6,marginRight:6,opacity:.4,cursor:void 0}}),(0,k.jsx)(o(958832).l,{context:Da().aV.SettingsFilters,collectionContextStore:t,collectionSettingsStore:t.filterOptionsCombinatorFilterSettingsStore})]})}function sc(e){let{filter:t,collectionContextStore:n,onClick:i}=e;const s=(0,r().v3)(),a=(0,l().K8)((()=>n.getFilterOptionsItemSettingsStore(t)),[n,t]);return(0,k.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[rc(s)&&(0,k.jsx)(Ka().A,{iconSize:12,style:{marginLeft:6,marginRight:6}}),(0,k.jsx)(o(602141).A,{id:t.id,context:Da().aV.SettingsFilters,collectionContextStore:n,collectionSettingsStore:a,onClick:i},t.id)]})}const ac={viewBox:"0 0 16 16",fittedViewBox:"1.37 1.37 13.25 13.25",svg:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("path",{d:"M9.75 7.125a.625.625 0 0 0-.625.625v1.375H7.75a.625.625 0 1 0 0 1.25h1.375v1.375a.625.625 0 1 0 1.25 0v-1.375h1.375a.625.625 0 1 0 0-1.25h-1.375V7.75a.625.625 0 0 0-.625-.625"}),(0,k.jsx)("path",{d:"M3.25 1.375c-1.036 0-1.875.84-1.875 1.875v6c0 1.036.84 1.875 1.875 1.875h1.625v1.625c0 1.036.84 1.875 1.875 1.875h6c1.036 0 1.875-.84 1.875-1.875v-6c0-1.036-.84-1.875-1.875-1.875h-1.625V3.25c0-1.036-.84-1.875-1.875-1.875zM2.625 3.25c0-.345.28-.625.625-.625h6c.345 0 .625.28.625.625v1.625H6.75c-1.036 0-1.875.84-1.875 1.875v3.125H3.25a.625.625 0 0 1-.625-.625zm3.5 3.5c0-.345.28-.625.625-.625h6c.345 0 .625.28.625.625v6c0 .345-.28.625-.625.625h-6a.625.625 0 0 1-.625-.625z"})]})},cc=(0,pn().wt)("squareOnSquarePlusSmall",ac);var dc=()=>o(152077),uc=()=>o(124749),pc=()=>o(457190),gc=()=>o(518773);var mc=()=>o(131849);function Sc(e){const{collectionSettingsStore:t,collectionContextStore:o,fullHeight:n}=e,i=(0,r().v3)(),s=(0,l().K8)((()=>o.collectionViewBlockStore()),[o]),a=(0,l().O$)(ce().AppStoreCurrentSpaceStore),c=function(e){let{teamStore:t,collectionViewBlockStore:o}=e;const n=(0,l().K8)((()=>null==t?void 0:t.isDefined()),[t]),{isExplicitlySubscribedToFeed:i,isExplicitlyUnsubscribedToFeed:r,followDataIsLoaded:s}=(0,l().K8)((()=>{const e=null==o?void 0:o.getFollowStore();return{followDataIsLoaded:null==e?void 0:e.isReady(),isExplicitlySubscribedToFeed:null==e?void 0:e.isExplicitlySubscribedToFeed(),isExplicitlyUnsubscribedToFeed:null==e?void 0:e.isExplicitlyUnsubscribedToFeed()}}),[o]),a=(0,mc().a)(t);if(!s||!n)return;return i||a&&!r}({teamStore:(0,l().K8)((()=>{var e;const t=null===(e=o.collectionStore())||void 0===e?void 0:e.id;if(t&&a)return ct().sk.createChildStore(a,{table:"team",id:t,spaceId:a.id})}),[o,a]),collectionViewBlockStore:s}),d=function(e){let{collectionViewBlockStore:t}=e;const{isExplicitlySubscribedToFeed:o,followDataIsLoaded:n}=(0,l().K8)((()=>{const e=null==t?void 0:t.getFollowStore();return{followDataIsLoaded:null==e?void 0:e.isReady(),isExplicitlySubscribedToFeed:null==e?void 0:e.isExplicitlySubscribedToFeed()}}),[t]);if(n)return o}({collectionViewBlockStore:s}),u=(0,dc().Vs)(),p=u?d:c,g=!u&&void 0===p,m=(0,l().K8)((()=>null==s?void 0:s.getModel()),[s]),S=(0,uc().$)();return(0,k.jsx)(y().Ay,{collectionSettingsStore:t,fullHeight:n,title:(0,k.jsx)(f().sA,{defaultMessage:"Your Feed settings",id:"database.viewSettings.followTab.title"}),desktopTitleType:"sectionHeader",children:(0,k.jsx)(ae().A,{children:(0,k.jsx)(Uo().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Follow",id:"database.viewSettings.followMenuItem.title"}),icon:cc({width:pn().Ev.sm,height:pn().Ev.sm}),on:Boolean(p),focused:!1,disabled:g,onClick:()=>{!function(e,t,o,n,i){if(!t||!o||!n)return;const r=i?"unsubscribed":"subscribed",l=t.getFollowSettingsKey(),{following:s,followSettings:a}=(0,gc().A)(l,r);pc().v({environment:e,followSettings:a,following:s,navigableBlockId:t.id,userId:o.id,spaceId:t.getSpaceId(),key:l,selectedKey:l,from:"more_menu"})}(i,s,S,m,Boolean(p))}})})})}var fc=()=>o(812480),yc=()=>o(921598),hc=()=>o(632537),xc=()=>o(673900);const vc=function(e){let{numberGroupBy:t,collectionContextStore:o,schema:n,onChange:i}=e;const r=(0,S().DP)(),s=n[t.property];return(0,l().K8)((()=>o.collectionStore()),[o])&&s?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ae().A,{topBorder:!1,disableMobileBorders:!0,title:(0,k.jsx)(f().sA,{id:"database.groupMenu.numberGroupRange",defaultMessage:"Group range"}),children:(0,k.jsxs)("div",{style:{display:"flex",paddingLeft:14,paddingRight:14},children:[(0,k.jsx)(Cc,{onChange:i,numberGroupBy:t,inputKey:"start"}),(0,k.jsx)("span",{style:{color:r.text.secondary,margin:"0 8px"},children:"–"}),(0,k.jsx)(Cc,{onChange:i,numberGroupBy:t,inputKey:"end"})]})}),(0,k.jsx)(ae().A,{topBorder:!1,disableMobileBorders:!0,title:(0,k.jsx)(f().sA,{id:"database.groupMenu.numberGroupSize",defaultMessage:"Group every"}),children:(0,k.jsxs)("div",{style:{paddingLeft:14,paddingRight:14},children:[(0,k.jsx)(Cc,{onChange:i,numberGroupBy:t,inputKey:"size"}),(0,k.jsxs)("span",{style:{color:r.text.secondary,fontSize:12},children:[(0,k.jsx)(hc().d,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start,end:t.start+t.size}}},schema:n,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o,source:"collection_settings"}),", ",(0,k.jsx)(hc().d,{disabled:!0,groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start+t.size,end:t.start+2*t.size}}},schema:n,currentGroups:[],isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o,source:"collection_settings"}),", ..."]})]})})]}):null};function Cc(e){let{numberGroupBy:t,inputKey:o,onChange:n}=e;return(0,k.jsx)(xc().v,{value:t[o],onChange:e=>{void 0!==e&&("size"===o&&e<=0&&(e=1),"start"===o&&e>t.end&&(e=t.end),"end"===o&&e<t.start&&(e=t.start),n({newNumberGroupBy:{...t,[o]:e}}))}})}const bc=function(e){return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(wc,{collectionSettingsStore:e.collectionSettingsStore,collectionContextStore:e.collectionContextStore}),children:(0,k.jsx)(jc,{groupByKey:e.groupByKey,groupsFormatKey:e.groupsFormatKey,collectionContextStore:e.collectionContextStore})})};function wc(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const n=(0,l().K8)((()=>(0,ui().S)(t)),[t]),i=(0,l().O$)(o.normalizedSchemaStore),r=(0,l().O$)(o.normalizedFormatStore);if(!n||"groupByNumber"!==n.type||"chart_config"===n.groupByKey)return null;const s=r[n.groupByKey];return s?(0,fc().hC)({groupBy:s,schema:i})??null:null}function jc(e){let{groupByKey:t,groupsFormatKey:o,collectionContextStore:n}=e;const i=(0,r().v3)(),s=(0,l().K8)((()=>n.collectionViewStore()),[n]),a=(0,l().O$)(n.normalizedSchemaStore),c=(0,l().O$)(n.normalizedFormatStore),d=(0,l().K8)((()=>(0,yc().H2)(c,t,o)),[c,t,o]);if(!d||!s)return null;const u=(0,fc().bO)(d);return u?(0,k.jsx)(vc,{numberGroupBy:u,schema:a,onChange:e=>{if("number"===d.type)g().createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:i,canUndo:!0,perform:n=>{p().zA({stores:[s],update:{[t]:e.newNumberGroupBy,[o]:void 0},transaction:n})}});else if("formula"===d.type){const n=eo().cJ(e.newNumberGroupBy,"property"),r={...d,groupBy:n};g().createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:i,canUndo:!0,perform:e=>{p().zA({stores:[s],update:{[t]:r,[o]:void 0},transaction:e})}})}(0,er().X)({environment:i,collectionContextStore:n,action:"group_by_number_update",original_view_type:void 0,property_type:d.type})},collectionContextStore:n}):null}const Ac=n.memo((function(e){const{collectionContextStore:t,collectionSettingsStore:i,groupByKey:s,groupsFormatKey:a}=e,c=(0,r().v3)(),d=(0,l().K8)((()=>(0,ui().S)(i)),[i]),m=(0,l().K8)((()=>t.collectionViewBlockStore()),[t]),S=(0,l().K8)((()=>t.collectionViewStore()),[t]),f=(0,l().K8)((()=>null==S?void 0:S.getType()),[S]),h=(0,l().K8)((()=>(0,yc().H2)(t.normalizedFormatStore.state,s,a)),[t,s,a]),x=(0,l().O$)(t.normalizedSchemaStore),v=(0,l().O$)(t.normalizedFormatStore),b=(0,l().K8)((()=>void 0!==f&&(0,o(10594).Qt)({viewType:f,groupByKey:s})),[s,f]),w=(0,n.useCallback)((()=>Object.entries(x).sort(_c).map((e=>e[0])).filter((e=>{const t=x[e];return t&&(0,yc().Eg)(t)}))),[x]),j=(0,n.useCallback)((e=>{const o=t.collectionViewStore();if(o){if(e){const n=x[e];if(!n||!(0,yc().Eg)(n))return;const i=(0,yc().V0)({property:e,propertySchema:n,isCollectionTypedView:"collectionTypedView"===t.contextType});g().createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:c,canUndo:!0,perform:e=>{p().zA({stores:[o],update:{[s]:i,[a]:void 0},transaction:e})}}),(0,er().X)({environment:c,collectionContextStore:t,action:"group_by_property_accept",original_view_type:void 0,property_type:n.type})}else g().createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:c,canUndo:!0,perform:e=>{p().zA({stores:[o],update:{[s]:void 0,[a]:void 0},transaction:e})}}),(0,er().X)({environment:c,collectionContextStore:t,action:"group_by_property_accept"});u().R8({collectionSettingsStore:i,item:{type:"main"}}),u().a2({collectionSettingsStore:i,item:{type:"group",groupByKey:s,groupsFormatKey:a}})}}),[t,i,s,a,x,c]),A=(0,n.useMemo)((()=>d&&"groupByProperty"===d.type&&f?(0,fc().rq)(d.groupByKey,f):null),[d,f]);return m&&S&&d&&f&&"groupByProperty"===d.type?(0,k.jsx)(y().Ay,{...e,collectionSettingsStore:i,title:A,children:(0,k.jsx)(C().A,{schema:x,format:v,currentProperty:null==h?void 0:h.property,showNoneOption:b,getProperties:w,onAccept:j})}):null}));function _c(e,t){var o,n;const i=null==e||null===(o=e[1])||void 0===o?void 0:o.name,r=null==t||null===(n=t[1])||void 0===n?void 0:n.name;return void 0!==i&&void 0!==r?i.localeCompare(r,void 0,{sensitivity:"base"}):void 0!==i?1:void 0!==r?-1:0}var Ic=()=>o(265504);const Mc=(0,f().j4)((function(e){const t=(0,l().K8)((()=>{const t=e.collectionContextStore.collectionViewStore();return"chart"===(null==t?void 0:t.getType())}),[e.collectionContextStore]),o=(0,Nl().a)();return(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Layout",id:"database.viewSettings.layoutTab.title"}),desktopWidth:o?280:290,children:(0,k.jsx)(Ic().A,{...e,showDoneButton:t,menuType:"editViewLayout"})})}));function kc(e){return(0,k.jsx)(Za,{...e,viewType:"filterAndSort"})}var Tc=()=>o(174638),Pc=()=>o(690471),Bc=()=>o(259464);const Vc=110,Fc=210,Ec=223,Rc=25,Dc=87;function Kc(e){const{propertyName:t}=e,o=(0,S().DP)(),n=(0,S().IS)((e=>({dependenciesPreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:6,alignItems:"center",position:"relative",height:112,paddingLeft:19},svgContainer:{position:"absolute",width:"100%",height:"100%"},svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:Pc().cC},dependencyPropertyNamePreview:{fontSize:12,position:"absolute",background:e.buttonBackground,top:48,left:96},timelineItemPreview:{padding:4,margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderRadius:5,background:e.cardBackground,boxShadow:e.buttonBoxShadow,width:100,justifyContent:"center"}})),[]);return(0,k.jsx)(ae().A,{children:(0,k.jsxs)("div",{style:n.dependenciesPreviewOutsideBorder,children:[(0,k.jsxs)("svg",{style:n.svgContainer,children:[(0,k.jsx)(Bc().A,{startPoint:{x:Vc,y:Rc},endPoint:{x:Vc,y:Dc},style:n.svgArrowTheme,showArrowHead:!0}),(0,k.jsx)(Bc().A,{startPoint:{x:Fc,y:Dc},endPoint:{x:Ec,y:Dc},style:n.svgArrowTheme,showArrowHead:!1}),(0,k.jsx)("circle",{cx:Ec,cy:Dc,r:Pc().w7,style:n.svgArrowTheme,fill:o.white})]}),(0,k.jsx)("div",{style:n.dependencyPropertyNamePreview,children:t}),(0,k.jsx)("div",{style:{...n.timelineItemPreview,marginTop:10,marginLeft:10},children:(0,k.jsx)("span",{children:"🌱"})}),(0,k.jsx)("div",{style:{...n.timelineItemPreview,marginTop:34,marginLeft:111},children:(0,k.jsx)("span",{children:"🌳"})})]})})}const Oc=(0,f().YK)({subitemInputPlaceholder:{defaultMessage:"Sub-tasks…",id:"database.viewSettings.relationsPropertyTab.subitemInputPlaceholder"},timelineArrowsByInputPlaceholder:{defaultMessage:"Dependencies…",id:"database.viewSettings.relationsPropertyTab.timelineArrowsByInputPlaceholder"}});const Lc=(0,f().j4)((function(e,t){const{collectionContextStore:i,collectionSettingsStore:s,formatSetting:a}=e,c=(0,r().Y0)(),d=(0,f().tz)(),m=(0,r().v3)(),h="collection_page_properties",[x]=(0,n.useState)("no_limit"),v="subitem"===a,w="timeline_arrows_by"===a,j=(0,l().K8)((()=>i.databaseType),[i]),A=(0,l().O$)(i.normalizedSchemaStore),_=(0,l().K8)((()=>i.collectionStore()),[i]),I=(0,l().K8)((()=>(null==_?void 0:_.getFormat())??{}),[_]),M=(0,l().K8)((()=>i.collectionViewStore()),[i]),T=(0,l().K8)((()=>null==M?void 0:M.getFormat()),[M]),P=(null==T?void 0:T.subitem_display_mode)??"show",B=(0,l().K8)((()=>{var e;return v?null===(e=i.currentSubitemFormatStoreForCollectionStore.state)||void 0===e?void 0:e.property:w?i.currentArrowsByFormatStore.state:void 0}),[i,v,w]),V=(0,l().K8)((()=>{var e,t;return v?null===(e=i.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.subitem_property:w?null===(t=i.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void 0}),[i,v,w]),F=(0,l().O$)(i.permissionScopesStore),E=(0,l().K8)((()=>Mi().uu(i,A)),[i,A]),R=(0,l().O$)(i.normalizedSchemaStore),K=(0,l().K8)((()=>{var e;const t=i.currentSubitemFormatStoreForCollectionStore.state,o=i.currentArrowsByFormatStore.state;let n;return v?n=t?A[t.property]:void 0:w&&(n=o?A[o]:void 0),null===(e=n)||void 0===e?void 0:e.name}),[i,A,v,w]),O=(0,l().K8)((()=>{const e=i.collectionStore();return null!=e&&e.isDefined()?Mi().$H(d,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:R,createUnique:!0,from:a}):d.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[i,R,d,a]),[z,N]=(0,n.useState)(K||O),U=(0,l().K8)((()=>{const e=i.currentSubitemFormatStoreForCollectionStore.state,t=i.currentArrowsByFormatStore.state;let o;if(v?o=e?A[e.property]:void 0:w&&(o=t?A[t]:void 0),o&&"relation"===o.type){var n;const e=o.property;return e?null===(n=A[e])||void 0===n?void 0:n.name:void 0}}),[i,A,v,w]),H=(0,l().K8)((()=>{const e=i.collectionStore();return null!=e&&e.isDefined()?Mi().zF(d,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:a}):d.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[i,d,a]),$=(0,l().K8)((()=>"title"===i.normalizedFormatStore.state.table_subitem_toggle_column),[i]),[G,Q]=(0,n.useState)({hasInverseRelation:!0,inverseName:U,autoRelate:{enabled:!1}}),[Z,q]=(0,n.useState)(0===E.length),Y=(0,l().uB)(void 0,L().A),J=(0,l().O$)(Y),X=(0,n.useCallback)((()=>Mi().uu(i,A)),[i,A]),ee=(0,n.useCallback)((e=>{if(e){const t=A[e];if(t&&"relation"===t.type){const e=t.property;if(e){const t=A[e];if(t&&G){const e=t.name;Q({hasInverseRelation:null==G?void 0:G.hasInverseRelation,inverseName:e,autoRelate:null==G?void 0:G.autoRelate})}}N(t.name)}}}),[A,G,N]),te=(0,n.useCallback)((e=>{const{collectionViewStore:t,newProperty:o,transaction:n}=e;v?(0,eo().b0)(t.getFormat().table_subitem_toggle_column)&&p().zA({stores:[t],update:{table_subitem_toggle_column:"title"},transaction:n}):w&&oa().Tq({collectionViewStore:t,newProperty:o,transaction:n})}),[v,w]),oe=(0,n.useCallback)((e=>{const{relationPropertyId:t,transaction:o}=e;v&&Ci().zt({environment:m,collectionContextStore:i,relationPropertyId:t,transaction:o}),w&&oa().L_({collectionContextStore:i,relationPropertyId:t,transaction:o})}),[v,w,m,i]),ne=(0,n.useCallback)((e=>{const t=i.collectionViewStore();t&&(g().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:m,canUndo:!0,perform:o=>{te({collectionViewStore:t,newProperty:e,transaction:o}),oe({relationPropertyId:e,transaction:o})}}),ee(e),q(!1),u().os({collectionSettingsStore:s}),(0,er().X)({action:v?"update_default_subitem":"update_default_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:i}))}),[i,m,q,ee,s,v,te,oe]),ie=(0,n.useCallback)((e=>{const t=i.collectionViewStore();t&&(g().createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:m,canUndo:!0,perform:o=>{te({collectionViewStore:t,newProperty:e,transaction:o})}}),ee(e),q(!1),u().os({collectionSettingsStore:s}),(0,er().X)({action:v?"update_subitem":"update_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:i}))}),[i,m,ee,s,v,te]),re=(0,n.useCallback)((()=>{fi().default.afterNextFlush((()=>{q(!0),Q({hasInverseRelation:!0,inverseName:H,autoRelate:{enabled:!1}}),N(O)}))}),[H,O]),le=(0,n.useCallback)((()=>{if(!G)return;const{hasInverseRelation:e,inverseName:t,autoRelate:o}=G,n=i.collectionStore(),r=n,l=i.collectionViewStore();n&&r&&(g().createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:m,canUndo:!0,perform:s=>{const c=ve().IL({environment:m,collectionStore:n,collectionViewArgs:l&&h?{collectionViewStore:l,format:l.getFormat(),formatKey:h}:void 0,propertyType:"relation",transaction:s});return ta().cT({environment:m,collectionContextStore:i,collectionStore:n,property:c,propertyName:z,targetCollectionStore:r,hasInverseRelation:e,inverseName:t,autoRelate:o,propertyLimit:x,intl:d,transaction:s,from:a}),l&&(te({collectionViewStore:l,newProperty:c,transaction:s}),oe({relationPropertyId:c,transaction:s})),c}}),u().yl({collectionSettingsStore:s}),u().a2({collectionSettingsStore:s,item:{type:"main"}}),(0,ea().Z)({environment:m,collectionContextStore:i,from:a,property_type:"relation"}))}),[i,m,s,h,d,x,z,G,a,te,oe]),se=(0,n.useCallback)((()=>{const e=i.collectionViewStore();e&&(tr().jP({environment:m,collectionViewStore:e,currentValue:i.normalizedFormatStore.state.table_subitem_toggle_column}),(0,er().X)({environment:m,collectionContextStore:i,action:"toggle_table_subitem_toggle_on_title"}))}),[i,m]),ce=!F.canConfigureBlock,de=(0,S().IS)((e=>({emptyStateText:{color:e.text.secondary,fontSize:14,margin:"0px 12px"},useExistingTitle:{fontSize:12,color:e.text.secondary,marginLeft:12,marginTop:12},existingRelationButton:{margin:"6px 12px 6px 12px",width:"auto"}})),[]);if(!_)return null;const ue=v&&F.canConfigureBlock&&K,pe=F.canConfigureCollection,ge=(e,t,n,r)=>(0,k.jsx)(o(148079).A,{version:"v1",menuProps:e,property:t,defaultProperty:V,isChecked:n,propertySchema:r,collectionContextStore:i,handleDefaultPropertySelect:ne,handlePropertySelect:ie});return(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{...(0,Ii().mv)({feature:a,databaseType:j})}),footer:(0,k.jsxs)(ae().A,{topBorder:E.length>0&&!Z,children:[ue&&!Z&&(0,k.jsx)(nr().A,{showImage:!ce,caption:jt().A.formatMessage(Ii().Ic.toggleNestingOnTitleMenuItemTooltip),tooltipImage:W().A.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,k.jsx)(Dl().A,{...e,icon:e=>(0,Xi().U)({width:pn().Ev.sm,height:pn().Ev.sm,marginLeft:4,marginRight:2}),title:(0,k.jsx)(f().sA,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),switcherProps:{disallowTabbing:!0,on:$},disabled:ce,onClick:se,isGray:!0})}),pe&&E.length>0&&!Z&&(0,k.jsx)(kt().A,{icon:ur().W,title:(0,k.jsx)(f().sA,{id:"database.viewSettings.subitemTab.newRelation",defaultMessage:"Create new relation"}),isGray:!0,onClick:re}),!Z&&(0,k.jsx)(k.Fragment,{children:F.canConfigureBlock&&!F.canConfigureCollection?(0,k.jsx)(kt().A,{title:(0,k.jsx)(f().sA,{id:"database.viewSettings.relationsPropertyTab.removeSubitemRelation.removeSubitemButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>ie(void 0)}):F.canConfigureBlock&&(0,k.jsx)(b().Ay,{popupType:c.isPhone?bn().nl.SlideUp:bn().nl.Popup,alignmentToOrigin:b().yP.End,placementToOrigin:b().sx.Bottom,originGap:0,renderOrigin:e=>(0,k.jsx)(k.Fragment,{children:!(!F.canConfigureBlock||!B)&&(0,k.jsx)(kt().A,{isGray:!0,icon:xn().I,title:(0,k.jsx)(f().sA,{...(0,Ii().Pf)({feature:a,databaseType:j})}),isRed:!0,...e})}),render:e=>{let t;return t=c.isPhone?{menuType:Ut().gu.ActionSheet}:{menuType:Ut().gu.Popup,width:300},(0,k.jsx)(zt().A,{...t,footer:(0,k.jsxs)(ae().A,{topBorder:!0,children:[F.canConfigureBlock&&(0,k.jsx)(kt().A,{title:(0,k.jsx)(f().sA,{id:"database.viewSettings.relationsPropertyTab.removeRelation.removeRelationButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>ie(void 0)}),F.canConfigureCollection&&(0,k.jsx)(kt().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Turn off for all new views",id:"database.viewSettings.relationsPropertyTab.removeRelation.removeAllDefaultButton.title"}),isRed:!0,onClick:()=>{ne(void 0)}})]})})}})})]}),children:[v&&(0,k.jsx)(Bi,{propertyName:z||O,inversePropertyName:(null==G?void 0:G.inverseName)||H,subitemsDisplayMode:P}),w&&(0,k.jsx)(Kc,{propertyName:z||O}),!Z&&(0,k.jsx)("div",{style:de.useExistingTitle,children:(0,k.jsx)(f().sA,{defaultMessage:"Use an existing relation",id:"database.viewSettings.relationsPropertyTab.useExistingRelation.title"})}),E.length>0&&!Z?(0,k.jsx)("div",{style:{paddingBottom:"6px"},children:(0,k.jsx)(ae().A,{children:(0,k.jsx)(b().Ay,{buttonPopupStore:Y,render:e=>{let t;return t=c.isPhone?{menuType:Ut().gu.ActionSheet}:{menuType:Ut().gu.Popup,width:300},(0,k.jsx)(zt().A,{...t,footer:(0,k.jsx)(C().A,{schema:A,format:I,getProperties:X,onAccept:F.canConfigureBlock&&!F.canConfigureCollection?ie:eo().lQ,inputPlaceholder:jt().A.formatMessage(v?Oc.subitemInputPlaceholder:Oc.timelineArrowsByInputPlaceholder),currentProperty:B,defaultShowPropertyCount:5,renderProperty:F.canConfigureBlock&&!F.canConfigureCollection?void 0:ge})})},renderOrigin:e=>{var t;return(0,k.jsx)(kt().A,{title:(0,k.jsx)(f().sA,{id:"database.viewSettings.relationsPropertyTab.existingRelation",defaultMessage:"Property"}),showChevron:!0,right:B?null===(t=A[B])||void 0===t?void 0:t.name:void 0,rotateChevron:J.open,disabled:!1,icon:o(365683).H,...e})},popupType:c.isPhone?bn().nl.SlideUp:bn().nl.Popup,alignmentToOrigin:b().yP.End,placementToOrigin:b().sx.Bottom,originGap:0})})}):pe&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ae().A,{children:(0,k.jsx)("div",{style:de.emptyStateText,children:(0,k.jsx)(f().sA,{defaultMessage:"Rename (optional)",id:"database.viewSettings.relationsPropertyTab.emptyStateDescription"})})}),(0,k.jsx)(ae().A,{children:(0,k.jsx)(Be().Ay,{value:z,placeholder:z,onChange:e=>N(e.target.value),onBlur:eo().lQ,onSubmit:eo().lQ,focusInitial:!0,selectAll:!1})}),(0,k.jsx)(ra().Ay,{collectionContextStore:i,targetCollectionStore:_,property:void 0,temporaryInverseState:G,setTemporaryInverseState:Q,onSubmit:le}),E.length>0&&(0,k.jsx)("div",{style:{margin:"auto",textAlign:"center"},children:(0,k.jsx)(D().p,{onClick:()=>{fi().default.afterNextFlush((()=>{q(!1)}))},isGray:!0,style:de.existingRelationButton,children:(0,k.jsx)(f().sA,{id:"database.viewSettings.relationsPropertyTab.newRelation",defaultMessage:"Use existing relation"})})})]})]})}));var zc=()=>o(301524);function Nc(e){let{context:t,collectionContextStore:o,collectionSettingsStore:n,fullHeight:i,hideDesktopHeader:s}=e;const a=(0,r().v3)(),[c,d,p,g,m,S]=(0,l().K8)((()=>[o.collectionViewStore(),(0,Ai().gv)(o),o.normalizedSchemaStore.state,o.normalizedFormatStore.state,o.permissionScopesStore.state,Uc(o)]),[o]),h=(t===Gr().Bd.ViewSettings||t===Gr().Bd.MobileSheet)&&d;return c?(0,k.jsx)(y().Ay,{collectionSettingsStore:n,fullHeight:i,hideDesktopHeader:s,title:(0,k.jsx)(f().sA,{defaultMessage:"Sort",id:"database.viewSettings.sortTab.title"}),footer:h&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{style:{paddingTop:24}}),(0,k.jsx)(ae().A,{topBorder:!0,children:(0,k.jsx)(Wc,{collectionContextStore:o})})]}),unconstrainedWidth:!0,children:(0,k.jsx)(zc().A,{collectionContextStore:o,schema:p,format:g,sorts:S,disabled:!m.canConfigureBlock,parentStore:c,onChange:e=>function(e,t,o){!function(e,t,o){const n=t.collectionViewStore();if(!n)return;ja().IU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:e}}})}(e,o,t)}(e,a,o),showDeleteAll:!0,onDeleteAll:()=>function(e,t){t===Gr().Bd.FilterBar&&u().os({collectionSettingsStore:e})}(n,t)})}):null}function Uc(e){return e.currentSortsStore.state}function Wc(e){let{collectionContextStore:t}=e;return(0,k.jsx)(Oa().Ay,{context:Oa().$J.SettingsSort,collectionContextStore:t})}const Hc=2e4,$c=100;var Gc=()=>o(792071),Qc=()=>o(979340);var Zc=()=>o(72135);const qc={type:"aggregation",filter:void 0,aggregation:{aggregator:"count",property:"title"}};function Yc(e){let{collectionContextStore:t}=e;const i=(0,f().tz)(),{isMobile:s}=(0,r().Y0)(),a=(0,S().IS)((e=>({menuItem:{color:e.text.secondary,paddingLeft:s?4:8},warningIcon:{fill:(0,E().k5)("orange",e).fill,marginRight:14,width:12,alignSelf:"center"}})),[s]),c=(0,l().K8)((()=>{var e;return"row_limit_exceeded"===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormatStore())||void 0===e?void 0:e.getKeyStore("sync_state").getKeyStore("syncing").getValue())}),[t]),d=(0,l().O$)(ce().AppStoreCurrentSpaceStore),u=(0,l().K8)((()=>function(e){if(!e)return Hc;const t=Gc().Bj6.fromSpace(e),o=t.getSetting("database_sync_row_limit");return void 0!==o?o:(0,Qc().dL)(t.getSubscriptionTier())?$c:Hc}(null==d?void 0:d.getModel())),[d]),p=(0,l().K8)((()=>(0,Qc().dL)(null==d?void 0:d.getSubscriptionTier())),[d]),g=(0,n.useMemo)((()=>(0,k.jsx)(o(101981).A,{id:"table:uncategorized:title:count",collectionContextStore:t,reducer:qc,render:e=>{const t=e.state;if(!t||"aggregation"!==t.type)return;if("number"!==t.aggregationResult.type)return;const o={...t.aggregationResult,value:t.aggregationResult.value&&Math.min(u,t.aggregationResult.value)};return(0,Zc().ZV)(o.value,"number_with_commas",i)}})),[t,i,u]);return(0,k.jsx)($r().Ay,{title:(0,k.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c&&d&&p&&(0,k.jsx)(Ie().A,{placement:Pt().W.Left,alignment:Pt().C.Center,renderTooltip:()=>(0,k.jsx)(f().sA,{id:"database.viewSettings.syncedSourceTab.limitFree.toolTip",defaultMessage:"Free Plans are limited to 1 synced database with up to 100 rows."}),render:e=>(0,k.jsx)("div",{...e,children:(0,Ll().Q)(a.warningIcon)})}),(0,k.jsx)(f().sA,{defaultMessage:"Limit",id:"database.viewSettings.syncedSourceTab.limit"})]}),right:(0,k.jsx)(f().sA,{defaultMessage:"{value}/{limit} rows",id:"database.viewSettings.syncedSourceTab.limitRows",values:{value:g,limit:(0,Zc().ZV)(u,"number_with_commas",i)}}),style:a.menuItem})}const Jc=n.memo(Yc,Ur().A);var Xc=()=>o(796073);function ed(e){let{collectionContextStore:t}=e;const i=(0,r().v3)(),{isMobile:s}=i.device,a=(0,S().IS)((e=>({menuItem:{color:e.text.secondary,paddingLeft:s?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[s]),c=!(0,l().O$)(Pl().e),d=(0,l().K8)((()=>t.collectionStore()),[t]),[p,g]=(0,l().K8)((()=>{const e=null==d?void 0:d.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue()]}),[d]),m=(0,l().O$)(ce().AppStoreCurrentSpaceStore),y=(0,l().K8)((()=>{var e;const o=t.numberChildrenUnfurledStore.state,n=t.numberChildrenReceivedStore.state,i=o/n,r=!0===(null===(e=t.collectionStore())||void 0===e||null===(e=e.getFormat().sync_state)||void 0===e?void 0:e.syncing);return o&&n&&i<1&&!s||r&&s}),[t,s]),h=(0,l().K8)((()=>{const e=m&&(0,Qc().dL)(m.getSubscriptionTier());return{defaultMessage:e?"Clear and sync database":"Sync database",description:e?"Clears and refreshes the database ":"Refreshes the synced database."}}),[m]),[x,v]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{if(p&&g){const e=`${g}:${p}`,t=o(763884).K.get({userId:i.currentUser.id,key:e});v(t)}}),[g,i,p]);const C=!x||x<Date.now();return p&&g?y?(0,k.jsx)($r().Ay,{title:(0,k.jsx)(f().sA,{defaultMessage:"Syncing",id:"database.viewSettings.syncedSourceTab.isSyncing"}),icon:(0,Xc().$)(a.menuItemIcon,"sync-spinner"),style:a.menuItem}):C?(0,k.jsx)(Ie().A,{renderTooltip:()=>c?(0,k.jsx)(f().sA,{defaultMessage:"Unavailable offline",id:"database.viewSettings.syncedSourceTab.syncNow.offlineTooltip"}):null,placement:Pt().W.Left,disableTooltip:!c,render:e=>(0,k.jsx)(kt().A,{isGray:!0,title:(0,k.jsx)(f().sA,{defaultMessage:"{message}",id:"database.viewSettings.syncedSourceTab.syncNow",values:{message:h.defaultMessage,description:h.description}}),icon:Xc().$,onClick:async()=>{const e=null==d?void 0:d.id,t=!0===(null==d?void 0:d.getFormat().stale);e&&await u().cJ({environment:i,uri:p,botId:g,collectionId:e,nextSync:x,setNextSync:v,isStale:t})},disabled:c,...e})}):(0,k.jsx)($r().Ay,{title:(0,k.jsx)(f().sA,{defaultMessage:"Sync available in {timeToNextSync}",id:"database.viewSettings.syncedSourceTab.syncNow.disabled",values:{timeToNextSync:(0,o(907514).OH)(Date.now(),x)}}),icon:(0,o(210314).u)(a.menuItemIcon),style:a.menuItem}):null}const td=n.memo(ed,Ur().A);function od(e){var t;let{collectionContextStore:n}=e;const i=(0,r().v3)(),{isMobile:s}=i.device,a=(0,S().IS)((()=>({menuItemTitle:{paddingLeft:s?4:8},menuItemIcon:{height:16,width:16,marginRight:2}})),[s]),c=(0,l().K8)((()=>n.collectionStore()),[n]),[d,u,p]=(0,l().K8)((()=>{const e=null==c?void 0:c.getFormatStore();return[null==e?void 0:e.getKeyStore("uri").getValue(),null==e?void 0:e.getKeyStore("bot_id").getValue(),null==e?void 0:e.getKeyStore("original_url").getValue()]}),[c]),g=null==c||null===(t=c.pointer)||void 0===t?void 0:t.spaceId,m=(0,l().K8)((()=>(0,o(252833).fH)(p,g)),[g,p]),y=(0,l().K8)((()=>n.collectionViewBlockStore()),[n]);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ae().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Source database",id:"database.viewSettings.syncedSourceTab.sourceDatabase"}),children:(0,k.jsx)(Ie().A,{placement:Pt().W.Left,alignment:Pt().C.Center,renderTooltip:()=>y&&(0,k.jsx)(o(706965).A,{store:y,compactFormat:!0}),render:e=>(0,k.jsx)($r().Ay,{...e,title:m,icon:(0,k.jsx)(pa().B6,{disabled:!0,icon:null==c?void 0:c.getIcon(),iconRecordCategory:"collection",isEmptyPage:!1,size:20,style:a.menuItemIcon}),style:a.menuItemTitle})}),style:{paddingBottom:0}}),(0,k.jsx)(ae().A,{children:(0,k.jsx)(Jc,{collectionContextStore:n})}),(0,k.jsxs)(ae().A,{topBorder:!0,children:[(0,k.jsx)(td,{collectionContextStore:n}),(0,k.jsx)(kt().A,{isGray:!0,title:(0,k.jsx)(f().sA,{defaultMessage:"Copy debugging information",id:"database.viewSettings.syncedSourceTab.copyDebugging"}),icon:o(925907).n,onClick:async()=>{const e=await _r().R.clipboardActions.load(),t={uri:d,botId:u,spaceId:g};e.copyString({environment:i,stringValue:JSON.stringify(t,null,2),copiedMessage:e.clipboardMessages.copiedToClipboard})}}),(0,k.jsx)(se().A,{href:`${O().A.domainBaseUrl}?target=connected_apps`,children:(0,k.jsx)(kt().A,{icon:o(262462).M,title:(0,k.jsx)(f().sA,{defaultMessage:"Manage my connections",id:"database.viewSettings.syncedSourceTab.manageConnections"}),isGray:!0})}),(0,k.jsx)(xr().A,{href:(0,ro().xS)("guides.syncedDatabases"),title:(0,k.jsx)(f().sA,{defaultMessage:"Learn about synced databases",id:"database.viewSettings.syncedSourceTab.learnMoreButton.title."}),analyticsFrom:"view_settings_source"})]})]})}const nd=n.memo(od,Ur().A);function id(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,i=(0,r().v3)(),{collectionViewBlockStore:s,shouldRenderSyncedSourceTab:a}=(0,l().K8)((()=>{const e=t.collectionViewBlockStore(),o=t.collectionStore(),n=(null==o?void 0:o.getParentId())===(null==e?void 0:e.id),i=(null==o?void 0:o.isSyncedCollection())||(null==o?void 0:o.isExternalSyncedCollection());return{collectionViewBlockStore:e,shouldRenderSyncedSourceTab:n&&i}}),[t]),c=(0,n.useMemo)((()=>yr().Store.createValue("")),[]),d=(0,l().K8)((()=>{var e;return{type:"sourceView",currentValue:null===(e=t.collectionStore())||void 0===e?void 0:e.id}}),[t]);return s?(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Source",id:"database.viewSettings.sourceTab.title"}),handleClose:()=>u().os({collectionSettingsStore:o}),children:a?(0,k.jsx)(nd,{collectionContextStore:t}):(0,k.jsx)(Ys,{collectionContextStore:t,parentStore:s,onAccept:e=>function(e,t,o,n){g().createAndCommit({userAction:"CollectionSettingsViewSource.handleSourcePickerAccept",environment:t,canUndo:!0,perform:t=>{ks({collectionContextStore:o,source:{type:"collection",id:e.id,spaceId:e.getSpaceId()},transaction:t})}}),u().yl({collectionSettingsStore:n})}(e,i,t,o),context:Gr().U9.Source,inputStore:c,suggestionConfig:d})}):null}const rd=n.memo(id);var ld=()=>o(338907),sd=()=>o(922952);function ad(e){const t=e.getParentStore();if(t&&(0,sd().u)(t))return t}function cd(e){let{input:t,setInput:o,placeholderText:i}=e;const{isMobile:s}=(0,r().Y0)(),a=(0,l().uB)(void 0,sl().A);return(0,n.useMemo)((()=>({key:"input",render:e=>(0,k.jsx)(ae().A,{shouldShowBottomDivider:!1,...e}),items:[{key:"input",action:()=>{},render:e=>(0,k.jsx)(Be().Ay,{...e,value:t,onChange:e=>{o(e.target.value),a.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},focusInitial:!s,autoFocus:!s,placeholder:i,showClearButton:!0})}]})),[t,a,i,o,s])}var dd=()=>o(536095),ud=()=>o(727722),pd=()=>o(160475),gd=()=>o(913454),md=()=>o(231314),Sd=()=>o(621767),fd=()=>o(3486),yd=()=>o(736982);const hd=14,xd=32;function vd(e){const{collectionTemplate:t,theme:o,iconStyle:n,captionStyle:i,onAcceptCollectionTemplate:r,parentStore:l,collectionTemplateParentStore:s,hideIconBackground:a,nameOverride:c,hideCaption:d,aiPrompt:u,origin:p}=e,{templateId:g,description:m}=t,{name:S}=t.value.targetCollection,f=(0,fd().d)(t.value.targetCollection.icon,o),y=(0,k.jsx)(Sd().z,{template:t,size:hd,iconStyle:n});return{key:g,render:e=>(0,k.jsx)(gi().wT,{placement:Pt().W.Left,collectionTemplate:t,render:t=>(0,k.jsx)(yd().I,{buttonMenuItemProps:{...(0,Tt().A)(e,t),alignIconTop:!0},title:c??S,caption:d?void 0:(0,k.jsx)("div",{style:i,children:m}),icon:(0,k.jsx)(md().y,{backgroundSize:xd,icon:y,backgroundColor:a?"#00000000":f.fill.secondary})})}),action:()=>{r({template:t,collectionViewBlockStore:l,collectionViewBlockParentStore:s,flowId:void 0,aiPrompt:u,origin:p})}}}var Cd=()=>o(820579);function bd(e){const{buttonMenuItemProps:t,isLinkedView:o}=e,n=(0,r().v3)(),i=(0,S().IS)((e=>({importIcon:{width:20,height:33,margin:"auto"},iconWrapper:{width:o?24:xd}})),[o]);return(0,el().w)((()=>{(0,pd().t)({environment:n,action:"view",from:"database_create_empty_state"})})),(0,k.jsx)(yd().I,{buttonMenuItemProps:t,title:(0,k.jsx)(f().sA,{id:"createViewSourceMenuBody.importButton",defaultMessage:"Import CSV"}),icon:(0,k.jsx)("div",{style:i.iconWrapper,children:(0,Cd().f)(i.importIcon)})})}const wd=(0,f().YK)({setupWithAI:{defaultMessage:"Build with AI",id:"database.viewSettings.searchCollections.setupWithAI"}});function jd(e){const{newButtonMenuItem:t,collectionTemplateParentStore:o,onAcceptCollectionTemplate:n,parentStore:i,showTopBorder:s,hideCaption:a,searchInput:d,settingsSupportsSuggestedTemplates:u,origin:p,isLinkedView:g}=e,m=(0,f().tz)(),y=(0,r().v3)(),h=(0,S().DP)(),x=(0,ji().ET)(),v=(0,l().K8)((()=>x.collectionViewBlockStore()),[x]),C=(0,S().IS)((()=>({icon:{width:20,height:20,...e.iconStyle},caption:e.captionStyle??{},tableWrapperStyle:e.sectionMenuItemStyle??{}})),[e.iconStyle,e.captionStyle,e.sectionMenuItemStyle]);return(0,l().K8)((()=>{if(!t)return;const e=[t];if((0,gd().getIsSetupGeneratorEnabled)()&&o&&u&&Pl().A.state.online){const t=gd().globalWorkflowTemplates.fromIdOfType({type:"collection",templateId:dd().MH});e.push(vd({collectionTemplate:t,theme:h,iconStyle:C.icon,captionStyle:C.caption,onAcceptCollectionTemplate:n,parentStore:i,collectionTemplateParentStore:o,nameOverride:m.formatMessage(wd.setupWithAI),hideIconBackground:!0,hideCaption:a,aiPrompt:(0,_n().x9d)(d),origin:p}))}if(c().default.checkGate({gateName:"contextualized_import_entrypoints"})&&!g){const t={key:"import_button",render:e=>(0,k.jsx)(bd,{buttonMenuItemProps:e,isLinkedView:g}),action:()=>{(0,pd().t)({environment:y,action:"click",from:"database_create_empty_state"}),v&&(0,ud().T)({environment:y,store:v,from:"database_create_empty_state"})}};e.push(t)}return{key:"newButton",render:e=>(0,k.jsx)(ae().A,{...e,topBorder:s,style:C.tableWrapperStyle}),items:e}}),[t,o,u,h,C.icon,C.caption,C.tableWrapperStyle,n,i,m,a,d,s,p,g,v,y])}var Ad=()=>o(343666),_d=()=>o(115512),Id=()=>o(839754);function Md(e){let{icon:t,style:o}=e;return t({...(0,S().IS)((e=>({icon:{fill:e.icon.primary,width:18,height:18}})),[]).icon,...o})}function kd(e){let{buttonMenuItemProps:t,iconStyle:o,hideButton:n,menuItemStyle:i}=e;const r=(0,S().IS)((e=>({buttonMenuItem:{display:n?"none":"flex",...i},icon:{fill:e.icon.secondary,...o}})),[n,i,o]);return(0,k.jsx)(Pe().A,{style:r.buttonMenuItem,...t,title:(0,k.jsx)(w().D,{styleName:"Body-14px/Regular",colorName:"secondary",children:(0,k.jsx)(f().sA,{id:"addWorkflowTemplateMenu.moreTemplates",defaultMessage:"More templates"})}),icon:(0,k.jsx)(Md,{icon:ol()._,style:r.icon})})}var Td=()=>o(575154);var Pd=()=>o(349379),Bd=()=>o(317053),Vd=()=>o(466934);const Fd=(0,f().YK)({suggested:{defaultMessage:"Suggested",id:"database.viewSettings.createViewTab.suggested"}});function Ed(e){const{input:t,parentStore:o,onAcceptCollectionTemplate:i,collectionContextStore:a,settingsSupportsSuggestedTemplates:c,origin:d}=e,u=(0,r().v3)(),p=(0,S().DP)(),[g]=(0,n.useState)((0,s().Ay)()),m=(0,S().IS)((()=>({icon:{marginLeft:6,marginRight:6},moreIcon:{width:hd,height:hd,margin:(xd-hd)/2},caption:{fontSize:(0,_d().ny)(u,"UIRegular"),whiteSpace:"normal"}})),[u]),f=(0,l().K8)((()=>ad(o)),[o]),y=(0,Td().q)({parentStore:f}),h=(0,he().Ay)(t,y,(e=>e.value.targetCollection.name)),x=h.slice(0,gd().TRUNCATE_COLLECTION_TEMPLATE_ITEMS_AT),v=x.length<h.length,C=(0,n.useMemo)((()=>f?x.map(((e,t)=>vd({collectionTemplate:e,theme:p,iconStyle:m.icon,captionStyle:m.caption,hideCaption:!0,onAcceptCollectionTemplate:o=>{i(o),(0,Pd().os)({environment:u,eventProperties:{from_modal_template_picker:!1,selected_index:t,collection_template_ids_shown:x.map((e=>e.templateId)),...(0,Vd().gM)({origin:d,parentStore:f,collectionTemplate:e,flowId:g,collectionTemplatesSearchQuery:void 0})}})},parentStore:o,collectionTemplateParentStore:f,aiPrompt:void 0,origin:d}))):[]),[f,i,o,p,m,x,u,g,d]),b=(0,n.useMemo)((()=>{const e={key:"see_more_workflow_templates",render:e=>(0,k.jsx)(kd,{buttonMenuItemProps:e,iconStyle:m.moreIcon,menuItemStyle:(0,yd().h)({environment:u})}),action:()=>function(e){let{environment:t,parentStore:o,collectionContextStore:n,origin:i,flowId:r}=e;const l=o.getParentStore(),s=n.collectionViewBlockStore();if(!l||!s||l.table===Ad().SN||!(0,sd().u)(l))return;const a={collectionStore:n.collectionStore(),collectionViewStore:n.collectionViewStore(),collectionViewBlockStore:s};(0,Bd().openTemplateOnboardingModal)({parentStore:l,template:void 0,version:(0,Bd().getTemplateOnboardingVersion)({template:void 0}),origin:i,existingCollectionInfo:a,navigateToOnFinish:"skip",flowId:r,onClose:e=>(0,Id().ZM)({environment:t,userAction:"CreateViewSourceMenuBodyNew.handleClickMoreButton",result:e,existingCollectionViewBlockStore:s,existingCollectionStore:a.collectionStore})})}({parentStore:o,collectionContextStore:a,environment:u,origin:d,flowId:g})};return{key:"suggestedCollectionTemplates",items:[...C,...v?[e]:[]],render:e=>(0,k.jsx)(ae().A,{title:jt().A.formatMessage(Fd.suggested),...e})}}),[C,v,m.moreIcon,u,o,a,d,g]);if(function(e){let{collectionTemplateIds:t,origin:o,flowId:i,blockId:l}=e;const s=(0,r().v3)(),a=(0,n.useRef)(!1);(0,n.useEffect)((()=>{a.current||((0,be().u)({environment:s,event:{eventName:"suggested_collection_templates_shown",eventProperties:{origin:o,collection_template_ids_shown:t,block_id:l,flow_id:i}}}),a.current=!0)}))}({collectionTemplateIds:x.map((e=>e.templateId)),origin:d,blockId:o.id,flowId:g}),c)return 0===C.length?void 0:b}function Rd(e){var t;let{environment:o,collectionContextStore:n,template:i,collectionViewBlockStore:r,collectionViewBlockParentStore:l,flowId:s,aiPrompt:a,origin:c}=e;if(null!==(t=i.value.onboarding)&&void 0!==t&&t.isMinimal)return void(0,Bd().createMinimalCollectionTemplateWithoutModal)({environment:o,template:i,parentStore:l,existingCollectionInfo:{collectionViewBlockStore:r,collectionStore:n.collectionStore(),collectionViewStore:n.collectionViewStore()},relationInfos:[]});const d={collectionViewBlockStore:r,collectionStore:n.collectionStore(),collectionViewStore:n.collectionViewStore()};(0,Bd().openSelectedTemplateOnboardingModalForInAppFlows)({environment:o,template:i,parentStore:l,existingCollectionInfo:d,origin:c,navigateToOnFinish:"skip",flowId:s,aiPrompt:a,onClose:e=>(0,Id().ZM)({environment:o,userAction:"CreateViewSourceMenuBodyNew.onAcceptCollectionTemplate",result:e,existingCollectionViewBlockStore:r,existingCollectionStore:d.collectionStore})})}const Dd=(0,f().YK)({search:{defaultMessage:"Search...",id:"database.viewSettings.searchCollections.search"}});function Kd(e){let{collectionContextStore:t,parentStore:o,input:i,setInput:s,newButtonMenuItem:a}=e;const c=(0,r().v3)(),d=(0,l().K8)((()=>(0,ld().u)(c)),[c]),u=i.length>0,p=(0,S().IS)((e=>({sectionMenuItem:{...u&&{position:"sticky",bottom:0,backgroundColor:e.popoverBackground}}})),[u]),g=(0,l().K8)((()=>ad(o)),[o]),m=(0,l().O$)(t.isFullScreenStore)?"collection_settings_add_new_database":"collection_settings_add_new_database_inline",f=(0,n.useCallback)((e=>Rd({...e,environment:c,collectionContextStore:t,origin:m})),[c,t,m]),y=Ed({input:i,onAcceptCollectionTemplate:f,parentStore:o,collectionContextStore:t,settingsSupportsSuggestedTemplates:d,origin:m}),h=jd({newButtonMenuItem:a,collectionTemplateParentStore:g,onAcceptCollectionTemplate:f,parentStore:o,showTopBorder:Boolean(y)&&u,sectionMenuItemStyle:p.sectionMenuItem,hideCaption:!0,searchInput:i,settingsSupportsSuggestedTemplates:d,origin:m,isLinkedView:!1}),x=cd({input:i,setInput:s,placeholderText:jt().A.formatMessage(Dd.search)}),v=(0,n.useMemo)((()=>(0,eo().oE)(u?[x,y,h]:[d?x:void 0,h,y])),[u,x,y,h,d]);return(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:v})}var Od=()=>o(700500),Ld=()=>o(72645),zd=()=>o(388821),Nd=()=>o(869558),Ud=()=>o(319975),Wd=()=>o(359454),Hd=()=>o(184468),$d=()=>o(389658);function Gd(e){var t;let{environment:o,collectionContextStore:n}=e;if(!(0,ld().u)(o))return!1;if(Qd(n))return!1;return!Boolean("chart"===(null===(t=n.collectionViewStore())||void 0===t?void 0:t.getType()))&&("linked"!==n.getCollectionViewBlockSourceState()||(0,Vr().yt)())}function Qd(e){var t;return Boolean((null===(t=e.collectionViewBlockStore())||void 0===t?void 0:t.isInlineCollectionView())&&"uninitialized"===e.getCollectionViewBlockSourceState())}const Zd=(0,f().YK)({newViewType:{defaultMessage:"New {viewType}",id:"database.viewSettings.createView.newViewType"},newEmptyDatabase:{defaultMessage:"New empty database",id:"database.viewSettings.createViewTab.newEmptyDatabase"},newEmptyDataSource:{defaultMessage:"New empty data source",id:"database.viewSettings.createViewTab.newEmptyDataSource"},newDatabaseWithName:{defaultMessage:"New “{name}” database",id:"database.viewSettings.createViewTab.newDatabaseWithName"},newDataSourceWithName:{defaultMessage:"New “{name}” data source",id:"database.viewSettings.createViewTab.newDataSourceWithName"},database:{defaultMessage:"Database",id:"database.viewSettings.createViewTab.view"},startBlankDatabase:{defaultMessage:"Start a blank database",id:"database.viewSettings.createViewTab.startBlankDatabase"}});function qd(e){let{phase:t,baseViewType:o,onComplete:i,input:s,originalTitle:a}=e;const c=(0,r().v3)(),d=(0,f().tz)(),p=(0,ji().ET)(),m=p.settingsStore,y=(0,Vr().x6)(),h=(0,l().K8)((()=>Gd({environment:c,collectionContextStore:p})||y),[c,p,y]),{collectionViewBlockStore:v,collectionStore:C}=(0,l().K8)((()=>({collectionViewBlockStore:p.collectionViewBlockStore(),collectionStore:p.collectionStore()})),[p]),b=(0,n.useMemo)((()=>o?rl().to[o].toLocaleLowerCase():d.formatMessage(Zd.database).toString().toLocaleLowerCase()),[d,o]),w=(0,S().IS)((e=>({newItemIconStyle:{color:e.icon.secondary,marginTop:2},newItemRightStyle:{alignItems:"top"},newDatabaseIconStyle:{fill:e.text.secondary,height:14,width:14}})),[]);return(0,l().K8)((()=>{if("initialized"!==t&&"initialized_source"!==t)return;let e;return e=y&&null!=v&&v.hasMultipleOwnedOrLinkedCollections()?s.length>0?d.formatMessage(Zd.newDataSourceWithName,{name:s}):d.formatMessage(Zd.newEmptyDataSource):s.length>0?d.formatMessage(Zd.newDatabaseWithName,{name:s}):d.formatMessage(Zd.newEmptyDatabase),h?{key:"newButton",render:t=>(0,k.jsx)(yd().I,{buttonMenuItemProps:t,title:e,icon:(0,k.jsx)(md().y,{icon:(0,Ld().b)(w.newDatabaseIconStyle),backgroundSize:xd})}),action:()=>{var e;if(s&&!a){const e=null==C?void 0:C.getNameStore();e&&g().createAndCommit({userAction:"CollectionSettingsCreateViewSource.setTitleAfterNewInput",environment:c,canUndo:!0,perform:t=>{Ud().R9({environment:c,store:e,value:[[s]],transaction:t})}})}u().os({collectionSettingsStore:m}),"collection_view_page"!==(null===(e=p.collectionViewBlockStore())||void 0===e?void 0:e.getType())||0!==s.length||a||fi().default.afterNextFlush((()=>{(0,Wd().P)({environment:c,collectionContextStore:p})}))}}:{key:"newButton",render:e=>(0,k.jsx)(kt().A,{...e,icon:x().plusIcon,iconStyle:w.newItemIconStyle,rightStyle:w.newItemRightStyle,title:d.formatMessage(Zd.newViewType,{viewType:b}),caption:d.formatMessage(Zd.startBlankDatabase)}),action:()=>{var e,t;const n=p.collectionViewStore();if(!n||!v||!o)return;if(u().os({collectionSettingsStore:m}),"chart"===o)return;const r=(0,$d().qP)({isInline:v.getType()===Od().xd.collectionView,viewType:o,chartType:n.getChartPlaceholderType()}),l=v.getSpaceId()??n.getSpaceId()??(null===(e=ce().default.state.currentSpaceStore)||void 0===e?void 0:e.id)??(null===(t=ce().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),a=l?c.idCreator.getSpaceIdCreatorSync(l):void 0,d=zd().RecordMapPolymorphic.create();d.set({id:"block",table:jn().ev},v.pointer),d.set({id:"view",table:Nd().Gy},n.pointer),g().createAndCommit({userAction:"useNewButtonMenuItem.handleNewButtonForViewType",environment:c,canUndo:!0,perform:e=>{(0,Hd().j)({environment:c,sourceBlockId:"root",targetBlockPointer:v.pointer,sourceBlockSubtree:(0,zd().partialRecordMapToRecordMap)(r),targetRecordCache:v.inMemoryRecordCache,transaction:e,recordPointerMap:d,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:a})}}),null==i||i(s)}}}),[t,h,y,s,w.newDatabaseIconStyle,w.newItemIconStyle,w.newItemRightStyle,a,m,p,i,C,c,b,v,o,d])}function Yd(e){const{collectionSettingsStore:t,collectionContextStore:o}=e,i=(0,l().K8)((()=>o.collectionViewBlockStore()),[o]),[r,s]=(0,n.useState)(""),a=qd({phase:"initialized",input:r,originalTitle:void 0,baseViewType:"table"}),c=(0,n.useCallback)((()=>u().os({collectionSettingsStore:t})),[t]),d=(0,l().K8)((()=>null!=i&&i.hasMultipleOwnedOrLinkedCollections()?(0,k.jsx)(f().sA,{defaultMessage:"New data source",id:"database.viewSettings.addNewDatabaseTab.newDataSource"}):(0,k.jsx)(f().sA,{defaultMessage:"New database",id:"database.viewSettings.addNewDatabaseTab.newDatabase"})),[i]);return(0,k.jsx)(y().Ay,{...e,title:d,handleClose:c,children:i&&(0,k.jsx)(Kd,{collectionContextStore:o,parentStore:i,input:r,setInput:s,newButtonMenuItem:a})})}var Jd=()=>o(654062),Xd=()=>o(943919),eu=()=>o(755735);const tu=function(e){const{collectionContextStore:t,collectionSettingsStore:i}=e,s=(0,f().tz)(),a=(0,S().DP)(),c=(0,r().v3)(),d=(0,l().K8)((()=>t.collectionViewStore()),[t]),u=(0,l().K8)((()=>null==d?void 0:d.isDefined()),[d]),[p,m]=(0,n.useState)(""),h=(0,l().K8)((()=>null==d?void 0:d.getFormat().collection_view_icon),[d]),x=(0,l().K8)((()=>null==d?void 0:d.getType()),[d]),v=(0,Nl().a)(),C=(0,n.useCallback)((()=>{nu(p,c,i,t)}),[p,c,i,t]);return d&&u?(0,k.jsxs)(y().Ay,{...e,collectionSettingsStore:i,title:(0,k.jsx)(f().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.title"}),desktopWidth:v?280:290,children:[(0,k.jsx)(ae().A,{isInput:!0,children:(0,k.jsx)(eu().B,{initialValue:p,placeholder:s.formatMessage(o(395859).X.viewNamePlaceholderMessage),focusInitial:!O().A.isMobile||void 0,onBlur:e=>ou(e,c,t),onChange:e=>m(e),iconButton:{iconLeading:e=>(0,k.jsx)(Mr().h,{color:"gray",viewIcon:h,viewType:x}),iconStyle:{fill:qt().l8[a.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore();if(!n||!n.isDefined())return;g().createAndCommit({userAction:"CollectionSettingsCreateView.handleViewIconSubmit",environment:e,canUndo:!0,perform:e=>{(0,Xd().o)({collectionViewStore:n,icon:o,transaction:e})}}),(0,er().X)({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(c,t,e)},onSubmit:e=>nu(e,c,i,t)})}),(0,k.jsx)(Ic().A,{collectionContextStore:t,collectionSettingsStore:i,showDoneButton:!O().A.isMobile,onDoneClick:C,menuType:"createView"})]}):null};function ou(e,t,o){const n=o.collectionViewStore();n&&n.isDefined()&&n.getName()!==e&&g().createAndCommit({userAction:"CollectionSettingsCreateView.handleViewNameBlur",environment:t,canUndo:!0,perform:t=>{(0,Jd().F)({collectionViewStore:n,update:{name:e},transaction:t})}})}function nu(e,t,o,n){ou(e,t,n),u().R8({collectionSettingsStore:o,item:{type:"main"}}),(0,er().X)({environment:t,collectionContextStore:n,action:"rename"})}var iu=()=>o(885110),ru=()=>o(58293),lu=()=>o(564037),su=()=>o(424599);function au(e){const{collectionContextStore:t,environment:o,collectionStore:n,collectionSettingsStore:i,createdCollectionStore:r,userAction:l}=e;if(g().createAndCommit({userAction:l,environment:o,canUndo:!0,perform:e=>{var l;const s=t.collectionViewBlockStore();if(!s)return;ks({collectionContextStore:t,source:{type:"collection",id:n.id,spaceId:n.getSpaceId()},transaction:e}),r&&(0,Ir().h)({collectionViewBlockStore:s,collectionStore:r,transaction:e}),t.isInHomeWidgetStore.state&&u().os({collectionSettingsStore:i});const a=s.getBlockTitleStore(),c=null==s||null===(l=s.getTitleStore())||void 0===l?void 0:l.getValue();a&&c&&Ud().R9({environment:o,store:a,value:c,transaction:e})}}),(0,lu().getIsWorkflowEditorOpen)(o))return void u().os({collectionSettingsStore:i});const s=t.viewsModuleContextStore.isInLayoutBuilder();(0,su().M)({environment:o,collectionStore:n,collectionContextStore:t,collectionSettingsStore:i,shouldSkipViewSelection:s})}var cu=()=>o(498474);const du=(0,f().YK)({link:{defaultMessage:"Link...",id:"database.viewSettings.searchCollections.link"},search:{defaultMessage:"Search...",id:"database.viewSettings.searchCollections.search"},addOrLinkDatabase:{defaultMessage:"Add or link database...",id:"database.viewSettings.searchCollections.addOrLinkDatabase"}}),uu={type:"noSuggestions"};function pu(e){let{collectionContextStore:t,collectionSettingsStore:o,parentStore:i,existingCollectionStore:s,createdCollectionRecordPointerMap:a,input:c,setInput:d,newButtonMenuItem:p,context:g,handleAcceptExistingCollection:m,hideSearchTitle:f,onSelectCollection:y}=e;const h=(0,r().v3)(),x=(0,n.useRef)(0),v=(0,l().K8)((()=>Gd({environment:h,collectionContextStore:t})),[h,t]),C=c.length>0,b=(0,l().K8)((()=>Qd(t)),[t]),w=C||!v,{resultsSection:j,searchSessionId:A,searchSessionFlowNumber:_,hasResults:I}=Us({input:c,collectionContextStore:t,hideSearchTitle:f,parentStore:i,context:g,handleAcceptExistingCollection:m,searchResultsItemsLimit:3,showLoadMoreResultsButton:C,isSearchSurfacesHookEnabled:!0,suggestionConfig:uu}),M=(0,n.useMemo)((()=>{if(w&&I)return j}),[j,w,I]),T=Ts(t);(0,n.useEffect)((()=>{x.current=_}),[_]),(0,n.useEffect)((()=>((0,be().u)({environment:h,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:A,using_secondary_search_surfaces_hook:!0,source:"source"}}}),()=>{(0,be().u)({environment:h,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:A,source:"source",using_secondary_search_surfaces_hook:!0,search_session_flow_number:x.current}}})})),[h,A]);const P=(0,S().IS)((e=>({sectionMenuItem:{...C&&{position:"sticky",bottom:0,backgroundColor:e.popoverBackground}}})),[C]),B=(0,l().K8)((()=>ad(i)),[i]),V=(0,l().O$)(t.isFullScreenStore)?"collection_settings_create_view_source":"collection_settings_create_view_source_inline",F=(0,n.useCallback)((e=>Rd({...e,environment:h,collectionContextStore:t,origin:V})),[h,t,V]),E=Ed({input:c,onAcceptCollectionTemplate:F,parentStore:i,collectionContextStore:t,settingsSupportsSuggestedTemplates:v,origin:V}),R=b?void 0:E,D=jd({newButtonMenuItem:p,collectionTemplateParentStore:B,onAcceptCollectionTemplate:F,parentStore:i,showTopBorder:!v&&w&&(Boolean(R)||I),sectionMenuItemStyle:P.sectionMenuItem,hideCaption:!0,searchInput:c,settingsSupportsSuggestedTemplates:v,origin:V,isLinkedView:b}),K=w?void 0:function(e){let{existingCollectionStore:t,collectionSettingsStore:o,createdCollectionRecordPointerMap:n,onSelectCollection:i}=e;const r={key:"link_database",render:e=>(0,k.jsx)(gu,{buttonMenuItemProps:e}),action:()=>{u().dP({collectionSettingsStore:o,item:{type:"createViewSource",existingCollectionStore:t,createdCollectionRecordPointerMap:n}}),u().a2({collectionSettingsStore:o,item:{type:"linkToDatabase",existingCollectionStore:t,onSelectCollection:i}})}};return{key:"more_settings",render:e=>(0,k.jsx)(ae().A,{topBorder:!0,...e}),items:[r]}}({existingCollectionStore:s,collectionSettingsStore:o,createdCollectionRecordPointerMap:a,onSelectCollection:y}),O=cd({input:c,setInput:d,placeholderText:(0,l().K8)((()=>void 0!==p?jt().A.formatMessage(du.addOrLinkDatabase):null!=t&&t.isInHomeWidgetStore.state?jt().A.formatMessage(du.search):jt().A.formatMessage(du.link)),[t,p])}),L=(0,n.useMemo)((()=>(0,eo().oE)(C?[O,M,R,D,K,T]:[O,D,M,R,K,T])),[C,O,M,R,D,K,T]);return(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:0,resetFocusOnMouseOut:!0,sections:L})}function gu(e){let{buttonMenuItemProps:t}=e;const o=(0,S().IS)((e=>({iconWrapper:{width:xd},linkDatabaseIcon:{fill:e.text.secondary,height:16,width:16,margin:"auto",transform:"rotate(45deg)"}})),[]);return(0,k.jsx)(yd().I,{buttonMenuItemProps:t,title:(0,k.jsx)(f().sA,{id:"createViewSourceMenuBody.linkDatabase",defaultMessage:"Link to existing database"}),icon:(0,k.jsx)("div",{style:o.iconWrapper,children:(0,cu().q)(o.linkDatabaseIcon)})})}function mu(e){const{collectionSettingsStore:t,collectionContextStore:i,existingCollectionStore:s,onSelectCollection:a}=e,c=(0,r().v3)(),d=(0,ru().r)(),p=c.currentUser.id,m=null==d?void 0:d.id,[S,f,h,x]=(0,l().K8)((()=>[i.collectionViewBlockStore(),i.collectionViewStore(),i.collectionStore(),i.getCollectionViewBlockSourceState()]),[i]),[v,C]=(0,n.useState)(void 0),[b,w]=(0,n.useState)(void 0),[[j,A],_]=(0,n.useState)([s,void 0]),I=(0,n.useCallback)((e=>{if(_(e),t.state.open){const[o,n]=e;u().dP({collectionSettingsStore:t,item:{type:"createViewSource",existingCollectionStore:o,createdCollectionRecordPointerMap:n}})}}),[t]),[M,T]=(0,n.useState)(""),P=(0,l().K8)((()=>h&&i.hasSingleCollection()),[i,h]),B=(0,Fl().P9)({name:"view_chart",spaceId:m,userId:p,amount:"unknown"}),[V,F]=(0,n.useState)("boot");(0,n.useEffect)((()=>{if("boot"===V&&f){var e,o,n;const l=null==f?void 0:f.id,s=l?null===(e=(0,ll().v)(l))||void 0===e?void 0:e.viewType:void 0,a=s||(null==f?void 0:f.getType());C(s??(null==f?void 0:f.getType()));const d=null===(o=i.collectionViewBlockStore())||void 0===o?void 0:o.getTitleValue();var r;if(null!=d&&null!==(n=d[0])&&void 0!==n&&null!==(n=n[0])&&void 0!==n&&n.length)w(null===(r=i.collectionViewBlockStore())||void 0===r?void 0:r.getTitleValue());"chart"===a&&iu().Z({environment:c,collectionContextStore:i,collectionViewId:l,from:"slash_menu"}).then((e=>{if("success"===(null==e?void 0:e.type)){const o=e.data.can_view_chart;B||o||"singleSource"!==i.getCollectionViewBlockSourceState()||u().os({collectionSettingsStore:t})}})),F("initializing")}}),[B,i,t,f,c,V]);const E=(0,n.useCallback)((async e=>{const t=i.collectionViewStore(),n=i.collectionViewBlockStore();if(!t||!n)return;if(a)return void(j&&a(j));let r;b?r=b:null!=e&&e.length&&(r=(0,_n().x9d)(e)),await async function(e){const{environment:t,collectionName:n,collectionContextStore:i,collectionViewBlockStore:r,collectionViewStore:l,baseViewType:s,createdCollectionRecordPointerMap:a,setCreatedCollection:c}=e,d=l,u=r;(0,er().X)({environment:t,collectionContextStore:i,action:"select_new_collection"}),"chart"===s&&i.isCreatingNewChartCollectionStore.setState(!0);const{addCollectionViewSourceToNewCollection:p}=await o.e(12071).then(o.bind(o,711996));g().createAndCommit({userAction:"CollectionSettingsCreateViewSourceNew.handleCreateDB",environment:t,canUndo:!0,perform:e=>{Is().zv({store:d,data:{name:s?rl().to[s]:void 0,query2:void 0,type:s??"table",..."chart"!==s&&{format:void 0}},transaction:e});const o=p({environment:t,collectionViewStore:d,collectionViewBlockStore:u,name:n,transaction:e,targetCollectionRecordPointerMap:a}),r=u.getCollectionViewSourceCollectionStore();i.setContext({type:"collectionView",collectionViewBlockStore:u,collectionStore:r,collectionViewStore:d,pageVisitSourceOverride:void 0}),c([r,o])}})}({environment:c,baseViewType:v,collectionName:r,collectionContextStore:i,collectionViewBlockStore:n,collectionViewStore:t,createdCollectionRecordPointerMap:A,setCreatedCollection:I})}),[i,b,c,v,A,I,a,j]);(0,n.useEffect)((()=>{if("initializing"===V){if(s)return I([s,A]),void F("initialized");"singleSource"===x?F("initialized_source"):"linked"===x||i.isEditableHomeCollectionStore.state?F("initialized_linked"):(E(),F("initialized"))}}),[v,i,S,E,s,A,P,V,x,I]);const R=qd({phase:V,baseViewType:v,onComplete:E,input:M,originalTitle:b}),D=(0,l().K8)((()=>t.state.hideSettingsHeader),[t]),K=(0,n.useCallback)((e=>{a?a(e):au({collectionContextStore:i,environment:c,collectionStore:e,collectionSettingsStore:t,createdCollectionStore:j,userAction:"CollectionSettingsCreateViewSource.handleSourcePickerAccept"})}),[i,t,j,c,a]);return(0,k.jsx)(y().Ay,{...e,title:jt().A.formatMessage(Su.newDatabase),handleClose:()=>{u().os({collectionSettingsStore:t})},children:S&&(0,k.jsx)(pu,{collectionContextStore:i,collectionSettingsStore:t,parentStore:S,existingCollectionStore:j,createdCollectionRecordPointerMap:A,input:M,setInput:T,newButtonMenuItem:R,handleAcceptExistingCollection:K,context:Qs.Source,hideSearchTitle:D,onSelectCollection:a})})}const Su=(0,f().YK)({newDatabase:{defaultMessage:"New database",id:"database.viewSettings.collectionSettingsCreateViewSource.newDatabase"}});var fu=()=>o(955825),yu=()=>o(118849);function hu(e){let{subscriptionTier:t,analyticsName:o}=e;const n=(0,r().v3)(),i=(0,l().K8)((()=>(0,Go().s7)(n)),[n]),s=(0,S().IS)((e=>({container:{margin:"8px 14px",padding:"8px 12px",borderRadius:8,border:`1px solid ${e.stroke.secondary}`,color:e.text.primary,fontSize:14,lineHeight:"20px",display:"flex",justifyContent:"space-between",alignItems:"center"},nonWorkspaceAdmin:{border:"unset",backgroundColor:e.lightGrayButtonBackground}})),[]);return(0,k.jsx)(je().A,{...(0,fu().AH)(s.container,!i&&s.nonWorkspaceAdmin),onClick:()=>{Ho().K(n,{from:o,upsell:{type:"product",product:t,limit:{type:"none"},trialability:"none"}})},disabled:!i,children:i?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(f().sA,{id:"upsellBannerButton.title.workspaceAdmin",defaultMessage:"Upgrade to unlock"}),(0,k.jsx)(yu().A,{subscriptionTier:t,analyticsName:o,desktopStyle:{marginLeft:8},disableTooltip:!0})]}):(0,k.jsx)(f().sA,{id:"upsellBannerButton.title.nonWorkspaceAdmin",defaultMessage:"Contact your workspace owner to upgrade to unlock this feature"})})}var xu=()=>o(404520),vu=()=>o(58488),Cu=()=>o(173215),bu=()=>o(524702),wu=()=>o(792540);function ju(e){let{formBlockStore:t,disabled:o}=e;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Au,{formBlockStore:t,disabled:o}),(0,k.jsx)(_u,{formBlockStore:t,disabled:o})]})}function Au(e){let{formBlockStore:t,disabled:o}=e;const n=(0,l().K8)((()=>t.getFormConfigStore().getKeyStore("custom_confirmation_screen_title")),[t]);return(0,k.jsx)(ae().A,{title:(0,k.jsx)(f().sA,{id:"formCustomizeSettings.customizeConfirmationScreen.title",defaultMessage:"Confirmation title"}),style:{paddingBottom:8},children:(0,k.jsx)(Iu,{formBlockStore:t,disabled:o,textStore:n,settingName:"custom_confirmation_screen_title"})})}function _u(e){let{formBlockStore:t,disabled:o}=e;const n=(0,l().K8)((()=>t.getFormConfigStore().getKeyStore("custom_confirmation_screen_body")),[t]);return(0,k.jsx)(ae().A,{title:(0,k.jsx)(f().sA,{id:"formCustomizeSettings.customizeConfirmationScreen.body",defaultMessage:"Confirmation body"}),style:{paddingBottom:12},children:(0,k.jsx)(Iu,{formBlockStore:t,disabled:o,textStore:n,textarea:!0,settingName:"custom_confirmation_screen_body"})})}function Iu(e){let{formBlockStore:t,disabled:o,textStore:i,textarea:s,settingName:a}=e;const c=(0,r().v3)(),d=(0,S().IS)((e=>({input:{fontSize:14,lineHeight:"20px",borderRadius:6,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",padding:"3px 6px",margin:"0 8px",width:"auto",overflow:"hidden",height:s?68:28,textWrap:s?"wrap":"nowrap",opacity:o?.4:1}})),[s,o]),u=(0,l().K8)((()=>t.getSpaceId()),[t]),p=(0,eo().sg)((0,n.useCallback)((()=>{(0,be().u)({environment:c,event:{eventName:"form_settings_changed",eventProperties:{form_id:t.id,form_setting:a}}})}),[t.id,c,a]),1e3),g=(0,Cu().x)({textStore:i,parentStore:t,spaceId:u,disabled:!0});return o?(0,k.jsx)("div",{style:d.input,children:g}):(0,k.jsx)(bu().A,{disabled:o,store:i,pasteBehavior:"inline",inPageFind:wu().Os.none,style:d.input,disabledMentionTypes:{page:!1,date:!1,user:!0,createPage:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0,reminder:!0,bot:!0,heading:!0,group:!0,templateVariable:!0},disableSlashCommands:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableEnter:!0,disableHorizontalEdgeScroll:!0,disableEquationInteraction:!0,disableFilters:!0,disableRightMarginHoverStyling:!0,disableSuggestEdit:!0,disableShiftEnter:!0,onChange:p,onTab:eo().D_,onUntab:eo().D_})}const Mu={viewBox:"0 0 20 20",fittedViewBox:"7 7 6 6",svg:(0,k.jsx)("path",{d:"M10 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6"})},ku=(0,pn().wt)("dotFill",Mu);var Tu=()=>o(594952),Pu=()=>o(435644),Bu=()=>o(769314);const Vu=30,Fu=(0,f().YK)({submitButtonTextPlaceholder:{id:"formCustomizeSettings.customizeSubmitButton.text.placeholder",defaultMessage:"Submit"}});function Eu(e){let{formBlockStore:t,disabled:o}=e;return(0,k.jsxs)(ae().A,{title:(0,k.jsx)(f().sA,{id:"formCustomizeSettings.customizeSubmitButton.title",defaultMessage:"Submit button"}),children:[(0,k.jsx)(Ru,{formBlockStore:t,disabled:o}),(0,k.jsx)(Du,{formBlockStore:t,disabled:o})]})}function Ru(e){let{formBlockStore:t,disabled:o}=e;const i=(0,r().Y0)(),{customSubmitButtonColorStore:s,currentColor:a}=(0,l().K8)((()=>{const e=t.getFormConfigStore().getKeyStore("custom_submit_button_color");return{customSubmitButtonColorStore:e,currentColor:(null==e?void 0:e.getValue())??"gray"}}),[t]),c=(0,k.jsx)(f().sA,{...qt().jd[a]}),d=(0,n.useCallback)((e=>{let{environment:o,color:n}=e;s&&(g().createAndCommit({userAction:"formSettings.setFormConfig.customSubmitButtonColor",environment:o,canUndo:!0,perform:e=>{Is().KY({store:s,value:n,transaction:e})}}),(0,be().u)({environment:o,event:{eventName:"form_settings_changed",eventProperties:{form_setting:"custom_submit_button_color",form_id:t.id}}}))}),[s,t.id]),u=(0,S().IS)((e=>({colorLabelWrapper:{display:"flex",alignItems:"center",gap:2},selectedCircle:{height:pn().Ev.lg,width:pn().Ev.lg,stroke:qt().l8[e.mode][a],fill:qt().l8[e.mode][a]},colorLabel:{fontSize:14,lineHeight:"18px"}})),[a]);return(0,k.jsx)(b().Ay,{popupType:i.isPhone?Wt().n.SlideUp:Wt().n.Popup,alignmentToOrigin:b().yP.End,placementToOrigin:b().sx.Bottom,disabled:o,originGap:0,renderOrigin:e=>(0,k.jsx)(kt().A,{...e,title:(0,k.jsx)(f().sA,{id:"formCustomizeSettings.customizeSubmitButton.color",defaultMessage:"Color"}),disabled:o,icon:Tu().I,right:(0,k.jsxs)("div",{style:u.colorLabelWrapper,children:[ku(u.selectedCircle),(0,k.jsx)("div",{style:u.colorLabel,children:c})]}),showChevron:!0}),render:e=>(0,k.jsx)(Bu().A,{parent:e,currentColor:a,onColorSelected:d}),style:{padding:"5px 0"}})}function Du(e){let{formBlockStore:t,disabled:o}=e;const i=(0,r().v3)(),s=(0,f().tz)(),{customSubmitButtonTextStore:a,currentText:c}=(0,l().K8)((()=>{const e=t.getFormConfigStore().getKeyStore("custom_submit_button_text");return{customSubmitButtonTextStore:e,currentText:(null==e?void 0:e.getValue())??""}}),[t]),d=(0,n.useCallback)((e=>{a&&(g().createAndCommit({userAction:"formSettings.setFormConfig.customSubmitButtonText",environment:i,canUndo:!0,perform:t=>{Is().KY({store:a,value:e,transaction:t})}}),(0,be().u)({environment:i,event:{eventName:"form_settings_changed",eventProperties:{form_setting:"custom_submit_button_text",form_id:t.id}}}))}),[a,i,t.id]),u=(0,eo().sg)(d,500);return(0,k.jsx)($r().Ay,{title:(0,k.jsx)(f().sA,{id:"formCustomizeSettings.customizeSubmitButton.text",defaultMessage:"Text"}),icon:(0,Pu().a)({width:pn().Ev.default,height:pn().Ev.default,marginLeft:4}),right:(0,k.jsx)(eu().B,{disabled:o,initialValue:c,placeholder:s.formatMessage(Fu.submitButtonTextPlaceholder),onBlur:d,onSubmit:d,onChange:u,inputOuterStyle:{margin:0,width:160},maxLength:Vu,textWrapperStyle:{margin:0}}),style:{padding:"2px 0 2px 4px",lineHeight:"28px"},disabled:o})}function Ku(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,r().Y0)(),i=(0,l().K8)((()=>(0,Vl().P4)()),[]),s=function(){const e=(0,r().v3)(),t=(0,ru().r)(),o=e.currentUser.id,n=null==t?void 0:t.id;return(0,Fl()._X)({name:"form_customization",spaceId:n,userId:o})}(),a="unavailable"===(null==s?void 0:s.type)&&s.upsell,c=Boolean(a),d=(0,l().K8)((()=>t.collectionViewStore()),[t]),u=(0,l().K8)((()=>{if(!d)throw new Error("No CollectionViewStore found");return d.getFormBlockStore()}),[d]);return d&&u?(0,k.jsx)(vu().I,{children:(0,k.jsx)(y().Ay,{collectionSettingsStore:o,title:(0,k.jsx)(f().sA,{id:"formCustomizeSettings.menuTitle",defaultMessage:"Customize"}),menuScrollerStyle:n.isMobile?void 0:{maxHeight:600},children:(0,k.jsxs)("div",{style:{padding:"0 4px 4px"},children:[a?i?(0,k.jsx)("div",{style:{margin:"8px 14px"},children:(0,k.jsx)(xu().R,{display:"button",source:"forms_customize_settings",upsell:s.upsell,featureName:"form_customization"})}):(0,k.jsx)(hu,{subscriptionTier:"plus",analyticsName:"forms_customize_settings"}):null,(0,k.jsx)(Eu,{formBlockStore:u,disabled:c}),(0,k.jsx)(ju,{formBlockStore:u,disabled:c})]})})}):null}var Ou=()=>o(31503),Lu=()=>o(713998),zu=()=>o(450648),Nu=()=>o(958102),Uu=()=>o(348241);const Wu=(0,pn().wt)("collectionFormCheckboxQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"12.602",fill:"#E3E2E0",rx:"1"}),(0,k.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"19.602",fill:"#E3E2E0",rx:"1"}),(0,k.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"26.602",fill:"#E3E2E0",rx:"1"}),(0,k.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M9.568 22.602c-1.336 0-2.068-.727-2.068-2.057v-7.09c0-1.33.732-2.057 2.068-2.057h7.067c1.342 0 2.068.727 2.068 2.057v7.09c0 1.33-.726 2.057-2.068 2.057H9.568zm.164-1.512h6.739c.468 0 .72-.229.72-.727v-6.72c0-.498-.252-.733-.72-.733H9.732c-.468 0-.72.235-.72.733v6.72c0 .498.252.727.72.727zm2.76-1.307c-.246 0-.445-.111-.615-.322l-1.313-1.564a.692.692 0 01-.175-.457c0-.34.275-.61.615-.61.193 0 .351.076.498.258l.978 1.201 2.104-3.387c.14-.234.328-.351.545-.351.328 0 .633.24.633.586 0 .14-.065.287-.159.428l-2.513 3.884a.715.715 0 01-.598.334z"})]})}),Hu=(0,pn().wt)("collectionFormCheckboxQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"12.602",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,k.jsx)("rect",{width:"10",height:"2",x:"22.5",y:"19.602",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,k.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"26.602",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,k.jsx)("path",{fill:"#2383E2",d:"M9.568 22.602c-1.336 0-2.068-.727-2.068-2.057v-7.09c0-1.33.732-2.057 2.068-2.057h7.067c1.342 0 2.068.727 2.068 2.057v7.09c0 1.33-.726 2.057-2.068 2.057H9.568zm.164-1.512h6.739c.468 0 .72-.229.72-.727v-6.72c0-.498-.252-.733-.72-.733H9.732c-.468 0-.72.235-.72.733v6.72c0 .498.252.727.72.727zm2.76-1.307c-.246 0-.445-.111-.615-.322l-1.313-1.564a.692.692 0 01-.175-.457c0-.34.275-.61.615-.61.193 0 .351.076.498.258l.978 1.201 2.104-3.387c.14-.234.328-.351.545-.351.328 0 .633.24.633.586 0 .14-.065.287-.159.428l-2.513 3.884a.715.715 0 01-.598.334z"})]})}),$u=(0,pn().wt)("collectionFormDateQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{d:"M13.335 28.9893C11.2939 28.9893 10.2686 27.9834 10.2686 25.9619V14.0381C10.2686 12.0166 11.2939 11.0107 13.335 11.0107H26.6748C28.7158 11.0107 29.7314 12.0264 29.7314 14.0381V25.9619C29.7314 27.9736 28.7158 28.9893 26.6748 28.9893H13.335ZM13.1885 27.417H26.8018C27.6709 27.417 28.1592 26.958 28.1592 26.0498V16.8408C28.1592 15.9424 27.6709 15.4736 26.8018 15.4736H13.1885C12.3193 15.4736 11.8408 15.9424 11.8408 16.8408V26.0498C11.8408 26.958 12.3193 27.417 13.1885 27.417ZM18.1006 18.9795C17.7588 18.9795 17.6416 18.8818 17.6416 18.54V17.9639C17.6416 17.6221 17.7588 17.5146 18.1006 17.5146H18.6768C19.0186 17.5146 19.126 17.6221 19.126 17.9639V18.54C19.126 18.8818 19.0186 18.9795 18.6768 18.9795H18.1006ZM21.3428 18.9795C21.001 18.9795 20.8838 18.8818 20.8838 18.54V17.9639C20.8838 17.6221 21.001 17.5146 21.3428 17.5146H21.9189C22.2607 17.5146 22.3779 17.6221 22.3779 17.9639V18.54C22.3779 18.8818 22.2607 18.9795 21.9189 18.9795H21.3428ZM24.585 18.9795C24.2432 18.9795 24.1357 18.8818 24.1357 18.54V17.9639C24.1357 17.6221 24.2432 17.5146 24.585 17.5146H25.1611C25.5029 17.5146 25.6201 17.6221 25.6201 17.9639V18.54C25.6201 18.8818 25.5029 18.9795 25.1611 18.9795H24.585ZM14.8584 22.1729C14.5068 22.1729 14.3994 22.0752 14.3994 21.7334V21.1572C14.3994 20.8154 14.5068 20.7178 14.8584 20.7178H15.4248C15.7764 20.7178 15.8838 20.8154 15.8838 21.1572V21.7334C15.8838 22.0752 15.7764 22.1729 15.4248 22.1729H14.8584ZM18.1006 22.1729C17.7588 22.1729 17.6416 22.0752 17.6416 21.7334V21.1572C17.6416 20.8154 17.7588 20.7178 18.1006 20.7178H18.6768C19.0186 20.7178 19.126 20.8154 19.126 21.1572V21.7334C19.126 22.0752 19.0186 22.1729 18.6768 22.1729H18.1006ZM14.8584 25.376C14.5068 25.376 14.3994 25.2686 14.3994 24.9268V24.3506C14.3994 24.0088 14.5068 23.9111 14.8584 23.9111H15.4248C15.7764 23.9111 15.8838 24.0088 15.8838 24.3506V24.9268C15.8838 25.2686 15.7764 25.376 15.4248 25.376H14.8584ZM18.1006 25.376C17.7588 25.376 17.6416 25.2686 17.6416 24.9268V24.3506C17.6416 24.0088 17.7588 23.9111 18.1006 23.9111H18.6768C19.0186 23.9111 19.126 24.0088 19.126 24.3506V24.9268C19.126 25.2686 19.0186 25.376 18.6768 25.376H18.1006Z",fill:"#E3E2E0"}),(0,k.jsx)("rect",{x:"21.0049",y:"20.7861",width:"4.74121",height:"4.74121",rx:"1",fill:"#2383E2",fillOpacity:"0.57"})]})}),Gu=(0,pn().wt)("collectionFormDateQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{d:"M13.335 28.9893C11.2939 28.9893 10.2686 27.9834 10.2686 25.9619V14.0381C10.2686 12.0166 11.2939 11.0107 13.335 11.0107H26.6748C28.7158 11.0107 29.7314 12.0264 29.7314 14.0381V25.9619C29.7314 27.9736 28.7158 28.9893 26.6748 28.9893H13.335ZM13.1885 27.417H26.8018C27.6709 27.417 28.1592 26.958 28.1592 26.0498V16.8408C28.1592 15.9424 27.6709 15.4736 26.8018 15.4736H13.1885C12.3193 15.4736 11.8408 15.9424 11.8408 16.8408V26.0498C11.8408 26.958 12.3193 27.417 13.1885 27.417ZM18.1006 18.9795C17.7588 18.9795 17.6416 18.8818 17.6416 18.54V17.9639C17.6416 17.6221 17.7588 17.5146 18.1006 17.5146H18.6768C19.0186 17.5146 19.126 17.6221 19.126 17.9639V18.54C19.126 18.8818 19.0186 18.9795 18.6768 18.9795H18.1006ZM21.3428 18.9795C21.001 18.9795 20.8838 18.8818 20.8838 18.54V17.9639C20.8838 17.6221 21.001 17.5146 21.3428 17.5146H21.9189C22.2607 17.5146 22.3779 17.6221 22.3779 17.9639V18.54C22.3779 18.8818 22.2607 18.9795 21.9189 18.9795H21.3428ZM24.585 18.9795C24.2432 18.9795 24.1357 18.8818 24.1357 18.54V17.9639C24.1357 17.6221 24.2432 17.5146 24.585 17.5146H25.1611C25.5029 17.5146 25.6201 17.6221 25.6201 17.9639V18.54C25.6201 18.8818 25.5029 18.9795 25.1611 18.9795H24.585ZM14.8584 22.1729C14.5068 22.1729 14.3994 22.0752 14.3994 21.7334V21.1572C14.3994 20.8154 14.5068 20.7178 14.8584 20.7178H15.4248C15.7764 20.7178 15.8838 20.8154 15.8838 21.1572V21.7334C15.8838 22.0752 15.7764 22.1729 15.4248 22.1729H14.8584ZM18.1006 22.1729C17.7588 22.1729 17.6416 22.0752 17.6416 21.7334V21.1572C17.6416 20.8154 17.7588 20.7178 18.1006 20.7178H18.6768C19.0186 20.7178 19.126 20.8154 19.126 21.1572V21.7334C19.126 22.0752 19.0186 22.1729 18.6768 22.1729H18.1006ZM14.8584 25.376C14.5068 25.376 14.3994 25.2686 14.3994 24.9268V24.3506C14.3994 24.0088 14.5068 23.9111 14.8584 23.9111H15.4248C15.7764 23.9111 15.8838 24.0088 15.8838 24.3506V24.9268C15.8838 25.2686 15.7764 25.376 15.4248 25.376H14.8584ZM18.1006 25.376C17.7588 25.376 17.6416 25.2686 17.6416 24.9268V24.3506C17.6416 24.0088 17.7588 23.9111 18.1006 23.9111H18.6768C19.0186 23.9111 19.126 24.0088 19.126 24.3506V24.9268C19.126 25.2686 19.0186 25.376 18.6768 25.376H18.1006Z",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("rect",{x:"21.0049",y:"20.7861",width:"4.74121",height:"4.74121",rx:"1",fill:"#2383E2"})]})}),Qu=(0,pn().wt)("collectionFormEmailQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsx)("g",{children:(0,k.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M10.798 20.026c0-5.625 3.867-9.386 9.404-9.386 5.265 0 9 3.34 9 8.42 0 3.41-1.59 5.748-4.183 5.748-1.415 0-2.453-.712-2.69-1.89h-.123c-.492 1.204-1.476 1.898-2.812 1.898-2.32 0-3.903-1.95-3.903-4.763 0-2.769 1.565-4.667 3.806-4.667 1.283 0 2.329.641 2.777 1.705h.132v-.72c0-.616.343-.985.94-.985.598 0 .94.369.94.984v5.397c0 .914.476 1.45 1.32 1.45 1.274 0 2.065-1.609 2.065-4 0-4.402-3.2-6.951-7.286-6.951-4.527 0-7.568 3.19-7.568 7.813 0 4.773 3.19 7.638 7.972 7.638 1.037 0 1.793-.14 2.645-.325.185-.036.343-.062.475-.062.475 0 .756.308.756.712 0 .387-.202.694-.774.896-.755.255-1.96.422-3.392.422-5.555 0-9.501-3.577-9.501-9.334zm9.026 3.05c1.389 0 2.277-1.169 2.277-3.023 0-1.82-.88-2.953-2.268-2.953-1.371 0-2.232 1.151-2.232 2.98 0 1.854.852 2.996 2.223 2.996z"})})}),Zu=(0,pn().wt)("collectionFormEmailQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsx)("g",{children:(0,k.jsx)("path",{fill:"#2383E2",d:"M10.798 20.026c0-5.625 3.867-9.386 9.404-9.386 5.265 0 9 3.34 9 8.42 0 3.41-1.59 5.748-4.183 5.748-1.415 0-2.453-.712-2.69-1.89h-.123c-.492 1.204-1.476 1.898-2.812 1.898-2.32 0-3.903-1.95-3.903-4.763 0-2.769 1.565-4.667 3.806-4.667 1.283 0 2.329.641 2.777 1.705h.132v-.72c0-.616.343-.985.94-.985.598 0 .94.369.94.984v5.397c0 .914.476 1.45 1.32 1.45 1.274 0 2.065-1.609 2.065-4 0-4.402-3.2-6.951-7.286-6.951-4.527 0-7.568 3.19-7.568 7.813 0 4.773 3.19 7.638 7.972 7.638 1.037 0 1.793-.14 2.645-.325.185-.036.343-.062.475-.062.475 0 .756.308.756.712 0 .387-.202.694-.774.896-.755.255-1.96.422-3.392.422-5.555 0-9.501-3.577-9.501-9.334zm9.026 3.05c1.389 0 2.277-1.169 2.277-3.023 0-1.82-.88-2.953-2.268-2.953-1.371 0-2.232 1.151-2.232 2.98 0 1.854.852 2.996 2.223 2.996z"})})}),qu=(0,pn().wt)("collectionFormFileQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M20.824 31.179c0 .455-.38.821-.824.821a.828.828 0 01-.824-.821V26.15l.065-1.808-.921.976-.976 1.021a.813.813 0 01-.585.255c-.445 0-.759-.322-.759-.765 0-.256.098-.444.271-.6l3.122-2.94c.228-.211.401-.289.607-.289.206 0 .38.078.607.288l3.122 2.941a.761.761 0 01.271.6.74.74 0 01-.759.765.795.795 0 01-.585-.255l-.976-1.02-.921-.977.065 1.808v5.029z"}),(0,k.jsx)("path",{fill:"#E3E2E0",fillRule:"evenodd",d:"M11 28.595c0 2.236 1.102 3.35 3.318 3.35h3.488a2.304 2.304 0 01-.13-.766v-.958h-3.284c-1.102 0-1.67-.588-1.67-1.659v-16.17c0-1.06.568-1.67 1.681-1.67h4.762v6.219c0 1.348.675 2.011 2.012 2.011h6.1v9.61c0 1.07-.567 1.66-1.68 1.66h-3.273v.957c0 .27-.046.527-.13.765h3.489c2.215 0 3.317-1.123 3.317-3.35v-9.716c0-1.381-.16-1.98-1.017-2.858l-5.896-6.003C21.273 9.182 20.599 9 19.4 9h-5.083C12.113 9 11 10.134 11 12.36v16.235zm15.945-11.258H21.37c-.428 0-.589-.172-.589-.6v-5.682l6.164 6.282z",clipRule:"evenodd"})]})}),Yu=(0,pn().wt)("collectionFormFileQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{fill:"#2383E2",d:"M20.824 31.179c0 .455-.38.821-.824.821a.828.828 0 01-.824-.821V26.15l.065-1.808-.921.976-.976 1.021a.813.813 0 01-.585.255c-.445 0-.759-.322-.759-.765 0-.256.098-.444.271-.6l3.122-2.94c.228-.211.401-.289.607-.289.206 0 .38.078.607.288l3.122 2.941a.761.761 0 01.271.6.74.74 0 01-.759.765.795.795 0 01-.585-.255l-.976-1.02-.921-.977.065 1.808v5.029z"}),(0,k.jsx)("path",{fill:"#fff",fillOpacity:"0.283",fillRule:"evenodd",d:"M11 28.595c0 2.236 1.102 3.35 3.318 3.35h3.488a2.304 2.304 0 01-.13-.766v-.958h-3.284c-1.102 0-1.67-.588-1.67-1.659v-16.17c0-1.06.568-1.67 1.681-1.67h4.762v6.219c0 1.348.675 2.011 2.012 2.011h6.1v9.61c0 1.07-.567 1.66-1.68 1.66h-3.273v.957c0 .27-.046.527-.13.765h3.489c2.215 0 3.317-1.123 3.317-3.35v-9.716c0-1.381-.16-1.98-1.017-2.858l-5.896-6.003C21.273 9.182 20.599 9 19.4 9h-5.083C12.113 9 11 10.134 11 12.36v16.235zm15.945-11.258H21.37c-.428 0-.589-.172-.589-.6v-5.682l6.164 6.282z",clipRule:"evenodd"})]})}),Ju=(0,pn().wt)("collectionFormMultiSelectQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{x:"17",y:"10",width:"14",height:"2",rx:"1",fill:"#E3E2E0"}),(0,k.jsx)("rect",{x:"17",y:"19",width:"14",height:"2",rx:"1",fill:"#E3E2E0"}),(0,k.jsx)("rect",{x:"17",y:"28",width:"14",height:"2",rx:"1",fill:"#E3E2E0"}),(0,k.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 12.5C11.8284 12.5 12.5 11.8284 12.5 11C12.5 10.1716 11.8284 9.5 11 9.5C10.1716 9.5 9.5 10.1716 9.5 11C9.5 11.8284 10.1716 12.5 11 12.5ZM11 14C12.6569 14 14 12.6569 14 11C14 9.34315 12.6569 8 11 8C9.34315 8 8 9.34315 8 11C8 12.6569 9.34315 14 11 14Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,k.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 21.5C11.8284 21.5 12.5 20.8284 12.5 20C12.5 19.1716 11.8284 18.5 11 18.5C10.1716 18.5 9.5 19.1716 9.5 20C9.5 20.8284 10.1716 21.5 11 21.5ZM11 23C12.6569 23 14 21.6569 14 20C14 18.3431 12.6569 17 11 17C9.34315 17 8 18.3431 8 20C8 21.6569 9.34315 23 11 23Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,k.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 30.5C11.8284 30.5 12.5 29.8284 12.5 29C12.5 28.1716 11.8284 27.5 11 27.5C10.1716 27.5 9.5 28.1716 9.5 29C9.5 29.8284 10.1716 30.5 11 30.5ZM11 32C12.6569 32 14 30.6569 14 29C14 27.3431 12.6569 26 11 26C9.34315 26 8 27.3431 8 29C8 30.6569 9.34315 32 11 32Z",fill:"#E3E2E0"})]})}),Xu=(0,pn().wt)("collectionFormMultiSelectQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{x:"17",y:"10",width:"14",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("rect",{x:"17",y:"19",width:"14",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("rect",{x:"17",y:"28",width:"14",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 12.5C11.8284 12.5 12.5 11.8284 12.5 11C12.5 10.1716 11.8284 9.5 11 9.5C10.1716 9.5 9.5 10.1716 9.5 11C9.5 11.8284 10.1716 12.5 11 12.5ZM11 14C12.6569 14 14 12.6569 14 11C14 9.34315 12.6569 8 11 8C9.34315 8 8 9.34315 8 11C8 12.6569 9.34315 14 11 14Z",fill:"#2383E2"}),(0,k.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 21.5C11.8284 21.5 12.5 20.8284 12.5 20C12.5 19.1716 11.8284 18.5 11 18.5C10.1716 18.5 9.5 19.1716 9.5 20C9.5 20.8284 10.1716 21.5 11 21.5ZM11 23C12.6569 23 14 21.6569 14 20C14 18.3431 12.6569 17 11 17C9.34315 17 8 18.3431 8 20C8 21.6569 9.34315 23 11 23Z",fill:"#2383E2"}),(0,k.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M11 30.5C11.8284 30.5 12.5 29.8284 12.5 29C12.5 28.1716 11.8284 27.5 11 27.5C10.1716 27.5 9.5 28.1716 9.5 29C9.5 29.8284 10.1716 30.5 11 30.5ZM11 32C12.6569 32 14 30.6569 14 29C14 27.3431 12.6569 26 11 26C9.34315 26 8 27.3431 8 29C8 30.6569 9.34315 32 11 32Z",fill:"white",fillOpacity:"0.283"})]})}),ep=(0,pn().wt)("collectionFormNumberQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{d:"M26.3063 25.1304C24.5768 25.1304 23.4557 24.4263 22.943 23.4351C22.8131 23.1958 22.7584 22.9702 22.7584 22.7378C22.7584 22.2729 23.0524 21.979 23.5445 21.979C23.9068 21.979 24.1256 22.1362 24.3102 22.4985C24.652 23.2437 25.2467 23.688 26.3268 23.688C27.4479 23.688 28.2067 23.0454 28.2067 22.1499C28.2135 21.0972 27.4479 20.5093 26.1832 20.5093H25.6227C25.1852 20.5093 24.9254 20.2427 24.9254 19.853C24.9254 19.4634 25.1852 19.1968 25.6227 19.1968H26.1422C27.2291 19.1968 27.9537 18.5747 27.9537 17.6997C27.9537 16.8452 27.3932 16.271 26.2994 16.271C25.3697 16.271 24.8297 16.6538 24.5016 17.4263C24.3102 17.8501 24.1188 18.0073 23.7086 18.0073C23.2164 18.0073 22.9566 17.7202 22.9566 17.269C22.9566 17.0229 23.0045 16.8042 23.1275 16.5649C23.5924 15.5874 24.6861 14.8696 26.2926 14.8696C28.3365 14.8696 29.649 15.936 29.649 17.4604C29.649 18.6978 28.7672 19.5249 27.5777 19.771V19.8052C29.0338 19.9419 29.9977 20.8169 29.9977 22.1909C29.9977 23.9409 28.4664 25.1304 26.3063 25.1304Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,k.jsx)("path",{d:"M15.4749 24.9321C14.928 24.9321 14.6409 24.6313 14.6409 24.187C14.6409 23.8452 14.7571 23.6401 15.1331 23.2847L18.1478 20.2974C19.4056 19.0532 19.72 18.5542 19.72 17.8022C19.72 16.9204 19.0433 16.2847 18.0931 16.2847C17.2044 16.2847 16.5823 16.7358 16.2337 17.6245C16.056 17.98 15.8509 18.1646 15.4476 18.1646C14.969 18.1646 14.6819 17.8706 14.6819 17.4331C14.6819 17.3032 14.7024 17.1802 14.7366 17.064C15.0032 15.9976 16.1858 14.8696 18.1067 14.8696C20.0823 14.8696 21.4427 16.0386 21.4427 17.6929C21.4427 18.8481 20.889 19.6274 19.2552 21.2271L16.9925 23.4556V23.4897H20.93C21.3948 23.4897 21.6819 23.7769 21.6819 24.2144C21.6819 24.645 21.3948 24.9321 20.93 24.9321H15.4749Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,k.jsx)("path",{d:"M11.6299 25.0688C11.1172 25.0688 10.7617 24.7134 10.7617 24.1802V16.7769H10.7275L9.13477 17.8843C8.96387 18.0073 8.82715 18.0552 8.63574 18.0552C8.2666 18.0552 8 17.7886 8 17.3989C8 17.1255 8.10938 16.9204 8.40332 16.7153L10.4199 15.3003C10.8574 14.9927 11.1309 14.9312 11.5 14.9312C12.1221 14.9312 12.498 15.3071 12.498 15.9155V24.1802C12.498 24.7134 12.1426 25.0688 11.6299 25.0688Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),tp=(0,pn().wt)("collectionFormNumberQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{d:"M26.3063 25.1304C24.5768 25.1304 23.4557 24.4263 22.943 23.4351C22.8131 23.1958 22.7584 22.9702 22.7584 22.7378C22.7584 22.2729 23.0524 21.979 23.5446 21.979C23.9069 21.979 24.1256 22.1362 24.3102 22.4985C24.652 23.2437 25.2467 23.688 26.3268 23.688C27.4479 23.688 28.2067 23.0454 28.2067 22.1499C28.2135 21.0972 27.4479 20.5093 26.1832 20.5093H25.6227C25.1852 20.5093 24.9254 20.2427 24.9254 19.853C24.9254 19.4634 25.1852 19.1968 25.6227 19.1968H26.1422C27.2291 19.1968 27.9537 18.5747 27.9537 17.6997C27.9537 16.8452 27.3932 16.271 26.2994 16.271C25.3698 16.271 24.8297 16.6538 24.5016 17.4263C24.3102 17.8501 24.1188 18.0073 23.7086 18.0073C23.2164 18.0073 22.9567 17.7202 22.9567 17.269C22.9567 17.0229 23.0045 16.8042 23.1276 16.5649C23.5924 15.5874 24.6862 14.8696 26.2926 14.8696C28.3365 14.8696 29.649 15.936 29.649 17.4604C29.649 18.6978 28.7672 19.5249 27.5778 19.771V19.8052C29.0338 19.9419 29.9977 20.8169 29.9977 22.1909C29.9977 23.9409 28.4664 25.1304 26.3063 25.1304Z",fill:"#2383E2"}),(0,k.jsx)("path",{d:"M15.4749 24.9321C14.928 24.9321 14.6409 24.6313 14.6409 24.187C14.6409 23.8452 14.7571 23.6401 15.1331 23.2847L18.1478 20.2974C19.4056 19.0532 19.72 18.5542 19.72 17.8022C19.72 16.9204 19.0433 16.2847 18.0931 16.2847C17.2044 16.2847 16.5823 16.7358 16.2337 17.6245C16.056 17.98 15.8509 18.1646 15.4476 18.1646C14.9691 18.1646 14.6819 17.8706 14.6819 17.4331C14.6819 17.3032 14.7025 17.1802 14.7366 17.064C15.0032 15.9976 16.1859 14.8696 18.1068 14.8696C20.0823 14.8696 21.4427 16.0386 21.4427 17.6929C21.4427 18.8481 20.889 19.6274 19.2552 21.2271L16.9925 23.4556V23.4897H20.93C21.3948 23.4897 21.6819 23.7769 21.6819 24.2144C21.6819 24.645 21.3948 24.9321 20.93 24.9321H15.4749Z",fill:"#2383E2"}),(0,k.jsx)("path",{d:"M11.6299 25.0688C11.1172 25.0688 10.7617 24.7134 10.7617 24.1802V16.7769H10.7275L9.13477 17.8843C8.96387 18.0073 8.82715 18.0552 8.63574 18.0552C8.2666 18.0552 8 17.7886 8 17.3989C8 17.1255 8.10938 16.9204 8.40332 16.7153L10.4199 15.3003C10.8574 14.9927 11.1309 14.9312 11.5 14.9312C12.1221 14.9312 12.498 15.3071 12.498 15.9155V24.1802C12.498 24.7134 12.1426 25.0688 11.6299 25.0688Z",fill:"#2383E2"})]})}),op=(0,pn().wt)("collectionFormPersonQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{d:"M11.7881 19.5371C10.4756 19.5371 9.375 18.3682 9.375 16.8916C9.36816 15.4424 10.4824 14.2939 11.7881 14.2939C13.0938 14.2939 14.208 15.4219 14.208 16.8848C14.208 18.3682 13.1006 19.5371 11.7881 19.5371ZM27.6338 19.5371C26.3145 19.5371 25.2139 18.3682 25.2139 16.8848C25.2139 15.4219 26.3281 14.2939 27.6338 14.2939C28.9395 14.2939 30.0537 15.4424 30.0469 16.8916C30.0469 18.3682 28.9463 19.5371 27.6338 19.5371ZM8.04883 25.7646C7.0918 25.7646 6.74316 25.3545 6.74316 24.6367C6.74316 22.8115 8.75293 20.5762 11.7881 20.5762C12.9912 20.5762 13.9756 20.9248 14.7207 21.3965C13.1348 22.6543 12.3828 24.7119 13.1211 25.7646H8.04883ZM31.373 25.7646H26.3008C27.0391 24.7119 26.2871 22.6543 24.7012 21.3965C25.4463 20.9248 26.4307 20.5762 27.6338 20.5762C30.6689 20.5762 32.6787 22.8115 32.6787 24.6367C32.6787 25.3545 32.3301 25.7646 31.373 25.7646Z",fill:"#E3E2E0"}),(0,k.jsx)("path",{d:"M19.7178 19.3867C18.207 19.3867 16.9492 18.0469 16.9424 16.3447C16.9424 14.6836 18.2139 13.3574 19.7178 13.3574C21.2217 13.3574 22.4932 14.6631 22.4932 16.3311C22.4932 18.0469 21.2285 19.3867 19.7178 19.3867ZM15.4795 25.7646C14.3174 25.7646 13.9209 25.4023 13.9209 24.7529C13.9209 22.9961 16.1699 20.5898 19.7178 20.5898C23.2588 20.5898 25.5078 22.9961 25.5078 24.7529C25.5078 25.4023 25.1113 25.7646 23.9492 25.7646H15.4795Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),np=(0,pn().wt)("collectionFormPersonQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{d:"M11.7881 19.5371C10.4756 19.5371 9.375 18.3682 9.375 16.8916C9.36816 15.4424 10.4824 14.2939 11.7881 14.2939C13.0938 14.2939 14.208 15.4219 14.208 16.8848C14.208 18.3682 13.1006 19.5371 11.7881 19.5371ZM27.6338 19.5371C26.3145 19.5371 25.2139 18.3682 25.2139 16.8848C25.2139 15.4219 26.3281 14.2939 27.6338 14.2939C28.9395 14.2939 30.0537 15.4424 30.0469 16.8916C30.0469 18.3682 28.9463 19.5371 27.6338 19.5371ZM8.04883 25.7646C7.0918 25.7646 6.74316 25.3545 6.74316 24.6367C6.74316 22.8115 8.75293 20.5762 11.7881 20.5762C12.9912 20.5762 13.9756 20.9248 14.7207 21.3965C13.1348 22.6543 12.3828 24.7119 13.1211 25.7646H8.04883ZM31.373 25.7646H26.3008C27.0391 24.7119 26.2871 22.6543 24.7012 21.3965C25.4463 20.9248 26.4307 20.5762 27.6338 20.5762C30.6689 20.5762 32.6787 22.8115 32.6787 24.6367C32.6787 25.3545 32.3301 25.7646 31.373 25.7646Z",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("path",{d:"M19.7178 19.3867C18.207 19.3867 16.9492 18.0469 16.9424 16.3447C16.9424 14.6836 18.2139 13.3574 19.7178 13.3574C21.2217 13.3574 22.4932 14.6631 22.4932 16.3311C22.4932 18.0469 21.2285 19.3867 19.7178 19.3867ZM15.4795 25.7646C14.3174 25.7646 13.9209 25.4023 13.9209 24.7529C13.9209 22.9961 16.1699 20.5898 19.7178 20.5898C23.2588 20.5898 25.5078 22.9961 25.5078 24.7529C25.5078 25.4023 25.1113 25.7646 23.9492 25.7646H15.4795Z",fill:"#2383E2"})]})}),ip=(0,pn().wt)("collectionFormPhoneNumberQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M12.283 23.691C10.415 21.831 9 19.581 9 17.727c0-.82.278-1.564.905-2.165.38-.368.82-.562 1.247-.562.349 0 .672.136.892.446l1.389 1.958c.22.304.323.556.323.788 0 .297-.174.556-.459.853l-.459.472a.327.327 0 00-.096.24c0 .096.038.186.07.258.207.4.795 1.085 1.429 1.718.64.634 1.324 1.222 1.725 1.435a.608.608 0 00.259.071.348.348 0 00.245-.103l.459-.453c.297-.29.562-.458.853-.458.233 0 .491.103.788.31l1.984 1.409c.304.22.427.53.427.852 0 .44-.214.886-.556 1.267-.588.646-1.318.937-2.152.937-1.855 0-4.123-1.441-5.99-3.309z"}),(0,k.jsx)("circle",{cx:"22",cy:"17",r:"2",fill:"#E3E2E0"}),(0,k.jsx)("circle",{cx:"29",cy:"17",r:"2",fill:"#E3E2E0"})]})}),rp=(0,pn().wt)("collectionFormPhoneNumberQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{fill:"#2383E2",d:"M12.283 23.691C10.415 21.831 9 19.581 9 17.727c0-.82.278-1.564.905-2.165.38-.368.82-.562 1.247-.562.349 0 .672.136.892.446l1.389 1.958c.22.304.323.556.323.788 0 .297-.174.556-.459.853l-.459.472a.327.327 0 00-.096.24c0 .096.038.186.07.258.207.4.795 1.085 1.429 1.718.64.634 1.324 1.222 1.725 1.435a.608.608 0 00.259.071.348.348 0 00.245-.103l.459-.453c.297-.29.562-.458.853-.458.233 0 .491.103.788.31l1.984 1.409c.304.22.427.53.427.852 0 .44-.214.886-.556 1.267-.588.646-1.318.937-2.152.937-1.855 0-4.123-1.441-5.99-3.309z"}),(0,k.jsx)("circle",{cx:"22",cy:"17",r:"2",fill:"#fff",fillOpacity:"0.283"}),(0,k.jsx)("circle",{cx:"29",cy:"17",r:"2",fill:"#fff",fillOpacity:"0.283"})]})}),lp=(0,pn().wt)("collectionFormPlaceQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{d:"M15.9961 12.8105C15.9961 10.5938 17.7832 8.78711 20.0098 8.78711C22.2363 8.78711 24.0137 10.5938 24.0137 12.8105C24.0137 14.6367 22.793 16.1895 21.1035 16.668V22.791C21.1035 25.291 20.459 26.9707 20.0098 26.9707C19.5605 26.9707 18.8965 25.2812 18.8965 22.791V16.668C17.2168 16.1797 15.9961 14.6367 15.9961 12.8105ZM18.877 13.0352C19.6289 13.0352 20.2441 12.4004 20.2441 11.6582C20.2441 10.916 19.6289 10.291 18.877 10.291C18.1445 10.291 17.5 10.916 17.5 11.6582C17.5 12.4004 18.1445 13.0352 18.877 13.0352Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,k.jsx)("path",{d:"M20 30.9844C13.5938 30.9844 9.67773 28.8652 9.67773 26.3066C9.67773 23.8968 12.9411 22.229 16.1647 21.7793C16.7172 21.7022 17.1875 22.148 17.1875 22.7059C17.1875 23.2197 16.7858 23.6404 16.2773 23.7138C14.1765 24.017 12.0703 24.9288 12.0703 26.1309C12.0703 27.8203 15.3906 28.9629 20 28.9629C24.5996 28.9629 27.9297 27.8203 27.9297 26.1309C27.9297 24.9293 25.8179 24.0178 23.7226 23.7142C23.2141 23.6405 22.8125 23.2198 22.8125 22.706C22.8125 22.1481 23.2829 21.7022 23.8354 21.7793C27.059 22.2291 30.3223 23.8969 30.3223 26.3066C30.3223 28.8652 26.4062 30.9844 20 30.9844Z",fill:"#E3E2E0"})]})}),sp=(0,pn().wt)("collectionFormPlaceQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("path",{d:"M15.9961 12.8105C15.9961 10.5938 17.7832 8.78711 20.0098 8.78711C22.2363 8.78711 24.0137 10.5938 24.0137 12.8105C24.0137 14.6367 22.793 16.1895 21.1035 16.668V22.791C21.1035 25.291 20.459 26.9707 20.0098 26.9707C19.5605 26.9707 18.8965 25.2812 18.8965 22.791V16.668C17.2168 16.1797 15.9961 14.6367 15.9961 12.8105ZM18.877 13.0352C19.6289 13.0352 20.2441 12.4004 20.2441 11.6582C20.2441 10.916 19.6289 10.291 18.877 10.291C18.1445 10.291 17.5 10.916 17.5 11.6582C17.5 12.4004 18.1445 13.0352 18.877 13.0352Z",fill:"#2383E2"}),(0,k.jsx)("path",{d:"M20 30.9844C13.5938 30.9844 9.67773 28.8652 9.67773 26.3066C9.67773 23.8968 12.9411 22.229 16.1647 21.7793C16.7172 21.7022 17.1875 22.148 17.1875 22.7059C17.1875 23.2197 16.7858 23.6404 16.2773 23.7138C14.1765 24.017 12.0703 24.9288 12.0703 26.1309C12.0703 27.8203 15.3906 28.9629 20 28.9629C24.5996 28.9629 27.9297 27.8203 27.9297 26.1309C27.9297 24.9293 25.8179 24.0178 23.7226 23.7142C23.2141 23.6405 22.8125 23.2198 22.8125 22.706C22.8125 22.1481 23.2829 21.7022 23.8354 21.7793C27.059 22.2291 30.3223 23.8969 30.3223 26.3066C30.3223 28.8652 26.4062 30.9844 20 30.9844Z",fill:"white",fillOpacity:"0.283"})]})}),ap=(0,pn().wt)("collectionFormRelationQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsx)("g",{children:(0,k.jsx)("path",{d:"M27.4707 23.5723C27.4707 24.2852 26.9141 24.832 26.2598 24.832C25.6055 24.832 25.0781 24.2754 25.0781 23.5918V19.9102L25.2344 16.2773L23.6719 18.0254L14.6484 27.0391C14.3848 27.3027 14.082 27.4395 13.7598 27.4395C13.1055 27.4395 12.5195 26.834 12.5195 26.1992C12.5195 25.8867 12.666 25.5645 12.9199 25.3105L21.9336 16.2871L23.6816 14.7344L19.9023 14.8711H16.3574C15.6836 14.8711 15.127 14.3438 15.127 13.6992C15.127 13.0449 15.6543 12.498 16.377 12.498H26.1816C26.9531 12.498 27.4609 13.0156 27.4609 13.7773L27.4707 23.5723Z",fill:"#E3E2E0"})})}),cp=(0,pn().wt)("collectionFormRelationQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsx)("g",{children:(0,k.jsx)("path",{d:"M27.4707 23.5723C27.4707 24.2852 26.9141 24.832 26.2598 24.832C25.6055 24.832 25.0781 24.2754 25.0781 23.5918V19.9102L25.1336 18.6198C25.1674 17.8334 24.1964 17.4385 23.6719 18.0254L14.6484 27.0391C14.3848 27.3027 14.082 27.4395 13.7598 27.4395C13.1055 27.4395 12.5195 26.834 12.5195 26.1992C12.5195 25.8867 12.666 25.5645 12.9199 25.3105L21.9336 16.2871C22.5227 15.7638 22.1325 14.7904 21.3451 14.8189L19.9023 14.8711H16.3574C15.6836 14.8711 15.127 14.3438 15.127 13.6992C15.127 13.0449 15.6543 12.498 16.377 12.498H26.1816C26.9531 12.498 27.4609 13.0156 27.4609 13.7773L27.4707 23.5723Z",fill:"white",fillOpacity:"0.283"})})}),dp=(0,pn().wt)("collectionFormSelectQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{x:"20",y:"12",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,k.jsx)("rect",{x:"20",y:"25",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,k.jsx)("path",{d:"M12.5 18C10.0464 18 8 15.964 8 13.5104C8 11.0464 10.036 9 12.5 9C14.9536 9 17 11.0464 17 13.5104C17 15.964 14.9536 18 12.5 18ZM11.9675 15.9223C12.1972 15.9223 12.3852 15.8179 12.5 15.6299L14.6821 12.2053C14.7761 12.0487 14.8179 11.9234 14.8179 11.7773C14.8179 11.5162 14.5673 11.2865 14.2749 11.2865C14.087 11.2865 13.9304 11.391 13.8051 11.5789L11.9466 14.565L11.1323 13.5313C10.9965 13.3538 10.8503 13.2703 10.652 13.2703C10.3701 13.2703 10.1404 13.5104 10.1404 13.8132C10.1404 13.9803 10.1717 14.1056 10.2761 14.2204L11.4455 15.6299C11.6021 15.8074 11.7483 15.9223 11.9675 15.9223Z",fill:"#2383E2",fillOpacity:"0.57"}),(0,k.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 29.5C14.1569 29.5 15.5 28.1569 15.5 26.5C15.5 24.8431 14.1569 23.5 12.5 23.5C10.8431 23.5 9.5 24.8431 9.5 26.5C9.5 28.1569 10.8431 29.5 12.5 29.5ZM12.5 31C14.9853 31 17 28.9853 17 26.5C17 24.0147 14.9853 22 12.5 22C10.0147 22 8 24.0147 8 26.5C8 28.9853 10.0147 31 12.5 31Z",fill:"#E3E2E0"})]})}),up=(0,pn().wt)("collectionFormSelectQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{x:"20",y:"12",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("rect",{x:"20",y:"25",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("path",{d:"M12.5 18C10.0464 18 8 15.964 8 13.5104C8 11.0464 10.036 9 12.5 9C14.9536 9 17 11.0464 17 13.5104C17 15.964 14.9536 18 12.5 18ZM11.9675 15.9223C12.1972 15.9223 12.3852 15.8179 12.5 15.6299L14.6821 12.2053C14.7761 12.0487 14.8179 11.9234 14.8179 11.7773C14.8179 11.5162 14.5673 11.2865 14.2749 11.2865C14.087 11.2865 13.9304 11.391 13.8051 11.5789L11.9466 14.565L11.1323 13.5313C10.9965 13.3538 10.8503 13.2703 10.652 13.2703C10.3701 13.2703 10.1404 13.5104 10.1404 13.8132C10.1404 13.9803 10.1717 14.1056 10.2761 14.2204L11.4455 15.6299C11.6021 15.8074 11.7483 15.9223 11.9675 15.9223Z",fill:"#2383E2"}),(0,k.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5 29.5C14.1569 29.5 15.5 28.1569 15.5 26.5C15.5 24.8431 14.1569 23.5 12.5 23.5C10.8431 23.5 9.5 24.8431 9.5 26.5C9.5 28.1569 10.8431 29.5 12.5 29.5ZM12.5 31C14.9853 31 17 28.9853 17 26.5C17 24.0147 14.9853 22 12.5 22C10.0147 22 8 24.0147 8 26.5C8 28.9853 10.0147 31 12.5 31Z",fill:"white",fillOpacity:"0.283"})]})}),pp=(0,pn().wt)("collectionFormTextQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{x:"19.5",y:"11",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,k.jsx)("rect",{x:"19.5",y:"17",width:"13",height:"2",rx:"1",fill:"#E3E2E0"}),(0,k.jsx)("rect",{x:"7.5",y:"23",width:"25",height:"2",rx:"1",fill:"#E3E2E0"}),(0,k.jsx)("rect",{x:"7.5",y:"29",width:"25",height:"2",rx:"1",fill:"#E3E2E0"}),(0,k.jsx)("path",{d:"M12.0176 19.1406C9.50977 19.1406 7.93945 17.4883 7.93945 14.7754C7.93945 12.0859 9.50977 10.3984 12.0176 10.3984C14.5195 10.3984 16.0898 12.0859 16.0898 14.7754C16.0898 16.2637 15.6152 17.459 14.7422 18.1797L15.2168 18.8711C15.334 19.0527 15.3809 19.1875 15.3809 19.3691C15.3809 19.7559 15.082 20.0312 14.6602 20.0312C14.373 20.0312 14.1855 19.9258 14.0098 19.6562L13.4941 18.9121C13.043 19.0645 12.5508 19.1406 12.0176 19.1406ZM12.0176 17.6816C12.2344 17.6816 12.4336 17.6523 12.6211 17.5996L12.2168 17.0137C12.0996 16.8379 12.0527 16.6855 12.0527 16.5391C12.0527 16.1582 12.334 15.8887 12.7148 15.8887C12.9609 15.8887 13.1309 15.9766 13.2773 16.1816L13.6699 16.7148C14.0625 16.2578 14.2852 15.5898 14.2852 14.7754C14.2852 13 13.4004 11.8574 12.0176 11.8574C10.6289 11.8574 9.74414 13 9.74414 14.7754C9.74414 16.5449 10.6289 17.6816 12.0176 17.6816Z",fill:"#2383E2",fillOpacity:"0.57"})]})}),gp=(0,pn().wt)("collectionFormTextQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{x:"19.5",y:"11",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("rect",{x:"19.5",y:"17",width:"13",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("rect",{x:"7.5",y:"23",width:"25",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("rect",{x:"7.5",y:"29",width:"25",height:"2",rx:"1",fill:"white",fillOpacity:"0.283"}),(0,k.jsx)("path",{d:"M12.0176 19.1406C9.50977 19.1406 7.93945 17.4883 7.93945 14.7754C7.93945 12.0859 9.50977 10.3984 12.0176 10.3984C14.5195 10.3984 16.0898 12.0859 16.0898 14.7754C16.0898 16.2637 15.6152 17.459 14.7422 18.1797L15.2168 18.8711C15.334 19.0527 15.3809 19.1875 15.3809 19.3691C15.3809 19.7559 15.082 20.0312 14.6602 20.0312C14.373 20.0312 14.1855 19.9258 14.0098 19.6562L13.4941 18.9121C13.043 19.0645 12.5508 19.1406 12.0176 19.1406ZM12.0176 17.6816C12.2344 17.6816 12.4336 17.6523 12.6211 17.5996L12.2168 17.0137C12.0996 16.8379 12.0527 16.6855 12.0527 16.5391C12.0527 16.1582 12.334 15.8887 12.7148 15.8887C12.9609 15.8887 13.1309 15.9766 13.2773 16.1816L13.6699 16.7148C14.0625 16.2578 14.2852 15.5898 14.2852 14.7754C14.2852 13 13.4004 11.8574 12.0176 11.8574C10.6289 11.8574 9.74414 13 9.74414 14.7754C9.74414 16.5449 10.6289 17.6816 12.0176 17.6816Z",fill:"#2383E2"})]})});const mp={light:{text:pp,select:dp,title:pp,multi_select:Ju,relation:ap,date:$u,person:op,file:qu,number:ep,checkbox:Wu,email:Qu,url:(0,pn().wt)("collectionFormUrlQuestionType",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"23",fill:"#E3E2E0",rx:"1"}),(0,k.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"29",fill:"#E3E2E0",rx:"1"}),(0,k.jsx)("path",{fill:"#2383E2",fillOpacity:"0.57",d:"M26 21.238c-.498 0-.855-.304-.855-.89v-6.88c0-.573.351-.878.843-.878s.844.305.844.885v.34h.035c.34-.739 1.037-1.196 1.945-1.196 1.594 0 2.573 1.213 2.573 3.24 0 2.022-.973 3.24-2.543 3.24-.914 0-1.617-.445-1.951-1.154h-.035v2.403c0 .586-.352.89-.856.89zm2.238-3.515c.856 0 1.395-.721 1.395-1.864 0-1.136-.54-1.869-1.395-1.869-.838 0-1.388.744-1.388 1.87 0 1.136.55 1.863 1.388 1.863zm-7.152-.328v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.322-.891.855-.891.534 0 .856.34.856.89v.698h.603c.405 0 .657.252.657.644 0 .393-.252.645-.657.645h-.603v3.006c0 .445.152.633.521.662l.112.012c.422.046.65.222.65.62 0 .505-.492.762-1.213.762h-.058c-1.143 0-1.723-.568-1.723-1.675zm-4.516 0v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.323-.891.856-.891.533 0 .855.34.855.89v.698h.604c.404 0 .656.252.656.644 0 .393-.252.645-.656.645h-.604v3.006c0 .445.153.633.522.662l.111.012c.422.046.65.222.65.62 0 .505-.492.762-1.212.762h-.059c-1.143 0-1.723-.568-1.723-1.675zm-6.83 1.728c-.498 0-.855-.305-.855-.89v-6.938c0-.55.316-.879.844-.879.527 0 .837.328.837.879v2.543h.036c.333-.791 1.02-1.236 1.974-1.236 1.395 0 2.192.902 2.192 2.355v3.275c0 .586-.352.891-.856.891-.498 0-.855-.305-.855-.89V15.32c0-.808-.399-1.3-1.178-1.3-.809 0-1.283.568-1.283 1.394v2.818c0 .586-.352.891-.856.891z"})]})}),phone_number:ip,place:lp},dark:{text:gp,select:up,title:gp,multi_select:Xu,relation:cp,date:Gu,person:np,file:Yu,number:tp,checkbox:Hu,email:Zu,url:(0,pn().wt)("collectionFormUrlQuestionTypeDark",{viewBox:"0 0 40 40",svg:(0,k.jsxs)("g",{children:[(0,k.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"23",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,k.jsx)("rect",{width:"25",height:"2",x:"7.5",y:"29",fill:"#fff",fillOpacity:"0.283",rx:"1"}),(0,k.jsx)("path",{fill:"#2383E2",d:"M26 21.238c-.498 0-.855-.304-.855-.89v-6.88c0-.573.351-.878.843-.878s.844.305.844.885v.34h.035c.34-.739 1.037-1.196 1.945-1.196 1.594 0 2.573 1.213 2.573 3.24 0 2.022-.973 3.24-2.543 3.24-.914 0-1.617-.445-1.951-1.154h-.035v2.403c0 .586-.352.89-.856.89zm2.238-3.515c.856 0 1.395-.721 1.395-1.864 0-1.136-.54-1.869-1.395-1.869-.838 0-1.388.744-1.388 1.87 0 1.136.55 1.863 1.388 1.863zm-7.152-.328v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.322-.891.855-.891.534 0 .856.34.856.89v.698h.603c.405 0 .657.252.657.644 0 .393-.252.645-.657.645h-.603v3.006c0 .445.152.633.521.662l.112.012c.422.046.65.222.65.62 0 .505-.492.762-1.213.762h-.058c-1.143 0-1.723-.568-1.723-1.675zm-4.516 0v-3.387h-.328c-.404 0-.662-.246-.662-.645 0-.398.258-.644.662-.644h.328v-.697c0-.551.323-.891.856-.891.533 0 .855.34.855.89v.698h.604c.404 0 .656.252.656.644 0 .393-.252.645-.656.645h-.604v3.006c0 .445.153.633.522.662l.111.012c.422.046.65.222.65.62 0 .505-.492.762-1.212.762h-.059c-1.143 0-1.723-.568-1.723-1.675zm-6.83 1.728c-.498 0-.855-.305-.855-.89v-6.938c0-.55.316-.879.844-.879.527 0 .837.328.837.879v2.543h.036c.333-.791 1.02-1.236 1.974-1.236 1.395 0 2.192.902 2.192 2.355v3.275c0 .586-.352.891-.856.891-.498 0-.855-.305-.855-.89V15.32c0-.808-.399-1.3-1.178-1.3-.809 0-1.283.568-1.283 1.394v2.818c0 .586-.352.891-.856.891z"})]})}),phone_number:rp,place:sp}},Sp=o(166883).x;function fp(e){const{style:t,propertyType:o}=e,i="dark"===(0,S().DP)().mode?"dark":"light",r=(0,n.useMemo)((()=>({...t})),[t]);return(0,l().K8)((()=>(0,Ou().XO)(o)?mp[i][o](r):Sp(r)),[o,i,r])}var yp=()=>o(98205),hp=()=>o(630960),xp=()=>o(465741),vp=()=>o(38337),Cp=()=>o(299487),bp=()=>o(978846),wp=()=>o(63667),jp=()=>o(478573);function Ap(e){const{questionStore:t,name:o}=e,{collectionStore:n}=(0,Tl().LH)(),i=(0,l().K8)((()=>{const e=t.getPropertyId();if(!n||!e)return;const o=n.getSchema();return(0,Lu()._g)({schema:o,property:e})}),[n,t]);if(!i)return null;const r=i.type;return(0,k.jsx)(jp().A,{...e,icon:(0,k.jsx)(fp,{propertyType:i.type}),name:o,subText:rl().dC[r],disabled:!1})}var _p=()=>o(959733);function Ip(e){const{area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:i,collectionContextStore:s}=e,a=(0,r().Y0)(),c=(0,f().tz)(),{layoutStore:d}=(0,Tl().LH)(),u=(0,l().K8)((()=>s.collectionStore()),[s]);return(0,l().K8)((()=>u?(null==d?void 0:d.getNormalizedFormQuestionStoresForFormLayout({collectionSchema:u.getSchema()}))??[]:[]),[d,u]).length>=xp().eb?(0,k.jsx)(y().Ay,{...e,title:c.formatMessage(xp().Gi.questionLimitReachedTitle),children:(0,k.jsx)("div",{style:{padding:16,paddingTop:2,fontSize:12},children:c.formatMessage(xp().Gi.questionLimitReachedSubtitle)})}):(0,k.jsx)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{id:"formQuestionCreateSettings.menuTitle",defaultMessage:"Select type"}),menuScrollerStyle:a.isMobile?void 0:{maxHeight:600},children:(0,k.jsx)(kp,{area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:i,collectionContextStore:s})})}const Mp=(0,f().YK)({showMore:{defaultMessage:"Show {numAdditionalProperties} more",id:"formQuestionCreateSettings.showMore"}});function kp(e){const{area:t,moduleId:o,parentModuleId:i,parentConditionalGroupId:s,collectionContextStore:a}=e,[c,d]=(0,n.useState)(!1),u=function(e){const{area:t,collectionContextStore:o,moduleId:n,parentModuleId:i,parentConditionalGroupId:s}=e,a=(0,r().v3)(),{layoutStore:c,collectionStore:d}=(0,Tl().LH)(),u=(0,l().K8)((()=>{var e;return Boolean(null===(e=o.collectionViewStore())||void 0===e||null===(e=e.getFormBlockStore())||void 0===e?void 0:e.hasSitePublicPermission())}),[o]),p=Tp({area:t,moduleId:n,parentModuleId:i,parentConditionalGroupId:s,collectionContextStore:o}),g=(0,hp().in)({layoutStore:c,collectionStore:d});return(0,l().K8)((()=>{if(!d)return[];const e=d.getSchema(),t=g.map((t=>{const o=(0,Lu()._g)({schema:e,property:t});if(!o)return;const n=(0,xp().CK)({environment:a,propertyType:o.type,propertySchema:o,isPublicForm:u});let i=null;return"invalid_property_type_for_public_form"===n?i=(0,k.jsx)(f().sA,{...hp().yh.unsupportedPublicQuestionType}):"related_collection_not_public"===n&&(i=(0,k.jsx)(f().sA,{...hp().yh.relatedCollectionNotPublic})),{key:t,keywords:[o.name],render:e=>{let{ref:o,...r}=e;return(0,k.jsx)("div",{style:{width:"100%"},children:(0,k.jsx)(wp().k,{...r,propertyId:t,tooltip:i,disabled:Boolean(n)})})},action:()=>{p({type:"existingProperty",propertyId:t})}}})).filter(In().O9);return t}),[d,g,a,u,p])}({area:t,collectionContextStore:a,moduleId:o,parentModuleId:i,parentConditionalGroupId:s}),p=function(e){const{area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:i,collectionContextStore:s}=e,a=(0,r().v3)(),c=(0,l().K8)((()=>{var e;return Boolean(null===(e=s.collectionViewStore())||void 0===e||null===(e=e.getFormBlockStore())||void 0===e?void 0:e.hasSitePublicPermission())}),[s]),d=Tp({area:t,moduleId:o,parentModuleId:n,parentConditionalGroupId:i,collectionContextStore:s}),u=(0,_p().g)({actionHandler:e=>d({type:"newProperty",propertyType:(0,de().v2)(e)}),renderIcon:e=>(0,k.jsx)(fp,{propertyType:(0,de().v2)(e)}),tooltip:e=>{if("invalid_property_type_for_public_form"===(0,xp().CK)({environment:a,propertyType:(0,de().v2)(e),isPublicForm:c}))return{image:void 0,caption:hp().yh.unsupportedPublicQuestionType}},disabled:e=>{const t=(0,xp().CK)({environment:a,propertyType:(0,de().v2)(e),isPublicForm:c});return Boolean(t)}}),p=(0,lo().X)("place_property");return(0,l().K8)((()=>Ou().m3.filter((e=>"select"!==e&&!("place"===e&&!p))).map((e=>{if("relation"!==e&&(0,Ou().XO)(e))return"title"!==e?u(e):void 0})).filter(In().O9)),[u,p])}({area:t,moduleId:o,parentModuleId:i,parentConditionalGroupId:s,collectionContextStore:a}),m=function(e,t,o){const i=(0,r().v3)(),{layoutStore:s,collectionStore:a,setModuleSelection:c,sessionId:d}=(0,Tl().LH)(),u=(0,l().K8)((()=>s.getModules()),[s]),p=(0,l().K8)((()=>[...u.form_layout_schema,...Object.values(u.form_conditional_modules??{})].filter((e=>"formQuestion"===e.type))),[u]),m=(0,l().K8)((()=>(0,Ou().Cg)({moduleId:o??e,modulesByArea:u})),[u,e,o]),S=o?m.length-1:m.length,f=(0,n.useCallback)((e=>{const o=e.parentConditionalGroupId===t,n=m.includes(e.id),i=(0,yp().Yg)({currentModule:e,nestedModules:u.form_conditional_modules||{},includePlaceholders:!0}).maxDepth+S>Ou().mh;return!o&&!n&&!i}),[t,m,u,S]),y=(0,n.useCallback)((o=>{void 0!==t&&void 0!==e&&(g().createAndCommit({userAction:"FormQuestionCreateSettings.moveExistingQuestion",canUndo:!0,environment:i,perform:n=>{(0,bp().E)({position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:t,parentModuleId:e},moduleId:o.id,environment:i,layoutStore:s,transaction:n,sessionId:d})}}),c({type:"existing_module",moduleId:o.id,isDragging:!1}))}),[i,t,e,s,c,d]);return(0,l().K8)((()=>{if(!a)return[];const e=p.filter(f).map((e=>{const t=ct().c7.createChildStore(s,{table:"form_question",id:e.formQuestionId,spaceId:s.getSpaceId()??""});if(void 0===t)return;const o=(0,zu().r4)({textValue:t.getNameStore().getValue(),getRecordModel:t.getRecordModel,deterministic:!0,userTimeZone:(0,ca().P)(),intl:jt().A.getIntl()});return{key:t.id,keywords:[o],render:e=>{let{ref:n,...i}=e;return(0,k.jsx)("div",{style:{width:"100%"},children:(0,k.jsx)(Ap,{...i,name:o,questionStore:t})})},action:()=>{y(e)}}})).filter(In().O9);return e}),[a,y,p,s,f])}(i,s,o),y=(0,S().IS)((e=>({showMoreIcon:{width:16,height:16,marginLeft:4,marginRight:4,fill:e.icon.tertiary},showMoreButton:{height:42,color:e.text.tertiary,marginLeft:0}})),[]),h=function(e){const{key:t,title:o,items:n,limit:i}=e,r={key:"show-more",keywords:[],action:()=>{},render:e=>(0,k.jsx)(Pe().A,{...e,id:vp().v4C,icon:(0,ol()._)({...y.showMoreIcon}),title:jt().A.formatMessage(Mp.showMore,{numAdditionalProperties:i?n.length-i:n.length}),desktopIconStyle:{marginLeft:7,marginRight:5},style:y.showMoreButton,onClick:e=>{d(!0),e.stopPropagation()}})},l=void 0!==i&&n.length>i,s=[...l?n.slice(0,i):n,...l?[r]:[]];return{key:t,render:e=>(0,k.jsx)(ae().A,{title:o,...e,style:{display:"flex",flexDirection:"column",alignItems:"center",paddingLeft:"8px",paddingRight:"8px",paddingTop:"new-properties"===t&&u.length>0?8:0,paddingBottom:0},desktopTitleStyle:{alignSelf:"flex-start",paddingLeft:"8px"}}),items:s}},x=c?void 0:5,v=h({key:"existing-properties",title:(0,k.jsx)(f().sA,{id:"formQuestionCreateSettings.existingPropertiesSectionTitle",defaultMessage:"Existing properties"}),items:u,limit:x}),C=h({key:"new-properties",title:u.length>0||m.length>0?(0,k.jsx)(f().sA,{id:"formQuestionCreateSettings.newPropertiesSectionTitle",defaultMessage:"New question"}):void 0,items:p}),b=h({key:"existing-questions",title:m.length>0?(0,k.jsx)(f().sA,{id:"formQuestionCreateSettings.existingQuestionsSectionTitle",defaultMessage:"Existing questions"}):void 0,items:m});return(0,k.jsx)(ae().A,{children:(0,k.jsx)(_e().Ay,{initialFocus:0,type:_e().Oh.Vertical,sections:[...m.length>0&&void 0!==i&&void 0!==s?[b]:[],...u.length>0?[v]:[],...p.length>0?[C]:[]]})})}function Tp(e){const{area:t,moduleId:o,parentModuleId:i,parentConditionalGroupId:s,collectionContextStore:a}=e,c=(0,r().v3)(),{layoutStore:d,collectionStore:u,setModuleSelection:p,sessionId:m}=(0,Tl().LH)(),{autofocusedQuestionTextStore:S,formAddConditionalLogicTooltipStore:f}=(0,Uu().cJ)(),{currentUserSettingsStore:y}=(0,l().K8)((()=>ce().default.state),[]);return(0,n.useCallback)((e=>{g().createAndCommit({userAction:"FormQuestionCreateSettings.createFormQuestion",environment:c,canUndo:!0,undoCheckpoint:`form_layout_new_question_${o}`,perform:n=>{if(!u)throw new Error("Collection store not found");const r=(()=>{if("existingProperty"===e.type)return e.propertyId;const t=e.propertyType;return ve().IL({environment:c,collectionStore:u,collectionViewArgs:void 0,propertyName:rl().dC[t],propertyType:t,transaction:n})})(),l=(()=>{if("existingProperty"===e.type){const e=u.getSchema()[r];return null==e?void 0:e.type}return e.propertyType})();if(!("form_conditional_modules"!==t||i&&s))throw new Error("Parent module ID and parent conditional group ID are required for nested modules");const{updatedModuleId:g,formQuestionId:h}=(0,Nu().createFormQuestionAndUpdateOrCreateModule)({environment:c,transaction:n,layoutStore:d,moduleId:o,propertyId:r,initialQuestionTitle:(()=>{if("existingProperty"===e.type){const e=u.getSchema()[r];return e?e.name:""}{const t=e.propertyType;if((0,Ou().XO)(t)&&"select"!==t)return xp().mY[t]}})()??"",shouldSyncQuestionNameToPropertyName:"newProperty"===e.type,collectionContextStore:a,autofocusTitle:{shouldAutofocus:!0,autofocusedQuestionTextStore:S},sessionId:m,..."form_conditional_modules"===t&&i&&s?{area:t,parentModuleId:i,parentConditionalGroupId:s}:{area:"form_layout_schema"}});p({type:"existing_module",moduleId:g,isDragging:!1});const x=null==y?void 0:y.getSettingsStore().getKeyStore("seen_forms_add_conditional_logic_tooltip").getValue();"checkbox"!==l||x||f.setState({openTooltip:(0,yp().fY)({formQuestionId:h})})}}),Cp().HH(c,yp().wG)}),[c,m,u,d,o,a,S,t,i,s,p,f,y])}const Pp=function(e){return(0,k.jsx)(vu().I,{children:(0,k.jsx)(Ip,{...e})})};var Bp=()=>o(665589),Vp=()=>o(419178),Fp=()=>o(566534),Ep=()=>o(655923),Rp=()=>o(112282),Dp=()=>o(638045);const Kp={viewBox:"0 0 20 20",fittedViewBox:"3.9 3.07 12.2 13.86",svg:(0,k.jsx)("path",{d:"M10 3.075c.345 0 .625.28.625.625v5.217l4.518-2.608a.625.625 0 1 1 .625 1.082L11.25 10l4.518 2.609a.625.625 0 0 1-.625 1.082l-4.518-2.609V16.3a.625.625 0 0 1-1.25 0v-5.218l-4.518 2.61a.625.625 0 1 1-.625-1.083l4.518-2.61-4.518-2.608a.625.625 0 1 1 .625-1.082l4.518 2.608V3.7c0-.345.28-.625.625-.625"})},Op=(0,pn().wt)("asterisk",Kp),Lp={viewBox:"0 0 20 20",fittedViewBox:"0 0 20 20",svg:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("g",{clipPath:"url(#clip0_9869_14376)",children:(0,k.jsx)("path",{d:"M6.25 3.125a3.125 3.125 0 1 0 0 6.25 3.125 3.125 0 0 0 0-6.25M4.375 6.25a1.875 1.875 0 1 1 3.75 0 1.875 1.875 0 0 1-3.75 0m1.875 4.375a3.125 3.125 0 1 0 0 6.25 3.125 3.125 0 0 0 0-6.25M4.375 13.75a1.875 1.875 0 1 1 3.75 0 1.875 1.875 0 0 1-3.75 0m6.25-7.5a3.125 3.125 0 1 1 6.25 0 3.125 3.125 0 0 1-6.25 0m3.125-1.875a1.875 1.875 0 1 0 0 3.75 1.875 1.875 0 0 0 0-3.75m0 6.25a3.125 3.125 0 1 0 0 6.25 3.125 3.125 0 0 0 0-6.25m-1.875 3.125a1.875 1.875 0 1 1 3.75 0 1.875 1.875 0 0 1-3.75 0"})}),(0,k.jsx)("defs",{children:(0,k.jsx)("clipPath",{id:"clip0_9869_14376",children:(0,k.jsx)("path",{d:"M0 0h20v20H0z"})})})]})},zp=(0,pn().wt)("circleGrid2X2",Lp);var Np=()=>o(274570),Up=()=>o(62616),Wp=()=>o(764781),Hp=()=>o(765974),$p=()=>o(594088),Gp=()=>o(813197),Qp=()=>o(524060),Zp=()=>o(688311),qp=()=>o(467248),Yp=()=>o(42583),Jp=()=>o(500993),Xp=()=>o(475140),eg=()=>o(251822),tg=()=>o(901952),og=()=>o(181922),ng=()=>o(832857),ig=()=>o(802975),rg=()=>o(37165),lg=()=>o(183558),sg=()=>o(312296);function ag(e){const{environment:t,module:o,collectionStore:n,formQuestionStore:i,transaction:r,position:l,layoutStore:s,autofocusTitle:a,duplicateModuleMapping:c,questionModulePropertyUpdateMap:d,propertyIdMapping:u,sessionId:p,collectionContextStore:g}=e;if("formQuestion"===o.type){const e=null==i?void 0:i.getConfig(),m=d.get(o.id);if(!m)return;(0,sg().F)({environment:t,collectionStore:n,update:{[m.newProperty]:m.newPropertySchema},transaction:r}),(0,Nu().createModuleForNewlyDuplicatedProperty)({type:o.type,environment:t,module:o,layoutStore:s,collectionStore:n,propertyId:m.newProperty,position:l,collectionContextStore:g,autofocusTitle:a,shouldLogEvent:!1,existingFormQuestionConfig:e,duplicateModuleMapping:c,sessionId:p,transaction:r,propertyIdMapping:u})}else(0,Nu().createModuleForNewlyDuplicatedProperty)({type:o.type,environment:t,module:o,layoutStore:s,collectionContextStore:g,shouldLogEvent:!1,position:l,duplicateModuleMapping:c,sessionId:p,transaction:r})}function cg(e){const{environment:t,questionStore:o,autofocusedQuestionTextStore:n,currValue:i}=e;g().createAndCommit({userAction:"formQuestion.toggleShowDescription",environment:t,canUndo:!0,perform:e=>{const t=!i;g().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","showDescription"],command:"set",args:t},transaction:e}),t||function(e){var t;const{questionStore:o,autofocusedQuestionTextStore:n,transaction:i}=e;void 0===(null===(t=o.getConfig())||void 0===t?void 0:t.description)&&g().applyOperation({store:o,operation:{pointer:o.pointer,path:["config","description"],command:"set",args:(0,_n().x9d)("")},transaction:i});n.autofocusQuestionDescription({questionId:o.id})}({questionStore:o,autofocusedQuestionTextStore:n,transaction:e})}})}var dg=()=>o(536308),ug=()=>o(811979),pg=()=>o(47170),gg=()=>o(237775);function mg(e){let{children:t}=e;return(0,k.jsx)(Ie().A,{renderTooltip:()=>(0,k.jsx)(f().sA,{id:"FormSettingsNameSyncTooltip.tooltip",defaultMessage:"Renaming a question also renames its linked database property. Disable to keep names separate."}),placement:Pt().W.Left,alignment:Pt().C.Center,textWrap:!0,render:e=>(0,k.jsx)("div",{...e,children:t})})}function Sg(e){let{tooltipState:t,disableTooltip:o,children:i}=e;const r=(0,n.useMemo)((()=>{if(!t)return null;switch(t){case"deleted_property":return(0,k.jsx)(f().sA,{id:"FormSettingsComingSoonTooltip.deletedProperty",defaultMessage:"The linked property has been deleted."});case"invalid_property_type":return(0,k.jsx)(f().sA,{id:"FormSettingsComingSoonTooltip.invalidProperty",defaultMessage:"The linked property is an unsupported type."});case"invalid_property_type_for_public_form":return(0,k.jsx)(f().sA,{...hp().yh.unsupportedPublicQuestionType});case"related_collection_not_public":return(0,k.jsx)(f().sA,{...hp().yh.relatedCollectionNotPublic});case"generic_error":return(0,k.jsx)(f().sA,{id:"FormSettingsErrorTooltip.genericError",defaultMessage:"There is an issue with this linked property."});default:(0,In().HB)(t)}}),[t]);return(0,k.jsx)(Ie().A,{renderTooltip:()=>r,disableTooltip:o,placement:Pt().W.Left,render:e=>(0,k.jsx)("div",{...e,children:i})})}function fg(e){const{collectionContextStore:t,collectionSettingsStore:o,formQuestionId:n,moduleId:i}=e,s=(0,r().v3)(),{collectionViewStore:a,formBlockStore:c}=(0,l().K8)((()=>{var e;return{collectionViewStore:t.collectionViewStore(),formBlockStore:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormBlockStore()}}),[t]),d=(0,l().K8)((()=>{if(!a)throw new Error("no collectionViewStore found");const e=a.getSpaceId();if(!e)throw new Error("no spaceId found");return gg().c.createChildStore(a,{table:"form_question",id:n,spaceId:e})}),[a,n]),u=(0,l().K8)((()=>{var e;return null===(e=d.getConfig())||void 0===e?void 0:e.propertyId}),[d]),p=(0,l().K8)((()=>{if(!u)return;return t.normalizedSchemaStore.state[u]}),[t.normalizedSchemaStore,u]),g=(0,l().K8)((()=>{const e=t.normalizedSchemaStore.state;return d?d.getQuestionErrorState(s,e,null==c?void 0:c.hasSitePublicPermission()):"generic_error"}),[t.normalizedSchemaStore,s,c,d]),m=(0,l().K8)((()=>{if(p)return p.type}),[p]);return u?(0,k.jsx)(vu().I,{children:(0,k.jsxs)(y().Ay,{...e,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.menuTitle",defaultMessage:"Question options"}),children:[(0,k.jsxs)(ae().A,{children:[(0,k.jsx)(xg,{collectionContextStore:t,formQuestionStore:d}),(0,k.jsx)(Mg,{collectionContextStore:t,formQuestionStore:d}),(0,k.jsx)(hg,{collectionContextStore:t,propertySchema:p,formQuestionStore:d})]}),(0,k.jsxs)(ae().A,{topBorder:!0,children:[(0,k.jsx)(yg,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:d,propertyId:u,propertyType:m,questionErrorState:g}),(0,k.jsx)(_g,{collectionSettingsStore:o,collectionContextStore:t,formQuestionStore:d,questionErrorState:g}),(0,k.jsx)(vg,{collectionContextStore:t,formQuestionStore:d})]}),(0,k.jsxs)(ae().A,{topBorder:!0,children:[(0,k.jsx)(Bg,{collectionSettingsStore:o,moduleId:i}),(0,k.jsx)(Tg,{moduleId:i,propertyId:u,propertySchema:p}),(0,k.jsx)(Pg,{moduleId:i}),(0,k.jsx)(Fg,{collectionSettingsStore:o,collectionContextStore:t,moduleId:i,propertyId:u,propertySchema:p,formQuestionStore:d}),(0,k.jsx)(Ig,{collectionSettingsStore:o,collectionContextStore:t,moduleId:i,formQuestionStore:d})]})]})}):null}function yg(e){let{collectionSettingsStore:t,collectionContextStore:o,formQuestionStore:i,propertyId:s,propertyType:a,questionErrorState:c}=e;const d=(0,r().v3)(),{layoutStore:u}=(0,Tl().LH)(),{isCollectionEmpty:p}=(0,Uu().cJ)(),{collectionStore:m,collectionSchema:y,collectionViewStore:h,formatKey:x}=(0,l().K8)((()=>({collectionStore:o.collectionStore(),collectionSchema:o.normalizedSchemaStore.state,collectionViewStore:o.collectionViewStore(),formatKey:o.getPropertyFormatKey()})),[o]),v=(0,l().K8)((()=>a&&(0,Ou().XO)(a)?"select"===a?"multi_select":a:"not_found"),[a]),C=c?Hp().exclamationMarkTriangleFillIcon:zp,b=(0,S().IS)((e=>({iconContainer:{background:"light"===e.mode?e.white:e.palette.translucentGray[100],borderWidth:1,borderStyle:"solid",borderColor:"light"===e.mode?e.palette.gray[100]:e.palette.translucentGray[300],minWidth:32,width:32,height:32,borderRadius:4,overflow:"hidden"}})),[]),w=(0,hp().in)({layoutStore:u,collectionStore:m}),j=(0,lo().X)("place_property"),A=Ou().m3.filter((e=>"place"!==e||j)),_=(0,l().K8)((()=>{const e=[];return A.forEach((t=>{"select"!==t&&e.push({key:t,type:"button",title:xp().mY[t],hideOption:"title"===t&&!w.includes(de().rn)||"relation"===t,icon:(0,k.jsx)("div",{style:b.iconContainer,children:(0,k.jsx)(fp,{propertyType:t})})})})),e.push({key:"not_found",type:"button",hideOption:!0,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.questionType.propertyNotFound",defaultMessage:"Not Found"})}),e}),[A,w,b.iconContainer]),I=(0,l().K8)((()=>null==m?void 0:m.getDatabaseType()),[m]),M=(0,n.useCallback)((e=>{(0,tg().V)({environment:d,collectionContextStore:o,property:s,new_property_type:e,from:"form_editor",action:"change_type"}),g().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:d,canUndo:!0,perform:t=>{if(m)if(a!==de().rn)e===de().rn?(Is().KY({store:i.getConfigStore().getKeyStore("propertyId"),value:de().rn,transaction:t}),p&&(ve().BJ({environment:d,collectionStore:m,schema:y,property:s,transaction:t}),t.postSubmitCallbacks.push((e=>{e||dg().formEditorActions.maybeSyncQuestionNameToPropertyName({environment:d,questionStore:i,collectionStore:m,collectionContextStore:o})})))):ve().Hj({environment:d,collectionStore:m,property:s,type:e,transaction:t});else{const o=ve().IL({environment:d,collectionStore:m,propertyType:e,transaction:t,collectionViewArgs:h&&x?{collectionViewStore:h,format:h.getFormat(),formatKey:x}:void 0});Is().KY({store:i.getConfigStore().getKeyStore("propertyId"),value:o,transaction:t})}}})}),[d,m,a,h,x,i,p,y,s,o]),T=(0,n.useCallback)((e=>{if("not_found"===e||!m)return;const t=y[s];og().g({environment:d,collectionContextStore:o,propertyId:s,propertySchema:t,handlePropertyTypeChange:()=>M(e)})}),[d,o,s,m,y,M]);return m?(0,k.jsx)(Sg,{tooltipState:c,disableTooltip:void 0===c,children:(0,k.jsx)(wt().A,{icon:C,options:_,disabled:"not_found"===v||void 0!==I,title:(0,k.jsx)(f().sA,{defaultMessage:"Question type",id:"formQuestionEditSettings.questionType.menuTitle"}),selectedKey:v,menuItemOptionsStyle:{paddingTop:4,paddingBottom:4},onChange:T})}):null}function hg(e){const{propertySchema:t,formQuestionStore:o,collectionContextStore:n}=e,i=(0,l().K8)((()=>{const e=null==t?void 0:t.type;if(e&&!(0,Ou().XO)(e)||!e)return null;switch(e){case"title":case"text":return(0,k.jsx)(Ag,{formQuestionStore:o,propertyType:e,collectionContextStore:n});case"select":return(0,k.jsx)(kg,{formQuestionStore:o,collectionContextStore:n,propertySchema:t});case"multi_select":return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(kg,{formQuestionStore:o,collectionContextStore:n,propertySchema:t}),(0,k.jsx)(jg,{formQuestionStore:o,propertySchema:t,collectionContextStore:n})]});case"relation":case"person":return(0,k.jsx)(jg,{formQuestionStore:o,propertySchema:t,collectionContextStore:n});case"date":return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Cg,{formQuestionStore:o,collectionContextStore:n}),(0,k.jsx)(bg,{formQuestionStore:o,collectionContextStore:n})]});case"file":case"number":case"checkbox":case"email":case"url":case"phone_number":case"place":return(0,k.jsx)(k.Fragment,{});default:(0,In().HB)(e)}}),[n,o,t]);return(0,k.jsx)(k.Fragment,{children:i})}function xg(e){let{collectionContextStore:t,formQuestionStore:o}=e;const i=(0,l().K8)((()=>o.isRequired()),[o]),s=(0,r().v3)(),a=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;g().createAndCommit({userAction:"formQuestion.toggleRequired",environment:o,canUndo:!0,perform:e=>{g().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","required"],command:"set",args:!n},transaction:e})}})}({environment:s,questionStore:o,currValue:o.isRequired()})}),[s,o]),c=Eg({collectionContextStore:t,formQuestionStore:o});return(0,k.jsx)(Dl().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Required",id:"formQuestionEditSettings.isRequired.title"}),switcherProps:{on:i},icon:Op,onClick:a,disabled:c})}function vg(e){let{collectionContextStore:t,formQuestionStore:o}=e;const i=(0,l().K8)((()=>o.shouldSyncQuestionNameToPropertyName()),[o]),s=(0,r().v3)(),a=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;g().createAndCommit({userAction:"formQuestion.toggleShouldSyncQuestionNameToPropertyName",environment:o,canUndo:!0,perform:e=>{g().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","shouldSyncQuestionNameToPropertyName"],command:"set",args:!n},transaction:e})}})}({environment:s,questionStore:o,currValue:o.shouldSyncQuestionNameToPropertyName()})}),[s,o]),c=Eg({collectionContextStore:t,formQuestionStore:o});return(0,k.jsx)(mg,{children:(0,k.jsx)(Dl().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Sync with property name",id:"formQuestionEditSettings.shouldSyncQuestionNameToPropertyName.title"}),switcherProps:{on:i},icon:Zp().h,onClick:a,disabled:c})})}function Cg(e){let{collectionContextStore:t,formQuestionStore:o}=e;const i=(0,r().v3)(),s=(0,l().K8)((()=>{var e;return(null===(e=o.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1}),[o]),a=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;g().createAndCommit({userAction:"formQuestion.changeEndDateSetting",environment:o,canUndo:!0,perform:e=>{g().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyTypeSpecificConfig","date","endDate"],command:"set",args:!n},transaction:e})}})}({environment:i,questionStore:o,currValue:s})}),[s,i,o]),c=Eg({collectionContextStore:t,formQuestionStore:o});return(0,k.jsx)(Dl().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"End date",id:"formQuestionEditSettings.date.endDate.title"}),switcherProps:{on:s},icon:Yp().D,onClick:a,disabled:c})}function bg(e){let{collectionContextStore:t,formQuestionStore:o}=e;const i=(0,r().v3)(),s=(0,l().K8)((()=>{var e;return(null===(e=o.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.includeTime)??!1}),[o]),a=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n}=e;g().createAndCommit({userAction:"formQuestion.changeIncludeTimeSetting",environment:o,canUndo:!0,perform:e=>{g().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyTypeSpecificConfig","date","includeTime"],command:"set",args:!n},transaction:e})}})}({environment:i,questionStore:o,currValue:s})}),[s,i,o]),c=Eg({collectionContextStore:t,formQuestionStore:o});return(0,k.jsx)(Dl().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Include time",id:"formQuestionEditSettings.date.includeTime.title"}),switcherProps:{on:s},icon:Np().clockIcon,onClick:a,disabled:c})}const wg=hp().Jz.map((e=>e.key));function jg(e){let{collectionContextStore:t,formQuestionStore:o,propertySchema:i}=e;const s=(0,r().v3)(),a=(0,f().tz)(),{selectedKey:c,maxSelection:d}=(0,l().K8)((()=>{const e=(0,Ou().hm)(i,o.getModel()),t=null==e?void 0:e.toString();let n="custom";return void 0===e?n="unlimited":t&&wg.includes(t)&&(n=t),{selectedKey:n,maxSelection:e}}),[o,i]),[u,p]=(0,n.useState)("custom"===c?null==d?void 0:d.toString():""),m=(0,n.useCallback)(((e,t,n)=>{let r;switch(e){case"unlimited":r=void 0;break;case"custom":if(!n)return;r=parseInt(n,10);break;default:r=parseInt(e,10)}void 0!==r&&(isNaN(r)||!Number.isInteger(r)||r<1||r>1e3)?p(""):g().createAndCommit({environment:s,userAction:"MaxSelectionComponent.handleUpdateSelection",canUndo:!0,perform:e=>{Is().KY({store:o.getKeyStore("config").getKeyStore("propertyTypeSpecificConfig").getKeyStore(i.type).getKeyStore("maxSelectionCount"),value:r,transaction:e})}})}),[s,o,i.type,p]);function S(e){const t=/[^0-9]/g;t.test(e)&&Ot().D6({label:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.maxSelection.nonNumberWarning",defaultMessage:"Please enter a number."})});const o=e.replace(t,"");p(o)}const y=(0,n.useMemo)((()=>{const e={key:"custom",type:"input",inputValue:u,onSubmit:m,onChange:S};return[...hp().Jz,e]}),[m,u]),h=Eg({collectionContextStore:t,formQuestionStore:o});return(0,k.jsx)(Ie().A,{textWrap:!0,alignment:Pt().C.Center,placement:Pt().W.Left,disableTooltip:!((0,Lu().bu)(i)&&i.limit),renderTooltip:()=>{if((0,Lu().bu)(i)&&void 0!==i.limit)return(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.maxSelection.error.tooltip",defaultMessage:"A limit of 1 has been set on the linked property. Please remove the limit on the linked property in order to configure this question’s max selection."})},render:e=>(0,k.jsx)(wt().A,{...e,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.maxSelection.title",defaultMessage:"Max selection"}),icon:Gp().L,selectedKey:c,options:y,onChange:m,disabled:h||(0,Lu().bu)(i)&&void 0!==i.limit,inputPlaceholder:a.formatMessage({id:"formQuestionEditSettings.maxSelection.inputPlaceholder",defaultMessage:"Custom"})})})}function Ag(e){let{collectionContextStore:t,formQuestionStore:o,propertyType:i}=e;const s=(0,l().K8)((()=>{var e;return(null===(e=o.getPropertyTypeSpecificConfig(i))||void 0===e?void 0:e.longAnswer)??!1}),[o,i]),a=(0,r().v3)(),c=(0,n.useCallback)((()=>{!function(e){const{questionStore:t,environment:o,currValue:n,propertyType:i}=e;g().createAndCommit({userAction:"formQuestion.changeName",environment:o,canUndo:!0,perform:e=>{g().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyTypeSpecificConfig",i,"longAnswer"],command:"set",args:!n},transaction:e})}})}({environment:a,questionStore:o,currValue:s,propertyType:i})}),[s,a,o,i]),d=Eg({collectionContextStore:t,formQuestionStore:o});return(0,k.jsx)(Dl().A,{title:(0,k.jsx)(f().sA,{defaultMessage:"Long answer",id:"formQuestionEditSettings.longAnswer.title"}),switcherProps:{on:s},icon:Bp().l,onClick:c,disabled:d})}function _g(e){let{collectionContextStore:t,collectionSettingsStore:o,formQuestionStore:n,questionErrorState:i}=e;const s=(0,S().DP)(),a=(0,r().v3)(),c=(0,l().K8)((()=>{var e;return null===(e=n.getConfig())||void 0===e?void 0:e.propertyId}),[n]),d=(0,l().K8)((()=>{if(!c)return;const e=t.normalizedSchemaStore.state[c];return e?e.name:void 0}),[t.normalizedSchemaStore,c]),{layoutStore:p,collectionStore:g}=(0,Tl().LH)(),m=(0,hp().in)({layoutStore:p,collectionStore:g}),y=(0,l().K8)((()=>{const e=[];return m.forEach((o=>{const n=t.normalizedSchemaStore.state[o];n&&(0,Ou().Sg)(n)&&e.push({key:o,type:"button",title:n.name,icon:(0,k.jsx)(ue().zB,{type:n.type,theme:s,icon:void 0,size:16,style:{fill:s.icon.primary}})})})),e.push({key:"not_found",type:"button",hideOption:!0,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.linkedProperty.propertyNotFound",defaultMessage:"Not Found"})}),e}),[s,t.normalizedSchemaStore,m]);return(d||i)&&c?"deleted_property"===i?(0,k.jsx)(wt().A,{disabled:y.every((e=>!0===e.hideOption)),icon:Up().c,title:(0,k.jsx)(f().sA,{defaultMessage:"Linked property",id:"formQuestionEditSettings.linkedProperty.title"}),selectedKey:"not_found",onChange:e=>dg().formEditorActions.remapQuestionToNewProperty({environment:a,formQuestionStore:n,newPropertyId:e}),options:y}):(0,k.jsx)(kt().A,{icon:Up().c,title:(0,k.jsx)(f().sA,{defaultMessage:"View linked property",id:"formQuestionEditSettings.viewLinkedProperty.title"}),showChevron:!0,onClick:()=>{u().a2({collectionSettingsStore:o,item:{type:"property",formatKey:void 0,property:c}})}}):null}function Ig(e){let{collectionContextStore:t,collectionSettingsStore:o,moduleId:i,formQuestionStore:s}=e;const{layoutStore:a,sessionId:c}=(0,Tl().LH)(),{isCollectionEmpty:d}=(0,Uu().cJ)(),u=(0,r().v3)(),p=(0,l().K8)((()=>(0,Xp().Ib)({modulesByArea:a.getModules(),find:e=>i===e.id})),[a,i]),m=(0,n.useCallback)((()=>{void 0!==p&&g().createAndCommit({userAction:"formActions.deleteFormQuestion",environment:u,canUndo:!0,perform:e=>{(0,ig().B)({environment:u,module:p.module,sessionId:c,layoutStore:a,transaction:e,collectionSettingsStore:o,isCollectionEmpty:d,collectionContextStore:t,area:p.area,updateParentModule:!0})}})}),[t,o,u,d,a,c,p]);return(0,k.jsx)(kt().A,{icon:hl().trashIcon,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.deleteQuestion.title",defaultMessage:"Delete question"}),onClick:m})}function Mg(e){let{formQuestionStore:t,collectionContextStore:o}=e;const i=(0,r().v3)(),{autofocusedQuestionTextStore:s}=(0,Uu().cJ)(),a=(0,l().K8)((()=>{var e;return Boolean(null===(e=t.getConfig())||void 0===e?void 0:e.showDescription)}),[t]),c=(0,n.useCallback)((()=>{cg({environment:i,questionStore:t,autofocusedQuestionTextStore:s,currValue:a})}),[s,i,t,a]),d=Eg({collectionContextStore:o,formQuestionStore:t});return(0,k.jsx)(Dl().A,{icon:qp().i,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.addDescription.title",defaultMessage:"Description"}),onClick:c,disabled:d,switcherProps:{on:a}})}function kg(e){let{collectionContextStore:t,formQuestionStore:o,propertySchema:i}=e;const s=(0,r().v3)(),a=null==i?void 0:i.type,c=(0,l().K8)((()=>(0,xp().KU)({formQuestionStore:o,propertySchema:i})),[o,i]),d=(0,n.useCallback)((e=>{a&&g().createAndCommit({environment:s,userAction:"DisplayModeComponent.handleUpdateDisplayMode",canUndo:!0,perform:n=>{var i;Is().KY({store:o.getKeyStore("config").getKeyStore("propertyTypeSpecificConfig").getKeyStore(a).getKeyStore("displayMode"),value:e,transaction:n});const r=o.getParentStore();r&&(0,be().u)({environment:s,event:{eventName:"form_question_display_mode_changed",eventProperties:{...(0,xp().YA)({collectionContextStore:t,propertyId:(null===(i=o.getConfig())||void 0===i?void 0:i.propertyId)??"",questionId:o.id,area:"form_layout_schema",layoutStore:r}),new_display_mode:e}}})}})}),[s,o,a,t]),u=(0,n.useMemo)((()=>[{key:"list",type:"button",title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.displayMode.list",defaultMessage:"List view"})},{key:"dropdown",type:"button",title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.displayMode.dropdown",defaultMessage:"Dropdown"})}]),[]),p=Eg({collectionContextStore:t,formQuestionStore:o});return(0,lo().X)("forms_select_question_display_mode_setting")?(0,k.jsx)(wt().A,{icon:$p().A,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.displayMode.title",defaultMessage:"Show options as"}),selectedKey:c??"list",options:u,onChange:d,disabled:p}):null}function Tg(e){var t;let{moduleId:o,propertyId:i,propertySchema:s}=e;const a=(0,r().v3)(),c=(0,pg().O)(),{layoutStore:d,sessionId:u,setModuleSelection:p}=(0,Tl().LH)(),g=(0,Fl()._X)({name:"forms_conditional_logic",spaceId:c,userId:null===(t=a.currentUser)||void 0===t?void 0:t.id}),m=null==g?void 0:g.upsell,S=(0,l().K8)((()=>{if(s)return"checkbox"===s.type||"select"===s.type||"multi_select"===s.type?s.type:void 0}),[s]),y=(0,l().K8)((()=>(0,Ou().Cg)({moduleId:o,modulesByArea:d.getModules()}).length>=Ou().mh),[d,o]),h=S&&!y,x=(0,l().K8)((()=>(0,Jp().A)(o,d.getModules())),[d,o]),v=(0,n.useCallback)((()=>{"unavailable"!==(null==g?void 0:g.type)||"product"!==(null==m?void 0:m.type)?S&&"available"===(null==g?void 0:g.type)&&ng().lF({environment:a,layoutStore:d,currentQuestionModule:x.module,area:x.area,property:i,filterValue:{type:S,value:void 0},setModuleSelection:p,sessionId:u}):Ho().K(a,{upsell:m,from:"forms_conditional_logic"})}),[null==g?void 0:g.type,m,S,a,d,x.module,x.area,i,p,u]);return h?(0,k.jsx)(kt().A,{icon:Qp().O,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.addConditionalLogic.title",defaultMessage:"Add conditional logic"}),onClick:v}):null}function Pg(e){let{moduleId:t}=e;const o=(0,r().v3)(),{layoutStore:i,sessionId:s}=(0,Tl().LH)(),a=(0,l().K8)((()=>{var e;if(i)return null===(e=i.getModules().form_conditional_modules)||void 0===e?void 0:e[t]}),[i,t]),c=(0,n.useCallback)((()=>{a&&"formQuestion"===a.type&&ng().Ix({environment:o,layoutStore:i,formQuestionModule:a,sessionId:s})}),[o,i,a,s]);return a?(0,k.jsx)(kt().A,{icon:Fp().U,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.removeFromConditionalGroup.title",defaultMessage:"Remove from conditional group"}),onClick:c}):null}function Bg(e){let{collectionSettingsStore:t,moduleId:o}=e;const n=(0,l().uB)(void 0,L().A),{layoutStore:i}=(0,Tl().LH)(),r=(0,l().K8)((()=>(0,Xp().Ib)({modulesByArea:i.getModules(),find:e=>e.id===o})),[i,o]),{currentModuleIndex:s,numChildrenInGroup:a}=(0,l().K8)((()=>(0,Xp().y1)({modulesByArea:i.getModules(),moduleId:o})),[i,o]),{numHeaderModules:c,numFooterModules:d}=(0,l().K8)((()=>{if("form_layout_schema"===(null==r?void 0:r.area)){const e=i.getModules(),t=(0,eg().jS)(r.area,e[r.area]);return{numHeaderModules:t.nonMoveableHeaderModules.length,numFooterModules:t.nonMoveableFooterModules.length}}return{numHeaderModules:0,numFooterModules:0}}),[r,i]);return void 0===r||void 0===s||void 0===a||a-c-d==1?null:(0,k.jsx)(ug().A,{focused:!1,popupType:b().z7.Popup,alignmentToOrigin:b().yP.Center,placementToOrigin:b().sx.Right,buttonPopupStore:n,renderOrigin:e=>(0,k.jsx)(kt().A,{...e,showChevron:!0,title:(0,k.jsx)(f().sA,{defaultMessage:"Move question",id:"formQuestionEditSettings.moveQuestion.title"}),icon:Dp().t,disabled:!1}),render:e=>(0,k.jsx)(Vg,{collectionSettingsStore:t,parent:e,currentModuleAndArea:r,currentModuleIndex:s,numChildrenInGroup:a,numHeaderModules:c,numFooterModules:d})})}function Vg(e){const{collectionSettingsStore:t,parent:o,currentModuleIndex:i,currentModuleAndArea:s,numChildrenInGroup:a,numHeaderModules:c,numFooterModules:d}=e,p=(0,r().v3)(),{layoutStore:g,sessionId:m}=(0,Tl().LH)(),{isFirstInGroup:S,isLastInGroup:y}=(0,n.useMemo)((()=>({isFirstInGroup:0===i-c,isLastInGroup:i===a-d-1})),[i,a,c,d]),h=(0,l().K8)((()=>{if("form_conditional_modules"===s.area){const e=s.module.parentConditionalGroupId,t=s.module.parentModuleId;if(!e||!t)return;return{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:e,parentModuleId:t,index:0}}return{type:"absolute",area:"form_layout_schema",index:c}}),[s,c]);if(!h)return null;const x=[],v={key:"default",items:[{key:"moveUp",render:(e,t)=>S?null:(0,k.jsx)(kt().A,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Move up",id:"formQuestionEditSettings.rearrangeQuestion.moveUp"}),icon:Rp().s,disabled:!1}),action:()=>{(0,bp().E)({environment:p,layoutStore:g,position:{...h,index:i-1},moduleId:s.module.id,sessionId:m}),o.close(),u().os({collectionSettingsStore:t})}},{key:"moveDown",render:(e,t)=>y?null:(0,k.jsx)(kt().A,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Move down",id:"formQuestionEditSettings.rearrangeQuestion.moveDown"}),icon:Ep().v,disabled:!1}),action:()=>{(0,bp().E)({environment:p,layoutStore:g,position:{...h,index:i+1},moduleId:s.module.id,sessionId:m}),o.close(),u().os({collectionSettingsStore:t})}},{key:"moveToTop",render:(e,t)=>S?null:(0,k.jsx)(kt().A,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Move to top of group",id:"formQuestionEditSettings.rearrangeQuestion.moveToTop"}),icon:Vp().Q,disabled:!1}),action:()=>{(0,bp().E)({environment:p,layoutStore:g,position:h,moduleId:s.module.id,sessionId:m}),o.close(),u().os({collectionSettingsStore:t})}},{key:"moveToBottom",render:(e,t)=>y?null:(0,k.jsx)(kt().A,{...e,title:(0,k.jsx)(f().sA,{defaultMessage:"Move to bottom of group",id:"formQuestionEditSettings.rearrangeQuestion.moveToBottom"}),icon:Cd().f,disabled:!1}),action:()=>{(0,bp().E)({environment:p,layoutStore:g,position:{...h,index:a-d-1},moduleId:s.module.id,sessionId:m}),o.close(),u().os({collectionSettingsStore:t})}}],render:e=>(0,k.jsx)(ae().A,{...e})};x.push(v);const C={menuType:Ut().gu.Popup,width:280,maxHeight:400};return(0,k.jsx)(zt().A,{...C,children:(0,k.jsx)(_e().Ay,{initialFocus:void 0,type:_e().Oh.Vertical,sections:x,resetFocusOnMouseOut:!0})})}function Fg(e){let{collectionContextStore:t,moduleId:o,propertyId:i,formQuestionStore:s,propertySchema:a}=e;const c=(0,r().v3)(),d=(0,f().tz)(),{layoutStore:u,sessionId:p,setModuleSelection:m}=(0,Tl().LH)(),{collectionStore:S,autofocusedQuestionTextStore:y}=(0,Uu().cJ)(),h=(0,l().K8)((()=>u.getSpaceId()),[u]),x=(0,l().K8)((()=>{var e;return S?(null===(e=u.getNormalizedFormQuestionStoresForFormLayout({collectionSchema:S.getSchema()}))||void 0===e?void 0:e.length)??0:0}),[u,S]),v=(0,l().K8)((()=>{const e=u.getModules();return(0,Jp().A)(o,e)}),[o,u]),C=(0,n.useCallback)((async()=>{h&&(x>=xp().eb?Ot().D6({label:d.formatMessage(xp().Gi.questionLimitReachedFullMessage)}):await async function(e){let{environment:t,module:o,sessionId:n,layoutStore:i,collectionStore:r,collectionContextStore:l,autofocusedQuestionTextStore:s,area:a,spaceId:c,setModuleSelection:d}=e;const u=i.getModules().form_conditional_modules??{},p=(0,yp().Yg)({currentModule:o,nestedModules:u,includePlaceholders:!0}),m=new Map,S=new Map,f=new Map,y=r.getSchema(),{currentModuleIndex:h}=(0,Xp().y1)({modulesByArea:i.getModules(),moduleId:o.id});for(const g of p.formQuestionDescendants){const e=(0,lg().Ay)();if(m.set(g.id,e),"formQuestion"!==g.type)continue;const o=ct().c7.createChildStore(i,{table:rg().lo,id:g.formQuestionId,spaceId:c}).getPropertyId();if(!o)continue;const n=await(0,wi().W4)({environment:t,schema:y,property:o,parentStore:r,propertyGroups:void 0,spaceId:c});n&&(S.set(g.id,n),f.set(o,n.newProperty))}g().createAndCommit({userAction:"CollectionSettingsProperty.handleDuplicateClick",environment:t,canUndo:!0,perform:e=>{for(const d of p.formQuestionDescendants){const u=d.id===o.id,p="formQuestion"===d.type?ct().c7.createChildStore(i,{table:rg().lo,id:d.formQuestionId,spaceId:c}):void 0,g={type:"module_relative",direction:"below",area:"form_layout_schema",relativeToModuleId:d.id},y=d.parentConditionalGroupId&&d.parentModuleId?{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:d.parentConditionalGroupId,parentModuleId:m.get(d.parentModuleId)??d.parentModuleId,index:u&&void 0!==h?h+1:void 0}:void 0,x=u&&"form_layout_schema"===a?g:y;if(!x)return;ag({environment:t,module:d,collectionStore:r,layoutStore:i,formQuestionStore:p,collectionContextStore:l,position:x,sessionId:n,autofocusTitle:u?{shouldAutofocus:!0,autofocusedQuestionTextStore:s}:void 0,duplicateModuleMapping:m,questionModulePropertyUpdateMap:S,propertyIdMapping:f,transaction:e})}const u=m.get(o.id);u&&d({type:"existing_module",moduleId:u,isDragging:!1})}})}({environment:c,module:v.module,sessionId:p,collectionStore:S,layoutStore:u,collectionContextStore:t,autofocusedQuestionTextStore:y,area:v.area,spaceId:h,setModuleSelection:m}))}),[y,t,S,v.area,v.module,x,c,d,u,p,h,m]);return a&&(0,de().vB)(a)&&h?(0,k.jsx)(kt().A,{icon:Wp().V,title:(0,k.jsx)(f().sA,{id:"formQuestionEditSettings.duplicateQuestion.title",defaultMessage:"Duplicate question"}),onClick:C}):null}function Eg(e){let{collectionContextStore:t,formQuestionStore:o}=e;const n=(0,r().v3)(),{collectionStore:i,formBlockStore:s}=(0,l().K8)((()=>{var e;return{collectionViewStore:t.collectionViewStore(),collectionStore:t.collectionStore(),formBlockStore:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormBlockStore()}}),[t]);return void 0!==(0,l().K8)((()=>{if(!i)return"generic_error";const e=i.getSchema();return e&&o?o.getQuestionErrorState(n,e,null==s?void 0:s.hasSitePublicPermission()):"generic_error"}),[i,n,s,o])}const Rg={type:"newView"},Dg=(0,f().YK)({link:{defaultMessage:"Link...",id:"database.viewSettings.searchCollections.link"},search:{defaultMessage:"Search...",id:"database.viewSettings.searchCollections.search"}});function Kg(e){let{existingCollectionStore:t,onSelectCollection:o}=e;const i=(0,r().v3)(),[s,a]=(0,n.useState)(""),d=(0,ji().ET)(),[u,p]=(0,l().K8)((()=>[d.settingsStore,d.settingsStore.state.hideSettingsHeader]),[d]),g=(0,l().K8)((()=>{const e=d.collectionViewBlockStore();if(!e)throw new Error("collectionViewBlockStore is required");return e}),[d]),m=(0,l().uB)(void 0,sl().A),S=(0,n.useCallback)((e=>{o?o(e):au({collectionContextStore:d,environment:i,collectionStore:e,collectionSettingsStore:u,createdCollectionStore:t,userAction:"LinkToDatabaseMenu.handleAcceptExistingSource"})}),[d,u,t,i,o]),{suggestedSection:h,resultsSection:x,fetchMoreResults:v,searchSessionId:C,searchSessionFlowNumber:b}=Us({input:s,collectionContextStore:d,hideSearchTitle:p,parentStore:g,context:Qs.Source,handleAcceptExistingCollection:S,suggestionConfig:Rg}),w=Ts(d),j=(0,n.useRef)(0);(0,n.useEffect)((()=>{j.current=b}),[b]);const A=(0,l().K8)((()=>"on"===c().default.getEligibleGroup({experimentId:"search_surfaces_collection_search",defaultGroup:"unassigned"})),[]);(0,n.useEffect)((()=>((0,be().u)({environment:i,event:{eventName:"source_collection_search_open",eventProperties:{search_session_id:C,using_secondary_search_surfaces_hook:A,source:"source"}}}),()=>{(0,be().u)({environment:i,event:{eventName:"source_collection_search_close",eventProperties:{search_session_id:C,source:"source",using_secondary_search_surfaces_hook:A,search_session_flow_number:j.current}}})})),[i,A,C]);const _=(0,l().K8)((()=>null!=d&&d.isInHomeWidgetStore.state?Dg.search:Dg.link),[d]);return(0,k.jsxs)(y().Ay,{collectionSettingsStore:u,title:(0,k.jsx)(f().sA,{defaultMessage:"Link to existing database",id:"database.viewSettings.createViewTab.linkToExistingDatabase"}),children:[(0,k.jsx)(ae().A,{shouldShowBottomDivider:!1,children:(0,k.jsx)(Be().Ay,{value:s,onChange:e=>{a(e.target.value),m.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},focusInitial:!0,placeholder:jt().A.formatMessage(_),showClearButton:!0})}),(0,k.jsx)(_e().Ay,{type:_e().Oh.Vertical,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:[h,x,w].filter(In().O9)}),A?(0,k.jsx)(Ss().A,{onChange:(e,t)=>{v&&e<fs().A.incrementScrollOffset&&v()}}):null]})}function Og(e){var t;const{collectionSettingsStore:o,collectionContextStore:s}=e,a=(0,r().v3)(),[c,p]=(0,n.useState)(),g=(0,l().K8)((()=>(0,ui().S)(o)),[o]),m=(0,l().K8)((()=>s.getViewType()),[s]),S=(0,l().K8)((()=>s.allowScrollingWhenCollectionSettingsSidebarOpen()),[s]),f=(0,l().K8)((()=>o.state.closeOnEscape),[o]);(0,ne().A)({capture:!S,preventType:di().A.Y});const y=(0,l().K8)((()=>{if("property"===(null==g?void 0:g.type))return(0,Lt().Jq)({collectionContextStore:s,property:g.property})}),[s,g]);(0,n.useEffect)((()=>{var e,t,o,n,i,r,l;g&&c!==g&&("propertyType"===g.type?d(a,{view_type:m,menu:g.type,is_database_name_empty:!Boolean(null==s||null===(e=s.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()),collection_id:null===(t=s.collectionStore())||void 0===t?void 0:t.id,collection_view_id:null===(o=s.collectionViewStore())||void 0===o?void 0:o.id,collection_view_block_id:null===(n=s.collectionViewBlockStore())||void 0===n?void 0:n.id,database_visit_id:s.visitSessionId,..."button"===(null==y?void 0:y.type)&&{builder_type:"modal"}}):d(a,{view_type:m,menu:g.type,collection_id:null===(i=s.collectionStore())||void 0===i?void 0:i.id,collection_view_id:null===(r=s.collectionViewStore())||void 0===r?void 0:r.id,collection_view_block_id:null===(l=s.collectionViewBlockStore())||void 0===l?void 0:l.id,database_visit_id:s.visitSessionId,builder_type:"modal"}));p(g)}),[s,g,a,c,null==y?void 0:y.type,m]);const h=(0,n.useCallback)((e=>{!1!==f&&(0,i().SQ)({event:e,context:i().y$.Click,callback:()=>{u().os({collectionSettingsStore:o})}})}),[f,o]),x=function(e){return{main:t=>(0,k.jsx)(Lg,{tab:t,...e}),source:()=>(0,k.jsx)(rd,{...e}),createViewSource:t=>(0,k.jsx)(Mm,{tab:t,...e}),addNewDatabase:t=>(0,k.jsx)(Im,{tab:t,...e}),createSyncedViewSource:t=>(0,k.jsx)(Ng,{tab:t,...e}),selectAccountForExternalSource:t=>(0,k.jsx)(Ug,{tab:t,...e}),shareSyncedView:t=>(0,k.jsx)(Wg,{tab:t,...e}),propertyType:t=>(0,k.jsx)(Hg,{tab:t,...e}),propertyAiAutofill:t=>(0,k.jsx)($g,{tab:t,...e}),createView:()=>(0,k.jsx)(tu,{...e}),duplicateExistingView:()=>(0,k.jsx)(dl,{...e}),properties:t=>(0,k.jsx)(Gg,{tab:t,...e}),propertyVisibility:t=>(0,k.jsx)(Qg,{tab:t,...e}),property:t=>(0,k.jsx)(Zg,{tab:t,...e}),deletedProperties:t=>(0,k.jsx)(qg,{tab:t,...e}),selectRelationSource:t=>(0,k.jsx)(Yg,{tab:t,...e}),setupRelation:t=>(0,k.jsx)(Jg,{tab:t,...e}),selectViewsModuleSource:t=>(0,k.jsx)(Xg,{tab:t,...e}),setupViewsModule:t=>(0,k.jsx)(em,{tab:t,...e}),layout:()=>(0,k.jsx)(Mc,{...e}),group:t=>(0,k.jsx)(tm,{tab:t,...e}),groupByProperty:t=>(0,k.jsx)(om,{tab:t,...e}),subitem:t=>(0,k.jsx)(im,{tab:t,...e}),arrowsBy:t=>(0,k.jsx)(lm,{tab:t,...e}),githubConfig:t=>(0,k.jsx)(cm,{tab:t,...e}),filters:()=>(0,k.jsx)(oc,{...e}),phoneFilterAndSort:()=>(0,k.jsx)(kc,{...e}),groupByNumber:t=>(0,k.jsx)(nm,{tab:t,...e}),filter:t=>(0,k.jsx)(dm,{tab:t,...e}),createFilter:()=>(0,k.jsx)(Ia,{...e}),createSort:()=>(0,k.jsx)(Ba,{...e}),sort:()=>(0,k.jsx)(Nc,{...e}),follow:()=>(0,k.jsx)(Sc,{...e}),page:()=>(0,k.jsx)(zg,{...e}),editProperties:t=>(0,k.jsx)(um,{tab:t,...e}),automationSettings:t=>(0,k.jsx)(pm,{tab:t,...e}),mobileCreateAutomation:t=>(0,k.jsx)(Sm,{tab:t,...e}),mobileEditAutomation:t=>(0,k.jsx)(fm,{tab:t,...e}),mobileEditButtonAutomation:t=>(0,k.jsx)(ym,{tab:t,...e}),externalProjectsSyncSettings:t=>(0,k.jsx)(gm,{tab:t,...e}),connectedRelationDatabaseActions:t=>(0,k.jsx)(mm,{tab:t,...e}),dependencies:t=>(0,k.jsx)(sm,{tab:t,...e}),relationFeaturesAdvancedSettings:t=>(0,k.jsx)(am,{tab:t,...e}),subitemV2:t=>(0,k.jsx)(rm,{tab:t,...e}),sprintSettings:t=>(0,k.jsx)(hm,{tab:t,...e}),customize:t=>(0,k.jsx)(bm,{tab:t,...e}),confirmAddTemplate:t=>(0,k.jsx)(wm,{tab:t,...e}),views:t=>(0,k.jsx)(jm,{tab:t,...e}),linked_collections:t=>(0,k.jsx)(Am,{tab:t,...e}),connectionFeatures:t=>(0,k.jsx)(_m,{tab:t,...e}),formQuestionEditSettings:t=>(0,k.jsx)(xm,{tab:t,...e}),formQuestionCreateSettings:t=>(0,k.jsx)(vm,{tab:t,...e}),formCustomizeSettings:t=>(0,k.jsx)(Cm,{tab:t,...e}),linkToDatabase:t=>(0,k.jsx)(km,{tab:t,...e}),databaseSettings:t=>(0,k.jsx)(Tm,{tab:t,...e}),databaseProperties:t=>(0,k.jsx)(Pm,{tab:t,...e}),conditionalColors:()=>(0,k.jsx)(U,{...e}),createConditionalColor:()=>(0,k.jsx)(H,{...e})}}(e),v=g?null===(t=x[g.type])||void 0===t?void 0:t.call(x,g):null;return v?(0,k.jsx)(G().A,{debugName:"CollectionSettings",capture:!0,onEsc:h,children:v}):null}function Lg(e){const{collectionContextStore:t,tab:o}=e,n=(0,l().K8)((()=>{var e;return null===(e=t.collectionViewStore())||void 0===e?void 0:e.id}),[t]),i=(0,l().K8)((()=>t.collectionViewStore()),[t]);return"main"===o.type&&i?(0,k.jsx)(Fr().gt,{selectViewNameInitial:o.selectViewNameInitial,collectionViewStore:i,...e},n):null}function zg(e){const{collectionContextStore:t}=e,o=(0,r().v3)(),n=(0,l().K8)((()=>t.collectionViewStore()),[t]);return n?(0,k.jsx)(y().Ay,{...e,title:"Select page to display",children:(0,k.jsx)("div",{style:{margin:12},children:(0,k.jsx)($().A,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{pi().A.setState({pageId:e.target.value})},onSubmit:()=>{const e=pi().A.state.pageId;if(!e)return null;g().createAndCommit({userAction:"collectionSettings.pageView.selectPage",environment:o,canUndo:!0,perform:t=>{p().zA({stores:[n],update:{page_pointer:{id:(0,s().G2)(e),spaceId:t.spaceId,table:"block"}},transaction:t})}})}})})}):null}function Ng(e){const{tab:t}=e;return"createSyncedViewSource"!==t.type?null:(0,k.jsx)(Sr().a,{...e,...t})}function Ug(e){const{tab:t}=e;return"selectAccountForExternalSource"!==t.type?null:(0,k.jsx)(pr,{...e,...t})}function Wg(e){const{tab:t}=e;return"shareSyncedView"!==t.type?null:(0,k.jsx)(ba,{...e,...t})}function Hg(e){const{tab:t}=e;return"propertyType"!==t.type?null:(0,k.jsx)(ms,{...e,...t})}function $g(e){const{tab:t}=e;return"propertyAiAutofill"!==t.type?null:(0,k.jsx)(ls,{...e,...t})}function Gg(e){const{tab:t}=e;return"properties"!==t.type?null:(0,k.jsx)(Tc().A,{...e,propertiesMenuType:"editPropertiesAndVisibility",timelineViewTab:t.timelineViewTab})}function Qg(e){const{tab:t}=e;return"propertyVisibility"!==t.type?null:(0,k.jsx)(Tc().A,{...e,propertiesMenuType:"propertyVisibilityOnly",timelineViewTab:t.timelineViewTab})}function Zg(e){const{tab:t}=e;return"property"!==t.type?null:(0,k.jsx)(ml().t_,{...e,...t,titleOverride:e.collectionSettingsPropertyTitleOverride},t.property)}function qg(e){const{tab:t}=e;return"deletedProperties"!==t.type?null:(0,k.jsx)(Yr,{...t,...e})}function Yg(e){const{tab:t}=e;return"selectRelationSource"!==t.type?null:(0,k.jsx)(Js,{...e,...t})}function Jg(e){const{tab:t}=e;return"setupRelation"!==t.type?null:(0,k.jsx)(aa,{...e,...t})}function Xg(e){const{tab:t}=e;return"selectViewsModuleSource"!==t.type?null:(0,k.jsx)(Xs,{...e,...t})}function em(e){const{tab:t}=e;return"setupViewsModule"!==t.type?null:(0,k.jsx)(ma,{...e,...t})}function tm(e){const{tab:t}=e;return"group"!==t.type?null:(0,k.jsx)(fc().oz,{...e,...t})}function om(e){const{tab:t}=e;return"groupByProperty"!==t.type?null:(0,k.jsx)(Ac,{...e,...t})}function nm(e){const{tab:t}=e;return"groupByNumber"!==t.type?null:(0,k.jsx)(bc,{...e,...t})}function im(e){const{tab:t}=e;return"subitem"!==t.type?null:(0,k.jsx)(Lc,{...e,...t,formatSetting:"subitem"})}function rm(e){const{tab:t}=e;return"subitemV2"!==t.type?null:(0,k.jsx)(Wi,{...e,feature:"subitem",from:t.from})}function lm(e){const{tab:t}=e;return"arrowsBy"!==t.type?null:(0,k.jsx)(Lc,{...e,...t,formatSetting:"timeline_arrows_by"})}function sm(e){const{tab:t}=e;return"dependencies"!==t.type?null:(0,k.jsx)(Wi,{...e,feature:"timeline_arrows_by",from:t.from})}function am(e){const{tab:t}=e;return"relationFeaturesAdvancedSettings"!==t.type?null:(0,k.jsx)(cr,{...e,feature:t.feature})}function cm(e){const{tab:t}=e;return"githubConfig"!==t.type?null:(0,k.jsx)(gl().A,{...e,property:t.property})}function dm(e){const{tab:t}=e;return"filter"!==t.type?null:(0,k.jsx)(Ra,{...e})}function um(e){const{tab:t}=e;return"editProperties"!==t.type?null:(0,k.jsx)(Tc().A,{...e,propertiesMenuType:"editPropertiesOnly",timelineViewTab:t.timelineViewTab})}function pm(e){const{tab:t}=e;return"automationSettings"!==t.type?null:(0,k.jsx)(q,{...e,tabSettings:t})}function gm(e){const{tab:t}=e;return"externalProjectsSyncSettings"!==t.type?null:(0,k.jsx)(an,{...e,tabSettings:t})}function mm(e){const{tab:t}=e;return"connectedRelationDatabaseActions"!==t.type?null:(0,k.jsx)(Et,{...e,tabSettings:t})}function Sm(e){const{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"mobileCreateAutomation"!==t.type?null:(0,k.jsx)(m().u,{collectionSettingsStore:n,collectionContextStore:o,mode:"create",from:t.from,source:t.source})}function fm(e){const{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;if("mobileEditAutomation"!==t.type)return null;const{automationId:i}=t;return(0,k.jsx)(m().u,{collectionSettingsStore:n,collectionContextStore:o,mode:"update",source:t.source,automationId:i})}function ym(e){const{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"mobileEditButtonAutomation"!==t.type?null:(0,k.jsx)(m().N,{collectionSettingsStore:n,collectionContextStore:o,propertyId:t.propertyId,propertySchema:t.propertySchema})}function hm(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"sprintSettings"!==t.type?null:(0,k.jsx)(Gn,{collectionContextStore:o,collectionSettingsStore:n,from:t.from})}function xm(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"formQuestionEditSettings"!==t.type?null:(0,k.jsx)(fg,{collectionContextStore:o,collectionSettingsStore:n,formQuestionId:t.formQuestionId,moduleId:t.moduleId})}function vm(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"formQuestionCreateSettings"!==t.type?null:(0,k.jsx)(Pp,{collectionContextStore:o,collectionSettingsStore:n,moduleId:t.moduleId,area:t.area,parentModuleId:t.parentModuleId,parentConditionalGroupId:t.parentConditionalGroupId})}function Cm(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"formCustomizeSettings"!==t.type?null:(0,k.jsx)(Ku,{collectionContextStore:o,collectionSettingsStore:n})}function bm(e){const{tab:t,collectionContextStore:o}=e,n=(0,r().v3)();(0,Si().b)(o);const i=(0,l().K8)((()=>{const e=o.collectionStore();return(0,mi().tY)({environment:n,collectionStore:e})}),[n,o]),s=(0,l().K8)((()=>i&&c().default.checkGate({gateName:"workflow_templates_prototype"})),[i]);return"customize"!==t.type?null:i&&s?(0,k.jsx)(ee,{collectionTemplate:i}):(0,k.jsx)(J,{...e})}function wm(e){let{tab:t,collectionSettingsStore:o}=e;return"confirmAddTemplate"!==t.type?null:(0,k.jsx)(gi().W3,{template:t.template,collectionSettingsStore:o})}function jm(e){let{tab:t,collectionSettingsStore:o,collectionContextStore:n}=e;return"views"!==t.type?null:(0,k.jsx)(gi().vK,{collectionSettingsStore:o,collectionContextStore:n})}function Am(e){let{tab:t}=e;return"linked_collections"!==t.type?null:(0,k.jsx)(gi().P6,{})}function _m(e){const{tab:t}=e;return"connectionFeatures"!==t.type?null:(0,k.jsx)(oe,{...e})}function Im(e){return"addNewDatabase"!==e.tab.type?null:(0,k.jsx)(Yd,{...e})}function Mm(e){const{tab:t}=e;return"createViewSource"!==t.type?null:(0,k.jsx)(mu,{existingCollectionStore:t.existingCollectionStore,createdCollectionRecordPointerMap:t.createdCollectionRecordPointerMap,onSelectCollection:t.onSelectCollection,...e})}function km(e){const{tab:t}=e;return"linkToDatabase"!==t.type?null:(0,k.jsx)(Kg,{existingCollectionStore:t.existingCollectionStore,onSelectCollection:t.onSelectCollection,...e})}function Tm(e){const{tab:t}=e;return"databaseSettings"!==t.type?null:(0,k.jsx)(Rr,{...e})}function Pm(e){const{tab:t}=e;return"databaseProperties"!==t.type?null:(0,k.jsx)(br,{...e})}},582094:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,personCropCircleBadgePlusIcon:()=>r});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"0.5 2.37 17.12 17.13",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 5.992 7.45q.197-.587.228-1.23a6.4 6.4 0 0 0 4.454-.62c-.547-1.049-1.697-1.789-3.05-1.789a3.55 3.55 0 0 0-1.739.45q-.241-.587-.626-1.081A4.8 4.8 0 0 1 10 12.561c1.754 0 3.298.934 4.087 2.332A6.375 6.375 0 1 0 3.78 11.406q-.643.032-1.23.227A7.7 7.7 0 0 1 2.375 10"}),(0,n.jsx)("path",{d:"M4 12.5a3.5 3.5 0 0 0-1.137.189A3.502 3.502 0 0 0 4 19.5a3.5 3.5 0 1 0 0-7m-2.594 3.531c0-.345.28-.625.625-.625h1.375v-1.375a.625.625 0 0 1 1.25 0v1.375h1.375a.625.625 0 0 1 0 1.25H4.656v1.375a.625.625 0 1 1-1.25 0v-1.375H2.031a.625.625 0 0 1-.625-.625m6.349-9.862C8.277 5.519 9.05 5.125 10 5.125s1.723.393 2.245 1.044c.51.635.75 1.474.75 2.346s-.24 1.71-.75 2.346c-.522.65-1.294 1.044-2.245 1.044-.95 0-1.723-.394-2.245-1.044-.51-.635-.75-1.474-.75-2.346s.24-1.711.75-2.346m.975.782c-.293.365-.475.909-.475 1.564s.182 1.198.475 1.564c.281.35.694.576 1.27.576s.989-.226 1.27-.576c.294-.366.475-.909.475-1.564s-.181-1.199-.475-1.564c-.281-.35-.693-.576-1.27-.576-.576 0-.989.225-1.27.576"})]})},r=(0,o(340498).wt)("personCropCircleBadgePlus",i)},589982:(e,t,o)=>{o.d(t,{u:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("basicClock",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M4.541 7.919a.53.53 0 01-.39-.157.53.53 0 01-.157-.39c0-.155.053-.282.157-.383a.53.53 0 01.39-.157h2.905V2.895c0-.15.053-.278.158-.383a.521.521 0 01.382-.158.53.53 0 01.39.158.521.521 0 01.157.383v4.477a.53.53 0 01-.157.39.53.53 0 01-.39.157H4.541zm3.452 6.207a6.789 6.789 0 01-2.727-.554 7.124 7.124 0 01-2.256-1.524 7.277 7.277 0 01-1.525-2.256 6.788 6.788 0 01-.553-2.728c0-.966.184-1.875.553-2.727A7.241 7.241 0 015.258.557 6.788 6.788 0 017.987.003c.971 0 1.882.184 2.735.554.852.369 1.604.88 2.256 1.53a7.136 7.136 0 011.53 2.25c.37.852.555 1.761.555 2.727 0 .967-.185 1.876-.554 2.728a7.218 7.218 0 01-3.787 3.78 6.789 6.789 0 01-2.728.554zm0-1.395c.789 0 1.525-.145 2.208-.437a5.678 5.678 0 001.805-1.217 5.68 5.68 0 001.217-1.805c.291-.683.437-1.42.437-2.208a5.55 5.55 0 00-.437-2.2 5.66 5.66 0 00-3.029-3.029 5.567 5.567 0 00-2.208-.438c-.784 0-1.52.146-2.208.438A5.6 5.6 0 003.98 3.052a5.715 5.715 0 00-1.21 1.811 5.55 5.55 0 00-.437 2.201c0 .789.146 1.525.438 2.208a5.735 5.735 0 001.21 1.805 5.598 5.598 0 004.013 1.654z"})})},613601:(e,t,o)=>{o.r(t),o.d(t,{arrowUTurnUpLeftSmallIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"1.57 2.85 12.86 9.98",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M6.162 3.038a.625.625 0 0 0-.884 0l-3.52 3.52a.625.625 0 0 0 0 .884l3.52 3.52a.625.625 0 1 0 .884-.884L3.71 7.625h7.49a1.975 1.975 0 0 1 0 3.95h-1.136a.625.625 0 0 0 0 1.25H11.2a3.225 3.225 0 1 0 0-6.45H3.71l2.453-2.453a.625.625 0 0 0 0-.884"})},i=(0,o(340498).wt)("arrowUTurnUpLeftSmall",n)},614525:(e,t,o)=>{o.d(t,{A:()=>s});o(296540);var n=()=>o(959013),i=()=>o(436696),r=()=>o(686526),l=o(474848);const s=function(e){let{collectionContextStore:t}=e;const s=(0,o(484714).v3)(),{viewName:a,viewType:c,isViewsModule:d}=(0,o(56366).K8)((()=>{var e,o;return{viewType:null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType(),viewName:null===(o=t.collectionViewStore())||void 0===o?void 0:o.getName(),isViewsModule:Boolean(t.viewsModuleContextStore.state)}}),[t]),u=(0,o(963589).X)("db_ux_chrome");if(!c||d)return null;let p=(0,l.jsx)(n().sA,{defaultMessage:"Copy link to view",id:"database.viewSettings.mainTab.copyLinkButton.title"});return"chart"===c?p=(0,l.jsx)(n().sA,{defaultMessage:"Copy link to chart",id:"database.viewSettings.mainTab.copyLinkButton.title.chart"}):a&&!u&&(p=(0,l.jsx)(n().sA,{defaultMessage:"Copy link to {viewName}",id:"database.viewSettings.mainTab.copyLinkButton.title.viewName",values:{viewName:a}})),(0,l.jsx)(o(497222).A,{icon:o(742852).w,title:p,onClick:()=>function(e,t){const o=t.collectionViewStore();o&&(r().GH({environment:e,collectionContextStore:t,collectionViewStore:o}),(0,i().X)({environment:e,collectionContextStore:t,action:"click_copy_link",original_view_type:o.getType()}))}(s,t)})}},626318:(e,t,o)=>{o.d(t,{Bj:()=>x,ZX:()=>h});o(16280);var n=()=>o(278238),i=()=>o(206267),r=()=>o(454984),l=()=>o(688728),s=()=>o(475140),a=()=>o(179034),c=()=>o(869558),d=()=>o(183558),u=()=>o(246826),p=()=>o(751156),g=()=>o(594794),m=()=>o(972435),S=()=>o(630116),f=()=>o(978846),y=()=>o(38e3);function h(e){var t,o;const{environment:n,layoutStore:a,relationPropertyId:c,targetCollectionPointer:u,viewName:g,viewIcon:m}=e,h=null===(t=a.getModel())||void 0===t?void 0:t.firstRawModuleOfType("editor"),v=null===(o=a.getModel())||void 0===o?void 0:o.firstRawModuleOfType("viewsMain");if(!h&&!v)throw new Error("Invalid state: no editor or viewsMain module");const{performResult:C}=p().createAndCommit({environment:n,canUndo:!0,perform:e=>{const{inMemoryRecordCache:t}=a;let o,C=v;if(C){var b;if("viewsMain"!==(null===(b=C)||void 0===b?void 0:b.type))throw new Error("Invalid state: editor or viewsMain module is not of the expected type");o=S().Bv.createChildStore(a,C.collection_view_block_pointer)}else{const t=(0,d().Ay)(),{collectionViewBlockStore:c}=(0,y().$)({environment:n,layoutStore:a,transaction:e});o=c,C={id:t,type:"viewsMain",collection_view_block_pointer:{...o.pointer,spaceId:o.getSpaceId()}};const u=(0,s().JO)(a.getModules(),(e=>"editor"===e.type));if(!u||!h||"form_conditional_modules"===u.area)throw new Error("Invalid state: no editor module");if("views_main_tab_modules"===u.area)throw new Error("Cannot add views main module when editor is already in views main module");p().applyOperation({store:a,transaction:e,operation:r().N4.deleteModuleInArea({pointer:a.pointer,area:l().Zm[u.area],moduleId:h.id})}),(0,f().UQ)({position:{type:"absolute",area:u.area,index:u.index},module:C,layoutStore:a,transaction:e,environment:n,sessionId:(0,i().JW)(),isPropertyCreation:!1})}if(!C)throw new Error("Invalid state: no views main module");const w=x({environment:n,transaction:e,targetCollectionPointer:u,collectionViewBlockStore:o,viewName:g,viewIcon:m,relationPropertyId:c,inMemoryRecordCache:t});return{viewsMainModule:C,collectionViewBlockPointer:o.pointer,collectionViewPointer:w}},userAction:"viewsModuleActions.addViewToViewsMainModule"});if(!C)throw new Error("Transaction to add collection view to views main module failed");return{viewsMainModule:C.viewsMainModule,collectionViewPointer:C.collectionViewPointer,collectionViewBlockPointer:C.collectionViewBlockPointer}}function x(e){let{environment:t,transaction:o,targetCollectionPointer:r,collectionViewBlockStore:l,viewName:s,viewIcon:d,relationPropertyId:f,inMemoryRecordCache:y}=e;const h=(0,g().JH)({environment:t,table:c().Gy,spaceId:l.getSpaceId()}).id;let x=d;if(!x&&r){const e=S().sk.createChildStore(l,r).getIcon();null!=e&&e.icon&&(0,n().T8)(e.icon)&&(x=e.icon)}const C={id:h,type:"table",parent_id:l.pointer.id,parent_table:a().ev,space_id:l.getSpaceId(),alive:!0,name:s??m().A.formatMessage(v.view),format:{hide_linked_collection_name:!0,collection_pointer:r,collection_view_icon:x,...f?{property_filters:[{id:i().JW(),filter:{property:f,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"current_page_in_related_collection"}}}}}]}:{},subitem_display_mode:f?"disabled":void 0}};return p().applyOperation({store:l,operation:{pointer:l.pointer,path:["view_ids"],command:"listAfter",args:{id:h}},transaction:o}),u().eC({environment:t,table:c().Gy,value:C,inMemoryRecordCache:y,transaction:o}),{id:h,table:c().Gy,spaceId:l.getSpaceId()}}const v=(0,o(959013).YK)({view:{defaultMessage:"View",id:"pageLayout.viewsModuleActions.defaultViewName"}})},633904:(e,t,o)=>{o.d(t,{l:()=>h,t:()=>x});o(16280);var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(912720),s=()=>o(534177),a=()=>o(751156),c=(o(898992),o(737550),()=>o(199378)),d=()=>o(496603),u=()=>o(630116);function p(e,t){var o,n;const i=null==e?void 0:e.getModel(),r=null==t?void 0:t.getModel();if(!t||!r)return!0;if(i&&(null===(o=i.getProperties())||void 0===o?void 0:o.name)!==(null===(n=r.getProperties())||void 0===n?void 0:n.name))return!0;return!(!i||i.getStatus()===r.getStatus())||(!!function(e,t){const o=null==e?void 0:e.getModel(),n=t.getModel();if(!n)return!0;if((0,s().O9)(o)){if(o.isEventType()&&n.isEventType()){const e=o.getEventConfiguration(),t=n.getEventConfiguration();return!(0,d().n4)(e,t)}if(o.isRecurrenceType()&&n.isRecurrenceType()){const e=o.getRecurrence(),t=n.getRecurrence();return!(0,d().n4)(e,t)}return!o.isButtonType()||!n.isButtonType()}if(n.isEventType()){const e=n.getEventConfiguration();return!1!==e.pagesAdded||"none"!==e.pagePropertiesEdited.type}if(n.isRecurrenceType())return!0;if(n.isButtonType())return!1;(0,s().HB)(n)}(e,t)||!!function(e,t){const o=t.getSpaceId();if(!o)return!1;if((0,s().O9)(e)){const n=e.getActionIds(),i=t.getActionIds();return n.length!==i.length||!(0,d().n4)(n,i)||n.some((n=>{const i={id:n,spaceId:o,table:c().SC},r=u().bx.createChildStore(e,i).getModel(),l=u().bx.createChildStore(t,i).getModel();return!(0,s().O9)(r)||!(0,s().O9)(l)||!(0,d().n4)(r.getConfig(),l.getConfig())}))}return t.getActionIds().length>0}(e,t))}var g=()=>o(186445),m=()=>o(841696),S=()=>o(246125),f=()=>o(6731),y=()=>o(765957);function h(e){const t=new(m().Z)({deadlockTimeoutMs:a().DEADLOCK_WARNING_TIMEOUT_MS});return{performResult:e.perform(t),serverCommitResult:Promise.resolve(void 0),transactionId:t.id}}function x(e){const{automationId:t,spaceId:o,defaultValue:c,persist:d}=e,m=(0,i().v3)(),h=(0,r().K8)((()=>{var e;return null===(e=y().default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),x=(0,n.useMemo)((()=>{if(t&&o)return{id:t,table:l().yB,spaceId:o}}),[t,o]),v=(0,S().l)("useUnpersistedAutomationStore",{cacheFallback:m.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),C=(0,n.useMemo)((()=>{if(!x)return;const e=v.getEntry({pointer:x,userId:h});if(!(0,s().O9)(e)&&h){if(!c)throw new Error("create is true but no defaultValue provided");v.setRecord({pointer:x,userId:h},{role:"editor",value:c})}return new(u().dn)(m,x,{inMemoryRecordCache:v})}),[c,m,x,v,h]),b=(0,r().K8)((()=>{const e=g().ao();if(x&&e)return u().dn.createChildStore(e,x)}),[x]),w=d?b:C,j=(0,r().K8)((()=>!d&&p(b,C)),[d,b,C]),{createAndCommit:A}=(0,f().D)({unpersistedInMemoryRecordCache:v}),_=(0,n.useCallback)((e=>d?a().createAndCommit({...e,canUndo:!0,environment:m}):A(e)),[A,m,d]);return{maybePersistedTransactionActions:{createAndCommit:_},maybePersistedAutomationStore:w,hasUnpersistedChanges:j}}},637558:(e,t,o)=>{o.d(t,{v:()=>l});var n=o(296540),i=()=>o(963589),r=o(474848);const l=n.memo((function(e){let{currentSorts:t,schema:n}=e;const{isMobile:l}=(0,o(484714).Y0)(),s=t.length,a=(0,i().X)("db_ux_chrome"),c=(0,i().X)("db_ux_mobile");if(0===s)return null;const d=t[0].property;return(a||c&&!l)&&1===s&&null!=n&&n[d]?(0,r.jsx)(o(398217).mA,{propertySchema:n[d],showIcon:!1}):(0,r.jsx)("span",{children:s})}))},638045:(e,t,o)=>{o.d(t,{t:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"5.83 0.79 8.33 18.41",svg:(0,o(474848).jsx)("path",{d:"M13.977 5.393a.625.625 0 0 1-.883 0l-2.47-2.469v5.662a.625.625 0 1 1-1.25 0V2.924L6.907 5.393a.625.625 0 0 1-.884-.884L9.558.974a.625.625 0 0 1 .884 0l3.535 3.535a.625.625 0 0 1 0 .884m-3.352 6.026a.625.625 0 1 0-1.25 0v5.648l-2.469-2.469a.625.625 0 1 0-.884.884l3.536 3.535c.244.245.64.245.884 0l3.535-3.535a.625.625 0 0 0-.883-.884l-2.47 2.469z"})},i=(0,o(340498).wt)("arrowUpDownStacked",n)},646668:(e,t,o)=>{o.d(t,{Rh:()=>S,d7:()=>d,nr:()=>p,rr:()=>g,uo:()=>m,v:()=>u});var n=()=>o(636090),i=()=>o(178492),r=()=>o(148307),l=()=>o(604995),s=()=>o(416504),a=()=>o(972435);const c=(0,o(959013).YK)({aiSummaryName:{id:"feature.ai_summary.name",defaultMessage:"AI summary"},aiSummaryDescription:{id:"feature.ai_summary.description",defaultMessage:"Summarize pages with AI"},aiAutofillName:{id:"feature.ai_autofill.name",defaultMessage:"Custom AI autofill"},aiAutofillDescription:{id:"feature.ai_autofill.description",defaultMessage:"Autofill properties with AI"},aiTranslationName:{id:"feature.ai_translation.name",defaultMessage:"AI translation"},aiTranslationDescription:{id:"feature.ai_translation.description",defaultMessage:"Translate pages with AI"},aiKeywordsName:{id:"feature.ai_keywords.name",defaultMessage:"AI keywords"},aiKeywordsDescription:{id:"feature.ai_keywords.description",defaultMessage:"Extract keywords with AI"}}),d=[{uri:i().Bn.priorityHmlFeature,name:"Priority",dependencies:[{uri:i().Kg.priorityHmlProperty,type:"property",collectionUri:n().iH,name:"Priority",description:"High, medium, or low",icon:r().A.images.appPackages.featurePrioritySvg,propertySchema:{type:"select",name:"Priority",options:[{id:"priority_low",value:"Low",color:"green"},{id:"priority_medium",value:"Medium",color:"yellow"},{id:"priority_high",value:"High",color:"red"}]}}],collectionUri:n().iH},{uri:i().Bn.progressBarFeature,collectionUri:n().iH,name:"Progress Bar",description:"Visual representation of progress",icon:r().A.images.appPackages.featureStatusSvg,dependencies:[{uri:i().Kg.progressBarCurrentProperty,type:"property",collectionUri:n().iH,name:"Progress Bar Current",propertySchema:{type:"number",name:"Current"}},{uri:i().Kg.progressBarTargetProperty,type:"property",collectionUri:n().iH,name:"Progress Bar Target",propertySchema:{type:"number",name:"Target"}},{uri:i().Kg.progressBarFormulaProperty,type:"property",collectionUri:n().iH,name:"Progress Bar Progress Formula",propertySchema:{type:"formula",name:"Progress bar",formula2:{code:[["‣",[["fpp",{property:i().Kg.progressBarCurrentProperty,collection:{id:n().iH,table:"collection"}}]]],["/"],["‣",[["fpp",{property:i().Kg.progressBarTargetProperty,collection:{id:n().iH,table:"collection"}}]]]],result_type:{type:"number"}},show_as:{type:"bar",color:"green",maxValue:1,showValue:!1},version:"v2"}}]},{uri:i().Bn.ganttChartFeature,collectionUri:n().iH,name:"Gantt Chat",description:"Chart to show progress of a project's tasks over time.",icon:r().A.images.appPackages.featureGanttSvg,dependencies:[{uri:i().Kg.ganttInitiativeProperty,type:"property",collectionUri:n().iH,name:"Initiative",description:"Initiatives associated with a specific project",icon:r().A.images.appPackages.featurePrioritySvg,propertySchema:{type:"select",name:"Initiative",options:[{id:"initiative_a",value:"Initiative A",color:"purple"},{id:"initiative_b",value:"Initiative B",color:"green"},{id:"initiative_c",value:"Initiative C",color:"blue"}]}},{uri:i().Kg.ganttDueDateProperty,type:"property",collectionUri:n().iH,name:"Due Date",description:"When a project is due.",icon:r().A.images.appPackages.featurePrioritySvg,propertySchema:{type:"date",name:"Due Date"}},{uri:i().Kg.ganttTimelineView,type:"collection_view",collectionUri:n().iH,description:"GANTT chart timeline view of projects",value:{type:"timeline",name:"Timeline",format:{collection_view_icon:"/icons/timeline_gray.svg",timeline_show_table:!0,timeline_table_properties:[{width:171,visible:!0,property:"title"},{width:200,visible:!0,property:i().Kg.ganttInitiativeProperty}],timeline_preference:{zoomLevel:"month",centerTimestamp:(0,l().ln)((0,l().Ec)((0,s().P)()),(0,s().P)())},collection_group_by:{sort:{type:"manual"},type:"multi_select",property:i().Kg.ganttInitiativeProperty,hideEmptyGroups:!0}},query2:{timeline_by:i().Kg.ganttDueDateProperty}},collectionViewBlockUri:n().eh}]}],u=[p(),g(),m(),S()];function p(){return{uri:i().Bn.aiSummaryFeature,collectionUri:n().iH,name:a().A.formatMessage(c.aiSummaryName),description:a().A.formatMessage(c.aiSummaryDescription),icon:r().A.images.appPackages.featureAiSummarizeSvg,tooltipImage:{img:r().A.images.tooltips.properties.aiAutofillSummaryPng,scale:.5},isAi:!0,dependencies:[{uri:i().Kg.aiSummaryProperty,type:"property",collectionUri:n().iH,name:a().A.formatMessage(c.aiSummaryName),propertySchema:{type:"text",name:a().A.formatMessage(c.aiSummaryName),ai_inference:{type:"summarize",auto_update_on_edit:!0}}}]}}function g(){return{uri:i().Bn.aiCustomAutofillFeature,collectionUri:n().iH,name:a().A.formatMessage(c.aiAutofillName),description:a().A.formatMessage(c.aiAutofillDescription),icon:"",tooltipImage:{img:r().A.images.tooltips.properties.aiCustomAutofillPng,scale:.5},isAi:!0,dependencies:[{uri:i().Kg.aiCustomAutofillProperty,type:"property",collectionUri:n().iH,name:a().A.formatMessage(c.aiAutofillName),propertySchema:{name:a().A.formatMessage(c.aiAutofillName),type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:!0}}}]}}function m(){return{uri:i().Bn.aiTranslationFeature,collectionUri:n().iH,name:a().A.formatMessage(c.aiTranslationName),description:a().A.formatMessage(c.aiTranslationDescription),icon:"",tooltipImage:{img:r().A.images.tooltips.properties.aiTranslationPng,scale:.5},isAi:!0,dependencies:[{uri:i().Kg.aiTranslationProperty,type:"property",collectionUri:n().iH,name:a().A.formatMessage(c.aiTranslationName),propertySchema:{name:a().A.formatMessage(c.aiTranslationName),type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:!0}}}]}}function S(){return{uri:i().Bn.aiKeywordsFeature,collectionUri:n().iH,name:a().A.formatMessage(c.aiKeywordsName),description:a().A.formatMessage(c.aiKeywordsDescription),icon:"",tooltipImage:{img:r().A.images.tooltips.properties.aiKeywordsPng,scale:.5},isAi:!0,dependencies:[{uri:i().Kg.aiKeywordsProperty,type:"property",collectionUri:n().iH,name:a().A.formatMessage(c.aiKeywordsName),propertySchema:{type:"multi_select",name:a().A.formatMessage(c.aiKeywordsName),select_ai_inference:{type:"multi_select",add_options:!0,auto_update_on_edit:!1}}}]}}},652380:(e,t,o)=>{o.d(t,{G:()=>C,M:()=>b});o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(401497),l=()=>o(959013),s=()=>o(381349),a=()=>o(496603),c=()=>o(36629),d=()=>o(313892),u=()=>o(878665),p=()=>o(760217),g=()=>o(933117),m=()=>o(553965),S=()=>o(463830),f=()=>o(455338),y=()=>o(822650),h=()=>o(39039),x=()=>o(95347),v=o(474848);function C(e){var t,o;const{collectionContextStore:r,collectionSettingsStore:l,feature:s,itemProps:C}=e,w=(0,n().v3)(),j=(0,x().rD)(r),A=(0,x().hw)(r,l),_=(0,i().K8)((()=>r.databaseType),[r]),I=(0,x().C5)(r),M=(0,h().tx)(s,_),k=(0,h().gZ)(s,I);return(0,v.jsx)(u().A,{showImage:!0,caption:M,description:k,tooltipImage:null===(t=s.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=s.tooltipImage)||void 0===o?void 0:o.scale,render:e=>{if((0,d().lK)(s)||(0,d().u1)(s))return(0,v.jsx)(h().j7,{collectionContextStore:r,buttonMenuItemProps:{...(0,m().A)(C,e)},feature:s,caption:M,onClick:()=>A(s),icon:(0,v.jsx)(y().a,{feature:s}),right:(0,v.jsx)(b,{focused:C.focused})});{const t=new(S().A),o=(0,x().ff)(s,null==j?void 0:j.allFeatures);return(0,v.jsx)(g().A,{buttonPopupStore:t,items:o,getKey:e=>e.name,renderItem:e=>(0,v.jsx)(p().A,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0}),onSelect:async e=>{await c().h3({environment:w,feature:e,collectionContextStore:r,addFeatureFrom:"customize_menu"}),(0,f().t)({featureName:e.name})},selectedItem:void 0,renderOrigin:o=>(0,v.jsx)(h().j7,{collectionContextStore:r,buttonMenuItemProps:{focused:Boolean(C.focused),...(0,m().A)(a().cJ(C,"onClick","focused"),(0,m().A)(e,o))},feature:s,caption:M,onClick:()=>{t.setState({open:!0})},icon:(0,v.jsx)(y().a,{feature:s}),right:(0,v.jsx)(b,{focused:C.focused})})})}}})}function b(e){const{focused:t}=e,o=(0,r().IS)((e=>({addButton:{fontSize:12,fontWeight:500,color:e.blueColor,background:t?s().Ay.diffBackground:e.palette.gray[75],padding:"3px 10px",borderRadius:16}})),[t]);return(0,v.jsx)("div",{style:o.addButton,children:(0,v.jsx)(l().sA,{defaultMessage:"Add",id:"database.viewSettings.customizeMenu.addButton"})})}},659915:(e,t,o)=>{o.d(t,{o:()=>i,s:()=>r});o(898992),o(430670);var n=()=>o(919709);function i(e){return!e.isTransclusionType()&&!e.isCollectionView()&&!e.hasContent()&&e.isEmptyTitle()}function r(e){const t=(0,n().tyK)(e.getTitleValue()),o=e.getContentStores().flatMap((e=>(0,n().tyK)(e.getTitleValue())));return t.length>0||o&&o.length>0}},673900:(e,t,o)=>{o.d(t,{v:()=>c});var n=o.n(o(364387)),i=o(296540),r=()=>o(401497),l=()=>o(496603),s=()=>o(623580),a=o(474848);function c(e){let{value:t,onChange:o,onBlur:c,onKeyDown:d,inputProps:u}=e;const[p,g]=(0,i.useState)(""),m=(0,i.useRef)(""),S=(0,i.useRef)(t);(0,i.useEffect)((()=>{const e=void 0===t?"":t.toString();g(e),m.current=e,S.current=t}),[t]);const f=(0,i.useCallback)((e=>l().sg((e=>{null==o||o(e)}),300)(e)),[o]),y=(0,i.useCallback)((e=>{const t=e.target.value;if(g(t),m.current=t,o){const e=n()(t);f(isNaN(e)?void 0:e)}}),[f,o]),h=(0,i.useCallback)((e=>{const t=n()(e.target.value);null==c||c(isNaN(t)?void 0:t)}),[c]),x=(0,i.useRef)(c),v=(0,i.useCallback)((e=>{if("Enter"===e.key){const e=n()(p);null==d||d(isNaN(e)?void 0:e)}}),[p,d]);(0,i.useEffect)((()=>()=>{var e;if((null===(e=S.current)||void 0===e?void 0:e.toString())!==m.current){var t;const e=n()(m.current);null===(t=x.current)||void 0===t||t.call(x,isNaN(e)?void 0:e)}}),[]);const C=(0,r().IS)((e=>({input:{background:e.contentBackground}})),[]);return(0,a.jsx)(s().A,{type:"number",value:p,inputClassName:"input-hide-arrows",style:C.input,onChange:y,onBlur:c?h:void 0,onKeyDown:d?v:void 0,...u})}},674582:(e,t,o)=>{o.d(t,{m:()=>a});o(296540);var n=()=>o(401497),i=()=>o(377114),r=()=>o(558687),l=()=>o(284371),s=o(474848);function a(e){const{title:t,description:o,integrationIconUrl:a,integrationIcon:c,children:d,styles:u}=e,p=(0,n().IS)((e=>({header:{fontWeight:l().Wy.medium,fontSize:17,textAlign:"center",marginTop:8},iconGroup:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gridColumnGap:9,marginBottom:9},arrowRight:{width:20,height:20,opacity:.4,fontWeight:l().Wy.bold,padding:3},notionLogo:{height:40,width:40,color:e.icon.primary},icon:{height:40,width:40}})),[]);return(0,s.jsxs)("div",{style:null==u?void 0:u.wrapper,children:[(0,s.jsxs)("div",{style:{...p.iconGroup,...null==u?void 0:u.iconGroup},children:[a?(0,s.jsx)("img",{style:{...p.icon,...null==u?void 0:u.icon},src:a,alt:"Integration Icon"}):c,(0,i().arrowLeftRightIcon)(p.arrowRight),(0,r().notionIcon)(p.notionLogo)]}),t&&(0,s.jsx)("div",{style:{...p.header,...null==u?void 0:u.header},children:t}),o&&(0,s.jsx)("div",{style:null==u?void 0:u.description,children:o}),d]})}},704640:(e,t,o)=>{o.d(t,{A:()=>c});o(898992),o(354520);var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(686526),s=()=>o(963589),a=o(474848);const c=function(e){let{collectionContextStore:t,collectionSettingsStore:c,disabled:d}=e;const u=(0,s().X)("db_ux_mobile_filter_sheet"),p=(0,i().v3)(),{isMobile:g}=(0,i().Y0)(),m=(0,r().O$)(t.permissionScopesStore),S=(0,r().K8)((()=>{var e;return null==t||null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),f=(0,r().K8)((()=>(0,o(873050).tG)(t)),[t]),y=(0,r().K8)((()=>t.currentPropertyFiltersStore.state.filter((e=>!(0,o(289915).t_)(e.filter)))),[t]),h=(0,s().X)("db_ux_chrome"),x=(0,n.useMemo)((()=>{if(0!==f){if(h&&1===f&&1===y.length&&S){const e=null==S?void 0:S[y[0].filter.property];if(e)return(0,a.jsx)(o(398217).mA,{propertySchema:e,showIcon:!1})}return f}}),[f,S,y,h]);return(0,a.jsx)(o(497222).A,{disabled:d,icon:o(170350).S,title:(0,a.jsx)(o(959013).sA,{defaultMessage:"Filter",id:"database.viewSettings.mainTab.filterButton.title"}),showChevron:!0,right:x,onClick:()=>{(0,o(436696).X)({environment:p,collectionContextStore:t,action:"click_filters"}),u&&g||function(e,t){return Boolean(e.currentPropertyFiltersStore.state.length>0||e.currentCombinatorFilterStore.state&&t.canConfigureBlock)}(t,m)?l().a2({collectionSettingsStore:c,item:{type:"filters"}}):l().a2({collectionSettingsStore:c,item:{type:"createFilter"}})}})}},739222:(e,t,o)=>{o.d(t,{$M:()=>$,Bm:()=>le,RH:()=>J,Y7:()=>U,YQ:()=>W,YX:()=>N,bz:()=>L,cM:()=>X,iF:()=>re,js:()=>se,nu:()=>ae,ph:()=>pe,tQ:()=>q});o(898992),o(354520),o(672577),o(581454),o(296540);var n=()=>o(484714),i=()=>o(56366),r=()=>o(401497),l=()=>o(66689),s=()=>o(148307),a=()=>o(970013),c=()=>o(617871),d=()=>o(857639),u=()=>o(263178),p=()=>o(959013),g=()=>o(534177),m=()=>o(686526),S=()=>o(36629),f=()=>o(901389),y=()=>o(751156),h=()=>o(679924),x=()=>o(521358),v=()=>o(374562),C=()=>o(878665),b=()=>o(807683),w=()=>o(476492),j=()=>o(23815),A=()=>o(972435),_=()=>o(553965),I=()=>o(685889),M=()=>o(252833),k=()=>o(37433),T=()=>o(765957),P=()=>o(53137),B=()=>o(346705),V=()=>o(455338),F=()=>o(234675),E=()=>o(397089),R=()=>o(39039),D=()=>o(95347),K=()=>o(652380),O=o(474848);function L(e){const t=(0,D().rD)(e),o=pe(),{canHaveSprints:n,canTurnIntoTasks:r}=(0,i().K8)((()=>({canHaveSprints:X(e),canTurnIntoTasks:U(e,t)})),[e,t]);return[...o,...r?[N]:[],...n?[J]:[]]}const z=(0,p().YK)({taskName:{id:"feature.turnIntoTasks.name",defaultMessage:"Tasks"},taskDescription:{id:"feature.turnIntoTasks.description",defaultMessage:"See your tasks in Home, manage tasks in sprints, and more"}}),N={uri:"notion://feature/turn_into_tasks_feature",name:A().A.formatMessage(z.taskName),description:A().A.formatMessage(z.taskDescription),tooltipImage:{img:s().A.images.tooltips.collectionSettings.turnIntoTasksPng,scale:.5},icon:"",collectionUri:F().R,isFeatureAdded:W,getSuggestedFeatureMenuItem:e=>(0,O.jsx)(H,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps}),getAddedFeatureMenuItem:e=>(0,O.jsx)(G,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps})};function U(e,t){var o;const n=(0,k().$H)(),i=null===(o=e.collectionStore())||void 0===o?void 0:o.getDatabaseType(),r=void 0===t||i===l().dC,s=i===l().pW;return n&&r&&!s}function W(e,t){var o;if(e.uri!==N.uri)return!1;return(null===(o=t.collectionStore())||void 0===o?void 0:o.getDatabaseType())===l().dC}function H(e){var t,o;const{collectionContextStore:i,feature:l,itemProps:s}=e,a=(0,n().v3)(),c=(0,D().NE)(),d=(0,r().IS)((e=>({featureIconWrapper:{...c.featureIconWrapper,backgroundColor:e.palette.blue[30]},featureIcon:{...c.featureIcon,fill:e.palette.blue[400]}})),[c]);return(0,O.jsx)(C().A,{showImage:!0,caption:l.description,tooltipImage:null===(t=l.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=l.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,O.jsx)(R().j7,{collectionContextStore:i,feature:l,caption:l.description,buttonMenuItemProps:{...(0,_().A)(s,e)},icon:(0,O.jsx)("div",{style:d.featureIconWrapper,children:(0,u().S)(d.featureIcon)}),right:(0,O.jsx)(K().M,{focused:s.focused}),onClick:()=>$({environment:a,collectionContextStore:i})})})}function $(e){const{collectionContextStore:t,environment:o}=e;B().A.setState({isModalOpen:!0,databaseType:l().dC,collectionContextStore:t});const n=(0,w().sl)(t)||{};(0,h().v)(o,"convert_db_start",{...n,database_type:l().dC})}function G(e){const{collectionContextStore:t,feature:o,itemProps:i}=e,l=(0,n().v3)(),s=(0,D().NE)(),a=(0,r().IS)((e=>({featureIconWrapper:{...s.featureIconWrapper,backgroundColor:e.palette.blue[30]},featureIcon:{...s.featureIcon,fill:e.palette.blue[400]}})),[s]);return(0,O.jsx)(E().jB,{collectionContextStore:t,feature:o,itemProps:i,icon:(0,O.jsx)("div",{style:a.featureIconWrapper,children:(0,u().S)(a.featureIcon)}),onClick:q({environment:l,collectionContextStore:t})})}function Q(){const e=(0,r().IS)((e=>({confirmationModalDescription:{fontSize:12,display:"flex",textAlign:"center"}})),[]);return(0,O.jsx)("span",{style:e.confirmationModalDescription,children:(0,O.jsx)(p().sA,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.description",defaultMessage:"Tasks from this database will no longer appear in Home or work with Sprints."})})}function Z(){const e=(0,r().IS)((e=>({confirmationModalTitle:{fontWeight:500},wrapper:{textAlign:"center"}})),[]);return(0,O.jsx)("div",{style:e.wrapper,children:(0,O.jsx)("span",{style:e.confirmationModalTitle,children:(0,O.jsx)(p().sA,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.title",defaultMessage:"Undo Task Database?"})})})}function q(e){const{environment:t,collectionContextStore:o}=e,n=[{label:(0,O.jsx)(p().sA,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.confirm",defaultMessage:"Remove"}),color:"red",onAccept:()=>{y().createAndCommit({environment:t,userAction:"CollectionTaskTypeBadge.untypeDatabase",canUndo:!0,perform:e=>{x().Fr({environment:t,collectionContextStore:o,transaction:e})}})}}];return()=>{f().ui({message:(0,O.jsx)(Z,{}),description:(0,O.jsx)(Q,{}),showCancel:!0,keepFocus:!0,items:n})}}const Y=(0,p().YK)({featureName:{id:"feature.sprints.name",defaultMessage:"Sprints"},featureDescription:{id:"feature.sprints.description",defaultMessage:"Plan tasks in cycles with sprints"}}),J={uri:"notion://feature/sprints_feature",name:A().A.formatMessage(Y.featureName),description:A().A.formatMessage(Y.featureDescription),tooltipImage:{img:s().A.images.tooltips.properties.sprintsPng,scale:.5},icon:"/icons/run_gray.svg",collectionUri:F().R,isFeatureAdded:function(e,t){var o;if(e.uri!==J.uri)return!1;const n=null===(o=t.sprintSettingsContextStore.state)||void 0===o?void 0:o.permissionsContext;if(!n)return!1;return n.canEdit&&n.sprintsEnabled},getSuggestedFeatureMenuItem:e=>(0,O.jsx)(ee,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore,feature:e.feature,itemProps:e.itemProps}),getAddedFeatureMenuItem:e=>(0,O.jsx)(te,{collectionContextStore:e.collectionContextStore,collectionSettingsStore:e.collectionSettingsStore,feature:e.feature,itemProps:e.itemProps})};function X(e){const t=e.databaseType;if(t===l().av){const t=e.collectionStore();return Boolean(t&&(0,j().$6)(t))}return t===l().dC&&function(e){const t=e.collectionStore();if(!t)return!1;const o=t.getMappedProperty(l().yx.TaskToSprintRelation),n=t.getSchema()[o];if(!n)return!0;const i=(0,I().pg)(e,n);return Boolean(i&&(0,j().$6)(i))}(e)}function ee(e){var t,o;const{collectionContextStore:n,collectionSettingsStore:i,feature:l,itemProps:s}=e,a=(0,D().NE)(),c=(0,r().IS)((e=>({featureIconWrapper:{...a.featureIconWrapper,backgroundColor:e.palette.blue[30]},featureIcon:{...a.featureIcon,fill:e.palette.blue[400]}})),[a]);return(0,O.jsx)(C().A,{showImage:!0,caption:l.description,tooltipImage:null===(t=l.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=l.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,O.jsx)(R().j7,{collectionContextStore:n,feature:l,caption:l.description,buttonMenuItemProps:{...(0,_().A)(s,e)},icon:(0,O.jsx)("div",{style:c.featureIconWrapper,children:(0,u().S)(c.featureIcon)}),right:(0,O.jsx)(K().M,{focused:s.focused}),onClick:()=>m().a2({collectionSettingsStore:i,item:{type:"sprintSettings",from:"customize_menu"}})})})}function te(e){const{collectionContextStore:t,collectionSettingsStore:o,feature:n,itemProps:i}=e,l=(0,D().NE)(),s=(0,r().IS)((e=>({featureIconWrapper:{...l.featureIconWrapper,backgroundColor:e.palette.blue[30]},featureIcon:{...l.featureIcon,fill:e.palette.blue[400]}})),[l]);return(0,O.jsx)(E().jB,{collectionContextStore:t,feature:n,itemProps:i,icon:(0,O.jsx)("div",{style:s.featureIconWrapper,children:(0,u().S)(s.featureIcon)}),onClick:()=>m().a2({collectionSettingsStore:o,item:{type:"sprintSettings",from:"customize_menu"}})})}const oe=(0,p().YK)({githubFeatureDescription:{id:"customizeMenu.github.featureDescription",defaultMessage:"Link PRs and set up automated task status updates based on PR changes"},googleDriveFeatureDescription:{id:"customizeMenu.googleDrive.featureDescription",defaultMessage:"Link Google Drive files"},figmaFeatureDescription:{id:"customizeMenu.figma.featureDescription",defaultMessage:"Link Figma pages"},zendeskFeatureDescription:{id:"customizeMenu.zendesk.featureDescription",defaultMessage:"Link Zendesk tickets"}}),ne=[c().Hd,c().ob,c().e1,c().k0],ie="notion://feature/connection_",re=`${ie}${c().ob}`,le=`${ie}${c().Hd}`,se=`${ie}${c().e1}`,ae=`${ie}${c().k0}`,ce={[c().ob]:`${ie}property_${c().ob}`,[c().Hd]:`${ie}property_${c().Hd}`,[c().e1]:`${ie}property_${c().e1}`,[c().k0]:`${ie}property_${c().k0}`},de={[c().ob]:oe.githubFeatureDescription,[c().Hd]:oe.googleDriveFeatureDescription,[c().e1]:oe.figmaFeatureDescription,[c().k0]:oe.zendeskFeatureDescription},ue={[c().ob]:s().A.images.tooltips.properties.githubSyncPullStatusPng,[c().Hd]:s().A.images.tooltips.properties.googleDrivePng,[c().e1]:s().A.images.tooltips.properties.figmaPng,[c().k0]:s().A.images.tooltips.properties.zendeskPng};function pe(){const e=(0,i().K8)((()=>{var e;return null===(e=T().default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),t=(0,i().K8)((()=>P().A.integrations.state),[]);return(0,i().K8)((()=>e?ne.map((e=>{const o=t.find((t=>t.id===e));if(!o)return;const n=o.id===c().ob?(0,v().Jb)().name:o.name;return{uri:`${ie}${e}`,name:n,description:A().A.formatMessage(de[e]),icon:o.info.icon,tooltipImage:{img:ue[e],scale:.5},collectionUri:F().R,integrationId:e,isFeatureAdded:(e,t)=>Boolean(Se(t,e.integrationId)),getSuggestedFeatureMenuItem:e=>(0,O.jsx)(ge,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps}),getAddedFeatureMenuItem:e=>(0,O.jsx)(me,{collectionContextStore:e.collectionContextStore,feature:e.feature,itemProps:e.itemProps})}})).filter(g().O9):[]),[e,t])}function ge(e){var t,o;const{collectionContextStore:i,feature:r,itemProps:l}=e,s=(0,n().v3)(),a=(0,p().tz)(),d=(0,D().NE)();return(0,O.jsx)(C().A,{showImage:!0,caption:r.description,tooltipImage:null===(t=r.tooltipImage)||void 0===t?void 0:t.img,tooltipImageScale:null===(o=r.tooltipImage)||void 0===o?void 0:o.scale,render:e=>(0,O.jsx)(R().j7,{collectionContextStore:i,feature:r,caption:r.description,buttonMenuItemProps:{...(0,_().A)(l,e)},icon:(0,O.jsx)("div",{style:d.featureIconWrapper,children:(0,O.jsx)(b().Ay,{style:d.featureIcon,src:r.icon})}),right:(0,O.jsx)(K().M,{focused:l.focused}),onClick:()=>async function(e){var t;const{environment:o,collectionContextStore:n,feature:i,intl:r}=e,l=P().A.integrations.state.find((e=>e.id===i.integrationId)),s=null==l||null===(t=l.info.original_url_patterns)||void 0===t?void 0:t.find((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.connectedRelation}));if(!l||!s||!i.integrationId)return;const a={name:l.id===c().ob?(0,v().Jb)().name:(0,M().Fe)({pattern:s,integration:l}),pattern:s,integration:l};await S().XO({environment:o,collectionContextStore:n,connectedRelationProperty:a,intl:r,from:"customize_menu",untypedFeatureArgs:{propertyId:ce[i.integrationId]},propertyGroupId:void 0}),(0,V().t)({featureName:i.name})}({environment:s,collectionContextStore:i,intl:a,feature:r})})})}function me(e){const{collectionContextStore:t,feature:o,itemProps:n}=e,i=(0,D().NE)(),r=o.integrationId;return r?(0,O.jsx)(E().jB,{collectionContextStore:t,feature:o,itemProps:n,icon:(0,O.jsx)("div",{style:i.featureIconWrapper,children:(0,O.jsx)(b().Ay,{style:i.featureIcon,src:o.icon})}),onClick:()=>{const e=Se(t,r);e?(0,E().Ak)({collectionContextStore:t,property:e}):d().log({level:"error",from:"CustomComponentFeatures",type:"ConnectionFeatureMissingPropertyId",error:{miscDataString:`Feature ${o.name} has no relation property ID.`}})}}):(d().log({level:"error",from:"CustomComponentFeatures",type:"ConnectionFeatureMissingIntegrationId",error:{miscDataString:`Feature ${o.name} has no integration ID.`}}),null)}function Se(e,t){var o;const n=null===(o=e.collectionStore())||void 0===o?void 0:o.getSchema();if(n&&t)for(const[i,r]of Object.entries(n))if(r&&(0,a().UU)(r)&&r.connectedRelation.integration_id===t)return i}},747444:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(757695))().Store{getInitialState(){return{isOpen:!1,blockStore:void 0}}}const i=new n},747651:(e,t,o)=>{o.d(t,{x:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("cubeOutline",{viewBox:"0 0 14 16",svg:(0,n.jsx)("path",{d:"M1.01855 11.96C0.694987 11.7777 0.448893 11.568 0.280273 11.3311C0.116211 11.0895 0.0341797 10.7272 0.0341797 10.2441V4.7207C0.0341797 4.35612 0.104818 4.05306 0.246094 3.81152C0.38737 3.56543 0.610677 3.35579 0.916016 3.18262L5.72168 0.489258C6.14551 0.252279 6.57161 0.133789 7 0.133789C7.42839 0.133789 7.85221 0.252279 8.27148 0.489258L13.0771 3.18262C13.3825 3.35579 13.6058 3.56543 13.7471 3.81152C13.8883 4.05306 13.959 4.35612 13.959 4.7207V10.2441C13.959 10.7272 13.877 11.0895 13.7129 11.3311C13.5488 11.568 13.3027 11.7777 12.9746 11.96L7.68359 14.9268C7.22786 15.1774 6.76986 15.1774 6.30957 14.9268L1.01855 11.96ZM1.75684 10.9072L6.36426 13.5117V8.0293L1.25098 5.14453V10.1211C1.25098 10.2988 1.28743 10.4492 1.36035 10.5723C1.43783 10.6953 1.56999 10.807 1.75684 10.9072ZM12.2363 10.9072C12.4232 10.807 12.5531 10.6953 12.626 10.5723C12.7035 10.4492 12.7422 10.2988 12.7422 10.1211V5.14453L7.62891 8.0293V13.5117L12.2363 10.9072ZM7 6.9082L12.0518 4.07812L7.73145 1.64453C7.24837 1.36654 6.75846 1.36654 6.26172 1.64453L1.94824 4.07812L7 6.9082Z"})})},748768:(e,t,o)=>{o.r(t),o.d(t,{toggleTwoWaySyncOnCollection:()=>f,updateSyncedData:()=>y});o(16280),o(898992),o(672577);var n=()=>o(282883),i=()=>o(179034),r=()=>o(343666),l=()=>o(919709),s=()=>o(312296),a=()=>o(789557),c=()=>o(972435),d=()=>o(252833),u=()=>o(630116),p=()=>o(449506),g=()=>o(896628),m=()=>o(436572),S=()=>o(751156);function f(e){var t;const{environment:o,taskCollectionStore:i,projectCollectionStore:r}=e,l=!(null===(t=i.getFormat().sync_state)||void 0===t?void 0:t.enable_two_way_sync);l&&function(e){const{environment:t,taskCollectionStore:o}=e,i=o.getSchema(),r={};for(const l of n().En){const e=i[l];e&&"read_write"!==e.synced_permissions&&("notion://tasks/assign_property"===l&&"person"===e.type?r[l]={...e,synced_permissions:"read_write",limit:1}:r[l]={...e,synced_permissions:"read_write"})}Object.keys(r).length>0&&S().createAndCommit({userAction:"updateSyncedCollectionActions.addSyncedPermissionsToSchema",environment:t,canUndo:!0,perform:e=>{(0,s().F)({environment:t,collectionStore:o,update:r,transaction:e})}})}({environment:o,taskCollectionStore:i});const a=i.getFormat().sync_state||{syncing:!1};S().createAndCommit({userAction:"updateSyncedCollectionActions.toggleTwoWaySyncOnCollection",environment:o,canUndo:!0,perform:e=>{g().zA({stores:[i,r],update:{sync_state:{...a,enable_two_way_sync:l}},transaction:e})}})}async function y(e){const{transaction:t,environment:o}=e,s=t.operations.find((e=>(0,d().C0)(e)&&2===e.path.length&&"properties"===e.path[0]&&n().En.includes(e.path[1].toString())));if(s){const e=(0,d().sP)({transaction:t,updateOperation:s,environment:o});if(!e)return;return void(await async function(e){const{transaction:t,environment:o,updateOperation:n,syncedCollectionStore:i}=e,r=()=>{try{return(0,d().jg)({updateOperation:n,transaction:t,collectionStore:i})}catch(e){throw h({}),e}},l=r();if("UPDATE_PROPERTY"===l.syncCollectionUpdates[0].updateType){const e=d().vT({pageId:l.syncCollectionUpdates[0].collectionPagePointer.id,propertyId:l.syncCollectionUpdates[0].propertyId});d().Jv({uniquePropertyId:e});const t=await p().callApi({eventName:"updateSyncedCollectionData",environment:o,data:l});if(d().NW(e),"success"===t.type){if(t.data.success)return;var s;throw h({errorCode:t.data.errorCode,syncCollectionType:i.getFormat().external_collection_type,propertyName:1===l.syncCollectionUpdates.length?null===(s=i.getSchema()[l.syncCollectionUpdates[0].propertyId])||void 0===s?void 0:s.name:void 0}),new Error(t.data.message)}var a;throw h({syncCollectionType:i.getFormat().external_collection_type}),new Error((null===(a=t.error)||void 0===a||null===(a=a.name)||void 0===a?void 0:a.toString())??"Unknown error")}}({transaction:t,environment:o,updateOperation:s,syncedCollectionStore:e}))}const c=t.operations.find((e=>"set"===e.command&&1===e.path.length&&"text"===e.path[0]));if(c&&c.pointer.table===r().SN){const e=(0,d().cb)({transaction:t,commentPointer:c.pointer,environment:o});if(!e)return;const{collectionStore:n,collectionPagePointer:i}=e;return void(await async function(e){const{transaction:t,environment:o,updateOperation:n,syncedCollectionStore:i,collectionPagePointer:r}=e,l=()=>{try{return(0,d().mE)({updateOperation:n,transaction:t,collectionStore:i,collectionPagePointer:r})}catch(e){throw h({}),e}},s=l();d().L$({commentId:n.pointer.id});const a=await p().callApi({eventName:"updateSyncedCollectionData",environment:o,data:s});if(d().Rw(n.pointer.id),"success"===(null==a?void 0:a.type)){if(a.data.success)return;throw h({errorCode:a.data.errorCode,syncCollectionType:i.getFormat().external_collection_type}),new Error(a.data.message)}var c;throw h({syncCollectionType:i.getFormat().external_collection_type}),new Error((null===(c=a.error)||void 0===c||null===(c=c.name)||void 0===c?void 0:c.toString())??"Unknown error")}({transaction:t,environment:o,updateOperation:c,syncedCollectionStore:n,collectionPagePointer:i}))}const g=t.operations.find((e=>{var t;return"update"===e.command&&1===e.path.length&&"properties"===e.path[0]&&(null===(t=e.args)||void 0===t?void 0:t.source)}));if(g){const e=(0,d().m0)({transaction:t,updateOperation:g,environment:o});if(!e)return;try{await async function(e){var t;const{transaction:o,environment:n,updateOperation:i,syncedCollectionStore:r,collectionPagePointer:s,commentPointer:a}=e,c=l().q4_(null===(t=i.args)||void 0===t?void 0:t.source);if(!c)return;const d=c.split(":").pop();if(!d)return;const u=r.getFormat().external_collection_type;if(!u)throw h({}),new Error("Collection is not an external synced collection");const g={spaceId:o.spaceId,syncType:u,syncCollectionUpdates:[{collectionPagePointer:s,notionCommentId:a.id,attachment:{fileName:d,s3Data:{path:c}},updateType:"APPEND_ATTACHMENT"}]},m=await p().callApi({eventName:"updateSyncedCollectionData",environment:n,data:g});if("success"===(null==m?void 0:m.type)){if(m.data.success)return;throw h({errorCode:m.data.errorCode,syncCollectionType:r.getFormat().external_collection_type}),new Error(m.data.message)}var S;throw h({syncCollectionType:r.getFormat().external_collection_type}),new Error((null===(S=m.error)||void 0===S||null===(S=S.name)||void 0===S?void 0:S.toString())??"Unknown error")}({transaction:t,environment:o,updateOperation:g,syncedCollectionStore:e.collectionStore,collectionPagePointer:e.collectionPagePointer,commentPointer:e.commentPointer})}catch(m){const n=new(u().jg)(o,e.commentPointer),r=new(u().Bv)(o,{id:g.pointer.id,table:i().ev,spaceId:t.spaceId});throw n&&r&&S().createAndCommit({userAction:"Comment.handleRemoveFileFromActionsDueToSyncFailure",environment:o,canUndo:!0,perform:e=>{a().L6({commentStore:n,fileBlocks:[r],transaction:e})}}),m}}else;}function h(e){const{errorCode:t,syncCollectionType:o,propertyName:n}=e,i=c().A.getIntl();if(!o)return void m().yq({item:{label:i.formatMessage({id:"syncedCollectionUpdateError.syncCollectionTypeMissing",defaultMessage:"Failed to update: incorrect sync collection setup"})}});if(!t)return void m().yq({item:{label:`Failed to update ${n??o}`}});const r=d().LA({syncCollectionType:o,errorCode:t,intl:i});m().yq({item:{label:r}})}},762631:(e,t,o)=>{o.d(t,{U:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"3.25 2.03 10.46 11.93",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M3.25 13.165a.8.8 0 0 0 1.203.69l8.854-5.164a.8.8 0 0 0 0-1.382L4.453 2.144a.8.8 0 0 0-1.203.691z"})},i=(0,o(340498).wt)("arrowCaretRightFillSmall",n)},768627:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(757695))().Store{getInitialState(){return{searchQuery:"",searchLimit:n.limitIncrement,searchPopupOpen:!1,addingPage:!1}}}n.limitIncrement=20,n.resultsCacheTTL=2*o(720665).Xb,n.incrementScrollOffset=200;const i=n},769145:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,salesforceIcon:()=>r});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{fill:"#00A1E0",fillRule:"evenodd",d:"M8.322 4.65a3.5 3.5 0 0 1 2.536-1.088c1.322 0 2.469.735 3.086 1.83a4.3 4.3 0 0 1 1.742-.371C18.067 5.02 20 6.968 20 9.37c0 2.404-1.933 4.351-4.314 4.351q-.436 0-.852-.084a3.157 3.157 0 0 1-4.13 1.3 3.592 3.592 0 0 1-6.68-.162 3.3 3.3 0 0 1-.687.07C1.492 14.847 0 13.334 0 11.475A3.39 3.39 0 0 1 1.668 8.55a3.883 3.883 0 0 1 3.568-5.424 3.87 3.87 0 0 1 3.087 1.529",clipRule:"evenodd"}),(0,n.jsx)("path",{fill:"#FFFFFE",fillRule:"evenodd",d:"M2.913 10.382c-.012.033.005.04.009.046.037.027.075.046.114.069.204.108.397.14.598.14.41 0 .665-.22.665-.57v-.007c0-.325-.288-.443-.557-.528l-.035-.011c-.204-.066-.38-.124-.38-.258v-.006c0-.115.103-.2.262-.2.176 0 .387.06.521.133 0 0 .04.026.054-.012l.084-.225c.008-.022-.006-.038-.02-.046a1.16 1.16 0 0 0-.588-.158H3.6c-.376 0-.638.227-.638.552v.007c0 .342.29.454.56.531l.043.014c.197.06.368.113.368.251v.007c0 .127-.111.222-.29.222a.97.97 0 0 1-.528-.152c-.029-.017-.045-.03-.067-.043-.012-.007-.041-.02-.054.019zm6.004 0c-.012.032.005.04.009.045.037.027.076.047.114.069.204.108.397.14.598.14.41 0 .665-.219.665-.57v-.007c0-.325-.287-.443-.557-.528l-.035-.01c-.204-.067-.38-.124-.38-.258v-.007c0-.115.103-.2.262-.2.177 0 .386.06.521.134 0 0 .04.026.055-.013l.083-.225c.008-.021-.006-.037-.02-.046a1.16 1.16 0 0 0-.588-.158h-.041c-.376 0-.638.227-.638.552v.007c0 .343.29.454.56.532l.043.013c.198.06.368.113.368.251v.007c0 .127-.111.222-.289.222a.97.97 0 0 1-.528-.152c-.03-.017-.046-.028-.068-.042-.007-.005-.042-.019-.054.018zm4.1-.688q0 .299-.11.466c-.072.11-.18.163-.333.163q-.226 0-.332-.162c-.072-.11-.108-.268-.108-.466q0-.299.108-.464.105-.162.332-.16.228-.001.334.16.109.165.11.464m.342-.368a.8.8 0 0 0-.156-.298.75.75 0 0 0-.263-.2.9.9 0 0 0-.368-.073.9.9 0 0 0-.367.073.76.76 0 0 0-.42.498q-.05.17-.05.368t.05.368a.8.8 0 0 0 .157.298q.105.125.263.198a.9.9 0 0 0 .367.072.9.9 0 0 0 .367-.072.74.74 0 0 0 .263-.198.8.8 0 0 0 .156-.298q.05-.17.05-.368t-.05-.368m2.815.94c-.012-.033-.044-.02-.044-.02a1 1 0 0 1-.16.045q-.086.014-.187.014a.52.52 0 0 1-.392-.147c-.095-.098-.148-.255-.147-.469 0-.194.048-.34.132-.45q.125-.167.38-.168c.14 0 .249.016.362.051 0 0 .027.012.04-.023l.084-.234c.01-.026-.013-.037-.021-.04a1.3 1.3 0 0 0-.486-.075.9.9 0 0 0-.381.073.79.79 0 0 0-.443.498 1.2 1.2 0 0 0-.056.369q0 .426.228.682.23.254.676.254c.176 0 .356-.035.485-.087 0 0 .025-.012.014-.04zm.599-.764a.7.7 0 0 1 .094-.273.37.37 0 0 1 .331-.169.36.36 0 0 1 .325.169.6.6 0 0 1 .077.273h-.83zm1.154-.243a.7.7 0 0 0-.149-.27.7.7 0 0 0-.22-.168.9.9 0 0 0-.332-.068.9.9 0 0 0-.383.075.8.8 0 0 0-.267.203.8.8 0 0 0-.157.301q-.051.173-.051.37 0 .201.052.37a.8.8 0 0 0 .169.295.8.8 0 0 0 .291.193q.177.07.422.069c.335-.002.511-.076.583-.117.013-.007.025-.02.01-.055l-.076-.212c-.011-.032-.043-.02-.043-.02-.084.03-.201.086-.477.085-.18 0-.313-.053-.397-.136-.085-.085-.128-.21-.134-.386h1.161s.03 0 .034-.03c.001-.012.04-.237-.035-.498zM7.49 9.502a.7.7 0 0 1 .094-.273.37.37 0 0 1 .331-.169.36.36 0 0 1 .325.169.6.6 0 0 1 .077.273h-.83zm1.154-.243a.7.7 0 0 0-.149-.27.7.7 0 0 0-.22-.168.9.9 0 0 0-.332-.068.9.9 0 0 0-.383.075.8.8 0 0 0-.267.203.8.8 0 0 0-.157.301q-.051.173-.051.37 0 .201.053.37a.8.8 0 0 0 .167.295.8.8 0 0 0 .292.193q.176.07.421.069c.335-.002.511-.076.583-.117.013-.007.025-.02.01-.055l-.075-.212c-.012-.032-.044-.02-.044-.02-.083.03-.2.086-.476.085-.18 0-.313-.053-.397-.136-.085-.085-.128-.21-.135-.386h1.161s.031 0 .034-.03c.001-.012.04-.237-.035-.498m-3.66 1a.2.2 0 0 1-.067-.069.3.3 0 0 1-.035-.15q0-.152.104-.225c-.001 0 .1-.086.336-.083q.158.002.315.026v.527s-.147.032-.313.042c-.236.014-.34-.068-.34-.068m.461-.816a3 3 0 0 0-.18-.005q-.15 0-.286.037a.7.7 0 0 0-.241.112.56.56 0 0 0-.169.191.56.56 0 0 0-.062.268q0 .155.053.264a.5.5 0 0 0 .152.182.6.6 0 0 0 .236.102q.136.03.307.031.179 0 .352-.03.147-.024.292-.056l.081-.02c.029-.008.027-.038.027-.038l-.001-1.059q0-.35-.184-.511-.184-.16-.532-.16a2 2 0 0 0-.311.028s-.253.05-.358.131c0 0-.022.014-.01.046l.082.22c.01.03.038.02.038.02l.02-.01c.222-.121.504-.118.504-.118q.188 0 .287.075c.063.049.095.122.095.277v.049c-.099-.015-.19-.023-.19-.023zm9.334-.597a.03.03 0 0 0 0-.025.03.03 0 0 0-.018-.017 1 1 0 0 0-.194-.033.6.6 0 0 0-.299.048.5.5 0 0 0-.195.145v-.141c0-.02-.014-.035-.034-.035h-.297c-.019 0-.033.015-.033.035v1.727q0 .015.01.025t.025.01h.305q.014 0 .024-.01a.04.04 0 0 0 .01-.025v-.867c0-.117.014-.232.039-.305a.44.44 0 0 1 .101-.17q.061-.061.144-.086a.56.56 0 0 1 .283-.006c.022.002.034-.012.042-.032l.088-.243",clipRule:"evenodd"}),(0,n.jsx)("path",{fill:"#FFFFFE",fillRule:"evenodd",d:"M11.938 8.049a1 1 0 0 0-.272-.04q-.316.001-.491.176-.174.176-.233.526l-.014.079h-.263s-.032-.002-.04.034l-.043.24c-.003.024.007.038.038.038h.257l-.26 1.45q-.03.177-.07.287a.6.6 0 0 1-.08.165.2.2 0 0 1-.107.082.43.43 0 0 1-.23.009c-.027-.006-.041-.012-.062-.02 0 0-.03-.012-.042.018l-.086.236c-.008.023.004.04.018.046a.7.7 0 0 0 .276.047.9.9 0 0 0 .284-.044.53.53 0 0 0 .215-.15.8.8 0 0 0 .15-.259q.06-.158.102-.39l.261-1.477h.382s.033.001.04-.034l.042-.24q.006-.037-.038-.038h-.37c.002-.009.019-.139.061-.262a.34.34 0 0 1 .081-.123.24.24 0 0 1 .097-.06.5.5 0 0 1 .279.006c.038.01.043 0 .05-.019l.09-.243c.008-.026-.014-.037-.022-.04m-5.18 2.507c0 .02-.013.035-.032.035h-.308c-.02 0-.033-.016-.033-.035V8.082c0-.02.014-.035.033-.035h.308c.019 0 .033.015.033.035z",clipRule:"evenodd"})]})},r=(0,o(340498).wt)("salesforce",i)},813197:(e,t,o)=>{o.d(t,{L:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.5 3.07 13 13.83",svg:(0,o(474848).jsx)("path",{d:"M8.848 3.085c.34.06.567.384.507.724l-.61 3.466h3.42l.65-3.683a.625.625 0 0 1 1.23.216l-.61 3.467h2.435a.625.625 0 1 1 0 1.25h-2.655l-.52 2.95h2.435a.625.625 0 0 1 0 1.25h-2.655l-.65 3.684a.625.625 0 0 1-1.23-.217l.61-3.467h-3.42l-.65 3.684a.625.625 0 0 1-1.23-.217l.61-3.467H4.13a.625.625 0 1 1 0-1.25h2.605l.52-2.95H4.87a.625.625 0 0 1 0-1.25h2.605l.65-3.683a.625.625 0 0 1 .723-.507m2.578 8.39.52-2.95H8.523l-.52 2.95z"})},i=(0,o(340498).wt)("number",n)},822650:(e,t,o)=>{o.d(t,{a:()=>b});o(296540);var n=()=>o(401497),i=()=>o(128914),r=()=>o(632625),l=()=>o(589982),s=()=>o(563884),a=()=>o(340498),c=o(474848);const d=(0,a().wt)("collectionDependenciesArrowRight",{viewBox:"0 0 16 16",directional:!0,svg:(0,c.jsx)("path",{transform:"translate(3,3)",d:"M1.34.302a.701.701 0 00-.383.095.708.708 0 00-.24.253 1.074 1.074 0 00-.109.322 3.26 3.26 0 00-.054.465c-.01.173-.014.36-.014.56 0 1.609.353 2.791 1.06 3.548.71.752 1.857 1.128 3.438 1.128h4.525l1.634-.089L9.16 8.423 7.643 9.968a.798.798 0 00-.164.239.785.785 0 00-.055.294c0 .205.068.376.205.513a.736.736 0 00.533.205c.196 0 .378-.082.547-.246l4.498-4.485a.78.78 0 00.246-.567.743.743 0 00-.246-.56L8.695.854A.76.76 0 008.162.63a.736.736 0 00-.533.205.696.696 0 00-.205.513c0 .104.018.202.055.294a.715.715 0 00.164.232L9.16 3.419l2.037 1.852-1.634-.102h-4.43c-.76 0-1.366-.11-1.818-.328a1.94 1.94 0 01-.963-1.04c-.196-.473-.294-1.09-.294-1.852 0-.191.002-.358.006-.499.01-.141.014-.278.014-.41a.721.721 0 00-.205-.533.721.721 0 00-.533-.205z"})});const u=(0,a().wt)("collectionTimeline",{viewBox:"0 0 16 16",svg:(0,c.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5964 14.4634H2.39697C0.940186 14.4634 0.162354 13.6987 0.162354 12.2485V4.24609C0.162354 2.7959 0.940186 2.03125 2.39697 2.03125H13.5964C15.0532 2.03125 15.8311 2.80249 15.8311 4.24609V12.2485C15.8311 13.6921 15.0532 14.4634 13.5964 14.4634ZM1.63232 12.0969C1.63232 12.7034 1.94214 12.9934 2.52222 12.9934H13.4712C14.0447 12.9934 14.3611 12.7034 14.3611 12.0969V4.39771C14.3611 3.79126 14.0447 3.50122 13.4712 3.50122H2.52222C1.94214 3.50122 1.63232 3.79126 1.63232 4.39771V12.0969ZM8.92711 6.13826H2.71776C2.44986 6.13826 2.23645 5.91123 2.23645 5.64787C2.23645 5.37997 2.44986 5.15747 2.71776 5.15747H8.92711C9.19955 5.15747 9.40842 5.37542 9.40842 5.64787C9.40842 5.91577 9.19955 6.13826 8.92711 6.13826ZM11.3757 8.49036H4.75992C4.49201 8.49036 4.2786 8.26332 4.2786 7.99996C4.2786 7.73206 4.49201 7.50957 4.75992 7.50957H11.3757C11.6482 7.50957 11.857 7.72752 11.857 7.99996C11.857 8.26332 11.6482 8.49036 11.3757 8.49036ZM13.2822 10.8424H8.24608C7.97818 10.8424 7.76477 10.6109 7.76477 10.352C7.76477 10.0841 7.97818 9.85711 8.24608 9.85711H13.2822C13.5547 9.85711 13.7636 10.0796 13.7636 10.352C13.7636 10.6154 13.5547 10.8424 13.2822 10.8424Z"})});var p=()=>o(747651),g=()=>o(658985);const m=(0,a().wt)("nest",{viewBox:"0 0 16 16",svg:(0,c.jsxs)("g",{children:[(0,c.jsx)("path",{d:"M5.59375 4.52344H14.3984C14.7607 4.52344 15.0479 4.23633 15.0479 3.87402C15.0479 3.51172 14.7607 3.22461 14.3984 3.22461H5.59375C5.23145 3.22461 4.94434 3.51172 4.94434 3.87402C4.94434 4.23633 5.22461 4.52344 5.59375 4.52344ZM8 8.7207H14.3984C14.7607 8.7207 15.0479 8.43359 15.0479 8.07129C15.0479 7.70898 14.7607 7.42188 14.3984 7.42188H8C7.6377 7.42188 7.35059 7.70898 7.35059 8.07129C7.35059 8.43359 7.63086 8.7207 8 8.7207ZM10 12.918H14.3984C14.7607 12.918 15.0479 12.6309 15.0479 12.2686C15.0479 11.9062 14.7607 11.6191 14.3984 11.6191H10C9.6377 11.6191 9.35059 11.9062 9.35059 12.2686C9.35059 12.6309 9.63086 12.918 10 12.918Z"}),(0,c.jsx)("path",{d:"M1.66386 4.7627L0.898238 3.46387C0.713668 3.14941 0.829878 2.80762 1.19218 2.80762H2.85332C3.22929 2.80762 3.33867 3.14258 3.14726 3.46387L2.36113 4.7627C2.21074 5.01562 1.82109 5.02246 1.66386 4.7627Z"}),(0,c.jsx)("path",{d:"M3.85358 8.94885L3.08795 7.65002C2.90338 7.33557 3.01275 6.99377 3.3819 6.99377H5.03619C5.41217 6.99377 5.52838 7.32874 5.33014 7.65002L4.55084 8.94885C4.40045 9.20178 4.0108 9.20862 3.85358 8.94885Z"}),(0,c.jsx)("path",{d:"M6.90723 12.6377L5.6084 13.4033C5.29395 13.5878 4.95215 13.4716 4.95215 13.1093V11.4482C4.95215 11.0722 5.28711 10.9628 5.6084 11.1543L6.90723 11.9404C7.16016 12.0908 7.16699 12.4804 6.90723 12.6377Z"})]})});var S=()=>o(385527),f=()=>o(713838),y=()=>o(248823),h=()=>o(328327),x=()=>o(374562),v=()=>o(646668);const C={[(0,x().kr)().uri]:u,[(0,x().Xq)().uri]:s().k,[(0,o(326224).nU)().uri]:g().$,[(0,h().Ub)().uri]:o(974967).n,[(0,h().mU)().uri]:o(50170).u,[(0,h().$$)().uri]:S().h,[(0,h().AN)().uri]:s().k,[(0,h().PA)().uri]:f().e,[(0,h().l3)().uri]:g().$,[(0,h().Sg)().uri]:l().u,[(0,h().NP)().uri]:l().u,[(0,v().rr)().uri]:o(173019).r,[(0,v().uo)().uri]:o(318890).K,[(0,v().Rh)().uri]:o(981714).u,[(0,x().md)().uri]:m,[(0,x().J4)().uri]:d,[(0,y().ft)().uri]:S().h,[(0,y().Li)().uri]:f().e};function b(e){const{feature:t}=e,o=(0,n().IS)((e=>{var o,n;return{featureIconWrapper:{height:28,width:28,padding:"6px 0px",backgroundColor:null===(o=w(t,e))||void 0===o?void 0:o[30],borderRadius:4},featureIcon:{width:16,height:16,alignItems:"center",margin:"auto",fill:null===(n=w(t,e))||void 0===n?void 0:n[400]}}}),[t]),i=(0,n().DP)();if(!t.icon){const e=C[t.uri]??p().x;return(0,c.jsx)("div",{style:o.featureIconWrapper,children:e(o.featureIcon)})}return(0,c.jsx)("div",{style:o.featureIconWrapper,children:(0,c.jsx)(r().p,{icon:t.icon,theme:i,size:16,style:o.featureIcon})})}function w(e,t){return e.isAi?t.palette.purple:(0,i().tK)(e.collectionUri,t)}},885749:(e,t,o)=>{o.d(t,{A:()=>d,u:()=>a});o(898992),o(803949),o(581454);var n=o(296540),i=()=>o(959013),r=()=>o(406699),l=()=>o(939740),s=o(474848);const a=(0,i().YK)({hide:{id:"PersonalHomePanel.moreDropdown.hide.title",defaultMessage:"Hide from Home"}});function c(e){let{actions:t}=e;const c=(0,i().tz)(),d=(0,n.useMemo)((()=>{const e={};return t.forEach((t=>{"custom"===t.type&&(e[t.item.key]=t.closeOnAccept)})),e}),[t]),u=[{key:"all",render:e=>(0,s.jsx)(o(89924).A,{...e}),items:t.map((e=>{switch(e.type){case"hide":return{key:"hide",render:e=>(0,s.jsx)(o(760217).A,{...e,icon:(0,s.jsx)(o(8980).I,{icon:o(566910).e}),title:c.formatMessage(a.hide),style:{borderRadius:o(665579)._g}}),action:e.hide};case"custom":return e.item;default:(0,o(534177).HB)(e)}}))}];return(0,s.jsx)(r().Ay,{popupType:r().z7.Popup,alignmentToOrigin:r().yP.Center,originGap:2,renderOrigin:e=>(0,s.jsx)(o(167068).A,{...e}),render:e=>(0,s.jsx)(o(928600).A,{menuType:o(722872).gu.Popup,children:(0,s.jsx)(l().Ay,{onAccept:t=>((e,t)=>{d[e.key]&&t.close()})(t,e),type:l().Oh.Vertical,sections:u,initialFocus:void 0})})})}const d=n.memo(c)},911724:(e,t,o)=>{o.d(t,{A:()=>u,v:()=>d});o(898992),o(354520);var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(2220),s=()=>o(546461),a=o(474848);const c=(0,n.createContext)({collectionStore:void 0,currentDraggingActionId:void 0,disabled:!0,maybePersistedTransactionActions:{createAndCommit:o(633904).l},editorPlacement:{type:"inline"},editorWidth:300,suppressActionErrors:[],collapsedActionIds:[],hideDragHandle:!1,cantSaveDueToError:!1,toggleActionIdCollapsed:()=>{}});function d(e){const t=(0,i().v3)(),{automationStore:o}=(0,s().EC)(),d=(0,r().K8)((()=>o.getActionIds()),[o]),[u,p]=(0,n.useReducer)(((e,n)=>{const i=e.includes(n);return(0,l().u)({environment:t,event:{eventName:"automation_action_collapse_toggle",eventProperties:{collapsed:!i,automation_action_id:n,automation_id:o.id}}}),i?e.filter((e=>e!==n)):[...e,n]}),e.defaultCollapseActions?d:[]);return(0,a.jsx)(c.Provider,{value:{...e.value,collapsedActionIds:u,toggleActionIdCollapsed:p},children:e.children})}c.displayName="AutomationEditorContext";const u=c},914873:(e,t,o)=>{o.d(t,{N:()=>g,e:()=>p});o(16280),o(296540);var n=()=>o(56366),i=()=>o(955363),r=()=>o(465505),l=()=>o(959013),s=()=>o(760217),a=()=>o(8980),c=()=>o(691093),d=()=>o(990402),u=o(474848);function p(e){let{environment:t,collectionContextStore:o}=e;if(g(t,o))return{key:"openBuilderConfig",action:()=>{const e=o.collectionViewBlockStore();if(!e)throw new Error("Parent store is undefined");(0,c().showWorkflowEditor)({environment:t,parentStore:e})},render:e=>(0,u.jsx)(s().A,{title:(0,u.jsx)(l().sA,{defaultMessage:"Builder mode",id:"collectionViewSuggestedViews.openBuilderConfig.label"}),icon:(0,u.jsx)(a().I,{icon:r().P}),right:(0,u.jsx)(a().I,{icon:i().arrowDiagonalUpRightIcon,color:"secondary",size:18}),...e})}}function g(e,t){const o=(0,n().K8)((()=>{const e=t.collectionViewBlockStore();return!!e&&(0,d().m)(e)}),[t]),i=(0,n().O$)(t.isFullScreenStore);return o&&i&&!e.device.isMobile}},926203:(e,t,o)=>{o.d(t,{$g:()=>V,Eg:()=>R,Wf:()=>N,Xm:()=>K,aH:()=>F,pz:()=>D,qd:()=>B,v9:()=>U});o(898992),o(354520),o(672577),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(401497),s=()=>o(970013),a=()=>o(726275),c=()=>o(212727),d=()=>o(236262),u=()=>o(959013),p=()=>o(183558),g=()=>o(534177),m=()=>o(284371),S=()=>o(436696),f=()=>o(966759),y=()=>o(235191),h=()=>o(686526),x=()=>o(901389),v=()=>o(246826),C=()=>o(751156),b=()=>o(312296),w=()=>o(704152),j=()=>o(204063),A=()=>o(89924),_=()=>o(574036),I=()=>o(760578),M=()=>o(497222),k=()=>o(147361),T=()=>o(554840),P=o(474848);const B="consume_gap",V=!0;function F(e){var t;const{currentConfig:o,onConfigChange:s,disabled:a,collectionContextStore:c}=e,d=(0,r().K8)((()=>c.databaseType),[c]),p=(0,i().v3)(),m=null===(t=o.configWithoutDates)||void 0===t?void 0:t.mode,[f,y]=(0,n.useState)((0,g().O9)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):V),h=(0,g().O9)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):f;(0,n.useEffect)((()=>{if((0,g().O9)(o.configWithoutDates)){const e=Boolean(o.configWithoutDates.avoid_weekends);e!==f&&y(e)}}),[o,f]);const x=(0,l().IS)((()=>({dateShiftContainer:{marginLeft:4},previewContainer:{marginLeft:4},previewTitle:{paddingLeft:10}})),[]),v=(0,n.useCallback)((e=>{(0,g().O9)(o.configWithoutDates)&&(s({...o,configWithoutDates:{...o.configWithoutDates,avoid_weekends:e}}),(0,S().X)({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_avoid_weekends",new_avoid_weekends:e}))}),[c,o,p,s]),C=(0,n.useCallback)((e=>{(0,g().O9)(e)?s({...o,configWithoutDates:{...o.configWithoutDates,mode:e,avoid_weekends:f}}):s({...o,configWithoutDates:void 0}),(0,S().X)({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_mode",new_date_shift_mode:e??"none"})}),[c,o,p,f,s]);return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(A().A,{title:(0,P.jsx)(u().sA,{...I().Ic.dateShiftingSectionCaption}),disableMobileBorders:!0,style:x.previewContainer,desktopTitleStyle:x.previewTitle,children:(0,P.jsx)(k().r,{mode:m})}),(0,P.jsx)(A().A,{disableMobileBorders:!0,style:x.dateShiftContainer,children:(0,P.jsx)(L,{currentMode:m,onModeChange:C,databaseType:d,disabled:a})}),(0,P.jsxs)(A().A,{children:[(0,P.jsx)(O,{currentValue:h,databaseType:d,onChange:v,disabled:a||!(0,g().O9)(o.configWithoutDates)}),(0,P.jsx)(E,{...e})]})]})}function E(e){const{collectionContextStore:t,currentConfig:o,onConfigChange:i,disabled:l}=e,a=(0,r().K8)((()=>{const e=t.normalizedSchemaStore.state;return Object.keys(e).filter((t=>{const o=e[t];return o&&(0,s().$L)(o)}))}),[t]),c=a.length,d=o.datePropertyId?a.find((e=>e!==o.datePropertyId)):void 0,p="string"==typeof o.datePropertyId&&(0,g().O9)(o.endDatePropertyId),m=(0,n.useCallback)(((e,t)=>{const n={[e]:t};if(p&&(0,g().O9)(o.datePropertyId)){const i="datePropertyId"===e?"endDatePropertyId":"datePropertyId";o[i]===t&&(n[i]=a.find((e=>e!==t)))}i({...o,...n})}),[o,a,i,p]);return!(0,g().O9)(o.configWithoutDates)||c<=1?null:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(T().e,{collectionContextStore:t,currentPropertyId:o.datePropertyId,title:p?(0,P.jsx)(u().sA,{...I().Ic.startDate}):(0,P.jsx)(u().sA,{...I().Ic.datePropertyPickerTitle}),onPropertyChanged:e=>m("datePropertyId",e),disabled:l}),(0,g().O9)(d)&&"string"==typeof o.datePropertyId&&(0,P.jsxs)(P.Fragment,{children:[(0,g().O9)(o.endDatePropertyId)&&(0,P.jsx)(T().e,{collectionContextStore:t,currentPropertyId:o.endDatePropertyId,title:(0,P.jsx)(u().sA,{...I().Ic.endDate}),onPropertyChanged:e=>m("endDatePropertyId",e),disabled:l}),(0,P.jsx)(_().A,{title:(0,P.jsx)(u().sA,{id:"database.viewSettings.relationFeatures.datePropertyPicker.separateStartEnd",defaultMessage:"Separate start and end dates"}),focused:!1,on:p,disabled:l,disabledFeedback:!0,onClick:()=>{i({...o,endDatePropertyId:p?void 0:d})}})]})]})}function R(e){const{collectionSettingsStore:t,feature:o,permissionScopes:n}=e,i=!n.canConfigureCollection&&!n.canConfigureBlock;return(0,P.jsx)(M().A,{icon:c().gearIcon,showChevron:!0,disabled:i,title:(0,P.jsx)(u().sA,{...I().Ic.advancedSettings}),onClick:()=>{h().a2({collectionSettingsStore:t,item:{type:"relationFeaturesAdvancedSettings",feature:o}})}})}function D(e){const{feature:t,handleAddRelation:o,databaseType:n,permissionScopes:i}=e,r=(0,l().IS)((e=>({button:{width:"100%"},buttonWrap:{margin:"0px 12px 4px 12px"}})),[]);if(!i.canConfigureBlock||!i.canConfigureCollection)return null;const s=(0,I().vP)({feature:t,databaseType:n});return(0,P.jsx)(A().A,{disableMobileBorders:!0,children:(0,P.jsx)("div",{style:r.buttonWrap,children:(0,P.jsx)(j().A,{style:r.button,onClick:o,size:"lg",children:(0,P.jsx)(u().sA,{...s})})})})}function K(e){const{feature:t,permissionScopes:o,propertyName:n,relationPropertyId:r,inversePropertyName:s,collectionContextStore:a,collectionSettingsStore:c,handleDefaultPropertySelect:p,databaseType:g,clearCollectionViewSubitemDisplayMode:S}=e,v=(0,i().v3)(),b=(0,l().IS)((e=>({modalPropertyName:{color:e.darkTextColor,fontWeight:m().Wy.semibold}})),[]);if(!(o.canConfigureCollection&&o.canConfigureBlock&&n&&s))return null;const w=(0,I().Pf)({feature:t,databaseType:g}),j=(0,I().Ew)({feature:t,databaseType:g}),A={label:(0,P.jsx)(u().sA,{...I().Ic.turnOff}),color:"red",onAccept:async e=>{r&&(null!=e&&e.delete&&await async function(e){const{environment:t,collectionContextStore:o,propertyId:n,feature:i}=e,r=o.normalizedSchemaStore.state,l=o.collectionStore();if(!l)return;await C().createAndCommitAsync({environment:t,userAction:"CollectionSettingsViewRelationFeatures.handleTurnOffFeatureAndDeleteAccept",waitForServerCommit:!1,perform:e=>y().PF({environment:t,collectionStore:l,schema:r,property:n,transaction:e})});const s=r[n];s&&(0,f().i)({environment:t,collectionContextStore:o,property_type:s.type,from:i,property:n})}({environment:v,propertyId:r,collectionContextStore:a,feature:t}),p(void 0),null==S||S(),h().R8({collectionSettingsStore:c,item:{type:"main"}}))}};return(0,P.jsx)(M().A,{icon:d().trashIcon,title:(0,P.jsx)(u().sA,{...w}),isRed:!0,onClick:()=>{x().ui({selectionItems:[{key:"delete",text:(0,P.jsx)(u().sA,{...I().Ic.removePropertiesTitle}),description:(0,P.jsx)(u().sA,{...I().Ic.removePropertiesDescription,values:{span:e=>(0,P.jsx)("span",{style:b.modalPropertyName,children:e}),property:n,inverseProperty:s}}),preSelected:!0},{key:"keep",text:(0,P.jsx)(u().sA,{...I().Ic.keepPropertiesTitle})}],selectType:"radio",selectAlignXAxis:"right",message:(0,P.jsx)(u().sA,{...j}),showCancel:!0,keepFocus:!0,items:[A]})}})}function O(e){const{currentValue:t,onChange:o,disabled:n,databaseType:i}=e;return(0,P.jsx)(_().A,{title:(0,P.jsx)(u().sA,{...I().Ic.avoidWeekendsSwitcherTitle}),caption:(0,P.jsx)(u().sA,{...(0,I().nV)(i)}),shouldWrapCaption:!0,shouldWrapTitle:!0,focused:!1,on:t,disabled:n,disabledFeedback:!0,onClick:()=>o(!t)})}function L(e){const{currentMode:t,onModeChange:o,disabled:n,databaseType:i}=e,r=(0,l().IS)((e=>({wrap:{display:"flex",flexDirection:"column",rowGap:8,marginLeft:12,marginRight:12}})),[]);return(0,P.jsx)("div",{style:r.wrap,children:[...a().OY,void 0].map((e=>(0,P.jsx)(z,{dateShiftingMode:e,databaseType:i,onClick:()=>o(e),active:e===t,disabled:n},e??"none")))})}function z(e){const{dateShiftingMode:t,onClick:o,active:n,disabled:r,databaseType:s}=e,a=(0,i().Y0)(),c=(0,l().IS)((e=>({buttonStyles:{fontSize:a.isMobile?m().J.UISmall.mobile:m().J.UISmall.desktop,fontWeight:m().Wy.medium,borderRadius:6,width:"100%",padding:"8px 8px",boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.darkTextColor,fill:e.text.secondary,...n&&{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor,fill:e.blueColor},...r&&{opacity:.65}},icon:{width:20,height:20,marginRight:6},buttonContentWrap:{display:"flex",alignItems:"center"}})),[n,a,r]),d=(0,I().Zt)({dateShiftingMode:t,databaseType:s}),p=(0,I().mo)(t);return(0,P.jsx)(w().A,{style:c.buttonStyles,onClick:o,disabled:r,children:(0,P.jsxs)("div",{style:c.buttonContentWrap,children:[(0,P.jsx)("div",{children:p(c.icon)}),(0,P.jsx)("div",{children:(0,P.jsx)(u().sA,{...d})})]})})}function N(e){const{environment:t,newConfig:o,collectionStore:n,transaction:i,intl:r}=e;let l;if((0,g().O9)(o.configWithoutDates))if(o.datePropertyId)l={...o.configWithoutDates,date_property:o.datePropertyId,end_date_property:o.endDatePropertyId};else{const e=(0,p().Ay)(),s={name:r.formatMessage(I().Ic.newDateProperty),type:"date"};(0,b().F)({environment:t,collectionStore:n,update:{[e]:s},transaction:i}),l={...o.configWithoutDates,date_property:e,end_date_property:void 0}}v().zv({store:n.getFormatStore(),data:{dependency_date_shifting_config:l??null},transaction:i})}function U(e){const{viewType:t,feature:o}=e;return"timeline_arrows_by"===o?"timeline"===t:"subitem"===o||void(0,g().HB)(o)}},943919:(e,t,o)=>{o.d(t,{o:()=>i});var n=()=>o(896628);function i(e){const{icon:t,collectionViewStore:o,transaction:i}=e;n().zA({stores:[o],update:{collection_view_icon:t},transaction:i})}},959733:(e,t,o)=>{o.d(t,{g:()=>I});var n=o(296540),i=()=>o(56366),r=()=>o(31503),l=()=>o(970013),s=()=>o(465741),a=()=>o(852353),c=()=>o(937199),d=()=>o(959013),u=()=>o(859428),p=()=>o(103448),g=()=>o(175116),m=()=>o(962730),S=()=>o(478573),f=()=>o(484714),y=()=>o(543906),h=()=>o(235191),x=()=>o(495262),v=()=>o(751156),C=()=>o(409198),b=()=>o(897119),w=()=>o(525432),j=o(474848);function A(e){var t;const{open:o,originRef:r,settingsViewToOpen:l,propertyType:s,isPropertyEditComplete:d,onPropertyEditComplete:u,onDismiss:p,rollbackIfEditIncomplete:g,collectionContextStore:S,collectionSettingsStore:A}=e,_=null===(t=r.current)||void 0===t?void 0:t.getBoundingClientRect(),I=(0,f().v3)(),{collectionStore:M}=(0,c().bi)(),[k,T]=(0,n.useState)(null),[P,B]=(0,n.useState)(!1),[V,F]=(0,n.useState)(null);(0,y().A)((()=>{const e=`CollectionPropertySettingsPopup.createNewProperty.${s}.${Date.now()}`,{performResult:t}=v().createAndCommit({userAction:"CollectionPropertySettingsPopup.createNewProperty",environment:I,canUndo:!0,undoCheckpoint:e,perform:e=>h().IL({environment:I,collectionStore:M,collectionViewArgs:void 0,propertyName:a().dC[s],propertyType:s,transaction:e})});A.update((e=>({...e,stack:[{...l,property:t}],open:!0}))),T(t),F(e)}),o);const E=(0,i().K8)((()=>{if(!k)return!1;const e=M.getSchema()[k];return!!e&&d(e)}),[M,d,k]);(0,n.useEffect)((()=>{E&&k&&!P&&(u(k),B(!0))}),[E,u,k,P]);const{setModuleSelection:R}=(0,c().LH)();return k?(0,j.jsx)(b().Ay,{open:o,popupType:b().nl.Popup,render:()=>(0,j.jsx)(C().CollectionSettings,{context:w().Bd.TopbarFilterPopup,collectionContextStore:S,collectionSettingsStore:A,hideDesktopHeader:!0}),originRect:_,alignmentToOrigin:m().C.Center,placementToOrigin:m().W.Bottom,originGap:4,onDismiss:()=>{!E&&g&&(V&&x().JM({environment:I,namedRevisionId:V}),R(void 0)),p()}}):null}function _(e){const{icon:t,name:o,disabled:i,tooltip:r,propertySettingsPopup:s,propertyType:a,...c}=e,{image:f,caption:y}=r||{},h=(0,g().ET)(),x=n.useRef(null),v=n.useCallback((e=>(0,j.jsx)("div",{style:{width:"100%"},...e,children:(0,j.jsx)(S().A,{icon:t,name:o,disabled:i,...c,ref:x})})),[i,t,o,c]);let C;return!f&&y?C=(0,j.jsx)(u().A,{textWrap:!0,placement:m().W.Left,render:v,renderTooltip:()=>(0,j.jsx)(d().sA,{...y})}):f&&y&&(C=(0,j.jsx)(u().A,{placement:m().W.Left,render:v,renderTooltip:()=>(0,j.jsx)(p().A,{caption:(0,j.jsx)(d().sA,{...y}),imageURL:f,imageWidth:140,imageHeight:100,imageContainerStyle:{backgroundColor:"white"}})})),(0,j.jsxs)(j.Fragment,{children:[C||(0,j.jsx)(v,{}),s&&s.open&&(0,j.jsx)(A,{originRef:x,propertyType:(0,l().v2)(a),collectionContextStore:h,collectionSettingsStore:h.settingsStore,...s})]})}function I(e){let{actionHandler:t,renderIcon:o,tooltip:d,disabled:u,propertySettingsPopupProps:p}=e;const[g,m]=n.useState(null),{layoutStore:S}=(0,c().LH)(),f=(0,i().K8)((()=>S.getLayoutType()),[S]);return(0,n.useCallback)((e=>({key:e,keywords:[a().dC[e]],render:t=>{let{ref:n,...i}=t;const c=null==p?void 0:p(e);let S=a().dC[e];const y=(0,l().v2)(e);return"form"===f&&(0,r().XO)(y)&&"select"!==y&&(S=s().mY[y]),(0,j.jsx)(_,{icon:o(e),name:S,disabled:null==u?void 0:u(e),propertyType:e,propertySettingsPopup:c?{...c,open:g===e,onDismiss:()=>{m(null)}}:void 0,tooltip:null==d?void 0:d(e),ref:n,...i})},action:()=>{null!=p&&p(e)?m(e):t(e)}})),[t,u,f,g,p,o,d])}}}]);