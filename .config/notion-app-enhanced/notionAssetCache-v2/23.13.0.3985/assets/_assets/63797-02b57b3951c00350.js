"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[63797],{33376:(e,t,o)=>{o.d(t,{E:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.37 3.09 15.2 12.78",svg:(0,o(474848).jsx)("path",{d:"M3.5 3.099c-.621 0-1.125.504-1.125 1.125v9.026A2.625 2.625 0 0 0 5 15.875h9.944a2.625 2.625 0 0 0 2.625-2.625V7.495a2.625 2.625 0 0 0-2.625-2.625H9.067L7.962 3.513A1.13 1.13 0 0 0 7.09 3.1zm.125 4.465V4.349H7.03l1.105 1.356c.214.263.534.415.872.415h5.937c.76 0 1.375.616 1.375 1.375v.069zm0 1.1h12.694v4.586c0 .76-.616 1.375-1.375 1.375H5c-.76 0-1.375-.616-1.375-1.375z"})},i=(0,o(340498).wt)("folder",n)},124749:(e,t,o)=>{o.d(t,{$:()=>r});var n=()=>o(56366);const i=new(o(496506).ComputedStore)((()=>o(765957).default.state.currentUserStore),{debugName:"AppStoreCurrentUserStore"});function r(){return(0,n().O$)(i)}},132409:(e,t,o)=>{o.d(t,{A:()=>c});o(16280),o(581454),o(296540);var n=()=>o(56366),i=()=>o(651124),r=()=>o(436696),l=()=>o(896628),a=()=>o(751156),s=o(474848);const c=function(e){let{collectionContextStore:t}=e;const c=(0,o(484714).v3)(),p=(0,n().O$)(t.normalizedFormatStore),u=(0,n().O$)(t.isFullScreenStore),S=(0,n().K8)((()=>d(t)),[t]),g=(0,n().K8)((()=>function(e){const t=e.normalizedFormatStore.state;return(0,i().i3)({limit:t.inline_collection_first_load_limit,isGrouped:Boolean(t.collection_group_by),viewType:d(e)})}(t)),[t]),m=(0,n().O$)(t.permissionScopesStore),y=(0,o(963589).X)("db_ux_chrome");return p.collection_group_by||"feed"===S||!u&&"calendar"!==S?(0,s.jsx)(o(828973).A,{title:(0,s.jsx)(o(959013).sA,{defaultMessage:"Load limit",id:"database.viewSettings.layoutTab.firstLoadLimitSetting"}),selectedKey:g,popupStyle:{minWidth:190},options:i().X9.map((e=>({key:e,type:"button",title:e.limit}))),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(!n)return;a().createAndCommit({userAction:"CollectionSettingsFirstLoadLimit.handleFirstLoadLimitChange",environment:t,canUndo:!0,perform:t=>{l().zA({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),o.groupsStore.resetAllLimits(),(0,r().X)({environment:t,collectionContextStore:o,action:"set_first_load_limit"})}(e,c,t),disabled:!m.canConfigureBlock,icon:y?void 0:o(655923).v}):null};function d(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}},174638:(e,t,o)=>{o.d(t,{A:()=>ae,u:()=>le});o(898992),o(354520),o(672577),o(581454);var n=o.n(o(844751)),i=o(296540),r=()=>o(484714),l=()=>o(56366),a=()=>o(401497),s=()=>o(443239),c=()=>o(970013),d=()=>o(713998),p=()=>o(743176),u=()=>o(651124),S=()=>o(906380),g=()=>o(514608),m=()=>o(288739),y=()=>o(617668),f=()=>o(236262),v=()=>o(340498),h=()=>o(959013),x=()=>o(496603),b=()=>o(534177),w=()=>o(284371),C=()=>o(436696),_=()=>o(686526),A=()=>o(896628),j=()=>o(751156),T=()=>o(654062),k=()=>o(736767),M=()=>o(551882),B=()=>o(493823),V=()=>o(760217),K=()=>o(439264),P=()=>o(57232),O=()=>o(348501),I=()=>o(285790),F=()=>o(939740),z=()=>o(8980),$=()=>o(89924),E=()=>o(574036),L=()=>o(859428),D=()=>o(987017),R=()=>o(780054),X=()=>o(525432),U=()=>o(673730),W=()=>o(553965),H=()=>o(836251),G=()=>o(963589),N=()=>o(696746),Q=()=>o(962730),Y=()=>o(227440),Z=()=>o(430171),q=()=>o(647702),J=()=>o(334684),ee=()=>o(95441),te=()=>o(497222),oe=o(474848);const ne=(0,h().YK)({inputPlaceholder:{defaultMessage:"Search for a propertyâ€¦",id:"database.viewSettings.propertiesTab.inputPlaceholder"},togglePropertyVisibilityAriaLabel:{defaultMessage:"Toggle property visibility",id:"database.viewSettings.propertiesTab.togglePropertyVisibilityAriaLabel"}}),ie=o(757695).Store.createClass("",{name:"InputStore"});function re(e){switch(e){case"editPropertiesAndVisibility":return{disableDatabaseEditing:!1,disableViewEditing:!1};case"editPropertiesOnly":return{disableDatabaseEditing:!1,disableViewEditing:!0};case"propertyVisibilityOnly":return{disableDatabaseEditing:!0,disableViewEditing:!1};default:(0,b().HB)(e)}}function le(e){const{collectionContextStore:t,onClick:o}=e,n=(0,r().v3)(),i=(0,l().O$)(t.normalizedFormatStore),a=Boolean(i.timeline_show_table),s=(0,l().O$)(t.permissionScopesStore);return(0,oe.jsx)(E().A,{title:(0,oe.jsx)(h().sA,{defaultMessage:"Show table",id:"database.viewSettings.propertiesTab.showTable"}),on:a,focused:!1,onClick:()=>{const e=t.collectionViewStore();e&&(j().createAndCommit({userAction:"CollectionSettingsViewProperties.TimelineShowTableSwitcher",environment:n,canUndo:!0,perform:t=>{A().zA({stores:[e],update:{timeline_show_table:!a,timeline_table_properties:[{property:"name",visible:!0}]},transaction:t})}}),null==o||o(),(0,C().X)({environment:n,collectionContextStore:t,action:"timeline_toggle_show_table"}))},disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})}const ae=function(e){let{collectionContextStore:t,timelineViewTab:n,collectionSettingsStore:i,propertiesMenuType:a}=e;const s=(0,r().v3)(),c=(0,l().uB)(void 0,o(970585).A),d=(0,l().uB)(void 0,ie),p=(0,l().O$)(d),u=(0,l().K8)((()=>(0,X().jx)({collectionContextStore:t})),[t]),S=(0,l().K8)((()=>(0,X().ZI)({timelineViewTab:n,collectionContextStore:t})),[n,t]),g=(0,l().K8)((()=>(0,o(690471).DG)({environment:s,isFullScreen:t.isFullScreenStore.state,isRootChild:t.isRootChildStore.state})),[s,t]),m=(0,l().O$)(t.isInHomeWidgetStore),y=(0,G().X)("db_ux_chrome"),{disableDatabaseEditing:f,disableViewEditing:v}=re(a);return(0,oe.jsxs)(o(735695).Ay,{collectionSettingsStore:i,title:(0,oe.jsx)(h().sA,{defaultMessage:"Properties",id:"database.viewSettings.propertiesTab.title"}),header:(0,oe.jsx)($().A,{children:(0,oe.jsx)(o(419357).Ay,{focusInitial:!R().A.isMobile,value:p,showClearButton:!0,onChange:e=>{d.setState(e.target.value),c.setState({...c.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:o(972435).A.formatMessage(ne.inputPlaceholder)})}),footer:!f&&(0,oe.jsx)(pe,{collectionContextStore:t,collectionSettingsStore:i,propertiesMenuType:a,timelineViewTab:n}),children:[!v&&"timeline"===u&&g&&(0,oe.jsx)(xe,{collectionSettingsStore:i,collectionContextStore:t,timelineViewTab:n,inputStore:d,propertiesMenuType:a}),S&&(0,oe.jsx)(Ce,{collectionContextStore:t,collectionSettingsStore:i,inputStore:d,menuListStore:c,formatKey:S,propertiesMenuType:a}),!y&&!m&&!f&&(0,oe.jsx)($().A,{children:(0,oe.jsx)(ue,{collectionContextStore:t,collectionSettingsStore:i,timelineViewTab:n})})]})};function se(e){let{viewType:t}=e;return"table"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Shown in table",id:"database.viewSettings.propertiesTab.shownInTableTitle"}):"timeline"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Shown in timeline",id:"database.viewSettings.propertiesTab.shownInTimelineTitle"}):"board"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Shown in board",id:"database.viewSettings.propertiesTab.shownInBoardTitle"}):"list"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Shown in list",id:"database.viewSettings.propertiesTab.shownInListTitle"}):"gallery"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Shown in gallery",id:"database.viewSettings.propertiesTab.shownInGalleryTitle"}):"calendar"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Shown in calendar",id:"database.viewSettings.propertiesTab.shownInCalendarTitle"}):"page"===t||"chart"===t||"form_editor"===t?null:"feed"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Shown in feed",id:"database.viewSettings.propertiesTab.shownInFeedTitle"}):"map"===t||"chat"===t||"custom"===t?null:void(0,b().HB)(t)}function ce(e){let{viewType:t}=e;return"table"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Hidden in table",id:"database.viewSettings.propertiesTab.hiddenInTableTitle"}):"timeline"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Hidden in timeline",id:"database.viewSettings.propertiesTab.hiddenInTimelineTitle"}):"board"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Hidden in board",id:"database.viewSettings.propertiesTab.hiddenInBoardTitle"}):"list"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Hidden in list",id:"database.viewSettings.propertiesTab.hiddenInListTitle"}):"gallery"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Hidden in gallery",id:"database.viewSettings.propertiesTab.hiddenInGalleryTitle"}):"calendar"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Hidden in calendar",id:"database.viewSettings.propertiesTab.hiddenInCalendarTitle"}):"page"===t||"chart"===t||"form_editor"===t?null:"feed"===t?(0,oe.jsx)(h().sA,{defaultMessage:"Hidden in feed",id:"database.viewSettings.propertiesTab.hiddenInFeedTitle"}):"map"===t||"chat"===t||"custom"===t?null:void(0,b().HB)(t)}function de(e,t,o){const{formatKey:n,visibility:i}=e,r=t.collectionViewStore();if(!r)return;const l=t.normalizedFormatStore.state[n]||[];let a=l.filter((e=>Boolean(e.visible))),s=l.filter((e=>!e.visible));me.includes(n)&&(a=ye(a),s=ye(s));const c=[...a.map((e=>({...e,visible:i}))),...s.map((e=>({...e,visible:i})))];j().createAndCommit({userAction:"CollectionSettingsViewProperties.setAllPropertiesVisibility",environment:o,canUndo:!0,perform:e=>{A().zA({stores:[r],update:{[n]:c},transaction:e})}})}function pe(e){let{collectionContextStore:t,collectionSettingsStore:o,propertiesMenuType:n,timelineViewTab:a}=e;const s=(0,r().v3)(),c=(0,l().O$)(t.permissionScopesStore),d=(0,l().K8)((()=>"timeline"===(0,X().jx)({collectionContextStore:t})&&"table"===a&&!(0,X().ZF)({collectionContextStore:t})),[t,a]),p=(0,l().K8)((()=>{const e=t.collectionViewBlockStore();return e&&(0,N().Nh)(e.id)}),[t]),u=c.canConfigureCollection&&!d&&!c.isExternallyImportedAndSyncedCollection&&!p,S=(0,i.useCallback)((()=>{(0,Z().c)({environment:s,collectionContextStore:t})}),[s,t]),g=(0,G().X)("db_ux_chrome"),m=(0,l().O$)(t.isInHomeWidgetStore),{disableDatabaseEditing:f}=re(n);return(0,oe.jsxs)($().A,{topBorder:!0,extraPadding:g,children:[u&&(0,oe.jsx)(te().A,{icon:y().plusIcon,title:(0,oe.jsx)(h().sA,{id:"database.viewSettings.propertiesTab.newProperty",defaultMessage:"New property"}),isGray:!0,onClick:S}),g&&!m&&!f&&(0,oe.jsx)(ue,{collectionContextStore:t,collectionSettingsStore:o,timelineViewTab:a}),(0,oe.jsx)(ee().A,{href:(0,H().xS)("guides.databaseProperties"),title:(0,oe.jsx)(h().sA,{defaultMessage:"Learn about properties",id:"database.viewSettings.propertiesTab.learnMoreButton.title"}),analyticsFrom:"view_settings_properties"})]})}function ue(e){let{collectionContextStore:t,collectionSettingsStore:o,timelineViewTab:n}=e;const i=(0,r().v3)(),a=(0,l().O$)(t.normalizedDeletedSchemaStore),s=Object.keys(a).length,c=(0,l().O$)(t.permissionScopesStore),d=(0,G().X)("db_ux_chrome");return c.canConfigureCollection&&s>0?(0,oe.jsx)(te().A,{icon:f().trashIcon,title:d?(0,oe.jsx)(h().sA,{id:"database.viewSettings.propertiesTab.recentlyDeleted",defaultMessage:"Recently deleted"}):(0,oe.jsx)(h().sA,{id:"database.viewSettings.propertiesTab.deletedProperties",defaultMessage:"Deleted properties"}),isGray:!0,onClick:()=>function(e,t,o,n){o.collectionStore()&&((0,C().X)({environment:e,collectionContextStore:o,action:"click_deleted_properties"}),_().a2({collectionSettingsStore:t,item:{type:"deletedProperties",timelineViewTab:n}}))}(i,o,t,n),right:s,showChevron:!0}):null}function Se(e,t,o){const n=t.state,i=e.permissionScopesStore.state,{disableViewEditing:r}=re(o);return!r&&!R().A.isMobile&&i.canConfigureBlock&&!n}function ge(e){e.reset()}const me=["board_properties","gallery_properties","calendar_properties"];function ye(e){const t=e.find((e=>"title"===e.property));return t?[t,...e.filter((e=>"title"!==e.property))]:e}const fe=12;function ve(e,t,o,n,i,r,l,a,y,f){var x;const{formatKey:b,propertyFormat:A}=e,k=n.permissionScopesStore.state,B=!A.visible,K=n.normalizedSchemaStore.state,F=(0,d()._g)({schema:K,property:A.property}),{disableDatabaseEditing:$,disableViewEditing:E}=re(y),D=Se(n,l,y)&&("title"!==A.property||!me.includes(b)),R=!E&&("title"!==A.property||function(e,t){const o=t.normalizedFormatStore.state,n=(0,X().jx)({collectionContextStore:t});return"board"===n?(0,u().zl)(o.board_cover):"gallery"===n?(0,u().zl)(o.gallery_cover):"timeline"===n&&("timeline_table_properties"===e||(0,u().w3)(Boolean(o.timeline_show_table),o.timeline_table_properties||[]))}(b,n));let H=!$&&(0,q().K)({collectionContextStore:n,permissionScopes:k})&&!k.isExternallyImportedAndSyncedCollection;if(k.isSyncedCollection&&((0,s().u)(A.property)||(0,c().cC)(A.property))&&(H=!1),!F)return;const G=!(f&&(0,J().$)({propertyType:null==F?void 0:F.type,propertySchema:F,allowAIProperty:!1})),N=!G||(null===(x=F.description)||void 0===x?void 0:x.length);return{key:A.property,render:e=>(0,oe.jsx)(L().A,{disableTooltip:!N,renderTooltip:e=>(0,oe.jsx)("div",{...e,style:U().Q$,children:G?(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)("div",{children:F.name}),(0,oe.jsx)("div",{style:{color:o.text.contrastSecondary},children:F.description})]}):(0,oe.jsx)(h().sA,{id:"collectionSettings.editProperty.offlineTooltip",defaultMessage:"Go online to edit property"})}),placement:Q().W.Left,render:r=>(0,oe.jsx)(V().A,{...(0,W().A)(e,r),titleStyle:D&&$?{marginLeft:-4}:void 0,title:(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[D&&($?(0,oe.jsx)(O().A,{iconStyle:{width:fe,height:fe},style:{marginRight:6},disableTooltip:!0}):(0,oe.jsx)(P().A,{iconSize:fe,style:{marginRight:6}})),(0,oe.jsx)(p().zB,{type:F.type,icon:F.icon,size:16,theme:o,style:{fill:o.icon.primary,marginLeft:2},isDefaultNoticonEnabled:a}),(0,oe.jsx)("span",{style:{marginLeft:D?8:10,...w().RC},children:F.name}),(0,c().$M)(F)&&(0,c().om)(F)&&(0,oe.jsx)(M().A,{})]}),right:(0,oe.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[!E&&(0,oe.jsx)(I().A,{icon:B?m().M:g().eyeFillSmallIcon,iconStyle:{width:v().Ev.sm,height:v().Ev.sm},color:B?"secondary":"primary",onClick:()=>{!function(e,t,o,n){var i;const{formatKey:r,propertyFormat:l}=e,a=o.collectionViewStore();if(!a)return;const s=o.normalizedFormatStore.state,c=(s[r]||[]).filter((e=>e.property!==l.property)),d={...l,visible:!l.visible},p=c.filter((e=>e.visible)),u=c.filter((e=>!e.visible));let S=[];S=me.includes(r)?!0===d.visible?[...ye([...p,d]),...ye(u)]:[...ye(p),...ye([d,...u])]:[...p,d,...u];const g={...s,[r]:S};j().createAndCommit({userAction:"CollectionSettingsViewProperties.handleTogglePropertyVisibility",environment:t,canUndo:!0,perform:e=>{(0,T().F)({collectionViewStore:a,update:{format:g},transaction:e})}}),(0,C().X)({environment:t,collectionContextStore:o,action:"toggle_property_visibility",original_view_type:a.getType(),property_type:null===(i=a.getCollectionStore())||void 0===i||null===(i=i.getSchema()[d.property])||void 0===i?void 0:i.type}),ge(n)}({formatKey:b,propertyFormat:A},t,n,l)},ariaLabel:i.formatMessage(ne.togglePropertyVisibilityAriaLabel),disabled:!R||!k.canConfigureBlock}),H&&(0,oe.jsx)(z().I,{icon:S().arrowChevronSingleRightSmallIcon,size:"sm",color:"tertiary",style:{marginLeft:5}})]}),disabled:!(H&&G),disabledFeedback:!G})}),action:()=>{H&&G&&function(e,t,o,n){var i,r,l;const a=(null===(i=n.collectionStore())||void 0===i?void 0:i.getSchema())||n.normalizedSchemaStore.state||{},{formatKey:s,propertyFormat:c}=e;(0,C().X)({environment:t,collectionContextStore:n,action:"click_property",original_view_type:null==n||null===(r=n.collectionViewStore())||void 0===r?void 0:r.getType(),property_type:null===(l=a[c.property])||void 0===l?void 0:l.type}),_().a2({collectionSettingsStore:o,item:{type:"property",formatKey:s,property:c.property}})}({formatKey:b,propertyFormat:A},t,r,n)}}}function he(e,t,o,n,i,r,l,a,s,c){const{formatKey:d,properties:p}=e;return x().oE(p.map((e=>ve({formatKey:d,propertyFormat:e},t,o,n,i,r,l,a,s,c))))}function xe(e){let{collectionSettingsStore:t,collectionContextStore:o,timelineViewTab:n,inputStore:l,propertiesMenuType:a}=e;const s=(0,r().v3)(),c=(0,i.useCallback)((()=>function(e){ge(e)}(l)),[l]),d=(0,i.useCallback)((e=>function(e,t,o,n,i,r){(0,C().X)({environment:t,collectionContextStore:n,action:0===e?"click_properties_tab_timeline":"click_properties_tab_table"}),_().dP({collectionSettingsStore:o,item:{type:"propertyVisibilityOnly"===r?"propertyVisibility":"properties",timelineViewTab:0===e?"timeline":"table"}}),ge(i)}(e,s,t,o,l,a)),[s,t,o,l,a]),p=(0,G().X)("db_ux_chrome"),u="timeline"===n?0:1;return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(D().Ay,{tabs:[(0,oe.jsx)(h().sA,{defaultMessage:"Timeline",id:"database.viewSettings.propertiesTab.timelineProperties"},"database.viewSettings.propertiesTab.timelineProperties"),(0,oe.jsx)(h().sA,{defaultMessage:"Table",id:"database.viewSettings.propertiesTab.tableProperties"},"database.viewSettings.propertiesTab.tableProperties")],selectedIndex:u,onChange:d}),"table"===n&&(0,oe.jsx)($().A,{extraPadding:p,children:(0,oe.jsx)(le,{collectionContextStore:o,onClick:c})})]})}function be(e){const t=(0,r().v3)(),{props:o,formatKey:n,children:i,collectionContextStore:a,inputStore:s}=e,c=(0,l().O$)(a.permissionScopesStore),d=(0,l().O$)(s),p=(0,l().K8)((()=>"timeline_table_properties"===n?"table":(0,X().jx)({collectionContextStore:a})),[a,n]);return(0,oe.jsx)($().A,{...o,noTextOverflow:!0,title:(0,oe.jsx)(ce,{viewType:p}),desktopTitleStyle:{height:19,padding:"0 4px"},mobileTitleStyle:{fontSize:14,paddingLeft:0,paddingRight:0},right:!d&&c.canConfigureBlock&&(0,oe.jsx)(B().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){(0,C().X)({environment:t,collectionContextStore:o,action:"click_show_all_properties"}),de({formatKey:e,visibility:!0},o,t)}(n,t,a),children:(0,oe.jsx)(h().sA,{id:"database.viewSettings.propertiesTab.showAllProperties",defaultMessage:"Show all"})}),style:{width:"100%",paddingBottom:0},children:i})}function we(e){const t=(0,r().v3)(),{formatKey:o,visibleProperties:n,hiddenProperties:i,children:a,collectionContextStore:s,inputStore:c,menuListStore:d,propertiesMenuType:p}=e,u=x().oE([...n.map((e=>"title"===e.property&&me.includes(o)?{key:e.property,draggable:!1}:e.property)),n.length>0&&i.length>0&&{key:"group-header-hidden-property",draggable:!1},...i.map((e=>"title"===e.property&&me.includes(o)?{key:e.property,draggable:!1}:e.property))]);return(0,l().K8)((()=>Se(s,c,p)),[s,c,p])?(0,oe.jsx)(K().Ay,{direction:"vertical",keys:u,renderKey:(e,t)=>a[t],onDrop:(e,n)=>{!function(e,t,o,n){const{formatKey:i,newPropertyKeys:r}=e,l=o.collectionViewStore();if(!l)return;const a=o.normalizedFormatStore.state[i]||[],s=r.indexOf("group-header-hidden-property");let c=x().oE(r.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=a.find((t=>t.property===e));if(o)return s>=0?{...o,visible:Boolean(t<s)}:o}))),d=a.filter((e=>!r.includes(e.property)));me.includes(i)&&(c=ye(c),d=ye(d));const p=[...c,...d];j().createAndCommit({userAction:"CollectionSettingsViewProperties.handlePropertyReorder",environment:t,canUndo:!0,perform:e=>{A().zA({stores:[l],update:{[i]:p},transaction:e})}}),(0,C().X)({environment:t,collectionContextStore:o,action:"reorder_properties",original_view_type:l.getType()}),n.reset()}({formatKey:o,newPropertyKeys:e},t,s,d)}}):(0,oe.jsx)(oe.Fragment,{children:a})}function Ce(e){let{formatKey:t,collectionContextStore:o,collectionSettingsStore:i,inputStore:s,menuListStore:c,propertiesMenuType:p}=e;const u=(0,a().DP)(),S=(0,r().v3)(),g=(0,h().tz)(),m=(0,G().X)("nds_default_property_noticon"),y=(0,l().O$)(o.permissionScopesStore),f=(0,l().O$)(o.normalizedFormatStore),v=(0,l().O$)(o.normalizedSchemaStore),b=(0,l().O$)(s),w=!(0,l().O$)(Y().e);let _=f[t]||[];if(b){let e=_.map((e=>{const t=(0,d()._g)({schema:v,property:e.property});return null==t?void 0:t.name}));e=n().filter(b,e).map((e=>{let{original:t}=e;return t})),_=_.filter((t=>{const o=v[t.property];return o&&o.name&&e.includes(o.name)}))}const A=_.filter((e=>Boolean(e.visible))),j=_.filter((e=>!e.visible)),T=(0,l().K8)((()=>"timeline_table_properties"===t?"table":(0,X().jx)({collectionContextStore:o})),[o,t]),{disableViewEditing:M}=re(p),V=(0,l().K8)((()=>he({formatKey:t,properties:A},S,u,o,g,i,s,m,p,w)),[t,A,p,S,u,o,g,i,s,m,w]),K=(0,l().K8)((()=>he({formatKey:t,properties:j},S,u,o,g,i,s,m,p,w)),[t,j,p,S,u,o,g,i,s,m,w]),P=(0,G().X)("db_ux_chrome");return 0===_.length?(0,oe.jsx)($().A,{extraPadding:P,children:(0,oe.jsx)(k().A,{caption:(0,oe.jsx)(h().sA,{defaultMessage:"No results",id:"database.viewSettings.propertiesTab.noResults"})})}):(0,oe.jsx)(F().Ay,{type:F().Oh.Vertical,store:c,initialFocus:void 0,resetFocusOnMouseOut:!0,sections:x().oE([A.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,oe.jsx)($().A,{...e,extraPadding:P,noTextOverflow:!0,title:!M&&(0,oe.jsx)(se,{viewType:T}),desktopTitleStyle:{height:19},mobileTitleStyle:{fontSize:14},right:!b&&y.canConfigureBlock&&(0,oe.jsx)(B().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:()=>function(e,t,o){(0,C().X)({environment:t,collectionContextStore:o,action:"click_hide_all_properties"}),de({formatKey:e,visibility:!1},o,t)}(t,S,o),children:(0,oe.jsx)(h().sA,{id:"database.viewSettings.propertiesTab.hideAllProperties",defaultMessage:"Hide all"})}),children:(0,oe.jsx)(we,{collectionContextStore:o,inputStore:s,menuListStore:c,formatKey:t,visibleProperties:A,hiddenProperties:j,children:e.children,propertiesMenuType:p})}),items:x().oE([...V,M?void 0:j.length>0&&{key:"group-header-hidden-property",render:e=>(0,oe.jsx)(be,{collectionContextStore:o,inputStore:s,props:e,formatKey:t,children:(0,oe.jsx)(oe.Fragment,{})}),action:()=>{}},...K])},0===A.length&&j.length>0&&{key:"hidden_properties",render:e=>(0,oe.jsx)(be,{collectionContextStore:o,inputStore:s,props:e,formatKey:t,children:(0,oe.jsx)(we,{formatKey:t,visibleProperties:A,hiddenProperties:j,children:e.children,collectionContextStore:o,inputStore:s,menuListStore:c,propertiesMenuType:p})}),items:K}])})}},265504:(e,t,o)=>{o.d(t,{A:()=>ye,c:()=>me});o(16280),o(944114),o(898992),o(354520),o(672577),o(581454);var n=o(296540),i=()=>o(484714),r=()=>o(56366),l=()=>o(401497),a=()=>o(584262),s=()=>o(970013),c=()=>o(743176),d=()=>o(604995),p=()=>o(651124),u=()=>o(340498),S=()=>o(959013),g=()=>o(496603),m=()=>o(498212),y=()=>o(284371),f=()=>o(436696),v=()=>o(321775),h=()=>o(686526),x=()=>o(896628),b=()=>o(435009),w=()=>o(4319),C=()=>o(751156),_=()=>o(679924),A=()=>o(253021),j=()=>o(636740),T=()=>o(314660),k=()=>o(885110),M=()=>o(246826),B=()=>o(407031),V=()=>o(896461);var K=()=>o(519839),P=()=>o(704152),O=()=>o(406699),I=()=>o(623580),F=()=>o(928600),z=()=>o(147294),$=()=>o(897119),E=()=>o(89924),L=()=>o(574036),D=()=>o(612900),R=()=>o(780054),X=()=>o(186445),U=()=>o(476492),W=()=>o(972435);const H=(0,S().YK)({none:{defaultMessage:"None",id:"database.viewPropertiesMenu.coverFormat.none"},page_content:{defaultMessage:"Page content",id:"database.viewPropertiesMenu.coverFormat.pageContent"},page_cover:{defaultMessage:"Page cover",id:"database.viewPropertiesMenu.coverFormat.pageCover"}}),G=(0,S().YK)({small:{defaultMessage:"Small",id:"database.viewPropertiesMenu.coverSize.small"},medium:{defaultMessage:"Medium",id:"database.viewPropertiesMenu.coverSize.medium"},large:{defaultMessage:"Large",id:"database.viewPropertiesMenu.coverSize.large"}});function N(e){return e?"page_content"===e.type?W().A.formatMessage(H.page_content):"page_cover"===e.type?W().A.formatMessage(H.page_cover):void 0:W().A.formatMessage(H.none)}function Q(e){switch(e){case"small":return W().A.formatMessage(G.small);case"medium":return W().A.formatMessage(G.medium);case"large":return W().A.formatMessage(G.large)}}var Y=()=>o(10594),Z=()=>o(852353),q=()=>o(544073),J=()=>o(492414),ee=()=>o(722872),te=()=>o(805025),oe=()=>o(836251),ne=()=>o(963589),ie=()=>o(765957),re=()=>o(988950),le=()=>o(712505),ae=()=>o(95441),se=()=>o(497222),ce=()=>o(828973),de=()=>o(380468),pe=()=>o(35091),ue=o(474848);const Se=(0,S().YK)({week:{defaultMessage:"Week",id:"calendar.viewRanges.week"},month:{defaultMessage:"Month",id:"calendar.viewRanges.month"}}),ge=6;function me(e){const{currentViewType:t,theme:o}=e,n=t?q().C9[t]:void 0;return["side_peek","center_peek","full_page"].map((e=>({key:e,type:"button",title:(0,q().LA)(e),body:(0,ue.jsxs)(ue.Fragment,{children:[(0,q()._t)(e),n&&t&&e===n&&(0,ue.jsx)("div",{style:{marginTop:2,fontWeight:500,color:o.blueColor},children:(0,ue.jsx)(S().sA,{defaultMessage:"Default for {view}",id:"database.viewPropertiesMenu.peekMode.defaultForView",values:{view:Z().to[t]}})})]}),icon:(0,q().qg)(e)({width:u().Ev.default,height:u().Ev.default,fill:o.text.secondary})})))}const ye=(0,S().j4)((function(e){let{collectionContextStore:t,showDoneButton:a,collectionSettingsStore:c,onDoneClick:d,menuType:p}=e;const u=(0,l().DP)(),g=(0,i().v3)(),m=(0,ne().X)("db_ux_chrome"),y=(0,o(46986).Y4)(),v=(0,n.useCallback)((e=>(0,ue.jsx)($e,{collectionContextStore:t,viewType:e},`view-type-button-${e}`)),[t]),b=(0,r().O$)(t.normalizedQueryStore),w=(0,r().O$)(t.normalizedSchemaStore),_=(0,r().O$)(t.normalizedFormatStore),A=(0,r().O$)(t.isFullScreenStore),j=(0,r().O$)(t.isRootChildStore),T=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),k=(0,r().K8)((()=>fe(t)),[t]),M=(0,r().K8)((()=>Boolean(ve(t))),[t]),B="table"===k||"board"===k||"gallery"===k||"calendar"===k,V="table"===k,K=Object.keys(w).filter((e=>{const t=w[e];return t&&(0,s().$L)(t)})),P=Object.keys(w).filter((e=>{const t=w[e];return t&&(0,s().iB)(t)})),O="timeline"===k&&K.length>0,I=(0,r().K8)((()=>"timeline"===k&&K.length>1&&T&&!(0,X().sj)(T.id)),[k,K,T]),F="timeline"===k&&Boolean(null==b?void 0:b.timeline_by_end),z="calendar"===k&&K.length>0,$="map"===k&&P.length>0,D="calendar"===k,U="calendar"===k,W="board"===k,H="feed"===k,G=(0,r().K8)((()=>(0,o(690471).DG)({environment:g,isFullScreen:A,isRootChild:j})),[g,A,j]),N="timeline"===k&&Boolean(_.timeline_show_table)&&G,Q="timeline"===k&&G,Y=(0,r().K8)((()=>null==T?void 0:T.hasSingleSourceAndNoLinkedCollections()),[T]),Z=(0,r().K8)((()=>!("collectionTypedView"===t.contextType||t.isInHomeWidgetStore.state||A&&Y)),[t,A,Y]),q=(0,r().K8)((()=>{if(y){var e;return((null==T||null===(e=T.getCollectionViewIds())||void 0===e?void 0:e.length)??0)>1?(0,ue.jsx)(S().sA,{defaultMessage:"Show data source titles",id:"database.viewSettings.layoutTab.showDataSourceTitles.title"}):(0,ue.jsx)(S().sA,{defaultMessage:"Show data source title",id:"database.viewSettings.layoutTab.showDataSourceTitle.title"})}return(0,ue.jsx)(S().sA,{defaultMessage:"Show database title",id:"database.viewSettings.layoutTab.showDatabaseTitle.title"})}),[y,T]),J=(0,r().K8)((()=>!t.isInHomeWidgetStore.state&&"chart"!==k),[t.isInHomeWidgetStore,k]),ee="chart"!==k,ie=(0,r().O$)(t.permissionScopesStore),re=(0,r().O$)(t.shouldShowSourceStore),le="chart"===k,se="chart"===k,{isFeedOutsidePostsEnabled:ce}=(0,r().K8)((()=>({isFeedOutsidePostsEnabled:(0,o(578136).X)({disableExposureLogging:!0})})),[]),de=(0,ne().X)("place_property"),pe=(0,l().IS)((e=>({sourcePickerButton:{paddingTop:2,paddingBottom:2},sourcePickerSection:{marginTop:4},doneButtonSection:{paddingTop:0,marginBottom:y||m?te().Qm:0}})),[y,m]);if(!T)return null;const Se="page"===k,ge=Z||M||V||B||Se||O||F||I||z||U||D||Q||N||W||H||J||ee||$,me=["table","board","timeline","calendar","list","gallery","chart"];ce&&me.push("feed"),de&&me.push("map");const ye=me.length%3==0?3:4;return(0,ue.jsxs)(ue.Fragment,{children:[(0,ue.jsx)(E().A,{topBorder:!1,shouldShowBottomDivider:R().A.isMobile,children:(0,ue.jsx)("div",{style:{...R().A.isMobile?{background:u.contentBackground,width:"100%",padding:te().X1}:{width:"100%",paddingLeft:te().Qm,paddingRight:te().Qm,paddingTop:te().Qm}},children:(0,ue.jsx)("div",{style:{display:"grid",gridTemplateColumns:`repeat(${ye}, 1fr)`,gap:8},children:me.map(v)})})}),ge&&(0,ue.jsxs)(E().A,{extraPadding:!0,children:[Z&&(0,ue.jsx)(L().A,{title:q,focused:!1,on:re,onClick:()=>function(e,t,o){const n=t.collectionViewStore();if(!n)return;const i=!t.shouldShowSourceStore.state;C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleShowCollectionTitleClick",environment:e,canUndo:!0,perform:e=>{x().zA({stores:[n],update:{hide_linked_collection_name:!i},transaction:e});const r=t.collectionViewBlockStore();o&&r&&x().zA({stores:[r],update:{hide_inline_collection_name:!i},transaction:e})}}),(0,f().X)({environment:e,collectionContextStore:t,action:"toggle_show_collection_title"})}(g,t,m),disabled:!ie.canConfigureBlock,textWrapperStyle:{opacity:1}}),M&&(0,ue.jsx)(ze,{collectionContextStore:t}),V&&(0,ue.jsx)(Me,{collectionContextStore:t}),ee&&(0,ue.jsx)(Fe,{collectionContextStore:t}),B&&(0,ue.jsx)(Be,{collectionContextStore:t}),Se&&(0,ue.jsx)(be,{collectionContextStore:t}),O&&(0,ue.jsx)(we,{collectionContextStore:t}),F&&(0,ue.jsx)(Ce,{collectionContextStore:t}),I&&(0,ue.jsx)(Ve,{collectionContextStore:t}),z&&(0,ue.jsx)(_e,{collectionContextStore:t}),$&&(0,ue.jsx)(Ae,{collectionContextStore:t}),U&&(0,ue.jsx)(Ke,{collectionContextStore:t}),D&&(0,ue.jsx)(Pe,{collectionContextStore:t}),Q&&(0,ue.jsx)(o(174638).u,{collectionContextStore:t}),N&&(0,ue.jsx)(je,{collectionContextStore:t,collectionSettingsStore:c}),W&&(0,ue.jsx)(Te,{collectionContextStore:t,collectionSettingsStore:c}),H&&(0,ue.jsx)(Oe,{collectionContextStore:t,collectionSettingsStore:c}),J&&(0,ue.jsx)(Ie,{collectionContextStore:t}),m&&(0,ue.jsx)(o(132409).A,{collectionContextStore:t})]}),y&&"createView"===p&&(0,ue.jsx)(E().A,{extraPadding:!0,disableMobileBorders:!0,topBorder:!0,style:pe.sourcePickerSection,children:(0,ue.jsx)(o(542984).A,{forceShow:!0,buttonStyle:pe.sourcePickerButton,overrideOnClickBehavior:()=>{h().a2({collectionSettingsStore:c,item:{type:"linkToDatabase",existingCollectionStore:void 0}})},collectionContextStore:t,collectionSettingsStore:c})}),a&&(0,ue.jsx)(E().A,{extraPadding:!0,disableMobileBorders:!0,style:pe.doneButtonSection,children:(0,ue.jsx)(o(204063).A,{style:{display:"flex",margin:`0 ${te().Qm}px`},onClick:()=>{null==d||d(),function(e,t,o){h().R8({collectionSettingsStore:t,item:{type:"main"}}),(0,f().X)({environment:e,collectionContextStore:o,action:"click_create_view_done"})}(g,c,t)},children:se?(0,ue.jsx)(S().sA,{defaultMessage:"Edit chart",id:"database.viewSettings.createViewTab.editChartButton.title"}):(0,ue.jsx)(S().sA,{defaultMessage:"Done",id:"database.viewSettings.createViewTab.doneButton.title"})})}),le?(0,ue.jsx)(E().A,{extraPadding:!0,topBorder:!1,style:{paddingTop:0},children:(0,ue.jsx)(ae().A,{href:(0,oe().xS)("guides.charts"),title:(0,ue.jsx)(S().sA,{defaultMessage:"Learn about charts",id:"database.viewSettings.layoutTab.learnAboutCharts.title"}),analyticsFrom:"view_settings_layout"})}):m?void 0:(0,ue.jsx)(E().A,{extraPadding:!0,topBorder:!a,style:{...a&&{paddingTop:0}},children:(0,ue.jsx)(ae().A,{href:(0,oe().xS)("guides.databaseView"),title:(0,ue.jsx)(S().sA,{defaultMessage:"Learn about views",id:"database.viewSettings.layoutTab.learnMoreButton.title"}),analyticsFrom:"view_settings_layout"})})]})}));function fe(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function ve(e){return Z().Jx[fe(e)]}function he(e){return Z().wm[fe(e)]}function xe(e){return Z().dD[fe(e)]}function be(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,r().K8)((()=>t.collectionViewStore()),[t]);return n?(0,ue.jsx)("div",{style:{padding:5},children:(0,ue.jsx)(I().A,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{re().A.setState({pageId:e.target.value})},onSubmit:e=>{const t=re().A.state.pageId;t&&C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderPageViewSettings",environment:o,canUndo:!0,perform:e=>{x().zA({stores:[n],update:{page_pointer:{id:(0,m().G2)(t),spaceId:e.spaceId,table:"block"}},transaction:e})}})}})}):null}function we(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,i().WS)(),l=(0,r().K8)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by}),[t]),a=(0,r().K8)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),c=(0,r().O$)(t.permissionScopesStore),d=(0,r().O$)(t.normalizedSchemaStore),p=(0,r().K8)((()=>t.collectionViewStore()),[t]),u=(0,r().K8)((()=>t.collectionStore()),[t]),g=(0,r().K8)((()=>null==u?void 0:u.getSchema()),[u]),m=(0,r().K8)((()=>null==u?void 0:u.getFormat()),[u]);if(!(l&&p&&u&&m&&g))return null;const v=d[l];return v?(0,ue.jsx)(O().Ay,{popupType:n?$().nl.SlideUp:$().nl.Popup,alignmentToOrigin:O().yP.End,placementToOrigin:O().sx.Bottom,originGap:0,renderOrigin:e=>(0,ue.jsx)(se().A,{title:a?(0,ue.jsx)(S().sA,{defaultMessage:"Start date",id:"database.viewSettings.layoutTab.timelineStartDate.title"}):(0,ue.jsx)(S().sA,{defaultMessage:"Show timeline by",id:"database.viewSettings.layoutTab.showTimelineByProperty.title"}),disabled:!c.canConfigureBlock,showChevron:!0,right:(0,ue.jsx)("div",{style:y().RC,children:v.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let i;return i=n?{menuType:ee().gu.ActionSheet}:{menuType:ee().gu.Popup,width:300},(0,ue.jsx)(F().A,{...i,children:(0,ue.jsx)(de().A,{schema:g,format:m,currentProperty:l,getProperties:()=>Object.keys(d).filter((e=>{const t=d[e];return t&&(0,s().$L)(t)})),onAccept:n=>{n&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineBySetting",environment:o,canUndo:!0,perform:e=>{(0,T().f)({collectionViewStore:p,update:{timeline_by:n},transaction:e})}}),e.close(),(0,f().X)({environment:o,collectionContextStore:t,action:"update_timeline_by",original_view_type:void 0,property_type:v.type}))}})})}}):null}function Ce(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,i().WS)(),l=(0,r().K8)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.timeline_by_end}),[t]),a=(0,r().O$)(t.permissionScopesStore),c=(0,r().O$)(t.normalizedSchemaStore),d=(0,r().K8)((()=>t.collectionViewStore()),[t]),p=(0,r().K8)((()=>t.collectionStore()),[t]),u=(0,r().K8)((()=>null==p?void 0:p.getSchema()),[p]),g=(0,r().K8)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&d&&p&&g&&u))return null;const m=c[l];return m?(0,ue.jsx)(O().Ay,{popupType:n?$().nl.SlideUp:$().nl.Popup,alignmentToOrigin:O().yP.End,placementToOrigin:O().sx.Bottom,originGap:0,renderOrigin:e=>(0,ue.jsx)(se().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"End date",id:"database.viewSettings.layoutTab.timelineEndDate.title"}),showChevron:!0,right:m.name,disabled:!a.canConfigureBlock,...e}),render:e=>{let i;return i=n?{menuType:ee().gu.ActionSheet}:{menuType:ee().gu.Popup,width:300},(0,ue.jsx)(F().A,{...i,children:(0,ue.jsx)(de().A,{schema:u,format:g,currentProperty:l,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,s().$L)(t)})),onAccept:n=>{n&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderTimelineEndSetting",environment:o,canUndo:!0,perform:e=>{(0,T().f)({collectionViewStore:d,update:{timeline_by_end:n},transaction:e})}}),e.close(),(0,f().X)({environment:o,collectionContextStore:t,action:"update_timeline_by_end",original_view_type:void 0,property_type:m.type}))}})})}}):null}function _e(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,i().WS)(),l=(0,r().K8)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.calendar_by}),[t]),a=(0,r().O$)(t.permissionScopesStore),c=(0,r().O$)(t.normalizedSchemaStore),d=(0,r().K8)((()=>t.collectionViewStore()),[t]),p=(0,r().K8)((()=>t.collectionStore()),[t]),u=(0,r().K8)((()=>null==p?void 0:p.getSchema()),[p]),g=(0,r().K8)((()=>null==p?void 0:p.getFormat()),[p]);if(!(l&&d&&p&&g&&u))return null;const m=c[l];return m?(0,ue.jsx)(O().Ay,{popupType:n?$().nl.SlideUp:$().nl.Popup,alignmentToOrigin:O().yP.End,placementToOrigin:O().sx.Bottom,originGap:0,renderOrigin:e=>(0,ue.jsx)(se().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Show calendar by",id:"database.viewSettings.layoutTab.showCalendarByProperty.title"}),disabled:!a.canConfigureBlock,showChevron:!0,right:(0,ue.jsx)("div",{style:y().RC,children:m.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let i;return i=n?{menuType:ee().gu.ActionSheet}:{menuType:ee().gu.Popup,width:300},(0,ue.jsx)(F().A,{...i,children:(0,ue.jsx)(de().A,{schema:u,format:g,currentProperty:l,getProperties:()=>Object.keys(c).filter((e=>{const t=c[e];return t&&(0,s().$L)(t)})),onAccept:n=>{n&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderCalendarBySetting",environment:o,canUndo:!0,perform:e=>{(0,T().f)({collectionViewStore:d,update:{calendar_by:n},transaction:e})}}),e.close(),(0,f().X)({environment:o,collectionContextStore:t,action:"update_calendar_by",original_view_type:void 0,property_type:m.type}))}})})}}):null}function Ae(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,i().WS)(),l=(0,r().K8)((()=>{var e;return null===(e=t.normalizedQueryStore.state)||void 0===e?void 0:e.map_by}),[t]),a=(0,r().O$)(t.permissionScopesStore),s=(0,r().O$)(t.normalizedSchemaStore),c=(0,r().K8)((()=>t.collectionViewStore()),[t]),d=(0,r().K8)((()=>t.collectionStore()),[t]),p=(0,r().K8)((()=>null==d?void 0:d.getSchema()),[d]),u=(0,r().K8)((()=>null==d?void 0:d.getFormat()),[d]);if(!(l&&c&&d&&u&&p))return null;const g=s[l];return g?(0,ue.jsx)(O().Ay,{popupType:n?$().nl.BottomSheet:$().nl.Popup,bottomSheetInitialState:"half",alignmentToOrigin:O().yP.End,placementToOrigin:O().sx.Bottom,originGap:0,renderOrigin:e=>(0,ue.jsx)(se().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Map by",id:"database.viewSettings.layoutTab.showMapByProperty.title"}),disabled:!a.canConfigureBlock,showChevron:!0,right:(0,ue.jsx)("div",{style:y().RC,children:g.name}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},...e}),render:e=>{let i;return i=n?{menuType:ee().gu.Modal}:{menuType:ee().gu.Popup,width:300},(0,ue.jsx)(F().A,{...i,children:(0,ue.jsx)(de().A,{schema:p,format:u,currentProperty:l,getProperties:()=>Object.keys(s).filter((e=>{const t=s[e];return t&&"place"===t.type})),onAccept:n=>{n&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderMapBySetting",environment:o,canUndo:!0,perform:e=>{(0,T().f)({collectionViewStore:c,update:{map_by:n},transaction:e})}}),e.close(),(0,f().X)({environment:o,collectionContextStore:t,action:"update_map_by",original_view_type:void 0,property_type:g.type}))}})})}}):null}function je(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const n=(0,i().v3)(),l=((0,r().O$)(t.normalizedFormatStore).timeline_table_properties||[]).filter((e=>Boolean(e.visible))).length,a=(0,r().O$)(t.permissionScopesStore);return(0,ue.jsx)(se().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Table properties",id:"database.viewSettings.layoutTab.tablePropertiesButton.title"}),showChevron:!0,right:(0,ue.jsx)(S().sA,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.layoutTab.propertiesButton.propertiesShown.title",values:{propertiesShown:l}}),onClick:()=>{h().a2({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"table"}}),(0,f().X)({environment:n,collectionContextStore:t,action:"click_timeline_table_properties"})},disabled:!a.canConfigureBlock})}function Te(e){const{collectionContextStore:t,collectionSettingsStore:o}=e,a=(0,i().v3)(),s=(0,r().O$)(t.normalizedFormatStore),c=s.board_columns_by,d=(0,r().K8)((()=>(0,Y().FS)(s)),[s]),p=(0,r().O$)(t.normalizedSchemaStore),{canConfigureBlock:u}=(0,r().O$)(t.permissionScopesStore),g=(0,n.useCallback)((()=>{if(!c)return null;const e=p[c.property];if(!e)return null;h().a2({collectionSettingsStore:o,item:{type:"group",groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}}),(0,f().X)({environment:a,collectionContextStore:t,action:"click_board_group_by",original_view_type:void 0,property_type:e.type})}),[t,o,a,c,p]),m=(0,n.useCallback)((()=>h().ut({environment:a,collectionContextStore:t})),[t,a]),y=(0,l().IS)((()=>({textWrapper:{opacity:1}})),[]);if(!c)return null;const v=p[c.property];return v?(0,ue.jsxs)(ue.Fragment,{children:[(0,ue.jsx)(se().A,{title:(0,ue.jsx)(S().sA,{id:"database.viewSettings.layoutTab.boardGroupByButton.title",defaultMessage:"Group by"}),showChevron:!0,right:v.name,onClick:g,disabled:!u}),(0,ue.jsx)(L().A,{title:(0,ue.jsx)(S().sA,{id:"database.viewSettings.groupTab.colorColumns",defaultMessage:"Color columns"}),on:!d,focused:!1,onClick:m,disabled:!u,textWrapperStyle:y.textWrapper})]}):null}function ke(e,t,o){const n=o.collectionViewStore();if(!n)return;const{serverCommitResult:i}=C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleViewRangeOptionClick",environment:t,canUndo:!0,perform:t=>{x().zA({stores:[n],update:{calendar_view_range:e},transaction:t})}}),r=X().XX.state,l=o.dateRangeStartStore.state,a=o.dateRangeEndStore.state,{newDateRangeStart:s,newDateRangeEnd:c}=function(e){const{newViewRange:t,oldCalendarStart:o,startOfWeekSetting:n}=e;if("month"===t){const e=(0,d().mK)(new Date((0,d().to)(o,n)).getDate()>7?(0,d().Mw)(o):o,n);return{newDateRangeStart:e,newDateRangeEnd:(0,d().to)((0,d().AQ)({date:e,monthsToAdd:1}),n)}}return{newDateRangeStart:(0,d().mK)(Date.now(),n),newDateRangeEnd:(0,d().to)(Date.now(),n)}}({oldCalendarStart:l,newViewRange:e,startOfWeekSetting:r});(0,j().r)({dateRangeStart:s,dateRangeEnd:c,collectionContextStore:o}),i.then((()=>{(0,f().X)({environment:t,collectionContextStore:o,action:"update_calendar_view_range"}),(0,A().LQ)({newCalendarStart:s,newCalendarEnd:c,collectionViewId:n.id,currentUserId:t.currentUser.id})})).catch((()=>{(0,j().r)({dateRangeStart:l,dateRangeEnd:a,collectionContextStore:o})}))}function Me(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,r().O$)(t.permissionScopesStore),l=(0,r().K8)((()=>!Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines)),[t]);return(0,ue.jsx)(L().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Show vertical lines",id:"database.viewSettings.layoutTab.tableShowVerticalLines"}),on:l,focused:!1,onClick:()=>function(e,t){const o=t.collectionViewStore();if(!o)return;const n=Boolean(t.normalizedFormatStore.state.hide_table_vertical_lines);w().au({environment:e,collectionViewStore:o,currentValue:n}),(0,f().X)({environment:e,collectionContextStore:t,action:"toggle_table_vertical_lines"})}(o,t),disabled:!n.canConfigureBlock,textWrapperStyle:{opacity:1}})}function Be(e){var t;let{collectionContextStore:o}=e;const l=(0,i().v3)(),a=(0,r().O$)(o.normalizedFormatStore),s=(0,r().O$)(o.permissionScopesStore),c=(0,r().K8)((()=>fe(o)),[o]),d=a.table_wrap||"calendar"===c&&!0===(null==a||null===(t=a.calendar_properties)||void 0===t||null===(t=t.find((e=>"title"===e.property)))||void 0===t?void 0:t.wrap),p=(0,n.useMemo)((()=>{switch(c){case"table":return(0,ue.jsx)(S().sA,{defaultMessage:"Wrap all columns",id:"database.viewSettings.layoutTab.tableWrapAllColumns"});case"calendar":return(0,ue.jsx)(S().sA,{defaultMessage:"Wrap page titles",id:"database.viewSettings.layoutTab.calendarWrapTitle"});default:return(0,ue.jsx)(S().sA,{defaultMessage:"Wrap all properties",id:"database.viewSettings.layoutTab.tableWrapAllProperties"})}}),[c]),u=(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&(w().g({environment:l,collectionViewStore:e,currentValue:Boolean(d)}),(0,f().X)({environment:l,collectionContextStore:o,action:"set_first_load_limit"}),(0,f().X)({environment:l,collectionContextStore:o,action:"toggle_table_wrap_cells"}))}),[o,l,d]);return(0,ue.jsx)(L().A,{title:p,on:Boolean(d),focused:!1,onClick:u,disabled:!s.canConfigureBlock,textWrapperStyle:{opacity:1}})}function Ve(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),n=(0,r().O$)(t.normalizedQueryStore),l=null==n?void 0:n.timeline_by_end,a=(0,r().O$)(t.permissionScopesStore);return(0,ue.jsx)(L().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Separate start and end dates",id:"database.viewSettings.layoutTab.timelineUseSeparateDates.title"}),focused:!1,on:Boolean(l),onClick:()=>function(e,t){const o=t.normalizedQueryStore.state,n=t.collectionViewStore(),i=null==o?void 0:o.timeline_by,r=null==o?void 0:o.timeline_by_end;if(!i||!n)return;const l=r?void 0:i;C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleTimelineSeparateDatesClick",environment:e,canUndo:!0,perform:e=>{(0,T().f)({collectionViewStore:n,update:{timeline_by_end:l??null},transaction:e})}}),(0,f().X)({environment:e,collectionContextStore:t,action:"toggle_timeline_separate_dates"})}(o,t),disabled:!a.canConfigureBlock,textWrapperStyle:{opacity:1}})}function Ke(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),l=(0,r().O$)(t.permissionScopesStore),a=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state;return(null==t?void 0:t.calendar_view_range)||"month"}(t)),[t]),s=(0,r().K8)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),c=(0,n.useMemo)((()=>["month","week"].map((e=>({key:e,type:"button",title:W().A.formatMessage(Se[e])})))),[]);return(0,ue.jsx)(ce().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Show calendar as",id:"database.viewSettings.layoutTab.showCalendarAs.title"}),collectionContextStore:t,openButtonPopup:s,selectedKey:a,popupStyle:{minWidth:190},options:c,onChange:e=>ke(e,o,t),disabled:!l.canConfigureBlock})}function Pe(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),l=(0,r().K8)((()=>{var e;return Boolean((null===(e=t.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("calendar_show_weekends").getValue())??!0)}),[t]),a=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleToggleShowWeekends",environment:o,canUndo:!0,perform:t=>{x().zA({stores:[e],update:{calendar_show_weekends:!l},transaction:t})}}),(0,f().X)({environment:o,collectionContextStore:t,action:"toggle_calendar_show_weekends"}))}),[t,o,l]);return(0,ue.jsx)(pe().A,{title:(0,ue.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,ue.jsx)(S().sA,{defaultMessage:"Show weekends",id:"database.viewSettings.layoutTab.showWeekends.title"})}),showChevron:!1,switcherProps:{on:l,noColor:!1},onClick:a})}function Oe(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;const l=(0,i().v3)(),a=(0,r().O$)(t.permissionScopesStore),s=(0,r().K8)((()=>{var e;return(null===(e=t.collectionViewStore())||void 0===e||null===(e=e.getFormatStore())||void 0===e?void 0:e.getKeyValue("feed_show_author_byline"))??!0}),[t]),c=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(C().createAndCommit({userAction:"CollectionSettingsProperty.FeedOptions.handleToggleShowAuthorByline",environment:l,canUndo:!0,perform:t=>{x().zA({stores:[e],update:{feed_show_author_byline:!s},transaction:t})}}),(0,f().X)({environment:l,collectionContextStore:t,action:"toggle_feed_show_author_byline"}))}),[t,l,s]);return(0,ue.jsx)(L().A,{title:(0,ue.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,ue.jsx)(S().sA,{defaultMessage:"Show author byline",id:"database.viewSettings.layoutTab.feedShowAuthorByline.title"})}),focused:!1,on:s,onClick:c,disabled:!a.canConfigureBlock})}function Ie(e){let{collectionContextStore:t}=e;const o=(0,l().DP)(),n=(0,i().v3)(),s=(0,r().O$)(t.permissionScopesStore),c=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state,o=fe(e);return(null==t?void 0:t.collection_peek_mode)||q().C9[o]}(t)),[t]),d=(0,r().K8)((()=>"peekModeFormat"===t.settingsStore.state.openButtonPopup),[t]),p=(0,r().K8)((()=>fe(t)),[t]);return(0,ue.jsx)(ce().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Open pages in",id:"database.viewSettings.layoutTab.peekModeTitle"}),collectionContextStore:t,openButtonPopup:d,selectedKey:c,popupStyle:{minWidth:190},options:me({currentViewType:p,theme:o}),menuItemOptionsStyle:{paddingTop:8,paddingBottom:8},onClick:()=>function(e,t){(0,v().m)({environment:e,collectionContextStore:t,from:"collection_view_settings"})}(n,t),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(!n||!e)return;C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handlePeekModeFormatClick",environment:t,canUndo:!0,perform:t=>{x().zA({stores:[n],update:{collection_peek_mode:e},transaction:t})}});const i=(0,U().sl)(o);if(i&&i.view_type&&(i&&i.view_type&&(0,_().v)(t,"update_peek_mode_format",{peek_mode:e,from:"collection_view_settings",...i}),le().default.state.open&&le().default.state.collectionContextStore===o)){const{mainEditorCurrentBlockStore:o}=ie().default.state,n="full_page"===e?(0,J().Ay)({store:le().default.state.targetStore,fullyQualified:!1,pageVisitSource:a().y8.Expand}):(0,K().wy)({environment:t,store:le().default.state.targetStore,mainEditorCurrentBlockStore:o,collectionContextStore:le().default.state.collectionContextStore,fullyQualified:!1,overridePeekMode:(0,le().getPeekModeFromCollectionPeekModeFormat)(e)});n&&b().oo({environment:t,url:n})}}(e,n,t),disabled:!s.canConfigureBlock})}function Fe(e){let{collectionContextStore:t}=e;const o=(0,i().v3)(),l=(0,r().O$)(t.permissionScopesStore),a=(0,r().K8)((()=>t.shouldShowPageIcon()??!0),[t]),s=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(C().createAndCommit({userAction:"CollectionSettingsProperty.TitleOptions.handleToggleShowIcon",environment:o,canUndo:!0,perform:t=>{x().zA({stores:[e],update:{show_page_icon:!a},transaction:t})}}),(0,f().X)({environment:o,collectionContextStore:t,action:"toggle_show_page_icon"}))}),[t,o,a]);return(0,ue.jsx)(L().A,{title:(0,ue.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,ue.jsx)(S().sA,{defaultMessage:"Show page icon",id:"database.viewSettings.layoutTab.showPageIcon.title"})}),focused:!1,on:a,onClick:s,disabled:!l.canConfigureBlock})}function ze(e){let{collectionContextStore:t}=e;const o=(0,l().DP)(),n=(0,i().v3)(),a=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state,o=ve(e);if(o&&t)return t[o]}(t)),[t]),s=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state,o=he(e);if(o&&t){const e=t[o];if(e)return e}return p().fi}(t)),[t]),d=(0,r().K8)((()=>!R().A.isMobile||"board"===fe(t)),[t]),u=(0,r().O$)(t.permissionScopesStore),m=(0,r().K8)((()=>function(e,t,o){const n=o.normalizedSchemaStore.state;let i=Object.keys(n);i=g().Ul(i,(e=>{const t=n[e];return t?t.name:""}));const r=g().oE(i.map((e=>{const o=n[e];if(o&&"file"===o.type)return{key:{type:"property",property:e},type:"button",title:o.name,icon:(0,ue.jsx)(c().zB,{type:o.type,icon:o.icon,size:R().A.isMobile?16:14,theme:t,style:{fill:t.icon.primary}})}})));return[...[void 0,{type:"page_cover"},{type:"page_content"}].map((e=>({key:e,type:"button",title:N(e)}))),...r]}(0,o,t)),[n,o,t]),y=(0,r().K8)((()=>function(e){const t=e.normalizedFormatStore.state,o=xe(e);if(o&&t)return t[o]}(t)),[t]);return(0,ue.jsxs)(ue.Fragment,{children:[(0,ue.jsx)(ce().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Card preview",id:"database.viewSettings.layoutTab.cardPreviewButtonTitle"}),selectedKey:a,popupStyle:{minWidth:190},options:m,onChange:e=>function(e,t,o){const n=ve(o),i=o.collectionViewStore();n&&i&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverFormatChange",environment:t,canUndo:!0,perform:t=>{x().zA({stores:[i],update:{[n]:e},transaction:t})}}),(0,f().X)({environment:t,collectionContextStore:o,action:"update_cover_format"}))}(e,n,t),disabled:!u.canConfigureBlock}),d&&(0,ue.jsx)(ce().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Card size",id:"databdatabase.viewSettings.layoutTab.cardSizeButtonTitle"}),selectedKey:s,popupStyle:{minWidth:190},options:["small","medium","large"].map((e=>({key:e,type:"button",title:Q(e)}))),onChange:e=>function(e,t,o){const n=he(o),i=o.collectionViewStore();n&&i&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverSizeFormatChange",environment:t,canUndo:!0,perform:t=>{x().zA({stores:[i],update:{[n]:e},transaction:t})}}),(0,f().X)({environment:t,collectionContextStore:o,action:"toggle_cover_size_format"}))}(e,n,t),disabled:!u.canConfigureBlock}),a&&(0,ue.jsx)(L().A,{title:(0,ue.jsx)(S().sA,{defaultMessage:"Fit image",id:"databdatabase.viewSettings.layoutTab.fitImageButtonTitle"}),on:"contain"===y,focused:!1,onClick:()=>function(e,t){const o=xe(t),n=t.collectionViewStore(),i=t.normalizedFormatStore.state;o&&n&&(C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.handleCoverAspectFormatToggle",environment:e,canUndo:!0,perform:e=>{x().zA({stores:[n],update:{[o]:"contain"===i[o]?"cover":"contain"},transaction:e})}}),(0,f().X)({environment:e,collectionContextStore:t,action:"toggle_cover_aspect_format"}))}(n,t),disabled:!u.canConfigureBlock,textWrapperStyle:{opacity:1}})]})}function $e(e){let{viewType:t,collectionContextStore:o}=e;const n=(0,l().DP)(),a=(0,i().v3)(),s=(0,r().K8)((()=>fe(o)),[o]),c=(0,r().O$)(o.permissionScopesStore),d=s===t,p=d||!c.canConfigureBlock,u=(0,ue.jsxs)(P().A,{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",flexGrow:0,flexShrink:0,fontSize:11,borderRadius:ge,padding:6,boxShadow:`inset 0 0 0 1px ${n.regularDividerColor}`,color:n.text.secondary,fill:n.text.secondary,...d&&{boxShadow:`inset 0 0 0 2px ${n.stroke.uiBluePrimary}`,color:n.text.uiBluePrimary,fill:n.icon.uiBluePrimary,fontWeight:500}},disabled:p,onClick:()=>{C().createAndCommit({userAction:"CollectionSettingsViewLayoutMenu.renderViewTypeButton",environment:a,canUndo:!0,perform:e=>{!function(e){const{environment:t,collectionContextStore:o,newViewType:n,transaction:i}=e,r=o.collectionViewStore(),l=o.collectionViewBlockStore(),a=o.collectionStore();if(!r||!l)return;if(n===r.getType()||"page"===n||"form_editor"===n)return;"chart"===n&&k().Z({environment:t,collectionContextStore:o,collectionViewId:r.id,from:"collection_view_type_change"});const s=r.getType();M().zv({store:r,data:{type:n},transaction:i}),(0,V().W)({environment:t,collectionContextStore:o,collectionViewStore:r,collectionStore:a,oldViewType:s,newViewType:n,transaction:i}),(0,B().S)({collectionContextStore:o})}({environment:a,collectionContextStore:o,newViewType:t,transaction:e})}}),(0,f().X)({environment:a,collectionContextStore:o,action:"change_type",original_view_type:s,new_view_type:t})},children:[Z().ZU[t]({width:void 0,height:20,marginBottom:4,marginTop:4}),(0,ue.jsx)("div",{children:Z().to[t]})]},t),S=(0,z().oG)("feed_collection_view"),{isOnboardingFeedView:g,hasClickedFeedViewNewButton:m}=(0,r().K8)((()=>{var e;return{isOnboardingFeedView:o.settingsStore.getState().isOnboardingFeedView,hasClickedFeedViewNewButton:null===(e=ie().default.state.currentUserSettingsStore)||void 0===e?void 0:e.hasClickedNewFeedButton()}}),[o.settingsStore]);return"feed"===t&&(S&&!m||g)?(0,ue.jsx)(D().u,{shape:"square",borderRadius:ge,children:u}):u}},321775:(e,t,o)=>{o.d(t,{m:()=>r});var n=()=>o(476492),i=()=>o(645302);function r(e){const t=(0,n().sl)(e.collectionContextStore);t&&t.view_type&&i().jE(e.environment,{from:e.from,from_peek_mode:e.from_peek_mode,...t,view_type:t.view_type})}},401634:(e,t,o)=>{o.d(t,{i:()=>f});o(296540);var n=()=>o(484714),i=()=>o(401497),r=()=>o(274609),l=()=>o(959013),a=()=>o(534177),s=()=>o(545805),c=()=>o(928600),d=()=>o(480095),p=()=>o(107683),u=()=>o(38337),S=()=>o(722872),g=o(474848);const m=(0,l().YK)({createTitle:{id:"automations.builderModal.createTitle",defaultMessage:"Create automation"},updateTitle:{id:"automations.builderModal.updateTitle",defaultMessage:"Edit automation"},saveButton:{id:"automations.builderModal.saveButton",defaultMessage:"Save"}}),y=88;function f(e){const{children:t,handleOnDismiss:o,canSave:f,handleOnSave:v,mode:h}=e,x=(0,l().tz)(),{isMobile:b}=(0,n().Y0)(),w=(0,i().IS)((e=>({container:{padding:b?0:"12px 16px",display:"flex",flexDirection:"column",overflow:"hidden",...b?{}:{flexGrow:1}},mobileBackIcon:{width:14,height:14,fill:e.icon.secondary,margin:"0 6px"}})),[b]);if(b){let e;return"create"===h?e=x.formatMessage(m.createTitle):"update"===h||"button_property"===h?e=x.formatMessage(m.updateTitle):"loading"===h?e=null:(0,a().HB)(h),(0,g.jsx)(c().A,{menuType:S().gu.Modal,whiteBackground:!0,title:e,left:(0,g.jsx)(g.Fragment,{children:(0,r().L)(w.mobileBackIcon)}),onClickLeft:o,rightDisabled:!f,right:"button_property"===h?(0,g.jsx)(d().DoneMenuText,{}):(0,g.jsx)(l().sA,{...m.saveButton}),onClickRight:v,children:(0,g.jsx)("div",{style:w.container,className:u().sux,children:t})})}return(0,g.jsx)(p().s,{anchor:"top",minimumOutsideSpacing:{type:"axes",vertical:y},areaConstraint:{width:{type:"fixed",length:500},height:{type:"min",length:600,scroll:"disallow"}},allowDismissByEscape:!1,isOpen:!0,render:()=>(0,g.jsxs)("div",{style:w.container,className:u().sux,children:[t,(0,g.jsx)(s().A,{debugName:"AutomationBuilderModal",capture:!0,onEsc:e=>{o()}})]})})}},419178:(e,t,o)=>{o.d(t,{Q:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.52 2.4 12.95 15.2",svg:(0,o(474848).jsx)("path",{d:"M15.85 3.65a.625.625 0 1 0 0-1.25H4.15a.625.625 0 1 0 0 1.25zm-1.008 6.692a.625.625 0 0 1-.884 0l-3.333-3.333v9.966a.625.625 0 1 1-1.25 0V7.009l-3.333 3.333a.625.625 0 1 1-.884-.884l4.4-4.4a.625.625 0 0 1 .884 0l4.4 4.4a.625.625 0 0 1 0 .884"})},i=(0,o(340498).wt)("arrowLineUp",n)},430171:(e,t,o)=>{o.d(t,{c:()=>l});var n=()=>o(436696),i=()=>o(686526),r=()=>o(36629);function l(e){const{environment:t,collectionContextStore:o}=e;o.collectionStore()&&((0,n().X)({environment:t,collectionContextStore:o,action:"click_new_property"}),i().a2({collectionSettingsStore:o.settingsStore,item:{type:"propertyType",onAccept:e=>{const{propertyType:n,isSuggestedProperty:i,propertyName:l,propertyIcon:a,selectOptions:s}=e;r().nZ({environment:t,propertyType:n,isSuggestedProperty:i,propertyName:l,propertyIcon:a,selectOptions:s,collectionContextStore:o,from:"view_settings"})}}}))}},457056:(e,t,o)=>{o.d(t,{o:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.12 4.12 14.76 12.16",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M4.375 4.75a.625.625 0 1 0-1.25 0v5c0 1.174.951 2.125 2.125 2.125h10.491l-3.333 3.333a.625.625 0 0 0 .884.884l4.4-4.4a.625.625 0 0 0 0-.884l-4.4-4.4a.625.625 0 0 0-.884.884l3.333 3.333H5.25a.875.875 0 0 1-.875-.875z"})},i=(0,o(340498).wt)("arrowTurnDownRight",n)},542984:(e,t,o)=>{o.d(t,{A:()=>C});var n=o(296540),i=()=>o(56366),r=()=>o(33376),l=()=>o(959013),a=()=>o(686526),s=()=>o(504836),c=(o(898992),o(672577),()=>o(651124)),d=()=>o(496603),p=()=>o(638013),u=()=>o(2220),S=()=>o(497222),g=()=>o(556048),m=()=>o(21140),y=()=>o(635676),f=()=>o(765957),v=()=>o(53137),h=()=>o(666803),x=o(474848);function b(e){let{environment:t,collectionSettingsStore:o,flowId:n,externalCollectionType:i,integrationIconUrl:s,site:c,botId:p,isSyncOwner:g}=e;return(0,x.jsx)(S().A,{icon:r().E,onClick:()=>{(0,u().u)({environment:t,event:{eventName:"external_sync_sidebar_config",eventProperties:{integration:i,actionType:"source_option_click",flowId:n,identifier:c,botId:p,isSyncOwner:g}}}),a().a2({collectionSettingsStore:o,item:{source:"external_source",type:"externalProjectsSyncSettings"}})},right:(0,x.jsxs)(m().Ye,{alignItems:"center",children:[(0,x.jsx)("img",{style:{height:12,width:12,marginRight:6},src:s,alt:"External integration icon"}),(0,x.jsx)(l().sA,{id:"database.viewSettings.mainTab.source.sourceName",defaultMessage:"{integrationName}",values:{integrationName:(0,d().ZH)(i||"")}})]}),showChevron:!0,title:(0,x.jsx)(l().sA,{defaultMessage:"Source",id:"database.viewSettings.mainTab.source.title"})})}function w(e){let{environment:t,collectionStore:o,collectionSettingsStore:r}=e;const l=function(e,t){const{botId:o,site:n,externalCollectionType:r,syncState:l}=(0,i().K8)((()=>{const e=null==t?void 0:t.getFormat();return{botId:null==e?void 0:e.bot_id,site:null==e?void 0:e.synced_collection_external_url,externalCollectionType:null==e?void 0:e.external_collection_type,syncState:null==e?void 0:e.sync_state}}),[t]),a=(0,i().K8)((()=>{var e;return null===(e=f().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()}),[]),d=(0,i().K8)((()=>h().Ay.getFlowId()),[]),p=(0,i().K8)((()=>(0,s().Sd)()),[]),u=(0,i().K8)((()=>Boolean(v().A.externalAuthentications.state.find((t=>t.id===o&&t.user_id===e.currentUser.id)))),[o,e.currentUser.id]);if(!r)return;const S={externalCollectionType:r,botId:o,site:n,integrationIconUrl:y().l[r],isSyncOwner:u,flowId:d};switch(r){case c().uO.Jira:return{...S,shouldShowTooltip:p&&!(!0===(null==a?void 0:a.seen_jira_sync_source_tooltip))&&l};case c().uO.Salesforce:default:return{...S,shouldShowTooltip:!1}}}(t,o),a=(0,n.useRef)(null);if(!l)return null;const{botId:d,site:u,integrationIconUrl:S,isSyncOwner:m,shouldShowTooltip:w,externalCollectionType:C,flowId:_}=l;return w?(0,x.jsxs)("div",{ref:a,style:{boxShadow:p().p.buttonBlueFocusRing.light,borderRadius:6},children:[(0,x.jsx)(b,{environment:t,collectionSettingsStore:r,flowId:_,externalCollectionType:C,integrationIconUrl:S,site:u,botId:d,isSyncOwner:m}),(0,x.jsx)(g().C8,{origin:a})]}):(0,x.jsx)(b,{environment:t,collectionSettingsStore:r,flowId:_,externalCollectionType:C,integrationIconUrl:S,site:u,botId:d,isSyncOwner:m})}const C=function(e){let{collectionContextStore:t,collectionSettingsStore:n,disabled:c,overrideOnClickBehavior:d,buttonStyle:p,forceShow:u}=e;const g=(0,o(484714).v3)(),m=(0,i().K8)((()=>t.collectionStore()),[t]),y=(0,i().K8)((()=>null==m?void 0:m.isExternalSyncedCollection()),[m]),f=(0,i().O$)(t.permissionScopesStore),v=(0,i().K8)((()=>(0,s().pB)()),[]),h=(0,i().K8)((()=>t.collectionViewBlockStore()),[t]),b=(0,o(963589).X)("db_ux_chrome"),C=(0,i().K8)((()=>u||function(e){const t=e.collectionStore(),o=e.collectionViewBlockStore(),n=e.collectionViewStore();if(!t||!o||!n)return!1;if(o.getOwnedCollectionStores().length>1||o.getLinkedCollectionStores().length>0)return!0;if(t.isSyncedCollection())return!0;if(t.isSystemCollection())return!1;return!o.hasSingleSourceAndNoLinkedCollections()}(t)),[u,t]),_=(0,i().K8)((()=>null==m?void 0:m.getIcon()),[m]);return v&&y&&m&&f.canConfigureBlock?(0,x.jsx)(w,{environment:g,collectionStore:m,collectionSettingsStore:n}):m&&h&&C?(0,x.jsx)(S().A,{icon:b?o(688311).h:r().E,title:(0,x.jsx)(l().sA,{defaultMessage:"Source",id:"database.viewSettings.mainTab.sourceButton.title"}),showChevron:!0,right:(0,x.jsxs)(x.Fragment,{children:[_&&(0,x.jsx)(o(187820).B6,{icon:_,iconRecordCategory:"collection",isEmptyPage:!1,size:20,disabled:!0,style:{marginRight:4,opacity:.6}}),(0,x.jsx)(o(16006).A,{store:m})]}),textWrapperStyle:{flexShrink:0},rightStyle:{flexShrink:1},disabled:!f.canConfigureBlock||c,buttonStyle:p,onClick:()=>{d?d():((0,o(436696).X)({environment:g,collectionContextStore:t,action:"click_source"}),a().a2({collectionSettingsStore:n,item:{type:"source"}}))}}):null}},635676:(e,t,o)=>{o.d(t,{l:()=>r});var n=()=>o(148307),i=()=>o(651124);const r={[i().uO.Jira]:n().A.images.externalIntegrations.jiraPng,[i().uO.Salesforce]:n().A.images.externalIntegrations.salesforcePng}},647702:(e,t,o)=>{o.d(t,{K:()=>u,d:()=>p});o(581454);var n=()=>o(221844),i=()=>o(792071),r=()=>o(519831),l=()=>o(869558),a=()=>o(496603),s=()=>o(921855),c=()=>o(630116),d=()=>o(269643);function p(e){const{environment:t,collectionStore:o,freezeTitle:p}=e,u=t.currentUser.id;if(!u)return;const S=function(e){var t,o;const{collectionStore:n,userId:i,spaceId:l,idCreator:c,propertyFilters:p,combinatorFilter:u,freezeTitle:S=!0}=e,g=n.getSchema(),m=Object.keys(g),y=null===(t=n.getModel())||void 0===t?void 0:t.parent_id;if(!y)return;const f=(0,a().Ul)(m,((e,t)=>"title"===e?-1:t)).map((e=>({property:e,visible:!0})));return{id:(0,d().D)(c,l,n.id),version:1,parent_id:y,parent_table:"block",alive:!0,space_id:l,created_by_id:i,created_by_table:"notion_user",last_edited_by_id:i,last_edited_by_table:"notion_user",type:"table",name:(0,s().r4)(null===(o=n.getModel())||void 0===o?void 0:o.getName(),n),format:{table_properties:f,table_wrap:!0,table_frozen_column_index:S?0:void 0,collection_pointer:{table:r().Vl,id:n.id,spaceId:l},collection_view_source:{type:"collection",id:n.id,spaceId:l},hide_linked_collection_name:!0,property_filters:p},query2:{sort:[],aggregations:[],filter:u},page_sort:[]}}({collectionStore:o,userId:t.currentUser.id,spaceId:o.getSpaceId(),idCreator:t.idCreator,propertyFilters:undefined,combinatorFilter:undefined,freezeTitle:p});if(!S)return;const g={table:l().Gy,id:S.id,spaceId:o.getSpaceId()},m=new(n().A)({name:"temporaryCache",isTemporaryData:!0});m.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),m.setModelAndRole({pointer:g,userId:u},i().Bj6.fromCollectionView(S),"editor");return new(c().pS)(t,{table:l().Gy,id:g.id},{inMemoryRecordCache:m})}function u(e){let{collectionContextStore:t,permissionScopes:o}=e;return!("collectionTypedView"!==t.contextType||!o.canConfigureBlock)||o.canConfigureCollection}},988950:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(757695))().Store{getInitialState(){return{pageId:void 0}}}const i=new n}}]);