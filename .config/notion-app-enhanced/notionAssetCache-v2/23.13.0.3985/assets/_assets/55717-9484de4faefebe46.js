"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[55717],{34423:(e,t,o)=>{o.d(t,{T:()=>y});var r=o(296540),a=()=>o(484714),n=()=>o(56366),i=()=>o(921598),s=()=>o(748054),l=()=>o(959013),u=()=>o(896628),d=()=>o(751156),c=()=>o(175116),p=()=>o(828973),g=o(474848);function y(e){let{groupBy:t}=e;const o=(0,a().v3)(),y=(0,c().ET)(),{viewType:m,startWeekOn:h}=(0,n().K8)((()=>{const e=y.normalizedFormatStore.state;return{viewType:y.getViewType(),startWeekOn:(null==e?void 0:e.start_week_on)??0}}),[y]),f=(0,r.useCallback)((e=>{d().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStartWeekOnChange",environment:o,canUndo:!0,perform:t=>{const o=y.collectionViewStore();o&&u().zA({stores:[o],update:{start_week_on:e},transaction:t})}})}),[o,y]);if(!(0,i().Ik)(t)&&"formula"!==t.type)return null;if((0,i().Ik)(t)&&"week"!==t.groupBy)return null;if("formula"===t.type){const e=t.groupBy;if(!(0,i().Ik)(e))return null;if("week"!==e.groupBy)return null}return(0,g.jsx)(p().A,{title:(0,g.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn",defaultMessage:"Start week on"}),popupStyle:{minWidth:190},selectedKey:h,onChange:f,icon:"chart"===m?s().M:void 0,options:[{key:0,type:"button",title:(0,g.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn.sunday",defaultMessage:"Sunday"})},{key:1,type:"button",title:(0,g.jsx)(l().sA,{id:"database.viewSettings.groupTab.startWeekOn.monday",defaultMessage:"Monday"})}]})}},187881:(e,t,o)=>{o.r(t),o.d(t,{eyeFillIcon:()=>n,iconDefinition:()=>a});o(296540);var r=o(474848);const a={viewBox:"0 0 20 20",fittedViewBox:"0.96 4.19 18.07 11.62",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M10 8.894a1.104 1.104 0 1 1-.003 2.207A1.104 1.104 0 0 1 10 8.894"}),(0,r.jsx)("path",{d:"M10 4.194c3.878 0 7.26 2.075 8.862 5.127l.073.163c.126.333.126.7 0 1.033l-.073.163c-1.602 3.052-4.984 5.126-8.862 5.126-3.757 0-7.049-1.946-8.707-4.843l-.156-.283a1.46 1.46 0 0 1 0-1.359l.156-.283C2.95 6.141 6.243 4.194 10 4.194m0 2.496a3.307 3.307 0 0 0-3.306 3.307l.004.17A3.307 3.307 0 0 0 9.83 13.3l.17.004a3.305 3.305 0 0 0 3.3-3.137l.005-.17a3.307 3.307 0 0 0-3.135-3.303z"})]})},n=(0,o(340498).wt)("eyeFill",a)},247788:(e,t,o)=>{o.d(t,{x:()=>d});o(581454);var r=()=>o(56366),a=()=>o(282339),n=()=>o(901610),i=()=>o(322638),s=()=>o(963589),l=()=>o(10594),u=()=>o(941814);function d(e){let{chartConfig:t,chartError:o,collectionContextStore:d}=e;const c=(0,s().X)("collection_group_reducer_visible"),p=(0,r().O$)(d.normalizedFormatStore),g=(0,r().K8)((()=>(0,u().hk)()),[]),y=(0,r().K8)((()=>(0,u().H4)()),[]);return(0,r().K8)((()=>{if((!o||(0,a().xG)(o))&&t)return function(e){var t,o,r;let{chartConfig:a,format:s,groupsLimit:u,subGroupsLimit:d,isGroupsReducerV2:c}=e;if("placeholder"===a.type||"groups_reducer"!==(null===(t=a.dataConfig)||void 0===t?void 0:t.type))return;const p=s.collection_groups||[],g=s.chart_subgroups||[],y=a.dataConfig.groupBy,m=(0,n().m)(a)?null===(o=a.dataConfig.aggregationConfig.stackOptions)||void 0===o?void 0:o.groupBy:void 0,h=(0,i().p7)(a);if(!h)return;const f=null===(r=a.chartFormat)||void 0===r?void 0:r.axisHideEmptyGroups,v=(0,l().w9)(y,s);if(c){return{version:"v2",type:"groups",omitZeroAggregationGroups:Boolean(f),groupBy:v,limit:u,groupSortPreference:p,aggregation:m?{type:"intersection_and_independent",intersectionAggregation:h,groupAggregation:h,subGroupAggregation:h}:{type:"independent",groupAggregation:h},subGroup:m?{groupBy:(0,l().w9)(m,s),limit:d,groupSortPreference:g}:void 0}}const S=p.map((e=>e.value)),b=g.map((e=>e.value)),x={type:"groups",groupBy:v,limit:u,groupSortPreference:S,hideEmptyAggregationGroups:Boolean(f),aggregation:m?{type:"intersection_and_independent",intersectionAggregation:h,groupAggregation:h,subGroupAggregation:h}:{type:"independent",groupAggregation:h},subGroup:m?{groupBy:(0,l().w9)(m,s),limit:d,groupSortPreference:b}:void 0};return x}({chartConfig:t,format:p,groupsLimit:g,subGroupsLimit:y,isGroupsReducerV2:c})}),[o,t,g,p,y,c],{useDeepEqual:!0})}},252051:(e,t,o)=>{o.d(t,{AI:()=>c,PB:()=>y,XC:()=>d,Yp:()=>a,Zz:()=>n,eq:()=>p,ev:()=>f,iq:()=>u,j2:()=>m,jQ:()=>g,jV:()=>r,kC:()=>h,o0:()=>i,p0:()=>s});const r=(0,o(959013).YK)({chart:{defaultMessage:"chart",id:"chartExport.chart"},exportChart:{defaultMessage:"Save chart as...",id:"chartExport.exportChart"},exportChartPreview:{defaultMessage:"Preview",id:"chartExport.exportChartPreview"},exportChartBackground:{defaultMessage:"Background",id:"chartExport.exportChartBackground"},copyPng:{defaultMessage:"Copy as PNG",id:"chartExport.copyAsPng"},downloadPng:{defaultMessage:"Download PNG",id:"chartExport.downloadPng"},downloadSvg:{defaultMessage:"Download SVG",id:"chartExport.downloadSVG"},madeWithNotion:{defaultMessage:"Made with Notion",id:"chartExport.madeWithNotion"}}),a=200,n=2,i=800,s=500,l=240,u=120,d=96,c=64,p=2*u,g=2*d,y=2*c;function m(e){let t={width:i,height:s};return"none"===e&&(t={width:i+p,height:s+g}),{chart:t,plotOptions:{pie:{size:l}}}}const h=20,f=8},282339:(e,t,o)=>{o.d(t,{QW:()=>m,dG:()=>g,ic:()=>y,lc:()=>p,xG:()=>h,ye:()=>c});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698);var r=()=>o(67657),a=()=>o(708685),n=()=>o(921598),i=()=>o(713998),s=()=>o(594013),l=()=>o(100594),u=()=>o(901610);const d=new Set(["groupBy_property_not_configured","groupBy_property_deleted","groupBy_property_not_groupable","groupBy_formula_not_groupable","aggregation_property_not_configured","aggregation_invalid","aggregation_deleted","stackBy_property_not_groupable","stackBy_formula_not_groupable","stackBy_property_deleted","name_property_not_configured","name_property_deleted","name_property_invalid","property_value_property_not_configured","property_value_property_deleted","property_value_property_invalid"]);function c(e){let{chartConfig:t,collectionSchema:o}=e;if(!t||"placeholder"===t.type)return"chart_config_not_found";if(void 0===t.dataConfig)return"data_model_invalid";if("groups_reducer"===t.dataConfig.type){const e=t.dataConfig.groupBy;if(!e)return"groupBy_property_not_configured";const s=(0,i()._g)({schema:o,property:e.property});if(!s)return"groupBy_property_deleted";const c=(0,n().Eg)(s);if("formula"===s.type&&!c)return"groupBy_formula_not_groupable";if(!c)return"groupBy_property_not_groupable";const p=t.dataConfig.aggregationConfig;if(!p)return"aggregation_property_not_configured";if("count"!==p.aggregation.aggregator){const e=p.aggregation.property,t=(0,i()._g)({schema:o,property:e});if(!t)return"aggregation_deleted";if((0,r().FM)(p.aggregation)&&t&&!(0,l().JW)(t))return"aggregation_invalid";if("formula"===(null==t?void 0:t.type)&&"unique"===p.aggregation.aggregator){const e=(0,a().getFormulaPropertySchemaResultType)(t);if(!(0,l().UK)(e))return"aggregation_invalid"}}if((0,u().m)(t)){var d;const e=null===(d=t.dataConfig.aggregationConfig.stackOptions)||void 0===d?void 0:d.groupBy.property;if(e){const t=(0,i()._g)({schema:o,property:e});if(!t)return"stackBy_property_deleted";const r=(0,n().Eg)(t);if("formula"===t.type&&!r)return"stackBy_formula_not_groupable";if(!r)return"stackBy_property_not_groupable"}}}else{if("results_reducer"!==t.dataConfig.type)return"data_model_invalid";{const e=t.dataConfig.nameProperty;if(!e)return"name_property_not_configured";const r=(0,i()._g)({schema:o,property:e});if(!r)return"name_property_deleted";if(!(0,s().tH)(r))return"name_property_invalid";const a=t.dataConfig.valueProperty;if(!a)return"property_value_property_not_configured";const n=(0,i()._g)({schema:o,property:a});if(!n)return"property_value_property_deleted";if(!(0,s().Iw)(n))return"property_value_property_invalid"}}}function p(e){return"groupBy_property_not_configured"===e||"groupBy_property_deleted"===e||"groupBy_property_not_groupable"===e||"groupBy_formula_not_groupable"===e||"name_property_not_configured"===e||"name_property_deleted"===e||"name_property_invalid"===e}function g(e){return"aggregation_property_not_configured"===e||"aggregation_deleted"===e||"aggregation_invalid"===e||"property_value_property_not_configured"===e||"property_value_property_deleted"===e||"property_value_property_invalid"===e}function y(e){return"stackBy_property_deleted"===e||"stackBy_property_not_groupable"===e||"stackBy_formula_not_groupable"===e||"stackBy_property_no_values"===e}function m(e){return d.has(e)}function h(e){return"stackBy_property_no_values"===e}},288739:(e,t,o)=>{o.d(t,{M:()=>a});o(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"0.7 2.19 14.6 11.6",svg:(0,o(474848).jsx)("path",{d:"M3.142 2.332a.55.55 0 0 1 .695-.017l.081.077.227.264.007.01 8.773 10.235.056.082a.551.551 0 0 1-.818.701l-.08-.076-1.18-1.376A8.5 8.5 0 0 1 8 12.74c-3.027 0-5.685-1.569-7.026-3.911L.848 8.6a1.29 1.29 0 0 1 0-1.199l.126-.228c.705-1.233 1.776-2.251 3.073-2.94l-.965-1.125-.063-.091a.55.55 0 0 1 .123-.685m2.77 4.078a2.6 2.6 0 0 0-.537 1.588l.014.269a2.626 2.626 0 0 0 2.343 2.343l.268.014c.453 0 .878-.118 1.25-.32L8.023 8.872 8 8.874a.875.875 0 0 1-.861-1.032zM8 3.26c3.125 0 5.857 1.673 7.152 4.141l.065.144c.11.293.11.617 0 .91l-.065.145a7.5 7.5 0 0 1-2.255 2.577L10.58 8.475q.02-.103.031-.208l.014-.269A2.626 2.626 0 0 0 8 5.372l-.077.002-1.66-1.937A8.6 8.6 0 0 1 8 3.261"})},a=(0,o(340498).wt)("eyeSlashFillSmall",r)},322638:(e,t,o)=>{o.d(t,{FE:()=>j,FZ:()=>k,G_:()=>C,Iq:()=>P,Le:()=>B,QJ:()=>K,Qn:()=>z,RO:()=>M,TP:()=>A,TQ:()=>V,WG:()=>T,Zr:()=>_,Zv:()=>R,bg:()=>x,k1:()=>I,p7:()=>F,pP:()=>w,uB:()=>D,zH:()=>G});o(16280),o(944114);var r=()=>o(484714),a=()=>o(56366),n=()=>o(401497),i=()=>o(100594),s=()=>o(901610),l=()=>o(67657),u=()=>o(708685),d=()=>o(713998),c=()=>o(959013),p=()=>o(496603),g=()=>o(534177),y=()=>o(436696),m=()=>o(187899),h=()=>o(246826),f=()=>o(751156),v=()=>o(895876),S=()=>o(722372),b=()=>o(476492);const x=(0,c().YK)({chartType:{defaultMessage:"Chart type",id:"database.viewSettings.mainTab.chartType.title"},chartDevFeedbackLink:{defaultMessage:"Give dev feedback",id:"database.viewSettings.mainTab.chartDevFeedbackLink"},chartData:{defaultMessage:"Data",id:"database.viewSettings.mainTab.chartData.title"},chartStyle:{defaultMessage:"Style",id:"database.viewSettings.mainTab.chartStyle.title"},chartMoreStyle:{defaultMessage:"More style options",id:"database.viewSettings.mainTab.moreChartStyles.title"},chartXAxis:{defaultMessage:"X axis",id:"database.viewSettings.mainTab.axisChart.xAxis"},chartXAxisGroupByUnique:{defaultMessage:"Unique",id:"database.viewSettings.mainTab.axisChart.xAxis.groupBy.unique"},chartAggregateByValues:{defaultMessage:"Values",id:"database.viewSettings.mainTab.axisChart.aggregateByValues"},chartGroupBy:{defaultMessage:"Group by",id:"database.viewSettings.mainTab.axisChart.groupBy"},chartYAxisRange:{defaultMessage:"Range",id:"database.viewSettings.mainTab.axisChart.yAxisRange"},chartYAxisRangeMenu:{defaultMessage:"Set custom range",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMenu"},chartYAxisRangeAuto:{defaultMessage:"Auto",id:"database.viewSettings.mainTab.axisChart.yAxisRangeAuto"},chartYAxisRangeCustom:{defaultMessage:"Custom",id:"database.viewSettings.mainTab.axisChart.yAxisRangeCustom"},chartYAxisRangeReset:{defaultMessage:"Reset",id:"database.viewSettings.mainTab.axisChart.yAxisRangeReset"},chartYAxisRangeMinPlaceholder:{defaultMessage:"Min",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMinPlaceholder"},chartYAxisRangeMaxPlaceholder:{defaultMessage:"Max",id:"database.viewSettings.mainTab.axisChart.yAxisRangeMaxPlaceholder"},chartSortBy:{defaultMessage:"Sort by",id:"database.viewSettings.mainTab.axisChart.sortBy"},chartYAxis:{defaultMessage:"Y axis",id:"database.viewSettings.mainTab.axisChart.yAxis"},chartCumulative:{defaultMessage:"Cumulative",id:"database.viewSettings.mainTab.axisChart.cumulative"},chartHelp:{defaultMessage:"Learn about charts",id:"database.viewSettings.mainTab.charts.learnMoreButton"},chartDuplicate:{defaultMessage:"Duplicate chart",id:"database.viewSettings.mainTab.charts.duplicate"},chartReset:{defaultMessage:"Reset chart",id:"database.viewSettings.mainTab.charts.reset"},chartWhatToShow:{defaultMessage:"What to show",id:"database.viewSettings.mainTab.charts.whatToShow"},chartSliceDonutBy:{defaultMessage:"Slice donut by",id:"database.viewSettings.mainTab.charts.sliceDonutBy"},chartSliceDonutAggregation:{defaultMessage:"Each slice represents",id:"database.viewSettings.mainTab.charts.sliceDonutAggregation"},noneMenuItem:{defaultMessage:"None",id:"database.viewSettings.mainTab.charts.noneMenuItem"},noResultsMenuItem:{defaultMessage:"No results",id:"chartSettingsPropertySearchMenuItem.search.noResults.title"},chartIncludeSubitems:{defaultMessage:"Include sub-items",id:"database.viewSettings.mainTab.charts.includeSubitems"}}),_=(0,c().YK)({chartStyleTitle:{defaultMessage:"Style",id:"database.viewSettings.chartStyleTab.title"},chartColor:{defaultMessage:"Color",id:"database.viewSettings.chartStyleTab.chartColor"},chartHeight:{defaultMessage:"Height",id:"database.viewSettings.chartStyleTab.chartHeight"},chartSmoothLine:{defaultMessage:"Smooth line",id:"database.viewSettings.chartStyleTab.chartSmoothLine"},chartLineFillArea:{defaultMessage:"Gradient area",id:"database.viewSettings.chartStyleTab.chartLineFillArea"},chartWeightColorValue:{defaultMessage:"Color by value",id:"database.viewSettings.chartStyleTab.chartWeightColorValue"},chartGroupStyle:{defaultMessage:"Group style",id:"database.viewSettings.chartStyleTab.groupStyle"},chartGridLine:{defaultMessage:"Grid line",id:"database.viewSettings.chartStyleTab.chartGridLine"},chartAxisAvatarFormat:{defaultMessage:"Label style",id:"database.viewSettings.chartStyleTab.chartAxisAvatarFormat"},chartAxisName:{defaultMessage:"Axis name",id:"database.viewSettings.chartStyleTab.chartAxisName"},chartLegend:{defaultMessage:"Legend",id:"database.viewSettings.chartStyleTab.chartLegend"},chartCaption:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaption"},chartCaptionPlaceholder:{defaultMessage:"Caption",id:"database.viewSettings.chartStyleTab.chartCaptionPlaceholder"},chartHideEmptyGroups:{defaultMessage:"Omit zero values",id:"database.viewSettings.chartStyleTab.chartOmitZeroValues"},chartDataLabels:{defaultMessage:"Data labels",id:"database.viewSettings.chartStyleTab.chartDataLabels"},chartShowDonutValue:{defaultMessage:"Show value in center",id:"database.viewSettings.chartStyleTab.chartHideDonutValue"},chartValueLabelPlaceholder:{defaultMessage:"Value label",id:"database.viewSettings.chartStyleTab.chartValueLabelPlaceholder"}}),C=(0,c().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.gridOptions.none"},horizontal:{defaultMessage:"Horizontal",id:"database.viewSettings.chartStyleTab.gridOptions.horizontal"},vertical:{defaultMessage:"Vertical",id:"database.viewSettings.chartStyleTab.gridOptions.vertical"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.gridOptions.both"}}),w=(0,c().YK)({auto:{id:"database.viewSettings.chartStyleTab.colorTheme.auto",defaultMessage:"Auto"},colorful:{id:"database.viewSettings.chartStyleTab.colorTheme.colorful",defaultMessage:"Colorful"},gray:{id:"database.viewSettings.chartStyleTab.colorTheme.gray",defaultMessage:"Colorless"},blue:{id:"database.viewSettings.chartStyleTab.colorTheme.blue",defaultMessage:"Blue"},yellow:{id:"database.viewSettings.chartStyleTab.colorTheme.yellow",defaultMessage:"Yellow"},green:{id:"database.viewSettings.chartStyleTab.colorTheme.green",defaultMessage:"Green"},purple:{id:"database.viewSettings.chartStyleTab.colorTheme.purple",defaultMessage:"Purple"},teal:{id:"database.viewSettings.chartStyleTab.colorTheme.teal",defaultMessage:"Teal"},orange:{id:"database.viewSettings.chartStyleTab.colorTheme.orange",defaultMessage:"Orange"},pink:{id:"database.viewSettings.chartStyleTab.colorTheme.pink",defaultMessage:"Pink"},red:{id:"database.viewSettings.chartStyleTab.colorTheme.red",defaultMessage:"Red"}}),M=(0,c().YK)({avatar:{defaultMessage:"Avatar",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatar"},avatar_name:{defaultMessage:"Avatar and name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.avatarName"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.axisAvtarFormat.name"}}),B=(0,c().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.axisLabelOptions.none"},x_axis:{defaultMessage:"X axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.xAxis"},y_axis:{defaultMessage:"Y axis",id:"database.viewSettings.chartStyleTab.axisLabelOptions.yAxis"},both:{defaultMessage:"Both",id:"database.viewSettings.chartStyleTab.axisLabelOptions.both"}}),A=(0,c().YK)({normal:{defaultMessage:"Stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.normal"},percent:{defaultMessage:"Percent",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.percent"},side_by_side:{defaultMessage:"Not stacked",id:"database.viewSettings.chartStyleTab.axisGroupStyleFormat.side_by_side"}}),T=(0,c().YK)({small:{defaultMessage:"Small",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.small"},medium:{defaultMessage:"Medium",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.medium"},large:{defaultMessage:"Large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.large"},extra_large:{defaultMessage:"Extra large",id:"database.viewSettings.chartStyleTab.chartSettingsChartHeightFormat.extra_large"}}),G=(0,c().YK)({none:{defaultMessage:"None",id:"database.viewSettings.chartStyleTab.donutDataLabels.none"},value:{defaultMessage:"Value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.value"},name:{defaultMessage:"Name",id:"database.viewSettings.chartStyleTab.donutDataLabels.name"},name_and_value:{defaultMessage:"Name and value (%)",id:"database.viewSettings.chartStyleTab.donutDataLabels.nameAndValue"}}),k=(0,c().YK)({column:{id:"chartType.bar.vertical",defaultMessage:"Vertical bar"},bar:{id:"chartType.bar.horizontal",defaultMessage:"Horizontal bar"},line:{id:"chartType.line",defaultMessage:"Line"},donut:{id:"chartType.donut",defaultMessage:"Donut"}});function V(e){let{aggregation:t,databaseType:o,intl:r}=e;if((0,l().Iq)(t)&&o){const e=(0,p().ZH)((0,v().$O)(o));return r.formatMessage({id:"chartYAxis.aggregate.count",defaultMessage:"{value} count"},{value:e})}if((0,l().Iq)(t))return r.formatMessage({id:"chartYAxis.aggregate.unTypedCount",defaultMessage:"Count"});if("unique"===t.aggregator)return r.formatMessage({id:"chartYAxis.aggregate.distinct",defaultMessage:"Distinct"});{const e=(0,l().V1)(t);return S().SE[e]}}function F(e){if("placeholder"!==e.type&&"groups_reducer"===e.dataConfig.type)return e.dataConfig.aggregationConfig.aggregation}function K(e,t,o,r,a,n){if("placeholder"===t.type||t.type===e)return;let l;if("donut"===e){if("donut"===t.type)return;(0,s().m)(t)?l=(0,i().YU)(t,n):(0,g().HB)(t)}else(0,s().I)(e)?(0,s().m)(t)?l=(0,i().SK)(t,e):"donut"===t.type?l=(0,i()._x)(t,e):(0,g().HB)(t):(0,g().HB)(e);f().createAndCommit({userAction:"chartSettings.setChartType",environment:o,canUndo:!0,perform:e=>{h().zv({store:r.getFormatStore().getKeyStore("chart_config"),data:l,transaction:e})}}),(0,y().X)({environment:o,collectionContextStore:a,action:"charts_update_chart_type",charts_analytics_context:(0,b().nL)(a)})}function j(e){return{fill:e.palette.orange[400]}}function P(e){const t=e.type;if("formula"===t){const t=(0,u().getFormulaPropertySchemaResultType)(e);return"text"===t||"checkbox"===t||"person"===t}return"title"===t||"text"===t||"url"===t||"email"===t||"phone_number"===t||"checkbox"===t||"person"===t||"select"===t||"multi_select"===t||"status"===t||"relation"===t||"created_by"===t||"last_edited_by"===t}function D(e,t){const o=(0,a().K8)((()=>null==e?void 0:e.dataConfig),[e]);return(0,a().K8)((()=>{let e;if("groups_reducer"===(null==o?void 0:o.type)?e=o.groupBy.property:"results_reducer"===(null==o?void 0:o.type)&&(e=o.nameProperty),e&&t)return(0,d()._g)({schema:t,property:e})}),[o,t],{useDeepEqual:!0})}function R(e,t){const o=(0,a().K8)((()=>null==e?void 0:e.dataConfig),[e]);return(0,a().K8)((()=>{let e;if("groups_reducer"===(null==o?void 0:o.type)?e=o.aggregationConfig.aggregation.property:"results_reducer"===(null==o?void 0:o.type)&&(e=o.valueProperty),e)return(0,d()._g)({schema:t,property:e})}),[o,t],{useDeepEqual:!0})}function z(e){let{environment:t,collectionContextStore:o,chartConfig:r,sort:a}=e;const n=[];"results_reducer"===r.dataConfig.type&&("x-ascending"===a?n.push({property:r.dataConfig.nameProperty,direction:"ascending"}):"x-descending"===a&&n.push({property:r.dataConfig.nameProperty,direction:"descending"})),m().IU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryStateStore.state,sorts:{value:n}}})}function I(){const e=250,t=(0,r().Y0)();return(0,n().IS)((()=>({whatToShowRightText:{maxWidth:t.isMobile?e:125},sortByRightText:{maxWidth:t.isMobile?e:163},groupByRightText:{maxWidth:t.isMobile?e:151},donutSliceRightText:{maxWidth:t.isMobile?e:124},donutSliceValueRightText:{maxWidth:t.isMobile?e:95},avatarStyle:{maxWidth:t.isMobile?e:110},donutDataLabelsRightText:{maxWidth:t.isMobile?e:90}})),[t.isMobile])}},374136:(e,t,o)=>{o.d(t,{_G:()=>O,$k:()=>k,w$:()=>I,H$:()=>P,l9:()=>H,NH:()=>z,jY:()=>j,JI:()=>D,ck:()=>K,i5:()=>R,EN:()=>W,gc:()=>V,wK:()=>F});var r=()=>o(244641),a=o(296540),n=()=>o(401497),i=()=>o(764880),s=()=>o(100594),l=()=>o(901610),u=()=>o(921598),d=()=>o(713998),c=()=>o(825237),p=()=>o(792071),g=o(474848);const y=a.memo((function(e){const{size:t,style:o,icon:r,baseUrl:a,getRecordModel:n}=e;return(0,g.jsx)("div",{style:{height:t,width:t,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,verticalAlign:"top",marginTop:1,...o},children:(0,g.jsx)(f,{icon:r,size:t,baseUrl:a,getRecordModel:n})})}));function m(e){return.9*e}function h(e){return.888*e}function f(e){let{icon:t,size:r,baseUrl:a,getRecordModel:n}=e;if(!t)return null;const i=(e,t)=>{const o=c().wY({url:e,baseUrl:a,fullyQualified:!0,permissionRecord:t,width:h(r),userId:void 0});return(0,g.jsx)("img",{alt:"icon",src:o,style:{width:h(r),height:h(r),objectFit:"cover",borderRadius:4,marginTop:1}})},s=(0,o(651124).WO)(t.icon);switch(s.type){case"unicode_emoji":return(0,g.jsx)("div",{style:{fontSize:m(r)},children:s.emoji.unicode});case"custom_emoji":const e=p().xm7.resolveCustomEmojiIcon(t,n);return e?i(e.icon,e.pointer):null;case"app_package_asset":case"notion_icon":case"url":return i(t.icon,t.pointer);default:(0,o(534177).HB)(s)}}var v=()=>o(216519);const S=function(e){const{botValue:t,avatarSize:r,baseUrl:a,theme:n,style:i}=e;if(null!=t&&t.icon){const s=o(522419).GM(t.icon)?c().x8({url:t.icon,width:e.avatarSize,fullyQualified:!0,stripGoogleIconQuery:!0,baseUrl:a,userId:void 0}):t.icon;return(0,g.jsx)("div",{style:{...(0,v().fo)({theme:n,avatarSize:r}),...i},children:(0,g.jsx)("img",{src:s,style:{display:"block",width:"100%",height:"100%",objectFit:"cover"}})})}if(null!=t&&t.name){const e=t.name[0];return(0,g.jsx)("div",{children:(0,g.jsx)("div",{style:{...(0,v().ws)({theme:n,avatarSize:r}),...i},children:(0,g.jsx)("div",{children:e})})})}return(0,g.jsx)("span",{children:"🤖"})};var b=()=>o(597777),x=()=>o(869190),_=()=>o(72135),C=()=>o(379632),w=()=>o(437607),M=()=>o(381349),B=()=>o(284371),A=()=>o(780054),T=()=>o(10594),G=()=>o(698449);const k=(0,o(959013).YK)({titlePlaceholder:{defaultMessage:"Untitled",id:"chartLabelFormatHelpers.untitledBlock"}});function V(e,t,o){const r=(0,n().IS)((e=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},initialStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor},avatarStyle:{background:"none"},botStyle:{backgroundColor:e.chartAvatarBackgroundColor,border:`1px solid ${e.chartAvatarBorderColor}`,color:e.chartAvatarColor,fontSize:o?8:10},avatarWrapper:{flexShrink:0},nameWrapper:{minWidth:0,...B().RC}})),[o]);return(0,a.useCallback)(((a,n)=>{var s,l,u;if(!n)return a.toString();let d,c,y;if(n.actorPointer&&e)if(n.actorPointer.table===w().n){var m;c=e(n.actorPointer),y=(0,G().Pf)({intl:t,groupName:null===(m=c)||void 0===m?void 0:m.name})}else{var h;const o=(0,i().xC)({pointer:n.actorPointer,getRecordModel:e});c=null==o?void 0:o.asActor,y=null===(h=c)||void 0===h?void 0:h.getDisplayName(t)}return y||(y=a||t.formatMessage(p().Fvx.messages.anonymousPlaceholder)),d="space_permission_group"===(null===(s=c)||void 0===s?void 0:s.table)?(0,g.jsx)(v().Ay,{userValue:{name:"?"},avatarSize:o?16:20,baseUrl:A().A.domainBaseUrl,theme:(0,M().x0)(),fontSize:o?8:10,initialStyle:r.initialStyle,avatarStyle:r.avatarStyle}):null!==(l=c)&&void 0!==l&&l.isUser()?(0,g.jsx)(v().Ay,{userValue:c,avatarSize:o?16:20,baseUrl:A().A.domainBaseUrl,theme:(0,M().x0)(),fontSize:o?8:10,initialStyle:r.initialStyle,avatarStyle:r.avatarStyle}):null!==(u=c)&&void 0!==u&&u.isBot()?(0,g.jsx)(S,{botValue:c,avatarSize:o?16:20,baseUrl:A().A.domainBaseUrl,theme:(0,M().x0)(),style:r.botStyle}):(0,g.jsx)(v().Ay,{userValue:{name:"?"},avatarSize:o?16:20,baseUrl:A().A.domainBaseUrl,theme:(0,M().x0)(),fontSize:o?8:10,initialStyle:r.initialStyle,avatarStyle:r.avatarStyle}),C().A.renderToStaticMarkup((0,g.jsxs)("div",{style:r.wrapper,children:[(0,g.jsx)("div",{style:r.avatarWrapper,children:d}),o?(0,g.jsx)("div",{style:r.nameWrapper,children:y}):null]}))}),[e,t,o,r])}function F(e,t,o){const r=(0,n().IS)((()=>({wrapper:{display:"flex",alignItems:"center",gap:6,minWidth:0},avatarWrapper:{flexShrink:0},titleWrapper:{minWidth:0,...B().RC}})),[]),i=t.formatMessage(k.titlePlaceholder);return(0,a.useCallback)(((a,n)=>{if(!n||!e)return a.toString()||i;let s;if(n.pagePointer&&e&&(s=e(n.pagePointer)),!s)return a.toString()||i;const l=s.getRenderTitleWithPlaceholder({getRecordModel:e,userTimeZone:o,intl:t,isWorkflowsContainerWithCreationEnabled:!1}),u=s.getRenderIcon({getRecordModel:e});return C().A.renderToStaticMarkup((0,g.jsxs)("div",{style:r.wrapper,children:[u&&(0,g.jsx)("div",{style:r.avatarWrapper,children:(0,g.jsx)(y,{getRecordModel:e,icon:u,size:16,baseUrl:A().A.domainBaseUrl})}),(0,g.jsx)("div",{style:r.titleWrapper,children:l})]}))}),[e,o,t,i,r.wrapper,r.avatarWrapper,r.titleWrapper])}function K(e){var t,o,r,a;const n="count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(o=e.aggregation)||void 0===o?void 0:o.aggregator)?"number":D(e.propertySchema);let i;return i="count"===(null===(r=e.aggregation)||void 0===r?void 0:r.aggregator)||"unique"===(null===(a=e.aggregation)||void 0===a?void 0:a.aggregator)?"precision_0":"precision_from_number_property"===e.numberPrecisionOverride?R(e.propertySchema):e.numberPrecisionOverride,t=>"string"==typeof t?t:i&&"precision_uncapped"!==i?(0,_().ZV)(t,n,e.intl,"compact",i):(0,_().ZV)(W(t,2),n,e.intl,"compact",void 0)}function j(e){let{groupBy:t,dateFormat:o,intl:r}=e;return(e,a)=>{let n;return n=a?a.name:"string"==typeof e?e:e.toString(),P({dateString:n,dateFormat:o,groupBy:t,intl:r})}}function P(e){let{dateString:t,dateFormat:o,groupBy:a,intl:n}=e;const i=parseInt(t,10);if(isNaN(i))return t;switch(a){case"relative":default:return t;case"day":return(0,x().ZF)({value:{type:"date",start_date:r().c9.fromMillis(i).toISODate()},date_format:o||b().vz,allowRelativeDates:!0,intl:n});case"week":case"month":case"year":const e=r().c9.fromMillis(i),s={type:a,range:{type:"daterange",start_date:e.toISODate(),end_date:e.plus({[`${a}s`]:1}).minus({days:1}).toISODate()}};return(0,T().nc)({value:s,intl:n})}}function D(e){let t;return("number"===e.type||"formula"===e.type)&&(t=e.number_format),t}function R(e){return"number"===e.type||"formula"===e.type?e.number_precision:void 0}function z(e){let{chartConfig:t,schema:o,highChartsLabel:r,highChartsValue:a,isMultiSeries:n,intl:i,numberPrecisionOverride:u}=e,c=r,p=a;if(!t)return{label:c,value:p};const g=t.dataConfig;let y,m,h,f;if(n){if((0,l().m)(t)&&"groups_reducer"===t.dataConfig.type){var v;const e=t.dataConfig;if(y=null===(v=e.aggregationConfig.stackOptions)||void 0===v?void 0:v.groupBy,y){const e=(0,d()._g)({schema:o,property:y.property});e&&(0,s().zn)(e)&&(m=e)}f=e.aggregationConfig.aggregation,"count"!==f.aggregator&&(h=(0,d()._g)({schema:o,property:f.property}))}}else"groups_reducer"===g.type?(y=g.groupBy,m=(0,d()._g)({schema:o,property:g.groupBy.property}),f=g.aggregationConfig.aggregation,"count"!==f.aggregator&&(h=(0,d()._g)({schema:o,property:f.property}))):h=(0,d()._g)({schema:o,property:g.valueProperty});if(c=m?I({propertySchema:m,groupByFormat:y,aggregation:void 0,highChartsLabel:r,intl:i}):c,p&&"number"==typeof p&&h&&(0,s().JW)(h)){var S,b,x,C;const e="count"===(null===(S=f)||void 0===S?void 0:S.aggregator)||"unique"===(null===(b=f)||void 0===b?void 0:b.aggregator)?"number":D(h),t="count"===(null===(x=f)||void 0===x?void 0:x.aggregator)||"unique"===(null===(C=f)||void 0===C?void 0:C.aggregator)?"precision_0":u??R(h);p=t&&"precision_uncapped"!==t?(0,_().ZV)(p,e,i,"compact",t):(0,_().ZV)(W(p,2),e,i,"compact")}return{label:c,value:p}}function I(e){const{propertySchema:t,groupByFormat:o,aggregation:r,highChartsLabel:a,intl:n}=e;if(t&&(0,s().JW)(t)){const e="count"===(null==r?void 0:r.aggregator)||"unique"===(null==r?void 0:r.aggregator)?"number":D(t),o=parseInt(a,10);return isNaN(o)||"percent"===e?a:(0,_().ZV)(o,e,n,"compact")}const i="formula"===(null==o?void 0:o.type)?o.groupBy:o;return t&&(0,s().i8)(t)&&i&&(0,u().Ik)(i)?P({dateString:a,dateFormat:t.date_format,groupBy:i.groupBy,intl:n}):a}const L=1.2,E=2;function O(e){var t,o,r,a;if("count"===(null===(t=e.aggregation)||void 0===t?void 0:t.aggregator)||"unique"===(null===(o=e.aggregation)||void 0===o?void 0:o.aggregator))return!1;return"percent"===D(e.propertySchema)||(void 0!==e.userYAxisMax&&void 0!==e.userYAxisMin&&Math.abs(e.userYAxisMax-e.userYAxisMin)<E||(!!(null!==(r=e.userYAxisMax)&&void 0!==r&&r.toString().includes(".")||null!==(a=e.userYAxisMin)&&void 0!==a&&a.toString().includes("."))||Math.abs(e.dataYAxisMax)<L&&Math.abs(e.dataYAxisMin)<L))}function H(e){return e%1==0?e:e.toFixed(1)}function W(e,t){const o=Math.pow(10,t);return Math.round(e*o)/o}},514608:(e,t,o)=>{o.r(t),o.d(t,{eyeFillSmallIcon:()=>n,iconDefinition:()=>a});o(296540);var r=o(474848);const a={viewBox:"0 0 16 16",fittedViewBox:"0.7 3.26 14.6 9.48",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M8 7.122a.875.875 0 1 1 0 1.75.875.875 0 0 1 0-1.75"}),(0,r.jsx)("path",{d:"M8 3.26c3.125 0 5.857 1.673 7.152 4.141l.065.144c.11.293.11.617 0 .91l-.065.145c-1.295 2.468-4.027 4.14-7.152 4.14-3.027 0-5.685-1.57-7.026-3.912L.848 8.6a1.29 1.29 0 0 1 0-1.199l.126-.228C2.314 4.83 4.972 3.26 8 3.26m0 2.112a2.626 2.626 0 0 0-2.625 2.626l.014.269A2.626 2.626 0 0 0 7.73 10.61l.269.014a2.626 2.626 0 0 0 2.611-2.357l.014-.269A2.626 2.626 0 0 0 8 5.372"})]})},n=(0,o(340498).wt)("eyeFillSmall",a)},596369:(e,t,o)=>{o.d(t,{L:()=>_});o(581454);var r=o(296540),a=()=>o(484714),n=()=>o(56366),i=()=>o(401497),s=()=>o(452706),l=()=>o(187881),u=o(474848);const d={viewBox:"0 0 20 20",fittedViewBox:"0.97 2.72 18.06 14.56",svg:(0,u.jsx)("path",{d:"M3.892 2.875a.626.626 0 0 1 .79-.02l.092.088.128.148.015.033.072.105 11.27 13.148a.623.623 0 0 1-1.034.68l-1.615-1.884c-1.12.408-2.338.633-3.61.633-3.757 0-7.049-1.946-8.707-4.843l-.155-.283a1.46 1.46 0 0 1 0-1.359l.155-.283c.89-1.554 2.249-2.834 3.898-3.687L3.825 3.757l-.072-.105a.626.626 0 0 1 .14-.777m3.519 5.066a3.3 3.3 0 0 0-.717 2.056l.004.17A3.307 3.307 0 0 0 9.83 13.3l.17.004c.595 0 1.151-.161 1.634-.437l-1.52-1.773a1.104 1.104 0 0 1-1.18-1.377zM10 4.194c3.878 0 7.26 2.075 8.862 5.127l.073.164c.126.332.126.7 0 1.032l-.073.163a9.3 9.3 0 0 1-2.987 3.327l-2.69-3.138q.095-.338.116-.702l.005-.17a3.31 3.31 0 0 0-3.136-3.303L10 6.691a3 3 0 0 0-.377.022L7.68 4.447A10.7 10.7 0 0 1 10 4.194"})},c=(0,o(340498).wt)("eyeSlashFill",d);var p=()=>o(230979),g=()=>o(68207),y=()=>o(959013),m=()=>o(285790),h=()=>o(678553),f=()=>o(89924),v=()=>o(859428),S=()=>o(10594),b=()=>o(553965);function x(e){const t=(0,a().Y0)(),r=(0,i().IS)((o=>{let r,a=t.isMobile?o.popoverBackground:o.surface.wash;return"yellow"===e.color&&(a=o.fill.yellowSecondary,r=o.text.uiYellowPrimary),{container:{display:"flex",width:"100%",position:"relative",borderRadius:6,padding:t.isPhone?16:12,backgroundColor:a},icon:{width:14,height:14,marginTop:2},messageContainer:{display:"flex",flexDirection:"column",fontSize:t.isPhone?14:12},title:{fontWeight:500,color:e.color?r:void 0},caption:{color:e.color?r:o.text.secondary}}}),[t,e.color]);return(0,u.jsx)(f().A,{topBorder:!0,shouldShowBottomDivider:t.isMobile,style:{padding:12},children:(0,u.jsxs)("div",{style:r.container,children:[e.icon&&(0,u.jsxs)(u.Fragment,{children:[!t.isPhone&&e.icon(r.icon),(0,u.jsx)(o(132389).A,{size:8})]}),(0,u.jsxs)("div",{style:r.messageContainer,children:[(0,u.jsx)("div",{style:r.title,children:e.title}),(0,u.jsx)("div",{style:r.caption,children:e.caption})]})]})})}const _=r.memo((function(e){const{groupBy:t,groupByKey:i,groupsFormatKey:l,collectionContextStore:d,groupsDisplayState:c,disableReorder:p}=e,g=(0,a().v3)(),{isMobile:m}=(0,a().Y0)(),v=(0,n().O$)(d.normalizedSchemaStore),b=(0,n().O$)(d.normalizedFormatStore),_=(0,n().O$)(d.permissionScopesStore).canConfigureBlock,w=0===(null==c?void 0:c.visibleGroups.length)&&(null==c?void 0:c.hiddenGroups.length)>0,M=(0,n().K8)((()=>(0,S().Z3)({disableReorder:Boolean(p),groupByKey:i,format:b,canConfigureBlock:_,isMobile:m})),[p,i,b,_,m]),B=(0,n().K8)((()=>!(!c||"v2"!==c.version)&&(c.currentGroups.length>s().O3&&c.hasMore)),[c]),A=(0,r.useCallback)((()=>{if(!_)return;let e=[];e=w?(null==c?void 0:c.hiddenGroups.map((e=>({...e,hidden:void 0,emptyHidden:void 0}))))??[]:(null==c?void 0:c.currentGroups.map((e=>({...e,hidden:!0,emptyHidden:void 0}))))??[],d.groupsLimitStore.setState(S()._9),o(751156).createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:g,canUndo:!0,perform:t=>{(0,o(916260).o)({collectionContextStore:d,newGroups:e,groupsFormatKey:l,transaction:t})}}),(0,o(436696).X)({environment:g,collectionContextStore:d,action:"click_groups_hide_all"})}),[_,w,d,g,null==c?void 0:c.hiddenGroups,null==c?void 0:c.currentGroups,l]),T=(0,r.useMemo)((()=>({topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,title:(0,u.jsx)(y().sA,{...S().K0.groups}),desktopTitleStyle:{paddingTop:4,marginBottom:8}})),[]);if(!c||"v2"!==c.version)return(0,u.jsx)(f().A,{...T,children:(0,u.jsx)(o(331542).A,{style:{alignSelf:"center",marginBottom:12}})});if(0===c.currentGroups.length)return(0,u.jsx)(f().A,{...T,children:(0,u.jsx)(h().Ay,{title:(0,u.jsx)(y().sA,{...S().K0.noGroups})})});const G=c.currentGroups.map((e=>(0,o(921598).Ix)(e)));return(0,u.jsxs)(u.Fragment,{children:[B&&(0,u.jsx)(x,{title:(0,u.jsx)(y().sA,{...S().K0.groupLimitReachedTitle}),caption:(0,u.jsx)(y().sA,{...S().K0.groupLimitReachedCaption}),color:"yellow"}),(0,u.jsx)(f().A,{topBorder:!B,title:(0,u.jsx)(y().sA,{...S().K0.groups}),desktopStyle:B?{position:"relative",top:-12}:void 0,right:(0,u.jsx)(o(493823).p,{size:"sm",shouldShrink:!0,isBlue:!0,disabled:!_,onClick:A,style:{fontSize:12},children:w?(0,u.jsx)(y().sA,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"}):(0,u.jsx)(y().sA,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:(0,u.jsx)(o(2143).H,{type:o(756279).A.Y,style:{maxHeight:400},children:(0,u.jsx)(o(439264).Ay,{direction:"vertical",keys:G,disabled:!M,renderKey:(e,o)=>{const r=c.currentGroups[o];return(0,u.jsx)(C,{collectionContextStore:d,schema:v,groupsDisplayState:c,groupBy:t,groupFormat:r,groupsFormatKey:l,canReorder:M})},onDrop:e=>{c&&(0,o(607517).V)({environment:g,collectionContextStore:d,groupsFormatKey:l,groupByKey:i,currentGroups:c.currentGroups,newGroupIds:e,containsAllGroups:!0})}})})})]})}),o(821062).A),C=r.memo((function(e){const{collectionContextStore:t,schema:d,groupsDisplayState:f,groupBy:x,groupFormat:_,groupsFormatKey:C,canReorder:w}=e,M=(0,a().v3)(),B=(0,a().Y0)(),A=(0,y().tz)(),[T,G]=(0,r.useState)(!1),[k,V]=(0,r.useState)(!1),F=(0,n().O$)(t.permissionScopesStore).canConfigureBlock,K=(0,r.useCallback)((e=>{(0,o(939466).m)({environment:M,collectionContextStore:t,currentGroups:f.currentGroups,groupsFormatKey:C,groupFormat:_,action:e})}),[C,M,t,f.currentGroups,_]),j=()=>{K("toggle_group_visibility")},P=()=>{K("toggle_group_pin")},D={onMouseEnter:()=>{V(!0)},onMouseLeave:()=>{V(!1)}},R={onMouseEnter:()=>{G(!0)},onMouseLeave:()=>{G(!1)}},z=(0,i().IS)((()=>({icon:B.isMobile?{width:18,height:18}:{width:16,height:16},title:{marginLeft:-2,opacity:_.hidden?.4:1}})),[B.isMobile,_.hidden]);return(0,u.jsx)(h().Ay,{left:w?(0,u.jsx)(o(57232).A,{iconSize:12}):void 0,title:(0,u.jsx)(o(632537).d,{groupBy:x,groupFormat:_,currentGroups:f.currentGroups,schema:d,disabled:!0,isHiddenGroup:!1,collectionContextStore:t,source:"collection_settings"}),titleStyle:z.title,right:(0,u.jsxs)(u.Fragment,{children:["board_columns"===C&&(0,u.jsx)(v().A,{renderTooltip:e=>(0,u.jsx)(y().sA,{...e,..._.pinned?S().K0.unpinGroup:S().K0.pinGroup}),render:e=>{const t=T&&F;return _.pinned?(0,u.jsx)(m().A,{...(0,b().A)(e,R),icon:t?p().N:g().S,iconStyle:z.icon,color:"primary",ariaLabel:A.formatMessage(S().K0.unpinGroup),onClick:P,disabled:!F}):F?(0,u.jsx)(m().A,{...(0,b().A)(e,R),icon:t?g().S:p().N,iconStyle:z.icon,ariaLabel:A.formatMessage(S().K0.pinGroup),onClick:P,disabled:f.pinnedGroups.groups.length>=s().U5}):null}}),(0,u.jsx)(v().A,{renderTooltip:e=>(0,u.jsx)(y().sA,{...e,..._.hidden?S().K0.showGroup:S().K0.hideGroup}),render:e=>{const t=k&&F;let o=t?c:l().eyeFillIcon,r=!t;return _.hidden&&(o=t?l().eyeFillIcon:c,r=t),(0,u.jsx)(m().A,{...(0,b().A)(e,D),icon:o,iconStyle:z.icon,color:r?"primary":"secondary",ariaLabel:_.hidden?A.formatMessage(S().K0.showGroup):A.formatMessage(S().K0.hideGroup),onClick:j,disabled:!F})}})]})})}))},620586:(e,t,o)=>{o.d(t,{BV:()=>d,HH:()=>g,LF:()=>u,NF:()=>v,Pi:()=>c,Q1:()=>m,nH:()=>f,tm:()=>y,wW:()=>p});var r=()=>o(100594),a=()=>o(970013),n=()=>o(751735),i=()=>o(381349),s=()=>o(534177),l=()=>o(10594);function u(e){return void 0!==e&&"auto"!==e&&"colorful"!==e}function d(e,t){if("auto"!==e){if("colorful"===e)return i().OK.colorful.slice(0,6);if(c(e)){const o="gray"===e?"dark"===t.mode?"white":"black":e;return i().OK[o]}(0,s().HB)(e)}}function c(e){return r().VY.includes(e)}function p(e,t,o){const r=function(e,t,o){if("auto"===e)return;let r;if(r="gray"===e?"dark"===o.mode?"white":"black":e,t&&c(e)){const e=i().OK[r];return[e[0],e[3]]}return i().OK[r]}(e,t,o);if(r)return c(e)&&t?{colorAxis:{minColor:r[1],maxColor:r[0],showInLegend:!1},colors:r}:{colorAxis:void 0,colors:r}}function g(e){var t,o;let{collectionContextStore:r,groupValue:n,index:s,groupBy:u,theme:d,environment:c}=e;const g=r.normalizedSchemaStore.state,y=r.normalizedFormatStore.state;if("placeholder"===(null===(t=y.chart_config)||void 0===t?void 0:t.type)||void 0===n.value)return"light"===d.mode?i().OK.translucentGray[0]:i().OK.translucentGray[1];const m=g[u.property],h=m&&((0,a().lx)(m)||(0,a().DD)(m)),f=(null===(o=y.chart_config)||void 0===o||null===(o=o.chartFormat)||void 0===o?void 0:o.colorTheme)||"auto";if("auto"===f&&h){const e=(0,l().$e)({environment:c,groupFormat:{property:u.property,value:n},schema:g,format:y,theme:d,ignoreDisableColorColumns:!0});if(e)return e.chartColor}const v=p("auto"===f?"colorful":f,!1,d),S=(null==v?void 0:v.colors)||i().OK.colorful;return S[s%S.length]}function y(e,t){return t?{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,"rgba(0, 0, 0, 0)"],[1,"rgba(0, 0, 0, 0)"]]}:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,(0,n().X4)(e,.1)],[1,(0,n().X4)(e,0)]]}}const m=["gradient","blue","red","yellow","grey","none"],h=(0,o(959013).YK)({gradient:{defaultMessage:"Gradient",id:"chart.export.background.gradient"},blue:{defaultMessage:"Blue",id:"chart.export.background.blue"},red:{defaultMessage:"Red",id:"chart.export.background.red"},yellow:{defaultMessage:"Yellow",id:"chart.export.background.yellow"},grey:{defaultMessage:"Grey",id:"chart.export.background.grey"},none:{defaultMessage:"None",id:"chart.export.background.none"}});function f(e){return h[e]}function v(e,t,o){const r="light"===e.mode?o?100:50:o?600:500;switch(t){case"blue":return e.palette.blue[r];case"red":return e.palette.red[r];case"yellow":return e.palette.yellow[r];case"grey":return e.palette.gray[r];case"none":const a=o?e.buttonHoveredBackground:e.popoverBackground;return`linear-gradient(to top right, ${a} calc(50% - 1px), ${e.regularDividerColor}, ${a} calc(50% + 1px) )`;case"gradient":return`${o?`linear-gradient(${e.buttonHoveredBackground}, ${e.buttonHoveredBackground}), `:""}${"dark"===e.mode?"linear-gradient(123deg, #3C3F41 40.15%, #4A2F27 89.33%)":"linear-gradient(123deg, #FEF5E9 40.15%, #FEE9E9 89.33%)"}`;default:(0,s().HB)(t)}}},622281:(e,t,o)=>{o.d(t,{AY:()=>I,CL:()=>X,CS:()=>N,Tm:()=>j,UX:()=>z,cN:()=>P,hu:()=>Y,p4:()=>L});o(944114),o(898992),o(803949),o(581454);var r=()=>o(244641),a=()=>o(764880),n=()=>o(66689),i=()=>o(100594),s=()=>o(499755),l=()=>o(901610),u=()=>o(708685),d=()=>o(921598),c=()=>o(970013),p=()=>o(713998),g=()=>o(254947),y=()=>o(80979),m=()=>o(799829),h=()=>o(450648),f=()=>o(179034),v=()=>o(437607),S=()=>o(381349),b=()=>o(496603),x=()=>o(534177),_=()=>o(895876),C=()=>o(217429),w=()=>o(148832),M=()=>o(10594),B=()=>o(972435),A=()=>o(71304),T=()=>o(685889),G=()=>o(698449),k=()=>o(909470),V=()=>o(23815),F=()=>o(620586),K=()=>o(374136);function j(e){var t,o;const{collectionContextStore:r,groupedDataConfig:a,xAxisType:n,aggregationResults:l,subGroupResults:u,timezone:c,theme:g,environment:y,intl:m,groupTotals:h}=e;let{groupResults:f}=e;const v=null===(t=r.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!v||"placeholder"===v.type)return;const x=a.groupBy;if(!x)return;if(!(0,d().rj)(x.type))return;const _=a.aggregationConfig;if(!_)return;if(!l)return;const C=r.normalizedSchemaStore.state,w=(0,p()._g)({schema:C,property:x.property});if(!w)return;const M=null==v?void 0:v.chartFormat,B=null==M?void 0:M.weightColorValue,A=null==M?void 0:M.mainSort,T=null==M?void 0:M.smoothLine,G=Boolean(null==M?void 0:M.axisHideEmptyGroups),k="datetime"===n||"linear"===n;"formula"!==x.type&&"descending"===x.sort.type&&k&&(f=f.reverse());const V=!k,K=k;let j=0,P=0,z=[],I=[];const L=_.seriesFormat.displayType,H=null===(o=_.stackOptions)||void 0===o?void 0:o.groupBy;if(u&&H){if(!(0,p()._g)({schema:C,property:H.property}))return;const e=new Map,t=null==M?void 0:M.axisCumulative;let o=0;u.forEach((e=>{const a=e.value,n=E({collectionContextStore:r,groupBy:H,groupValue:a,removeUncategorizedDateOrNumber:!1,environment:y,intl:m,timezone:c});if(!n)return;const s=(0,d().AC)(a),u=l[s],p=u?O(u):void 0;if(G&&!p)return;const S=D(n.stringValue,L,T),{maxGroupValue:b,minGroupValue:_,dataPoints:C}=R({collectionContextStore:r,subGroupKey:s,groupBy:x,hideEmptyGroups:G,groupResults:f,aggregationResults:l,groupTotals:h,timezone:c,environment:y,shouldSetDataPointColor:"line"!==L&&!B,theme:g,intl:m,useIndexAsX:V,removeUncategorizedDateOrNumber:K,seriesDisplayType:L});var w;(S.color=(0,F().HH)({collectionContextStore:r,groupValue:a,index:o,groupBy:H,theme:g,environment:y}),"line"===L)&&(S.fillColor=(0,F().tm)(S.color,Boolean(null===(w=v.chartFormat)||void 0===w?void 0:w.hideLineFillArea)));if(t&&N(v)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:o}=$(C);S.data=o,"line"===L&&M.axisGroupStyle===i().PC.side_by_side?(e>j&&(j=e),t<P&&(P=t)):(j+=e,P+=t)}else S.data=C,j=Math.max(b,j),P=Math.min(_,P);z.push(S),o+=1})),"y-ascending"!==A&&"y-descending"!==A||(z=function(e,t){const o=(0,b().mg)(e);return o.forEach((e=>{const o=e.data.sort(((e,o)=>"y-ascending"===t?(e.total?e.total:0)-(o.total?o.total:0):(o.total?o.total:0)-(e.total?e.total:0)));o.forEach(((e,t)=>{e.x=t})),e.data=o})),o}(z,A));for(const r of z)for(const t of r.data)e.set(t.x,t);I=Array.from(e).sort(((e,t)=>e[0]-t[0])).map((e=>{let[t,o]=e;return o}))}else{var W;const e=w.name,{maxGroupValue:t,minGroupValue:o,dataPoints:a}=R({collectionContextStore:r,subGroupKey:void 0,groupBy:x,hideEmptyGroups:G,groupResults:f,aggregationResults:l,groupTotals:h,timezone:c,environment:y,shouldSetDataPointColor:"line"!==L&&!(0,F().LF)(null==M?void 0:M.colorTheme)&&!B,theme:g,intl:m,useIndexAsX:V,removeUncategorizedDateOrNumber:K,seriesDisplayType:L}),n=D(e.toString(),L,T);if("line"===L){var Y,X,q;const e=(null===(Y=(0,F().wW)((null===(X=v.chartFormat)||void 0===X?void 0:X.colorTheme)||"colorful",!1,g))||void 0===Y||null===(Y=Y.colors)||void 0===Y?void 0:Y[0])||S().OK.colorful[0];n.fillColor=(0,F().tm)(e,Boolean(null===(q=v.chartFormat)||void 0===q?void 0:q.hideLineFillArea))}if((null==M?void 0:M.axisCumulative)&&N(v)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:o}=$(a);n.data=o,j+=e,P+=t}else n.data=a,j=Math.max(t,j),P=Math.min(o,P);const i=null===(W=v.chartFormat)||void 0===W?void 0:W.mainSort;i!==s().S0.yAscending&&i!==s().S0.yDescending||(n.data=U(n.data,i)),I=n.data,z.push(n)}return{seriesData:z,maxValue:j,minValue:P,dataPointsForXAxisLabels:I}}function P(e){var t,o,r;const{groupedDataConfig:a,collectionContextStore:n,groupResults:i,aggregationResults:l,timezone:u,environment:d,theme:c,intl:g,groupTotals:y}=e,m=null===(t=n.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!m||"placeholder"===m.type)return;const h=n.normalizedSchemaStore.state,f=a.groupBy,v=(0,p()._g)({schema:h,property:f.property});if(!v)return;const S=v.name,{dataPoints:b}=R({collectionContextStore:n,subGroupKey:void 0,groupBy:f,groupResults:i,aggregationResults:l,groupTotals:y,timezone:u,environment:d,shouldSetDataPointColor:!Boolean(null===(o=m.chartFormat)||void 0===o?void 0:o.weightColorValue),theme:c,intl:g,hideEmptyGroups:!0,useIndexAsX:!0,removeUncategorizedDateOrNumber:!1}),x=null===(r=m.chartFormat)||void 0===r?void 0:r.mainSort;return x===s().S0.yAscending||x===s().S0.yDescending?[{name:S,data:U(b,x)}]:[{name:S,data:b}]}function D(e,t,o){let r;return r="line"===t?o?"areaspline":"area":t,{name:e,type:r,data:[]}}function R(e){var t;let{collectionContextStore:o,subGroupKey:r,groupBy:a,hideEmptyGroups:n,groupResults:s,aggregationResults:l,groupTotals:u,timezone:c,environment:p,shouldSetDataPointColor:g,theme:y,intl:m,useIndexAsX:h,removeUncategorizedDateOrNumber:f,seriesDisplayType:v}=e,S=0,b=0;const x=[],_=null===(t=o.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!_||"placeholder"===_.type)return{maxGroupValue:S,minGroupValue:b,dataPoints:x};let C=0;return s.forEach(((e,t)=>{var s,w,M,B,A;const T=e.value,G=(0,d().AC)(T),k=r?(0,d().A)([r,G]):G,V=l[k],K=l[G];if(!V||!K)return;const j=E({collectionContextStore:o,groupBy:a,removeUncategorizedDateOrNumber:f,groupValue:T,environment:p,intl:m,timezone:c}),P=O(V),D=(null===(s=u.get(G))||void 0===s?void 0:s.max)||0,R=(null===(w=u.get(G))||void 0===w?void 0:w.min)||0,z=(null===(M=u.get(G))||void 0===M?void 0:M.total)||0,I=g&&!r?(0,F().HH)({collectionContextStore:o,groupValue:T,index:C,groupBy:a,theme:y,environment:p}):void 0;if(void 0===j||void 0===P||void 0===D||void 0===R)return;if(n&&0===z)return;if(n&&"side_by_side"===(null===(B=_.chartFormat)||void 0===B?void 0:B.axisGroupStyle)&&0===P)return;const L=null===(A=_.chartFormat)||void 0===A?void 0:A.axisGroupStyle;let H;L===i().PC.side_by_side?(P>S&&(S=P),P<b&&(b=P)):"line"===v&&L===i().PC.normal?(S=Math.max(S,z),b=Math.min(b,z)):(S=Math.max(S,D),b=Math.min(b,R)),h?(H={x:r?t:C,y:P,name:j.stringValue,total:z},j.actorPointer&&(H.actorPointer=j.actorPointer)):H={x:j.numberValue,y:P,name:j.stringValue,total:z},I&&(H.color=I),H.groupFormat=e,x.push(H),C+=1})),{maxGroupValue:S,minGroupValue:b,dataPoints:x}}function z(e){var t,o;let{collectionContextStore:r,resultsDataConfig:a,resultsChartReducerResults:n,chartType:i,timezone:l,theme:d,intl:c}=e;const g=null===(t=r.collectionViewStore())||void 0===t?void 0:t.getChartConfig();if(!g||"placeholder"===g.type)return;const m=null==g?void 0:g.chartFormat,f=null==m?void 0:m.weightColorValue,v=null==m?void 0:m.smoothLine,b=r.normalizedSchemaStore.state,x=(0,p()._g)({schema:b,property:a.valueProperty});if(!x)return;const _=Boolean(null===(o=g.chartFormat)||void 0===o?void 0:o.axisHideEmptyGroups),M=[],B=x.name,A="axis"===i?a.valueSeriesFormat.displayType:"column",{maxDataPoint:T,minDataPoint:G,dataPoints:V}=function(e){var t,o,r;let{collectionContextStore:a,hideEmptyGroups:n,resultsDataConfig:i,resultsChartReducerResults:l,shouldSetDataPointColor:d,theme:c,useIndexAsX:g,timezone:m,intl:f}=e,v=0,S=0;const b=[],x=a.normalizedFormatStore.state.chart_config,_=a.collectionStore();if(!_||!x||"placeholder"===x.type||!l)return{maxDataPoint:v,minDataPoint:S,dataPoints:b};let M=0;const B=(null===(t=x.chartFormat)||void 0===t?void 0:t.colorTheme)||"auto",A=(0,F().wW)("auto"===B?"colorful":B,!1,c),T=a.normalizedSchemaStore.state,G=(0,p()._g)({schema:T,property:i.nameProperty}),V=(0,p()._g)({schema:T,property:i.valueProperty}),j=new Map,P=new Map,D=new Map;if(l.blockIds.forEach((e=>{const t=w().B.createChildStore(_,{table:"block",id:e,spaceId:_.getSpaceId()}),o=t.getModel(),r=(()=>{if("formula"===(null==G?void 0:G.type)){if("text"!==(0,u().getFormulaPropertySchemaResultType)(G)||!o)return;return(0,y().primitiveFormulaValueFromPropertySchema)({schema:T,property:i.nameProperty,blockModel:o,getRecordModel:t.getRecordModel,intl:f,userTimeZone:m,depth:0,resultCache:j,regExpCache:P,formatDateCache:D,experimentService:C().default,collectionFeatureGates:(0,k().i)()})??""}const e=t.getPropertyValue(i.nameProperty),r=(0,h().r4)({textValue:e,getRecordModel:t.getRecordModel,userTimeZone:m,intl:f});return"title"===(null==G?void 0:G.type)?r||f.formatMessage(K().$k.titlePlaceholder):r})(),a=(()=>{if("formula"===(null==V?void 0:V.type)){if("number"!==(0,u().getFormulaPropertySchemaResultType)(V)||!o)return;const e=(0,y().primitiveFormulaValueFromPropertySchema)({schema:T,property:i.valueProperty,blockModel:o,getRecordModel:t.getRecordModel,intl:f,userTimeZone:m,depth:0,resultCache:j,regExpCache:P,formatDateCache:D,experimentService:C().default,collectionFeatureGates:(0,k().i)()});if("number"!=typeof e)return;return e}const e=t.getPropertyValue(i.valueProperty);return(0,p().Me)(e)})();if(n&&void 0===a)return;let s;a&&a>v&&(v=a),a&&a<S&&(S=a);const l=null==A?void 0:A.colors;if(l&&d&&(s=l[M%l.length]),g){const e={x:M,y:a,name:r,color:s};"title"===(null==G?void 0:G.type)&&o&&(e.pagePointer=o.pointer),b.push(e)}M+=1})),(null==x||null===(o=x.chartFormat)||void 0===o?void 0:o.axisCumulative)&&N(x)){const{maxDataPoint:e,minDataPoint:t,cumulatedDataPoints:o}=$(b);return{maxDataPoint:e,minDataPoint:t,dataPoints:o}}const R=null===(r=x.chartFormat)||void 0===r?void 0:r.mainSort;if(R===s().S0.yAscending||R===s().S0.yDescending){const e=U(b,R);return{maxDataPoint:v,minDataPoint:S,dataPoints:e}}return{maxDataPoint:v,minDataPoint:S,dataPoints:b}}({collectionContextStore:r,hideEmptyGroups:_,resultsDataConfig:a,resultsChartReducerResults:n,shouldSetDataPointColor:"line"!==A&&!f,theme:d,useIndexAsX:!0,timezone:l,intl:c}),j=D(B.toString(),A,v);if("line"===A){var P,R,z;const e=(null===(P=(0,F().wW)((null===(R=g.chartFormat)||void 0===R?void 0:R.colorTheme)||"colorful",!1,d))||void 0===P||null===(P=P.colors)||void 0===P?void 0:P[0])||S().OK.colorful[0];j.fillColor=(0,F().tm)(e,Boolean(null===(z=g.chartFormat)||void 0===z?void 0:z.hideLineFillArea))}return j.data=V,M.push(j),{maxValue:T,minValue:G,seriesData:M}}function I(e){let{groupedDataConfig:t,hideEmptyGroups:o,mainSort:r}=e;if(o||"y-ascending"===r||"y-descending"===r)return"category";const{type:a}=t.groupBy;return(0,d().Ik)(t.groupBy)&&"relative"!==t.groupBy.groupBy?"datetime":"number"===a?"linear":"category"}function L(e){let{mainSort:t,xAxisType:o}=e;return"datetime"===o&&"x-descending"===t||"linear"===o&&"x-descending"===t}function E(e){let{collectionContextStore:t,groupBy:o,groupValue:n,removeUncategorizedDateOrNumber:i,environment:s,intl:u,timezone:y}=e;const h=t.collectionViewBlockStore();if(!h)return;const S=t.normalizedSchemaStore.state,b=(0,p()._g)({schema:S,property:o.property});if(!b)return;const _=b.name;if(!n.value){if(i&&("number"===n.type&&"number"===(null==b?void 0:b.type)||(0,d().DH)(n)))return;if((0,d().D1)(n)&&(0,c().nC)(b)){const e=h.getAssociatedCollectionStore();return{stringValue:W(_,!!e&&(0,V().Vu)({collectionStore:e,property:o.property,propertySchema:b,parentStore:e}))}}return{stringValue:W(_)}}if((0,d().DH)(n)){const e=(0,M().nc)({intl:u,value:n.value}),t="formula"===o.type?o.groupBy:o;if((0,d().Ik)(t)&&"relative"===t.groupBy)return{stringValue:e};if("day"===n.value.type||"month"===n.value.type||"week"===n.value.type||"year"===n.value.type){const e=r().c9.fromISO(n.value.range.start_date,{zone:y}).startOf("day").toMillis();return{stringValue:e.toString(),numberValue:e}}return{stringValue:e}}if((0,d().D1)(n)&&(0,c().nC)(b)){const e=n.value;if((0,d().WO)(e)){const t=e.id,o=w().B.createChildStore(h,{id:t,table:f().ev});return{stringValue:(0,A().tS)({environment:s,intl:u,store:o})}}if((0,d().zx)(e)){var C;const t=(0,T().LQ)(b,h);if(!t)return;const o=null===(C=m().n$[t])||void 0===C||null===(C=C[e.value.variable])||void 0===C?void 0:C.messageDescriptor;return o?{stringValue:u.formatMessage(o)}:void 0}}else if((0,d().rM)(n)){const e=n.value,t=null==e?void 0:e.type;if("by_group"===t&&null!=e&&e.group)return(0,g().wC)(e.group)?{stringValue:u.formatMessage((0,g().gh)(e.group))}:{stringValue:e.group};if("by_option"===t&&null!=e&&e.option)return{stringValue:null==e?void 0:e.option}}else{if("select"===n.type||"multi_select"===n.type)return{stringValue:n.value};if("number"===n.type){var B;const e=n.value,o=e.type;let r;const a=null===(B=t.collectionViewStore())||void 0===B?void 0:B.getChartConfig();var k;if(a&&(0,l().m)(a))r=null===(k=a.chartFormat)||void 0===k?void 0:k.numberPrecisionOverride;const i=(0,K().ck)({propertySchema:b,aggregation:void 0,intl:u,numberPrecisionOverride:r});if(!i)return;if("range"===o)return{stringValue:i(e.start),numberValue:e.start};if("unique"===o)return{stringValue:i(e.value),numberValue:e.value};if("out_of_range"===o)return;(0,x().HB)(o)}else{if((0,d().GG)(n)){const e=n.value;if(e.table===v().n){const t=h.getRecordModel(e);if(!t)return;return{stringValue:(0,G().Pf)({intl:u,groupName:t.name}),actorPointer:e}}const t=(0,a().xC)({pointer:e,getRecordModel:h.getRecordModel});if(!t)return;return{stringValue:(0,a().lR)(u,t),actorPointer:e}}if("checkbox"===n.type)return{stringValue:b.name};if("title"===n.type){if("exact"===n.value.type)return{stringValue:n.value.value||u.formatMessage(K().$k.titlePlaceholder)}}else if((0,d().kO)(n)){if("exact"===n.value.type)return{stringValue:n.value.value}}else if("formula"===n.type&&"formula"===o.type){return E({collectionContextStore:t,groupBy:o,groupValue:n.value,removeUncategorizedDateOrNumber:i,environment:s,intl:u,timezone:y})}}}}function O(e){if(!e)return;const t=e.aggregationResult;return"number"===t.type?t.value:void 0}const H=(0,o(959013).YK)({chartUncategorizedGroup:{defaultMessage:"No {name}",id:"database.chartView.uncategorizedGroupLabel"}});function W(e,t){return t?B().A.formatMessage(V().zX.sprintUncategorizedGroup,{name:e??B().A.formatMessage(n().TZ.sprint_plural)}):B().A.formatMessage(H.chartUncategorizedGroup,{name:e??(0,_().oj)(void 0)})}function Y(e){if("column"!==e.type&&"bar"!==e.type)return!1;{const o=e.dataConfig.type;var t;if("groups_reducer"===o)return void 0===(null===(t=e.dataConfig.aggregationConfig.stackOptions)||void 0===t?void 0:t.groupBy);if("results_reducer"===o)return!0;(0,x().HB)(o)}}function U(e,t){const o=(0,b().mg)(e).sort(((e,o)=>{const r=void 0===e.y?-1/0:e.y,a=void 0===o.y?-1/0:o.y;return t===s().S0.yDescending?a-r:r-a}));return o.forEach(((e,t)=>{e.x=t})),o}function N(e){var t;const o=(0,l().m)(e),r="groups_reducer"===e.dataConfig.type?e.dataConfig.aggregationConfig.aggregation.aggregator:"count",a="count"===r||"sum"===r,n=null===(t=e.chartFormat)||void 0===t?void 0:t.mainSort;return o&&a&&"x-ascending"===n}function $(e){let t=0,o=0;const r=[];let a=0;for(const n of e){const e=n.y||0,i={...n,y:e+a};r.push(i),a+=e,a>o&&(o=a),a<t&&(t=a)}return{maxDataPoint:o,minDataPoint:t,cumulatedDataPoints:r}}function X(e){let{groupedChartReducerResults:t,chartConfig:o,sortType:r}=e;const a=null==t?void 0:t.aggregationResults;if(!a)return;const n=o.chartFormat,i=null==n?void 0:n.mainSort;let s;"main"!==r||"y-ascending"!==i&&"y-descending"!==i||(s="y-ascending"===i?"asc":"desc");const l=null==n?void 0:n.axisHideEmptyGroups,u=function(e){const{groupResults:t,aggregationResults:o,subGroupResults:r}=e,a=new Map;return t.forEach((e=>{const t=e.value,n=(0,d().AC)(t);let i=0,s=0;if(r)r.forEach((e=>{const t=e.value,r=(0,d().AC)(t),a=(0,d().A)([r,n]),l=O(o[a])||0;l>0&&(i+=l),l<0&&(s+=l)}));else{const e=O(o[n])||0;e>i&&(i=e),e<s&&(s=e)}a.set(n,{min:s,max:i,total:s+i})})),a}({aggregationResults:a,groupResults:t.results,subGroupResults:t.subGroupResults});return{aggregationResults:a,yAxisSortOrder:s,hideZeroAggregations:l||"donut"===o.type,groupTotals:u}}},656881:(e,t,o)=>{o.d(t,{b:()=>a,y:()=>n});var r=()=>o(972435);const a=(0,o(959013).YK)({noData:{defaultMessage:"No data",id:"chartError.noData"},badYAxisRange:{defaultMessage:"No data due to axis range",id:"chartError.badYAxisRange"},unconfiguredProperty:{id:"chartError.unconfiguredProperty",defaultMessage:"Property is not configured. Please make another selection."},unsupportedProperty:{id:"chartError.unsupportedProperty",defaultMessage:"This property type is not supported. Please select another property"},unsupportedFormula:{id:"chartError.unsupportedFormula",defaultMessage:"This formula is not supported. Please select another property or adjust your formula."},deletedProperty:{id:"chartError.deletedProperty",defaultMessage:"This property has been deleted. Please select another property."},invalidAggregation:{id:"chartError.invalidAggregation",defaultMessage:"Previously selected property is no longer valid with the current aggregation. Please make another selection."},invalidPropertyValueChart:{id:"chartError.invalidPropertyValueChart",defaultMessage:"Selected property is no longer valid with the previous configured chart. Please make another selection."},noValues:{id:"chartError.noValues",defaultMessage:"This property has no values. Please add some values or select another property."}});function n(e){switch(e){case"groupBy_property_not_configured":case"aggregation_property_not_configured":case"name_property_not_configured":case"property_value_property_not_configured":return r().A.formatMessage(a.unconfiguredProperty);case"groupBy_property_not_groupable":case"stackBy_property_not_groupable":return r().A.formatMessage(a.unsupportedProperty);case"groupBy_formula_not_groupable":case"stackBy_formula_not_groupable":return r().A.formatMessage(a.unsupportedFormula);case"groupBy_property_deleted":case"stackBy_property_deleted":case"aggregation_deleted":case"name_property_deleted":case"property_value_property_deleted":return r().A.formatMessage(a.deletedProperty);case"aggregation_invalid":return r().A.formatMessage(a.invalidAggregation);case"stackBy_property_no_values":return r().A.formatMessage(a.noValues);case"name_property_invalid":case"property_value_property_invalid":return r().A.formatMessage(a.invalidPropertyValueChart);default:return}}},714185:(e,t,o)=>{o.d(t,{f:()=>y});var r=()=>o(484714),a=()=>o(56366),n=()=>o(187174),i=()=>o(869558),s=()=>o(96689),l=()=>o(58293),u=()=>o(792415);const d=new(o(848776).U)((e=>{let{spaceId:t,collectionViewId:o}=e;return`${t}|${o}`}),(async(e,t)=>{let{spaceId:r,collectionViewId:a}=t;if(!r||!a)return{canViewChart:!1,canViewChartError:"paywall_error"};const n=await Promise.resolve().then(o.bind(o,449506)),i=await n.callApi({eventName:"canViewChart",environment:e,data:{spaceId:r,collectionViewId:a}});return"success"!==i.type?{canViewChart:!1,canViewChartError:"paywall_error"}:{canViewChart:i.data.can_view_chart,canViewChartError:void 0}}));o(604341).exposeDebugValue("CollectionViewCanViewChartStore",d);const c=d;var p=()=>o(589994),g=()=>o(329304);function y(e){let{collectionContextStore:t}=e;const o=(0,r().v3)(),d=(0,l().r)(),y=o.currentUser.id,m=null==d?void 0:d.id,h=(0,a().K8)((()=>{var e;return(null==d?void 0:d.id)===s().Zz||(null===(e=u().A.state.publicPageData)||void 0===e?void 0:e.spaceId)===s().Zz}),[d]),{collectionViewStore:f,collectionViewBlockStore:v}=(0,a().K8)((()=>({collectionViewStore:t.collectionViewStore(),collectionViewBlockStore:t.collectionViewBlockStore()})),[t]),S=(0,a().K8)((()=>{const e=null==f?void 0:f.id,o=t.updateFreeChartsResultStore.state;if(e&&o&&o.has(e))return o.get(e)}),[t.updateFreeChartsResultStore,f]),b=(0,g().P9)({name:"view_chart",spaceId:m,userId:y,amount:"unknown"}),[{value:x}]=(0,n().Yb)((async()=>{const e=null==f?void 0:f.id,t=null==f?void 0:f.getSpaceId();if(!e||!t)return{canViewChart:!1,canViewChartError:"paywall_error"};if(b||h)return{canViewChart:!0,canViewChartError:void 0};if(await p().transactionQueue.awaitRecordTransaction({table:i().Gy,id:e}),null!=S&&S.isPending)return{canViewChart:void 0,canViewChartError:void 0};if(null==v?void 0:v.pathIsAccessibleAndAlive())return void 0!==(null==S?void 0:S.value)?{canViewChart:S.value,canViewChartError:void 0}:await c.awaitData(o,{spaceId:t,collectionViewId:e});{const r=await c.awaitData(o,{spaceId:t,collectionViewId:e});return await c.awaitData(o,{spaceId:t,collectionViewId:e},Boolean(r))}}),[f,v,o,b,S,h]),{canViewChart:_,canViewChartError:C}=x??{canViewChart:void 0,canViewChartError:void 0};return{canViewChart:_,canViewChartError:C}}},812480:(e,t,o)=>{o.d(t,{Rb:()=>Me,WK:()=>ce,bO:()=>le,cS:()=>pe,eD:()=>de,hC:()=>ne,hU:()=>oe,oz:()=>te,rq:()=>re});o(16280),o(581454);var r=o(296540),a=()=>o(484714),n=()=>o(56366),i=()=>o(401497),s=()=>o(757695),l=()=>o(708685),u=()=>o(921598),d=()=>o(452706),c=()=>o(30626),p=()=>o(514608),g=()=>o(288739),y=()=>o(236262),m=()=>o(340498),h=()=>o(959013),f=()=>o(496603),v=()=>o(534177),S=()=>o(436696),b=()=>o(607517),x=()=>o(786452),_=()=>o(916260),C=()=>o(686526),w=()=>o(896628),M=()=>o(751156),B=()=>o(101981),A=()=>o(632537),T=()=>o(493823),G=()=>o(760217),k=()=>o(439264),V=()=>o(57232),F=()=>o(285790),K=()=>o(331542),j=()=>o(678553),P=()=>o(89924),D=()=>o(574036),R=()=>o(398217),z=()=>o(10594),I=()=>o(9151),L=()=>o(972435),E=()=>o(836251),O=()=>o(396671),H=()=>o(963589),W=()=>o(940371),Y=()=>o(701311),U=()=>o(596369),N=()=>o(95441),$=()=>o(735695),X=()=>o(497222),q=()=>o(828973),Z=()=>o(34423),Q=o(474848);const J=s().Store.createClass(void 0,{name:"ReducerResultStore"}),ee=s().Store.createClass(z()._9,{name:"GroupsLimitStore"});function te(e){const{collectionContextStore:t,groupsFormatKey:o,groupByKey:r,collectionSettingsStore:i}=e,s=(0,a().v3)(),l=(0,n().uB)(void 0,ee),d=(0,n().uB)(void 0,J),c=(0,n().O$)(d),p=(0,n().O$)(l),g=(0,n().K8)((()=>(0,u().H2)(t.normalizedFormatStore.state,r,o)),[t,r,o]),[m,f]=(0,O().d)({collectionContextStore:t,groupBy:g,groupsFormatKey:o,reducerResult:c,groupsLimit:p}),v=(0,n().O$)(t.normalizedSchemaStore),b=(0,n().K8)((()=>function(e,t){return he(e)&&(0,z().Qt)({viewType:me(e),groupByKey:t})}(t,r)),[t,r]);return(0,Q.jsxs)($().Ay,{collectionSettingsStore:i,title:(0,Q.jsx)(fe,{collectionSettingsStore:i,collectionContextStore:t}),children:[(0,Q.jsxs)(P().A,{children:[(0,Q.jsx)(ve,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:r,groupsFormatKey:o,groupBy:g}),g&&ae({groupBy:g,schema:v})&&(0,Q.jsx)(be,{collectionContextStore:t,collectionSettingsStore:i,groupByKey:r,groupsFormatKey:o,groupBy:g}),g&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(Z().T,{groupBy:g}),(0,Q.jsx)(xe,{collectionContextStore:t,groupByKey:r,groupBy:g,groupsFormatKey:o}),(0,Q.jsx)(_e,{groupByKey:r,collectionContextStore:t,groupsFormatKey:o,groupsDisplayState:m,groupBy:g})]}),g&&"board_columns_by"===r&&(0,Q.jsx)(Se,{collectionContextStore:t})]}),g&&(0,Q.jsx)(Be,{groupsFormatKey:o,collectionContextStore:t,groupByKey:r,reducerResultStore:d,groupsLimitStore:l,groupsDisplayState:m}),(0,Q.jsxs)(P().A,{topBorder:!0,children:[g&&b&&(0,Q.jsx)(X().A,{isGray:!0,icon:y().trashIcon,title:(0,Q.jsx)(h().sA,{defaultMessage:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),onClick:()=>function(e,t,o,r){const a=t.collectionViewStore();if(!a)return;M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleRemoveClick",environment:e,canUndo:!0,perform:e=>{w().zA({stores:[a],update:{[o]:void 0,[r]:void 0},transaction:e})}}),(0,S().X)({environment:e,collectionContextStore:t,action:"click_remove_grouping"})}(s,t,r,o),isRed:!0}),(0,Q.jsx)(N().A,{href:(0,E().xS)("guides.databaseGroup"),title:(0,Q.jsx)(h().sA,{defaultMessage:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),analyticsFrom:"view_settings_group"})]})]})}function oe(e){return e?(0,Q.jsx)(R().mA,{propertySchema:e,showIcon:!1}):void 0}function re(e,t){return"collection_group_by"===e&&"board"===t?(0,Q.jsx)(h().sA,{defaultMessage:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}):(0,Q.jsx)(h().sA,{defaultMessage:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function ae(e){const{groupBy:t,schema:o}=e,r=o[t.property];if(!r||!(0,u().Eg)(r))return;let a;if("formula"===r.type){const e=(0,l().getFormulaPropertySchemaResultType)(r);if("unknown"===e||"array"===e)return;a="block"===e?"relation":e}else a=r.type;return(0,u()._o)(a)||(0,u().Vs)(a)||"number"===a||"status"===a?a:void 0}function ne(e){const t=ae(e);if(t)return(0,u()._o)(t)?(0,Q.jsx)(h().sA,{defaultMessage:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,u().Vs)(t)?(0,Q.jsx)(h().sA,{defaultMessage:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?(0,Q.jsx)(h().sA,{defaultMessage:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?(0,Q.jsx)(h().sA,{defaultMessage:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function ie(e){return(0,u().Ik)(e)?e:"formula"===e.type&&"date"===e.groupBy.type?e.groupBy:void 0}function se(e){return(0,u().Vh)(e)?e:"formula"===e.type&&"text"===e.groupBy.type?e.groupBy:void 0}function le(e){return"number"===e.type?e:"formula"===e.type&&"number"===e.groupBy.type?{...e.groupBy,property:e.property}:void 0}function ue(e){const{groupBy:t}=e,o=ae(e);if(o)if((0,u()._o)(o)){const e=ie(t);if(e)return ge(e.groupBy)}else if((0,u().Vs)(o)){const e=se(t);if(e)return ye(e.groupBy)}else if("number"===o){const e=le(t);if(e)return(0,Q.jsx)(h().sA,{defaultMessage:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}const de=(0,h().YK)({group:{defaultMessage:"Group",id:"database.groupMenu.statusGroupBy.group"},option:{defaultMessage:"Option",id:"database.groupMenu.statusGroupBy.option"}});const ce=(0,h().YK)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Day",id:"database.groupMenu.dateGroupBy.day"},week:{defaultMessage:"Week",id:"database.groupMenu.dateGroupBy.week"},month:{defaultMessage:"Month",id:"database.groupMenu.dateGroupBy.month"},year:{defaultMessage:"Year",id:"database.groupMenu.dateGroupBy.year"}}),pe=(0,h().YK)({relative:{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"},day:{defaultMessage:"Days",id:"database.groupMenu.dateGroupBy.days"},week:{defaultMessage:"Weeks",id:"database.groupMenu.dateGroupBy.weeks"},month:{defaultMessage:"Months",id:"database.groupMenu.dateGroupBy.months"},year:{defaultMessage:"Years",id:"database.groupMenu.dateGroupBy.years"}});function ge(e){return"relative"===e?(0,Q.jsx)(h().sA,{...ce.relative}):"day"===e?(0,Q.jsx)(h().sA,{...ce.day}):"week"===e?(0,Q.jsx)(h().sA,{...ce.week}):"month"===e?(0,Q.jsx)(h().sA,{...ce.month}):"year"===e?(0,Q.jsx)(h().sA,{...ce.year}):void(0,v().HB)(e)}function ye(e){return"exact"===e?(0,Q.jsx)(h().sA,{defaultMessage:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?(0,Q.jsx)(h().sA,{defaultMessage:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,v().HB)(e)}function me(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function he(e){return e.permissionScopesStore.state.canConfigureBlock}function fe(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;const r=(0,n().K8)((()=>(0,W().S)(t)),[t]),a=(0,n().K8)((()=>me(o)),[o]);return r&&"group"===r.type?"collection_group_by"===r.groupByKey&&"board"===a?(0,Q.jsx)(h().sA,{defaultMessage:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):(0,Q.jsx)(h().sA,{defaultMessage:"Group",id:"database.viewSettings.groupTab.group.title"}):null}function ve(e){let{groupBy:t,collectionContextStore:o,collectionSettingsStore:r,groupByKey:i,groupsFormatKey:s}=e;const l=(0,a().v3)(),u=(0,n().O$)(o.normalizedSchemaStore),d=t?u[t.property]:void 0,c=(0,n().K8)((()=>he(o)),[o]),p=(0,n().K8)((()=>me(o)),[o]);return(0,Q.jsx)(X().A,{title:re(i,p),showChevron:!0,right:oe(d),onClick:()=>{(0,S().X)({environment:l,collectionContextStore:o,action:"click_group_by_property",original_view_type:void 0,property_type:null==d?void 0:d.type}),C().a2({collectionSettingsStore:r,item:{type:"groupByProperty",groupByKey:i,groupsFormatKey:s}})},disabled:!c})}function Se(e){const{collectionContextStore:t}=e,o=(0,a().v3)(),{canConfigureBlock:s}=(0,n().O$)(t.permissionScopesStore),l=(0,n().O$)(t.normalizedFormatStore),u=(0,n().K8)((()=>(0,z().FS)(l)),[l]),d=(0,r.useCallback)((()=>{C().ut({environment:o,collectionContextStore:t})}),[o,t]),c=(0,i().IS)((()=>({textWrapper:{opacity:1}})),[]);return(0,Q.jsx)(D().A,{title:(0,Q.jsx)(h().sA,{id:"database.viewSettings.groupTab.colorColumns",defaultMessage:"Color columns"}),on:!u,focused:!1,onClick:d,disabled:!s,textWrapperStyle:c.textWrapper})}function be(e){let{groupBy:t,collectionContextStore:o,collectionSettingsStore:r,groupByKey:i,groupsFormatKey:s}=e;const l=(0,a().v3)(),d=(0,n().O$)(o.normalizedSchemaStore),c=(0,n().K8)((()=>he(o)),[o]),p="formula"===t.type?{...t.groupBy,property:t.property}:t;return(0,u().Ik)(p)?(0,Q.jsx)(q().A,{title:ne({groupBy:p,schema:d}),popupStyle:{minWidth:190},selectedKey:p.groupBy,options:u().BI.map((e=>({key:e,type:"button",title:ge(e)}))),onChange:e=>function(e,t,o,r,a){const n=(0,u().H2)(o.normalizedFormatStore.state,r,a),i=o.collectionViewStore();if(!n||!i)return;const s=ie(n);if(s){if((0,u().Ik)(n))M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{w().zA({stores:[i],update:{[r]:{...n,groupBy:e},[a]:void 0},transaction:t}),"week"===e&&w().Jo(i,t)}});else if("formula"===n.type){const o={...f().cJ(s,"property"),type:"date",groupBy:e},l={...n,groupBy:o};M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{w().zA({stores:[i],update:{[r]:l,[a]:void 0},transaction:t}),"week"===e&&w().Jo(i,t)}})}(0,S().X)({environment:t,collectionContextStore:o,action:"update_date_group_by"})}}(e,l,o,i,s),disabled:!c}):(0,u().Vh)(p)?(0,Q.jsx)(q().A,{title:ne({groupBy:p,schema:d}),popupStyle:{minWidth:190},selectedKey:p.groupBy,options:u().ah.map((e=>({key:e,type:"button",title:ye(e)}))),onChange:e=>function(e,t,o,r,a){const n=(0,u().H2)(o.normalizedFormatStore.state,r,a),i=o.collectionViewStore();if(!n||!i)return;const s=se(n);if(s){if((0,u().Vh)(n))M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{w().zA({stores:[i],update:{[r]:{...n,groupBy:e},[a]:void 0},transaction:t})}});else if("formula"===n.type){const o={...f().cJ(s,"property"),groupBy:e},l={...n,groupBy:o};M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,canUndo:!0,perform:e=>{w().zA({stores:[i],update:{[r]:l,[a]:void 0},transaction:e})}})}(0,S().X)({environment:t,collectionContextStore:o,action:"update_text_group_by"})}}(e,l,o,i,s),disabled:!c}):"number"===p.type?(0,Q.jsx)(X().A,{title:ne({groupBy:p,schema:d}),showChevron:!0,right:ue({groupBy:p,schema:d}),onClick:()=>{C().a2({collectionSettingsStore:r,item:{type:"groupByNumber",groupByKey:i,groupsFormatKey:s}})},disabled:!c}):"status"===p.type?(0,Q.jsx)(q().A,{title:ne({groupBy:p,schema:d}),popupStyle:{minWidth:190},selectedKey:p.groupBy,options:u().PC.map((e=>{return{key:e,type:"button",title:(t=e,"group"===t?(0,Q.jsx)(h().sA,{...de.group}):"option"===t?(0,Q.jsx)(h().sA,{...de.option}):void(0,v().HB)(t))};var t})),onChange:e=>function(e,t,o,r,a){const n=(0,u().H2)(o.normalizedFormatStore.state,r,a),i=o.collectionViewStore();n&&i&&"status"===(null==n?void 0:n.type)&&(M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",environment:t,canUndo:!0,perform:t=>{w().zA({stores:[i],update:{[r]:{...n,groupBy:e},[a]:void 0},transaction:t})}}),(0,S().X)({environment:t,collectionContextStore:o,action:"update_status_group_by"}))}(e,l,o,i,s),disabled:!c}):null}function xe(e){let{groupBy:t,collectionContextStore:o,groupByKey:r,groupsFormatKey:i}=e;const s=(0,a().v3)(),l=(0,n().K8)((()=>(0,u().Nf)(t)),[t]),d=(0,n().K8)((()=>he(o)),[o]);if(l.length<=1)return null;const c=(0,u().Kq)(t);return(0,Q.jsx)(q().A,{title:(0,Q.jsx)(h().sA,{defaultMessage:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{minWidth:190},selectedKey:c.type,options:l.map((e=>({key:e,type:"button",title:L().A.formatMessage((0,z().rA)(t,e))}))),onChange:e=>{M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:s,canUndo:!0,perform:t=>{(0,x().y)({sortType:e,environment:s,collectionContextStore:o,groupByKey:r,groupsFormatKey:i,transaction:t})}})},disabled:!d})}function _e(e){let{groupBy:t,groupByKey:o,collectionContextStore:i,groupsFormatKey:s,groupsDisplayState:l}=e;const d=(0,a().v3)(),c=(0,r.useCallback)((()=>function(e,t,o,r,a){const n=(0,u().H2)(o.normalizedFormatStore.state,t,r);if(!a)return;const{currentGroups:i}=a,s=o.collectionViewStore();if(!n||!s)return;const l=!n.hideEmptyGroups;M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",environment:e,canUndo:!0,perform:e=>{if(l){const t=i.map((e=>!1===e.hidden?{...e,hidden:void 0}:e));(0,_().o)({collectionContextStore:o,newGroups:t,groupsFormatKey:r,transaction:e})}w().zA({stores:[s],update:{[t]:{...n,hideEmptyGroups:l}},transaction:e})}}),(0,S().X)({environment:e,collectionContextStore:o,action:"toggle_hide_empty_groups"})}(d,o,i,s,l)),[d,o,i,s,l]),p=(0,n().K8)((()=>he(i)),[i]);return(0,Q.jsx)(D().A,{title:(0,Q.jsx)(h().sA,{defaultMessage:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(t.hideEmptyGroups),focused:!1,onClick:c,disabled:!p,textWrapperStyle:{opacity:1}})}function Ce(e){const t=(0,a().v3)(),o=(0,h().tz)(),{groupFormat:r,canReorder:i,collectionContextStore:s,groupByKey:l,groupsFormatKey:d,groupsDisplayState:c,isLastGroup:y}=e,f=(0,n().O$)(s.normalizedSchemaStore),v=(0,u().tx)(r),b=(0,n().K8)((()=>(0,u().H2)(s.normalizedFormatStore.state,l,d)),[s,l,d]),x=(0,n().K8)((()=>he(s)),[s]);if(!b)return null;const C=y&&!v;return(0,Q.jsx)(j().Ay,{disabled:!x,title:(0,Q.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[i&&(0,Q.jsx)(V().A,{iconSize:12,style:{marginRight:3}}),(0,Q.jsx)(A().d,{groupBy:b,groupFormat:r,currentGroups:(null==c?void 0:c.currentGroups)??[],schema:f,disabled:!0,isHiddenGroup:!1,style:{padding:0},collectionContextStore:s,source:"collection_settings"})]}),right:C?null:(0,Q.jsx)(F().A,{icon:v?g().M:p().eyeFillSmallIcon,iconStyle:{width:m().Ev.sm,height:m().Ev.sm},color:v?"secondary":"primary",onClick:()=>{!function(e,t,o,r,a){if(!a)return;const{currentGroups:n}=a,i=n.map((t=>(0,u().Mn)(t,e)?{...e,hidden:!(0,u().tx)(e)}:t));M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupVisibility",environment:t,canUndo:!0,perform:e=>{(0,_().o)({collectionContextStore:o,newGroups:i,groupsFormatKey:r,transaction:e})}}),(0,S().X)({environment:t,collectionContextStore:o,action:"toggle_group_visibility"})}(r,t,s,d,c)},disabled:!x,ariaLabel:v?o.formatMessage(z().K0.showGroup):o.formatMessage(z().K0.hideGroup)}),textWrapperStyle:{opacity:1}})}function we(e){const t=(0,a().v3)(),{groups:o,canReorder:i,isHidden:s,collectionContextStore:l,groupByKey:d,groupsFormatKey:c,groupsDisplayState:p,disableHideAll:g}=e,y=(0,n().K8)((()=>he(l)),[l]),m=g&&1===o.length,h=o.map((e=>(0,u().Ix)(e)));return i?(0,Q.jsx)(k().Ay,{direction:"vertical",keys:h,renderKey:(e,t)=>{const r=o[t];return(0,Q.jsx)(Ce,{collectionContextStore:l,groupByKey:d,groupsFormatKey:c,groupsDisplayState:p,groupFormat:r,canReorder:i,isLastGroup:m})},onDrop:e=>{p&&(0,b().r)({newGroupIds:e,isHidden:s,environment:t,collectionContextStore:l,groupByKey:d,groupsFormatKey:c,currentGroups:p.currentGroups})},disabled:!y}):(0,Q.jsx)(Q.Fragment,{children:o.map((e=>(0,Q.jsx)(r.Fragment,{children:(0,Q.jsx)(Ce,{collectionContextStore:l,groupByKey:d,groupsFormatKey:c,groupsDisplayState:p,groupFormat:e,canReorder:i,isLastGroup:m})},(0,u().Ix)(e))))})}function Me(e){let{collectionContextStore:t,groupsFormatKey:o,groupByKey:s,groupsLimitStore:l,groupsDisplayState:d,disableHideAll:p,disableLoadMore:g,disableReorder:y}=e;const m=(0,i().DP)(),f=(0,a().v3)(),v=(0,r.useCallback)((()=>function(e,t,o,r,a){if(!a)return;const{currentGroups:n}=a,i=n.map((e=>({...e,hidden:!1})));r.setState(z()._9),M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleShowAllClick",environment:e,canUndo:!0,perform:e=>{(0,_().o)({collectionContextStore:t,newGroups:i,groupsFormatKey:o,transaction:e})}}),(0,S().X)({environment:e,collectionContextStore:t,action:"click_groups_show_all"})}(f,t,o,l,d)),[f,t,o,l,d]),b=(0,r.useCallback)((()=>function(e,t,o,r,a){if(!a)return;const{currentGroups:n}=a,i=n.map((e=>({...e,hidden:!0})));r.setState(z()._9),M().createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:e,canUndo:!0,perform:e=>{(0,_().o)({collectionContextStore:t,newGroups:i,groupsFormatKey:o,transaction:e})}}),(0,S().X)({environment:e,collectionContextStore:t,action:"click_groups_hide_all"})}(f,t,o,l,d)),[f,t,o,l,d]),x=(0,n().K8)((()=>(0,u().H2)(t.normalizedFormatStore.state,s,o)),[t,s,o]),C=(0,n().K8)((()=>he(t)),[t]),w=(0,n().K8)((()=>(0,z().Z3)({disableReorder:Boolean(y),groupByKey:s,format:t.normalizedFormatStore.state,canConfigureBlock:C,isMobile:f.device.isMobile})),[y,s,t.normalizedFormatStore,C,f.device.isMobile]),B=(0,n().O$)(l);if(!x)return null;if(!d)return(0,Q.jsx)(P().A,{topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,children:(0,Q.jsx)("div",{style:{marginTop:6,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,Q.jsx)(K().A,{})})});const A="v2"===d.version?void 0:Math.min(z().B2,d.total-d.hiddenGroups.length-d.visibleGroups.length),k=void 0!==A&&A>0&&!Boolean(g)?(0,Q.jsx)(G().A,{disabled:!1,focused:!1,style:{color:m.text.secondary},icon:(0,c()._)({width:14,height:14}),title:(0,Q.jsx)(h().sA,{id:"database.groupMenu.loadMoreButton.text",defaultMessage:"Show {loadMoreAmount, plural, one {{loadMoreAmount} more group} other {{loadMoreAmount} more groups}}",values:{loadMoreAmount:A}}),onClick:()=>{t.isLoadingStore.state||t.loadingDetailsStore.setState({type:"load_groups_menu"}),l.setState(B+z().B2)}}):void 0;return(0,Q.jsxs)(Q.Fragment,{children:[d.visibleGroups.length>0&&(0,Q.jsxs)(P().A,{topBorder:!0,noTextOverflow:!0,title:(0,Q.jsx)("span",{style:{alignSelf:"center"},children:(0,Q.jsx)(h().sA,{id:"database.groupMenu.visibleGroups",defaultMessage:"Visible groups"})}),right:p?null:(0,Q.jsx)(T().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:b,disabled:!C,children:(0,Q.jsx)(h().sA,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:[(0,Q.jsx)(we,{collectionContextStore:t,groupByKey:s,groupsFormatKey:o,groupsDisplayState:d,groups:d.visibleGroups,canReorder:w,isHidden:!1,disableHideAll:p}),k]}),d.hiddenGroups.length>0&&(0,Q.jsx)(P().A,{topBorder:!0,noTextOverflow:!0,title:(0,Q.jsx)(h().sA,{id:"database.groupMenu.hiddenGroups",defaultMessage:"Hidden groups"}),right:p?null:(0,Q.jsx)(T().p,{size:"sm",shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:v,disabled:!C,children:(0,Q.jsx)(h().sA,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"})}),children:(0,Q.jsx)(we,{collectionContextStore:t,groupByKey:s,groupsFormatKey:o,groupsDisplayState:d,groups:d.hiddenGroups,canReorder:w,isHidden:!0,disableHideAll:p})})]})}function Be(e){let{groupsFormatKey:t,collectionContextStore:o,groupByKey:r,reducerResultStore:a,groupsLimitStore:i,groupsDisplayState:s}=e;const l=(0,n().O$)(o.normalizedSchemaStore),c=(0,H().X)("collection_group_reducer_visible"),p=(0,n().K8)((()=>(0,u().H2)(o.normalizedFormatStore.state,r,t)),[o,r,t]),g=(0,n().K8)((()=>{if(!p)return;const e=o.normalizedFormatStore.state;return(0,I().p)({groupBy:p,schema:l,format:e,groupsFormatKey:t,limit:c?d().O3:i.state,returnHiddenGroups:!0,returnPinnedGroups:"board_columns_by"===r,aggregation:void 0})}),[p,o.normalizedFormatStore,l,t,c,i,r]);return p?g?(0,Q.jsx)(B().A,{id:(0,Y().Q)(t),reducer:g,collectionContextStore:o,resultStore:a,render:()=>c?(0,Q.jsx)(U().L,{collectionContextStore:o,groupBy:p,groupByKey:r,groupsFormatKey:t,groupsDisplayState:s}):(0,Q.jsx)(Me,{collectionContextStore:o,groupsFormatKey:t,groupByKey:r,groupsLimitStore:i,groupsDisplayState:s})}):"v2"===(null==s?void 0:s.version)?(0,Q.jsx)(U().L,{collectionContextStore:o,groupBy:p,groupByKey:r,groupsFormatKey:t,groupsDisplayState:s}):(0,Q.jsx)(Me,{collectionContextStore:o,groupsFormatKey:t,groupByKey:r,groupsLimitStore:i,groupsDisplayState:s}):null}},818367:(e,t,o)=>{o.d(t,{x:()=>a});var r=()=>o(217429);function a(){return r().default.getConfigKey("collection_reducer_request_settings","chart").debounce_wait_ms}},941814:(e,t,o)=>{o.d(t,{H4:()=>i,dP:()=>n,hk:()=>s});var r=()=>o(452706),a=()=>o(217429);function n(){const e=a().default.getConfigKey("charts_query_collection_limits","max_results_reducer_limit");return e||r().aF}function i(){const e=a().default.getConfigKey("charts_query_collection_limits","max_subgroups_reducer_limit");return e||r().O3}function s(){const e=a().default.getConfigKey("charts_query_collection_limits","max_groups_reducer_limit");return e||r().O3}}}]);