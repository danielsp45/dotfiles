"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[78708],{175213:(e,t,o)=>{o.d(t,{G:()=>r});var n=()=>o(679924),a=()=>o(217429);function r(e,t){(0,n().v)(e,"delete_property",t),a().default.logEvent("delete_property")}},241319:(e,t,o)=>{o.d(t,{y:()=>r});o(898992),o(672577);var n=()=>o(534177),a=()=>o(977345);function r(e){var t;const{actionModels:o,id:r}=e,i=(0,a().y5)(r),l="action"===i.source?o.find((e=>e.id===i.action_id)):void 0,c=(0,n().O9)(l)&&l.isType("create_page")?null===(t=l.getConfig())||void 0===t?void 0:t.collection:void 0;return{automationValueInfo:i,collectionPointer:c,actionModel:l}}},778708:(e,t,o)=>{o.d(t,{Dl:()=>ee,U2:()=>H,Zk:()=>te,_R:()=>j,bE:()=>oe,c:()=>Y,cJ:()=>$,eN:()=>X,e_:()=>L,g4:()=>Z,qy:()=>K});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(803949),o(581454),o(737550);var n=()=>o(244641),a=()=>o(584262),r=()=>o(66689),i=()=>o(890409),l=()=>o(970013),c=()=>o(597777),s=()=>o(604995),u=()=>o(206267),p=()=>o(273900),d=()=>o(912720),m=()=>o(199378),f=()=>o(179034),v=()=>o(519831),y=()=>o(96689),_=()=>o(854150),g=()=>o(950914),S=()=>o(864779),k=()=>o(919709),C=()=>o(908447),M=()=>o(966759),h=()=>o(449506),T=()=>o(235191),A=()=>o(686526),O=()=>o(896628),w=()=>o(246826),b=()=>o(867201),x=()=>o(751156),V=()=>o(345913),R=()=>o(755199),I=()=>o(479788),D=()=>o(374562),E=()=>o(313892),B=()=>o(813297),F=()=>o(465364),N=()=>o(654062),G=()=>o(601734),P=()=>o(594794),U=()=>o(972435),z=()=>o(765957),q=()=>o(630116);const W="week";function j(e){var t;const{environment:o,transaction:n,tasksBlockStore:a,sprintsBlockStore:r}=e,i=null===(t=r.getFormat())||void 0===t?void 0:t.collection_pointer,l=a.getFormat().collection_pointer;if(!i||!l)return;const c=q().md.createChildStore(r,i),s=c.getRole()??"none";if(!(0,p().q_)(s,"editor"))return;c.getAutomationStores().some((e=>e.isCompleteSprintAutomation()))||J({environment:o,transaction:n,sprintCollectionStore:c,taskCollectionStore:q().md.createChildStore(a,l),sprintSettingsConfig:g().AL})}function J(e){const{environment:t,sprintSettingsConfig:o,transaction:n,sprintCollectionStore:a,taskCollectionStore:r}=e,i=a.getSpaceId(),l=(0,P().Z1)({environment:t,table:d().yB,spaceId:i}),c=(0,P().Z1)({environment:t,table:m().SC,spaceId:i});w().eC({environment:t,table:d().yB,inMemoryRecordCache:a.inMemoryRecordCache,value:{id:l,parent_id:a.id,parent_table:a.table,alive:!0,space_id:i,status:o.autoCompleteSprints?"active":"disabled",trigger:{id:u().JW(),type:"recurrence",recurrence:ae(o)},action_ids:[c]},transaction:n}),O().zA({stores:[a],update:{automation_ids:[...a.getFormat().automation_ids??[],l]},transaction:n}),w().vt({environment:t,table:m().SC,inMemoryRecordCache:a.inMemoryRecordCache,transaction:n,args:{id:c,version:1,parent_id:l,parent_table:d().yB,type:"complete_sprint",alive:!0,space_id:i,config:{sprint_collection:a.getSpaceShardedPointer(),task_collection:r.getSpaceShardedPointer(),complete_sprint_action:o.actionConfig.complete_sprint_action}}})}function L(e){const{environment:t,automationStore:o,transaction:n,newDuration:a,currentSprintBlockStore:r}=e;w().zv({store:o.getTriggerStore().getKeyStore("recurrence"),data:{interval:a},transaction:n}),Q({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function Z(e){const{environment:t,automationStore:o,transaction:n,newWeekday:a,currentSprintBlockStore:r}=e;w().zv({store:o.getTriggerStore().getKeyStore("recurrence"),data:{weekdays:[a]},transaction:n}),Q({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function H(e){const{environment:t,actionStore:o,automationStore:n,transaction:a,newAutocompleteStatus:r,currentSprintBlockStore:l}=e;w().zv({store:n,data:{status:r?"active":"disabled"},transaction:a}),Q({environment:t,transaction:a,automationStore:n,currentSprintBlockStore:l});const c=n.getParentPointer();if(!c||c.table!==v().Vl)return;const s=(0,I().Q)(t),u={automation_id:n.id,automation_actions:[{automation_action_id:o.id,type:"complete_sprint"}],automation_triggers:[{type:"recurrence"}],collection_id:c.id};r?(0,i().Ah)(s,u):(0,i().vN)(s,u)}function Q(e){const{automationStore:t,currentSprintBlockStore:o,transaction:a,environment:i}=e;if(!t.isActive())return;const l=t.getRecurrence();if(!l)return;const s=(0,S().Vv)(l);if(!s)return;const u=o.getPropertyValue(r().Hx.Dates);if(!u)return;const p=(0,k().Cok)(u)[0];if(!p||"daterange"!==p.type)return;const d=p.start_date,{start_date:m,end_date:f}=(0,S().Me)({currentSprintStartDate:d,sprintSchedule:s});w().zv({store:t.getTriggerStore().getKeyStore("recurrence"),data:{start_date:(0,c().Rz)(n().c9.fromISO(m).plus({minutes:1}).toJSDate())},transaction:a}),F().D5({store:o,propertyId:r().Hx.Dates,transaction:a,environment:i,type:"dateValue",dateValue:{type:"daterange",start_date:d,end_date:f}})}function K(e){const{transaction:t,newRemainingTasksBehavior:o,actionStore:n}=e;w().zv({store:n.getConfigStore(),data:{complete_sprint_action:o},transaction:t})}async function Y(e){var t;const{appTemplatesSetupActions:o,appTemplatesSprintBoardActions:n,appConfigs:i}=await G().Aw.load(),{environment:l,collectionContextStore:c,from:s}=e,{currentSpaceViewStore:u}=z().default.state,p=c.collectionStore(),d=null==p?void 0:p.getParentBlockStore(),m=null==d?void 0:d.getParentStore(),v=null==p||null===(t=p.getFormat())||void 0===t?void 0:t.app_config_uri,g=v&&(0,E().lS)(i(),v);if(!p||!d||!m||!u||m.table!==y().NX&&m.table!==f().ev&&m.table!==_().yK||!g)return;const S=d.getFormat().app_id,k=S?await h().callApi({eventName:"getCollectionViewBlocksByAppId",environment:l,data:{spaceId:d.getSpaceId(),appId:S}}):void 0,M="success"===(null==k?void 0:k.type)&&k.data.result.length?k.data.result.map((e=>q().Bv.createChildStore(m,{table:f().ev,id:e.blockId,spaceId:d.getSpaceId()}))):[d];await ne({environment:l,taskCollectionStore:p,executeFn:()=>{const e=x().createAndCommit({userAction:"sprintSettingsActions.handleTurnOnSprints",environment:l,canUndo:!0,perform:e=>{const t=(0,D().We)(),a=o.applyTypedFeatures({environment:l,spaceViewStore:u,appParentStore:m,appUri:g.uri,features:[{type:"simple",featureUri:t.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:M}),i=n.createSprintPage({environment:l,spaceViewStore:u,appParentStore:m,transaction:e,blockStores:a,creationEntryPoint:{type:"sprint_settings"}});if(A().os({collectionSettingsStore:c.settingsStore}),!i)return;const p=s?{feature:{id:r().yx.TaskToSprintRelation,from:s,type:"notion://projects/tasks_with_sprints_feature"}}:{};return(0,C().Z)({environment:l,collectionContextStore:c,from:"view_settings",property:r().yx.TaskToSprintRelation,property_type:"relation",is_suggested_property:!0,...p}),i}});e.serverCommitResult.then((()=>{const t=e.performResult;t&&b().Y({environment:l,store:t,pageVisitSource:a().y8.Create})}))}})}async function X(e){const{environment:t,collectionContextStore:o,sprintSettingsContext:n,sprintBoardViewBlockIds:i}=e,{sprintCollectionStore:l,automationContext:c,currentCollectionViewBlockStore:s,sprintCollectionViewBlockStore:u,taskCollectionStore:p,taskCollectionViewBlockStore:d}=n;if(!l||!u||!c)return;const m=d.getSpaceId(),v=[u,...i.map((e=>new(q().Bv)(t,{id:e,table:f().ev,spaceId:m})))];s.id===d.id?A().os({collectionSettingsStore:o.settingsStore}):b().Y({environment:t,store:d,pageVisitSource:a().y8.LeaveOrRemove});const{automationActions:y}=await B().QV.automations.load(),{automationStore:_}=c;await ne({environment:t,taskCollectionStore:p,executeFn:()=>{x().createAndCommit({userAction:"sprintSettingsActions.handleTurnOffSprints",environment:t,canUndo:!0,perform:e=>{!function(e){const{transaction:t,blocksToDelete:o,environment:n,taskCollectionStore:a,sprintCollectionStore:i}=e;w().zv({store:i,transaction:t,data:{alive:!1}}),T().BJ({environment:n,collectionStore:a,schema:a.getSchema(),property:r().yx.TaskToSprintRelation,transaction:t,permanentlyDelete:!0}),V().oD({environment:n,blocks:o,transaction:t,permanentlyDelete:!0})}({environment:t,transaction:e,blocksToDelete:v,sprintCollectionStore:l,taskCollectionStore:p}),y.disableAutomation({automationStore:_,environment:t,transaction:e}),y.deleteAutomation({automationStore:_,environment:t,transaction:e})}}),(0,M().i)({environment:t,collectionContextStore:o,property_type:"relation",from:"view_settings",property:r().yx.TaskToSprintRelation})}})}function $(e){const{environment:t,userSettingsStore:o}=e;x().createAndCommit({userAction:"sprintSettingsActions.handleSeenSprintsEngagementBanner",environment:t,canUndo:!0,perform:e=>{R().mJ({userSettingsStore:o,data:{seen_sprint_settings_engagement_banner:!0},transaction:e})}})}function ee(e){e.settingsStore.setState({open:!0,stack:[{type:"main"},{type:"sprintSettings"}]})}function te(e){const{environment:t,collectionContextStore:o,currentViewBlockStore:n,taskCollectionViewBlockStore:a}=e,i=o.collectionViewStore();if(!i)return;const l=i.getFormat(),c=i.getRawQuery();x().createAndCommit({userAction:"sprintSettingsActions.handleManageSprintFromThisView",environment:t,canUndo:!0,perform:e=>{if((0,N().F)({collectionViewStore:i,transaction:e,update:{name:U().A.formatMessage(D().DZ.tasksCurrentSprintV2ViewName),query2:{...c,filter:void 0},format:{...l,collection_view_icon:"/icons/playback-play-button_gray.svg",property_filters:D().Wo,app_config_uri:r().Lu,hide_linked_collection_name:!0}}}),n.id===a.id){var t;const o=(null===(t=n.getFormat())||void 0===t?void 0:t.app_uri_map)??{},c=l.app_config_uri;c&&delete o[c],O().zA({stores:[a],update:{app_uri_map:{...o,[r().Lu]:i.id}},transaction:e})}}})}function oe(e){const{environment:t,sprintSettingsContext:o}=e;if(!o)return;const n=o.sprintCollectionStore,a=(null==n?void 0:n.getRole())??"none";n&&(0,p().q_)(a,"editor")&&o.automationContextLoaded&&!o.automationContext&&x().createAndCommit({userAction:"sprintSettingsActions.ensureCompleteSprintAutomation",environment:t,canUndo:!0,perform:e=>{J({environment:t,transaction:e,sprintCollectionStore:n,taskCollectionStore:o.taskCollectionStore,sprintSettingsConfig:g().AL})}})}async function ne(e){const{executeFn:t,environment:o,taskCollectionStore:n}=e;await async function(e){var t;const{environment:o,taskCollectionStore:n}=e,a=n.getFormat().app_uri_map,i=r().yx.TaskToSprintRelation,c=n.getSchema(),s=(null==a?void 0:a[i])??i,u=c[s];if(!u||!(0,l().nC)(u))return;const p=null===(t=(0,l().Nv)(u))||void 0===t?void 0:t.id;if(!p)return;const d=new Set([s]);Object.entries(c).forEach((e=>{var t;let[o,n]=e;n&&(0,l().nC)(n)&&(null===(t=(0,l().Nv)(n))||void 0===t?void 0:t.id)===p&&d.add(o)}));const{serverCommitResult:m}=x().createAndCommit({userAction:"sprintSettingsActions.clearSprintRelationDataFromTaskCollection",environment:o,canUndo:!0,perform:e=>{for(const t of d)T().BJ({environment:o,transaction:e,permanentlyDelete:!0,collectionStore:n,schema:c,property:t});null==a||delete a[i],a&&O().zA({stores:[n],transaction:e,update:{app_uri_map:a}})}});await m}({environment:o,taskCollectionStore:n}),t()}function ae(e){return{frequency:W,interval:e.recurrenceConfig.interval,weekdays:e.recurrenceConfig.weekdays,start_date:(0,c().Rz)(n().c9.local().set({hour:0,minute:0,second:0,millisecond:0}).toJSDate()),timezone:(0,s().dB)(),hour:0,minute:0}}},864779:(e,t,o)=>{o.d(t,{Me:()=>l,Vv:()=>a,Z3:()=>r,wI:()=>i});var n=()=>o(244641);function a(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function r(e){const{currentSprintEndDate:t,sprintSchedule:o}=e;return c({startDate:u({dateToAdjust:n().c9.fromISO(t),weekday:o.weekday,wrapForEqualDays:!0}),duration:o.duration})}function i(e){const{userTimeZone:t,sprintSchedule:o}=e;return c({startDate:n().c9.local({zone:t}),duration:o.duration})}function l(e){const{currentSprintStartDate:t,sprintSchedule:o}=e,a=u({dateToAdjust:n().c9.fromISO(t),weekday:o.weekday,wrapForEqualDays:!1}),{end_date:r}=c({startDate:a,duration:o.duration});let i=n().c9.fromISO(r);const l=n().c9.now().startOf("day");for(;i.diff(l,"days").days<0;)i=i.plus({weeks:1});return{type:"daterange",start_date:i.plus({days:1}).minus({weeks:o.duration}).toISODate(),end_date:i.toISODate()}}function c(e){const{startDate:t,duration:o}=e,n=t.plus({weeks:o}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:n.toISODate()}}const s={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function u(e){const{dateToAdjust:t,weekday:o,wrapForEqualDays:n}=e,a=p({currentWeekday:t.weekday%7,nextWeekday:s[o],wrapForEqualDays:n});return t.plus({days:a})}function p(e){const{currentWeekday:t,nextWeekday:o,wrapForEqualDays:n}=e,a="number"==typeof t?t:s[t],r="number"==typeof o?o:s[o];if(a===r)return n?7:0;let i=a,l=0;for(;i!==r;)i===s.SA?i=0:i+=1,l+=1;return l}},890409:(e,t,o)=>{o.d(t,{Ah:()=>y,Dk:()=>m,Iv:()=>v,SF:()=>f,YO:()=>S,_f:()=>C,c_:()=>p,dW:()=>g,gW:()=>d,sp:()=>M,vN:()=>_});o(16280),o(944114),o(898992),o(354520),o(803949),o(581454),o(737550);var n=()=>o(496603),a=()=>o(973647),r=()=>o(534177),i=()=>o(842599),l=()=>o(977345),c=()=>o(798880),s=()=>o(919709),u=()=>o(241319);function p(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"add_automation_step",properties:t})}function d(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"delete_automation_step",properties:t})}function m(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_create",properties:t})}function f(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_update",properties:t})}function v(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_delete",properties:t})}function y(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_enable",properties:t})}function _(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_disable",properties:t})}function g(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_create",properties:t})}function S(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_delete",properties:t})}function k(e){const{formulaAnalyticsModule:t,formulasModule:o,formulaTypecheckContextValues:n,getRecordModel:i,spaceId:c,value:s,featureGates:u}=e;if("formula"===s.type){if(!(0,r().O9)(s.value))return;const e=a().Q.unwrapOr(o.parseFormulaInputToAst(s.value),void 0);if(e){const a=o.addTypesToFormulaAST(e,{handleDataRequest:(0,l().zg)(i),spaceId:c,valueTypes:n,featureGates:u});return{...t.getFormulaAnalytics(e,{getRecordModel:i,typecheckContextValues:n}),formula_return_type:a.node.type,redacted_formula:t.getRedactedFormulaAsStringSync(e,{getRecordModel:i,typecheckContextValues:n})}}}else{if("simple"===s.type){if(!(0,r().O9)(s.value))return;return t.getSimpleFormulaAnalytics(s.value,{getRecordModel:i,typecheckContextValues:n})}(0,r().HB)(s.type)}}function C(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:a,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f,simpleFormulasModule:v}=e;return t.isType("complete_sprint")?{automation_action_id:t.pointer.id,type:"complete_sprint"}:t.isType("create_page")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:a,getRecordModel:i,featureGates:l}=e,c=t.getConfig();let s,u=[];const p=null==c?void 0:c.collection,d=null==c?void 0:c.properties;if((0,r().O9)(p)&&(0,r().O9)(d)&&d.length>0){const e=i(p),f=null==e?void 0:e.getNormalizedSchema();(0,r().O9)(f)&&(u=d.map((e=>{var t;return(null===(t=f[e])||void 0===t?void 0:t.type)??"unknown"})));const v=null==c?void 0:c.values;if(n&&(0,r().O9)(v)){s=[];for(const e of d){var m;const r=null===(m=v[e])||void 0===m?void 0:m.value;if(!r)continue;const c=k({formulaAnalyticsModule:o,formulasModule:n,getRecordModel:i,formulaTypecheckContextValues:a,spaceId:t.spaceId,value:r,featureGates:l});c&&s.push(c)}}}return{automation_action_id:t.pointer.id,property_formula_stats:s,property_types:u,type:"create_page"}}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("duplicate_blocks")?{automation_action_id:t.pointer.id,type:"duplicate_blocks"}:t.isType("modal_confirmation")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:a,getRecordModel:i,featureGates:l}=e,c=t.getConfig(),s=[];if(n&&(0,r().O9)(c)&&c.text){const e=k({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:i,formulaTypecheckContextValues:a,spaceId:t.spaceId,value:c.text,featureGates:l});e&&s.push(e)}return{automation_action_id:t.pointer.id,formula_stats:s,type:"modal_confirmation"}}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("open_page")?{automation_action_id:t.pointer.id,type:"open_page"}:t.isType("query_collection")?{automation_action_id:t.pointer.id,type:"query_collection"}:t.isType("send_in_app_notification")?function(e){var t;const{automationActionModel:o,formulaAnalyticsModule:n,formulasModule:a,formulaTypecheckContextValues:i,getRecordModel:l,featureGates:c,simpleFormulasModule:u}=e,p={automation_action_id:o.pointer.id,messageCharacterCount:0,type:"send_in_app_notification"},d=o.getConfig();if(!(0,r().O9)(d))return p;if((0,r().O9)(d.target))if("formula"===d.target.type&&(0,r().O9)(d.target.value)){if(p.targetData={type:"formula",numUserFormulaTargets:(0,s().Fbh)(d.target.value.value).length,numFormulaContextTargets:u.getReferencedContextValueIds(d.target.value).length},a){const e=k({formulasModule:a,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:i,spaceId:o.spaceId,value:d.target.value,featureGates:c});e&&(p.formula_stats??=[],p.formula_stats.push(e))}}else if("property"===d.target.type&&(0,r().O9)(d.target.propertyId)&&(0,r().O9)(d.target.collectionPointer)){const e=l(d.target.collectionPointer),t=null==e?void 0:e.getSchema();var m;(0,r().O9)(t)&&(p.targetData={type:"property",propertyType:null===(m=t[d.target.propertyId])||void 0===m?void 0:m.type})}if((0,r().O9)(null===(t=d.notification_message)||void 0===t?void 0:t.value)&&(p.messageCharacterCount=(0,s().FAw)(d.notification_message.value),a)){const e=k({formulasModule:a,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:i,spaceId:o.spaceId,value:d.notification_message,featureGates:c});e&&(p.formula_stats??=[],p.formula_stats.push(e))}return p}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f,simpleFormulasModule:v}):t.isType("send_gmail_notification")?function(e){var t,o,a,l,u,p,d;const{automationActionModel:m,formulaAnalyticsModule:f,formulasModule:v,formulaTypecheckContextValues:y,getRecordModel:_,featureGates:g}=e,S=m.getConfig();if(!(0,r().O9)(S))return{automation_action_id:m.pointer.id,fields:{},recipient_domains:{},type:"send_gmail_notification"};const C=Object.fromEntries(Object.entries(S||{}).map((e=>{let[t,o]=e;var n;return"formula"===(null==o?void 0:o.type)?[t,Boolean(null==o||null===(n=o.value)||void 0===n?void 0:n.value)]:"simple"===(null==o?void 0:o.type)?[t,Boolean(null==o?void 0:o.value)]:[t,Boolean(o)]}))),{to:M,cc:h,bcc:T}=S,A=[...(null==M||null===(t=M.value)||void 0===t?void 0:t.value)||[],...(null==h||null===(o=h.value)||void 0===o?void 0:o.value)||[],...(null==T||null===(a=T.value)||void 0===a?void 0:a.value)||[]],O=[...(0,s().Fbh)(A).map((e=>_({table:c().oo,id:e}))).map((e=>null==e?void 0:e.email)).filter(r().O9),...(0,i().C3)((0,s().k4p)(A))],w=n().Tr(O.map((e=>e.split("@")[1]))),b=[null===(l=S.to)||void 0===l?void 0:l.value,null===(u=S.cc)||void 0===u?void 0:u.value,null===(p=S.bcc)||void 0===p?void 0:p.value,null===(d=S.reply_to)||void 0===d?void 0:d.value,S.from_name,S.email_subject,S.email_body].map((e=>{if(v&&(0,r().O9)(e))return k({formulaAnalyticsModule:f,formulasModule:v,getRecordModel:_,formulaTypecheckContextValues:y,spaceId:m.spaceId,value:e,featureGates:g})})).filter(r().O9);return{automation_action_id:m.pointer.id,fields:C,formula_stats:b,recipient_domains:w,type:"send_gmail_notification"}}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("slack_notification")?{automation_action_id:t.pointer.id,type:"slack_notification"}:t.isType("update_pages")?function(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:n,formulasModule:a,formulaTypecheckContextValues:i,getRecordModel:c,featureGates:s}=e,p=t.getConfig(),d=[],m=[],f=[];if((0,r().O9)(p)&&(0,r().O9)(p.target)&&(0,r().O9)(p.properties)&&p.properties.length>0){let e;if("variable"===p.target.type){const t=(0,l().y5)(p.target.id);if("action"===t.source){const t=(0,u().y)({actionModels:o,id:p.target.id}).collectionPointer;if((0,r().O9)(t)){const o=c(t);e=null==o?void 0:o.getNormalizedSchema()}}else{if("global"!==t.source||"button_page"!==t.global)throw new Error("Failed loading property schema");{const t=(0,l().IV)(i,p.target.id);if("block"===(null==t?void 0:t.type.type)&&(0,r().O9)(t.type.collection)){const o=c(t.type.collection);e=null==o?void 0:o.getNormalizedSchema()}}}}else if("collection"===p.target.type){const t=c(p.target.collection);e=null==t?void 0:t.getNormalizedSchema()}(0,r().O9)(e)&&p.properties.forEach((o=>{const l=e[o];if((0,r().O9)(l)&&(d.push(l.type),a&&(0,r().O9)(p.values))){const e=p.values[o];if((0,r().O9)(e)&&(m.push({type:l.type,operator:e.action}),e.value)){const o=k({formulasModule:a,formulaAnalyticsModule:n,getRecordModel:c,formulaTypecheckContextValues:i,spaceId:t.spaceId,value:e.value,featureGates:s});o&&f.push(o)}}}))}return{automation_action_id:t.pointer.id,property_configs:m,property_formula_stats:f,property_types:d,type:"update_pages"}}({automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:a,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("define_variables")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:a,getRecordModel:i,featureGates:l}=e,c=t.getConfig(),s=[];if(n&&(0,r().O9)(c)&&c.values)for(const r of Object.values(c.values))if(r.value){const e=k({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:i,formulaTypecheckContextValues:a,spaceId:t.spaceId,value:r.value,featureGates:l});e&&s.push(e)}return{automation_action_id:t.pointer.id,formula_stats:s,type:"define_variables"}}({automationActionModel:t,formulaAnalyticsModule:a,formulasModule:p,formulaTypecheckContextValues:d,getRecordModel:m,featureGates:f}):t.isType("http_request")?{automation_action_id:t.pointer.id,type:"http_request"}:t.isType("publish_site")?{automation_action_id:t.pointer.id,type:"publish_site"}:void(0,r().HB)(t)}function M(e){const{automationModel:t,builderType:o="sidebar",formulaAnalyticsModule:n,formulasModule:a,formulaTypecheckContextValues:i,getRecordModel:l,featureGates:c,simpleFormulasModule:s,source:u}=e,p=[],d=t.getActionPointers().map((e=>l(e))).filter(r().O9);for(const S of t.getActionPointers()){const e=l(S);(0,r().O9)(e)&&p.push(C({automationActionModel:e,automationActionModels:d,formulaAnalyticsModule:n,formulasModule:a,formulaTypecheckContextValues:i,getRecordModel:l,featureGates:c,simpleFormulasModule:s}))}const m=[];let f,v,y;if(t.isEventType()){var _;const e=t.getEventConfiguration(),o=l(t.getParentPointer());f=t.getParentId();const n=t.getEventConfiguration();if("collection_view"===(null===(_=n.source)||void 0===_?void 0:_.type)){const e=l(n.source.pointer);y=null==e?void 0:e.parent_id,v=null==n?void 0:n.source.pointer.id}const a=null==o?void 0:o.getNormalizedSchema();if((0,r().O9)(a)){const{pagesAdded:t,pagePropertiesEdited:o}=e;if(t&&m.push({type:"page"}),"any"===o.type)m.push({condition:"any",type:"property"});else if("none"===o.type)m.push({condition:"none",type:"property"});else{let e=[];"some"===o.type?e=o.some??[]:"all"===o.type&&(e=o.all??[]);const t=[],n=[];e.forEach((e=>{var o;const i=null===(o=a[e.property])||void 0===o?void 0:o.type;(0,r().O9)(i)&&(t.push({type:i,operator:e.filter.operator}),n.push(i))})),m.push({condition:o.type,property_configs:t,property_types:n,type:"property"})}}}else if(t.isButtonType())m.push({type:"button"});else if(t.isRecurrenceType()){var g;m.push({type:"recurrence",frequency:null===(g=t.getTrigger().recurrence)||void 0===g?void 0:g.frequency})}else(0,r().HB)(t);return{automation_actions:p,automation_id:t.id,automation_triggers:m,collection_id:f,collection_view_id:v,collection_view_block_id:y,builder_type:o,source:u}}},950914:(e,t,o)=>{o.d(t,{AL:()=>r,Q6:()=>l,vt:()=>i});o(898992),o(672577);var n=()=>o(66689),a=()=>o(254947);const r={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function i(e){const{eventTracker:t,properties:o}=e;t.DO_NOT_USE_commonTrackEvent({eventName:"complete_sprint_action",properties:o})}function l(e,t){var o;return null===(o=t.groups)||void 0===o||null===(o=o.find((t=>t.id===n().nl||(null==t?void 0:t.name)===a().P0||(null==t?void 0:t.name)===e.formatMessage(a().oz.statusGroupNameComplete))))||void 0===o?void 0:o.name}},966759:(e,t,o)=>{o.d(t,{i:()=>r});var n=()=>o(476492),a=()=>o(175213);function r(e){const{environment:t,collectionContextStore:o,property_type:r,from:i,property:l,...c}=e,s=(0,n().sl)(o)||{};(0,a().G)(t,{property:l,property_type:r,from:i,...c,...s})}}}]);