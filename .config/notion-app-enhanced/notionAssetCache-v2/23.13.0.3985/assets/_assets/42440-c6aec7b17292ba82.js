"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[42440],{942440:(e,t,o)=>{o.r(t);o(944114),o(898992),o(354520),o(803949),o(581454);var n=()=>o(466103),s=()=>o(197959),i=()=>o(919709),r=()=>o(496603),c=()=>o(246826),a=()=>o(751156),u=()=>o(765957),d=()=>o(630116),l=()=>o(413962);function g(e){const t=[],o=[e,...e.getContentStores()];for(;o.length>0;){const e=o.pop();for(const o of(null==e?void 0:e.getDiscussionStores())??[])"suggestion"===o.getType()&&t.push(o);if(null==e||!e.isNavigableBlock())for(const t of(null==e?void 0:e.getContentStores())??[])o.push(t)}return t}(0,n().exposeDebugEnvironmentValue)("getAllSuggestionsOnMainEditor",(e=>()=>{if(u().default.state.mainEditorCurrentBlockStore)return g(u().default.state.mainEditorCurrentBlockStore)})),(0,n().exposeDebugEnvironmentValue)("updateAllSuggestionContextsOnMainEditor",(e=>()=>{u().default.state.mainEditorCurrentBlockStore&&g(u().default.state.mainEditorCurrentBlockStore).forEach((t=>{t.isDefined()&&a().createAndCommit({userAction:"ConsoleHelpers.updateAllSuggestionContextsOnMainEditor",environment:e,canUndo:!0,perform:o=>{(0,l().c3)({environment:e,transaction:o,discussionStore:t})}})}))})),(0,n().exposeDebugEnvironmentValue)("updateSuggestionDiscussionSnapshot",(e=>(t,o)=>{if(!u().default.state.currentSpaceStore)return;const n=d().cc.createChildStore(u().default.state.currentSpaceStore,{table:s().$Y,id:t,spaceId:u().default.state.currentSpaceStore.id});a().createAndCommit({userAction:"ConsoleHelpers.updateSuggestionDiscussionSnapshot",environment:e,canUndo:!0,perform:t=>{(0,l().c3)({environment:e,transaction:t,discussionStore:n,addModifiedBlockIdsAfter:o})}})})),(0,n().exposeDebugEnvironmentValue)("forceReopenSuggestionDiscussion",(e=>(t,n)=>{if(!u().default.state.currentSpaceStore)return;const i=d().cc.createChildStore(u().default.state.currentSpaceStore,{table:s().$Y,id:t,spaceId:u().default.state.currentSpaceStore.id});i.isDefined()&&a().createAndCommit({userAction:"ConsoleHelpers.forceReopenSuggestionDiscussion",environment:e,canUndo:!0,perform:t=>{const s=(0,o(220719).o9)(i.getSuggestionRawContextStore());c().zv({store:i,data:{resolved:!1},transaction:t}),c().KY({store:s,value:{...s.getValue(),rejected:!1,resolvedBy:void 0},transaction:t}),(0,l().c3)({environment:e,transaction:t,discussionStore:i,addModifiedBlockIdsAfter:n})}})})),(0,n().exposeDebugEnvironmentValue)("fixBlockSuggestionDiscussionMismatch",(e=>t=>{if(!u().default.state.currentSpaceStore)return;const n=u().default.state.currentSpaceStore,c=d().Bv.createChildStore(n,{table:o(179034).ev,id:t}),g=c.getModel();if(!g||!c.isDefined())return;const f=r().sb([...g.getAllBlockSuggestions().map((e=>e.discussionId)),...(0,i().j2Y)(c.getTitleValue())]),S=g.getDiscussionPointers().map((e=>e.id));r().FF(f,...S).forEach((t=>a().createAndCommit({userAction:"ConsoleHelpers.fixBlockSuggestionDiscussionMismatch.addDiscussionToBlockStore",environment:e,canUndo:!0,perform:e=>{(0,o(543225).B)({transaction:e,blockStore:c,discussionId:t})}})));r().sb([...f,...S]).forEach((t=>{const o=d().cc.createChildStore(n,{table:s().$Y,id:t,spaceId:n.id});if(o.isDefined()){(o.getSuggestModifiedBlockIds()??[]).includes(c.id)||a().createAndCommit({userAction:"ConsoleHelpers.fixBlockSuggestionDiscussionMismatch.addDiscussionToBlockStore",environment:e,canUndo:!0,perform:t=>{(0,l().c3)({environment:e,transaction:t,discussionStore:o,addModifiedBlockIdsAfter:[c.id]})}})}}))})),(0,n().exposeDebugEnvironmentValue)("findAllBlocksInMainEditorWithDanglingSuggestions",(e=>()=>{const e=[];if(!u().default.state.mainEditorCurrentBlockStore)return;const t=u().default.state.mainEditorCurrentBlockStore;if(!t.isDefined())return;const o=u().default.state.currentSpaceStore;if(!o)return;const n=[t,...t.getContentStores()];for(;n.length>0;){const t=n.pop();if(!t||!t.isDefined())continue;if(t.isType("table")||t.isType("table_row"))continue;const c=r().sb([...t.getAllBlockSuggestions().map((e=>e.discussionId)),...(0,i().j2Y)(t.getTitleValue())]).map((e=>d().cc.createChildStore(o,{table:s().$Y,id:e,spaceId:o.id}))).filter((e=>e.isDefined()&&!(e.getSuggestModifiedBlockIds()??[]).includes(t.id)));if(c.length>0&&e.push({blockStore:t,discussionStores:c}),!t.isNavigableBlock())for(const e of t.getContentStores()??[])n.push(e)}return e})),(0,n().exposeDebugEnvironmentValue)("resetSuggestionTooltips",(e=>()=>{o(755199).eO({environment:e,dismissed:!1})}))}}]);