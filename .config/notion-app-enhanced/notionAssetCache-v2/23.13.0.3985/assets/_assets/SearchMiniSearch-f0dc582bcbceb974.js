"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[4902,98682],{7767:(e,t,s)=>{s.d(t,{A:()=>o});var n=()=>s(194188),r=()=>s(10123),i=()=>s(570551);function o(e,t){(0,i().A)(2,arguments);var s=(0,r().A)(e).getTime(),o=(0,n().A)(t);return new Date(s+o)}},10123:(e,t,s)=>{s.d(t,{A:()=>i});var n=()=>s(570551);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){(0,n().A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===r(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},194188:(e,t,s)=>{function n(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}s.d(t,{A:()=>n})},270341:(e,t,s)=>{s.r(t),s.d(t,{RESULT_BUTTON_STYLES:()=>it,default:()=>lt});s(898992),s(354520),s(581454),s(737550);var n=s(296540),r=()=>s(484714),i=()=>s(852507),o=()=>s(56366),a=()=>s(401497),l=()=>s(416504),c=()=>s(992437),d=()=>s(386164),u=()=>s(450648),h=()=>s(245241),p=()=>s(919709),m=()=>s(175947),g=()=>s(959013),f=()=>s(496603),v=()=>s(449506),y=()=>s(847743),b=()=>s(780865),S=()=>s(135599),x=()=>s(47170),I=()=>s(249847),w=()=>s(857437),A=()=>s(962730),M=()=>s(765957),T=()=>s(217429),j=()=>s(786601),C=()=>s(250484),k=()=>s(24157),F=()=>s(122058),R=()=>s(676007),B=()=>s(897119),N=()=>s(42425),P=()=>s(340498),E=s(474848);const K={viewBox:"0 0 20 20",fittedViewBox:"2.06 3.15 15.88 15.65",svg:(0,E.jsx)("path",{d:"M12.207 18.678a1.91 1.91 0 0 1-2.33-.838l-.348-.715c-.177-.293-.36-.658-.535-1.005l-.13-.257c-.225-.442-.431-.822-.627-1.08l-2.164-2.306h-2.41a1.6 1.6 0 0 1-1.6-1.6V5.74a1.6 1.6 0 0 1 1.6-1.6H6.97l1.227-.42.021-.011a5.2 5.2 0 0 1 2.347-.553h4.309a1.844 1.844 0 0 1 1.78 2.32c.554.318.922.918.922 1.6 0 .284-.067.547-.18.78.333.327.54.782.54 1.297 0 .429-.145.817-.388 1.124.17.27.271.592.271.943a1.844 1.844 0 0 1-1.843 1.844h-3.783c.069.167.15.33.242.516v.001c.14.28.302.608.416 1.004l.001.002.507 1.774a1.913 1.913 0 0 1-1.144 2.315zm-1.567-2.126.345.71a.66.66 0 0 0 .781.247.66.66 0 0 0 .393-.804l-.507-1.773v-.001c-.08-.276-.195-.512-.336-.797l-.014-.028a6 6 0 0 1-.408-.97 1.03 1.03 0 0 1 .988-1.323h4.095a.594.594 0 0 0 .593-.594.56.56 0 0 0-.27-.47.625.625 0 0 1 .066-1.086.56.56 0 0 0 .322-.511.58.58 0 0 0-.4-.55.625.625 0 0 1-.191-1.074.59.59 0 0 0 .23-.453.586.586 0 0 0-.584-.594.625.625 0 0 1-.452-1.057.594.594 0 0 0-.416-1.02h-4.31c-.593 0-1.17.13-1.703.381a.6.6 0 0 1-.161.083l-1.424.488a.6.6 0 0 1-.202.033h-.181v6.136l2.275 2.425.037.043c.286.367.547.86.772 1.303l.147.29a13 13 0 0 0 .515.966m-4.846-5.324v-5.84H3.663a.35.35 0 0 0-.35.35v5.139c0 .193.156.35.35.35z"})},V=(0,P().wt)("handThumbsDown",K);const _={viewBox:"0 0 20 20",fittedViewBox:"2.06 1.19 15.88 15.65",svg:(0,E.jsx)("path",{d:"M12.207 1.322a1.91 1.91 0 0 0-2.33.838l-.348.715c-.177.292-.36.658-.535 1.005l-.13.257c-.225.442-.431.822-.627 1.08L6.073 7.521h-2.41a1.6 1.6 0 0 0-1.6 1.6v5.139a1.6 1.6 0 0 0 1.6 1.6H6.97l1.227.42.021.01c.73.366 1.528.554 2.347.554h4.309a1.844 1.844 0 0 0 1.78-2.32c.554-.318.922-.918.922-1.6 0-.284-.067-.547-.18-.78.333-.327.54-.782.54-1.297a1.8 1.8 0 0 0-.388-1.124c.17-.27.271-.592.271-.943a1.844 1.844 0 0 0-1.843-1.844h-3.783c.069-.167.15-.33.242-.516a6 6 0 0 0 .416-1.004l.001-.002.507-1.774a1.913 1.913 0 0 0-1.144-2.315zM10.64 3.449l.345-.71a.66.66 0 0 1 .781-.248c.32.128.488.471.393.804l-.507 1.773v.001c-.08.276-.195.512-.336.797l-.014.028c-.134.27-.292.59-.408.97a1.03 1.03 0 0 0 .988 1.323h4.095c.327 0 .593.267.593.594a.56.56 0 0 1-.27.47.625.625 0 0 0 .066 1.086.56.56 0 0 1 .322.511.58.58 0 0 1-.4.55.625.625 0 0 0-.191 1.074c.149.122.23.285.23.453a.586.586 0 0 1-.584.594.625.625 0 0 0-.452 1.057.594.594 0 0 1-.416 1.02h-4.31c-.593 0-1.17-.13-1.703-.381a.6.6 0 0 0-.161-.083l-1.424-.488a.6.6 0 0 0-.202-.033h-.181V8.475L9.169 6.05l.037-.043c.286-.367.547-.86.772-1.303l.147-.29a13 13 0 0 1 .515-.965M5.794 8.772v5.839H3.663a.35.35 0 0 1-.35-.35V9.122a.35.35 0 0 1 .35-.35z"})},O=(0,P().wt)("handThumbsUp",_);var L=()=>s(148777),D=()=>s(10722),q=()=>s(364280),U=()=>s(285790),z=()=>s(859428);const W=n.memo((function(e){const{searchSessionFlowNumber:t,quickFindFeedbackPayload:i,currentView:o}=e,l=(0,g().tz)(),c=(0,r().v3)(),[d,u]=(0,n.useState)(!1),[h,p]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{p(void 0)}),[t,o]);const m=(0,n.useCallback)((async()=>{i&&(p("thumbsUp"),await(0,D().Tk)({environment:c,feedback:"thumbsUp",quickFindFeedbackPayload:i}))}),[c,i]),f=(0,n.useCallback)((async()=>{i&&(p("thumbsDown"),u(!0),await(0,D().Tk)({environment:c,feedback:"thumbsDown",quickFindFeedbackPayload:i}))}),[c,i]),v=(0,n.useCallback)((async e=>{i&&await D().d7({environment:c,quickFindFeedbackPayload:{...i,additional_information:e.additionalInformation,desired_result_url:e.desiredUrl,can_followup_with_user:e.canFollowUpWithUser}})}),[c,i]),y=(0,a().IS)((e=>({container:{padding:"6px 8px",color:e.text.secondary,display:"flex",justifyContent:"space-between",borderTop:`1px solid ${e.lightDividerColor}`,marginTop:1}})),[]);return(0,E.jsxs)("div",{style:y.container,children:[(0,s(211134).PF)(s(780054).A)?(0,E.jsx)(H,{}):null,Boolean(i)?(0,E.jsxs)("div",{children:[(0,E.jsx)(U().A,{icon:"thumbsUp"===h?s(408197).s:O,ariaLabel:l.formatMessage($.thumbsUpFeedback),onClick:m,disabled:void 0!==h}),(0,E.jsx)(U().A,{icon:"thumbsDown"===h?s(436150).v:V,ariaLabel:l.formatMessage($.thumbsDownFeedback),onClick:f,disabled:void 0!==h})]}):null,(0,E.jsx)(s(410386).e,{isOpen:d,setIsOpen:u,submit:v})]})}));function H(){var e,t,i,l;const c=(0,r().v3)(),d=(0,g().tz)(),u=(0,o().K8)((()=>(0,L().PE)({environment:c})),[c]),h=(0,n.useCallback)((async()=>{const e=await s(884107).R.clipboardActions.load();await e.copyString({environment:c,stringValue:JSON.stringify({cacheStats:u,readinessTimings:(0,L().Yp)()},null,2),copiedMessage:e.clipboardMessages.copiedToClipboard})}),[u,c]),p=(0,a().IS)((e=>({buttonContainer:{display:"flex",alignItems:"center",justifyContent:"center",marginLeft:4},devMessage:{color:e.text.secondary},indexBuilding:{color:e.text.tertiary,fontSize:12,display:"flex"}})),[]),m=(0,n.useMemo)((()=>{var e,t,s,n;return(0,E.jsxs)(q().VP,{gap:8,children:[u.localSearchableBlocksCacheLoaded&&(0,E.jsxs)(q().VP,{gap:2,children:[(0,E.jsx)("div",{children:`Pages: ${u.localSearchableBlocksCacheSize} `}),(0,E.jsx)("div",{children:`Recents: ${null===(e=u.localSearchableBlocksCacheBlockSourceCount)||void 0===e?void 0:e.recentVisit}`}),(0,E.jsx)("div",{children:`Frecency: ${null===(t=u.localSearchableBlocksCacheBlockSourceCount)||void 0===t?void 0:t.frecencyStore}`}),(0,E.jsx)("div",{children:`Similar: ${null===(s=u.localSearchableBlocksCacheBlockSourceCount)||void 0===s?void 0:s.similarUser1dRecentPages}`}),(0,E.jsx)("div",{children:`Popular: ${null===(n=u.localSearchableBlocksCacheBlockSourceCount)||void 0===n?void 0:n.topPages7dPageView}`})]}),!u.hasPersistedRecordCache&&(0,E.jsx)("div",{children:"NO RECORD CACHE"}),(0,E.jsx)("div",{style:p.devMessage,children:"[Dev] Click to copy index metadata"})]})}),[u.hasPersistedRecordCache,null===(e=u.localSearchableBlocksCacheBlockSourceCount)||void 0===e?void 0:e.frecencyStore,null===(t=u.localSearchableBlocksCacheBlockSourceCount)||void 0===t?void 0:t.recentVisit,null===(i=u.localSearchableBlocksCacheBlockSourceCount)||void 0===i?void 0:i.similarUser1dRecentPages,null===(l=u.localSearchableBlocksCacheBlockSourceCount)||void 0===l?void 0:l.topPages7dPageView,u.localSearchableBlocksCacheLoaded,u.localSearchableBlocksCacheSize,p.devMessage]),f=u.localSearchableBlocksCacheLoaded;return(0,n.useMemo)((()=>(0,E.jsx)(z().A,{placement:A().W.Bottom,renderTooltip:()=>m,render:e=>(0,E.jsxs)(q().fI,{gap:8,alignItems:"center",children:[(0,E.jsx)(U().A,{...e,style:p.buttonContainer,iconStyle:{height:15,width:15},icon:s(359545).d,onClick:h,ariaLabel:d.formatMessage($.copySearchIndexReadiness)}),f?null:(0,E.jsx)("div",{style:p.indexBuilding,children:(0,E.jsxs)(q().fI,{gap:4,alignItems:"center",children:[(0,E.jsx)(s(331542).A,{style:{height:12,width:12}}),"Building..."]})})]})})),[h,m,f,p.buttonContainer,p.indexBuilding,d])}const $=(0,g().YK)({copySearchIndexReadiness:{id:"miniSearch.copySearchIndexReadiness",defaultMessage:"Button to copy local/client search index readiness"},thumbsUpFeedback:{id:"miniSearch.thumbsUpFeedback",defaultMessage:"Give thumbs up feedback"},thumbsDownFeedback:{id:"miniSearch.thumbsDownFeedback",defaultMessage:"Give thumbs down feedback"}});var Y=()=>s(529324),G=()=>s(506166),Q=()=>s(799384),Z=()=>s(349348),X=()=>s(177148),J=()=>s(788621),ee=()=>s(737693),te=()=>s(435644),se=()=>s(476524),ne=()=>s(725614),re=()=>s(792540),ie=()=>s(963589),oe=()=>s(298182),ae=()=>s(493823),le=()=>s(805751),ce=()=>s(939740),de=()=>s(460292),ue=()=>s(89924),he=()=>s(524702);const pe=!0;function me(e){const{inputComboboxProps:t,queryText:s,scrollerRef:r,onEsc:i}=e,l=(0,g().tz)(),c=(0,ie().X)("unified_find_typeable_filters"),d=(0,o().K8)((()=>j().A.state.isNewElectronTab),[],{debugName:"SearchInput.isNewElectronTab"}),u=(0,a().IS)((e=>({searchIcon:{color:e.icon.secondary,width:25,height:25,marginLeft:4,marginRight:4},textContainer:{display:"flex",alignItems:"center",margin:10,gap:1},textPlaceholder:{cursor:"text"},textInput:{overflowX:"auto",overflowY:"hidden",whiteSpace:"pre"}})),[]);return(0,n.useMemo)((()=>{const n={placeholder:l.formatMessage(d?fe.openInNewTabPlaceholder:fe.defaultInputPlaceHolder),left:d?(0,Z().Y)(u.searchIcon):(0,Q().o)(u.searchIcon)};return(0,E.jsx)(le().A,{capture:!0,debugName:"SearchInput",children:(0,E.jsxs)("div",{style:u.textContainer,children:[(0,E.jsx)(de().Q,{iconGroup:Y().C,variantName:"default",colorName:"tertiary",style:u.searchIcon}),(0,E.jsx)(he().A,{...t,placeholder:n.placeholder,onClick:void 0,disabled:!1,store:s.store,inPageFind:re().Os.none,pasteBehavior:"inline",placeholderStyle:u.textPlaceholder,disableUpDownArrows:!0,disableSlashCommands:!0,disableMobileActionBar:!0,disableEmbedMenu:!0,disableInsertedDeletedAnnotations:!0,disableEmojiCommands:!0,disabledMentionTypes:oe().md,allowSearchTypeableFilters:c,disableComment:!0,style:u.textInput,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEnter:!0,disableStyleAnnotations:!0,disableSuggestEdit:!0,onChange:()=>{var e;null===(e=r.current)||void 0===e||null===(e=e.getNode())||void 0===e||e.scrollTo({top:0,behavior:"auto"})},onEsc:i}),pe&&ge?(0,E.jsx)(ge,{inputStore:s.store,setInput:s.setValue,filters:e.filters}):null]})})}),[l,d,u.searchIcon,u.textContainer,u.textPlaceholder,u.textInput,t,s.store,s.setValue,c,i,e.filters,r])}function ge(e){const{inputStore:t,setInput:s,filters:i}=e,o=(0,r().v3)(),l=(0,g().tz)(),[c,d]=(0,n.useState)(!1),u=(0,n.useCallback)((()=>{const e=o.currentUser.id;if(!e)return;const n=t.getValue()||[],r=(0,p().wmz)((0,p().J_S)(e)),i=n.length>0?[...n,r]:[r];s(i),ne().setSelectionAtEnd({store:t}),d(!1)}),[o.currentUser.id,t,s]),h=(0,n.useCallback)((()=>{const e=t.getValue()||[],n=(0,p().wmz)((0,p().C_C)()),r=e.length>0?[...e,n]:[n];s(r),d(!1)}),[t,s]),m=Boolean(i),f=(0,a().IS)((e=>{const t={width:20,height:20};return{baseIcon:t,personIcon:{...t,color:e.icon.bluePrimary[500]},filterIcon:{height:22,width:22}}}),[]),v=(0,n.useMemo)((()=>({items:[{key:"my-docs-option",render:e=>(0,E.jsx)(ae().p,{...e,iconLeading:J().personCircleIcon,iconStyle:f.personIcon,children:(0,E.jsx)("div",{children:l.formatMessage(fe.myDocsFilter)})}),action:()=>u()}],render:e=>(0,E.jsx)(ue().A,{...e,title:l.formatMessage(fe.suggestedSectionTitle)}),key:"suggested-filter-section"})),[u,l,f.personIcon]),y=(0,n.useMemo)((()=>{const e=e=>{se().zU({filterType:e,inputStore:t,setInput:s}),d(!1)};return{items:[{key:"search-filters-author-filter-option",render:e=>(0,E.jsx)(ae().p,{...e,iconLeading:J().personCircleIcon,iconStyle:f.baseIcon,children:l.formatMessage(fe.authorFilter)}),action:()=>e("by")},{key:"search-filters-in-filter-option",render:e=>(0,E.jsx)(ae().p,{...e,iconLeading:X().Y,iconStyle:f.baseIcon,children:l.formatMessage(fe.inFilter)}),action:()=>e("in")},{key:"title-only-option",render:e=>(0,E.jsx)(ae().p,{...e,iconLeading:te().a,iconStyle:f.baseIcon,children:`${l.formatMessage(fe.titleOnlyFilter)}`}),action:()=>h()},{key:"search-filters-team-filter-option",render:e=>(0,E.jsx)(ae().p,{...e,iconLeading:ee().V,iconStyle:f.baseIcon,children:l.formatMessage(fe.teamFilter)}),action:()=>e("team")}],render:e=>(0,E.jsx)(ue().A,{...e,title:l.formatMessage(fe.addFilterSectionTitle)}),key:"filter-section"}}),[h,t,l,s,f.baseIcon]),b=(0,n.useMemo)((()=>(0,E.jsx)(ce().Ay,{type:ce().Oh.Vertical,disableKeyboardArrowWrap:!0,initialFocus:0,sections:[y,v],style:{width:200}})),[v,y]);return(0,E.jsx)(B().Ay,{trapFocus:!0,open:c,popupType:B().nl.Popup,origin:(0,E.jsx)(U().A,{icon:G().E,iconStyle:f.filterIcon,color:m?"uiBluePrimary":"secondary",onClick:()=>d(!0),ariaLabel:l.formatMessage({id:"miniSearch.filterButton.ariaLabel",defaultMessage:"Filter"})}),onDismiss:()=>d(!1),render:()=>b})}const fe=(0,g().YK)({openInNewTabPlaceholder:{defaultMessage:"Open in new tab...",id:"SearchInput.openInNewTab"},defaultInputPlaceHolder:{defaultMessage:"Search or ask anything",id:"SearchInput.defaultInputPlaceHolder"},myDocsFilter:{defaultMessage:"My docs",id:"SearchInput.myDocsFilter"},authorFilter:{defaultMessage:"From",id:"SearchInput.authorFilter"},inFilter:{defaultMessage:"In",id:"SearchInput.inFilter"},teamFilter:{defaultMessage:"Teamspace",id:"SearchInput.teamFilter"},addFilterSectionTitle:{defaultMessage:"Add a filter",id:"SearchInput.addFilterSectionTitle"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"SearchInput.suggestedSectionTitle"},titleOnlyFilter:{defaultMessage:"Title only",id:"SearchInput.titleOnlyFilter"}});s(944114),s(517642),s(658004),s(733853),s(845876),s(432475),s(515024),s(731698),s(823215);var ve=()=>s(584262),ye=()=>s(356596),be=()=>s(798880),Se=()=>s(620333),xe=()=>s(284371),Ie=()=>s(728611),we=()=>s(751380);s(803949);class Ae extends(()=>s(757695))().Store{getInitialState(){return{pageIdToUsers:{},similarUserIdToLastVisitedPageId:{}}}getPageIdToActiveSimilarUsersCount(){const e={};for(const[t,n]of(0,s(534177).WP)(this.state.pageIdToUsers))e[t]=(null==n?void 0:n.length)??0;return e}}const Me=new Ae;var Te=()=>s(866515);const je=6e4;function Ce(e){return Date.now()-e.timestamp>=e.numberOfMinutes*je}var ke=()=>s(982254),Fe=()=>s(760217),Re=()=>s(187820),Be=()=>s(128295),Ne=()=>s(126126),Pe=()=>s(90612),Ee=()=>s(913441),Ke=()=>s(825972),Ve=()=>s(392890),_e=()=>s(187174),Oe=()=>s(338931),Le=()=>s(523239),De=()=>s(677169),qe=()=>s(614016),Ue=()=>s(379560);function ze(e){const{numberOfRecentPagesToShow:t,buildMenuListItem:i}=e,a=(0,g().tz)(),l=function(){const e=(0,r().v3)(),[t,s]=(0,n.useState)(!1),[i,a]=(0,n.useState)([]),l=(0,De().m)(),c=(0,o().K8)((()=>Ue().A.getEvents()),[]),d=(0,o().O$)(M().AppStoreCurrentSpaceStore),u=(0,o().O$)(M().AppStoreCurrentSpaceViewStore);(0,_e().Yb)((async()=>{if(!l.botId||t)return;const n="two_days",r=(0,qe().B7)(n),i=await(0,Le().qq)({environment:e,currentSpaceViewStore:u,forceRefetch:!1,reason:"background_load",botId:l.botId,timeRange:{key:n,...r}});"success"!==i&&"skipped"!==i||s(!0)}),[l.botId,u,e,t]);const h=(0,n.useCallback)((()=>{const e=Date.now();return c.filter((t=>{var s;if(t.isAllDay||"declined"===t.responseStatus)return!1;const n=new Date(t.end.dateTime),r=(0,Ve().A)(n,5);return((null===(s=t.attachments)||void 0===s?void 0:s.length)??0)>0&&r.getTime()>=e}))}),[c]);return(0,Te().n)((()=>{const e=h(),t=e.map((e=>e.id)),s=i.map((e=>e.id));(0,f().R9)(t,s).length>0&&a(e)}),12e4,t),(0,o().K8)((()=>{const t=[];for(const s of i){const{attachments:n}=s;if(2===t.length)break;const r=(0,f().oE)((n??[]).map((t=>{const s=t.fileUrl;return(0,Oe().xy)({environment:e,fileUrl:s,currentSpaceStore:d})})).filter((e=>null==e?void 0:e.isReady()))),i=r.length>0?r[0]:void 0;i&&!t.includes(i)&&t.push(i)}return t}),[i,e,d])}(),c=(0,o().K8)((()=>{const e=(0,s(186445).ao)();return Ke().NK.state.filter((t=>t.pageId!==(null==e?void 0:e.id)&&!l.some((e=>e.id===t.pageId)))).slice(0,t-l.length)}),[t,l]),d=(0,o().K8)((()=>{const e=new Map;return c.forEach(((t,s)=>{const n=(0,Ke().ht)(t.visitedAt),r=Xe({blockStore:t.store,idx:s,resultFeatureNames:["RECENT_ALIVE_PAGES"]}),o=i(r);var a;e.has(n)?null===(a=e.get(n))||void 0===a||a.push(o):e.set(n,[o])})),e}),[i,c],{debugName:"MiniSearch.resultsByBucket"}),u=function(){const e=(0,g().tz)(),t=(0,r().v3)(),s=(0,o().K8)((()=>j().A.state.isNewElectronTab),[],{debugName:"MiniSearch.isNewElectronTab"}),i=(0,o().K8)((()=>(0,b().iu)(ke().A.state.tabs,ke().A.state.currentTab.id)),[],{debugName:"MiniSearch.electronTabs"}),a=(0,n.useMemo)((()=>{if(s)return(0,Pe().mD)({environment:t,intl:e,electronTabs:i,isNewElectronTab:s})}),[t,e,s,i]);return a}(),h=(0,o().K8)((()=>{const e=[];if(u&&e.push({items:[u],key:"new-page",render:e=>(0,E.jsx)(ue().A,{...e})}),l.length>0){const t=l.map(((e,t)=>Xe({blockStore:e,idx:t,resultFeatureNames:["UPCOMING_MEETING_ATTACHMENTS"]})));e.push({items:t.map(i),key:"upcoming-meeting-attachments",render:e=>(0,E.jsx)(ue().A,{...e,title:a.formatMessage(We.fromCalendarEvents)})})}return Ke().Rj.forEach((t=>{const s=d.get(t);s&&0!==s.length&&e.push({items:s,key:`recent-pages-${t}`,render:e=>(0,E.jsx)(ue().A,{...e,title:(0,E.jsx)(Pe().sg,{bucket:t})})})})),e}),[i,a,u,l,d]);return h}const We=(0,g().YK)({fromCalendarEvents:{id:"miniSearch.fromCalendarEvents",defaultMessage:"From calendar events"}});function He(e){const{query:t,filters:i,searchSessionId:a,searchSessionFlowNumber:l,queryTextValueWithoutSearchFilters:c,isResultsLoading:d,onDismiss:u,results:h,currentView:p,buildMenuListItem:m}=e,f=(0,r().v3)(),v=(0,g().tz)(),y=(0,o().K8)((()=>{if(0===t.length)return[];return(0,s(830351).wn)({query:t,environment:f,searchMode:"nav-local-only"})??[]}),[f,t],{debugName:"MiniSearch.matchingActions"}),S=(0,o().K8)((()=>j().A.state.isNewElectronTab),[],{debugName:"MiniSearch.isNewElectronTab"}),x=(0,o().K8)((()=>(0,b().iu)(ke().A.state.tabs,ke().A.state.currentTab.id)),[],{debugName:"MiniSearch.electronTabs"}),I=(0,n.useMemo)((()=>(0,Se().mk)({searchSessionId:a,searchSessionFlowNumber:l})),[a,l]),w=(0,n.useCallback)((e=>(0,s(802200).g)({environment:f,result:e,action:()=>u({shouldResetQuery:!0,shouldResetMetricsState:!1}),queryId:I,isMiniSearch:!0,desktopProps:{electronTabs:x,isNewElectronTabSearch:Boolean(S)}})),[x,f,S,u,I]),A=(0,n.useMemo)((()=>{const e=[];return y.forEach((t=>{const{eventName:s}=t;"full_search"!==s&&"full_search_deep_dive"!==s&&"deep_dive"!==s&&e.push(w(t))})),e}),[w,y]),M=(0,o().K8)((()=>h.map((e=>m(e)))),[m,h],{debugName:"MiniSearch.resultItems"}),T=(0,s(385979).h)({resultsCount:h.length,shouldShow:"results"===p&&d,hideBorders:!0}),C=(0,n.useCallback)((e=>{var t;const n=(0,Ie().Vr)(null===(t=e.menuListItemAction)||void 0===t?void 0:t.event);u({shouldResetQuery:!0,shouldResetMetricsState:!1}),(0,s(36951).Iu)({environment:f,query:c,clientStore:s(166442).Kd,config:{type:"search",searchSessionId:a,scopeForNextSearch:{type:"everything",ancestorsFilter:null==i?void 0:i.ancestors,createdByFilter:null==i?void 0:i.createdBy}},openInNewTab:"tab"===n,surface:"search_modal"})}),[u,f,c,a,null==i?void 0:i.ancestors,null==i?void 0:i.createdBy]),k=(0,o().K8)((()=>function(e){const{onClick:t,intl:s}=e;return{action:t,key:"deep-find-entry-point",render:e=>(0,E.jsx)($e,{menuListProps:e,title:s.formatMessage(Ye.deepFindTitle),subtitle:s.formatMessage(Ye.deepFindSubtitle),renderIcon:e=>(0,Q().o)(e)})}}({onClick:e=>C({menuListItemAction:e}),intl:v})),[C,v]),F=(0,s(255704).O)({query:t,searchSessionId:a}),R=(0,n.useRef)(null),B=(0,o().K8)((()=>({key:"auto-streaming-search",action:()=>{R.current&&(u({shouldResetQuery:!1,shouldResetMetricsState:!0}),R.current.navigateToThread())},render:e=>(0,E.jsx)(s(86771).bF,{query:t,searchResultsStore:void 0,searchSessionId:a,menuListItemProps:e,ref:R})})),[u,t,a]),N=(0,o().K8)((()=>{const e=[];return"auto_streaming"===F?e.push(B):e.push(k),{items:e,key:"search",render:e=>(0,E.jsx)(ue().A,{...e})}}),[F,B,k]),P=(0,n.useMemo)((()=>{const e=[...A,...M,...T??[]];if(0!==e.length)return{items:e,key:"results",render:e=>(0,E.jsx)(ue().A,{...e,title:v.formatMessage(Ye.quickMatchesSectionTitle)})}}),[v,A,M,T]);return{entrypointsSection:N,queryBasedResultsSection:P}}function $e(e){const{menuListProps:t,title:s,subtitle:r,renderIcon:i}=e,{focused:o}=t,l=(0,a().IS)((e=>({container:{borderRadius:6,paddingLeft:4},titleContainer:{display:"flex",alignItems:"center",gap:8},title:{fontWeight:xe().Wy.medium},subtitle:{color:e.text.secondary,fontSize:12},enterIcon:{width:12,height:12,color:e.text.secondary},searchIcon:{width:20,height:20}})),[]),c=(0,n.useMemo)((()=>{if(o)return(0,E.jsx)("div",{children:(0,ye().K)(l.enterIcon)})}),[l.enterIcon,o]);return(0,E.jsx)(Fe().A,{...t,title:(0,E.jsx)("div",{style:l.titleContainer,children:(0,E.jsx)("span",{style:l.title,children:s})}),icon:i(l.searchIcon),style:l.container,right:c,buttonStyle:it,caption:(0,E.jsx)("span",{style:l.subtitle,children:r})})}const Ye=(0,g().YK)({deepFindTitle:{id:"miniSearch.deepFind.title",defaultMessage:"Search"},deepFindSubtitle:{id:"miniSearch.deepFind.subtitle",defaultMessage:"Get more results & AI summary"},quickMatchesSectionTitle:{id:"miniSearch.quickMatches.sectionTitle",defaultMessage:"Quick matches"}}),Ge=n.forwardRef((function(e,t){const{onDismiss:i,currentView:l,isResultsLoading:c,query:d,searchSessionId:u,searchSessionFlowNumber:h,results:p,filters:m,setCurrentView:g}=e,[f,v]=(0,n.useState)(C().ZK),[y,S]=(0,n.useState)(!1),[I,w]=(0,n.useState)(!1),A=(0,r().v3)(),M=(0,x().O)(),T=d.trim().length>0||void 0!==m,k=(0,o().K8)((()=>j().A.state.isNewElectronTab),[],{debugName:"MiniSearch.isNewElectronTab"}),F=(0,o().K8)((()=>(0,b().iu)(ke().A.state.tabs,ke().A.state.currentTab.id)),[],{debugName:"MiniSearch.electronTabs"}),R=(0,o().K8)((()=>A.device.isElectron),[A]),B=(0,o().K8)((()=>(0,s(658883).q)(A)&&R),[A,R]),N=(0,n.useCallback)((e=>{i(e),w(!1),S(!1),v(C().ZK)}),[i]),P=(0,n.useCallback)((t=>{const n=t.store,r="results"===l?"query_results":"recent_pages",i=(0,Se().mk)({searchSessionId:u,searchSessionFlowNumber:h});return{action:n=>{let{event:o}=n;return function(e){const{result:t,context:n,queryId:r,searchAnalytics:i,closeSearch:o,isCommandSearch:a,environment:l,electronTabs:c,isNewElectronTab:d,event:u}=e,h=t.store,p=(0,Ie().Vr)(u);if(i.trackSelectSearchItem({result:t,isMetaClick:Boolean(p),context:n}),o({shouldResetQuery:!0,shouldResetMetricsState:!1}),(()=>s(543491))().A.setState({queryId:r,pageId:t.store.id,timeEntered:new Date}),a){const e=(0,s(921940).A)({pageModel:h.getModel(),pageId:h.id,pageVisitSource:ve().y8.MiniQuickFind,queryId:r});s(874913).openQuickSearchResult(e)}else s(839752).q9({searchResult:{type:"custom",store:h},environment:l,pageVisitSource:ve().y8.MiniQuickFind,queryId:r,openInNew:p,electronTabSearch:{tabs:c,isNewTab:Boolean(d)},context:n})}({event:o,result:t,context:r,queryId:i,searchAnalytics:e.searchAnalytics,closeSearch:N,isCommandSearch:B,environment:A,electronTabs:F,isNewElectronTab:k})},key:n.id,render:e=>(0,E.jsx)(Qe,{...e,currentView:l,result:t})}}),[l,u,h,e.searchAnalytics,N,B,A,F,k]),K=ze({numberOfRecentPagesToShow:f,buildMenuListItem:P}),{entrypointsSection:V,queryBasedResultsSection:_}=He({query:d,filters:m,searchSessionId:u,searchSessionFlowNumber:h,queryTextValueWithoutSearchFilters:e.queryTextValueWithoutSearchFilters,isResultsLoading:c,onDismiss:i,results:p,currentView:l,buildMenuListItem:P}),O=(0,n.useMemo)((()=>{const e=[V];return _&&e.push(_),e}),[V,_]),L=(0,n.useCallback)((t=>{var s;"results"===l&&!c&&t<200?null===(s=e.fetchAdditionalServerResultsOnChange)||void 0===s||s.call(e,C().ZK):"recents"===l&&M&&(0,Pe().fQ)({environment:A,offsetFromBottom:t,spaceId:M,setIsLoadingRecents:S,setEndOfRecentsReached:w,numRecents:f,setNumRecents:v,endOfRecentsReached:I,isLoadingRecents:y,incrementBy:C().ZK})}),[e,l,I,A,y,c,f,M]),D=(0,n.useMemo)((()=>new(s(970585).A)),[]),q=(0,n.useCallback)((()=>{D.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[D]),U=(0,n.useCallback)((()=>{const e=0===V.items.length?0:1,t=V.items.length;D.setState({focus:{section:e,indexGlobal:t,indexLocal:0,footerFocused:!1}})}),[D,V.items.length]),z=(0,o().K8)((()=>{const e=D.state.focus;return T&&((null==e?void 0:e.indexGlobal)??0)>V.items.length+((null==_?void 0:_.items.length)??0)}),[D,T,V.items.length,null==_?void 0:_.items.length]),W=T&&0===(null==_?void 0:_.items.length)&&"results"===l&&!c;(0,n.useEffect)((()=>{T||"results"!==l?T&&"recents"===l&&(g("results"),U()):(g("recents"),q()),z?U():W&&q()}),[q,U,W,z,l,T,g]);const H=(0,o().K8)((()=>j().A.state.position),[]),$=(0,a().IS)((e=>{const t="sidebar"===H?500:400;return{scroller:{width:"100%",minHeight:t,maxHeight:t,position:"relative",display:"flex",flexDirection:"column"}}}),[H]);return(0,E.jsxs)(s(2143).H,{ref:t,type:s(756279).A.Y,style:$.scroller,children:[(0,E.jsx)(ce().Ay,{comboboxProps:e.menuListComboboxProps,type:ce().Oh.Vertical,initialFocus:0,sections:"recents"===l?K:O,disableKeyboardArrowWrap:!0,store:D}),W?(0,E.jsx)(st,{}):null,(0,E.jsx)(s(228927).A,{onChange:L})]})})),Qe=n.memo(n.forwardRef((function(e,t){const{focused:i,currentView:l,result:c}=e,{highlight:d,store:u}=c,h=(0,g().tz)(),p=(0,r().v3)(),m=(0,o().K8)((()=>(0,s(97059).W)(p,u.id)),[p,u]),f=(0,a().IS)((e=>({enterIcon:{width:12,height:12,color:e.text.secondary,display:i?"block":"none"},divider:{color:e.text.tertiary},pathHighlight:{color:e.text.primary,fontWeight:xe().Wy.medium},pathText:{color:e.text.tertiary}})),[i]),v=(0,o().K8)((()=>(0,Be().a6)(u)),[u]),y=(0,o().K8)((()=>{if(v)return(0,E.jsx)(Je,{store:u,pathHighlight:null==d?void 0:d.pathText,styles:f})}),[u,d,f,v]),b=(0,o().O$)(M().AppStoreCurrentSpaceStore),S=(0,o().K8)((()=>u.id),[u]),x=(0,o().K8)((()=>Me.state.pageIdToUsers[S]??[]),[S]),I=(0,o().K8)((()=>u.getIcon()),[u]),w=(0,o().K8)((()=>u.isEmptyPage()),[u]),A=(0,o().K8)((()=>(0,Re().Te)(u)),[u]),T=(0,n.useMemo)((()=>(0,E.jsx)(Re().B6,{disabled:!0,icon:I,iconRecordCategory:A,isEmptyPage:w,size:20})),[I,A,w]),j=(0,o().K8)((()=>Me.state.similarUserIdToLastVisitedPageId),[]),C=(0,n.useCallback)((e=>function(e){return!Ce({timestamp:e.timestamp,numberOfMinutes:2})}({timestamp:e.visitedAt})&&j[e.userId]===S),[j,S]),k=(0,o().K8)((()=>function(e){const{spaceStore:t,similarUsers:n,isUserPresentOnPage:r}=e,i=4;if(!t)return[];const o=[...n].sort(((e,t)=>{const s=r({userId:e.userId,visitedAt:e.visitedAt});return s!==r({userId:t.userId,visitedAt:t.visitedAt})?s?-1:1:t.visitedAt-e.visitedAt})).slice(0,i);return o.map((e=>{const n=s(630116).LU.createChildStore(t,{table:be().oo,id:e.userId});return n.load(),{store:n,visitedAt:e.visitedAt,isPresent:r({userId:e.userId,visitedAt:e.visitedAt})}}))}({spaceStore:b,similarUsers:x,isUserPresentOnPage:C})),[C,x,b]),F=(0,o().K8)((()=>k.every((e=>e.store.isReady()))),[k]),R=(0,n.useMemo)((()=>{if(!F)return null;const e=k.length;return(0,E.jsx)("div",{style:{display:"flex"},children:k.map(((t,s)=>{let{store:n,visitedAt:r,isPresent:i}=t;return(0,E.jsx)("span",{style:{zIndex:e-s},children:(0,E.jsx)(tt,{userStore:n,isPresent:i})},`search-user-presence-${n.id}-${S}-${r}`)}))})}),[F,S,k]),B=(0,n.useMemo)((()=>(0,E.jsxs)(q().fI,{gap:12,alignItems:"center",children:[R,(0,E.jsx)("div",{children:(0,ye().K)(f.enterIcon)})]})),[R,f.enterIcon]),N="recents"===l,P=(0,o().K8)((()=>!N&&(u.isType("link_to_collection")||u.isType("collection_view_page")||u.isType("collection_view"))),[N,u]),K=(0,n.useMemo)((()=>{var e;const t=c.badges??[];return Boolean(null===(e=c.localSource)||void 0===e?void 0:e.has("topPages7dPageView"))&&t.push({type:"popular_this_week",properties:{},label:"Popular this week"}),P&&t.push({type:"is_collection",properties:{},label:"Collection"}),t}),[P,c.badges,c.localSource]);return(0,E.jsx)(Fe().A,{disabled:m,disabledFeedback:m,style:{paddingLeft:4},...e,ref:t,buttonStyle:it,title:(0,E.jsx)(Ze,{badges:K,store:u,highlight:d,recordPathCaption:N&&y?y:void 0,isRecentsView:N}),caption:N?void 0:(0,E.jsx)(et,{store:u,intl:h,pathDisplay:y,styles:f}),body:(0,E.jsx)(Ee().Sh,{result:c}),icon:T,right:B,className:"notranslate"})})));function Ze(e){const{badges:t,store:r,highlight:i,recordPathCaption:l,isRecentsView:c}=e,d=(0,g().tz)(),u=(0,a().IS)((e=>({databaseIcon:{color:e.text.secondary,width:18,height:18},verifiedIcon:{width:15,height:15,color:e.blueColor},divider:{color:e.text.secondary,fontSize:12},title:{fontWeight:xe().Wy.medium,color:c?e.text.primary:e.text.secondary},titleHighlight:{color:e.text.primary}})),[c]),p=(0,we().PO)({words:(0,we().oQ)((null==i?void 0:i.title)??(null==i?void 0:i.text)),highlightText:(null==i?void 0:i.title)??(null==i?void 0:i.text),styleOverride:u.titleHighlight}),m=(0,o().K8)((()=>(0,E.jsx)(s(16006).A,{store:r,style:u.title,highlighter:p})),[r,p,u.title]),f=(0,n.useMemo)((()=>new Set(t.map((e=>e.type)))),[t]);return(0,E.jsxs)(q().fI,{gap:4,alignItems:"center",children:[m,f.has("is_collection")?(0,s(421559).T)(u.databaseIcon):void 0,f.has("verified")?(0,s(943882).w)(u.verifiedIcon):void 0,f.has("is_template")?(0,E.jsx)(Ee().rx,{label:d.formatMessage(h().Nz.template)}):void 0,f.has("popular_this_week")?(0,E.jsx)(Ee().oj,{label:d.formatMessage(h().Nz.popularThisWeek)}):void 0,f.has("most_viewed")?(0,E.jsx)(Ee().iY,{label:d.formatMessage(h().Nz.mostViewed)}):void 0,l?(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("span",{style:u.divider,children:"—"}),l]}):void 0]})}function Xe(e){const{blockStore:t,idx:s,resultFeatureNames:n}=e;return{id:t.id,score:0,spaceId:t.getSpaceId(),sources:[h().Ni.Local],featureGroups:n?[{groupName:"custom",features:n.map((e=>({name:e,value:1})))}]:[],store:t,originalPosition:s,localSource:new Set,serverEventProperties:void 0}}function Je(e){const{store:t,pathHighlight:s,styles:n}=e,r=(0,we().PO)({words:(0,we().oQ)(s),highlightText:s,styleOverride:n.pathHighlight});return(0,E.jsx)(Be().Ay,{store:t,showFullPathInTooltip:!0,highlighter:r})}function et(e){const{store:t,intl:r,pathDisplay:i,styles:a}=e,l=(0,o().K8)((()=>(0,s(819493).b)(t)),[t]),c=[i,(0,o().K8)((()=>{if(null==l||!l.canAccess)return;const e=(0,s(764880).lR)(r,l.createdBy);return(0,E.jsx)("span",{style:a.pathText,children:e})}),[l,a.pathText,r]),(0,o().K8)((()=>{const e=t.getLastEditedTime();if(e)return(0,E.jsx)("span",{style:a.pathText,children:r.formatMessage(nt.lastEdited,{time:(0,s(907514).nl)(e,{useCompactFormat:!0})})})}),[r,t,a.pathText])].filter(Boolean);return(0,E.jsx)(q().fI,{gap:4,children:c.map(((e,t)=>(0,E.jsxs)(n.Fragment,{children:[t>0&&(0,E.jsx)("span",{style:a.pathText,children:"•"}),e]},t)))})}function tt(e){const{userStore:t,isPresent:n}=e,r=(0,g().tz)(),i=(0,Ne().XE)((e=>(0,s(381349).Nq)(t.id,e)),n),{name:l,email:c}=(0,o().K8)((()=>({name:(0,s(695608).c6)(r,t.getModel()),email:t.getEmail()})),[r,t]),d=(0,a().IS)((e=>({avatarOuterOutline:{...i.avatarOuterOutline,outlineColor:n?i.avatarOuterOutline.outlineColor:e.palette.gray[100]}})),[n,i.avatarOuterOutline]);return(0,E.jsx)(z().A,{textWrap:!0,renderTooltip:()=>(0,E.jsxs)("div",{children:[(0,E.jsx)("div",{children:l}),(0,E.jsx)("div",{children:c})]}),render:e=>(0,E.jsx)("div",{style:d.avatarOuterOutline,...e,children:(0,E.jsx)("div",{style:i.avatarBorder,children:(0,E.jsx)(s(453697).A,{iconStyle:i.avatarInnerOutline,style:i.uiUserAvatarStyles,size:Ne().eQ,isOffline:!n,userStore:t,avatarShouldShowShadow:!0,initialOverrideStyle:i.initialColor})})})})}function st(){const e=(0,g().tz)(),t=(0,a().IS)((e=>({wrapper:{display:"grid",alignItems:"center",height:"100%",width:"100%",userSelect:"none",flex:1},container:{textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",gap:4},heading:{fontSize:14,fontWeight:500,color:e.text.secondary,display:"flex",alignItems:"center",gap:8},returnIcon:{width:12,height:12},returnText:{display:"flex",alignItems:"center",gap:6,fontSize:12,border:`1px solid ${e.stroke.secondary}`,padding:"2px 4px",borderRadius:4,color:e.text.secondary,fontFamily:"monospace",fontWeight:400}})),[]),s=(0,E.jsxs)("span",{style:t.returnText,children:[(0,ye().K)(t.returnIcon),e.formatMessage(nt.returnKey)]});return(0,E.jsx)("div",{style:t.wrapper,children:(0,E.jsx)("div",{style:t.container,children:(0,E.jsx)("div",{style:t.heading,children:e.formatMessage(nt.searchMoreSources,{returnButton:s})})})})}const nt=(0,g().YK)({returnKey:{id:"miniSearch.returnKey",defaultMessage:"Return"},searchMoreSources:{id:"miniSearch.searchMoreSources",defaultMessage:"Press {returnButton} to expand your search"},lastEdited:{id:"miniSearch.lastEdited",defaultMessage:"Edited {time}"}}),rt=(0,f().sg)(F().nT,75);const it={padding:"4px 8px"};function ot(){const e=(0,r().v3)(),t=(0,g().tz)(),[s,f]=(0,n.useState)("recents"),[P,K]=(0,w().$)(),V=(0,o().O$)(j().A),_=(0,o().O$)(M().AppStoreCurrentSpaceStore),O=(0,y().AI)({initialValue:[]}),L=(0,n.useRef)(null),D=function(){const e=(0,r().v3)(),t=(0,o().K8)((()=>e.device.isElectron),[e.device.isElectron]),s=(0,o().K8)((()=>j().A.state.position),[]),i=(0,n.useMemo)((()=>t?(0,m().ek)(e.device.isElectronMac)-8:void 0),[e.device.isElectronMac,t]);return(0,a().IS)((e=>({input:{margin:"10px 10px",width:"auto",fontSize:14},container:{width:"center"===s?640:420,display:"flex",flexDirection:"column"},popup:{marginTop:"sidebar"===s&&t?i:0}})),[s,t,i])}();(0,i().w)((()=>{j().A.update((e=>({...e,query:O})))}));const{query:q,queryTextValue:U,queryTextValueWithoutSearchFilters:z}=(0,o().K8)((()=>{if(!_)return{queryTextValue:[],queryTextValueWithoutSearchFilters:[],query:""};const s=O.store.getValue()??[],n=s.filter((e=>!(0,p().uPN)(e).some(p().RXL)));return{queryTextValue:s,query:(0,u().r4)({intl:t,textValue:n,userTimeZone:(0,l().P)(),deterministic:!1,disableAnnotationPrefix:!0,disableInsertedAnnotations:!1,getRecordModel:c().b.fromGetRecordValueFn(e.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(e.currentUser.id))}),queryTextValueWithoutSearchFilters:n}}),[_,O.store,t,e.defaultRecordCache.inMemoryRecordCache,e.currentUser.id]),H=(0,n.useMemo)((()=>{const e=(0,p().lfB)({textValue:U,annotationGroupingKey:p().Ifu.TemporarySearchFilter});return(0,b().c5)(e)}),[U]),$=(0,o().K8)((()=>"on"===T().default.getEligibleGroup({experimentId:"search_quickfind_prefetch"})),[]),Y=q.trim().length>0||void 0!==H,{results:G,searchSessionId:Q,searchSessionFlowNumber:Z,isResultsLoading:X,searchAnalytics:J,fetchAdditionalServerResultsOnChange:ee}=(0,S().W)({type:h().Vz.BlocksInSpace,query:q,limit:C().ZK,source:"mini_quick_find",filters:H,options:{disable:!Y,isTitleOnly:!1,usePrefetch_EXPERIMENTAL:$,overrideSearchSessionId:V.sessionId}}),te=(0,n.useRef)(Date.now());(0,n.useEffect)((()=>{Y&&_&&(rt({searchSessionId:Q,results:G.map((e=>({id:e.store.id,source:e.localSource?"local":"server"}))),searchSessionFlowNumber:Z,queryLength:q.length,queryWords:q.split(" ").length,timeToResult:Date.now()-te.current,environment:e,query:U,spaceStore:_}),te.current=Date.now())}),[G,Q]);const se=(0,n.useCallback)((t=>{var s;const n=null===(s=j().A.state.previousTextSelection)||void 0===s?void 0:s.multiSelection;(0,F().yM)({openedTimeMs:V.openedTimeMs??0,searchSessionId:V.sessionId??"",environment:e}),t.shouldResetQuery&&O.setValue([]),j().A.update((e=>({...e,isOpen:!1,isNewElectronTab:!1,openedTimeMs:t.shouldResetMetricsState?void 0:e.openedTimeMs,sessionId:t.shouldResetMetricsState?void 0:e.sessionId,previousTextSelection:void 0}))),n&&"editing"!==k().default.state.mode&&k().default.setState({forceExtendAnnotations:{},mode:"editing",multiSelection:n})}),[V.openedTimeMs,V.sessionId,e,O]),ne=(0,x().O)(),re=(0,I().T)();(0,n.useEffect)((()=>{V.isOpen&&ne&&(v().callApi({eventName:"warmSearchCache",environment:e,data:{spaceId:ne}}),v().callApi({eventName:"warmVectorDBCache",environment:e,data:{spaceId:ne},headers:(0,d().WS)({spaceId:ne})}))}),[V.isOpen,e,ne]);const ie=(0,n.useMemo)((()=>{if(ne&&re&&Q)return{space_id:ne,user_id:re,search_session_id:Q,search_session_flow_number:Z,results:G.map((e=>({...e,store:void 0,serverEventProperties:void 0}))),query:U}}),[ne,re,Q,Z,G,U]),oe=(0,o().K8)((()=>(0,E.jsxs)("div",{style:D.container,children:[(0,E.jsx)(me,{inputComboboxProps:P,queryText:O,filters:H,scrollerRef:L,onEsc:()=>se({shouldResetQuery:!1,shouldResetMetricsState:!0})}),(0,E.jsx)(Ge,{ref:L,currentView:s,isResultsLoading:X,fetchAdditionalServerResultsOnChange:ee,onDismiss:se,searchAnalytics:J,results:G,query:q,searchSessionId:Q,searchSessionFlowNumber:Z,menuListComboboxProps:K,queryTextValueWithoutSearchFilters:z,filters:H,setCurrentView:f}),(0,E.jsx)(W,{searchSessionFlowNumber:Z,quickFindFeedbackPayload:ie,currentView:s})]})),[D.container,O,s,X,ee,se,J,G,q,Q,Z,K,z,H,ie,P]);return"center"===V.position?(0,E.jsx)(R().a,{open:V.isOpen,onDismiss:()=>se({shouldResetQuery:!1,shouldResetMetricsState:!0}),render:()=>oe,transitionAppearance:"none",isWaxPaper:!0,backgroundStyle:{background:"transparent"},innerStyle:{width:"max-content",height:"max-content"},style:{display:"flex",alignItems:"center"}}):(0,E.jsx)(B().Ay,{open:V.isOpen,popupType:B().nl.Popup,style:D.popup,placementToOrigin:A().W.Bottom,alignmentToOrigin:N().C1.Start,render:()=>oe,onDismiss:()=>se({shouldResetQuery:!1,shouldResetMetricsState:!0}),trapFocus:!0,ariaLabel:t.formatMessage(at.ariaLabel)},`mini-search-${V.position}`)}const at=(0,g().YK)({ariaLabel:{defaultMessage:"Search Notion",id:"MiniSearch.ariaLabel"}}),lt=function(){return(0,o().K8)((()=>s(430483).zD.isMiniSearchModalEnabled()),[])?(0,E.jsx)(ot,{}):null}},359545:(e,t,s)=>{s.d(t,{d:()=>r});s(296540);var n=s(474848);const r=(0,s(340498).wt)("computerChip",{viewBox:"0 0 64 64",svg:(0,n.jsx)("path",{d:"m58,21.5v-3l-6-1.5v-1c0-2.47-1.53-4-4-4h-1l-1.5-6h-3l-1.5,6h-6l-1.5-6h-3l-1.5,6h-6l-1.5-6h-3l-1.5,6h-1c-2.47,0-4,1.53-4,4v1l-6,1.5v3l6,1.5v6l-6,1.5v3l6,1.5v6l-6,1.5v3l6,1.5v1c0,2.47,1.53,4,4,4h1l1.5,6h3l1.5-6h6l1.5,6h3l1.5-6h6l1.5,6h3l1.5-6h1c2.47,0,4-1.53,4-4v-1l6-1.5v-3l-6-1.5v-6l6-1.5v-3l-6-1.5v-6l6-1.5Zm-10,26.5H16V16h32v32Zm-4-28h-24v24h24v-24Zm-17,10c-1.66,0-3-1.34-3-3s1.34-3,3-3,3,1.34,3,3-1.34,3-3,3Z"})})},392890:(e,t,s)=>{s.d(t,{A:()=>a});var n=()=>s(194188),r=()=>s(7767),i=()=>s(570551),o=6e4;function a(e,t){(0,i().A)(2,arguments);var s=(0,n().A)(t);return(0,r().A)(e,s*o)}},392998:(e,t,s)=>{s.d(t,{A:()=>o});var n=()=>s(194188),r=()=>s(10123),i=()=>s(570551);function o(e,t){(0,i().A)(2,arguments);var s=(0,r().A)(e),o=(0,n().A)(t);return isNaN(o)?new Date(NaN):o?(s.setDate(s.getDate()+o),s):s}},408197:(e,t,s)=>{s.d(t,{s:()=>r});s(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.68 1.82 14.63 14.4",svg:(0,s(474848).jsx)("path",{d:"M10.566 16.22a4.6 4.6 0 0 1-2.068-.487v-.01l-1.423-.487h-.122V7.498l1.76-1.876c.293-.375.576-.938.846-1.475.179-.355.352-.7.519-.972l.36-.74a1.29 1.29 0 0 1 1.551-.527c.624.243.955.916.77 1.56l-.507 1.774c-.099.343-.241.63-.384.917a5.6 5.6 0 0 0-.376.887.404.404 0 0 0 .39.517h4.095a1.22 1.22 0 0 1 1.218 1.218c0 .42-.224.78-.555.995a1.2 1.2 0 0 1-.147 2.213c.274.224.459.556.459.936a1.21 1.21 0 0 1-1.21 1.219 1.22 1.22 0 0 1-.868 2.077zM5.734 8.148H3.663a.975.975 0 0 0-.975.975v5.138c0 .538.436.975.974.975h2.072z"})},r=(0,s(340498).wt)("handThumbsUpFill",n)},436150:(e,t,s)=>{s.d(t,{v:()=>r});s(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.68 3.77 14.63 14.4",svg:(0,s(474848).jsx)("path",{d:"m6.953 12.502 1.76 1.876c.293.375.576.938.846 1.475.179.356.352.7.519.972l.36.741c.322.527.976.741 1.551.527.624-.244.955-.917.77-1.56l-.507-1.775a5.3 5.3 0 0 0-.384-.917c-.138-.278-.276-.556-.376-.887a.404.404 0 0 1 .39-.517h4.095a1.22 1.22 0 0 0 1.218-1.218c0-.42-.224-.78-.555-.995.4-.195.672-.594.672-1.072a1.2 1.2 0 0 0-.819-1.141 1.21 1.21 0 0 0 .459-.936 1.21 1.21 0 0 0-1.21-1.219 1.22 1.22 0 0 0-.868-2.077h-4.308c-.722 0-1.424.166-2.068.488v.01l-1.423.487h-.122zM5.734 4.764v7.088H3.663a.975.975 0 0 1-.975-.975V5.74c0-.538.436-.975.974-.975z"})},r=(0,s(340498).wt)("handThumbsDownFill",n)},506166:(e,t,s)=>{s.d(t,{E:()=>i});s(296540);var n=s(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M8.35 12.274a.625.625 0 0 0 0 1.25h3.3a.625.625 0 1 0 0-1.25zM13 9.844a.625.625 0 1 1 0 1.25H7a.625.625 0 0 1 0-1.25zm-7-2.43a.625.625 0 1 0 0 1.25h8a.625.625 0 1 0 0-1.25z"}),(0,n.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},i=(0,s(340498).wt)("filterCircle",r)},529324:(e,t,s)=>{s.d(t,{C:()=>n});const n=(0,s(340498).xh)("magnifyingGlass",{default:{loader:()=>s.e(1827).then(s.bind(s,901827))},small:{loader:()=>s.e(41805).then(s.bind(s,741805))},mini:{loader:()=>s.e(20283).then(s.bind(s,420283))},large:{loader:()=>s.e(61969).then(s.bind(s,861969))}})},570551:(e,t,s)=>{function n(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}s.d(t,{A:()=>n})},606982:(e,t,s)=>{s.d(t,{A:()=>i});var n=()=>s(10123),r=()=>s(570551);function i(e,t){(0,r().A)(2,arguments);var s=(0,n().A)(e),i=(0,n().A)(t),o=s.getTime()-i.getTime();return o<0?-1:o>0?1:o}},677169:(e,t,s)=>{s.d(t,{f:()=>d,m:()=>c});s(898992),s(354520),s(672577),s(737550);var n=s(296540),r=()=>s(56366),i=()=>s(617871),o=()=>s(765957),a=()=>s(217429),l=()=>s(53137);function c(){const e=(0,n.useRef)(void 0);return(0,r().K8)((()=>{if(void 0===e.current){if(!a().default.isStatsigReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};e.current=a().default.checkGate({gateName:"calendar_home_tile_caching"})}return e.current?d():function(){var e,t,s;const n=l().A.bots.state.filter((e=>e.integration_id===i().io)),r=null===(e=o().default.state.currentSpaceViewStore)||void 0===e?void 0:e.getSelectedCalendarBotId(),a=!l().A.state.loaded||!(null!==(t=o().default.state.currentSpaceViewStore)&&void 0!==t&&t.isReady()),{spaceId:c,userId:d}=l().A.state.loaded?l().A.state:{spaceId:void 0,userId:void 0},u=null===(s=n[0])||void 0===s?void 0:s.id;if(!r)return{loading:a,botId:u,botSpaceId:c,botUserId:d};const h=n.find((e=>e.id===r));return{loading:a,botId:(null==h?void 0:h.id)??u,botSpaceId:c,botUserId:d}}()}),[])}function d(){var e;const{currentSpaceViewStore:t}=o().default.state;if(!t||!t.isReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};const s=t.getSelectedCalendarBotId();if(s&&!l().A.state.loaded)return{loading:!1,botId:s,botSpaceId:t.getSpaceId(),botUserId:t.getUserId()};const{spaceId:n,userId:r}=l().A.state.loaded?l().A.state:{spaceId:void 0,userId:void 0},a=l().A.bots.state.filter((e=>e.integration_id===i().io)),c=null===(e=a[0])||void 0===e?void 0:e.id,d=s&&a.some((e=>e.id===s))?s:c;return{loading:!l().A.state.loaded||l().A.state.loading,botId:d,botSpaceId:n,botUserId:r}}},715011:(e,t,s)=>{s.d(t,{A:()=>a});var n=s(296540),r=()=>s(959013),i=()=>s(409268),o=s(474848);function a(e){const t=(0,n.useMemo)((()=>(0,i().s)(e.store)),[e.store]);return(0,o.jsx)(r().sA,{id:"pageWordCount.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:t}})}},819493:(e,t,s)=>{s.d(t,{$:()=>T,b:()=>j});s(898992),s(908872),s(296540);var n=()=>s(662303),r=()=>s(484714),i=()=>s(56366),o=()=>s(401497),a=()=>s(764880),l=()=>s(869190),c=()=>s(959013),d=()=>s(777092),u=()=>s(921855),h=()=>s(972435),p=()=>s(963589),m=()=>s(154060),g=()=>s(303742),f=()=>s(311337),v=()=>s(962730),y=()=>s(765957),b=()=>s(706965),S=()=>s(678553),x=()=>s(89924),I=()=>s(859428),w=()=>s(125565),A=()=>s(715011),M=s(474848);function T(e){let{isPageMoreButton:t,hideTopBorder:s,store:n,wordCountStores:l,showWordCount:d}=e;const u=(0,i().K8)((()=>j(n)),[n]),{device:p}=(0,r().v3)(),T=(0,i().K8)((()=>p.isPhone),[p]),k=h().A.getIntl(),F=(0,r().v3)(),R=(0,o().IS)((()=>({menuItem:{paddingTop:T?8:s?0:6,paddingBottom:T?8:16}})),[s,T]);return(0,i().K8)((()=>{var e;const t=(0,m().A)(F)&&n.getSpaceId()!==(null===(e=y().default.state.currentSpaceStore)||void 0===e?void 0:e.id);return(0,f().y)(F)||t||(0,g().o)(y().default.state.currentSpaceStore)}),[F,n])||u&&!u.canAccess?null:(0,M.jsx)(x().A,{topBorder:!t&&!s,style:{paddingTop:t?0:8,paddingBottom:t?0:8},children:(0,M.jsx)(S().Ay,{style:u?void 0:R.menuItem,shouldWrapTitle:!0,title:u?(0,M.jsx)(I().A,{placement:v().W.Right,render:e=>(0,M.jsxs)("div",{...e,children:[d?(0,M.jsx)(w().A,{isSmall:!0,isSecondaryColor:!0,isMobile:p.isPhone,isMultiline:!0,style:{marginBottom:4,marginTop:8},children:(0,M.jsx)(c().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,M.jsx)(A().A,{store:n})}})}):void 0,l?(0,M.jsx)(C,{stores:l}):void 0,(0,M.jsx)(w().A,{isSmall:!0,isSecondaryColor:!0,isMobile:p.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,M.jsx)(c().sA,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:u.lastEditedBy.asActor?(0,a().lR)(k,u.lastEditedBy):void 0}})}),(0,M.jsx)(w().A,{isSmall:!0,isSecondaryColor:!0,isMobile:p.isPhone,style:{marginBottom:d?8:0},children:u.lastEditedTime})]}),renderTooltip:()=>(0,M.jsx)(b().A,{store:n,compactFormat:!0})}):void 0,loading:!u})})}function j(e){const t=e.getCreatedByPointer(),s=e.getCreatedTime(),r=e.getLastEditedByPointer(),i=e.getLastEditedTime(),o=h().A.getIntl();if(!e.canRead())return{canAccess:!1};if(t&&s&&i&&r){const a=(0,d().vt)({parentStore:e,pointer:t}),c=(0,l().jE)(s,n().locale,o),u=(0,d().vt)({parentStore:e,pointer:r}),h=(0,l().jE)(i,n().locale,o);if(!u)return;return{canAccess:!0,createdBy:a,createdTime:c,lastEditedBy:u,lastEditedTime:h}}}function C(e){const{stores:t}=e,s=(0,p().X)("selectable_word_count"),n=(0,i().K8)((()=>s?k(t):0),[s,t]);return s?(0,M.jsx)(w().A,{isSmall:!0,isSecondaryColor:!0,style:{marginBottom:4},children:(0,M.jsx)(c().sA,{id:"blockMetadataMenuItem.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:n}})}):null}function k(e){return e.reduce(((e,t)=>{const s=(0,u().r4)(t.getTitleValue(),t);return e+(0,u().sQ)(s)+k(t.getContentStores())}),0)}},851775:(e,t,s)=>{s.d(t,{A:()=>o});var n=()=>s(194188),r=()=>s(10123),i=()=>s(570551);function o(e,t){(0,i().A)(2,arguments);var s=(0,r().A)(e),o=(0,n().A)(t),a=s.getFullYear(),l=s.getDate(),c=new Date(0);c.setFullYear(a,o,15),c.setHours(0,0,0,0);var d=function(e){(0,i().A)(1,arguments);var t=(0,r().A)(e),s=t.getFullYear(),n=t.getMonth(),o=new Date(0);return o.setFullYear(s,n+1,0),o.setHours(0,0,0,0),o.getDate()}(c);return s.setMonth(o,Math.min(l,d)),s}},894074:(e,t,s)=>{s.d(t,{A:()=>l});var n=()=>s(10123),r=()=>s(851775),i=()=>s(194188),o=()=>s(570551);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function l(e,t){if((0,o().A)(2,arguments),"object"!==a(t)||null===t)throw new RangeError("values parameter must be an object");var s=(0,n().A)(e);return isNaN(s.getTime())?new Date(NaN):(null!=t.year&&s.setFullYear(t.year),null!=t.month&&(s=(0,r().A)(s,t.month)),null!=t.date&&s.setDate((0,i().A)(t.date)),null!=t.hours&&s.setHours((0,i().A)(t.hours)),null!=t.minutes&&s.setMinutes((0,i().A)(t.minutes)),null!=t.seconds&&s.setSeconds((0,i().A)(t.seconds)),null!=t.milliseconds&&s.setMilliseconds((0,i().A)(t.milliseconds)),s)}}}]);