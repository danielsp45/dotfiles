"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[22542,26093],{3079:(e,t,o)=>{o.d(t,{H:()=>i});var n=o(296540),r=o(474848);const i=n.forwardRef((function(e,t){const{children:n,property:i,store:l}=e,a=(0,o(171722).y)({propertyId:i,store:l})||[];return(0,r.jsx)("div",{ref:t,className:a.length?a.join(" "):void 0,children:n})}))},48105:(e,t,o)=>{o.d(t,{J:()=>p,Y:()=>u});var n=o(296540),r=()=>o(484714),i=()=>o(401497),l=()=>o(955825),a=()=>o(236030),s=()=>o(234359),c=o(474848);const d=4;function u(e){const{children:t,align:o,sticky:n,style:s}=e,u=(0,r().WS)(),p=(0,i().IS)((t=>{const n=e.height||24,r=u?a().Um:a().tt;return{buttonWrapperStyle:{display:"flex",justifyContent:"right"===o?"end":"start",position:"absolute",top:(r-n)/2,right:0,left:0,zIndex:2,margin:`0 ${d}px`,pointerEvents:"none",...s},innerWrapperStyle:{display:"flex",pointerEvents:"auto",background:t.surface.elevated,padding:"2px",height:n,boxShadow:t.shadowSM,borderRadius:6},stickyStyle:{position:"sticky",right:d}}}),[o,u,e.height,s]);return t?(0,c.jsx)("div",{style:p.buttonWrapperStyle,children:(0,c.jsx)("div",{...(0,l().AH)(p.innerWrapperStyle,n&&p.stickyStyle),className:"quickActionContainer",children:t})}):null}function p(e){const{format:t,align:o}=e;switch(t){case"table":return(0,c.jsx)(b,{...e,align:o??"right"});case"property_module":case"page":return(0,c.jsx)(m,{...e,align:o??"right"});case"compact_page":return(0,c.jsx)(f,{...e,align:o??"right"});case"board":return(0,c.jsx)(y,{...e,align:o??"right"});case"gallery":return(0,c.jsx)(S,{...e,align:o??"right"});case"list":return(0,c.jsx)(h,{...e,align:o??"right"});default:return(0,c.jsx)(u,{...e,align:o??"right"})}}function y(e){const t=(0,i().IS)((()=>({buttonWrapperStyle:{top:0,...e.style}})),[e.style]);return(0,c.jsx)(u,{...e,style:t.buttonWrapperStyle})}function m(e){const{propertyModule:t}=(0,n.useContext)(s().L8),o=(0,i().IS)((()=>({buttonWrapperStyle:{top:t&&"style"in t&&"large"===t.style?10:5,...e.style}})),[t,e.style]);return(0,c.jsx)(u,{...e,style:o.buttonWrapperStyle})}function f(e){const t=(0,i().IS)((()=>({buttonWrapperStyle:{top:"unset",...e.style}})),[e.style]);return(0,c.jsx)(u,{...e,style:t.buttonWrapperStyle})}function S(e){const t=(0,i().IS)((()=>({buttonWrapperStyle:{top:-1,...e.style}})),[e.style]);return(0,c.jsx)(u,{...e,style:t.buttonWrapperStyle})}function h(e){const t=(0,i().IS)((()=>({buttonWrapperStyle:{position:void 0,margin:0,...e.style}})),[e.style]);return(0,c.jsx)(u,{...e,style:t.buttonWrapperStyle})}function b(e){const{align:t="right"}=e,{isMobile:o}=(0,r().Y0)(),{shouldWrap:l,propertyFormat:a}=(0,n.useContext)(s().L8),p=null==a?void 0:a.width,y=(0,n.useMemo)((()=>p&&p<=32?d-4:p&&p<50?d-2:d),[p]),m=(0,i().IS)((()=>({buttonWrapperStyle:{...e.style,...o&&l?{position:"sticky",float:t,marginRight:0,marginLeft:2,right:y}:{margin:`0 ${y}px`}}})),[t,y,o,e.style,l]);return(0,c.jsx)(u,{...e,style:m.buttonWrapperStyle,sticky:!0})}},56740:(e,t,o)=>{o.d(t,{U:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("chevronUpDown",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M10 3.20801C10.1185 3.20801 10.2279 3.23307 10.3281 3.2832C10.4329 3.32878 10.5332 3.39714 10.6289 3.48828L14.5186 7.2207C14.5915 7.29362 14.6507 7.37793 14.6963 7.47363C14.7464 7.56934 14.7715 7.67643 14.7715 7.79492C14.7715 7.94987 14.735 8.08887 14.6621 8.21191C14.5892 8.3304 14.4912 8.42383 14.3682 8.49219C14.2497 8.56055 14.1198 8.59473 13.9785 8.59473C13.8828 8.59473 13.7826 8.57878 13.6777 8.54688C13.5775 8.51042 13.484 8.44889 13.3975 8.3623L10 5.04004L6.60254 8.3623C6.51595 8.45345 6.42253 8.51497 6.32227 8.54688C6.22201 8.57878 6.12174 8.59473 6.02148 8.59473C5.87565 8.59473 5.74349 8.56055 5.625 8.49219C5.50651 8.42383 5.41081 8.3304 5.33789 8.21191C5.26497 8.08887 5.22852 7.94987 5.22852 7.79492C5.22852 7.67643 5.2513 7.56934 5.29688 7.47363C5.34701 7.37793 5.41081 7.29362 5.48828 7.2207L9.37109 3.48828C9.4668 3.39714 9.56706 3.32878 9.67188 3.2832C9.77669 3.23307 9.88607 3.20801 10 3.20801ZM10 16.9209C9.88607 16.9209 9.77669 16.8958 9.67188 16.8457C9.56706 16.8001 9.4668 16.7318 9.37109 16.6406L5.48828 12.9082C5.41081 12.8307 5.34701 12.7441 5.29688 12.6484C5.2513 12.5527 5.22852 12.4456 5.22852 12.3271C5.22852 12.1722 5.26497 12.0355 5.33789 11.917C5.41081 11.7985 5.50651 11.7051 5.625 11.6367C5.74349 11.5684 5.87565 11.5342 6.02148 11.5342C6.12174 11.5342 6.22201 11.5501 6.32227 11.582C6.42253 11.6139 6.51595 11.6755 6.60254 11.7666L10 15.0889L13.3975 11.7666C13.484 11.68 13.5775 11.6208 13.6777 11.5889C13.7826 11.5524 13.8828 11.5342 13.9785 11.5342C14.1198 11.5342 14.2497 11.5684 14.3682 11.6367C14.4912 11.7051 14.5892 11.7985 14.6621 11.917C14.735 12.0355 14.7715 12.1722 14.7715 12.3271C14.7715 12.4456 14.7464 12.5527 14.6963 12.6484C14.6507 12.7441 14.5915 12.8307 14.5186 12.9082L10.6289 16.6406C10.5332 16.7318 10.4329 16.8001 10.3281 16.8457C10.2279 16.8958 10.1185 16.9209 10 16.9209Z"})})},86499:(e,t,o)=>{o.d(t,{q:()=>i});var n=()=>o(645873);const r=new(n().O2)("RelationMenuRow",(async()=>{const{RelationMenuRow:e}=await o.e(18766).then(o.bind(o,243443));return{RelationMenuRow:e}})),i=(0,n()._h)(r,(e=>e.RelationMenuRow))},93549:(e,t,o)=>{o.d(t,{j:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("parentItem",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.29662 5.47368L7.33167 4.11653L6.30839 5.24265L4.22625 7.32458C4.16064 7.39019 4.0821 7.43856 3.99288 7.47024C3.90958 7.5013 3.82192 7.51646 3.73089 7.51646C3.54036 7.51646 3.37427 7.45062 3.24187 7.31823L3.23992 7.31628C3.11249 7.18353 3.04999 7.01804 3.04999 6.82921C3.04999 6.63758 3.12598 6.46746 3.2656 6.32285L3.26711 6.32129L7.4749 2.10083C7.62016 1.9509 7.79567 1.87 7.99651 1.87C8.19734 1.87 8.37284 1.95089 8.51809 2.10079L12.7355 6.32457C12.8705 6.46954 12.943 6.63917 12.943 6.82921C12.943 7.01927 12.8775 7.18502 12.7458 7.31725C12.617 7.45083 12.4522 7.51646 12.2621 7.51646C12.1706 7.51646 12.0814 7.50115 11.995 7.47068L11.9926 7.4698C11.9069 7.43769 11.8313 7.38908 11.7668 7.32458L9.6802 5.238L8.65635 4.11153L8.69652 5.47736L8.69011 9.81896C8.69011 10.5736 8.80303 11.157 9.01808 11.5793C9.2312 11.9935 9.55909 12.2887 10.0079 12.4675L10.0088 12.4678C10.4652 12.6536 11.062 12.7499 11.8051 12.7499C11.952 12.7499 12.0793 12.7478 12.1871 12.7436C12.303 12.7393 12.417 12.7372 12.5287 12.7372C12.7186 12.7372 12.8855 12.7955 13.0191 12.9179C13.1612 13.0441 13.2287 13.2138 13.2287 13.4117C13.2287 13.5394 13.2018 13.6569 13.1388 13.7556C13.0846 13.8467 13.0093 13.919 12.9157 13.9718C12.8317 14.0256 12.7415 14.0631 12.6459 14.0833C12.5373 14.1068 12.4035 14.12 12.2469 14.1243C12.0973 14.1286 11.931 14.1307 11.748 14.1307C10.2678 14.1307 9.14333 13.8104 8.40142 13.144C7.6536 12.4723 7.29657 11.3702 7.29657 9.87609L7.29662 5.47368Z"})})},112217:(e,t,o)=>{o.d(t,{QE:()=>Oe,eH:()=>De,$s:()=>Ke,iM:()=>He,eM:()=>ze,F1:()=>$e,hF:()=>Ve,bn:()=>Ye,I5:()=>Ue,$$:()=>qe,Kr:()=>Fe,DE:()=>Ne,Dd:()=>Je,Tn:()=>Me,jD:()=>Re});o(944114),o(898992),o(354520),o(581454),o(737550);var n=o(296540),r=()=>o(484714),i=()=>o(852507),l=()=>o(56366),a=()=>o(401497),s=()=>o(970013),c=()=>o(713998),d=()=>o(784892),u=()=>o(191772),p=()=>o(496603),y=()=>o(522986),m=()=>o(27732),f=()=>o(870578),S=()=>o(751156),h=()=>o(86499),b=()=>o(458366),g=()=>o(571468),x=()=>o(671891),v=()=>o(962730),C=()=>o(970585),k=()=>o(630116),w=()=>o(704152),P=()=>o(939740),I=()=>o(89924),j=()=>o(859428),R=()=>o(68350),M=(o(908872),()=>o(908006)),_=()=>o(66689),T=()=>o(700500),B=()=>o(743176),A=()=>o(689094),E=o(474848);const L=(0,o(340498).wt)("replace",{viewBox:"0 0 16 16",svg:(0,E.jsx)("path",{d:"M3.26465 3.96094C2.95996 4.26562 2.979 4.66553 3.23291 4.8877C3.49316 5.12256 3.86133 5.12256 4.16602 4.83057C5.11182 3.80225 6.48291 3.15479 8 3.15479C10.6851 3.15479 12.856 5.12891 13.2051 7.66162H12.2466C11.7642 7.66162 11.6309 8.01709 11.9102 8.41064L13.4209 10.5435C13.6494 10.8608 13.9985 10.8608 14.2334 10.5435L15.7441 8.41699C16.0298 8.02344 15.8965 7.66162 15.4077 7.66162H14.519C14.1445 4.44336 11.3516 1.85986 8 1.85986C6.13379 1.85986 4.43262 2.68506 3.26465 3.96094ZM0.249512 8.42334C-0.0297852 8.81689 0.097168 9.17871 0.585938 9.17871H1.4873C1.85547 12.397 4.64844 14.9805 8 14.9805C9.87256 14.9805 11.5737 14.1553 12.748 12.873C13.0464 12.5684 13.0273 12.1685 12.7734 11.9399C12.5132 11.7051 12.1514 11.7114 11.8403 12.0034C10.9009 13.0381 9.52979 13.6855 8 13.6855C5.32129 13.6855 3.14404 11.7178 2.79492 9.17871H3.74707C4.22949 9.17871 4.36279 8.82324 4.0835 8.42969L2.57275 6.29688C2.34424 5.97949 1.99512 5.97949 1.7666 6.29688L0.249512 8.42334Z"})});var W=()=>o(381138),F=()=>o(179034),V=()=>o(919709),K=()=>o(959013),z=()=>o(284371),O=()=>o(970330),D=()=>o(679924);var H=()=>o(846156);var N=()=>o(557281),U=()=>o(176072),q=()=>o(44729),Q=()=>o(246826),Y=()=>o(899453),X=()=>o(319975),$=()=>o(725614),J=()=>o(895876),Z=()=>o(780054),G=()=>o(645873);const ee=new(G().O2)("RelationPropertyCustomizeLayoutMenu",(async()=>{const{default:e}=await o.e(92222).then(o.bind(o,50651));return{RelationPropertyCustomizeLayoutMenu:e}})),te=(0,G()._h)(ee,(e=>e.RelationPropertyCustomizeLayoutMenu));var oe=()=>o(476492),ne=()=>o(594794),re=()=>o(478726),ie=()=>o(299545),le=()=>o(685889),ae=()=>o(163194),se=()=>o(317958);const ce={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0};function de(e){const t=(0,n.useContext)(o(175116).p2),i=(0,l().uB)(void 0,C().A),u=(0,l().uB)(void 0,o(170253).A),[p,y]=(0,n.useState)(10),{schema:g,format:v,locked:j,property:M,collectionStore:T,store:B,disabled:W,visibility:V,isInPeekRenderer:z,topBorder:O,pagePropertiesStore:N,blockPropertyValueOverlayStore:q}=e,Q=(0,r().v3)(),X=(0,l().K8)((()=>{const e=g[M];if(!e||"relation"!==e.type)return[];const t=B.getPropertyValue(M);return c().bG({relationValue:c().n(t),propertySchema:e,getRecordModel:B.getRecordModel,includeNoAccess:!0})}),[g,M,B],{useDeepEqual:!0}),J=(0,l().K8)((()=>X.length),[X.length]),G=(0,n.useCallback)(((e,t)=>function(e,t,o,n,r,i,l,a){const d=r[i];if(!d||"relation"!==d.type)return;const u=s().Nv(d);if(!u)return;const p=k().md.createChildStore(l,u);if(!(0,ie()._p)(l)||!i)return;const y=l.getPropertyValue(i),m=c().n(y),f=[...e.map((e=>({id:e,spaceId:n.pointer.spaceId,table:F().ev}))),...m.slice(e.length)];he({newValues:f,oldValues:m},p,l,i,o),(0,H().F)(o,{from:"relation_section"}),U().pl({store:a,focus:{section:0,indexLocal:t.endPosition,indexGlobal:t.endPosition,footerFocused:!1}})}(e,t,Q,T,g,M,B,i)),[Q,T,g,M,B,i]),ee=(0,n.useCallback)(((o,n,r)=>xe(o,n,r,Q,e.blockPropertyValueOverlayStore,B,M,t,te)),[t,Q,M,e.blockPropertyValueOverlayStore,B]),te=(0,n.useRef)(null),oe=g[M],ne=(0,l().K8)((()=>null==t?void 0:t.permissionScopesStore.state),[t]),le=(0,l().K8)((()=>{if("relation"===(null==oe?void 0:oe.type)&&t)return oe}),[t,oe]),ae=(0,l().K8)((()=>{if(!le)return;const e=s().Nv(le);return e?k().md.createChildStore(B,e):void 0}),[le,B]),de=(0,l().K8)((()=>(null==ae?void 0:ae.canEdit())??!1),[ae]),me=(0,l().K8)((()=>{const e=T.getSchema()[M];return Boolean(e&&s().UU(e))}),[T,M]),ve=(0,l().K8)((()=>B.canEdit()),[B]),Ce=(0,l().K8)((()=>(0,re().fc)(B)),[B]),ke=(0,a().IS)((e=>({addNewRelationButtonWrapper:fe(e),addNewRelationButtonIcon:Se(e),replacePageSprint:{color:e.text.secondary}})),[]),we=(0,n.useMemo)((()=>X.slice(0,p)),[X,p]),Pe=(0,l().K8)((()=>(null==ae?void 0:ae.getFormatStore().getKeyStore("app_config_uri").getValue())===_().av),[ae]),Ie=1===(null==le?void 0:le.limit),je=!(Z().A.isMobile||W||j||Ie),Re=(0,x().l)(B),Me=(0,l().K8)((()=>{var e;return"hide"===(null==Re||null===(e=Re.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[Re]),_e=(0,n.useCallback)((()=>{ae&&le&&(Pe?be(ae,e.store,e.property,X,Q):me||Ie?ee(!0):ge(X.length>=p?p:X.length+1,ae,"relation_section_footer",Q,B,M,T,p,y,t,le))}),[t,T,p,Q,ee,Ie,me,Pe,M,e.property,e.store,le,X,B,ae]),Te=(0,l().K8)((()=>{if(!ae||!le||!T)return[];const e=ae.getFormatStore().getKeyStore("app_config_uri").getValue()===_().av;return we.reduce(((o,n,r)=>{const l=k().Bv.createChildStore(B,n),a=l.getAssociatedCollectionStore(),c=!l.canRead();if((null==a?void 0:a.id)===s().zO(le)||c){const n={key:l.id,render:o=>{let{ref:n,...a}=o;return(0,E.jsx)(h().q,{...a,canDrag:je&&1!==le.limit&&B.canEdit(),schema:g,propertySchema:le,collectionStore:T,collectionId:T.id,targetCollectionStore:ae,relatedPageStore:l,disabled:W,locked:j,isSelected:!0,pageStore:B,property:M,rowType:"section",onActionButtonClick:()=>function(e,t,o,n,r,i,l,a,s,c){const d=i[l];if("relation"!==(null==d?void 0:d.type)||!c)return;if((0,re().fc)(r))return;const u=d.limit,p=u?[]:e.filter((e=>e.id!==t.id));S().createAndCommit({userAction:"RelationSection.handleRemoveRelationClick",environment:n,canUndo:!0,perform:e=>{m().Iq({store:r,propertyId:l,value:p,environment:n,relatedPageId:t.id,propertySchema:d,transaction:e,collectionContextStore:c,analyticsData:{isFromBulkActionsToolbar:b().pi(a),analyticsFrom:b().zP("page")},isUnthrottled:!1})}}),function(e,t){(0,D().v)(e,"relation_remove_block",t)}(n,{from:"relation_section",collection_id:null==s?void 0:s.id,target_collection_id:null==o?void 0:o.id})}(X,l,ae,Q,B,g,M,q,T,t),onMouseLeave:()=>i.unsetFocus(),onSecondaryButtonClick:()=>ge(r+1,ae,"relation_section_inline",Q,B,M,T,p,y,t,le),onInsertInline:e?()=>{$().clear({environment:Q})}:()=>ge(r+1,ae,"relation_section_inline",Q,B,M,T,p,y,t,le),onTitleEsc:()=>{var e;!Boolean(null===(e=l.getTitleStore())||void 0===e||null===(e=e.getValue())||void 0===e?void 0:e.length)&&"relation"===le.type?function(e){const{relatedPageStore:t,environment:o,store:n,property:r}=e;if((0,re().fc)(n))return;S().createAndCommit({userAction:"RelationSection.handleDeleteRelatedPage",environment:o,canUndo:!0,perform:e=>{const i={pointer:t.pointer,command:"update",path:[],args:{alive:!1}};S().applyOperation({store:t,operation:i,transaction:e}),Y().zB({environment:o,store:n,propertyId:r,id:t.id,transaction:e})}})}({relatedPageStore:l,environment:Q,store:B,property:M}):$().clear({environment:Q})},onOpenPageButtonClick:c?void 0:()=>{f().k({relationPointers:X,relatedPageStore:l,environment:Q,from:"relation_section_inline"})},index:r+1,propertyLimit:le.limit})},action:e=>{}};o.push(n)}return o}),[])}),[ae,le,T,we,B,je,g,W,j,M,X,Q,q,t,i,p]);if(!("section_hide"!==V&&le&&ae&&t&&ne))return null;if("minimal"===V)return(0,E.jsx)(pe,{property:M,propertySchema:le,numberOfRelations:J,onHandleOpenProperty:ee,onHandleRelationPropertyPageSectionRefMount:e=>{e&&(te.current=e)},schema:g,format:v,disabled:W,locked:j,canConfigureCollection:ne.canConfigureCollection,blockStore:B,collectionStore:T,collectionContextStore:t,isInPeekRenderer:z,targetCollectionStore:ae,pagePropertiesStore:N,shouldHideIcon:Me});const Be=Te.map((e=>e.key.toString())),Ae=(0,E.jsx)(P().Ay,{type:P().Oh.Vertical,store:i,initialFocus:void 0,disableKeyboard:!0,style:{width:"100%"},sections:[{key:"section",render:e=>(0,E.jsx)(I().A,{...e,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,children:je?(0,E.jsx)(o(439264).Ay,{direction:"vertical",keys:Be,renderKey:t=>e.children[Be.indexOf(t)],onDrop:G,store:u}):e.children}),items:Te}]});return(0,E.jsx)(ye,{collectionContextStore:t,isConnectedRelation:me,title:e.propertyRowName??(0,E.jsx)(R().I,{schema:g,format:v,property:M,blockStore:B,collectionStore:T,disabled:W,locked:j,canConfigureCollection:ne.canConfigureCollection,styleVariants:ue,isInPeekRenderer:z,pagePropertiesStore:N,hideIcon:Me}),collectionStore:T,targetCollectionStore:ae,property:M,showRight:!0,disabled:W,schema:g,format:v,locked:j,canEditTargetCollection:de,canConfigureCollection:ne.canConfigureCollection,canEditCurrentPage:ve,handleMouseMove:e.handleMouseMove,onHandleOpenProperty:()=>{xe(!1,void 0,void 0,Q,q,B,M,t,te)},onHandleRelationPropertyPageSectionRefMount:e=>{e&&(te.current=e)},onTitleEnter:()=>ge(void 0,ae,"relation_section_inline",Q,B,M,T,p,y,t,le),handleClearProperty:()=>be(ae,B,M,X,Q),topBorder:O,children:(0,E.jsxs)("div",{style:{flex:1,minWidth:0,display:"flex",flexWrap:"wrap",flexDirection:"column",width:"100%",...Z().A.isMobile&&{paddingLeft:"none"}},onMouseMove:e.handleMouseMove,onMouseLeave:e.handleMouseLeave,children:[Ae,X.length>p&&(0,E.jsx)(w().A,{style:{width:"100%",display:"flex",alignItems:"center",borderRadius:3,fontSize:14,minHeight:30,margin:0,padding:"6px 8px 7px 8px"},onClick:()=>y(p+10),children:(0,E.jsx)(se().A,{count:X.length-p,format:d().NY.Medium,style:{margin:void 0},fixedHeight:!1,isCompact:!1})}),de&&ve&&!j&&!Ce&&(0,E.jsx)(w().A,{style:ke.addNewRelationButtonWrapper,onClick:_e,disabled:W||j,children:0===J?(0,E.jsxs)(E.Fragment,{children:[(0,A().W)({...ke.addNewRelationButtonIcon,marginLeft:6,marginRight:6}),(0,E.jsx)(K().sA,{id:"RelationPropertyPageSection.button.addPage",defaultMessage:"New"})]}):(0,E.jsxs)(E.Fragment,{children:[Pe?(0,o(729650).M)({width:16,height:16,marginRight:11,marginTop:1,marginLeft:4,fill:"#868682"}):1===le.limit?L(ke.addNewRelationButtonIcon):(0,A().W)(ke.addNewRelationButtonIcon),(0,E.jsxs)("div",{style:ce,children:[Pe&&(0,E.jsx)("span",{style:ke.replacePageSprint,children:(0,E.jsx)(K().sA,{id:"RelationPropertyPageSection.button.replacePageSprint",defaultMessage:"Move to backlog"})}),!Pe&&(1===le.limit?(0,E.jsx)(K().sA,{id:"RelationPropertyPageSection.button.replacePage",defaultMessage:"Replace"}):(0,E.jsx)(K().sA,{id:"RelationPropertyPageSection.button.addPage",defaultMessage:"New"}))]})]})})]})},M)}const ue={width:{variant:"hug-content"},height:{variant:"small"},fontWeight:"medium",size:"small"};function pe(e){const{property:t,propertySchema:o,numberOfRelations:r,schema:i,format:s,disabled:c,locked:d,canConfigureCollection:u,blockStore:p,collectionStore:y,onHandleOpenProperty:m,onHandleRelationPropertyPageSectionRefMount:f,isInPeekRenderer:S,targetCollectionStore:h,pagePropertiesStore:b,shouldHideIcon:g}=e,x=(0,a().IS)((e=>({hoverButton:{display:"flex",alignItems:"baseline",justifyContent:"normal",color:e.text.secondary,width:"100%"},minimalButton:{display:"flex",alignItems:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:4,fontSize:14,lineHeight:1.2,minWidth:0,paddingLeft:6,paddingRight:8,fontWeight:z().Wy.regular,color:e.text.tertiary},minimalButtonWrapper:{width:"100%",maxWidth:"100%",fontWeight:z().Wy.regular,color:e.text.tertiary},iconStyle:{width:14,height:14,fill:e.icon.tertiary,marginRight:6,alignItems:"baseline"},minmalButtonLabelStyle:{...z().RC}})),[]),v=(0,a().DP)(),C=(0,n.useCallback)((e=>{c||d||!u||(e.preventDefault(),b.setState({...b.state,openProperty:{property:t,isInPeekRenderer:S}}))}),[c,d,u,b,t,S]),k=(0,n.useCallback)((e=>{m(!0)}),[m]),P=(0,n.useMemo)((()=>({size:"medium",fontWeight:"regular",width:{variant:"hug-content",maxWidthDesktop:300,maxWidthMobile:300}})),[]),I=(0,n.useCallback)((()=>{b.setState({...b.state,hoveredProperty:t})}),[t,b]),j=(0,n.useCallback)((()=>{b.setState({...b.state,hoveredProperty:void 0})}),[b]),M=(0,l().K8)((()=>h.getFormatStore().getKeyStore("app_config_uri").getValue()),[h]),T=(0,J().$O)(_().av),A=(0,J().oj)(_().av);return(0,E.jsx)("div",{style:x.hoverButton,onMouseMove:I,onMouseLeave:j,children:(0,E.jsx)(R().I,{schema:i,format:s,property:t,blockStore:p,collectionStore:y,disabled:c,locked:d,canConfigureCollection:u,styleVariants:P,pagePropertiesStore:b,labelComponent:(0,E.jsx)("div",{ref:f,style:x.minimalButtonWrapper,children:(0,E.jsxs)(w().A,{style:x.minimalButton,onClick:k,onContextMenu:C,children:[(0,E.jsx)(B().zB,{size:14,style:x.iconStyle,theme:v,type:o.type??"relation",icon:o.icon}),(0,E.jsx)("div",{style:x.minmalButtonLabelStyle,children:M===_().av?(0,E.jsx)(K().sA,{id:"RelationPropertyPageSection.sprints.showSprintRelations",defaultMessage:"{numberOfRelations, plural, =0 {Add {propertyName}} one {1 {singleTypedItemName}} other {{numberOfRelations} {pluralTypedItemName}}}",values:{numberOfRelations:r,propertyName:o.name,singleTypedItemName:T,pluralTypedItemName:A}}):(0,E.jsx)(K().sA,{id:"RelationPropertyPageSection.showRelations",defaultMessage:"{numberOfRelations, plural, =0 {Add {propertyName}} one {1 {propertyName}} other {{numberOfRelations} {propertyName}}}",values:{numberOfRelations:r,propertyName:o.name}})})]},`minimal-section-${t}`)}),hideDragHandle:!0,isInPeekRenderer:S,hideIcon:g})})}function ye(e){const{collectionStore:t,targetCollectionStore:o,property:i,showRight:a,disabled:s,style:c,children:d,canConfigureCollection:u,isConnectedRelation:p,canEditCurrentPage:y,handleMouseMove:m,onHandleOpenProperty:f,onHandleRelationPropertyPageSectionRefMount:S,topBorder:h,collectionContextStore:b}=e,g=(0,l().K8)((()=>o.isSyncedCollection()),[o]),x=(0,l().K8)((()=>o.getFormatStore().getKeyStore("app_config_uri").getValue()===_().av),[o]),v=(0,l().O$)(b.permissionScopesStore),{isPhone:C}=(0,r().Y0)(),[k,w]=(0,n.useState)(!1),P=Z().A.isMobile?a:a&&k;return(0,E.jsx)("div",{style:{width:"100%"},ref:S,onMouseEnter:()=>w(!0),onMouseLeave:()=>w(!1),children:(0,E.jsx)(I().A,{...e,topBorder:h,children:d,noTextOverflow:!1,disableMobilePadding:!0,right:P&&!g&&!v.isExternallyImportedAndSyncedCollection&&!p&&(0,E.jsxs)("div",{style:{height:"100%",display:"flex",alignItems:"center",width:"100%"},children:[y&&(0,E.jsx)(me,{disabled:s,handleMouseMove:m,onClick:f,icon:W().q,tooltipMessage:x?(0,E.jsx)(K().sA,{id:"database.RelationPropertyPageSectionHeaderButton.tooltip.searchButtonSprints.message",defaultMessage:"Search for a sprint"}):(0,E.jsx)(K().sA,{id:"database.RelationPropertyPageSectionHeaderButton.tooltip.searchButton.message",defaultMessage:"Link a page"})},`searchIcon-${i}`),!C&&(0,E.jsx)(te,{collectionStore:t,targetCollectionStore:o,property:i,disabled:s||!u,rowType:"section"})]}),style:{padding:0,width:"100%",...c},mobileStyle:{boxShadow:"none"},desktopTitleStyle:{marginTop:0,marginBottom:4,paddingLeft:0,paddingRight:8,fontWeight:"normal"},mobileTitleStyle:{paddingLeft:0,paddingRight:4,alignItems:"center",fontWeight:"normal"}})})}function me(e){const{disabled:t,handleMouseMove:o,onClick:n,icon:r,tooltipMessage:i}=e,l=(0,a().IS)((e=>({buttonStyle:{width:24,height:24,borderRadius:4,display:"inline-flex",alignItems:"center",justifyContent:"center",marginRight:4},iconStyle:{width:14,height:14,flexGrow:0,flexShrink:0,fill:e.icon.secondary}})),[]);return(0,E.jsx)(j().A,{renderTooltip:()=>i,render:e=>(0,E.jsx)(w().A,{style:l.buttonStyle,onMouseMove:o,onClick:n,disabled:t,...e,children:r(l.iconStyle)})})}function fe(e){return{display:"flex",alignItems:"center",color:e.text.tertiary,borderRadius:4,paddingRight:4,height:32,width:"100%",fontSize:14}}function Se(e){return{width:16,height:16,marginRight:Z().A.isMobile?7:11,marginTop:1,marginLeft:5,fill:e.icon.tertiary}}function he(e,t,o,n,r){if(!(0,ie()._p)(o)||!n)return;let i;S().createAndCommit({userAction:"RelationToken.handleRelationPropertyMenuUpdate",environment:r,canUndo:!0,perform:l=>{const a=t.id;if(e.newPage&&a){const a=V().x9d(e.newPage.name);i=Q().Wv({environment:r,id:e.newPage.id,type:T().xd.page,properties:{title:a},spaceId:e.newPage.spaceId,inMemoryRecordCache:t.inMemoryRecordCache,transaction:l}),q().X$({childStore:i,parentStore:t,transaction:l});const s=k().Bv.createChildStore(o,i.pointer),c=t.getDefaultTemplatePageStore();return c&&N().n5({title:{text:a},environment:r,store:s,templateStore:c,isKeyboard:!1,isCreateIn:!1,transaction:l,from:"relation_property_page_section"}),void Y().K6({store:o,propertyId:n,id:i.id,environment:r,transaction:l,position:{type:"after"}})}if(e.newValues){const t=c().Ap(e.newValues),i=o.getPropertyStore(n);X().R9({environment:r,store:i,value:t,transaction:l})}}}),M().default.afterNextFlush((()=>{if(!i)return;const e=ae().A.findRow(i.id,"section",n);if(!e)return;const t=e.relationTokenBlockStoreRef.current;if(!t)return;const o=t.getBlockTitleStore(),r={start:{index:0,store:o},end:{index:0,store:o}};$().setMultiSelection({multiSelection:r})}))}function be(e,t,o,n,r){he({newValues:[],oldValues:n},e,t,o,r)}function ge(e,t,o,n,r,i,l,a,s,d,u){if(!u||"relation"!==u.type)return;if(!r.canEdit())return;if((0,re().fc)(r))return;const p=l.pointer.spaceId,y=u.limit,m=(0,ne().zP)({environment:n,table:F().ev,spaceId:p}),f=m.id;if(!(0,ie()._p)(r)||!i)return;const S=r.getPropertyValue(i),h=c().n(S);e&&e+1>a&&s(e+1);he({newPage:{id:f,spaceId:p,name:""},newValues:y?[m]:e?[...h.slice(0,e),m,...h.slice(e)]:[m,...h],oldValues:h},t,r,i,n),O().v(n,{...(0,oe().sl)(d),from:o,type:"page",target_collection_id:null==t?void 0:t.id,new_page_id:f,creating_block_id:f})}function xe(e,t,o,n,r,i,l,a,s){const c=s.current;if(!(c&&c instanceof Element))return;if((0,re().fc)(i))return;const d=o?null==o?void 0:o.getBoundingClientRect():c.getBoundingClientRect(),u=e?d.top+le().d0:d.top+5,p=new DOMRect(d.left,u,d.width,d.height);y().ho({environment:n,blockPropertyValueOverlayStore:r,store:i,property:l,rect:p,format:"page",mode:t,collectionContextStore:a}),function(e,t){(0,D().v)(e,"relation_section_link_pages",t)}(n,{from:"relation_section"})}var ve=()=>o(124954),Ce=()=>o(279620),ke=()=>o(234359),we=()=>o(414712),Pe=()=>o(40106),Ie=()=>o(167677),je=()=>o(859118);function Re(e){const{store:t,property:o,propertySchema:n}=e;return(0,l().K8)((()=>{const e=t.getPropertyValue(o);return n?c().bG({relationValue:c().n(e),propertySchema:n,getRecordModel:t.getRecordModel,includeNoAccess:!0}):void 0}),[t,o,n])}function Me(e){const{store:t,relationValue:o,propertySchema:n}=e;return(0,l().K8)((()=>{const e=null!=n&&n.limit&&o?o.slice(0,n.limit):o;if(!e)return[];const r=e.map((e=>{const o=k().Bv.createChildStore(t,e);if(!(0,g().X)(o))return{pointer:e,pageStore:o}}));return(0,p().oE)(r)}),[n,o,t])}const _e=n.memo((0,n.forwardRef)((function(e,t){const{collectionStore:r,buttonStyle:i,editButtonClickProps:c,property:d,EmptyComponent:u,onContextMenu:p,blockPropertyValueOverlayStore:y,store:m,format:f,renderAs:S,quickActionButtons:h,width:b,formQuestionStore:g,userExpandable:x}=e,{propertySchema:v,canEdit:w,baseStyles:P,collectionContextStore:I}=(0,n.useContext)(ke().L8),j=v,R=(0,o(425497).Ug)(null==P?void 0:P.tokenFormat),M=(0,l().uB)(void 0,C().A),_=Re({store:m,propertySchema:j,property:d}),T=(0,o(358167).v)({blockId:null==m?void 0:m.id,propertyId:d}),B=(0,o(171722).s)({propertyId:d,store:m}),A=Boolean(B),L=(0,n.useMemo)((()=>{const e=j?s().Nv(j):void 0;return e?k().md.createChildStore(m,e):void 0}),[j,m]),W=Me({store:m,propertySchema:j,relationValue:_}),F=0===W.length,V="rows"===S&&!F,K=(0,a().IS)((e=>({buttonStyle:{...P.buttonStyle,...i,...V&&{padding:0}},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},relationItemsWrapper:{width:"100%"}})),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,i,V]),z=(0,n.useMemo)((()=>L?"rows"===S?j&&_&&(0,E.jsx)(Te,{relationItemPointers:W,relationValue:_,collectionStore:r,menuListStore:M,store:m,targetCollectionStore:L,property:d,disabled:!w,buttonContainerRef:t,blockPropertyValueOverlayStore:y,format:f,propertySchema:j,collectionContextStore:I}):"inline"===S?(0,E.jsx)(Be,{relationItemPointers:W,store:m,tokenFormat:R,hasUnresolvedDiscussion:A,hasDraftComment:T}):"singleWithOverflow"===S?(0,E.jsx)(Ae,{relationItemPointers:W,store:m,tokenFormat:R,hasUnresolvedDiscussion:A,hasDraftComment:T,buttonContainerRef:t,blockPropertyValueOverlayStore:y,property:d,format:f,collectionContextStore:I,canEdit:w}):void(0,o(534177).HB)(S):null),[L,S,j,_,W,r,M,m,d,w,t,y,f,I,R,A,T]),O=n.useCallback((e=>z||["property_module","page"].includes(f)?(0,E.jsx)("div",{style:K.relationItemsWrapper,className:B,children:e.children}):(0,E.jsx)(E.Fragment,{children:e.children})),[B,f,z,K.relationItemsWrapper]);return F&&void 0===u?null:(0,E.jsx)(o(614001).P,{ref:t,editButtonClickProps:V?void 0:c,forceEnableButton:"singleWithOverflow"===S,onContextMenu:p,style:K.buttonStyle,hoveredStyle:K.buttonHoveredStyle,pressedStyle:K.buttonPressedStyle,quickActionButtons:h,width:b,formQuestionStore:g,userExpandable:x,children:(0,E.jsx)(O,{children:F&&void 0!==u?(0,E.jsx)(u,{}):z})})})));function Te(e){const{collectionStore:t,targetCollectionStore:o,relationItemPointers:i,relationValue:s,property:c,store:u,disabled:p,menuListStore:g,buttonContainerRef:x,blockPropertyValueOverlayStore:v,format:C,propertySchema:k,collectionContextStore:j}=e,R=(0,r().v3)(),{collectionSchemaStore:M}=(0,n.useContext)(ke().L8),_=(0,l().O$)(M),T=(0,n.useCallback)(((e,t)=>{y().ho({environment:R,blockPropertyValueOverlayStore:v,store:u,property:c,rect:null==t?void 0:t.getBoundingClientRect(),format:C,mode:e,collectionContextStore:j})}),[v,j,R,C,c,u]),B=(0,n.useCallback)(((e,t)=>{if(!j)return;const o=e.filter((e=>e.id!==t.id));S().createAndCommit({userAction:"RelationBlockPropertyValue.handleRemoveRelationClick",environment:R,canUndo:!0,perform:e=>{m().Iq({store:u,propertyId:c,value:o,environment:R,relatedPageId:t.id,propertySchema:k,transaction:e,collectionContextStore:j,analyticsData:{isFromBulkActionsToolbar:b().pi(v),analyticsFrom:b().zP(C)},isUnthrottled:!1})}})}),[v,j,R,C,c,k,u]),A=(0,a().IS)((()=>({moreMenuItem:{width:"100%",display:"flex",alignItems:"center",justifyItems:"center",borderRadius:4,fontSize:14,minHeight:32,margin:0,padding:"6px 8px"},moreMenuItemLabel:{lineHeight:"normal",margin:0}})),[]);if(!_)return null;const L=i.slice(0,5).map(((e,n)=>{let{pageStore:r}=e;return{key:r.id,render:e=>{let{ref:i,...l}=e;return(0,E.jsx)(h().q,{...l,canDrag:!1,collectionStore:t,collectionId:t.id,schema:_,propertySchema:k,targetCollectionStore:o,relatedPageStore:r,disabled:p,isSelected:!0,pageStore:u,property:c,rowType:"inline",onActionButtonClick:()=>{B(s,r)},onMouseLeave:()=>g.unsetFocus(),onSecondaryButtonClick:e=>{T({type:"view",index:n+1},e)},onOpenPageButtonClick:()=>{f().k({relationPointers:s,relatedPageStore:r,environment:R,from:"relation_property"})}})},action:()=>{}}}));return i.length>5&&L.push({key:"add",render:e=>(0,E.jsx)(w().A,{...e,style:A.moreMenuItem,onClick:e=>T({type:"view"},x&&"current"in x?x.current:void 0),children:(0,E.jsx)(se().A,{style:A.moreMenuItemLabel,count:i.length-5,format:d().NY.Medium,fixedHeight:!1,isCompact:!1})}),action:()=>{T({type:"add",index:s.length},void 0)}}),(0,E.jsx)(P().Ay,{type:P().Oh.Vertical,store:g,initialFocus:void 0,disableKeyboard:!0,style:{width:"100%"},sections:[{key:"results",render:e=>(0,E.jsx)(I().A,{...e,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,children:e.children}),items:L}]})}function Be(e){const{relationItemPointers:t,store:o,tokenFormat:n,hasUnresolvedDiscussion:r,hasDraftComment:i}=e;return(0,E.jsx)(Le,{limit:10,store:o,linkify:"whenReadOnly",relationItemPointers:t,tokenFormat:n,hasUnresolvedDiscussion:r,hasDraftComment:i,wrapTokens:!0})}function Ae(e){const{relationItemPointers:t,store:o,tokenFormat:i,hasUnresolvedDiscussion:l,hasDraftComment:s,buttonContainerRef:c,blockPropertyValueOverlayStore:d,property:u,format:p,collectionContextStore:m,canEdit:f}=e,S=(0,a().IS)((()=>({relationTokenStyle:{overflow:"hidden",width:"100%"}})),[]),h=(0,r().v3)(),b=(0,n.useCallback)((()=>{var e;y().ho({environment:h,blockPropertyValueOverlayStore:d,store:o,property:u,rect:null===(e=c&&"current"in c?c.current:void 0)||void 0===e?void 0:e.getBoundingClientRect(),format:p,mode:{type:"view",index:0},collectionContextStore:m})}),[d,c,m,h,p,u,o]),g=(0,E.jsx)(Le,{relationTokenStyle:S.relationTokenStyle,limit:1,store:o,linkify:"never",relationItemPointers:t,tokenFormat:i,hasUnresolvedDiscussion:l,hasDraftComment:s,wrapTokens:!1});return f?g:(0,E.jsx)(w().A,{...e,ignoreLocalHoverState:!0,onClick:b,children:g})}function Ee(e){let{pageStore:t}=e;const o=(0,n.useRef)(null);return(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,E.jsx)(ve().w,{blockStore:t,format:d().NY.ExtraSmall}),(0,E.jsx)(Ce().Y,{blockStore:t,noUnderline:!0,shouldWrap:!1,titleStyle:{fontSize:12},recordTitleRef:o,disableTooltip:!0})]},t.id)}function Le(e){let{linkify:t,limit:o,hasUnresolvedDiscussion:r,hasDraftComment:s,relationItemPointers:c,tokenFormat:d,store:p,relationTokenStyle:y,wrapTokens:m}=e;const f=(0,a().IS)((e=>({moreToken:{margin:0},commentHighlightWrapperStyle:r||s?{...(0,u().sQ)(e),padding:4,flexWrap:"wrap",lineHeight:2,display:"inline-flex"}:{},relationTokenHighlightStyle:r||s?{marginLeft:2,marginRight:2,maxWidth:"fit-content",display:"inline-flex"}:{}})),[s,r]),S=c.length>o,h=n.useMemo((()=>c.slice(0,o)),[c,o]);!function(e){const{store:t,relationItemPointers:o}=e,{format:r,collectionContextStore:a,property:s}=(0,n.useContext)(ke().L8);(0,i().w)((()=>{var e;"table"===r&&s&&(null==a||null===(e=a.propertyResultDurationTracker)||void 0===e||e.trackMount({pageId:t.id,propertyId:s,propertyType:"relation"}))}));const c=(0,l().K8)((()=>!o.some((e=>{let{pageStore:t}=e;return!t.isReady()}))),[o]);(0,n.useEffect)((()=>{var e;c&&"table"===r&&s&&(null==a||null===(e=a.propertyResultDurationTracker)||void 0===e||e.trackResult({pageId:t.id,propertyId:s,propertyType:"relation"}))}),[a,r,c,s,t])}({store:p,relationItemPointers:h});const b=h.map((e=>{let{pointer:o,pageStore:r}=e;return(0,E.jsx)(n.Fragment,{children:(0,E.jsx)(We,{recordPointer:o,parentStore:p,recordStore:r,style:y,propertyStyle:f.relationTokenHighlightStyle,linkify:t,noWrap:!m,disableTooltip:S})},o.id)}));S&&b.push((0,E.jsx)(se().A,{style:f.moreToken,count:c.length-o,format:d,fixedHeight:!1,isCompact:!0},"more"));const g=(0,n.useCallback)((e=>(0,E.jsx)("div",{...e,style:{marginTop:2,marginBottom:2,display:"flex",flexDirection:"column",gap:1,width:"max-content",maxWidth:320},children:c.map((e=>{let{pointer:t,pageStore:o}=e;return(0,E.jsx)(Ee,{pageStore:o},t.id)}))})),[c]),x=(0,E.jsx)(Ie().h,{style:f.commentHighlightWrapperStyle,children:b});return S?(0,E.jsx)(j().A,{renderTooltip:g,delayThreshold:500,placement:v().W.Bottom,originGap:8,render:e=>(0,E.jsx)("div",{...e,children:x})}):x}function We(e){const{style:t,recordPointer:o,recordStore:n,parentStore:r,linkify:i,disableTooltip:l,propertyStyle:a,noWrap:s}=e;return(0,g().W)(n)?null:(0,E.jsx)("div",{style:t,children:(0,E.jsx)(Pe().a,{recordPointer:o,parentStore:r,style:a,linkify:i,noWrap:s,disableTooltip:l})})}const Fe=(0,n.forwardRef)((function(e,t){const{shouldWrap:r}=(0,n.useContext)(ke().L8),i=Je(e,t),l=(0,n.useMemo)((()=>(0,E.jsx)(o(146962).k,{},"comment")),[]);return(0,E.jsx)(_e,{...i,EmptyComponent:je().rW,renderAs:"inline",quickActionButtons:l,userExpandable:r})})),Ve=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,E.jsx)(_e,{...o,EmptyComponent:je().ao,renderAs:"rows"})})),Ke=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,E.jsx)(_e,{...o,EmptyComponent:je().ao,renderAs:"singleWithOverflow"})})),ze=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=Je(e,t,(0,o(512321).F)(t,e.collectionStore,e.property,"relation"));return(0,E.jsx)(_e,{...r,EmptyComponent:n?je().Jb:void 0,renderAs:"inline"})})),Oe=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Je(e,t);return(0,E.jsx)(_e,{...n,EmptyComponent:o?je().Jb:void 0,renderAs:"inline"})})),De=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,E.jsx)(_e,{...o,renderAs:"inline"})})),He=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Je(e,t);return(0,E.jsx)(_e,{...n,EmptyComponent:o?je().Jb:void 0,renderAs:"inline"})})),Ne=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,E.jsx)(_e,{...o,renderAs:"inline"})})),Ue=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,E.jsx)(_e,{...o,renderAs:"inline"})})),qe=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,E.jsx)(_e,{...o,renderAs:"inline"})}));function Qe(){}const Ye=(0,n.forwardRef)((function(e,t){const{store:r,collectionStore:i,property:a,blockPropertyValueOverlayStore:c,isInPeekRenderer:d}=Je(e,t),{canEdit:u,propertyModule:p,propertySchema:y,collectionSchemaStore:m}=(0,n.useContext)(ke().L8),f=(0,l().O$)(m),S=(0,l().K8)((()=>r.isNonEditableState()),[r]),h=(0,n.useMemo)((()=>new(o(171018).YB)),[]),b=(0,l().K8)((()=>i.getFormat()),[i]),g=(0,l().K8)((()=>null==i?void 0:i.getParentStore()),[i]),v=(0,l().K8)((()=>!(!i||!g||"block"!==g.table)&&(0,o(33791).v)({collectionStore:i,collectionViewBlockStore:g,checkNavigableAncestorLocked:!1})),[i,g]),C=(0,x().l)(r),w=(0,l().K8)((()=>{var e;return"hide"===(null==C||null===(e=C.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[C]),P=(0,n.useMemo)((()=>{if("relation"!==(null==y?void 0:y.type))return;const e=y?s().Nv(y):void 0;return e?k().md.createChildStore(r,e):void 0}),[y,r]),I=(0,l().K8)((()=>(null==P?void 0:P.getDatabaseType())===o(636090).av),[P]);if(!y||!f)return null;const j=(0,E.jsx)(R().I,{schema:f,format:b,hideDragHandle:!0,property:a,blockStore:r,collectionStore:i,pagePropertiesStore:h,disabled:!u,locked:S,canConfigureCollection:v,isInPeekRenderer:d??!1,styleVariants:Xe,layoutModule:p,hideIcon:w});return(0,E.jsx)(o(3079).H,{store:r,property:a,ref:t,children:(0,E.jsx)(de,{store:r,collectionStore:i,disabled:!u,locked:S,property:a,schema:f,handleMouseMove:Qe,handleMouseLeave:Qe,handleContextMenu:Qe,blockPropertyValueOverlayStore:c,format:b,visibility:I?"inline":e.propertyVisibility??"inline",isInPeekRenderer:Boolean(d),topBorder:!1,showIcon:!1,propertyRowName:j,pagePropertiesStore:h})})})),Xe={width:{variant:"hug-content"},height:{variant:"small"},fontWeight:"medium",size:"small"},$e=(0,n.forwardRef)((function(e,t){const o=Je(e,t);return(0,E.jsx)(_e,{...o,EmptyComponent:je().Fe,renderAs:"inline"})}));function Je(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,blockPropertyValueOverlayStore:a,format:s,isInPeekRenderer:c,width:d,formQuestionStore:u}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,we().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,blockPropertyValueOverlayStore:a,format:s,isInPeekRenderer:c,width:d,formQuestionStore:u}}},117886:(e,t,o)=>{o.d(t,{A:()=>P});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(401497),a=()=>o(970013),s=o(474848);const c={viewBox:"0 0 16 16",fittedViewBox:"1.82 1.82 12.68 12.68",svg:(0,s.jsx)("path",{d:"M8 1.825a.575.575 0 0 0-.575.575V4a.575.575 0 0 0 1.15 0V2.4A.575.575 0 0 0 8 1.825m4.367 1.809a.575.575 0 0 0-.814 0l-1.131 1.131a.575.575 0 1 0 .813.813l1.132-1.131a.575.575 0 0 0 0-.813m-7.92 0a.575.575 0 0 0-.813.813l1.13 1.131a.575.575 0 1 0 .814-.813zm3.248 3.071a.7.7 0 1 0-.99.99l.77.77.99-.99zm4.305.72a.575.575 0 0 0 0 1.15h1.6a.575.575 0 1 0 0-1.15zm-9.6 0a.575.575 0 1 0 0 1.15H4a.575.575 0 0 0 0-1.15zm11.895 5.88-5.37-5.37-.99.99 5.37 5.37a.7.7 0 0 0 .99-.99m-8.717-2.883a.575.575 0 0 0-.813 0l-1.131 1.131a.575.575 0 1 0 .813.813l1.131-1.131a.575.575 0 0 0 0-.813M8 11.425a.575.575 0 0 0-.575.575v1.6a.575.575 0 1 0 1.15 0V12A.575.575 0 0 0 8 11.425"})},d=(0,o(340498).wt)("magicWandSmall",c);var u=()=>o(522986),p=()=>o(662453),y=()=>o(780054),m=()=>o(458366),f=()=>o(68465),S=()=>o(972435),h=()=>o(747100),b=()=>o(289190),g=()=>o(227440),x=()=>o(205682),v=()=>o(77238),C=()=>o(411671),k=()=>o(234359),w=()=>o(761529);function P(e){const{store:t,property:o,openOverlay:c}=e,P=(0,r().v3)(),{propertySchema:j,format:R,collectionContextStore:M,isEmptyStore:_,canEdit:T}=(0,n.useContext)(k().L8),B=(0,i().O$)(_),A=(0,n.useCallback)((async()=>{if(!j)return;if(c){const e=(0,h().cq)(t)?v().A:x().A;u().ho({blockPropertyValueOverlayStore:e,collectionContextStore:M,format:R,environment:P,store:t,property:o,readOnly:!0})}const e=b().m.setIsWriting({propertySchema:j,stores:[t]}),{propertyCompletionsActions:n}=await p().aiDependency.load();n.autofillPropertyForBlocks({environment:P,stores:[t],property:o,propertySchema:j,userEventForAnalytics:"generate_from_action_button",collectionContextStore:M,sessionIdForAnalytics:e,from:m().zP(R)})}),[M,P,R,c,o,j,t]),E=(0,i().K8)((()=>T&&j&&(!y().A.isMobile||B)&&(0,f().ge)(C().A.getMode(P,t),t)&&(0,a().$M)(j)&&(0,a().om)(j)&&g().A.state.online),[P,T,B,j,t]),L=(0,l().IS)((e=>({iconStyle:{color:e.text.secondary,fill:e.text.secondary,width:16,height:16}})),[]);return E?(0,s.jsx)(w().A,{icon:d,tooltip:S().A.formatMessage(I.update),onClick:A,iconStyle:L.iconStyle,style:{height:20,width:24,borderRadius:4}}):null}const I=(0,o(959013).YK)({update:{defaultMessage:"Update",id:"database.editButton.autofillWithAiTooltip"}})},124954:(e,t,o)=>{o.d(t,{w:()=>y});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(401497),a=()=>o(987555),s=()=>o(246826),c=()=>o(751156),d=()=>o(187820),u=()=>o(738865),p=o(474848);function y(e){const{clickTitleBehavior:t,blockStore:o,format:a,shouldWrap:y}=e,f="edit"===t,S=(0,r().v3)(),[h,b,g]=(0,i().K8)((()=>[o.getIcon(),o.isEmptyPage(),o.isReady()&&"none"===o.getRole()]),[o]),x=(0,i().K8)((()=>(0,d().Te)(o)),[o]),{style:v}=(0,l().IS)((()=>({style:{flexShrink:0,marginRight:f?0:u().U[a].recordIconMarginRight,justifyContent:"flex-start",...y&&{display:"inline-block",verticalAlign:"text-top",marginBottom:-1}}})),[f,a,y]),C=(0,n.useCallback)((e=>{const t=o.getIconStore();t&&c().createAndCommit({userAction:"RelationToken.handleRecordIconChange",environment:S,canUndo:!0,perform:o=>{s().KY({store:t,value:e,transaction:o})}})}),[o,S]),k={icon:h,size:u().U[a].pageIconSize,isEmptyPage:b,iconRecordCategory:x,style:v};return g?(0,p.jsx)(m,{...k}):f?(0,p.jsx)(d().B6,{...k,disabled:!1,onChange:C,bucket:"public"}):(0,p.jsx)(d().B6,{...k,disabled:!0})}function m(e){const t=(0,l().DP)();return(0,a().T)({...e.style,width:e.size,height:e.size,fill:t.icon.secondary,verticalAlign:"top",marginTop:1})}},146445:(e,t,o)=>{o.d(t,{p$:()=>L,Jd:()=>W,_R:()=>T,bZ:()=>F,VW:()=>E,K1:()=>B,e7:()=>_,de:()=>I,oN:()=>A,L$:()=>K,K2:()=>z,JJ:()=>M,cE:()=>V,Dd:()=>O});o(16280),o(898992),o(354520),o(430670),o(581454);var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(401497),a=()=>o(764880),s=()=>o(784892),c=()=>o(437607),d=()=>o(534177),u=()=>o(645873);const p=new(u().O2)("PropertyModulePersonProperty",(async()=>await Promise.all([o.e(56952),o.e(74562),o.e(27711),o.e(30291),o.e(6463),o.e(82120)]).then(o.bind(o,444823)))),y=(0,u()._h)(p,(e=>e.PersonPropertyModule));var m=()=>o(449412);const f={};function S(e){const{throttleSeconds:t,...o}=e,n=`${e.from}:${e.type}`,r=f[n],i=Date.now();(!r||i-r>1e3*t)&&(f[n]=i,function(e){const{error:t,...o}=e;(0,m().O8)(t,o)}(o))}var h=()=>o(630116),b=()=>o(146962),g=()=>o(234359),x=()=>o(414712),v=()=>o(859118),C=()=>o(962730),k=o(474848);function w(e){let{renderOrigin:t,actors:n,placement:a=C().W.Bottom,alignment:s=C().C.Start}=e;const c=(0,r().WS)(),d=(0,i().O$)(o(765957).AppStoreCurrentSpaceStore),u=(0,o(741737).c)({spaceStore:d,viewedUserStore:void 0,ignoreViewedUserStore:!0}),p=c||n.length<1||u&&n.length<2,y=(0,l().IS)((()=>({scrollContainer:{maxHeight:"min(50vh, 300px)",overflowY:"auto"},listContainer:{display:"flex",flexDirection:"column",gap:6,paddingTop:6,paddingBottom:6},tooltip:{maxWidth:300,paddingTop:0,paddingBottom:0}})),[]);return(0,k.jsx)(o(859428).A,{placement:a,alignment:s,disableTooltip:p,render:t,style:y.tooltip,allowHover:!0,renderTooltip:e=>(0,k.jsx)("div",{...e,style:y.scrollContainer,children:(0,k.jsx)("div",{style:y.listContainer,children:n.map((e=>e instanceof h().LU?(0,k.jsx)(o(994006).A,{userStore:e,avatarSize:20,inline:!0,hasTooltip:!1},e.id):e instanceof h().vK?(0,k.jsx)(o(427636).A,{botStore:e,avatarSize:20},e.id):null))})})})}const P=n.memo(w),I=n.memo(n.forwardRef((function(e,t){const{buttonStyle:r,onContextMenu:i,editButtonClickProps:a,property:c,store:d,EmptyComponent:u,tokenFontSize:p,tokenLimit:y,quickActionButtons:m,width:f,formQuestionStore:S,collectionSchema:h,limitTokensToSingleTruncatedLine:b,userExpandable:v,generateButtonStyles:C}=e,{propertySchema:w,baseStyles:P,format:I}=(0,n.useContext)(g().L8),M=(0,x().DZ)(d,c,w),_=(0,o(425497).Ug)(null==P?void 0:P.tokenFormat),T=R({store:d,property:c,propertySchema:w,format:I}),B=0===T.length,A=(0,l().IS)((e=>({buttonStyle:{...P.buttonStyle,...r,...(null==C?void 0:C(e,B))||{}},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},tokensContainer:{..._===s().NY.Inline?{gap:0}:{},...b&&{display:"flex",...o(284371).RC}},token:{...p&&{fontSize:p}},actorTokenOverlap:{..._===s().NY.Inline?{margin:o(848401).vb[_].margin}:{}},moreToken:{margin:0,...b&&{flexShrink:0}}})),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,r,B,b,C,_,p]);return B&&void 0===u?null:(0,k.jsx)(o(614001).P,{ref:t,editButtonClickProps:a,onContextMenu:i,style:A.buttonStyle,pressedStyle:A.buttonPressedStyle,hoveredStyle:A.buttonHoveredStyle,tooltipHide:_===s().NY.Inline,quickActionButtons:m,width:f,formQuestionStore:S,collectionSchema:h,userExpandable:v,children:B&&void 0!==u&&!M?(0,k.jsx)(u,{}):(0,k.jsx)(j,{values:T,tokenLimit:y,tokenFormat:_,styles:A,store:d,property:c,limitTokensToSingleTruncatedLine:b??!1})})})));function j(e){let{values:t,tokenLimit:n,tokenFormat:r,styles:s,store:u,property:p,limitTokensToSingleTruncatedLine:y}=e;const m=t.slice(0,n),f=(0,l().DP)(),S=(0,i().K8)((()=>{if(u)return(0,o(299545).O3)(u,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===p))}),[u,p]),h=(0,o(358167).v)({blockId:null==u?void 0:u.id,propertyId:p}),b=S&&(null==S?void 0:S.length)>0||h,g=(0,l().IS)((()=>({personTokenStyle:{...s.token,...b?{marginLeft:3,marginRight:3,maxWidth:"fit-content",display:"inline-block"}:{}},wrapperStyle:{...s.tokensContainer,...b?{...(0,o(191772).sQ)(f),paddingTop:9,paddingBottom:0,lineHeight:2,...y?{display:"flex"}:{flexWrap:"wrap",display:"inline"}}:{}}})),[b,y,s.tokensContainer,s.token,f]),x=(0,o(171722).s)({propertyId:p,store:u});return(0,k.jsxs)(o(167677).h,{className:x,style:g.wrapperStyle,children:[m.map(((e,n)=>{if((0,a().Pu)(e))return(0,k.jsx)(o(370618).A,{actorPointer:e,style:{...n<t.length-1&&s.actorTokenOverlap,...g.personTokenStyle,...y&&{width:"100%",flexShrink:1}}},e.id);if((0,o(919709).MMZ)(e))return(0,k.jsx)(o(422464).W,{templateVariableType:e},`person-property-value-${e}`);if((0,c().GL)(e)){if(!u)return null;const t=(0,c().bj)({spacePermissionGroupId:e.id,spaceId:e.spaceId});return(0,k.jsx)(o(27356).UISpacePermissionGroupToken,{parentStore:u,groupPointer:t,format:r,isSingle:!1},t.id)}(0,d().ub)(e)})),n&&t.length>n&&(0,k.jsx)(o(317958).A,{count:t.length-n,format:r,style:s.moreToken,fixedHeight:!0,isCompact:!0})]})}function R(e){let{property:t,store:n,propertySchema:r,format:l}=e;return(0,i().K8)((()=>{const e=null==r?void 0:r.type;switch(e){case"created_by":{const e=n.getCreatedByPointer();if(e)return[e];break}case"last_edited_by":{const e=n.getLastEditedByPointer();if(e)return[e];break}case"person":{const e=n.isTemplate();return(0,o(713998).as)({value:n.getPropertyValue(t),isTemplatePage:e,propertySchema:r,blockCreatorPointer:e||(0,o(458366).NN)(l)?void 0:n.getCreatedByPointer()})}case void 0:return[];default:(0,d().HB)(e)}return[]}),[t,r,n,l])}const M=n.forwardRef((function(e,t){const{shouldWrap:i}=(0,n.useContext)(g().L8),l=(0,o(963589).X)("db_ux_chrome"),a=(0,r().WS)(),s=(0,n.useMemo)((()=>(0,k.jsx)(b().k,{},"comment")),[]),c=O(e,t);return(0,k.jsx)(I,{...c,EmptyComponent:v().rW,collectionStore:e.collectionStore,quickActionButtons:s,userExpandable:i,tokenFontSize:l&&a?o(828180).hN:void 0})})),_=n.forwardRef((function(e,t){const o=O(e,t),r=(0,n.useMemo)((()=>(0,k.jsx)(b().k,{},"comment")),[]);return(0,k.jsx)(I,{...o,EmptyComponent:v().ao,collectionStore:e.collectionStore,quickActionButtons:r})})),T=n.forwardRef((function(e,t){var o;const l=O(e,t),s=(0,r().v3)(),{propertySchema:c}=(0,n.useContext)(g().L8),d=c,u=R({store:e.store,property:e.property,propertySchema:d,format:e.format}),p=(0,i().K8)((()=>{var t;const o=null===(t=e.store)||void 0===t?void 0:t.getRecordModel;return o?u.flatMap((e=>{if(!(0,a().Pu)(e))return[];const t=(0,a().xC)({pointer:e,getRecordModel:o});return t&&t.asActor?[h().sk.createUniqueRootStore(s,t.pointer)]:[]})):[]}),[s,u,null===(o=e.store)||void 0===o?void 0:o.getRecordModel]),y=(0,n.useMemo)((()=>(0,k.jsx)(b().k,{},"comment")),[]);return(0,k.jsx)(P,{actors:p,renderOrigin:e=>(0,k.jsx)("div",{...e,children:(0,k.jsx)(I,{...l,EmptyComponent:v().ao,tokenLimit:1,quickActionButtons:y,limitTokensToSingleTruncatedLine:!0})})})})),B=n.forwardRef((function(e,t){const o=O(e,t);return(0,k.jsx)(I,{...o,EmptyComponent:v().Fe,tokenLimit:1})})),A=n.forwardRef((function(e,t){const{store:r,property:i}=O(e,t),{propertySchema:l,propertyModule:a,format:s}=(0,n.useContext)(g().L8),c=l,d=R({store:r,property:i,propertySchema:c,format:s});return a&&(0,o(778781).E2)(a)?(0,k.jsx)(o(3079).H,{ref:t,store:r,property:i,children:(0,k.jsx)(y,{store:r,property:i,propertyValues:d,propertySchema:c,module:a,format:e.format})}):(S({from:"PropertyModulePersonProperty",type:"invalidModule",throttleSeconds:60,error:new Error("Expected to find a property_person module."),data:{blockId:r.id,propertyId:i,miscDataToConvertToString:{moduleType:null==a?void 0:a.type}}}),null)})),E=n.forwardRef((function(e,t){const n=O(e,t,(0,o(512321).F)(t,e.collectionStore,e.property,"person"));return(0,k.jsx)(I,{...n,EmptyComponent:e.showIfEmpty?v().Jb:void 0})})),L=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=O(e,t);return(0,k.jsx)(I,{...n,EmptyComponent:o?v().Jb:void 0})})),W=n.forwardRef((function(e,t){const o=O(e,t);return(0,k.jsx)(I,{...o})})),F=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=O(e,t);return(0,k.jsx)(I,{...n,EmptyComponent:o?v().Jb:void 0})})),V=n.forwardRef((function(e,t){const o=O(e,t);return(0,k.jsx)(I,{...o})})),K=n.forwardRef((function(e,t){const o=O(e,t);return(0,k.jsx)(I,{...o})})),z=n.forwardRef((function(e,t){const o=O(e,t);return(0,k.jsx)(I,{...o})}));function O(e,t,o){const{store:n,property:r,onContextMenu:i,width:l}=e;return{ref:t,store:n,property:r,editButtonClickProps:(0,x().QK)(e),onContextMenu:i,buttonStyle:null==o?void 0:o.buttonStyle,width:l}}},146962:(e,t,o)=>{o.d(t,{k:()=>S});o(898992),o(354520),o(908872);var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=o(474848);const a={viewBox:"0 0 16 16",fittedViewBox:"2.12 2.57 11.75 11.7",svg:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{d:"M5.2 5.425a.575.575 0 0 0 0 1.15h5.6a.575.575 0 1 0 0-1.15zm0 2.4a.575.575 0 1 0 0 1.15h4a.575.575 0 1 0 0-1.15z"}),(0,l.jsx)("path",{d:"M4 2.575c-1.036 0-1.875.84-1.875 1.875v5.5c0 1.036.84 1.875 1.875 1.875h.466v1.822a.625.625 0 0 0 1.019.485l2.84-2.307H12c1.036 0 1.875-.84 1.875-1.875v-5.5c0-1.035-.84-1.875-1.875-1.875zM3.375 4.45c0-.345.28-.625.625-.625h8c.345 0 .625.28.625.625v5.5c0 .345-.28.625-.625.625H8.102a.63.63 0 0 0-.394.14l-1.992 1.619V11.2a.625.625 0 0 0-.625-.625H4a.625.625 0 0 1-.625-.625z"})]})},s=(0,o(340498).wt)("commentFilledSmall",a);var c=()=>o(959013),d=()=>o(534177),u=()=>o(112873),p=()=>o(116008),y=()=>o(285790),m=()=>o(234359);const f=(0,c().YK)({comment_on_property:{defaultMessage:"Comment",id:"database.CommentButton.commentOnPropertyValue"},open_discussion:{defaultMessage:"Open discussion",id:"database.CommentButton.openDiscussion"}}),S=n.memo((function(e){const{style:t,showShadow:a}=e,S=(0,c().tz)(),h=(0,r().v3)(),{isMobile:b}=(0,r().Y0)(),{isEmptyStore:g,propertySchema:x,format:v,collectionContextStore:C,property:k,store:w,disabled:P}=(0,n.useContext)(m().L8),I=(0,i().O$)(g),j=(0,i().K8)((()=>null==C?void 0:C.collectionStore()),[C]),R=(0,m().O2)({store:w,collectionStore:j,property:k,disabled:P,format:v,propertySchema:x,collectionContextStore:C,writeStateType:"comment"}),M=(0,i().K8)((()=>o(372154).A.state.open),[]),_=(0,i().K8)((()=>{if(!k||!w)return 0;return(0,o(299545).O3)(w,{recursivelyLoadAllDiscussions:!1,includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===k&&(0,o(852353).q7)(e,S,w,k))).reduce(((e,t)=>{const o=t.getModel();return o?{comments:e.comments+(o.getComments()||[]).length}:e}),{comments:0}).comments}),[S,k,w]),T=_>99?"99+":`${_}`,B=(0,i().K8)((()=>{var e;return(0,d().O9)(w)&&p().A.state.open&&p().A.isPropertyComment()&&(null===(e=p().A.state)||void 0===e?void 0:e.blockId)===w.id&&p().A.getPropertyId()===k}),[k,w]),A=(0,i().K8)((()=>{if(!j)return!1;const e="compact_page"===v,t=j.canEditCollection();return!e||!t}),[j,v]),E=(0,n.useMemo)((()=>!(_<=0)&&function(e){switch(e){case"table":case"board":case"calendar":case"list":case"feed":case"gallery":case"timeline":case"mini":case"form_editor":case"form_viewer":return!1;case"property_module":case"page":case"compact_page":case"relation":case"relation_section":return!0;default:(0,d().HB)(e)}}(v)),[_,v]),L=(0,n.useMemo)((()=>_>0?S.formatMessage(f.open_discussion):S.formatMessage(f.comment_on_property)),[S,_]),W=(0,n.useCallback)((async()=>{k&&w&&(M?u().xl():w.isNavigableAncestorNonCommentableState()||(_>0?await u().B4({environment:h,blockStore:w,shouldFocusDiscussion:!0,analyticsFrom:"db_quick_action",recursivelyLoadAllDiscussions:!1,property_id:k,openFullPropertyDiscussionOnly:!0,intl:S}):B?o(555776).A.setActiveWithSource("popover_comments"):await(0,o(730307).l)({environment:h,blockStore:w,rect:o(57618).A.getRect(w,k),property_id:k})))}),[k,w,M,_,h,S,B]),F=(0,o(401497).IS)((e=>({icon:{width:16,height:16,color:e.text.secondary,fill:e.text.secondary},caption:{marginLeft:2,color:e.text.secondary},button:{...t,position:"relative",display:"flex"},iconButton:{minWidth:24,height:20,borderRadius:4,paddingLeft:3,paddingRight:3}})),[t]),V=(0,n.useCallback)((e=>(0,l.jsxs)("div",{...e,style:F.button,children:[_>0?(0,l.jsx)(y().A,{ariaLabel:L,hasBackground:!0,icon:s,caption:(0,l.jsx)("span",{children:T}),showShadow:a,iconStyle:F.icon,captionStyle:F.caption,style:F.iconButton,onClick:W},`icon-btn-${_}`):(0,l.jsx)(y().A,{ariaLabel:L,hasBackground:!0,icon:s,showShadow:a,iconStyle:F.icon,style:F.iconButton,onClick:W},`icon-btn-${_}`),B&&(0,l.jsx)(o(359848).h,{onlyShowDraftDot:!0,customTop:2,customLeft:15})]})),[T,B,_,W,a,F.button,F.caption,F.icon,F.iconButton,L]),K=(0,n.useCallback)((()=>L),[L]);return!x||I||!A||E||b||!R||(0,o(970013).F_)(x.type)?null:(0,l.jsx)(o(859428).A,{renderTooltip:K,render:V})}))},163194:(e,t,o)=>{o.d(t,{A:()=>r});o(898992),o(672577);class n extends(()=>o(959180))().A{findRow(e,t,o){return this.find((n=>n.relatedPageStoreId===e&&n.rowType===t&&n.property===o))}}const r=new n},164124:(e,t,o)=>{o.d(t,{W:()=>u});o(296540);var n=()=>o(56366),r=()=>o(401497),i=()=>o(970013),l=()=>o(807831),a=()=>o(284371),s=()=>o(519839),c=()=>o(405417),d=o(474848);function u(e){let{blockStore:t,collectionContextStore:o,wrapperStyle:u}=e;const p=(0,n().O$)(o.currentSubitemFormatStoreForCollectionStore),y=(0,n().K8)((()=>(0,s().Dj)({store:t,collectionContextStore:o})),[o,t]),m=(0,n().K8)((()=>{if(!p||!y)return;const e=y.getSchema()[p.property];return void 0!==e&&(0,i().nC)(e)?e:void 0}),[y,p]),f=(0,r().IS)((e=>({subItemIcon:{color:e.icon.secondary,width:14,height:14,marginRight:2},wrapper:{display:"inline-flex",alignItems:"center",verticalAlign:" text-top",paddingRight:8,...u},numSubitemsSpan:{fontSize:a().J.UISmall.desktop,fontWeight:a().Wy.medium,color:e.text.tertiary}})),[u]),S=(0,n().K8)((()=>p&&m?(0,c().rt)({store:t,subitemFormat:p,propertySchema:m}):[]),[t,p,m]);return(0,n().K8)((()=>(0,c().Kk)({collectionContextStore:o,blockStore:t})),[o,t])&&0!==S.length?(0,d.jsxs)("span",{style:f.wrapper,children:[(0,l().V)(f.subItemIcon),(0,d.jsx)("span",{style:f.numSubitemsSpan,children:S.length})]}):null}},171722:(e,t,o)=>{o.d(t,{s:()=>l,y:()=>a});o(898992),o(354520),o(581454);var n=()=>o(56366),r=()=>o(955825),i=()=>o(299545);function l(e){let{store:t,propertyId:o}=e;const l=(0,n().K8)((()=>{var e;return t&&o?null===(e=(0,i().O3)(t,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===o)))||void 0===e||null===(e=e[0])||void 0===e?void 0:e.id:void 0}),[t,o]);return l?(0,r().wV)({discussionId:l}):void 0}function a(e){let{store:t,propertyId:o}=e;const l=(0,n().K8)((()=>t&&o?(0,i().O3)(t,{includePropertyDiscussions:!0}).filter((e=>e.getPropertyId()===o)).map((e=>e.id)):void 0),[t,o]);return l?l.map((e=>(0,r().wV)({discussionId:e}))):void 0}},173783:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(401497),r=()=>o(658985),i=o(474848);function l(e){const t=function(e){const{size:t,style:o}=e;return(0,n().IS)((e=>({icon:{width:.6*t,height:.6*t,fill:e.text.secondary},iconContainer:{width:t,height:t,borderRadius:"100%",background:e.regularDividerColor,display:"flex",alignItems:"center",justifyContent:"center",...o}})),[t,o])}(e),o=(0,r().$)(t.icon);return(0,i.jsx)("div",{style:t.iconContainer,children:o})}},175120:(e,t,o)=>{o.d(t,{m:()=>u});var n=o(296540),r=()=>o(56366),i=()=>o(401497),l=()=>o(919709),a=()=>o(116008),s=()=>o(921855),c=()=>o(735372),d=o(474848);const u=n.memo((function(e){const{parentStore:t,withComma:u,linkifyUrls:p,disableCommentHighlight:y,disableLinks:m,shouldTruncate:f,clampLines:S}=e,{textValue:h}=e,b=(0,o(484714).v3)(),g=(0,i().DP)(),x=(0,o(712030).Ol)();(0,n.useEffect)((()=>{void 0!==h&&b.KatexStore.loadIfNeeded((()=>h))}),[b.KatexStore,h]);const{collectionContextStore:v,property:C}=(0,n.useContext)(o(234359).L8),{collectionViewBlockId:k,collectionViewId:w}=(0,r().K8)((()=>{var e,t;return{collectionViewId:null==v||null===(e=v.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==v||null===(t=v.collectionViewBlockStore())||void 0===t?void 0:t.id}}),[v]),P=(0,r().K8)((()=>b.KatexStore.getKatex()),[b.KatexStore]),I=(0,r().K8)((()=>{const e=c().qu.state,o=c().wb.state;if(!e||!C||!h)return h;return s().nu({textValue:h,blockId:t.id,textProps:{type:"page_property_value_match",collectionViewBlockId:k,collectionViewId:w,propertyId:C},find:e,currentFocusedResult:o})}),[C,h,t.id,k,w]),j=(0,r().K8)((()=>{if(a().A.getPropertyId()!==C||a().A.getBlockStore()!==t)return I;const e=a().A.getMultiSelection();return e?l().Mwp({textValue:I,selection:{startIndex:e.start.index,endIndex:e.end.index},annotation:[l().Ifu.TemporaryComment]}):h?l().Mwp({textValue:I,selection:{startIndex:0,endIndex:l().qAZ(h).length},annotation:[l().Ifu.TemporaryComment]}):I}),[t,C,h,I]),R=(0,r().K8)((()=>void 0===j?null:s().S5({environment:b,textValue:j&&{value:j,spaceId:(0,o(161479).e)(t.pointer.spaceId)},parentStore:t,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableCommentAnnotations:y??!1,disabled:!0,theme:g,disableLinks:m??!1,emojiType:x,katex:P,formulaValueTypes:[],stopLinkPropagation:!0,linkTargetBlank:!0})),[j,b,t,y,g,m,x,P]),M=(0,n.useMemo)((()=>{if(!p||void 0===h)return null;const e=(0,l().k4p)(h);return(0,o(735577).A)(e)?(0,o(713998).MO)(h):null}),[p,h]),_=(0,i().IS)((e=>({text:{...f&&!S?o(284371).RC:void 0,...f&&S?{...(0,o(115512).pA)(S),overflow:"hidden",textOverflow:"ellipsis"}:{}}})),[f,S]);return(0,d.jsxs)("span",{style:_.text,children:[M?(0,d.jsx)(o(187485).A,{href:M,style:{display:"inline",pointerEvents:"auto",...(0,o(458366).w_)(g)},external:!0,onClick:e=>e.stopPropagation(),children:R}):R,u?", ":null]})}))},175882:(e,t,o)=>{o.r(t),o.d(t,{exclamationMarkTriangleSmallIcon:()=>i,iconDefinition:()=>r});o(296540);var n=o(474848);const r={viewBox:"0 0 16 16",fittedViewBox:"1.49 1.87 13.01 11.75",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M7.9 5.281a.625.625 0 0 0-.625.625v2.5a.625.625 0 0 0 1.25 0v-2.5a.625.625 0 0 0-.625-.625m0 4.7a.725.725 0 1 0 0 1.45.725.725 0 0 0 0-1.45"}),(0,n.jsx)("path",{d:"M9.58 2.788c-.702-1.217-2.458-1.217-3.16 0l-4.677 8.1c-.702 1.216.176 2.737 1.58 2.737h9.354c1.405 0 2.283-1.52 1.58-2.738zm-2.078.625a.575.575 0 0 1 .996 0l4.677 8.1a.575.575 0 0 1-.498.862H3.324a.575.575 0 0 1-.498-.863z"})]})},i=(0,o(340498).wt)("exclamationMarkTriangleSmall",r)},229793:(e,t,o)=>{o.d(t,{Vt:()=>l,wC:()=>i});var n=()=>o(645873);const r={CollectionMapView:new(n().O2)("CollectionMapView",(async()=>await Promise.all([o.e(53066),o.e(87421),o.e(92845),o.e(84468),o.e(75078),o.e(95168),o.e(36908),o.e(91194),o.e(67608),o.e(51680)]).then(o.bind(o,270058)))),MapTile:new(n().O2)("MapTile",(async()=>await Promise.all([o.e(87421),o.e(80983)]).then(o.bind(o,123133))))},i=(0,n()._h)(r.CollectionMapView,(e=>e.CollectionMapView)),l=(0,n()._h)(r.MapTile,(e=>e.MapTile))},279620:(e,t,o)=>{o.d(t,{Y:()=>l});var n=o(296540),r=()=>o(16006),i=o(474848);function l(e){const{blockStore:t,shouldWrap:o,titleStyle:l,recordTitleRef:a,noUnderline:s,disableTooltip:c}=e,d=(0,n.useRef)({getNode:()=>a.current});return(0,i.jsx)(r().A,{store:t,underline:!s,shouldWrap:o,style:l,ref:d,enableHover:!0,showTooltipWhenTruncated:!0,disableTooltip:c})}},317958:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(784892),r=()=>o(959013),i=o(474848);const l={[n().NY.ExtremeSmall]:{height:12,fontSize:8,margin:"0 4px 0 0"},[n().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 4px 0 0"},[n().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0"},[n().NY.CompactEssential]:{height:21,fontSize:14,margin:"0 12px 6px 0"},[n().NY.Medium]:{height:21,fontSize:14,margin:"0 12px 6px 0"},[n().NY.Inline]:{height:21,fontSize:14,margin:"0 12px 0 0"},[n().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0"}};const a=function(e){const{count:t,format:n,fixedHeight:a,style:s,isCompact:c}=e,{margin:d,height:u,fontSize:p}=l[n],y=(0,o(401497).IS)((e=>({wrapper:{display:"flex",alignItems:"center",lineHeight:1.2,borderRadius:4,fontSize:p,margin:d,color:e.text.secondary,...a&&{height:u},...s},compact:{whiteSpace:"nowrap"}})),[p,u,a,d,s]);return(0,i.jsx)("div",{style:y.wrapper,children:c?(0,i.jsx)("span",{style:y.compact,children:(0,i.jsx)(r().sA,{defaultMessage:"+{thinSpace}{moreItemsCount}",id:"database.tokens.moreItems.message",values:{moreItemsCount:t,thinSpace:(0,i.jsx)("span",{children:""})}})}):(0,i.jsx)("span",{children:(0,i.jsx)(r().sA,{defaultMessage:"{relationMoreItemsCount} more",id:"database.relationPropertyValue.moreItems.message",values:{relationMoreItemsCount:t}})})})}},422464:(e,t,o)=>{o.d(t,{W:()=>h,e:()=>S});o(296540);var n=()=>o(401497),r=()=>o(784892),i=()=>o(563884),l=()=>o(91451),a=()=>o(436632),s=()=>o(919709),c=()=>o(959013),d=()=>o(534177),u=()=>o(848401),p=()=>o(88306),y=o(474848);const m="20px",f=(0,c().YK)({me:{id:"templateVariablePropertyValueComponent.templateVariables.text.me",defaultMessage:"Person who duplicated page"},now:a().H.nowText,today:a().H.todayText});function S(e){const t=(0,n().IS)((e=>({textWrapper:{lineHeight:m}})),[]);return(0,y.jsx)(p().C,{fontColor:"light",style:t.textWrapper,children:(0,y.jsx)(h,{templateVariableType:e.templateVariableType})})}function h(e){const{templateVariableType:t,showRemoveButton:o,onRemove:a,style:p}=e,m=(0,c().tz)(),f=(0,n().IS)((e=>({uiToken:{background:e.outlineBlueButtonPressedBackground,color:e.blueColor,padding:"2px 4px",width:"max-content",...p||{}}})),[p]);return(0,y.jsx)(u().Ay,{format:r().NY.Medium,isSingle:!0,title:b(t,m),renderAvatar:()=>function(e){let t;(0,s().pbt)(e)?t=l().z:(0,s().UKc)(e)?t=i().k:(0,d().HB)(e);return t}(t)({width:12,height:12,marginRight:4}),shouldShrink:!0,onClickRemove:a,showRemoveButton:Boolean(o),style:f.uiToken})}function b(e,t){let o;return"me"===e?o=t.formatMessage(f.me):"now"===e?o=t.formatMessage(f.now):"today"===e?o=t.formatMessage(f.today):(0,d().HB)(e),o}},454155:(e,t,o)=>{o.d(t,{Dd:()=>R,Dl:()=>v,ER:()=>I,I8:()=>b,S1:()=>g,V6:()=>C,_Z:()=>j,ej:()=>w,h3:()=>x,jd:()=>h,rw:()=>k,xV:()=>P,zg:()=>f});o(581454);var n=o(296540),r=()=>o(401497),i=()=>o(713998),l=()=>o(962730),a=()=>o(117886),s=()=>o(146962),c=()=>o(234359),d=()=>o(414712),u=()=>o(997415),p=()=>o(859118),y=o(474848);const m=[],f=n.memo((0,n.forwardRef)((function(e,t){const{buttonStyle:l,editButtonClickProps:a,property:s,EmptyComponent:d,onContextMenu:u,tokenLimit:p,store:f,quickActionButtons:h,width:b,limitTokensToSingleTruncatedLine:g,userExpandable:x,formQuestionStore:v,collectionSchema:C,generateButtonStyles:k}=e,{propertySchema:w,baseStyles:P,shouldRenderTooltip:I}=(0,n.useContext)(c().L8),j=(0,o(425497).Ug)(v?o(784892).NY.Large:null==P?void 0:P.tokenFormat),R=w,M=(null==R?void 0:R.options)??m,_=null==R?void 0:R.type,T=(0,o(56366).K8)((()=>f.getPropertyValue(s)),[f,s]),[B,A]=(0,n.useMemo)((()=>{let e=[];if("select"===_){const t=i().fF(T,M);e=t?[t]:[]}else e=i().J4(T,M);v&&(e=e.map((e=>({...e,color:"default"}))));return[p?e.slice(0,p):e,p?e.slice(p):[]]}),[_,p,T,M,v]),E=void 0!==v&&B.length>0,L=(0,r().IS)((e=>({buttonStyle:{...P.buttonStyle,...l,...(null==k?void 0:k(e,0===B.length))||{}},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},overflowIndicator:{marginRight:4,color:e.text.secondary},tooltip:{padding:8},remainderPropertiesContainer:{display:"flex",flexWrap:"wrap",fontWeight:"normal",width:"max-content",maxWidth:"240px",gap:4},selectToken:{margin:0},tokenContainer:g?{display:"flex",flexWrap:"nowrap",...o(284371).RC}:{},moreToken:{margin:0,...g?{flexShrink:0}:{}},propertyValuesWrapper:{width:"100%",display:E?"inline-flex":void 0,justifyContent:"space-between",alignItems:"center"},chevronIcon:{width:20,fill:e.text.tertiary,marginRight:-4,flexShrink:0}})),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,l,k,g,B.length,E]);return null!=B&&B.length||void 0!==d?(0,y.jsx)(o(614001).P,{ref:t,editButtonClickProps:a,onContextMenu:u,style:L.buttonStyle,hoveredStyle:L.buttonHoveredStyle,pressedStyle:L.buttonPressedStyle,quickActionButtons:h,width:b,userExpandable:x,formQuestionStore:v,collectionSchema:C,children:null!=B&&B.length||void 0===d?(0,y.jsxs)("div",{style:L.propertyValuesWrapper,children:[(0,y.jsx)(S,{shownOptions:B,hiddenOptions:A,tokenLimit:p,tokenFormat:j,styles:L,store:f,property:s,parentHasTooltip:I}),E?(0,y.jsx)("div",{children:(0,o(56740).U)(L.chevronIcon)}):null]}):(0,y.jsx)(d,{})}):null})));function S(e){let{shownOptions:t,hiddenOptions:n,tokenLimit:i,styles:a,tokenFormat:s,store:c,property:d,parentHasTooltip:p}=e;const m=(0,r().DP)(),f=(0,o(358167).v)({blockId:null==c?void 0:c.id,propertyId:d}),S=(0,o(171722).s)({propertyId:d,store:c}),h=Boolean(S),b=(0,r().IS)((()=>{const e=h||f?{...(0,o(191772).sQ)(m),paddingTop:4,paddingBottom:4,flexWrap:"wrap",lineHeight:2,display:"inline"}:{},t=h||f?{marginLeft:3,marginRight:3,maxWidth:"fit-content",display:"inline-flex"}:{};return{tokenContainer:{...e,...a.tokenContainer},selectTokenHighlightStyle:t}}),[f,a.tokenContainer,m,h]);return(0,y.jsxs)(o(167677).h,{style:b.tokenContainer,className:S,children:[t.map((e=>(0,y.jsx)(u().X,{type:"select",value:e.value,description:e.description,color:e.color,shouldShrink:Boolean(i),style:b.selectTokenHighlightStyle,shouldShowTooltip:!p,tokenFormat:s},e.id))),n.length>0&&(0,y.jsx)(o(859428).A,{style:a.tooltip,renderTooltip:()=>(0,y.jsx)("div",{style:a.remainderPropertiesContainer,children:n.map((e=>(0,y.jsx)(u().X,{type:"select",value:e.value,color:e.color,shouldShrink:!1},e.id)))}),isLightBackground:!0,textWrap:!0,alignment:l().C.Center,placement:l().W.Bottom,render:e=>(0,y.jsx)("div",{...e,children:(0,y.jsx)(o(317958).A,{count:n.length,format:s,fixedHeight:!1,style:a.moreToken,isCompact:!0})})})]})}const h=(0,n.forwardRef)((function(e,t){const{store:o,property:r}=e,{shouldWrap:i}=(0,n.useContext)(c().L8),l=(0,n.useMemo)((()=>(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(a().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,y.jsx)(s().k,{},"comment")]})),[r,o]),d=R(e,t);return(0,y.jsx)(f,{...d,EmptyComponent:p().rW,quickActionButtons:l,userExpandable:i})})),b=(0,n.forwardRef)((function(e,t){const o=R(e,t),{store:r,property:i}=e,l=(0,n.useMemo)((()=>(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(a().A,{store:r,property:i,openOverlay:!0},"autofill"),(0,y.jsx)(s().k,{},"comment")]})),[i,r]);return(0,y.jsx)(f,{...o,EmptyComponent:p().ao,quickActionButtons:l})})),g=(0,n.forwardRef)((function(e,t){const o=R(e,t),{store:r,property:i}=e,l=(0,n.useMemo)((()=>(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(a().A,{store:r,property:i,openOverlay:!0},"autofill"),(0,y.jsx)(s().k,{},"comment")]})),[i,r]);return(0,y.jsx)(f,{...o,EmptyComponent:p().ao,tokenLimit:1,quickActionButtons:l,limitTokensToSingleTruncatedLine:!0})})),x=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=R(e,t,(0,o(512321).F)(t,e.collectionStore,e.property,"multi_select"));return(0,y.jsx)(f,{...r,EmptyComponent:n?p().Jb:void 0})})),v=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=R(e,t);return(0,y.jsx)(f,{...n,EmptyComponent:o?p().Jb:void 0})})),C=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,y.jsx)(f,{...o})})),k=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=R(e,t);return(0,y.jsx)(f,{...n,EmptyComponent:o?p().Jb:void 0})})),w=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,y.jsx)(f,{...o})})),P=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,y.jsx)(f,{...o})})),I=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,y.jsx)(f,{...o})})),j=(0,n.forwardRef)((function(e,t){const o=R(e,t);return(0,y.jsx)(f,{...o,EmptyComponent:p().Fe,tokenLimit:1})}));function R(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,d().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}},477660:(e,t,o)=>{function n(e){switch(null==e?void 0:e.type){case"url":case"email":case"phone_number":return e;default:return}}o.d(t,{z:()=>n})},512321:(e,t,o)=>{o.d(t,{F:()=>d,X:()=>s});o(898992),o(354520),o(581454);var n=o(296540),r=()=>o(56366),i=()=>o(401497),l=()=>o(761408),a=()=>o(234359);const s=120,c={title:[s,600],text:[100,300],number:[100,150],select:[100,150],multi_select:[100,200],date:[100,150],person:[100,150],file:[100,150],checkbox:[40,100],phone_number:[100,150],formula:[100,150],relation:[100,150],rollup:[100,150],created_time:[100,150],created_by:[100,150],last_edited_time:[100,150],last_edited_by:[100,150],last_visited_time:[100,150],button:[100,150],status:[100,150],auto_increment_id:[100,150],location:[100,150],verification:[100,150],place:[100,150]};function d(e,t,o,d){const[u,p]=c[d],{collectionContextStore:y}=(0,n.useContext)(a().L8),{isBeforeTitle:m,propertyIndex:f,titleIndex:S,visibleProperties:h}=(0,r().K8)((()=>{var e,n;if(!t)return{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]};const r=((null===(n=((null==y||null===(e=y.collectionViewStore())||void 0===e?void 0:e.getFormat())??{}).list_properties)||void 0===n?void 0:n.filter((e=>e.visible)))??[]).map((e=>(0,l().L)({collectionStore:t,collectionContextStore:y,property:e.property})));if(void 0===r)return{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]};const i=r.findIndex((e=>"title"===e)),a=r.findIndex((e=>e===o));return-1===i||-1===a?{isBeforeTitle:!1,propertyIndex:-1,titleIndex:-1,visibleProperties:[]}:{isBeforeTitle:a<i,propertyIndex:a,titleIndex:i,visibleProperties:r}}),[y,t,o]),[b,g]=(0,n.useState)(null);return(0,n.useEffect)((()=>{if(!e||!("current"in e)||!e.current)return;const t=e.current,o=new ResizeObserver((e=>{var t;const o=null===(t=e[0])||void 0===t?void 0:t.contentRect.width;o&&g(o)}));return o.observe(t),()=>{o.disconnect()}}),[e]),(0,i().IS)((()=>{if(void 0===o||void 0===d)return{};const e={};0===f?e.marginLeft=0:f===h.length-1&&(e.marginRight=0);const t=Math.floor(100/h.length),n=S;return f!==S&&m&&n>0?e.maxWidth=`calc((100% - ${s}px) / ${n})`:(null!==b&&b>=u&&(e.minWidth=u),e.maxWidth=`max(${p}px, ${t}%)`),"rollup"===d?{textButtonStyle:e,buttonButtonStyle:e}:{buttonStyle:e}}),[o,d,f,h.length,S,m,b,u,p])}},548218:(e,t,o)=>{o.d(t,{E:()=>K,V:()=>H});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(672577);var n=()=>o(908006),r=()=>o(716016),i=()=>o(787626),l=()=>o(970013),a=()=>o(713998),s=()=>o(597777),c=()=>o(869190),d=()=>o(604995),u=()=>o(977345),p=()=>o(416504),y=()=>o(72135),m=()=>o(919709),f=()=>o(191772),S=()=>o(496603),h=()=>o(534177),b=()=>o(720665),g=()=>o(319975),x=()=>o(679924),v=()=>o(634224),C=()=>o(897119),k=()=>o(780054),w=()=>o(267419),P=()=>o(862292),I=()=>o(458366),j=()=>o(921855),R=()=>o(476492),M=()=>o(909470),_=()=>o(761408),T=()=>o(972435),B=()=>o(217429),A=()=>o(843141),E=()=>o(299709),L=()=>o(522986),W=()=>o(884107),F=()=>o(620689),V=()=>o(751156);async function K(e){const{environment:t,theme:o,store:n,schema:l,property:c,collectionContextStore:y}=e,S=t.device,g=l[c],x=await W().R.clipboardActions.load();if(g){switch(g.type){case"formula":{const e=await P().T.formulas.load();"v2"===g.version?function(e){const{clipboardActions:t,environment:o,store:n,propertySchema:r,property:i,formulasModule:l}=e,a=n.getModel();if(!r.formula2||!a)return;const s=T().A.getIntl(),c=(0,p().P)(),d=l.evaluateCollectionFormula2({block:a,property:i,formulaCode:r.formula2.code,getRecordModel:n.getRecordModel,intl:s,userTimeZone:c,depth:0,visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,experimentService:B().default,collectionFeatureGates:(0,M().i)()});if(!d)return;const y=(0,u().Ht)(d),m=(0,j().r4)(y,n);t.copyString({stringValue:m,environment:o,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}({clipboardActions:x,environment:t,store:n,propertySchema:g,property:c,formulasModule:e}):function(e){var t;const{clipboardActions:o,environment:n,store:r,schema:i,property:l,propertySchema:a,formulasModule:c}=e,d=r.getValue();if(!d)return;const u=c.evaluateFormulaProperty({property:l,schema:i,block:d,getRecordValue:r.getRecordValue,collectionRequestContext:{userId:void 0,userTimeZone:(0,p().P)(),depth:0,intl:T().A.getIntl(),resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,visitedProperties:new Set,experimentService:B().default,collectionFeatureGates:(0,M().i)()}}),y=null==a||null===(t=a.formula)||void 0===t?void 0:t.result_type;switch(y){case"number":b().Et(u)&&O({clipboardActions:o,value:u,propertySchema:a,environment:n});break;case"date":u&&s().kC(u)&&D({clipboardActions:o,date:u,environment:n});break;case"text":u&&o.copyString({stringValue:u.toString(),environment:n,copiedMessage:o.clipboardMessages.copiedPropertyToClipboard});break;case"checkbox":case void 0:return;default:(0,h().HB)(y)}}({clipboardActions:x,environment:t,store:n,schema:l,property:c,propertySchema:g,formulasModule:e});break}case"person":{const e=n.getPropertyValue(c);z({actors:a().Y6({textValue:e,propertySchema:g,blockCreatorPointer:n.getCreatedByPointer()}),clipboardActions:x,environment:t,store:n});break}case"created_by":{const e=n.getCreatedByPointer();e&&z({actors:[e],clipboardActions:x,environment:t,store:n});break}case"last_edited_by":{const e=n.getLastEditedByPointer();e&&z({actors:[e],clipboardActions:x,environment:t,store:n});break}case"number":O({clipboardActions:x,environment:t,propertySchema:g,value:a().Me(n.getPropertyValue(c))});break;case"text":{const e=n.getPropertyValue(c);if(!e)return;const r=(0,f().$e)({textValue:{value:e,spaceId:n.getSpaceId()},getRecordModel:n.getRecordModel,getRecordRole:n.getRecordRole,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!0,disableSuggestionAnnotations:!1,disableLinks:!1,disabled:!1,userTimeZone:(0,p().P)(),isClient:!0,isAndroid:S.isAndroid,isSafariOrIOS:S.isSafari||S.isIOS,isWindows:S.isWindows,showEmojiInline:S.isWindows,emojiType:"raw",theme:o,baseUrl:k().A.domainBaseUrl,publicDomainName:k().A.publicDomainName,currentUserId:t.currentUser.id,intl:T().A.getIntl(),katex:void 0,getPublicBaseUrlForPage:void 0,externalIntegrations:[],formulaValueTypes:[],emojiData:w().A.state,isMobileNative:S.isMobileNative,isMobileNativeExternalLinkFixEnabled:B().default.checkGate({gateName:"mobile_native_external_link_fix"})}),i=(0,j().r4)(n.getPropertyValue(c),n);x.copyHtml({stringValue:i,htmlValue:r,environment:t,copiedMessage:x.clipboardMessages.copiedPropertyToClipboard});break}case"url":case"email":case"phone_number":{const e=m().k4p(n.getPropertyValue(c));x.copyString({stringValue:e,environment:t,copiedMessage:x.clipboardMessages.copiedPropertyToClipboard});break}case"date":{const e=n.getPropertyValue(c),o=(0,i().b)(e);o&&D({clipboardActions:x,date:o,environment:t,dateFormat:g.date_format,timeFormat:g.time_format});break}case"last_edited_time":case"created_time":{const e=n.getKeyStore(g.type).getValue();if(e){D({clipboardActions:x,date:d().KQ(e,(0,p().P)()),environment:t,dateFormat:g.date_format,timeFormat:g.time_format})}break}case"auto_increment_id":{const e=n.getPropertyValue(c);!function(e){const{clipboardActions:t,value:o,environment:n,collectionContextStore:i}=e;if(o&&i){var l;const e=(null===(l=i.collectionStore())||void 0===l||null===(l=l.getRecordKeyStore())||void 0===l?void 0:l.getRecordKey())??"";t.copyString({stringValue:(0,r().H4)(e,o),environment:n,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}}({clipboardActions:x,value:a().On(e),environment:t,collectionContextStore:y});break}}(0,A().E)(t,y,{block_id:n.id,property:c,property_type:g.type})}}function z(e){const{actors:t,clipboardActions:o,environment:n,store:r}=e,i=a().AH(t);o.copyString({stringValue:(0,j().r4)(i,r),environment:n,copiedMessage:o.clipboardMessages.copiedPropertyToClipboard})}function O(e){const{clipboardActions:t,value:o,propertySchema:n,environment:r}=e;if(!S().yr(o)&&!b().pN(o)){const e=(null==n?void 0:n.number_format)||y().C4,i=y().ZV(o,e,T().A.getIntl());t.copyString({stringValue:i,environment:r,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}}function D(e){const{clipboardActions:t,date:o,environment:n,dateFormat:r,timeFormat:i}=e,l=(0,c().ZF)({value:o,date_format:r??s().vz,time_format:i??s().CE,allowRelativeDates:!0,intl:T().A.getIntl()});t.copyString({stringValue:l,environment:n,copiedMessage:t.clipboardMessages.copiedPropertyToClipboard})}async function H(e){const{element:t,rect:o,environment:r,onClick:i,store:s,additionalStores:c=[],property:d,format:u,collectionStore:p,blockPropertyValueOverlayStore:y,disableHorizontalEdgeScroll:m,collectionContextStore:f,collectionSchema:S,mouseStore:h,setMouseEntered:b,statusSetCheckbox:k,preventClearSelection:w,collectionsBulkActionsToolbarStore:P,scrollerContext:j,sizing:M,formQuestionStore:B,onClose:A,isDBUXMobileEnabled:W}=e,{device:K,WindowSizeStore:z}=r,O=f&&I().br({store:s,additionalStores:c,collectionContextStore:f});let D=p.getSchema();O&&(D=f.normalizedSchemaStore.state),S&&(D=S);const H=(0,_().L)({collectionStore:p,collectionContextStore:f,property:d}),N=D[H],U=null==N?void 0:N.type;if(!U)return;if(I().F1({property:d,collectionStore:p}))return;const q=s.getPropertyStore(H);if("checkbox"===U)q&&V().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:r,canUndo:!0,perform:e=>{L().qS({stores:[s,...c],property:H,transaction:e})}}),f&&(0,E().E)({environment:r,collectionContextStore:f,block_id:q.id,property:H,property_type:U,from:I().zP(u),isFromBulkActionsToolbar:Boolean(P)});else if("status"===U&&"status"===N.type&&k){const e=s.getPropertyValue(H),t=a().MC(e,N,T().A.getIntl());q&&V().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:r,canUndo:!0,perform:e=>{const o=N.groups??[],n=!0===t?o[0]:o[o.length-1],i=(N.options??[]).find((e=>{var t;return e.id===(null==n||null===(t=n.optionIds)||void 0===t?void 0:t[0])}));if(i)for(const t of[s,...c])g().R9({environment:r,store:t.getPropertyStore(H),value:a().wb(i.value),transaction:e})}})}else{if(-1===l().dA.indexOf(U)){null==b||b(!1),h&&h.setState({...h.state,mouseEntered:!1});const e=W?v().w1:v().Hp;if(t&&j&&K.isMobileNative&&e[U]===C().nl.Popup&&(F().hT({element:t,environment:r,scrollerContext:j,vertical:{reveal:"bottom",paddingToTopEdge:4,paddingToBottomEdge:z.getSafePaddingBottomPx(320)},horizontal:{reveal:"closest"}}),await n().default.afterNextFlush()),L().ho({environment:r,blockPropertyValueOverlayStore:y,store:s,additionalStores:c,property:H,format:u,rect:o,disableHorizontalEdgeScroll:m,collectionContextStore:f,collectionSchema:S,preventClearSelection:w,collectionsBulkActionsToolbarStore:P,sizing:M,formQuestionStore:B,onClose:A}),f){const e=(0,R().sl)(f)||{};(0,x().v)(r,"collection_open_block_property_overlay",{property:H,property_type:U,property_context:void 0,from:I().zP(u),isFromBulkActionsToolbar:Boolean(P),...e})}}}i&&i()}},563015:(e,t,o)=>{o.d(t,{eJ:()=>f,ew:()=>m,ml:()=>d,rA:()=>p,yI:()=>y,zf:()=>u});o(581454);var n=()=>o(496603),r=()=>o(534177),i=()=>o(708685),l=()=>o(145076),a=()=>o(349835),s=()=>o(977345);function c(e){switch(e){case"checkbox":return"boolean";case"number":return"number";case"text":return"text";case"date":return"date";case"array":return"array";case"block":return"block";case"person":return"person";case"select":return"select";case"function":return"function";case"unknown":return"unknown";case"undefined":return"undefined";default:(0,r().HB)(e)}}function d(e){switch(e.type){case a().M9.InvalidCharacter:return{...l().x0.InvalidCharacter,values:{errorCharacter:e.character}};case a().M9.UnclosedStringLiteral:return l().x0.UnclosedStringLiteral;case a().M9.UnclosedComment:return l().x0.UnclosedComment;case a().M9.TokenExpected:return{...l().x0.TokenExpected,values:{expectedToken:e.token}};case a().M9.StringLiteralContainsToken:return l().x0.StringLiteralContainsToken;case a().M9.ExpressionExpected:return l().x0.ExpressionExpected;case a().M9.PropertyTokenOrFunctionExpected:return l().x0.PropertyTokenOrFunctionExpected;case a().M9.EndOfInputExpected:return l().x0.EndOfInputExpected;case a().M9.UnexpectedError:return l().x0.UnexpectedError;case a().M9.TooDeeplyNested:return l().x0.TooDeeplyNested;default:(0,r().HB)(e)}}function u(e){switch(e.type){case a().IA.FunctionCallArgumentWrongType:case a().IA.FunctionCallUnexpectedArgument:return e.argument;default:return e.node}}function p(e,t){let o;switch(t.type){case a().IA.ThisRowTypeNotFound:o=l().Xz.ThisRowTypeNotFound;break;case a().IA.ThisRowNotBlockWithCollection:o=l().Xz.ThisRowNotBlockWithCollection;break;case a().IA.MissingPropertyOnThisRow:o={...l().Xz.MissingPropertyOnThisRow,values:{propertyName:t.property}};break;case a().IA.MissingContextVariable:{const e=(0,s().ix)(t.token)?t.token.contextValueId:t.token.valueId;o={...l().Xz.MissingContextVariable,values:{valueId:e}}}break;case a().IA.MissingBlock:o={...l().Xz.MissingBlock,values:{blockId:t.token.blockId}};break;case a().IA.CallingNotFunction:o={...l().Xz.CallingNotFunction,values:{expressionType:c(t.callee.type.type)}};break;case a().IA.FunctionCallTooFewArguments:o={...l().Xz.FunctionCallTooFewArguments,values:{minNumParameters:t.minNumParameters,functionName:t.libraryFunction.name,numArguments:t.numArguments}};break;case a().IA.FunctionCallUnexpectedArgument:o={...l().Xz.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case a().IA.FunctionCallArgumentWrongType:o={...l().Xz.FunctionCallArgumentWrongType,values:{argumentType:c(t.argument.type.type),functionName:t.libraryFunction.name}};break;case a().IA.MemberPropertyMismatchCollection:o={...l().Xz.MemberPropertyMismatchCollection,values:{propertyName:t.token.property}};break;case a().IA.MemberPropertyMissing:o={...l().Xz.MemberPropertyMissing,values:{propertyName:t.property}};break;case a().IA.MemberPropertyTargetNotBlock:o=l().Xz.MemberPropertyTargetNotBlock;break;case a().IA.MemberPropertyTypeInvalid:o={...l().Xz.MemberPropertyTypeInvalid,values:{propertyName:t.propertyName,propertyType:t.propertyType}};break;case a().IA.UndefinedIdentifier:o={...l().Xz.UndefinedIdentifier,values:{identifier:t.node.text}};break;case a().IA.UnifiedFunctionCannotFindFunction:o={...l().Xz.UnifiedFunctionCannotFindFunction,values:{functionName:t.name}};break;case a().IA.UnifiedFunctionNoArguments:o={...l().Xz.UnifiedFunctionNoArguments,values:{functionName:t.libraryFunction.name}};break;case a().IA.UnifiedFunctionTargetWrongType:o={...l().Xz.UnifiedFunctionTargetWrongType,values:{functionName:t.libraryFunction.name,targetType:c(t.expression.type.type)}};break;case a().IA.CannotRelativelyCompareTypes:o={...l().Xz.CannotRelativelyCompareTypes,values:{lhsType:c(t.lhsType.type),rhsType:c(t.rhsType.type)}};break;case a().IA.CannotDoMathOnType:o={...l().Xz.CannotDoMathOnType,values:{lhsType:c(t.lhsType.type),rhsType:c(t.rhsType.type)}};break;case a().IA.UnaryMinusOnNonNumber:o={...l().Xz.UnaryMinusOnNonNumber,values:{type:c(t.expression.type.type)}};break;case a().IA.IdentifierExpected:o=l().Xz.IdentifierExpected;break;case a().IA.FunctionCallExpected:o={...l().Xz.FunctionCallExpected,values:{functionName:t.functionName}};break;case a().IA.RenamedIdentifier:o={...l().Xz.RenamedIdentifier,values:{identifier:t.identifier,renamedTo:t.renamedTo}};break;case a().IA.RemovedFunction:o={...l().Xz.RemovedFunction,values:{functionName:t.functionName,alternative:t.alternative}};break;case a().IA.ContextVariableNotBlockWithCollection:o={...l().Xz.ContextVariableNotBlockWithCollection,values:{valueId:t.token.contextValueId}};break;case a().IA.MissingPropertyOnContextVariable:o={...l().Xz.MissingPropertyOnContextVariable,values:{propertyName:t.property,valueId:t.token.contextValueId}};break;case a().IA.BlockPropertyTypeInvalid:o={...l().Xz.BlockPropertyTypeInvalid,values:{propertyName:t.propertyName}};break;case a().IA.DisallowedReturnType:{const n=t.allowedReturnTypes.map((t=>e.formatMessage((0,i().getHumanReadableType)(t)).toLocaleLowerCase()));o={...l().Xz.DisallowedReturnType,values:{allowedReturnType:e.formatList(n,{style:"long",type:"conjunction"}),allowedReturnTypeCount:t.allowedReturnTypes.length,returnType:e.formatMessage((0,i().getHumanReadableType)(t.returnType)).toLocaleLowerCase()}};break}case a().IA.CrossSpacePropertyNotSupported:o={...l().Xz.CrossSpacePropertyNotSupported};break;default:(0,r().HB)(t)}return{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}}function y(e,t){let o;switch(t.type){case a().uW.MissingThisRow:o=l().X8.MissingThisRow;break;case a().uW.MissingSchemaPropertyOnThisRow:o={...l().X8.MissingSchemaPropertyOnThisRow,values:{propertyName:t.property}};break;case a().uW.ThisRowBlockPropertyMismatchCollection:o=l().X8.ThisRowBlockPropertyMismatchCollection;break;case a().uW.MissingContextVariable:o={...l().X8.MissingContextVariable,values:{valueId:t.valueId}};break;case a().uW.IdentifierNotFound:o={...l().X8.IdentifierNotFound,values:{identifier:t.node.text}};break;case a().uW.CannotRelativelyCompareTypes:o={...l().X8.CannotRelativelyCompareTypes,values:{lhsType:c(t.lhsType),rhsType:c(t.rhsType)}};break;case a().uW.CannotDoMathOnType:o={...l().X8.CannotDoMathOnType,values:{valueType:c(t.valueType)}};break;case a().uW.CannotCallNonFunction:o={...l().X8.CannotCallNonFunction,values:{calleeType:c(t.calleeType)}};break;case a().uW.UnifiedFunctionPropertyNotFound:o={...l().X8.UnifiedFunctionPropertyNotFound,values:{functionName:t.node.name}};break;case a().uW.LibraryFunctionExecutionError:const n=t.error instanceof a().x4?t.error:void 0;o=(null==n?void 0:n.info.type)===a().v3.DateInvalidDurationUnit?{...l().gW.DateInvalidDurationUnit,values:{functionName:t.libraryFunction.name,invalidUnit:n.info.invalidUnit}}:(null==n?void 0:n.info.type)===a().v3.CannotUseToNumberOnList?{...l().gW.CannotUseToNumberOnList}:(null==n?void 0:n.info.type)===a().v3.CannotRoundToNonInteger?{...l().gW.CannotRoundToNonInteger,values:{precision:n.info.precision}}:(null==n?void 0:n.info.type)===a().v3.CannotRoundToTooManyDecimalPlaces?{...l().gW.CannotRoundToTooManyDecimalPlaces,values:{precision:n.info.precision}}:{...l().X8.LibraryFunctionExecutionError,values:{functionName:t.libraryFunction.name}};break;case a().uW.FunctionCallTooFewArguments:o={...l().X8.FunctionCallTooFewArguments,values:{functionName:t.libraryFunction.name}};break;case a().uW.FunctionCallUnexpectedArgument:o={...l().X8.FunctionCallUnexpectedArgument,values:{functionName:t.libraryFunction.name}};break;case a().uW.FunctionCallArgumentWrongType:o={...l().X8.FunctionCallArgumentWrongType,values:{functionName:t.libraryFunction.name,argumentType:c(t.argumentType)}};break;case a().uW.AccessingPropertyOnNonBlock:o=l().X8.AccessingPropertyOnNonBlock;break;case a().uW.MissingDataDependencyBlock:o={...l().X8.MissingDataDependencyBlock,values:{blockId:t.blockPointer.id}};break;case a().uW.MissingDataDependencyPerson:o={...l().X8.MissingDataDependencyPerson,values:{personId:t.personPointer.id}};break;case a().uW.MemberPropertyMismatchCollection:o=l().X8.MemberPropertyMismatchCollection;break;case a().uW.MissingPropertyOnSchemaForMemberProperty:o=l().X8.MissingPropertyOnSchemaForMemberProperty;break;case a().uW.UnaryMinusOnNonNumber:o={...l().X8.UnaryMinusOnNonNumber,values:{expressionType:c(t.expressionType)}};break;case a().uW.UnexpectedRecoveryNode:o=l().X8.UnexpectedRecoveryNode;break;case a().uW.UnexpectedError:o=l().X8.UnexpectedError;break;case a().uW.DepthExceeded:o=l().X8.DepthExceeded;break;case a().uW.CycleDetected:o=l().X8.CycleDetected;break;case a().uW.DownstreamParseFailure:o=l().X8.DownstreamParseFailure;break;case a().uW.MaxEvaluationTimeExceeded:o=l().X8.MaxEvaluationTimeExceeded;break;case a().uW.MissingSchemaPropertyOnCollection:o={...l().X8.MissingSchemaPropertyOnCollection,values:{collectionId:t.collectionId,propertyName:t.property}};break;case a().uW.ContextVariableWrongType:o={...l().X8.ContextVariableWrongType,values:{expectedType:t.expectedType,propertyType:t.resultType,valueId:t.valueId}};break;case a().uW.DisallowedValueType:{const n=t.allowedValueTypes.map((t=>e.formatMessage((0,i().getHumanReadableType)(t)).toLocaleLowerCase()));o={...l().Xz.DisallowedReturnType,values:{allowedValueType:e.formatList(n,{style:"long",type:"conjunction"}),allowedValueTypeCount:t.allowedValueTypes.length,valueType:e.formatMessage((0,i().getHumanReadableValueType)(t.expressionValue)).toLocaleLowerCase()}};break}default:(0,r().HB)(t)}return(0,s().li)(t)?{...o,values:{...o.values,startOffset:t.node.startOffset,endOffset:t.node.endOffset+1}}:o}function m(e){const t=null==e?void 0:e.values;return[n().cJ(e,"values"),t]}function f(e){return e.type===a().uW.DepthExceeded||e.type===a().uW.CycleDetected||e.type===a().uW.MaxEvaluationTimeExceeded||e.type===a().uW.LibraryFunctionExecutionError}},566081:(e,t,o)=>{o.d(t,{A:()=>E});var n=o(296540),r=()=>o(56366),i=()=>o(728611),l=()=>o(908006),a=()=>o(725614),s=()=>o(685889),c=()=>o(704152),d=()=>o(16006),u=o(474848);function p(e){const{blockStore:t,titleStyle:o,shouldWrap:r,recordTitleRef:i,disableTooltip:p}=e,y=(0,n.useRef)({getNode:()=>i.current}),m=(0,n.useCallback)((e=>{l().default.afterNextFlush((()=>{const e=t.getBlockTitleStore();if(!e)return;const o=e.getValue(),n=o?o[0][0].length:0,r={start:{index:n,store:e},end:{index:n,store:e}};a().setMultiSelection({multiSelection:r})}))}),[t]);return(0,u.jsx)(c().A,{style:{height:s().d0+2,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:5,padding:"6px 8px 7px 8px",overflow:"hidden"},onClick:m,children:(0,u.jsx)(d().A,{store:t,underline:!0,shouldWrap:r,style:o,ref:y,disableTooltip:p})})}var y=()=>o(959013),m=()=>o(496603),f=()=>o(792540),S=()=>o(972435),h=()=>o(524702);const b=(0,y().YK)({typeTitle:{defaultMessage:"Type a title...",id:"relationToken.title.placeholder"}});function g(e){const{blockStore:t,clickTitleBehavior:o,onTitleEnter:n,onTitleEsc:i}=e,l="edit"===o,a=(0,r().K8)((()=>t.getBlockTitleStore()),[t]);return(0,u.jsx)(h().A,{store:a,disabled:!l,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,onEnter:n,onEsc:i,onTab:m().D_,placeholder:S().A.formatMessage(b.typeTitle),style:{padding:"6px 8px 7px 8px",textOverflow:"none",overflow:"visible",whiteSpace:"pre"},disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:f().Os.none})}var x=()=>o(484714),v=()=>o(919709),C=()=>o(319975);const k=function(e){const{store:t,style:l,disableLinks:a,disableHover:s,isAndroid:c,externalIntegrations:d,canEdit:p,shouldWrap:m,tokenFormat:f}=e,S=(0,n.useRef)(null),h=(0,y().tz)(),b=(0,x().v3)(),g=(0,o(401497).DP)(),{isExternalIntegrationPageType:k,blockType:w,blockId:P,blockModel:I}=(0,r().K8)((()=>{const e=t.getModel();return{isExternalIntegrationPageType:Boolean(null==e?void 0:e.isType(o(700500).xd.externalObjectInstancePage)),blockType:t.getType(),blockId:t.id,blockModel:e}}),[t]),j=(0,r().K8)((()=>o(267419).A.getState()),[]),R=(0,n.useCallback)((()=>{if(!S||!S.current)return;const e=(0,v().bMp)(t.id),o=(0,v().wmz)(e);return{textValue:[o],tokenIndex:0,textToken:o,node:S.current}}),[S,t.id]),M=(0,n.useCallback)((e=>{if(s)return;const o=R(),n=t.getTitleStore();n&&o&&C().xE({environment:b,event:e,interactiveToken:o,store:n,canEdit:p})}),[s,R,t,b,p]),_=(0,n.useCallback)((e=>{const o=R(),n=t.getTitleStore();n&&o&&!s&&C().HH({environment:b,event:e,interactiveToken:o,store:n,canEdit:p})}),[R,t,s,b,p]),T=t.getRecordModel,B=P,A=(0,o(712030).FN)(b),E=o(780054).A.domainBaseUrl,L=b.currentUser.id,W=!a,F=(0,r().K8)((()=>{if(I)return(0,o(191772).gA)({blockModel:I,shouldWrap:m,index:0,style:l,disableHover:s,disableLinks:a,isAndroid:c,theme:g,getRecordModel:T,currentUserId:L,baseUrl:E,emojiType:A,externalIntegrations:d,classNames:[],intl:h,emojiData:j,stopLinkPropagation:W,tokenFormat:(0,o(425497).Ug)(f)})}),[I,m,l,s,a,c,g,T,L,E,A,d,h,j,W,f]);return B?"external_object_instance_page"!==w?null:k?(0,u.jsx)("span",{ref:S,onMouseOver:M,onMouseOut:_,onClick:W?i().kV:void 0,style:{width:"100%"},children:F}):null:null};function w(e){const{blockStore:t,shouldWrap:n,style:i,disableLinks:l,format:a}=e,s=(0,r().K8)((()=>(0,o(939768).q7)(t.getSyncedUri())),[t]),c=(0,r().O$)(o(53137).A.integrations),d=(0,x().v3)();return(0,u.jsx)(k,{shouldWrap:n,store:t,style:i,disableHover:l||!s,disableLinks:l||!s,isAndroid:d.device.isAndroid,externalIntegrations:c,canEdit:!0,tokenFormat:a})}var P=()=>o(738865);function I(e){const{format:t,showRemoveButton:n,onClickRemove:r}=e,{height:i,closeIconSize:l}=P().U[t];return n?(0,u.jsx)(c().A,{onClick:r,style:{display:"flex",alignItems:"center",justifyContent:"center",width:i,height:i,marginLeft:2,marginRight:2,flexGrow:0,flexShrink:0,borderRadius:4},children:(0,o(65767).l)({width:l,height:l,opacity:.5})}):null}var j=()=>o(584262),R=()=>o(519839),M=()=>o(175116),_=()=>o(492414),T=()=>o(765957);var B=()=>o(231722),A=()=>o(24157);const E=(0,n.forwardRef)((function(e,t){const{parentStore:i,blockId:l,shouldWrap:a,format:s,showRemoveButton:c,clickTitleBehavior:d,onClickRemove:p,titleStyle:y,onTitleEnter:m,onTitleEsc:f,index:S,noUnderline:h,disableTooltip:b,disableLinks:g}=e,x=o(630116).Bv.createChildStore(i,{table:o(179034).ev,id:l}),{style:v}=(0,P().t)(e),C=(0,n.useRef)(null),k=(0,n.useRef)(null),j="peek"===d;(0,n.useImperativeHandle)(t,(()=>x),[x]);const R=(0,r().K8)((()=>"external_object_instance_page"===x.getType()),[x]);if((0,o(571468).W)(x))return null;if(R)return(0,u.jsx)(w,{shouldWrap:a,blockStore:x,style:v,disableLinks:g,format:s});const M=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(o(124954).w,{format:s,blockStore:x,clickTitleBehavior:d,shouldWrap:a}),(0,u.jsx)(W,{blockStore:x,recordTitleRef:C,clickTitleBehavior:d,shouldWrap:a,titleStyle:y,noUnderline:h,onTitleEnter:m,onTitleEsc:f,index:S,disableTooltip:b})]});return(0,u.jsxs)("div",{style:v,ref:k,children:[j?(0,u.jsx)(L,{blockStore:x,relationTokenStyle:v,children:M}):M,(0,u.jsx)(I,{showRemoveButton:c,onClickRemove:p,format:s})]})}));function L(e){let{blockStore:t,relationTokenStyle:l,children:a}=e;const{blockUrlPage:s,blockUrlPeek:c}=function(e){const t=(0,x().v3)(),o=(0,M().Ks)(),n=(0,r().K8)((()=>(0,_().Ay)({store:e,fullyQualified:!1,pageVisitSource:j().y8.LinkInPage})),[e]);return{blockUrlPeek:(0,r().K8)((()=>{const{mainEditorCurrentBlockStore:n}=T().default.state;return R().wy({environment:t,store:e,mainEditorCurrentBlockStore:n,collectionContextStore:o,fullyQualified:!1})}),[t,e,o]),blockUrlPage:n}}(t),d=(0,n.useMemo)((()=>({display:l.display,height:l.height,alignItems:l.alignItems})),[l]);return(0,u.jsx)(o(187485).A,{href:s,metaHref:c,onClick:i().kV,style:d,children:a})}function W(e){const{blockStore:t,clickTitleBehavior:n,onTitleEnter:i,onTitleEsc:l,index:a,recordTitleRef:s,titleStyle:c,shouldWrap:d,noUnderline:y,disableTooltip:m}=e,f=(0,o(551619).Sm)(t),S="edit"===n&&!f,h=function(e){return(0,r().K8)((()=>{var t;const o=A().default.state;return"editing"===o.mode&&(null===(t=(0,B().H7)(o.multiSelection))||void 0===t?void 0:t.store)===e.getBlockTitleStore()}),[e])}(t);return S?h&&i&&a?(0,u.jsx)(g,{blockStore:t,clickTitleBehavior:n,onTitleEnter:i,onTitleEsc:l}):(0,u.jsx)(p,{blockStore:t,recordTitleRef:s,titleStyle:c,shouldWrap:d,disableTooltip:m}):(0,u.jsx)(o(279620).Y,{blockStore:t,recordTitleRef:s,titleStyle:c,shouldWrap:d,noUnderline:y,disableTooltip:m})}},571468:(e,t,o)=>{o.d(t,{W:()=>i,X:()=>r});var n=()=>o(56366);function r(e){return e.isReady()&&!e.isDefined()&&"none"!==e.getRole()}function i(e){return(0,n().K8)((()=>r(e)),[e])}},573451:(e,t,o)=>{o.d(t,{C:()=>r});var n=()=>o(945895);function r(e){const{store:t,transient:o}=e;n().A.setState({isActive:!0,store:t,transient:Boolean(o)})}},595465:(e,t,o)=>{o.d(t,{T:()=>i,m:()=>r});var n=()=>o(645873);const r=new(n().O2)("formPropertyRenderer",(()=>o.e(59111).then(o.bind(o,129090)))),i=(0,n().jQ)(r,(e=>e.default))},614001:(e,t,o)=>{o.d(t,{P:()=>M});o(898992),o(737550);var n=o(296540),r=()=>o(402014),i=()=>o(484714),l=()=>o(56366),a=()=>o(401497),s=()=>o(534177),c=()=>o(675592),d=()=>o(252833),u=o(474848);function p(){const e=(0,a().IS)((e=>({outer:{display:"inline-flex",overflow:"hidden",position:"relative",width:"100%"},inner:{width:"60%",height:10,borderRadius:12,backgroundColor:e.lightDividerColor}})),[]);return(0,u.jsx)("div",{style:e.outer,children:(0,u.jsx)(o(710149).A,{style:e.inner})})}const y=(0,o(340498).wt)("arrowUpDown",{viewBox:"0 0 20 20",directional:!0,svg:(0,u.jsx)("path",{d:"M10 16.8662C9.89518 16.8662 9.79492 16.848 9.69922 16.8115C9.60807 16.7751 9.52604 16.7181 9.45312 16.6406L5.90527 13.0244C5.75488 12.874 5.67969 12.6986 5.67969 12.498C5.67969 12.2839 5.74577 12.1107 5.87793 11.9785C6.01009 11.8464 6.18099 11.7803 6.39062 11.7803C6.49544 11.7803 6.58887 11.8008 6.6709 11.8418C6.75293 11.8828 6.82585 11.9352 6.88965 11.999L8.33203 13.4756L9.33008 14.6514L9.26855 13.1133V7.01562L9.33008 5.47754L8.33203 6.64648L6.88965 8.12988C6.82585 8.19368 6.75293 8.24609 6.6709 8.28711C6.58887 8.32357 6.49544 8.3418 6.39062 8.3418C6.18099 8.3418 6.01009 8.27799 5.87793 8.15039C5.74577 8.01823 5.67969 7.84277 5.67969 7.62402C5.67969 7.42806 5.75488 7.25488 5.90527 7.10449L9.45312 3.48828C9.52604 3.41081 9.60807 3.35384 9.69922 3.31738C9.79492 3.28092 9.89518 3.2627 10 3.2627C10.0957 3.2627 10.1891 3.28092 10.2803 3.31738C10.376 3.35384 10.4626 3.41081 10.54 3.48828L14.0879 7.10449C14.2383 7.25488 14.3135 7.42806 14.3135 7.62402C14.3135 7.84277 14.2451 8.01823 14.1084 8.15039C13.9762 8.27799 13.8076 8.3418 13.6025 8.3418C13.4977 8.3418 13.4043 8.32357 13.3223 8.28711C13.2402 8.24609 13.165 8.19368 13.0967 8.12988L11.6611 6.64648L10.6562 5.47754L10.7246 7.01562V13.1133L10.6562 14.6514L11.6611 13.4756L13.0967 11.999C13.165 11.9352 13.2402 11.8828 13.3223 11.8418C13.4043 11.8008 13.4977 11.7803 13.6025 11.7803C13.8076 11.7803 13.9762 11.8464 14.1084 11.9785C14.2451 12.1107 14.3135 12.2839 14.3135 12.498C14.3135 12.6986 14.2383 12.874 14.0879 13.0244L10.54 16.6406C10.4626 16.7181 10.376 16.7751 10.2803 16.8115C10.1891 16.848 10.0957 16.8662 10 16.8662Z"})});var m=()=>o(959013);const f=(0,m().YK)({expand_property:{defaultMessage:"Expand",id:"database.ExpandButton"}});function S(e){let{store:t,property:r,showHoverColor:i}=e;const s=(0,m().tz)(),c=(0,o(175116).Ks)(),d=null==c?void 0:c.virtualizedModule.getBlockHeightsCache(),p=(0,l().K8)((()=>null==d?void 0:d.propertyCanExpandStore(t.id,r).state),[d,r,t]),S=(0,n.useCallback)((()=>{null==d||d.expandHeightToTallestCached(t.id)}),[d,t.id]),h=(0,a().IS)((e=>({icon:{color:i?e.icon.secondary:e.icon.tertiary,fill:i?e.icon.secondary:e.icon.tertiary,height:16,width:16},iconButton:{height:20,width:20}})),[i]);return c&&p?(0,u.jsx)(o(761529).A,{onClick:S,icon:y,tooltip:s.formatMessage(f.expand_property),iconStyle:h.icon,style:h.iconButton}):null}var h=()=>o(962730),b=()=>o(488173),g=()=>o(504836),x=()=>o(765957);const v=(0,m().YK)({upgrade_to_enterprise:{defaultMessage:"Upgrade to Enterprise to edit this property",id:"BlockPropertyButtonExternalPropertyTooltip.upgradeToEnterprise"},two_way_sync_not_enabled:{defaultMessage:"2-way sync required to edit",id:"BlockPropertyButtonExternalPropertyTooltip.twoWaySyncRequired"},property_not_editable:{defaultMessage:"This property is not editable",id:"BlockPropertyButtonExternalPropertyTooltip.propertyNotEditable"},connect_to_integration:{defaultMessage:"Connection to {integration} required to edit",id:"BlockPropertyButtonExternalPropertyTooltip.connectToIntegration"},full_access:{defaultMessage:"You have full access to this property",id:"BlockPropertyButtonExternalPropertyTooltip.fullAccess"}}),C=(0,m().YK)({clickToGetStarted:{defaultMessage:"Click to get started",id:"BlockPropertyButtonExternalPropertyTooltip.clickToGetStarted"},dataCannotBeEdited:{defaultMessage:"Data synced from {integration} cannot be edited",id:"BlockPropertyButtonExternalPropertyTooltip.dataCannotBeEdited"}});function k(e){let{collectionContextStore:t,propertySchema:o,baseTooltip:n}=e;const r=(0,l().K8)((()=>{var e;return"enterprise"===(null===(e=x().default.getState().currentSpaceStore)||void 0===e?void 0:e.getSubscriptionTier())}),[]),i=(0,a().IS)((e=>({action:{color:e.text.contrastSecondary}})),[]),s=(0,l().K8)((()=>{var e,n,i;const l=null==t||null===(e=t.collectionStore())||void 0===e?void 0:e.getFormat().external_collection_type;if(!(0,d().cd)(l)||!(0,g().CS)())return{twoWaySyncUserState:void 0,integration:l};if(!r)return{twoWaySyncUserState:(0,b().fW)({isUserOnEnterprisePlan:r}),integration:l};const a=Boolean(null==t||null===(n=t.collectionStore())||void 0===n||null===(n=n.getFormat())||void 0===n||null===(n=n.sync_state)||void 0===n?void 0:n.enable_two_way_sync);if(!a)return{twoWaySyncUserState:(0,b().fW)({isUserOnEnterprisePlan:r,twoWaySyncEnabled:a}),integration:l};const s=Boolean(null==t||null===(i=t.externalSyncStore)||void 0===i||null===(i=i.state)||void 0===i?void 0:i.shouldAllowUserToEditSyncedCollection()),c="read_write"===(null==o?void 0:o.synced_permissions);return{twoWaySyncUserState:(0,b().fW)({isUserOnEnterprisePlan:r,twoWaySyncEnabled:a,canEdit:s,isEditableProperty:c}),integration:l}}),[r,t,o]);if(s.twoWaySyncUserState){if("full_access"===s.twoWaySyncUserState)return n;if("connect_to_integration"===s.twoWaySyncUserState||"two_way_sync_not_enabled"===s.twoWaySyncUserState){const e={...v[s.twoWaySyncUserState],values:{integration:s.integration??"integration"}};return(0,u.jsxs)("div",{children:[(0,u.jsx)(m().sA,{...e}),(0,u.jsx)("div",{style:i.action,children:(0,u.jsx)(m().sA,{...C.clickToGetStarted})})]})}return(0,u.jsx)(m().sA,{...v[s.twoWaySyncUserState]})}{const e={...C.dataCannotBeEdited,values:{integration:s.integration??"integration"}};return(0,u.jsx)(m().sA,{...e})}}var w=()=>o(234359);function P(e){const{propertyValue:t,propertyCaption:r,render:i}=e,{propertySchema:l,format:s,shouldRenderTooltip:c,isExternallyImportedAndSyncedPage:d,collectionContextStore:p}=(0,n.useContext)(w().L8),y=null==l?void 0:l.name,m=!c,f="board"===s||"gallery"===s,S=(null==y?void 0:y.length)&&!m,b=void 0!==t,g=void 0!==r,x=S||b||g,v=(0,a().IS)((e=>({value:{color:S?e.text.contrastSecondary:void 0},caption:{color:S||b?e.text.contrastSecondary:void 0}})),[S,b]),C=(0,n.useCallback)((()=>{const e=(0,u.jsxs)(u.Fragment,{children:[S&&(0,u.jsx)("div",{children:y}),b&&(0,u.jsx)("div",{style:v.value,children:t}),g&&(0,u.jsx)("span",{style:v.caption,children:r})]});return d&&"page"===s?(0,u.jsx)(k,{collectionContextStore:p,propertySchema:l,baseTooltip:e}):e}),[g,S,b,r,y,t,v,d,s,p,l]);return x?(0,u.jsx)(o(859428).A,{renderTooltip:C,render:e=>i(e),tooltipClassName:o(38337).Efz,placement:f?h().W.Left:h().W.Bottom}):i()}var I=()=>o(236030);function j(e){const{propertySchema:t,isPhone:o}=e;if(!t)return o?I().A4:I().Nh;switch(function(e){switch(e){case"auto_increment_id":case"created_by":case"created_time":case"date":case"email":case"formula":case"last_edited_by":case"last_edited_time":case"last_visited_time":case"location":case"multi_select":case"number":case"phone_number":case"place":case"rollup":case"text":case"title":case"url":case"verification":return"text";case"button":case"file":return"button";case"checkbox":return"checkbox";case"person":case"relation":case"select":case"status":return"token";default:(0,s().HB)(e)}}(t.type)){case"default":return o?I().A4:I().Nh;case"text":return o?I().Wh:I().Zs;case"token":return o?I().Sh:I().hB;case"checkbox":return o?I().IH:I().Nl;case"button":return o?I().DX:I().Mk}}function R(e){let{children:t,blockPropertyValueOverlayStore:r}=e;const l=(0,i().WS)(),a=(0,n.useRef)(null),{collectionContextStore:s,store:d,property:p,propertySchema:y}=(0,n.useContext)(w().L8),m=(0,c().PD)(),f=null==s?void 0:s.virtualizedModule.getBlockHeightsCache(),S=(0,n.useRef)(!1),h=(0,n.useCallback)((e=>{f&&d&&!e.state.isOpen&&(f.expandHeightToTallestCached(d.id),e.removeListener(h),S.current=!1)}),[f,d]),b=(0,n.useCallback)((e=>{if(!(f&&d&&p&&e))return;const t=f.getPropertyHeightStore(d.id,p).state,n=j({isPhone:l,propertySchema:y}),i=0===e.height?0:e.height+n+n;f.cachePropertyHeight(d.id,p,i),t!==i&&!1===(null==m?void 0:m.isScrolling)&&!0!==o(230062).A.state&&(null!=r&&r.state.isOpen&&!S.current?(r.addListener(h),S.current=!0):f.expandHeightToTallestCached(d.id))}),[f,d,p,l,y,null==m?void 0:m.isScrolling,r,h]);return(0,o(828634).tK)(a,b),(0,u.jsx)("div",{ref:a,children:t})}const M=n.memo((0,n.forwardRef)((function(e,t){const{tooltipPropertyValue:o,tooltipPropertyCaption:n,tooltipHide:r}=e,i=o=>(0,u.jsx)(_,{ref:t,...e,tooltipEvents:o});return r?i():(0,u.jsx)(P,{propertyValue:o,propertyCaption:n,render:i})}))),_=(0,n.forwardRef)((function(e,t){const{style:y,quickActionButtons:m,quickActionButtonsAlign:f,quickActionButtonsForceVisible:h,editButtonClickProps:b,width:g,forceEnableButton:x,collectionSchema:v,onContextMenu:C,formQuestionStore:k,userExpandable:P}=e,I=(0,i().v3)(),{isAndroid:j,isMobile:M,isPhone:_}=(0,i().Y0)(),T=(0,o(963589).X)("db_ux_mobile"),[B,A]=(0,n.useState)(!1),[E,L]=(0,n.useState)(!1),{collectionContextStore:W,format:F,canEdit:V,store:K,property:z,baseStyles:O,propertySchema:D}=(0,n.useContext)(w().L8),H=(0,l().O$)(o(227440).e),N=(0,l().K8)((()=>Boolean(null==W?void 0:W.viewsModuleContextStore.isInLayoutBuilder())),[W]),U="text"===(null==D?void 0:D.type)&&!(null!=D&&D.ai_inference),q=(0,l().K8)((()=>!!U&&(!!K&&(0,o(299545).O3)(K,{includePropertyDiscussions:!0}).some((e=>e.getPropertyId()===z)))),[U,z,K]),{isLoading:Q,isExternalUpdateInProgress:Y}=(0,l().K8)((()=>{var e;const t=null==W?void 0:W.collectionStore(),n=null==K?void 0:K.getFormat(),r=!(null!=n&&null!==(e=n.attributes)&&void 0!==e&&e.length)&&!(null!=n&&n.error)&&Boolean(null==t?void 0:t.isSyncedCollection());if(!(null==t?void 0:t.isExternallyImportedAndSyncedCollection())||null==K||!K.id||!z)return{isLoading:r,isExternalUpdateInProgress:!1};const i=o(485634).A.getState();return{isLoading:r,isExternalUpdateInProgress:Boolean(i.syncingProperties.size>0&&i.syncingProperties.has((0,d().vT)({pageId:K.id,propertyId:z})))}}),[W,K,z]),X=(0,o(106412).Zp)(),$=H||!H&&(0,s().O9)(D)&&!(0,o(334684).$)({propertyType:null==D?void 0:D.type,propertySchema:D,allowAIProperty:!0}),J=(x||V&&void 0!==b||q)&&!N&&!(null!=X&&X.disableAllPointerEvents)&&$,Z=(0,a().IS)((()=>({buttonStyle:{position:"relative",...y,display:Y?"flex":null==y?void 0:y.display,...J?{}:{cursor:"default"}},expandButtonPosition:{position:"relative",left:"left"===f?-2:2,float:"left"===f?"left":"right"}})),[y,Y,f,J]),G=(0,n.useRef)(null),ee=(0,n.useCallback)((()=>{L(!0)}),[]),te=(0,n.useCallback)((e=>{G.current&&e.relatedTarget&&(!e.relatedTarget||G.current.contains(e.relatedTarget))||L(!1)}),[]),oe=(0,n.useCallback)((()=>{A(!0)}),[]),ne=(0,n.useCallback)((()=>{A(!1)}),[]),re=(0,n.useCallback)((e=>{j&&_?e.preventDefault():C&&(0,r().SQ)({event:e,context:r().y$.EditorContextMenu,callback:()=>{C(e)}})}),[j,_,C]),ie=(0,c().DV)(),le=P&&ie,ae=(0,n.useCallback)((async e=>{if(void 0===b)return;const{onClick:t,store:n,property:r,format:i,collectionStore:l,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:s,isStatusCheckbox:c,focusButtonAfterClose:d}=b;await o(548218).V({element:G.current??void 0,environment:I,onClick:t,store:n,property:r,format:i,collectionStore:l,blockPropertyValueOverlayStore:a,disableHorizontalEdgeScroll:s,collectionContextStore:W,collectionSchema:v,setMouseEntered:A,statusSetCheckbox:c?!e.altKey:void 0,sizing:"large"===(null==O?void 0:O.sizing)?"large":"default",formQuestionStore:k,onClose:()=>{var e;d&&(null===(e=G.current)||void 0===e||e.focus())},isDBUXMobileEnabled:T})}),[b,I,W,v,null==O?void 0:O.sizing,k,T]),se=(0,n.useCallback)((e=>{var o;null===(o=G.current)||void 0===o||o.removeEventListener("focusout",te),G.current=e,null==e||e.addEventListener("focusout",te),"function"==typeof t?t(e):t&&(t.current=e)}),[te,t]),ce=(0,o(736230).V)({collectionContextStore:W,blockId:null==K?void 0:K.id,property:z,featureEnabled:le}),de=N||(null==X?void 0:X.disablePageLinks),ue=(0,n.useMemo)((()=>{if(de||!m||Array.isArray(m)&&0===m.length)return null;const t=void 0!==h?h||E:(!g||g>80)&&(B||E||M);if(!t)return ce&&K&&z?(0,u.jsx)("div",{style:Z.expandButtonPosition,children:(0,u.jsx)(S,{store:K,property:z})}):null;const n=ce?(0,u.jsxs)(u.Fragment,{children:["left"===f&&K&&z&&(0,u.jsx)(S,{store:K,property:z,showHoverColor:!0}),m,(!f||"right"===f)&&K&&z&&(0,u.jsx)(S,{store:K,property:z,showHoverColor:!0})]}):m;return(0,u.jsxs)(u.Fragment,{children:[!M&&ce&&K&&z&&(0,u.jsx)("div",{style:Z.expandButtonPosition,children:(0,u.jsx)(S,{store:K,property:z})}),t?(0,u.jsx)(o(48105).J,{align:f,style:e.quickActionButtonsStyle,format:F,containerRef:G,children:n}):null]})}),[de,m,g,h,E,B,M,ce,f,K,z,Z.expandButtonPosition,e.quickActionButtonsStyle,F]);if(Q)return(0,u.jsx)("div",{style:Z.buttonStyle,children:(0,u.jsx)(p,{})});const pe=(0,o(553965).A)({onMouseMove:oe,onMouseLeave:ne},e.tooltipEvents);return J?(0,u.jsxs)(o(704152).A,{className:e.className,ref:se,hoveredStyle:e.hoveredStyle,pressedStyle:e.pressedStyle,style:Z.buttonStyle,onContextMenu:re,onClick:ae,onFocus:ee,testId:"property-value",...pe,children:[ue,le?(0,u.jsx)(R,{blockPropertyValueOverlayStore:null==b?void 0:b.blockPropertyValueOverlayStore,children:e.children}):e.children,Y?(0,u.jsx)(o(331542).A,{style:{alignSelf:"center",marginRight:8,marginLeft:8}}):null]}):(0,u.jsxs)("div",{className:e.className,ref:se,style:Z.buttonStyle,onFocus:ee,...pe,children:[ue,le?(0,u.jsx)(R,{children:e.children}):e.children]})}))},627503:(e,t,o)=>{o.d(t,{a:()=>r});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"1.37 1.37 13.25 13.25",svg:(0,o(474848).jsx)("path",{d:"M3.25 1.375c-1.036 0-1.875.84-1.875 1.875v6c0 1.036.84 1.875 1.875 1.875h1.625v1.625c0 1.036.84 1.875 1.875 1.875h6c1.036 0 1.875-.84 1.875-1.875v-6c0-1.036-.84-1.875-1.875-1.875h-1.625V3.25c0-1.036-.84-1.875-1.875-1.875zM2.625 3.25c0-.345.28-.625.625-.625h6c.345 0 .625.28.625.625v1.625H6.75c-1.036 0-1.875.84-1.875 1.875v3.125H3.25a.625.625 0 0 1-.625-.625zm3.5 3.5c0-.345.28-.625.625-.625h6c.345 0 .625.28.625.625v6c0 .345-.28.625-.625.625h-6a.625.625 0 0 1-.625-.625z"})},r=(0,o(340498).wt)("duplicateSmall",n)},634224:(e,t,o)=>{o.d(t,{Hp:()=>a,Yg:()=>m,Zz:()=>y,qi:()=>p,qs:()=>u,vM:()=>f,w1:()=>s});var n=()=>o(284371),r=()=>o(236030),i=()=>o(897119),l=()=>o(828180);const a={title:i().nl.Popup,text:i().nl.Popup,number:i().nl.Popup,url:i().nl.Popup,phone_number:i().nl.Popup,email:i().nl.Popup,relation:i().nl.SlideUp,rollup:i().nl.SlideUp,select:i().nl.SlideUp,multi_select:i().nl.SlideUp,status:i().nl.SlideUp,person:i().nl.SlideUp,date:i().nl.SlideUp,file:i().nl.SlideUp,formula:i().nl.SlideUp,checkbox:i().nl.SlideUp,created_by:i().nl.SlideUp,created_time:i().nl.SlideUp,last_edited_by:i().nl.SlideUp,last_edited_time:i().nl.SlideUp,last_visited_time:i().nl.SlideUp,button:i().nl.SlideUp,auto_increment_id:i().nl.Popup,location:i().nl.Popup,verification:i().nl.SlideUp,place:i().nl.SlideUp},s={title:i().nl.Popup,text:i().nl.Popup,number:i().nl.Popup,url:i().nl.Popup,phone_number:i().nl.Popup,email:i().nl.Popup,relation:i().nl.BottomSheet,rollup:i().nl.SlideUp,select:i().nl.BottomSheet,multi_select:i().nl.BottomSheet,status:i().nl.BottomSheet,person:i().nl.BottomSheet,date:i().nl.BottomSheet,file:i().nl.SlideUp,formula:i().nl.SlideUp,checkbox:i().nl.SlideUp,created_by:i().nl.SlideUp,created_time:i().nl.SlideUp,last_edited_by:i().nl.SlideUp,last_edited_time:i().nl.SlideUp,last_visited_time:i().nl.SlideUp,button:i().nl.SlideUp,auto_increment_id:i().nl.Popup,location:i().nl.Popup,verification:i().nl.SlideUp,place:i().nl.BottomSheet},c=Object.freeze({paddingLeft:9,paddingRight:9,paddingTop:(r().tt-20)/2,paddingBottom:(r().tt-20)/2,minHeight:r().tt+1+1,display:"flex",height:"100%",flexDirection:"column",justifyContent:"space-between",flexGrow:1}),d=Object.freeze({...c,paddingTop:(r().Um-20)/2,paddingBottom:(r().Um-20)/2,minHeight:r().Um+1+1}),u=Object.freeze({...c,fontSize:l().Mi}),p=Object.freeze({...c,fontSize:l().KI,fontWeight:n().Wy.medium}),y=Object.freeze({...d,fontSize:l().Mi}),m=Object.freeze({...d,fontSize:l().hN}),f=Object.freeze({...d,fontSize:l().KI,fontWeight:n().Wy.medium})},658985:(e,t,o)=>{o.d(t,{$:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("membersFilled",{viewBox:"0 0 30 30",svg:(0,n.jsx)("path",{d:"M20.31 14.731c2.22 0 4.097-1.967 4.097-4.513 0-2.485-1.887-4.391-4.098-4.391-2.2 0-4.097 1.937-4.087 4.411 0 2.526 1.866 4.493 4.087 4.493zm-11.725.233c1.937 0 3.57-1.724 3.57-3.935 0-2.17-1.653-3.823-3.57-3.823-1.917 0-3.57 1.683-3.56 3.844 0 2.19 1.633 3.914 3.56 3.914zm-5.588 9.21h7.606c-1.085-1.552.082-4.615 2.374-6.42-1.116-.72-2.566-1.248-4.392-1.248-4.533 0-7.464 3.337-7.464 6.085 0 1.004.507 1.582 1.876 1.582zm10.994-.01h12.637c1.673 0 2.251-.508 2.251-1.44 0-2.607-3.316-6.198-8.57-6.198-5.263 0-8.57 3.59-8.57 6.197 0 .933.578 1.44 2.252 1.44z"})})},675592:(e,t,o)=>{o.d(t,{DV:()=>s,PD:()=>a,Pr:()=>r,UB:()=>c,Wm:()=>l,Z6:()=>i});var n=o(296540);const r=n.createContext(void 0);r.displayName="ColumnVirtualizerContext";const i=n.createContext(!1);i.displayName="ColumnVirtualizerExistenceContext";const l=n.createContext({propertiesInRange:[],propertiesInRangeIndices:[],beforeWidth:0,afterWidth:0});function a(){return(0,n.useContext)(r)}function s(){return(0,n.useContext)(i)}function c(){return(0,n.useContext)(l)}l.displayName="ColumnVirtualizerVisiblePropertiesContext"},705516:(e,t,o)=>{o.d(t,{i:()=>c});var n=o(296540),r=()=>o(401497),i=()=>o(421107),l=()=>o(234359),a=o(474848);const s=(0,o(959013).YK)({copy:{defaultMessage:"Copy to Clipboard",id:"database.copyButton.copyToClipboard"}}),c=n.memo((function(e){const{store:t,property:c,style:d,format:u,showShadow:p}=e,y=(0,o(484714).v3)(),m=(0,r().DP)(),f=(0,o(175116).Ks)(),{collectionSchemaStore:S}=(0,n.useContext)(l().L8),{isEmptyStore:h,propertySchema:b,canEdit:g}=(0,n.useContext)(l().L8),x=(0,o(56366).O$)(h),v=(0,r().IS)((e=>({buttonStyle:{display:"flex",position:"relative"},iconStyle:{color:e.text.secondary,fill:e.text.secondary,width:16,height:16}})),[]),C="table"===u,k=o(972435).A.formatMessage(s.copy),w=(0,n.useCallback)((()=>k),[k]),P=(0,n.useCallback)((e=>(0,a.jsx)("div",{style:{...d,...v.buttonStyle},...e,children:(0,a.jsx)(o(285790).A,{onClick:async()=>{const e=S.getState();if(!e)return;let n;C&&(n=i().A.getState(),o(4319).wr()),await o(548218).E({environment:y,theme:m,store:t,schema:e,property:c,collectionContextStore:f}),C&&n&&i().A.setState(n)},ariaLabel:k,hasBackground:!0,icon:o(627503).a,showShadow:p,iconStyle:v.iconStyle,style:{height:20,width:24,borderRadius:4}})})),[f,S,y,C,c,p,t,d,v.buttonStyle,v.iconStyle,m,k]);return void 0===b||x||o(780054).A.isMobile&&!0===g||"checkbox"===(0,o(501053).c)(b)?null:(0,a.jsx)(o(859428).A,{renderTooltip:w,render:P})}))},712796:(e,t,o)=>{o.d(t,{BP:()=>T,Gx:()=>P,Qz:()=>M,RM:()=>_,UP:()=>j,g$:()=>w,nr:()=>x,v:()=>k,vy:()=>R,wW:()=>C,y9:()=>I,zI:()=>v});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(401497),a=()=>o(787626),s=()=>o(604995),c=()=>o(416504),d=()=>o(559653),u=()=>o(630116),p=()=>o(146962),y=()=>o(705516),m=()=>o(234359),f=()=>o(828180),S=()=>o(414712),h=()=>o(859118),b=o(474848);const g=n.memo((0,n.forwardRef)((function(e,t){const{store:i,onContextMenu:a,editButtonClickProps:s,quickActionButtons:c,EmptyComponent:d,buttonStyle:u,property:p,width:y,formQuestionStore:f,userExpandable:h}=e,{baseStyles:g,propertySchema:v,propertyFormat:C}=(0,n.useContext)(m().L8),k=(0,S().DZ)(i,p,v),w=(0,r().v3)(),P=v,I=x(i,null==P?void 0:P.type,p,w.currentUser.id),j=(0,l().IS)((e=>({buttonStyle:{...g.buttonStyle,...u},buttonPressedStyle:g.buttonPressedStyle??{},buttonHoveredStyle:g.buttonHoveredStyle??{}})),[g.buttonHoveredStyle,g.buttonPressedStyle,g.buttonStyle,u]);if(!I&&void 0===d&&void 0===k)return null;let R;if(k)R=(0,b.jsx)(o(422464).e,{templateVariableType:k.templateVariable});else if(I||void 0===d){const e=(null==C?void 0:C.date_format)??(null==P?void 0:P.date_format),t=(null==C?void 0:C.time_format)??(null==P?void 0:P.time_format);R=(0,b.jsx)(o(88306).C,{children:(0,b.jsx)(o(388507).b,{dateValue:I,dateFormat:e,timeFormat:t,store:i,property:p})})}else R=(0,b.jsx)(d,{});return(0,b.jsx)(o(614001).P,{ref:t,style:j.buttonStyle,hoveredStyle:j.buttonHoveredStyle,pressedStyle:j.buttonPressedStyle,onContextMenu:a,editButtonClickProps:s,quickActionButtons:c,width:y,formQuestionStore:f,userExpandable:h,children:R})})));function x(e,t,o,n){return(0,i().K8)((()=>{switch(t){case"created_time":const t=e.getCreatedTime();return t?s().KQ(t,(0,c().P)()):void 0;case"last_edited_time":const r=e.getLastEditedTime();return r?s().KQ(r,(0,c().P)()):void 0;case"last_visited_time":if(!n)return;const i=u()._z.createChildStore(e,{table:d().F9,id:(0,d().$5)({parent_id:e.id,user_id:n}),spaceId:e.getSpaceId()}).getVisitedAt();return i?s().KQ(i,(0,c().P)()):void 0;default:const l=e.getPropertyValue(o);return(0,a().b)(l)}}),[o,e,t,n])}const v=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:a}=e,{isMobile:s,isPhone:c}=(0,r().Y0)(),d=(0,l().IS)((()=>({buttonStyle:{padding:(0,f()._Q)({isPhone:c}).page.text}})),[c]),u=(0,n.useMemo)((()=>{if(!s)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p().k,{},"comment"),(0,b.jsx)(y().i,{store:o,property:i,format:a},"copy")]})}),[a,s,i,o]),m=B(e,t,d);return(0,b.jsx)(g,{...m,EmptyComponent:h().ao,quickActionButtons:u})})),C=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:a}=e,{isMobile:s,isPhone:c}=(0,r().Y0)(),{shouldWrap:d}=(0,n.useContext)(m().L8),u=(0,l().IS)((()=>({buttonStyle:{padding:(0,f()._Q)({isPhone:c}).table.text}})),[c]),S=(0,n.useMemo)((()=>{if(!s)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p().k,{},"comment"),(0,b.jsx)(y().i,{store:o,property:i,format:a},"copy")]})}),[a,s,i,o]),x=B(e,t,u);return(0,b.jsx)(g,{...x,EmptyComponent:h().rW,quickActionButtons:S,userExpandable:d})})),k=(0,n.forwardRef)((function(e,t){const{store:o,property:i,format:a}=e,{isMobile:s,isPhone:c}=(0,r().Y0)(),d=(0,l().IS)((()=>({buttonStyle:{padding:(0,f()._Q)({isPhone:c}).compact_page.text}})),[c]),u=(0,n.useMemo)((()=>{if(!s)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p().k,{},"comment"),(0,b.jsx)(y().i,{store:o,property:i,format:a},"copy")]})}),[a,s,i,o]),m=B(e,t,d);return(0,b.jsx)(g,{...m,EmptyComponent:h().ao,quickActionButtons:u})})),w=(0,n.forwardRef)((function(e,t){const{showIfEmpty:n}=e,r=B(e,t,(0,o(512321).F)(t,e.collectionStore,e.property,"date"));return(0,b.jsx)(g,{...r,EmptyComponent:n?h().Jb:void 0})})),P=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,r().WS)(),i=B(e,t,(0,l().IS)((()=>({buttonStyle:{padding:(0,f()._Q)({isPhone:n}).board.text}})),[n]));return(0,b.jsx)(g,{...i,EmptyComponent:o?h().Jb:void 0})})),I=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,b.jsx)(g,{...o})})),j=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=B(e,t);return(0,b.jsx)(g,{...n,EmptyComponent:o?h().Jb:void 0})})),R=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,b.jsx)(g,{...o})})),M=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,b.jsx)(g,{...o})})),_=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,b.jsx)(g,{...o})})),T=(0,n.forwardRef)((function(e,t){const o=B(e,t);return(0,b.jsx)(g,{...o,EmptyComponent:h().Fe})}));function B(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,S().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}},714574:(e,t,o)=>{o.d(t,{P:()=>r});var n=()=>o(996494);function r(e){const{store:t}=e;"new"===n().A.state.editMode&&n().A.state.store.id===t.id&&n().A.reset()}},727395:(e,t,o)=>{o.d(t,{_:()=>r});var n=()=>o(679924);function r(e,t){(0,n().v)(e,"relation_navigate_block",t)}},729650:(e,t,o)=>{o.d(t,{M:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("collectionInbox",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M11.0918,0 C11.5383,0 11.9307,0.295898 12.0533,0.725586 L13.9615,7.40332 C13.9871,7.49316 14,7.58594 14,7.67871 L14,13 C14,13.5527 13.5522,14 13,14 L1,14 C0.447754,14 0,13.5527 0,13 L0,7.67871 C0,7.58594 0.0129395,7.49316 0.0384521,7.40332 L1.94666,0.725586 C2.06934,0.295898 2.46167,0 2.9082,0 L11.0918,0 Z M4.27271,1.5 C3.83728,1.5 3.45178,1.78223 3.31982,2.19727 L1.91455,6.61328 C1.70947,7.25879 2.1908,7.91699 2.86755,7.91699 L4.70837,7.91699 C4.70837,8.93652 5.16663,10.168 7,10.168 C8.83337,10.168 9.29163,8.93652 9.29163,7.91699 L11.1478,7.89355 C11.8201,7.88477 12.2927,7.22852 12.0876,6.58887 L10.681,2.19531 C10.5485,1.78125 10.1635,1.5 9.72864,1.5 L4.27271,1.5 Z"})})},736230:(e,t,o)=>{o.d(t,{V:()=>r});var n=()=>o(56366);function r(e){let{collectionContextStore:t,blockId:o,property:r,featureEnabled:i=!1}=e;return(0,n().K8)((()=>{if(!(i&&o&&r&&t))return!1;const e=t.virtualizedModule.getBlockHeightsCache();return e&&e.propertyCanExpandStore(o,r).state}),[t,o,r,i])}},738865:(e,t,o)=>{o.d(t,{U:()=>a,t:()=>s});var n=()=>o(401497),r=()=>o(784892),i=()=>o(284371),l=()=>o(685889);const a={[r().NY.ExtremeSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[r().NY.ExtraSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[r().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",recordIconMarginRight:3,pageIconSize:16,closeIconSize:8},[r().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[r().NY.Medium]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[r().NY.Inline]:{height:20,fontSize:14,margin:"0 12px 0 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[r().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",recordIconMarginRight:4,pageIconSize:24,closeIconSize:10}};function s(e){let{format:t,shouldShrink:o,shouldWrap:s,isSingle:d,style:u,clickTitleBehavior:p}=e;const y="edit"===p;return(0,n().IS)((()=>{const{fontSize:e,margin:n}=a[t],p=y?l().d0:a[t].height;return{style:{...s?{display:"inline",lineHeight:1.5,borderRadius:4}:c({height:p}),fontSize:e,fontWeight:i().Wy.medium,minWidth:o?0:"auto",margin:d?0:n,...t===r().NY.Inline&&{overflow:"hidden"},...u}}}),[t,o,s,d,y,u])}function c(e){let{height:t}=e;return{display:"flex",alignItems:"center",lineHeight:1.2,height:t}}},739041:(e,t,o)=>{o.d(t,{u:()=>r});var n=()=>o(679924);function r(e,t,o){(0,n().v)(e,t,o)}},740241:(e,t,o)=>{o.r(t),o.d(t,{BlockPropertyRouter:()=>Ci});var n=o(296540),r=()=>o(56366),i=()=>o(175116),l=()=>o(458366),a=()=>o(484714),s=()=>o(401497),c=()=>o(716016),d=()=>o(713998),u=()=>o(705516),p=()=>o(614001),y=()=>o(234359),m=()=>o(828180),f=()=>o(512321),S=()=>o(88306),h=o(474848);const b=n.memo((0,n.forwardRef)((function(e,t){const{store:o,collectionStore:i,buttonStyle:l,onContextMenu:a,quickActionButtons:u,property:m}=e,{baseStyles:f}=(0,n.useContext)(y().L8),b=(0,r().K8)((()=>{var e;const t=o.getPropertyValue(m),n=null==i||null===(e=i.getRecordKeyStore())||void 0===e?void 0:e.getRecordKey(),r=(0,d().On)(t);return void 0===r?"...":(0,c().H4)(n,r)}),[i,m,o]),g=(0,s().IS)((()=>({buttonStyle:{...f.buttonStyle,...l},buttonPressedStyle:f.buttonPressedStyle??{},buttonHoveredStyle:f.buttonHoveredStyle??{}})),[f.buttonHoveredStyle,f.buttonPressedStyle,f.buttonStyle,l]);return(0,h.jsx)(p().P,{ref:t,style:g.buttonStyle,hoveredStyle:g.buttonHoveredStyle,pressedStyle:g.buttonPressedStyle,onContextMenu:a,quickActionButtons:u,editButtonClickProps:void 0,children:(0,h.jsx)(S().C,{fontColor:"light",children:b})})}))),g=(0,n.forwardRef)((function(e,t){const{store:o,property:n,format:r}=e,i=(0,a().WS)(),l=_(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:i}).page.text}})),[i]));return(0,h.jsx)(b,{...l,quickActionButtons:(0,h.jsx)(u().i,{store:o,property:n,format:r})})})),x=(0,n.forwardRef)((function(e,t){const{store:o,property:n,format:r}=e,{isMobile:i,isPhone:l}=(0,a().Y0)(),c=_(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:l}).table.text}})),[l]));return(0,h.jsx)(b,{...c,quickActionButtons:i?void 0:(0,h.jsx)(u().i,{store:o,property:n,format:r},"copy")})})),v=(0,n.forwardRef)((function(e,t){const{store:o,property:n,format:r}=e,{isMobile:i,isPhone:l}=(0,a().Y0)(),c=_(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:l}).compact_page.text}})),[l]));return(0,h.jsx)(b,{...c,quickActionButtons:i?void 0:(0,h.jsx)(u().i,{store:o,property:n,format:r},"copy")})})),C=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,h.jsx)(b,{...o})})),k=(0,n.forwardRef)((function(e,t){const o=_(e,t,(0,f().F)(t,e.collectionStore,e.property,"auto_increment_id"));return(0,h.jsx)(b,{...o})})),w=(0,n.forwardRef)((function(e,t){const o=(0,a().WS)(),n=_(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).board.text}})),[o]));return(0,h.jsx)(b,{...n})})),P=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,h.jsx)(b,{...o})})),I=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,h.jsx)(b,{...o})})),j=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,h.jsx)(b,{...o})})),R=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,h.jsx)(b,{...o})})),M=(0,n.forwardRef)((function(e,t){const o=_(e,t);return(0,h.jsx)(b,{...o})}));function _(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l}=e;return{ref:t,store:n,collectionStore:r,property:i,onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle}}var T=()=>o(959013),B=()=>o(381349),A=()=>o(973647),E=()=>o(534177),L=()=>o(813297),W=()=>o(862292),F=()=>o(157857),V=()=>o(972435),K=()=>o(645873),z=()=>o(630116),O=()=>o(19794),D=()=>o(864943),H=()=>o(859428);const N=n.memo((0,n.forwardRef)((function(e,t){const{store:i,property:l,collectionStore:c,buttonStyle:d,innerButtonStyle:u,onContextMenu:m,disabled:f}=e,[S,b]=(0,n.useState)(!1),g=(0,a().v3)(),{baseStyles:x,propertySchema:v,collectionContextStore:C}=(0,n.useContext)(y().L8),k=v,w=(null==x?void 0:x.sizing)??"default",{value:P}=(0,K().fJ)(W().T.formulas),{value:I}=(0,K().fJ)(L().QV.automationTypecheck),{value:j}=(0,K().fJ)(L().QV.automationActionRegistry),R=(0,r().K8)((()=>{if(null!=k&&k.automation_id)return z().dn.createChildStore(c,{table:o(912720).yB,id:k.automation_id,spaceId:c.getSpaceId()})}),[c,k]),M=(0,o(76190).n)(R),_=(0,r().K8)((()=>null==C?void 0:C.settingsStore),[C]),N=(0,r().K8)((()=>{const e=g.currentUser.id;if(P&&I&&j&&C&&"button"===(null==k?void 0:k.type)&&k.automation_id&&i.isPageBlock()&&R)return{type:"button_property",persisted:!0,automationStore:R,collectionContextStore:C,propertyId:l,propertySchema:k,intl:V().A.getIntl(),parentRecordStore:R,currentUserId:e,pageStore:i,formulasModule:P,isLoggedIn:g.currentUser.isLoggedIn(),automationTypecheckModule:I,automationActionRegistryModule:j}}),[g.currentUser,P,I,j,C,k,i,R,l]),U=!(0,r().O$)(o(227440).e),{isDisabled:q,hasError:Q}=(0,r().K8)((()=>{if(U||!N)return{isDisabled:!0,hasError:!1};const e=(0,F().lp)({environment:g,isSubscribed:M,...N}).state,t="sufficient"===e.executionPermissionStatus;return{isDisabled:f||!t||!i.canEdit()||S,hasError:(0,E().O9)(e.typecheckResult)&&A().Q.isSuccess(e.typecheckResult)&&(0,o(352271).x4)(e.typecheckResult.value)}}),[g,f,N,i,S,M,U]),Y=(0,n.useCallback)((async()=>{if(N)if(Q)C&&_&&k&&o(837570).h({environment:g,mode:"edit_button_property",collectionSettingsStore:_,collectionContextStore:C,propertyId:l,propertySchema:k});else try{var e;b(!0);const{automationExecutionActions:t}=await L().QV.automations.load();await t.executeClientAutomation({environment:g,clientContext:N}),null!==(e=g.mobileNative)&&void 0!==e&&e.buzz?g.mobileNative.buzz():window.navigator.vibrate(20)}finally{b(!1)}}),[N,C,_,g,Q,l,k]),X=(0,r().K8)((()=>(null==N?void 0:N.automationStore.getNameStore().getValue())??(null==k?void 0:k.name)),[null==N?void 0:N.automationStore,null==k?void 0:k.name]),$=(0,r().K8)((()=>{if(!o(780054).A.isMobile)return(0,F().nD)(null==N?void 0:N.automationStore)}),[N]),J=!X||0===X.length,Z=(0,s().IS)((e=>({buttonStyle:{...x.buttonStyle,...d},buttonPressedStyle:x.buttonPressedStyle??{},buttonHoveredStyle:x.buttonHoveredStyle??{},innerButtonStyle:{pointerEvents:"auto",overflow:"hidden",height:"small"===w?20:24,paddingLeft:6,paddingRight:6,...u},innerButtonLabelStyle:{overflow:"hidden",textOverflow:"ellipsis",color:J?e.text.tertiary:void 0},buttonColors:(0,B().eA)("default",e)})),[x.buttonHoveredStyle,x.buttonPressedStyle,x.buttonStyle,d,u,J,w]),G=e=>(0,h.jsx)(D().A,{backgroundColor:Z.buttonColors.background,disabled:q,disabledFeedback:!0,hoveredBackgroundColor:Z.buttonColors.hoveredBackground,size:"sm",onClick:Y,pressedBackgroundColor:Z.buttonColors.pressedBackground,style:Z.innerButtonStyle,...e,children:(0,h.jsx)("span",{style:Z.innerButtonLabelStyle,children:J?(0,h.jsx)(T().sA,{...O().y.buttonPlaceholder}):X})});return(0,h.jsx)(p().P,{ref:t,style:Z.buttonStyle,hoveredStyle:Z.buttonHoveredStyle,pressedStyle:Z.buttonPressedStyle,editButtonClickProps:void 0,onContextMenu:m,tooltipHide:(0,E().O9)($),tooltipPropertyValue:U?(0,h.jsx)(T().sA,{...o(416726).AY.unavailableOfflineTooltip}):void 0,children:Q?(0,h.jsx)(H().A,{placement:o(962730).W.Right,renderTooltip:()=>(0,h.jsx)(L().Od,{content:(0,h.jsx)(T().sA,{...o(913687).A.buttonPropertyErrorTooltip}),subtitle:(0,h.jsx)(T().sA,{...O().y.clickToEdit})}),render:G}):$?(0,h.jsx)(L().Vp,{parentStore:i,urlToPreview:$,renderOrigin:G}):G()})}))),U=(0,n.forwardRef)((function(e,t){const o=(0,a().WS)(),n=oe(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).table.button},innerButtonStyle:{maxWidth:"100%"}})),[o]));return(0,h.jsx)(N,{...n})})),q=(0,n.forwardRef)((function(e,t){const o=(0,a().WS)(),n=oe(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).page.button}})),[o]));return(0,h.jsx)(N,{...n})})),Q=(0,n.forwardRef)((function(e,t){const o=(0,a().WS)(),n=oe(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).compact_page.button}})),[o]));return(0,h.jsx)(N,{...n})})),Y=(0,n.forwardRef)((function(e,t){const o=oe(e,t);return(0,h.jsx)(N,{...o})})),X=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,f().F)(t,e.collectionStore,e.property,"button"));return(0,h.jsx)(N,{...o})})),$=(0,n.forwardRef)((function(e,t){const o=(0,a().WS)(),n=oe(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).board.button}})),[o]));return(0,h.jsx)(N,{...n})})),J=(0,n.forwardRef)((function(e,t){const o=oe(e,t);return(0,h.jsx)(N,{...o})})),Z=(0,n.forwardRef)((function(e,t){const o=oe(e,t);return(0,h.jsx)(N,{...o})})),G=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,s().IS)((()=>({buttonStyle:{maxWidth:200}})),[]));return(0,h.jsx)(N,{...o})})),ee=(0,n.forwardRef)((function(e,t){const o=oe(e,t,(0,s().IS)((()=>({buttonStyle:{height:void 0}})),[]));return(0,h.jsx)(N,{...o})})),te=(0,n.forwardRef)((function(e,t){const o=oe(e,t);return(0,h.jsx)(N,{...o})}));function oe(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,innerButtonStyle:null==o?void 0:o.innerButtonStyle}}var ne=()=>o(443239),re=()=>o(299709),ie=()=>o(522986),le=()=>o(751156),ae=()=>o(414712),se=()=>o(355594);const ce=n.memo(n.forwardRef((function(e,t){const{store:o,property:i,enablePointerEventsForInteractiveTypes:c,editButtonClickProps:u,onClick:m,onContextMenu:f,buttonStyle:S,showLabel:b,disabled:g}=e,x=(0,a().v3)(),v=(0,r().K8)((()=>d().wu(o.getPropertyValue(i))),[i,o]),{baseStyles:C,propertySchema:k,format:w,collectionContextStore:P}=(0,n.useContext)(y().L8),I=de(o,i,g),j=k,R=(0,n.useCallback)((()=>{const e=o.getPropertyStore(i);e&&P&&(le().createAndCommit({userAction:"BlockPropertyValue.handleEditButtonClick",environment:x,canUndo:!0,perform:e=>{ie().qS({stores:[o],property:i,transaction:e})}}),(0,re().E)({environment:x,collectionContextStore:P,block_id:e.id,property:i,property_type:"checkbox",from:(0,l().zP)(w),isFromBulkActionsToolbar:!1})),m&&m()}),[P,x,w,m,i,o]),M=(0,s().IS)((()=>({buttonStyle:{...C.buttonStyle,...S},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C,S]);return(0,h.jsx)(p().P,{ref:t,onContextMenu:f,editButtonClickProps:u,style:M.buttonStyle,hoveredStyle:M.buttonHoveredStyle,pressedStyle:M.buttonPressedStyle,children:(0,h.jsx)(se().o,{propertyLabel:b?null==j?void 0:j.name:void 0,checked:v,enablePointerEventsForInteractiveTypes:c,onClick:R,disabled:I,store:o,property:i})})})));function de(e,t,o){return(0,r().K8)((()=>o||!e.canEdit()||(0,ne().u)(t)||e.isNonEditableState()),[o,t,e])}const ue=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=Ce(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).table.checkbox}})),[o]));return(0,h.jsx)(ce,{...n,showLabel:!1})})),pe=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=Ce(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).page.checkbox}})),[o]));return(0,h.jsx)(ce,{...n,showLabel:!1,collectionStore:e.collectionStore})})),ye=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=Ce(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).compact_page.checkbox}})),[o]));return(0,h.jsx)(ce,{...n,showLabel:!1})})),me=n.forwardRef((function(e,t){const o=Ce(e,t,(0,s().IS)((()=>({buttonStyle:{minWidth:"fit-content"}})),[]));return(0,h.jsx)(ce,{...o,showLabel:!1})})),fe=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=Ce(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).board.checkbox,width:"unset"}})),[o]));return(0,h.jsx)(ce,{...n,showLabel:!0})})),Se=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,h.jsx)(ce,{...o,showLabel:!0})})),he=n.forwardRef((function(e,t){const o=Ce(e,t,(0,s().IS)((()=>({buttonStyle:{width:"unset",minWidth:"unset"}})),[]));return(0,h.jsx)(ce,{...o,showLabel:!0})})),be=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,h.jsx)(ce,{...o,showLabel:!1})})),ge=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,h.jsx)(ce,{...o,showLabel:!1})})),xe=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,h.jsx)(ce,{...o,showLabel:!1})})),ve=n.forwardRef((function(e,t){const o=Ce(e,t);return(0,h.jsx)(ce,{...o,showLabel:!1})}));function Ce(e,t,o){const{store:n,disabled:r,collectionStore:i,property:l,enablePointerEventsForInteractiveTypes:a,onClick:s,onContextMenu:c}=e;return{ref:t,store:n,disabled:r,collectionStore:i,property:l,editButtonClickProps:(0,ae().QK)(e),enablePointerEventsForInteractiveTypes:a,onClick:s,onContextMenu:c,buttonStyle:null==o?void 0:o.buttonStyle}}var ke=()=>o(477660);const we={contactVisitButton:new(K().O2)("contactVisitButton",(()=>o.e(82970).then(o.bind(o,95164))))},Pe=(0,K()._h)(we.contactVisitButton,(e=>e.default));var Ie=()=>o(146962),je=()=>o(859118);const Re=n.memo(n.forwardRef((function(e,t){const{onContextMenu:i,editButtonClickProps:l,property:a,store:c,buttonStyle:d,EmptyComponent:u,quickActionButtons:m=[],showIfEmpty:f,width:b,disableLinkify:g,userExpandable:x}=e,{propertySchema:v,baseStyles:C}=(0,n.useContext)(y().L8),k=(0,ke().z)(v),w=(0,r().K8)((()=>c.getPropertyValue(a)),[a,c]),P=(0,r().K8)((()=>!(!k||"url"!==k.type)&&!k.show_full_url),[k]),I=(0,s().IS)((()=>({buttonStyle:{...C.buttonStyle,...d},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C.buttonHoveredStyle,C.buttonPressedStyle,C.buttonStyle,d]);return null!=w&&w.length||void 0!==u?(0,h.jsx)(p().P,{ref:t,editButtonClickProps:l,onContextMenu:i,style:I.buttonStyle,pressedStyle:I.buttonPressedStyle,hoveredStyle:I.buttonHoveredStyle,quickActionButtons:m,width:b,userExpandable:x,children:null!=w&&w.length||void 0===u?k?(0,h.jsx)(S().C,{children:(0,h.jsx)(o(768407).LE,{type:k.type,textValue:w,useShortenedUrl:P,disableLinkify:f||g,store:c,property:a})}):null:(0,h.jsx)(u,{})}):null}))),Me=n.forwardRef((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l}=(0,a().Y0)(),{shouldWrap:c}=(0,n.useContext)(y().L8),d=(0,n.useMemo)((()=>{if(!l)return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ie().k,{},"comment"),(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})}),[i,l,r,o]),p=(0,a().WS)(),f=ze(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:p}).table.text}})),[p]));return(0,h.jsx)(Re,{...f,EmptyComponent:je().rW,quickActionButtons:d,userExpandable:c})})),_e=n.forwardRef((function(e,t){const{store:o,property:r,format:i}=e,l=(0,a().WS)(),c=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:l}).page.text}})),[l]),d=(0,n.useMemo)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ie().k,{},"comment"),(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})),[i,r,o]),p=ze(e,t,c);return(0,h.jsx)(Re,{...p,EmptyComponent:je().ao,quickActionButtons:d})})),Te=n.forwardRef((function(e,t){const{store:o,property:r,format:i}=e,l=(0,a().WS)(),c=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:l}).compact_page.text}})),[l]),d=(0,n.useMemo)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ie().k,{},"comment"),(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy"),(0,h.jsx)(Pe,{},"visit")]})),[i,r,o]),p=ze(e,t,c);return(0,h.jsx)(Re,{...p,EmptyComponent:je().ao,quickActionButtons:d,disableLinkify:!0})})),Be=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=ze(e,t,(0,f().F)(t,e.collectionStore,e.property,"phone_number"));return(0,h.jsx)(Re,{...n,EmptyComponent:o?je().Jb:void 0})})),Ae=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=(0,a().WS)(),r=ze(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:n}).board.text}})),[n]));return(0,h.jsx)(Re,{...r,EmptyComponent:o?je().Jb:void 0})})),Ee=n.forwardRef((function(e,t){const o=ze(e,t);return(0,h.jsx)(Re,{...o})})),Le=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=ze(e,t);return(0,h.jsx)(Re,{...n,EmptyComponent:o?je().Jb:void 0})})),We=n.forwardRef((function(e,t){const o=ze(e,t);return(0,h.jsx)(Re,{...o})})),Fe=n.forwardRef((function(e,t){const o=ze(e,t);return(0,h.jsx)(Re,{...o})})),Ve=n.forwardRef((function(e,t){const o=ze(e,t);return(0,h.jsx)(Re,{...o})})),Ke=n.forwardRef((function(e,t){const o=ze(e,t);return(0,h.jsx)(Re,{...o,EmptyComponent:je().Fe,showIfEmpty:!0})}));function ze(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ae().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}var Oe=()=>o(712796),De=(o(581454),()=>o(191772));const He=new(K().O2)("FilePropertyModule",(async()=>await o.e(5938).then(o.bind(o,637360)))),Ne=(0,K()._h)(He,(e=>e.FilePropertyModule));var Ue=()=>o(3079),qe=()=>o(425497),Qe=()=>o(171722),Ye=()=>o(167677);const Xe=n.memo(n.forwardRef((function(e,t){const{store:i,EmptyComponent:l,onContextMenu:c,buttonStyle:u,selectableStyle:m,property:f,editButtonClickProps:S,quickActionButtons:b,width:g,shouldDisableLinks:x,shouldTruncateToSingleLine:v,shouldLockImageAspectRatio:C,userExpandable:k}=e,w=(0,a().v3)(),{baseStyles:P,collectionContextStore:I,canEdit:j}=(0,n.useContext)(y().L8),[R,M]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{M(i.clone())}),[i]);const _=(0,n.useCallback)((e=>{ie().ho({environment:w,blockPropertyValueOverlayStore:S.blockPropertyValueOverlayStore,store:i,property:f,format:S.format,uploadFiles:e.files,disableHorizontalEdgeScroll:S.disableHorizontalEdgeScroll,collectionContextStore:I})}),[I,S.blockPropertyValueOverlayStore,S.disableHorizontalEdgeScroll,S.format,w,f,i]),T=(0,r().K8)((()=>{const e=i.getPropertyValue(f);return d().pJ(e)}),[i,f]),B=(0,s().IS)((()=>{var e;return{buttonStyle:{...P.buttonStyle,...u},buttonPressedStyle:P.buttonPressedStyle??{},buttonHoveredStyle:P.buttonHoveredStyle??{},selectableStyle:{display:"inherit",borderRadius:null===(e=P.buttonStyle)||void 0===e?void 0:e.borderRadius,...m}}}),[P.buttonHoveredStyle,P.buttonPressedStyle,P.buttonStyle,u,m]),A=!T||0===T.length,E=A&&void 0!==l,L=!A;return R&&(E||L)?(0,h.jsx)(o(199896).Ay,{store:R,canNativeDropOnto:j,onNativeDrop:_,analyticsName:"file_property",shouldShowDropZone:j,style:B.selectableStyle,children:(0,h.jsxs)(p().P,{ref:t,onContextMenu:c,editButtonClickProps:S,style:B.buttonStyle,pressedStyle:B.buttonPressedStyle,hoveredStyle:B.buttonHoveredStyle,quickActionButtons:b,width:g,forceEnableButton:v,userExpandable:k,children:[E&&(0,h.jsx)(l,{}),L&&(0,h.jsx)($e,{store:i,links:T,property:f,shouldTruncateToSingleLine:v,shouldDisableLinks:x,shouldLockImageAspectRatio:C,tokenFormat:(0,qe().Ug)(null==P?void 0:P.tokenFormat)})]})}):null}))),$e=n.memo((function(e){let{store:t,links:n,property:r,shouldTruncateToSingleLine:i=!1,shouldDisableLinks:l=!1,shouldLockImageAspectRatio:a=!1,tokenFormat:c}=e;const d=i?3:void 0,u=(0,Qe().s)({propertyId:r,store:t}),p=Boolean(u),y=(0,s().IS)((e=>({wrapperStyle:{...p?{...(0,De().sQ)(e),padding:4,lineHeight:2,...!i&&{flexWrap:"wrap",display:"inline-flex"}}:{}},moreToken:{margin:0,flexShrink:0}})),[p,i]),m=d&&n.length>d?n.slice(0,d):n,f=m.length<n.length?n.length-m.length:0;return(0,h.jsxs)(Ye().h,{style:y.wrapperStyle,className:u,children:[m.map(((e,n)=>(0,h.jsx)(o(736433).X,{linkValue:e,store:t,shouldDisableLinks:l,shouldLockImageAspectRatio:a},e.url+n))),f>0&&(0,h.jsx)(o(317958).A,{count:f,format:c,style:y.moreToken,fixedHeight:!0,isCompact:!0})]})})),Je=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(y().L8),r=(0,a().WS)(),i=ct(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:r}).table.button,height:"100%"},selectableStyle:{width:"100%"}})),[r]));return(0,h.jsx)(Xe,{...i,EmptyComponent:je().rW,quickActionButtons:(0,h.jsx)(Ie().k,{},"comment"),userExpandable:o})})),Ze=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=ct(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).page.button,height:"100%"},selectableStyle:{width:"100%"}})),[o]));return(0,h.jsx)(Xe,{...n,EmptyComponent:je().ao,quickActionButtons:(0,h.jsx)(Ie().k,{},"comment")})})),Ge=n.forwardRef((function(e,t){const o=(0,a().WS)(),r=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).compact_page.button}})),[o]),i=(0,n.useMemo)((()=>(0,h.jsx)(Ie().k,{},"comment")),[]),l=ct(e,t,r);return(0,h.jsx)(Xe,{...l,EmptyComponent:je().ao,quickActionButtons:i,shouldDisableLinks:!0,shouldLockImageAspectRatio:!0,shouldTruncateToSingleLine:!0})})),et=n.forwardRef((function(e,t){const o=ct(e,t);return(0,h.jsx)(Xe,{...o,EmptyComponent:je().Fe,shouldDisableLinks:!0})})),tt=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=ct(e,t,(0,f().F)(t,e.collectionStore,e.property,"file"));return(0,h.jsx)(Xe,{...n,EmptyComponent:o?je().Jb:void 0})})),ot=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=(0,a().WS)(),r=ct(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:n}).board.button,width:"100%"},selectableStyle:{width:"100%"}})),[n]));return(0,h.jsx)(Xe,{...r,EmptyComponent:o?je().Jb:void 0})})),nt=n.forwardRef((function(e,t){const o=ct(e,t);return(0,h.jsx)(Xe,{...o})})),rt=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=ct(e,t);return(0,h.jsx)(Xe,{...n,EmptyComponent:o?je().Jb:void 0})})),it=n.forwardRef((function(e,t){const o=ct(e,t);return(0,h.jsx)(Xe,{...o})})),lt=n.forwardRef((function(e,t){const o=ct(e,t);return(0,h.jsx)(Xe,{...o})})),at=n.forwardRef((function(e,t){const o=ct(e,t);return(0,h.jsx)(Xe,{...o})})),st=n.forwardRef((function(e,t){return(0,h.jsx)(Ue().H,{...e,ref:t,children:(0,h.jsx)(Ne,{...e})})}));function ct(e,t,o){const{store:n,onContextMenu:r,property:i,width:l}=e;return{ref:t,store:n,property:i,editButtonClickProps:(0,ae().QK)(e),onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle,selectableStyle:null==o?void 0:o.selectableStyle,width:l}}o(16280),o(898992),o(354520);var dt=()=>o(852507),ut=()=>o(708685),pt=()=>o(597777),yt=()=>o(869190),mt=()=>o(416504),ft=()=>o(284371),St=()=>o(847743),ht=(o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),()=>o(496506)),bt=()=>o(247331),gt=()=>o(349835),xt=()=>o(319625),vt=()=>o(909470),Ct=()=>o(991114),kt=()=>o(792415),wt=()=>o(217429),Pt=()=>o(792071),It=()=>o(813690);function jt(e,t){let o=!1;return[t(Pt().b4_.fromMonomorphicFunctionUnsafe((t=>{const n=e.getRecordStore(e,t);return n.isReady()||(o=!0),n.getModel()}),It().xb.fromMonomorphicFunctionUnsafe((t=>{const n=e.getRecordStore(e,t);return n.isReady()||(o=!0),n.getValue()})))),o]}function Rt(e){const t=function(e){const{blockStore:t,collectionStore:o,propertyId:n}=e,{value:l}=(0,K().fJ)(W().T.formulas),a=(0,Ct().C)(),s=(0,T().tz)(),c=(0,i().Ks)(),[d,u]=(0,r().K8)((()=>{var e;return[t.getModel(),null===(e=o.getModel())||void 0===e?void 0:e.getVersion()]}),[t,o]);if(!l)return Mt;if((0,E().O9)(u)&&(0,E().O9)(d)){const e=l.getFormula2Thunk({blockModel:d,collectionVersion:u,propertyId:n});if(e)return e}const p=new(ht().ComputedStore)((()=>{var e;const r=o.getSchema(),i=null==r?void 0:r[n];if(!i||"formula"!==i.type||"v2"!==i.version)return;const d=null===(e=i.formula2)||void 0===e?void 0:e.code;if(!d)return{value:{type:"undefined"}};if(!t.isDefined())return bt().FORMULA_LOADING;const u=t.getModel(),p=kt().A.state.publicPageData,[y,m]=jt(t,(e=>l.evaluateCollectionFormula2WithoutCache({block:u,collectionFeatureGates:(0,vt().i)(),depth:0,formulaCode:d,formulaTimeoutTimestampMs:Date.now()+a,getRecordModel:e,intl:s,property:n,experimentService:wt().default,publicPageDataCollection:{id:null==p?void 0:p.collectionId,schema:null==p?void 0:p.collectionSchema},regExpCache:new Map,resultCache:new Map,formatDateCache:new Map,userTimeZone:(0,mt().P)(),visitedProperties:new Set})));if(m){const e=_t({collectionContextStore:c,blockId:t.id,propertyId:n,formulasModule:l});return e?{value:e}:bt().FORMULA_LOADING}return(0,E().O9)(y)?A().Q.isFail(y)?{type:y.error.type,error:y.error}:{value:y.value}:{error:{type:gt().uW.UnexpectedError,error:(0,xt().A)(void 0)}}}),{debugName:`formula2Evaluation${t.id}`,useDeepEqual:!0}),y=()=>p.getState();(0,E().O9)(u)&&(0,E().O9)(d)&&l.setFormula2Thunk({blockModel:d,collectionVersion:u,propertyId:n,thunkCallback:y});return y}(e);return(0,r().K8)((()=>{if(!St().Pe&&t)return t()}),[t],{debugName:`formula2Evaluation${e.blockStore.id}`,useDeepEqual:!0})}function Mt(){return bt().FORMULA_LOADING}function _t(e){const{collectionContextStore:t,blockId:o,propertyId:n,formulasModule:r}=e,i=null==t?void 0:t.resultSetStore.state.propertyResultCache;if(!(0,E().O9)(i))return;const l=r.getFormula2ResultCache({resultCache:i,blockId:o,property:n});return(0,E().O9)(l)?r.formulaValueToCollectionFormulaValue(l):void 0}var Tt=()=>o(710149);function Bt(e){const t=(0,s().IS)((t=>({shimmer:{width:"60%",marginTop:6,height:10,flexShrink:0,borderRadius:12,backgroundColor:t.lightDividerColor,...e.style}})),[e.style]);return(0,h.jsx)(Tt().A,{style:t.shimmer})}var At=()=>o(942504);var Et=()=>o(886578);const Lt=[gt().uW.MaxEvaluationTimeExceeded,gt().uW.DepthExceeded,gt().uW.CycleDetected];function Wt(e){const{blockStore:t,formula2Result:o,legacyFormulaResult:n,propertySchema:i}=e;return(0,r().K8)((()=>{if(!i)return[[],"empty"];var e,r;if("v2"!==i.version)return n?n===bt().FORMULA_LOADING?[[],"loading"]:[eo(n),(null===(e=i.formula)||void 0===e?void 0:e.result_type)??"text"]:[[],"empty"];if(void 0===o)return[[],"empty"];if(o===bt().FORMULA_LOADING)return[[],"loading"];if(A().Q.isFail(o))return r=o.error,Lt.includes(r.type)?[[{id:"error",type:"error",value:o.error}],"error"]:[[],"formula"];if(A().Q.isSuccess(o)){var l;const e=(0,Et().O)(o.value,t.getRecordModel,(0,mt().P)());return[e,(null===(l=e[0])||void 0===l?void 0:l.type)??"text"]}(0,E().HB)(o)}),[t,o,n,i])}const Ft=n.memo(n.forwardRef((function(e,t){var o,i;const{store:l,property:a,EmptyComponent:c,collectionStore:d,onContextMenu:u,editButtonClickProps:m,checkboxButtonStyle:f,textButtonStyle:b,quickActionButtons:g,checkboxShowLabel:x,userExpandable:v}=e,{baseStyles:C,propertySchema:k,format:w}=(0,n.useContext)(y().L8),P=k,I="v2"===(null==P?void 0:P.version)?null==P||null===(o=P.formula2)||void 0===o?void 0:o.result_type.type:null==P||null===(i=P.formula)||void 0===i?void 0:i.result_type,j=!0===e.numberRightAlign&&"number"===(0,ut().getFormulaPropertySchemaBaseResultType)(P),[R,M]=function(e){const{store:t,collectionStore:o,property:i,checkboxShowLabel:l,numberRightAlign:a}=e,{propertySchema:s,format:c,collectionSchemaStore:d}=(0,n.useContext)(y().L8),u=(0,r().O$)(d);!function(e){if(void 0===e||"formula"===e.type)return;throw new Error(`Expected a formula property schema, got ${e.type}`)}(s);const p=function(e){const{blockStore:t,collectionSchema:o,propertyId:n,propertySchema:i}=e,{value:l}=(0,K().fJ)(W().T.formulas),a=(0,Ct().C)(),s=(0,T().tz)();return(0,r().K8)((()=>{if(!i||"v2"===i.version)return;if(!l||!o||!t.isDefined())return bt().FORMULA_LOADING;const e=(0,vt().i)(),r=(0,mt().P)(),[c,d]=jt(t,(i=>l.evaluateFormulaProperty({block:t.getModel(),collectionRequestContext:{collectionFeatureGates:e,depth:0,experimentService:wt().default,formulaTimeoutTimestampMs:Date.now()+a,intl:s,regExpCache:new Map,resultCache:new Map,formatDateCache:new Map,userId:void 0,userTimeZone:r,visitedProperties:new Set},getRecordModel:i,property:n,schema:o})));return d?bt().FORMULA_LOADING:c}),[i,l,o,t,a,s,n],{debugName:`legacyFormulaEvaluation${t.id}`})}({blockStore:t,collectionSchema:u,propertyId:i,propertySchema:s}),m=Rt({blockStore:t,collectionStore:o,propertyId:i}),f=Wt({blockStore:t,formula2Result:m,legacyFormulaResult:p,propertySchema:s}),S="loading"===f[1],b=function(e){const{blockStore:t,checkboxShowLabel:o,format:n,formulaTokenData:i,numberRightAlign:l,propertyId:a,propertySchema:s}=e;return(0,r().K8)((()=>{const[e,r]=i;if("loading"===r)return(0,h.jsx)(Bt,{style:{justifyContent:l?"flex-end":void 0}});if(0===e.length)return null;const c=o&&"checkbox"===(0,ut().getFormulaPropertySchemaResultType)(s)&&1===e.length?null==s?void 0:s.name:void 0,d=!!s&&(0,At().GL)(r,s),u=1===e.length;return s&&(0,h.jsx)(At().Ye,{propertyType:r,rootPropertySchema:s,numberRightAlign:l,store:t,property_id:a,children:e.map(((o,r)=>(0,h.jsx)(At().yZ,{token:o,targetPropertySchema:s,blockStore:t,checkboxPropertyLabel:c,withComma:d&&r<e.length-1,numberRightAlign:l,shouldTruncate:u&&"compact_page"===n,disableLinks:"compact_page"===n},`${o.id}-${r}`)))})}),[i,o,s,l,t,a,n])}({blockStore:t,checkboxShowLabel:l,format:c,formulaTokenData:f,numberRightAlign:a,propertyId:i,propertySchema:s});return[b,S]}({checkboxShowLabel:Boolean(x),collectionStore:d,numberRightAlign:Boolean(j),property:a,store:l});!function(e){const{pageId:t,propertyId:o,isLoading:r}=e,{collectionContextStore:i}=(0,n.useContext)(y().L8);(0,dt().w)((()=>{var e;null==i||null===(e=i.propertyResultDurationTracker)||void 0===e||e.trackMount({pageId:t,propertyId:o,propertyType:"formula"})})),(0,n.useEffect)((()=>{if(!r){const e=performance.now();async function n(){var n;const r=await W().T.formulas.load();null==i||null===(n=i.propertyResultDurationTracker)||void 0===n||n.trackResult({pageId:t,propertyId:o,propertyType:"formula",endTime:e,context:{formula_property_cache_result_available:(0,E().O9)(_t({collectionContextStore:i,blockId:t,propertyId:o,formulasModule:r}))}})}n()}}),[i,r,t,o])}({pageId:l.id,propertyId:a,isLoading:M});const _=(0,s().IS)((e=>({buttonStyle:{...C.buttonStyle,..."checkbox"===I?f:{},..."number"===I||"date"===I||"text"===I?b:{}},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C.buttonHoveredStyle,C.buttonPressedStyle,C.buttonStyle,f,I,b]),B=(0,Qe().s)({propertyId:a,store:l});if(St().Pe)return(0,h.jsx)("div",{style:{padding:"5px 8px"},children:(0,h.jsx)(S().C,{fontColor:"light",children:(0,h.jsx)(T().sA,{defaultMessage:"Disabled",id:"database.pageProperty.disableFormulas"})})});const A=null===R;return A&&void 0===c?null:(0,h.jsxs)(p().P,{ref:t,className:B,onContextMenu:u,editButtonClickProps:m,style:_.buttonStyle,pressedStyle:_.buttonPressedStyle,hoveredStyle:_.buttonHoveredStyle,quickActionButtons:!M&&g?(0,h.jsx)(Vt,{buttons:g,store:l,collectionStore:d,property:a,format:w,isEmpty:A}):void 0,quickActionButtonsAlign:j?"left":void 0,userExpandable:v,children:[A&&c&&(0,h.jsx)(c,{}),!A&&R]})})));function Vt(e){const{buttons:t,store:o,property:n,format:r,isEmpty:i}=e;if(i)return null;const l=t.map((e=>{switch(e){case"copy":return(0,h.jsx)(u().i,{store:o,property:n,format:r},"copy");case"comment":return(0,h.jsx)(Ie().k,{},"comment");default:(0,E().HB)(e)}})).filter(E().Pe);return l?(0,h.jsx)(h.Fragment,{children:l}):null}const Kt=["comment","copy"],zt=n.forwardRef((function(e,t){const{isMobile:o,isPhone:r}=(0,a().Y0)(),{shouldWrap:i}=(0,n.useContext)(y().L8),l=Gt(e,t,(0,s().IS)((()=>{const e=(0,m()._Q)({isPhone:r});return{checkboxButtonStyle:{padding:e.table.checkbox},textButtonStyle:{padding:e.table.text}}}),[r]));return(0,h.jsx)(Ft,{...l,numberRightAlign:!0,EmptyComponent:je().rW,quickActionButtons:o?void 0:Kt,userExpandable:i})})),Ot=["comment","copy"],Dt=n.forwardRef((function(e,t){const{isPhone:o}=(0,a().Y0)(),n=Gt(e,t,(0,s().IS)((()=>{const e=(0,m()._Q)({isPhone:o});return{checkboxButtonStyle:{padding:e.page.checkbox},textButtonStyle:{padding:e.page.text}}}),[o]));return(0,h.jsx)(Ft,{...n,EmptyComponent:je().ao,quickActionButtons:Ot})})),Ht=["comment","copy"],Nt=n.forwardRef((function(e,t){const{isMobile:o,isPhone:n}=(0,a().Y0)(),r=Gt(e,t,(0,s().IS)((()=>{const e=(0,m()._Q)({isPhone:n});return{checkboxButtonStyle:{padding:e.compact_page.checkbox},textButtonStyle:{padding:e.compact_page.text,width:"100%",...ft().RC}}}),[n]));return(0,h.jsx)(Ft,{...r,EmptyComponent:je().ao,quickActionButtons:o?void 0:Ht})})),Ut=n.forwardRef((function(e,t){const o=Gt(e,t);return(0,h.jsx)(Ft,{...o,EmptyComponent:je().Fe})})),qt=n.forwardRef((function(e,t){const o=Gt(e,t,(0,f().F)(t,e.collectionStore,e.property,"formula"));return(0,h.jsx)(Ft,{...o})})),Qt=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=Gt(e,t,(0,s().IS)((()=>{const e=(0,m()._Q)({isPhone:o});return{checkboxButtonStyle:{padding:e.board.checkbox},textButtonStyle:{padding:e.board.text}}}),[o]));return(0,h.jsx)(Ft,{...n,checkboxShowLabel:!0})})),Yt=n.forwardRef((function(e,t){const o=Gt(e,t);return(0,h.jsx)(Ft,{...o,checkboxShowLabel:!0})})),Xt=n.forwardRef((function(e,t){const o=Gt(e,t);return(0,h.jsx)(Ft,{...o,checkboxShowLabel:!0})})),$t=n.forwardRef((function(e,t){const o=Gt(e,t);return(0,h.jsx)(Ft,{...o})})),Jt=n.forwardRef((function(e,t){const o=Gt(e,t);return(0,h.jsx)(Ft,{...o})})),Zt=n.forwardRef((function(e,t){const o=Gt(e,t);return(0,h.jsx)(Ft,{...o})}));function Gt(e,t,o){const{store:n,onContextMenu:r,property:i,collectionStore:l}=e;return{ref:t,store:n,property:i,collectionStore:l,editButtonClickProps:(0,ae().QK)(e),onContextMenu:r,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,textButtonStyle:null==o?void 0:o.textButtonStyle}}function eo(e){if(void 0===e)return[];if("string"==typeof e)return 0===e.length?[]:[{id:e,type:"text",value:[[e]]}];if("number"==typeof e)return[{id:e,type:"number",value:e}];if((0,pt().kC)(e)){return[{id:(0,yt().ZF)({allowRelativeDates:!1,value:e,userTimeZone:(0,mt().P)(),intl:V().A.getIntl()}),type:"date",value:e}]}if("boolean"==typeof e)return[{id:e,type:"checkbox",value:e}];(0,E().HB)(e)}var to=()=>o(584262),oo=()=>o(987555),no=()=>o(449552),ro=()=>o(234194),io=()=>o(906719),lo=()=>o(565049),ao=()=>o(921855),so=()=>o(108944),co=()=>o(898808),uo=()=>o(187820);const po=(0,T().YK)({shared:{defaultMessage:"Shared",id:"CollectionLocation.SidebarTitle.sectionShared"},private:{defaultMessage:"Private",id:"CollectionLocation.SidebarTitle.sectionPrivate"},noAccess:{defaultMessage:"No access",id:"CollectionLocation.noAccess"},emptyCollectionName:{id:"CollectionLocation.EmptyCollectionName",defaultMessage:"Untitled"}});function yo(e){return(0,h.jsx)("span",{style:{paddingTop:4,paddingLeft:4,...e.style},children:"/"})}function mo(e){const{collectionForLocationStore:t,collectionContextStore:o}=e,n=(0,T().tz)(),i=(0,r().K8)((()=>{const e=so().fU(t);return e.reverse(),e}),[t]),{collectionIsInPrivate:l,collectionIsInRestricted:a,collectionIsInShared:c}=(0,r().K8)((()=>{const e=o.groupsForTypedDatabasesStore.state;return{collectionIsInPrivate:Boolean(null==e?void 0:e.privateDatabases[t.id]),collectionIsInRestricted:Boolean(null==e?void 0:e.restrictedDatabases[t.id]),collectionIsInShared:Boolean(null==e?void 0:e.sharedDatabases[t.id])}}),[o.groupsForTypedDatabasesStore,t.id],{useDeepEqual:!0}),d=(0,r().K8)((()=>(0,B().O4)({theme:"light"})),[]),u=(0,s().IS)((e=>({textStyle:{color:d.popoverWaxPaperBackground,fontWeight:"normal"},shareTypeIndicatorIcon:{width:20,height:20,marginRight:2,color:e.icon.secondary,padding:2,backgroundColor:d.palette.gray[100],borderRadius:3}})),[d]),p=l||a||c;let y=null;return l?y=(0,h.jsxs)(h.Fragment,{children:[(0,no().g)(u.shareTypeIndicatorIcon),(0,h.jsx)("span",{children:n.formatMessage(po.private)})]}):a?y=(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{style:{...u.shareTypeIndicatorIcon,padding:0,paddingLeft:1,margin:0},children:(0,oo().T)({...u.shareTypeIndicatorIcon,margin:0,background:void 0})}),(0,h.jsx)("span",{children:n.formatMessage(po.noAccess)})]}):c&&(y=(0,h.jsxs)(h.Fragment,{children:[(0,ro().M)(u.shareTypeIndicatorIcon),(0,h.jsx)("span",{children:n.formatMessage(po.shared)})]})),(0,h.jsxs)("div",{style:{display:"flex"},children:[p&&(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:4,...u.textStyle},children:[y,!a&&(0,h.jsx)(yo,{style:{marginTop:-4,...u.textStyle}})]}),i.length>3?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(fo,{ancestorStore:i[0],showDivider:!0}),(0,h.jsx)("span",{style:{paddingLeft:2,paddingTop:4,...u.textStyle},children:"..."}),(0,h.jsx)(yo,{style:u.textStyle}),!(l||c)&&(0,h.jsx)(fo,{ancestorStore:i[i.length-2],showDivider:!0}),(0,h.jsx)(fo,{ancestorStore:i[i.length-1],showDivider:!1})]}):i.map(((e,t)=>(0,h.jsx)(fo,{ancestorStore:e,showDivider:t<i.length-1},e.id)))]})}function fo(e){const{ancestorStore:t,showDivider:o}=e,n=(0,r().K8)((()=>(0,B().O4)({theme:"light"})),[]),i=(0,s().IS)((e=>({teamIconStyle:{background:e.popoverWaxPaperBackground},textStyle:{color:n.popoverWaxPaperBackground,fontWeigth:"normal"}})),[n]);return t instanceof z().h4?(0,h.jsxs)("div",{style:{display:"flex"},children:[(0,h.jsx)(lo().A,{store:t,showDivider:!1,maxWidth:160,iconSize:16,iconStyle:i.teamIconStyle,titleStyle:i.textStyle,disabled:!1}),o&&(0,h.jsx)(yo,{style:i.textStyle})]}):(0,h.jsxs)("div",{style:{display:"flex"},children:[(0,h.jsx)(io().A,{store:t,showDivider:!1,emojiSize:18,maxWidth:160,titleStyle:i.textStyle,disabled:!1},t.id),o&&(0,h.jsx)(yo,{style:i.textStyle})]})}function So(e){const{teamStore:t,collectionStore:o}=e,n=(0,r().K8)((()=>o.getIcon()),[o]),i=(0,s().IS)((e=>({miniTeamSpaceIcon:{background:e.home.tile.background,position:"absolute",bottom:-3,right:-3,borderRadius:2},teamSpaceIcon:{borderRadius:2,marginRight:2}})),[]);return n?(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",position:"relative",marginRight:2},children:[(0,h.jsx)(uo().B6,{icon:n,size:20,emojiSize:20,isEmptyPage:!1,bucket:"public",isLarge:!0,largeIcon:!0,disabled:!0}),(0,h.jsx)(co().x,{store:t,disabled:!0,size:12,style:i.miniTeamSpaceIcon},"icon")]}):(0,h.jsx)(co().x,{store:t,disabled:!0,size:20,style:i.teamSpaceIcon},"icon")}const ho=function(e){const{collectionContextStore:t,collectionForLocationStore:n}=e,i=(0,a().v3)(),c=(0,T().tz)(),{collectionIsInPrivate:d,collectionIsInRestricted:u,collectionIsInShared:p}=(0,r().K8)((()=>{const e=t.groupsForTypedDatabasesStore.state;return{collectionIsInPrivate:Boolean(null==e?void 0:e.privateDatabases[n.id]),collectionIsInRestricted:Boolean(null==e?void 0:e.restrictedDatabases[n.id]),collectionIsInShared:Boolean(null==e?void 0:e.sharedDatabases[n.id])}}),[t.groupsForTypedDatabasesStore,n.id],{useDeepEqual:!0}),y=(0,r().K8)((()=>so().Uo(n)),[n]),m=(0,r().K8)((()=>(0,ao().r4)(n.getName(),n)??c.formatMessage(po.emptyCollectionName)),[n,c]),f=(0,r().K8)((()=>n.getIcon()),[n]),S=(0,r().K8)((()=>{var e;return null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id}),[t]),b=(0,r().K8)((()=>{let e=to().y8.LocationProperty;return S?((0,o(186445).sj)(S)&&(e=t.isInHomeWidgetStore.state?to().y8.PersonalHomeTileTasks:to().y8.PersonalHomePageTasks),e):e}),[S,t]),g=(0,s().IS)((e=>({button:{color:e.palette.gray[800],cursor:"pointer"},inner:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:4},shareTypeIndicatorIcon:{width:20,height:20,marginRight:2,color:e.icon.secondary,padding:2,backgroundColor:e.fill.lightGraySecondary,borderRadius:3},miniShareTypeIndicatorIcon:{position:"absolute",bottom:-3,right:-3,width:12,height:12,color:e.icon.secondary,backgroundColor:e.fill.grayPrimary,borderRadius:3,paddingTop:1,paddingBottom:1},collectionTitleTextStyle:{lineHeight:1,fontWeight:ft().Wy.medium,marginTop:2,marginLeft:2,whiteSpace:"nowrap",...(0,l().w_)(e)}})),[]);if(!(y||d||u||p))return null;const x=d||u||p;let v=(0,ro().M)(g.shareTypeIndicatorIcon);return f?v=(0,h.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",position:"relative"},children:[(0,h.jsx)(uo().B6,{icon:f,size:20,emojiSize:20,isEmptyPage:!1,bucket:"public",isLarge:!0,largeIcon:!0,disabled:!0}),d?(0,no().g)(g.miniShareTypeIndicatorIcon):(0,ro().M)(g.miniShareTypeIndicatorIcon)]}):u?v=(0,h.jsx)("div",{style:{...g.shareTypeIndicatorIcon,padding:0,paddingLeft:1,margin:0},children:(0,oo().T)({...g.shareTypeIndicatorIcon,margin:0,background:void 0})}):d&&(v=(0,no().g)(g.shareTypeIndicatorIcon)),(0,h.jsx)(o(704152).A,{hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},style:g.button,onClick:e=>{const t=n.getParentBlockStore();if(t){const n=(0,o(728611).Vr)(e);o(857783).uK({environment:i,store:t,pageVisitSource:b,openInNew:n})}},children:(0,h.jsxs)("div",{style:g.inner,children:[y&&(0,h.jsx)(So,{teamStore:y,collectionStore:n}),x&&v,(0,h.jsx)("div",{style:g.collectionTitleTextStyle,children:m})]})})},bo=n.memo(n.forwardRef((function(e,t){const{store:o,EmptyComponent:i,onContextMenu:l,buttonStyle:a}=e,{baseStyles:c,collectionContextStore:d}=(0,n.useContext)(y().L8),u=(0,r().K8)((()=>o.getAssociatedCollectionStore()),[o]),m=(0,s().IS)((()=>({buttonStyle:{...c.buttonStyle,minWidth:32,...a},buttonPressedStyle:c.buttonPressedStyle??{},buttonHoveredStyle:c.buttonHoveredStyle??{}})),[c.buttonHoveredStyle,c.buttonPressedStyle,c.buttonStyle,a]),f=!u||!d;return f&&void 0===i?null:(0,h.jsx)(p().P,{ref:t,onContextMenu:l,editButtonClickProps:void 0,style:m.buttonStyle,pressedStyle:m.buttonPressedStyle,hoveredStyle:m.buttonHoveredStyle,tooltipPropertyValue:(0,h.jsx)(mo,{collectionForLocationStore:u,collectionContextStore:d}),children:f&&void 0!==i?(0,h.jsx)(i,{}):(0,h.jsx)(ho,{collectionContextStore:d,collectionForLocationStore:u})})}))),go=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=_o(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).table.text}})),[o]));return(0,h.jsx)(bo,{...n,EmptyComponent:je().rW})})),xo=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=_o(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).page.text}})),[o]));return(0,h.jsx)(bo,{...n,EmptyComponent:je().ao})})),vo=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=_o(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).compact_page.text}})),[o]));return(0,h.jsx)(bo,{...n,EmptyComponent:je().ao})})),Co=n.forwardRef((function(e,t){const o=_o(e,t);return(0,h.jsx)(bo,{...o,EmptyComponent:je().Fe})})),ko=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=_o(e,t,(0,f().F)(t,e.collectionStore,e.property,"location"));return(0,h.jsx)(bo,{...n,EmptyComponent:o?je().Jb:void 0})})),wo=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=(0,a().WS)(),r=_o(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:n}).board.text}})),[n]));return(0,h.jsx)(bo,{...r,EmptyComponent:o?je().Jb:void 0})})),Po=n.forwardRef((function(e,t){const o=_o(e,t);return(0,h.jsx)(bo,{...o})})),Io=n.forwardRef((function(e,t){const{showIfEmpty:o}=e,n=_o(e,t);return(0,h.jsx)(bo,{...n,EmptyComponent:o?je().Jb:void 0})})),jo=n.forwardRef((function(e,t){const o=_o(e,t);return(0,h.jsx)(bo,{...o})})),Ro=n.forwardRef((function(e,t){const o=_o(e,t);return(0,h.jsx)(bo,{...o})})),Mo=n.forwardRef((function(e,t){const o=_o(e,t);return(0,h.jsx)(bo,{...o})}));function _o(e,t,o){const{store:n,onContextMenu:r}=e;return{ref:t,store:n,onContextMenu:r,buttonStyle:null==o?void 0:o.buttonStyle}}var To=()=>o(454155),Bo=()=>o(495930);const Ao=n.memo((0,n.forwardRef)((function(e,t){var o,i;const{store:a,buttonStyle:c,onContextMenu:u,editButtonClickProps:m,quickActionButtons:f,EmptyComponent:b,isRightAligned:g,property:x,width:v,userExpandable:C}=e,{baseStyles:k,propertySchema:w,shouldRenderTooltip:P}=(0,n.useContext)(y().L8),I=w,j=(0,r().K8)((()=>{const e=a.getPropertyValue(x);return d().Me(e)}),[x,a]),R=(0,l().lh)({numberValue:j,numberFormat:null==I?void 0:I.number_format,numberShowAs:null==I?void 0:I.show_as}),M=(0,s().IS)((()=>({buttonStyle:{...k.buttonStyle,...c},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,c]);if(void 0===j&&void 0===b)return null;const _="bar"===(null==I||null===(o=I.show_as)||void 0===o?void 0:o.type)||"ring"===(null==I||null===(i=I.show_as)||void 0===i?void 0:i.type);return(0,h.jsx)(p().P,{ref:t,style:M.buttonStyle,hoveredStyle:M.buttonHoveredStyle,pressedStyle:M.buttonPressedStyle,onContextMenu:u,editButtonClickProps:m,quickActionButtons:f,quickActionButtonsAlign:g?"left":void 0,tooltipPropertyValue:P?R:void 0,width:v,userExpandable:C,children:void 0===j&&void 0!==b?(0,h.jsx)(b,{}):_?(0,h.jsx)(Ye().h,{isRightAligned:g,children:(0,h.jsx)(Bo().E,{numberValue:j,isRightAligned:g,store:a,property:x})}):(0,h.jsx)(S().C,{isRightAligned:g,children:(0,h.jsx)(Bo().E,{numberValue:j,isRightAligned:g,store:a,property:x})})})}))),Eo=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=(0,a().WS)(),c=Uo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:l}).page.text}})),[l])),d=(0,n.useMemo)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ie().k,{},"comment"),(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})),[i,r,o]);return(0,h.jsx)(Ao,{...c,EmptyComponent:je().ao,quickActionButtons:d})})),Lo=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l,isPhone:c}=(0,a().Y0)(),{shouldWrap:d}=(0,n.useContext)(y().L8),p=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:c}).table.text}})),[c]),f=(0,n.useMemo)((()=>{if(!l)return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ie().k,{},"comment"),(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})}),[i,l,r,o]),S=Uo(e,t,p);return(0,h.jsx)(Ao,{...S,EmptyComponent:je().rW,quickActionButtons:f,isRightAligned:!0,userExpandable:d})})),Wo=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l,isPhone:c}=(0,a().Y0)(),d=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:c}).compact_page.text}})),[c]),p=(0,n.useMemo)((()=>{if(!l)return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ie().k,{},"comment"),(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})}),[i,l,r,o]),y=Uo(e,t,d);return(0,h.jsx)(Ao,{...y,EmptyComponent:je().ao,quickActionButtons:p})})),Fo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Uo(e,t,(0,f().F)(t,e.collectionStore,e.property,"number"));return(0,h.jsx)(Ao,{...n,EmptyComponent:o?je().Jb:void 0})})),Vo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,a().WS)(),r=Uo(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:n}).board.text}})),[n]));return(0,h.jsx)(Ao,{...r,EmptyComponent:o?je().Jb:void 0})})),Ko=(0,n.forwardRef)((function(e,t){const o=Uo(e,t);return(0,h.jsx)(Ao,{...o})})),zo=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Uo(e,t);return(0,h.jsx)(Ao,{...n,EmptyComponent:o?je().Jb:void 0})})),Oo=(0,n.forwardRef)((function(e,t){const o=Uo(e,t);return(0,h.jsx)(Ao,{...o})})),Do=(0,n.forwardRef)((function(e,t){const o=Uo(e,t);return(0,h.jsx)(Ao,{...o})})),Ho=(0,n.forwardRef)((function(e,t){const o=Uo(e,t);return(0,h.jsx)(Ao,{...o})})),No=(0,n.forwardRef)((function(e,t){const o=Uo(e,t);return(0,h.jsx)(Ao,{...o,EmptyComponent:je().Fe})}));function Uo(e,t,o){const{store:n,collectionStore:r,property:i,onContextMenu:l,width:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ae().QK)(e),onContextMenu:l,buttonStyle:null==o?void 0:o.buttonStyle,width:a}}var qo=()=>o(146445),Qo=()=>o(117886);const Yo=n.memo((0,n.forwardRef)(((e,t)=>{const{store:i,buttonStyle:l,onContextMenu:a,editButtonClickProps:c,quickActionButtons:d=[],EmptyComponent:u,property:m,width:f,linkifyUrls:b,disableLinks:g,userExpandable:x,clampLines:v,forceBlockPropertyButtonEnable:C=!1}=e,{baseStyles:k}=(0,n.useContext)(y().L8),w=(0,r().K8)((()=>i.getPropertyValue(m)),[m,i]),P=(0,s().IS)((()=>({buttonStyle:{...k.buttonStyle,...l},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,l]);if((null==w||!w.length)&&void 0===u)return null;const I=Boolean(v);return(0,h.jsx)(p().P,{ref:t,style:P.buttonStyle,hoveredStyle:P.buttonHoveredStyle,pressedStyle:P.buttonPressedStyle,onContextMenu:a,editButtonClickProps:c,quickActionButtons:d,forceEnableButton:C,width:f,userExpandable:x,children:null!=w&&w.length||void 0===u?(0,h.jsx)(S().C,{children:(0,h.jsx)(o(175120).m,{textValue:w,parentStore:i,linkifyUrls:b,disableLinks:g,shouldTruncate:I,clampLines:v})}):(0,h.jsx)(u,{})})}))),Xo=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=(0,a().WS)(),c=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:l}).page.text}})),[l]),d=(0,n.useMemo)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Qo().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,h.jsx)(Ie().k,{},"comment"),(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})),[i,r,o]),p=sn(e,t,c);return(0,h.jsx)(Yo,{...p,EmptyComponent:je().ao,quickActionButtons:d})})),$o=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l,isPhone:c}=(0,a().Y0)(),d=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:c}).table.text}})),[c]),p=(0,n.useMemo)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Qo().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,h.jsx)(Ie().k,{},"comment"),l?null:(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),y=sn(e,t,d);return(0,h.jsx)(Yo,{...y,EmptyComponent:je().rW,quickActionButtons:p,userExpandable:!0})})),Jo=n.forwardRef((function(e,t){const{propertyModule:n}=e;if(!n||n&&!(0,o(778781).NS)(n))throw new Error("PlacePropertyModule can only be used with place property modules");const i=(0,r().K8)((()=>(0,o(96330).e)(e.store.getPropertyValue(e.property))),[e.store,e.property]);return(0,h.jsxs)(Ue().H,{...e,ref:t,children:[(0,h.jsx)(Xo,{...e}),"map"===n.style&&i&&(0,h.jsx)(o(229793).Vt,{place:i})]})})),Zo=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l,isPhone:c}=(0,a().Y0)(),d=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:c}).compact_page.text,maxWidth:"300px"}})),[c]),p=(0,n.useMemo)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ie().k,{},"comment"),l?null:(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),y=sn(e,t,d);return(0,h.jsx)(Yo,{...y,EmptyComponent:je().ao,quickActionButtons:p,linkifyUrls:!1,disableLinks:!0})})),Go=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=sn(e,t,(0,f().F)(t,e.collectionStore,e.property,"text"));return(0,h.jsx)(Yo,{...n,EmptyComponent:o?je().Jb:void 0})})),en=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,a().WS)(),r=sn(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:n}).board.text}})),[n]));return(0,h.jsx)(Yo,{...r,EmptyComponent:o?je().Jb:void 0})})),tn=(0,n.forwardRef)((function(e,t){const o=sn(e,t);return(0,h.jsx)(Yo,{...o})})),on=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=sn(e,t);return(0,h.jsx)(Yo,{...n,EmptyComponent:o?je().Jb:void 0})})),nn=(0,n.forwardRef)((function(e,t){const o=sn(e,t);return(0,h.jsx)(Yo,{...o})})),rn=(0,n.forwardRef)((function(e,t){const o=sn(e,t);return(0,h.jsx)(Yo,{...o})})),ln=(0,n.forwardRef)((function(e,t){const o=sn(e,t);return(0,h.jsx)(Yo,{...o})})),an=(0,n.forwardRef)((function(e,t){const o=sn(e,t);return(0,h.jsx)(Yo,{...o,EmptyComponent:je().Fe})}));function sn(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,width:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,ae().QK)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,width:s}}var cn=()=>o(112217),dn=(o(944114),o(672577),o(803949),()=>o(787626)),un=()=>o(970013),pn=()=>o(568063),yn=()=>o(604995),mn=()=>o(450648),fn=()=>o(559653),Sn=()=>o(919709),hn=()=>o(496603),bn=()=>o(722372),gn=()=>o(173019),xn=()=>o(548218),vn=()=>o(454305),Cn=()=>o(963589),kn=()=>o(761529);const wn=(0,T().YK)({rollup:{defaultMessage:"Configure rollup",id:"database.editButton.configureRollupTooltip"}});function Pn(e){const{type:t,editButtonClickProps:o}=e,i=(0,a().v3)(),{isMobile:l}=(0,a().Y0)(),c=(0,Cn().X)("db_ux_mobile"),{containerRef:d,collectionContextStore:u,canEdit:p}=(0,n.useContext)(y().L8),m=(0,r().uB)(void 0,vn().A),f=(0,n.useMemo)((()=>V().A.formatMessage(wn[t])),[t]),S=(0,s().IS)((e=>({iconStyle:{color:e.text.secondary,fill:e.text.secondary},button:{height:20,width:20}})),[]),b=(0,n.useCallback)((async e=>{if(void 0===o)return;const{onClick:t,store:n,property:r,format:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:p}=o,y=d&&"current"in d&&(null==d?void 0:d.current)||void 0;await xn().V({element:y,environment:i,onClick:t,store:n,property:a.getMappedProperty(r),format:l,collectionStore:a,blockPropertyValueOverlayStore:s,disableHorizontalEdgeScroll:p,collectionContextStore:u,mouseStore:m,isDBUXMobileEnabled:c})}),[u,d,o,i,m,c]);return!p||l?null:(0,h.jsx)(kn().A,{icon:gn().r,tooltip:f,onClick:b,style:S.button,iconStyle:S.iconStyle})}const In=n.memo(n.forwardRef((function(e,t){const{store:i,property:l,EmptyComponent:c,collectionStore:u,onContextMenu:m,editButtonClickProps:f,checkboxButtonStyle:b,textButtonStyle:g,buttonButtonStyle:x,quickActionButtons:v,numberRightAlign:C,userExpandable:k}=e,{baseStyles:w,format:P,collectionSchemaStore:I}=(0,n.useContext)(y().L8),j=(0,r().O$)(I),R=(0,Ct().C)(),M=(0,n.useMemo)((()=>{if(!j)return;const e=j[l];if("person"===(null==e?void 0:e.rollup_type))return;const t=(0,pn().fS)({schema:j,property:l}),o=t.isValid&&"relation"===t.type?t.relationPropertySchema:void 0,n=o?un().Nv(o):void 0;return n?z().md.createChildStore(i,n):void 0}),[l,j,i]),_=(0,r().K8)((()=>{if(void 0!==j)return(0,pn().eY)({property:l,schema:j,preLoadedTargetCollectionModel:null==M?void 0:M.getModel(),getRecordModel:u.getRecordModel})}),[j,l,M,u.getRecordModel]),T=function(e){var t;const{schema:o,property:i,store:l,rollupPropertyData:a,numberRightAlign:s,clientFormulaTimeoutMs:c}=e,{value:d}=(0,K().fJ)(W().T.formulas),u=(0,r().K8)((()=>{const e=l.getModel(),{propertySchema:t,targetPropertySchema:n}=a??{};if(null==t||!t.aggregation||"show_unique"===t.aggregation||!e||!o)return{rollupAggregationValue:void 0,numberFormat:void 0,numberPrecision:void 0};const r=(0,pn().Pm)({block:e,property:i,schema:o,getRecordModel:l.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,mt().P)(),depth:0,intl:V().A.getIntl(),visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,formulaTimeoutTimestampMs:Date.now()+c,experimentService:wt().default,collectionFeatureGates:(0,vt().i)()},formulasModule:d});if(!r)return{rollupAggregationValue:void 0,numberFormat:void 0,numberPrecision:void 0};const s=(0,bn().o_)(t.aggregation,"formula"===(null==n?void 0:n.type)||"number"===(null==n?void 0:n.type)?n.number_format:void 0),u=(0,bn().zI)(t.aggregation,"formula"===(null==n?void 0:n.type)||"number"===(null==n?void 0:n.type)?n.number_precision:void 0);if(s){const e=void 0===(null==r?void 0:r.value)||null===(null==r?void 0:r.value)||"number"!=typeof r.value?void 0:Number(r.value);if(void 0!==e&&!isNaN(e))return{rollupAggregationValue:e,numberFormat:s,numberPrecision:u}}const p=(0,bn().Y9)({numberFormat:void 0,dateFormat:n&&"date_format"in n?n.date_format:void 0,aggregationType:t.aggregation,value:r,userTimeZone:(0,mt().P)(),numberPrecision:void 0});return void 0===p||""===p?{rollupAggregationValue:void 0,numberFormat:void 0}:{rollupAggregationValue:p,numberFormat:void 0}}),[l,a,o,i,d,c]),p=(0,n.useMemo)((()=>{const{rollupAggregationValue:e,numberFormat:t,numberPrecision:o}=u;if(void 0===e)return null;if(t){var n,r;return"bar"===(null==a||null===(n=a.propertySchema)||void 0===n||null===(n=n.show_as)||void 0===n?void 0:n.type)||"ring"===(null==a||null===(r=a.propertySchema)||void 0===r||null===(r=r.show_as)||void 0===r?void 0:r.type)?(0,h.jsx)(Ye().h,{isRightAligned:s,children:(0,h.jsx)(Bo().E,{numberFormatOverride:t,numberPrecisionOverride:o,numberValue:e,isRightAligned:s})}):(0,h.jsx)(S().C,{isRightAligned:s,children:(0,h.jsx)(Bo().E,{numberFormatOverride:t,numberPrecisionOverride:o,numberValue:e,isRightAligned:s})})}return(0,h.jsx)(S().C,{children:e})}),[s,null==a||null===(t=a.propertySchema)||void 0===t||null===(t=t.show_as)||void 0===t?void 0:t.type,u]);return p}({store:i,schema:j,property:l,rollupPropertyData:_,numberRightAlign:C,clientFormulaTimeoutMs:R}),B=function(e){const{store:t,rollupPropertyData:o,numberRightAlign:i,clientFormulaTimeoutMs:l,format:s,targetCollectionStore:c}=e,{value:u}=(0,K().fJ)(W().T.formulas),p=(0,a().v3)(),{propertySchema:y}=o||{},m=(0,r().K8)((()=>{if("relation"!==(null==o?void 0:o.rollupType)||!y||!o.relationPropertySchema||!o.targetCollectionModel)return[];const e=t.getModel();if(!e)return[];if(!y.relation_property)return[];return d().bG({relationValue:d().n(d().yQ(e,y.relation_property)),getRecordModel:t.getRecordModel,propertySchema:o.relationPropertySchema,includeNoAccess:!0}).map((e=>z().Bv.createChildStore(t,e))).filter((e=>{var t;return(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===o.targetCollectionModel.id}))}),[o,y,t]),f=(0,r().K8)((()=>{if(!o||!y)return[];const e=new Map,n=new Map,r=new Map;if("person"===o.rollupType){const e=t.getModel();if(!e)return[];const n=d().Y6({textValue:y.person_property?e.getProperty(y.person_property):void 0,propertySchema:o.personPropertySchema,blockCreatorPointer:Pt().Bj6.fromBlock(e).getCreatedByPointer()}),r=[];return n.forEach((e=>{const n=t.getRecordModel(e);if("notion_user"===(null==n?void 0:n.table)){let e;o.targetProperty===pn().zi?e=n.getEmail():o.targetProperty===pn().Ym&&(e=n.getFullName(V().A.getIntl())??n.getEmail()),e&&r.push({token:{id:e,type:"text",value:[[e]]},blockStore:null})}})),"show_unique"===y.aggregation?hn().hS(r,(e=>e.token.id)):r}if("relation"===o.rollupType&&c&&o.targetPropertySchema){const t=[];for(const i of m){const a=Rn({textValue:i.getPropertyValue(o.targetProperty),blockStore:i,targetCollectionStore:c,targetPropertySchema:o.targetPropertySchema,targetProperty:o.targetProperty,currentUserId:p.currentUser.id,clientFormulaTimeoutMs:l,resultCache:e,regExpCache:n,formatDateCache:r,formulasModule:u});for(const e of a)t.push({token:e,blockStore:i})}return"show_unique"===y.aggregation?hn().hS(t,(e=>e.token.id)):t}return[]}),[o,y,c,t,m,p.currentUser.id,l,u]);return(0,n.useMemo)((()=>{if(null==f||!f.length||!y)return null;const e=1===f.length,n=f[0].token.type,r=(0,At().GL)(n,y);return(0,h.jsx)(At().Ye,{propertyType:n,rootPropertySchema:y,numberRightAlign:i,children:f.map(((n,l)=>(0,h.jsx)(At().yZ,{token:n.token,targetPropertySchema:"relation"===(null==o?void 0:o.rollupType)?o.targetPropertySchema:void 0,blockStore:n.blockStore??t,withComma:r&&l<f.length-1,numberRightAlign:i,shouldTruncate:e&&"compact_page"===s,disableLinks:"compact_page"===s},`${n.token.id}-${l}`)))})}),[f,y,i,s,t,o])}({store:i,rollupPropertyData:_,numberRightAlign:C,clientFormulaTimeoutMs:R,targetCollectionStore:M,format:P}),A=!T&&!B;!function(e){const{store:t,property:o}=e,{format:r,collectionContextStore:i}=(0,n.useContext)(y().L8);(0,dt().w)((()=>{var e;"table"===r&&(null==i||null===(e=i.propertyResultDurationTracker)||void 0===e||e.trackMount({pageId:t.id,propertyId:o,propertyType:"rollup"}))})),(0,n.useEffect)((()=>{var e;"table"===r&&(null==i||null===(e=i.propertyResultDurationTracker)||void 0===e||e.trackResult({pageId:t.id,propertyId:o,propertyType:"rollup"}))}),[i,r,o,t])}({store:i,property:l});const E=(0,r().K8)((()=>{if(A||!_)return"text";const{targetPropertySchema:e,propertySchema:t}=_;return void 0!==(null==t?void 0:t.aggregation)&&"show_unique"!==t.aggregation?void 0!==(0,bn().o_)(t.aggregation,"number")?"number":"text":e?function(e){if(!e)return"text";if("formula"===e.type){if(e.formula2){const t=(0,o(977345).pg)(e.formula2.result_type).type;return"block"===t?"relation":"unknown"===t||"array"===t?"text":t}return"text"}return"rollup"===e.type?"text":e.type}(e):"text"}),[A,_]),L=(0,s().IS)((e=>({buttonStyle:{...w.buttonStyle,..."checkbox"===E?b:{},..."title"!==E&&(0,qe().YX)(E)?g:{},...(0,qe()._t)(E)?x:{}},buttonPressedStyle:w.buttonPressedStyle??{},buttonHoveredStyle:w.buttonHoveredStyle??{}})),[w.buttonHoveredStyle,w.buttonPressedStyle,w.buttonStyle,x,b,E,g]);if(A&&void 0===c)return null;const F=!0===C&&"number"===E;return(0,h.jsx)(p().P,{ref:t,onContextMenu:m,editButtonClickProps:f,style:L.buttonStyle,pressedStyle:L.buttonPressedStyle,hoveredStyle:L.buttonHoveredStyle,quickActionButtons:v?(0,h.jsx)(jn,{buttons:v,editButtonClickProps:f}):void 0,quickActionButtonsAlign:F?"left":void 0,userExpandable:k,children:A?c?(0,h.jsx)(c,{}):null:T??B})})));function jn(e){let{buttons:t,editButtonClickProps:o}=e;const n=t.map((e=>{if("edit"===e)return(0,h.jsx)(Pn,{type:"rollup",editButtonClickProps:o},e);(0,E().HB)(e)})).filter(E().Pe);return n?(0,h.jsx)(h.Fragment,{children:n}):null}function Rn(e){var t;const{textValue:o,blockStore:n,targetCollectionStore:r,targetPropertySchema:i,targetProperty:l,clientFormulaTimeoutMs:a,resultCache:s,regExpCache:u,formatDateCache:p,formulasModule:y}=e,{type:m}=i;switch(m){case"auto_increment_id":if(void 0===o)return[];const S=null===(t=r.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey(),h=(0,c().H4)(S,d().On(o));return h?[{id:h,type:"text",value:[[h]]}]:[];case"button":case"rollup":case"location":case"verification":case"place":return[];case"checkbox":{const e=d().wu(o);return[{id:e,type:"checkbox",value:e}]}case"date":{const e=(0,dn().b)(o);if(void 0===e)return[];return[{id:yt().ZF({allowRelativeDates:!1,value:e,userTimeZone:(0,mt().P)(),intl:V().A.getIntl()}),type:"date",value:e}]}case"email":case"phone_number":case"url":return void 0===o?[]:[{id:(0,Sn().k4p)(o),type:m,value:o}];case"file":return d().pJ(o).map((e=>({id:e.url,type:"file",value:e})));case"formula":{const e=n.getModel();if(void 0===e)return[];if(!y)return[];const t=V().A.getIntl(),o=(0,mt().P)();if("v2"===i.version){var f;if(null===(f=i.formula2)||void 0===f||!f.code)return[];const r=y.evaluateCollectionFormula2({block:e,property:l,formulaCode:i.formula2.code,getRecordModel:n.getRecordModel,intl:t,userTimeZone:o,depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+a,resultCache:s,regExpCache:u,formatDateCache:p,experimentService:wt().default,collectionFeatureGates:(0,vt().i)()});return r?(0,Et().O)(r,n.getRecordModel,o):[]}return eo(y.evaluateFormulaProperty({property:l,schema:n.getSchema(),block:e,getRecordModel:n.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:o,depth:0,intl:t,resultCache:s,regExpCache:u,formatDateCache:p,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+a,experimentService:wt().default,collectionFeatureGates:(0,vt().i)()}}))}case"select":{const e=d().L3(o,i.options??[]);if(!i.options||!e)return[];return[{id:e,type:"select",value:e,color:(0,d().FE)(i.options??[],e)}]}case"multi_select":return d().o2(o,i.options??[]).map((e=>({id:e,type:"select",value:e,color:(0,d().FE)(i.options??[],e)})));case"number":{const e=d().Me(o);return void 0===e?[]:[{id:e,type:"number",value:e}]}case"person":return d().Y6({textValue:o,propertySchema:i,blockCreatorPointer:n.getCreatedByPointer()}).map((e=>({id:e.id,type:"person",value:e})));case"title":if(void 0===r)return[];return[{id:(0,mn().r4)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,mt().P)(),intl:V().A.getIntl()}),type:"relation",value:{id:n.id,table:"block",spaceId:r.getSpaceId()}}];case"relation":if(void 0===r)return[];return d().bG({relationValue:d().n(o),getRecordModel:n.getRecordModel,propertySchema:i,includeNoAccess:!0}).map((e=>({id:e.id,type:"relation",value:e})));case"status":{const e=d().RZ(o,i),{options:t,groups:n}=i,r=null==t?void 0:t.find((t=>t.value===e));if(void 0===e||void 0===r)return[];const l=null==n?void 0:n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(r.id)}));return[{id:e,type:"select",value:e,color:r.color,groupColor:(null==l?void 0:l.color)??"default"}]}case"text":if(void 0===o)return[];const b=(0,mn().r4)({textValue:o,getRecordModel:n.getRecordModel,deterministic:!0,userTimeZone:(0,mt().P)(),intl:V().A.getIntl()});return 0===b.length?[]:[{id:b,type:"text",value:o}];case"created_by":const g=n.getCreatedByPointer();return g?[{id:g.id,type:"person",value:g}]:[];case"created_time":{const e=n.getCreatedTime();return[{id:e,type:"date",value:(0,yn().KQ)(e,(0,mt().P)())}]}case"last_edited_by":{const e=n.getLastEditedByPointer();return e?[{id:e.id,type:"person",value:e}]:[]}case"last_edited_time":{const e=n.getLastEditedTime();return[{id:e,type:"date",value:(0,yn().KQ)(e,(0,mt().P)())}]}case"last_visited_time":{const{currentUserId:t}=e;if(!t)return[];const o=(0,fn().$5)({parent_id:n.id,user_id:t}),r=z()._z.createChildStore(n,{table:fn().F9,id:o,spaceId:n.getSpaceId()}).getModel(),i=null==r?void 0:r.getVisitedAt();if(!i)return[];return[{id:i,type:"date",value:(0,yn().KQ)(i,(0,mt().P)())}]}default:(0,E().HB)(m)}}const Mn=n.forwardRef((function(e,t){const{shouldWrap:o}=(0,n.useContext)(y().L8),r=(0,a().WS)(),i=zn(e,t,(0,s().IS)((()=>{const e=(0,m()._Q)({isPhone:r});return{checkboxButtonStyle:{padding:e.table.checkbox},textButtonStyle:{padding:e.table.text},buttonButtonStyle:{padding:e.table.button}}}),[r]));return(0,h.jsx)(In,{...i,numberRightAlign:!0,EmptyComponent:je().rW,quickActionButtons:["edit"],userExpandable:o})})),_n=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=zn(e,t,(0,s().IS)((()=>{const e=(0,m()._Q)({isPhone:o});return{checkboxButtonStyle:{padding:e.page.checkbox},textButtonStyle:{padding:e.page.text},buttonButtonStyle:{padding:e.page.button}}}),[o]));return(0,h.jsx)(In,{...n,quickActionButtons:["edit"],EmptyComponent:je().ao})})),Tn=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=zn(e,t,(0,s().IS)((()=>{const e=(0,m()._Q)({isPhone:o});return{checkboxButtonStyle:{padding:e.compact_page.checkbox},textButtonStyle:{padding:e.compact_page.text},buttonButtonStyle:{padding:e.compact_page.button}}}),[o]));return(0,h.jsx)(In,{...n,EmptyComponent:je().ao})})),Bn=n.forwardRef((function(e,t){const o=zn(e,t);return(0,h.jsx)(In,{...o,EmptyComponent:je().Fe})})),An=n.forwardRef((function(e,t){const o=zn(e,t,(0,f().F)(t,e.collectionStore,e.property,"rollup"));return(0,h.jsx)(In,{...o})})),En=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=zn(e,t,(0,s().IS)((()=>{const e=(0,m()._Q)({isPhone:o});return{checkboxButtonStyle:{padding:e.board.checkbox},textButtonStyle:{padding:e.board.text},buttonButtonStyle:{padding:e.board.button}}}),[o]));return(0,h.jsx)(In,{...n})})),Ln=n.forwardRef((function(e,t){const o=zn(e,t);return(0,h.jsx)(In,{...o})})),Wn=n.forwardRef((function(e,t){const o=zn(e,t);return(0,h.jsx)(In,{...o})})),Fn=n.forwardRef((function(e,t){const o=zn(e,t);return(0,h.jsx)(In,{...o})})),Vn=n.forwardRef((function(e,t){const o=zn(e,t);return(0,h.jsx)(In,{...o})})),Kn=n.forwardRef((function(e,t){const o=zn(e,t);return(0,h.jsx)(In,{...o})}));function zn(e,t,o){const{store:n,onContextMenu:r,property:i,collectionStore:l}=e;return{ref:t,store:n,property:i,collectionStore:l,editButtonClickProps:(0,ae().QK)(e),onContextMenu:r,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,textButtonStyle:null==o?void 0:o.textButtonStyle,buttonButtonStyle:null==o?void 0:o.buttonButtonStyle}}const On=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To().jd,{...e,ref:t})})),Dn=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To().I8,{...e,ref:t})})),Hn=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To().S1,{...e,ref:t})})),Nn=(0,n.forwardRef)((function(e,t){const o=(0,f().F)(t,e.collectionStore,e.property,"multi_select"),n={...e,styles:o};return(0,h.jsx)(To().h3,{...n,ref:t})})),Un=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To().Dl,{...e,ref:t})})),qn=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To().V6,{...e,ref:t})})),Qn=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To().rw,{...e,ref:t})})),Yn=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To().ej,{...e,ref:t})})),Xn=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To().xV,{...e,ref:t})})),$n=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To().ER,{...e,ref:t})})),Jn=(0,n.forwardRef)((function(e,t){return(0,h.jsx)(To()._Z,{...e,ref:t})}));const Zn=n.memo(n.forwardRef((function(e,t){const{store:o,onContextMenu:i,property:l,disabled:a,enablePointerEventsForInteractiveTypes:c,editButtonClickProps:u,selectButtonStyle:m,checkboxButtonStyle:f,checkboxShowLabel:S,EmptyComponent:b,quickActionButtons:g,width:x,userExpandable:v}=e,{baseStyles:C,propertyFormat:k,propertySchema:w,shouldRenderTooltip:P}=(0,n.useContext)(y().L8),I=w,j=(0,qe().Ug)(null==C?void 0:C.tokenFormat),R=(0,r().K8)((()=>o.getPropertyValue(l)),[l,o]),M=(0,n.useMemo)((()=>I?d().RZ(R,I)??"":""),[R,I]),_=(null==k?void 0:k.statusShowAs)??"select",T=(0,s().IS)((()=>({buttonStyle:{...C.buttonStyle,..."select"===_?m:f},buttonPressedStyle:C.buttonPressedStyle??{},buttonHoveredStyle:C.buttonHoveredStyle??{}})),[C.buttonHoveredStyle,C.buttonPressedStyle,C.buttonStyle,m,f,_]);return M||void 0!==b?(0,h.jsx)(p().P,{ref:t,onContextMenu:i,editButtonClickProps:u,style:T.buttonStyle,pressedStyle:T.buttonPressedStyle,hoveredStyle:T.buttonHoveredStyle,tooltipPropertyValue:P&&"checkbox"===_?M:void 0,quickActionButtons:g,width:x,userExpandable:v,children:"checkbox"===_?(0,h.jsx)(er,{enablePointerEventsForInteractiveTypes:c,showLabel:S,propertyName:null==I?void 0:I.name,propertyValue:R,statusValue:M,editButtonClickProps:u,containerRef:t,store:o,property:l,disabled:a}):M||void 0===b?(0,h.jsx)(Gn,{statusValue:M,tokenFormat:j,store:o,property:l,propertySchema:I,parentHasTooltip:P}):(0,h.jsx)(b,{})}):null})));function Gn(e){const{statusValue:t,store:r,parentHasTooltip:i,property:l,propertySchema:a}=e,c=(0,s().DP)(),d=(0,o(358167).v)({blockId:null==r?void 0:r.id,propertyId:l}),u=(0,Qe().s)({propertyId:l,store:r}),p=Boolean(u),y=(0,s().IS)((()=>({container:{...p||d?{...(0,De().sQ)(c),paddingTop:3}:{},maxWidth:"fit-content"}})),[d,c,p]),{foundOption:m,foundGroup:f}=(0,n.useMemo)((()=>{const e=(null==a?void 0:a.options)??[],o=e.find((e=>e.value===t)),n=(null==a?void 0:a.groups)??[],r=o&&n.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(o.id)}));return{options:e,foundOption:o,foundGroup:r}}),[a,t]);return m?(0,h.jsx)(Ye().h,{style:y.container,className:u,children:(0,h.jsx)(o(997415).X,{type:"status",value:m.value,description:m.description,color:m.color,groupColor:null==f?void 0:f.color,shouldShowTooltip:!i})}):null}function er(e){const{propertyName:t,propertyValue:o,statusValue:r,showLabel:i,enablePointerEventsForInteractiveTypes:l,editButtonClickProps:s,containerRef:c,store:u,property:p,disabled:m}=e,f=(0,Cn().X)("db_ux_mobile"),S=(0,a().v3)(),{propertySchema:b,shouldRenderTooltip:g}=(0,n.useContext)(y().L8),x=b,v=de(u,p,m),C=(0,n.useMemo)((()=>!!x&&d().MC(o,x,V().A.getIntl())),[o,x]),k=(0,n.useCallback)((async e=>{await xn().V({...s,element:c&&"current"in c?(null==c?void 0:c.current)??void 0:void 0,environment:S,statusSetCheckbox:!e.altKey,isDBUXMobileEnabled:f})}),[c,s,S,f]);return(0,h.jsx)(se().o,{onClick:k,propertyLabel:i?t:void 0,checked:C,enablePointerEventsForInteractiveTypes:l,tooltip:g?void 0:r,disabled:v,store:u,property:p})}const tr=(0,n.forwardRef)((function(e,t){const{collectionStore:o}=e,r=(0,a().WS)(),{shouldWrap:i}=(0,n.useContext)(y().L8),l=pr(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:(0,m()._Q)({isPhone:r}).table.checkbox}})),[r]));return(0,h.jsx)(Zn,{...l,checkboxShowLabel:!1,EmptyComponent:je().rW,collectionStore:o,quickActionButtons:(0,h.jsx)(Ie().k,{},"comment"),userExpandable:i})})),or=(0,n.forwardRef)((function(e,t){const{collectionStore:o}=e,n=(0,a().WS)(),r=pr(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:(0,m()._Q)({isPhone:n}).page.checkbox}})),[n]));return(0,h.jsx)(Zn,{...r,checkboxShowLabel:!1,EmptyComponent:je().ao,collectionStore:o,quickActionButtons:(0,h.jsx)(Ie().k,{},"comment")})})),nr=(0,n.forwardRef)((function(e,t){const o=(0,a().WS)(),n=pr(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:(0,m()._Q)({isPhone:o}).compact_page.checkbox}})),[o]));return(0,h.jsx)(Zn,{...n,checkboxShowLabel:!1,EmptyComponent:je().ao,quickActionButtons:(0,h.jsx)(Ie().k,{},"comment")})})),rr=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=pr(e,t,(0,f().F)(t,e.collectionStore,e.property,"status"));return(0,h.jsx)(Zn,{...n,checkboxShowLabel:!1,EmptyComponent:o?je().Jb:void 0})})),ir=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,a().WS)(),r=pr(e,t,(0,s().IS)((()=>({checkboxButtonStyle:{padding:(0,m()._Q)({isPhone:n}).board.checkbox}})),[n]));return(0,h.jsx)(Zn,{...r,checkboxShowLabel:!0,EmptyComponent:o?je().Jb:void 0})})),lr=(0,n.forwardRef)((function(e,t){const o=pr(e,t);return(0,h.jsx)(Zn,{...o,checkboxShowLabel:!0})})),ar=(0,n.forwardRef)((function(e,t){const o=pr(e,t);return(0,h.jsx)(Zn,{...o,checkboxShowLabel:!0})})),sr=(0,n.forwardRef)((function(e,t){const o=pr(e,t);return(0,h.jsx)(Zn,{...o,checkboxShowLabel:!1})})),cr=(0,n.forwardRef)((function(e,t){const o=pr(e,t);return(0,h.jsx)(Zn,{...o,checkboxShowLabel:!1})})),dr=(0,n.forwardRef)((function(e,t){const o=pr(e,t);return(0,h.jsx)(Zn,{...o,checkboxShowLabel:!1})})),ur=(0,n.forwardRef)((function(e,t){const o=pr(e,t);return(0,h.jsx)(Zn,{...o,checkboxShowLabel:!1,EmptyComponent:je().Fe})}));function pr(e,t,o){const{store:r,disabled:i,property:l,onContextMenu:a,enablePointerEventsForInteractiveTypes:s,width:c}=e,{propertyFormat:d}=(0,n.useContext)(y().L8),u="checkbox"===(null==d?void 0:d.statusShowAs),p=(0,ae().QK)(e,{isStatusCheckbox:u});return{ref:t,store:r,disabled:i,property:l,selectButtonStyle:null==o?void 0:o.selectButtonStyle,checkboxButtonStyle:null==o?void 0:o.checkboxButtonStyle,editButtonClickProps:p,onContextMenu:a,enablePointerEventsForInteractiveTypes:s,width:c}}const yr=n.memo((0,n.forwardRef)(((e,t)=>{const{store:i,buttonStyle:l,onContextMenu:a,editButtonClickProps:c,quickActionButtons:d=[],EmptyComponent:u,property:m,width:f,linkifyUrls:b,disableLinks:g,userExpandable:x,clampLines:v,forceBlockPropertyButtonEnable:C=!1}=e,{baseStyles:k}=(0,n.useContext)(y().L8),w=(0,r().K8)((()=>i.getPropertyValue(m)),[m,i]),P=(0,s().IS)((()=>({buttonStyle:{...k.buttonStyle,...l},buttonPressedStyle:k.buttonPressedStyle??{},buttonHoveredStyle:k.buttonHoveredStyle??{}})),[k.buttonHoveredStyle,k.buttonPressedStyle,k.buttonStyle,l]);if((null==w||!w.length)&&void 0===u)return null;const I=Boolean(v);return(0,h.jsx)(p().P,{ref:t,style:P.buttonStyle,hoveredStyle:P.buttonHoveredStyle,pressedStyle:P.buttonPressedStyle,onContextMenu:a,editButtonClickProps:c,quickActionButtons:d,forceEnableButton:C,width:f,userExpandable:x,children:null!=w&&w.length||void 0===u?(0,h.jsx)(S().C,{children:(0,h.jsx)(o(178788).A,{textValue:w,parentStore:i,linkifyUrls:b,disableLinks:g,shouldTruncate:I,clampLines:v})}):(0,h.jsx)(u,{})})}))),mr=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,l=(0,a().WS)(),c=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:l}).page.text}})),[l]),d=(0,n.useMemo)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Qo().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,h.jsx)(Ie().k,{},"comment"),(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})),[i,r,o]),p=Pr(e,t,c);return(0,h.jsx)(yr,{...p,EmptyComponent:je().ao,quickActionButtons:d})})),fr=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l,isPhone:c}=(0,a().Y0)(),{shouldWrap:d}=(0,n.useContext)(y().L8),p=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:c}).table.text}})),[c]),f=(0,n.useMemo)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Qo().A,{store:o,property:r,openOverlay:!0},"autofill"),(0,h.jsx)(Ie().k,{},"comment"),l?void 0:(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),S=Pr(e,t,p);return(0,h.jsx)(yr,{...S,EmptyComponent:je().rW,quickActionButtons:f,userExpandable:d})})),Sr=(0,n.forwardRef)((function(e,t){const{store:o,property:r,format:i}=e,{isMobile:l,isPhone:c}=(0,a().Y0)(),d=(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:c}).compact_page.text,maxWidth:"300px"}})),[c]),p=(0,n.useMemo)((()=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Ie().k,{},"comment"),l?void 0:(0,h.jsx)(u().i,{store:o,property:r,format:i},"copy")]})),[i,l,r,o]),y=Pr(e,t,d);return(0,h.jsx)(yr,{...y,EmptyComponent:je().ao,quickActionButtons:p,linkifyUrls:!1,disableLinks:!0})})),hr=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Pr(e,t,(0,f().F)(t,e.collectionStore,e.property,"text"));return(0,h.jsx)(yr,{...n,EmptyComponent:o?je().Jb:void 0})})),br=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=(0,a().WS)(),r=Pr(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:n}).board.text}})),[n]));return(0,h.jsx)(yr,{...r,EmptyComponent:o?je().Jb:void 0})})),gr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,h.jsx)(yr,{...o})})),xr=(0,n.forwardRef)((function(e,t){const{showIfEmpty:o}=e,n=Pr(e,t);return(0,h.jsx)(yr,{...n,EmptyComponent:o?je().Jb:void 0})})),vr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,h.jsx)(yr,{...o})})),Cr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,h.jsx)(yr,{...o})})),kr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,h.jsx)(yr,{...o})})),wr=(0,n.forwardRef)((function(e,t){const o=Pr(e,t);return(0,h.jsx)(yr,{...o,EmptyComponent:je().Fe})}));function Pr(e,t,o){const{store:n,collectionStore:r,property:i,disabled:l,onContextMenu:a,width:s}=e;return{ref:t,store:n,collectionStore:r,property:i,disabled:l,editButtonClickProps:(0,ae().QK)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,width:s}}var Ir=()=>o(340498);function jr(e,t){(0,o(679924).v)(e,"click_block_property_url",t)}var Rr=()=>o(778417),Mr=()=>o(725614),_r=()=>o(819527),Tr=()=>o(476492),Br=()=>o(852353),Ar=()=>o(405417),Er=()=>o(97059),Lr=()=>o(945895),Wr=()=>o(735372);function Fr(e){const{store:t}=e,r=(0,a().v3)(),l=(0,i().Ks)(),c=(0,T().tz)(),d=(0,n.useCallback)((()=>{const e=t.getBlockTitleStore();(0,o(573451).C)({store:t}),Rr().hc({environment:r,store:t}),Mr().setSelectionAtEnd({store:e}),(0,o(739041).u)(r,"list_item_edit_mode_enter",{...(0,Tr().sl)(l),block_id:t.id,from:"click",view_type:"list"})}),[t,r,l]),u=(0,s().IS)((e=>({buttonStyle:{color:e.text.secondary,fill:e.text.secondary,height:20,width:26},iconStyle:{color:e.text.secondary,fill:e.text.secondary}})),[]),p=c.formatMessage({id:"collectionViewItem.edit.tooltip",defaultMessage:"Edit"});return(0,h.jsx)(H().A,{renderTooltip:()=>p,render:e=>(0,h.jsx)(o(285790).A,{icon:gn().r,ariaLabel:p,onClick:d,hasBackground:!0,showShadow:!1,style:u.buttonStyle,iconStyle:u.iconStyle,...e})})}var Vr=()=>o(402014),Kr=()=>o(435009),zr=()=>o(519839);const Or=(0,T().YK)({openAsPageTitle:{defaultMessage:"Open",id:"database.actionButton.openAsPageTitle"}});function Dr(e){const{store:t,handleOpenPeekPage:c,showLabel:d,showIcon:u}=e,p=(0,a().v3)(),y=(0,i().Ks)(),{peekModeProps:m}=(0,r().K8)((()=>{const e=void 0!==y?zr().hH(y):"full_page";return{peekModeProps:(0,l().lA)(e,!1)}}),[y],{useDeepEqual:!0}),f=(0,n.useCallback)((()=>(0,o(492414).Ef)({environment:p,updates:{store:t,fullyQualified:!1,pageVisitSource:to().y8.LinkInPage}})),[p,t]),S=(0,n.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=o(765957).default.state;return zr().wy({environment:p,store:t,mainEditorCurrentBlockStore:e,collectionContextStore:y,fullyQualified:!1})}),[p,y,t]),b=(0,n.useCallback)((e=>{if(e.metaKey||e.ctrlKey)Kr().oo({environment:p,url:f(),openInNew:"tab"});else{const e=S();if(!e)return;null==c||c(),Kr().oo({environment:p,url:e})}}),[p,S,f,c]),g=(0,n.useCallback)((e=>{1===e.button&&Kr().oo({environment:p,url:f(),openInNew:"tab"})}),[p,f]),x=(0,n.useCallback)((e=>{(0,Vr().SQ)({event:e,context:Vr().y$.EditorMouseDown,callback:()=>{e.preventDefault()}})}),[]),v=(0,s().IS)((e=>({buttonStyle:{color:e.text.secondary,fill:e.text.secondary,fontFamily:ft().Tf.sans,...!d&&{width:26},background:e.whiteButtonBackground,border:void 0,fontSize:12,fontWeight:ft().Wy.medium,textTransform:"uppercase",letterSpacing:.5,borderRadius:4,height:20,display:"flex",paddingLeft:4,paddingRight:4},buttonHoveredStyle:{background:e.whiteButtonHoveredBackground},buttonPressedStyle:{background:e.whiteButtonPressedBackground},iconStyle:{width:Ir().Ev.default,height:Ir().Ev.default,color:e.text.secondary,fill:e.text.secondary}})),[d]),C=(0,n.useCallback)((()=>m.tooltip),[m.tooltip]),k=(0,n.useCallback)((e=>(0,h.jsx)("div",{onAuxClick:g,onMouseDown:x,role:"button",tabIndex:0,children:(0,h.jsx)(D().A,{onClick:b,iconLeading:u?m.icon:void 0,ariaLabel:m.tooltip,size:"sm",style:v.buttonStyle,iconStyle:v.iconStyle,hoveredStyle:v.buttonHoveredStyle,pressedStyle:v.buttonPressedStyle,...e,children:d?V().A.formatMessage(Or.openAsPageTitle):void 0})})),[g,b,x,m.icon,m.tooltip,u,d,v.buttonHoveredStyle,v.buttonPressedStyle,v.buttonStyle,v.iconStyle]);return(0,h.jsx)(H().A,{renderTooltip:C,render:k})}const Hr=(0,T().YK)({untitledBlock:{defaultMessage:"Untitled",id:"collectionViewItemTitle.untitledBlock"},typeAName:{defaultMessage:"Type a name",id:"collectionViewItemTitle.itemName.placeholder"},pageWithContentTooltip:{defaultMessage:"This {type} has content",id:"collectionViewItemTitle.pageWithContentTooltip"}}),Nr=new Set(["table"]),Ur=n.memo((0,n.forwardRef)((function(e,t){const{buttonStyle:i,canEdit:c,collectionStore:d,commentsIndicatorStyle:u,editButtonClickProps:m,forceMouseEntered:f,format:S,iconActionFrom:b,iconSize:g,linkifyText:x,onContextMenu:v,onTab:C,onUntab:k,property:w,quickActionButtons:P,quickActionButtonsStyle:I,recordIconStyle:j,showIcon:R,store:M,textStyle:_,titlePropertyType:B,userExpandable:A,width:L}=e,W=(0,a().v3)(),{isMobile:F}=(0,a().Y0)(),K=(0,T().tz)(),z=(0,s().DP)(),O=(0,Cn().X)("db_ux_chrome"),{baseStyles:D,collectionContextStore:N,propertySchema:U}=(0,n.useContext)(y().L8),q=(0,r().K8)((()=>{if("inlineEditable"===B)return(0,Br().yT)(M)}),[M,B],{useDeepEqual:!0}),{collectionViewBlockId:Q,collectionViewId:Y,collectionUri:X}=(0,r().K8)((()=>{var e,t,o;return{collectionViewId:null==N||null===(e=N.collectionViewStore())||void 0===e?void 0:e.id,collectionViewBlockId:null==N||null===(t=N.collectionViewBlockStore())||void 0===t?void 0:t.id,collectionUri:null==N||null===(o=N.collectionStore())||void 0===o?void 0:o.getFormat().app_config_uri}}),[N]),$=(0,r().K8)((()=>{if("inlineEditable"!==B)return;const e=Lr().A.state;return Boolean(e.isActive&&e.store.id===M.id)}),[M.id,B]),{icon:J,iconStore:Z,isEmptyPage:G,recordTable:ee,blockType:te,hasError:oe}=(0,r().K8)((()=>{const e=M.getIconStore();return{icon:M.getIcon(),iconStore:e,isEmptyPage:M.isEmptyPage(),recordTable:null==e?void 0:e.table,blockType:M.getType(),hasError:M.hasError()}}),[M],{useDeepEqual:!0}),ne=(0,r().K8)((()=>(0,uo().Te)(M)),[M]),ie=!J&&!G,ae=(0,un().cP)(w),se=(0,r().K8)((()=>{if(!ae)return x?l().UY({store:M,propertySchema:(0,ke().z)(U),property:w}):void 0;const e=M.getFormatStore().getKeyStore("uri").getValue(),t=e&&o(939768).Jf({str:e,allowNoProtocol:!1});return t&&(0,o(493208).e)(t,M.pointer.spaceId)}),[ae,M,x,U,w]),ce=(0,n.useCallback)((()=>{if(N&&ae){const e=(0,Tr().sl)(N)||{};jr(W,{...e,block_id:M.id,property:w,from:l().zP(S),is_external_title_property_id:!0})}}),[N,W,S,w,M.id,ae]),de=(0,n.useCallback)((e=>{Z&&le().createAndCommit({userAction:"TitleProperty.handleRecordIconChange",environment:W,canUndo:!0,perform:t=>{o(246826).KY({store:Z,value:e,transaction:t})}})}),[W,Z]),ue=(0,n.useCallback)((e=>{"Enter"!==(null==e?void 0:e.key)&&(N&&(0,re().E)({environment:W,collectionContextStore:N,block_id:M.id,property:"title",property_type:"text",from:"list"}),(0,o(714574).P)({store:M}))}),[W,M,N]),pe=(0,n.useCallback)((e=>{e.target.scrollLeft=0}),[]),ye=(0,n.useCallback)((()=>{Lr().A.setState({isActive:!1}),Mr().clear({environment:W}),Rr().Lt({environment:W,store:M})}),[M,W]),me=(0,r().K8)((()=>{if(N){const e=N.searchQueryStore.state;return e.length>0?e:void 0}}),[N]),fe=(0,r().K8)((()=>Wr().qu.state??me),[me]),Se=(0,n.useMemo)((()=>({type:"page_property_value_match",collectionViewBlockId:Q,collectionViewId:Y,propertyId:"title"})),[Q,Y]),he=(0,r().K8)((()=>{const e=Wr().wb.state;return(0,o(792540).wc)(e)&&e.id===M.id?e:void 0}),[M.id]),be=(0,s().IS)((()=>{const e=O&&Nr.has(S);return{textStyle:{...D.textStyle,display:"inline",fontWeight:ft().Wy.medium,..._,marginRight:F?3:5},buttonStyle:{...D.buttonStyle,...i},quickActionButtonsStyle:{...I},buttonPressedStyle:{...D.buttonPressedStyle,background:"none"},buttonHoveredStyle:{...D.buttonHoveredStyle,background:"none"},recordIconStyle:{display:"inline-flex",verticalAlign:"text-top",...j},pageIconStyle:{fill:z.text.tertiary},link:{display:"inline"},subitemCountIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},parentItemIndicator:{display:"inline-flex",alignItems:"center",verticalAlign:"text-top"},discussionIndicator:{display:"inline-flex",alignItems:"center",color:z.text.tertiary,fontSize:12,fontWeight:ft().Wy.medium,verticalAlign:"text-top"},errorIcon:{display:"inline-block",verticalAlign:"text-top",marginLeft:1,marginRight:7,paddingBottom:4,width:Ir().Ev.sm,fill:z.palette.orange[500]},content:e?{display:"flex",alignItems:"flex-start",gap:F?4:1}:{display:"contents"},iconContainer:e?{flexShrink:0}:{display:"contents"},restContainer:e?{flexGrow:1,minWidth:0}:{display:"contents"}}}),[O,S,D.textStyle,D.buttonStyle,D.buttonPressedStyle,D.buttonHoveredStyle,_,F,i,I,j,z.text.tertiary,z.palette.orange]),ge=(0,r().K8)((()=>{var e,t;switch(B){case"inlineEditable":const n=$?V().A.formatMessage(Hr.typeAName):(null===(e=M.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:M.getRecordModel,intl:K,userTimeZone:(0,mt().P)(),isWorkflowsContainerWithCreationEnabled:(0,o(46986).yt)()}))||K.formatMessage(Hr.untitledBlock);return(0,h.jsx)(o(524702).A,{store:q,disabled:!$,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,disableShiftEnter:!0,onEnter:ye,onEsc:ye,onTab:C,onUntab:k,onChange:ue,onBlur:pe,placeholder:n,style:be.textStyle,disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:Se});case"hidePlaceholderText":let r=null===(t=M.getTitleStore())||void 0===t?void 0:t.getValue();M.isType("external_object_instance_page")&&(r=M.getPropertyValue(w)),fe&&fe.length>0&&r&&(r=ao().nu({textValue:r,blockId:M.id,textProps:Se,find:fe,currentFocusedResult:he}));const i=ao().S5({environment:W,textValue:r&&{value:r,spaceId:(0,o(161479).e)(M.pointer.spaceId)},parentStore:M,disableHover:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!0,disabled:!0,theme:z,emojiType:(0,o(712030).FN)(W),katex:W.KatexStore.getKatex(),formulaValueTypes:[]});return(0,h.jsx)("span",{style:be.textStyle,children:i});case"showPlaceholderAsTitle":return(0,h.jsx)(o(16006).A,{style:be.textStyle,store:M});default:(0,E().HB)(B)}}),[B,$,M,K,q,ye,C,k,ue,pe,be.textStyle,Se,fe,W,z,w,he],{silenceRerenderDefender:!0}),xe=(0,n.useMemo)((()=>({collection_id:d.id,recordTable:ee,source:b,block_type:te})),[d.id,ee,b,te]),ve=(0,n.useMemo)((()=>"never"!==R&&("withContent"!==R||void 0!==J||!G)),[R,J,G]),Ce=(0,r().K8)((()=>N&&(0,Ar().xC)({collectionContextStore:N,blockStore:M})),[N,M]),we=(0,r().K8)((()=>N&&(0,Ar().Kk)({collectionContextStore:N,blockStore:M})),[N,M]),Pe=(0,n.useMemo)((()=>{if(oe)return(0,o(175882).exclamationMarkTriangleSmallIcon)(be.errorIcon);if(!ve)return null;let e;return e=c?(0,h.jsx)(uo().B6,{disabled:!1,icon:J,iconRecordCategory:ne,isEmptyPage:G,size:g,style:be.recordIconStyle,pageIconStyle:be.pageIconStyle,store:M,bucket:"secure",onChange:de,iconLoggingData:xe,isInCollectionView:O}):(0,h.jsx)(uo().B6,{disabled:!0,icon:J,iconRecordCategory:ne,isEmptyPage:G,size:g,style:be.recordIconStyle,pageIconStyle:be.pageIconStyle,isInCollectionView:O}),ie&&O?(0,h.jsx)(H().A,{renderTooltip:()=>K.formatMessage(Hr.pageWithContentTooltip,{type:(0,o(895876).$O)(X)}),render:t=>(0,h.jsx)("div",{...t,children:e})}):e}),[M,oe,ve,c,J,ne,G,g,be.recordIconStyle,be.errorIcon,be.pageIconStyle,de,xe,K,X,ie,O]);return(0,h.jsx)(p().P,{ref:t,editButtonClickProps:m,onContextMenu:v,style:be.buttonStyle,pressedStyle:be.buttonPressedStyle,hoveredStyle:be.buttonHoveredStyle,quickActionButtons:P,quickActionButtonsStyle:be.quickActionButtonsStyle,quickActionButtonsForceVisible:F?void 0:f,tooltipHide:!0,userExpandable:A,children:(0,h.jsxs)("div",{style:be.content,children:[(0,h.jsx)("div",{style:be.iconContainer,children:Pe}),(0,h.jsxs)("div",{style:be.restContainer,children:[!$&&se?(0,h.jsx)(o(758740).A,{href:se,external:ae,onClick:ce,style:be.link,children:ge}):ge,void 0!==N&&Ce?(0,h.jsx)("span",{style:be.parentItemIndicator,children:(0,h.jsx)(o(743147).n,{blockStore:M,collectionContextStore:N,columnWidth:L})}):null,void 0!==N&&we?(0,h.jsx)("span",{style:be.subitemCountIndicator,children:(0,h.jsx)(o(164124).W,{blockStore:M,collectionContextStore:N})}):null,(0,h.jsx)(o(932210).g,{store:M,iconStyle:be.discussionIndicator,buttonStyle:u})]})]})})}))),qr=(0,n.forwardRef)((function(e,t){const{store:o,handleOpenPeekPage:i,width:c}=e,d=(0,Cn().X)("db_ux_chrome"),u=(0,a().v3)(),{isMobile:p,isPhone:f}=(0,a().Y0)(),{collectionContextStore:S,canEdit:b,shouldWrap:g}=(0,n.useContext)(y().L8),x=(0,r().K8)((()=>(0,Er().W)(u,o.id)),[u,o]),v=(0,s().IS)((e=>({buttonStyle:{padding:(0,m()._Q)({isPhone:f}).table.text},textStyle:d?{}:{...l().w_(e)},recordIconStyle:{height:22,width:22,margin:"-2px 3px 0px -2px"},dbCommentButton:{position:"relative",top:2,marginTop:-2.8}})),[d,f]),C=(0,r().K8)((()=>(null==S?void 0:S.shouldShowPageIcon())??!0),[S]),k=(0,n.useMemo)((()=>x?void 0:(0,h.jsx)(Dr,{handleOpenPeekPage:i,store:o,showLabel:p||void 0===c||c>100,showIcon:!p})),[i,p,o,c,x]),w=Xr(e,t,v);return(0,h.jsx)(Ur,{...w,iconActionFrom:"collection_table_view",showIcon:C?"always":"never",iconSize:20,titlePropertyType:"hidePlaceholderText",quickActionButtons:k,linkifyText:!b,commentsIndicatorStyle:v.dbCommentButton,userExpandable:g,canEdit:b})})),Qr=(0,n.forwardRef)((function(e,t){const{store:i}=e,{isPhone:l,isMobile:c}=(0,a().Y0)(),d=(0,a().v3)(),{canEdit:u,collectionContextStore:p}=(0,n.useContext)(y().L8),m=(0,r().K8)((()=>{const e=Lr().A.state;return Boolean(e.isActive&&e.store.id===i.id)}),[i]),S=(0,r().K8)((()=>!!p&&p.isInHomeWidgetStore.state),[p]),b=(0,r().K8)((()=>(0,Er().W)(d,i.id)),[d,i]),g=(0,r().K8)((()=>(null==p?void 0:p.shouldShowPageIcon())??!0),[p]),x=(0,n.useMemo)((()=>!c&&!b&&(u&&!m?(0,h.jsx)(Fr,{store:i}):(0,h.jsx)(Dr,{store:i,showLabel:!1,showIcon:!0}))),[m,c,u,i,b]),v=(0,s().IS)((()=>({buttonStyle:{marginLeft:0,marginRight:0,paddingLeft:S?o(665579).VQ/2:void 0,flexGrow:1,flexShrink:1,flexBasis:"auto",maxWidth:void 0,minWidth:l?void 0:f().X},textStyle:{fontSize:S?14:16,whiteSpace:m?"pre":"nowrap",pointerEvents:m?void 0:"none",cursor:m?"text":void 0,width:"auto",textOverflow:m?void 0:"ellipsis"},recordIconStyle:{marginRight:_r().mA},actionButton:{marginLeft:10,marginRight:1,order:3}})),[m,S,l]),C=Xr(e,t,v);return(0,h.jsx)(Ur,{...C,iconActionFrom:"collection_list_view",showIcon:g?"always":"never",iconSize:S?16:_r().kG,editButtonClickProps:void 0,quickActionButtonsStyle:v.actionButton,quickActionButtons:x,titlePropertyType:"inlineEditable",canEdit:u})})),Yr=(0,n.forwardRef)((function(e,t){o(857639).log({level:"error",from:"BlockPropertyValue",type:"BlockPropertyValue.InvalidTitlePropertyFormat"});const r=Xr(e,t),{canEdit:i}=(0,n.useContext)(y().L8);return(0,h.jsx)(Ur,{...r,iconActionFrom:"collection_table_view",showIcon:"always",iconSize:20,titlePropertyType:"hidePlaceholderText",canEdit:i})}));function Xr(e,t,o){const{collectionStore:n,disabled:r,forceMouseEntered:i,format:l,onContextMenu:a,onTab:s,onUntab:c,property:d,store:u,width:p}=e;return{ref:t,store:u,collectionStore:n,property:d,disabled:r,editButtonClickProps:(0,ae().QK)(e),onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle,textStyle:null==o?void 0:o.textStyle,recordIconStyle:null==o?void 0:o.recordIconStyle,quickActionButtonsStyle:null==o?void 0:o.quickActionButtonsStyle,format:l,onTab:s,onUntab:c,forceMouseEntered:i,width:p}}var $r=()=>o(931075),Jr=()=>o(310442),Zr=()=>o(824862),Gr=()=>o(798880),ei=()=>o(53528),ti=()=>o(427636),oi=()=>o(994006);function ni(e){const{isMobile:t}=(0,a().Y0)();return(0,h.jsx)("div",{style:t?{padding:"12px 20px",fontSize:14}:{fontSize:12,display:"flex",alignItems:"center"},children:(0,h.jsx)(ri,{...e})})}function ri(e){const{verificationState:t,blockStore:o}=e,n=(0,T().tz)();switch(t.type){case"none":return null;case"verified":return t.isIndefinite?(0,h.jsx)(T().sA,{defaultMessage:"Verified by {user} on {date}",id:"VerificationSummary.verifiedIndefinitely",values:{user:(0,h.jsx)(ii,{actorPointer:t.actorPointer,blockStore:o}),date:(0,ei().OH)({dateTime:t.startDateTime,intl:n})}}):(0,h.jsx)(T().sA,{defaultMessage:"Verified by {user} from {dateTimeRange}",id:"VerificationSummary.verified",values:{user:(0,h.jsx)(ii,{actorPointer:t.actorPointer,blockStore:o}),dateTimeRange:(0,ei().do)({luxonRange:t.dateTimeRange,intl:n})}});case"expired":return(0,h.jsx)(T().sA,{defaultMessage:"Last verified by {user} from {dateTimeRange}",id:"VerificationSummary.verificationExpired",values:{user:(0,h.jsx)(ii,{actorPointer:t.actorPointer,blockStore:o}),dateTimeRange:(0,ei().do)({luxonRange:t.dateTimeRange,intl:n})}});default:(0,E().HB)(t)}}function ii(e){const{actorPointer:t,blockStore:o}=e,n=(0,r().K8)((()=>z().sk.createChildStore(o,t)),[o,t]),i={display:"flex",marginLeft:4,marginRight:4};return n.table===Gr().oo?(0,h.jsx)(oi().A,{userStore:n,inline:!0,style:i,avatarSize:16,avatarMarginRight:4}):n.table===Zr().GP?(0,h.jsx)(ti().A,{botStore:n,style:i,avatarSize:16}):n.table===Jr().yj?(0,h.jsx)(oi().A,{userStore:void 0,inline:!0,style:i,avatarSize:16,avatarMarginRight:4}):void(0,E().HB)(n)}const li=n.memo(n.forwardRef((function(e,t){var i;const{property:l,store:a,collectionStore:c,buttonStyle:d,editButtonClickProps:u,EmptyComponent:m}=e,{canEdit:f,propertySchema:S,baseStyles:b,collectionSchemaStore:g}=(0,n.useContext)(y().L8),x=S,v=(0,r().K8)((()=>{const e=g.getState();return!(!x||!e)&&Br().E5(x,a,e)}),[x,g,a]),C=(0,r().K8)((()=>{var e;if(c.isPageTreeCollection())return!0;const t=null==a||null===(e=a.getSpaceStore())||void 0===e?void 0:e.getModel();return!!t&&(0,$r().Xi)(t)}),[c,a]),k=!f||!v||!C,w=(0,s().IS)((e=>({buttonStyle:{...b.buttonStyle,...d,cursor:k?"text":"pointer"},buttonPressedStyle:b.buttonPressedStyle??{},buttonHoveredStyle:b.buttonHoveredStyle??{}})),[b.buttonHoveredStyle,b.buttonPressedStyle,b.buttonStyle,d,k]),P=(0,r().K8)((()=>{const e=a.getPropertyValue(l);return(0,$r().U1)(e)}),[l,a]),I=(0,n.useMemo)((()=>(0,$r().B2)(P)),[P]),j=(0,n.useMemo)((()=>{if("none"!==I.type)return(0,h.jsx)(ni,{verificationState:I,blockStore:a})}),[a,I]),R=(0,r().K8)((()=>{var e;const t=!v||!C,o=g.getState();if(!t||!o)return;if(!C)return(0,h.jsx)(T().sA,{defaultMessage:"Upgrade plan to edit verification",id:"VerificationPropertyButton.tooltip.nonWikiVerificationRestrictedToBusinessTier"});const n=null==x?void 0:x.verifier_property,r=n?null===(e=o[n])||void 0===e?void 0:e.name:void 0;return(0,h.jsx)(ai,{verifierPropertyName:r})}),[v,g,C,null==x?void 0:x.verifier_property]),M="none"===I.type;return M&&void 0===m?null:(0,h.jsx)(p().P,{ref:t,editButtonClickProps:k?void 0:u,style:w.buttonStyle,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,tooltipPropertyValue:j,tooltipPropertyCaption:R,children:M&&void 0!==m?(0,h.jsx)(m,{}):(0,h.jsx)(o(880298).r,{verificationValue:P,fontSize:null===(i=b.buttonStyle)||void 0===i?void 0:i.fontSize})})})));function ai(e){const{verifierPropertyName:t}=e;return t?(0,h.jsx)(T().sA,{defaultMessage:"Only people listed in {verifierPropertyName} can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToVerifier",values:{verifierPropertyName:(0,h.jsx)("span",{style:{fontWeight:ft().Wy.bold},children:t})}}):(0,h.jsx)(T().sA,{defaultMessage:"Only page owners can verify this page",id:"VerificationPropertyButton.tooltip.editRestrictedToOwner"})}const si=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=gi(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).table.text}})),[o]));return(0,h.jsx)(li,{...n,EmptyComponent:je().rW})})),ci=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=gi(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).page.text}})),[o]));return(0,h.jsx)(li,{...n,EmptyComponent:je().ao})})),di=n.forwardRef((function(e,t){const o=(0,a().WS)(),n=gi(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:o}).compact_page.text}})),[o]));return(0,h.jsx)(li,{...n,EmptyComponent:je().ao})})),ui=n.forwardRef((function(e,t){const o=gi(e,t);return(0,h.jsx)(li,{...o,EmptyComponent:je().Fe})})),pi=n.forwardRef((function(e,t){const{collectionStore:o,store:i,showIfEmpty:l}=e,{propertySchema:a}=(0,n.useContext)(y().L8),s=a,c=(0,r().K8)((()=>o.getSchema()),[o]),d=(0,r().K8)((()=>!!s&&Br().E5(s,i,c)),[s,c,i]),u=gi(e,t,(0,f().F)(t,e.collectionStore,e.property,"verification"));return(0,h.jsx)(li,{...u,EmptyComponent:l&&d?je().Jb:void 0})})),yi=n.forwardRef((function(e,t){const{collectionStore:o,store:i,showIfEmpty:l}=e,{propertySchema:c}=(0,n.useContext)(y().L8),d=c,u=(0,r().K8)((()=>o.getSchema()),[o]),p=(0,r().K8)((()=>!!d&&Br().E5(d,i,u)),[d,u,i]),f=(0,a().WS)(),S=gi(e,t,(0,s().IS)((()=>({buttonStyle:{padding:(0,m()._Q)({isPhone:f}).board.text}})),[f]));return(0,h.jsx)(li,{...S,EmptyComponent:l&&p?je().Jb:void 0})})),mi=n.forwardRef((function(e,t){const o=gi(e,t);return(0,h.jsx)(li,{...o})})),fi=n.forwardRef((function(e,t){const o=gi(e,t);return(0,h.jsx)(li,{...o})})),Si=n.forwardRef((function(e,t){const o=gi(e,t);return(0,h.jsx)(li,{...o})})),hi=n.forwardRef((function(e,t){const o=gi(e,t);return(0,h.jsx)(li,{...o})})),bi=n.forwardRef((function(e,t){const o=gi(e,t);return(0,h.jsx)(li,{...o})}));function gi(e,t,o){const{store:n,collectionStore:r,property:i,onClick:l,onContextMenu:a}=e;return{ref:t,store:n,collectionStore:r,property:i,editButtonClickProps:(0,ae().QK)(e),onClick:l,onContextMenu:a,buttonStyle:null==o?void 0:o.buttonStyle}}const xi=n.memo(n.forwardRef((function(e,t){const{property:o,format:n,propertyType:r,innerProps:i}=e;if(!r)return null;const l=vi[n][r];return l?(0,h.jsx)(l,{ref:t,...i,property:o,format:n}):null}))),vi={table:{checkbox:ue,created_by:qo().JJ,created_time:Oe().wW,date:Oe().wW,email:Me,file:Je,formula:zt,last_edited_by:qo().JJ,last_edited_time:Oe().wW,last_visited_time:Oe().wW,location:go,multi_select:To().jd,number:Lo,person:qo().JJ,phone_number:Me,relation:cn().Kr,rollup:Mn,select:On,status:tr,text:fr,title:qr,url:Me,verification:si,auto_increment_id:x,button:U,place:$o},board:{checkbox:fe,created_by:qo().p$,created_time:Oe().Gx,date:Oe().Gx,email:Ae,file:ot,formula:Qt,last_edited_by:qo().p$,last_edited_time:Oe().Gx,last_visited_time:Oe().Gx,location:wo,multi_select:To().Dl,number:Vo,person:qo().p$,phone_number:Ae,relation:cn().QE,rollup:En,select:Un,status:ir,text:br,title:Yr,url:Ae,verification:yi,auto_increment_id:w,button:$,place:en},calendar:{checkbox:Se,created_by:qo().Jd,created_time:Oe().y9,date:Oe().y9,email:Ee,file:nt,formula:Yt,last_edited_by:qo().Jd,last_edited_time:Oe().y9,last_visited_time:Oe().y9,location:Po,multi_select:To().V6,number:Ko,person:qo().Jd,phone_number:Ee,relation:cn().eH,rollup:Ln,select:qn,status:lr,text:gr,title:Yr,url:Ee,verification:mi,auto_increment_id:P,button:J,place:tn},list:{checkbox:me,created_by:qo().VW,created_time:Oe().g$,date:Oe().g$,email:Be,file:tt,formula:qt,last_edited_by:qo().VW,last_edited_time:Oe().g$,last_visited_time:Oe().g$,location:ko,multi_select:To().h3,number:Fo,person:qo().VW,phone_number:Be,relation:cn().eM,rollup:An,select:Nn,status:rr,text:hr,title:Qr,url:Be,verification:pi,auto_increment_id:k,button:X,place:Go},gallery:{checkbox:he,created_by:qo().bZ,created_time:Oe().UP,date:Oe().UP,email:Le,file:rt,formula:Xt,last_edited_by:qo().bZ,last_edited_time:Oe().UP,last_visited_time:Oe().UP,location:Io,multi_select:To().rw,number:zo,person:qo().bZ,phone_number:Le,relation:cn().iM,rollup:Wn,select:Qn,status:ar,text:xr,title:Yr,url:Le,verification:fi,auto_increment_id:I,button:Z,place:on},timeline:{checkbox:be,created_by:qo().cE,created_time:Oe().vy,date:Oe().vy,email:We,file:it,formula:$t,last_edited_by:qo().cE,last_edited_time:Oe().vy,last_visited_time:Oe().vy,location:jo,multi_select:To().ej,number:Oo,person:qo().cE,phone_number:We,relation:cn().DE,rollup:Fn,select:Yn,status:sr,text:vr,title:Yr,url:We,verification:Si,auto_increment_id:j,button:G,place:nn},page:{checkbox:pe,created_by:qo().e7,created_time:Oe().zI,date:Oe().zI,email:_e,file:Ze,formula:Dt,last_edited_by:qo().e7,last_edited_time:Oe().zI,last_visited_time:Oe().zI,location:xo,multi_select:To().I8,number:Eo,person:qo().e7,phone_number:_e,relation:cn().hF,rollup:_n,select:Dn,status:or,text:mr,title:Yr,url:_e,verification:ci,auto_increment_id:g,button:q,place:Xo},compact_page:{checkbox:ye,created_by:qo()._R,created_time:Oe().v,date:Oe().v,email:Te,file:Ge,formula:Nt,last_edited_by:qo()._R,last_edited_time:Oe().v,last_visited_time:Oe().v,location:vo,multi_select:To().S1,number:Wo,person:qo()._R,phone_number:Te,relation:cn().$s,rollup:Tn,select:Hn,status:nr,text:Sr,title:Yr,url:Te,verification:di,auto_increment_id:v,button:Q,place:Zo},relation:{checkbox:ge,created_by:qo().L$,created_time:Oe().Qz,date:Oe().Qz,email:Fe,file:lt,formula:Jt,last_edited_by:qo().L$,last_edited_time:Oe().Qz,last_visited_time:Oe().Qz,location:Ro,multi_select:To().xV,number:Do,person:qo().L$,phone_number:Fe,relation:cn().I5,rollup:Vn,select:Xn,status:cr,text:Cr,title:Yr,url:Fe,verification:hi,auto_increment_id:R,button:ee,place:rn},relation_section:{checkbox:xe,created_by:qo().K2,created_time:Oe().RM,date:Oe().RM,email:Ve,file:at,formula:Zt,last_edited_by:qo().K2,last_edited_time:Oe().RM,last_visited_time:Oe().RM,location:Mo,multi_select:To().ER,number:Ho,person:qo().K2,phone_number:Ve,relation:cn().$$,rollup:Kn,select:$n,status:dr,text:kr,title:Yr,url:Ve,verification:bi,auto_increment_id:M,button:te,place:ln},mini:{checkbox:ve,created_by:qo().K1,created_time:Oe().BP,date:Oe().BP,email:Ke,file:et,formula:Ut,last_edited_by:qo().K1,last_edited_time:Oe().BP,last_visited_time:Oe().BP,location:Co,multi_select:To()._Z,number:No,person:qo().K1,phone_number:Ke,relation:cn().F1,rollup:Bn,select:Jn,status:ur,text:wr,title:Yr,url:Ke,verification:ui,auto_increment_id:C,button:Y,place:an},property_module:{checkbox:pe,created_by:qo().oN,created_time:Oe().zI,date:Oe().zI,email:_e,file:st,formula:Dt,last_edited_by:qo().oN,last_edited_time:Oe().zI,last_visited_time:Oe().zI,location:xo,multi_select:To().I8,number:Eo,person:qo().oN,phone_number:_e,relation:cn().bn,rollup:_n,select:Dn,status:or,text:mr,title:Yr,url:_e,verification:ci,auto_increment_id:g,button:q,place:Jo},feed:{checkbox:me,created_by:qo().VW,created_time:Oe().g$,date:Oe().g$,email:Be,file:tt,formula:qt,last_edited_by:qo().VW,last_edited_time:Oe().g$,last_visited_time:Oe().g$,location:ko,multi_select:To().h3,number:Fo,person:qo().VW,phone_number:Be,relation:cn().eM,rollup:An,select:Nn,status:rr,text:hr,title:Qr,url:Be,verification:pi,auto_increment_id:k,button:X,place:Go}},Ci=n.memo((function(e){const{property:t,collectionStore:a,format:s,formDataStore:c,onTab:d,onUntab:u,onEnter:p,onEsc:m,onBgClick:f,onOpenProperty:S,store:b}=e,g=(0,o(761408).y)({collectionStore:a,property:t}),x=function(e,t,o){const n=(0,i().Ks)();return(0,r().K8)((()=>{var r;const i=e.getSchema();return(null==t||null===(r=t.getFormState())||void 0===r||null===(r=r.collectionSchema)||void 0===r?void 0:r[o])??i[o]??(null==n?void 0:n.normalizedSchemaStore.state[o])}),[n,t,e,o],{debugName:"usePropertySchema",useDeepEqual:!0})}(a,c,g),v=(0,n.useContext)(o(789550).R),C=(0,n.useRef)(null);return(0,o(790748).b)(o(57618).A,(()=>({getNode:()=>{const{current:e}=C;return e?"getNode"in e?e.getNode():e:null},props:{onTab:d,onUntab:u,onEnter:p,onEsc:m,onBgClick:f,onOpenProperty:S,property:g,format:s,store:b},getScrollerContext:()=>v})),[v,d,u,p,m,f,S,g,s,b]),null!=x&&x.type?(0,h.jsx)(y().qN,{innerProps:e,property:g,unmappedProperty:t,propertySchema:x,containerRef:C,children:(0,l().NN)(s)?(0,h.jsx)(o(595465).T,{ref:C,innerProps:e,format:s,property:g,propertyType:null==x?void 0:x.type}):(0,h.jsx)(xi,{ref:C,innerProps:e,format:s,property:g,propertyType:null==x?void 0:x.type})}):null}))},743147:(e,t,o)=>{o.d(t,{n:()=>k});o(296540);var n=()=>o(484714),r=()=>o(56366),i=()=>o(401497),l=()=>o(970013),a=()=>o(416504),s=()=>o(93549),c=()=>o(959013),d=()=>o(284371),u=()=>o(870578),p=()=>o(780054),y=()=>o(405417),m=()=>o(962730),f=()=>o(148832),S=()=>o(46986),h=()=>o(704152),b=()=>o(859428),g=o(474848);const x=200,v=75,C=75;function k(e){let{blockStore:t,collectionContextStore:o,columnWidth:k}=e;const w=(0,n().v3)(),P=(0,S().x6)(),I=(0,r().O$)(o.currentSubitemFormatStoreForCollectionStore),j=(0,r().K8)((()=>t.getAssociatedCollectionStore()),[t]),R=(0,r().K8)((()=>{var e;return null===(e=o.collectionViewStore())||void 0===e?void 0:e.getType()}),[o]),M=(0,r().K8)((()=>{if(!I||!j)return;const e=j.getSchema()[I.property];return void 0!==e&&(0,l().nC)(e)?e:void 0}),[j,I]),_="table"===R||"list"===R||"timeline"===R,T=(0,c().tz)(),B=p().A.isMobile?v:x,A=(0,i().IS)((e=>({parentItemIcon:{color:e.icon.secondary,width:14,height:14,marginRight:2},button:{height:20,display:"flex",alignItems:"center",color:e.text.tertiary,borderRadius:6,padding:"0 6px"},parentTitle:{..._?{maxWidth:k?Math.min(B,k-C):B}:{},fontWeight:d().Wy.medium,fontSize:d().J.UISmall.desktop,...d().RC}})),[k,_,B]),E=(0,r().K8)((()=>I&&M?(0,y().eO)({store:t,subitemFormat:I,propertySchema:M}):[]),[t,I,M]),L=(0,r().K8)((()=>{if(0===E.length)return;const e=E[0];return f().B.createChildStore(t,e)}),[t,E]),W=(0,r().K8)((()=>{var e;return null==L||null===(e=L.getModel())||void 0===e?void 0:e.getRenderTitleWithPlaceholder({getRecordModel:L.getRecordModel,userTimeZone:(0,a().P)(),intl:T,isWorkflowsContainerWithCreationEnabled:P})}),[L,T,P]);return(0,r().K8)((()=>(0,y().xC)({collectionContextStore:o,blockStore:t})),[o,t])&&L?(0,g.jsx)(b().A,{renderTooltip:()=>(0,g.jsx)("div",{children:W}),alignment:m().C.Start,delayThreshold:300,render:e=>(0,g.jsxs)(h().A,{ariaLabel:T.formatMessage({id:"parentItemIndicator.button.openParentSidePeek.ariaLabel",defaultMessage:"Open parent in side peek"}),onClick:()=>{u().k({relationPointers:E,relatedPageStore:L,environment:w,from:"relation_property",peekMode:"side_peek"})},style:A.button,...e,children:[(0,s().j)(A.parentItemIcon),(0,g.jsx)("div",{style:A.parentTitle,children:W})]})}):null}},761408:(e,t,o)=>{o.d(t,{L:()=>i,y:()=>l});var n=()=>o(56366),r=()=>o(175116);function i(e){let{collectionStore:t,collectionContextStore:o,property:n}=e;return null!=o&&o.isMultiSourceView?t.getMappedProperty(n):n}function l(e){let{collectionStore:t,property:o}=e;const l=(0,r().Ks)();return(0,n().K8)((()=>i({collectionStore:t,collectionContextStore:l,property:o})),[t,l,o])}},761529:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(285790),r=()=>o(859428),i=o(474848);function l(e){const{href:t,icon:o,iconStyle:l,tooltip:a,externalLink:s,onClick:c,showShadow:d,style:u}=e;return(0,i.jsx)(r().A,{renderTooltip:()=>a,render:e=>(0,i.jsx)(n().A,{ariaLabel:a,icon:o,iconStyle:l,href:t,onClick:c,hasBackground:!0,showShadow:d,external:s,...e,style:u})})}},807831:(e,t,o)=>{o.d(t,{V:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("subItem",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.88642 2.43778C1.98215 2.3846 2.09567 2.35999 2.22362 2.35999C2.41846 2.35999 2.58374 2.42299 2.71309 2.55179C2.84789 2.67678 2.91386 2.84079 2.91386 3.03655C2.91386 3.161 2.90926 3.28545 2.90008 3.40989C2.8956 3.52687 2.89335 3.66669 2.89335 3.82952C2.89335 4.6672 2.99989 5.34012 3.20906 5.85192C3.42107 6.35987 3.76386 6.73052 4.23921 6.9683C4.72178 7.20285 5.37665 7.32288 6.20897 7.32288H10.9303L12.4002 7.41264L10.2433 5.44074L8.72396 3.8939C8.66786 3.83269 8.6225 3.76177 8.58753 3.68184L8.58532 3.67681C8.55515 3.59133 8.54022 3.50307 8.54022 3.41252C8.54022 3.22504 8.60443 3.06601 8.73414 2.94147C8.86699 2.81372 9.02934 2.74963 9.21678 2.74963C9.40179 2.74963 9.5677 2.81976 9.71223 2.95431L9.71419 2.95614L14.2523 7.49436C14.4062 7.63869 14.4871 7.81019 14.4871 8.00627C14.4871 8.20241 14.4062 8.37593 14.2528 8.52459L9.72696 13.0436C9.57465 13.191 9.40407 13.2698 9.21678 13.2698C9.03026 13.2698 8.86827 13.2086 8.73525 13.0858L8.73305 13.0838C8.60434 12.9551 8.54022 12.7943 8.54022 12.6069C8.54022 12.5163 8.55535 12.4281 8.58551 12.3426C8.61631 12.2554 8.66304 12.1796 8.72601 12.1166L10.2463 10.5689L12.3938 8.61275L10.9258 8.69663L6.14745 8.69651C4.516 8.69651 3.32454 8.32105 2.59311 7.55211C1.86303 6.77991 1.50604 5.55355 1.50604 3.89104C1.50604 3.68942 1.51062 3.50571 1.51983 3.34C1.52904 3.17413 1.54527 3.03558 1.56915 2.92552C1.58898 2.82668 1.62376 2.73465 1.67362 2.64989C1.72566 2.56142 1.79795 2.48982 1.88642 2.43778Z"})})},843141:(e,t,o)=>{o.d(t,{E:()=>l});var n=()=>o(534177),r=()=>o(679924),i=()=>o(476492);function l(e,t,o){var l,a,s;let c="page_properties";const d=(0,i().sl)(t);switch(d.view_type){case void 0:case"page":case"table":c="table";break;case"list":c="list";break;case"gallery":c="gallery";break;case"board":c="board";break;case"calendar":c="calendar";break;case"timeline":c="timeline";break;case"chart":case"form_editor":case"feed":case"map":case"chat":case"custom":break;default:(0,n().HB)(d.view_type)}const u={...o,collection_id:null==t||null===(l=t.collectionStore())||void 0===l?void 0:l.id,collection_view_id:null==t||null===(a=t.collectionViewStore())||void 0===a?void 0:a.id,collection_view_block_id:null==t||null===(s=t.collectionViewBlockStore())||void 0===s?void 0:s.id,from:c};(0,r().v)(e,"copy_property",u)}},846156:(e,t,o)=>{o.d(t,{F:()=>r});var n=()=>o(679924);function r(e,t){(0,n().v)(e,"relation_reorder",t)}},859118:(e,t,o)=>{o.d(t,{Fe:()=>S,Jb:()=>f,ao:()=>y,rW:()=>m});var n=o(296540),r=()=>o(56366),i=()=>o(401497),l=()=>o(455348),a=()=>o(743176),s=()=>o(959013),c=()=>o(234359),d=()=>o(88306),u=o(474848);const p="20px";function y(){return(0,u.jsx)(d().C,{fontColor:"light",style:{lineHeight:p},isEmpty:!0,children:(0,u.jsx)(s().sA,{defaultMessage:"Empty",id:"database.pageProperty.emptyTitle"})})}function m(){return null}function f(){const e=(0,i().DP)(),{store:t,property:o,collectionContextStore:p}=(0,n.useContext)(c().L8),y=(0,r().K8)((()=>{const e=null==p?void 0:p.normalizedSchemaStore.state,n=null==t?void 0:t.getAssociatedCollectionStore();if(!e||!n||!o)return;return e["collectionTypedView"===p.contextType?l().u9.derivePropertyUri(o,n.getPropertyMapping())??o:o]}),[p,o,t]),m=(0,i().IS)((()=>({textContainer:{display:"inline-flex",alignItems:"center"},propertyIcon:{marginRight:6}})),[]);return y?(0,u.jsxs)(d().C,{fontColor:"light",style:m.textContainer,children:[(0,u.jsx)(a().zB,{type:y.type,icon:y.icon,size:14,theme:e,style:m.propertyIcon}),(0,u.jsx)(s().sA,{defaultMessage:"Add {propertyName}",id:"database.boardProperty.fillProperty",values:{propertyName:y.name}})]}):null}function S(){const e=(0,i().DP)(),{propertySchema:t,baseStyles:o,collectionContextStore:l}=(0,n.useContext)(c().L8),s=(0,r().K8)((()=>{var e;return"hide"===(null==l||null===(e=l.collectionStore())||void 0===e||null===(e=e.getLayoutStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.property_icons_visibility)}),[l]),d=(0,i().IS)((e=>({container:{...null==o?void 0:o.textStyle,display:"inline-flex",alignItems:"center",overflow:"hidden",color:e.text.tertiary},text:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},icon:{marginRight:4}})),[o]);return t?(0,u.jsxs)("div",{style:d.container,children:[!s&&(0,u.jsx)(a().zB,{type:t.type,icon:t.icon,size:14,theme:e,style:d.icon}),(0,u.jsx)("div",{style:d.text,children:t.name})]}):null}},870578:(e,t,o)=>{o.d(t,{N:()=>f,k:()=>m});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577);var n=()=>o(584262),r=()=>o(970013),i=()=>o(713998),l=()=>o(921940),a=()=>o(562800),s=()=>o(765957),c=()=>o(217429),d=()=>o(712505),u=()=>o(630116),p=()=>o(727395),y=()=>o(435009);function m(e){let{relationPointers:t,relatedPageStore:o,environment:r,from:i,peekMode:c,openInNew:m}=e;const{mainEditorCurrentBlockStore:f}=s().default.state;if(!f)return;const S=t.find((e=>e.id===o.id));if(!S)return;let h;if(m){const e=u().Bv.createChildStore(f,S),t=e.getModel(),o=a().E2(r,e);h=(0,l().A)({pageId:S.id,pageModel:t,baseUrl:o,pageVisitSource:n().y8.MentionInPage})}else{const e=f.getModel(),t=a().E2(r,f);h=(0,l().A)({pageId:f.id,pageModel:e,baseUrl:t,peekViewBlockId:S.id,peekMode:(0,d().getUrlParamFromPeekMode)("full_page"===c?void 0:c??d().default.state.mode),pageVisitSource:n().y8.MentionInPage}),(0,p()._)(r,{from:i,meta_click:Boolean(m)})}y().oo({environment:r,url:h,openInNew:m})}async function f(e){var t,o;const{update:n,environment:l,store:a,collectionStore:d,propertySchema:p}=e,y=a.state.isOpen?a.state:null,m=new Set(n.oldValues),f=n.newValues.filter((e=>!m.has(e)));if(!c().default.checkGate({gateName:"relation_two_way_limit_of_1_add_relation_confirmation_dialog"}))return!1;const S=s().default.state.currentUserSettingsStore;if(Boolean(null==S?void 0:S.getSettingsStore().getKeyStore("relation_limit_confirmation_dialog_dismissed_at").getValue()))return!1;if(1!==f.length||!y)return!1;const h=y.property,b=(null===(t=y.collectionContextStore)||void 0===t?void 0:t.collectionViewStore())||(null==d||null===(o=d.getParentBlockStore())||void 0===o?void 0:o.getCollectionViewStores()[0]);if(!d||!b||!p)return!1;const g=await async function(e){const{collectionStore:t,property:o,environment:n,targetCollectionStore:i}=e,l=t.getSchema()[o];if(!l||"relation"!==l.type)return!1;const a=r().Nv(l),s=l.property;if(!a||!s)return!1;const c=i??new(u().md)(n,a);await c.load();const d=c.getSchema();if(!(0,r().rd)({propertySchema:l,property:o,sourceCollectionId:t.id,targetCollectionSchema:d}))return!1;const p=d[s];return!(!p||"relation"!==p.type)&&Boolean(p.limit)}({collectionStore:d,property:h,environment:l});if(!g)return!1;const x=await async function(e){const{collectionStore:t,relationPointer:o,environment:n,property:r}=e,l=new(u().Bv)(n,o);await l.load();const a=t.getSchema()[r];if(!a||"relation"!==a.type)return;const s=a.property;if(!s)return;const c=l.getPropertyValue(s);if(!c)return;const[d]=i().n(c);return d}({collectionStore:d,relationPointer:f[0],property:h,environment:l});if(!x)return!1;const v=new(u().Bv)(l,x);await v.load();return{blockWithExistingRelationTitle:v.getPropertyValue("title"),currentBlockTitle:y.store.getPropertyValue("title"),update:n,canAccessBlockWithExistingRelation:v.canRead()}}},880298:(e,t,o)=>{o.d(t,{r:()=>m});var n=o(296540),r=()=>o(401497),i=()=>o(372160),l=()=>o(677195),a=()=>o(53528),s=()=>o(931075),c=()=>o(959013),d=()=>o(534177),u=()=>o(284371),p=()=>o(828180),y=o(474848);function m(e){const{verificationValue:t,fontSize:o=p().Mi}=e,m=(0,c().tz)(),f=(0,n.useMemo)((()=>s().B2(t)),[t]),S=f.type,h=(0,r().IS)((e=>({icon:{width:"expired"===S?8:14,height:"expired"===S?9:14,fill:"verified"===S?e.blueColor:e.icon.secondary},caption:{fontVariantNumeric:"normal",fontWeight:u().Wy.regular,color:e.text.primary,textTransform:"none",letterSpacing:0,marginLeft:6,marginRight:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:o,lineHeight:p().$g},expiredIconContainer:{width:14,height:14,borderRadius:6,border:"1px dashed",borderColor:e.icon.secondary,display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0}})),[S,o]);if("none"===S)return null;let b=null,g=null;const x=h.caption;switch(S){case"verified":b=(0,i().E)({...h.icon}),g=f.isIndefinite?(0,y.jsx)(c().sA,{defaultMessage:"Verified",id:"VerificationPropertyButton.verifiedIndefinitely"}):(0,y.jsx)(c().sA,{defaultMessage:"Until {date}",id:"VerificationPropertyButton.verifiedUntil",values:{date:a().OH({dateTime:f.dateTimeRange.end,intl:m})}});break;case"expired":b=(0,y.jsx)("div",{style:h.expiredIconContainer,children:(0,l().R)({...h.icon})}),g=(0,y.jsx)(c().sA,{defaultMessage:"Expired {timeFromMoment}",id:"VerificationPropertyButton.expired.text",values:{timeFromMoment:s().F7(f.dateTimeRange.end.setLocale(m.locale))}});break;default:(0,d().HB)(S)}return(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[b,(0,y.jsx)("div",{style:x,children:g})]})}},913687:(e,t,o)=>{o.d(t,{A:()=>n});const n=(0,o(959013).YK)({inputPlaceholder:{defaultMessage:"Property name",id:"database.viewSettings.propertyTab.propertyName"},autofillOffLabel:{defaultMessage:"Off",id:"database.viewSettings.propertyTab.autofillOffLabel"},autofillOnLabel:{defaultMessage:"On",id:"database.viewSettings.propertyTab.autofillOnLabel"},keptUpToDateWithNotionAITooltip:{defaultMessage:"Auto-updated by AI",id:"database.tableHeaderCell.tooltipAiAutofillDescription"},buttonPropertyErrorTooltip:{defaultMessage:"Button property has an error",id:"database.tableHeaderCell.tooltipButtonPropertyError"},offlineWarningFormula:{id:"database.tableHeaderCell.offlineWarning.formula",defaultMessage:"Formula results may not be accurate when offline"},offlineWarningAutoUpdate:{id:"database.tableHeaderCell.offlineWarning.autoUpdate",defaultMessage:"Content will not auto-update when offline"}})},932210:(e,t,o)=>{o.d(t,{g:()=>m});var n=o(296540),r=()=>o(484714),i=()=>o(56366),l=()=>o(401497),a=()=>o(965998),s=()=>o(112873),c=()=>o(299545),d=()=>o(372154),u=()=>o(493823),p=o(474848);const y=14;function m(e){let{store:t,iconStyle:o,size:m,buttonStyle:f}=e;const S=(0,r().v3)(),h=(0,n.useRef)(null),b=(0,i().K8)((()=>c().oC(t,{recursivelyLoadAllDiscussions:!1})),[t]),{menuOpen:g,menuStoreId:x}=(0,i().K8)((()=>{const e=d().A.state.open;return{menuOpen:e,menuStoreId:e?d().A.state.blockStore.id:void 0}}),[]),v=(0,n.useCallback)((()=>{var e;g&&x===t.id?s().xl():(s().xl(),s().B4({environment:S,blockStore:t,shouldFocusDiscussion:!0,analyticsFrom:"db_page_comments",rect:null===(e=h.current)||void 0===e?void 0:e.getBoundingClientRect(),recursivelyLoadAllDiscussions:!1}))}),[g,x,S,t]),C=(0,l().IS)((e=>({iconStyle:{fill:e.icon.secondary}})),[]);return 0===b?null:(0,p.jsx)(u().p,{"aria-label":"Open comments",ref:h,size:"sm",style:f,onClick:v,children:(0,p.jsxs)("div",{style:o,children:[(0,a().M)({width:m??y,height:m??y,marginRight:3,fill:C.iconStyle.fill}),b]})})}},996494:(e,t,o)=>{o.d(t,{A:()=>r});class n extends(()=>o(757695))().Store{getInitialState(){return{editMode:void 0,store:void 0}}cloneState(){return o(496603).o8(this.state)}}const r=new n}}]);