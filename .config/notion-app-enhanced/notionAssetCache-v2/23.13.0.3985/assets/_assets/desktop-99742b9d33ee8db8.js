"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[7097],{15121:(e,t,o)=>{o.r(t),o.d(t,{Notification:()=>x});o(18107),o(967357),o(898992),o(354520),o(672577),o(581454);var s=()=>o(244641),r=()=>o(496603),i=()=>o(534177),a=()=>o(939768),n=()=>o(813206),c=()=>o(764880),l=()=>o(855826),d=()=>o(601813),u=()=>o(264435),p=()=>o(236162),m=()=>o(641007),g=()=>o(792071),f=()=>o(814388),b=()=>o(450648),y=()=>o(296344),k=()=>o(869558),v=()=>o(343666),h=()=>o(197959),M=()=>o(798880),N=()=>o(461946),U=()=>o(979340),j=()=>o(797809),A=()=>o(919709);function x(e){var t;const{activity:o,getRecordValue:x,baseURL:I,userTimeZone:R,pageVisitSource:T,intl:E,useSimplifiedEmailSubjectForGrouping:S,isMobilePush:C,recipientUser:L,experimentService:w,collectionFeatureGates:V}=e,P=g().b4_.fromGetRecordValueFn(x),B=(0,f().Ln)({...e}),Z=(0,f().bD)(B,E),F=(0,f().dy)(B),q=(0,f().ds)({recipientUser:L,authors:B}),D=(0,f().$f)({...e,intl:E}),G=(0,f().Nn)({...e,intl:E}),O=(0,f().OM)({...e,intl:E}),W=(0,f().GK)({...e,intl:E}),$=(0,f().xt)({...e,intl:E});switch(o.type){case"top-level-block-created":return{subject:E.formatMessage(f().Ui.topLevelBlockCreated,{userName:Z,targetName:D,spaceName:W})};case"top-level-block-deleted":return{subject:E.formatMessage(f().Ui.topLevelBlockDeleted,{userName:Z,targetName:D,spaceName:W})};case"collection-row-created":return{subject:E.formatMessage(f().Ui.collectionRowCreated,{userName:Z,targetName:D,collectionName:O})};case"collection-row-deleted":return{subject:E.formatMessage(f().Ui.collectionRowDeleted,{userName:Z,targetName:D,collectionName:O})};case"block-edited":{let t;const s=o.getEdits();if(s.length){const o=s[0];if("block-changed"===o.type){const s=o.block_data.after.block_value,i=(0,p().zN)({block:s,getRecordValue:x});if("page"===s.type&&i){const s=o.block_schema||(0,j().RX)(E),i=l().PE({before:o.block_data.before.block_value,after:o.block_data.after.block_value,schema:s}).filter((e=>{const t=s[e];return t&&"formula"!==t.type})).map((t=>{const r=s[t],i=r?r.name:void 0,a=(0,f().Bu)({intl:E,property:t,schema:s,block:o.block_data.after.block_value,getRecordValue:x,userTimeZone:e.userTimeZone,baseURL:e.baseURL,experimentService:w,collectionFeatureGates:V})||E.formatMessage(f().Ui.emptyBlockEditedProperty);return E.formatMessage(f().Ui.propertyNameAndValueEdited,{propertyName:i,propertyValue:a})})),a=n().TW({before:o.block_data.before.block_value,after:o.block_data.after.block_value}),c=r().oE(a.map((e=>{const t=(0,f().$L)({formatProperty:e,intl:E}),s=(0,f().uj)({formatProperty:e,intl:E,block:o.block_data.after.block_value,getRecordValue:x});if(t&&s)return E.formatMessage(f().Ui.propertyNameAndValueEdited,{propertyName:t,propertyValue:s})})));t=E.formatList(i.concat(c),{type:"conjunction",style:"narrow"})}else t=(0,f().g8)({intl:E,blockValue:s,getRecordValue:x,baseURL:I,userTimeZone:R})}else if("block-created"===o.type){const e=o.block_data.block_value;t=(0,f().g8)({intl:E,blockValue:e,getRecordValue:x,baseURL:I,userTimeZone:R})}else if("block-deleted"===o.type){const e=o.block_data.block_value,s=(0,f().g8)({intl:E,blockValue:e,getRecordValue:x,baseURL:I,userTimeZone:R});t=E.formatMessage(f().Ui.blockDeletedEditBody,{renderedBlock:s})}}return{subject:S?_(D,E):E.formatMessage(f().Ui.blockEditedNotification,{userName:Z,blockName:D}),body:t}}case"block-property-edited":const g={subject:S?_(D,E):E.formatMessage(f().Ui.blockPropertyEditedNotification,{userName:Z,blockName:D}),body:void 0},K=o.getEdits();if(K.length){const t=K[0],o=Object.entries(t.property_updates).filter((e=>{var o;let[s,r]=e;const i=null===(o=t.filtered_block_schema)||void 0===o?void 0:o[s];return i&&!["formula","created_by","created_time"].includes(i.type)})).map((o=>{var s,r;let[i,a]=o;const n=null===(s=t.filtered_block_schema)||void 0===s?void 0:s[i],c=n?n.name:void 0,l=(0,f().sL)({intl:E,propertySchema:n,textValue:(null===(r=a.after)||void 0===r?void 0:r.value)??[],getRecordValue:x,userTimeZone:e.userTimeZone,baseURL:e.baseURL,experimentService:w})||E.formatMessage(f().Ui.emptyBlockEditedProperty);return E.formatMessage(f().Ui.propertyNameAndValueEdited,{propertyName:c,propertyValue:l})}));g.body=E.formatList(o,{type:"conjunction",style:"narrow"})}return C?{subject:E.formatMessage(f().Ui.mobileBlockPropertyEditedNotification,{userName:Z}),subtitle:D,body:g.body,senderUserId:F,senderProfilePhoto:q,conversationIdentifier:G}:g;case"permissions-edited":return{subject:E.formatMessage(f().Ui.userEditedPermissionsFor,{userName:Z,targetName:D}),body:(0,f().fk)({intl:E,activity:o,getRecordValue:x,pageVisitSource:T,userTimeZone:e.userTimeZone,experimentService:w,collectionFeatureGates:V})};case"user-mentioned":{const t=(0,f().OQ)({intl:E,getRecordValue:x,baseURL:I,userTimeZone:e.userTimeZone,blockId:o.mentioned_block_id,property:o.mentioned_property,experimentService:w,collectionFeatureGates:V});return C?{subject:E.formatMessage(f().Ui.mobileUserMentionedIn,{userName:Z}),subtitle:D,body:t,senderUserId:F,senderProfilePhoto:q,conversationIdentifier:G}:{subject:S?_(D,E):E.formatMessage(f().Ui.userMentionedIn,{userName:Z,targetName:D}),body:t}}case"commented":{let t,s,r;const i=L?o.getEdits().filter((e=>{var t;return!Boolean(null===(t=e.authors)||void 0===t?void 0:t.find((e=>e.id===L.id)))})):o.getEdits(),a=i[0];let n;if(a)if(s=a.comment_id,r=a.discussion_id,"comment-created"===a.type){const o=x({table:v().SN,id:a.comment_id,spaceId:a.space_id}),s=a.comment_data||o;if(s){var H;t=(0,b().r4)({intl:E,textValue:s.text,getRecordModel:P,userTimeZone:e.userTimeZone});const o=s.created_by_table&&s.created_by_id?null===(H=P({table:s.created_by_table,id:s.created_by_id,spaceId:a.space_id}))||void 0===H?void 0:H.asActor:void 0;n=o?(0,f().bD)([o.asActor],E):Z}}else if("comment-changed"===a.type)t=(0,b().r4)({intl:E,textValue:a.comment_data.after.text,getRecordModel:P,userTimeZone:e.userTimeZone});else if("suggestion-created"===a.type){const o=P({table:h().$Y,id:a.discussion_id,spaceId:a.space_id});var Q;if(o&&"suggestion"===o.getType())t=(0,b().r4)({intl:E,textValue:(0,d().l8)({discussionContextData:(null===(Q=o.getSuggestionRawContext())||void 0===Q||null===(Q=Q.snapshot)||void 0===Q?void 0:Q.data)??[],discussionType:"suggestion",discussionId:o.id,intl:E}),getRecordModel:P,userTimeZone:e.userTimeZone})}else{const o=x({table:v().SN,id:a.comment_id,spaceId:a.space_id}),s=a.comment_data||o;if(s){const o=(0,b().r4)({intl:E,textValue:s.text,getRecordModel:P,userTimeZone:e.userTimeZone});t=E.formatMessage(f().Ui.userDeletedComment,{commentText:o})}}return C?{subject:"suggestion-created"===(null==a?void 0:a.type)?E.formatMessage(f().Ui.mobileUserSuggestedSubject,{userName:n??Z}):E.formatMessage(f().Ui.mobileUserCommentedSubject,{userName:n??Z}),subtitle:D,body:t,senderUserId:F,senderProfilePhoto:q,conversationIdentifier:G,categoryIdentifier:"comment_notification_category",commentId:s,discussionId:r}:{subject:S?_(D,E):"suggestion-created"===(null==a?void 0:a.type)?E.formatMessage(f().Ui.userSuggestedSubject,{userName:n??Z,targetName:D}):E.formatMessage(f().Ui.userCommentedSubject,{userName:n??Z,targetName:D}),body:t}}case"user-invited":const J=(0,a().ZL)(D),Y=J.length>0?J:E.formatMessage(f().Ui.defaultPageName);if(o.permission_group_id)return{subject:E.formatMessage(f().Ui.userAddedToSpace,{userName:Z,workspaceName:Y})};const X=0===B.filter(c().L_).length;return C?X?{subject:E.formatMessage(f().Ui.mobileUserInvitedByBot),subtitle:D,conversationIdentifier:G}:{subject:E.formatMessage(f().Ui.mobileUserInvited,{userName:Z}),subtitle:D,senderUserId:F,senderProfilePhoto:q,conversationIdentifier:G}:{subject:X?E.formatMessage(f().Ui.userInvitedToSpaceByBot,{workspaceName:Y}):E.formatMessage(f().Ui.userInvitedToSpace,{userName:Z,workspaceName:Y})};case"collection-edited":{let e,t=E.formatMessage(f().Ui.userEditedCollectionSubject,{userName:Z,collectionName:D});const s=o.getEdits();if(s.length){const o=s[0];if("collection-changed"===o.type&&o.collection_data){const s=o.collection_data.after?o.collection_data.after.description:void 0,r=o.collection_data.before?o.collection_data.before.description:void 0;r&&!s?t=E.formatMessage(f().Ui.collectionDescriptionDeleted,{userName:Z,collectionName:D}):!r&&s?(t=E.formatMessage(f().Ui.collectionDescriptionCreated,{userName:Z,collectionName:D}),e=A().k4p(s)):r&&s&&A().dze(r,s)&&(e=A().k4p(s))}else if("collection-created"===o.type&&o.collection_data){const s=o.collection_data.description;s&&(t=E.formatMessage(f().Ui.userCreatedCollectionSubject,{userName:Z,collectionName:D}),e=A().k4p(s))}}return{subject:t,body:e}}case"collection-view-edited":const ee=e.getRecordValue({table:k().Gy,id:o.collection_view_id,spaceId:o.space_id}),te=ee&&ee.name||E.formatMessage(f().Ui.untitledCollectionView);return{subject:E.formatMessage(f().Ui.collectionViewEditedSubject,{userName:Z,collectionViewName:te,collectionName:D})};case"collection-property-edited":const oe=o.getEdits(),se=oe.length&&oe[0],re=se&&("collection-property-changed"===se.type?se.collection_property_data.after.name:se.collection_property_data.name)||E.formatMessage(f().Ui.collectionPropertyEditedUnknown);return o.collection_property_id,{subject:E.formatMessage(f().Ui.collectionPropertyEditedSubject,{userName:Z,propertyType:re,collectionName:D})};case"collection-page-layout-edited":let ie;return{subject:E.formatMessage(f().Ui.userEditedCollectionPageLayoutSubject,{userName:Z,collectionName:D}),body:ie};case"reminder":return{subject:E.formatMessage(f().Ui.reminderSubject,{pageName:D}),body:(0,f().OQ)({getRecordValue:x,baseURL:I,userTimeZone:e.userTimeZone,blockId:o.reminder_block_id,property:o.reminder_property,intl:E,experimentService:w,collectionFeatureGates:V})};case"page-locked":case"page-unlocked":return{subject:"page-locked"===o.type?E.formatMessage(f().Ui.pageLockedActivity,{userName:Z,pageName:D}):E.formatMessage(f().Ui.pageUnlockedActivity,{userName:Z,pageName:D})};case"email-edited":return{subject:E.formatMessage(f().Ui.emailEditedActivity,{userName:Z})};case"access-requested":{const e=P({id:o.getAccessRequestId(),table:y().O,spaceId:o.getSpaceId()});if(!e||e.isPageAccessRequest()||e.isTeamMembershipRequest())return null!=e&&e.isEditPageAccessRequest()?{subject:E.formatMessage(f().Ui.editAccessRequestedSubject,{userName:Z,pageName:D})}:{subject:E.formatMessage(f().Ui.accessRequestedSubject,{userName:Z,pageName:D})};if(e.isGuestInviteRequest())return{subject:E.formatMessage(f().Ui.guestInviteRequestedSubject,{userName:Z,workspaceName:D})};if(e.isSpaceMembershipRequest())return{subject:E.formatMessage(f().Ui.membershipRequestedSubject,{userName:Z,workspaceName:D})};(0,i().HB)(e);break}case"access-request-resolved":{const e=P({id:o.getAccessRequestId(),table:y().O,spaceId:o.getSpaceId()}),t=o.getEdits()[0].requested_for,s=t?P(t):void 0,r=null!=s&&s.isUser()?s.getEmail():E.formatMessage({defaultMessage:"a guest",id:"pushNotification.accessRequestResolved.invalidGuest"});return{subject:E.formatMessage("approved"===(null==e?void 0:e.status)?f().Ui.accessRequestResolvedApprovedSubject:f().Ui.accessRequestResolvedRejectedSubject,{guestEmail:r,pageName:D})}}case"page-deleted":return{subject:E.formatMessage(f().Ui.pageDeletedActivity,{userName:Z})};case"page-restored":return{subject:E.formatMessage(f().Ui.pageRestoredActivity,{userName:Z})};case"page-permanently-deleted":return{subject:E.formatMessage(f().Ui.pagePermanentlyDeletedActivity,{userName:Z})};case"team-membership-edited":return{subject:E.formatMessage(f().Ui.userInvitedToTeam,{userName:Z,teamName:D})};case"private-content-transferred":const ae=o.getEdits(),ne=ae.length>0?ae[0].from_user_id:void 0,ce=(0,i().O9)(ne)?P({table:M().oo,id:ne}):void 0;return ce&&ce.getFullName(E)?{subject:E.formatMessage(f().Ui.privateContentTransferred,{author:Z,pageName:D,fromUserName:ce.getFullName(E)})}:{subject:E.formatMessage({defaultMessage:"{author} transferred private content to you: {pageName}",id:"pushNotification.privateContentTransferred.noFromUserName"},{author:Z,pageName:D})};case"permission-group-mentioned":const le=(0,f().$I)({spaceId:o.space_id,permissionGroupId:o.mentioned_group_id,getRecordValue:e.getRecordValue}),de=(0,f().kr)(E,le);return{subject:S?_(D,E):E.formatMessage(f().Ui.permissionGroupMentionedIn,{userName:Z,targetName:D,groupName:de}),body:(0,f().OQ)({intl:E,getRecordValue:x,baseURL:I,userTimeZone:e.userTimeZone,blockId:o.navigable_block_id,property:o.mentioned_property,experimentService:w,collectionFeatureGates:V})};case"verification-expired":return{subject:E.formatMessage(f().Ui.verificationExpired,{pageName:D})};case"team-mentioned":const ue=(0,f().Uo)({spaceId:o.space_id,teamId:null===(t=o.getEdits())||void 0===t||null===(t=t[0])||void 0===t?void 0:t.mentioned_team_id,getRecordValue:e.getRecordValue}),pe=null==ue?void 0:ue.getName();return{subject:S?_(D,E):E.formatMessage(f().Ui.teamMentionedIn,{userName:Z,targetName:D,teamName:pe}),body:(0,f().OQ)({intl:E,getRecordValue:x,baseURL:I,userTimeZone:e.userTimeZone,blockId:o.navigable_block_id,property:o.mentioned_property,experimentService:w,collectionFeatureGates:V})};case"import-completed":const me=o.getEdits()[0],ge="failed"===me.import_status?f().Ui.importFailed:f().Ui.importSuccessful;return{subject:E.formatMessage(ge,{importSource:me.import_source})};case"export-completed":return{subject:E.formatMessage(f().Ui.exportCompleted)};case"in-app-notification-automation-action-triggered":const fe=o.getEdits()[0];return{subject:E.formatMessage(f().Ui.inAppNotificationAutomationActionTriggered,{automationName:$}),body:(0,b().r4)({intl:E,textValue:fe.message.value,getRecordModel:P,userTimeZone:e.userTimeZone})};case"no-conflicts-found":return{subject:E.formatMessage(f().Ui.noConflictsFound),subtitle:D,senderUserId:m().px.id,senderProfilePhoto:m().px.profile_photo};case"automation-typecheck-error-raised":return{subject:E.formatMessage(f().Ui.automationTypecheckErrorRaisedSubject,{automationName:$}),body:E.formatMessage(f().Ui.automationTypecheckErrorRaisedBody)};case"reacted":return{subject:E.formatMessage(f().Ui.reactionCreated,{userName:Z,targetName:D})};case"upgrade-request-created":return{subject:E.formatMessage(f().Ui.upgradeRequestCreated,{userName:Z})};case"app-builder-notification":return{subject:"App Builder Notification"};case"external-integration-notification":const be=o.getEdits()[0];return"jira-sync-token-expiry"===be.external_integration_notification_type?{subject:E.formatMessage(f().Ui.externalIntegrationNotificationJiraSyncTokenExpiryError,{site:be.identifier})}:{subject:E.formatMessage(f().Ui.externalIntegrationNotificationDefault)};case"trial-created":{var z;let e,t,r;const i=o.getEdits();if(i.length){const o=i[0],{trial_data:a}=o;t=s().c9.fromMillis(a.end_time),r=a.product,e=E.formatMessage(f().Ui.trialCreatedBody,{endDate:`${t.toFormat("MMM")} ${(0,u().o4)(t.locale.substring(0,2),t.day,"c")}`,product:(0,U().u2)({product:r,intl:E})})}const a=N().WL,n=null===(z=i.at(0))||void 0===z?void 0:z.trial_data.user_id;if(!n)return{subject:E.formatMessage(f().Ui.trialCreatedWithoutUserName,{days:a,product:r})};const c=P({table:M().oo,id:n});if(!c)return{subject:E.formatMessage(f().Ui.trialCreatedWithoutUserName,{days:a,product:r})};const l=(0,f().bD)([c.asActor],E);return{subject:E.formatMessage(f().Ui.trialCreated,{userName:l,days:a,product:r}),body:e}}}}function _(e,t){return t.formatMessage({defaultMessage:"New activity in {pageTitle}",id:"emailActivity.pageActivity.simplifiedSubjectLine"},{pageTitle:e})}},91063:(e,t,o)=>{o.r(t),o.d(t,{default:()=>j});o(944114);var s=o(296540),r=()=>o(56366),i=()=>o(919709),a=()=>o(959013),n=()=>o(502492),c=()=>o(939768),l=()=>o(874913),d=()=>o(725614),u=()=>o(780054),p=()=>o(921855),m=()=>o(728611),g=()=>o(231722),f=()=>o(906537),b=()=>o(301421),y=()=>o(807926),k=()=>o(24157),v=()=>o(575143),h=()=>o(760217),M=()=>o(939740),N=()=>o(89924),U=o(474848);const j=function(){(0,s.useEffect)((()=>{var e,t;return null===(e=l().electronApi)||void 0===e||null===(e=e.contextMenu)||void 0===e||null===(t=e.addListener)||void 0===t||t.call(e,_),()=>{var e,t;null===(e=l().electronApi)||void 0===e||null===(e=e.contextMenu)||void 0===e||null===(t=e.removeListener)||void 0===t||t.call(e,_)}}),[]);const e=(0,o(484714).v3)(),t=(0,s.useRef)(document.activeElement),i=(0,s.useRef)(f().get());let d=null,p=null;(t.current instanceof HTMLInputElement||t.current instanceof HTMLTextAreaElement)&&(d=t.current.selectionStart,p=t.current.selectionEnd);const g=(0,r().K8)(R,[]),{menuInfo:b,open:k}=(0,r().O$)(y().A),j=(0,r().K8)((()=>{if(!b)return[];const s=function(e,t){const o=[],s=function(e,t){const o="SpellCheckStore"in t&&t.SpellCheckStore,s=[];if(x(e)&&o&&o.isEnabled()){const t=o.getCorrections(e);for(const e of t)s.push({key:e,action:()=>{l().electronApi&&l().electronApi.replaceMisspelling&&l().electronApi.replaceMisspelling(e)},render:t=>(0,U.jsx)(h().A,{...t,title:e})})}return s}(e,t);if(s.length>0){const e=o.length>0;o.push({key:"spellingCorrectionItems",items:s,render:t=>(0,U.jsx)(N().A,{...t,topBorder:e})})}const r=function(e,t){const o="SpellCheckStore"in t&&t.SpellCheckStore,s=[];x(e)&&o&&o.isEnabled()&&s.push({key:"learn-spelling",action:()=>{o.addToDictionary(e.misspelledWord)},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Add to dictionary",id:"desktop.spellcheckMenuItem.addToDictionary.title"})})});x(e)&&o&&o.isEnabled()&&s.push({key:"disable",action:()=>{o.setEnabled(!1)},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Disable spell check",id:"desktop.spellcheckMenuItem.disableSpellcheck.title"})})});return s}(e,t);if(r.length>0){const e=o.length>0;o.push({key:"disableSpellCheckItems",items:r,render:t=>(0,U.jsx)(N().A,{...t,topBorder:e})})}const i=function(e){const t=[];e.selectionText&&e.selectionText.length>0&&t.push({key:"google",action:()=>{if(l().electronApi){const t=`https://www.google.com/search?q=${encodeURIComponent(e.selectionText.trim())}`;l().electronApi.openExternalUrl(t)}},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Search with Google",id:"desktop.searchMenuItem.searchWithGoogle.title"})})});return t}(e);if(i.length>0){const e=o.length>0;o.push({key:"searchItems",items:i,render:t=>(0,U.jsx)(N().A,{...t,topBorder:e})})}const d=function(e,t){const o=[];if(!t.linkURL||0===t.linkURL.length)return o;const s=n().it({url:t.linkURL,domainBaseUrl:u().A.domainBaseUrl,protocol:u().A.protocol});t.linkURL.startsWith("mailto:")?o.push({key:"copy-email",action:()=>{var e;null!==(e=l().electronApi)&&void 0!==e&&e.copyText&&l().electronApi.copyText(t.linkText)},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Copy email address",id:"desktop.rightClickMenu.copyEmailAddress"})})}):o.push({key:"copy-link",action:()=>{var e;null!==(e=l().electronApi)&&void 0!==e&&e.copyText&&l().electronApi.copyText(s)},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Copy link",id:"desktop.rightClickMenu.copyLink"})})});o.push({key:"open-link",action:()=>{l().openExternalUrl(s)},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Open link in browser",id:"desktop.rightClickMenu.openLinkInBrowser"})})});const r=(i=s,(0,c().$_)(i)===u().A.domainBaseUrl);var i;r&&o.push({key:"open-link-new-tab",action:t=>{"tab"===(0,m().Vr)(t.event)?l().openInactiveNewTab(e,{url:s,position:"after-children"}):l().openInNewTab({url:s,position:"after-children",makeTabActive:!0})},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Open link in new tab",id:"desktop.rightClickMenu.openLinkInNewTab"})})});r&&o.push({key:"open-link-new-window",action:()=>{l().openInNewWindow(s)},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Open link in new window",id:"desktop.rightClickMenu.openLinkInNewWindow"})})});return o}(t,e);if(d.length>0){const e=o.length>0;o.push({key:"linkMenuItems",items:d,render:t=>(0,U.jsx)(N().A,{...t,topBorder:e})})}const p=function(e){const t=[];e.hasImageContents&&e.srcURL&&e.srcURL.length>0&&(t.push({key:"copy-image",action:()=>{l().electronApi&&l().electronApi.copyImage&&l().electronApi.copyImage(e.srcURL)},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Copy image",id:"desktop.rightClickMenu.copyImage"})})}),t.push({key:"copy-image-address",action:()=>{l().electronApi&&l().electronApi.copyText&&l().electronApi.copyText(n().it({url:e.srcURL,domainBaseUrl:u().A.domainBaseUrl,protocol:u().A.protocol}))},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Copy image address",id:"desktop.rightClickMenu.copyImageAddress"})})}));return t}(e);if(p.length>0){const e=o.length>0;o.push({key:"imageMenuItems",items:p,render:t=>(0,U.jsx)(N().A,{...t,topBorder:e})})}const g=function(e){var t;const o=[],s=(null===(t=e.selectionText)||void 0===t?void 0:t.length)??0;if(!A(e)&&0===s)return o;e.editFlags.canCut&&o.push({key:"cut",action:()=>{l().electronApi&&l().electronApi.cut&&l().electronApi.cut()},render:e=>(0,U.jsx)(v().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Cut",id:"desktop.textEditingMenuItem.cutAction.title"}),shortcut:"cut"})});e.editFlags.canCopy&&o.push({key:"copy",action:()=>{l().electronApi&&l().electronApi.copy&&l().electronApi.copy()},render:e=>(0,U.jsx)(v().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Copy",id:"desktop.textEditingMenuItem.copyAction.title"}),shortcut:"copy"})});e.editFlags.canPaste&&o.push({key:"paste",action:()=>{l().electronApi&&l().electronApi.paste&&requestAnimationFrame(l().electronApi.paste)},render:e=>(0,U.jsx)(v().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Paste",id:"desktop.textEditingMenuItem.pasteAction.title"}),shortcut:"paste"})});return o}(e);if(g.length>0){const e=o.length>0;o.push({key:"textEditingItems",items:g,render:t=>(0,U.jsx)(N().A,{...t,topBorder:e})})}const f=function(e,t){const o="SpellCheckStore"in t&&t.SpellCheckStore,s=[];A(e)&&o&&!o.isEnabled()&&s.push({key:"enable",action:()=>{o.setEnabled(!0)},render:e=>(0,U.jsx)(h().A,{...e,title:(0,U.jsx)(a().sA,{defaultMessage:"Enable spell check",id:"desktop.spellcheckMenuItem.enableSpellcheck.title"})})});return s}(e,t);if(f.length>0){const e=o.length>0;o.push({key:"enableSpellCheckItems",items:f,render:t=>(0,U.jsx)(N().A,{...t,topBorder:e})})}return o}(b,e);for(const r of s)for(const s of r.items){const r=s.action;s.action=s=>{t.current instanceof HTMLElement&&t.current.focus(),t.current instanceof HTMLInputElement||t.current instanceof HTMLTextAreaElement?(t.current.selectionStart=d,t.current.selectionEnd=p):i.current&&i.current.startOffset!==i.current.endOffset&&f().set(i.current,e.device),o(908006).default.afterNextFlush((()=>{r(s)}))}}return s}),[t,e,b,p,d]),{x:T,y:E}=function(e){const t=l().deprecatedGetCurrentZoom();return{x:e?e.x/t:0,y:e?e.y/t:0}}(b),S=g??new DOMRect(T,E,0,0);return(0,s.useEffect)((()=>{k&&(t.current=document.activeElement)}),[k]),(0,U.jsx)(o(897119).Ay,{open:k&&j.length>0,popupType:o(377586).n.Popup,originRect:S,originGap:g?4:void 0,render:()=>(0,U.jsx)(o(805751).A,{debugName:"ElectronContextMenu",capture:!0,allowEsc:!0,children:(0,U.jsx)(o(928600).A,{menuType:o(722872).gu.Popup,children:(0,U.jsx)(M().Ay,{type:M().Oh.Vertical,sections:j,initialFocus:void 0,onAccept:I,suppressFocusRing_PLEASE_USE_SPARINGLY:!0})})}),onDismiss:I,trapFocus:!0})};function A(e){return e.isEditable||"none"!==(null==e?void 0:e.formControlType)}function x(e){return A(e)&&e.misspelledWord&&e.misspelledWord.length>0}function _(e,t){if(t.misspelledWord){const e=k().default.state,o="editing"===e.mode&&(0,g().H7)(e.multiSelection);if(o&&o.selection.startIndex===o.selection.endIndex){const e=i().JWU({textValue:o.store.getValue()||[],substring:t.misspelledWord,ignoreCase:!1}),s=o.selection.startIndex,r=i().zBr(e,s);r&&d().setSelection({store:o.store,selection:r})}}y().A.setState({open:!0,menuInfo:t})}function I(){y().A.setState({...y().A.state,open:!1})}function R(){const e=k().default.state;if("empty"===e.mode)return;const t=(0,g().H7)(e.multiSelection);if(t){var o;const{store:e,selection:s}=t,r=b().n.findEditableWithStore(e),i=null==r||null===(o=r.getContentEditableLeaf())||void 0===o?void 0:o.getNode();if(i){const e=(0,p().rM)(i,s.startIndex,s.endIndex);if(e)return f().getRect(e)}}}}}]);