"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[47779],{112698:(e,t,o)=>{o.d(t,{B:()=>h});o(296540);var n=()=>o(484714),r=()=>o(56366),i=()=>o(401497),a=()=>o(959013),l=()=>o(381349),c=()=>o(534177),s=()=>o(284371),p=()=>o(824160),d=()=>o(859428),u=()=>o(962730),y=()=>o(765957),m=()=>o(991249),f=o(474848);function h(e){let{upsell:t,mobileStyle:o,desktopStyle:l,analyticsName:s,onClick:h,disableTooltip:g}=e;const S=(0,i().DP)(),C=(0,n().v3)(),{device:v}=C,b=(0,r().K8)((()=>{const{currentSpaceStore:e}=y().default.state;return null==e?void 0:e.canAdmin()}),[]);if("none"===t.type)return null;if(v.isMobileNative)return null;const A=(()=>{switch(t.product){case"personal":return(0,f.jsx)(a().sA,{defaultMessage:"Personal Pro",id:"upgradeButton.personal.text"});case"plus":return(0,f.jsx)(a().sA,{defaultMessage:"Plus ↗",id:"upgradeButton.plus.textWithArrow"});case"business":return(0,f.jsx)(a().sA,{defaultMessage:"Business ↗",id:"upgradeButton.business.textWithArrow"});case"enterprise":return(0,f.jsx)(a().sA,{defaultMessage:"Enterprise ↗",id:"upgradeButton.enterprise.textWithArrow"});case"ai":return(0,f.jsx)(a().sA,{defaultMessage:"AI ↗",id:"upgradeButton.ai.textWithArrow"});case"sites_custom_hostnames":return(0,f.jsx)(a().sA,{defaultMessage:"Custom Hostnames ↗",id:"upgradeButton.sites_custom_hostnames.textWithArrow"});default:t.product,(0,c().HB)(t.product)}})();return v.isMobile||!b?(0,f.jsx)(p().A,{mobileStyle:o,children:A}):(0,f.jsx)(d().A,{delayThreshold:120,disableTooltip:g,placement:u().W.Bottom,renderTooltip:()=>(0,f.jsx)("div",{style:{maxWidth:500},children:(0,f.jsx)(a().sA,{defaultMessage:"Upgrade to use this feature.",id:"premiumFeatureUpgradeButton.upgrade.tooltip"})}),originGap:6,render:e=>(0,f.jsx)(p().A,{desktopStyle:l,innerStyle:x(t.product,S),onClick:e=>function(e,t,o,n,r){m().K(n,{from:t,upsell:o}),r&&r(e)}(e,s,t,C,h),...e,children:A})})}function x(e,t){switch(e){case"plus":case"business":case"enterprise":return{color:t.blueColor,background:"light"===t.mode?l().Ay.diffBackground:"rgba(35, 131, 226, 0.2)",fontWeight:s().Wy.medium};default:return{}}}},150987:(e,t,o)=>{o.d(t,{A:()=>m});o(898992),o(354520),o(581454),o(737550);var n=o.n(o(844751)),r=o(296540),i=()=>o(970013),a=()=>o(713998),l=()=>o(959013),c=()=>o(496603),s=()=>o(722872),p=()=>o(939740),d=()=>o(89924),u=()=>o(250202),y=o(474848);const m=function(e){let{selectedProperty:t,onAccept:m,schema:f,onClose:h,allowProperty:x,isRelationProperty:g}=e;const S=(0,o(484714).v3)(),C=(0,l().tz)(),[v,b]=(0,r.useState)("");let A=Object.keys(f);const j=A.some(o(443239).u);A=c().Ul(A,(e=>{const t=(0,a()._g)({schema:f,property:e});return t?t.name:""}));const P=j?i().Ho:i().rn;if(A=c().FF(A,P),A.unshift(P),x&&(A=A.filter((e=>{const t=(0,a()._g)({schema:f,property:e});return t&&x(t)}))),v){let e=A.map((e=>{const t=(0,a()._g)({schema:f,property:e});return t&&t.name}));e=n().filter(v,e).map((e=>{let{original:t}=e;return t})),A=A.filter((t=>{const o=(0,a()._g)({schema:f,property:t});return o&&o.name&&e.includes(o.name)}))}const w=v||A.length>o(525432).R8,_=c().oE(A.map((e=>{const o=(0,a()._g)({schema:f,property:e});if(!o)return null;return{key:e,render:n=>(0,y.jsx)(u().G,{...n,propertySchema:o,format:u().e.Name,isChecked:e===t}),action:()=>m(e)}}))),I=[{key:0,render:e=>(0,y.jsx)(d().A,{...e}),items:_}],{device:T}=S,M=w?(0,y.jsx)(d().A,{isInput:!0,children:(0,y.jsx)(o(419357).Ay,{focus:!T.isMobile||void 0,focusAfterAnimation:!0,value:v,onChange:e=>b(e.target.value),placeholder:g?C.formatMessage({defaultMessage:"Search for a relation property…",id:"propertySelectMenu.searchForProperty.relation.placeholder"}):C.formatMessage({defaultMessage:"Search for a property…",id:"propertySelectMenu.searchForProperty.default.placeholder"})})}):null;let k;return k=T.isMobile?{menuType:s().gu.Modal,title:g?C.formatMessage({defaultMessage:"Relation property",id:"propertySelectMenu.mobileMenu.relationProperty.header"}):C.formatMessage({defaultMessage:"Property",id:"propertySelectMenu.mobileMenu.property.header"}),right:(0,y.jsx)(o(480095).CancelMenuText,{}),onClickRight:h,header:M}:{menuType:s().gu.Popup,width:280,maxHeight:480,header:M},(0,y.jsx)(o(928600).A,{...k,children:0===_.length?(0,y.jsx)(d().A,{children:(0,y.jsx)(o(64e3).A,{title:(0,y.jsx)(l().sA,{defaultMessage:"No results",id:"propertySelectMenu.search.noResults.title"})})}):(0,y.jsx)(p().Ay,{type:p().Oh.Vertical,sections:I,onAccept:h,initialFocus:v.length>0?0:void 0})})}},201724:(e,t,o)=>{o.r(t),o.d(t,{TableHeaderCellMenu:()=>le});o(944114),o(898992),o(354520),o(672577),o(581454);var n=o(296540),r=()=>o(484714),i=()=>o(56366),a=()=>o(921598),l=()=>o(970013),c=()=>o(713998),s=()=>o(244149),p=()=>o(340498),d=o(474848);const u={viewBox:"0 0 20 20",fittedViewBox:"2.4 3.52 15.2 12.95",directional:!0,svg:(0,d.jsx)("path",{d:"M16.975 3.525c.345 0 .625.28.625.625v11.7a.625.625 0 1 1-1.25 0V4.15c0-.345.28-.625.625-.625M9.658 5.158a.625.625 0 0 1 .884 0l4.4 4.4a.625.625 0 0 1 0 .884l-4.4 4.4a.625.625 0 1 1-.884-.884l3.333-3.333H3.025a.625.625 0 1 1 0-1.25h9.966L9.658 6.042a.625.625 0 0 1 0-.884"})},y=(0,p().wt)("arrowLineRight",u),m={viewBox:"0 0 20 20",fittedViewBox:"1.1 3.52 17.79 12.88",directional:!0,svg:(0,d.jsx)("path",{d:"M3.024 3.524a1.92 1.92 0 0 0-1.918 1.92v9.113a1.92 1.92 0 0 0 3.837 0V5.444a1.92 1.92 0 0 0-1.919-1.92m0 1.251c.37 0 .67.3.67.67v9.112a.67.67 0 0 1-1.338 0V5.444c0-.369.3-.668.668-.669m8.612.383a.625.625 0 0 0-.884 0l-4.4 4.4a.626.626 0 0 0 0 .884l4.4 4.4a.626.626 0 0 0 .884-.884l-3.334-3.333h9.967a.625.625 0 0 0 0-1.25H8.303l3.333-3.333a.625.625 0 0 0 0-.884"})},f=(0,p().wt)("arrowRectangleLeft",m),h={viewBox:"0 0 20 20",fittedViewBox:"1.1 3.52 17.79 12.88",directional:!0,svg:(0,d.jsx)("path",{d:"M16.976 3.524a1.92 1.92 0 0 1 1.918 1.92v9.113a1.92 1.92 0 0 1-3.837 0V5.444c0-1.06.859-1.92 1.919-1.92m0 1.251a.67.67 0 0 0-.67.67v9.112a.67.67 0 0 0 1.338 0V5.444a.67.67 0 0 0-.668-.669m-8.612.383a.625.625 0 0 1 .884 0l4.4 4.4a.626.626 0 0 1 0 .884l-4.4 4.4a.626.626 0 0 1-.884-.884l3.334-3.333H1.731a.625.625 0 0 1 0-1.25h9.966L8.364 6.042a.625.625 0 0 1 0-.884"})},x=(0,p().wt)("arrowRectangleRight",h);var g=()=>o(170350),S=()=>o(90907);const C={viewBox:"0 0 20 20",fittedViewBox:"3.67 2.37 12.66 15.94",svg:(0,d.jsx)("path",{d:"m4.897 3.085-.122-.142a.625.625 0 0 0-.95.814l3.56 4.152-.013.131a4.625 4.625 0 0 0-2.997 4.33V13c0 .345.28.625.625.625h4.13v3.08c0 .158.035.317.1.46l.433.94a.35.35 0 0 0 .565.103l.063-.087.44-.956c.065-.142.1-.3.1-.46v-3.08h1.453l2.941 3.432a.625.625 0 0 0 1.042-.67L4.989 3.228a.6.6 0 0 1-.093-.144m3.258 6.007a.6.6 0 0 0 .169-.088l2.889 3.371H5.625v-.006c0-1.447.922-2.733 2.293-3.197zm7.259 4.379a.62.62 0 0 0 .212-.47v-.63a4.625 4.625 0 0 0-2.997-4.33l-.157-1.603.289-.258a3.63 3.63 0 0 0 1.212-2.705V3a.625.625 0 0 0-.625-.625H6.653a.62.62 0 0 0-.516.272l1.216 1.419a2.4 2.4 0 0 1-.07-.441h5.434a2.38 2.38 0 0 1-.79 1.621l-.525.47a.63.63 0 0 0-.206.527l.227 2.318a.63.63 0 0 0 .422.531l.237.08a3.375 3.375 0 0 1 2.291 3.084z"})},v=(0,p().wt)("pinSlash",C);var b=()=>o(735790),A=()=>o(798880),j=()=>o(959013),P=()=>o(496603),w=()=>o(416726),_=()=>o(901952),I=()=>o(436696),T=()=>o(187899),M=()=>o(235191),k=()=>o(686526),F=()=>o(896628),H=()=>o(4319),B=()=>o(751156),V=()=>o(312540),O=()=>o(59400),E=()=>o(334684),z=()=>o(673964),R=()=>o(419167),K=()=>o(760217),L=()=>o(928600),D=()=>o(939740),U=()=>o(8980),W=()=>o(897119),X=()=>o(89924),N=()=>o(859428),G=()=>o(662971),q=()=>o(673730),$=()=>o(68465),Y=()=>o(722872),Q=()=>o(553965),Z=()=>o(963589),J=()=>o(962730),ee=()=>o(765957),te=()=>o(227440),oe=()=>o(329304),ne=()=>o(877568),re=()=>o(875909);function ie(e){const{menuListProps:t,menuListParent:a,property:l,propertySchema:s,collectionContextStore:p,buttonPopupParent:u}=e,y=(0,r().v3)(),{isMobile:m}=(0,r().Y0)(),f=p.settingsStore,{disabled:h,icon:x,tooltipMessage:g}=function(e){let{propertySchema:t,collectionContextStore:o}=e;const n=(0,i().O$)(o.permissionScopesStore),r=!(0,i().O$)(te().e)&&(0,E().$)({propertyType:t.type,propertySchema:t,allowAIProperty:!1}),a=!n.canConfigureCollection||r,l=n.canConfigureCollection?(0,d.jsx)(U().I,{icon:b().M}):(0,d.jsx)(U().I,{icon:S().h}),c=r?(0,d.jsx)(j().sA,{id:"database.tableHeaderCell.editProperty.offlineTooltip",defaultMessage:"Go online to edit property"}):(0,d.jsx)(j().sA,{defaultMessage:"You don’t have permission to edit this property",id:"database.tableHeaderCell.editPropertyTooltipDisabled"});return{disabled:a,icon:l,tooltipMessage:c}}({propertySchema:s,collectionContextStore:p}),C=(0,i().K8)((()=>(0,$().O0)(y)),[y]),v=(0,n.useMemo)((()=>{if(h)return(0,d.jsx)(N().A,{placement:J().W.Left,render:e=>(0,d.jsx)(K().A,{disabled:!0,disabledFeedback:!0,title:(0,d.jsx)(j().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:x,...(0,Q().A)(t,e)}),renderTooltip:()=>g});if((0,c().V5)(s)||(0,c().di)(s))return(0,d.jsx)(K().A,{...t,title:(0,d.jsx)(j().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,d.jsx)(U().I,{icon:b().M})});switch(s.type){case"text":return C?(0,d.jsx)(re().oX,{collectionContextStore:p,property:l,collectionSettingsStore:f,source:"tableHeaderMenu"}):null;case"url":return(0,d.jsx)(o(109129).V,{collectionContextStore:p,property:l,propertySchema:s});case"button":return(0,d.jsx)(O().nR,{collectionSettingsStore:f,collectionContextStore:p,property:l,source:"tableHeaderMenu"});default:return(0,d.jsx)(G().A,{...t,disableDefaultClick:!0,disableCloseOnEnter:!0,alignmentToOrigin:J().C.Start,bottomSheetInitialState:"half",renderOrigin:(e,t)=>(0,d.jsx)(K().A,{...e,ref:t,title:(0,d.jsx)(j().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,d.jsx)(U().I,{icon:b().M})}),renderExtension:()=>{const e=m?{menuType:Y().gu.Modal,title:(0,d.jsx)(j().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"})}:{menuType:Y().gu.Popup,width:250},t=[{key:"property-settings",render:e=>(0,d.jsx)(re().lI,{property:l,propertySchema:s,collectionContextStore:p,source:"tableHeaderMenu",buttonPopupParent:u}),action:()=>{}}];return(0,d.jsx)(L().A,{...e,children:(0,d.jsx)(D().Ay,{type:D().Oh.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,d.jsx)(X().A,{...e}),items:t}],onAccept:()=>{}})})},onFocus:a.onFocus})}}),[p,u,m,f,C,a,t,l,s,h,x,g]);return v}function ae(e){const{property:t,propertySchema:a,extensionPopupButtonEvents:l,parent:c}=e,s=(0,o(175116).ET)(),p=(0,r().v3)(),u=(0,i().K8)((()=>s.collectionStore()),[s]),y=s.settingsStore,m=(0,n.useCallback)((e=>{u&&("relation"===e?k().a2({collectionSettingsStore:y,item:{type:"selectRelationSource",property:t,formatKey:"table_properties"}}):B().createAndCommit({userAction:"CollectionSettingsProperty.handlePropertyTypeAccept",environment:p,canUndo:!0,perform:o=>{M().Hj({environment:p,collectionStore:u,property:t,type:e,transaction:o})}}))}),[u,p,t,y]),f=(0,n.useCallback)((e=>{const{propertyType:n}=e;o(181922).g({environment:p,collectionContextStore:s,propertyId:t,propertySchema:a,handlePropertyTypeChange:()=>m(n)})}),[s,p,t,a,m]),h=(0,o(135986).Re)({environment:p,collectionContextStore:s,propertySchema:a,onAccept:f,section:"all"}),x=o(780054).A.isMobile?{menuType:Y().gu.Modal,title:(0,d.jsx)(j().sA,{defaultMessage:"Change type",id:"database.tableHeaderCell.changePropertyType"})}:{menuType:Y().gu.Popup,width:200,height:470};return(0,d.jsx)(L().A,{...x,...l,children:(0,d.jsx)(D().Ay,{type:D().Oh.Vertical,initialFocus:0,sections:[{key:"standard",render:e=>(0,d.jsx)(X().A,{...e}),items:Object.values(h)}],onAccept:c.close})})}const le=n.memo((function(e){const{allowHidingTitle:t,collectionContextStore:p,columnIndex:u,format:m,formatKey:h,parent:g,property:C,schema:W,handleTemporaryNewPropertyInsertion:re}=e,le=(0,j().tz)(),ye=(0,r().v3)(),{isPhone:me,isMobile:fe}=(0,r().Y0)(),he=(0,Z().X)("db_ux_empty_states"),xe=(0,Z().X)("db_ux_properties"),ge=(0,Z().X)("nds_default_property_noticon"),Se=(0,Z().X)("db_ux_phone_remove_bar"),Ce=(0,o(401497).DP)(),{collectionStore:ve,isNonEditableState:be,collectionStoreFormat:Ae}=(0,i().K8)((()=>{const e=p.collectionStore();return{collectionStore:e,isNonEditableState:null==e?void 0:e.isNonEditableState(),collectionStoreFormat:null==e?void 0:e.getFormat()}}),[p]),je=(0,i().K8)((()=>p.collectionViewStore()),[p]),Pe=p.settingsStore,we=(0,i().O$)(p.normalizedQueryStore),_e=(0,i().O$)(p.permissionScopesStore),Ie=(0,i().O$)(p.isInHomeWidgetStore),Te=(0,i().K8)((()=>null==je?void 0:je.getType()),[je]),Me=(0,i().K8)((()=>"collectionTypedView"===p.contextType),[p]),ke=!(0,i().O$)(te().e),Fe=(0,i().K8)((()=>{const{frozenIndex:e}=p.frozoneStore.state;return Boolean(u===e)}),[p,u]),He=(0,i().K8)((()=>{const{frozenIndex:e,scrollerWidth:t}=p.frozoneStore.state;if(void 0===e)return!1;const o=(null==je?void 0:je.getTableMaxFrozenColumnIndex(t,p.normalizedFormatStore.state))??-1;return u>o}),[p,je,u]),Be=(0,i().K8)((()=>{var e;return!(!je||"timeline"===Te)&&Boolean(je.getFormat().table_wrap||(null===(e=de({format:m,formatKey:h,property:C}))||void 0===e?void 0:e.wrap))}),[je,m,h,C,Te]),Ve=(0,n.useMemo)((()=>o(651124).Ts(Ae,C)),[Ae,C]),Oe=(0,i().K8)((()=>null==ve?void 0:ve.getSpaceId()),[ve]),Ee=(0,oe()._X)({name:"collection_property_autofill",spaceId:Oe,userId:ye.currentUser.id,amount:"unknown"}),ze=(0,i().K8)((()=>!ve||(!!ke||(!(0,$().jq)(ye,o(411671).A.getMode(ye,ve),ve)||!!Ve&&(0,ne()._)({taskRunningState:Ve})))),[ve,ye,Ve,ke]),Re=(0,i().K8)((()=>(0,$().O0)(ye)),[ye]),{isTypedProperty:Ke,databaseType:Le}=(0,i().K8)((()=>ve?{isTypedProperty:ve.isTypedProperty(C),databaseType:ve.getDatabaseType()}:{isTypedProperty:!1,databaseType:void 0}),[ve,C]),De=(0,i().uB)(void 0,o(463830).A),Ue=(0,i().K8)((()=>{const e=W[C];return o(685889).pg(p,e)}),[p,C,W]),[We,Xe]=(0,n.useState)(!1),[Ne,Ge]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=W[C];e&&Ge(e.name||"")}),[C,W]),(0,n.useEffect)((()=>{const e=W[C];e&&"relation"===e.type&&(null==Ue||Ue.load())}),[C,W,Ue]);const qe=(0,n.useCallback)((e=>{!function(e){const{collectionContextStore:t,environment:o,inputValue:n,name:r,property:i,schema:a}=e;if(ue({property:i,schema:a,inputValue:n}))return;const l=t.collectionStore();if(!l)return;const c=l.getSchema(),s=c[i];if((null==s?void 0:s.name)===r)return;B().createAndCommit({userAction:"TableHeaderCell.handlePropertyNameSubmit",environment:o,canUndo:!0,perform:e=>{M().YO({collectionStore:l,property:i,name:r,transaction:e})}}),(0,_().V)({environment:o,collectionContextStore:t,property:i,from:"view_settings",action:"rename"})}({collectionContextStore:p,environment:ye,inputValue:Ne,name:e,property:C,schema:W})}),[p,ye,Ne,C,W]),$e=(0,n.useCallback)((e=>{Ge(e)}),[]),Ye=(0,i().K8)((()=>{const e=W[C];if(!je||!e)return[];const n=(0,o(443239).u)(C),r="title"===e.type,i=ke&&(0,E().$)({propertyType:e.type,propertySchema:e,allowAIProperty:!1}),$=[];if(n&&"person"===e.type){const t=[];$.push(t),t.push({key:"synced_person",render:t=>(0,d.jsx)(o(678553).Ay,{...t,title:e.name||"",icon:(0,d.jsx)(U().I,{icon:o(525884).infoCircleIcon}),caption:(0,d.jsx)("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",minWidth:300,maxWidth:350},children:(0,d.jsx)(j().sA,{defaultMessage:"People synced from external sources may require additional set up. Visit <helpcenterlink>the help center</helpcenterlink> for more information.",id:"database.tableHeaderCell.syncedPersonPropertyCaption",values:{helpcenterlink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,d.jsx)(o(719147).A,{href:(0,o(836251).xS)("guides.syncedContent"),children:t})}}})})}),action:()=>{}})}const Z=[];$.push(Z),!_e.canConfigureCollection||n||_e.isExternallyImportedAndSyncedCollection||(Z.push({key:"rename",render:t=>(0,d.jsx)("div",{style:fe?{}:{paddingTop:4},children:(0,d.jsx)(o(755735).B,{...t,initialValue:e.name||"",placeholder:le.formatMessage(o(913687).A.inputPlaceholder),focusInitial:!fe,onChange:$e,onBlur:qe,onSubmit:qe,iconButton:{iconLeading:t=>(0,d.jsx)(o(743176).zB,{type:e.type,icon:e.icon,size:16,theme:Ce,style:t,isDefaultNoticonEnabled:ge}),iconStyle:{fill:o(278238).l8[Ce.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o,n){const r=t.collectionStore();if(!r)return;M().yC({environment:o,collectionStore:r,collectionContextStore:t,property:e,icon:n,from:"table"})}(C,p,ye,e)},inputRightButton:(0,d.jsx)(o(539148).S,{description:e.description,showTooltip:!We,onClick:()=>Xe(!We),addDescriptionText:le.formatMessage(q().Mo.addPropertyDescriptionTooltip),editDescriptionText:le.formatMessage(q().Mo.editPropertyDescriptionTooltip)})})}),action:()=>{(0,I().X)({environment:ye,collectionContextStore:p,action:"table_header_rename"}),(0,z().j)({collectionContextStore:p,environment:ye,fit:"settings"}),g.close()}}),We&&Z.push({key:"description",render:t=>(0,d.jsx)(o(705602).y,{...t,initialDescription:e.description,handleSaveDescription:e=>function(e){var t;const{collectionContextStore:n,description:r,environment:i,property:a}=e,l=n.collectionStore(),c=null==l||null===(t=l.getSchema())||void 0===t?void 0:t[a];if(!l||void 0===c||r===c.description)return;B().createAndCommit({userAction:"CollectionSettingsProperty.handleDescriptionChange",environment:i,canUndo:!0,perform:e=>{(0,o(312296).F)({environment:i,collectionStore:l,update:{[a]:{...c,description:r}},transaction:e})}}),(0,_().V)({environment:i,collectionContextStore:n,property:a,from:"view_properties",action:"set_description"})}({collectionContextStore:p,description:e,environment:ye,property:C}),disableAutoSection:!0}),action:P().lQ}),ue({property:C,schema:W,inputValue:Ne})&&Z.push({key:"duplicate_error",render:e=>(0,d.jsx)(o(653259).A,{...e,propertyName:Ne,styles:fe?{paddingBottom:5,paddingLeft:16,paddingRight:16,margin:0,boxShadow:`inset 0 -1px 0 ${Ce.regularDividerColor}`}:{}}),action:P().lQ}));const te=[];$.push(te);if((0,o(817126).kg)(e)&&te.push({key:"connected_property_upsell",render:()=>(0,d.jsx)(o(611520).uo,{collectionContextStore:p,property:C,compact:!0}),action:()=>{g.close()}}),xe&&r&&_e.canConfigureCollection){const e=i,t=p.shouldShowPageIcon();te.push({key:"show_page_icon",render:n=>(0,d.jsx)(o(574036).A,{...n,on:t,icon:(0,d.jsx)(U().I,{icon:o(424139).emojiFaceIcon}),title:(0,d.jsx)(j().sA,{defaultMessage:"Show page icon",id:"database.tableHeaderCell.showPageIcon"}),disabled:e,disabledFeedback:!0,onClick:()=>{B().createAndCommit({userAction:"TableHeaderCellMenu.handleToggleShowPageIcon",environment:ye,canUndo:!0,perform:e=>{F().zA({stores:[je],update:{show_page_icon:!t},transaction:e})}})}}),action:()=>{(0,I().X)({environment:ye,collectionContextStore:p,action:"table_header_show_page_icon"})}})}if(_e.canConfigureBlock&&!n&&!be&&!_e.isExternallyImportedAndSyncedCollection)if((0,l().nu)(e)&&!xe){const t=Me||(0,c().Jf)({property:C,propertySchema:e,isTypedProperty:Ke});te.push({key:"button_property_change_type",render:e=>(0,d.jsx)(N().A,{placement:J().W.Left,render:o=>(0,d.jsx)("div",{...(0,Q().A)(e,o),role:"button",children:(0,d.jsx)(O().Dy,{disabled:t,isTypedProperty:Ke,collectionUri:Le,collectionContextStore:p,formatKey:h,propertyTypeButtonPopupStore:De,property:C})}),style:{whiteSpace:"normal"},renderTooltip:()=>(0,d.jsx)(j().sA,{defaultMessage:"Change property type",id:"database.tableHeaderCell.buttonPropertyChangeTypeTooltip"})}),action:()=>{g.close()}}),te.push({key:"button_property_edit_automation",render:e=>(0,d.jsx)(N().A,{placement:J().W.Left,render:t=>(0,d.jsx)(K().A,{title:(0,d.jsx)(j().sA,{defaultMessage:"Edit automation",id:"database.tableHeaderCell.buttonPropertyEditAutomationLeft"}),right:(0,d.jsx)(U().I,{icon:o(906380).arrowChevronSingleRightSmallIcon,size:"sm",color:"secondary"}),disabled:ke,disabledFeedback:!0,...(0,Q().A)(e,t)}),style:{whiteSpace:"normal"},renderTooltip:()=>ke?(0,d.jsx)(j().sA,{id:"database.tableHeaderCell.buttonPropertyEditAutomation.offlineTooltip",defaultMessage:"Go online to edit automation"}):(0,d.jsx)(j().sA,{defaultMessage:"Edit button automation",id:"database.tableHeaderCell.buttonPropertyTooltip"})}),action:()=>{g.close(),o(837570).h({environment:ye,mode:"edit_button_property",collectionSettingsStore:Pe,collectionContextStore:p,propertyId:C,propertySchema:e})}})}else{if(xe)(0,c().HB)(e)&&te.push({key:"edit_property",render:(t,o)=>(0,d.jsx)(ie,{menuListProps:t,menuListParent:o,property:C,propertySchema:e,collectionContextStore:p,buttonPopupParent:g}),action:()=>{g.close(),((0,c().V5)(e)||(0,c().di)(e))&&k().Ow({collectionContextStore:p,collectionSettingsStore:Pe,initialStack:[{type:"properties",timelineViewTab:"table"},{type:"property",formatKey:h,property:C}]})}});else{const e=!_e.canConfigureCollection||i;te.push({key:"edit_property",render:t=>(0,d.jsx)(N().A,{placement:J().W.Left,render:o=>(0,d.jsx)(K().A,{title:(0,d.jsx)(j().sA,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:_e.canConfigureCollection?(0,d.jsx)(U().I,{icon:b().M}):(0,d.jsx)(U().I,{icon:S().h}),disabled:e,disabledFeedback:!0,...(0,Q().A)(t,o)}),style:{whiteSpace:"normal"},renderTooltip:()=>i?(0,d.jsx)(j().sA,{id:"database.tableHeaderCell.editProperty.offlineTooltip",defaultMessage:"Go online to edit property"}):_e.canConfigureCollection?(0,d.jsx)(j().sA,{defaultMessage:"Edit property name, type, and other options...",id:"database.tableHeaderCell.editPropertyTooltip"}):(0,d.jsx)(j().sA,{defaultMessage:"You don’t have permission to edit this property",id:"database.tableHeaderCell.editPropertyTooltipDisabled"})}),action:()=>{(0,I().X)({environment:ye,collectionContextStore:p,action:"table_header_edit"}),(0,z().j)({collectionContextStore:p,environment:ye,fit:"settings"}),g.close(),k().Ow({collectionContextStore:p,collectionSettingsStore:Pe,initialStack:[{type:"properties",timelineViewTab:"table"},{type:"property",formatKey:h,property:C}]})}})}const t=Me||(0,c().Jf)({property:C,propertySchema:e,isTypedProperty:Ke});!xe||!_e.canConfigureCollection||n||be||_e.isExternallyImportedAndSyncedCollection||t||te.push({key:"change_property_type",render:(t,n)=>(0,d.jsx)(G().A,{...t,renderOrigin:(e,t)=>(0,d.jsx)(K().A,{...e,ref:t,title:(0,d.jsx)(j().sA,{defaultMessage:"Change type",id:"database.tableHeaderCell.changePropertyType"}),icon:(0,d.jsx)(U().I,{icon:o(3284).arrowSquarePathUpDownIcon})}),renderExtension:t=>(0,d.jsx)(ae,{property:C,propertySchema:e,extensionPopupButtonEvents:t,parent:g}),onFocus:n.onFocus}),action:()=>{g.close()}})}if(_e.canConfigureCollection&&!n&&!_e.isExternallyImportedAndSyncedCollection&&ve&&Ve&&Re&&(0,l().$M)(e)){const t=(0,l().om)(e),n=(0,ne()._)({taskRunningState:Ve});t?te.push({key:"fill_all_pages",render:e=>(0,d.jsx)(N().A,{placement:J().W.Left,renderTooltip:()=>ke?(0,d.jsx)(j().sA,{...w().AY.aiUnavailableOfflineTooltip}):(0,d.jsx)(R().GI,{autofillFeatureAvailability:Ee}),render:t=>(0,d.jsx)(K().A,{titleStyle:{color:ze?Ce.text.tertiary:void 0},disabled:ze,icon:(0,d.jsx)(R().am,{updateAiInferencesTaskStatus:Ve,progressIconStyle:{marginTop:1,marginLeft:0,marginRight:-3}}),title:(0,d.jsx)(R().Ay,{updateAiInferencesTaskStatus:Ve}),caption:n&&"requested"!==Ve.status&&(0,d.jsx)(R().jD,{updateAiInferencesTaskStatus:Ve}),...(0,Q().A)(e,t)})}),action:async()=>{var t,o;const n=await(0,oe().Bw)(ye,{name:"collection_property_autofill",spaceId:null===(t=ee().default.state.currentSpaceStore)||void 0===t?void 0:t.id,userId:null===(o=ee().default.state.currentUserStore)||void 0===o?void 0:o.id,amount:"unknown"});"unavailable"!==n.type?await V().autofillPropertyForCollection({environment:ye,collectionStore:ve,propertySchema:e,property:C,collectionViewStore:je}):(0,V().triggerAiAutofillUpsell)({environment:ye,from:"ai_autofill_fill_all_pages",upsell:n.upsell})}}):te.push({key:"autofill_with_ai",render:e=>(0,d.jsx)(N().A,{placement:J().W.Left,renderTooltip:()=>ke?(0,d.jsx)(j().sA,{...w().AY.aiUnavailableOfflineTooltip}):null,disableTooltip:!ke,render:t=>(0,d.jsx)(K().A,{disabled:void 0===ve||ke,disabledFeedback:void 0===ve||ke,title:(0,d.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,d.jsx)(j().sA,{defaultMessage:"Set up AI autofill",id:"database.tableHeaderCell.autofillWithAI"})}),icon:(0,d.jsx)(U().I,{icon:o(116089).x}),...e,...t})}),action:()=>{ve&&(g.close(),k().Ow({collectionContextStore:p,collectionSettingsStore:Pe}),k().a2({collectionSettingsStore:Pe,item:{type:"properties",timelineViewTab:"table"}}),k().a2({collectionSettingsStore:Pe,item:{type:"property",formatKey:h,property:C}}),"text"===e.type&&k().a2({collectionSettingsStore:Pe,item:{type:"propertyAiAutofill",propertySchema:e,property:C}}))}})}const Ae=[];if($.push(Ae),_e.canConfigureBlock&&((0,s().oH)(e)||(0,c().ah)(e))){(0,c().ah)(e)&&Ae.push({key:"filter",render:e=>me&&Se?(0,d.jsx)(ce,{...e,property:C,collectionContextStore:p,schema:W}):(0,d.jsx)(se,{...e}),action:()=>{"collectionSystemView"!==p.contextType&&((0,I().X)({environment:ye,collectionContextStore:p,action:"table_header_filter"}),function(e){const{collectionContextStore:t,environment:o,property:n,schema:r,isPhone:i,isDBUXPhoneRemoveBarEnabled:a,parent:l}=e,c=T().m({property:n,collectionContextStore:t,environment:o,schema:r});if(!c)return;const s=t.isInHomeWidgetStore.state;if(s)return void k().R8({collectionSettingsStore:t.settingsStore,item:{type:"filters"}});if(i&&a)k().R8({collectionSettingsStore:t.getFilterOptionsItemSettingsStore(c),item:{type:"filter"}});else{t.filtersBarOpenStore.setState(!0);const e=t.getFilterBarItemSettingsStore(c);k().R8({collectionSettingsStore:e,item:{type:"filter"}}),l.close(),(0,z().j)({collectionContextStore:t,environment:o,fit:"filtersBar"})}}({collectionContextStore:p,environment:ye,property:C,schema:W,isPhone:me,isDBUXPhoneRemoveBarEnabled:Se,parent:g}))}});const t={key:"sort_asc",render:e=>(0,d.jsx)(K().A,{...e,title:(0,d.jsx)(j().sA,{defaultMessage:"Sort ascending",id:"database.tableHeaderCell.sortAscending"}),icon:(0,d.jsx)(U().I,{icon:o(112282).s})}),action:()=>{(0,I().X)({environment:ye,collectionContextStore:p,action:"table_header_sort_asc"}),g.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:r}=e;pe({collectionContextStore:o,environment:r,isAscending:!0,property:t,schema:n})}({collectionContextStore:p,environment:ye,property:C,schema:W})}},n={key:"sort_desc",render:e=>(0,d.jsx)(K().A,{...e,title:(0,d.jsx)(j().sA,{defaultMessage:"Sort descending",id:"database.tableHeaderCell.sortDescending"}),icon:(0,d.jsx)(U().I,{icon:o(655923).v})}),action:()=>{(0,I().X)({environment:ye,collectionContextStore:p,action:"table_header_sort_desc"}),g.close(),function(e){const{property:t,collectionContextStore:o,schema:n,environment:r}=e;pe({collectionContextStore:o,environment:r,isAscending:!1,property:t,schema:n})}({collectionContextStore:p,environment:ye,property:C,schema:W})}};if((0,s().oH)(e)&&(xe?Ae.push({key:"sort",render:(e,r)=>(0,d.jsx)(G().A,{...e,renderOrigin:(e,t)=>(0,d.jsx)(K().A,{...e,ref:t,title:(0,d.jsx)(j().sA,{defaultMessage:"Sort",id:"database.tableHeaderCell.sort"}),icon:(0,d.jsx)(U().I,{icon:o(582684).C})}),renderExtension:e=>{let o;return o=ye.device.isMobile?{menuType:Y().gu.Modal}:{menuType:Y().gu.Popup,width:200},(0,d.jsx)(L().A,{...o,...e,children:(0,d.jsx)(D().Ay,{type:D().Oh.Vertical,initialFocus:0,sections:[{key:"sections",render:e=>(0,d.jsx)(X().A,{...e}),items:[t,n]}],onAccept:g.close})})},onFocus:r.onFocus}),action:()=>{}}):(Ae.push(t),Ae.push(n))),(0,a().Eg)(e)&&xe){const t=p.normalizedFormatStore.state.collection_group_by,n=(null==t?void 0:t.property)===C;Ae.push({key:"group_by_or_ungroup",render:e=>(0,d.jsx)(K().A,{...e,title:n?(0,d.jsx)(j().sA,{defaultMessage:"Ungroup",id:"database.tableHeaderCell.ungroup"}):(0,d.jsx)(j().sA,{defaultMessage:"Group",id:"database.tableHeaderCell.group"}),icon:(0,d.jsx)(U().I,{icon:o(871151).p})}),action:()=>{if(g.close(),n){if(!je)return;!function(e){const{collectionContextStore:t,environment:o,propertySchema:n}=e,r=t.collectionViewStore();if(!r||!n)return;B().createAndCommit({userAction:"TableHeaderCellMenu.handleUngroupBy",environment:o,canUndo:!0,perform:e=>{F().zA({stores:[r],update:{collection_group_by:void 0,collection_groups:void 0},transaction:e})}}),(0,I().X)({environment:o,collectionContextStore:t,action:"table_header_ungroup_by",original_view_type:void 0,property_type:n.type})}({collectionContextStore:p,environment:ye,propertySchema:e})}else!function(e){const{collectionContextStore:t,environment:o,property:n,schema:r}=e,i=t.collectionViewStore(),l=r[n];if(!i||!l)return;if(!(0,a().Eg)(l))return;const c=(0,a().V0)({property:n,propertySchema:l,isCollectionTypedView:"collectionTypedView"===t.contextType});B().createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:o,canUndo:!0,perform:e=>{F().zA({stores:[i],update:{collection_group_by:c,collection_groups:void 0},transaction:e})}}),(0,I().X)({environment:o,collectionContextStore:t,action:"table_header_group_by",original_view_type:void 0,property_type:l.type})}({collectionContextStore:p,environment:ye,property:C,schema:W})}})}he&&we&&Ae.push({key:"calculate",render:(e,t)=>(0,d.jsx)(G().A,{...e,renderOrigin:(e,t)=>(0,d.jsx)(N().A,{placement:J().W.Left,disableTooltip:!ke,renderTooltip:()=>(0,d.jsx)(j().sA,{id:"database.tableHeaderCell.calculate.offlineTooltip",defaultMessage:"Unavailable while offline"}),render:n=>(0,d.jsx)(K().A,{...(0,Q().A)(n,e),ref:t,title:(0,d.jsx)(j().sA,{defaultMessage:"Calculate",id:"database.tableHeaderCell.calculate"}),icon:(0,d.jsx)(U().I,{icon:o(585639).v}),disabled:ke,disabledFeedback:!0})}),renderExtension:(e,t)=>{var n;return ke?null:(0,d.jsx)(o(195071).A,{property:C,schema:W,currentAggregation:null===(n=we.aggregations)||void 0===n?void 0:n.find((e=>e.property===C)),onChange:e=>{let{aggregationType:t,enforceMaxAggregationLimit:n}=e;const r=t?{aggregator:t,property:C,enforceMaxAggregationLimit:n}:void 0;(0,o(500733).I)({collectionContextStore:p,environment:ye,query:we,property:C,newAggregation:r})},onClose:g.close,source:"tableAggregation"})},onFocus:t.onFocus}),action:()=>{}})}!_e.canConfigureBlock||Ie||me||Ae.push({key:"freeze_column",render:e=>(0,d.jsx)(N().A,{placement:J().W.Left,disableTooltip:!He,renderTooltip:e=>(0,d.jsx)(j().sA,{...e,defaultMessage:"Insufficient space to freeze columns",id:"database.tableHeaderCell.freezePropertyTooltip",description:"If the width of the frozen columns is wider than the screen, show the user this tooltip warning."}),render:t=>(0,d.jsx)(K().A,{...e,...t,disabled:He,buttonStyle:{color:He?Ce.text.quaternary:void 0},title:Fe?(0,d.jsx)(j().sA,{defaultMessage:"{numberFrozenColumns, plural, one {Unfreeze column} other {Unfreeze columns}}",values:{numberFrozenColumns:u+1},id:"database.tableHeaderCell.unfreezeColumns"}):xe?(0,d.jsx)(j().sA,{defaultMessage:"Freeze",id:"database.tableHeaderCell.freeze"}):(0,d.jsx)(j().sA,{defaultMessage:"Freeze up to column",id:"database.tableHeaderCell.freezeUpToColumn"}),icon:Fe?(0,d.jsx)(U().I,{icon:v}):(0,d.jsx)(U().I,{icon:o(230979).N})})}),action:()=>{!function(e){const{collectionContextStore:t,columnIndex:o,environment:n}=e;B().createAndCommit({userAction:"TableHeaderCell.handleFreezeColumns",environment:n,canUndo:!0,perform:e=>{H().sp({environment:n,collectionContextStore:t,currentIndex:o,transaction:e,entrypoint:"TableHeaderCell",propertyAction:"toggle"})}})}({collectionContextStore:p,columnIndex:u,environment:ye})}}),(t||"title"!==e.type)&&_e.canConfigureBlock&&Ae.push({key:"hide",render:e=>(0,d.jsx)(K().A,{...e,title:xe?(0,d.jsx)(j().sA,{defaultMessage:"Hide",id:"database.tableHeaderCell.hide"}):(0,d.jsx)(j().sA,{defaultMessage:"Hide in view",id:"database.tableHeaderCell.hideInView"}),icon:(0,d.jsx)(U().I,{icon:o(566910).e})}),action:()=>{(0,I().X)({environment:ye,collectionContextStore:p,action:"table_header_hide"}),g.close(),function(e){const{collectionContextStore:t,columnIndex:n,environment:r,format:i,formatKey:a,property:l}=e,c=t.collectionViewStore();if(!c)return;const s=i[a]||[],p=s.map((e=>e.property===l?{...e,visible:!1}:e)),d={...i,[a]:p};B().createAndCommit({userAction:"TableHeaderCell.updatePropertyFormat",environment:r,canUndo:!0,perform:e=>{(0,o(654062).F)({collectionViewStore:c,update:{format:d},transaction:e}),H().sp({environment:r,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"hide"})}})}({collectionContextStore:p,columnIndex:u,environment:ye,format:m,formatKey:h,property:C})}}),_e.canConfigureBlock&&"timeline"!==Te&&Ae.push({key:"wrap_cell",render:e=>(0,d.jsx)(K().A,{...e,title:Be?(0,d.jsx)(j().sA,{defaultMessage:"Unwrap text",id:"database.tableHeaderCell.unwrapText"}):(0,d.jsx)(j().sA,{defaultMessage:"Wrap text",id:"database.tableHeaderCell.wrapText"}),icon:(0,d.jsx)(U().I,{icon:Be?y:o(871114).o})}),action:()=>{H().Nv({currentValue:Be,environment:ye,property:C,collectionViewStore:je,format:m,formatKey:h}),g.close(),(0,I().X)({environment:ye,collectionContextStore:p,action:"table_header_wrap_column"})}});const Oe=[];if($.push(Oe),xe&&ve&&_e.canConfigureCollection&&(Oe.push({key:"insert_left",render:e=>(0,d.jsx)(K().A,{...e,title:(0,d.jsx)(j().sA,{defaultMessage:"Insert left",id:"database.tableHeaderCell.insertLeft"}),icon:(0,d.jsx)(U().I,{icon:f})}),action:()=>{g.close(),re("left")}}),Oe.push({key:"insert_right",render:e=>(0,d.jsx)(K().A,{...e,title:(0,d.jsx)(j().sA,{defaultMessage:"Insert right",id:"database.tableHeaderCell.insertRight"}),icon:(0,d.jsx)(U().I,{icon:x})}),action:()=>{g.close(),re("right")}})),(0,l().vB)(e)&&ve&&_e.canConfigureCollection&&!n&&!r&&!_e.isExternallyImportedAndSyncedCollection){const e=i;Oe.push({key:"duplicate",render:t=>(0,d.jsx)(N().A,{disableTooltip:!e,placement:J().W.Left,render:n=>(0,d.jsx)(K().A,{...(0,Q().A)(t,n),title:(0,d.jsx)(j().sA,{defaultMessage:"Duplicate property",id:"database.tableHeaderCell.duplicateProperty"}),icon:(0,d.jsx)(U().I,{icon:o(764781).V}),disabled:e,disabledFeedback:!0}),renderTooltip:()=>(0,d.jsx)(j().sA,{id:"database.tableHeaderCell.duplicateProperty.offlineTooltip",defaultMessage:"Unavailable while offline"})}),action:async()=>{(0,I().X)({environment:ye,collectionContextStore:p,action:"table_header_duplicate"}),g.close(),await async function(e){const{collectionContextStore:t,columnIndex:n,environment:r,format:i,formatKey:a,property:l}=e,c=de({format:i,formatKey:a,property:l}),s=t.collectionStore(),p=t.collectionViewStore(),d=t.normalizedFormatStore.state[a]||[],u=null==s?void 0:s.getSpaceId();if(!(s&&p&&u&&c))return;const y=s.getSchema(),m=y[l];if(!m)return;const f=s.getNormalizedPropertyGroups(),h=await(0,o(519839).W4)({environment:r,schema:y,property:l,properties:d,propertyGroups:f,parentStore:s,spaceId:u});if(!h)return;const x=r.currentUser.id,g=x?{id:x,table:A().oo}:void 0,{automationActions:S}=await o(813297).QV.automations.load(),C={...y,[h.newProperty]:h.newPropertySchema},v=s.getFormat(),b={...v,collection_page_properties:h.newProperties,property_groups:h.newPropertyGroups};B().createAndCommit({userAction:"TableHeaderCell.handleDuplicate",environment:r,canUndo:!0,perform:e=>{(0,o(797535).I)({environment:r,collectionStore:s,update:{schema:C,format:b},transaction:e}),H().sp({environment:r,collectionContextStore:t,currentIndex:n,entrypoint:"TableHeaderCell",transaction:e,propertyAction:"duplicate"}),(0,o(534177).O9)(h.automationUpdate)&&S.duplicateAutomation({actorPointer:g,environment:r,sourceAutomationStore:h.automationUpdate.sourceAutomationStore,targetAutomationId:h.automationUpdate.targetAutomationId,transaction:e}),a&&F().zA({stores:[p],update:{[a]:h.newProperties},transaction:e})}}),(0,I().X)({environment:r,collectionContextStore:t,action:"duplicate_property",original_view_type:null==p?void 0:p.getType(),property_type:m.type})}({collectionContextStore:p,columnIndex:u,environment:ye,format:m,formatKey:h,property:C})}})}return l().cN.includes(e.type)&&ve&&_e.canConfigureCollection&&!n&&!r&&!_e.isExternallyImportedAndSyncedCollection&&Oe.push({key:"delete",render:e=>(0,d.jsx)(o(437426).$,{...e,property:C,collectionContextStore:p}),action:async()=>{g.close(),await(0,o(358354).I)({collectionContextStore:p,columnIndex:u,updateFrozenColumnEntrypoint:"TableHeaderCell",updateFrozenColumn:!0,environment:ye,property:C,schema:W,theme:Ce,from:"table_column"})}}),$}),[he,xe,ge,re,we,t,Ee,De,He,p,Pe,ve,je,u,Le,ye,m,h,$e,qe,Ne,le,ze,Re,Ie,fe,Me,be,ke,me,Fe,Ke,g,_e.canConfigureBlock,_e.canConfigureCollection,_e.isExternallyImportedAndSyncedCollection,C,W,We,Ve,Ce,Te,Be,Se]),Qe=(0,n.useMemo)((()=>P().oE(Ye.map(((e,t)=>{if(e.length>0){const o=t>0&&0===Ye[t-1].length;return{key:t,render:e=>(0,d.jsx)(X().A,{...e,topBorder:0!==t&&1!==t&&!o,style:0===t?{padding:0}:{}}),items:e}}})))),[Ye]),Ze=fe?{menuType:Y().gu.Modal,minWidth:void 0,title:(0,d.jsx)(j().sA,{id:"database.tableHeaderCell.title",defaultMessage:"Edit property"})}:{menuType:Y().gu.Popup,minWidth:220};return(0,d.jsx)(L().A,{...Ze,children:(0,d.jsx)(D().Ay,{type:D().Oh.Vertical,initialFocus:void 0,sections:Qe})})}));function ce(e){const{collectionContextStore:t,property:r,schema:a}=e,l=(0,i().K8)((()=>t.collectionViewStore()),[t]),c=(0,i().K8)((()=>t.currentPropertyFiltersStore.state.find((e=>e.filter.property===r))),[t,r]),s=(0,i().K8)((()=>{if(c)return t.getFilterOptionsItemSettingsStore(c)}),[c,t]),p=(0,i().K8)((()=>!!s&&s.state.open),[s]),u=(0,n.useCallback)((()=>{s&&k().os({collectionSettingsStore:s})}),[s]),y=(0,n.useCallback)((()=>{if(s&&c&&l)return(0,d.jsx)(o(866913).q,{collectionContextStore:t,collectionSettingsStore:s,collectionViewStore:l,context:o(300089).aV.SettingsFilters,filter:c,schema:a})}),[t,s,c,l,a]);return(0,d.jsx)(W().Ay,{trapFocus:!0,open:p,popupType:W().nl.BottomSheet,origin:(0,d.jsx)(se,{...e,showExtensionArrow:!0}),onDismiss:u,render:y})}function se(e){return(0,d.jsx)(K().A,{...e,title:(0,d.jsx)(j().sA,{defaultMessage:"Filter",id:"database.tableHeaderCell.filter"}),icon:(0,d.jsx)(U().I,{icon:g().S})})}function pe(e){const{collectionContextStore:t,environment:o,isAscending:n,property:r,schema:i}=e;if(!i[r])return;const a=[{property:r,direction:n?"ascending":"descending"}];t.filtersBarOpenStore.setState(!0),T().IU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryStateStore.state,sorts:{value:a}}}),(0,z().j)({collectionContextStore:t,environment:o,fit:"filtersBar"})}function de(e){var t;const{format:o,formatKey:n,property:r}=e;return null===(t=o[n])||void 0===t?void 0:t.find((e=>e.property===r))}function ue(e){const{inputValue:t,property:o,schema:n}=e,r=Object.keys(n).find((e=>{var r;return e!==o&&(null===(r=n[e])||void 0===r?void 0:r.name)===t}));return Boolean(r)}},207583:(e,t,o)=>{o.d(t,{F:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("eyeHideInversePadded",{viewBox:"0 0 24 24",svg:(0,n.jsx)("path",{d:"M17.3867 18.1074C17.6055 18.3193 17.9404 18.333 18.1592 18.1074C18.3848 17.875 18.3711 17.5469 18.1592 17.335L6.5791 5.76855C6.37402 5.55664 6.01855 5.5498 5.80664 5.76855C5.60156 5.97363 5.60156 6.3291 5.80664 6.53418L17.3867 18.1074ZM12 6.1582C10.8105 6.1582 9.73047 6.36328 8.72559 6.69141L9.81934 7.78516C10.5098 7.58691 11.2275 7.4707 12 7.4707C16.3682 7.4707 19.8408 11.2715 19.8408 12.0713C19.8408 12.6113 18.7334 14.0059 16.9766 15.1064L17.9883 16.125C20.1348 14.7168 21.3857 12.8779 21.3857 12.0713C21.3857 10.6699 17.6055 6.1582 12 6.1582ZM12 17.9912C13.2646 17.9912 14.4199 17.7725 15.4658 17.4102L14.3789 16.3232C13.6338 16.542 12.8477 16.6787 12 16.6787C7.63184 16.6787 4.15918 13.0283 4.15918 12.0713C4.15918 11.6133 5.32129 10.1299 7.19434 8.98145L6.16211 7.94922C3.92676 9.37109 2.60742 11.251 2.60742 12.0713C2.60742 13.4727 6.46973 17.9912 12 17.9912ZM15.4111 13.3906C15.5889 12.9873 15.6914 12.5361 15.6914 12.0713C15.6914 10.0137 14.0508 8.39355 12 8.39355C11.5283 8.39355 11.084 8.48242 10.6738 8.65332L15.4111 13.3906ZM12 15.7559C12.5332 15.7559 13.0322 15.6328 13.4766 15.4209L8.64355 10.5811C8.4248 11.0322 8.30176 11.5312 8.30176 12.0781C8.30859 14.0811 9.94238 15.7559 12 15.7559Z"})})},358354:(e,t,o)=>{o.d(t,{B:()=>s,I:()=>c});var n=()=>o(966759),r=()=>o(235191),i=()=>o(854593),a=()=>o(4319),l=()=>o(751156);async function c(e){let{theme:t,collectionContextStore:o,environment:n,property:r,from:a,schema:l,onDeleteCompleted:c,...p}=e;await i().q({environment:n,collectionContextStore:o,property:r,handleDeleteAccept:async()=>{await s({collectionContextStore:o,environment:n,property:r,schema:l,from:a,...p}),null==c||c()},theme:t,from:a})}async function s(e){const{collectionContextStore:t,environment:o,property:i,schema:c,from:s,...p}=e,d=t.collectionStore();if(!d)return;const u=d.getSchema()[i];await l().createAndCommitAsync({environment:o,userAction:"TableHeaderCell.handleDeleteAccept",waitForServerCommit:!1,perform:async e=>{await r().PF({environment:o,collectionStore:d,schema:c,property:i,transaction:e}),p.updateFrozenColumn&&a().sp({environment:o,collectionContextStore:t,currentIndex:p.columnIndex,entrypoint:p.updateFrozenColumnEntrypoint,transaction:e,propertyAction:"delete"})}}),u&&(0,n().i)({environment:o,collectionContextStore:t,property_type:u.type,from:s,property:i})}},437426:(e,t,o)=>{o.d(t,{$:()=>c});var n=o(296540),r=()=>o(56366),i=()=>o(895876),a=()=>o(8980),l=o(474848);const c=n.memo(n.forwardRef((function(e,t){let{collectionContextStore:c,property:s,iconTransformer:p=(e=>e),getTitleOverride:d,...u}=e;const{isMobile:y}=(0,o(484714).Y0)(),m=(0,r().K8)((()=>c.collectionStore()),[c]),f=(0,r().K8)((()=>null==m?void 0:m.getDatabaseType()),[m]),h=(0,r().K8)((()=>Boolean(m&&f&&o(313892).jP((0,o(617254).appConfigs)(),f,s,m))),[m,f,s]),x=(0,n.useCallback)((e=>(0,i().eF)(f,e)),[f]),g=(0,n.useCallback)((e=>(0,l.jsx)(o(760217).A,{...u,...e,disabled:h,disabledFeedback:h,title:(null==d?void 0:d({isRequiredProperty:h}))??(0,l.jsx)(o(959013).sA,{defaultMessage:"Delete property",id:"database.tableHeaderCell.deleteProperty"}),caption:y&&h?(0,i().eF)(f):null,icon:p(h?(0,l.jsx)("div",{...e,children:(0,l.jsx)(a().I,{icon:o(471095).i})}):(0,l.jsx)(a().I,{icon:o(236262).trashIcon})),isRedOnHover:!0})),[f,d,p,y,h,u]);return(0,l.jsx)(o(859428).A,{placement:o(962730).W.Left,disableTooltip:!h,renderTooltip:x,render:g})})))},525884:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>r,infoCircleIcon:()=>i});o(296540);var n=o(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M8.65 8.25a.625.625 0 1 0 0 1.25h.725v3.25H8.65a.625.625 0 1 0 0 1.25h2.7a.625.625 0 1 0 0-1.25h-.725V8.875A.625.625 0 0 0 10 8.25zM10.7 6.3a.8.8 0 1 1-1.6 0 .8.8 0 0 1 1.6 0"}),(0,n.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},i=(0,o(340498).wt)("infoCircle",r)},582684:(e,t,o)=>{o.d(t,{C:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.24 3.26 15.53 13.47",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M14.075 3.45a.625.625 0 0 0-.884 0l-3.497 3.5a.625.625 0 0 0 .883.884l2.431-2.431v10.705a.625.625 0 0 0 1.25 0V5.402l2.431 2.43a.625.625 0 1 0 .884-.883zM2.427 12.167a.625.625 0 0 1 .884 0l2.43 2.431V3.893a.625.625 0 0 1 1.25 0v10.705l2.431-2.43a.625.625 0 0 1 .884.883L6.81 16.55a.625.625 0 0 1-.884 0l-3.498-3.498a.625.625 0 0 1 0-.884"})},r=(0,o(340498).wt)("arrowUpDown",n)},673964:(e,t,o)=>{o.d(t,{j:()=>i});var n=()=>o(953418),r=()=>o(129522);function i(e){const{collectionContextStore:t,environment:o,fit:i}=e,a=t.collectionViewBlockStore();if(a){const e=r().K.findCollectionViewBlockFromStore(a);if(e){var l;const t=null===(l=e.getNode())||void 0===l?void 0:l.firstChild;t instanceof HTMLElement&&(0,n().$v)({blockAlignment:"start",element:t,environment:o,behavior:"instant",additionalPadding:{top:"filtersBar"===i?64:128},verticalVisibilityRequirement:"topVisible",horizontalVisibilityRequirement:"none"})}}}},871202:(e,t,o)=>{o.r(t),o.d(t,{hasAccessDefaultFn:()=>g,hasAccessToCode:()=>b,hasAccessToProperty:()=>v,hasReadPermissionsAccess:()=>S,hasSameSpaceAccess:()=>C,testOnly:()=>A});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520);var n=()=>o(496603),r=()=>o(763824),i=()=>o(973647),a=()=>o(534177),l=()=>o(970013),c=()=>o(247331),s=()=>o(443881),p=()=>o(977345),d=()=>o(501053),u=()=>o(373907);function*y(e){const{collectionPointer:t,context:o,propertyId:n,propertySchema:r,visitedPointers:i,hasAccessFn:a}=e,l=(0,s().G7)({...t,propertyId:n});if(i.has(l))return!0;i.add(l);const c=a({propertySchema:r,spaceId:o.spaceId});return"boolean"==typeof c?c:yield*c}function*m(e){var t,o;const{collectionPointer:r,depth:d,collectionSchema:y,context:m,propertyId:f,propertySchema:h,visitedPointers:g,hasAccessFn:S}=e;if("v2"!==h.version||d>c().FORMULA_MAX_DEPTH)return!1;const C=(0,s().G7)({...r,propertyId:f});if(g.has(C))return!0;if(g.add(C),!(0,a().O9)(null===(t=h.formula2)||void 0===t?void 0:t.code))return!0;const v=(0,u().$t)(null===(o=h.formula2)||void 0===o?void 0:o.code);if(i().Q.isFail(v))return!0;const{spaceId:b}=m,A=(0,s().zm)({formulaTypecheckContextValues:[{kind:c().FormulaContextValueKind.ThisRow,type:{collection:r,type:"block"}}],node:v.value,spaceId:b}),j=(0,n().hS)(A,(e=>(0,s().G7)(e)));if(0===j.length)return!0;const{getRecordModel:P}=yield{collectionBlockProperties:[{blockPointers:[],collectionPointer:r,property:f,schema:y}],recordPointers:j.filter((e=>(0,p().T3)(e)))};for(const n of j)if((0,l().pq)(n)){const e=P(n);if(!(0,a().O9)(e))return!1;const t=n.propertyId,o=e.getSchema(),r=o[t];if(!r)continue;if((0,l().bT)(r)||(0,l().lb)(r)){if(!(yield*x({collectionPointer:n,collectionSchema:o,context:m,depth:d+1,propertyId:t,propertySchema:r,visitedPointers:g,hasAccessFn:S})))return!1}else if((0,l().nC)(r)){if(!(yield*x({collectionPointer:n,collectionSchema:o,context:m,depth:d,propertyId:t,propertySchema:r,visitedPointers:g,hasAccessFn:S})))return!1}}else if(!(0,a().O9)(P(n)))return!1;return!0}function*f(e){const{collectionPointer:t,depth:o,collectionSchema:n,context:r,propertyId:i,propertySchema:a,visitedPointers:p,hasAccessFn:u}=e;if("v2"===a.version||o>c().FORMULA_MAX_DEPTH)return!1;const y=(0,s().G7)({...t,propertyId:i});if(p.has(y))return!0;p.add(y);const m=(0,d().kh)(a.formula);if(0===m.length)return!0;for(const c of m){const e=n[c];if(e)if((0,l().bT)(e)||(0,l().lb)(e)){if(!(yield*x({collectionPointer:t,depth:o+1,collectionSchema:n,context:r,propertyId:c,propertySchema:e,visitedPointers:p,hasAccessFn:u})))return!1}else if((0,l().nC)(e)){if(!(yield*x({collectionPointer:t,collectionSchema:n,context:r,depth:o,propertyId:c,propertySchema:e,visitedPointers:p,hasAccessFn:u})))return!1}}return!0}function*h(e){const{collectionPointer:t,depth:o,collectionSchema:n,context:r,propertyId:i,propertySchema:a,visitedPointers:p,hasAccessFn:d}=e;if(o>c().FORMULA_MAX_DEPTH)return!1;const u=(0,s().G7)({...t,propertyId:i});if(p.has(u))return!0;if(p.add(u),!a.relation_property||!a.target_property)return!0;const y=n[a.relation_property];if(!y||"relation"!==y.type)return!0;const m=d({propertySchema:y,spaceId:r.spaceId});if(!("boolean"==typeof m?m:yield*m))return!1;const f=(0,l().Nv)(y);if(!f)return!0;const{getRecordModel:h}=yield{recordPointers:[f]},g=h(f),S=null==g?void 0:g.getNormalizedSchema();if(a.target_property_type&&S){const e=S[a.target_property];if(e&&a.target_property_type===e.type){if((0,l().lb)(e))return yield*x({collectionPointer:f,collectionSchema:S,context:r,depth:o+1,propertyId:a.target_property,propertySchema:e,visitedPointers:p,hasAccessFn:d});if((0,l().nC)(e))return yield*x({collectionPointer:f,collectionSchema:S,context:r,depth:o,propertyId:a.target_property,propertySchema:e,visitedPointers:p,hasAccessFn:d})}}return!0}function*x(e){const{collectionPointer:t,depth:o,collectionSchema:n,context:r,propertyId:i,propertySchema:a,visitedPointers:c,hasAccessFn:s}=e;return(0,l().nC)(a)?yield*y({collectionPointer:t,context:r,propertyId:i,propertySchema:a,visitedPointers:c,hasAccessFn:s}):(0,l().lb)(a)?"v2"===a.version?yield*m({collectionPointer:t,depth:o,collectionSchema:n,context:r,propertyId:i,propertySchema:a,visitedPointers:c,hasAccessFn:s}):yield*f({collectionPointer:t,depth:o,collectionSchema:n,context:r,propertyId:i,propertySchema:a,visitedPointers:c,hasAccessFn:s}):!(0,l().bT)(a)||(yield*h({collectionPointer:t,depth:o,collectionSchema:n,context:r,propertyId:i,propertySchema:a,visitedPointers:c,hasAccessFn:s}))}function*g(e){const{propertySchema:t,spaceId:o}=e,n=(0,l().Nv)(t);if(!(0,a().O9)(n))return!0;const{getRecordModel:r}=yield{recordPointers:[n]},i=r(n);return(0,a().O9)(i)&&C({spaceId:o,propertySchema:t})}function*S(e){const{propertySchema:t}=e,o=(0,l().Nv)(t);if(!(0,a().O9)(o))return!0;const{getRecordModel:n}=yield{recordPointers:[o]},r=n(o);return(0,a().O9)(r)}function C(e){const{propertySchema:t,spaceId:o}=e;return!(0,l().o2)(o,t)}async function v(e){const{collectionPointer:t,collectionSchema:o,context:n,propertyId:i,hasAccessFn:a}=e,l=o[i];return!l||await async function(e){const{context:t}=e;try{const o=x(e);let n=o.next();for(;!n.done;){const e=t.handleDataRequest(n.value);n=o.next((0,r().yL)(e)?await e:e)}return n.value}catch(o){return!0}}({collectionPointer:t,depth:0,collectionSchema:o,context:n,propertyId:i,propertySchema:l,visitedPointers:new Set,hasAccessFn:a})}function b(e){const{context:t}=e;try{const o=function*(e){const{collectionPointer:t,depth:o,context:r,code:d,visitedPointers:y,hasAccessFn:m}=e,f=(0,u().$t)(d);if(i().Q.isFail(f))return!0;const{spaceId:h}=r,g=r.valueTypes.filter((e=>e.kind!==c().FormulaContextValueKind.ThisRow)),S=(0,s().zm)({formulaTypecheckContextValues:t?[...g,{kind:c().FormulaContextValueKind.ThisRow,type:{collection:t,type:"block"}}]:[],node:f.value,spaceId:h}),C=(0,n().hS)(S,(e=>(0,s().G7)(e)));if(0===C.length)return!0;const{getRecordModel:v}=yield{collectionBlockProperties:[],recordPointers:C.filter((e=>(0,p().T3)(e)))};for(const n of C)if((0,l().pq)(n)){const e=v(n);if(!(0,a().O9)(e))return!1;const t=n.propertyId,i=e.getSchema(),c=i[t];if(!c)continue;if((0,l().bT)(c)||(0,l().lb)(c)){if(!(yield*x({collectionPointer:n,collectionSchema:i,context:r,depth:o+1,propertyId:t,propertySchema:c,visitedPointers:y,hasAccessFn:m})))return!1}else if((0,l().nC)(c)&&!(yield*x({collectionPointer:n,collectionSchema:i,context:r,depth:o,propertyId:t,propertySchema:c,visitedPointers:y,hasAccessFn:m})))return!1}else if(!(0,a().O9)(v(n)))return!1;return!0}(e);let r=o.next();for(;!r.done;){const e=t.handleDataRequest(r.value);r=o.next(e)}return r.value}catch(o){return!0}}const A={hasAccessDefaultFn:g,hasAccessToProperty:v,hasAccessToFormula1Property:f,hasAccessToFormula2Property:m,hasAccessToRelationProperty:y,hasAccessToRollupProperty:h}},965134:(e,t,o)=>{o.d(t,{i:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"0.38 5.51 19.25 8.97",svg:(0,o(474848).jsx)("path",{d:"M8.793 6.767c-.816 0-1.472.465-1.71 1.036a.625.625 0 1 1-1.154-.482C6.38 6.242 7.52 5.517 8.794 5.517c1.618 0 3.068 1.181 3.068 2.786a2.62 2.62 0 0 1-.762 1.835l-3.312 3.095h3.637a.625.625 0 1 1 0 1.25h-5.22a.625.625 0 0 1-.427-1.081l4.453-4.163a1.37 1.37 0 0 0 .381-.936c0-.775-.742-1.536-1.818-1.536m7.576 0c-.868 0-1.508.425-1.724.877a.625.625 0 0 1-1.127-.54c.473-.99 1.629-1.587 2.85-1.587.799 0 1.546.247 2.107.675.56.429.962 1.066.962 1.819s-.401 1.39-.962 1.819l-.036.026q.085.056.165.116c.595.448 1.02 1.114 1.02 1.902s-.425 1.454-1.02 1.903c-.595.448-1.388.706-2.236.706-1.287 0-2.488-.6-3.008-1.6a.625.625 0 1 1 1.108-.577c.252.484.952.927 1.9.927.602 0 1.125-.185 1.484-.455.358-.27.522-.595.522-.904 0-.308-.164-.634-.522-.904-.359-.27-.882-.455-1.484-.455h-.554a.625.625 0 0 1 0-1.25h.44a1 1 0 0 1 .114-.01c.549 0 1.023-.17 1.348-.419.323-.247.47-.544.47-.825s-.147-.579-.47-.826c-.325-.247-.8-.418-1.348-.418M3.731 6.22l.005.078v7.56a.625.625 0 0 1-1.25 0V7.21l-1.182.658a.625.625 0 0 1-.608-1.092L2.806 5.6a.625.625 0 0 1 .925.62"})},r=(0,o(340498).wt)("numbers123",n)}}]);