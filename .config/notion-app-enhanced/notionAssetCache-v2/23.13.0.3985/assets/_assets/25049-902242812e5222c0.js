"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[25049],{26408:(e,t,i)=>{function n(e){const{buttonsStore:t,buttonName:i,buttonState:n}=e;t.setState({buttons:{...t.state.buttons,[i]:n}})}i.d(t,{E:()=>n})},253271:(e,t,i)=>{i.d(t,{A:()=>o});class n extends(()=>i(757695))().Store{getInitialState(){return{buttons:{}}}}const o=n},293311:(e,t,i)=>{i.d(t,{m:()=>o});const n={small:600,medium:800,large:1020,giant:1380};function o(e,t,i){const{WindowSizeStore:o}=e,a="number"==typeof i?i:n[i];return"minWidth"===t?o.state.width>=a:o.state.width<=a}},486155:(e,t,i)=>{i.d(t,{s:()=>v});i(296540);var n=()=>i(484714),o=()=>i(56366),a=()=>i(416845),s=()=>i(62926),r=()=>i(959013),l=()=>i(26408),c=()=>i(554509),d=()=>i(898486),u=()=>i(406792),g=()=>i(789690),m=()=>i(757856),p=i(474848);function v(e){const{loginStore:t,buttonsStore:i,showInvitationVersion:v,isMobile:f,themeOverride:h,isSmallScreen:y,callbackType:w}=e,S=(0,n().Y0)(),b=(0,n().v3)(),k=(0,r().tz)(),A=(0,o().K8)((()=>"loading"===(null==i?void 0:i.state.buttons.loginWithPasskeyButton)),[i]),T=(0,o().K8)((()=>(null==t?void 0:t.state.forceAdminSamlLogin)??!1),[t]),I=(0,r().YK)({message:{id:"passkey.genericError",defaultMessage:"Something went wrong; please try another sign-in option or follow the instructions on your device for passkeys"}}),N=k.formatMessage(I.message);return S.isBannedGoogleSSOUserAgent||T?null:(0,p.jsx)("div",{style:{width:"100%"},children:(0,p.jsx)(m().F,{onClick:async()=>{if(l().E({buttonsStore:i,buttonName:"loginWithPasskeyButton",buttonState:"loading"}),S.isElectronAny||S.isMobileNativeCalendar)g().YN(b);else{if(w)return void(await g().BU(b,w));{let i;u().default.mark("login_time.passkey");try{i=await g().ho({environment:b,showInvitationVersion:v,isMobile:f})}catch(e){e instanceof a().Cdc&&(null==t||t.setState({...null==t?void 0:t.state,alert:k.formatMessage(d().Ou.cant_access_workspace_from_network)}))}"boolean"==typeof i&&(null==t||t.setState({...null==t?void 0:t.state,alert:N}))}}l().E({buttonsStore:i,buttonName:"loginWithPasskeyButton",buttonState:"idle"})},iconFn:s().a,iconStyles:{width:y?20:16,height:y?20:16,position:"absolute",left:10},getLabel:()=>v?(0,p.jsx)(c().D,{styleName:"UIRegular-14px/Medium",children:(0,p.jsx)(r().sA,{id:"loginForm.verifyWithPasskeyButton.label",defaultMessage:"Verify with Passkey"})}):(0,p.jsx)(c().D,{styleName:"UIRegular-14px/Medium",children:(0,p.jsx)(r().sA,{id:"loginForm.loginWithPasskeyButton.label",defaultMessage:"Log in with passkey"})}),isLoading:A,themeOverride:h,isSmallScreen:y})})}},709577:(e,t,i)=>{i.d(t,{A:()=>o});i(296540);var n=i(474848);const o=function(e){const{analyticsName:t}=e,o=(0,i(484714).v3)(),a=(0,i(56366).K8)((()=>(0,i(293311).m)(o,"maxWidth","large")),[o]);return(0,n.jsx)("div",{style:{flexShrink:0},children:(0,n.jsx)(i(187485).A,{"aria-label":"Notion",href:"https://www.notion.com/product",onMouseDown:()=>i(902052)._C(o,{from:t,name:"notion_logo",href:i(427704).JZ.product}),style:{cursor:"pointer",userSelect:"auto",WebkitUserSelect:"auto"},children:(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,i(426388).S)({width:a?28:30,height:a?28:30,marginRight:10,flexShrink:0}),e.hideNotionText?void 0:(0,n.jsx)("div",{style:{fontWeight:i(284371).Wy.medium,fontSize:16},children:"Notion"})]})})})}},757856:(e,t,i)=>{i.d(t,{F:()=>l});i(296540);var n=()=>i(401497),o=()=>i(284371),a=()=>i(704152),s=()=>i(331542),r=i(474848);function l(e){let{onClick:t,getLabel:i,id:l,iconFn:c,iconStyles:d,isLoading:u,themeOverride:g,isSmallScreen:m,backgroundColor:p,hoveredBackgroundColor:v}=e;const f=(0,n().IS)((e=>{const t=g??e;return{base:{position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",height:36,borderRadius:6,color:t.text.primary,fill:t.text.primary,background:p??"none",fontSize:14,lineHeight:1,paddingLeft:12,paddingRight:12,fontWeight:o().Wy.medium,border:`1px solid ${t.stroke.primary}`,width:"100%",boxShadow:"none",marginTop:"8px",...m&&{height:48,borderRadius:12,fontSize:16,marginTop:10,fontWeight:o().Wy.semibold},...u&&{display:"grid",gridTemplateColumns:"1fr auto 1fr"}},hovered:{background:v??t.buttonHoveredBackground}}}),[m,g,u,p,v]);return(0,r.jsxs)(a().A,{id:l,onClick:t,style:f.base,hoveredStyle:f.hovered,disabled:u,children:[u?(0,r.jsx)(s().A,{style:{marginLeft:"auto"}}):null,(0,r.jsxs)("div",{style:{display:"flex",textAlign:"center",justifyContent:"center",alignItems:"center"},children:[" ",null==c?void 0:c(d??{width:m?28:20,height:m?28:20,marginRight:m?0:2}),i()]})]})}},789690:(e,t,i)=>{i.d(t,{z:()=>z,W9:()=>D,Zr:()=>C,YN:()=>J,$p:()=>O,pe:()=>q,y8:()=>V,bn:()=>j,ho:()=>$,yt:()=>F,WV:()=>W,BU:()=>H,Dh:()=>B,A$:()=>Z});i(964979),i(814603),i(147566),i(198721);var n=()=>i(412681),o=()=>i(662303),a=()=>i(554279),s=()=>i(885443),r=()=>i(857639),l=()=>i(861017),c=()=>i(427704),d=()=>i(677338),u=()=>i(502800),g=()=>i(939768),m=()=>i(449506),p=()=>i(687532),v=()=>i(433052),f=()=>i(496414),h=()=>i(957416),y=()=>i(435009),w=()=>i(679924),S=()=>i(268405),b=()=>i(780054),k=()=>i(725951),A=(i(16280),()=>i(763824));const T="challengeHelpers";async function I(e,t,i,n){if(!t||!i.executeTurnstile)return;const o=performance.now();let a;try{const e=await(0,A().Vq)(i.executeTurnstile(n),15e3);e.timeout?(r().log({level:"error",from:T,type:"turnstileExecutionTimeout"}),a=void 0):a=e.result}catch(s){r().log({level:"error",from:T,type:"turnstileExecutionError",error:(0,u().convertErrorToLog)(s)}),a=void 0}return function(e,t){(0,w().v)(e,"challenge_executed",t)}(e,{provider:"turnstile",action:n,is_success:void 0!==a,time_ms:performance.now()-o}),a}var N=()=>i(529543),P=()=>i(898486),M=()=>i(479954),L=()=>i(972435),_=()=>i(905654),x=()=>i(404141),E=()=>i(719431),U=()=>i(893702);const R=(0,i(959013).YK)({loggingInWithApple:{id:"loginActions.loggingInWithApple.loadingMessage",defaultMessage:"Logging in with Apple…"},loggingInWithGoogle:{id:"loginActions.loggingInWithGoogle.loadingMessage",defaultMessage:"Logging in with Google…"},googleErrorMessage:{id:"loginActions.loggingInWithGoogle.errorMessage",defaultMessage:"Something went wrong while trying to log in with Google."},titleMessageGooglePopup:{defaultMessage:"Google login",id:"loginActions.googleLoginPopupModal.title"},titleMessageMicrosoftPopup:{defaultMessage:"Microsoft login",id:"loginActions.microsoftLoginPopupModal.title"}});async function W(e){const{environment:t,loginStore:i,disableLoginLink:n,reverify:a,needsSendTemporaryPasswordReason:s,turnstileProps:r,onSendTemporaryPasswordSuccess:l,onSendTemporaryPasswordFailure:u}=e;await async function(e){const{environment:t,store:i,reverify:n,turnstileToken:a,loginOptionsToken:s,onSendTemporaryPasswordSuccess:r,onSendTemporaryPasswordFailure:l}=e,{RouterStore:u}=t,f=e.disableLoginLink||Boolean((0,d().sY)());U().QR(t);const{url:h}=v().v4(t),y=_().Sw(t),w=i.isMicrosoftLogin()||i.isMicrosoftVerification();let k={email:i.state.email,redirectURL:h,disableLoginLink:f,native:t.device.isNative,isSignup:"signup"===u.state.route.name,turnstileToken:a,shouldHidePasscode:y,loginOptionsToken:s,deviceId:await(0,N().getExperimentDeviceId)(t)};w&&(k={...k,thirdPartyToken:i.state.thirdPartyToken,microsoftEmailVerification:!0});const A=await m().callApi({eventName:"sendTemporaryPassword",environment:t,data:k});if("success"===A.type){const{csrfState:e}=A.data;if(w?i.setState({...i.state,loginType:"microsoft_verification",password:"",alert:void 0,hiddenPasscode:y,sentEmailPasscodeState:e}):i.setState({...i.state,loginType:n?"reverify":"temporary",password:"",sentEmailPasscodeState:e,alert:void 0,hiddenPasscode:y}),null==r||r(),function(e){let{environment:t,isMicrosoftLogin:i}=e;const n=t.device.isElectronAny;return n&&"en-US"===o().locale&&!i}({environment:t,isMicrosoftLogin:w})){const e=await(0,S().T)(t),n=g().Gm({url:`${b().A.domainBaseUrl}${c().JZ.desktopEmailConfirm}`,query:{state:btoa(JSON.stringify({email:i.state.email,deviceId:e}))}});t.device.isElectronAny&&p().P(n)}}else{null==l||l();const e=(0,P().Hu)(L().A.getIntl(),A);i.setState({...i.state,loginType:"email",password:"",alert:e})}}({environment:t,store:i,disableLoginLink:n,reverify:a,needsSendTemporaryPasswordReason:s,turnstileToken:await I(t,"turnstile"===i.state.challengeProvider,r,"login_temporary_password"),loginOptionsToken:i.state.loginOptionsToken,onSendTemporaryPasswordSuccess:l,onSendTemporaryPasswordFailure:u})}async function C(e){const{environment:t,email:i,password:n,redirectURL:o,turnstileProps:a,loginStore:s}=e,r=await(0,M().loadCurrentUserId)(t),l=await m().callApi({eventName:"loginWithEmail",environment:t,data:{email:i,password:n,turnstileToken:await I(t,"turnstile"===s.state.challengeProvider,a,"login_password"),loginOptionsToken:s.state.loginOptionsToken,source:(0,d().dY)()}});if("success"!==l.type){await E().handleLoginFailureIfSamlRequired(t,l),function(e,t){var i;"login_options_invalid"===(null===(i=t.body.clientData)||void 0===i?void 0:i.type)&&e.setState({...e.state,loginType:"email",password:""})}(s,l);return(0,P().Hu)(L().A.getIntl(),l)}{const e=l.data.enabledMfaSettings??[],{userId:i}=l.data;e.length>0?E().handleLoginWithMfa({environment:t,isNewSignup:!1,userId:i,redirectURL:o,previousPersistedUserId:r,loginMethod:"password",mfaSettings:e,loginStore:s}):await E().handleLoginSuccess({environment:t,isNewSignup:!1,userId:i,redirectURL:o,previousPersistedUserId:r,loginMethod:"password"})}}async function B(e){const{environment:t,store:i}=e,n=await m().callApi({eventName:"sendTemporaryPassword",environment:t,data:{passwordReset:!0,email:i.state.email,native:t.device.isNative,loginOptionsToken:i.state.loginOptionsToken}});if("success"===n.type){const{csrfState:e}=n.data;i.setState({...i.state,loginType:"reset",password:"",sentPasswordResetState:e,alert:void 0})}else{const e=(0,P().Hu)(L().A.getIntl(),n);i.setState({...i.state,password:"",alert:e})}}async function O(e){const{environment:t,store:i}=e,{mobileNative:n}=t,o=await(0,M().loadCurrentUserId)(t);if(U().lt(t),n&&n.hasNativeAppleLogin())return void(await async function(e){const{environment:t,store:i,previousPersistedUserId:n}=e,{mobileNative:o}=t;if(!o)return;const a=await o.requestNativeAppleAuth();if(!a)return;if(a.error)r().log({level:"error",from:"loginActions",type:"requestNativeAppleAuth",error:(0,u().convertErrorToLog)(a.error)});else{f().m({message:R.loggingInWithApple});const{code:e,nonce:o,firstName:s,lastName:r}=a.value,l=await m().callApi({eventName:"loginWithAppleNativeAuth",environment:t,data:{code:e,nonce:o,firstName:s,lastName:r}});if("success"===l.type){const{isNewSignup:e,userId:i}=l.data;await E().handleLoginSuccess({environment:t,isNewSignup:e,userId:i,previousPersistedUserId:n,loginMethod:"login-with-apple"}),f().V()}else{await E().handleLoginFailureIfSamlRequired(t,l);const e=(0,P().Hu)(L().A.getIntl(),l);i.setState({...i.state,alert:e}),f().V()}}}({environment:t,store:i,previousPersistedUserId:o}));const a=(0,k().Le)(t);let s=l().tt(b().A.domainBaseUrl,{authType:a});s=a.redirectToAuth?s:await(0,k().YN)(t,s),t.mobileNative?E().openBrowserInMobileNative(t,s):t.device.isElectronAny?p().P(s):window.location.href=s}async function j(e){const{environment:t}=e,i=_().EB()||_().Nz()?(0,d().dY)():void 0;U().P6(t);const n=(0,k().LX)(t);let o=l().LC(b().A.domainBaseUrl,{authType:n,source:i});if(o=n.redirectToAuth?o:await(0,k().YN)(t,o),t.mobileNative)E().openBrowserInMobileNative(t,o);else if("redirect"===n.callbackType)window.location.href=o;else if(t.device.isElectronAny)p().P(o);else{const e=await h().P(t,{width:610,height:700,url:o,titleMessage:R.titleMessageMicrosoftPopup});if(!e)return;const i=g().Jh({url:g().ZO(e),pathname:c().JZ.microsoftAuthCallback});y().oo({environment:t,url:i})}}const G=L().A.formatMessage(R.googleErrorMessage);async function V(e){const{environment:t,store:i,email:n,permissionsStore:o}=e,{mobileNative:a}=t,s=await(0,M().loadCurrentUserId)(t);U().s(t);const v=a&&a.hasNativeGoogleLogin()?()=>a.requestGoogleJwt():void 0;if(v){const e=await v();if(e){if(e.error)return void r().log({level:"error",from:"loginActions",type:"requestGoogleJwt",error:(0,u().convertErrorToLog)(e.error)});{f().m({message:R.loggingInWithGoogle});const{idToken:n}=e.value,{device:o}=t;let a;o.isElectronMail?a="nativemailredirect":o.isElectron?a="nativeredirect":o.isNative&&(a="native");const r=await m().callApi({eventName:"loginWithGoogleJwt",environment:t,data:{idToken:n,callbackType:a}});if("success"===r.type){const{isNewSignup:e,userId:i}=r.data;await E().handleLoginSuccess({environment:t,isNewSignup:e,userId:i,previousPersistedUserId:s,loginMethod:"login-with-google"}),f().V()}else await E().handleLoginFailureIfSamlRequired(t,r),i.setState({...i.state,alert:G}),f().V()}return}}const w=_().EB()||_().Nz()?(0,d().dY)():void 0,S=(0,k().LX)(t),A=crypto.randomUUID();let T=l().g$(b().A.domainBaseUrl,{email:n,contacts:o.state.contacts,authType:S,source:w},A);if(sessionStorage.setItem("googleLoginRequestId",A),T=S.redirectToAuth?T:await(0,k().YN)(t,T,!!(t.mobileNative&&b().A.domainBaseUrl.indexOf("localhost")>=0)),t.mobileNative)E().openBrowserInMobileNative(t,T);else if("redirect"===S.callbackType)window.location.href=T;else if(t.device.isElectronAny)p().P(T);else{const e=await h().P(t,{width:610,height:700,url:T,titleMessage:R.titleMessageGooglePopup});if(!e)return;const i=g().Jh({url:g().ZO(e),pathname:c().JZ.googleAuthCallback});y().oo({environment:t,url:i})}}async function q(e){const{loginStore:t,environment:i}=e;if(!t.isEmail())return;const{email:n}=t.state,o=await m().callApi({eventName:"getLoginOptions",environment:i,data:{email:n}});if("failed"===o.type){const e=(0,P().Hu)(L().A.getIntl(),o);return t.setState({...t.state,loginType:"email",alert:e}),void function(e,t){(0,w().v)(e,"login_invalid_email_submitted",{invalidEmail:t})}(i,n)}const s=o.data;if("required"===s.samlSignIn)return await E().showSamlRedirectMessage(2e3),t.setState({...t.state,loginType:"saml",alert:"Redirecting you to use SAML SSO"}),void F({environment:i,loginStore:t});(0,a().aq)({device:i.device,email:n,cookieService:i.cookieService}),t.setState({...t.state,loginOptionsToken:s.loginOptionsToken,challengeProvider:s.challengeProvider}),s.hasAccount?s.mustReverify?t.setState({...t.state,needsSendTemporaryPasswordReason:"reverify"}):s.passwordSignIn?t.setState({...t.state,loginType:"password",alert:void 0}):t.setState({...t.state,needsSendTemporaryPasswordReason:"login_no_password"}):t.setState({...t.state,needsSendTemporaryPasswordReason:"signup"})}async function F(e){const{environment:t,loginStore:i}=e,{device:n}=t;if(!i.isSaml())return;const{email:o}=i.state,a=L().A.getIntl();if(!o&&!i.state.forceAdminSamlLogin)return;let r;n.isElectronMail?r="nativemailredirect":n.isElectronCalendar||n.isMobileNativeCalendar?r="nativecalendarredirect":n.isElectron||(0,k().jd)(t)?r="nativeredirect":n.isNative&&(r="native");const l=await m().callApi({eventName:"getSamlRedirect",environment:t,data:{email:o,callbackType:r}});if("failed"===l.type)return void i.setState({...i.state,alert:(0,P().Hu)(a,l)});i.setState({...i.state,alert:void 0});const c=l.data.redirectUrl;if(c){const e=(0,s().iK)();if(e){const i=new URL(c);i.searchParams.set(s().sg,e),E().redirectToSaml(t,i.toString())}else E().redirectToSaml(t,c)}}function J(e){const t={callbackType:(0,k().LX)(e).callbackType},i=g().Gm({url:`${b().A.domainBaseUrl}${c().JZ.passkeyAuthVerify}`,query:t});e.mobileNative?E().openBrowserInMobileNative(e,i):e.device.isElectronAny?p().P(i):y().oo({environment:e,url:i})}async function H(e,t){const i=await Y(e);if(!i)return;const{attestation:n,attemptId:o}=i,a=g().O$(c().JZ.passkeyAuthCallback,{attestation:JSON.stringify(n),attemptId:o});"nativemailredirect"===t?y().oo({environment:e,url:`/nativemail${a}`}):"nativecalendarredirect"===t?y().oo({environment:e,url:`/nativecalendar${a}`}):y().oo({environment:e,url:`/native${a}`})}async function Y(e){const t=await m().callApi({eventName:"authPasskeyGenerateChallenge",environment:e,data:{}});if("success"!==t.type)return;let i;try{i=await(0,n().HS)(t.data.options,!1)}catch(o){return}return{attestation:i,attemptId:t.data.attemptId}}async function $(e){const{environment:t,showInvitationVersion:i}=e,n=await Y(t);if(!n)return!1;const{attestation:o,attemptId:a}=n;return await E().loginUserWithPasskeyVerifyChallenge({environment:t,attestation:o,attemptId:a,showInvitationVersion:i})}async function Z(e){const{environment:t,state:i,password:n}=e,o=await m().callApi({eventName:"verifyEmail",environment:t,data:{state:i,password:n}});if("success"!==o.type){return(0,P().Hu)(L().A.getIntl(),o)}}async function z(e){const{environment:t,redirectURL:i,previousPersistedUserId:n,userId:o,regenerateBackupCodes:a}=e;await E().handleLoginSuccess({environment:t,isNewSignup:!1,userId:o,redirectURL:i,previousPersistedUserId:n,loginMethod:"password-mfa"}),a&&x().A.setState({open:!0,openedFrom:"login",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function D(e){e.reset()}},902052:(e,t,i)=>{i.d(t,{_C:()=>o,gQ:()=>l,gr:()=>c,jr:()=>a,pO:()=>r,v4:()=>s});var n=()=>i(679924);function o(e,t){const{name:i,...o}=t;(0,n().v)(e,"click_link",{...o,click_name:i})}function a(e,t){(0,n().v)(e,"scroll",t)}function s(e,t){(0,n().v)(e,"customer_io_in_app_callout_show",t)}function r(e,t){(0,n().v)(e,"customer_io_in_app_callout_suppress",t)}function l(e,t){(0,n().v)(e,"customer_io_in_app_callout_dismiss",t)}function c(e,t){(0,n().v)(e,"customer_io_in_app_callout_error",t)}}}]);