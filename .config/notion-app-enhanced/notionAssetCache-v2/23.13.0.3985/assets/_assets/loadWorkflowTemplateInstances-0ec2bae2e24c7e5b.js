"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[17586],{191458:(t,e,o)=>{o.r(e),o.d(e,{loadWorkflowTemplateInstances:()=>s});o(944114),o(581454);var n=()=>o(912720),i=()=>o(534177),a=()=>o(630116);const c=!1;function s(t){const e=[];let o=!1;t.isDefined()||(o=!0);const s=t=>{var n;if(!t.isDefined())return void(o=!0);const i=null===(n=t.getProperties())||void 0===n?void 0:n.workflow_template_instance;i&&e.push({instancePointer:{type:"automation",id:t.id,spaceId:t.getSpaceId()},templateId:i.template_id})},d=t.getFormat().workflow_template_instance,l=t.getParentBlockStore();if(null==l||!l.isDefined())return{isLoading:!0,instances:[]};d&&e.push({instancePointer:{type:"collection",id:t.id},templateId:d.template_id});const p=l.getCollectionViewStores()??[];for(const n of p){if(!n.isDefined()){o=!0;continue}const t=n.getFormat().workflow_template_instance;t&&e.push({instancePointer:{type:"collection_view",id:n.id},templateId:t.template_id})}const r=t.getLayoutStore();if(r)if(r.isDefined()){var m;const t=null===(m=r.getFormat())||void 0===m?void 0:m.workflow_template_instance;t&&e.push({instancePointer:{type:"layout",id:r.id,spaceId:r.getSpaceId()},templateId:t.template_id})}else o=!0;const u=t.getTemplatePageStores();for(const n of u){const t=n.getModel();if(!t){o=!0;continue}if(!t.isPageBlock())continue;const i=t.getFormat().workflow_template_instance;i&&e.push({instancePointer:{type:"block",id:t.id,spaceId:t.getSpaceId()},templateId:i.template_id});const a=n.getAutomationStore();a&&s(a)}const f=t.getAutomationStores();for(const n of f)s(n);const _=t.getSpaceId(),g=t.getSchema();for(const[i,c]of Object.entries(g)){if(!c)continue;const o=c.workflow_template_instance;if(o&&e.push({instancePointer:{type:"property",id:i,collectionId:t.id},templateId:o.template_id}),"button"===c.type&&c.automation_id){s(a().dn.createChildStore(t,{id:c.automation_id,spaceId:_,table:n().yB}))}}const w=t.getFormat().compound_workflow_template_instances??[];for(const n of w)e.push({instancePointer:{type:"compound",id:n.id,collectionId:t.id,instancePointers:n.instance_pointers.map((e=>{switch(e.type){case"automation":return{type:"automation",id:e.id,spaceId:_};case"block":return{type:"block",id:e.id,spaceId:_};case"collection_view":return{type:"collection_view",id:e.id};case"layout":return{type:"layout",id:e.id,spaceId:_};case"property":return{type:"property",id:e.id,collectionId:t.id}}(0,i().HB)(e)}))},templateId:n.template_id});return c&&console.log("loadWorkflowTemplateInstances: loaded workflow template instances for collection:",t.id,"isLoading:",o,"instances:",e),{isLoading:o,instances:e}}}}]);