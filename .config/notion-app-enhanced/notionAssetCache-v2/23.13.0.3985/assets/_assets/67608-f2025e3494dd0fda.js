"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[67608],{413267:(e,t,o)=>{o.d(t,{b:()=>n});o(296540);var i=o(474848);const n=(0,o(340498).wt)("thinCheck",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},454531:(e,t,o)=>{o.d(t,{W:()=>h});var i=()=>o(780054),n=()=>o(972435),a=()=>o(867772),r=()=>o(681810),s=()=>o(901389),l=()=>o(896628),d=()=>o(383594),c=()=>o(675925),g=()=>o(751156),p=()=>o(892632);const u=1500,m=(0,o(959013).YK)({pageCover:{defaultMessage:"Page cover",id:"pageCover.title"},fileTypeCaption:{defaultMessage:"Images wider than {idealImageWidth} pixels work best.",id:"pageCover.fileType.caption"},uploadFailed:{defaultMessage:"Upload failed",id:"pageCover.errorDialogMessage.uploadFailed"},preparing:{defaultMessage:"Preparing...",id:"pageCover.status.preparing"},downloading:{defaultMessage:"Downloading...",id:"pageCover.status.downloading"},embedTitle:{defaultMessage:"Link",id:"pageCover.embedType.title"},embedPlaceholder:{defaultMessage:"Paste an image linkâ€¦",id:"pageCover.embedType.placeholder"},embedCaption:{defaultMessage:"Works with any image from the web.",id:"pageCover.embedType.caption"},embedSubmit:{defaultMessage:"Submit",id:"pageCover.embedType.buttonText"}});function h(e){let{environment:t,intl:o,store:i,rect:n,from:a}=e;d().W(t,{originGap:3,originRect:n,isSmallWidth:!1,popupWidth:540,maxHeight:485,title:o.formatMessage(m.pageCover),onDelete:()=>{!function(e){let{environment:t,store:o}=e;d().I(),g().createAndCommit({userAction:"PageCover.handleDelete",environment:t,canUndo:!0,perform:e=>{l().PT({store:o,transaction:e})}})}({environment:t,store:i})},currentTab:"gallery",tabs:[{type:"gallery",onChange:e=>{let{url:o,position:n}=e;(0,c().o)(t,{action:"edit_cover",block_type:"page",from:a},(e=>{f({environment:t,store:i,url:{originUrl:o},position:n}),e()}))}},{type:"file",fileUpload:!1,imageUpload:!0,videoUpload:!1,caption:o.formatMessage(m.fileTypeCaption,{idealImageWidth:u}),onUpload:e=>{(0,c().o)(t,{action:"edit_cover",block_type:"page",from:a},(n=>{var a;d().I(),p().QM({environment:t,file:e[0],bucket:"secure",record:(null===(a=i.getCoverStore())||void 0===a?void 0:a.pointer)??i.pointer,isFileBlock:!1,reportRichUploadMetrics:!0,onStart:b,onProgress:C,onComplete:e=>{var o;o={environment:t,store:i,url:{originUrl:e}},v({...o,position:.5})},onError:()=>{s().f1(o.formatMessage(m.uploadFailed))}}),n()}))}},{type:"embed",title:o.formatMessage(m.embedTitle),inputPlaceholder:o.formatMessage(m.embedPlaceholder),caption:o.formatMessage(m.embedCaption),buttonText:o.formatMessage(m.embedSubmit),onChange:e=>{(0,c().o)(t,{action:"edit_cover",block_type:"page",from:a},(o=>{var n;n={environment:t,store:i,url:e},v({...n,position:.5}),d().I(),o()}))}},{type:"unsplash",onChange:e=>{let{url:o,position:n}=e;(0,c().o)(t,{action:"edit_cover",block_type:"page",from:a},(e=>{f({environment:t,store:i,url:{originUrl:o},position:n}),e()}))}}]})}async function v(e){const{environment:t,store:o,url:i,position:s}=e,{serverCommitResult:d}=g().createAndCommit({userAction:"PageCover.updatePageCover",environment:t,canUndo:!0,perform:e=>{l().fg({store:o,url:i,position:s||.5,transaction:e})}});await d,r().A.state.loadingMode===a().vS&&r().A.setState({loadingMode:a().Gi,dataURL:r().A.state.dataURL,uploadProgress:t.device.isMobileNative?void 0:100,progressText:n().A.formatMessage(m.downloading)})}function f(e){v(e),i().A.isMobile&&d().I()}function b(e){const{file:t,name:o,size:i}=e;if(d().I(),r().A.setState({loadingMode:a().Wc,file:t,name:o,size:i}),t.type.indexOf("image")>=0)if(t instanceof File){const e=new FileReader;e.onload=e=>{r().A.state.loadingMode===a().Wc&&r().A.setState({...r().A.state,loadingMode:a().vS,uploadProgress:0,dataURL:e.target.result})},e.readAsDataURL(t)}else r().A.state.loadingMode===a().Wc&&r().A.setState({...r().A.state,loadingMode:a().vS,dataURL:t.dataURL,progressText:n().A.formatMessage(m.preparing)});else r().A.state.loadingMode===a().Wc&&r().A.setState({...r().A.state,loadingMode:a().vS,progressText:n().A.formatMessage(m.preparing)})}function C(e){const{progressPercent:t,progressText:o}=e;r().A.state.loadingMode===a().vS&&r().A.setState({...r().A.state,uploadProgress:t,progressText:o})}},544862:(e,t,o)=>{o.d(t,{A:()=>M});var i=o(296540),n=()=>o(484714),a=()=>o(56366),r=()=>o(959013),s=()=>o(896628),l=()=>o(454531),d=()=>o(751156),c=()=>o(478726),g=()=>o(227440),p=()=>o(867772),u=()=>o(681810),m=()=>o(608581),h=()=>o(145214),v=()=>o(704152),f=()=>o(807683),b=()=>o(401497),C=()=>o(534177),y=o(474848);function x(e){let{src:t,placeholderSrc:o,placeholderBehavior:n,imageStyle:a,containerStyle:r,onLoadComplete:s,testId:l}=e;const[d,c]=(0,i.useState)(!0);let g;switch(n){case"force-show-placeholder":g=!0;break;case"force-show-src":g=!1;break;case"show-placeholder-if-loading-src":g=!!o&&(d||void 0===t);break;default:(0,C().HB)(n)}const p=(0,b().IS)((()=>{const e={gridColumn:1,gridRow:1};return{container:{display:"grid",...r},srcWrapper:{...g&&{display:"none"},...e},placeholderWrapper:{pointerEvents:"none",...e}}}),[r,g]);(0,i.useEffect)((()=>{void 0!==t&&c(!0)}),[t]);const u=(0,i.useCallback)((e=>{c(!1),null==s||s()}),[s]);return(0,y.jsxs)("div",{style:p.container,children:[(0,y.jsx)(f().Ay,{src:t,onLoad:u,style:a,placeholderStyle:p.srcWrapper,placeholderLoadedStyle:p.srcWrapper,testId:l}),o&&(0,y.jsx)(f().Ay,{src:o,style:a,placeholderStyle:p.placeholderWrapper,placeholderLoadedStyle:p.placeholderWrapper})]})}var A=()=>o(453101);const M=function(e){let{store:t,disabled:r,paddingRight:l,paddingLeft:c,height:g,proxyWidth:m}=e;const h=(0,n().v3)(),v=(0,n().Y0)(),b=(0,a().uB)(void 0,o(454305).A),C=(0,a().K8)((()=>r||"suggest"===o(77246).Uv.getMode(t)||(0,o(600871).aD)(v)),[r,t,v]),A=(0,a().K8)((()=>t.getCover()),[t]),M=(0,a().O$)(u().A),[w,R]=(0,i.useState)(void 0);if(!A)return null;const P=M.loadingMode!==p().pF&&M.loadingMode!==p().Wc;return(0,y.jsx)(o(801678).A,{mouseStore:b,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:i,reset:n}=e;d().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,canUndo:!0,perform:e=>{s().yY({store:t,coverPosition:i,transaction:e}),n()}})}(e,t,h),renderControl:e=>{let{handleRepositionClick:o,handleSavePositionClick:i,handleCancelClick:n,isVisible:a,isRepositioning:r}=e;return(0,y.jsx)(k,{handleRepositionClick:o,handleSavePositionClick:i,handleCancelClick:n,isVisible:a,isRepositioning:r,lastProxiedUrl:w,store:t,disabled:C,paddingRight:l,paddingLeft:c,mouseStore:b})},source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:g,maxHeight:280,cursor:"default"},preventClickPropagation:!0,render:e=>(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)(o(360083).A,{url:A.cover,isAuthenticated:!0,permissionRecord:A.pointer,width:m,onFinishedLoadingProxyUrl:R,render:(t,o)=>{const i={width:"100%",height:g,maxHeight:280,objectFit:"cover",opacity:P?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},n={width:"100%",height:g,maxHeight:280};return(0,y.jsx)(x,{src:o,placeholderSrc:P?M.dataURL:void 0,placeholderBehavior:P?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:n,imageStyle:i,onLoadComplete:S,testId:"pageCover"})}}),P&&(0,y.jsxs)("div",{style:f().fd,children:[(0,y.jsx)(o(331542).A,{size:"md",style:{marginRight:4}}),(0,y.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:void 0!==M.uploadProgress?(0,y.jsx)(o(773382).A,{percentage:M.uploadProgress}):M.progressText?(0,y.jsx)("span",{children:M.progressText}):null})]})]})})};function S(){u().A.reset()}function k(e){let{isVisible:t,isRepositioning:o,handleCancelClick:s,handleRepositionClick:d,handleSavePositionClick:f,lastProxiedUrl:b,store:C,disabled:x,paddingRight:M,paddingLeft:S,mouseStore:k}=e;const w=(0,n().v3)(),R=(0,r().tz)(),P=(0,i.useCallback)((e=>function(e,t,o,i,n){n.reset();const a=e.target.getBoundingClientRect();l().W({environment:t,intl:o,store:i,rect:a,from:"page_header"})}(e,w,R,C,k)),[w,R,C,k]),j=(0,a().K8)((()=>u().A.state.loadingMode),[]),T=(0,a().K8)((()=>function(e){let t;return t=Boolean(e.isFullWidth())?"100%":c().x6,t}(C)),[C]),{device:L}=w,I=(0,a().O$)(g().e);if(x||j!==p().pF||!I)return null;const{isMobile:W}=L;return(0,y.jsx)(h().A,{animate:{width:T,opacity:t?1:0},style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,y.jsxs)(m().A,{isVisible:t,position:"bottom",style:{marginRight:M,marginLeft:S},children:[!o&&(0,y.jsx)(v().A,{style:{borderRight:W?"none":void 0,...A().k},onClick:P,children:(0,y.jsx)(r().sA,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!o&&!W&&(0,y.jsx)(v().A,{style:{...A().k,borderRight:"none"},onClick:e=>d(e,b),children:(0,y.jsx)(r().sA,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),o&&!W&&(0,y.jsx)(v().A,{style:A().k,onClick:f,children:(0,y.jsx)(r().sA,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),o&&!W&&(0,y.jsx)(v().A,{style:{...A().k,borderRight:"none"},onClick:s,children:(0,y.jsx)(r().sA,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})}},608581:(e,t,o)=>{o.d(t,{A:()=>g});o(898992),o(354520),o(581454),o(941795);var i=o(296540),n=()=>o(401497),a=()=>o(955825),r=()=>o(284371),s=()=>o(780054),l=()=>o(963575),d=o(474848);function c(e){const{button:t,isLast:o}=e,s=(0,n().IS)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:r().Wy.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return i.cloneElement(t,{...(0,a().AH)(t.props.style,s.button,o&&s.buttonLast),hoveredStyle:(0,a().AH)(s.buttonHovered,o&&s.buttonLast).style,pressedStyle:s.buttonPressed})}const g=function(e){let{children:t,isVisible:g,position:p,style:u}=e;const m=(0,n().IS)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.shadowSM,display:"flex",whiteSpace:"nowrap",borderRadius:l().A.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:s().A.isMobile?"auto":"none",opacity:s().A.isMobile?1:0,fontFamily:r().vc(o(662303).locale).sans,position:"absolute",right:l().A.horizontal.small,bottom:l().A.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:l().A.vertical.small,bottom:void 0}})),[]),h=i.Children.toArray(t).filter(o(534177).O9),v=h.length;return(0,d.jsx)(o(145214).A,{animate:{opacity:g?1:0},...(0,a().AH)(m.container,u,g&&m.containerHover,"top"===p&&m.containerTop),children:h.map(((e,t)=>{const n=t===v-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===o(859428).A&&i.isValidElement(e))return i.cloneElement(e,{render:(t,o)=>{const i=e.props.render(t,o);return(0,d.jsx)(c,{isLast:n,button:i},e.key)}});if(e.type===o(704152).A&&i.isValidElement(e))return(0,d.jsx)(c,{isLast:n,button:e},e.key)}}))})}},681810:(e,t,o)=>{o.d(t,{A:()=>i});const i=new(o(867772).Ay)},801678:(e,t,o)=>{o.d(t,{A:()=>m});var i=o(296540),n=()=>o(662303),a=()=>o(56366),r=()=>o(959013),s=()=>o(381349),l=()=>o(496603),d=()=>o(284371),c=()=>o(720665),g=()=>o(145214),p=o(474848);const u={isRepositioning:!1};const m=function(e){const t=(0,i.useRef)(null),n=(0,o(484714).v3)(),[r,s]=(0,i.useState)(u),d=(0,i.useCallback)((()=>{s(u)}),[]),{renderControl:g,onFlushTemporaryPosition:m,style:v,source:f,store:b}=e,{isRepositioning:C,image:y,startDragRenderedPosition:x,startDragImageScreenHeight:A}=r,M=(0,a().K8)((()=>0===o(502438).default.state.stores.length),[]),[S,k]=(0,i.useState)(!1),w=(0,a().uB)(e.mouseStore,o(454305).A),R=(0,a().K8)((()=>w.state.mouseEntered),[w]),P=(0,o(401497).IS)((()=>({dragContainer:{width:"100%",cursor:C?"move":"inherit"},container:{position:"relative",width:"100%",zIndex:1}})),[C]),j=(0,a().K8)((()=>function(e,t,o){return(0,l().Et)(o)?o:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,l().Et)(e))return e}const o=.5;if(t.isCollectionView()){const e=t.getCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,c().pN)(t)?o:t}}const i=t.getFormat(),n=i.page_cover_position;if((0,l().Et)(n))return n;return o}(e,t)}(f,b,r.temporaryPosition)),[r.temporaryPosition,f,b]);(0,i.useEffect)((()=>{const e=e=>{const o=t.current;o&&!o.contains(e.target)&&C&&m({imagePosition:j,reset:()=>{w.reset(),d()}})};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)}),[j,C,w,m,d]),C&&!M&&d();const T=(0,i.useMemo)((()=>(0,l().nF)((e=>{w.setState({...w.state,mouseEntered:!0})}),100)),[w]),L=(0,i.useMemo)((()=>(0,l().sg)((e=>{w.setState({...w.state,mouseEntered:!1})}),100)),[w]),I=(0,i.useCallback)(((e,t)=>{o(778417).IU({environment:n});const i=new Image;i.onload=()=>{s((e=>({...e,isRepositioning:!0,image:i})))},t&&(i.src=t)}),[n]),W=(0,i.useCallback)((e=>{m({imagePosition:j,reset:()=>{d()}})}),[j,m,d]),E=(0,i.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o(819121).p)(t)&&k(!0)}),[]),U=(0,i.useCallback)((()=>{k(!0)}),[]),D=(0,i.useCallback)((e=>{if(y&&C){const e=t.current;if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/y.width*y.height;s((e=>({...e,startDragImageScreenHeight:t,startDragRenderedPosition:j})))}}}),[y,j,C]),F=(0,i.useCallback)((e=>{if(C){const t=e.diffY/(A||0)+(x||0);s((e=>({...e,temporaryPosition:(0,l().LI)((0,o(40845).A)(t,0,1),4)})))}}),[C,A,x]),B=(0,i.useCallback)((()=>{s((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),H=(0,a().K8)((()=>g({handleRepositionClick:I,handleSavePositionClick:W,handleCancelClick:d,isVisible:R||S||C,isRepositioning:C})),[I,W,S,C,R,g,d]),_=(0,o(79043).A)(Boolean(e.preventClickPropagation));return(0,p.jsxs)("div",{ref:t,onFocus:E,onBlur:U,onMouseEnter:T,onMouseMove:T,onMouseLeave:L,..._,...(0,o(955825).AH)(P.container,v),children:[(0,p.jsx)(o(603820).A,{onDraggableDragStart:D,onDraggableDragMove:F,onDraggableDragEnd:B,onDraggableDragCancel:B,disabled:!C,render:t=>(0,p.jsx)("div",{style:P.dragContainer,...t,children:e.render({imagePosition:j,isRepositioning:C})})}),(0,p.jsx)(h,{small:e.small,isRepositioning:C}),H]})};function h(e){let{small:t,isRepositioning:o}=e;if(t)return null;const i={background:s().Ay.blackWithAlpha(.4),borderRadius:4,color:s().Ay.white,fontSize:12,fontFamily:d().vc(n().locale).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,p.jsx)(g().A,{visible:o,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:i,children:(0,p.jsx)(r().sA,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}},867772:(e,t,o)=>{o.d(t,{Ay:()=>l,Gi:()=>a,Wc:()=>i,pF:()=>r,vS:()=>n});const i="loadingLocalImage",n="uploading",a="downloading",r="loaded";class s extends(()=>o(757695))().Store{getInitialState(){return{loadingMode:r}}}const l=s}}]);