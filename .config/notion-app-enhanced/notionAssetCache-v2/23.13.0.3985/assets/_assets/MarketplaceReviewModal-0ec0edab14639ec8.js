"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[5999],{20051:(e,t,i)=>{i.d(t,{Bl:()=>l,IH:()=>u,Lh:()=>M,Mh:()=>y,RY:()=>f,VP:()=>x,_A:()=>p,n$:()=>b});var a=()=>i(534177),r=()=>i(130382),n=()=>i(416845),s=()=>i(266442);const o=15;function l(e){if(!s().Vu.includes(e))throw new(n().rTV)("Rating must be an integer between 1 and 5.",{type:"marketplace_listing_review_invalid_rating"});return!0}const c=3,d=100;function u(e){const t=e.trim();if(t.length<c)throw new(n().rTV)("Title too short",{type:"marketplace_listing_review_title_too_short"});if(t.length>d)throw new(n().rTV)("Title too long",{type:"marketplace_listing_review_title_too_long"})}const g=50,m=1500;function p(e){const t=e.trim();if(t.length<g)throw new(n().rTV)("Description too short",{type:"marketplace_listing_review_description_too_short"});if(t.length>m)throw new(n().rTV)("Title too long",{type:"marketplace_listing_review_description_too_long"})}const h=40;function f(e){const t=e.trim();if(0===t.length)throw new(n().rTV)("Name is required",{type:"marketplace_listing_review_name_too_short"});if(t.length>h)throw new(n().rTV)("Name too long",{type:"marketplace_listing_review_name_too_long"})}const v=5,w=1500;function b(e){const t=e.trim();if(t.length<v)throw new(n().rTV)("Creator response too short",{type:"marketplace_listing_review_creator_response_too_short"});if(t.length>w)throw new(n().rTV)("Creator response too long",{type:"marketplace_listing_review_creator_response_too_long"})}function y(e){return void 0!==e.getTitle()&&void 0!==e.getSerializedContent()}function x(e){return(0,r().YH)(e)<o}function M(e){switch(e){case"mostRecent":return{columnName:"updated_time",direction:"descending"};case"highestRating":return{columnName:"rating",direction:"descending"};case"lowestRating":return{columnName:"rating",direction:"ascending"};default:(0,a().HB)(e)}}},36338:(e,t,i)=>{i.d(t,{_:()=>l});i(16280);var a=i(296540),r=()=>i(484714),n=()=>i(187174),s=()=>i(226098),o=()=>i(327684);function l(e){let{acquisitionId:t,source:i}=e;const l=(0,r().v3)(),{trackRateListing:c}=(0,o().o)(t),[d,u]=(0,a.useState)(),[g,m]=(0,a.useState)(0),p=(0,a.useCallback)((e=>{m(e),u(void 0)}),[]),[h,f]=(0,n().V$)((()=>(0,s().Df)({environment:l,acquisitionId:t,rating:g})),[l,t,g]);return{onRatingConfirmed:p,onSubmit:(0,a.useCallback)((async()=>{try{await f(),g&&c({type:"add",surface:"leaveReviewButton",rating:g,source:i})}catch(e){throw e instanceof Error&&u(e),e}}),[f,g,i,c]),isLoading:"pending"===h.status,error:d}}},195821:(e,t,i)=>{i.d(t,{A:()=>l,O:()=>o});i(296540);var a=()=>i(401497),r=()=>i(381349),n=()=>i(284371),s=i(474848);function o(e){const{name:t,htmlLabel:i,children:n,errorMessage:o,hideLabel:l,style:d={},labelStyle:u={},errorMessageStyle:g={},required:m}=e,p=(0,a().IS)((e=>({formInputContainer:{display:"flex",flexDirection:"column",gap:6,width:"100%"},formLabel:{color:e.darkTextColor,visibility:l?"hidden":"inherit"},errorMessage:{fontSize:12,color:e.errorText,...g},wrapper:{display:"flex",alignItems:"center"},required:{color:r().Ay.red,marginLeft:2}})),[l,g]);return(0,s.jsxs)("div",{style:{...p.formInputContainer,...d},children:[(0,s.jsxs)("div",{style:p.wrapper,children:[(0,s.jsx)(c,{htmlFor:i,style:{...p.formLabel,...u},children:t}),m?(0,s.jsx)("div",{style:p.required,children:"*"}):void 0]}),n,o?(0,s.jsx)("div",{role:"alert",style:p.errorMessage,children:o}):void 0]})}const l=o;function c(e){const{children:t,htmlFor:i,style:r}=e,o=(0,a().IS)((e=>({base:{lineHeight:n().K_.UISmall.desktop,fontSize:n().J.UISmall.desktop,color:e.text.primary}})),[]);return(0,s.jsx)("label",{htmlFor:i,style:{...o.base,...r},children:t})}},226098:(e,t,i)=>{i.d(t,{Df:()=>c,Jj:()=>g,TG:()=>d});i(16280),i(504294),i(944114);var a=()=>i(416845),r=()=>i(20051),n=()=>i(449506),s=()=>i(898486),o=()=>i(972435),l=()=>i(743071);async function c(e){let{environment:t,acquisitionId:i,rating:a,title:s,description:o,name:c}=e;try{(0,r().Bl)(a)}catch(g){!function(e){const t=m(e);if(t)throw new Error(t);p()}(g)}u({title:s,description:o,name:c});const d=await n().callApi({eventName:"createMarketplaceListingReview",environment:t,data:{acquisitionId:i,rating:a,title:s,description:o,name:c}});if("success"===d.type){const e=d.data.marketplaceListingReviewId;return l().A.setReviewId(i,e),{reviewId:e}}p()}async function d(e){let{environment:t,reviewId:i,title:a,description:r,name:s}=e;if(!i)throw new Error("Review id is required");u({title:a,description:r,name:s});const o=await n().callApi({eventName:"updateMarketplaceListingReview",environment:t,data:{reviewId:i,title:a,description:r,name:s}});if("success"===o.type)return o.data.success;p()}function u(e){let{title:t,description:i,name:a}=e;const n=[];if(void 0!==t)try{(0,r().IH)(t)}catch(s){n.push(new Error(m(s),{cause:"title"}))}if(void 0!==i)try{(0,r()._A)(i)}catch(s){n.push(new Error(m(s),{cause:"description"}))}if(void 0!==a)try{(0,r().RY)(a)}catch(s){n.push(new Error(m(s),{cause:"name"}))}if(n.length>0)throw new AggregateError(n)}async function g(e){let{environment:t,listingId:i,sort:a,offset:s,limit:o}=e;const l=await n().callApi({eventName:"getMarketplaceListingReviews",environment:t,data:{listingId:i,sort:(0,r().Lh)(a??"mostRecent"),limit:o,offset:s}});let c=[];return"success"===l.type&&(c=l.data.reviewIds),{reviewIds:c}}function m(e){if((0,a().V4j)(e))return(0,s().DX)(o().A.getIntl(),e.body)}function p(){throw new Error(o().A.getIntl().formatMessage({id:"marketplace.review.createReviewError",defaultMessage:"Something went wrong"}))}},289275:(e,t,i)=>{i.r(t),i.d(t,{MarketplaceReviewModal:()=>E});var a=i(296540),r=()=>i(484714),n=()=>i(56366),s=()=>i(591779),o=()=>i(534177),l=()=>i(2220),c=()=>i(107683),d=()=>i(217429),u=()=>i(743071),g=(i(16280),i(504294),i(898992),i(803949),()=>i(401497)),m=()=>i(187174),p=()=>i(959013),h=()=>i(623580),f=()=>i(195821),v=()=>i(765957),w=()=>i(226098),b=()=>i(619418),y=()=>i(327684),x=i(474848);function M(){const e=(0,p().tz)(),t=(0,r().v3)(),i=(0,g().IS)((e=>({body:{display:"flex",flexDirection:"column",width:"100%",gap:"16px"}})),[]),[s,o]=(0,a.useState)(""),[l,c]=(0,a.useState)(),[d,M]=(0,a.useState)(""),[j,I]=(0,a.useState)(),[T,C]=(0,a.useState)(""),[A,B]=(0,a.useState)(),L=(0,n().K8)((()=>{var t;return null===(t=v().default.state.currentUserStore)||void 0===t?void 0:t.getDisplayName(e,!0)}),[e]);(0,a.useEffect)((()=>{L&&C(L)}),[L]);const{acquisitionId:D,rating:N,source:E}=(0,n().O$)(u().A),{trackRateListing:Y,trackReviewListing:z}=(0,y().o)(D),P=(0,n().K8)((()=>u().A.getReviewId(D)),[D]),[V,q]=(0,m().V$)((async()=>{const e={title:s,description:d,name:T};return P?(0,w().TG)({environment:t,reviewId:P,...e}):(0,w().Df)({environment:t,acquisitionId:D,rating:N,...e})}),[t,P,D,N,s,d,T]);return(0,x.jsx)("form",{method:"dialog",children:(0,x.jsx)(b().Y,{title:e.formatMessage(S.modalTitle),subTitle:e.formatMessage(S.modalSubTitle),body:(0,x.jsxs)("div",{style:i.body,children:[(0,x.jsx)(f().O,{name:e.formatMessage(S.title),htmlLabel:k,errorMessage:l,children:(0,x.jsx)(h().A,{id:k,placeholder:e.formatMessage(S.titlePlaceholder),value:s,onChange:e=>{o(e.target.value),c(void 0)},"aria-invalid":Boolean(l),autoComplete:"off"})}),(0,x.jsx)(f().O,{name:e.formatMessage(S.review),htmlLabel:_,errorMessage:j,children:(0,x.jsx)(h().A,{id:_,placeholder:e.formatMessage(S.reviewPlaceholder),value:d,onChange:e=>{M(e.target.value),I(void 0)},textarea:!0,autosize:!0,autosizeMinHeight:50,textareaSubmitOnEnter:!1,showClearButton:!0,"aria-invalid":Boolean(j),autoComplete:"off"})}),(0,x.jsx)(f().O,{name:e.formatMessage(S.name),htmlLabel:R,errorMessage:A,children:(0,x.jsx)(h().A,{id:R,placeholder:e.formatMessage(S.namePlaceholder),value:T,onChange:e=>{C(e.target.value),B(void 0)},showClearButton:!0,"aria-invalid":Boolean(A)})})]}),actions:[{type:"primary",text:e.formatMessage(S.submit),onClick:async()=>{try{await q(),z({type:"add",source:E}),N&&Y({type:"add",surface:"emptyState",rating:N,source:E}),u().A.updateState({stage:"success"})}catch(e){e instanceof AggregateError&&e.errors.forEach((e=>{"title"===e.cause?c(e.message):"description"===e.cause?I(e.message):"name"===e.cause&&B(e.message)}))}},isDisabled:Boolean(l||j),isLoading:"pending"===V.status},{type:"plain",text:e.formatMessage(S.skip),onClick:()=>u().A.closeModal()}]})})}const k="marketplace-review-title",_="marketplace-review-review",R="marketplace-review-name",S=(0,p().YK)({modalTitle:{id:"marketplace.submitRatingModal.details.modalTitle",defaultMessage:"Share your thoughts"},modalSubTitle:{id:"marketplace.submitRatingModal.details.modalSubTitle",defaultMessage:"Leave a review for the Notion community"},title:{id:"marketplace.submitRatingModal.details.title",defaultMessage:"Title"},titlePlaceholder:{id:"marketplace.submitRatingModal.details.titlePlaceholder",defaultMessage:"My review"},review:{id:"marketplace.submitRatingModal.details.review",defaultMessage:"Review"},reviewPlaceholder:{id:"marketplace.submitRatingModal.details.reviewPlaceholder",defaultMessage:"This template is..."},name:{id:"marketplace.submitRatingModal.details.name",defaultMessage:"Name shown on review"},namePlaceholder:{id:"marketplace.submitRatingModal.details.namePlaceholder",defaultMessage:"Your name"},submit:{id:"marketplace.submitRatingModal.details.submit",defaultMessage:"Submit"},skip:{id:"marketplace.submitRatingModal.details.skip",defaultMessage:"Skip"}});var j=()=>i(332661),I=()=>i(36338);function T(){const e=(0,p().tz)(),{acquisitionId:t,source:i}=(0,n().O$)(u().A),{onRatingConfirmed:a,onSubmit:r,isLoading:s,error:o}=(0,I()._)({acquisitionId:t,source:i});return(0,x.jsx)("form",{method:"dialog",children:(0,x.jsx)(b().Y,{title:(0,x.jsx)("div",{id:C,children:e.formatMessage(A.rateThisTemplate)}),body:(0,x.jsx)(j().v,{labelledBy:C,error:o,onRatingConfirmed:a}),actions:[{type:"primary",text:e.formatMessage(A.submit),onClick:async()=>{try{await r(),u().A.updateState({stage:"details"})}catch(e){}},isDisabled:Boolean(o),isLoading:s},{type:"plain",text:e.formatMessage(A.cancel),onClick:()=>u().A.closeModal()}]})})}const C="rate-this-template",A=(0,p().YK)({rateThisTemplate:{id:"marketplace.submitRatingModal.rateThisTemplate",defaultMessage:"Rate this template"},submit:{id:"marketplace.submitRatingModal.submit",defaultMessage:"Submit"},cancel:{id:"marketplace.submitRatingModal.cancel",defaultMessage:"Cancel"}});const B=(0,i(340498).xh)("bubbleEllipses",{default:{loader:()=>i.e(76378).then(i.bind(i,40785))},small:{loader:()=>i.e(76378).then(i.bind(i,578427))},fill:{loader:()=>i.e(76378).then(i.bind(i,654929))},fillSmall:{loader:()=>i.e(76378).then(i.bind(i,196568))}},["speech","bubble","typing","type","reply","replying","waiting","message","comment"]);var L=()=>i(460292);function D(){const e=(0,p().tz)();return(0,x.jsx)(b().Y,{icon:(0,x.jsx)(L().Q,{iconGroup:B,colorName:"secondary",variantName:"default",overrideSize:()=>36}),title:e.formatMessage(N.title),subTitle:e.formatMessage(N.subTitle),actions:[{type:"outline",text:e.formatMessage(N.done),onClick:()=>u().A.closeModal()}],width:300})}const N=(0,p().YK)({title:{id:"marketplace.submitRatingModal.success.title",defaultMessage:"Reviewing your submission"},subTitle:{id:"marketplace.submitRatingModal.success.subTitle",defaultMessage:"Your review will be visible after it’s been approved by our team"},done:{id:"marketplace.submitRatingModal.success.gotIt",defaultMessage:"Got it"}});function E(){const e=(0,r().v3)(),{isOpen:t,stage:i,source:g}=(0,n().O$)(u().A),m=(0,s().ZC)(i);(0,a.useEffect)((()=>{if(t){const t={stage:i,previous_stage:m!==i?m:void 0,source:g};(0,l().u)({environment:e,event:{eventName:"view_marketplace_review_modal",eventProperties:t}}),d().default.logEvent("view_marketplace_review_modal",i,t)}}),[e,t,i,m,g]);const p=(0,a.useCallback)((()=>{u().A.closeModal()}),[]),h=(0,a.useCallback)((()=>{switch(i){case"rating":return(0,x.jsx)(T,{});case"details":return(0,x.jsx)(M,{});case"success":return(0,x.jsx)(D,{});default:(0,o().HB)(i)}}),[i]);return(0,x.jsx)(c().s,{isOpen:t,onDismiss:p,showCloseIcon:"success"!==i,render:h,animateSizeTransition:!1})}},327684:(e,t,i)=>{i.d(t,{o:()=>d});var a=i(296540),r=()=>i(484714),n=()=>i(56366),s=()=>i(529745),o=()=>i(2220),l=()=>i(217429),c=()=>i(936015);function d(e){const t=(0,r().v3)(),i=(0,n().K8)((()=>new(c().y)(t,{table:s().Ht,id:e}).getListingId()||""),[t,e]);return{trackReviewListing:(0,a.useCallback)((e=>{(0,o().u)({environment:t,event:{eventName:"review_listing",eventProperties:{from:"inApp",listing_id:i,...e}}}),l().default.logEvent("review_listing",void 0,e)}),[t,i]),trackRateListing:(0,a.useCallback)((e=>{(0,o().u)({environment:t,event:{eventName:"rate_listing",eventProperties:{from:"inApp",listing_id:i,...e}}}),l().default.logEvent("rate_listing",e.rating,e)}),[t,i])}}},332661:(e,t,i)=>{i.d(t,{v:()=>u});i(581454);var a=i(296540),r=()=>i(401497),n=()=>i(85438),s=()=>i(995166),o=()=>i(266442),l=()=>i(959013),c=()=>i(554509),d=i(474848);function u(e){let{labelledBy:t,error:i,isDisabled:u,rating:h,onRatingConfirmed:f}=e;const v=(0,l().tz)(),w=function(e){return(0,r().IS)((t=>({marketplaceRatingContainer:{paddingBottom:"4px"},group:{display:"flex",...e&&{pointerEvents:"none"}},star:{cursor:"pointer",padding:"0 4px",height:"40px",width:"40px",color:t.marketplaceStarDefault},starDragging:{cursor:"grabbing"},highlighted:{color:t.marketplaceStarSelected},error:{color:t.text.uiRedTertiary},errorMessage:{marginTop:"8px",textAlign:"center"}})),[e])}(u),[b,y]=(0,a.useState)(0),x=h??b,[M,k]=(0,a.useState)(!1),[_,R]=(0,a.useState)(0),S=()=>R(0),j=S,I=e=>()=>{R(e)},T=e=>()=>{k(!1),y(e)},C=e=>t=>{"Enter"===t.key&&(y(e),null==f||f(e),k(!1))},A=e=>()=>{k(!1),null==f||f(e)},B=e=>t=>{m(t)&&(k(!0),y(e)),R(e)};return(0,d.jsxs)("div",{style:w.marketplaceRatingContainer,children:[(0,d.jsx)("div",{role:"radiogroup","aria-labelledby":t,"aria-invalid":Boolean(i),"aria-errormessage":i?g:void 0,"aria-required":!0,style:w.group,onMouseLeave:e=>{S(),k(!1),m(e)&&x&&(null==f||f(x))},onBlur:j,children:o().Vu.map((e=>{const t=x===e,a=e<=x,r=!u&&(a||e<=_),o={...w.star,...r&&w.highlighted,...M&&w.starDragging,...i&&!_&&w.error};return(0,d.jsx)("div",{role:"radio",tabIndex:0,"aria-checked":t,"aria-label":v.formatMessage(p.starLabel,{star:e}),"aria-disabled":u,onFocus:I(e),onMouseDown:T(e),onKeyDown:C(e),onMouseUp:A(e),onMouseEnter:B(e),children:a?(0,s().M)(o):(0,n().w)(o)},e)}))}),i?(0,d.jsx)(c().D,{id:g,styleName:"UIRegular-14px/Regular",colorName:"redTertiary",customStyles:w.errorMessage,children:i.message}):void 0]})}const g="rating-error-message";function m(e){return 1===e.buttons}const p=(0,l().YK)({starLabel:{id:"marketplace.rating.star",defaultMessage:"Select {star, plural, one {{star, number} star} other {{star, number} stars}}"}})},504294:(e,t,i)=>{var a=i(746518),r=i(497751),n=i(318745),s=i(779039),o=i(714601),l="AggregateError",c=r(l),d=!s((function(){return 1!==c([1]).errors[0]}))&&s((function(){return 7!==c([1],l,{cause:7}).cause}));a({global:!0,constructor:!0,arity:2,forced:d},{AggregateError:o(l,(function(e){return function(t,i){return n(e,this,arguments)}}),d,!0)})},619418:(e,t,i)=>{i.d(t,{Y:()=>u});i(581454),i(296540);var a=()=>i(484714),r=()=>i(401497),n=()=>i(534177),s=()=>i(493823),o=()=>i(554509),l=()=>i(864943),c=()=>i(204063),d=i(474848);function u(e){let{icon:t,title:i,subTitle:n,body:s,actions:l,width:c,style:u}=e;const m=(0,a().Y0)(),p=function(e){let{width:t=406,style:i={}}=e;return(0,r().IS)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"center",width:t,padding:"20px",gap:"24px",...i},header:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"8px"},headerPadding:{paddingTop:"16px"},actions:{display:"flex",flexDirection:"column",gap:"6px",width:"100%"}})),[t,i])}({width:c,style:u});return(0,d.jsxs)("div",{style:p.container,children:[(0,d.jsxs)(o().D,{styleName:m.isMobile?"UITitle-26px/Bold":"Heading-17px/Medium",style:{...p.header,...!t&&p.headerPadding},children:[t,i,n?(0,d.jsx)(o().D,{styleName:"Body-14px/Regular",colorName:"secondary",children:n}):null]}),s,(0,d.jsx)("div",{style:p.actions,children:null==l?void 0:l.map(((e,t)=>(0,d.jsx)(g,{...e},`marketplace-modal-action-${t}`)))})]})}function g(e){const t=(0,a().Y0)(),i=function(){const e=(0,a().Y0)();return(0,r().IS)((t=>({mobileButton:e.isMobile?{height:48,borderRadius:12}:{},plainButton:{justifyContent:"center"},actionError:{textAlign:"center"}})),[e.isMobile])}();return(0,d.jsxs)(d.Fragment,{children:[(()=>{switch(e.type){case"primary":return(0,d.jsx)(c().A,{size:"lg",onClick:e.onClick,disabled:e.isDisabled,isLoading:e.isLoading,color:t.isMobile?"black":"uiBlue",style:i.mobileButton,children:(0,d.jsx)(o().D,{styleName:t.isMobile?"Heading-17px/Medium":"UIRegular-14px/Medium",children:e.text})});case"outline":return(0,d.jsx)(l().A,{size:"lg",onClick:e.onClick,style:i.mobileButton,children:(0,d.jsx)(o().D,{styleName:t.isMobile?"Heading-17px/Medium":"UIRegular-14px/Medium",children:e.text})});case"plain":return(0,d.jsx)(s().p,{size:"lg",onClick:e.onClick,isBlue:e.isBlue,isGray:!e.isBlue,style:{...i.plainButton,...i.mobileButton},children:(0,d.jsx)(o().D,{styleName:t.isMobile?"Heading-17px/Regular":"UIRegular-14px/Regular",children:e.text})});default:(0,n().HB)(e)}})(),e.error&&(0,d.jsx)(o().D,{styleName:"UIRegular-14px/Regular",colorName:"redTertiary",customStyles:i.actionError,children:e.error})]})}},995166:(e,t,i)=>{i.d(t,{M:()=>r});i(296540);var a=i(474848);const r=(0,i(340498).wt)("starFilled",{viewBox:"0 0 24 24",svg:(0,a.jsx)("path",{d:"M4.603 22.837c.375.277.826.2 1.4-.22l6.002-4.411 6.003 4.41c.561.42 1.024.498 1.387.221.375-.276.463-.73.232-1.403l-2.346-7.075 6.047-4.366c.572-.41.77-.83.627-1.271-.143-.432-.55-.653-1.255-.653l-7.424.045-2.269-7.108C12.787.32 12.457 0 12.005 0c-.463 0-.782.32-1.002 1.006l-2.27 7.108-7.423-.045c-.716 0-1.123.221-1.266.653-.144.442.066.862.638 1.27l6.036 4.367-2.335 7.075c-.231.674-.143 1.127.22 1.403z"})})}}]);