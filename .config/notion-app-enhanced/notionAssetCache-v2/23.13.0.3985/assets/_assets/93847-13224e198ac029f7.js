"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[93847],{30731:(e,t,s)=>{s.d(t,{BI:()=>c,ES:()=>g,Em:()=>o,Hl:()=>m,Ht:()=>p,Tq:()=>n,jO:()=>f,qC:()=>u,r6:()=>l,y2:()=>d});var i=()=>s(869190),r=()=>s(604995),a=()=>s(416504);function n(e,t){return(0,i().eV)({value:r().C6.notionDateTimeToLuxon(e,t.locale),preset:"short"})}function o(e,t){return(0,i().eV)({value:r().C6.notionDateTimeToLuxon(e,t.locale),preset:"time"})}function l(e,t){return r().C6.notionDateTimeToLuxon(e,t.locale).toFormat(r().k8)}function d(e,t){let s={starting:void 0,ending:void 0};var i,r,n,o;if(t.starting&&t.ending)s={starting:{type:"datetime",start_time:"",start_date:t.starting.start_date,time_zone:""},ending:{type:"datetime",start_time:"",start_date:t.ending.start_date,time_zone:""}},null!==(i=e.starting)&&void 0!==i&&i.start_time&&null!==(r=e.starting)&&void 0!==r&&r.time_zone&&(s.starting={...s.starting,start_time:e.starting.start_time,time_zone:e.starting.time_zone}),null!==(n=e.ending)&&void 0!==n&&n.start_time&&null!==(o=e.ending)&&void 0!==o&&o.time_zone?s.ending={...s.ending,start_time:e.ending.start_time,time_zone:e.ending.time_zone}:s={starting:{...s.starting,start_time:"00:00",time_zone:(0,a().P)()},ending:{...s.ending,start_time:"23:59",time_zone:(0,a().P)()}};else if(t.starting){var l,d;s=null!==(l=e.starting)&&void 0!==l&&l.start_time&&null!==(d=e.starting)&&void 0!==d&&d.time_zone?{starting:{type:"datetime",start_date:t.starting.start_date,start_time:e.starting.start_time,time_zone:e.starting.time_zone},ending:e.ending}:{starting:{type:"datetime",start_date:t.starting.start_date,start_time:"00:00",time_zone:(0,a().P)()},ending:e.ending}}else if(t.ending){var c,u;s=null!==(c=e.ending)&&void 0!==c&&c.start_time&&null!==(u=e.ending)&&void 0!==u&&u.time_zone?{ending:{type:"datetime",start_date:t.ending.start_date,start_time:e.ending.start_time,time_zone:e.ending.time_zone},starting:e.starting}:{ending:{type:"datetime",start_date:t.ending.start_date,start_time:"23:59",time_zone:(0,a().P)()},starting:e.starting}}else s={starting:e.starting,ending:e.ending};return s}function c(e){return e.starting&&e.ending?{starting:{type:"date",start_date:e.starting.start_date},ending:{type:"date",start_date:e.ending.start_date}}:e.starting?{starting:{type:"date",start_date:e.starting.start_date}}:e.ending?{ending:{type:"date",start_date:e.ending.start_date}}:{}}function u(e){if(e)return{type:"date",start_date:e.start_date}}function p(e){return`${e.actorType}:${e.actorId}`}function m(e){const t=e.split(":");if(2===t.length)return"bot"===t[0]?{actorId:t[1],actorType:"bot"}:"notion_user"===t[0]?{actorId:t[1],actorType:"notion_user"}:void 0}function g(e){return{starting:e.starting?{type:"date",start_date:e.starting.start_date}:void 0,ending:e.ending?{type:"date",start_date:e.ending.start_date}:void 0}}function f(e){return void 0===e.starting&&void 0===e.ending}},37625:(e,t,s)=>{s.d(t,{Ay:()=>C});s(898992),s(354520),s(581454);var i=s(296540),r=()=>s(484714),a=()=>s(56366),n=()=>s(401497),o=()=>s(668725),l=()=>s(959013),d=()=>s(972435),c=()=>s(722872),u=()=>s(37433),p=()=>s(632709),m=()=>s(848237),g=()=>s(898808),f=()=>s(452558),h=()=>s(493823),v=()=>s(760217),x=()=>s(406699),y=()=>s(419357),b=()=>s(928600),S=()=>s(89924),M=()=>s(125565),_=s(474848);function w(e){let{teamsForMember:t,shouldHideTeamMemberCount:s}=e;const i=(0,n().IS)((e=>({button:{marginRight:8},noTeams:{marginRight:8,color:e.text.tertiary},chevron:{width:10,marginLeft:4,fill:e.icon.tertiary}})),[]),r=t.length;return(0,_.jsx)(x().Ay,{popupType:x().z7.Popup,renderOrigin:e=>(0,_.jsx)(h().p,{disabled:0===r,style:0===r?i.noTeams:i.button,...e,children:0===r?(0,_.jsx)(l().sA,{id:"teamsDropdownForMember.teamsCountNone.label",defaultMessage:"No access"}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(l().sA,{id:"teamsDropdownForMember.teamsCount.label",defaultMessage:"{numberOfTeams, plural, one {{numberOfTeams} teamspace} other {{numberOfTeams} teamspaces}}",values:{numberOfTeams:r}}),(0,o().b)(i.chevron)]})}),render:()=>(0,_.jsx)(A,{teamStores:t,shouldHideTeamMemberCount:s})})}const I=(0,l().YK)({filterTeams:{defaultMessage:"Filter teamspaces…",id:"teamsDropdownForMember.filterForTeams.placeholder"}});function A(e){const{shouldHideTeamMemberCount:t}=e,s=(0,r().v3)(),o=(0,n().IS)((()=>({teamMenuItem:{fontWeight:400,maxWidth:180}})),[]),[h,x]=(0,i.useState)(""),w=(0,i.useCallback)((e=>m().F2({environment:s,teamId:e,tab:p().p.Members,from:"teams_dropdown_for_team_member"})),[s]),A=(0,a().K8)((()=>[{key:"teams for member",render:e=>(0,_.jsx)(S().A,{...e}),actions:e.teamStores.map((e=>{const s={key:e.id,displayName:e.getName(),analyticsName:e.getName()||"team_unknown",searchName:e.getName(),render:s=>{var i;return(0,_.jsx)(v().A,{icon:(0,_.jsx)(g().x,{disabled:!0,store:e}),title:(0,_.jsx)(M().A,{style:o.teamMenuItem,children:e.getName()}),caption:t?void 0:(0,_.jsx)(l().sA,{defaultMessage:"{numMembers} {numMembers, plural, one {member} other {members}}",id:"teamsDropdownForMember.numMembers",values:{numMembers:(null===(i=(0,u().PF)({teamStore:e}))||void 0===i?void 0:i.memberCountWithGuests)??0}}),inline:!0,...s})},action:()=>{w(e.id)},closeParentMenu:!1};return s}))}]),[e.teamStores,o.teamMenuItem,w,t]),C=h,T=(0,_.jsx)(S().A,{isInput:!0,children:(0,_.jsx)(y().Ay,{value:C,onChange:(0,i.useCallback)((e=>{x(e.target.value)}),[]),focus:!0,focusAfterAnimation:!0,placeholder:d().A.formatMessage(I.filterTeams)})}),k={menuType:c().gu.Popup,maxWidth:350,maxHeight:300,header:e.teamStores.length>5?T:void 0};return(0,_.jsx)(b().A,{...k,children:(0,_.jsx)(f().A,{filter:C,context:{blocks:[],environment:s,publicEditMode:void 0},initialFocus:0,sections:A})})}const C=function(e){const t=(0,u().uJ)(),s=(0,i.useMemo)((()=>((null==t?void 0:t.teams)??[]).map((e=>e.store))),[t]),r=(0,u().qQ)(),n=(0,u().D5)(),o=(0,i.useMemo)((()=>n?s:r),[s,r,n]),l=(0,a().K8)((()=>e.teamStores??o),[e.teamStores,o]),d=(0,a().K8)((()=>l.filter((t=>t.isMemberOrGuest(e.memberId,e.userPermissionGroupIds)))),[l,e.memberId,e.userPermissionGroupIds]);return(0,_.jsx)(w,{teamsForMember:d})}},72563:(e,t,s)=>{s.r(t),s.d(t,{iconDefinition:()=>i,priceTagFillIcon:()=>r});s(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"2.19 2.19 15.61 15.61",svg:(0,s(474848).jsx)("path",{d:"M13.166 2.216a2.05 2.05 0 0 1 1.74.58l2.298 2.299c.456.456.671 1.1.58 1.74l-.383 2.68a2.05 2.05 0 0 1-.58 1.16l-6.529 6.53c-.8.8-2.098.8-2.899 0l-4.597-4.598c-.8-.8-.8-2.099 0-2.9L9.324 3.18a2.05 2.05 0 0 1 1.16-.58zm-.828 5.446a1.188 1.188 0 1 0 1.68-1.68 1.188 1.188 0 0 0-1.68 1.68"})},r=(0,s(340498).wt)("priceTagFill",i)},91709:(e,t,s)=>{s.d(t,{Dd:()=>Se,z_:()=>Me,_3:()=>_e,Lw:()=>Ee,uU:()=>Ce,UP:()=>le,QF:()=>Le,U6:()=>Te,M0:()=>ke,s6:()=>ye,AO:()=>De,IG:()=>ge,P_:()=>de,aC:()=>je,X:()=>Ue,Sg:()=>fe,id:()=>Ae,li:()=>xe,Ss:()=>pe});s(944114),s(898992),s(354520),s(672577),s(430670),s(581454),s(296540);var i=()=>s(700500),r=()=>s(857639),a=()=>s(416504),n=()=>s(416845),o=()=>s(763884),l=()=>s(386164),d=()=>s(68263),c=()=>s(179034),u=()=>s(519831),p=()=>s(946064),m=()=>s(96689),g=()=>s(848538),f=()=>s(798880),h=()=>s(959013),v=()=>s(496603),x=()=>s(763824),y=()=>s(534177),b=()=>s(583835);const S=(0,b().Dv)("exportAdminContentSearch"),M=(0,b().Dv)("exportAuditLog"),_=(0,b().Dv)("exportBlock"),w=(0,b().Dv)("exportContentAnalytics"),I=(0,b().Dv)("exportDomainClaimableSpaces"),A=(0,b().Dv)("exportDomainClaimableSpacesForOrganization"),C=(0,b().Dv)("exportLegalHoldContentSummary"),T=(0,b().Dv)("exportSpace"),k=(0,b().Dv)("exportUserAnalytics");var P=()=>s(30731),j=()=>s(56366),L=s(474848);const E=function(e){let{exportProgressStore:t}=e;const{messageStyle:i,spinnerContainerStyle:r}=(0,s(401497).IS)((e=>({messageStyle:{fontSize:14,color:e.text.secondary,textAlign:"center"},spinnerContainerStyle:{marginTop:24,marginBottom:24,display:"flex",justifyContent:"center"}})),[]);return(0,L.jsxs)("div",{style:i,children:[(0,L.jsx)("div",{style:r,children:(0,L.jsx)(s(331542).A,{})}),(0,L.jsx)(D,{exportProgressStore:t}),(0,L.jsx)(U,{exportProgressStore:t})]})};function U(e){let{exportProgressStore:t}=e;return(0,j().K8)((()=>t.state.targetEmailAddress),[t])?(0,L.jsx)("p",{children:(0,L.jsx)(h().sA,{id:"exportProgressDialog.emailMessage",defaultMessage:"We’ll also send you an email with the download link."})}):null}function D(e){let{exportProgressStore:t}=e;const s=(0,j().K8)((()=>t.state.pagesExported),[t]);return s>0?(0,L.jsx)("p",{children:(0,L.jsx)(h().sA,{id:"exportProgressDialog.exportedPagesMessage",defaultMessage:"{pagesExported, plural, one {{pagesExported} page exported} other {{pagesExported} pages exported}}",values:{pagesExported:s}})}):(0,L.jsx)("p",{children:(0,L.jsx)(h().sA,{id:"exportProgressDialog.exportStartedMessage",defaultMessage:"Exporting…"})})}var F=()=>s(878377),z=()=>s(638146),V=()=>s(898486),R=()=>s(972435),B=()=>s(71304),O=()=>s(544019),N=()=>s(765957),q=()=>s(605402),G=()=>s(21735),H=()=>s(436529);class K extends(()=>s(757695))().Store{getInitialState(){return{pagesExported:0}}}const Z=K;var W=()=>s(630116),Y=()=>s(870092),Q=()=>s(134217),$=()=>s(749240),X=()=>s(701763),J=()=>s(679924);function ee(e,t){(0,J().v)(e,"export",t)}function te(e,t){(0,J().v)(e,"export_failed",t)}var se=()=>s(449506),ie=()=>s(901389),re=()=>s(235116),ae=()=>s(357625),ne=()=>s(496414);const oe=(0,h().YK)({exporting:{id:"exportActions.exporting.loadingMessage",defaultMessage:"Exporting"},exportAuditLogEmail:{id:"exportActions.auditLog.exporting.EmailMessage",defaultMessage:"Your CSV export is currently being generated. The generated CSV has a 2-hour delay from the real time audit log. Once it is ready, an email will be sent to you with the download link."},exportCSVEmail:{id:"exportActions.exportingCSV.EmailMessage",defaultMessage:"Your CSV export is currently being generated. Once it is ready, an email will be sent to you with the download link."},exportFailed:{id:"exportActions.exportFailedError.message",defaultMessage:"Export failed."},workspaceOwnerMessage:{defaultMessage:"Workspace owner",id:"export.userPermissionsRole.workspaceOwner.message"},memberMessage:{defaultMessage:"Member",id:"export.userPermissionsRole.member.message"},membershipAdminMessage:{defaultMessage:"Membership admin",id:"export.userPermissionsRole.membershipAdmin.message"},guestMessage:{defaultMessage:"Guest",id:"export.userPermissionsRole.guest.message"},idMessage:{defaultMessage:"ID",id:"export.csvHeader.id"},emailMessage:{defaultMessage:"Email",id:"export.csvHeader.email"},nameMessage:{defaultMessage:"Name",id:"export.csvHeader.name"},roleMessage:{defaultMessage:"Role",id:"export.csvHeader.role"},permissionGroupsMessage:{defaultMessage:"Permission groups",id:"export.csvHeader.permissionGroups"},pagesMessage:{defaultMessage:"Pages",id:"export.csvHeader.pages"},partitionMessage:{defaultMessage:"Export is still in progress due to file size. We will send you an email about its progress.",id:"export.exportPartitioned.message"},privatePageMessage:{defaultMessage:"Private page",id:"export.privatePageTitle.message"},pageTitleAndIdMessage:{defaultMessage:"{pageTitle} ({pageId})",id:"export.pageTitleAndId.message"},pageSeparatorMessage:{defaultMessage:", ",id:"export.pageSeparator.message"}});async function le(e,t){if(!be({environment:e,...t}))return void te(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive});const{currentUserStore:s}=N().default.state;if(!s)return void te(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive});const i=s.getEmail();if(!i)return void te(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive});ee(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive}),"currentView"===t.exportOptions.collectionViewExportType&&(t.exportOptions.preferredViewMap=ue(s.id));const r=(0,ae().UT)(e,_,t,{spaceIds:[]}),a=N().default.state.currentSpaceStore;await ce(e,r,t.recursive,i,null==a?void 0:a.id)}async function de(e,t,s,i){if(!be({environment:e,recursive:!0,exportOptions:t.exportOptions,isOrgConsole:void 0!==s}))return void te(e,{target:"space",format:t.exportOptions.exportType,recursive:!0});const{currentUserStore:r}=N().default.state;if(!r)return void te(e,{target:"space",format:t.exportOptions.exportType,recursive:!0});const a=r.getEmail();if(!a)return void te(e,{target:"space",format:t.exportOptions.exportType,recursive:!0});ee(e,{target:"space",format:t.exportOptions.exportType,recursive:!0}),"currentView"===t.exportOptions.collectionViewExportType&&(t.exportOptions.preferredViewMap=ue(r.id));const n=(0,ae().UT)(e,T,t,{spaceIds:[]});await ce(e,n,!0,a,t.spaceId,i)}async function ce(e,t,s,i,r,a){const{currentSpaceViewStore:n}=N().default.state;if(!n&&!a)return;const o=new Z;o.setState({pagesExported:0,targetEmailAddress:i});let l,d=!1;const c=((null==n?void 0:n.getTeamsStores())||a)??[],u=null==c?void 0:c.filter((e=>e.getSetting("disable_export"))).flatMap((e=>e.getName()||[]));if(s){const t=u.length>0?6e3:1250;l=(0,x().wR)(t);const s={exportProgressStore:o,disabledExportTeamNames:u};ie().ui({message:(0,L.jsx)(E,{...s}),showCancel:!1,keepFocus:!0,disableBackgroundDismiss:!0,items:[{label:(0,L.jsx)(h().sA,{id:"exportProgressDialog.closeButton.label",defaultMessage:"Close"}),onAccept:()=>{Ue({environment:e,spaceId:r}),d=!0}}]})}else l=Promise.resolve(),ne().m({message:oe.exporting});for await(const p of t){if(d)return;if(p.error)return ne().V(),void ie().f1(R().A.formatMessage(oe.exportFailed));{const{value:t}=p;if("complete"===t.type||"partition"===t.type)return await l,ne().V(),void("complete"===t.type?(ie().zw(),!d&&t.exportURL&&re().I5(e,t.exportURL)):ie().rG({message:R().A.formatMessage(oe.partitionMessage)}));o.setState({...o.state,pagesExported:t.pagesExported})}}}function ue(e){const t={};return o().K.scan(((s,i)=>{if(s.includes(z().Ie)&&s.includes(e)){const e=s.split(z().Ie)[1];e&&i&&(t[e]=i)}})),t}function pe(e){const{root:t,environment:s,isCollectionViewExportTypeSupported:i}=e,r=s.currentUser.id,n=Ie(r),o=n&&n.exportType||"markdown",l=i?"currentView":void 0,d="pdf"===o?{exportType:"pdf",timeZone:(0,a().P)(),pdfFormat:Ae(r),locale:"en",collectionViewExportType:l}:{exportType:o,timeZone:(0,a().P)(),locale:"en",collectionViewExportType:l};Me(s,{open:!0,root:t,recursive:"space"===t.table,exportOptions:d,shouldExportComments:!1})}function me(e,t){switch(t){case"editor":return e.formatMessage(oe.workspaceOwnerMessage);case"membership_admin":return e.formatMessage(oe.membershipAdminMessage);case"read_and_write":return e.formatMessage(oe.memberMessage);case"none":return e.formatMessage(oe.guestMessage);default:return r().log({level:"error",from:"exportActions",type:"roleNotFound",data:{miscDataToConvertToString:{role:t}}}),""}}async function ge(e,t){const{spaceStore:s,subscriptionData:i,intl:r}=t;await se().callApi({eventName:"exportSpaceMembers",environment:e,data:{spaceId:s.getSpaceId()}});let a=[],n=[];if(G().A.state.shouldUseEdgeCache){const t=await se().callApi({eventName:"listUsers",environment:e,data:{cursor:void 0,membershipFilter:void 0,limit:2e4,sort:"name_normalized",sortDirection:"asc",query:"",spaceId:s.id}});if("success"!==t.type)return void ie().rG({message:R().A.formatMessage(oe.exportFailed)});a=t.data.users.map((e=>e.id));for(const e of t.data.users){const t=(0,g().DR)(e.membership_type??"none");("none"===t||(0,d().DH)(t))&&n.push({userId:e.id,role:t})}}else a=i.users.map((e=>e.userId)),n=i.users;const o=await se().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:e,data:{spaceId:s.getSpaceId(),userIds:a},headers:(0,l().WS)({cellId:void 0,spaceId:s.getSpaceId()})}),c={};if("success"===o.type)for(const[l,d]of Object.entries(o.data.userToGroupMap)){const e=(d||[]).map((e=>q().A.state.permissionGroupsAndMemberCounts.find((t=>t.group.group_id===e)))),t=v().oE(e).map((e=>e.group.name)).sort().join(",");c[l]=t}await fe(s,n,c,r)}async function fe(e,t,s,i){const r=v().oE(await x().lX(t,40,(async t=>{const r=Y().L.createChildStore(e,{table:f().oo,id:t.userId});await r.waitUntil((()=>r.isReady()));const a=r.getEmail(),n=r.getFullName(i);if(a||n)return[a||"",n||"",me(i,t.role),s[t.userId]||"",r.id]})));he(ve([[oe.emailMessage,oe.nameMessage,oe.roleMessage,oe.permissionGroupsMessage,oe.idMessage].map((e=>i.formatMessage(e))),...r]),"members.csv")}function he(e,t){const s=document.createElement("a");s.setAttribute("href",`data:text/csv;charset=utf-8,${encodeURIComponent(e)}`),s.setAttribute("download",t),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}function ve(e){return e.map((e=>e.map((e=>((e=e.replace(/"/g,'""')).search(/("|,|\n)/g)>=0&&(e=`"${e}"`),e))).join(","))).join("\n")}async function xe(e){let{spaceStore:t,intl:s,environment:i}=e;const r=$().subscriptionDataStoreInstance.state;if(void 0===r||"subscribed_admin"!==r.type)return;let a=[];if(G().A.state.shouldUseEdgeCache){const e=await se().callApi({eventName:"listUsers",environment:i,data:{cursor:void 0,membershipFilter:"guests",limit:1e4,sort:"name_normalized",sortDirection:"asc",query:"",spaceId:t.id}});if("success"!==e.type)return void ie().rG({message:R().A.formatMessage(oe.exportFailed)});const s=e.data.users,r=await se().callApi({eventName:"getGuestPagesForUserIds",environment:i,data:{spaceId:t.id,guestUserIds:s.map((e=>e.id))},headers:(0,l().WS)({cellId:void 0,spaceId:t.id})});if("success"!==r.type)return void ie().rG({message:R().A.formatMessage(oe.exportFailed)});a=s.map((e=>({userId:e.id,role:"none",guestPageIds:r.data.guestIdToPages[e.id].pageIds,isPageGuest:!0,isTeamGuest:!1})))}else a=(0,Q().oe)(r);ye(i,{intl:s,spaceStore:t,guests:a})}async function ye(e,t){let{guests:s,intl:r,spaceStore:a}=t;await se().callApi({eventName:"exportSpaceGuests",environment:e,data:{spaceId:a.getSpaceId()}});const n=r.formatMessage(oe.pageSeparatorMessage),o=v().oE(await Promise.all(s.map((async t=>{const s=Y().L.createChildStore(a,{table:f().oo,id:t.userId});async function o(t){const s=W().Bv.createChildStore(a.getPagesStore(),{table:c().ev,id:t});if(await s.load(),s.isCollectionView()){const e=s.getCollectionPointer();if(e){const t=W().md.createChildStore(a,{table:u().Vl,id:e.id});t&&await t.load()}}else if(s.getType()===i().xd.alias){const e=s.getAliasTargetStore();e&&await e.load()}return(0,B().Qe)(s,r,e,!1)??r.formatMessage(oe.privatePageMessage)}const[,...l]=await Promise.all([s.load(),...t.guestPageIds.map((e=>async function(e){return r.formatMessage(oe.pageTitleAndIdMessage,{pageId:e,pageTitle:await o(e)})}(e)))]),d=s.getEmail(),p=s.getFullName(r);if(d||p)return[d||"",p||"",l.join(n),s.id]})))),l=[[oe.emailMessage,oe.nameMessage,oe.pagesMessage,oe.idMessage].map((e=>r.formatMessage(e))),...o];he(ve(l),"guests.csv"),X().Is(e,{line_count:l.length})}function be(e){const t="pdf"===e.exportOptions.exportType&&e.recursive;return!!e.isOrgConsole||(!t||Se(e.environment))}function Se(e){return(0,Q().n)(e,"enterprise")||(0,Q().n)(e,"business")||F().hfc()}function Me(e,t){const s=H().Ay.state,i=e.currentUser.id;let r=t;if(H().xt(r)&&!Se(e))if("space"===r.root.table){const e=s.open&&!H().xt(s)?s.exportOptions.exportType:"html";r={...r,exportOptions:{...r.exportOptions,exportType:e}}}else r={...r,recursive:!1};if(!be({environment:e,...r}))throw new(n().Umn)("Invalid export options",{data:r});H().Ay.setState(r),function(e){const t=H().Ay.state;if(t.open){const s={...Ie(e),exportType:t.exportOptions.exportType};"pdf"===t.exportOptions.exportType&&(s.pdfFormat=t.exportOptions.pdfFormat),o().K.set({userId:e,key:we,value:s})}}(i)}function _e(){H().Ay.setState({open:!1,shouldExportComments:!1})}const we="ExportSettings";function Ie(e){return o().K.get({userId:e,key:we})}function Ae(e){const t=Ie(e);return t&&t.pdfFormat||H().N4()}async function Ce(e,t){const{currentUserStore:s}=N().default.state,{targetPointer:i}=t;if(!s)return r().log({level:"error",from:"exportActions",type:"exportAuditLogCSV-currentUserStoreNotFound",data:{miscDataToConvertToString:{targetPointer:i}}}),ie().rG({message:R().A.formatMessage(oe.exportFailed)}),void te(e,{target:"auditLog",format:"csv",recursive:!1});if(!s.isDefined())return r().log({level:"error",from:"exportActions",type:"exportAuditLogCSV-currentUserValueNotFound",data:{miscDataToConvertToString:{targetPointer:i}}}),ie().rG({message:R().A.formatMessage(oe.exportFailed)}),void te(e,{target:"auditLog",format:"csv",recursive:!1});let a;ee(e,{target:"auditLog",format:"csv",recursive:!1}),i.table===m().NX?a=(0,ae().UT)(e,M,{spaceId:i.id,exportOptions:t.exportOptions},{spaceIds:[]}):i.table===p().y7?a=(0,ae().UT)(e,M,{organizationId:i.id,exportOptions:t.exportOptions},{spaceIds:[]}):(0,y().HB)(i),await Pe(a,oe.exportAuditLogEmail)}async function Te(e){const{environment:t,data:s}=e;ee(t,{target:"domainClaimableSpaces",format:"csv",recursive:!1});const i=(0,ae().UT)(t,I,s,{spaceIds:[]});await Pe(i,oe.exportCSVEmail)}async function ke(e){const{environment:t,data:s}=e;ee(t,{target:"domainClaimableSpaces",format:"csv",recursive:!1});const i=(0,ae().UT)(t,A,s,{spaceIds:[]});await Pe(i,oe.exportCSVEmail)}async function Pe(e,t){const s=await e.next();if(s.value.error){const e=(0,V().A)(R().A.getIntl(),s.value.error);ie().f1(e)}else ie().rG({message:R().A.formatMessage(t)})}async function je(e,t){ee(e,{target:"userAnalytics",format:"csv",recursive:!1});const s=(0,ae().UT)(e,k,t,{spaceIds:[t.spaceId]});await Pe(s,oe.exportCSVEmail)}async function Le(e,t){ee(e,{target:"contentAnalytics",format:"csv",recursive:!1});const s=(0,ae().UT)(e,w,t,{spaceIds:[t.spaceId]});await Pe(s,oe.exportCSVEmail)}async function Ee(e,t){ee(e,{target:"adminContentSearchAnalytics",format:"csv",recursive:!1});const s=(0,ae().UT)(e,S,{spaceId:t.spaceId,organizationId:t.organizationId,sort:{field:"relevance",direction:"desc"},query:t.filters.query,audience:t.filters.audience,lastEditedTime:(0,P().ES)(t.filters.lastEditedTime),createdTime:(0,P().ES)(t.filters.createdTime),createdBy:t.filters.createdBy,sharedWith:t.filters.sharedWith,teamspaceIds:t.filters.teamIds,deletionStatuses:t.filters.pageStatus},{spaceIds:[t.spaceId]});await Pe(s,oe.exportCSVEmail)}async function Ue(e){let{environment:t,spaceId:s}=e;if(!s)return;const i=await se().callApi({eventName:"getActiveExportTasks",environment:t,data:{spaceId:s}});var r;"success"===i.type&&O().A.setState({count:i.data.length,exportedPageCount:null===(r=i.data[0])||void 0===r?void 0:r.exportedPageCount})}async function De(e,t){ee(e,{target:"legalHoldContentSummary",format:"csv",recursive:!1});const s=(0,ae().UT)(e,C,{spaceId:t.spaceId,legalHoldId:t.legalHoldId,teamIds:t.teamIds,userIds:t.userIds,blockIds:t.blockIds,query:t.query},{spaceIds:[t.spaceId]});await Pe(s,oe.exportCSVEmail)}},118789:(e,t,s)=>{s.d(t,{n:()=>h});s(898992),s(354520),s(581454);var i=s(296540),r=()=>s(484714),a=()=>s(56366),n=()=>s(798880),o=()=>s(959013),l=()=>s(21735),d=()=>s(576737),c=()=>s(630116),u=()=>s(585428),p=()=>s(134217),m=()=>s(749240),g=()=>s(58293),f=()=>s(646736);function h(e){const{query:t,filter:s,limit:h,disable:x,sort:y}=e,b=(0,a().O$)(m().subscriptionDataStoreInstance),S=(0,a().K8)((()=>l().A.state.shouldUseEdgeCache),[]),M=(0,o().tz)(),_=(0,g().r)(),w=(0,r().v3)(),I=(0,a().K8)((()=>{if(x||S||!b||!_)return[];return p().Be(b).map((e=>{var t,s;const i=c().LU.createChildStore(_,{table:n().oo,id:e.userId}),r=(0,f().dp)(_,e.userId);return{id:e.userId,email:i.getEmail()||"",space_id:_.id,name:i.getDisplayName(M),profile_photo:null===(t=i.getModel())||void 0===t?void 0:t.profile_photo,membership_type:r.getMembershipType(),onboarding_completed:null===(s=i.getModel())||void 0===s?void 0:s.onboarding_completed,first_joined_space_time:v(e)}}))}),[x,S,b,_,M]),A=(0,i.useMemo)((()=>x?void 0:S&&_?new(u().e)({users:void 0,environment:w,spaceId:_.id,initialMembershipFilter:s,initialSort:y,initialQuery:t,limit:h}):new(d().z)({users:I,initialMembershipFilter:s,initialSort:y,initialQuery:t})),[x,S,_,w]);return(0,i.useEffect)((()=>{A instanceof d().z&&A.setUsers(I)}),[A,I]),(0,i.useEffect)((()=>{null==A||A.setSort(y)}),[A,y]),(0,i.useEffect)((()=>{null==A||A.setQuery(t)}),[A,t]),(0,i.useEffect)((()=>{null==A||A.setFilter(s)}),[A,s]),A}function v(e){return"firstJoinedSpaceTime"in e?e.firstJoinedSpaceTime??Date.now():Date.now()}},132813:(e,t,s)=>{s.d(t,{A:()=>r});class i extends(()=>s(757695))().Store{getInitialState(){return{disablePublicAccess:!1,disableGuests:!1,disableMoveToSpace:!1,disableExport:!1,disableSpacePageEdits:!1,disablePublicAccessRequests:!1,disableTeamCreation:!1,disableMembershipRequests:!1,disableExternalMembershipRequests:!1,disableGuestMembershipRequests:!1,disableMemberUpgradeRequests:!1,enableGuestInviteRequests:!1,disableTeamGuests:!1,disableGuestsModalOpen:!1,enableAiTraining:!1,zeroRetentionEnabled:!1}}getValueForSpace(e){if(e.isDefined())return{disablePublicAccess:Boolean(e.getDisablePublicAccess()),disableGuests:Boolean(e.getDisableGuests()),disableMoveToSpace:Boolean(e.getDisableMoveToSpace()),disableExport:Boolean(e.getDisableExport()),disableSpacePageEdits:Boolean(e.getDisableSpacePageEdits()),disablePublicAccessRequests:Boolean(e.getDisablePublicAccessRequests()),disableTeamCreation:Boolean(e.getDisableTeamCreation()),disableMembershipRequests:Boolean(e.getSetting("disable_membership_requests")),disableExternalMembershipRequests:Boolean(e.getSetting("disable_external_membership_requests")),disableGuestMembershipRequests:Boolean(e.getSetting("disable_guest_membership_requests")),enableGuestInviteRequests:Boolean(e.getSetting("enable_guest_invite_requests")),disableTeamGuests:Boolean(e.getSetting("disable_team_guests")),enableAiTraining:Boolean(e.getSetting("enable_ai_training")),zeroRetentionEnabled:Boolean(e.getSetting("zero_retention_enabled")),disableMemberUpgradeRequests:Boolean(e.getSetting("disable_member_upgrade_requests"))}}}const r=i},236527:(e,t,s)=>{s.d(t,{_:()=>p,a:()=>m});s(296540);var i=()=>s(56366),r=()=>s(401497),a=()=>s(798880),n=()=>s(959013),o=()=>s(765957),l=()=>s(630116),d=()=>s(566468),c=()=>s(453697),u=s(474848);function p(e){let{userId:t}=e;const s=(0,n().tz)(),p=(0,r().IS)((e=>({iconStyle:{color:e.text.tertiary,fontWeight:500}})),[]),g=(0,i().K8)((()=>{const e=o().default.state.currentSpaceStore;if(!e)return;const i=l().LU.createChildStore(e,{table:a().oo,id:t});return{userStore:i,isReady:i.isReady(),userName:i.getDisplayName(s),userEmail:i.getEmail()}}),[t,s]);return null!=g&&g.isReady?(0,u.jsx)(d().s7,{useThinTitle:!0,title:g.userName,byline:g.userEmail,icon:(0,u.jsx)(c().A,{size:28,userStore:g.userStore,iconStyle:p.iconStyle})}):(0,u.jsx)(m,{})}function m(e){const t=(0,r().IS)((()=>({icon:{borderRadius:"100%",height:e.iconSize??28,width:e.iconSize??28,marginLeft:-4}})),[e.iconSize]);return(0,u.jsx)(d().mf,{includeByline:!0,includeIcon:!0,iconStyles:t.icon})}},288864:(e,t,s)=>{s.d(t,{_:()=>o});s(296540);var i=()=>s(401497),r=()=>s(284371),a=()=>s(719147),n=s(474848);function o(e){let{href:t,external:s,onClick:o,children:l}=e;const d=(0,i().IS)((e=>({link:{color:e.icon.uiBluePrimary,fontWeight:r().Wy.medium}})),[]);return(0,n.jsx)(a().A,{disableUnderline:!0,href:t,external:s,onClick:o,color:d.link.color,hoverColor:"blue",style:d.link,children:l})}},301863:(e,t,s)=>{s.d(t,{$:()=>S});var i=s(296540),r=()=>s(484714),a=()=>s(56366),n=()=>s(401497),o=()=>s(584262),l=()=>s(921940),d=()=>s(416504),c=()=>s(663247),u=()=>s(980208),p=()=>s(179034),m=()=>s(959013),g=()=>s(284371),f=()=>s(554283),h=()=>s(765957),v=()=>s(148832),x=()=>s(404141),y=()=>s(719147),b=s(474848);function S(){const e=(0,m().tz)(),t=(0,r().v3)(),{collectionViewPageName:s,collectionViewPageURL:S}=(0,a().K8)((()=>{const s=h().default.state.currentSpaceStore;if(!s)return{collectionViewPageName:void 0,collectionViewPageURL:void 0};const i=s.id,r=(0,u().Pg)({spaceIdCreator:t.idCreator.getSpaceIdCreatorSync(i)}),a=v().B.createChildStore(s,{table:p().ev,id:r,spaceId:s.id}),n=null==a?void 0:a.getModel();if(!n)return{collectionViewPageName:void 0,collectionViewPageURL:void 0};const c=(0,l().A)({pageId:r,pageVisitSource:o().y8.WorkspaceSettingsPeopleSectionHeader});return{collectionViewPageName:n.getRenderTitle({getRecordModel:a.getRecordModel,userTimeZone:(0,d().P)(),intl:e}),collectionViewPageURL:c}}),[t.idCreator,e]),M=(0,i.useCallback)((e=>{e.metaKey||x().A.setState({...x().A.state,open:!1})}),[]),[_,w]=(0,f().B)(),I=(0,n().IS)((e=>({icon:{width:16,height:16,fill:w?e.text.uiBluePrimary:e.text.secondary},textLink:{color:e.text.secondary,fontWeight:g().Wy.medium,fontSize:g().J.UISmall.desktop,display:"flex",alignItems:"center"}})),[w]);return(0,b.jsx)("div",{ref:_,children:(0,b.jsxs)(y().A,{onClick:M,href:S,disableUnderline:!0,style:I.textLink,hoverColor:"blue",children:[(0,b.jsx)("span",{children:(0,b.jsx)(m().sA,{id:"spacePermissionsSettings.people.common.managePeopleDirectoryLink",defaultMessage:"Manage {directoryName}",values:{directoryName:s}})}),(0,b.jsx)("span",{children:(0,c().arrowDiagonalUpRightFillIcon)(I.icon)})]})})}},317194:(e,t,s)=>{s.d(t,{jo:()=>H,gz:()=>q,K:()=>K});var i=s(296540),r=()=>s(484714),a=()=>s(56366),n=()=>s(401497),o=()=>s(133033),l=()=>s(959013),d=()=>s(284371),c=()=>s(278768),u=()=>s(492666),p=()=>s(449506),m=()=>s(884107),g=()=>s(901389),f=()=>s(755636),h=()=>s(426116),v=()=>s(751156),x=()=>s(836251),y=()=>s(640653),b=()=>s(359941),S=()=>s(224701),M=()=>s(72563),_=()=>s(84817),w=()=>s(493823),I=()=>s(661764),A=()=>s(204063),C=()=>s(208993),T=s(474848);function k(){return(0,T.jsx)("div",{style:{marginBottom:16},children:(0,T.jsx)(P,{})})}function P(){const e=(0,l().tz)();return(0,T.jsx)(I().lZ,{display:"inline",tint:"gray",staticIcon:M().priceTagFillIcon,iconColor:"uiBluePrimary",label:e.formatMessage({id:"spacePermissionsSettings.spaceMembers.inviteLink.expansion.reward.label",defaultMessage:"You've added 3+ new members to Acme Labs"}),description:(0,T.jsxs)(_().Y1,{direction:"horizontal",gap:2,align:"center-left",children:[e.formatMessage({id:"spacePermissionsSettings.spaceMembers.inviteLink.expansion.reward.description",defaultMessage:"Get 50% off Business for one month, including advanced AI and premium features"}),"  ",(0,T.jsx)(C().W,{tooltipTitle:e.formatMessage({id:"spacePermissionsSettings.spaceMembers.inviteLink.expansion.reward.tooltip.title",defaultMessage:"Business Plan Offer"}),tooltipDescription:e.formatMessage({id:"spacePermissionsSettings.spaceMembers.inviteLink.expansion.reward.tooltip.description",defaultMessage:"This one-time offer includes unlimited AI usage, advanced collaboration features, and priority support for your team."}),iconSize:"default",iconColorName:"tertiary"})]}),actions:[{isCustom:!0,render:()=>(0,T.jsx)(A().A,{color:"uiBlue",onClick:()=>{},children:e.formatMessage({id:"spacePermissionsSettings.spaceMembers.inviteLink.expansion.redeem.button.text",defaultMessage:"Redeem Offer"})})},{isCustom:!0,render:()=>(0,T.jsx)(w().p,{isGray:!0,onClick:()=>{},children:e.formatMessage({id:"spacePermissionsSettings.spaceMembers.inviteLink.expansion.dismiss.button.text",defaultMessage:"Dismiss"})})}]})}var j=()=>s(807778),L=()=>s(843189),E=()=>s(802790),U=()=>s(364280),D=()=>s(285790),F=()=>s(946548),z=()=>s(125565),V=()=>s(719147),R=()=>s(8178),B=()=>s(288864),O=()=>s(792223),N=()=>s(301863);function q(e){let{spaceStore:t}=e;const s=Z(),a=(0,r().v3)(),n=(0,i.useCallback)((()=>{f().f({environment:a,url:(0,x().xS)("guides.invitePerson")})}),[a]),d=(0,l().tz)(),c=(0,b().V)({spaceStore:t});return(0,T.jsxs)(R().A,{divider:"none",large:!0,style:s.headingStyle,children:[(0,T.jsxs)("div",{children:[(0,T.jsx)(l().sA,{id:"spacePermissionsSettings.people.common.title",defaultMessage:"People"}),(0,T.jsx)(D().A,{onClick:n,icon:o().$,ariaLabel:d.formatMessage({id:"spacePermissionsSettings.people.common.iconButton.ariaLabel",defaultMessage:"Learn more about inviting people"})})]}),c?(0,T.jsx)(N().$,{}):void 0]})}function G(e){let{spaceStore:t,inviteLink:s,spacePermissionsSettingsStore:i}=e;const n=(0,r().v3)(),o=Z(),d=(0,a().K8)((()=>Boolean(t.getInviteLinkEnabled())),[t]);return(0,T.jsxs)("div",{style:o.inviteLinkSection,children:[(0,T.jsxs)("div",{style:{marginRight:8,flexGrow:1},children:[(0,T.jsx)(R().A,{smallMarginBottom:!0,children:(0,T.jsx)(l().sA,{id:"spacePermissionsSettings.spaceMembers.inviteLink.description",defaultMessage:"Invite link to add members"})}),(0,T.jsx)(z().A,{isSmall:!0,isMultiline:!0,style:{marginTop:0,width:"85%"},children:i&&d&&s?(0,T.jsx)(H,{spaceStore:t}):(0,T.jsx)(l().sA,{id:"spacePermissionSettings.spaceMembers.inviteLink.caption.v2",defaultMessage:"Only people with permission to invite members can see this."})})]}),(0,T.jsx)("div",{style:{minWidth:130},children:(0,T.jsxs)(_().Y1,{gap:16,align:"center-right",direction:"horizontal",children:[i&&d&&s?(0,T.jsx)(L().E,{color:"uiBlue",onClick:()=>{!async function(e){let{environment:t,inviteLinkUrl:s}=e;const i=await m().R.clipboardActions.load();i.copyString({environment:t,stringValue:s,copiedMessage:i.clipboardMessages.copiedLinkToClipboard}),(0,u().b)(t)}({environment:n,inviteLinkUrl:s})},children:(0,T.jsx)(l().sA,{id:"spacePermissionsSettings.spaceMembers.inviteLink.copyButton",defaultMessage:"Copy link"})}):void 0,(0,T.jsx)(F().A,{on:d,onClick:()=>{!function(e){let{environment:t,spaceStore:s,inviteLinkEnabled:i}=e;const r=!i;c().OE(t,{enabled:r}),v().createAndCommit({userAction:"SpacePermissionsSettings.handleInviteLinkClick",environment:t,canUndo:!0,perform:e=>{h().Xk({transaction:e,spaceStore:s,inviteLinkEnabled:Boolean(r)})}})}({environment:n,spaceStore:t,inviteLinkEnabled:d})}})]})})]})}function H(e){let{spaceStore:t,organizationId:s,showBlueLink:a}=e;const n=(0,r().v3)(),o=(0,i.useCallback)((()=>{g().ui({message:(0,T.jsx)(l().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.description",defaultMessage:"Are you sure you want to reset the invite link for all space members? Your old one will no longer be able to be used."}),showCancel:!0,keepFocus:!1,handleCancel:g().zw,items:[{label:(0,T.jsx)(l().sA,{id:"spacePermissionsSettings.inviteLinkRefreshModal.accept",defaultMessage:"Reset"}),color:"red",onAccept:async()=>{await p().callApi({eventName:"refreshInviteLink",environment:n,data:{spaceId:t.id,organizationId:s}}),S().x(n)}}]})}),[n,t.id,s]);return(0,T.jsx)(l().sA,{id:"spacePermissionSettings.spaceMembers.inviteLink.resetLink.v2",defaultMessage:"Only people with permission to invite members can see this. You can also <resetlink>generate a new link</resetlink>",values:{resetlink:e=>a?(0,T.jsx)(B()._,{onClick:o,children:e}):(0,T.jsx)(V().A,{onClick:o,children:e})}})}function K(e){let{spaceStore:t,inviteLinkCode:s,spacePermissionsSettingsStore:i}=e;const o=(0,r().v3)(),l=(0,a().K8)((()=>(0,y().e3)({spaceStore:t,environment:o,inviteLinkCode:s})),[t,s,o]),d=(0,O().Gg)({spaceStore:t})&&l,c=(0,n().IS)((e=>({divider:{color:e.stroke.secondary}})),[]),u=(0,a().K8)((()=>(0,j().Nu)()),[]);return(0,T.jsxs)(U().VP,{marginTop:16,children:[u?(0,T.jsx)(k,{}):void 0,d?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(G,{spaceStore:t,inviteLink:l,spacePermissionsSettingsStore:i}),(0,T.jsx)(E().A,{size:40,dividerColor:c.divider.color})]}):null]})}function Z(){return(0,n().IS)((()=>({inviteLinkSection:{display:"flex",alignItems:"center"},headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:d().Wy.medium,display:"flex",justifyContent:"space-between",alignItems:"center"}})),[])}},359941:(e,t,s)=>{s.d(t,{V:()=>n});var i=()=>s(56366),r=()=>s(646736),a=()=>s(12974);function n(e){const{spaceStore:t}=e,s=(0,r().eD)(t);return(0,i().K8)((()=>(0,a().MU)({spaceStore:t,actorRole:s})),[t,s])}},397103:(e,t,s)=>{s.d(t,{h:()=>n});var i=()=>s(56366),r=()=>s(765957),a=()=>s(329304);function n(){var e;const{currentSpaceId:t,currentUserId:s}=(0,i().K8)((()=>{var e,t;return{currentSpaceId:null===(e=r().default.state.currentSpaceStore)||void 0===e?void 0:e.id,currentUserId:null===(t=r().default.state.currentUserStore)||void 0===t?void 0:t.id}}),[]),n=(0,a()._X)({name:"members",spaceId:t,userId:s,amount:"unknown"}),o=null==n||null===(e=n.limit)||void 0===e?void 0:e.total;return!!o&&("unlimited"===o||o>1)}},418884:(e,t,s)=>{s.d(t,{A:()=>n});s(296540),s(581454);function i(){return(navigator.languages?navigator.languages.map((e=>e.toLowerCase())):navigator.language?[navigator.language.toLowerCase()]:navigator.userLanguage?[navigator.userLanguage.toLowerCase()]:[]).map((e=>e.split("-")[0]))}const r=["ar","az","he","fa","ur"];var a=s(474848);const n=function(e){const{style:t,translations:s}=e,n=i();for(const i of n){const e=s[i];if(e){const s=r.includes(i);return(0,a.jsx)("div",{style:{...s&&{direction:"rtl"},...t},children:e})}}return null}},436529:(e,t,s)=>{s.d(t,{Ay:()=>l,N4:()=>n,xt:()=>a});var i=()=>s(662303);const r=["en","en-us","en-ca"];function a(e){return"pdf"===e.exportOptions.exportType}function n(){return r.includes(i().locale.toLowerCase())?"Letter":"A4"}class o extends(()=>s(757695))().Store{getInitialState(){return{open:!1,shouldExportComments:!1}}}const l=new o},461924:(e,t,s)=>{s.d(t,{o:()=>i});s(898992),s(354520);class i{constructor(e){this.rowsStore=new r,this.sort=void 0,this.filter=void 0,this.abortController=void 0,this._isFetching=!1,this.rowsStore.setState({rows:e,hasMore:!0})}async _maybeFetch(){if(!this._isFetching){this._isFetching=!0;try{return await this.fetch()}finally{this._isFetching=!1}}}async loadMore(){const e=await this._maybeFetch();e&&this.rowsStore.setState({rows:[...this.rowsStore.getState().rows??[],...e.rows??[]],hasMore:e.hasMore})}async setSort(e){this.sort=e,await this.refresh()}async setFilter(e){this.filter=e,await this.refresh()}async refresh(){var e;null===(e=this.abortController)||void 0===e||e.abort(),this._isFetching=!1;const t=await this._maybeFetch();t&&this.rowsStore.setState({rows:t.rows,hasMore:t.hasMore})}}class r extends(()=>s(757695))().Store{getInitialState(){return{rows:void 0,hasMore:!0}}}},492666:(e,t,s)=>{s.d(t,{b:()=>a});var i=()=>s(679924),r=()=>s(217429);function a(e){(0,i().v)(e,"workspace_invite_copy_link"),r().default.logEvent("workspace_invite_copy_link")}},544019:(e,t,s)=>{s.d(t,{A:()=>r});class i extends(()=>s(757695))().Store{getInitialState(){return{count:0,exportedPageCount:0}}}const r=new i},576737:(e,t,s)=>{s.d(t,{z:()=>r});s(898992),s(354520),s(581454);var i=()=>s(848538);class r extends(()=>s(461924))().o{constructor(e){const{users:t,initialMembershipFilter:s,initialSort:i,initialQuery:r,limit:a}=e;super([]),this._allUsers=void 0,this._filteredAndSortedUsers=[],this._currentPage=0,this._limit=void 0,this._query=void 0,this._allUsers=[...t],this._limit=a??20,this._query=void 0,this.filter=s,this.sort=i,this._query=r,this._updateFilteredAndSortedUsers(),this.refresh()}_updateFilteredAndSortedUsers(){let e=this._applyMembershipFilter(this._allUsers);this._query&&(e=this._applySearch(e)),this.sort&&(e=this._applySort(e)),this._filteredAndSortedUsers=e}_applyMembershipFilter(e){return this.filter?e.filter((e=>"members"===this.filter?void 0!==e.membership_type&&(0,i().MN)(e.membership_type):"guests"!==this.filter||void 0!==e.membership_type&&(0,i().P)(e.membership_type))):e}_applySearch(e){return this._query&&0!==this._query.length?(0,s(778078).Ay)(this._query,e,(e=>[e.name,e.email].filter(Boolean).join(" "))):e}_applySort(e){if(!this.sort)return e;const{field:t,direction:s}=this.sort,i="asc"===s?1:-1,r=e.map((e=>{let s,i;switch(t){case"name_normalized":s=this._normalizeName(e.name)||e.email.toLowerCase();break;case"type":s=this._getMembershipTypeRank(e.membership_type),i=this._normalizeName(e.name)||e.email.toLowerCase();break;case"first_joined":s=e.first_joined_space_time||0;break;default:s=null}return{user:e,sortValue:s,secondarySortValue:i}}));return r.sort(((e,s)=>{if(null===e.sortValue&&null===s.sortValue);else{if(null===e.sortValue)return Number(i);if(null===s.sortValue)return-1*i;if(e.sortValue<s.sortValue)return-1*i;if(e.sortValue>s.sortValue)return Number(i)}if("type"===t&&e.secondarySortValue&&s.secondarySortValue){if(e.secondarySortValue<s.secondarySortValue)return-1;if(e.secondarySortValue>s.secondarySortValue)return 1}return(e.user.id<s.user.id?-1:1)*i})),r.map((e=>e.user))}_normalizeName(e){return null==e?void 0:e.normalize("NFKD").toLowerCase().replace(/\p{Diacritic}/gu,"")}_getMembershipTypeRank(e){switch(e){case"owner":return 6;case"membership_admin":return 5;case"member":return 4;case"restricted_member":return 3;case"page_guest":return 2;case"none":return 1;default:return 0}}async setUsers(e){this._allUsers=[...e],this._updateFilteredAndSortedUsers(),await this.refresh()}async setFilter(e){this.filter!==e&&(this._currentPage=0,this.filter=e,this._updateFilteredAndSortedUsers(),await this.refresh())}async setSort(e){var t,s;(null===(t=this.sort)||void 0===t?void 0:t.field)===(null==e?void 0:e.field)&&(null===(s=this.sort)||void 0===s?void 0:s.direction)===(null==e?void 0:e.direction)||(this._currentPage=0,this.sort=e,this._updateFilteredAndSortedUsers(),await this.refresh())}async setQuery(e){this._query!==e&&(this._query=e,this._currentPage=0,this._updateFilteredAndSortedUsers(),await this.refresh())}async fetch(){const e=this._currentPage*this._limit,t=e+this._limit,s=this._filteredAndSortedUsers.slice(e,t),i=t<this._filteredAndSortedUsers.length;return Promise.resolve({rows:s,hasMore:i})}async loadMore(){this._currentPage++,await super.loadMore()}async refresh(){this._currentPage=0,await super.refresh()}TEST_ONLY_setLimit(e){this._limit=e}}},585428:(e,t,s)=>{s.d(t,{e:()=>i});s(16280),s(898992),s(354520);class i extends(()=>s(461924))().o{constructor(e){let{users:t,environment:s,spaceId:i,initialMembershipFilter:r,initialSort:a,initialQuery:n,limit:o}=e;super(t),this._spaceId=void 0,this._environment=void 0,this._cursor=void 0,this._limit=void 0,this._query=void 0,this._environment=s,this._limit=o??20,this._cursor=void 0,this._query=void 0,this._spaceId=i,this.filter=r,this.sort=a,this._query=n,this.refresh()}async setFilter(e){this.filter!==e&&(this._cursor=void 0,this.filter=e,await this.refresh())}async setSort(e){var t,s;(null===(t=this.sort)||void 0===t?void 0:t.field)===(null==e?void 0:e.field)&&(null===(s=this.sort)||void 0===s?void 0:s.direction)===(null==e?void 0:e.direction)||(this._cursor=void 0,this.sort=e,await this.refresh())}async setQuery(e){this._query!==e&&(this._query=e,this._cursor=void 0,await this.refresh())}async refresh(){this._cursor=void 0,await super.refresh()}async fetch(){return await(0,s(532313).L5)({fn:async()=>{var e,t;const{callApi:i}=await Promise.resolve().then(s.bind(s,449506));this.abortController=new AbortController;const r=await i({eventName:"listUsers",environment:this._environment,data:{cursor:this._cursor,membershipFilter:this.filter,limit:this._limit,sort:null===(e=this.sort)||void 0===e?void 0:e.field,sortDirection:null===(t=this.sort)||void 0===t?void 0:t.direction,query:this._query,spaceId:this._spaceId},abortSignal:this.abortController.signal});if(this.abortController=void 0,"success"===r.type)return this._cursor=r.data.nextCursor,{rows:r.data.users,hasMore:r.data.hasMore};if("failed"===r.type&&(r.offline||429===r.status||503===r.status||504===r.status))throw new Error(`RetryableError:${r.status}`)},handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:[1e3,2e3,4e3],retryAttemptRandomOffsetMS:500,initialInput:void 0})}}},663247:(e,t,s)=>{s.r(t),s.d(t,{arrowDiagonalUpRightFillIcon:()=>r,iconDefinition:()=>i});s(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"4.16 4.17 11.67 11.67",directional:!0,svg:(0,s(474848).jsx)("path",{d:"M15.825 5.05a.875.875 0 0 0-.875-.875H7.313a.875.875 0 1 0 0 1.75h5.524L4.393 14.37c-.32.32-.303.857.039 1.198.341.342.878.36 1.198.039l8.445-8.444v5.524a.875.875 0 1 0 1.75 0z"})},r=(0,s(340498).wt)("arrowDiagonalUpRightFill",i)},709062:(e,t,s)=>{s.d(t,{C_:()=>u,Iu:()=>g,MG:()=>m});s(296540);var i=()=>s(340498),r=s(474848);const a={viewBox:"0 0 20 20",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{width:"16",height:"16",x:"2",y:"2",fill:"#039",rx:"8"}),(0,r.jsx)("rect",{width:"15",height:"15",x:"2.5",y:"2.5",stroke:"#544831",strokeOpacity:".15",rx:"7.5",fill:"#039"}),(0,r.jsx)("path",{fill:"#FC0",d:"m10 4 .168.518h.545l-.44.32.168.519-.441-.32-.44.32.168-.518-.441-.32h.545L10 4ZM10 14.5l.168.518h.545l-.44.32.168.519-.441-.32-.44.32.168-.518-.441-.32h.545L10 14.5ZM15.25 9.063l.168.518h.545l-.44.32.168.518-.441-.32-.44.32.168-.518-.441-.32h.545l.168-.518ZM4.75 9.063l.168.518h.545l-.44.32.168.518-.441-.32-.44.32.168-.518-.441-.32h.545l.168-.518ZM7.422 4.75l.168.518h.545l-.44.32.168.519-.441-.32-.441.32.168-.518-.44-.32h.544l.169-.519ZM7.422 13.532l.168.518h.545l-.44.32.168.518-.441-.32-.441.32.168-.518-.44-.32h.544l.169-.518ZM12.578 4.75l.168.518h.545l-.44.32.168.519-.441-.32-.44.32.168-.518-.441-.32h.545l.168-.519ZM12.578 13.532l.168.518h.545l-.44.32.168.518-.441-.32-.44.32.168-.518-.441-.32h.545l.168-.518ZM5.5 6.547l.168.518h.545l-.44.32.168.519-.441-.32-.44.32.168-.519-.441-.32h.545l.168-.518ZM5.5 11.579l.168.518h.545l-.44.32.168.518-.441-.32-.44.32.168-.518-.441-.32h.545l.168-.518ZM14.5 6.547l.168.518h.545l-.44.32.168.519-.441-.32-.44.32.168-.519-.441-.32h.545l.168-.518ZM14.5 11.579l.168.518h.545l-.44.32.168.518-.441-.32-.44.32.168-.518-.441-.32h.545l.168-.518Z"})]})},n=(0,i().wt)("flagEu",a),o={viewBox:"0 0 20 20",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"2",y:"2",width:"16",height:"16",rx:"8",fill:"#D9D9D9"}),(0,r.jsx)("rect",{x:"2.5",y:"2.5",width:"15",height:"15",rx:"7.5",stroke:"#544831",strokeOpacity:"0.15",fill:"#D9D9D9"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 10H2C2 9.105 2.1488 8.24494 2.41992 7.44141L2.83008 7.73926L2.49316 8.77637L3.375 8.13574L4.25684 8.77637L3.91992 7.73926L4.80176 7.09863H3.71191L3.375 6.0625L3.03809 7.09863H2.54492C3.20107 5.41387 4.41027 4.00679 5.95117 3.10059L6.83008 3.73926L6.49316 4.77637L7.375 4.13574L8.25684 4.77637L7.91992 3.73926L8.80176 3.09863H7.71191L7.48633 2.4043C8.27693 2.1428 9.12173 2 10 2V10ZM7.03809 7.09863H5.94824L6.83008 7.73926L6.49316 8.77637L7.375 8.13574L8.25684 8.77637L7.91992 7.73926L8.80176 7.09863H7.71191L7.375 6.0625L7.03809 7.09863Z",fill:"#0052B4"}),(0,r.jsx)("path",{d:"M7.03809 3.09863H5.95508C6.3607 2.86038 6.7881 2.65494 7.23535 2.49023L7.03809 3.09863Z",fill:"#0052B4"}),(0,r.jsx)("path",{d:"M16.9268 14C16.4911 14.7529 15.9373 15.4281 15.2891 16H4.71094C4.06269 15.4281 3.50893 14.7529 3.07324 14H16.9268Z",fill:"#D80027"}),(0,r.jsx)("path",{d:"M18 10C18 10.6906 17.9126 11.3608 17.748 12H2.25195C2.08743 11.3608 2 10.6906 2 10H18Z",fill:"#D80027"}),(0,r.jsx)("path",{d:"M10 6H16.9268C17.2852 6.61938 17.5653 7.28996 17.748 8H10V6Z",fill:"#D80027"}),(0,r.jsx)("path",{d:"M10 2C12.0282 2 13.879 2.75604 15.2891 4H10V2Z",fill:"#D80027"})]})},l=(0,i().wt)("flagUsa",o);var d=()=>s(959013),c=()=>s(534177);function u(){return(0,r.jsx)(d().sA,{id:"organization.workspaceSettings.locked.tooltip",defaultMessage:"This setting is being managed by your organization."})}const p=(0,d().YK)({"us-west-2":{id:"organization.dataResidency.location.us",defaultMessage:"United States"},"eu-central-1":{id:"organization.dataResidency.location.eu",defaultMessage:"Europe"},unknown:{id:"organization.dataResidency.location.unknown",defaultMessage:"N/A"}});function m(e){switch(e){case"us-west-2":case"eu-central-1":return p[e];case void 0:return p.unknown;default:(0,c().HB)(e)}}function g(e){switch(e){case"us-west-2":return l;case"eu-central-1":return n;default:(0,c().HB)(e)}}},736501:(e,t,s)=>{s.d(t,{f:()=>i});const i=28*s(720665).nD},762286:(e,t,s)=>{s.d(t,{A:()=>r});class i extends(()=>s(757695))().Store{getInitialState(){return{recentRecoverableUsers:[],searchQuery:void 0}}}const r=new i},792223:(e,t,s)=>{s.d(t,{BV:()=>m,CR:()=>b,Gg:()=>y,k4:()=>v,r1:()=>h,rl:()=>g,t1:()=>f,tU:()=>S,zh:()=>x});var i=()=>s(484714),r=()=>s(56366),a=()=>s(187174),n=()=>s(979340),o=()=>s(449506),l=()=>s(901389),d=()=>s(397103),c=()=>s(12974),u=()=>s(134217),p=()=>s(762286);function m(e){let{spaceStore:t,members:s}=e;const r=h({spaceStore:t}),n=(0,i().v3)(),d=t.id,[c]=(0,a().Yb)((async()=>{if(!r)return;const e=await o().callApi({eventName:"getRecentlyRemovedUsers",environment:n,data:{spaceId:d}});if("failed"===e.type)throw l().Qg(e),e;return e.data.recentlyRemovedMembers}),[d,n,r,s]);return c.value}function g(e){let{spaceStore:t,subscriptionData:s}=e;const r=f({spaceStore:t,subscriptionData:s}),n=(0,i().v3)();(0,a().Yb)((async()=>{if(!r)return;const e=await o().callApi({eventName:"getRecoverableSpaceUserContent",environment:n,data:{spaceId:t.id}});if("failed"===e.type)throw e;const s=e.data.recentSpaceRecoverPages;return p().A.setState({...p().A.state,recentRecoverableUsers:s}),s}),[t,n,r])}function f(e){let{spaceStore:t,subscriptionData:s}=e;return(0,r().K8)((()=>t.canAdmin()&&n().OX(s.subscriptionTier)),[s,t])}function h(e){let{spaceStore:t}=e;return(0,r().K8)((()=>t.canAdmin()),[t])}function v(e){let{spaceStore:t}=e;return(0,r().K8)((()=>!!t&&t.canEditMembership()),[t])}function x(){const e=(0,i().v3)();return(0,r().K8)((()=>u().vl(e)),[e])}function y(e){let{spaceStore:t}=e;const s=(0,d().h)();return(0,r().K8)((()=>(null==t?void 0:t.canEditMembership())&&s),[t,s])}function b(e){let{spaceStore:t}=e;const s=(0,r().K8)((()=>(0,c().Pd)()),[]),i=(0,d().h)();return(0,r().K8)((()=>null==t?void 0:t.canAdmin()),[t])&&i&&s}function S(e){let{spaceStore:t}=e;const s=(0,r().K8)((()=>(0,c()._m)()),[]),i=(0,d().h)();return(0,r().K8)((()=>null==t?void 0:t.canAdmin()),[t])&&i&&s}},926938:(e,t,s)=>{s.d(t,{q:()=>o});var i=()=>s(484714),r=()=>s(187174),a=()=>s(534177),n=()=>s(449506);function o(){const e=(0,i().v3)(),[{status:t,error:s,value:o},l]=(0,r().Yb)((async()=>{const t=await n().callApi({eventName:"getUserOrganizations",environment:e,data:{}});if("success"===t.type)return t.data;if("failed"===t.type)throw t.error;return(0,a().HB)(t)}),[e]);return{organizationsInfo:(null==o?void 0:o.organizationsInfo)??[],loading:"pending"===t||"idle"===t,error:s,refresh:l}}}}]);