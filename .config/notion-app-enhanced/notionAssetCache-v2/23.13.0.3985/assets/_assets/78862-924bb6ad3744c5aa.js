"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[78862],{94935:(e,s,t)=>{t.d(s,{r:()=>a});function a(e,s){return(e.getName()||"").localeCompare(s.getName()||"")}},222334:(e,s,t)=>{t.r(s),t.d(s,{arrowChevronSingleRightIcon:()=>o,iconDefinition:()=>a});t(296540);const a={viewBox:"0 0 20 20",fittedViewBox:"7.22 3.97 6.66 12.06",directional:!0,svg:(0,t(474848).jsx)("path",{d:"M13.692 10.442a.625.625 0 0 0 0-.884l-5.4-5.4a.625.625 0 1 0-.884.884L12.366 10l-4.958 4.958a.625.625 0 0 0 .884.884z"})},o=(0,t(340498).wt)("arrowChevronSingleRight",a)},247601:(e,s,t)=>{t.d(s,{a:()=>c});t(944114),t(517642),t(658004),t(733853),t(845876),t(432475),t(515024),t(731698),t(898992),t(354520),t(581454),t(737550);var a=t(296540),o=()=>t(484714),n=()=>t(56366),i=()=>t(68263),l=()=>t(179034),r=()=>t(108944),d=()=>t(630116);function c(e){let{pagesSharedWithUser:s,privatePages:t,workspacePages:c,teamPagesByTeam:g,selectedPageIds:p,spaceStore:h}=e;const u=(0,o().v3)(),m=(0,n().K8)((()=>new Set(s.filter((e=>(0,i().Km)(e.getRole()||"none"))).map((e=>e.id)))),[s]),y=(0,n().K8)((()=>new Set(t.filter((e=>(0,i().Km)(e.getRole()||"none"))).map((e=>e.id)))),[t]),x=(0,n().K8)((()=>new Set(Object.values(g).flat().filter((e=>{const s=new(d().Bv)(u,{table:l().ev,id:e,spaceId:h.id});return(0,i().Km)(s.getRole()||"none")})))),[u,h.id,g]),v=(0,n().K8)((()=>new Set(c.filter((e=>(0,i().Km)(e.getRole()||"none"))).map((e=>e.id)))),[c]),f=(0,a.useMemo)((()=>{const e={};for(const s of Object.keys(g))e[s]=g[s].filter((e=>x.has(e)));return e}),[g,x]),S=(0,n().K8)((()=>{const e=[];for(const s of p){if(m.has(s)||y.has(s))continue;const t=new(d().Bv)(u,{table:l().ev,id:s,spaceId:h.id});(0,r().g7)(t).some((e=>e.table===l().ev&&m.has(e.id)))&&e.push(s)}return e}),[p,m,y,u,h.id]),j=(0,n().K8)((()=>{const e=new Set;for(const s of p){if(x.has(s))continue;const t=new(d().Bv)(u,{table:l().ev,id:s,spaceId:h.id});(0,r().g7)(t).some((e=>e.table===l().ev&&x.has(e.id)))&&e.add(s)}return e}),[p,x,u,h.id]),I=(0,n().K8)((()=>{const e=[];for(const s of p){if(v.has(s))continue;const t=new(d().Bv)(u,{table:l().ev,id:s,spaceId:h.id});(0,r().g7)(t).some((e=>e.table===l().ev&&e.isTopLevelWorkspacePage(h.id)))&&e.push(s)}return e}),[u,p,h.id,v]),P=(0,n().K8)((()=>{const e=[];for(const s of p){if(y.has(s)||m.has(s)||x.has(s))continue;const t=new(d().Bv)(u,{table:l().ev,id:s,spaceId:h.id});(0,r().g7)(t).some((e=>e.table===l().ev&&e.isTopLevelPrivatePage()))&&e.push(s)}return e}),[p,y,m,x,u,h.id]);return{topLevelShareableSharedPageIds:m,topLevelShareablePrivatePageIds:y,topLevelShareableTeamspacePageIds:x,topLevelShareableWorkspacePageIds:v,shareableTeamPagesByTeam:f,selectedNonTopLevelSharedPageIds:S,selectedNonTopLevelPrivatePageIds:P,selectedNonTopLevelWorkspacePageIds:I,teamspaceManualSet:j}}},307971:(e,s,t)=>{t.d(s,{f:()=>T});t(898992),t(354520),t(581454),t(296540);var a=()=>t(484714),o=()=>t(56366),n=()=>t(401497),i=()=>t(187174),l=()=>t(29037),r=()=>t(68263),d=()=>t(179034),c=()=>t(959013),g=()=>t(381349),p=()=>t(534177),h=()=>t(722872),u=()=>t(645873),m=()=>t(106628),y=()=>t(361330),x=()=>t(630116),v=()=>t(84817),f=()=>t(928600),S=()=>t(939740),j=()=>t(64e3),I=()=>t(8980),P=()=>t(958378),b=()=>t(16006),k=()=>t(89924),A=()=>t(320865),M=t(474848);function T(e){const{spaceId:s,onSelectPage:t,query:T,source:w,findSelectedBlockAncestorId:B,spaceStore:C}=e,N=(0,n().IS)((e=>({hoveredRow:{background:e.buttonHoveredBackground}})),[]),L=(0,a().v3)();let W=null;const H=(0,u().fJ)(m().T.searchActions),[{status:R,value:z}]=(0,i().Yb)((async()=>{if("resolved"!==H.status)return;const e=H.value;return await e.searchPagesInSpace({environment:L,query:T,limit:10,requireEditPermissions:!0,spaceId:s,excludeTemplates:!0,source:w,boostRecentlyViewedPages:!1,spaceStore:C})}),[H.status,H.value,L,T,s,w,C],{debounce:y().tu}),U=(0,o().K8)((()=>"idle"===R||"pending"===R?[]:((null==z?void 0:z.results)||[]).map((e=>{let{id:s}=e;const a=new(x().Bv)(L,{table:d().ev,id:s});return function(e){const{store:s,environment:t,alreadySelectedAncestorId:a,onSelectPage:o,styles:n}=e;if(a&&a===s.id)return{key:s.id,action:()=>{},render:e=>(0,M.jsx)(P().A,{...e,hoveredStyle:n.hoveredRow,store:s,hidePath:!1,disabled:!0,style:{opacity:.5},right:(0,M.jsxs)(v().Y1,{direction:"horizontal",gap:4,align:"center",children:[(0,M.jsx)(I().I,{icon:l().checkmarkIcon,color:"uiBluePrimary"}),(0,M.jsx)("div",{style:{color:g().Ay.blue},children:(0,M.jsx)(c().sA,{id:"oauthPageSearchResults.disabledResult.bySelf.message",defaultMessage:"Already added"})})]})})};if(a){const e=new(x().Bv)(t,{table:d().ev,id:a});return{key:s.id,action:()=>{},render:t=>(0,M.jsx)(P().A,{...t,hoveredStyle:n.hoveredRow,store:s,hidePath:!0,disabled:!0,style:{opacity:.5},caption:(0,M.jsx)(c().sA,{id:"oauthPageSearchResults.disabledResult.byAncestor.message",defaultMessage:"Added via {ancestorPageName}",values:{ancestorPageName:(0,M.jsx)(b().A,{store:e,style:{display:"inline"}})}}),right:(0,M.jsxs)(v().Y1,{direction:"horizontal",gap:4,align:"center",children:[(0,M.jsx)(I().I,{icon:l().checkmarkIcon,color:"uiBluePrimary"}),(0,M.jsx)("div",{style:{color:g().Ay.blue},children:(0,M.jsx)(c().sA,{id:"oauthPageSearchResults.disabledResult.bySelf.message",defaultMessage:"Already added"})})]})})}}const i=s.getRole();return i&&r().Km(i)?{key:s.id,action:()=>o(s.id),render:e=>(0,M.jsx)(P().A,{store:s,hidePath:!1,hoveredStyle:n.hoveredRow,...e})}:void 0}({store:a,alreadySelectedAncestorId:B(a),environment:L,onSelectPage:t,styles:N})})).filter(p().O9)),[L,B,t,null==z?void 0:z.results,R,N]);W="idle"===R||"pending"===R?(0,M.jsx)(k().A,{children:(0,M.jsx)(A().A,{})}):0===U.length?(0,M.jsx)(k().A,{children:(0,M.jsx)(j().A,{title:(0,M.jsx)(c().sA,{id:"oauthPageSearchResults.noResults.placeholder",defaultMessage:"No results"})})}):function(e){return(0,M.jsx)(S().Ay,{type:S().Oh.Vertical,initialFocus:void 0,sections:[{key:"results",items:e,render:e=>(0,M.jsx)(k().A,{...e})}]})}(U);const D={menuType:h().gu.Popup};return(0,M.jsx)(f().A,{...D,children:W})}},404200:(e,s,t)=>{t.d(s,{V:()=>a});const a=(0,t(959013).YK)({teamspacesHeader:{id:"pageAccess.teamspacesHeader",defaultMessage:"Teamspaces"},teamspacesHeaderSubheader:{id:"pageAccess.teamspacesSubheader",defaultMessage:"Teamspace pages"},topLevelPagesHeader:{id:"pageAccess.topLevelPagesHeader",defaultMessage:"Top level pages"},manuallySelectedPagesHeader:{id:"pageAccess.manuallySelectedPagesHeader",defaultMessage:"Manually selected"},sharedPagesHeader:{id:"pageAccess.sharedPagesHeader",defaultMessage:"Shared"},privatePagesHeader:{id:"pageAccess.privatePagesHeader",defaultMessage:"Private"},workspacePagesHeader:{id:"pageAccess.workspacePagesHeader",defaultMessage:"Workspace"}})},568721:(e,s,t)=>{t.d(s,{b:()=>p});t(581454);var a=t(296540),o=()=>t(401497),n=()=>t(222334),i=()=>t(340498),l=()=>t(284371),r=()=>t(21140),d=()=>t(704152),c=()=>t(125565),g=t(474848);function p(e){const{sections:s,expandAllWhenSectionsChange:t=!1}=e,p=(0,o().IS)((e=>({container:{display:"grid",gap:4},sectionButton:{background:e.palette.translucentGray[50],borderRadius:6,padding:"8px 12px"},sectionButtonHovered:{background:e.palette.translucentGray[100]},sectionButtonPressed:{background:e.lightGrayButtonPressedBackground},sectionButtonLabel:{justifyContent:"space-between",display:"flex",alignItems:"center"},sectionTitle:{fontWeight:l().Wy.medium,padding:0},sectionButtonIconArea:{alignItems:"center"},chevronIcon:{width:i().Ev.xs,height:i().Ev.xs,marginLeft:12,transition:"transform 200ms ease-out"},sectionContent:{padding:"12px 24px"}})),[]),[h,u]=a.useState({});return a.useEffect((()=>{if(t){const e={};for(const t of s)t.hidden||(e[t.key]=!0);u(e)}}),[s,t]),(0,g.jsx)("div",{style:p.container,children:s.map((e=>{if(e.hidden)return null;const s=Boolean(h[e.key]),t=!1!==e.collapsible;return(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{children:t?(0,g.jsx)(d().A,{onClick:()=>u({...h,[e.key]:!s}),style:p.sectionButton,hoveredStyle:p.sectionButtonHovered,children:(0,g.jsxs)(r().Ye,{style:p.sectionButtonLabel,children:[(0,g.jsx)("div",{children:(0,g.jsx)(c().A,{style:p.sectionTitle,children:e.title})}),(0,g.jsxs)(r().Ye,{style:p.sectionButtonIconArea,children:[e.secondaryLabel&&(0,g.jsx)(c().A,{isSecondaryColor:!0,children:e.secondaryLabel}),(0,n().arrowChevronSingleRightIcon)({...p.chevronIcon,transform:`rotateZ(${s?90:0}deg)`})]})]})}):(0,g.jsx)("div",{style:p.sectionButton,children:(0,g.jsxs)(r().Ye,{style:p.sectionButtonLabel,children:[(0,g.jsx)("div",{children:(0,g.jsx)(c().A,{style:p.sectionTitle,children:e.title})}),e.secondaryLabel&&(0,g.jsx)(c().A,{isSecondaryColor:!0,children:e.secondaryLabel})]})})}),e.content&&(0,g.jsx)("div",{style:{...e.sectionContentStyleOverride?e.sectionContentStyleOverride:p.sectionContent,display:s?"block":"none"},children:e.content})]},e.key)}))})}},593781:(e,s,t)=>{t.d(s,{r:()=>j});t(944114),t(517642),t(658004),t(733853),t(845876),t(432475),t(515024),t(731698);var a=t(296540),o=()=>t(484714),n=()=>t(401497),i=()=>t(920495),l=()=>t(340498),r=()=>t(959013),d=()=>t(908928),c=()=>t(2220),g=()=>t(84817),p=()=>t(493823),h=()=>t(554509),u=()=>t(204063),m=()=>t(107683),y=()=>t(2609),x=()=>t(855939),v=t(474848);const f=(0,r().YK)({modalHeader:{id:"pageAccess.modal.header",defaultMessage:"Select page access"},byline:{id:"pageAccess.modal.byline",defaultMessage:"Choose the pages and databases this integration can access. To include unlinked pages, search and add them manually."},saveButton:{id:"pageAccess.modal.saveButton",defaultMessage:"Update access"},cancelButton:{id:"pageAccess.modal.cancelButton",defaultMessage:"Cancel"}});function S(e){let{onClose:s,pageIdsAlreadySharedWithBot:t,teamPagesByTeam:m,allTeams:S,privatePages:j,pagesSharedWithUser:I,workspacePages:P,spaceId:b,botStore:k,spaceStore:A,refetchBotSharedPages:M,selectedBlockIdsStore:T,pagePickerLocation:w}=e;const B=(0,n().IS)((e=>({icon:{width:l().Ev.xl,height:l().Ev.xl,color:e.icon.secondary}})),[]),C=(0,r().tz)(),N=(0,o().v3)(),[L,W]=a.useState(!1);return(0,v.jsxs)(g().Y1,{direction:"vertical",height:"fill",padding:20,gap:20,children:[(0,v.jsxs)(g().Y1,{gap:24,direction:"vertical",children:[(0,v.jsx)(y().rQ,{icon:(0,i().pageIcon)(B.icon),title:C.formatMessage(f.modalHeader),byline:C.formatMessage(f.byline),bylineWidthOverride:"80%"}),(0,v.jsx)(x().C,{teamPagesByTeam:m,allTeams:S,privatePages:j,pagesSharedWithUser:I,workspacePages:P,spaceId:b,spaceStore:A,selectedBlockIdsStore:T,heightOverride:280})]}),(0,v.jsxs)(g().Y1,{gap:8,direction:"horizontal",align:"center-right",children:[(0,v.jsx)(p().p,{onClick:s,disabled:L,size:"lg",children:(0,v.jsx)(h().D,{styleName:"UIRegular-14px/Medium",colorName:"secondary",children:C.formatMessage(f.cancelButton)})}),(0,v.jsx)(u().A,{size:"lg",onClick:async()=>await(async()=>{W(!0);const e=new Set(t),a=T.state,o=[];let n=0,i=0;for(const s of Object.keys(a)){const t=a[s],l=e.has(s);l&&!t?(o.push({pageId:s,operationType:"remove"}),i++):!l&&t&&(o.push({pageId:s,operationType:"add"}),n++)}o.length>0&&(await d().iN({environment:N,spaceStore:A,botStore:k,pageIdAndOperations:o,concurrency:20}),(0,c().u)({environment:N,event:{eventName:"clearer_integration_access_page_access_updated",eventProperties:{triggered_from:w,pages_added:n,pages_removed:i,space_id:b,bot_id:k.id}}}),M&&await M()),W(!1),s()})(),isLoading:L,disabled:L,children:C.formatMessage(f.saveButton)})]})]})}function j(e){const{onClose:s,selectedBlockIdsStore:t,pageIdsAlreadySharedWithBot:o}=e,n=a.useCallback((()=>{const e={};for(const s of o)e[s]=!0;t.setState(e),s()}),[s,t,o]);return(0,v.jsx)(m().s,{areaConstraint:{width:{type:"fixed",length:600},height:{type:"max",length:620}},isOpen:e.isOpen,onDismiss:n,render:()=>(0,v.jsx)(S,{...e,onClose:n})})}},639355:(e,s,t)=>{t.d(s,{I:()=>d});t(296540);var a=()=>t(340498),o=()=>t(84817),n=()=>t(554509),i=()=>t(16006),l=()=>t(898808),r=t(474848);function d(e){const{teamStore:s}=e;return(0,r.jsxs)(o().Y1,{direction:"horizontal",gap:8,width:"hug",children:[(0,r.jsx)(l().x,{disabled:!0,store:s,size:a().Ev.default}),(0,r.jsx)(n().D,{styleName:"UIRegular-14px/Medium",children:(0,r.jsx)(i().A,{store:s})})]})}},664460:(e,s,t)=>{t.d(s,{y:()=>S});var a=t(296540),o=()=>t(56366),n=()=>t(340498),i=()=>t(84817),l=()=>t(464708),r=()=>t(554509),d=()=>t(187820),c=()=>t(16006),g=()=>t(972435),p=()=>t(401497),h=()=>t(128295),u=()=>t(859428),m=()=>t(828634),y=()=>t(962730),x=t(474848);function v(e){let{blockStore:s,maxWidth:t}=e;const o=(0,p().IS)((e=>({truncatedText:{maxWidth:t,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},tooltipRecordPath:{flexWrap:"wrap",overflow:"visible"}})),[t]),n=(0,p().DP)(),i=a.useRef(null),[l,r]=a.useState(!1),d=a.useCallback((()=>{const e=i.current;if(!e)return;let s=e.scrollWidth>e.clientWidth;if(!s)for(const t of Array.from(e.querySelectorAll("*")))if(t.scrollWidth>t.clientWidth){s=!0;break}r((e=>e===s?e:s))}),[]);a.useEffect((()=>{d()}),[d,t]);const c=a.useRef(void 0),g=a.useCallback((e=>{c.current!==e&&(c.current=e,d())}),[d]);return(0,m().tK)(i,g),(0,x.jsx)(u().A,{textWrap:!0,placement:y().W.Top,disableTooltip:!l,render:e=>(0,x.jsx)("div",{...e,ref:i,style:o.truncatedText,children:(0,x.jsx)(h().Ay,{store:s,showFullPathInTooltip:!0,style:o.truncatedText,tooltipStyle:{color:n.text.contrastSecondary},ellipsisTooltipPlacement:y().W.Top})}),renderTooltip:()=>(0,x.jsx)(h().Ay,{store:s,textColor:n.text.contrastSecondary,style:o.tooltipRecordPath,innerStyle:{whiteSpace:"normal",overflow:"visible",textOverflow:"unset"}})})}const f=(0,t(959013).YK)({inTrash:{defaultMessage:"In trash",id:"creatorProfile.integrations.pageAccess.inTrash"}});function S(e){let{blockStore:s,styles:t,maxWidth:a,maxLength:p,shouldWrap:h=!1}=e;const{pageIcon:u,isEmptyPage:m,isInTrash:y,iconRecordCategory:S}=(0,o().K8)((()=>({pageIcon:s.getIcon(),isEmptyPage:s.isEmptyPage(),isInTrash:s.pathIsDead(),iconRecordCategory:(0,d().Te)(s)})),[s]);return(0,x.jsxs)(i().Y1,{direction:"horizontal",gap:8,width:"hug",children:[(0,x.jsx)(d().B6,{disabled:!0,icon:u,iconRecordCategory:S,size:n().Ev.default,pageIconStyle:null==t?void 0:t.pageIconStyle,isEmptyPage:m}),(0,x.jsxs)(i().Y1,{gap:"auto",align:"start",children:[(0,x.jsxs)(i().Y1,{direction:"horizontal",gap:4,children:[(0,x.jsx)(r().D,{styleName:"UIRegular-14px/Medium",children:(0,x.jsx)(c().A,{store:s,maxLength:p??60,shouldWrap:h,enableHover:!0})}),y&&(0,x.jsx)(l().A,{color:"yellow",content:g().A.formatMessage(f.inTrash)},s.id)]}),(0,x.jsx)(v,{blockStore:s,maxWidth:a})]})]})}},723786:(e,s,t)=>{t.d(s,{g:()=>d});t(898992),t(354520),t(581454),t(908872);var a=()=>t(484714),o=()=>t(56366),n=()=>t(179034),i=()=>t(854150),l=()=>t(640653),r=()=>t(630116);function d(e){let{pageIdsSharedWithUser:s,currentSpaceViewStore:t,spaceStore:d}=e;const c=(0,a().v3)(),g=(0,o().K8)((()=>t.getSpaceId()),[t]),p=(0,o().K8)((()=>s.map((e=>new(r().Bv)(c,{table:n().ev,id:e,spaceId:g})))),[s,c,g]),h=(0,o().K8)((()=>t.shouldShowWorkspaceSection(!1)?t.getWorkspacePages()??[]:[]),[t]),u=(0,o().K8)((()=>((null==t?void 0:t.getTeamsStores())??[]).reduce(((e,s)=>{const t=s.getTeamPagesStores().filter((e=>e.isLoadedNonCopyIndicator()));return t.length>0&&(e[s.id]=t.map((e=>e.id))),e}),{})),[t]),m=(0,o().K8)((()=>Object.keys(u).map((e=>new(r().h4)(c,{table:i().yK,id:e,spaceId:g})))),[c,g,u]),y=(0,o().K8)((()=>t.getPrivatePages(c)??[]),[t,c]),x=(0,o().K8)((()=>{const e=t.getUserId();return e?p.filter((s=>(0,l().Bz)({store:s,userId:e,spaceStore:d}))):[]}),[t,p,d]);return{allTeams:m,teamPagesByTeam:u,allPrivatePages:y,allSharedPages:x,allWorkspacePages:h}}},855939:(e,s,t)=>{t.d(s,{C:()=>G});t(944114),t(517642),t(658004),t(733853),t(845876),t(432475),t(515024),t(731698),t(898992),t(354520),t(672577),t(581454),t(737550);var a=t(296540),o=()=>t(484714),n=()=>t(56366),i=()=>t(401497),l=()=>t(416504),r=()=>t(207207),d=()=>t(406533),c=()=>t(340498),g=()=>t(68263),p=()=>t(179034),h=()=>t(959013),u=()=>t(284371),m=()=>t(84817),y=()=>t(493823),x=()=>t(568721),v=()=>t(285790),f=()=>t(419357),S=()=>t(378765),j=()=>t(939740),I=()=>t(8980),P=()=>t(554509),b=()=>t(897119),k=()=>t(89924),A=()=>t(859428),M=()=>t(307971),T=()=>t(972435),w=()=>t(108944),B=()=>t(94935),C=()=>t(962730),N=()=>t(630116),L=()=>t(664460),W=()=>t(760217),H=()=>t(187820),R=()=>t(16006),z=()=>t(73332),U=t(474848);function D(e){let{pageStore:s,isSelected:t,onToggle:a,maxLength:o,styles:i}=e;const{blockId:l,icon:r,isEmpty:d,iconRecordCategory:g}=(0,n().K8)((()=>({blockId:s.id,icon:s.getIcon(),isEmpty:s.isEmptyPage(),iconRecordCategory:(0,H().Te)(s)})),[s]);return(0,U.jsx)(W().A,{onClick:a,focused:!1,icon:(0,U.jsx)(z().T,{checked:t,size:14,onClick:e=>{e.stopPropagation(),a()}}),title:(0,U.jsxs)(m().Y1,{direction:"horizontal",gap:8,width:"hug",children:[(0,U.jsx)(H().B6,{disabled:!0,icon:r,iconRecordCategory:g,size:c().Ev.default,pageIconStyle:i.pageIconStyle,isEmptyPage:d}),(0,U.jsx)(P().D,{styleName:"UIRegular-14px/Medium",children:(0,U.jsx)(R().A,{store:s,maxLength:o??60,showTooltipWhenTruncated:!0})})]})},l)}var K=()=>t(222334),Y=()=>t(639355);const E=(0,h().YK)({collapseTeamspace:{id:"creatorProfile.integrations.pageAccess.collapseTeamspace",defaultMessage:"Collapse teamspace"},expandTeamspace:{id:"creatorProfile.integrations.pageAccess.expandTeamspace",defaultMessage:"Expand teamspace"}});function O(e){let{teamspaceStore:s,checkType:t,onToggleSelect:a,expanded:o,onExpandToggle:n}=e;return(0,U.jsx)(W().A,{onClick:n,focused:!1,icon:(0,U.jsx)(z().T,{checked:t,size:14,onClick:e=>{e.stopPropagation(),a()}}),right:(0,U.jsx)("div",{role:"button",tabIndex:0,style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:e=>{e.stopPropagation(),n()},"aria-label":o?T().A.formatMessage(E.collapseTeamspace):T().A.formatMessage(E.expandTeamspace),children:(0,U.jsx)(I().I,{icon:K().arrowChevronSingleRightIcon,size:"xs",style:{transform:o?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.1s ease-in-out"}})}),title:(0,U.jsx)(Y().I,{teamStore:s})},s.id)}var _=()=>t(247601);const V=(0,h().YK)({selectPagesLabel:{id:"pageAccess.modal.selectPagesLabel",defaultMessage:"Select pages"},searchPlaceholder:{id:"pageAccess.modal.searchPlaceholder",defaultMessage:"Search pages"},selectAll:{id:"pageAccess.modal.selectAll",defaultMessage:"Select all"},deselectAll:{id:"pageAccess.modal.deselectAll",defaultMessage:"Deselect all"},remove:{id:"pageAccess.modal.removePage",defaultMessage:"Remove"},noPagesMessage:{id:"pageAccess.modal.noPagesMessage",defaultMessage:"No pages found"},addPagesMessage:{id:"pageAccess.modal.addPagesMessage",defaultMessage:"Add pages first to give this integration access"},tooltip:{id:"pageAccess.modal.tooltip",defaultMessage:"Only pages where you have Full Access will appear here"}}),q={...t(404200).V,...V};const F=420;function $(e){let{key:s,title:t,allItems:a,styles:o}=e;return{key:s,title:t,content:(0,U.jsx)("div",{style:o.menuList,children:(0,U.jsx)(j().Ay,{type:j().Oh.Vertical,sections:[{key:s,render:e=>(0,U.jsx)(k().A,{...e}),items:a}],initialFocus:void 0})}),sectionContentStyleOverride:{padding:0}}}const Z=t(757695).Store.createClass({},{name:"SelectedBlockIdsStore"});function G(e){let{teamPagesByTeam:s,pagesSharedWithUser:t,privatePages:j,workspacePages:k,selectedBlockIdsStore:W,allTeams:H,spaceStore:R,heightOverride:z=320}=e;const K=(0,h().tz)(),Y=(0,o().v3)(),E=function(e){return(0,i().IS)((s=>({icon:{width:c().Ev.xl,height:c().Ev.xl,color:s.icon.secondary},pageIconStyle:{fill:s.icon.secondary},nestedPageItem:{marginLeft:24},sectionsContainer:{borderRadius:8},button:{minWidth:120},sectionHeading:{color:s.palette.gray[500],fontWeight:u().Wy.medium},subSectionHeading:{padding:"8px",color:s.palette.gray[500],fontWeight:u().Wy.medium},subSectionRowWithBorder:{borderTop:`1px solid ${s.stroke.secondary}`,marginTop:4,width:"100%"},pageSelectionContainer:{height:e,overflowY:"auto",borderRadius:8,border:`1px solid ${s.stroke.secondary}`,padding:4},noPagesContainer:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",padding:16},tooltipIcon:{width:c().Ev.sm,height:c().Ev.sm}})),[e])}(z),[V,G]=a.useState(""),J=(0,n().uB)(W,Z),Q=e=>{J.setState({...J.state,[e]:!J.state[e]})},X=(0,n().K8)((()=>new Set(Object.keys(J.state).filter((e=>J.state[e])).filter((e=>{const s=new(N().Bv)(Y,{table:p().ev,id:e,spaceId:R.id});return(0,g().Km)(s.getRole()||"none")&&!s.pathIsDead()&&s.isNavigableBlock()})))),[J,Y,R.id]),{topLevelShareableSharedPageIds:ee,topLevelShareablePrivatePageIds:se,topLevelShareableTeamspacePageIds:te,topLevelShareableWorkspacePageIds:ae,shareableTeamPagesByTeam:oe,selectedNonTopLevelSharedPageIds:ne,selectedNonTopLevelPrivatePageIds:ie,selectedNonTopLevelWorkspacePageIds:le,teamspaceManualSet:re}=(0,_().a)({pagesSharedWithUser:t,privatePages:j,workspacePages:k,teamPagesByTeam:s,selectedPageIds:X,spaceStore:R}),[de,ce]=a.useState(new Set);const ge=(0,a.useCallback)((e=>function(e,s){if(s.has(e.id))return e.id;const t=(0,w().g7)(e).find((e=>e.table===p().ev&&s.has(e.id)));return t?t.id:void 0}(e,new Set(X))),[X]);function pe(e,s){const t={...J.state};for(const a of e)t[a]=s;J.setState(t)}const he=[],ue=a.useMemo((()=>new Map),[]),{sortedTopLevelSharedIds:me,sortedTopLevelPrivateIds:ye,sortedTeamspaceManualIds:xe,sortedTopLevelWorkspacePageIds:ve,sortedNonTopLevelSharedIds:fe,sortedNonTopLevelPrivateIds:Se,sortedNonTopLevelWorkspacePageIds:je,sortedTeams:Ie}=(0,n().K8)((()=>{const e=ue,s=s=>{let t=e.get(s);var a;void 0===t&&(t=(null===(a=new(N().Bv)(Y,{table:p().ev,id:s,spaceId:R.id}).getRenderTitle({intl:K,userTimeZone:(0,l().P)()}))||void 0===a?void 0:a.toString())??"",e.set(s,t));return t},t=(e,t)=>s(e).localeCompare(s(t));return{sortedTopLevelSharedIds:[...ee].sort(t),sortedTopLevelPrivateIds:[...se].sort(t),sortedTeamspaceManualIds:[...re].sort(((e,s)=>{const a=e=>{var s;const t=new(N().Bv)(Y,{table:p().ev,id:e,spaceId:R.id});return(null===(s=(0,w().Uo)(t))||void 0===s?void 0:s.getName())||""},o=a(e),n=a(s);return o!==n?o.localeCompare(n):t(e,s)})),sortedNonTopLevelSharedIds:[...ne].sort(t),sortedNonTopLevelPrivateIds:[...ie].sort(t),sortedTeams:[...H].sort(B().r),sortedTopLevelWorkspacePageIds:[...ae].sort(t),sortedNonTopLevelWorkspacePageIds:[...le].sort(t)}}),[Y,K,R.id,ee,se,re,ne,ie,ae,le,H,ue]),Pe=a.useMemo((()=>new Map),[]),be=a.useCallback((e=>{let s=Pe.get(e);return s||(s=new(N().Bv)(Y,{table:p().ev,id:e,spaceId:R.id}),Pe.set(e,s)),s}),[Y,R.id,Pe]);if(!(!(ee.size>0||se.size>0)||(me.length>0||ye.length>0)))return(0,U.jsx)(S().A,{loaded:!1,showSpinnerTimeout:0});if(te.size>0||re.size>0){const e=[];if(re.size>0){e.push({key:"teamspace-manual-header",action:()=>{},render:()=>(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.subSectionHeading,children:T().A.formatMessage(q.manuallySelectedPagesHeader)})});for(const s of xe){const t=be(s);e.push({key:`manual-${s}`,action:()=>{Q(s)},render:()=>(0,U.jsxs)(m().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",style:{paddingLeft:E.subSectionHeading.padding},children:[(0,U.jsx)("div",{children:(0,U.jsx)(L().y,{blockStore:t,maxWidth:F})}),(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{Q(s)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.remove)})})]})})}}re.size>0&&te.size>0&&e.push({key:"teamspace-manual-divider",action:()=>{},render:()=>(0,U.jsx)("div",{style:E.subSectionRowWithBorder})});const s=Array.from(te).some((e=>X.has(e)));e.push({key:"teamspace-top-level-header",action:()=>{},render:()=>(0,U.jsxs)(m().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",children:[(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.subSectionHeading,children:(0,U.jsx)(h().sA,{...q.teamspacesHeaderSubheader})}),s?(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{pe(te,!1)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.deselectAll)})}):(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{pe(te,!0)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.selectAll)})})]})});const t=Ie.filter((e=>oe[e.id]&&oe[e.id].length>0));for(const o of t){const s=oe[o.id].filter((e=>X.has(e))),t=0!==s.length&&(s.length===oe[o.id].length||"partial"),a=de.has(o.id);if(e.push({key:`teamspace-${o.id}`,action:()=>{},render:()=>(0,U.jsx)(O,{teamspaceStore:o,checkType:t,onToggleSelect:()=>pe(oe[o.id],!t),expanded:a,onExpandToggle:()=>{return e=o.id,void ce((s=>{const t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t}));var e}})}),a){const s=[...oe[o.id]].sort(((e,s)=>{var t,a;const o=(null===(t=be(e).getRenderTitle({intl:K,userTimeZone:(0,l().P)()}))||void 0===t?void 0:t.toString())??"",n=(null===(a=be(s).getRenderTitle({intl:K,userTimeZone:(0,l().P)()}))||void 0===a?void 0:a.toString())??"";return o.localeCompare(n)}));for(const t of s){const s=be(t);e.push({key:t,action:()=>{Q(t)},render:()=>(0,U.jsx)("div",{style:E.nestedPageItem,children:(0,U.jsx)(D,{pageStore:s,isSelected:X.has(t),onToggle:()=>{Q(t)},styles:E,maxLength:50})})})}}}const a=$({key:"teamspaces",title:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.sectionHeading,children:(0,U.jsx)(h().sA,{...q.teamspacesHeader})}),allItems:e,styles:E});he.push(a)}if((ae.size>0||le.length>0)&&0===H.length){const e=[];if(le.length>0){e.push({key:"workspaceManualHeader",action:()=>{},render:()=>(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.subSectionHeading,children:T().A.formatMessage(q.manuallySelectedPagesHeader)})});for(const s of je){const t=be(s);e.push({key:s,action:()=>{Q(s)},render:()=>(0,U.jsxs)(m().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",style:{paddingLeft:E.subSectionHeading.padding},children:[(0,U.jsx)("div",{children:(0,U.jsx)(L().y,{blockStore:t,maxWidth:F})}),(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{Q(s)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.remove)})})]})})}}if(le.length>0&&ae.size>0&&e.push({key:"shared-manual-divider",action:()=>{},render:()=>(0,U.jsx)("div",{style:E.subSectionRowWithBorder})}),ae.size>0){const s=Array.from(ae).some((e=>X.has(e)));e.push({key:"workspaces-top-level-header",action:()=>{},render:()=>(0,U.jsxs)(m().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",children:[(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.subSectionHeading,children:(0,U.jsx)(h().sA,{...q.topLevelPagesHeader})}),s?(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{pe(ae,!1)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.deselectAll)})}):(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{pe(ae,!0)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.selectAll)})})]})})}e.push(...ve.map((e=>{const s=be(e);return{key:s.id,action:()=>{Q(s.id)},render:()=>(0,U.jsx)("div",{children:(0,U.jsx)(D,{pageStore:s,isSelected:X.has(s.id),onToggle:()=>{Q(s.id)},styles:E,maxLength:50})})}})));const s=$({key:"workspacePages",title:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.sectionHeading,children:(0,U.jsx)(h().sA,{...q.workspacePagesHeader})}),allItems:e,styles:E});he.push(s)}if(ee.size>0||ne.length>0){const e=[];if(ne.length>0){e.push({key:"sharedManualHeader",action:()=>{},render:()=>(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.subSectionHeading,children:T().A.formatMessage(q.manuallySelectedPagesHeader)})});for(const s of fe){const t=be(s);e.push({key:s,action:()=>{Q(s)},render:()=>(0,U.jsxs)(m().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",style:{paddingLeft:E.subSectionHeading.padding},children:[(0,U.jsx)("div",{children:(0,U.jsx)(L().y,{blockStore:t,maxWidth:F})}),(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{Q(s)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.remove)})})]})})}}if(ne.length>0&&ee.size>0&&e.push({key:"shared-manual-divider",action:()=>{},render:()=>(0,U.jsx)("div",{style:E.subSectionRowWithBorder})}),ee.size>0){const s=Array.from(ee).some((e=>X.has(e)));e.push({key:"shared-top-level-header",action:()=>{},render:()=>(0,U.jsxs)(m().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",children:[(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.subSectionHeading,children:(0,U.jsx)(h().sA,{...q.topLevelPagesHeader})}),s?(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{pe(ee,!1)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.deselectAll)})}):(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{pe(ee,!0)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.selectAll)})})]})})}e.push(...me.map((e=>{const s=be(e);return{key:s.id,action:()=>{Q(s.id)},render:()=>(0,U.jsx)("div",{children:(0,U.jsx)(D,{pageStore:s,isSelected:X.has(s.id),onToggle:()=>{Q(s.id)},styles:E,maxLength:50})})}})));const s=$({key:"sharedPages",title:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.sectionHeading,children:(0,U.jsx)(h().sA,{...q.sharedPagesHeader})}),allItems:e,styles:E});he.push(s)}if(ye.length>0||ie.length>0){const e=[];if(ie.length>0){e.push({key:"privateManualHeader",action:()=>{},render:()=>(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.subSectionHeading,children:T().A.formatMessage(q.manuallySelectedPagesHeader)})});for(const s of Se){const t=be(s);e.push({key:s,action:()=>{Q(s)},render:()=>(0,U.jsxs)(m().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",style:{paddingLeft:E.subSectionHeading.padding},children:[(0,U.jsx)("div",{children:(0,U.jsx)(L().y,{blockStore:t,maxWidth:F})}),(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{Q(s)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.remove)})})]})})}}if(ie.length>0&&ye.length>0&&e.push({key:"private-manual-divider",action:()=>{},render:()=>(0,U.jsx)("div",{style:E.subSectionRowWithBorder})}),ye.length>0){const s=Array.from(se).some((e=>X.has(e)));e.push({key:"private-top-level-header",action:()=>{},render:()=>(0,U.jsxs)(m().Y1,{direction:"horizontal",width:"fill",gap:"auto",align:"center",children:[(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.subSectionHeading,children:(0,U.jsx)(h().sA,{...q.topLevelPagesHeader})}),s?(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{pe(se,!1)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.deselectAll)})}):(0,U.jsx)(y().p,{isBlue:!0,onClick:()=>{pe(se,!0)},children:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",children:T().A.formatMessage(q.selectAll)})})]})})}e.push(...ye.map((e=>{const s=be(e);return{key:s.id,action:()=>{Q(s.id)},render:()=>(0,U.jsx)("div",{children:(0,U.jsx)(D,{pageStore:s,isSelected:X.has(s.id),onToggle:()=>{Q(s.id)},styles:E,maxLength:50})})}})));const s=$({key:"privatePages",title:(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",style:E.sectionHeading,children:(0,U.jsx)(h().sA,{...q.privatePagesHeader})}),allItems:e,styles:E});he.push(s)}return 0===he.length?(0,U.jsx)("div",{style:E.pageSelectionContainer,children:(0,U.jsx)("div",{style:E.sectionsContainer,children:(0,U.jsxs)(m().Y1,{direction:"vertical",gap:8,align:"center",padding:24,children:[(0,U.jsx)(P().D,{styleName:"UIRegular-14px/Semibold",children:(0,U.jsx)(h().sA,{...q.noPagesMessage})}),(0,U.jsx)(P().D,{styleName:"UIMedium-13px/Regular",children:(0,U.jsx)(h().sA,{...q.addPagesMessage})})]})})}):(0,U.jsxs)(m().Y1,{direction:"vertical",gap:24,children:[(0,U.jsx)("div",{children:(0,U.jsx)(b().Ay,{trapFocus:!1,origin:(0,U.jsx)(f().Ay,{focus:!0,focusAfterAnimation:!0,value:V||"",onChange:e=>{G(e.target.value)},placeholder:K.formatMessage(q.searchPlaceholder),inputLeft:(0,U.jsx)(I().I,{icon:r().J,color:"secondary"}),inputOuterStyle:{height:32},ignoreKeyboardMode:!0,style:{padding:0}}),sameWidthAsOrigin:!0,popupType:b().nl.Popup,open:""!==V,render:()=>(0,U.jsx)(M().f,{spaceId:R.id,spaceStore:R,onSelectPage:e=>{Q(e)},query:V||"",source:"internal_integrations_page_picker",findSelectedBlockAncestorId:ge}),onDismiss:()=>G("")})}),(0,U.jsxs)("div",{children:[(0,U.jsxs)(m().Y1,{direction:"horizontal",width:"hug",gap:2,align:"center-left",children:[(0,U.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",children:(0,U.jsx)(h().sA,{...q.selectPagesLabel})}),(0,U.jsx)(A().A,{textWrap:!0,renderTooltip:()=>(0,U.jsx)("div",{style:{width:200},children:K.formatMessage(q.tooltip)}),render:e=>(0,U.jsx)("div",{...e,children:(0,U.jsx)(v().A,{ariaLabel:K.formatMessage({id:"creatorProfile.integrations.pagePicker.tooltip",defaultMessage:"Only pages where you have Full Access will appear here"}),icon:d().questionMarkCircleIcon,size:"sm",disableBackground:!0,style:{marginTop:2}})}),placement:C().W.Right})]}),(0,U.jsx)("div",{style:E.pageSelectionContainer,children:(0,U.jsx)("div",{style:E.sectionsContainer,children:(0,U.jsx)(x().b,{sections:he})})})]})]})}}}]);