"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[19930],{66529:(e,t,n)=>{n.r(t),n.d(t,{canAcceptAutocompletionsWithoutDot:()=>I,getFormulaEditorInfoAtPosition:()=>S});n(18107),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(967357),n(898992),n(354520),n(672577),n(803949),n(581454);var o=()=>n(303151),i=()=>n(778078),r=()=>n(763824),a=()=>n(973647),s=()=>n(534177),l=()=>n(510916),u=()=>n(958970),d=()=>n(247331),p=()=>n(106714),c=()=>n(44907),m=()=>n(871202),y=()=>n(844698),f=()=>n(349835),g=()=>n(977345),x=()=>n(628048);async function v(e,t,n){const o=[],i=new Set;if(void 0!==e){const a=t.handleDataRequest({recordPointers:[e]}),l=((0,r().yL)(a)?await a:a).getRecordModel(e),u=null==l?void 0:l.getNormalizedSchema();if(u)for(const[r,p]of Object.entries(u))if(void 0!==(null==p?void 0:p.type)&&(0,s().Xk)(d().FormulaTokenSupportedBlockSystemPropertyList,null==p?void 0:p.type)&&i.add(p.type),r!==t.sourceProperty&&null!=p&&p.name&&d().FORMULAS_SUPPORTED_COLLECTION_PROPERTY_TYPES.includes(null==p?void 0:p.type)&&b(n,p.name)){let n;"cross_space_only"===t.restrictUnaccessibleProperties?n=m().hasSameSpaceAccess:"read_permissions_only"===t.restrictUnaccessibleProperties?n=m().hasReadPermissionsAccess:"cross_space_and_read_permissions"===t.restrictUnaccessibleProperties&&(n=m().hasAccessDefaultFn);(!t.restrictUnaccessibleProperties||!n||await(0,m().hasAccessToProperty)({collectionPointer:e,collectionSchema:u,context:t,propertyId:r,hasAccessFn:n}))&&o.push({kind:d().FormulaEditorInfoCompletionKind.Token,name:p.name,token:{type:d().FormulaTokenType.BlockProperty,property:(0,g().XH)(r),collection:e}})}}for(const r of Object.values(d().FormulaTokenSupportedBlockSystemProperty)){if(i.has(r))continue;const e=(0,l().i)(r);(""===n||b(n,e))&&o.push({kind:d().FormulaEditorInfoCompletionKind.Token,token:{type:d().FormulaTokenType.BlockProperty,property:r,collection:void 0},name:e})}return o}function b(e,t){return""===e||(0,i().It)(e,t)}async function h(e){const{prefix:t,context:n,receiverType:o,includeDeprecatedCompletions:r,dotMemberExpression:a,allowCountFunction:s}=e,l=[],u=[],p=[],c=new Set;if(void 0===o){var m;n.valueTypes.forEach((e=>{if(e.kind===d().FormulaContextValueKind.Binding){const n=e.id;!c.has(n)&&t!==e.id&&b(t,e.id)&&(l.push({kind:d().FormulaEditorInfoCompletionKind.Binding,text:n,type:e.type}),c.add(n))}}));const e=null===(m=n.valueTypes.find((e=>e.kind===d().FormulaContextValueKind.ThisRow)))||void 0===m?void 0:m.type;"block"===(null==e?void 0:e.type)&&void 0!==e.collection&&u.push(...await v(e.collection,n,t)),n.valueTypes.forEach((e=>{if(e.kind===d().FormulaContextValueKind.ContextValue&&b(t,e.name)){const t=(0,g().Bk)(e.id);u.push({kind:d().FormulaEditorInfoCompletionKind.Token,name:e.name,token:{type:d().FormulaTokenType.ContextValue,valueId:t}})}}))}else"block"===o.type&&u.push(...await v(o.collection,n,t));for(const i in x().LP)if(!c.has(i)&&b(t,i)&&(r||!i.startsWith("_"))&&("count"!==i||s)&&("toNumber"!==i||null==o||!o.type||!x().Qi.includes(o.type))&&(!a||!x().bq.includes(i))){const e=x().LP[i];if(void 0!==o){var y,f;const t=(null===(y=e.parameters)||void 0===y||null===(y=y.expected)||void 0===y||null===(y=y[0])||void 0===y?void 0:y.type)??(null===(f=e.parameters)||void 0===f||null===(f=f.varargs)||void 0===f||null===(f=f[0])||void 0===f?void 0:f.type);if(void 0===t||!(0,g().s7)(o,t))continue}p.push({kind:d().FormulaEditorInfoCompletionKind.LibraryFunction,libraryFunction:e}),c.add(i)}return[...(0,i().Ay)(t,l,(e=>e.text)),...(0,i().Ay)(t,u,(e=>e.name??"")),...(0,i().Ay)(t,[],(e=>e.builtin)),...(0,i().Ay)(t,p,(e=>e.libraryFunction.name))]}function k(e,t){const n=[...e].reverse().find((e=>e.kind===f().NM.Call));if((null==n?void 0:n.kind)===f().NM.Call){let e=-1;if(t>n.lParenOffset&&(void 0===n.rParenOffset||t<=n.rParenOffset))for(e=0;e<n.commaOffsets.length&&!(n.commaOffsets[e]>t);e++);return{expression:n.expression,parameterIndex:e}}}const C={[d().FormulaEditorInfoCompletionKind.Binding]:0,[d().FormulaEditorInfoCompletionKind.Token]:1,[d().FormulaEditorInfoCompletionKind.Builtin]:2,[d().FormulaEditorInfoCompletionKind.LibraryFunction]:3};function I(e){const{nodeAtPosition:t,dotMemberExpression:n}=e;return!(!n||!t)&&(t.kind===f().NM.NotionToken||t.kind===f().NM.MemberBlockProperty||t.kind===f().NM.Call||t.kind===f().NM.Boolean||t.kind===f().NM.Number||t.kind===f().NM.String||t.kind===f().NM.Array)}async function S(e){var t,n;const{formula:i,inputPosition:r,context:s,includeDeprecatedCompletions:l,isBetterFormulaCompletionsEnabled:m}=e,[v,S]=(0,p().kb)(i),T=(0,p().NZ)(S,r);let P=v.substring(0,T);const E=P[P.length-1],A=/[\s.]/.test(E);A&&(P=`${P}_`);const F=(0,c().p8)(),w=(0,c().TM)(F).tokenize(P).tokens,j=(0,c()._M)(F);j.input=w;const D=j.expression(),N=(0,u().f)(D);if(a().Q.isFail(N))return{value:void 0};const B=await(0,y()._)(N.value,s,S),{node:R}=B,L=w[w.length-1];let _=!1,Y=w;void 0!==L&&(0,o().G)(L,F.IdentifierName)&&(Y=[...Y],Y.pop(),_=!0);const H=j.computeContentAssist("expression",Y),U=_?L.image.substring(0,L.image.length-(A?1:0)):void 0,K=(0,g().Kp)(R,T),V=K.at(-1),z={inputPosition:r,mappedPosition:T,nodePath:K,callParameter:k(K,T)};if(w.find((e=>e.tokenType===F.UnclosedStringLiteral)))return z.completions=[],{value:z};const O=[],W=k(K,T),$={handleDataRequest:s.handleDataRequest,restrictUnaccessibleProperties:s.restrictUnaccessibleProperties,sourceProperty:s.sourceProperty,spaceId:s.spaceId,valueTypes:R.valueTypes,featureGates:s.featureGates};let G;for(let o=1;o<=5;o++){const e=(0,g().Kp)(R,T-o);if(G=e[e.length-1],void 0!==G)break}(null===(t=G)||void 0===t?void 0:t.kind)===f().NM.RecoveryNode&&(G=void 0);const q=void 0!==G&&(m||0===K.length),Q=!G||G.kind===f().NM.Unary||G.kind===f().NM.Equality||G.kind===f().NM.Identifier,J=!G||G.kind===f().NM.Equality||G.kind===f().NM.Identifier;for(const o of H){var Z,X,ee,te,ne,oe,ie,re,ae;if(o.nextTokenType===F.IdentifierName||o.nextTokenType===F.Dot){const e="dotMemberExpression"===o.ruleStack[o.ruleStack.length-1];if(V&&e){if(V.kind===f().NM.UnifiedFunctionProperty){const t=V.expression;z.completionsInfo={type:"member dot receiver",prefix:U,receiverNode:t};const n=await h({prefix:U??"",context:$,receiverType:t.type,includeDeprecatedCompletions:l,dotMemberExpression:e,allowCountFunction:Boolean(s.featureGates.formulas_count_function)});O.push(...n)}else if(m&&I({nodeAtPosition:V,dotMemberExpression:e})){z.completionsInfo={type:"member dot receiver",prefix:U,receiverNode:V};const t=await h({prefix:U??"",context:$,receiverType:V.type,includeDeprecatedCompletions:l,dotMemberExpression:e,allowCountFunction:Boolean(s.featureGates.formulas_count_function)});O.push(...t)}}else{z.completionsInfo={type:"free identifier",prefix:U};const t=await h({prefix:U??"",context:$,includeDeprecatedCompletions:l,dotMemberExpression:e,allowCountFunction:Boolean(s.featureGates.formulas_count_function)});if(O.push(...t),W&&(W.expression.kind===f().NM.UnifiedFunctionProperty&&0===W.parameterIndex||W.expression.kind===f().NM.Identifier&&1===W.parameterIndex)){const e=W.expression.kind===f().NM.UnifiedFunctionProperty?W.expression.name:W.expression.text,t=x().LP[e];if(((null==t?void 0:t.parameters)===x().Ux||(null==t?void 0:t.parameters)===x().MB)&&b(U??"",d().CURRENT_VALUE_NAME)&&U!==d().CURRENT_VALUE_NAME&&U!==`${d().CURRENT_VALUE_NAME}.`){var se,le;const e=W.expression,t="function"===e.type.type&&"array"===(null===(se=e.type.boundTargetType)||void 0===se?void 0:se.type)&&(null===(le=e.type.boundTargetType)||void 0===le?void 0:le.of)||{type:"unknown"};O.push({kind:d().FormulaEditorInfoCompletionKind.Binding,text:d().CURRENT_VALUE_NAME,type:t}),O.push({kind:d().FormulaEditorInfoCompletionKind.Binding,text:d().CURRENT_INDEX_NAME,type:{type:"number"}})}}}}else if(o.nextTokenType===F.AdditionOperator&&q&&(null==V?void 0:V.type.type)!==f().NM.Array&&"text"===(null===(Z=G)||void 0===Z?void 0:Z.type.type)){const e=M(["+"],U??"");O.push(...e)}else if(o.nextTokenType===F.AdditionOperator&&q&&(null==V?void 0:V.type.type)!==f().NM.Array&&"number"===(null===(X=G)||void 0===X?void 0:X.type.type)){const e=M(["+","-"],U??"");O.push(...e)}else if(o.nextTokenType===F.MultiplicationOperator&&q&&(null==V?void 0:V.type.type)!==f().NM.Array&&"number"===(null===(ee=G)||void 0===ee?void 0:ee.type.type)){const e=M(["*","/"],U??"");O.push(...e)}else if(o.nextTokenType!==F.RelationalOperator||!q||(null==V?void 0:V.type.type)===f().NM.Array||"number"!==(null===(te=G)||void 0===te?void 0:te.type.type)&&"text"!==(null===(ne=G)||void 0===ne?void 0:ne.type.type)&&"date"!==(null===(oe=G)||void 0===oe?void 0:oe.type.type)){if(o.nextTokenType===F.EqualityOperator&&q&&null!==(ie=G)&&void 0!==ie&&ie.type.type&&"unknown"!==(null===(re=G)||void 0===re?void 0:re.type.type)){const e=M(["==","!="],U??"");O.push(...e)}else if(o.nextTokenType===F.BooleanLiteral&&Q){const e=M(["true","false"],U??"");O.push(...e)}else if(o.nextTokenType===F.And&&q&&"checkbox"===(null===(ae=G)||void 0===ae?void 0:ae.type.type)){const e=M(["and","or"],U??"");O.push(...e)}else if(o.nextTokenType===F.UnaryOperator&&J){const e=M(["not"],U??"");O.push(...e)}}else{const e=M([">",">=","<","<="],U??"");O.push(...e)}}const ue=null===(n=w[w.length-1])||void 0===n?void 0:n.tokenType;if(0===O.length&&ue===F.IdentifierName){const e=w.slice(-4).reverse(),t=[];for(let o=0;o<e.length;o++){var de;if((null===(de=e[o])||void 0===de?void 0:de.tokenType)!==F.IdentifierName)break;const n=_?e[o].image.substring(0,e[o].image.length-(A?1:0)):void 0;void 0!==n&&(0===o?t.push(n):t.push(n+t[o-1]))}let n=[];for(let o=1;o<t.length;o++){const e=t[o],i=await h({prefix:e.trim(),context:$,includeDeprecatedCompletions:l,dotMemberExpression:!1,allowCountFunction:Boolean(s.featureGates.formulas_count_function)});if(i.length>0){n=i.map((t=>({...t,overridePrefixLength:e.length+o})))}}O.push(...n)}return z.completions=O.sort(((e,t)=>{const n=e.kind,o=t.kind;return C[n]-C[o]})),{value:z}}function M(e,t){return e.filter((e=>b(t,e))).map((e=>({kind:d().FormulaEditorInfoCompletionKind.Builtin,builtin:e})))}},85082:(e,t,n)=>{n.d(t,{J:()=>u});n(296540);var o=()=>n(959013);const i=n.p+"a7e5ea83ae6a4462.gif",r=n.p+"7dfc0055539fbdc2.gif",a=n.p+"9a2487c01dfc5636.gif";var s=n(474848);const l=(0,o().YK)({altText:{id:"aiChatModeGifFace.altText",defaultMessage:"Notion AI animated face"}});function u(e){const{configType:t,size:n=60}=e,u=(0,o().tz)();let d;return d="researcher"===t||"formulas"===t?a:"setup-generator"===t?r:i,(0,s.jsx)("img",{src:d,style:{width:n,height:n},alt:u.formatMessage(l.altText)})}},129852:(e,t,n)=>{n.r(t),n.d(t,{exclamationMarkCircleIcon:()=>r,iconDefinition:()=>i});n(296540);var o=n(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.26 15.25",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M9.875 6.25c.345 0 .625.28.625.625v3.5a.625.625 0 1 1-1.25 0v-3.5c0-.345.28-.625.625-.625m0 7.375a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5"}),(0,o.jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0M10 3.625a6.375 6.375 0 1 0 0 12.75 6.375 6.375 0 0 0 0-12.75"})]})},r=(0,n(340498).wt)("exclamationMarkCircle",i)},141768:(e,t,n)=>{n.d(t,{YH:()=>l,bi:()=>a});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(803949),n(581454),n(908872);var o=()=>n(919709),i=()=>n(496603),r=()=>n(713972);function a(e){let t="";const n=document.createElement("div");n.innerHTML=e;const o=r().zn(n);for(const r of o){const e=i().ih(r.data);if(null!==r.parentElement&&r.parentElement!==n){t+=`<span class="${s({parent:r.parentElement,root:n}).join(" ")}">${e}</span>`}else t+=e}return t}function s(e){const{parent:t,root:n}=e,o=new Set;let i=t;for(;i&&i!==n;)i.classList.forEach((e=>{o.add(e)})),i=i.parentElement??void 0;return Array.from(o)}function l(e,t){const n={text:u(e),syntax:u(t)},i=function(e){let t=0;return e.reduce(((e,n)=>(e.push([t,n]),t+=n,e)),[])}(function(e,t){const n=e.slice(),o=t.slice(),i=[];let r=0,a=0;for(;r<n.length&&a<o.length;){const e=n[r],t=o[a];e===t?(i.push(e),r+=1,a+=1):e<t?(i.push(e),r+=1,o[a]-=e):(i.push(t),n[r]-=t,a+=1)}return i}(n.text,n.syntax)),r={text:0,syntax:0},a={text:0,syntax:0},s=[],l=e.map(o().N8A).join("");for(const[o,u]of i){const e=o+u,i=t[r.syntax],p={value:l.substring(o,e),textTokenIndex:r.text,classNames:(d=i,d&&d[1])};s.push(p);const c=n.text[r.text],m=n.syntax[r.syntax];e>=a.text+c&&(r.text+=1,a.text+=c),e>=a.syntax+m&&(r.syntax+=1,a.syntax+=m)}var d;return s}function u(e){return e.map((e=>e[0].length))}},164891:(e,t,n)=>{n.d(t,{y:()=>r});var o=()=>n(56366),i=()=>n(217429);function r(e){const{experimentId:t,groups:n,disableExposureLogging:r}=e,a=function(e){const{experimentId:t,disableExposureLogging:n,defaultGroup:r}=e;return(0,o().K8)((()=>i().default.getEligibleGroup({experimentId:t,defaultGroup:r??"control",disableExposureLogging:n})),[t,n,r])}({experimentId:t,disableExposureLogging:r});return n[a]}},211975:(e,t,n)=>{n.d(t,{v:()=>Xt});n(944114),n(898992),n(354520),n(803949),n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(563015),l=()=>n(106714),u=()=>n(977345),d=()=>n(416504),p=()=>n(591779),c=()=>n(450648),m=()=>n(919709),y=()=>n(959013),f=()=>n(496603),g=()=>n(973647),x=()=>n(534177),v=()=>n(284371),b=()=>n(884107),h=()=>n(436572),k=()=>n(725614),C=()=>n(2220),I=()=>n(780054),S=()=>n(862292),M=()=>n(847743),T=()=>n(231722),P=()=>n(645873),E=()=>n(963589),A=()=>n(765957),F=()=>n(24157),w=()=>n(164891),j=()=>n(545805),D=()=>n(757695);class N extends D().Store{getInitialState(){return{currentSuggestion:"",dismissedSuggestions:[],isGenerating:!1}}setSuggestion(e){this.setState({...this.state,currentSuggestion:e})}dismissFormulaSuggestion(){const{currentSuggestion:e,dismissedSuggestions:t}=this.state;e&&t.includes(e),this.setState({...this.state,currentSuggestion:""})}clearDismissedSuggestions(){this.setState({...this.state,dismissedSuggestions:[]})}getCurrentSuggestion(){return this.state.currentSuggestion}}const B=new N;function R(e){const{existingFormula:t}=e,n=B,[i,r]=(0,o.useState)(0),[a,s]=(0,o.useState)(!1),l=(0,o.useCallback)((()=>{n.setSuggestion("")}),[n]),u=(0,o.useCallback)((()=>{n.dismissFormulaSuggestion(),s(!0)}),[n]);(0,o.useEffect)((()=>{if(a){if(3===i)return void s(!1);r((e=>e+1))}}),[t,i,a]);const d=(0,o.useCallback)((()=>{const e=n.state.currentSuggestion,t=n.state.dismissedSuggestions;return Boolean(e)&&!t.includes(e)}),[n]),p=(0,o.useCallback)((e=>{n.setState({...n.state,isGenerating:e})}),[n]),c=(0,o.useCallback)((e=>{n.setSuggestion(e)}),[n]);return{store:n,justDismissedSuggestion:a,shouldShowFormulaSuggestion:d,dismissFormulaSuggestion:u,clearFormulaSuggestion:l,setIsGenerating:p,setSuggestion:c}}n(16280);var L=()=>n(158489),_=()=>n(638681);const Y=_().union([_().object({required:{type:_().literal("formula"),formula:_().string()},optional:{format:_().union([_().literal("number"),_().literal("bar"),_().literal("ring")])},exact:!0}),_().object({required:{type:_().literal("chat"),message:_().string()},optional:{},exact:!0}),_().object({required:{type:_().literal("reset")},optional:{},exact:!0})]);var H=()=>n(388821),U=()=>n(519831),K=()=>n(155792),V=()=>n(352733),z=()=>n(720665),O=()=>n(319975),W=()=>n(751156),$=()=>n(348869),G=()=>n(594794),q=()=>n(963443);async function Q(e){var t;const{environment:n,spaceId:o,collectionId:i,userPrompt:r,formulaErrors:a,existingFormula:s,typecheckContext:l,handleFormulaStream:u,handleRefusalStream:d,abortSignal:p}=e;let c=s;const m=(0,G().Z1)({environment:n,table:K().mS,spaceId:o}),y={table:U().Vl,id:i,spaceId:o},f=new(q().y)(n,y).getModel();if(!f)throw new Error("Collection not found");const g=H().RecordMap.create();g.addModel(f);const x=[{id:(0,G().Z1)({environment:n,table:K().mS,spaceId:o}),type:"config",value:{type:"formulas",formulaErrors:a,existingFormula:c,typecheckContext:l}},{id:(0,G().Z1)({environment:n,table:K().mS,spaceId:o}),type:"agent-record-map",threadRecordMap:(0,L().he)(g)},{id:(0,G().Z1)({environment:n,table:K().mS,spaceId:o}),type:"user",value:[[r]],userId:(null===(t=n.currentUser)||void 0===t?void 0:t.id)??""}];let v="";const b=await(0,$().g)({environment:n,data:{generateTitle:!1,traceId:m,transcript:x,spaceId:o},onResponse:e=>{if("generate-formula"!==e.type)return;const t=(0,z().$l)(e.value);if(t){try{(0,V().j)(Y,t)}catch{return}"reset"!==t.type?("chat"===t.type?d&&d(t.message):"formula"===t.type&&(v=t.formula),c.startsWith(v)||u(v)):c=v}},abortSignal:p});if(v.length>0&&c.includes(v)&&u(v),!b.error)return{formula:v,traceId:m}}var J=()=>n(381349),Z=()=>n(247345),X=()=>n(85082),ee=()=>n(84817),te=()=>n(704152),ne=()=>n(805751),oe=()=>n(623580),ie=()=>n(135221),re=()=>n(554509),ae=n(474848);function se(e){const{formulaAssistantStore:t,onStop:n,onSubmit:i}=e,s=(0,y().tz)(),{prompt:l,inputMode:u,refusal:d}=(0,r().K8)((()=>{const{state:e}=t;return{prompt:e.prompt,inputMode:e.inputMode,refusal:e.refusal}}),[t]),p=(0,o.useCallback)((()=>{i(t.state.prompt)}),[t,i]),c=(0,o.useCallback)((e=>{t.update((t=>({...t,prompt:e})))}),[t]),m=(0,o.useCallback)((()=>{t.setRefusal(void 0)}),[t]),f=(0,a().IS)((e=>({wrapper:{borderTop:`1px solid ${e.stroke.secondary}`,background:e.popoverBackground}})),[]);return(0,ae.jsx)(ne().A,{capture:!0,debugName:"FormulaAssistantInput",priority:1,children:(0,ae.jsxs)(ee().Y1,{direction:"horizontal",align:"top-left",gap:6,padding:"9px 12px",style:f.wrapper,children:[(0,ae.jsx)(ee().Y1,{width:20,height:28,align:"center",children:(0,ae.jsx)(X().J,{configType:"busy"===u?"formulas":void 0,size:28})}),(0,ae.jsx)(ee().Y1,{width:"fill",children:"busy"===u||d?(0,ae.jsx)(de,{refusal:d,inputMode:u}):(0,ae.jsx)(re().D,{styleName:"Body-14px/Regular",children:(0,ae.jsx)(ne().A,{debugName:"FormulaAssistantInput_PromptInput",capture:!0,allowMenuList:!1,allowEsc:!0,children:(0,ae.jsx)(oe().A,{format:oe().C.Transparent,placeholder:s.formatMessage(ce(u)),selectAll:!1,value:l,textarea:!0,textareaSubmitOnEnter:!0,autosize:!0,style:{minHeight:28,paddingTop:5,paddingBottom:3},onSubmit:e=>{l&&(e.stopPropagation(),p())},onChange:e=>{c(e.target.value)}})})})}),"busy"===u?(0,ae.jsx)(le,{onStop:n}):d?(0,ae.jsx)(pe,{onGotIt:m}):(0,ae.jsx)(ue,{onSubmit:p,isEnabled:l.length>0})]})})}function le(e){const{onStop:t}=e,n=(0,y().tz)(),{isPhone:o}=(0,i().Y0)(),r=(0,a().IS)((e=>({lightweightButton:{display:"flex",alignItems:"baseline",justifyContent:"center",fontSize:14,padding:"5px 8px",borderRadius:4,color:e.text.secondary,height:32,marginTop:2},keyboardShortcut:{textTransform:"uppercase",fontWeight:500,fontSize:11,marginLeft:6,color:e.text.tertiary,display:o?"none":void 0}})),[o]);return(0,ae.jsx)(j().A,{debugName:"FormulaAssistantInput_StopButton",capture:!0,onEnter:t,onEsc:t,priority:1,children:(0,ae.jsx)(ee().Y1,{width:"hug",height:28,align:"center",children:(0,ae.jsxs)(te().A,{style:r.lightweightButton,onClick:t,children:[n.formatMessage(me.cancel),(0,ae.jsx)("span",{style:r.keyboardShortcut,children:n.formatMessage(me.cancelShortcut)})]})})})}function ue(e){const{isEnabled:t,onSubmit:n}=e;return(0,ae.jsx)(ee().Y1,{width:"hug",height:28,align:"center",children:(0,ae.jsx)(Z().J,{onSubmit:n,canSend:t})})}function de(e){let{refusal:t,inputMode:n}=e;const o=(0,y().tz)();return(0,ae.jsxs)(ee().Y1,{direction:"horizontal",gap:6,height:28,align:"center-left",children:[(0,ae.jsx)(re().D,{styleName:"Body-14px/Regular",colorName:"secondary",children:t||o.formatMessage(me.assistantIsBusy)}),"busy"===n&&(0,ae.jsx)(ie().A,{isTriColored:!0})]})}function pe(e){const{onGotIt:t}=e,n=(0,y().tz)(),o=(0,a().IS)((e=>({blueButton:{display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:500,padding:"6px 12px",borderRadius:6,background:J().Ay.blue,color:J().Ay.white,border:"none",cursor:"pointer",height:28,minWidth:28},blueButtonHovered:{background:e.blueButtonHoveredBackground}})),[]);return(0,ae.jsx)(ee().Y1,{width:"hug",height:28,align:"center",children:(0,ae.jsx)(te().A,{style:o.blueButton,onClick:t,hoveredStyle:o.blueButtonHovered,children:n.formatMessage(me.gotIt)})})}function ce(e){switch(e){case"initial":case"followUp":case"busy":return me.initialPlaceholder;default:(0,x().HB)(e)}}const me=(0,y().YK)({cancel:{id:"formulaAssistantInput.cancel",defaultMessage:"Cancel"},cancelShortcut:{id:"formulaAssistantInput.cancelShortcut",defaultMessage:"esc"},gotIt:{id:"formulaAssistantInput.gotIt",defaultMessage:"Got it"},initialPlaceholder:{id:"formulaAssistantInput.initialPlaceholder",defaultMessage:"What do you want the formula to do?"},assistantIsBusy:{id:"formulaAssistantInput.assistantIsBusy",defaultMessage:"Notion AI is writing"}});class ye extends D().Store{constructor(){super(...arguments),this.didBeginRequest=()=>{this.update((e=>({...e,inputMode:"busy"})))},this.setRefusal=e=>{this.update((t=>({...t,refusal:e})))},this.didFinishRequest=()=>{this.update((e=>({...e,inputMode:"followUp"})))}}getInitialState(){return{id:n(206267).JW(),inputMode:"initial",prompt:"",refusal:void 0}}}n(18107),n(967357);var fe=()=>n(743176),ge=()=>n(247331),xe=()=>n(66529),ve=()=>n(349835),be=()=>n(145076),he=()=>n(197499);const ke={true:{name:"true",type:{type:"checkbox"},description:be().Q$.true,examples:[{input:"true"},{input:[(0,he().Py)("Checked"),[" == true"]]}]},false:{name:"false",type:{type:"checkbox"},description:be().Q$.false,examples:[{input:"false"},{input:[(0,he().Py)("Checked"),[" == false"]]}]},and:{name:"and",type:{type:"checkbox"},description:be().Q$.and,examples:[{input:"3 > 2 and 2 > 3",output:"false"},{input:[(0,he().Py)("Naughty"),[" && "],(0,he().Py)("Nice")]}]},or:{name:"or",type:{type:"checkbox"},description:be().Q$.or,examples:[{input:"3 > 2 or 2 > 3",output:"true"},{input:[(0,he().Py)("Naughty"),[" || "],(0,he().Py)("Nice")]}]},not:{name:"not",type:{type:"checkbox"},description:be().Q$.not,examples:[{input:"not true",output:"false"},{input:"not (2 > 3)",output:"true"},{input:[["!"],(0,he().Py)("Checked")]}]},"+":{name:"+",type:{type:"number"},description:be().Q$["+"],examples:[{input:"3 + 2",output:"5"},{input:"add(-1, 2)",output:"1"}]},"-":{name:"-",type:{type:"number"},description:be().Q$["-"],examples:[{input:"3 - 2",output:"1"},{input:"subtract(-1, 2)",output:"-3"}]},"*":{name:"*",type:{type:"number"},description:be().Q$["*"],examples:[{input:"3 * 2",output:"6"},{input:"multiply(-1, 2)",output:"-2"}]},"/":{name:"/",type:{type:"number"},description:be().Q$["/"],examples:[{input:"3 / 2",output:"1.5"},{input:"divide(-1, 2)",output:"-0.5"}]},"%":{name:"%",type:{type:"number"},description:be().Q$["%"],examples:[{input:"3 % 2",output:"1"},{input:"mod(-1, 2)",output:"-1"}]},"^":{name:"^",type:{type:"number"},description:be().Q$["^"],examples:[{input:"3 ^ 2",output:"9"},{input:"pow(-1, 2)",output:"1"}]},"==":{name:"==",type:{type:"checkbox"},description:be().Q$["=="],examples:[{input:"3 == 2",output:"false"},{input:'equal("A", "A")',output:"true"}]},"!=":{name:"!=",type:{type:"checkbox"},description:be().Q$["!="],examples:[{input:"3 != 2",output:"true"},{input:'unequal("A", "A")',output:"false"}]},">":{name:">",type:{type:"checkbox"},description:be().Q$[">"],examples:[{input:"3 > 2",output:"true"},{input:'now() > parseDate("2040-01-01")',output:"false"}]},"<":{name:"<",type:{type:"checkbox"},description:be().Q$["<"],examples:[{input:"3 < 2",output:"false"},{input:'now() < parseDate("2040-01-01")',output:"true"}]},">=":{name:">=",type:{type:"checkbox"},description:be().Q$[">="],examples:[{input:"3 >= 2",output:"true"},{input:'now() >= parseDate("2040-01-01")',output:"false"}]},"<=":{name:"<=",type:{type:"checkbox"},description:be().Q$["<="],examples:[{input:"3 <= 2",output:"false"},{input:'now() <= parseDate("2040-01-01")',output:"true"}]}};var Ce=()=>n(972435),Ie=()=>n(722872),Se=()=>n(970585),Me=()=>n(736767),Te=()=>n(760217),Pe=()=>n(406699),Ee=()=>n(928600),Ae=()=>n(939740),Fe=()=>n(89924),we=()=>n(67657);const je=(0,y().YK)({property:{id:"formula2Input.propertyHelper.descriptionGeneric",defaultMessage:"Database property."},titlePropertyDescription:{id:"formulaLibrary.property.title.description",defaultMessage:"Title property."},textPropertyDescription:{id:"formulaLibrary.property.text.description",defaultMessage:"Text property."},urlPropertyDescription:{id:"formulaLibrary.property.url.description",defaultMessage:"URL property."},emailPropertyDescription:{id:"formulaLibrary.property.email.description",defaultMessage:"Email property."},phoneNumberPropertyDescription:{id:"formulaLibrary.property.phoneNumber.description",defaultMessage:"Phone number property."},selectPropertyDescription:{id:"formulaLibrary.property.select.description",defaultMessage:"Select property."},multiSelectPropertyDescription:{id:"formulaLibrary.property.multiSelect.description",defaultMessage:"Multi-select property, list."},statusPropertyDescription:{id:"formulaLibrary.property.status.description",defaultMessage:"Status property."},checkboxPropertyDescription:{id:"formulaLibrary.property.checkbox.description",defaultMessage:"Checkbox property."},datePropertyDescription:{id:"formulaLibrary.property.date.description",defaultMessage:"Date property."},personPropertyDescription:{id:"formulaLibrary.property.person.description",defaultMessage:"Person property, list."},relationPropertyDescription:{id:"formulaLibrary.property.relation.description",defaultMessage:"Relation property, list."},rollupPropertyDescriptionList:{id:"formulaLibrary.property.rollup.description",defaultMessage:"Rollup property, list."},rollupPropertyDescription:{id:"formulaLibrary.property.rollup.descriptionWithList",defaultMessage:"Rollup property."},numberPropertyDescription:{id:"formulaLibrary.property.number.description",defaultMessage:"Number property."},formulaPropertyDescription:{id:"formulaLibrary.property.formula.description",defaultMessage:"Formula property."},formulaPropertyDescriptionList:{id:"formulaLibrary.property.formula.descriptionWithList",defaultMessage:"Formula property, list."},createdTimePropertyDescription:{id:"formulaLibrary.property.createdTime.description",defaultMessage:"Created time property."},lastEditedTimePropertyDescription:{id:"formulaLibrary.property.lastEditedTime.description",defaultMessage:"Last edited time property."},createdByPropertyDescription:{id:"formulaLibrary.property.createdBy.description",defaultMessage:"Created by property."},lastEditedByPropertyDescription:{id:"formulaLibrary.property.lastEditedBy.description",defaultMessage:"Last edited by property."},filePropertyDescription:{id:"formulaLibrary.property.file.description",defaultMessage:"File property, list."},autoincrementIdDescription:{id:"formulaLibrary.property.autoincrementId.description",defaultMessage:"ID property."}}),De={title:{name:"title",type:{type:"text"},description:je.titlePropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),['.style("b")']],isCopyable:!0},{input:[(0,he().Py)("Full Name"),['.split(" ").at(0)']]}]:[{input:[(0,he().Py)("Title")]},{input:[(0,he().Py)("Title"),['.style("b")']]},{input:[(0,he().Py)("Name"),['.split(" ").at(0)']]}]},text:{name:"text",type:{type:"text"},description:je.textPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[["upper("],(0,he().Y2)(e),[")"]],isCopyable:!0},{input:[(0,he().Y2)(e),['.style("b", "red")']],isCopyable:!0}]:[{input:[["upper("],(0,he().Py)("Name"),[")"]]},{input:[(0,he().Py)("Name"),['.style("b", "red")']]}]},url:{name:"url",type:{type:"text"},description:je.urlPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[' ? link("Link", '],(0,he().Y2)(e),[').style("green") : ""']],isCopyable:!0}]:[{input:[(0,he().Py)("URL"),[' ? link("Link", '],(0,he().Py)("URL"),[').style("green") : ""']]}]},email:{name:"email",type:{type:"text"},description:je.emailPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[' ? link("Email", "mailto:" + '],(0,he().Y2)(e),[').style("blue") : ""']],isCopyable:!0}]:[{input:[(0,he().Py)("Email"),[' ? link("Email", "mailto:" + '],(0,he().Py)("Email"),[').style("blue") : ""']]}]},phone_number:{name:"phone_number",type:{type:"text"},description:je.phoneNumberPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[' ? link("Call", "tel:" + '],(0,he().Y2)(e),[').style("blue") : ""']],isCopyable:!0}]:[{input:[(0,he().Py)("Email"),[' ? link("Call", "tel:" + '],(0,he().Py)("Email"),[').style("blue") : ""']]}]},number:{name:"number",type:{type:"number"},description:je.numberPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[" / 2"]],isCopyable:!0},{input:[["pi() * "],(0,he().Y2)(e),[" ^ 2"]],isCopyable:!0}]:[{input:[(0,he().Py)("Cost"),[" / "],(0,he().Py)("Total Units")]},{input:[["pi() * "],(0,he().Py)("Radius"),[" ^ 2"]]}]},select:{name:"select",type:{type:"text"},description:je.selectPropertyDescription,examples:e=>{const t=[{input:[(0,he().Py)("Priority"),[' == "High"']]},{input:[['["Feature", "Bug"].includes('],(0,he().Py)("Task Type"),[")"]]}];return e&&t.unshift({input:[(0,he().Y2)(e)],isCopyable:!0}),t}},multi_select:{name:"select",type:{type:"array",of:{type:"text"}},description:je.multiSelectPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[".length()"]],isCopyable:!0},{input:[(0,he().Py)("Tags"),['.includes("Finance")']]}]:[{input:[(0,he().Py)("Tags"),[".length()"]]},{input:[(0,he().Py)("Tags"),['.includes("Finance")']]}]},status:{name:"status",type:{type:"text"},description:je.statusPropertyDescription,examples:e=>"Status"===(null==e?void 0:e.name)?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[' == "Done"']],isCopyable:!0},{input:[['["Not started", "In progress"].includes('],(0,he().Y2)(e),[")"]],isCopyable:!0}]:[{input:[(0,he().Py)("Status"),[' == "Done"']]},{input:[['["Not started", "In progress"].includes('],(0,he().Py)("Status"),[")"]]}]},checkbox:{name:"checkbox",type:{type:"checkbox"},description:je.checkboxPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[["not "],(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Py)("Signed"),[" and "],(0,he().Py)("Sealed"),[" and "],(0,he().Py)("Delivered")]}]:[{input:[["not"],(0,he().Py)("Done")]},{input:[(0,he().Py)("Signed"),[" and "],(0,he().Py)("Sealed"),[" and "],(0,he().Py)("Delivered")]}]},date:{name:"date",type:{type:"date"},description:je.datePropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[" > now()"]],isCopyable:!0},{input:[(0,he().Y2)(e),['.dateAdd(1, "weeks")']],isCopyable:!0},{input:[["dateBetween("],(0,he().Y2)(e),[', now(), "days")']],isCopyable:!0}]:[{input:[(0,he().Py)("Due Date"),[" > now()"]]},{input:[["formatDate("],(0,he().Py)("Date"),[', "YYYY/MM/DD HH:mm")']]},{input:[["dateBetween("],(0,he().Py)("Birthday"),[', now(), "days")']]}]},person:{name:"person",type:{type:"array",of:{type:"text"}},description:je.personPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[".length()"]],isCopyable:!0},{input:[(0,he().Y2)(e),[".at(0)"]],isCopyable:!0},{input:[(0,he().Y2)(e),[".map(current.email())"]],isCopyable:!0},{input:[(0,he().Y2)(e),['.some(current.name() == "Alice")']]}]:[{input:[(0,he().Py)("Participants"),[".at(0)"]]},{input:[(0,he().Py)("Participants"),[".length()"]]},{input:[(0,he().Py)("Participants"),['.some(current.name() == "Alice")']]}]},relation:{name:"relation",type:{type:"array",of:{type:"block"}},description:je.relationPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[".length()"]],isCopyable:!0},{input:[(0,he().Py)("Tasks"),[".filter(current."],(0,he().Py)("Status"),[' != "Done")']]}]:[{input:[(0,he().Py)("Tasks"),[".length()"]]},{input:[(0,he().Py)("Tasks"),[".filter(current."],(0,he().Py)("Status"),[' != "Done")']]}]},rollup:{name:"rollup",type:e=>{if("rollup"===(null==e?void 0:e.type)&&("show_unique"===e.aggregation||void 0===e.aggregation))return{type:"array",of:{type:"unknown"}};if(e&&"aggregation"in e&&void 0!==e.aggregation){return{type:(0,we().ou)((0,we().ZP)(e.aggregation))}}return{type:"unknown"}},description:e=>"rollup"!==(null==e?void 0:e.type)||"show_unique"!==e.aggregation&&void 0!==e.aggregation?je.rollupPropertyDescription:je.rollupPropertyDescriptionList,examples:(e,t)=>{let n;return n=!t||"rollup"!==(null==t?void 0:t.type)||"show_unique"!==t.aggregation&&void 0!==t.aggregation?[{input:[(0,he().Py)("Average cost"),[" * 12"]]},{input:[(0,he().Py)("Sum of customers"),[" > 100"]]}]:[void 0!==e?{input:[(0,he().Y2)(e),[".length()"]],isCopyable:!0}:{input:[(0,he().Py)("Purchases"),[".length()"]]},{input:[["sum("],(0,he().Py)("Purchases"),[".map(current."],(0,he().Py)("Cost"),["))"]]}],e&&n.unshift({input:[(0,he().Y2)(e)],isCopyable:!0}),n}},file:{name:"file",type:{type:"array",of:{type:"text"}},description:je.filePropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[".length()"]],isCopyable:!0},{input:[(0,he().Y2)(e),['.filter(current.match(".pdf$"))']],isCopyable:!0},{input:[(0,he().Y2)(e),['.map(link("File", current))']],isCopyable:!0}]:[{input:[(0,he().Py)("Attachments"),[".length()"]]},{input:[(0,he().Py)("Attachments"),['.filter(current.match(".pdf$"))']]},{input:[(0,he().Py)("Attachments"),['.map(link("File", current))']]}]},formula:{name:"formula",type:e=>{var t,n,o;return e&&"formula2"in e&&null!==(t=e.formula2)&&void 0!==t&&null!==(t=t.result_type)&&void 0!==t&&t.type?e.formula2.result_type:e&&"formula"in e&&null!==(n=e.formula)&&void 0!==n&&n.result_type?{type:null===(o=e.formula)||void 0===o?void 0:o.result_type}:{type:"unknown"}},description:e=>{var t;return e&&"formula2"in e&&"array"===(null===(t=e.formula2)||void 0===t||null===(t=t.result_type)||void 0===t?void 0:t.type)?je.formulaPropertyDescriptionList:je.formulaPropertyDescription},examples:(e,t)=>{var n,o;let i={type:"unknown"};if(t&&"formula2"in t&&null!==(n=t.formula2)&&void 0!==n&&null!==(n=n.result_type)&&void 0!==n&&n.type)i=t.formula2.result_type;else if(t&&"formula"in t&&null!==(o=t.formula)&&void 0!==o&&o.result_type){var r;i={type:null===(r=t.formula)||void 0===r?void 0:r.result_type}}if(!e)return[];const a=[{input:[(0,he().Y2)(e)],isCopyable:!0}];switch(i.type){case"array":switch(a.push({input:[(0,he().Y2)(e),[".length()"]],isCopyable:!0}),i.of.type){case"text":a.push({input:[(0,he().Y2)(e),['.join("\\n")']],isCopyable:!0});break;case"number":a.push({input:[(0,he().Y2)(e),[".sum()"]],isCopyable:!0});break;case"date":a.push({input:[(0,he().Y2)(e),['.map(dateBetween(now(), current, "days"))']],isCopyable:!0});break;case"person":a.push({input:[(0,he().Y2)(e),[".map(current.name())"]],isCopyable:!0}),a.push({input:[(0,he().Y2)(e),[".some(current.name() == 'Alice')"]],isCopyable:!0});break;case"checkbox":a.push({input:[(0,he().Y2)(e),[".every(current == true)"]],isCopyable:!0});break;case"block":a.push({input:[(0,he().Py)("Primary Tasks"),[".filter(current."],(0,he().Py)("Status"),[' == "Done")']]})}break;case"number":a.push({input:[(0,he().Y2)(e),[" * 2 > 100"]],isCopyable:!0});break;case"text":a.push({input:[(0,he().Y2)(e),[".upper()"]],isCopyable:!0});break;case"date":a.push({input:[(0,he().Y2)(e),[" > now()"]],isCopyable:!0});break;case"person":a.push({input:[(0,he().Y2)(e),[".name()"]],isCopyable:!0});break;case"checkbox":a.push({input:[["not "],(0,he().Y2)(e)],isCopyable:!0});break;case"block":a.push({input:[(0,he().Y2)(e),[".map(current."],(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.CreatedBy),[")"]]})}return a}},created_time:{name:"created_time",type:{type:"date"},description:je.createdTimePropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),['.dateAdd(1, "weeks")']],isCopyable:!0},{input:[(0,he().Y2)(e),[' > dateSubtract(now(), 1, "years")']],isCopyable:!0}]:[{input:[(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.CreatedTime),['.dateAdd(1, "weeks")']]},{input:[(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.CreatedTime),[' > dateSubtract(now(), 1, "years")']]}]},last_edited_time:{name:"last_edited_time",type:{type:"date"},description:je.lastEditedTimePropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),['.dateAdd(1, "weeks")']],isCopyable:!0},{input:[(0,he().Y2)(e),[' > dateSubtract(now(), 1, "month")']],isCopyable:!0}]:[{input:[(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.LastEditedTime),['.dateAdd(1, "weeks")']]},{input:[(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.LastEditedTime),[' > dateSubtract(now(), 1, "month")']]}]},created_by:{name:"created_by",type:{type:"person"},description:je.createdByPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[".name()"]],isCopyable:!0},{input:[(0,he().Y2)(e),[".email()"]],isCopyable:!0}]:[{input:[(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.CreatedBy),[".name()"]]},{input:[(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.CreatedBy),[".email()"]]}]},last_edited_by:{name:"last_edited_by",type:{type:"person"},description:je.lastEditedByPropertyDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),[".name()"]],isCopyable:!0},{input:[(0,he().Y2)(e),[".email()"]],isCopyable:!0}]:[{input:[(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.LastEditedBy),[".name()"]]},{input:[(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.LastEditedBy),[".email()"]]}]},auto_increment_id:{name:"auto_increment_id",type:{type:"number"},description:je.autoincrementIdDescription,examples:e=>e?[{input:[(0,he().Y2)(e)],isCopyable:!0},{input:[(0,he().Y2)(e),['.split("-").first() /* Prefix */']],isCopyable:!0},{input:[(0,he().Y2)(e),['.split("-").last().toNumber() /* ID */']],isCopyable:!0}]:[{input:[(0,he().Py)("ID Code")]},{input:[(0,he().Py)("Task ID"),['.split("-").first() /* Prefix */']],output:'"TASK"'},{input:[(0,he().Py)("Task ID"),['.split("-").last().toNumber() /* ID */']],output:"123"}]},button:null,location:null,last_visited_time:null,verification:null,place:null},Ne={text:{examples:e=>e?[{input:[(0,he().HH)({id:e.id})]},{input:[["upper("],(0,he().HH)({id:e.id}),[")"]]},{input:[(0,he().HH)({id:e.id}),['.style("b", "red")']]}]:[]},number:{examples:e=>e?[{input:[(0,he().HH)(e)],isCopyable:!0},{input:[(0,he().HH)(e),[" / 2"]],isCopyable:!0},{input:[["pi() * "],(0,he().HH)(e),[" ^ 2"]],isCopyable:!0}]:[]},checkbox:{examples:e=>e?[{input:[(0,he().HH)(e)]},{input:[["not "],(0,he().HH)(e)]}]:[]},date:{examples:e=>e?[{input:[(0,he().HH)(e)]},{input:[(0,he().HH)(e),[" > now()"]]},{input:[(0,he().HH)(e),['.dateAdd(1, "weeks")']]},{input:[["dateBetween("],(0,he().HH)(e),[', now(), "days")']]}]:[]},block:{examples:e=>e?[{input:[(0,he().HH)(e)]},{input:[(0,he().HH)(e),[".format()"]]},{input:[(0,he().HH)(e),["."],(0,he().pC)(ge().FormulaTokenSupportedBlockSystemProperty.CreatedBy)]}]:[]},person:{examples:e=>e?[{input:[(0,he().HH)(e)]},{input:[(0,he().HH)(e),[".email()"]]},{input:[(0,he().HH)(e),['.name() == "Alice"']]}]:[]},array:{examples:e=>e?[{input:[(0,he().HH)(e)]},{input:[(0,he().HH)(e),[".length()"]]},{input:[(0,he().HH)(e),[".at(0).format()"]]}]:[]},select:null,function:null,unknown:null};var Be=()=>n(925907),Re=()=>n(979004),Le=()=>n(191772),_e=()=>n(354584),Ye=()=>n(712030),He=()=>n(267419),Ue=()=>n(713972),Ke=()=>n(141768),Ve=()=>n(47170),ze=()=>n(217429),Oe=()=>n(285790);const We=o.memo((function(e){let{infoHelper:t,getRecordModel:n,style:o,typecheckContextValues:i}=e;const r=t;if(void 0===(null==r?void 0:r.kind))return null;switch(r.kind){case ge().FormulaEditorInfoCompletionKind.Token:return(0,ae.jsx)(qe,{completion:r,getRecordModel:n,style:o,typecheckContextValues:i});case ge().FormulaEditorInfoCompletionKind.LibraryFunction:{const e=Boolean(null==t?void 0:t.calledFromUnifiedFunctionProperty),i=function(e,t){if(t&&void 0!==e.syntax[1])return e.syntax[1];return e.syntax[0]}(r.libraryFunction,e),a=function(e,t){if(t&&void 0!==e.examples[1])return e.examples[1];return e.examples[0]}(r.libraryFunction,e),s=r.libraryFunction.returnType;return(0,ae.jsx)(Ge,{icon:at("function"==typeof s?s([]).type:s.type),name:i,description:Ce().A.formatMessage(r.libraryFunction.description),examples:a.length>0?a.map(((e,t)=>(0,ae.jsx)($e,{example:e,getRecordModel:n},t))):void 0,style:o})}case ge().FormulaEditorInfoCompletionKind.Binding:var a;return r.text===ge().CURRENT_VALUE_NAME?(0,ae.jsx)(Ge,{icon:at(r.type.type),name:r.text,description:Ce().A.formatMessage(et.currentValueDescription),style:o}):r.text===ge().CURRENT_INDEX_NAME?(0,ae.jsx)(Ge,{icon:at(r.type.type),name:r.text,description:Ce().A.formatMessage(et.currentIndexDescription),style:o}):(0,ae.jsx)(Ge,{icon:at(r.type.type),name:r.text,description:Ce().A.formatMessage("array"===(null==r||null===(a=r.type)||void 0===a?void 0:a.type)?et.listVariableType:et.variableType),style:o});case ge().FormulaEditorInfoCompletionKind.Builtin:{const e=ke[r.builtin];return(0,ae.jsx)(Ge,{icon:at(e.type.type),name:e.name,description:Ce().A.formatMessage(e.description),examples:e.examples.length>0?e.examples.map(((e,t)=>(0,ae.jsx)($e,{example:e,getRecordModel:n},t))):void 0,style:o})}default:return(0,x().HB)(r)}}));function $e(e){let{example:t,getRecordModel:n,typecheckContextValues:s}=e;const l=(0,P().fJ)(_e().y),u=(0,Ye().Ol)(),p=(0,i().v3)(),{device:g}=p,x=(0,Ve().O)(),v=(0,a().DP)(),h=(0,y().tz)(),k=(0,He()._)(),C=(0,r().K8)((()=>{var e;const o=document.createElement("div"),i="string"!=typeof t.input?m().q4_(t.input):t.input,r=(null===(e=l.value)||void 0===e?void 0:e.highlight(`${i}`,l.value.languages[Re().PrismLanguages.notion],Re().PrismLanguages.notion))??"";o.innerHTML=Ke().bi(r);const a=f().oE(Array.from(o.childNodes).map(Ze)),c="string"==typeof t.input?[[t.input],[" = "]]:t.input.concat([[" = "]]),y=Ke().YH(c,f().oE(a)),b=c.map(m().uPN).map(((e,t)=>(0,Le().sT)({annotations:e,theme:v,getRecordModel:n,spaceId:x})));return y.map(((e,t)=>{const o=b[e.textTokenIndex],i=c[e.textTokenIndex];return m().qXl(i)?(0,Le().Au)({args:{textValue:{value:c,spaceId:x},getRecordModel:n,getRecordRole:()=>{},disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableLinks:!1,userTimeZone:(0,d().P)(),disabled:!1,isAndroid:g.isAndroid,isSafariOrIOS:g.isSafari||g.isIOS,isWindows:g.isWindows,showEmojiInline:g.isWindows,emojiType:u,highlightDiscussionId:void 0,theme:v,intl:h,renderedPageBlockId:void 0,parentBlockId:void 0,katex:void 0,isClient:!0,baseUrl:I().A.domainBaseUrl,publicDomainName:I().A.publicDomainName,currentUserId:p.currentUser.id,getPublicBaseUrlForPage:void 0,externalIntegrations:[],formulaValueTypes:s??[],emojiData:k,isMobileNative:g.isMobileNative,isMobileNativeExternalLinkFixEnabled:ze().default.checkGate({gateName:"mobile_native_external_link_fix"}),displayInUserTimezone:!0},style:o.style,classNames:o.classNames,index:t,token:i,tokenValue:m().N8A(i),tokenAnnotations:m().uPN(i)}):(0,ae.jsx)("span",{className:[e.classNames||"",...o.classNames].join(" "),style:o.style,"data-token-index":e.textTokenIndex,children:e.value},t)}))}),[t.input,l.value,v,n,x,g.isAndroid,g.isSafari,g.isIOS,g.isWindows,g.isMobileNative,u,h,p.currentUser.id,s,k]),S=(0,r().K8)((()=>Array.isArray(t.output)?(0,Le().S5)({textValue:{value:t.output,spaceId:x},getRecordModel:n,getRecordRole:()=>{},disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableLinks:!1,userTimeZone:(0,d().P)(),disabled:!1,isAndroid:g.isAndroid,isSafariOrIOS:g.isSafari||g.isIOS,isWindows:g.isWindows,showEmojiInline:g.isWindows,emojiType:u,theme:v,intl:h,katex:void 0,isClient:!0,baseUrl:I().A.domainBaseUrl,publicDomainName:I().A.publicDomainName,currentUserId:p.currentUser.id,getPublicBaseUrlForPage:void 0,externalIntegrations:[],formulaValueTypes:[],emojiData:k,isMobileNative:g.isMobileNative,isMobileNativeExternalLinkFixEnabled:ze().default.checkGate({gateName:"mobile_native_external_link_fix"}),displayInUserTimezone:!0}):t.output),[g.isAndroid,g.isIOS,g.isSafari,g.isWindows,g.isMobileNative,k,u,p.currentUser.id,t.output,n,h,x,v]),M=!1!==t.isCopyable&&("string"==typeof t.input||!0===t.isCopyable),T=(0,o.useCallback)((async()=>{if(M){const e=(Array.isArray(t.input)?(0,c().r4)({intl:h,textValue:t.input,getRecordModel:n,userTimeZone:(0,d().P)()}):t.input).replaceAll(/\/\*.*\*\//g,"").trim();(await b().R.clipboardActions.load()).copyString({stringValue:e,environment:p,copiedMessage:Xe.copiedExampleMessage})}}),[p,t.input,n,h,M]),E=(0,a().IS)((e=>({code:{fontFamily:"monospace",whiteSpaceCollapse:"preserve",fontSize:11,borderRadius:5,border:`1px solid ${e.stroke.secondary}`,margin:"0 -4px",padding:"0 6px",pointerEvents:"none",opacity:.95,display:"flex",flexDirection:"row",alignItems:"center",tabSize:2},left:{flexGrow:1,padding:"6px 0"},right:{alignSelf:"center"},copyButton:{height:22,width:22,pointerEvents:"auto"},copyButtonIcon:{height:12,width:12}})),[]);return(0,ae.jsxs)("div",{style:E.code,children:[(0,ae.jsxs)("div",{style:E.left,children:[(0,ae.jsx)("div",{children:C}),S?(0,ae.jsxs)("div",{children:["= ",S]}):null]}),M?(0,ae.jsx)("div",{style:E.right,children:(0,ae.jsx)(Oe().A,{ariaLabel:h.formatMessage(Xe.copyToClipboard),onClick:T,icon:Be().n,style:E.copyButton,iconStyle:E.copyButtonIcon,disallowTabbing:!0})}):null]})}function Ge(e){let{name:t,icon:n,description:o,examples:i,style:r}=e;const s=(0,a().IS)((e=>({helper:{display:"flex",flexDirection:"column",fontSize:12,height:"auto",width:"100%",gap:8,overflow:"auto",textWrap:"wrap",...r},name:{fontSize:14,fontWeight:600,display:"flex",alignItems:"center"},description:{color:e.text.secondary},iconStyle:{height:14,width:14,fill:e.icon.secondary,display:"inline",marginRight:6},examples:{display:"flex",flexDirection:"column",gap:4}})),[r]);return(0,ae.jsxs)("div",{style:s.helper,children:[(0,ae.jsxs)("span",{style:s.name,children:[void 0!==n&&n(s.iconStyle),t]}),void 0!==o&&(0,ae.jsx)("span",{style:s.description,children:o}),void 0!==i&&(0,ae.jsx)("div",{style:s.examples,children:i})]})}function qe(e){let{completion:t,getRecordModel:n,style:o,typecheckContextValues:i}=e;const{name:a,description:s,icon:l,examples:d}=(0,r().K8)((()=>{if(!n)return{};if(t.token.type===ge().FormulaTokenType.BlockProperty){var e;if((0,u().ix)(t.token))return{};if(ge().FormulaTokenSupportedBlockSystemPropertyList.includes(t.token.property)&&!t.token.collection){var o;const e=null===(o=ge().FormulaTokenSupportedBlockSystemPropertyToType[t.token.property])||void 0===o?void 0:o.type,i=e?fe().LE[e]:void 0,r=De[t.token.property],a="function"==typeof(null==r?void 0:r.description)?r.description():null==r?void 0:r.description,s=t.name??t.token.property;return{name:s,icon:i,description:a?Ce().A.formatMessage(a):void 0,examples:null!==r?Qe(r,n,{collection:t.token.collection,property:t.token.property,name:s},{name:s,type:t.token.property}):void 0}}if(!t.token.collection)return{};const i=(0,u().Yi)(t.token.property),r=n(t.token.collection),a=null==r||null===(e=r.getNormalizedSchema())||void 0===e?void 0:e[i];if(!a)return{};const s=De[a.type];return s?{name:t.name,icon:fe().LE[a.type],description:Ce().A.formatMessage("function"==typeof s.description?s.description(a):s.description),examples:Qe(s,n,{collection:t.token.collection,property:i,name:t.name},a)}:{}}if(t.token.type===ge().FormulaTokenType.ContextValue){const e=(0,u()._H)(i,(0,u().GH)(t.token.valueId));if(!e||e.kind!==ge().FormulaContextValueKind.ContextValue)return{};const o=e.type.type,r=Ne[o];return{name:e.name,description:e.description??e.tooltipName,icon:at(e.type.type),examples:null!=r&&r.examples?Je(r,n,i,e):void 0}}if(t.token.type===ge().FormulaTokenType.Block||t.token.type===ge().FormulaTokenType.Checkbox||t.token.type===ge().FormulaTokenType.Date||t.token.type===ge().FormulaTokenType.Person)return{};(0,x().HB)(t.token)}),[t.name,t.token,n,i]);return void 0===a?null:(0,ae.jsx)(Ge,{name:a,icon:l,description:s,examples:d,style:o})}function Qe(e,t,n,o){const i=e.examples;let r=[];return r="function"==typeof i?i(n,o).map(((e,n)=>(0,ae.jsx)($e,{example:e,getRecordModel:t},n))):i.map(((e,n)=>(0,ae.jsx)($e,{example:e,getRecordModel:t},n))),r.length>0?r:void 0}function Je(e,t,n,o){const i=e.examples;let r=[];return r="function"==typeof i?i(o).map(((e,o)=>(0,ae.jsx)($e,{example:e,getRecordModel:t,typecheckContextValues:n},o))):i.map(((e,o)=>(0,ae.jsx)($e,{example:e,getRecordModel:t,typecheckContextValues:n},o))),r.length>0?r:void 0}function Ze(e){return Ue().KH(e)?[e.data]:Ue().vq(e)?[e.textContent||"",e.className]:void 0}const Xe=(0,y().YK)({copiedExampleMessage:{id:"formula2Input.helperText.copiedExampleMessage",defaultMessage:"Copied example to clipboard!"},copyToClipboard:{defaultMessage:"Copy to Clipboard",id:"database.copyButton.copyToClipboard"}}),et=(0,y().YK)({currentValueDescription:{id:"formula2Input.helperText.currentValueDescription",defaultMessage:"Returns the value of the current item in the list function."},currentIndexDescription:{id:"formula2Input.helperText.currentIndexDescription",defaultMessage:"Returns the index of the current item in the list function, starting from 0."},variableType:{id:"formula2Input.variableHelper.description",defaultMessage:"User-defined variable."},listVariableType:{id:"formula2Input.variableHelper.descriptionWithList",defaultMessage:"User-defined variable, list."}});function tt(e){const{store:t,selection:n,cursorEditorInfo:s,cursorEditorInfoRef:l,context:u,onChange:d,getRecordModel:p,setInfoHelper:c}=e,m=(0,a().IS)((()=>({menu:{top:0,left:0,right:0,bottom:0,position:"absolute",marginBottom:2},menuSection:{paddingTop:6,paddingBottom:2}})),[]),y=(0,i().Y0)(),g=(0,r().uB)(void 0,Se().A),x=(0,o.useMemo)((()=>{const e=f().$z((null==s?void 0:s.completions)??[],"kind");let o=-1;return Object.entries(e).map(((e,i)=>{const[r,a]=e,s=a.map(((e,r)=>{o+=1;const a=o;return{key:`${i}-${r}`,render:t=>(0,ae.jsx)(nt,{...t,completion:e,context:u,getRecordModel:p,menuListStore:g,indexGlobal:a,cursorEditorInfoRef:l,setInfoHelper:c}),action:()=>{var o;void 0!==e&&l.current&&(c({...e,calledFromUnifiedFunctionProperty:"member dot receiver"===(null===(o=l.current.completionsInfo)||void 0===o?void 0:o.type)}),lt({completion:e,store:t,selection:n,onChange:d,cursorEditorInfo:l.current}))}}}));return{key:r,render:e=>(0,ae.jsx)(Fe().A,{...e,style:m.menuSection,title:Ce().A.formatMessage(dt[r])}),items:s}}))}),[u,null==s?void 0:s.completions,l,p,g,d,n,c,t,m.menuSection]),v=(0,o.useCallback)((e=>{var t;if(y.isMobile)return;const n=void 0!==e.indexGlobal?null===(t=l.current)||void 0===t||null===(t=t.completions)||void 0===t?void 0:t[e.indexGlobal]:void 0;var o;n&&c({...n,calledFromUnifiedFunctionProperty:"member dot receiver"===(null===(o=l.current)||void 0===o||null===(o=o.completionsInfo)||void 0===o?void 0:o.type)})}),[l,y.isMobile,c]);let b;return(0,o.useEffect)((()=>{if(y.isMobile)return;const e=e=>{var t,n;if(void 0!==e.state.focus.indexGlobal&&null!==(t=l.current)&&void 0!==t&&t.completions&&(null===(n=l.current)||void 0===n?void 0:n.completions.length)>0){var o;const t=null===(o=l.current)||void 0===o||null===(o=o.completions)||void 0===o?void 0:o[e.state.focus.indexGlobal];void 0!==t&&c((e=>{var n;return void 0===e||void 0===(null===(n=l.current)||void 0===n?void 0:n.callParameter)?t:e}))}};return g.addListener(e),()=>g.removeListener(e)}),[l,g,c,y.isMobile]),(0,o.useEffect)((()=>{var e,t,n,o;if(y.isMobile)return;const i="function"===(null==s||null===(e=s.callParameter)||void 0===e||null===(e=e.expression)||void 0===e||null===(e=e.type)||void 0===e?void 0:e.type)?null===(t=s.callParameter.expression)||void 0===t?void 0:t.type:void 0;void 0!==i&&void 0!==(null==s||null===(n=s.callParameter)||void 0===n?void 0:n.parameterIndex)&&(null==s||null===(o=s.callParameter)||void 0===o?void 0:o.parameterIndex)>-1&&c({kind:ge().FormulaEditorInfoCompletionKind.LibraryFunction,libraryFunction:i.libraryFunction,calledFromUnifiedFunctionProperty:i.calledFromUnifiedFunctionProperty})}),[null==s?void 0:s.callParameter,y.isMobile,c]),(0,o.useEffect)((()=>{x.length>0&&g.update((e=>({focus:{...e,section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})))}),[x.length,g,c]),b=y.isPhone?{menuType:Ie().gu.Modal,forceFullScreenSlideUp:!0,hideMobileTopbar:!0}:{menuType:Ie().gu.Popup,width:228,minWidth:228,maxWidth:228},(0,ae.jsx)(Ee().A,{...b,scrollerStyle:m.menu,children:(0,ae.jsx)(Ae().Ay,{type:Ae().Oh.Vertical,initialFocus:0,priority:1,store:g,onKeyboardArrow:v,sections:f().oE([...x,0===x.length&&{key:"no-results",render:e=>(0,ae.jsx)(Fe().A,{...e,disableDesktopPadding:!0,style:m.menuSection,children:(0,ae.jsx)(st,{})}),items:[]}])})})}const nt=o.forwardRef((function(e,t){const{completion:s,context:l,getRecordModel:d,menuListStore:p,indexGlobal:c,cursorEditorInfoRef:m,setInfoHelper:f,onMouseEnter:g,...v}=e,b=(0,i().Y0)(),h=(0,a().IS)((e=>({icon:{width:14,fill:e.icon.secondary},lightParens:{color:e.text.tertiary}})),[]),k=(0,o.useCallback)((e=>{if(!b.isMobile){var t;const e=null===(t=m.current)||void 0===t||null===(t=t.completions)||void 0===t?void 0:t[c];f(e)}null==g||g(e)}),[m,c,g,f,b.isMobile]),C=(0,r().K8)((()=>p.state.focus.indexGlobal===c),[p,c]),I=(0,o.useMemo)((()=>b.isMobile?(0,ae.jsx)(Pe().Ay,{popupType:Pe().z7.SlideUp,renderOrigin:e=>(0,ae.jsx)(te().A,{style:{width:16,height:16},...e,children:(0,n(166883).x)(h.icon)}),render:e=>{var t;let o;return o=b.isMobile?{menuType:Ie().gu.Modal,title:(0,ae.jsx)(y().sA,{defaultMessage:"Documentation",id:"database.formulaPropertyEntryMenuItem.title"}),right:(0,ae.jsx)(n(480095).DoneMenuText,{}),onClickRight:e.close}:{menuType:Ie().gu.Popup},(0,ae.jsx)(Ee().A,{...o,children:(0,ae.jsx)(Fe().A,{children:(0,ae.jsx)(n(678553).Ay,{title:(0,ae.jsx)(We,{infoHelper:{...s,calledFromUnifiedFunctionProperty:"member dot receiver"===(null==m||null===(t=m.current)||void 0===t||null===(t=t.completionsInfo)||void 0===t?void 0:t.type)},getRecordModel:d,style:{padding:4},typecheckContextValues:l.valueTypes}),style:{paddingTop:16,paddingBottom:16}})})})}}):(0,ae.jsx)(ot,{visible:C})),[s,l.valueTypes,m,b.isMobile,d,C,h.icon]),S=(0,r().K8)((()=>{var e;if(s.kind!==ge().FormulaEditorInfoCompletionKind.Token||s.token.type!==ge().FormulaTokenType.BlockProperty||!d)return;if(ge().FormulaTokenSupportedBlockSystemPropertyList.includes(s.token.property))return s.token.property;if((0,u().ix)(s.token)||!s.token.collection)return;const t=(0,u().Yi)(s.token.property),n=d(s.token.collection);return null==n||null===(e=n.getNormalizedSchema())||void 0===e||null===(e=e[t])||void 0===e?void 0:e.type}),[s,d]);if(s.kind===ge().FormulaEditorInfoCompletionKind.Token){if(s.token.type===ge().FormulaTokenType.Checkbox)return null;if(s.token.type===ge().FormulaTokenType.BlockProperty)return(0,ae.jsx)(Te().A,{...v,icon:S?fe().LE[S](h.icon):(0,ae.jsx)(it,{type:"unknown"}),title:s.name??s.token.property,right:I,onMouseEnter:k,ref:t});if(s.token.type===ge().FormulaTokenType.ContextValue){const e=(0,u().IV)(l.valueTypes,(0,u().GH)(s.token.valueId));return e?(0,ae.jsx)(Te().A,{...v,icon:(0,ae.jsx)(rt,{contextValue:e}),title:(0,ae.jsx)("div",{style:{display:"flex"},children:e.name}),right:I,onMouseEnter:k,ref:t}):null}if(s.token.type===ge().FormulaTokenType.Date)return null;if(s.token.type===ge().FormulaTokenType.Block)return null;if(s.token.type===ge().FormulaTokenType.Person)return null;(0,x().HB)(s.token)}else{if(s.kind===ge().FormulaEditorInfoCompletionKind.LibraryFunction){const e=s.libraryFunction.returnType;return(0,ae.jsx)(Te().A,{...v,icon:(0,ae.jsx)(it,{type:"function"==typeof e?e([]).type:e.type}),title:(0,ae.jsxs)(ae.Fragment,{children:[s.libraryFunction.name,(0,ae.jsx)("span",{style:h.lightParens,children:"()"})]}),right:I,onMouseEnter:k,ref:t})}if(s.kind===ge().FormulaEditorInfoCompletionKind.Builtin)return(0,ae.jsx)(Te().A,{...v,title:s.builtin,icon:(0,ae.jsx)(it,{type:ke[s.builtin].type.type}),right:I,onMouseEnter:k,ref:t});if(s.kind===ge().FormulaEditorInfoCompletionKind.Binding)return(0,ae.jsx)(Te().A,{...v,title:s.text,icon:(0,ae.jsx)(it,{type:s.type.type}),right:I,onMouseEnter:k,ref:t});(0,x().HB)(s)}})),ot=o.memo((function(e){let{visible:t}=e;const o=(0,a().IS)((e=>({icon:{width:14,fill:e.icon.secondary,transition:"opacity 50ms 200ms",visibility:t?"visible":"hidden",opacity:t?1:0}})),[t]);return(0,n(356596).K)(o.icon)})),it=o.memo((function(e){var t;let{type:n}=e;const o=(0,a().IS)((e=>({icon:{width:14,fill:e.icon.secondary,transition:"transform .3s ease"}})),[]);return null===(t=at(n))||void 0===t?void 0:t(o.icon)}));function rt(e){const{contextValue:t}=e,o=(0,a().IS)((e=>({stepNumber:{color:e.icon.secondary}})),[]);return(0,x().O9)(t.stepNumberForDisplay)?(0,ae.jsx)(n(931077).Q,{size:n(494379).H.Small,number:t.stepNumberForDisplay,style:o.stepNumber}):(0,ae.jsx)(it,{type:t.type.type})}function at(e){return"text"===e?fe().LE.text:"number"===e?fe().LE.number:"checkbox"===e?fe().LE.checkbox:"date"===e?fe().LE.date:"block"===e?fe().LE.relation:"person"===e?fe().LE.person:"select"===e?fe().LE.select:"array"===e?fe().LE.multi_select:"function"===e||void 0===e||"unknown"===e?fe().LE.formula:void(0,x().HB)(e)}function st(){return(0,ae.jsx)(Me().A,{caption:(0,ae.jsx)(y().sA,{defaultMessage:"No results",id:"FormulaAutocompleteMenu.noResults.message"})})}function lt(e){var t,n;const{completion:o,store:i,selection:r,onChange:a,cursorEditorInfo:s}=e,l=(null==r?void 0:r.startIndex)||0,d=(null==r?void 0:r.endIndex)||0,p=l!==d,c="member dot receiver"===(null===(t=s.completionsInfo)||void 0===t?void 0:t.type),y=(s.nodePath??[]).at(-1),f=(0,xe().canAcceptAutocompletionsWithoutDot)({nodeAtPosition:y,dotMemberExpression:c}),g=(null===(n=s.completionsInfo)||void 0===n?void 0:n.prefix)||"",v="overridePrefixLength"in o?o.overridePrefixLength??0:g.length,b=p?l:d-v,h=i.getValue();if(o.kind===ge().FormulaEditorInfoCompletionKind.Token){if(o.token.type===ge().FormulaTokenType.Checkbox)return;if(o.token.type===ge().FormulaTokenType.BlockProperty){if((0,u().ix)(o.token))return;const e=(0,m().lzV)(h,b,d),t=o.token.collection?(0,u().Yi)(o.token.property):o.token.property,n=(0,m().wmz)((0,m().ESw)({collection:o.token.collection,property:t,name:o.name})),i=b+(f?1:0)+1;return void a({newValue:(0,m().xym)(e,f?[["."],n]:[n],b),newSelection:{startIndex:i,endIndex:i}})}if(o.token.type===ge().FormulaTokenType.ContextValue){const e=(0,m().lzV)(h,b,d),t=(0,u().GH)(o.token.valueId),n=(0,m().wmz)((0,m().CA$)({id:t}));a({newValue:(0,m().xym)(e,f?[["."],n]:[n],b),newSelection:{startIndex:b+1,endIndex:b+1}})}else{if(o.token.type===ge().FormulaTokenType.Date||o.token.type===ge().FormulaTokenType.Block||o.token.type===ge().FormulaTokenType.Person)return;(0,x().HB)(o.token)}}else if(o.kind===ge().FormulaEditorInfoCompletionKind.LibraryFunction){var k,C,I;const e=(0,m().lzV)(h,b,d),t=(0,m().Ey_)(`${o.libraryFunction.name}()`,[]),n=(0,m().xym)(e,f?[["."],t]:[t],b);let i=b+o.libraryFunction.name.length+1;f&&(i+=1),void 0===(null===(k=o.libraryFunction)||void 0===k||null===(k=k.parameters)||void 0===k?void 0:k.varargs)&&(null===(C=o.libraryFunction)||void 0===C||null===(C=C.parameters)||void 0===C||null===(C=C.expected)||void 0===C||!C.length||1===(null===(I=o.libraryFunction)||void 0===I||null===(I=I.parameters)||void 0===I||null===(I=I.expected)||void 0===I?void 0:I.length)&&c)&&(i+=1);a({newValue:n,newSelection:{startIndex:i,endIndex:i}})}else if(o.kind===ge().FormulaEditorInfoCompletionKind.Binding||o.kind===ge().FormulaEditorInfoCompletionKind.Builtin){const e=(0,m().lzV)(h,b,d);let t="";o.kind===ge().FormulaEditorInfoCompletionKind.Binding?t=o.text:o.kind===ge().FormulaEditorInfoCompletionKind.Builtin?(t=o.builtin,((null==y?void 0:y.kind)!==ve().NM.Call||c)&&(void 0!==y&&(t=" "+t),t+=" ")):(0,x().HB)(o);const n=(0,m().Ey_)(t,[]),i=(0,m().xym)(e,[n],b),r=b+t.length;a({newValue:i,newSelection:{startIndex:r,endIndex:r}})}else(0,x().HB)(o)}const ut=(0,y().YK)({[ge().FormulaEditorInfoCompletionKind.Token]:{defaultMessage:"Properties",id:"formulaAutocompleteMenu.token.message"},[ge().FormulaEditorInfoCompletionKind.LibraryFunction]:{defaultMessage:"Functions",id:"formulaAutocompleteMenu.function.message"},[ge().FormulaEditorInfoCompletionKind.Binding]:{defaultMessage:"Variables",id:"formulaAutocompleteMenu.variables.message"},[ge().FormulaEditorInfoCompletionKind.Builtin]:{defaultMessage:"Built-ins",id:"formulaAutocompleteMenu.builtin.message"}}),dt={[ge().FormulaEditorInfoCompletionKind.Token]:ut[ge().FormulaEditorInfoCompletionKind.Token],[ge().FormulaEditorInfoCompletionKind.LibraryFunction]:ut[ge().FormulaEditorInfoCompletionKind.LibraryFunction],[ge().FormulaEditorInfoCompletionKind.Binding]:ut[ge().FormulaEditorInfoCompletionKind.Binding],[ge().FormulaEditorInfoCompletionKind.Builtin]:ut[ge().FormulaEditorInfoCompletionKind.Builtin]};var pt=()=>n(962730),ct=()=>n(493823),mt=()=>n(204063),yt=()=>n(859428),ft=()=>n(449506);const gt=(0,y().YK)({feedbackSuccess:{id:"formulaInferenceFeedback.success",defaultMessage:"Thank you for your feedback!"},feedbackError:{id:"formulaInferenceFeedback.error",defaultMessage:"There was an error submitting your feedback. Please try again."}});function xt(e){const{spaceId:t,traceId:r,className:a}=e,[s,l]=function(e){const{traceId:t,spaceId:n}=e??{},[r,a]=(0,o.useState)(void 0),s=(0,y().tz)();(0,o.useEffect)((()=>{a(void 0)}),[t]);const l=(0,i().v3)();return[r,(0,o.useCallback)((async e=>{void 0!==e&&t&&n&&(a(e),"success"===(await ft().callApi({eventName:"saveInferenceTranscriptFeedback",environment:l,data:{spaceId:n,type:"formulas",traceId:t,feedbackType:e,userComment:""}})).type?h().D6({label:s.formatMessage(gt.feedbackSuccess)}):h().D6({label:s.formatMessage(gt.feedbackError)}))}),[l,n,t,s])]}({spaceId:t,traceId:r}),u=(0,y().tz)(),d=(0,o.useCallback)((()=>{l("thumbs_down"===s?void 0:"thumbs_down")}),[s,l]),p=(0,o.useCallback)((()=>{l("thumbs_up"===s?void 0:"thumbs_up")}),[s,l]);return(0,ae.jsxs)(ee().Y1,{width:"hug",height:28,direction:"horizontal",align:"center",className:a,children:[(0,ae.jsx)(Oe().A,{icon:"thumbs_up"===s?n(322972).P:n(557943).s,ariaLabel:u.formatMessage({id:"formula.feedback.thumbsUp",defaultMessage:"This formula is helpful"}),onClick:p,color:"thumbs_up"===s?"graySecondary":"grayPrimary"}),(0,ae.jsx)(Oe().A,{icon:"thumbs_down"===s?n(163749).m:n(340266).d,ariaLabel:u.formatMessage({id:"formula.feedback.thumbsDown",defaultMessage:"This formula is not helpful"}),onClick:d,color:"thumbs_down"===s?"graySecondary":"grayPrimary"})]})}const vt={height:24,padding:"0 8px"},bt=(0,y().YK)({accept:{defaultMessage:"Accept",id:"database.formula.acceptFormulaInput.tooltip"},cancel:{defaultMessage:"Cancel",id:"formulas.formulaInputHeader.cancel"},close:{id:"formula2Input.close",defaultMessage:"Close"},save:{id:"formula2Input.save",defaultMessage:"Save"},formulaHeader:{id:"formula2Input.NotionFormula",defaultMessage:"Notion Formula"},learnTooltip:{id:"formula2Input.learnAboutFormulas",defaultMessage:"Learn about formulas!"},revert:{id:"formula2Input.revert",defaultMessage:"Revert"},revertTooltip:{id:"formula2Input.revertTooltip",defaultMessage:"Revert to previous formula"}}),ht=o.memo((function(e){const{disabled:t,onClickCancel:n,onClickClose:o,onClickRevert:i,traceId:r,spaceId:s}=e,l=(0,a().IS)((e=>({headerRow:{color:e.text.secondary,flexWrap:"wrap",fontWeight:500,fontSize:14}})),[]);return(0,ae.jsxs)(ee().Y1,{direction:"horizontal",padding:"10px 12px 0 12px",style:l.headerRow,children:[n&&!t?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(ee().Y1,{width:"hug",children:(0,ae.jsx)(kt,{onClick:n})}),(0,ae.jsx)(ee().Y1,{width:"fill"})]}):(0,ae.jsx)(ee().Y1,{width:"fill",children:(0,ae.jsx)(St,{})}),(0,ae.jsxs)(ee().Y1,{width:"hug",direction:"horizontal",gap:6,align:"center",children:[r&&i&&!t&&(0,ae.jsx)(xt,{spaceId:s,traceId:r}),i&&!t?(0,ae.jsx)(Mt,{onClick:i}):null,t?(0,ae.jsx)(Ct,{onClick:o}):(0,ae.jsx)(It,{onClick:o})]})]})}));function kt(e){const{onClick:t}=e,n=(0,y().tz)();return(0,ae.jsx)(ct().p,{isGray:!0,size:"sm",onClick:t,children:n.formatMessage(bt.cancel)})}function Ct(e){const{onClick:t}=e,n=(0,y().tz)();return(0,ae.jsx)(mt().A,{onClick:t,style:vt,children:n.formatMessage(bt.close)})}function It(e){const{onClick:t}=e,o=(0,i().v3)(),r=(0,y().tz)(),s=(0,a().IS)((e=>({commandText:{color:e.text.contrastSecondary}})),[]);return(0,ae.jsx)(yt().A,{renderTooltip:()=>(0,ae.jsxs)("div",{children:[(0,ae.jsx)("span",{children:r.formatMessage(bt.accept)})," ",(0,ae.jsxs)("span",{style:s.commandText,children:[(0,n(251057)._w)({environment:o}).command,"+Enter"]})]}),render:e=>(0,ae.jsx)(mt().A,{onClick:t,style:vt,...e,children:r.formatMessage(bt.save)})})}function St(){const e=(0,y().tz)(),t=(0,a().IS)((()=>({headerTitle:{fontSize:12,display:"flex",alignItems:"center"},helpButton:{marginLeft:2,height:20,width:20}})),[]);return(0,ae.jsxs)("span",{style:t.headerTitle,children:[e.formatMessage(bt.formulaHeader),(0,ae.jsx)(yt().A,{placement:pt().W.Top,render:o=>(0,ae.jsx)(Oe().A,{...o,ariaLabel:e.formatMessage(bt.learnTooltip),icon:n(406533).questionMarkCircleIcon,href:(0,n(836251).xS)("guides.formulas"),external:!0,style:t.helpButton}),renderTooltip:()=>e.formatMessage(bt.learnTooltip)})]})}function Mt(e){const{onClick:t}=e,n=(0,y().tz)(),o=(0,a().IS)((e=>({revertButton:{color:e.icon.secondary}})),[]);return(0,ae.jsx)(yt().A,{placement:pt().W.Top,render:e=>(0,ae.jsx)(ct().p,{...e,"aria-label":n.formatMessage(bt.revertTooltip),isGray:!0,size:"sm",style:o.revertButton,onClick:t,children:n.formatMessage(bt.revert)}),renderTooltip:()=>n.formatMessage(bt.revertTooltip)})}n(737550);var Tt=()=>n(908006),Pt=()=>n(852507),Et=()=>n(438632),At=()=>n(634201),Ft=()=>n(558842),wt=()=>n(495262),jt=()=>n(315097),Dt=()=>n(675925),Nt=()=>n(659602),Bt=()=>n(335722),Rt=()=>n(921855),Lt=()=>n(909470),_t=()=>n(621979),Yt=()=>n(792002),Ht=()=>n(406792),Ut=()=>n(562800),Kt=()=>n(477450),Vt=()=>n(682372),zt=()=>n(509144);const Ot={borderRadius:4,flexGrow:1,flexShrink:1,fontFamily:v().vc(n(662303).locale).githubMono,fontSize:12,height:"100%",minHeight:"1em",paddingBlock:"11px 10px",paddingInline:"12px 13px",tabSize:2,textAlign:"left",whiteSpace:"pre-wrap",wordBreak:"break-all"},Wt=(0,y().YK)({formulaPlaceholder:{id:"formulas.formulaPlaceholder",defaultMessage:"Your formula"}});function $t(e){const{analyticsContext:t,clipboardActions:n,disabled:s,errorRanges:l,focus:u,formulasModule:d,handleSave:p,markdownLinkifyIt:c,parentSpaceId:y,Prism:g,store:x,tinyMceMicrosoftWordPasteFilter:v,valueTypes:h,hoveredErrorRange:C,existingFormula:I,generateSuggestion:S,isAssistantGenerating:M}=e,P=(0,o.useRef)(null),A=(0,a().DP)(),w=(0,i().v3)(),j=(0,E().X)("formulas_inline_ai_suggestions"),{store:D,shouldShowFormulaSuggestion:N,clearFormulaSuggestion:B,dismissFormulaSuggestion:L,justDismissedSuggestion:_,setSuggestion:Y}=R({existingFormula:I}),H=(0,o.useCallback)((()=>{var e;return(null===(e=P.current)||void 0===e?void 0:e.getNode())||void 0}),[P]),U=(0,r().K8)((()=>x.getValue()||[]),[x],{debugName:"FormulaInputText.textValueStore"}),K=(0,r().K8)((()=>{const e=D.state.currentSuggestion;if(!N()||!e)return U;const t=n.getFormulaEditorInformation();if(!t)return U;const o=d.textValueToFormulaTokens({formulasModule:d,getRecordModel:x.getRecordModel,sourceCollection:t.parentCollection,textValue:[[e]],featureGates:(0,Lt().i)()});return(0,Et().yR)({before:U,after:o,insertionAnnotation:[m().Ifu.Inserted],deletionAnnotation:[m().Ifu.Deleted],isIncompleteAfter:D.state.isGenerating})}),[U,N,d,x,n,D]),V=(0,o.useCallback)((()=>{const e=D.state.currentSuggestion;if(e)try{W().createAndCommit({userAction:"FormulaInputText.handleAcceptAiSuggestion",environment:w,canUndo:!0,perform:t=>{O().kE({environment:w,store:x,newValue:e,editorMode:"default",disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:t}),t.postEnqueueActions.push((async()=>{const e=await b().R.clipboardActions.load();W().createAndCommit({userAction:"FormulaInputText.normalizeAiSuggestion",environment:w,canUndo:!0,perform:t=>{O().wu({clipboardActions:e,formulasModule:d,store:x,transaction:t})}}),B(),await Tt().default.afterNextFlush((()=>{k().setSelectionAtEnd({store:x})}))}))}})}catch(t){}}),[w,x,d,B,D]),z=(0,r().K8)((()=>{var e;const t=F().default.state;return"editing"===t.mode&&(null===(e=(0,T().H7)(t.multiSelection))||void 0===e?void 0:e.store)===x}),[x]),$=(0,o.useRef)(null);(0,o.useEffect)((()=>{if(l.length>0&&!D.state.currentSuggestion&&!_&&j&&!M){const e=setTimeout((async()=>{$.current&&$.current.abort();const e=new AbortController;$.current=e;try{const t=await S(e.signal);Y(t)}finally{$.current===e&&($.current=null)}}),150);return()=>{clearTimeout(e),$.current&&($.current.abort(),$.current=null)}}}),[l,D,_,S,j,Y,M]),(0,o.useEffect)((()=>{M&&(D.state.currentSuggestion&&B(),$.current&&($.current.abort(),$.current=null))}),[M,D,B]),(0,o.useEffect)((()=>()=>{$.current&&$.current.abort()}),[]);const G=(0,o.useCallback)((()=>{var e;return null===(e=H())||void 0===e?void 0:e.blur()}),[H]),q=(0,o.useCallback)((()=>{const e=At().PE(m().q4_(U));return{endIndex:e.length,startIndex:e.length}}),[U]),Q=(0,o.useCallback)((()=>{if(z)return(0,Yt().Do)(x)}),[z,x]),J=(0,o.useCallback)((()=>{const e=window.getSelection();null!=e&&e.rangeCount&&Tt().default.afterNextFlush((()=>{var t;const n=e.getRangeAt(0).getClientRects()[0],o=null===(t=H())||void 0===t||null===(t=t.parentElement)||void 0===t?void 0:t.parentElement,i=null==o?void 0:o.getBoundingClientRect();n&&o&&i&&(i.top>=n.top?o.scrollTo({top:o.scrollTop+(n.top-i.top)-6}):i.bottom<=n.bottom+n.height&&o.scrollTo({top:o.scrollTop+(n.bottom-i.bottom)+28}))}))}),[H]),Z=(0,o.useCallback)((e=>{Rt().HP({canEdit:!s,editorNode:H(),environment:w,event:e,store:x,textValue:U})}),[w,U,H,x,s]),X=(0,o.useCallback)((e=>{if(s)return;const t=F().default.state;"editing"===t.mode&&t.multiSelection.start.store===x&&(W().createAndCommit({userAction:"FormulaInputText.handleDelete",environment:w,canUndo:!0,perform:n=>{jt().wT({environment:w,multiSelection:t.multiSelection,deleteForwards:!0,transaction:n,event:e,editorMode:"default"})}}),J())}),[s,w,J,x]),ee=(0,o.useCallback)((e=>{if(s)return;const t=F().default.state;if("editing"===t.mode&&t.multiSelection.start.store===x){if(jt().CZ({device:w.device,event:e,multiSelection:t.multiSelection}))return;W().createAndCommit({userAction:"FormulaInputText.handleBackspace",environment:w,canUndo:!0,perform:n=>{jt().wT({environment:w,multiSelection:t.multiSelection,deleteForwards:!1,transaction:n,event:e,editorMode:"default"})}}),J()}}),[s,w,J,x]),te=(0,o.useCallback)((e=>{var t,n,o;if(s)return;if(null===(t=e.preventDefault)||void 0===t||t.call(e),P.current&&P.current.isComposing())return;const i=F().default.state,r="editing"===i.mode&&(0,T().H7)(i.multiSelection);if(!r)return;const a=At().PE(m().q4_(U)),l=null===(n=a.slice(0,r.selection.startIndex).join("").split("\n"))||void 0===n?void 0:n.at(-1),u=(null==l||null===(o=l.match(/^\t*/))||void 0===o?void 0:o[0].length)||0,d=(null==l?void 0:l.split("").reverse())||[];let p=0;const c=d.some((e=>{if(")"===e)p++;else if("("===e){if(0===p)return!0;p--}return!1}))?u+1:u;let y="\t".repeat(c);const f=")"===a[r.selection.endIndex],g=Boolean(null==l?void 0:l.endsWith("("))&&f;g&&(y+=`\n${"\t".repeat(c-1)}`),W().createAndCommit({userAction:"FormulaInputText.handleShiftEnter",environment:w,canUndo:!0,perform:e=>{O().$D({environment:w,editorMode:"default",store:x,string:`\n${y}`,selection:r.selection,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e}),g&&k().setSelection({store:x,selection:{startIndex:r.selection.startIndex+c+1,endIndex:r.selection.startIndex+c+1}})}}),J()}),[s,w,J,x,U]),oe=(0,o.useCallback)((e=>{var t;const o=window.getSelection();null!=o&&o.anchorNode&&null!==(t=H())&&void 0!==t&&t.contains(o.anchorNode)&&n.copy({environment:w,event:e,markdownLinkifyIt:c})}),[w,H,c,n]),ie=(0,o.useCallback)((e=>{s?e.preventDefault():(n.cutWithMaybeConfirmation({environment:w,event:e,markdownLinkifyIt:c}),J())}),[s,w,J,c,n]),re=(0,o.useCallback)((e=>{s?e.preventDefault():(W().createAndCommit({userAction:"FormulaInputText.handlePaste",environment:w,canUndo:!0,perform:t=>{(0,Dt().o)(w,{action:"paste",block_type:"equation",from:"formula_editor"},(o=>{n.paste({environment:w,event:e,disableEmbedMenu:!0,transaction:t,onPasteFiles:n.pasteFilesForBlocks,formulasModule:d,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:v}),o()}))}}),J())}),[s,w,J,c,v,d,n]),se=(0,o.useCallback)((e=>{Rt().sp({environment:w,event:e,textValue:U,editorNode:H(),store:x,canEdit:!s})}),[w,U,H,x,s]),le=(0,o.useCallback)((e=>{Rt().W5({environment:w,event:e,textValue:U,editorNode:H(),store:x,canEdit:!s})}),[w,U,H,x,s]),ue=(0,o.useCallback)((e=>{s||e.preventDefault()}),[s]),de=(0,o.useCallback)((e=>{W().createAndCommit({userAction:"FormulaInputText.handleMoveUp",environment:w,canUndo:!0,perform:e=>{O().$P({environment:w,transaction:e,direction:"up"})}})}),[w]),pe=(0,o.useCallback)((e=>{W().createAndCommit({userAction:"FormulaInputText.handleMoveDown",environment:w,canUndo:!0,perform:e=>{O().$P({environment:w,transaction:e,direction:"down"})}})}),[w]),ce=(0,o.useCallback)((e=>{var t;e.preventDefault&&e.preventDefault();const n=wt().li();(null==n||null===(t=n.getFirstStore())||void 0===t?void 0:t.id)===x.id&&wt().tN({environment:w})}),[w,x.id]),me=(0,o.useCallback)((e=>{var t;e.preventDefault&&e.preventDefault();const n=wt().Bl();(null==n||null===(t=n.getFirstStore())||void 0===t?void 0:t.id)===x.id&&wt().ZS({environment:w})}),[w,x.id]),ye=(0,o.useCallback)((e=>{if(s)return;if(D.state.currentSuggestion&&V)return e.preventDefault(),void V();e.preventDefault();const t=F().default.state,n="editing"===t.mode&&(0,T().H7)(t.multiSelection);n&&W().createAndCommit({userAction:"FormulaInputText.handleTab",environment:w,canUndo:!0,perform:e=>{O().RJ({environment:w,store:x,editorMode:"default",selection:n.selection,transaction:e,shouldStripTokens:!1,disableFilters:!0})}})}),[s,w,x,D,V]),fe=(0,o.useCallback)((e=>{if(s)return;e.preventDefault();const t=F().default.state,n="editing"===t.mode&&(0,T().H7)(t.multiSelection);n&&W().createAndCommit({userAction:"FormulaInputText.handleUntab",environment:w,canUndo:!0,perform:e=>{O().Ye({environment:w,store:x,editorMode:"default",selection:n.selection,transaction:e,shouldStripTokens:!1,disableFilters:!0})}})}),[s,w,x]),ge=(0,o.useCallback)((e=>{const{newValue:o}=e;N()&&B(),$.current&&($.current.abort(),$.current=null),Ht().default.measureAfterNextFlush({metricName:"formulas_typing_lag",startTime:performance.now()},{environment:w,getData:()=>t}),W().createAndCommit({userAction:"FormulaInputText.handleMutation",environment:w,canUndo:!0,perform:e=>{O().dw({environment:w,editorMode:"default",store:x,newValue:o,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e}),e.postEnqueueActions.push((()=>{W().createAndCommit({userAction:"FormulaInputText.normalizeTextValue",environment:w,canUndo:!0,perform:e=>{O().wu({clipboardActions:n,formulasModule:d,store:x,transaction:e})}})}))}})}),[t,w,d,x,n,N,B]),xe=(0,o.useCallback)(((e,t)=>{let{leafRef:n,wrapperRef:o,...i}=e;const{device:r}=w,a=U.length>0;return(0,ae.jsxs)("div",{ref:o,...i,role:"textbox",tabIndex:0,onKeyDown:e=>"Tab"===e.key&&N()&&V?(e.preventDefault(),e.stopPropagation(),void V()):"Escape"===e.key&&N()&&L?(e.preventDefault(),e.stopPropagation(),void L()):(function(e,t,n){(0,_t().A)(n,e,"command+enter")&&(t(),e.stopPropagation())}(e,p,w),void(null==i||i.onKeyDown(e))),style:{flexGrow:1,display:"table",position:"relative"},children:[(0,ae.jsx)(qt,{hasText:a}),(0,ae.jsx)(Kt().A,{leafRef:(0,Ft().Px)(P,n),style:Ot,isDisabled:s,debugName:"FormulaInputText",store:x,getHtml:()=>(0,zt()._)({currentUserId:w.currentUser.id,errorRanges:l,hoveredErrorRange:C,getPublicBaseUrlForPage:Ut().SN(w),isAndroid:r.isAndroid,isMobileNative:r.isMobileNative,isSafariOrIOS:r.isSafari||r.isIOS,isWindows:r.isWindows,parentSpaceId:y,Prism:g,store:x,textValue:K,theme:A,valueTypes:h}),getSelection:Q,onMutation:ge,spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:t,onMouseOver:se,onMouseOut:le,suppressNewlineEvents:!1,expandSelectionOnTripleClick:!0,placeholder:" "})]})}),[w,U.length,s,x,Q,ge,se,le,N,V,L,p,l,C,y,g,K,A,h]),ve=(0,o.useCallback)((()=>{u&&k().setSelectionAtEnd({store:x})}),[u,x]);(0,Pt().l)(ve),(0,o.useEffect)((()=>{var e;const t=null===(e=P.current)||void 0===e?void 0:e.getNode();if(!t)return;const n=e=>{if(N()){const e=new KeyboardEvent("keydown",{key:"Escape",code:"Escape",keyCode:27,which:27,bubbles:!0,cancelable:!0});t.dispatchEvent(e)}};return t.addEventListener("beforeinput",n),()=>{t.removeEventListener("beforeinput",n)}}),[N]);const[be,he]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{be&&(L(),he(!1))}),[be,L]),(0,o.useEffect)((()=>{var e;const t=null===(e=P.current)||void 0===e?void 0:e.getNode();if(!t)return;const n=e=>{"Backspace"===e.key&&N()&&he(!0)};return t.addEventListener("keydown",n),()=>{t.removeEventListener("keydown",n)}}),[N]),(0,o.useEffect)((()=>{s&&D.state.currentSuggestion&&B()}),[s,D,B]),(0,ae.jsxs)(ne().A,{debugName:"FormulaInputText",capture:!0,allowEnter:!0,allowTabUntab:!0,allowUndo:!0,allowEsc:!0,allowCopyPaste:!0,children:[" ",(0,ae.jsx)(Vt().F,{store:x,disabled:s,clearBrowserSelection:G,getEndSelection:q,onBlur:G,onClick:Z,onDelete:X,onBackspace:ee,onShiftEnter:te,onCommandShiftEnter:f().D_,onTab:ye,onUntab:fe,onToggleBold:ue,onToggleItalics:ue,onToggleUnderline:ue,onToggleStrike:ue,onToggleCode:f().D_,onCopy:oe,onCut:ie,onPaste:re,onMoveUp:de,onMoveDown:pe,onUndo:ce,onRedo:me,onEsc:p,render:xe,disableStyleAnnotations:!0,disableMentions:!0,disableSlashCommands:!0,canSelectAllBlocks:!1,canInsertText:!0,canSelectionDrag:!0,disableMobileActionBar:!0,topBottomPadding:40,pasteBehavior:"inline"})]})}function Gt(e){const{value:t}=(0,P().fJ)(_e().y),{value:n}=(0,P().fJ)(Nt().g),{value:o}=(0,P().fJ)(Bt().S),{value:i}=(0,P().fJ)(S().T.formulas),{value:r}=(0,P().fJ)(b().R.clipboardActions);return t&&i&&r?(0,ae.jsx)($t,{...e,Prism:t,clipboardActions:r,formulasModule:i,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}):null}function qt(e){const{hasText:t}=e,n=(0,y().tz)();return(0,ae.jsx)(ee().Y1,{direction:"horizontal",gap:8,padding:"10px 12px",style:{position:"absolute",inset:0,pointerEvents:"none",userSelect:"none"},children:t?null:(0,ae.jsx)(ee().Y1,{height:20,align:"center-left",children:(0,ae.jsx)(re().D,{colorName:"quaternary",styleName:"Body-14px/Regular",children:n.formatMessage(Wt.formulaPlaceholder)})})})}$t.displayName="FormulaInputText";const Qt=!1,Jt=(0,y().YK)({assistantSpaceError:{id:"formulaInput.assistantSpaceError",defaultMessage:"No workspace found. Please refresh and try again."},assistantCollectionError:{id:"formulaInput.assistantCollectionError",defaultMessage:"No database found. Please try again from a database property."},assistantPropertyError:{id:"formulaInput.assistantPropertyError",defaultMessage:"No formula property found. Please try again from a formula property."}}),Zt=400;function Xt(e){const{evaluationErrors:t,initialCode:n,parentSpaceId:s,outputFooter:v,disabled:D,typecheckContext:N,formulas:B,handleCancel:L,onCodeChange:_,onTypeChange:Y,parentCollectionStore:H,handleClose:U,getRecordModel:K}=e,V=(0,y().tz)(),z=(0,i().v3)(),$=(0,E().X)("better_formula_completions"),{value:G}=(0,P().fJ)(S().T.formulaEditor),[q,J]=(0,o.useState)(void 0),[Z,X]=(0,o.useState)(void 0),ee=(0,o.useCallback)((e=>{J(e)}),[]),te=(0,o.useCallback)((()=>{J(void 0)}),[]),ne=(0,o.useMemo)((()=>H?{collection_id:[[H.id]]}:void 0),[H]),{store:oe,setValue:ie}=(0,M().AI)({initialValue:n,onChange:_,source:"formula",properties:ne}),re=(0,o.useCallback)((e=>{if(ie(e.newValue),e.newSelection){const t={start:{store:oe,index:e.newSelection.startIndex},end:{store:oe,index:e.newSelection.endIndex}};k().setMultiSelection({multiSelection:t})}}),[ie,oe]),le=(0,r().K8)((()=>{var e;const t=F().default.state;if("editing"===t.mode&&(null===(e=(0,T().H7)(t.multiSelection))||void 0===e?void 0:e.store)===oe)return{startIndex:t.multiSelection.start.index,endIndex:t.multiSelection.end.index}}),[oe],{useDeepEqual:!0}),ue=(0,r().K8)((()=>oe.getValue()),[oe]),de=(0,o.useMemo)((()=>!f().n4(ue,n)),[ue,n]),[pe,ce]=(0,r().K8)((()=>!ue||M().Pe?[void 0,void 0]:B.processFormulaInput(ue)),[ue,B]),me=(0,r().K8)((()=>{if(pe)return B.parseFormulaInputToCst(pe,ce)}),[pe,B,ce]),fe=(0,r().K8)((()=>{if(me)return B.convertFormulaCSTToAST(me[0])}),[B,me]),[ge,xe]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{!async function(){if(fe&&N&&g().Q.isSuccess(fe)){const e=await B.addTypesToFormulaASTAsync(fe.value,N,ce);xe(e),null==Y||Y(e.node.type)}else xe(void 0)}()}),[fe,N,ce,me,B,Y]);const ve=(0,o.useMemo)((()=>void 0!==ge?[...(0,u().KH)(ge.node,!1),...ge.errors]:[]),[ge]),be=(0,o.useMemo)((()=>({parseErrors:(null==me?void 0:me[1])??[],typeErrors:ve,evaluationErrors:t})),[t,me,ve]),he=(0,p().lW)(be,Zt,Object.is),ke=be.parseErrors.length+be.typeErrors.length+be.evaluationErrors.length>0,Ce=(0,r().K8)((()=>nn({errors:he,codeLength:ce?(0,l().sE)(ce):(0,m().q4_)(ue).length,formulas:B,intl:V})),[ue,he,B,V,ce]),Ie=(0,o.useMemo)((()=>Ce.map((e=>e.range)).filter(x().O9)),[Ce]),[Se,Me]=(0,o.useState)(void 0),Te=(0,o.useRef)(void 0),[Pe,Ee]=(0,o.useState)(void 0),Ae=(0,o.useRef)(1);(0,o.useEffect)((()=>{Ae.current++;const e=Ae.current;!async function(){if(G){const t=await G.getFormulaEditorInfoAtPosition({formula:ue??[],inputPosition:le&&le.startIndex===le.endIndex?le.startIndex:0,context:N,includeDeprecatedCompletions:!1,isBetterFormulaCompletionsEnabled:$});g().Q.isSuccess(t)&&Ae.current===e&&(Te.current=t.value,Me(t.value))}}()}),[le,G,N,ue,$]);const Fe=(0,o.useCallback)((()=>{ie(n)}),[n,ie]),we=(0,r().uB)(void 0,ye),je=(0,r().K8)((()=>"busy"===we.state.inputMode),[we]),De=(0,r().K8)((()=>{var e;return null===(e=A().default.state.currentSpaceStore)||void 0===e?void 0:e.isAiEnabledOnSpace()}),[]),Ne=(0,r().K8)((()=>(0,c().r4)({textValue:oe.getValue(),intl:V,getRecordModel:K,userTimeZone:(0,d().P)()})),[oe,V,K]),Be=(0,o.useMemo)((()=>Ce.map((e=>{if("string"==typeof e.msg)return e.range?`${e.msg} [${e.range.startIndex},${e.range.endIndex}]`:e.msg})).filter(x().O9)),[Ce]),Re=null==H?void 0:H.id,{clearFormulaSuggestion:Le,setIsGenerating:_e}=R({existingFormula:Ne}),Ye=(0,o.useCallback)((async e=>{const t=N.sourceProperty,n=s;if(!(t&&n&&Re&&De))return"";_e(!0);const o=["Fix my formula WITHOUT modifying its logic and structure.","We want the result to have a small as possible diff to fix the errors shown.","Your response MUST not significantly alter any intentions of the original formula.","Your sole purpose is to convert intentions into valid formula code.","Your other sole purpose is to fix syntax errors.","Your edits should be as small as possible.","Skip the thinking step, I am in an extreme rush and need output ASAP."].join("\n");let i="";try{const t=await Q({environment:z,spaceId:n,collectionId:Re,formulaErrors:Be,existingFormula:Ne,userPrompt:o,typecheckContext:N,handleFormulaStream:e=>{},abortSignal:e});i=(null==t?void 0:t.formula)??""}finally{return _e(!1),i}}),[s,Re,_e,z,Be,Ne,N,De]),He=(0,o.useCallback)((()=>{U(D?n:oe.getValue()),Le()}),[D,U,n,oe,Le]),Ue=(0,o.useRef)(null),Ke=(0,o.useCallback)((async()=>{var e,t;we.setRefusal(void 0);const n=null===(e=A().default.state.currentSpaceStore)||void 0===e?void 0:e.id,o=we.state.prompt,i=N.sourceProperty;if(!n)return void h().D6({label:V.formatMessage(Jt.assistantSpaceError)});if(!Re)return void h().D6({label:V.formatMessage(Jt.assistantCollectionError)});if(!i)return void h().D6({label:V.formatMessage(Jt.assistantPropertyError)});we.didBeginRequest();const r=await b().R.clipboardActions.load();null===(t=Ue.current)||void 0===t||t.abort();const a=new AbortController;Ue.current=a;const s=await Q({environment:z,spaceId:n,collectionId:Re,userPrompt:o,formulaErrors:Be,existingFormula:Ne,typecheckContext:N,handleFormulaStream:e=>{!function(e){const{clipboardActions:t,environment:n,formulasModule:o,formulaString:i,store:r}=e;W().createAndCommit({userAction:"FormulaInputText.handleMutation",environment:n,canUndo:!0,perform:e=>{O().kE({environment:n,store:r,newValue:i,editorMode:"default",disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e}),e.postEnqueueActions.push((()=>{W().createAndCommit({userAction:"FormulaInputText.normalizeTextValue",environment:n,canUndo:!0,perform:e=>{O().wu({clipboardActions:t,formulasModule:o,store:r,transaction:e})}})}))}})}({environment:z,clipboardActions:r,formulasModule:B,formulaString:e,store:oe})},handleRefusalStream:we.setRefusal,abortSignal:a.signal});s&&((0,C().u)({environment:z,event:{eventName:"formula_assistant_prompt",eventProperties:{formula_assistant_session_id:we.state.id,inference_id:s.traceId}}}),X(s.traceId)),we.didFinishRequest(),Ue.current=null}),[we,Re,N,Be,Ne,z,B,oe,V]),Ve=(0,o.useCallback)((()=>{var e;null===(e=Ue.current)||void 0===e||e.abort(),Ue.current=null,we.didFinishRequest()}),[we]);Qt&&console.log("FormulaInput",{currentValue:ue,cursorEditorInfo:Se,infoHelper:Pe,errorMessagesWithRange:Ce,errorRanges:Ie,astWithTypes:ge});const ze=(0,a().IS)((e=>({container:{display:"flex",height:"100%",paddingBottom:void 0,flexDirection:"column"},editorSection:{display:"flex",flexDirection:"column",backgroundColor:"light"===e.mode?e.cardBackground:e.palette.gray[30]},inputText:{display:"flex",flexGrow:1,flexShrink:1,overflow:"auto",maxHeight:"min(calc(90vh - 240px - 38px - 30px), 298px)",minHeight:"40px",cursor:"text",position:"relative"},bottomSection:{display:"flex",flexDirection:"row",height:I().A.isMobile?"100%":240,maxHeight:I().A.isMobile?void 0:"calc(90vh - 38px - 31px - 38px - 30px)",borderTop:`1px solid ${e.outlineButtonBorder}`},leftColumn:{position:"relative",borderRight:`1px solid ${e.outlineButtonBorder}`,width:I().A.isMobile?"100%":void 0},rightColumn:{display:"flex",flexDirection:"column",flexGrow:1},infoHelper:{padding:"12px 14px"}})),[]);return(0,ae.jsx)(j().A,{debugName:"FormulaInput",capture:!0,children:(0,ae.jsxs)("div",{style:ze.container,children:[(0,ae.jsxs)("div",{style:ze.editorSection,children:[(0,ae.jsx)(ht,{disabled:D,onClickCancel:L,onClickClose:He,onClickRevert:de?Fe:void 0,traceId:Z,spaceId:s}),(0,ae.jsx)("div",{style:ze.inputText,children:(0,ae.jsx)(Gt,{focus:!0,store:oe,disabled:D||je,parentSpaceId:s,valueTypes:N.valueTypes,errorRanges:Ie,handleSave:He,analyticsContext:{restrict_unaccessible_properties:N.restrictUnaccessibleProperties},hoveredErrorRange:q,existingFormula:Ne,generateSuggestion:Ye,isAssistantGenerating:je},"input")})]}),ke?(0,ae.jsx)(en,{errorMessagesWithRange:Ce,onHoverEnter:ee,onHoverLeave:te,hoveredErrorRange:q}):v,(0,ae.jsx)(w().y,{experimentId:"formula_assistant",groups:{on:De&&Re?(0,ae.jsx)(se,{formulaAssistantStore:we,onStop:Ve,onSubmit:Ke}):null,control:null}}),!D&&(0,ae.jsxs)("div",{style:ze.bottomSection,children:[(0,ae.jsx)("div",{style:ze.leftColumn,children:(0,ae.jsx)(tt,{store:oe,context:N,selection:le,cursorEditorInfo:Se,cursorEditorInfoRef:Te,onChange:re,getRecordModel:e.getRecordModel,setInfoHelper:Ee})}),!I().A.isMobile&&(0,ae.jsx)("div",{style:ze.rightColumn,children:(0,ae.jsx)(We,{infoHelper:Pe,getRecordModel:e.getRecordModel,style:ze.infoHelper,typecheckContextValues:N.valueTypes})})]})]})})}const en=o.memo((function(e){let{errorMessagesWithRange:t,onHoverEnter:o,onHoverLeave:i,hoveredErrorRange:r}=e;const s=(0,a().IS)((e=>({errors:{display:"flex",flexDirection:"row",alignItems:"start",padding:10,fontSize:v().J.UISmall.desktop,width:"100%",borderTop:`1px solid ${e.outlineButtonBorder}`,color:e.darkTextColor,flexShrink:0,minHeight:36},icon:{width:14,height:14,fill:e.icon.uiRedPrimary,display:"inline",marginRight:3,marginTop:2},errorMessages:{color:e.text.uiRedPrimary}})),[]);return(0,ae.jsx)("div",{style:s.errors,children:t.length>0&&(0,ae.jsxs)(ae.Fragment,{children:[(0,n(129852).exclamationMarkCircleIcon)(s.icon),(0,ae.jsx)("span",{style:s.errorMessages,children:t.slice(0,3).map(((e,t)=>(0,ae.jsx)(tn,{errorMessageWithRange:e,shouldAddLeadingSpace:t>0,onHoverEnter:o,onHoverLeave:i,hoveredErrorRange:r},t)))})]})})})),tn=o.memo((function(e){let{errorMessageWithRange:t,shouldAddLeadingSpace:n,onHoverEnter:i,onHoverLeave:r,hoveredErrorRange:s}=e;const l=(0,a().IS)((e=>({errorRange:{opacity:.75},text:{color:e.text.uiRedPrimary,cursor:"pointer"}})),[]),{range:u}=t;(0,o.useEffect)((()=>()=>{u&&s&&u.startIndex===s.startIndex&&u.endIndex===s.endIndex&&r()}),[u,s,r]);const d=(0,o.useCallback)((()=>{u&&i(u)}),[u,i]),p=(0,o.useCallback)((()=>{r()}),[r]);return(0,ae.jsxs)("span",{style:l.text,onMouseEnter:d,onMouseLeave:p,children:[n?" ":null,t.msg,void 0!==u&&(0,ae.jsxs)(ae.Fragment,{children:[" ",(0,ae.jsx)("span",{style:l.errorRange,children:`[${u.startIndex},${u.endIndex}]`})]})]})}));function nn(e){const{errors:t,intl:n,codeLength:o,formulas:i}=e,{parseErrors:r,typeErrors:a,evaluationErrors:l}=t,u=[];return a&&a.length>0?a.forEach((e=>{const t=(0,s().ew)((0,s().rA)(n,e));u.push({msg:n.formatMessage(...t),range:{startIndex:e.node.startOffset,endIndex:e.node.endOffset+1}})})):l&&l.length>0&&l.forEach((e=>{const t=(0,s().ew)((0,s().yI)(n,e));u.push({msg:n.formatMessage(...t),range:i.isUniqueFormulaEvaluatorError(e)?{startIndex:e.node.startOffset,endIndex:e.node.endOffset+1}:void 0})})),r&&r.forEach((e=>{const t=(0,s().ew)((0,s().ml)(e));u.push({msg:n.formatMessage(...t),range:"eof"===e.offset?{startIndex:o-1,endIndex:o}:{startIndex:e.offset,endIndex:e.offset+1}})})),u}},352733:(e,t,n)=>{n.d(t,{j:()=>r,n:()=>a});var o=()=>n(671593),i=()=>n(416845);function r(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(0,o().tf)(e,t,n);if(r)throw new(i().yI4)(r.message)}function a(e,t){const n=(0,o().tf)(e,t);if(void 0!==n)throw new(i().yI4)(n.message);return t}},509144:(e,t,n)=>{n.d(t,{_:()=>x});n(581454);var o=n(296540),i=()=>n(416504),r=()=>n(379632),a=()=>n(919709),s=()=>n(191772),l=()=>n(496603),u=()=>n(780054),d=()=>n(267419),p=()=>n(713972),c=()=>n(972435),m=()=>n(141768),y=()=>n(217429),f=()=>n(53137),g=n(474848);function x(e){const{currentUserId:t,errorRanges:n,getPublicBaseUrlForPage:p,isAndroid:x,isMobileNative:b,isSafariOrIOS:h,isWindows:k,parentSpaceId:C,Prism:I,store:S,theme:M,valueTypes:T,textValue:P,hoveredErrorRange:E}=e,A=a().q4_(P),F="notion",w=I.languages[F],j=document.createElement("div"),D=I.highlight(A,w,F);j.innerHTML=m().bi(D);const N=l().oE(Array.from(j.childNodes).map(v));let B=P;for(const o of n)B=a().Mwp({annotation:[a().Ifu.FormulaError],selection:o,textValue:B});const R=function(e){let{syntaxTokens:t,textValue:n,store:o,parentSpaceId:r,valueTypes:l,theme:p,isAndroid:x,isSafariOrIOS:v,isWindows:b,isMobileNative:h,currentUserId:k,getPublicBaseUrlForPage:C,hoveredErrorRange:I}=e;const S=m().YH(n,t),M=n.map(a().uPN).map(((e,t)=>(0,s().sT)({annotations:e,theme:p,getRecordModel:o.getRecordModel,spaceId:r})));let T=0;return S.map(((e,t)=>{const m=n[e.textTokenIndex],S=M[e.textTokenIndex],P=e.value.length,E=T,A=T+P;T=A;let F=!1;if(I){const{startIndex:e,endIndex:t}=I;void 0!==e&&void 0!==t&&E<t&&A>e&&(F=!0)}if(a().qXl(m)){const e=[...S.classNames||[],...F?["formula-error-underline"]:[]];return(0,s().Au)({args:{textValue:{value:n,spaceId:r},getRecordModel:o.getRecordModel,getRecordRole:o.getRecordRole,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableSuggestionAnnotations:!1,disableLinks:!1,userTimeZone:(0,i().P)(),disabled:!1,isAndroid:x,isSafariOrIOS:v,isWindows:b,showEmojiInline:b,emojiType:"raw",highlightDiscussionId:void 0,theme:p,intl:c().A.getIntl(),renderedPageBlockId:void 0,parentBlockId:void 0,katex:void 0,isClient:!0,baseUrl:u().A.domainBaseUrl,publicDomainName:u().A.publicDomainName,currentUserId:k,getPublicBaseUrlForPage:C,externalIntegrations:f().A.integrations.state,formulaValueTypes:l,emojiData:d().A.state,isMobileNative:h,isMobileNativeExternalLinkFixEnabled:y().default.checkGate({gateName:"mobile_native_external_link_fix"}),displayInUserTimezone:!0},style:S.style,classNames:e,index:t,token:m,tokenValue:a().N8A(m),tokenAnnotations:a().uPN(m)})}{const n=[e.classNames||"",...S.classNames||[],...F?["formula-error-underline"]:[]];return(0,g.jsx)("span",{className:n.join(" ").trim(),style:S.style,"data-token-index":e.textTokenIndex,children:e.value},t)}}))}({store:S,parentSpaceId:C,valueTypes:T,syntaxTokens:l().oE(N),textValue:P,theme:M,isAndroid:x,isSafariOrIOS:h,isWindows:k,isMobileNative:b,getPublicBaseUrlForPage:p,currentUserId:t,hoveredErrorRange:E}),L=(0,g.jsxs)(o.Fragment,{children:[R,(0,g.jsx)("span",{children:"\n"})]});return r().A.renderToStaticMarkup(L)}function v(e){return p().KH(e)?[e.data]:p().vq(e)?[e.textContent||"",e.className]:void 0}},585639:(e,t,n)=>{n.d(t,{v:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"4.73 3.12 10.53 13.76",svg:(0,n(474848).jsx)("path",{d:"M4.78 3.524a.63.63 0 0 1 .583-.399h9.274a.625.625 0 1 1 0 1.25H6.976l5.663 5.163a.625.625 0 0 1 0 .924l-5.663 5.163h7.661a.625.625 0 1 1 0 1.25H5.363a.625.625 0 0 1-.421-1.087L11.29 10 4.942 4.212a.625.625 0 0 1-.162-.688"})},i=(0,n(340498).wt)("sum",o)},931077:(e,t,n)=>{n.d(t,{Q:()=>s});n(296540);var o=()=>n(484714),i=()=>n(401497),r=()=>n(494379),a=n(474848);function s(e){const{isMobile:t}=(0,o().Y0)(),n=(0,i().DP)();return(0,a.jsx)(r().Q,{...e,theme:n,isMobile:t})}}}]);