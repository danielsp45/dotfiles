"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[25497,25700,61660,70593,75078,75681],{369:(e,t,n)=>{n.d(t,{R:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("eyeHide",{viewBox:"0 0 16 12",svg:(0,o.jsx)("path",{d:"M12.2754 10.9346L3.08545 1.76074C2.91895 1.59424 2.91895 1.3042 3.08545 1.1377C3.25732 0.96582 3.53662 0.971191 3.7085 1.1377L12.8931 10.3169C13.0649 10.4888 13.0703 10.752 12.8931 10.9346C12.7212 11.1172 12.4473 11.1064 12.2754 10.9346ZM8 1.44922C12.4526 1.44922 15.4067 5.02637 15.4067 6.13281C15.4067 6.76123 14.4346 8.20605 12.7588 9.31787L11.8618 8.41553C13.167 7.58301 13.978 6.54102 13.978 6.13281C13.978 5.50977 11.3516 2.62012 8 2.62012C7.43066 2.62012 6.9043 2.70068 6.39404 2.84033L5.42188 1.86816C6.21143 1.61035 7.06006 1.44922 8 1.44922ZM8 10.811C3.60645 10.811 0.587891 7.22852 0.587891 6.13281C0.587891 5.48828 1.6084 4.0166 3.33789 2.89404L4.25635 3.8125C2.87598 4.67725 2.0166 5.77832 2.0166 6.13281C2.0166 6.87402 4.64307 9.64014 8 9.64014C8.6123 9.64014 9.18701 9.54883 9.73486 9.39307L10.707 10.3652C9.88525 10.6445 8.98291 10.811 8 10.811ZM10.6211 7.06201L7.06543 3.50635C7.35547 3.38818 7.66699 3.32373 8 3.32373C9.55762 3.32373 10.8145 4.56445 10.8145 6.12744C10.8145 6.45508 10.7446 6.77734 10.6211 7.06201ZM8 8.93652C6.43164 8.93652 5.18555 7.6582 5.18018 6.13281C5.18018 5.75146 5.26074 5.39697 5.41113 5.08008L9.04199 8.70557C8.7251 8.85059 8.37598 8.93652 8 8.93652Z"})})},6027:(e,t,n)=>{n.d(t,{F:()=>Y});var o=()=>n(662303),i=()=>n(825237),r=()=>n(945778),a=()=>n(142748),s=()=>n(919709),l=()=>n(751735),d=()=>n(496603),c=()=>n(284371),u=()=>n(780054),p=()=>n(972435),m=()=>n(108944),g=()=>n(613735),f=()=>n(337567),h=()=>n(896628),v=()=>n(751156),y=()=>n(892632);const b=630,S=1200,x=(0,n(381349).O4)({theme:"light"}),A=240,M="white",w=200,k=96,j=150,C=184,I=100,T=145,_=23,P=347,B=24,L=100,R=100,D=100,N="black",O=96,E=68,U=x.text.tertiary,F=40,V=(0,n(959013).YK)({builtWithNotion:{id:"socialMediaPreview.madeWithNotion",defaultMessage:"Made with Notion"}}),z='"Apple Color Emoji","Segoe UI Emoji",NotoColorEmoji,"Noto Color Emoji","Segoe UI Symbol","Android Emoji",EmojiSymbols';function K(e){return new Promise(((t,n)=>{const o=new Image;o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.src=e}))}function W(e,t){return`${c().Wy.bold} ${t}px ${c().xf({pageFont:e,locale:o().locale})}`}function H(e){const t=c().Wy.medium,n=c().xf({pageFont:e,locale:o().locale});return`${t} ${F}px ${n}`}function G(e){let{context:t,text:n,font:o,color:i,x:r,y:a}=e;t.font=o,t.textAlign="left",t.textBaseline="top",t.fillStyle=i,t.fillText(n,r,a)}async function Y(e){var t;let{store:n,environment:o}=e;if(n.pathIsDead()||!(0,a().ot)(m().E(n))||(0,f().dL)(n)||n.inMemoryRecordCache.recordHasOverride({pointer:n.pointer,userId:o.currentUser.id}))return;const c=s().q4_(n.getTitleValue())||"",F=null===(t=n.getIcon())||void 0===t?void 0:t.icon,Y=function(e,t){var n;const o=null===(n=t.getCover())||void 0===n?void 0:n.cover;if(o)return i().wY({url:o,width:S,permissionRecord:t.pointer,stripGoogleIconQuery:!0,baseUrl:u().A.domainBaseUrl,fullyQualified:!1,userId:e.currentUser.id})}(o,n),q=n.getFormat(),$=new OffscreenCanvas(S,b),Q=$.getContext("2d"),[Z,X]=function(e,t){const n=document.createElement("div");n.style.width="auto",n.style.position="absolute",n.style.whiteSpace="nowrap",n.style.font=W(t,O),n.style.top="110vh",n.innerText=e;const o=S-L-R,i=document.body;if(i.appendChild(n),n.clientWidth<o)return i.removeChild(n),[e,O];if(n.style.font=W(t,E),n.clientWidth<o)return i.removeChild(n),[e,E];let r=e;for(;n.clientWidth>o;)r=r.substring(0,r.length-1),n.innerText=`${r}…`;return i.removeChild(n),[`${r}…`,E]}(c,q.page_font),J=W(q.page_font,X),ee=P+(F?_:0),te=ee+B+X;if(Q){!function(e){e.fillStyle=M,e.fillRect(0,0,S,b)}(Q),await async function(e){let{context:t,coverImageUrl:n,icon:o,coverPosition:i=.5}=e;if(n){const e=await K(n),o=e.width*(A/S),r=((0,d().Et)(i)?1-i:.5)*(e.height-o);t.drawImage(e,0,r,e.width,o,0,0,S,A)}else{const e=(0,g().b)({icon:o,theme:x}),n=e?(0,l().X4)(e,.1):x.home.cards.coverPhoto.base;t.fillStyle=n,t.fillRect(0,0,S,A),t.fillStyle="rgb(0,0,0,1)"}}({context:Q,coverImageUrl:Y,icon:F,coverPosition:q.page_cover_position}),await async function(e){let{context:t,store:n,icon:o}=e;if(o)if((0,r().A)(o))t.font=`${w}px ${z}`,t.textAlign="left",t.textBaseline="top",t.fillText(o,k,j);else{const e=i().wY({url:o,baseUrl:u().A.domainBaseUrl,fullyQualified:!0,permissionRecord:n.pointer,width:C,userId:void 0}),r=await K(e);t.drawImage(r,I,T,C,C)}}({context:Q,store:n,icon:F}),G({context:Q,text:Z,font:J,color:N,x:L,y:ee}),G({context:Q,text:p().A.formatMessage(V.builtWithNotion),font:H(q.page_font),color:U,x:D,y:te});const e=await $.convertToBlob();!function(e){let{store:t,file:n,environment:o}=e;y().QM({environment:o,file:n,bucket:"secure",record:t.pointer,isFileBlock:!1,onComplete:e=>{v().createAndCommit({userAction:"SocialMediaPreviewImageUploadStore.updateSocialMediaPreviewImage",environment:o,canUndo:!1,perform:n=>{h().lm({store:t,url:e,transaction:n})}})},retryWhenOffline:!0})}({store:n,environment:o,file:new File([e],"SocialMediaPreviewImage.png",{type:"image/png"})})}}},26517:(e,t,n)=>{n.d(t,{Wf:()=>h,YB:()=>g,aj:()=>f,f3:()=>y,qg:()=>v});n(898992),n(354520),n(581454),n(296540);var o=()=>n(401497),i=()=>n(651124),r=()=>n(959013),a=()=>n(449195),s=()=>n(722872),l=()=>n(760217),d=()=>n(928600),c=()=>n(939740),u=()=>n(89924),p=()=>n(74263),m=n(474848);function g(e){const{currentVisibility:t,propertySchema:n,onSelect:o,onClose:s}=e;let l=[...i().vj];l=l.filter((e=>"section"!==e)),(0,a()._f)({propertySchema:n})||(l=l.filter((e=>"hide_if_empty"!==e)));const d=l.map((e=>({visibility:e,label:(0,m.jsx)(r().sA,{...p().gY[e]})})));return(0,m.jsx)(b,{currentVisibility:t,visibilityLevelsWithLabels:d,onSelect:o,onClose:s})}function f(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,i=(0,a().SB)(t),s=["always_show","section_collapsed","section_hide"].map((e=>({visibility:e,label:(0,m.jsx)(r().sA,{...p().vG[e]})})));return(0,m.jsx)(b,{currentVisibility:i,visibilityLevelsWithLabels:s,onSelect:n,onClose:o})}function h(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,a=i().OA.filter((e=>"section_hide"!==e)).map((e=>({visibility:e,label:(0,m.jsx)(r().sA,{...p().wV[e]})}))),s="section_hide"===t?void 0:t;return(0,m.jsx)(b,{currentVisibility:s,visibilityLevelsWithLabels:a,onSelect:n,onClose:o})}function v(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,a=i().qG.filter((e=>"section_collapsed"!==e)).map((e=>({visibility:e,label:(0,m.jsx)(r().sA,{...p().Bb[e]})}))),s="section_collapsed"===t?"section_show":t;return(0,m.jsx)(b,{currentVisibility:s,visibilityLevelsWithLabels:a,onSelect:n,onClose:o})}function y(e){const{currentVisibility:t,onSelect:n,onClose:o}=e,a=i().RL.map((e=>({visibility:e,label:(0,m.jsx)(r().sA,{...p().PP[e]})})));return(0,m.jsx)(b,{currentVisibility:t,visibilityLevelsWithLabels:a,onSelect:n,onClose:o})}function b(e){const{currentVisibility:t,visibilityLevelsWithLabels:n,onSelect:o,onClose:i}=e,r=n.map((e=>{let{visibility:n,label:r}=e;return{key:n,render:e=>(0,m.jsx)(S,{buttonMenuItemProps:e,isChecked:n===t,label:r}),action:()=>{o(n),i&&i()}}})),a=[{key:"visibilityLevels",render:e=>(0,m.jsx)(u().A,{...e,topBorder:0!==e.index}),items:r}],l={menuType:s().gu.Popup,width:"auto",maxWidth:360};return(0,m.jsx)(d().A,{...l,children:(0,m.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:void 0,sections:a})})}function S(e){const{buttonMenuItemProps:t,label:n,isChecked:i}=e,r=(0,o().IS)((()=>({title:{display:"flex",alignItems:"center",width:150}})),[]),a=(0,m.jsx)("div",{style:r.title,children:n});return(0,m.jsx)(l().A,{...t,textWrapperStyle:{marginRight:0},title:a,isChecked:i})}},31902:(e,t,n)=>{n.d(t,{A:()=>r});n(296540);var o=()=>n(959013),i=n(474848);const r=function(e){let{collectionViewName:t,collectionViewType:r}=e;return t?(0,i.jsx)(n(288722).A,{children:t}):"page"===r?(0,i.jsx)(o().sA,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,i.jsx)(o().sA,{...n(403905).X[r]})}},41432:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const i=new o},64901:(e,t,n)=>{n.d(t,{A:()=>i});n(296540);var o=n(474848);const i=function(e){const t=(0,n(484714).v3)(),i=(0,n(401497).DP)();return(0,o.jsx)(n(187485).A,{style:{display:"flex",alignSelf:"stretch",width:36,...e.isRight?{marginRight:-8}:{marginLeft:-8}},external:!0,href:e.href,onClick:()=>n(148024).FH(t,{from:e.analyticsFrom}),children:(0,o.jsx)(n(704152).A,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,n(133033).$)({width:18,marginTop:1,fill:i.icon.tertiary})})})}},70463:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});n(898992),n(941795);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(133033),l=()=>n(427704),d=()=>n(959013),c=()=>n(381349),u=()=>n(284371),p=()=>n(449506),m=()=>n(186445),g=()=>n(404141),f=()=>n(446242),h=()=>n(623580),v=()=>n(204063),y=()=>n(719147),b=n(474848);const S={padding:"24px 36px 24px",minWidth:300,maxWidth:400},x=n(757695).Store.createClass(void 0,{name:"PromoErrorStore"});const A=function(){const e=(0,r().K8)((()=>f().A.state.open),[]);return(0,b.jsx)(n(676007).a,{open:e,innerStyle:S,preventHideChildrenWhileOpening:!0,render:()=>(0,b.jsx)(I,{}),onDismiss:w})};function M(){const e=(0,a().DP)();return(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",color:e.text.tertiary,borderTop:`1px solid ${e.regularDividerColor}`,paddingTop:14},children:[(0,s().$)({width:14,marginTop:1,marginRight:6,fill:e.icon.tertiary})," ",(0,b.jsx)("div",{children:(0,b.jsx)(d().sA,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,b.jsx)(y().A,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function w(){f().A.setState({open:!1})}function k(){w(),g().A.setState({open:!0,openedFrom:"student_not_eligible_modal",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function j(){const e=(0,a().DP)(),t=(0,i().v3)(),n=(0,r().K8)((()=>(0,m()._m)(t)),[t]),o=(0,r().K8)((()=>null==n?void 0:n.getEmail()),[n]);return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:e.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:e.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,b.jsx)("div",{style:{fontWeight:u().Wy.medium,marginTop:0},children:o}),(0,b.jsx)("div",{style:{color:e.text.secondary,marginTop:4},children:(0,b.jsx)(d().sA,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,b.jsx)(v().A,{style:{marginTop:12},onClick:k,size:"lg",children:(0,b.jsx)(d().sA,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}function C(){const e=(0,d().tz)(),t=(0,a().DP)(),n=(0,i().v3)(),s=(0,r().uB)(void 0,x),[l,u]=(0,o.useState)(""),m=(0,o.useCallback)((()=>async function(e,t,n,o){if(n){const i=await p().callApi({eventName:"getPromoCode",environment:e,data:{code:n}});"failed"!==i.type&&i.data.promo?f().A.state.open&&(await f().A.state.handlePromoCode(n),w()):o.setState(t.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:n}))}}(n,e,l,s)),[n,e,l,s]),g=(0,o.useCallback)((e=>function(e,t,n){t(e.target.value.toUpperCase()),n.setState(void 0)}(e,u,s)),[u,s]),y=(0,r().O$)(s),S=e.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,b.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,b.jsx)("div",{style:{width:18,flexShrink:0,color:t.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,b.jsxs)("div",{style:{flexGrow:1},children:[(0,b.jsx)("div",{style:{color:t.text.secondary},children:(0,b.jsx)(d().sA,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,b.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,b.jsx)(h().A,{style:{marginRight:8,height:32},value:l,onChange:g,onSubmit:m,placeholder:S}),(0,b.jsx)(v().A,{onClick:m,disabled:!l,size:"lg",children:(0,b.jsx)(d().sA,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,b.jsx)("div",{style:{color:c().Ay.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:y})]})]})}function I(){return(0,b.jsxs)("div",{style:{fontSize:14},children:[(0,b.jsx)("div",{children:(0,b.jsx)(d().sA,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,b.jsx)("br",{}),p:e=>(0,b.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:o.Children.toArray(e)}),pricinglink:e=>(0,b.jsx)(y().A,{external:!0,href:l().eR.pricing,children:e})}})}),(0,b.jsx)(j,{}),(0,b.jsx)(C,{}),(0,b.jsx)(M,{})]})}},74263:(e,t,n)=>{n.d(t,{Bb:()=>r,PP:()=>s,gY:()=>m,vG:()=>d,wV:()=>u});var o=()=>n(959013);const i=(0,o().YK)({expanded:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),r={section_show:i.expanded,section_collapsed:i.expanded,section_hide:i.off},a=(0,o().YK)({default:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimal:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"}}),s={inline:a.default,minimal:a.minimal},l=(0,o().YK)({showOnHover:{id:"visibilityLevelMessages.backlinksPageSection.showOnHover",defaultMessage:"Show on hover"},alwaysShow:{id:"visibilityLevelMessages.backlinksPageSection.alwaysShow",defaultMessage:"Always show"},off:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"}}),d={always_show:l.alwaysShow,section_show:l.showOnHover,section_collapsed:l.showOnHover,section_hide:l.off,inline:l.off,minimal:l.off},c=(0,o().YK)({asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},minimal:{id:"visibilityLevelMessages.propertyPageSection.minimal",defaultMessage:"Minimal"}}),u={inline:c.asPageSection,minimal:c.minimal},p=(0,o().YK)({alwaysShow:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},alwaysHide:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hideWhenEmpty:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},asPageSection:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"}}),m={show:p.alwaysShow,hide:p.alwaysHide,hide_if_empty:p.hideWhenEmpty,section:p.asPageSection}},74355:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(334261),s=()=>n(377586),l=()=>n(765957),d=()=>n(796249),c=()=>n(712505),u=()=>n(401497),p=()=>n(651124),m=()=>n(390066),g=()=>n(142015),f=()=>n(49621),h=()=>n(642557),v=n(474848);const y={viewBox:"0 0 16 16",fittedViewBox:"3.17 1.59 11.88 12.45",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{d:"M8 8.1a1.125 1.125 0 0 0-.575 2.092v.958a.575.575 0 0 0 1.15 0v-.958A1.125 1.125 0 0 0 8 8.1"}),(0,v.jsx)("path",{d:"M12.2 1.6a2.846 2.846 0 0 0-2.846 2.846V5.8H5.2a2.025 2.025 0 0 0-2.025 2.025v4.2c0 1.118.907 2.025 2.025 2.025h5.6a2.025 2.025 0 0 0 2.025-2.025v-4.2A2.025 2.025 0 0 0 10.8 5.8h-.196V4.446a1.596 1.596 0 1 1 3.192 0v1.63a.625.625 0 1 0 1.25 0v-1.63A2.846 2.846 0 0 0 12.2 1.6M4.425 7.825c0-.428.347-.775.775-.775h5.6c.428 0 .775.347.775.775v4.2a.775.775 0 0 1-.775.775H5.2a.775.775 0 0 1-.775-.775z"})]})},b=(0,n(340498).wt)("lockOpenSmall",y);var S=()=>n(358359),x=()=>n(959013),A=()=>n(284371),M=()=>n(246826),w=()=>n(751156),k=()=>n(2220),j=()=>n(449195),C=()=>n(722872),I=()=>n(600871),T=()=>n(557198),_=()=>n(455425),P=()=>n(493823),B=()=>n(678553),L=()=>n(8980),R=()=>n(89924),D=()=>n(946548),N=()=>n(867159);const O=function(e){let{store:t,useBottomSheetStyling:s}=e;const l=(0,i().v3)(),d=(0,x().tz)(),{device:c}=l,u=(0,r().K8)((()=>t.isLockedForAllUsers()),[t]),g=(0,r().K8)((()=>_().$.isTemporarilyUnlocked({userId:t.userId,blockId:t.id})),[t.id,t.userId]),f=(0,r().K8)((()=>t.isLocked()),[t]),h=(0,r().K8)((()=>t.isExternalObjectInstancePageBlockStore()),[t]);let y;y=c.isMobile?{menuType:C().gu.Modal,right:s?void 0:(0,v.jsx)(n(480095).DoneMenuText,{}),onClickRight:a().VN,title:d.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:C().gu.Popup,minWidth:300};const b=(0,r().K8)((()=>function(e,t){const n=e.getFormat();if(!t)return{};const o=(0,m().L)(n,t,void 0,p().jf.Collection);return o}(t,t.getSchema())),[t]),S=(0,o.useCallback)((()=>{g?_().$.relockBlock({userId:t.userId,blockId:t.id}):_().$.temporarilyUnlockBlock({userId:t.userId,blockId:t.id})}),[t.id,t.userId,g]);return(0,v.jsxs)(n(928600).A,{...y,children:[u&&(0,v.jsx)(K,{isTemporarilyUnlocked:g,onToggleLock:S}),(0,v.jsx)(E,{store:t,locked:f,format:b,isSyncedCollection:h,device:c})]})};function E(e){let{format:t,isSyncedCollection:n,store:o,locked:i,device:a}=e;const s=(0,r().K8)((()=>o.getSchema()),[o]),l=function(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}(t),{pageSectionVisibility:d}=l,c=(0,r().K8)((()=>(0,j().vk)(d)),[d]),u=(0,r().K8)((()=>o.isCollectionView()),[o]),p=!(0,I().D1)(a),m=!a.isMobile&&!u;if(!s||!o)return null;if(!l)return null;if(!d)return null;const g={topLevelDiscussions:!n,backLinks:p,floatingTableOfContents:m,pageComments:!n},f={locked:i,store:o,format:t},h=(0,v.jsxs)(v.Fragment,{children:[g.backLinks&&(0,v.jsx)(F,{...f}),g.topLevelDiscussions&&(0,v.jsx)(U,{pageVisibility:d.comments,...f}),g.floatingTableOfContents&&(0,v.jsx)(V,{pageVisibility:d.comments,...f,store:o}),g.pageComments&&(0,v.jsx)(z,{pageVisibility:c,...f})]});return(0,v.jsx)(R().A,{style:{opacity:i?.5:1},children:(0,v.jsx)("div",{style:{marginLeft:2},children:h})})}function U(e){let{pageVisibility:t,locked:n,store:r,format:s}=e;const l=(0,i().v3)(),d="section_show"===t,c=(0,o.useCallback)((()=>{const e="section_show"===t?"section_hide":"section_show";a().OD({environment:l,pageSection:"comments",visibility:e,store:r,format:s})}),[l,s,t,r]),p=(0,u().IS)((()=>({switcherButtonContainer:{marginRight:4}})),[]);return(0,v.jsx)(B().Ay,{title:(0,v.jsx)(x().sA,{id:"customizePageMenu.pageSections.pageCommentsSwitcherTitle",defaultMessage:"Page discussions"}),icon:(0,v.jsx)(L().I,{icon:f().h}),right:(0,v.jsx)("div",{style:p.switcherButtonContainer,children:(0,v.jsx)(D().A,{disabled:n,on:d,onClick:c})})})}function F(e){let{locked:t,store:n,format:o}=e;const{backlinksVisibility:i,updateBacklinksVisibility:r}=(0,T().Ap)({store:n,format:o});return(0,v.jsx)(B().Ay,{title:(0,v.jsx)(x().sA,{id:"customizePageMenu.pageSections.backlinksSwitcherTitle",defaultMessage:"Backlinks"}),icon:(0,v.jsx)(L().I,{icon:g().D}),right:(0,v.jsx)(N().p7,{currentVisibility:i,onSelect:r,disabled:t})})}function V(e){let{pageVisibility:t,locked:n,store:a,format:s}=e;const l=(0,u().IS)((()=>({switcherButtonContainer:{marginRight:4}})),[]),d=(0,i().v3)(),c=(0,r().K8)((()=>{var e;return"off"!==(null===(e=a.getModel())||void 0===e?void 0:e.getFloatingTableOfContentsState())}),[a]),p=(0,o.useCallback)((()=>{w().createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:d,canUndo:!0,perform:e=>{M().zv({store:a.getFormatStore(),data:{page_floating_table_of_contents:{state:c?"off":"minimal"}},transaction:e})}}),(0,k().u)({environment:d,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:!c}}})}),[a,d,c]);return(0,v.jsx)(B().Ay,{title:(0,v.jsx)(x().sA,{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"}),icon:(0,v.jsx)(L().I,{icon:S().L}),right:(0,v.jsx)("div",{style:l.switcherButtonContainer,children:(0,v.jsx)(D().A,{disabled:n,on:c,onClick:p})})})}function z(e){let{pageVisibility:t,locked:n,store:o,format:r}=e;const s=(0,i().v3)();return(0,v.jsx)(B().Ay,{title:(0,v.jsx)(x().sA,{id:"customizePageMenu.pageSections.inlineCommentsTitle",defaultMessage:"Inline comments"}),icon:(0,v.jsx)(L().I,{icon:f().h}),right:(0,v.jsx)(N().J8,{currentVisibility:t,disabled:n,onSelect:e=>{a().OD({environment:s,pageSection:"margin_comments",visibility:e,store:o,format:r})}})})}function K(e){let{isTemporarilyUnlocked:t,onToggleLock:n}=e;const o=(0,u().DP)();return(0,v.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${o.regularDividerColor}`,borderBottom:`1px solid ${o.regularDividerColor}`,background:o.surface.wash,color:o.text.secondary,paddingTop:6,paddingBottom:6},children:[(0,v.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:t?(0,v.jsx)(L().I,{icon:b,size:"sm",color:"secondary"}):(0,v.jsx)(L().I,{icon:h().O,size:"sm",color:"secondary"})}),(0,v.jsx)(x().sA,{id:"customizePageMenu.locked.header",defaultMessage:"Page is locked."}),(0,v.jsx)(P().p,{style:{fontSize:12,color:o.text.secondary,fontWeight:A().Wy.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:n,children:t?(0,v.jsx)(x().sA,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,v.jsx)(x().sA,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock for me"})})]})}const W=function(){const e=(0,i().v3)(),{device:t}=e,o=(0,r().O$)(d().A);return(0,v.jsx)(n(897119).Ay,{popupType:t.isMobile?s().n.BottomSheet:s().n.Popup,bottomSheetInitialState:"half",alignmentToOrigin:n(962730).C.Center,open:o.isOpen,render:()=>(0,v.jsx)(H,{useBottomSheetStyling:t.isMobile}),originRect:o.isOpen?o.rect:void 0,onDismiss:()=>a().VN(),trapFocus:!0})};function H(e){let{useBottomSheetStyling:t}=e;const n=(0,r().O$)(d().A),o=(0,r().K8)((()=>c().default.state.open&&c().default.state.targetStore||l().default.state.mainEditorCurrentBlockStore),[]);return n.isOpen&&o?(0,v.jsx)(O,{store:o,useBottomSheetStyling:t}):null}},87017:(e,t,n)=>{n.r(t),n.d(t,{duplicateBlocks:()=>C,duplicateBlocksWithMaybeConfirmation:()=>j,insertBlockAbove:()=>T,insertBlockAndEdit:()=>_,insertBlockBelow:()=>I,insertTextAbove:()=>B,insertTextBelow:()=>P});n(18107),n(944114),n(967357);var o=()=>n(908006),i=()=>n(206267),r=()=>n(496603),a=()=>n(855801),s=()=>n(466614),l=()=>n(60867),d=()=>n(669548),c=()=>n(901389),u=()=>n(620689),p=()=>n(797265),m=()=>n(751156),g=()=>n(838256),f=()=>n(521358),h=()=>n(807700),v=()=>n(799832),y=()=>n(413962),b=()=>n(405417),S=()=>n(755206),x=()=>n(53664),A=()=>n(393255),M=()=>n(77246),w=()=>n(502438),k=()=>n(611371);async function j(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:i,callback:r}=e;if(!(0,k().EF)(t))return;const s=await a().VI.duplicateActions.load();let d=n;if(1===n.length){const e=await f().rW({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return void(null==r||r());d=e}const c=d.at(0);if(!c)return;const p=(0,v().U)(c);if(p&&(0,b().ls)(c,p))await l().un({blocks:d,environment:t,analyticsFrom:"subitem_duplication",callback:r,collectionContextStore:p});else{const{serverCommitResult:e}=m().createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,canUndo:!0,perform:e=>{C({environment:t,blocks:d,transaction:e,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:i,duplicateActions:s})},transactionTooBigFallback:e=>{C({environment:t,blocks:d,transaction:e,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:i,duplicateActions:s})}});e.then(r)}o().default.afterNextFlush((()=>{u().BM({environment:t})}))}function C(e){const{environment:t,blocks:n,transaction:o,preferDuplicateLocation:i,lastTopLevelBlockStore:a,preventSetSelection:l,duplicateOnlyCollectionSchema:d,duplicateActions:u}=e,m=r().$z(n,(e=>e.getFormat().app_id??e.id)),g=[];return r().jJ(m,(e=>{const n=e[0],{blockStores:r,onComplete:a}=u.duplicateBlock({environment:t,stores:e,transaction:o,targetSpaceId:n.getSpaceId(),preferDuplicateLocation:i,options:{addCopyName:(0,x().A)(n),allowRedundancy:!1,deepCopyTransclusionContainers:!n.isTransclusionType(),resolveTemplateVariables:!(0,h().l)(n),duplicateOnlyCollectionSchema:d}});g.push(...r),a.then((e=>{if("error"===e.status){const n=e.error;s().Rk(n)?s().UK(t,{product:n.clientData.metadata.product}):c().f1(e.errorMessage)}}))})),p().LE({blocksToInsert:g,target:a?[a]:n,environment:t,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:l}),g}function I(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:r,preventSetSelection:a}=e,s=w().default.getCurrentRecordCache(),l=new(g().UF)({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let c;if((0,k().EF)(t)&&n&&s){const e=d().w({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:s,from:r,selection:o});l.track(e.pointer,i),c=p().LE({environment:t,blocksToInsert:[e],target:o,transaction:i,replaceEmptyTextBlock:!1,preventSetSelection:a})[0]}else l.fail("invalid_state");return c}function T(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:r,preventSetSelection:a}=e,s=w().default.getCurrentRecordCache();let l;if((0,k().EF)(t)&&n&&s){const e=d().w({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:s,from:r,selection:o});l=p().t1({environment:t,blocks:[e],selection:o,transaction:i,preventSetSelection:a})[0]}return l}function _(e){const{environment:t,selection:n,transaction:o}=e,r=I({...e,preventSetSelection:!0});if(r){var a;p().x5({environment:t,insertedStores:[r],isCreated:!0});const e=M().Uv.getMode(r);if("suggest"===e){const e=y().RR(t,o,r);y().tM(o,r,{id:i().JW(),type:"insert",discussionId:e.id}),y().c3({environment:t,transaction:o,discussionStore:e,addModifiedBlockIdsAfter:[r.id]})}"suggest"===e&&null!==(a=r.getNavigableBlockStore({skipCurrent:!0}))&&void 0!==a&&a.isCommentOnly()||p().um({transaction:o,blocks:n})}return r}function P(e){const{blocks:t,transaction:n,environment:i,skipAnalytics:r}=e,a=r?void 0:"text_insert_below",s=I({environment:i,selection:t,createBlockItem:S().ry.text,analyticsFrom:a,transaction:n});return s&&o().default.afterNextFlush((()=>{A().zz({environment:i,blockStore:s,insertedTextBlockLocation:"below"})})),s}function B(e){const{blocks:t,transaction:n,environment:i,skipAnalytics:r}=e,a=r?void 0:"text_insert_below",s=T({environment:i,selection:t,createBlockItem:S().ry.text,analyticsFrom:a,transaction:n});return s&&o().default.afterNextFlush((()=>{A().zz({environment:i,blockStore:s,insertedTextBlockLocation:"above"})})),s}},91669:(e,t,n)=>{n.d(t,{z:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{isOpen:!1}}}const i=new o},93549:(e,t,n)=>{n.d(t,{j:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("parentItem",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.29662 5.47368L7.33167 4.11653L6.30839 5.24265L4.22625 7.32458C4.16064 7.39019 4.0821 7.43856 3.99288 7.47024C3.90958 7.5013 3.82192 7.51646 3.73089 7.51646C3.54036 7.51646 3.37427 7.45062 3.24187 7.31823L3.23992 7.31628C3.11249 7.18353 3.04999 7.01804 3.04999 6.82921C3.04999 6.63758 3.12598 6.46746 3.2656 6.32285L3.26711 6.32129L7.4749 2.10083C7.62016 1.9509 7.79567 1.87 7.99651 1.87C8.19734 1.87 8.37284 1.95089 8.51809 2.10079L12.7355 6.32457C12.8705 6.46954 12.943 6.63917 12.943 6.82921C12.943 7.01927 12.8775 7.18502 12.7458 7.31725C12.617 7.45083 12.4522 7.51646 12.2621 7.51646C12.1706 7.51646 12.0814 7.50115 11.995 7.47068L11.9926 7.4698C11.9069 7.43769 11.8313 7.38908 11.7668 7.32458L9.6802 5.238L8.65635 4.11153L8.69652 5.47736L8.69011 9.81896C8.69011 10.5736 8.80303 11.157 9.01808 11.5793C9.2312 11.9935 9.55909 12.2887 10.0079 12.4675L10.0088 12.4678C10.4652 12.6536 11.062 12.7499 11.8051 12.7499C11.952 12.7499 12.0793 12.7478 12.1871 12.7436C12.303 12.7393 12.417 12.7372 12.5287 12.7372C12.7186 12.7372 12.8855 12.7955 13.0191 12.9179C13.1612 13.0441 13.2287 13.2138 13.2287 13.4117C13.2287 13.5394 13.2018 13.6569 13.1388 13.7556C13.0846 13.8467 13.0093 13.919 12.9157 13.9718C12.8317 14.0256 12.7415 14.0631 12.6459 14.0833C12.5373 14.1068 12.4035 14.12 12.2469 14.1243C12.0973 14.1286 11.931 14.1307 11.748 14.1307C10.2678 14.1307 9.14333 13.8104 8.40142 13.144C7.6536 12.4723 7.29657 11.3702 7.29657 9.87609L7.29662 5.47368Z"})})},103674:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{permissionsInviteStore:new(n(986229).A),contextualInviteStore:new(n(159026).Ay)}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const i=o},135154:(e,t,n)=>{n.d(t,{E:()=>i});n(898992),n(823215);var o=()=>n(953418);function i(e){const{element:t,extraBottomSpacing:n=0}=e;let i=t.getBoundingClientRect();i=DOMRect.fromRect({x:i.x,y:i.y,width:i.width,height:i.height+n});return(0,o().sl)(t).every((e=>{const t=e.getBoundingClientRect();return i.top>=t.top&&i.bottom<=t.bottom&&i.left>=t.left&&i.right<=t.right}))}},135546:(e,t,n)=>{n.r(t),n.d(t,{CreateTeamFromPageConfirmModal:()=>v});n(296540);var o=()=>n(484714),i=()=>n(56366),r=()=>n(401497),a=n(474848);const s=(0,n(340498).wt)("loop",{viewBox:"0 0 16 16",svg:(0,a.jsx)("path",{d:"M5.80371 3.12305C5.81006 3.50391 6.05762 3.74512 6.47656 3.74512H11.3643C11.9546 3.74512 12.2783 4.0498 12.2783 4.66553V11.2925L11.377 10.3149L10.8628 9.80078C10.5962 9.54688 10.2344 9.52783 9.96777 9.78809C9.71387 10.0483 9.72021 10.4229 9.98047 10.6831L12.145 12.8413C12.6211 13.311 13.167 13.311 13.6431 12.8413L15.8076 10.6831C16.0679 10.4229 16.0742 10.0483 15.8203 9.78809C15.5537 9.52783 15.1919 9.54688 14.9253 9.80078L14.4111 10.3149L13.5161 11.2861V4.56396C13.5161 3.20557 12.8052 2.50098 11.4341 2.50098H6.47656C6.05762 2.50098 5.79736 2.74219 5.80371 3.12305ZM0.186035 7.05859C0.446289 7.3252 0.808105 7.30615 1.07471 7.0459L1.59521 6.53809L2.48389 5.56689V12.2891C2.48389 13.6475 3.19482 14.3521 4.56592 14.3521H9.52344C9.94238 14.3521 10.2026 14.1108 10.1963 13.73C10.1899 13.3428 9.94238 13.1079 9.52344 13.1079H4.64209C4.05176 13.1079 3.72803 12.7969 3.72803 12.1812V5.5542L4.62305 6.53809L5.14355 7.0459C5.40381 7.30615 5.77197 7.3252 6.03223 7.05859C6.29248 6.79834 6.28613 6.43018 6.01953 6.16992L3.85498 4.01172C3.37891 3.53564 2.83936 3.53564 2.36328 4.01172L0.19873 6.16992C-0.0678711 6.43018 -0.0742188 6.79834 0.186035 7.05859Z"})});var l=()=>n(959013),d=()=>n(284371),c=()=>n(864943),u=()=>n(204063),p=()=>n(641514),m=()=>n(21140),g=()=>n(475355),f=()=>n(108414),h=()=>n(812941);function v(){const e=(0,o().v3)(),t=(0,l().tz)(),n=(0,r().IS)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},title:{marginTop:16,marginBottom:12,color:e.text.primary,fontWeight:d().Wy.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]),v=(0,i().K8)((()=>f().A.state.open),[]);return(0,a.jsx)(p().A,{onDismiss:()=>{f().A.setState({open:!1})},render:()=>(0,a.jsx)("div",{style:n.modal,children:(0,a.jsxs)(m().Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[s(n.loopIcon),(0,a.jsx)("div",{style:n.title,children:(0,a.jsx)(l().sA,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,a.jsx)("div",{style:n.description,children:(0,a.jsx)(l().sA,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,a.jsx)(u().A,{size:"lg",style:n.confirmButton,onClick:()=>{if(f().A.state.open){const{pageStore:n,flowId:o}=f().A.state;g().v4({environment:e,intl:t,page:n,flowId:o}),f().A.setState({open:!1})}},children:(0,a.jsx)(l().sA,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,a.jsx)(c().A,{size:"lg",style:n.cancelButton,onClick:()=>f().A.setState({open:!1}),children:(0,a.jsx)(l().sA,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,a.jsx)(h().A,{message:(0,a.jsx)(l().sA,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),isOpen:v})}},136805:(e,t,n)=>{n.r(t),n.d(t,{TopbarShareButton:()=>D,messages:()=>_});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(328347),l=()=>n(864896),d=()=>n(959013),c=()=>n(381349),u=()=>n(904671),p=()=>n(780054),m=()=>n(38337),g=()=>n(553965),f=()=>n(963589),h=()=>n(321172),v=()=>n(623275),y=()=>n(437487),b=()=>n(326589),S=()=>n(962730),x=()=>n(227440),A=()=>n(493823),M=()=>n(406699),w=()=>n(35392),k=()=>n(859428),j=()=>n(21140),C=()=>n(978578),I=()=>n(863059),T=n(474848);const _=(0,d().YK)({share:{defaultMessage:"Share",id:"topbar.share"}});function P(e){let{store:t,buttonPopupStore:s}=e;const l=(0,i().v3)(),{isMobile:d,isTablet:c}=(0,r().K8)((()=>({isMobile:l.device.isMobile,isTablet:l.device.isTablet})),[l]),p=(0,r().uB)(void 0,n(103674).A),m=(0,r().uB)(void 0,n(529183).Ay),g=(0,r().uB)(void 0,n(454354).A),f=(0,r().K8)((()=>function(e,t){if(t.shouldUserHaveAccessToPrivatePageBlock()&&t.state.changePermissionsEnabled&&t.state.privatePageStore&&t.state.privatePageStore.id===e.id)return t.state.privatePageStore;return e}(t,g)),[t,g]),S=(0,r().K8)((()=>t.canAdmin()),[t]),x=(0,r().K8)((()=>!d&&function(e,t){const{permissionsInviteStore:n}=e.state;return n.state.inviteTargets.length>0||t.state.inviteTargets.length>0}(p,m)),[m,d,p]),{sudoModeStoreId:A}=(0,r().K8)((()=>{var e;return{sudoModeStoreId:null===(e=g.state.privatePageStore)||void 0===e?void 0:e.id}}),[g]),w=(0,r().O$)(n(765957).AppStoreCurrentSpaceStore);(0,o.useEffect)((()=>{!function(e){var t;let{environment:n,store:o,sudoModeStore:i,canAdmin:r,currentSpaceStore:a}=e;null!==(t=i.state.privatePageStore)&&void 0!==t&&t.id&&i.state.privatePageStore.id!==o.id&&i.reset();r||u().B({environment:n,sudoModeStore:i,pageBlockId:o.id,currentSpaceStore:a})}({environment:l,sudoModeStore:g,store:t,canAdmin:S,currentSpaceStore:w})}),[S,l,t,g,A,w]),(0,o.useEffect)((()=>{y().Ay.setState({...y().Ay.state,isInitialized:!0})}));const k=(0,o.useCallback)((()=>{s.reset()}),[s]),j=(0,o.useCallback)((()=>{R({buttonPopupStore:s,universalMemberInviteStore:p,inviteTargetsStore:m}),n(778417).IU({environment:l}),h().Tk(l),(0,b().g)()||n(224701).x(l)}),[s,p,m,l]),C=(0,r().K8)((()=>{const e=t.getPublicPermission();if(!e||!(0,n(68263).W8)(e))return!1;const o=t.getSpaceStore();return!!o&&o.getSettings().hide_sites_banner}),[t]),I=(0,o.useCallback)((e=>(0,T.jsx)(B,{buttonPopupEvents:e,handleClick:j,shouldShowGlobeIcon:C})),[j,C]),_=(0,o.useCallback)((async()=>{if(m.state.inviteTargets.length>0){return void(await h().T({environment:l,inviteTargetsStore:m})&&(h().XP(l),R({buttonPopupStore:s,universalMemberInviteStore:p,inviteTargetsStore:m})))}const{permissionsInviteStore:e}=p.state;"invitee"===e.state.inputFocus&&e.setState({...e.state,inputFocus:"none"});await(0,n(743260).iQ)({environment:l,permissionsInviteStoreState:e.state,from:"share_menu"})||(h().XP(l),R({buttonPopupStore:s,universalMemberInviteStore:p,inviteTargetsStore:m}))}),[s,l,m,p]),P=(0,a().IS)((e=>({buttonPopup:{...d?{width:"100%"}:c?{width:460}:{width:v().$D,overflow:"hidden",borderRadius:v().Sg,boxShadow:e.shadowMD,..."dark"===e.mode&&{border:`1px solid ${e.largePopupBorder}`}}}})),[d,c]);return(0,T.jsx)(M().Ay,{popupType:d?M().z7.SlideUp:M().z7.Popup,forceInitialInbound:!0,buttonPopupStore:s,renderOrigin:I,originGap:d?void 0:8,style:P.buttonPopup,onClick:j,render:()=>(0,T.jsx)(n(482707).k,{buttonPopupStore:s,sudoModeStore:g,store:f,inviteTargetsStore:m,universalMemberInviteStore:p,onUpgradeButtonClick:k,location:d?"topbar_mobile":"topbar_share_button",onClose:_}),persistOnClose:x,onDismiss:_,onClose:_})}function B(e){let{buttonPopupEvents:t,handleClick:n,shouldShowGlobeIcon:s}=e;const{isMobile:l}=(0,i().Y0)(),c=!(0,r().O$)(x().e),u=(0,r().K8)((()=>(0,b().g)()),[]),p=(0,a().IS)((e=>({shortcut:{color:e.text.contrastSecondary}})),[]),m=(0,o.useCallback)((()=>c?(0,T.jsx)(d().sA,{defaultMessage:"Unavailable while offline",id:"topbar.shareButton.offlineTooltip"}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{children:u?(0,T.jsx)(d().sA,{defaultMessage:"Share",id:"topbar.shareButton.tooltipAWTL"}):(0,T.jsx)(d().sA,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,T.jsx)(w().A,{style:p.shortcut,name:"openShareMenu"})]})),[c,u,p.shortcut]);return(0,T.jsx)(k().A,{disableTooltip:l,renderTooltip:m,placement:S().W.Bottom,delayThreshold:400,render:e=>(0,T.jsx)(L,{events:(0,g().A)(e,t),handleClick:n,disabled:c,shouldShowGlobeIcon:s})})}function L(e){let{events:t,handleClick:n,disabled:o,shouldShowGlobeIcon:i}=e;const r=p().A.isMobile,u=(0,d().tz)(),g=(0,f().X)("allow_disable_sites_banner"),h=(0,a().IS)((e=>{const t=(0,C().aD)(e),n=(0,I().Hh)(e);return{mobileIconStyle:t.iconStyle,globeIconStyle:{...n.icon,fill:c().Tj.blue,paddingRight:4},shareButton:{...r?t.iconContainer:{marginRight:n.iconButton.marginRight,marginLeft:6}}}}),[r]);const v=r?(0,l().Y)(h.mobileIconStyle):(0,T.jsxs)(j().Ye,{alignItems:"center",children:[i&&g?(0,s().h)(h.globeIconStyle):void 0,(0,T.jsx)(d().sA,{defaultMessage:"Share",id:"topbar.shareButton.title"})]});return(0,T.jsx)(A().p,{id:void 0,className:m().voG,...t,style:h.shareButton,"aria-label":u.formatMessage(_.share),disabled:o,disabledFeedback:o,children:v})}function R(e){let{buttonPopupStore:t,universalMemberInviteStore:n,inviteTargetsStore:o}=e;t.reset(),n.reset(),o.reset()}const D=o.memo(P)},137840:(e,t,n)=>{n.r(t),n.d(t,{OutlinerDropdownMenuButton:()=>K,useSortActions:()=>G});n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(582684),l=()=>n(29037),d=()=>n(126617),c=()=>n(813197),u=()=>n(617668),p=()=>n(946065),m=()=>n(116225),g=()=>n(959013),f=()=>n(416726),h=()=>n(899963),v=()=>n(246826),y=()=>n(751156),b=()=>n(664713),S=()=>n(47373),x=()=>n(722872),A=()=>n(396301),M=()=>n(37433),w=()=>n(963589),k=()=>n(655923),j=()=>n(112282),C=()=>n(575143),I=()=>n(667193),T=()=>n(765957),_=()=>n(966711),P=n(474848);const B=(0,g().YK)({move:{id:"useMoveSidebarAction.title.moveSection",defaultMessage:"Move section"},moveUp:{id:"useMoveSidebarAction.option.moveUp",defaultMessage:"Move up"},moveDown:{id:"useMoveSidebarAction.option.moveDown",defaultMessage:"Move down"}});var L=()=>n(852678),R=()=>n(620149),D=()=>n(848237),N=()=>n(452558),O=()=>n(704152),E=()=>n(406699),U=()=>n(928600),F=()=>n(8980),V=()=>n(89924);const z=(0,g().YK)({manual:{id:"outlinerDropdownMenuButton.sort.manual",defaultMessage:"Manual"},lastEdited:{id:"outlinerDropdownMenuButton.sort.lastEdited",defaultMessage:"Last edited"}});function K(e){const{type:t,spaceViewStore:n}=e,r=(0,i().v3)(),s=(0,a().IS)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:4}})),[]),l=(0,o.useCallback)((()=>{L().A.setState({open:!0}),h().ye(r,{outliner_type:A().BP[t]})}),[r,t]),c=(0,o.useCallback)((()=>{L().A.setState({open:!1})}),[]),u=(0,g().tz)().formatMessage({id:"outlinerDropdownMenuButton.ariaLabel",defaultMessage:"Open menu"});return(0,P.jsx)(E().Ay,{popupType:E().z7.Popup,alignmentToOrigin:E().yP.Start,renderOrigin:e=>(0,P.jsx)(O().A,{style:s.button,ariaLabel:u,...e,children:(0,P.jsx)(F().I,{icon:d().Y,size:"sm",color:r.device.isMobile?"tertiary":"secondary"})}),onClick:l,onClose:c,render:e=>(0,P.jsx)(H,{type:t,spaceViewStore:n,onClose:()=>{e.close()}}),originGap:2})}const W=(0,g().YK)({sort:{id:"outlinerDropdownMenu.sort",defaultMessage:"Sort"},truncationLimit:{id:"outlinerDropdownMenu.truncationLimit",defaultMessage:"Show"},addTeam:{id:"outlinerDropdownMenu.addTeam",defaultMessage:"New teamspace"}});function H(e){const{type:t,spaceViewStore:n,onClose:o}=e,d=(0,i().v3)(),b=(0,g().tz)(),w=(0,a().IS)((e=>({rightText:{fontSize:12,color:e.text.secondary}})),[]),L=(0,r().K8)((()=>(0,S().rY)(d)),[d]),O=(0,r().K8)((()=>(0,A().RQ)({spaceViewStore:n,type:t})),[n,t]),E=O.sortOption,F=O.truncationLimit,K="shared"===t&&L||"private"===t||"teamspaces"===t,H="private"===t||"shared"===t&&L,q=(0,r().K8)((()=>!R().l.state),[]),$=(0,r().K8)((()=>{const{currentSpaceStore:e}=T().default.state;return!!e&&(0,M().sx)({environment:d,spaceStore:e})}),[d]),Q=q&&"teamspaces"===t&&$,Z=G({type:t,onSelect:o,spaceViewStore:n,outlinerLocation:"sidebar"}),X=function(e){const{type:t,spaceViewStore:n,onSelect:o}=e,s=(0,i().v3)(),d=(0,a().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]),c=(0,r().K8)((()=>(0,A().RQ)({type:t,spaceViewStore:n}).truncationLimit),[t,n]);return p().AQ.map((e=>(0,f().Ls)({key:e.toString(),displayName:void 0,analyticsName:e.toString(),validators:[],closeParentMenu:!0,action:()=>{y().createAndCommit({userAction:"OutlinerDropdownMenuButton.setTruncationLimit",environment:s,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("truncationLimit").getKeyStore(t);v().KY({transaction:o,store:i,value:e})}}),m().u4({name:"update_sidebar_section_option",args:{option:"show",type:t}}),h().nT(s,{outliner_type:A().BP[t],option:e}),o()},render:t=>(0,P.jsx)(C().A,{...t,title:(0,P.jsx)(Y,{limit:e,withItems:!0}),right:c===e&&(0,l().checkmarkIcon)(d.icon),rightStyle:d.right})})))}({type:t,onSelect:o,spaceViewStore:n}),J=function(e){const{type:t,onSelect:n}=e,o=(0,r().O$)(T().AppStoreCurrentSpaceStore),a=(0,r().O$)(T().AppStoreCurrentSpaceViewStore),s=(0,r().K8)((()=>T().default.state.currentUserRootStore),[]),l=(0,g().tz)(),d=(0,i().v3)(),c=(0,I().p)(),u=(0,_().m)(),p=(0,r().K8)((()=>(0,S().i3)({environment:d,spaceStore:o,userRootStore:s})),[d,o,s]),m=(0,A().KP)({sidebarOrder:u,sidebarState:c,showLockedSidebar:p});if(!a)return[];const b=m.indexOf(t),x=0===b,M=b===m.length-1,w=(null==c?void 0:c.shownSidebarSectionCount)??0;return["moveUp","moveDown"].map((e=>{const o=B[e];return(0,f().Ls)({key:e,displayName:void 0,analyticsName:o.defaultMessage,validators:[()=>w>1],closeParentMenu:!0,action:o=>{let{environment:i}=o;const r=function(e){let{sidebarSection:t,selectedMoveOption:n,sidebarOrder:o,visibleSidebarOrder:i}=e;const r=[...o],a=o.indexOf(t),s=i.indexOf(t);if("moveUp"===n&&s>0){const e=i[s-1];r[o.indexOf(e)]=t,r[a]=e}if("moveDown"===n&&s<i.length-1){const e=i[s+1];r[o.indexOf(e)]=t,r[a]=e}return r}({sidebarSection:t,selectedMoveOption:e,sidebarOrder:u,visibleSidebarOrder:m});y().createAndCommit({userAction:`useMoveSidebarAction.${e}`,environment:i,canUndo:!0,perform:e=>{v().zv({store:a,data:{sidebar_order:r},transaction:e})}}),h().ub(i,{section:t,previous_order:u,new_order:r,from:"outliner_section_menu"}),n()},render:t=>{const n="moveUp"===e&&x||"moveDown"===e&&M,i="moveUp"===e?j().s:k().v;return(0,P.jsx)(C().A,{...t,disabled:n,disabledFeedback:n,title:l.formatMessage(o),svg:i})}})}))}({type:t,onSelect:o}),ee=[(0,f().uk)({key:"sort",displayName:W.sort,analyticsName:W.sort.defaultMessage,validators:[()=>H],svg:s().C,right:b.formatMessage(z[E]),rightStyle:w.rightText,subActions:()=>[(0,f().gy)({key:"sort",render:e=>(0,P.jsx)(V().A,{...e}),actions:Z})]}),(0,f().uk)({key:"truncationLimit",displayName:W.truncationLimit,analyticsName:W.truncationLimit.defaultMessage,validators:[()=>K],svg:c().L,right:(0,P.jsx)(Y,{limit:F}),rightStyle:w.rightText,subActions:()=>[(0,f().gy)({key:"truncationLimit",render:e=>(0,P.jsx)(V().A,{...e}),actions:X})]}),...J],te=[(0,f().gy)({key:"all",render:e=>(0,P.jsx)(V().A,{...e}),actions:ee}),(0,f().gy)({key:"addTeam",render:e=>(0,P.jsx)(V().A,{...e}),actions:[(0,f().Ls)({key:"addTeam",displayName:W.addTeam,analyticsName:W.addTeam.defaultMessage,validators:[()=>Q],svg:u().plusIcon,closeParentMenu:!0,action:()=>{(0,D().vn)("sidebar_team_section"),o()}})]})];return(0,P.jsx)(U().A,{menuType:x().gu.Popup,minWidth:220,children:(0,P.jsx)(N().A,{context:{blocks:[],environment:d,publicEditMode:void 0},sections:te,initialFocus:void 0})})}function G(e){const{type:t,spaceViewStore:n,onSelect:o,outlinerLocation:s}=e,d=(0,i().v3)(),c=(0,g().tz)(),{currentSpaceStore:u}=(0,r().O$)(T().default),p=d.currentUser.id,S=(0,w().X)("sidebar_add_new_pages_to_bottom"),x=(0,r().K8)((()=>(0,A().RQ)({type:t,spaceViewStore:n}).sortOption),[t,n]),M=(0,a().IS)((()=>({icon:{width:16,height:16},right:{width:16}})),[]);return["manual","lastEdited"].map((e=>{const i=z[e];return(0,f().Ls)({key:e,displayName:void 0,analyticsName:i.defaultMessage,validators:[],closeParentMenu:!0,action:async()=>{y().createAndCommit({userAction:"OutlinerDropdownMenuButton.setSortOption",environment:d,canUndo:!0,perform:o=>{const i=n.getSettingsStore().getKeyStore("sidebar_section_menu").getKeyStore("sortOption").getKeyStore(t);v().KY({transaction:o,store:i,value:e})}}),"manual"===e&&"shared"===t&&!S&&p&&u&&await b().Z({environment:d,spaceId:u.id,userId:p}),m().u4({name:"update_sidebar_section_option",args:{option:"sort",type:t}}),h().Rf(d,{outliner_type:A().BP[t],outliner_location:s,option:e}),o()},render:t=>(0,P.jsx)(C().A,{...t,title:c.formatMessage(i),right:x===e&&(0,l().checkmarkIcon)(M.icon),rightStyle:M.right})})}))}function Y(e){const{limit:t,withItems:n}=e;return t===p().vw?(0,P.jsx)(g().sA,{id:"outlinerDropdownMenuButton.truncationLimit.noTruncation",defaultMessage:"All"}):n?(0,P.jsx)(g().sA,{id:"outlinerDropdownMenuButton.truncationLimit",defaultMessage:"{limit} items",values:{limit:t}}):(0,P.jsx)("span",{children:t})}},142015:(e,t,n)=>{n.d(t,{D:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"4.42 4.41 11.16 11.16",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M15.417 5.467c.23-.23.219-.615-.025-.859s-.629-.255-.86-.025l-8.857 8.858V7.313a.625.625 0 0 0-1.25 0v7.637c0 .345.28.625.625.625h7.637a.625.625 0 1 0 0-1.25H6.559z"})},i=(0,n(340498).wt)("arrowDiagonalDownLeft",o)},142662:(e,t,n)=>{n.d(t,{Xy:()=>Y,du:()=>z,n5:()=>G});n(581454),n(296540);var o=()=>n(484714),i=()=>n(56366),r=()=>n(401497),a=()=>n(668725),s=()=>n(381138),l=()=>n(693954),d=()=>n(959013),c=()=>n(496603),u=()=>n(284371),p=()=>n(895876),m=()=>n(493823),g=()=>n(760217),f=()=>n(802790),h=()=>n(805751),v=()=>n(419357),y=()=>n(545805),b=()=>n(187485),S=()=>n(331542),x=()=>n(928600),A=()=>n(187820),M=()=>n(89924),w=()=>n(933117),k=()=>n(125565),j=()=>n(780054),C=()=>n(722872),I=()=>n(372657),T=()=>n(836251),_=()=>n(640653),P=()=>n(62856),B=()=>n(765957),L=()=>n(832820),R=()=>n(970585),D=()=>n(845566),N=()=>n(188669),O=()=>n(265665),E=()=>n(258805),U=()=>n(478495),F=()=>n(828048),V=n(474848);function z(e){const{targetBlocks:t,isCreateIn:n,onAccept:r,isAddTo:a,isTurnIntoPage:s,autocompleteQuery:l,onAutocompleteQueryChange:c,onMouseEnter:u,onCancel:p,desktopWidth:m,forceShowPrivatePageOption:g=!1,isLoading:f,allTargetsAreNavigable:v,autocompleteComponent:b}=e,S=(0,i().uB)(void 0,R().A),A=(0,i().uB)(void 0,D().A),w=(0,i().K8)((()=>(0,E().R3)()),[]),k=(0,i().K8)((()=>N().Ay.state.isOpen),[]),j=(0,o().WS)(),T=(0,i().K8)((()=>I().n6()),[]);if(!a&&!n&&!k)return null;let _,P;_=w?j?(0,V.jsx)(Y,{autocompleteQuery:l,onAutocompleteQueryChange:c,isAddTo:a,isTurnIntoPage:s,moveToSpaceMenuStore:A,menuListStore:S,isLoading:f}):(0,V.jsx)(M().A,{isInput:!0,children:(0,V.jsx)(Y,{autocompleteQuery:l,onAutocompleteQueryChange:c,isAddTo:a,isTurnIntoPage:s,moveToSpaceMenuStore:A,menuListStore:S,isLoading:f})}):void 0,P=j?{onMouseEnter:u,menuType:C().gu.Modal,title:s?(0,V.jsx)(d().sA,{defaultMessage:"Add to another page",id:"moveBlockMenu.mobileNewPageInj.label"}):a?(0,V.jsx)(d().sA,{defaultMessage:"Add new page in",id:"moveBlockMenu.mobileAddTo.label"}):(0,V.jsx)(d().sA,{defaultMessage:"Move to",id:"moveBlockMenu.mobileMoveTo.label"}),right:(0,V.jsx)(d().sA,{defaultMessage:"Done",id:"moveBlockMenu.rightDoneButton.label"}),onClickRight:p,header:_}:{onMouseEnter:u,menuType:C().gu.Popup,width:m,header:_};const B=!Boolean(l)&&!j||T&&!Boolean(l);return(0,V.jsxs)(h().A,{debugName:"MoveToOrCreateMenu",capture:!0,allowMenuList:!0,allowEsc:!0,allowLeft:!0,allowTabUntab:!1,allowUndo:!1,children:[(0,V.jsx)(y().A,{debugName:"MoveToOrCreateMenu",capture:!0,onEsc:p}),(0,V.jsx)(x().A,{...P,onClick:e=>{e.stopPropagation()},footer:(0,V.jsx)(G,{isCreateIn:n,isAddTo:a,moveToSpaceMenuStore:A,allTargetsAreNavigable:v}),children:B?(0,V.jsx)(H,{onAccept:r,targets:t,moveToSpaceMenuStore:A,menuListStore:S,allTargetsAreNavigable:v,forceShowPrivatePageOption:g}):b})]})}function K(e){return{width:10,marginLeft:4,fill:e.icon.tertiary}}function W(e){var t;return!!e&&e.getChosenSpaceId()!==(null===(t=B().default.state.currentSpaceStore)||void 0===t?void 0:t.id)}function H(e){let{onAccept:t,targets:n,moveToSpaceMenuStore:r,menuListStore:a,allTargetsAreNavigable:s,forceShowPrivatePageOption:l}=e;const d=(0,o().v3)(),c=(0,i().K8)((()=>(0,E().wc)(r)),[r]),u=(0,i().K8)((()=>(0,E().NA)(r)),[r]),p=(0,i().K8)((()=>I().n6()),[]),m=(0,i().K8)((()=>(0,_().IL)(c)),[c]);if(!u||!c)return null;const g=!s||m;return p?(0,V.jsx)(F().C,{spaceStore:c,spaceViewStore:u,onAccept:e=>(0,E().nG)(e,t,d),targets:n,menuListStore:a,moveToPagesOnly:g,forceShowPrivatePageOption:l,maxMenuItems:5}):(0,V.jsx)(U().Cr,{spaceStore:c,spaceViewStore:u,onAccept:t,targets:n,moveToPagesOnly:g,forceShowPrivatePageOption:l})}function G(e){let{isCreateIn:t,isAddTo:n,moveToSpaceMenuStore:s,allTargetsAreNavigable:l}=e;const u=(0,d().tz)(),p=(0,r().DP)(),h=(0,o().v3)(),{currentUserRootStore:v,currentSpaceStore:y}=(0,i().K8)((()=>{const{currentUserRootStore:e,currentSpaceStore:t}=B().default.state;return{currentUserRootStore:e,currentSpaceStore:t}}),[]),b=(0,i().K8)((()=>s.getChosenSpaceStore()),[s]),S=(0,i().K8)((()=>l&&!(null!=y&&y.getDisableMoveToSpace())&&!t&&!n),[l,y,t,n]),x=(0,i().K8)((()=>null==v?void 0:v.getSpaceViewStores()),[v]),M=(0,i().K8)((()=>c().hS(c().oE(null==x?void 0:x.map((e=>{const t=e.getSpaceStore();return!(0,_().IL)(t)&&t}))),(e=>e.id))),[x]);if(!v||!b||!y)return null;if(!S)return null;const k={menuTitle:u.formatMessage({defaultMessage:"Workspaces",id:"moveBlockMenu.spaceSwitcher.menuTitle"}),items:M,selectedItem:b,onSelect:e=>{s.setState({chosenSpaceId:e.id})},getKey:e=>e.id,renderItem:e=>(0,V.jsx)(g().A,{...e,isChecked:e.value.id===b.id,title:(0,_().GK)(h,e.value),icon:(0,V.jsx)(A().B6,{icon:(0,_().c2)(h,e.value),isEmptyPage:!1,size:20,disabled:!0,title:(0,_().GK)(h,e.value)})}),renderOrigin:e=>(0,V.jsxs)(m().p,{size:"sm",style:{fontWeight:"normal",fontSize:12,flexShrink:1},...e,children:[(0,V.jsx)(A().B6,{disabled:!0,icon:b.getIcon(),iconRecordCategory:"workspace",isEmptyPage:!1,size:16,title:b.getName(),style:{marginRight:4}}),(0,V.jsx)(O().j,{children:(0,_().GK)(h,b)}),(0,a().b)(K(p))]}),width:150};return(0,V.jsxs)("div",{children:[(0,V.jsx)(f().A,{size:1}),(0,V.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",padding:"4px"},children:(0,V.jsx)(w().A,{...k},"space-switcher")})]})}function Y(e){let{isLoading:t,autocompleteQuery:n,onAutocompleteQueryChange:o,isDataSource:a,isAddTo:c,isTurnIntoPage:m,moveToSpaceMenuStore:g,menuListStore:f}=e;const h=(0,d().tz)(),y=(0,r().DP)(),x=(0,i().K8)((()=>I().n6()&&N().Ay.state.isOpen&&"typed"===N().Ay.state.variant&&!L().c.state),[]),A=(0,i().K8)((()=>function(e){let{intl:t,isDataSource:n,isAddTo:o,isTurnIntoPage:i,moveToSpaceMenuStore:r}=e;if(n)return t.formatMessage({defaultMessage:"Move data source to…",id:"moveToMenuRenderer.moveDataSourceTo.label"});if(W(r))return t.formatMessage({defaultMessage:"Duplicate page…",id:"moveToMenuRenderer.duplicateToSpace.label"});if(I().n6()){const e=N().Ay.getDatabaseType();if(I().Hc()){const n=(0,p().$O)(e);return t.formatMessage({defaultMessage:"Move {typedItemName} to…",id:"moveToMenuRenderer.moveTo.typedLabel"},{typedItemName:n})}{const n=(0,p().$O)(e);return t.formatMessage({defaultMessage:"Search for a {typedItemName} database…",id:"moveToMenuRenderer.createIn.typedLabel"},{typedItemName:n})}}return i?t.formatMessage({defaultMessage:"Search page to add in…",id:"moveToMenuRenderer.addNewPageIn.label"}):o?t.formatMessage({defaultMessage:"Search page to add to…",id:"moveToMenuRenderer.addTo.label"}):t.formatMessage({defaultMessage:"Move page to…",id:"moveToMenuRenderer.moveTo.teamLabel"})}({intl:h,isDataSource:a,isAddTo:c,isTurnIntoPage:m,moveToSpaceMenuStore:g})),[h,a,c,m,g]),M=(0,i().K8)((()=>W(g)),[g]),w=(0,P().A)(t,400,0);return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(v().Ay,{onCancel:()=>{N().Ay.state.isOpen&&N().Ay.setState({...N().Ay.state,isOpen:!1})},preventCaptureArrowShortcuts:!n,disabled:x,focus:!j().A.isMobile||void 0,focusAfterAnimation:!0,value:n,onChange:e=>{o(e.target.value),f.setState({...f.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})},placeholder:A,inputLeft:(0,V.jsx)(v().Zf,{icon:s().q}),inputRight:w&&(0,V.jsx)(S().A,{style:{marginRight:2}}),style:{marginBottom:-2}}),M?(0,V.jsxs)(k().A,{isMultiline:!0,isSecondaryColor:!1,style:{background:y.palette.gray[30],marginTop:12,marginLeft:12,marginRight:12,padding:8,borderRadius:6},children:[(0,l().Q)({fill:y.palette.orange[400],width:14,height:14,marginRight:4,alignSelf:"center",display:"inline-block",verticalAlign:"text-bottom"}),(0,V.jsx)("span",{children:(0,V.jsx)(d().sA,{id:"moveBlockMenu.duplicateToSpace.message",defaultMessage:"You can only duplicate pages into another workspace — not move them."})}),(0,V.jsx)(b().A,{href:(0,T().xS)("guides.duplicateToSpace"),style:{color:y.palette.gray[500],fontWeight:u().Wy.semibold,marginTop:4},children:(0,V.jsx)(d().sA,{id:"moveBlockMenu.duplicateToSpace.learnMoreLink",defaultMessage:"Learn more"})})]}):void 0]})}},146594:(e,t,n)=>{n.d(t,{H:()=>r});var o=()=>n(645873);const i=new(o().O2)("UpdateSidebarTabInfo",(async()=>await Promise.all([n.e(75134),n.e(93282),n.e(3910),n.e(82122),n.e(21377)]).then(n.bind(n,722143)))),r=(0,o()._h)(i,(e=>e.UpdateSidebarTabInfo))},149257:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(296540),i=()=>n(959013),r=n(474848);const a=(0,i().YK)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const s=function(e){const{teamStore:t,teamName:s,teamId:l,isModalOpen:d,onDismiss:c}=e,[u,p]=(0,o.useState)(""),m=(0,n(484714).v3)(),g=(0,i().tz)(),f=async()=>{await n(350648).Ip({environment:m,teamId:l,message:u}),c()},h=(0,n(401497).IS)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,r.jsx)(n(676007).a,{open:d,onDismiss:c,innerStyle:h.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:h.requestTitle,children:(0,r.jsx)(i().sA,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:s,icon:(0,r.jsx)(n(898808).x,{style:h.icon,store:t,disabled:!0,size:22})}})}),(0,r.jsx)(n(623580).A,{textarea:!0,style:h.input,value:u,onChange:e=>{p(e.target.value)},placeholder:g.formatMessage(a.message_placeholder)}),(0,r.jsxs)("div",{style:h.footer,children:[(0,r.jsx)(n(125565).A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,r.jsx)(i().sA,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,r.jsx)(n(204063).A,{size:"lg",style:h.requestInvitesButton,onClick:f,children:(0,r.jsx)(i().sA,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},152077:(e,t,n)=>{n.d(t,{Vs:()=>d,WA:()=>l,YU:()=>c,bO:()=>a,lU:()=>s});var o=n(296540),i=n(474848);const r=o.createContext(void 0);function a(e){return(0,i.jsx)(r.Provider,{value:e.surface,children:e.children})}function s(){return o.useContext(r)}function l(){const e=s();return"TeamHome"===e||"PersonalHome"===e}function d(){return void 0===s()}function c(){return d()?12:0}r.displayName="PostFeedSurfaceContext"},154017:(e,t,n)=>{n.d(t,{b:()=>a});var o=()=>n(476492),i=()=>n(679924);var r=()=>n(504066);function a(e){const{environment:t,collectionContextStore:n,view_type:a,view_config_uri:s,from:l,...d}=e;!function(e,t){(0,i().v)(e,"create_view",t)}(t,{...(0,o().sl)(n)||{},...d,view_type:a,view_config_uri:s,from:l}),(0,r().f)({collectionContextStore:n,action:"create_view",from:l,property_type:void 0})}},167170:(e,t,n)=>{n.d(t,{_:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"3.29 3.29 13.41 13.41",svg:(0,n(474848).jsx)("path",{d:"M3.3 4.825c0-.842.683-1.525 1.525-1.525h3.15c.842 0 1.525.683 1.525 1.525v10.35c0 .842-.683 1.525-1.525 1.525h-3.15A1.525 1.525 0 0 1 3.3 15.175zm1.525-.275a.275.275 0 0 0-.275.275v10.35c0 .152.123.275.275.275h3.15a.275.275 0 0 0 .275-.275V4.825a.275.275 0 0 0-.275-.275zm5.675.275v3.15c0 .842.683 1.525 1.525 1.525h3.15c.842 0 1.525-.683 1.525-1.525v-3.15c0-.842-.683-1.525-1.525-1.525h-3.15c-.842 0-1.525.683-1.525 1.525m1.525-.275h3.15c.152 0 .275.123.275.275v3.15a.275.275 0 0 1-.275.275h-3.15a.275.275 0 0 1-.275-.275v-3.15c0-.152.123-.275.275-.275m0 5.95c-.842 0-1.525.683-1.525 1.525v3.15c0 .842.683 1.525 1.525 1.525h3.15c.842 0 1.525-.683 1.525-1.525v-3.15c0-.842-.683-1.525-1.525-1.525zm-.275 1.525c0-.152.123-.275.275-.275h3.15c.152 0 .275.123.275.275v3.15a.275.275 0 0 1-.275.275h-3.15a.275.275 0 0 1-.275-.275z"})},i=(0,n(340498).wt)("layout",o)},168345:(e,t,n)=>{n.d(t,{L:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 3.13 15.26 14.86",svg:(0,n(474848).jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})},i=(0,n(340498).wt)("comment",o)},171510:(e,t,n)=>{n.r(t),n.d(t,{AuthSyncListener:()=>y});n(898992),n(354520);var o=n(296540),i=()=>n(484714),r=()=>n(56366);const a="initial_handshake";var s=()=>n(798880),l=()=>n(959013),d=()=>n(496603),c=()=>n(763824),u=()=>n(498212),p=()=>n(780054),m=()=>n(630116),g=()=>n(179534),f=()=>n(214006),h=n(474848);const v=1;function y(){const e=(0,i().v3)(),t=(0,l().tz)(),n=`${p().A.identity.domainBaseUrl}/authSync`,y=e.currentUser.isLoggedIn(),[b,S]=(0,o.useState)(null),[x,A]=(0,o.useState)({value:!1,count:0}),M=(0,r().K8)((()=>g().A.getTotalUnreadMentionsCount()),[]),w=(0,r().K8)((()=>f().A.getAllSpaceViewStores(e)),[e]);(0,o.useEffect)((()=>{const e=t=>{const n=p().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(S(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,o.useEffect)((()=>{y&&(x.value||0===x.count||null==b||b.postMessage({version:v,name:"unreadCount",source:"notion",unreadCount:M}))}),[y,x.count,x.value,b,M]);const k=(0,o.useCallback)((async()=>{const e=d().hS(w,"userId"),n=await(0,c().lX)(e,10,(async e=>{if(!e.userId)return;const n=m().LU.createChildStore(e,{table:s().oo,id:e.userId});await n.load();const o=n.getEmail()??"",i=n.getDisplayName(t)??"";return{id:e.userId,displayName:i,emailAddress:o}}));null==b||b.postMessage({version:v,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,b,w]);(0,o.useEffect)((()=>{y&&b&&(x.value||0===x.count)&&k()}),[y,k,x.count,x.value,b]),(0,o.useEffect)((()=>{e.currentUser.id&&!(0,u().uj)(e.currentUser.id)||null==b||b.postMessage({version:v,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id?e.currentUser.id:"",type:"mutation"})}),[e.currentUser.id,b]),(0,o.useEffect)((()=>{y||(null==b||b.postMessage({version:v,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"}),null==b||b.postMessage({version:v,name:"accountSwitcher",source:"notion",accounts:[],persistCookie:!0}))}),[y,b]);const j=(0,o.useCallback)((e=>{if(e.data.version!==v)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)A((e=>({value:!0,count:e.count+1})))}),[]);return(0,o.useEffect)((()=>(S((e=>(e&&(e.onmessage=j),e))),()=>{S((e=>(e&&(e.onmessage=null),e)))})),[j,b]),(0,h.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(a,p().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},171789:(e,t,n)=>{n.d(t,{A:()=>s});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(874913),r=n(474848);function a(){const[e,t]=(0,o.useReducer)(((e,t)=>{switch(t.type){case"push":return[...e.map((e=>({...e,isAnimatingOut:!0}))),{item:t.item,isAnimatingOut:!1}];case"delete":return e.filter((e=>e.item.key!==t.key));case"clear":return e.map((e=>({...e,isAnimatingOut:!0})));default:return e}}),[]);return(0,o.useEffect)((()=>(null===i()||void 0===i()||i().snackbarReady(!0),()=>{null===i()||void 0===i()||i().snackbarReady(!1)})),[]),(0,o.useEffect)((()=>{const e=new(n(496506).ComputedStore)((()=>n(666429).Ay.state.currentItem),{debugName:"currentItemStore"});let o=null;function i(){const n=e.state;n&&o!==n.key?(t({type:"push",item:n}),o=n.key):n||t({type:"clear"})}return e.addListener(i),()=>{e.removeListener(i)}}),[]),(0,r.jsx)(n(177158).A,{open:e.length>0,zIndex:201,children:e.map((e=>(0,o.createElement)(l,{...e,key:e.item.key,dispatch:t})))})}const s=o.memo(a),l=o.memo((function(e){let{dispatch:t,isAnimatingOut:i,item:a}=e;const s=(0,n(401497).DP)(),l=(0,n(552871).L)(),d=(0,o.useCallback)((()=>{t({type:"delete",key:a.key})}),[t,a.key]),c=(0,o.useRef)(i);(0,o.useEffect)((()=>{if(!c.current&&i){const e=setTimeout(d,270);return()=>{d(),clearTimeout(e)}}c.current=i}),[i,d]);const u=a.position??"bottom",p="top"===u?{top:24}:{bottom:l};return(0,r.jsx)("div",{style:{...p,position:"fixed",left:0,width:"100%",display:"flex",zIndex:1e6,padding:4,pointerEvents:"none"},children:(0,r.jsxs)("div",{"aria-live":"polite",style:{background:s.tooltipBackground,color:s.text.contrastPrimary,borderRadius:8,padding:"11px 16px",boxShadow:s.shadowLG,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",...a.style,animationName:`snackbar-slide-in-${u}`,animationDuration:"270ms",animationTimingFunction:"ease",transitionProperty:"transform, opacity",transitionDuration:"270ms",transitionTimingFunction:"ease",transform:i?"scale(0.95)":"scale(1)",opacity:i?0:1},onTransitionEnd:i?d:void 0,children:[a.label,a.helpUrl&&(0,r.jsx)(n(296798).A,{href:a.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:s.text.contrastPrimary},children:(0,n(133033).$)({fill:s.text.contrastSecondary})}),(0,r.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:a.right})]})})}))},178998:(e,t,n)=>{n.d(t,{Z:()=>d});var o=()=>n(416726),i=()=>n(878377),r=()=>n(972435),a=()=>n(540758),s=()=>n(670631);const l=(0,n(959013).YK)({name:{id:"action.availableOffline.name",defaultMessage:"Available offline"}}),d=(0,o().fi)({key:"available offline",getSvgIcon:e=>{let{store:t}=e;return a().fF(t.id)&&a().Bd(t.id)?n(671089).checkmarkCircleIcon:a().fF(t.id)&&a().SS(t.id)?n(129852).exclamationMarkCircleIcon:n(973238).arrowInCircleDownIcon},displayName:l.name,label:r().A.formatMessage(l.name),isLoading:e=>{const t=void 0===s().A.state.offlinePages,n=a().B1(e.id);return t||n&&s().A.state.isSlowWrite},isChecked:e=>a().fF(e.id),validators:[i().SQN("download_for_offline"),i().or([i().b8R,i().wHP]),i().M3g,i().AU6(i().PaP),i().AU6(i().Pnk)],action:(e,t,o,i)=>{n(560868).lX({store:t,environment:e,analyticsFrom:i})},disabled:()=>!n(227440).A.state.online,renderTooltip:e=>{let{context:t}=e;const n=t.blocks[0];if(a().Bd(n.id)&&!a().fF(n.id))return r().A.formatMessage(o().AY.autoSyncedOfflinePageTooltip)},disableTooltip:e=>!a().Bd(e.id)||a().fF(e.id)})},189158:(e,t,n)=>{n.d(t,{f:()=>a});var o=()=>n(2220),i=()=>n(108944),r=()=>n(457717);function a(e,t){const n=i().fU(t);(0,o().u)({environment:e,event:{eventName:"topbar_breadcrumb_menu_click",eventProperties:{has_parent_pages:n.length>1}}}),r().F.setState({open:!0})}},189308:(e,t,n)=>{n.d(t,{aj:()=>_,pJ:()=>L,B2:()=>B,Sg:()=>D,_4:()=>R,X:()=>S});n(296540);var o=()=>n(584262),i=()=>n(75756),r=n(474848);const a={viewBox:"0 0 20 20",fittedViewBox:"2.87 2.37 13 15.25",directional:!0,svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v3.625h1.25V4.5c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v11a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875v-3.625h-1.25V15.5c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-11a2.125 2.125 0 0 0-2.125-2.125z"}),(0,r.jsx)("path",{d:"M12.442 9.558a.625.625 0 0 1 0 .884l-2.5 2.5a.625.625 0 0 1-.884-.884l1.408-1.408H3.5a.625.625 0 0 1 0-1.25h7.016L9.058 7.942a.625.625 0 1 1 .884-.884z"})]})},s=(0,n(340498).wt)("arrowRightIntoRectangle",a);var l=()=>n(589407),d=()=>n(864896),c=()=>n(348337),u=()=>n(89924),p=()=>n(878377),m=()=>n(492414),g=()=>n(599364),f=()=>n(416726),h=()=>n(346552);const v=(0,n(959013).YK)({signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"},topbarMobileMoreActionsMenu:{id:"action.topBarSiteMoreMobileActions.name",defaultMessage:"More"},search:{id:"topbar.publicPage.searchButton.label",defaultMessage:"Search"},reportFormName:{id:"action.reportForm.name",defaultMessage:"Report form"},viewOriginalPageName:{id:"action.viewOriginalPage.name",defaultMessage:"View original page"}}),y=(0,f().Ls)({key:"log in",displayName:v.signUpOrLogInName,analyticsName:v.signUpOrLogInName.defaultMessage,svg:s,validators:[p().AU6(p().M3g),p().IrU,p().AU6(p().ZVI)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;n(530216).Tv(t),await n(729283).VE(t,{utmContent:"sign_up_or_log_in",nextRoute:n(427704).JZ.login})}}),b=(0,f().Ls)({key:"view original page",displayName:v.viewOriginalPageName,analyticsName:v.viewOriginalPageName.defaultMessage,svg:n(47218).arrowExpandDiagonalBottomLeftToTopRightIcon,validators:[p().ZVI],closeParentMenu:!0,action:e=>{let{blocks:t}=e;const n=(0,m().Ay)({store:t[0],preferPublicLink:!0,pageVisitSource:o().y8.EmbedPublicPageViewOriginal,disableSlug:!0,embedded:!1});window.open(`${n}`,"_blank")}}),S=(0,f().Ls)({key:"report form",displayName:v.reportFormName,analyticsName:v.reportFormName.defaultMessage,svg:n(748054).M,validators:[p().Env,p().kD4],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;c().Hi(t,n[0].id)}}),x=(0,f().Ls)({key:"ios share link",displayName:v.shareLinkName,analyticsName:v.shareLinkName.defaultMessage,svg:d().Y,validators:[p().vXb,p().wHP,p().un6],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const i=t[0],r=i.getNavigableBlockStore();if(r){const e=(0,m().Ay)({store:r,scrollToBlockId:r.id===i.id?void 0:i.id,fullyQualified:!0,pageVisitSource:o().y8.NativeShareLink,embedded:!1});n.mobileNative&&n.mobileNative.share(e)}}}),A=(0,f().Ls)({key:"web share link",displayName:v.shareLinkName,analyticsName:v.shareLinkName.defaultMessage,svg:d().Y,validators:[p().vXb,p().rr0],closeParentMenu:!0,action:async e=>{let{blocks:t}=e;const n=t[0],i=n.getNavigableBlockStore();if(i){const e=(0,m().Ay)({store:i,scrollToBlockId:i.id===n.id?void 0:n.id,fullyQualified:!0,pageVisitSource:o().y8.NativeShareLink,embedded:!1});try{await navigator.share({url:e})}catch{}}}}),M=(0,f().Ls)({key:"android share link",displayName:v.shareLinkName,analyticsName:v.shareLinkName.defaultMessage,svg:n(441532).y,validators:[p().vXb,p().wHP,p().m01],closeParentMenu:x.closeParentMenu,action:x.action}),w=(0,f().Fw)({key:"copy link",displayName:f().AY.copyLinkName,analyticsName:f().AY.copyLinkName.defaultMessage,svg:n(742852).w,shortcuts:["copyLinkToBlock"],validators:[p().M3g,p().vXb,p().AU6(p().wHP),p().AU6(p()._fc)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,t,n)=>{let{lazyDependencies:o,environment:i,blocks:r}=t;const{clipboardActions:a}=o;a&&a.copyLinkToBlock({environment:i,blockStore:r[0],callback:e})}}),k=(0,f().Ls)({key:"edit page",displayName:v.editPageName,analyticsName:v.editPageName.defaultMessage,svg:n(105819).pencilLineIcon,validators:[p().vXb,p()._fc,p().Wci,p().AU6(p().V5t),p().FrL],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;c().T7(t,n[0].id)}}),j=(0,f().Ls)({key:"comment page",displayName:v.commentPageName,analyticsName:v.commentPageName.defaultMessage,svg:n(49621).h,validators:[p().vXb,p()._fc,n(930545).tm,p().AU6(p().M3g),p().FrL],closeParentMenu:!0,action:e=>{let{environment:t,blocks:n}=e;c().aL(t,n[0].id)}}),C=(0,f().Ls)({key:"fork page",displayName:v.duplicatePageName,analyticsName:v.duplicatePageName.defaultMessage,svg:n(764781).V,validators:[p().vXb,p().FrL,p()._fc,p().K1R],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:o,environment:i}=e;n(624550).Ul({environment:i,store:t[0],originRect:o})}});function I(e){return(0,f().Ls)({key:"more actions menu",displayName:v.topbarMobileMoreActionsMenu,analyticsName:v.topbarMobileMoreActionsMenu.defaultMessage,svg:l().L,validators:[p().vXb,p().FrL,p()._fc],closeParentMenu:!0,action:e})}const T=(0,f().Ls)({key:"back to my content",displayName:v.backtoNotionName,analyticsName:v.backtoNotionName.defaultMessage,svg:n(426388).S,validators:[p().M3g,p().FrL],closeParentMenu:!0,action:(e,t)=>{let{environment:i}=e;const{currentUserRootStore:r,currentUserSettingsStore:a}=n(765957).default.state;r&&a&&n(426116).t9({environment:i,userRootStore:r,userSettingsStore:a,pageVisitSource:o().y8.SwitchSpace})}}),_=(0,f().Ls)({key:"cookie settings",displayName:i().LS.cookieSettingsLabel,analyticsName:i().LS.cookieSettingsLabel.defaultMessage,validators:[p().AU6(p().ibx),p().Env],closeParentMenu:!1,render:e=>(0,r.jsx)(n(455215).A,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:o,...a}=e;return(0,r.jsx)(n(575143).A,{...a,...t,title:n(972435).A.formatMessage(i().LS.cookieSettingsLabel),svg:n(212727).gearIcon})}}),action:()=>{}}),P=(0,f().Ls)({key:"search page",displayName:v.search,analyticsName:v.search.defaultMessage,svg:n(207207).J,validators:[p().vXb,p().FrL,p()._fc,p().Kg6],closeParentMenu:!0,action:e=>{let{environment:t}=e;n(260488)._N({environment:t,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})}});function B(e){return(0,f().gy)({key:"page",render:e=>(0,r.jsx)(u().A,{...e}),actions:[P,C,j,k,w,g().oc,x,M,I(e)]})}function L(e){return(0,f().gy)({key:"page",render:e=>(0,r.jsx)(u().A,{...e}),actions:[A,x,M,I(e)]})}const R=[(0,f().gy)({key:"user",render:e=>(0,r.jsx)(u().A,{...e}),actions:[T,y,b]}),(0,f().gy)({key:"report page actions",render:e=>(0,r.jsx)(u().A,{...e}),actions:[h().H,S,_]})],D=[(0,f().gy)({key:"report page actions",render:e=>(0,r.jsx)(u().A,{...e}),actions:[h().H,_]})]},192940:(e,t,n)=>{n.d(t,{h:()=>r});var o=()=>n(56366),i=()=>n(37433);function r(e){return(0,o().K8)((()=>{var t;return void 0===e?0:(null===(t=(0,i().PF)({teamStore:e}))||void 0===t?void 0:t.memberCountWithGuests)??0}),[e])}},195795:(e,t,n)=>{n.d(t,{A:()=>S});n(898992),n(672577),n(737550);var o=n(296540),i=()=>n(484714),r=()=>n(921385),a=()=>n(953448),s=()=>n(741496),l=()=>n(845955),d=()=>n(494043),c=()=>n(56366),u=()=>n(961581);var p=()=>n(695625),m=()=>n(407054),g=()=>n(217429),f=()=>n(732770),h=()=>n(871399),v=()=>n(502438),y=()=>n(527606),b=n(474848);function S(e){const t=(0,i().v3)(),s=(0,a().J)(),[l,d]=(0,o.useState)([]),p=(0,c().K8)((()=>u().A.state.initialRenderCompleted),[]);(0,o.useEffect)((()=>{(async()=>{if(p){const{lowPriActionsWithKeyboardShortcuts:e}=await n.e(15498).then(n.bind(n,28965));d(e)}})()}),[p]);const m=(0,o.useRef)(),g=(0,o.useRef)();(0,o.useEffect)((()=>{function e(e){e.clientX===m.current&&e.clientY===g.current||(m.current=e.clientX,g.current=e.clientY,f().A.setKeyboardMode(!1))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]);const h=(0,o.useMemo)((()=>[...r().D0,...l]),[l]),v=(0,o.useMemo)((()=>function(e,t,n){const o={};for(const i of t)for(const r of i.shortcuts)o[r]=o=>A(r,o,e,t,n);return o}(t,h,s)),[t,h,s]);return(0,b.jsx)(y().k,{debugName:e.debugName,priority:e.priority,enable:e.capture,shortcuts:v})}function x(){return!function(){const e=document.querySelector("#intercom-container");return!(!e||!e.contains(document.activeElement))}()&&!(m().A.state.isActive&&!g().default.checkGate({gateName:"block_menu_shortcut_fix"}))}function A(e,t,n,o,i){if(!x())return;const r=v().default.state.stores,a=v().default.state.pivot||r[0],c=a&&p().T.getRectFromStore(a),u=o.find((t=>!!t.shortcuts.some((t=>t===e))&&l().F6(t,{environment:n,blocks:r,originRect:c,publicEditMode:void 0})));if(u){"keydown"===t.type&&t.preventDefault&&t.preventDefault();const e=m().A.state.isActive;u.action({environment:n,blocks:r,originRect:c,publicEditMode:void 0,analyticsFrom:"keyboard_shortcut",lazyDependencies:i},t);const o=r[0];let a,l,p,v;var y;if(o)a=o.getType(),l=a?(0,d().Yt)(a,o.getFormat()):void 0,p=null===(y=o.getCollectionStore())||void 0===y?void 0:y.id,v=o.getParentCollectionIdUpToTwoLevels();(0,s().N)(n,{analyticsName:u.analyticsName,action_type:u.analyticsActionType,from:"keyboard_shortcut",block_id:null==o?void 0:o.id,block_type:a,is_toggleable:l,collection_id:p,parent_collection_id:v}),b={resetBlockMenuStore:e},f().A.setKeyboardMode(!0),h().default.reset(),g().default.checkGate({gateName:"block_menu_shortcut_fix"})&&b.resetBlockMenuStore&&m().A.reset()}var b}},196163:(e,t,n)=>{n.d(t,{T:()=>x});n(296540);var o=()=>n(401497),i=()=>n(218275),r=()=>n(84817),a=()=>n(464708),s=()=>n(493823),l=()=>n(313633),d=()=>n(296798),c=()=>n(8980),u=()=>n(554509),p=()=>n(204063),m=n(474848);const g=480,f=16/9,h=20;function v(e){const{heroMedia:t,heroElement:n,width:i}=e,r=(0,o().IS)((()=>({heroContainer:{width:i,marginLeft:-h,marginTop:-h,...t?{position:"relative",aspectRatio:f,overflow:"hidden"}:{}}})),[t,i]);return(0,m.jsx)("div",{style:r.heroContainer,children:t?(0,m.jsx)(y,{src:t.src,alt:t.alt,type:t.type}):n})}function y(e){const{alt:t,src:n,type:i}=e,r=(0,o().IS)((()=>({media:{width:"100%",height:"100%",position:"absolute",objectFit:"cover",objectPosition:"top center"}})),[]);return"image"===i?(0,m.jsx)("img",{src:n,style:r.media,alt:t}):(0,m.jsx)("video",{title:t,src:n,style:r.media,autoPlay:!0,playsInline:!0,muted:!0,loop:!0,controls:!1})}function b(e){const{title:t,body:n,badge:i,eyebrow:s}=e,l=(0,o().IS)((()=>({container:{paddingRight:4,paddingBottom:12,paddingLeft:4,paddingTop:24},title:{textWrap:"pretty"},badge:{margin:0,alignSelf:"start"},badgeInline:{display:"inline-flex",verticalAlign:"middle",margin:"-4px 0 0 8px"}})),[]);return(0,m.jsxs)(r().Y1,{style:l.container,gap:4,children:[null!=s&&s.text?(0,m.jsxs)(r().Y1,{direction:"horizontal",align:"center-left",width:"hug",gap:4,children:[s.icon?(0,m.jsx)(c().I,{icon:s.icon,color:(null==s?void 0:s.iconColor)??"inherit"}):void 0,(0,m.jsx)(u().D,{styleName:"UIRegular-14px/Regular",colorName:(null==s?void 0:s.color)??"primary",children:s.text})]}):null!=i&&i.text?(0,m.jsx)(a().A,{content:i.text,color:i.color,style:l.badge}):void 0,(0,m.jsxs)(u().D,{styleName:"UITitle-26px/Bold",colorName:"primary",customStyles:l.title,children:[t,null!=s&&s.text&&null!=i&&i.text?(0,m.jsx)(a().A,{content:i.text,color:i.color,style:l.badgeInline}):void 0]}),(0,m.jsx)(u().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:n})]})}function S(e){const{link:t,secondary:n,primary:a}=e,l=(0,o().IS)((e=>({container:{marginTop:16},primary:{...null!=a&&a.isFullWidth?{width:"100%"}:{},...null!=a&&a.icon?{gap:4}:{}},link:{color:e.text.secondary,borderRadius:6,padding:"4px 8px",marginLeft:-4},linkIcon:{display:"inline-block",verticalAlign:"text-bottom",marginLeft:4},secondary:{color:e.text.secondary,padding:"0 12px",borderRadius:6,height:32,display:"flex",alignItems:"center"}})),[a]),g=a?(0,m.jsxs)(p().A,{color:"black",size:a.isFullWidth?"xl":"lg",onClick:a.onClick,style:l.primary,autoFocus:!0,children:[a.icon?(0,m.jsx)(c().I,{icon:a.icon}):void 0,a.text]}):void 0;if(null!=a&&a.isFullWidth)return(0,m.jsx)("div",{style:l.container,children:g});let f=(0,m.jsx)("div",{});t&&(f=(0,m.jsx)(d().A,{onClick:t.onClick,style:l.link,external:t.external,children:(0,m.jsxs)(u().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:[t.text,t.external?(0,m.jsx)(c().I,{icon:i().arrowUpRightSquareSmallIcon,size:"sm",color:"secondary",style:l.linkIcon}):void 0]})}));const h=n?(0,m.jsx)(s().p,{onClick:n.onClick,style:l.secondary,external:n.external,children:n.text}):void 0;return(0,m.jsxs)(r().Y1,{style:l.container,direction:"horizontal",align:"center",gap:"auto",children:[f,(0,m.jsxs)(r().Y1,{direction:"horizontal",gap:8,align:"center",width:"hug",children:[h,g]})]})}function x(e){const{title:t,body:n,badge:i,eyebrow:a,heroMedia:s,heroElement:d,primary:c,secondary:u,link:p,onDismiss:f,width:y,hideCloseButton:x}=e,A=y||g,M=(0,o().IS)((e=>({container:{width:A,padding:h,position:"relative",backgroundColor:e.surface.elevated}})),[A]);return(0,m.jsxs)(r().Y1,{style:M.container,direction:"vertical",children:[s||d?(0,m.jsx)(v,{heroMedia:s,heroElement:d,width:A}):void 0,(0,m.jsx)(b,{title:t,body:n,badge:i,eyebrow:a}),(0,m.jsx)(S,{primary:c,secondary:u,link:p}),x?void 0:(0,m.jsx)(l().A,{onClick:f})]})}},201170:(e,t,n)=>{n.d(t,{HX:()=>r,Hi:()=>i().Hi,lR:()=>a});var o=()=>n(736026),i=()=>n(348337);function r(){o().A.setState({open:!0,submitted:!1,error:void 0})}function a(){o().A.setState({open:!1})}},210748:(e,t,n)=>{n.d(t,{O:()=>s});var o=()=>n(857639),i=()=>n(134025),r=()=>n(534177),a=()=>n(751156);function s(e){var t;const{environment:n,layoutStore:s}=e,d=s.getPreviousViewsMainCollectionViewBlockPointer(),c=null===(t=s.getModuleByType("viewsMain"))||void 0===t?void 0:t.collection_view_block_pointer;if(!s.getModel()||!s.canEdit())return;const u=s.getBlockChildren(),{blocksToRemoveFromChildArray:p,clearPreviousPointer:m}=function(e){let{previousViewsMainBlockId:t,currentViewsMainBlockId:n,currentBlocksArray:o}=e;if(o.length>1)return l;const i=1===o.length?o[0]:void 0;if((0,r().O9)(n))return(0,r().O9)(t)?{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i===t&&n!==i?[t]:[]}:l;if((0,r().O9)(t)){return i===t?l:{clearPreviousPointer:!0,blocksToRemoveFromChildArray:i?[i]:[]}}return{clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}}({previousViewsMainBlockId:null==d?void 0:d.id,currentViewsMainBlockId:null==c?void 0:c.id,currentBlocksArray:u});if(!m&&0===p.length)return;const g=m?null:d;(0,o().log)({level:"info",from:"cleanupInvalidCollectionViewBlocks",type:"resetInvalidBlockChildrenArray",data:{layoutPointer:s.pointer,expectedPreviousPointer:g,actualPreviousPointer:c??null,actualChildIds:u}}),a().createAndCommit({environment:n,userAction:"cleanupInvalidCollectionViewBlocks.fixEmptyBlockChildren",canUndo:!1,perform:e=>{if(m&&a().applyOperation({store:s,transaction:e,operation:i().op.update({pointer:s.pointer,path:["format"],args:{previousViewsMainCollectionViewBlockPointer:null}})}),p.length>0)for(const t of p)a().applyOperation({store:s,transaction:e,operation:i().op.removeChild({pointer:s.pointer,path:["blocks"],args:{id:t}})})}})}const l={clearPreviousPointer:!1,blocksToRemoveFromChildArray:[]}},211825:(e,t,n)=>{n.d(t,{G:()=>a});var o=()=>n(484714),i=()=>n(56366),r=()=>n(486130);function a(e){const t=(0,o().v3)().currentUser.id;return(0,i().K8)((()=>Boolean(void 0!==t&&e.isNonGuestMember(t,r()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()})))),[t,e])}},218275:(e,t,n)=>{n.r(t),n.d(t,{arrowUpRightSquareSmallIcon:()=>r,iconDefinition:()=>i});n(296540);var o=n(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.25 11.25",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M6.898 5.025a.575.575 0 1 0 0 1.15h2.114l-3.969 3.968a.575.575 0 0 0 .814.814l3.968-3.969v2.114a.575.575 0 0 0 1.15 0V5.6a.575.575 0 0 0-.575-.575z"}),(0,o.jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zM3.625 4.25c0-.345.28-.625.625-.625h7.5c.345 0 .625.28.625.625v7.5c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625z"})]})},r=(0,n(340498).wt)("arrowUpRightSquareSmall",i)},218429:(e,t,n)=>{n.d(t,{l:()=>b});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(543906),l=()=>n(110750),d=()=>n(778417),c=()=>n(725614),u=()=>n(297872),p=()=>n(676007),m=()=>n(754002),g=()=>n(836251),f=()=>n(404141),h=()=>n(51367),v=()=>n(131448),y=n(474848);function b(e){const{messageKey:t,desktopRenderInner:n,desktopInnerStyle:o,desktopOnDismiss:d,phoneRenderInner:c,phoneInnerStyle:m,phoneOnly:b}=e,x=(0,i().v3)(),A=(0,i().Y0)(),M=(0,a().IS)((e=>({modalStyle:{background:e.surface.wash,borderRadius:12,...o}})),[o]),w=(0,r().K8)((()=>{var e;const t=(0,l().Xz)(x.TabbedRouterStore.state);return"web"===t.type&&((null===(e=t.redirectedTo)||void 0===e?void 0:e.route)||t.route)}),[x.TabbedRouterStore]),k=(0,r().K8)((()=>!(A.isPhone&&(0,g().Al)(x)&&(!w||"page"!==w.name))&&!f().A.state.open),[A.isPhone,x,w]),j=(0,r().K8)((()=>v().default.isVisible(t)),[t])&&k;return(0,s().A)((()=>{h().DL(x,{callout_key:t,is_forced:v().default.isForced(t),placement_key:"Modal"})}),j),j?A.isPhone?(0,y.jsx)(S,{messageKey:t,renderInner:c,innerStyle:m}):b&&!A.isPhone?null:(0,y.jsx)(p().a,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:d,innerStyle:M.modalStyle,render:()=>(0,y.jsx)(u().A,{capture:!0,allowEsc:!0,render:n})}):null}function S(e){const{renderInner:t,innerStyle:n,messageKey:r}=e,a=(0,i().v3)(),s=(0,o.useCallback)((()=>{h().Sq(a,{callout_key:r,dismiss_type:"modal_background_clicked",placement_key:"Modal"})}),[a,r]),l=(0,o.useCallback)((()=>{h().Sq(a,{callout_key:r,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"})}),[a,r]);return(0,o.useEffect)((()=>{d().IU({environment:a}),c().blurActiveElement()}),[a]),(0,y.jsx)(m()._,{renderInner:t,innerStyle:n,onDismiss:s,onClosed:l})}},220172:(e,t,n)=>{n.r(t),n.d(t,{MobilePageBacklinksMenuRenderer:()=>p});n(296540);var o=()=>n(56366),i=()=>n(959013),r=()=>n(722872),a=()=>n(352759),s=()=>n(765957),l=()=>n(592968),d=()=>n(928600),c=()=>n(897119),u=n(474848);function p(e){const t=(0,o().O$)(l().F);return(0,u.jsx)(c().Ay,{popupType:c().nl.BottomSheet,bottomSheetInitialState:"half",trapFocus:!0,open:t.isOpen,render:()=>(0,u.jsx)(m,{menuState:t}),onDismiss:()=>{l().F.setState({isOpen:!1})}})}function m(e){const t=(0,o().O$)(s().AppStoreMainEditorCurrentBlockStore);if(!e.menuState.isOpen)return null;if(t){const e={menuType:r().gu.Modal,title:(0,u.jsx)(i().sA,{defaultMessage:"Linked to this page",id:"page.expandedBacklinks.label"})};return(0,u.jsx)(d().A,{...e,children:(0,u.jsx)(a().t,{store:t})})}return null}},226916:(e,t,n)=>{n.d(t,{c:()=>y,t:()=>b});n(16280);var o=()=>n(908006),i=()=>n(388821),r=()=>n(919709),a=()=>n(970330),s=()=>n(319975),l=()=>n(751156),d=()=>n(62287),c=()=>n(184468),u=()=>n(389658),p=()=>n(972435),m=()=>n(129522),g=()=>n(765957),f=()=>n(217429),h=()=>n(75368);const v=(0,n(959013).YK)({formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}});function y(e){var t,n,r;const{environment:l,store:p,viewType:v,transaction:y}=e,b=null===(t=p.getBlockTitleStore())||void 0===t?void 0:t.getValue();f().default.checkGate({gateName:"mobile_keep_template_gallery_open"})&&h().A.state.open&&h().A.setState({open:!1});const S=p.getSpaceId()??(null===(n=g().default.state.currentSpaceStore)||void 0===n?void 0:n.id)??(null===(r=g().default.state.mainEditorCurrentBlockStore)||void 0===r?void 0:r.getSpaceId()),x=S?l.idCreator.getSpaceIdCreatorSync(S):void 0;(0,c().j)({environment:l,sourceBlockId:"root",targetBlockPointer:p.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().qP)({isInline:!1,viewType:v})),targetRecordCache:p.inMemoryRecordCache,transaction:y,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:x}),d().pd({environment:l,block:p,blockType:"collection_view_page",transaction:y}),b&&s().R9({environment:l,store:p.getBlockTitleStore(),value:b,transaction:y}),o().default.afterNextFlush((()=>{const e=m().K.findCollectionViewBlockFromStore(p);var t;e&&"handleCreated"in e&&(null===(t=e.handleCreated)||void 0===t||t.call(e))})),a().v(l,{from:"template_picker",type:"collection_view_page",creating_block_id:p.id,is_full_screen:!0,view_type:v})}async function b(e){var t,o,s;const{environment:m,store:f}=e,h=null===(t=f.getBlockTitleStore())||void 0===t?void 0:t.getValue(),{formsEditorDependency:y}=await Promise.resolve().then(n.bind(n,339034)),{formEditorActions:b}=await y.load(),S=f.getSpaceId()??(null===(o=g().default.state.currentSpaceStore)||void 0===o?void 0:o.id)??(null===(s=g().default.state.mainEditorCurrentBlockStore)||void 0===s?void 0:s.getSpaceId()),x=S?m.idCreator.getSpaceIdCreatorSync(S):void 0;l().createAndCommit({userAction:"HorizontalTemplatePicker.createForm",environment:m,canUndo:!0,perform:e=>{var t;(0,c().j)({environment:m,sourceBlockId:"root",targetBlockPointer:f.pointer,sourceBlockSubtree:(0,i().partialRecordMapToRecordMap)((0,u().mT)({isInline:!1,name:(0,r().w9s)(h)?(0,r().x9d)(p().A.formatMessage(v.formDatabaseTitle)):h})),targetRecordCache:f.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,spaceIdCreator:x}),d().pd({environment:m,block:f,blockType:"collection_view_page",transaction:e});const n=f.getCollectionStore(),o=null==n||null===(t=n.getModel())||void 0===t?void 0:t.getNormalizedSchema(),s=f;if(!o)throw new Error("Schema not found");const l=b.createCollectionFormEditorView({environment:m,transaction:e,collectionViewBlockStore:s,schema:o,initializeWithAllDefaultQuestions:!0});b.createResponsesCollectionView({environment:m,transaction:e,collectionViewBlockStore:s,schema:o}),a().v(m,{from:"template_picker",type:"form",creating_block_id:f.pointer.id,form_id:null==l?void 0:l.formId,view_id:s.id})}})}},231039:(e,t,n)=>{n.d(t,{N:()=>l});n(296540);var o=()=>n(401497),i=()=>n(568999),r=()=>n(959013),a=()=>n(460292),s=n(474848);function l(e){let{inviteTarget:t}=e;const n=(0,o().IS)((e=>({notionMemberLine:{display:"flex",alignItems:"center",gap:2},notionMemberIcon:{display:"flex",alignItems:"center",justifyContent:"center",color:e.icon.uiBluePrimary}})),[]);return(0,s.jsxs)("div",{style:n.notionMemberLine,children:[(0,s.jsxs)("div",{style:n.notionMemberIcon,children:[(0,s.jsx)(a().Q,{variantName:"fillSmall",iconGroup:i().g}),(0,s.jsx)(r().sA,{id:"invite.google_imports.notion_member.title",defaultMessage:"Notion Member"})]}),(0,s.jsx)("span",{children:"•"}),(0,s.jsx)("div",{children:t.value.email})]})}},233842:(e,t,n)=>{n.d(t,{u:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("notionCalendarLogo",{viewBox:"0 0 20 21",svg:(0,o.jsxs)("svg",{width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",children:[(0,o.jsxs)("g",{clipPath:"url(#clip0_970_53429)",children:[(0,o.jsx)("path",{d:"M2.17141 17.1924C1.81019 17.1884 1.48919 17.0958 1.23979 16.8633C1.23979 16.8633 1.23899 16.8633 1.23819 16.8617C1.20922 16.8336 1.18187 16.8046 1.15613 16.7756C0.959022 16.5504 0.852023 16.2615 0.852023 15.9494L0.849609 3.0915C0.849609 2.34732 1.47712 1.67957 2.21968 1.63371L15.0636 0.838839C15.0918 0.83723 15.1191 0.836426 15.1473 0.836426C15.4683 0.836426 15.7675 0.952277 15.996 1.16789C16.0274 1.19766 16.0572 1.22823 16.0845 1.26041C16.1585 1.34488 16.2197 1.43821 16.268 1.53877C16.2205 1.43901 16.1585 1.34569 16.0845 1.26121C16.2768 1.48487 16.3822 1.76967 16.3822 2.07861V2.40766C16.3822 2.40766 16.3902 2.67717 16.1231 2.69487L16.1247 2.69648L4.3114 3.43664C3.44494 3.49055 2.741 4.24117 2.741 5.10925C2.741 5.10925 2.73617 16.9768 2.73537 16.9961C2.72652 17.1924 2.56481 17.1924 2.43127 17.1924H2.17141Z",fill:"black"}),(0,o.jsx)("path",{d:"M19.1589 18.1882C19.1589 18.2075 19.1573 18.2269 19.1556 18.2462C19.1275 18.6589 18.7984 19.0225 18.3938 19.0973C18.3857 19.0973 18.3777 19.0998 18.3696 19.0998L4.66812 19.9292H4.62548C4.35758 19.9155 4.10979 19.8126 3.91671 19.6307C3.7003 19.4272 3.57882 19.1488 3.56997 18.8439C3.56997 18.8319 3.56836 18.8198 3.56836 18.8069V5.19278C3.56836 5.17347 3.56836 5.15497 3.56997 5.13566C3.59974 4.6988 3.96498 4.31746 4.40102 4.2724C4.41229 4.2724 4.42355 4.26919 4.43481 4.26838L17.5531 3.44616L18.1436 3.40915C18.1653 3.40754 18.187 3.40674 18.2087 3.40674C18.4557 3.40674 18.6858 3.49604 18.862 3.66097C18.9851 3.77601 19.072 3.92002 19.1186 4.08012C19.1388 4.14851 19.1508 4.22011 19.1556 4.29332V13.1785L19.1589 18.1874V18.1882Z",fill:"black"}),(0,o.jsx)("path",{d:"M20.001 4.36907C20.001 3.86302 19.8023 3.3972 19.4402 3.0577C19.0782 2.71819 18.6011 2.54763 18.0967 2.57981L17.3928 2.62245C17.2166 2.62808 17.2246 2.49212 17.2246 2.49212V2.08583C17.2246 1.49692 16.9929 0.955478 16.5722 0.560458C16.1514 0.165437 15.5955 -0.0324757 15.009 0.00372785L2.16349 0.798596C0.97121 0.872612 0.000976562 1.90482 0.000976562 3.09953L0.00339008 15.9574C0.00339008 16.5455 0.235088 17.0878 0.655844 17.4836C1.04442 17.8488 1.54724 18.0468 2.08465 18.0468C2.12889 18.0468 2.55448 18.0387 2.55448 18.0387C2.70975 18.0387 2.73549 18.1103 2.73549 18.2439V18.9012C2.73549 19.4289 2.94547 19.9157 3.32278 20.2705C3.67113 20.5979 4.12246 20.7749 4.60436 20.7749C4.62366 20.7749 4.64217 20.7733 4.66148 20.7733C4.67113 20.7733 4.67998 20.7749 4.68963 20.7749C4.73147 20.7749 4.7733 20.7733 4.81594 20.7709L18.3477 19.9519C18.4081 19.9478 18.4668 19.9406 18.5255 19.931C19.3461 19.8304 19.9994 19.1071 19.9994 18.2728L19.9978 18.2648C19.9978 18.2415 20.001 18.2181 20.001 18.1948V4.36907ZM2.17153 17.1996C1.81031 17.1956 1.48931 17.1031 1.23991 16.8705C1.23991 16.8705 1.23911 16.8705 1.23831 16.8689C1.20934 16.8408 1.18199 16.8118 1.15625 16.7829C0.959142 16.5576 0.852143 16.2688 0.852143 15.9566L0.84973 3.09873C0.84973 2.35454 1.47724 1.68679 2.2198 1.64093L15.0637 0.846063C15.0919 0.844454 15.1192 0.84365 15.1474 0.84365C15.4684 0.84365 15.7677 0.959501 15.9961 1.17511C16.0275 1.20488 16.0573 1.23545 16.0846 1.26763C16.1587 1.35211 16.2198 1.44543 16.2681 1.546C16.2206 1.44624 16.1587 1.35291 16.0846 1.26844C16.2769 1.49209 16.3823 1.7769 16.3823 2.08583V2.41488C16.3823 2.41488 16.3904 2.6844 16.1233 2.7021L16.1249 2.70371L4.31152 3.44387C3.44506 3.49777 2.74112 4.24839 2.74112 5.11647C2.74112 5.11647 2.73629 16.984 2.73549 17.0033C2.72664 17.1996 2.56493 17.1996 2.43139 17.1996H2.17153ZM19.1635 18.1948C19.1635 18.2141 19.1619 18.2334 19.1603 18.2527C19.1321 18.6654 18.8031 19.0291 18.3984 19.1039C18.3904 19.1039 18.3823 19.1063 18.3743 19.1063L4.67274 19.9358H4.6301C4.3622 19.9221 4.11441 19.8191 3.92133 19.6373C3.70492 19.4338 3.58344 19.1554 3.57459 18.8505C3.57459 18.8384 3.57298 18.8263 3.57298 18.8135V5.19934C3.57298 5.18003 3.57298 5.16152 3.57459 5.14221C3.60436 4.70536 3.9696 4.32402 4.40564 4.27896C4.41691 4.27896 4.42817 4.27574 4.43943 4.27494L17.5577 3.45272L18.1482 3.41571C18.1699 3.4141 18.1916 3.4133 18.2134 3.4133C18.4603 3.4133 18.6904 3.5026 18.8666 3.66752C18.9897 3.78257 19.0766 3.92658 19.1233 4.08668C19.1434 4.15507 19.1554 4.22667 19.1603 4.29988V13.185L19.1635 18.194V18.1948Z",fill:"white"}),(0,o.jsx)("path",{d:"M17.1877 17.7582L5.7163 18.426C5.24727 18.459 4.83215 18.2997 4.84502 17.685V8.11764C4.84502 7.7894 5.11533 7.57942 5.4138 7.56413L17.3398 6.84891C17.6375 6.83362 17.8812 7.04924 17.8812 7.34771V16.932C17.8812 17.2828 17.7935 17.7341 17.1901 17.7574H17.1885L17.1877 17.7582Z",fill:"white"}),(0,o.jsx)("path",{d:"M8.39759 10.4651C7.83685 10.4997 7.64699 10.9277 7.64779 11.5858V11.7016C7.58102 11.7177 7.5247 11.7322 7.45712 11.7362C7.05326 11.7612 6.76203 11.4329 6.76123 10.844C6.76042 9.94293 7.56654 9.09577 9.10234 9.00003C10.47 8.91475 11.3453 9.57607 11.3469 10.7426C11.3469 11.6204 10.6196 12.2439 9.90282 12.4386C11.248 12.5045 11.8095 13.2551 11.8111 14.2141C11.8127 15.8546 10.614 16.7838 8.76445 16.8988L8.71939 16.9012C7.32921 16.9881 6.35334 16.4596 6.35254 15.5472C6.35254 15.0275 6.73227 14.5882 7.30427 14.552C7.34932 14.5488 7.39357 14.5577 7.43862 14.5553C7.55206 15.4837 8.18037 15.8256 8.80789 15.787C9.41288 15.7492 9.83846 15.3413 9.83846 14.7636V14.7403C9.83766 13.8392 9.08625 13.7942 7.9535 13.7491L7.77329 12.6743C8.8272 12.4812 9.35334 12.1369 9.35254 11.5134C9.35254 10.8432 8.98166 10.4273 8.3984 10.4643H8.39759V10.4651Z",fill:"black"}),(0,o.jsx)("path",{d:"M13.4544 10.0227C12.3338 10.3469 12.0868 9.85373 12.2091 9.33803C12.8816 9.18034 14.6298 8.65579 15.2911 8.41846L15.2992 15.3374L16.5212 15.5152C16.5212 15.9657 16.2638 16.2473 15.8044 16.2762C15.4231 16.2996 14.5373 16.3317 14.1117 16.3583C13.4504 16.3993 12.2396 16.4983 12.2396 16.4983C12.2058 16.4082 12.1946 16.3165 12.1946 16.2352C12.1946 16.0156 12.2839 15.7903 12.5751 15.6913L13.4601 15.4049L13.4536 10.0227H13.4544Z",fill:"black"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_970_53429",children:(0,o.jsx)("rect",{width:"20",height:"20.7752",fill:"white"})})})]})})},236190:(e,t,n)=>{n.d(t,{c:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("minus",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M3.037 8.844h9.92a.705.705 0 00.368-.103.825.825 0 00.28-.28.73.73 0 000-.773.752.752 0 00-.28-.28.705.705 0 00-.369-.102H3.037a.705.705 0 00-.369.102.824.824 0 00-.28.28.73.73 0 000 .772.914.914 0 00.28.281.705.705 0 00.37.103z"})})},239529:(e,t,n)=>{n.d(t,{S:()=>d,q:()=>l});n(898992),n(672577);var o=()=>n(436696),i=()=>n(435009),r=()=>n(728611),a=()=>n(492414),s=()=>n(519839);function l(e){const{environment:t,collectionContextStore:n,event:a,buttonPopupParent:l}=e,d=(0,s().t2)(n);if(!d)return null;const c=r().Vr(a);i().oo({environment:t,url:d,openInNew:c}),c||null==l||l.close(),(0,o().X)({environment:t,collectionContextStore:n,action:"click_source_view"})}function d(e){var t;let{environment:n,collectionStore:o,pageVisitSource:s,event:l}=e;const d=o.getParentBlockStore();if(!d)return;const c=null===(t=d.getCollectionViewStores())||void 0===t?void 0:t.find((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===o.id})),u=(0,a().J8)({store:d,fullyQualified:!1,pageVisitSource:s,collectionViewId:null==c?void 0:c.id});i().oo({environment:n,url:u,openInNew:r().Vr(l)})}},264699:(e,t,n)=>{n.d(t,{_:()=>a});var o=()=>n(972435);const i=(0,n(959013).YK)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"}});function r(e){const{environment:t,store:o,viewType:i}=e;n(751156).createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,canUndo:!0,perform:e=>{(0,n(226916).c)({environment:t,store:o,viewType:i,transaction:e}),n(857783).uK({environment:t,store:o,pageVisitSource:n(584262).y8.LinkInPage});const r=o.getCollectionViewStores()[0];r&&(0,n(493260).F)(r.id,{viewType:i})}})}const a=[{name:o().A.formatMessage(i.table),type:"table",iconFn:n(421559).T,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>r({environment:e,store:t,viewType:"table"})},{name:o().A.formatMessage(i.board),type:"board",iconFn:n(969523).q,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>r({environment:e,store:t,viewType:"board"})},{name:o().A.formatMessage(i.list),type:"list",iconFn:n(202017).n,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>r({environment:e,store:t,viewType:"list"})},{name:o().A.formatMessage(i.timeline),type:"timeline",iconFn:n(397414).u,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>r({environment:e,store:t,viewType:"timeline"})},{name:o().A.formatMessage(i.calendar),type:"calendar",iconFn:n(42583).D,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>r({environment:e,store:t,viewType:"calendar"})},{name:o().A.formatMessage(i.gallery),type:"gallery",iconFn:n(858141).p,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>r({environment:e,store:t,viewType:"gallery"})}]},271459:(e,t,n)=>{n.r(t),n.d(t,{TopbarStopSuggestModeButton:()=>w});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(66913),l=()=>n(880922),d=()=>n(959013),c=()=>n(473227),u=()=>n(755199),p=()=>n(614415),m=()=>n(745766),g=()=>n(645873),f=()=>n(737230),h=()=>n(962730),v=()=>n(765957),y=()=>n(948914),b=()=>n(704152),S=()=>n(953006),x=n(474848);const A=(0,d().YK)({stopSuggestRole:{defaultMessage:"Turn off suggesting",id:"topbar.stopsuggestmodel."},tooltip:{defaultMessage:"You’re suggesting",id:"topbarStopSuggestModeButton.tooltip"},tooltipCommentOnlyContent:{defaultMessage:"Suggest edits or add comments",id:"topbarStopSuggestModeButton.tooltipCommentOnlyContent"}});function M(e){let{store:t,isVisible:n,compact:u,framerMotion:p}=e;const g=(0,i().v3)(),h=(0,d().tz)(),v=(0,r().O$)(y().b),S=(0,r().K8)((()=>f().Ay.state.expanded),[]),M=(0,a().IS)((e=>({button:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:256,color:e.text.uiBluePrimary,gap:0,height:28,background:e.palette.uiBlue[100],...(0,m().g)({noDrag:g.device.isElectron&&!v})},hoveredButton:{background:e.palette.uiBlue[200]},pressedButton:{background:e.palette.uiBlue[300]},suggestionIcon:{height:18,width:18,marginLeft:9,marginRight:7},text:{fontSize:14,lineHeight:1.428,marginRight:7},closeIcon:{height:14,width:14,fill:e.text.uiBlueSecondary,marginRight:9}})),[g.device.isElectron,v]),w=(0,o.useCallback)((()=>{c().PD({environment:g,navigableBlockStore:t,mode:"default",location:"stop_suggest_pill"})}),[g,t]),j=(0,o.useRef)(null),{AnimatePresence:C,motion:I}=p;return(0,x.jsx)(C,{children:n?(0,x.jsxs)(I.div,{ref:j,initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{duration:.1},children:[(0,x.jsxs)(b().A,{style:M.button,hoveredStyle:M.hoveredButton,pressedStyle:M.pressedButton,onClick:w,ariaLabel:h.formatMessage(A.stopSuggestRole),children:[(0,l().A)(M.suggestionIcon),(0,x.jsx)(C,{initial:S,children:u||S?void 0:(0,x.jsx)(I.div,{initial:{width:0},exit:{width:0},animate:{width:"auto"},transition:{duration:.1},style:M.text,children:(0,x.jsx)(d().sA,{id:"topbar.stopsuggestmodel.label",defaultMessage:"Suggesting"})})}),(0,s().V)(M.closeIcon)]},"button"),u||S?void 0:(0,x.jsx)(k,{store:t,origin:j})]}):void 0})}function w(e){const{value:t}=(0,g().fJ)(p().fM);return t?(0,x.jsx)(M,{...e,framerMotion:t}):null}function k(e){const{store:t,origin:n}=e,a=(0,d().tz)(),s=(0,i().v3)(),l=(0,r().K8)((()=>t.isCommentOnly()),[t]),c=(0,r().K8)((()=>{var e;return null===(e=v().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.dismissed_suggest_mode_tooltip}),[]),p=l||!c,[m,g]=(0,o.useState)(p);return m?(0,x.jsx)(S().k,{origin:n,alignmentToOrigin:h().C.Center,placementToOrigin:"bottom",header:(0,x.jsx)(x.Fragment,{children:a.formatMessage(A.tooltip)}),content:l?a.formatMessage(A.tooltipCommentOnlyContent):null,headerStyle:{marginBottom:-2,width:"max-content",maxWidth:240},contentStyle:{width:"max-content",maxWidth:240},hideCloseButton:!0,shouldDismissUponOutsideClick:!0,onCloseClick:()=>{g(!1),u().eO({environment:s,dismissed:!0})},pointerPosition:"50%",pointerLength:24}):null}},273321:(e,t,n)=>{n.d(t,{A:()=>T});var o=n(296540),i=()=>n(790748),r=()=>n(56366),a=()=>n(401497),s=()=>n(713998),l=()=>n(797809),d=()=>n(959013),c=()=>n(284371),u=()=>n(710648),p=()=>n(678553),m=()=>n(125565),g=()=>n(862292),f=()=>n(186445),h=()=>n(972435),v=()=>n(480289),y=()=>n(765957),b=()=>n(441467),S=()=>n(848565),x=()=>n(369767),A=()=>n(555776),M=()=>n(116008),w=()=>n(811879),k=()=>n(846583),j=()=>n(640753),C=()=>n(105157),I=n(474848);function T(e){const{environment:t,menuListItemProps:n,shouldShowTopDividerLine:T,shouldShowBottomDividerLine:_,shouldExpandDiscussionWidth:P,noBackgroundColors:B,onMouseEnter:L,onMouseLeave:R,onFocus:D,onBlur:N}=e,O=(0,r().O$)(y().AppStoreMainEditorCurrentBlockStore),E=(0,r().K8)((()=>(0,f()._m)(t)),[t]),U=S().eQ,F=(0,r().K8)((()=>A().A.state.isActivelyComposing),[]),V=(0,r().K8)((()=>A().A.state.isHovered),[]),z=(0,o.useCallback)((()=>{null==L||L()}),[L]),K=(0,o.useCallback)((()=>{null==R||R()}),[R]),W=(0,o.useCallback)((()=>{null==D||D()}),[D]),H=(0,o.useCallback)((()=>{M().A.hasContent()?A().A.resetAllActiveSources():(M().A.reset(),A().A.reset()),null==N||N()}),[N]),G=(0,d().tz)(),Y=(0,o.useRef)(null);(0,i().b)(v().A,(()=>({getNode:()=>Y.current})),[]);const q=(0,a().IS)((e=>({menuDiscussionItem:{marginLeft:-14,marginRight:-14,width:"calc(100% + 28px)"},discussionContainer:{paddingTop:t.device.isMobile?4:6,borderTop:!t.device.isMobile&&T?`1px solid ${e.regularDividerColor}`:void 0,borderBottom:!t.device.isMobile&&_?`1px solid ${e.regularDividerColor}`:void 0,transition:"background 300ms ease",background:B?void 0:F?e.focusDiscussionBackground:V?e.hoveredDiscussionBackground:void 0},comment:{position:"relative",fontSize:14},commentElementsBelowUserRow:{paddingLeft:S().FB},avatar:{marginTop:0,marginRight:8,userSelect:"none",WebkitUserSelect:"none"},userRow:{display:"flex",flexDirection:"row",alignItems:"center",userSelect:"none",WebkitUserSelect:"none"},placeholder:{height:8,width:81,borderRadius:6,background:e.lightDividerColor},draftLabel:{margin:"0 6px",flexBasis:140,whiteSpace:"normal",flexGrow:void 0,display:"inline",color:e.text.tertiary},commentAuthorPlaceholder:{marginRight:8,marginTop:2,height:U,width:U,borderRadius:20,flexShrink:0},container:{paddingTop:S().e4,paddingRight:16,paddingBottom:S().Wv,paddingLeft:16},noOverflow:{overflow:"hidden"},commentContext:{display:"flex",width:"100%",marginTop:6,marginBottom:22,fontSize:13,color:e.text.secondary},displayName:{fontWeight:c().Wy.medium,whiteSpace:"normal"},fullWidthFlex:{display:"flex",width:"100%"},smallTopPadding:{marginTop:1}})),[U,t.device.isMobile,V,F,B,_,T]),$=(0,o.useCallback)((async()=>{const e=await g().T.formulas.load();b().i5({environment:t,allowActionsWhileCommenting:!0,formulasModule:e})}),[t]),Q=(0,r().K8)((()=>!M().A.state.open||"reaction"===M().A.state.content),[]),Z=(0,r().K8)((()=>{var e;return M().A.getBlockStore()??(null===(e=M().A.getClosestBlockStore())||void 0===e?void 0:e.parentBlockStore)}),[]),X=(0,r().K8)((()=>M().A.getPropertyId()),[]),J=(0,r().K8)((()=>{if(X){var e;const t=null===(e=M().A.getBlockStore())||void 0===e?void 0:e.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const n=t.getSchema();return(0,s()._g)({schema:n,property:X})}}),[X]),ee=(0,r().K8)((()=>(0,l().RX)(h().A.getIntl()).title),[]),te=(0,r().O$)(M().f),ne=(0,r().K8)((()=>null==E?void 0:E.getDisplayName(G)),[E,G]),oe=(0,r().K8)((()=>null==Z?void 0:Z.getSpaceId()),[Z]),ie=(0,r().K8)((()=>b().Ek({environment:t})),[t]),re=(0,r().K8)((()=>M().A.getType()),[]),ae=(0,r().K8)((()=>null==Z?void 0:Z.getValue()),[Z]);if(Q||!ee||!E||!Z||!O||!te||!oe||!ae&&"block"===re||!ie&&"inline"===re)return null;const se="inline"===re||X,le="block"===re&&!X?(0,I.jsx)(u().Ay,{blockValue:ae,rootStore:Z,blockPreviewLocation:"comments_sidebar"}):se?(0,I.jsx)(u().vY,{value:{value:(null==ie?void 0:ie.context)??[],spaceId:oe},propertySchema:ee,labeled:!1,rootStore:Z,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0}):null;return(0,I.jsx)("div",{style:q.discussionContainer,ref:Y,onClick:null==n?void 0:n.onClick,onMouseEnter:z,onMouseLeave:K,children:(0,I.jsx)(p().Ay,{allowTextSelection:!0,style:q.menuDiscussionItem,title:(0,I.jsx)("div",{style:q.container,children:(0,I.jsxs)("div",{style:q.comment,children:[(0,I.jsxs)("div",{style:q.userRow,children:[(0,I.jsx)(w().E,{authorStore:E,avatarSize:U,avatarStyle:q.avatar,placeholderStyle:q.commentAuthorPlaceholder}),(0,I.jsxs)("div",{style:q.noOverflow,children:[(0,I.jsx)("span",{style:q.displayName,children:ne||(0,I.jsx)("span",{style:q.placeholder})}),(0,I.jsx)(m().A,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:q.draftLabel,children:(0,I.jsx)(d().sA,{defaultMessage:"Draft",id:"DraftCommentInputWithContext.draftLabel"})})]})]}),(0,I.jsxs)("div",{style:q.commentElementsBelowUserRow,children:[(0,I.jsx)("div",{style:q.commentContext,children:(0,I.jsxs)("div",{style:q.fullWidthFlex,children:[(0,I.jsx)(k().T,{}),J&&(0,I.jsx)(C().A,{propertySchema:J}),(0,I.jsx)("div",{style:q.smallTopPadding,children:le})]})}),(0,I.jsx)(j().A,{showAvatar:!1,parentStore:O,blockStore:Z,onSubmit:$,discussionInputStore:te,isNewComment:!0,isEditingExistingComment:!1,isMobileSlideUpMenu:!0,shouldSaveUnsentComments:!1,discussionFormat:x().DiscussionFormat.Sidebar,canDrop:!0,disableFocusRing:!0,adjustWidthForDraftDiscussions:P,dontMoveCursorToInputEndOnFocus:!0,onBlur:H,onFocus:W},"draft-comment-sidebar")]})]})})})},"draft-comment-discussion-updates")}},274072:(e,t,n)=>{n.r(t),n.d(t,{MobilePageUpdatesMenuRenderer:()=>S});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(959013),s=()=>n(722872),l=()=>n(446027),d=()=>n(928600),c=()=>n(480095),u=()=>n(897119),p=()=>n(401497),m=()=>n(577009),g=()=>n(765957),f=()=>n(187959),h=()=>n(131533),v=()=>n(569866),y=n(474848);function b(){const e=(0,o.useCallback)((()=>(0,y.jsx)(v().A,{message:(0,y.jsx)(a().sA,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),title:(0,y.jsx)(a().sA,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})})),[]),t=(0,r().O$)(g().AppStoreCurrentSpaceStore),n=(0,r().O$)(g().AppStoreMainEditorCurrentBlockStore),i=(0,r().K8)((()=>{var e;const t=null==n||null===(e=n.getCollectionPointer())||void 0===e?void 0:e.id,o=null==n?void 0:n.isCollectionView();return null!=n&&n.isDefined()?{id:n.id,isCollection:o,collectionId:t}:void 0}),[n]),s=(0,p().IS)((e=>({getNotifiedFor:{padding:18,backgroundColor:e.surface.wash}})),[]);return t&&i&&n?(0,y.jsxs)("div",{children:[(0,y.jsx)(m().QB,{navigableBlockStore:n,from:"page_updates",buttonPopupStore:f().A,style:s.getNotifiedFor}),(0,y.jsx)(h().A,{navigableBlockStore:n,collectionId:i.collectionId,spaceId:t.id,empty:e,source:"updates_sidebar"},"current-page")]}):null}function S(e){const t=(0,i().Y0)(),n=(0,r().O$)(l().A),a=(0,o.useCallback)((()=>{l().A.setState({open:!1})}),[]);return t.isMobile?(0,y.jsx)(u().Ay,{popupType:u().nl.BottomSheet,bottomSheetInitialState:"full",trapFocus:!0,open:n.open,render:()=>(0,y.jsx)(x,{onClose:a}),onDismiss:a}):null}function x(e){const{onClose:t}=e,n={menuType:s().gu.Modal,title:(0,y.jsx)(a().sA,{defaultMessage:"Page Updates",id:"pageUpdatesModal.mobileMenu.title"}),right:(0,y.jsx)(c().DoneMenuText,{}),onClickRight:t};return(0,y.jsx)(d().A,{...n,children:(0,y.jsx)(b,{})})}},275193:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(591779),l=n(474848);const d=(0,n(340498).wt)("appDownload",{viewBox:"0 0 23 16",svg:(0,l.jsx)("path",{clipRule:"evenodd",d:"m23 11.4338c0 2.5317-2.1591 4.5662-4.922 4.5662h-12.59789c-3.12888 0-5.48011-2.2739-5.48011-4.9804 0-2.2463 1.28998-4.10591 3.3576-4.43732.04574-2.57768 2.49761-4.2992 4.74821-3.63637 1.09785-1.61104 2.86359-2.94591 5.34289-2.94591 3.7418 0 6.6786 2.96433 6.6603 7.0702 1.784.75489 2.891 2.43038 2.891 4.3636zm-17.51989 3.084h12.59789c1.9487 0 3.449-1.3717 3.449-3.084 0-1.66625-1.0704-2.89065-2.7354-3.25889-.1098-.02761-.1556-.09206-.1464-.21173.0366-.43269.064-.92981.0366-1.35328-.1555-2.73418-2.2323-5.12774-5.2331-5.12774-2.3695 0-3.73271 1.30725-4.62014 2.89989-.05489.10126-.11893.12888-.22872.09206-1.8755-.6168-3.90652.22094-3.90652 3.05638 0 .11968-.04575.18412-.17383.18412-1.93954 0-3.04654 1.46376-3.04654 3.30499 0 1.878 1.70167 3.4982 4.00716 3.4982zm7.19089-9.49502c0-.39047-.3145-.70701-.7026-.70701-.388 0-.7026.31654-.7026.70701v4.89196l-1.61105-1.62112c-.27439-.27611-.71927-.27611-.99366 0-.2744.27611-.2744.72377 0 .99987l2.81051 2.82811c.2744.2761.7193.2761.9936 0l2.8106-2.82811c.2743-.2761.2743-.72376 0-.99987-.2744-.27611-.7193-.27611-.9937 0l-1.6111 1.62112z",fillRule:"evenodd"})});var c=()=>n(66913),u=()=>n(861017),p=()=>n(959013),m=()=>n(284371),g=()=>n(579631),f=()=>n(435009),h=()=>n(778450),v=()=>n(597755),y=()=>n(112799),b=()=>n(346),S=()=>n(567121),x=()=>n(962730),A=()=>n(765957),M=()=>n(927080),w=()=>n(493823),k=()=>n(285790),j=()=>n(187485),C=()=>n(897119),I=()=>n(204063),T=()=>n(73332),_=()=>n(125565);function P(){const e=(0,i().v3)(),t=(0,p().tz)(),[n,P]=(0,o.useState)(!0),{isDesktopBrowser:B,os:L}=(0,i().Y0)(),R=(0,r().K8)((()=>e.RouterStore.state.route.name in u().b1),[e]),D=(0,r().K8)((()=>A().default.state.inAppCalloutStore),[]),N=(0,r().K8)((()=>D.getCalloutVisibility("desktop_preference_popup").canShow),[D]),O=e.currentUser.isLoggedIn(),E=(0,r().O$)(M().A),[U,F]=(0,o.useState)(!1),V=(0,r().K8)((()=>M().A.canPersistToLocalStorage()),[]),z=!U&&O&&void 0===E&&B&&("mac"===L||"windows"===L)&&R&&V&&N,[K,W]=(0,o.useState)(!1),H=z&&K,G=(0,o.useRef)(!1);(0,o.useEffect)((()=>{z&&!G.current&&((0,h().e)(e).then((e=>{W(e)})),G.current=!0)}),[z,W,e,L]);const Y=(0,s().ZC)(H);(0,o.useEffect)((()=>{H&&!Y&&(g()._g(e),D.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!0,validateCanShow:!0}))}),[H,Y,e,D]);const q=(0,b().n_)(),$=(0,y().E)(),Q=(0,a().IS)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",minWidth:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:m().Wy.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34,marginLeft:12}})),[]);return(0,l.jsx)(C().Ay,{popupType:C().nl.Popup,placementToOrigin:x().W.Bottom,alignmentToOrigin:x().C.Center,origin:(0,l.jsx)("div",{style:Q.origin}),originGap:q?-S().ls/2:0,disableMouseCapture:!0,open:H,style:Q.container,render:()=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{style:Q.header,children:[(0,l.jsx)(_().A,{style:Q.headerText,children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,l.jsx)(k().A,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:c().V,onClick:()=>{M().A.setState("never"),F(!0),g().e1(e)}})]}),(0,l.jsx)(j().A,{external:!0,onClick:()=>{$.current&&(f().oo({environment:e,url:$.current,openInNew:"tab"}),g().co(e))},children:(0,l.jsxs)(w().p,{isGray:!0,size:"xs",style:Q.appDownloadButton,children:[d(Q.appDownloadIcon),(0,l.jsx)("span",{children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,l.jsxs)("div",{style:Q.actions,children:[(0,l.jsxs)("div",{style:Q.alwaysOpenLinks,children:[(0,l.jsx)(T().T,{checked:n,size:16,onClick:()=>{P(!n)}}),(0,l.jsx)(_().A,{isInline:!0,style:Q.alwaysOpenLinksLabel,children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]}),(0,l.jsx)(I().A,{style:Q.alwaysOpenLinksButton,onClick:()=>{M().A.setState(n?"always":"never"),F(!0),f().eG({url:(0,v().P)(window.location.href),environment:e}),g().SS(e,{always_open_in_app:n})},children:(0,l.jsx)(p().sA,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,l.jsx)("strong",{children:e})}})})]})]}),onClosed:()=>{D.updateCalloutStatus({calloutId:"desktop_preference_popup",visible:!1})}})}},289313:(e,t,n)=>{n.d(t,{Z:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("chevronLeftRounded",{viewBox:"0 0 24 24",directional:!0,svg:(0,o.jsx)("path",{d:"M7.1875 11.8594C7.1875 12.0547 7.25781 12.2266 7.40625 12.375L13.6016 18.4297C13.7344 18.5703 13.9062 18.6406 14.1094 18.6406C14.5156 18.6406 14.8281 18.3359 14.8281 17.9297C14.8281 17.7266 14.7422 17.5547 14.6172 17.4219L8.92969 11.8594L14.6172 6.29688C14.7422 6.16406 14.8281 5.98438 14.8281 5.78906C14.8281 5.38281 14.5156 5.07812 14.1094 5.07812C13.9062 5.07812 13.7344 5.14844 13.6016 5.28125L7.40625 11.3438C7.25781 11.4844 7.1875 11.6641 7.1875 11.8594Z"})})},291606:(e,t,n)=>{n.d(t,{AC:()=>r,dE:()=>s,Nw:()=>l,tn:()=>a});var o=()=>n(2220);const i=new(n(178624).R)({key:"offline_autosync_setting",namespace:n(419494).cd,important:!0,trackingType:"necessary"});function r(){return"on"===i.getState()}function a(e){let{environment:t}=e;const n=r()?"off":"on";(0,o().u)({environment:t,event:{eventName:"offline_autosyncing_toggled",eventProperties:{toggle_status:n}}}),i.setState(n)}function s(){return i.getState()}function l(e){i.setState(e)}},300451:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{settingOpen:"initial",permissionItem:void 0,from:void 0,sudoModeStore:void 0,location:"",faviconUrl:null,previewImageUrl:null,hideBreadcrumbs:!1,hideSearch:!1,hideWatermark:!1,enableDuplicateAsTemplate:!1,hideShare:!1,customHeaderBlockIds:[],googleAnalyticsId:void 0,theme:void 0,enableQna:!1}}}const i=new o},305837:(e,t,n)=>{n.d(t,{H:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("settingsUpgradeFilled",{viewBox:"0 0 20 20",svg:(0,o.jsx)("path",{d:"M10 19c4.935 0 9.009-4.073 9.009-9 0-4.926-4.082-9-9.018-9C5.065 1 1 5.074 1 10c0 4.927 4.074 9 9 9zm0-4.422c-.47 0-.818-.33-.818-.8v-4.23l.087-1.863-.81 1.01-1 1.053a.762.762 0 01-.558.235c-.435 0-.757-.314-.757-.74 0-.218.07-.392.218-.549l2.994-3.029c.2-.217.4-.313.644-.313.261 0 .461.104.662.313l2.976 3.03a.73.73 0 01.227.548c0 .426-.322.74-.758.74a.73.73 0 01-.557-.235l-.992-1.045-.818-1.027.087 1.871v4.23c0 .47-.348.801-.827.801z"})})},308228:(e,t,n)=>{n.d(t,{W:()=>s,m:()=>a});n(296540);var o=()=>n(959013),i=n(474848);const r=(0,o().YK)({addingGuestsToDefaultTeam:{id:"getTeamRoleDisabled.addingGuestsToDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"},addingGuestsAsNonOwner:{id:"getTeamRoleDisabled.addingGuestsAsNonOwner",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"},makingAGroupATeamGuest:{id:"getTeamRoleDisabled.makingAGroupATeamGuest",defaultMessage:"Groups can’t be teamspace guests"},upgradingAnOwnerAsNonOwner:{id:"getTeamRoleDisabled.upgradingAnOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to add another owner"},downgradeLastUserOwner:{id:"getTeamRoleDisabled.downgradeLastUserOwner",defaultMessage:"Add another teamspace owner to downgrade yourself to member"},downgradeToOwnerAsNonOwner:{id:"getTeamRoleDisabled.downgradeToOwnerAsNonOwner",defaultMessage:"You must be a teamspace owner to downgrade other teamspace owners"},removeLastUserOwner:{id:"getTeamRoleDisabled.removeLastUserOwner",defaultMessage:"Add another teamspace owner to leave the team"},removeLastGroupOwner:{id:"getTeamRoleDisabled.removeLastGroupOwner",defaultMessage:"Add another teamspace owner to remove this group"},downgradeLastMakingAGroupAnOwner:{id:"getTeamRoleDisabled.downgradeLastMakingAGroupAnOwner",defaultMessage:"Add another teamspace owner to make this group a member"},downgradingAMemberToAGuest:{id:"getTeamRoleDisabled.downgradingAMemberToAGuest",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."},removingMemberFromDefaultTeam:{id:"getTeamRoleDisabled.removingMemberFromDefaultTeam",defaultMessage:"Members cannot be removed from a default teamspace."},removingMemberAsMember:{id:"getTeamRoleDisabled.removingMemberTeam.noPermission",defaultMessage:"You must be a team owner to remove other team members in this teamspace."},changingTeamRoleAsNonTeamOwner:{id:"getTeamRoleDisabled.changingTeamRoleAsNonMember",defaultMessage:"You must be a teamspace owner to adjust team membership."}});function a(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}=e;return t||"owner"!==n?o&&"team_level_guest"===n?l(r.addingGuestsToDefaultTeam):!i&&"team_level_guest"===n||!t&&"team_level_guest"===n?l(r.addingGuestsAsNonOwner):{isDisabled:!1,disabledReason:void 0}:l(r.upgradingAnOwnerAsNonOwner)}function s(e){let{isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i,userIsEnterpriseWorkspaceOwner:s,originalTeamMemberInfo:d,onlyHasOneOwner:c,isUnowned:u,isMemberCurrentUser:p,canCurrentUserAddTeamMembers:m}=e;if("team_level_guest"===n&&"team_level_guest"!==d.type)return l(r.downgradingAMemberToAGuest);const g="owner"!==n&&"owner"===d.type;if(g&&!t)return l(r.downgradeToOwnerAsNonOwner);if(g&&c)return l("none"===n?"group"===d.entity_type?r.removeLastGroupOwner:r.removeLastUserOwner:"group"===d.entity_type?r.downgradeLastMakingAGroupAnOwner:r.downgradeLastUserOwner);if("none"===n&&o)return l(r.removingMemberFromDefaultTeam);return"group"===d.entity_type&&"team_level_guest"===n?l(r.makingAGroupATeamGuest):"owner"===n&&i&&"user"===d.entity_type&&u&&p||"owner"===n&&s&&p?{isDisabled:!1,disabledReason:void 0}:"none"===n?t||m&&"member"===d.type?{isDisabled:!1,disabledReason:void 0}:l(r.removingMemberAsMember):t?a({isCurrentUserTeamOwner:t,role:n,isDefaultTeam:o,userIsSpaceAdmin:i}):l(r.changingTeamRoleAsNonTeamOwner)}function l(e){return{isDisabled:!0,disabledReason:(0,i.jsx)(o().sA,{...e})}}},313633:(e,t,n)=>{n.d(t,{A:()=>s});n(296540);var o=()=>n(401497),i=()=>n(66913),r=()=>n(197190),a=n(474848);function s(e){const{top:t,right:n,onClick:s}=e,l=(0,o().IS)((e=>({buttonBackground:{position:"absolute",top:t??12,right:n??12,width:22,height:22,borderRadius:"100%",background:e.buttonBackground},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},buttonHovered:{background:e.buttonHoveredBackground},icon:{width:14,fill:e.icon.secondary}})),[t,n]);return(0,a.jsx)("div",{style:l.buttonBackground,children:(0,a.jsx)(r().A,{style:l.button,hoveredStyle:l.buttonHovered,onClick:s,children:(0,i().V)(l.icon)})})}},315841:(e,t,n)=>{n.d(t,{Js:()=>a,Ns:()=>i,d:()=>r});var o=()=>n(645873);const i={publishSite:new(o().O2)("PublishSite",(async()=>await Promise.all([n.e(9304),n.e(39541),n.e(35658),n.e(16345)]).then(n.bind(n,142650)))),publishedSiteSettings:new(o().O2)("PublishedSiteSettings",(async()=>await Promise.all([n.e(9304),n.e(39541),n.e(9066),n.e(39301)]).then(n.bind(n,348651))))},r=(0,o()._h)(i.publishedSiteSettings,(e=>e.default)),a=(0,o()._h)(i.publishSite,(e=>e.default))},339806:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=n(474848);const l=(0,n(340498).wt)("thanksShield",{viewBox:"0 0 27 32",svg:(0,s.jsx)("path",{d:"M13.5 31.672c.281 0 .672-.125 1.031-.328 8.75-5.063 11.64-6.969 11.64-12.344V7.125c0-1.672-.624-2.219-2.062-2.797-2.218-.89-7.14-2.719-9.375-3.484-.406-.14-.828-.235-1.234-.235-.422 0-.844.11-1.25.235-2.219.719-7.156 2.61-9.375 3.484C1.437 4.891.812 5.453.812 7.125V19c0 5.375 2.922 7.234 11.641 12.344.36.203.75.328 1.047.328zm0-2.14c-.266 0-.547-.126-.922-.36-7.25-4.5-9.844-5.797-9.844-10.547V7.485c0-.782.141-1.063.735-1.298 2.078-.828 7.187-2.656 9.281-3.468.281-.125.547-.188.75-.188.188 0 .438.078.75.188 2.078.812 7.156 2.703 9.266 3.469.593.218.734.515.734 1.296v11.141c0 4.75-2.625 6.016-9.844 10.547-.375.234-.656.36-.906.36zm-1.688-6.75c.391 0 .72-.188.954-.548l7.593-11.859c.141-.234.282-.5.282-.75 0-.531-.485-.906-.985-.906-.312 0-.61.203-.843.547L11.75 20.437 8.156 16c-.281-.375-.562-.484-.89-.484a.944.944 0 00-.938.953c0 .265.11.531.281.765l4.188 5c.297.391.61.547 1.015.547z",fill:"#636363"})});var d=()=>n(959013);const c=["dmca_no_action"],u=(0,d().YK)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"},dmca_no_action:{id:"reportPage.reportReasons.dmca_no_action",defaultMessage:"DMCA takedown request"}});var p=()=>n(381349),m=()=>n(496603),g=()=>n(284371),f=()=>n(449506),h=()=>n(901389),v=()=>n(201170),y=()=>n(780054),b=()=>n(186445),S=()=>n(135552),x=()=>n(972435),A=()=>n(722872),M=()=>n(836251),w=()=>n(227440),k=()=>n(736026),j=()=>n(716583),C=()=>n(297872),I=()=>n(623580),T=()=>n(928600),_=()=>n(678553),P=()=>n(939740),B=()=>n(819121),L=()=>n(484595);function R(e){let{name:t,title:n,caption:r,isSelected:l,onClick:d,disabled:c}=e;const[u,p]=(0,B().A)(),m=(0,i().Y0)(),g=(0,a().IS)((e=>({root:{position:"relative",display:"flex",alignItems:"center",flex:1,fontSize:14,marginBottom:8,cursor:"pointer",opacity:c?.4:1,...p&&{boxShadow:e.buttonBlueFocusRing}},caption:{color:e.text.secondary,marginLeft:8},input:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}})),[c,p]),f=(0,o.useCallback)((()=>{c||d()}),[c,d]);return m.isMobile?(0,s.jsx)(_().Ay,{title:n,right:(0,s.jsx)(L().A,{isSelected:l}),onClick:f}):(0,s.jsxs)("label",{style:g.root,children:[(0,s.jsx)(L().A,{isSelected:l}),(0,s.jsx)("div",{children:n}),r&&(0,s.jsx)("div",{style:g.caption,children:r}),(0,s.jsx)("input",{type:"radio",checked:l,disabled:c,name:t,onClick:f,style:g.input,ref:u})]})}var D=()=>n(864943),N=()=>n(89924),O=()=>n(690197),E=()=>n(719147),U=()=>n(327165);const F=(0,d().YK)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Please describe how this content violates our Content & Use Policy ({otherSelected, select, true {required} other {optional}})"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const V=function(){const e=(0,r().K8)((()=>k().A.state.open),[]);return(0,s.jsx)(n(641514).A,{ariaLabel:x().A.formatMessage(F.dialogLabel),onDismiss:Z,render:()=>(0,s.jsx)(te,{}),isOpen:e})};function z(e){const{reason:t,additionalInformation:n}=e;return void 0!==t&&(!c.includes(t)&&!("other_content_policy_violation"===t&&!n))}function K(){const{state:e}=k().A;if(e.open){const{reason:t,additionalInformation:n}=e;return z({reason:t,additionalInformation:n})}return!1}function W(e){let{modalState:t}=e;const{reason:n}=t;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R,{title:(0,s.jsx)(d().sA,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===n,onClick:()=>k().A.setState({...t,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,s.jsx)(R,{title:x().A.formatMessage(u.inappropriate_content),isSelected:"inappropriate_content"===n,onClick:()=>k().A.setState({...t,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,s.jsx)(R,{title:x().A.formatMessage(u.dmca_no_action),isSelected:"dmca_no_action"===n,onClick:()=>k().A.setState({...t,reason:"dmca_no_action"}),name:"report-page-modal"},"dmca_no_action"),(0,s.jsx)(R,{title:(0,s.jsx)(d().sA,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===n,onClick:()=>k().A.setState({...t,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function H(e){const t=k().A.getState();if(!t.open)return;const{additionalInformation:n,reason:o}=t,i=(0,b().Gu)();if(null==i||!i.id||!o||!z({reason:o,additionalInformation:n}))return void h().f1((0,s.jsx)(d().sA,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const r=await f().callApi({eventName:"reportPage",environment:e,data:{reason:o,page:i,additionalInformation:n}});"failed"===r.type?h().Qg(r):(k().A.setState({open:!1}),h().rG({message:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[l({width:32}),(0,s.jsx)("div",{style:{paddingTop:12,paddingBottom:8,textAlign:"center"},children:(0,s.jsx)(d().sA,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})}))}function G(e){return{width:360,padding:24,fontSize:14,color:e.text.secondary}}function Y(e,t){return{width:"100%",background:t.popoverBackground,display:"block",padding:y().A.isMobile?16:"10px 12px",height:y().A.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:y().A.isMobile?16:14}}function q(e){let{isMobile:t=!1}=e;return(0,s.jsx)(d().sA,{defaultMessage:"This page is hosted by Notion. Use this form to submit a report if you believe this page violates <contentpolicylink>Notion's content policy</contentpolicylink>.{br}{br}<clarification>This is not a contact form for the person or organization that authored this page</clarification>.",id:"reportPageModal.reportButton.description",values:{br:(0,s.jsx)("br",{}),contentpolicylink:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(0,s.jsx)(O().A,{title:n,href:(0,M().xS)("contentPolicy"),analyticsFrom:"report_page",style:{display:"inline",marginLeft:void 0},buttonStyle:{alignItems:"baseline",height:t?g().K_.UISmall.mobile:g().K_.UISmall.desktop,paddingLeft:"3px",paddingRight:"2px"},iconStyle:{alignSelf:"center",marginRight:"3px"},textSize:"small",isMobile:t})},clarification:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.jsx)("i",{children:t})}}})}function $(){return(0,s.jsx)(d().sA,{defaultMessage:"To submit a formal DMCA takedown request, please follow the instructions detailed in <dmcapolicylink>Notion's official DMCA policy</dmcapolicylink>.",id:"reportPageModal.reportButton.dmcaInstructions",values:{dmcapolicylink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.jsx)(E().A,{external:!0,href:"https://www.notion.so/notion/DMCA-Policy-69d880bd37fe496a9b7c64ccc65e024d",children:t})}}})}function Q(){const e=(0,a().DP)();return(0,s.jsx)("div",{style:G(e),children:(0,s.jsx)(d().sA,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function Z(){v().lR()}function X(){return(0,a().IS)((e=>({reportPageExplanation:{color:e.text.tertiary,background:e.contentBackground,border:`1px solid ${e.stroke.input}`},reportPageBanner:{justifyContent:void 0,whiteSpace:"normal",display:"block",paddingTop:"7px",paddingBottom:"7px",marginBottom:"15px"},mobileDescription:{color:p().Ay.lightTextColor,padding:"5px",fontSize:g().J.UISmall.mobile},modalTitle:{fontSize:16,marginBottom:12,fontWeight:g().Wy.medium}})),[])}function J(e){let{modalState:t}=e;const n=(0,a().DP)(),o=(0,i().v3)(),r=X();if(!t.open)return null;const{reason:l}=t,u={menuType:A().gu.Modal,title:(0,s.jsx)(d().sA,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,s.jsx)(d().sA,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:Z};return(0,s.jsx)(T().A,{...u,children:(0,s.jsx)(P().Ay,{type:P().Oh.Vertical,initialFocus:void 0,sections:m().oE([{key:"help",render:e=>{let{children:t,...n}=e;return(0,s.jsx)(N().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"help",render:()=>(0,s.jsx)(_().Ay,{title:(0,s.jsx)(q,{isMobile:!0}),textWrapperStyle:r.mobileDescription,shouldWrapTitle:!0,right:(0,s.jsx)(s.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...n}=e;return(0,s.jsx)(N().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"options",render:()=>(0,s.jsx)(W,{modalState:t}),action:()=>{}},{key:"additionalInfo",render:()=>l&&!c.includes(l)&&(0,s.jsx)(I().A,{textarea:!0,style:Y(0,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:x().A.formatMessage(F.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===l}),onChange:e=>{k().A.setState({...t,additionalInformation:e.target.value})}}),action:()=>{}}]},"dmca_no_action"===l?{key:"explain_dmca",render:e=>{let{children:t,...n}=e;return(0,s.jsx)(N().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"explain_dmca",render:()=>"dmca_no_action"===l&&(0,s.jsx)(_().Ay,{title:(0,s.jsx)($,{}),textWrapperStyle:{...r.mobileDescription,background:n.palette.yellow[100],color:n.palette.yellow[600],margin:"0px",padding:"10px 20px"},style:{display:"block"},shouldWrapTitle:!0,right:(0,s.jsx)(s.Fragment,{}),onClick:()=>{}}),action:()=>{}}]}:void 0,{key:"actions",render:e=>{let{children:t,...n}=e;return(0,s.jsx)(N().A,{...n,disableMobilePadding:!0,mobileStyle:{marginTop:"20px"},children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...n}=e,o=K();return(0,s.jsx)(U().A,{...n,disabled:!o,title:(0,s.jsx)("div",{style:{color:o?p().Ay.red:p().Ay.uiGray},children:(0,s.jsx)(d().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||H})},action:()=>H(o)}]}])},"main list")})}function ee(e){let{modalState:t}=e;const n=(0,a().DP)(),o=(0,i().v3)(),r=X();if(!t.open)return null;const{reason:l}=t,u="dmca_no_action"===l;return(0,s.jsx)(C().A,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,s.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,s.jsx)("div",{style:r.modalTitle,children:(0,s.jsx)(d().sA,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,s.jsx)(j().A,{isMobile:!1,textSize:"small",styleKey:S().q.Yellow,style:u?r.reportPageBanner:{...r.reportPageExplanation,...r.reportPageBanner},children:u?(0,s.jsx)($,{}):(0,s.jsx)(q,{})}),(0,s.jsx)("div",{children:(0,s.jsx)(W,{modalState:t})}),l&&!c.includes(l)&&(0,s.jsx)(I().A,{textarea:!0,style:Y(0,n),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:x().A.formatMessage(F.additionalInformationPlaceholder,{otherSelected:"other_content_policy_violation"===l}),onChange:e=>{k().A.setState({...t,additionalInformation:e.target.value})}}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,s.jsx)(D().A,{size:"lg",onClick:Z,style:{marginRight:12},children:(0,s.jsx)(d().sA,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,s.jsx)(D().A,{color:"uiRed",size:"lg",onClick:()=>H(o),disabled:!K(),disabledFeedback:!0,children:(0,s.jsx)(d().sA,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function te(){const e=(0,r().O$)(w().e),t=(0,r().O$)(k().A);return e?t.open?y().A.isMobile?(0,s.jsx)(J,{modalState:t}):(0,s.jsx)(ee,{modalState:t}):null:(0,s.jsx)(Q,{})}},341974:(e,t,n)=>{n.r(t),n.d(t,{TeamJoinLeaveButton:()=>y});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(284371),l=()=>n(640653),d=()=>n(37433),c=()=>n(515512),u=()=>n(211825),p=()=>n(959013),m=()=>n(493823),g=n(474848);const f=function(e){const{teamStore:t,from:a,navigateToTeamHomeOnJoin:s,style:l,hoveredStyle:d,icon:c,isRed:u}=e,f=(0,i().v3)(),h=(0,r().O$)(n(765957).AppStoreCurrentSpaceStore),v=(0,o.useCallback)((async()=>{h&&await n(848237).e2({environment:f,teamStore:t,currentSpaceStore:h,from:a,andNavigateToTeamHome:s??!1})}),[h,f,t,a,s]);return(0,g.jsx)(m().p,{style:l,hoveredStyle:d,onClick:v,iconLeading:c,isRed:u,children:(0,g.jsx)(p().sA,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var h=()=>n(655784);const v=function(e){const{teamStore:t,style:i,hoveredStyle:a}=e,[s,l]=(0,o.useState)(!1),d=(0,r().K8)((()=>t.getName()),[t]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(m().p,{style:i,hoveredStyle:a,onClick:()=>l(!0),children:(0,g.jsx)(p().sA,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,g.jsx)(n(149257).A,{teamStore:t,teamName:d,teamId:t.id,isModalOpen:s,onDismiss:()=>l(!1)})]})};function y(e){const{teamStore:t,style:n,hoveredStyle:o}=e,p=(0,i().v3)(),m=(0,c().Q)(),y=(0,u().G)(t),b=(0,r().K8)((()=>t.getTeamAccessLevel()),[t]),S=(0,a().IS)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:s().Wy.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...n},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...o}})),[n,o]),x=(0,r().K8)((()=>(0,d().A2)({membership:t.getRawMembership()})&&(0,l().s7)(p)),[p,t]),A=!y&&"open"===b||x,M=!y&&"closed"===b;return m?null:y?(0,g.jsx)(h().A,{...e,style:S.joinTeamButton,hoveredStyle:S.joinTeamButtonHoveredStyle}):A?(0,g.jsx)(f,{...e,style:S.joinTeamButton,hoveredStyle:S.joinTeamButtonHoveredStyle}):M?(0,g.jsx)(v,{teamStore:t,style:S.joinTeamButton,hoveredStyle:S.joinTeamButtonHoveredStyle}):null}},345578:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var o=()=>n(449552),i=()=>n(959013),r=()=>n(859428),a=()=>n(962730),s=n(474848);function l(e){let{iconStyle:t}=e;return(0,s.jsx)(r().A,{textWrap:!0,style:{width:210},placement:a().W.Bottom,renderTooltip:()=>(0,s.jsx)(i().sA,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,s.jsx)("div",{...e,children:(0,o().g)(t)})})}},346552:(e,t,n)=>{n.d(t,{H:()=>l});n(296540);var o=()=>n(959013),i=()=>n(381349),r=()=>n(878377),a=n(474848);const s=(0,o().YK)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),l=(0,n(416726).Ls)({key:"action report page",displayName:s.reportPageName,analyticsName:s.reportPageName.defaultMessage,validators:[r().sc7,r().Env,r().Kwf,r().AU6(r().kD4)],closeParentMenu:!0,render:e=>(0,a.jsx)(n(575143).A,{...e,style:{color:i().Ay.red},svg:n(748054).M,svgStyle:{fill:i().Ay.red},title:(0,a.jsx)(o().sA,{...s.reportPageName})}),action:e=>{let{blocks:t,environment:o}=e;n(201170).HX()}})},349990:(e,t,n)=>{n.d(t,{l:()=>a});var o=()=>n(484714),i=()=>n(56366),r=()=>n(154060);function a(){const e=(0,o().v3)();return(0,i().K8)((()=>(0,r().A)(e)),[e])}},350648:(e,t,n)=>{n.d(t,{D2:()=>w,Ip:()=>x,Jk:()=>A,YT:()=>M,e2:()=>b,g:()=>S});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520);var o=()=>n(584262),i=()=>n(798880),r=()=>n(946141),a=()=>n(449506),s=()=>n(246826),l=()=>n(436572),d=()=>n(426116),c=()=>n(751156),u=()=>n(972435),p=()=>n(640653),m=()=>n(37433),g=()=>n(765957),f=()=>n(999830),h=()=>n(848237),v=()=>n(263928);const y=(0,n(959013).YK)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function b(e){let{environment:t,userId:n,teamStore:o,user:i}=e;const a=o.getSpaceId();if(!a)return;await h().rU({environment:t,teamId:o.id,spaceId:a,teamUserInfo:i,isSettingDefaultTeam:!1,inviterId:n})&&(r().vo(t,{store:o,joined_role:"member",from:"team_invite_link"}),await S({environment:t,userId:n,teamStore:o}),l().D6({label:u().A.formatMessage(y.joinTeamSuccessMessage,{teamName:o.getName()})}))}async function S(e){let{environment:t,userId:n,teamStore:i}=e;const r=g().default.state.currentUserRootStore,a=i.getSpaceId();if(!a||!r)return;const s=r.getSpaceViewStores().filter((e=>e.getSpaceId()===a))[0];await d().tR({environment:t,spaceViewStore:s,userSettingsStore:void 0,userRootStore:r,pageVisitSource:o().y8.JoinTeam,navigationType:"switchingToOrLoadingSpace"}),(0,m().Qn)()?f().q.fetchUnfetchedTeams({userId:n,spaceId:a,teamTypes:new Set(["Joined"]),environment:t,callGetTeamsV2ApiFn:m().FK}):await v().J({environment:t,spaceId:a,userId:n}),h().L0({environment:t,teamStore:i,shouldScroll:!0})}async function x(e){let{environment:t,teamId:n,message:o}=e;if(!t.currentUser.id)return;"success"===(await a().callApi({eventName:"requestAccess",environment:t,data:{type:"current-actor-to-team",teamId:n,message:o}})).type?(r().XQ(t,{teamId:n}),await M({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{l().D6({label:u().A.formatMessage(y.requestTeamSuccessMessage)})}))):l().D6({label:u().A.formatMessage(y.requestTeamFailureMessage)})}async function A(e){let{environment:t,teamStore:n,accessRequestStore:o,status:a}=e;const l=o.getForActorId();if(!l)return;const d=o.getRecordModel({table:i().oo,id:l});if(d){if("approved"===a){const e=[{type:"member",entity_type:"user",user_id:d.id}];if(!(await h().Zd({environment:t,teamStore:n,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}c().createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,canUndo:!0,perform:e=>{s().zv({store:o,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:i().oo,resolved_by_id:t.currentUser.id,status:a}})}}),r().GW(t,{store:n,resolution:a})}}async function M(e){let{environment:t}=e;const{lastVisitedSpaceView:n,userRootStore:i,userSettingsStore:r}=await(0,p().ex)({environment:t,disableRedirectUrl:!1});n?await d().tR({environment:t,spaceViewStore:n,userRootStore:i,userSettingsStore:r,pageVisitSource:o().y8.BackForward,navigationType:"switchingToOrLoadingSpace"}):await d().t9({environment:t,userRootStore:i,userSettingsStore:r,pageVisitSource:o().y8.BackForward})}async function w(e){let{environment:t,teamId:n}=e;const o=await a().callApi({eventName:"getTeamAccessRequestMetadata",environment:t,data:{teamId:n}});if("success"===o.type)return o.data}},353289:(e,t,n)=>{n.r(t),n.d(t,{MembersTabTitle:()=>Hn,PeopleRow:()=>Kn,SettingToggle:()=>Gn,SidebarTeamModal:()=>Wn});n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(959013),l=()=>n(496603),d=()=>n(534177),c=()=>n(284371),u=()=>n(946141),p=()=>n(38337),m=()=>n(37433),g=()=>n(249847),f=()=>n(632709),h=()=>n(756279),v=()=>n(765957),y=()=>n(630116),b=()=>n(991249),S=()=>n(341974),x=()=>n(345578),A=(n(944114),()=>n(820579)),M=()=>n(340498),w=()=>n(381349),k=()=>n(436572),j=()=>n(751156),C=()=>n(297872),I=()=>n(623580),T=()=>n(204063),_=()=>n(859428),P=()=>n(125565),B=()=>n(972435),L=()=>n(213525),R=()=>n(962730),D=()=>n(848237),N=()=>n(605685),O=()=>n(43450);function E(e){return!(0,O().R)(e)}var U=()=>n(976519),F=()=>n(211825),V=()=>n(655784),z=()=>n(812941),K=()=>n(898808),W=()=>n(235741),H=()=>n(493823),G=()=>n(802790),Y=n(474848);function q(e){let{title:t,subtitle:n,style:o}=e;const i=(0,a().IS)((e=>({base:{width:"100%"},title:{fontWeight:c().Wy.medium,color:e.text.primary,fontSize:14},subtitle:{fontWeight:c().Wy.regular,color:e.text.secondary,fontSize:12}})),[]);return(0,Y.jsxs)("div",{style:{...i.base,...o},children:[(0,Y.jsx)("div",{style:i.title,children:t}),n&&(0,Y.jsx)("div",{style:i.subtitle,children:n})]})}const $=15,Q=8,Z=20;function X(e){const t=(0,a().IS)((()=>({button:{height:"auto",paddingLeft:0,paddingRight:0,display:"flex"},title:{marginBottom:10}})),[]);return Boolean(e.onClick)?(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(q,{title:e.title,style:t.title}),(0,Y.jsx)(H().p,{onClick:e.onClick,style:t.button,children:(0,Y.jsx)(J,{...e})})]}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(q,{title:e.title,style:t.title}),(0,Y.jsx)(J,{...e})]})}function J(e){let{title:t,rows:n,hideDividers:i=!1,itemStyle:r,onClick:s}=e;const l=(0,a().IS)((e=>({container:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,width:"100%"},list:{listStyle:"none",padding:0,margin:0},listItem:{marginLeft:$,marginRight:$,paddingTop:Q,paddingBottom:Q,...r},divider:{marginLeft:$,marginRight:$,borderColor:`${e.regularDividerColor}`}})),[r]);return(0,Y.jsx)("div",{style:{...l.container},children:(0,Y.jsx)("ul",{style:l.list,children:n.map(((e,t)=>(0,Y.jsxs)(o.Fragment,{children:[!i&&t>0&&(0,Y.jsx)(G().A,{size:1,innerStyle:l.divider}),(0,Y.jsx)("li",{style:l.listItem,children:e},t)]},t)))})})}var ee=()=>n(640653),te=()=>n(144707);const ne=(0,s().YK)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),oe=(0,s().YK)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function ie(e){let{teamStore:t}=e;const n=(0,a().IS)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),o=f().p.Members,i=(0,r().K8)((()=>t.getTeamAccessLevel()),[t]);return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("div",{style:n.spacer}),(0,Y.jsx)(X,{title:(0,Y.jsx)(s().sA,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,Y.jsx)(te().u,{currentAccessLevel:i,teamStore:t,disabledWithRightChevron:!0,style:n.accessLevelButton},"visibility"),(0,Y.jsx)(re,{teamStore:t},"permissions")],onClick:()=>{f().A.state.open&&f().A.setState({...f().A.state,tab:o})},itemStyle:n.listItem})]})}function re(e){let{teamStore:t}=e;const n=(0,r().O$)(v().AppStoreCurrentSpaceStore),o=(0,i().v3)(),s=(0,a().IS)((e=>({label:{color:e.text.primary,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,r().K8)((()=>t.getTeamPermission()),[t]),d=(0,r().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,r().K8)((()=>{if(!n)return{spaceIcon:void 0,spaceName:void 0};const e=(0,ee().GK)(o,n);return{spaceIcon:(0,Y.jsx)(K().x,{disabled:!0,store:n,size:20,style:s.icon}),spaceName:e}}),[n,o,s.icon]),p=(0,r().K8)((()=>(0,Y.jsx)(K().x,{disabled:!0,store:t,size:20,style:s.icon})),[t,s.icon]),m=(null==l?void 0:l.role)??"none",g=!(m===d.role),f=g?p:c,h=B().A.formatMessage(oe[d.role],{showTeam:g,spaceName:u}),y=B().A.formatMessage(ne[m]);return(0,Y.jsxs)("div",{style:s.row,children:[f,(0,Y.jsxs)(P().A,{isSmall:!0,style:s.label,children:[g&&(0,Y.jsxs)(Y.Fragment,{children:[y,(0,Y.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),h]})]})}var ae=()=>n(934999),se=()=>n(638743),le=()=>n(709062),de=()=>n(963589),ce=()=>n(118849),ue=()=>n(233510),pe=(n(898992),n(672577),()=>n(668725)),me=()=>n(68263),ge=(n(354520),()=>n(273900));const fe=["none","reader","comment_only","read_and_write","editor"],he=["reader","comment_only","read_and_write"],ve=["reader","comment_only","read_and_write","editor"],ye=["editor"];function be(e){const t=function(e){var t,n;let{teamId:o,permissions:i}=e;const r=(null===(t=i.find((e=>(0,me().Lg)(e))))||void 0===t?void 0:t.role)??"none",a=(null===(n=i.find((e=>(0,me().gl)(e)&&e.team_id===o)))||void 0===n?void 0:n.role)??r,s=i.find((e=>(0,me().un)(e)));return{spacePermission:{type:"space_permission",role:r},teamMemberPermission:{type:"explicit_team_permission",team_id:o,role:a},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:o,role:"editor"},...s&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:o,role:s.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:n,teamMemberPermission:o}=t,i={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},r={spacePermission:xe({roles:fe,currentRole:o.role}),teamGuestPermission:he,teamMemberPermission:Se({roles:ve,currentRole:n.role}),teamOwnerPermission:ye},{visibility:a,space_member_join_access:s}=e.settings;return"team_members"===a&&(i.space_member_join_access=["invite_only"],r.spacePermission=["none"]),"self_join"===s&&(i.visibility=["space_members"],i.invite_access=["team_members"],r.spacePermission=r.spacePermission.filter((e=>"none"!==e))),e.is_default&&(r.teamMemberPermission=[o.role],r.spacePermission=[o.role]),{settingsOptions:i,permissionItemRoleOptions:r,currentTeamPermissionItems:t}}function Se(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,ge().Pr)(e,n)))}function xe(e){let{roles:t,currentRole:n}=e;return t.filter((e=>(0,ge().Y1)(e,n)))}var Ae=()=>n(760217),Me=()=>n(406699),we=()=>n(928600),ke=()=>n(939740),je=()=>n(89924),Ce=()=>n(946548),Ie=()=>n(722872),Te=()=>n(553965);function _e(e){let{teamStore:t}=e;const n=(0,r().K8)((()=>t.getSettingsStore().getValue()),[t]),o=(0,r().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return be({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!n||!o)return null;const i=[(0,Y.jsx)(Be,{teamStore:t,hasMultiInviteAccessOptions:1===o.settingsOptions.invite_access.length,inviteAccess:n.invite_access},"invite"),(0,Y.jsx)(Pe,{teamStore:t,disablePageEdits:n.disable_team_page_edits},"editSidebar"),(0,Y.jsx)(Le,{teamStore:t},"toggleInviteLink")];return(0,Y.jsx)(X,{title:(0,Y.jsx)(s().sA,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:i,hideDividers:!0})}function Pe(e){const{teamStore:t,disablePageEdits:n}=e,a=(0,i().v3)(),l=E(t),d=(0,r().K8)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),c=(0,o.useCallback)((e=>{j().createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:a,canUndo:!0,perform:n=>{D().WC({environment:a,store:t,update:{disable_team_page_edits:e},transaction:n})}})}),[a,t]),u=(0,me().p2)(d),p=[{option:!0,label:(0,Y.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>c(!0)}];return u&&p.push({option:!1,label:(0,Y.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>c(!1)}),(0,Y.jsx)(Re,{title:(0,Y.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,Y.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:l||!u,currentOption:!u||Boolean(n),allOptions:p,optionTooltip:u?void 0:(0,Y.jsx)(s().sA,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function Be(e){const{teamStore:t,hasMultiInviteAccessOptions:n,inviteAccess:r}=e,a=(0,O().R)(t),l=(0,i().v3)(),d=(0,o.useCallback)((e=>{j().createAndCommit({userAction:"team.setInviteAccess",environment:l,canUndo:!0,perform:n=>{D().WC({environment:l,store:t,update:{invite_access:e},transaction:n})}})}),[l,t]),c=!a||n;return(0,Y.jsx)(Re,{title:(0,Y.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite or remove teamspace members"}),disabled:c,optionTooltip:c&&a&&(0,Y.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:r,allOptions:[{option:"team_members",label:(0,Y.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d("team_members")},{option:"team_owners",label:(0,Y.jsx)(s().sA,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d("team_owners")}]})}function Le(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,r().K8)((()=>(0,m().FQ)(t)),[t]),l=E(t),d=(0,a().IS)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,Y.jsxs)("div",{style:d.container,children:[(0,Y.jsxs)("div",{children:[(0,Y.jsx)(P().A,{children:(0,Y.jsx)(s().sA,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,Y.jsx)(P().A,{isSmall:!0,style:d.subtitle,children:(0,Y.jsx)(s().sA,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,Y.jsx)("div",{style:d.switcher,children:(0,Y.jsx)(Ce().A,{disabled:l,on:!o,onClick:()=>{j().createAndCommit({userAction:"team.setInviteAccess",environment:n,canUndo:!0,perform:e=>{D().WC({environment:n,store:t,update:{disable_invite_link:!o},transaction:e})}})}})})]})}function Re(e){const{title:t,caption:n,currentOption:o,allOptions:r,disabled:s,optionTooltip:l}=e,d=(0,i().Y0)(),c=(0,a().IS)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},chevron:{width:10,marginLeft:4,fill:e.icon.tertiary},buttonStyle:{fontSize:12.5,color:e.text.secondary},tooltipWidth:{width:300}})),[]),u=r.find((e=>e.option===o));return u?(0,Y.jsxs)("div",{style:c.root,children:[(0,Y.jsxs)("div",{style:c.title,children:[t,n&&(0,Y.jsx)(P().A,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:n})]}),(0,Y.jsx)(_().A,{style:c.tooltipWidth,placement:R().W.Top,alignment:R().C.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,Y.jsx)(Me().Ay,{...e,disablePopup:s,popupType:d.isMobile?Me().z7.SlideUp:Me().z7.Popup,alignmentToOrigin:Me().yP.End,renderOrigin:t=>(0,Y.jsxs)(H().p,{style:c.buttonStyle,disabled:s,...(0,Te().A)(e,t),children:[u.label,!s&&(0,pe().b)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:Ie().gu.ActionSheet}:{menuType:Ie().gu.Popup,minWidth:150};const n=[{key:"options",render:e=>(0,Y.jsx)(je().A,{...e}),items:r.map((t=>{const n={key:t.option.toString(),render:e=>(0,Y.jsx)(Ae().A,{...e,title:t.label,caption:t.caption,isChecked:o===t.option}),action:()=>{t.action(),e.close()}};return n}))}];return(0,Y.jsx)(we().A,{...t,children:(0,Y.jsx)(ke().Ay,{type:ke().Oh.Vertical,initialFocus:void 0,sections:n})})}})})]}):null}function De(e){let{teamStore:t}=e;const n=(0,a().IS)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]);return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(_e,{teamStore:t}),(0,Y.jsx)("div",{style:n.spacer}),(0,Y.jsx)(Ne,{teamStore:t}),(0,Y.jsx)(z().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:n.learnMoreLinkContainer,message:(0,Y.jsx)(s().sA,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function Ne(e){let{teamStore:t}=e;const n=(0,r().O$)(v().AppStoreCurrentSpaceStore),o=(0,i().v3)(),l=(0,ue().Z)(),d="enterprise",c=(0,de().X)("sharing_anyone_with_the_link"),{organizationOverrides:u}=(0,se().n)({spaceId:null==n?void 0:n.id}),p=o.currentUser.id,m=(0,r().K8)((()=>({disable_public_access:{spaceIsDisabled:(null==n?void 0:n.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess(),isControlledByOrganization:Boolean(u.disable_public_access)},disable_export:{spaceIsDisabled:(null==n?void 0:n.getDisableExport())??!1,teamIsDisabled:t.getDisableExport(),isControlledByOrganization:Boolean(u.disable_export)},disable_guests:{spaceIsDisabled:(null==n?void 0:n.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests(),isControlledByOrganization:Boolean(u.disable_guests)},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits(),isControlledByOrganization:!1}})),[n,t,u]),g=(0,O().R)(t),f=(0,r().K8)((()=>(null==n?void 0:n.canAdmin())??!1),[n]),h=(0,a().IS)((()=>({switcher:{marginRight:0}})),[]);if(!n)return null;if(!p)return null;const y=e=>l||m[e].teamIsDisabled,b=e=>{if(!y(e))return!1;if(!g)return!1;if(m[e].isControlledByOrganization)return!1;const t=(e=>m[e].spaceIsDisabled&&m[e].teamIsDisabled)(e);return!t||f},S=e=>!y(e)&&f,x=e=>{const{teamIsDisabled:n,spaceIsDisabled:i}=m[e],r=!n;D()._B({environment:o,store:t,settingName:e,newTeamSettingValue:Ue(r),spaceSettingValue:void 0===i?void 0:Ue(i)})},A=e=>{if((e=>m[e].spaceIsDisabled)(e))return(e=>m[e].teamIsDisabled)(e)?(0,Y.jsx)(s().sA,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,Y.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,Y.jsx)(s().sA,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,Y.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},M=(0,Y.jsx)(ce().A,{subscriptionTier:d,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),w=(0,Y.jsx)(s().sA,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),k=[(0,Y.jsx)(Gn,{switcherStyle:h.switcher,upsellTier:d,on:m.disable_public_access.teamIsDisabled,disabled:!b("disable_public_access"),onChange:()=>x("disable_public_access"),shouldTriggerUpsell:S("disable_public_access"),secondCaption:A("disable_public_access"),title:(0,Y.jsxs)(Y.Fragment,{children:[c?(0,Y.jsx)(s().sA,{id:"teamSettingsSecurity.setting.shareTitleAWTLUpdate",defaultMessage:"Disable publishing sites, forms, and public links"}):(0,Y.jsx)(s().sA,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable publishing sites and forms"}),!y("disable_public_access")&&M]}),tooltip:!y("disable_public_access")&&w,isLocked:m.disable_public_access.isControlledByOrganization,lockedTooltip:(0,le().C_)()}),(0,Y.jsx)(Gn,{switcherStyle:h.switcher,upsellTier:d,on:m.disable_guests.teamIsDisabled,disabled:!b("disable_guests"),onChange:()=>x("disable_guests"),shouldTriggerUpsell:S("disable_guests"),secondCaption:A("disable_guests"),title:(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(s().sA,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),!y("disable_guests")&&M]}),tooltip:!y("disable_guests")&&w,isLocked:m.disable_guests.isControlledByOrganization,lockedTooltip:(0,le().C_)()}),(0,Y.jsx)(Gn,{switcherStyle:h.switcher,upsellTier:d,on:m.disable_export.teamIsDisabled,disabled:!b("disable_export"),onChange:()=>x("disable_export"),shouldTriggerUpsell:S("disable_export"),secondCaption:A("disable_export"),title:(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(s().sA,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),!y("disable_export")&&M]}),tooltip:!y("disable_export")&&w,isLocked:m.disable_export.isControlledByOrganization,lockedTooltip:(0,le().C_)()})],j=(0,Y.jsx)(s().sA,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,Y.jsx)(X,{title:j,rows:k,hideDividers:!0})}function Oe(e){const t=(0,i().v3)(),n=(0,r().K8)((()=>(0,m().mN)(e.teamStore)),[e.teamStore]);return(0,Y.jsx)(H().p,{style:e.style,iconLeading:e=>(0,ae().B)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default}),onClick:async()=>await(async e=>{let{teamStore:n,teamName:o}=e;await D().Q8({environment:t,teamStore:n,teamName:o,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStore}),disabled:!n,children:(0,Y.jsxs)("div",{children:[(0,Y.jsx)(P().A,{children:(0,Y.jsx)(s().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,Y.jsx)(P().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,Y.jsx)(s().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})}function Ee(e){const t=(0,i().v3)(),n=(0,a().IS)((()=>({archiveLabel:{color:w().Ay.red}})),[]);return(0,Y.jsx)(H().p,{style:e.style,isRed:!0,iconLeading:e=>(0,ae().B)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:async()=>{e.disabled||await D().mm({environment:t,teamStore:e.teamStore,from:"sidebar_team_modal"})},...e.tooltipEvents,children:(0,Y.jsxs)("div",{children:[(0,Y.jsx)(P().A,{style:n.archiveLabel,children:(0,Y.jsx)(s().sA,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,Y.jsx)(P().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,Y.jsx)(s().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function Ue(e){return e?"disable":"allow"}const Fe=(0,s().YK)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Ve(e){let{teamStore:t}=e;const n=(0,i().v3)(),l=(0,r().O$)(v().AppStoreCurrentSpaceStore),d=E(t),[c,u]=(0,o.useState)(void 0),[p,m]=(0,o.useState)(void 0),g=(0,a().IS)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[f,h]=(0,r().K8)((()=>[t.getName(),t.getDescription()]),[t]),y=(0,o.useCallback)((e=>{(0,D().qq)({store:t,environment:n,icon:e,source:"TeamSettingsGeneral"})}),[t,n]);if(void 0===f)return null;const b=f||"",S=h??"",x=S.length>0,A=null==c?void 0:c.trim(),M=null==p?void 0:p.trim(),w=""===A||(void 0===p||M===S.trim())&&(void 0===c||A===b.trim()),C=async()=>{if(w)return;if(A&&A!==b.trim()){if(!(await(0,L().d$)({environment:n,spaceStore:l,teamName:A})))return}const{performResult:e,serverCommitResult:o}=j().createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:n,canUndo:!0,perform:e=>{D().n7({store:t,update:{name:A??b,description:M??S},transaction:e})}});try{await Promise.all([e,o])}catch(i){return}k().D6({label:(0,Y.jsx)(s().sA,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},I=(0,Y.jsx)(s().sA,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),_=(0,Y.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,Y.jsx)(K().x,{disabled:d,store:t,style:g.icon,size:20,onChange:y}),d?(0,Y.jsx)(P().A,{children:b}):(0,Y.jsx)(ze,{value:c??b,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},onSubmit:async e=>{u(e),await C()},disabled:d,placeholder:"Acme Labs"})]}),R=(0,Y.jsx)(s().sA,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),N=B().A.formatMessage(Fe.noDescription),O=d?(0,Y.jsx)(P().A,{isMultiline:!0,isSecondaryColor:!x,children:x?S:N}):(0,Y.jsx)(ze,{value:void 0===p?S:p,onBlur:e=>{m(e)},onChange:e=>{m(e)},onSubmit:async e=>{m(e),await C()},disabled:d,textarea:!0,autosize:!0,placeholder:N,style:g.description}),U=[(0,Y.jsxs)(o.Fragment,{children:[(0,Y.jsx)(P().A,{isSmall:!0,children:I}),_]},"name"),(0,Y.jsxs)(o.Fragment,{children:[(0,Y.jsx)(P().A,{isSmall:!0,children:R}),O]},"description")];return(0,Y.jsxs)("div",{style:g.container,children:[(0,Y.jsx)(X,{title:(0,Y.jsx)(s().sA,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:U}),!d&&(0,Y.jsx)(T().A,{style:g.updateButton,disabled:w,size:"lg",onClick:C,children:(0,Y.jsx)(s().sA,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,Y.jsx)("br",{}),(0,Y.jsx)(ie,{teamStore:t}),(0,Y.jsx)(Ke,{teamStore:t}),(0,Y.jsx)(z().A,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function ze(e){const{value:t,style:n,onBlur:i,onChange:r,onSubmit:a,placeholder:s,disabled:l}=e,[d,c]=(0,o.useState)(!1);return(0,Y.jsx)(C().A,{capture:d,render:o=>(0,Y.jsx)(I().A,{textarea:e.textarea,autosize:e.autosize,onFocus:e=>{c(!0)},onBlur:e=>{c(!1),i(e.target.value)},onChange:e=>{c(!1),null==r||r(e.target.value)},onSubmit:e=>{c(!1);const t=e.target;null==a||a(t.value),t.blur()},placeholder:s,disabled:l,value:t,style:n,...o})})}function Ke(e){let{teamStore:t}=e;const n=(0,a().IS)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:Q,paddingBottom:Q,paddingLeft:$,paddingRight:$}})),[]),[o,i]=(0,r().K8)((()=>[t.getName(),t.isArchived()]),[t]),l=(0,O().R)(t),d=(0,F().G)(t),c=(0,U().q)(t.id),u=(0,N().c)(),p=c&&!u.canArchive;if(void 0===o||!d)return null;const m=[],g=(0,Y.jsx)(V().A,{buttonInternals:(0,Y.jsx)(We,{isTeamOwner:l}),teamStore:t,placement:R().W.Bottom,alignment:R().C.Start,from:"sidebar_team_modal",style:n.buttonStyle,icon:e=>(0,A().f)({...e,margin:"2px 17px 2px 2px",width:M().Ev.default,height:M().Ev.default,transform:"rotate(-90deg)"}),isRed:!l});if(m.push(g),l)if(i)m.push((0,Y.jsx)(Oe,{teamStore:t,teamName:o,style:n.buttonStyle}));else{const e=(0,Y.jsx)(_().A,{disableTooltip:!p,placement:R().W.Bottom,alignment:R().C.Start,renderTooltip:()=>(0,W().P)(u),render:e=>(0,Y.jsx)(Ee,{disabled:p,teamStore:t,tooltipEvents:e,style:n.buttonStyle})});m.push(e)}return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)("div",{style:{height:20,width:"100%"}}),(0,Y.jsx)(X,{title:(0,Y.jsx)(s().sA,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:m,itemStyle:{padding:0,margin:0}})]})}function We(e){let{isTeamOwner:t}=e;const n=(0,a().IS)((()=>({label:{color:t?"inherit":w().Ay.red}})),[t]);return(0,Y.jsxs)("div",{children:[(0,Y.jsx)(P().A,{style:n.label,children:(0,Y.jsx)(s().sA,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,Y.jsx)(P().A,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,Y.jsx)(s().sA,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var He=()=>n(381138),Ge=()=>n(986863),Ye=()=>n(205618),qe=()=>n(931956),$e=()=>n(284331);function Qe(e){let{teamStore:t}=e;const n=(0,a().IS)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.surface.elevated,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.icon.secondary}})),[]),o=(0,s().tz)(),i=(0,r().K8)((()=>f().A.state.memberFilterQuery),[]),l=(0,r().uB)(void 0,Ye().A),d=(0,qe().X)(t),c=(0,r().K8)((()=>d&&!(0,m().FQ)(t)),[t,d]);return(0,Y.jsxs)("div",{style:n.container,children:[(0,Y.jsxs)("div",{children:[(0,Y.jsx)(Ge().u,{store:t,permissionsInviteStore:l,origin:(0,Y.jsx)(_().A,{placement:R().W.Left,alignment:R().C.Start,textWrap:!0,renderTooltip:()=>d?(0,Y.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,Y.jsx)(s().sA,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,Y.jsx)("div",{style:{width:220},children:(0,Y.jsx)(s().sA,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,Y.jsx)(T().A,{disabled:!d,size:"lg",onClick:()=>{l.setState({...l.state,modalOpen:!0})},...e,children:(0,Y.jsx)(s().sA,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),c&&(0,Y.jsx)($e().m,{store:t,isSmall:!0})]}),(0,Y.jsx)(I().A,{placeholder:o.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:n.input,value:i,onChange:e=>{f().A.setState({...f().A.state,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,He().q)(n.searchIcon),showClearButton:!0,format:I().C.Small})]})}var Ze=()=>n(331542),Xe=()=>n(442672),Je=()=>n(124749),et=()=>n(798880),tt=()=>n(646736),nt=()=>n(21735),ot=()=>n(870092),it=()=>n(134217),rt=()=>n(749240),at=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),()=>n(468006)),st=()=>n(763824),lt=()=>n(574752),dt=()=>n(605402);const ct=["owner","member","team_level_guest"],ut=["group","user"];class pt extends(()=>n(461924))().o{constructor(e){let{teamStore:t,currentUserStore:o,environment:i,members:r,initialQuery:a,initialSort:s,intl:l,canAddMembers:d,shouldUseEdgeCache:c,limit:u}=e;super(void 0),this.teamStore=void 0,this.environment=void 0,this.query=void 0,this.intl=void 0,this.canAddMembers=void 0,this.limit=void 0,this.currentPage=0,this.filteredAndSortedMembers=[],this.membersToAdd=[],this.innerListSource=void 0,this.currentUserStore=void 0,this.isLoadingMore=!1,this.isRefreshing=!1,this.teamStore=t,this.environment=i,this.query=a,this.sort=s,this.intl=l,this.canAddMembers=d,this.limit=u??20,this.currentUserStore=o,t.isDefault()&&(this.innerListSource=c?new(n(585428).e)({users:[],environment:this.environment,spaceId:this.teamStore.getSpaceId()??"",initialMembershipFilter:"members",initialQuery:this.query,initialSort:{field:"name_normalized",direction:"asc"},limit:this.limit}):new(n(576737).z)({users:r,initialMembershipFilter:"members",initialSort:{field:"name_normalized",direction:"asc"},initialQuery:this.query,limit:this.limit})),this.refresh()}async applySearch(e){return this.query&&0!==this.query.length?(await(0,st().lX)(e,25,(async e=>{if("user"===e.entity_type){const t=this.currentUserStore?y().LU.createChildStore(this.currentUserStore,{table:et().oo,id:e.user_id}):void 0;await(null==t?void 0:t.load())}})),(0,n(778078).Ay)(this.query,e,(e=>{if("user"===e.entity_type){const t=this.currentUserStore?y().LU.createChildStore(this.currentUserStore,{table:et().oo,id:e.user_id}):void 0;return[(null==t?void 0:t.getName())??"",(null==t?void 0:t.getEmail())??""].filter(Boolean).join(" ")}{var t;const n=null===(t=dt().A.state.permissionGroupsAndMemberCounts.find((t=>t.group.group_id===e.group_id)))||void 0===t?void 0:t.group;return(null==n?void 0:n.getName())??""}}),{minThreshold:1e3})):e}async applySort(e){return this.sort?"name"===this.sort.column?(await(0,st().lX)(e,25,(async e=>{if("user"===e.entity_type){const t=this.currentUserStore?y().LU.createChildStore(this.currentUserStore,{table:et().oo,id:e.user_id}):void 0;await(null==t?void 0:t.load())}})),e.sort(((e,t)=>{var n;const o=mt({member:e,parentStore:this.currentUserStore})??"",i=mt({member:t,parentStore:this.currentUserStore})??"";if(o===i)return 0;const r=o<i?-1:1;return null!==(n=this.sort)&&void 0!==n&&n.sortedAscending?r:-r}))):"role"===this.sort.column?e.sort(((e,t)=>{const n=e.type,o=t.type,i=ct.indexOf(n)-ct.indexOf(o);var r;if(0!==i)return null!==(r=this.sort)&&void 0!==r&&r.sortedAscending?-i:i;const a=e.entity_type,s=t.entity_type,l=ut.indexOf(a)-ut.indexOf(s);return 0!==l?l:0})):void(0,d().HB)(this.sort.column):e}async getMembersToAdd(){if(0===this.query.length||!this.canAddMembers)return[];let e=[];this.teamStore.isDefault()||(e=await lt().searchSpaceUsers({environment:this.environment,query:this.query,membersOnly:!0,limit:5,shouldUseEdgeCacheRollout:!0}));const t=lt().searchSpaceGroups({query:this.query,intl:this.intl}),n=[...e,...t],o=new Set(this.filteredAndSortedMembers.map(gt));return n.filter((e=>!o.has("group_id"in e?e.group_id:e.id))).slice(0,5)}async setSort(e){var t,n;if((null===(t=this.sort)||void 0===t?void 0:t.column)!==(null==e?void 0:e.column)||(null===(n=this.sort)||void 0===n?void 0:n.sortedAscending)!==(null==e?void 0:e.sortedAscending)){var o,i;if(this.currentPage=0,this.sort=e,"name"!==e.column||e.sortedAscending)await(null===(o=this.innerListSource)||void 0===o?void 0:o.setSort({field:"name_normalized",direction:"asc"}));else await(null===(i=this.innerListSource)||void 0===i?void 0:i.setSort({field:"name_normalized",direction:"desc"}));await this.refresh()}}async setQuery(e){var t;this.query!==e&&(this.currentPage=0,this.query=e,await(null===(t=this.innerListSource)||void 0===t?void 0:t.setQuery(e)),await this.refresh())}async fetch(){var e;const t=this.currentPage*this.limit,n=t+this.limit,o=[...this.filteredAndSortedMembers.map((e=>({type:"joined",value:e}))),...this.membersToAdd.map((e=>({type:"to_add",value:e})))],i=o.slice(t,n),r=Boolean(n<o.length||(null===(e=this.innerListSource)||void 0===e?void 0:e.rowsStore.state.hasMore));return Promise.resolve({rows:i,hasMore:r})}async loadMore(){if(!this.isLoadingMore){if(this.isLoadingMore=!0,this.currentPage++,this.teamStore.isDefault()){var e,t;await(null===(e=this.innerListSource)||void 0===e?void 0:e.loadMore());const n=(null===(t=this.innerListSource)||void 0===t||null===(t=t.rowsStore.state.rows)||void 0===t?void 0:t.map((e=>e.id)))??[],o=this.teamStore.getModel(),i=o?(0,at().tv)({team:o,spaceMemberUserIds:n}):[],r=await this.applySearch(i);this.filteredAndSortedMembers=await this.applySort(r),this.membersToAdd=await this.getMembersToAdd()}await super.loadMore(),this.isLoadingMore=!1}}async refresh(){if(this.isRefreshing)return;this.isRefreshing=!0,this.currentPage=0;let e=[];if(this.teamStore.isDefault()){var t,n;await(null===(t=this.innerListSource)||void 0===t?void 0:t.refresh());const o=(null===(n=this.innerListSource)||void 0===n||null===(n=n.rowsStore.state.rows)||void 0===n?void 0:n.map((e=>e.id)))??[],i=this.teamStore.getModel();i&&(e=(0,at().tv)({team:i,spaceMemberUserIds:o}))}else e=this.teamStore.getRawMembership();const o=await this.applySearch(e);this.filteredAndSortedMembers=await this.applySort(o),this.membersToAdd=await this.getMembersToAdd(),await super.refresh(),this.isRefreshing=!1}}function mt(e){let t,{member:n,parentStore:o}=e;if("user"===n.entity_type){const e=o?y().LU.createChildStore(o,{table:et().oo,id:n.user_id}):void 0;t=(null==e?void 0:e.getName())??(null==e?void 0:e.getEmail())}else{var i;t=null===(i=dt().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n.group_id)))||void 0===i||null===(i=i.group)||void 0===i?void 0:i.getName()}return function(e){return null==e?void 0:e.normalize("NFKD").toLowerCase().replace(/\p{Diacritic}/gu,"")}(t)}function gt(e){switch(e.entity_type){case"user":return e.user_id;case"group":return e.group_id;default:(0,d().HB)(e)}}var ft=()=>n(96689),ht=()=>n(695608),vt=()=>n(34293),yt=()=>n(173783),bt=()=>n(187820),St=()=>n(453697),xt=()=>n(820635),At=(n(16280),()=>n(831310)),Mt=()=>n(901389),wt=()=>n(47373),kt=()=>n(176983),jt=()=>n(463830),Ct=()=>n(700250),It=()=>n(329304),Tt=()=>n(10984),_t=()=>n(308228),Pt=()=>n(418426),Bt=(n(737550),()=>n(854150)),Lt=()=>n(76118),Rt=()=>n(912913),Dt=()=>n(731320),Nt=()=>n(112698);function Ot(e){var t;const{teamStore:n,memberInfo:l,permissionItem:d,memberName:c,style:u,onMenuItemClicked:p,isPermissionOverridden:m}=e,g=(0,i().v3)(),f=(0,s().tz)(),h=(0,o.useMemo)((()=>new(jt().A)),[]),y=(0,r().K8)((()=>n.getTeamPermission()),[n]),b=(0,r().O$)(v().AppStoreCurrentSpaceStore),S=(0,It()._X)({name:"custom_teamspace_permissions",spaceId:null==b?void 0:b.id,userId:null==g||null===(t=g.currentUser)||void 0===t?void 0:t.id}),x=(0,O().R)(n),A=!(0,Lt().e2)(S)&&!m||!x,M=(0,r().K8)((()=>{if(null==n||!n.isDefined())return;const e=f.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members’ access to enable this option."}),t=(0,Y.jsx)(s().sA,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});return["editor","read_and_write","comment_only","reader"].map((function(o){const i=(null==y?void 0:y.role)===o?t:void 0;return(0,ge().or)({teamValue:{id:n.id,permissions:n.getPermissionItems()},permissionRole:o})?{role:o,disabledInfo:{isDisabled:!0,disabledMessage:e},tag:i}:{role:o,tag:i}}))}),[y,f,n]);const w=(0,a().IS)((e=>({overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},roleSelectButton:{marginRight:0,fontSize:12,color:e.text.secondary,visibility:m?void 0:"hidden"},disabledItem:{...u,color:e.text.tertiary}})),[u,m]),k=(0,Y.jsxs)("div",{style:w.overrideTitle,children:[(0,Y.jsx)(s().sA,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),null!=S&&S.upsell&&!m?(0,Y.jsx)(Nt().B,{upsell:null==S?void 0:S.upsell,analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,Y.jsx)(Rt().Ay,{role:"owner"===l.type?"none":d.role,table:Bt().yK,type:"user"===l.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===l.entity_type?"user_permission_item":"group_permission_item",disabled:A,buttonStyle:w.roleSelectButton,availableRoleItems:M,header:(0,Y.jsx)(P().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,Y.jsx)(s().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){Mt().ui({message:(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}’s role to {role}?",values:{name:c,role:(0,Dt().qZ)(e).toLowerCase()}}),description:(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won’t apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:Mt().zw,items:[{label:(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:t}=j().createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:g,canUndo:!0,perform:t=>{D().b4({memberInfo:l,teamStore:n,transaction:t,environment:g,permissionRole:e})}});await t,n.isDefault()&&(n.getMembershipDefinedOnTeam().some((e=>(0,at().Q6)(e,l)))||await D().Zd({environment:g,teamStore:n,teamMemberInfos:[l],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),p&&p())},buttonPopupStore:h,placementToOrigin:Ct().UV.Right,alignmentToOrigin:Ct().MY.End})]});return(0,Y.jsx)(_().A,{placement:A?R().W.Right:R().W.Left,textWrap:!0,renderTooltip:()=>A&&!x?(0,Y.jsx)(s().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip.disabled",defaultMessage:"You must be a teamspace owner to set custom permission level"}):(0,Y.jsx)(s().sA,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,Y.jsx)(Ae().A,{...e,focused:!1,disabled:A,style:A?w.disabledItem:u,textWrapperStyle:{marginRight:0},onClick:()=>h.setState({open:!0}),title:k,icon:m?(0,Y.jsx)("div",{style:{marginTop:8},children:(0,At().o)({width:14})}):void 0})})}function Et(e){let{teamStore:t,memberInfo:n,permissionItem:o,memberName:a,isPermissionOverridden:l,disabled:c}=e;const u=(0,r().uB)(void 0,jt().A),p=(0,i().v3)(),g=(0,r().O$)(v().AppStoreCurrentSpaceStore),f=(0,Je().$)(),h=(0,r().K8)((()=>{const e=null==f?void 0:f.userId;return"user"===n.entity_type&&n.user_id===e}),[null==f?void 0:f.userId,n]),y=()=>u.setState({...u.state,open:!1}),b=(0,O().R)(t),S=(0,It().P9)({name:"team_self_promotion",spaceId:null==g?void 0:g.id,userId:null==f?void 0:f.userId}),x=(0,r().K8)((()=>{const{currentSpaceStore:e}=v().default.state;return Boolean(null==e?void 0:e.canAdmin())}),[]),A=(0,r().K8)((()=>{const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return e.length+n.length}),[t]),M=(0,Pt().$)(t),w=0===A,k=async e=>{y();const o="owner"===e?(0,Y.jsx)(s().sA,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,Y.jsx)(s().sA,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==n.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===n.entity_type||"group"===n.entity_type){const e=async()=>{const{serverCommitResult:e}=j().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:p,canUndo:!0,perform:e=>{D().D6({environment:p,memberInfo:n,teamStore:t,transaction:e})}});await e},o=async()=>{await D().z9({environment:p,teamStore:t,currentSpaceStore:g,from:"team_settings_members",action:"upgradeToOwner"})};w&&h?Mt().ui({message:(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.message",defaultMessage:"Are you sure you want to become a teamspace owner? You can become the teamspace owner since there are no other owners and you are a workspace admin."}),showCancel:!0,keepFocus:!1,handleCancel:Mt().zw,items:[{label:(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeOwnerForUnownedTeamConfirmation.accept",defaultMessage:"Become teamspace owner"}),color:"blue",onAccept:async()=>{await e()}}]}):h&&S&&x?await o():await e()}}else h&&b?Mt().ui({message:(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:Mt().zw,items:[{label:(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:C}]}):await C();else{const i=(await(0,m().p2)({lookupUserId:n.user_id,spaceStore:g,environment:p})).length;Mt().ui({message:(0,Y.jsx)(Y.Fragment,{children:i>1?(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:o,numberOfOtherTeams:i-1}}):(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:o}})}),showCancel:!0,keepFocus:!1,handleCancel:Mt().zw,items:[{label:(0,Y.jsx)(s().sA,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(g){const{serverCommitResult:o}=j().createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:p,canUndo:!0,perform:o=>{D().Nd({environment:p,userId:n.user_id,teamStore:t,transaction:o,spaceStore:g,newTeamRole:e})}});await o}}}]})}},C=async()=>{if("owner"!==n.type||"user"!==n.entity_type&&"group"!==n.entity_type){if("member"===n.type){const{serverCommitResult:e}=j().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:p,canUndo:!0,perform:e=>{D().P8({environment:p,memberInfo:n,teamStore:t,transaction:e})}});await e}}else{const{serverCommitResult:e}=j().createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:p,canUndo:!0,perform:e=>{D().qS({memberInfo:n,teamStore:t,transaction:e,environment:p})}});await e}},I=async()=>{var e;const{entity_type:o}=n;switch(y(),o){case"group":const i=null===(e=dt().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===n.group_id)))||void 0===e?void 0:e.group;if(!i)throw new Error("Permission group not found in space.");D().BQ({environment:p,teamStore:t,group:i});break;case"user":await D().fy({environment:p,teamStore:t,userId:n.user_id,from:"team_settings_member_table",userGroupsInTeam:M});break;default:(0,d().HB)(o)}};return(0,Y.jsx)(Me().Ay,{buttonPopupStore:u,placementToOrigin:Ct().UV.Bottom,renderOrigin:e=>(0,Y.jsx)(Ft,{buttonPopupEvents:e,isPermissionOverridden:l,permissionItem:o,memberInfo:n,disabled:c}),render:()=>(0,Y.jsx)(Ut,{teamStore:t,isPermissionOverridden:l,memberInfo:n,permissionItem:o,memberName:a,numberOfOwners:A,isMemberCurrentUser:h,onMenuItemClicked:k,onRemoveClicked:I,onSubMenuItemClicked:y}),popupType:Me().z7.Popup})}function Ut(e){let{teamStore:t,isPermissionOverridden:n,memberInfo:o,permissionItem:i,memberName:s,numberOfOwners:d,isMemberCurrentUser:u,onRemoveClicked:m,onMenuItemClicked:g,onSubMenuItemClicked:f}=e;const h=(0,r().K8)((()=>{const{currentSpaceStore:e}=v().default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,wt().Qd)()}),[]),y=(0,r().K8)((()=>t.isDefault()),[t]),b=(0,kt().J)(),S=(0,r().K8)((()=>{const{currentSpaceStore:e}=v().default.state;return Boolean((null==e?void 0:e.canAdmin())&&(0,Tt().OX)())}),[]),x=(0,O().R)(t),A=(0,qe().X)(t),M=1===d,w=0===d,k=(0,a().IS)((e=>{const t={paddingTop:5,paddingBottom:5},n={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:n,indentedMenuItem:{...n,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.text.secondary,fontSize:12,fontWeight:c().Wy.regular}}}),[]),j=(e,t,n)=>(0,_t().W)({isCurrentUserTeamOwner:x,role:e,isDefaultTeam:y,userIsSpaceAdmin:Boolean(b),userIsEnterpriseWorkspaceOwner:S,originalTeamMemberInfo:t,onlyHasOneOwner:M,isUnowned:w,isMemberCurrentUser:u,canCurrentUserAddTeamMembers:n}),C=(e,t)=>{const{isDisabled:o,disabledReason:i}=j(e,t,A);return{key:e,action:()=>g(e),render:r=>{const a=!n&&t.type===e;return(0,Y.jsx)(_().A,{disableTooltip:!o,placement:R().W.Right,textWrap:!0,renderTooltip:()=>i,render:t=>(0,Y.jsx)("span",{...t,children:(0,Y.jsx)(Ae().A,{...r,style:a?k.menuItem:k.indentedMenuItem,disabled:o,disabledFeedback:o,title:(0,Y.jsx)(Vt,{type:e}),caption:Kt(e),shouldWrapCaption:!0,icon:a?(0,At().o)({width:14}):void 0})})})}}},I=y&&"user"===o.entity_type,T="group"!==o.entity_type&&h,P=[{key:"teamRoles",items:l().oE([C("owner",o),C("member",o),T?C("team_level_guest",o):void 0,Wt({onRemoveClicked:m,styles:k,...j("none",o,A),isMemberInDefaultTeam:I}),..."owner"===o.type||w?[]:[{key:"divider",action:()=>{},render:()=>(0,Y.jsx)(G().A,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,Y.jsx)("span",{...e,children:(0,Y.jsx)(Ot,{teamStore:t,memberInfo:o,permissionItem:i,memberName:s,onMenuItemClicked:f,isPermissionOverridden:n,style:n?k.menuItem:k.indentedMenuItem})})}]]),render:e=>(0,Y.jsx)(je().A,{...e,topBorder:0!==e.index})}];return(0,Y.jsx)(we().A,{className:p().yw8,menuType:Ie().gu.Popup,children:(0,Y.jsx)(ke().Ay,{type:ke().Oh.Vertical,initialFocus:void 0,sections:P})})}function Ft(e){let{buttonPopupEvents:t,disabled:n,isPermissionOverridden:o,permissionItem:i,memberInfo:r}=e;const l=(0,a().IS)((e=>({label:{color:e.text.primary,fontSize:12.5,fontWeight:c().Wy.regular},overrideLabel:{color:e.text.secondary,fontSize:12,fontWeight:c().Wy.regular},chevron:{width:10,marginLeft:4,fill:e.icon.tertiary}})),[]),u=function(e,t,n){if(t&&n)return function(e){switch(e){case"none":return(0,Y.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,Y.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,Y.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,Y.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,Y.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,Y.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,d().HB)(e)}}(n);return zt(e)}(r.type,o,i.role);return(0,Y.jsxs)(H().p,{disabled:n,...t,children:[o&&(0,Y.jsxs)("span",{style:l.overrideLabel,children:[(0,Y.jsx)(s().sA,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,Y.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,Y.jsx)("span",{style:l.label,children:u}),!n&&(0,pe().b)(l.chevron)]})}function Vt(e){let{type:t}=e;const n=zt(t);return(0,Y.jsx)("div",{children:(0,Y.jsx)("span",{children:n})})}function zt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,Y.jsx)(s().sA,{...m().Y7[e].label});case"none":return;default:(0,d().HB)(e)}}function Kt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,Y.jsx)(s().sA,{...m().Y7[e].caption});case"none":return;default:(0,d().HB)(e)}}function Wt(e){let{styles:t,isDisabled:n,disabledReason:o,onRemoveClicked:i,isMemberInDefaultTeam:r}=e;return{key:"remove",action:i,render:e=>(0,Y.jsx)(_().A,{disableTooltip:!n,placement:R().W.Right,textWrap:!1,renderTooltip:()=>o,render:o=>(0,Y.jsx)("span",{...o,children:(0,Y.jsx)(Ae().A,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:n,disabledFeedback:!0,title:(0,Y.jsx)(s().sA,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var Ht=()=>n(265665);function Gt(e){const{icon:t,label:n,name:o,tag:i,style:r}=e,s=(0,a().IS)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...r},labelContainer:{display:"flex",flexDirection:"column",...c().RC,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[r]);return(0,Y.jsxs)("div",{style:s.container,children:[t,(0,Y.jsxs)("div",{style:s.labelContainer,children:[(0,Y.jsxs)("div",{style:s.nameContainer,children:[(0,Y.jsx)(Ht().j,{style:s.name,children:o}),i]}),n&&(0,Y.jsx)(P().A,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,Y.jsx)(Ht().j,{children:n})})]})]})}function Yt(e){const{iconComponent:t,label:n,name:o,permissionRoleSelectComponent:i,tag:r,tooltip:s,style:l}=e,d=(0,a().IS)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,Y.jsxs)("div",{style:d.permissionRow,children:[(0,Y.jsx)(Gt,{icon:t,name:o,tag:r,label:n,style:{minWidth:200,marginRight:6}}),(0,Y.jsx)(_().A,{textWrap:!0,style:{width:210},disableTooltip:!s,placement:R().W.Left,renderTooltip:()=>s,render:e=>(0,Y.jsx)("span",{...e,children:i})})]})}function qt(e){const{type:t,store:n,permissionItem:o,memberInfo:l}=e,c=(0,i().v3)(),u=(0,s().tz)(),p="group"===t?e.permissionGroup:void 0,g="user"===t?e.userStore:void 0,f=(0,r().O$)(v().AppStoreCurrentSpaceStore),h=(0,r().K8)((()=>{var e;switch(t){case"group":return"none";case"user":const n=l.user_id;return(null===(e=(0,tt().sE)(f,n))||void 0===e?void 0:e.getMembershipTypeAsRoleOrNone())??"none";default:(0,d().HB)(t)}}),[t,l,f]),y=(0,O().R)(n),b=(0,qe().X)(n),S=(0,r().K8)((()=>{const{currentSpaceStore:e}=v().default.state;return null==e?void 0:e.canEditMembership()}),[]),x=(0,r().K8)((()=>{const e=c.currentUser.id,t=n.getSettingsStore().getValue();return!!(null!=f&&f.isDefined()&&n.isDefined()&&t&&e)&&(0,m().zC)({environment:c,teamStore:n,spaceStore:f})}),[c,f,n]),A=(0,r().K8)((()=>{const e=n.getPermissionItems()||[];switch(l.entity_type){case"group":return Boolean(e.find((e=>(0,me().Ds)(e)&&e.group_id===l.group_id)));case"user":return Boolean(e.find((e=>(0,me().B2)(e)&&e.user_id===l.user_id)));default:return!1}}),[l,n]),{name:M,label:w,icon:k,isSelfUserPermission:j}=(0,r().K8)((()=>{const e=c.currentUser.id;switch(t){case"group":return Qt({permissionGroup:p,spaceId:null==f?void 0:f.id});case"user":return function(e){var t;let{intl:n,userStore:o,currentUserId:i}=e;const r=void 0!==i&&(null==o||null===(t=o.getModel())||void 0===t?void 0:t.id)===i;return{name:(0,ht().c6)(n,null==o?void 0:o.getModel()),label:null==o?void 0:o.getEmail(),icon:(0,Y.jsx)(St().A,{avatarShouldShowShadow:!0,userStore:o,size:32}),isSelfUserPermission:r}}({intl:u,userStore:g,currentUserId:e});default:(0,d().HB)(t)}}),[c.currentUser.id,t,p,null==f?void 0:f.id,u,g]),C=(0,Y.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,Y.jsx)(Et,{teamStore:n,memberInfo:l,memberName:M,permissionItem:o,isPermissionOverridden:A,disabled:b&&"member"===l.type?!y&&A:!y&&!x||"team_level_guest"===l.type&&!S})}),I=(0,a().IS)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17},titleYouIndicator:{color:e.text.secondary}})),[]),T=(0,Y.jsxs)("div",{style:{display:"flex",gap:4},children:[M,j&&(0,Y.jsx)("span",{style:I.titleYouIndicator,children:(0,Y.jsx)(s().sA,{id:"specificTeamMemberPermissionRow.displayName.youIndicator",defaultMessage:"(You)"})})]});return(0,Y.jsx)(Yt,{style:I.row,tag:(0,me().EH)(h)?(0,Y.jsx)(vt().A,{desktopStyle:I.pill,mobileStyle:I.pill,role:$t(h)}):"group"===t?(0,Y.jsx)("div",{style:I.pill,children:k}):void 0,permissionRoleSelectComponent:C,iconComponent:"group"===t?(0,Y.jsx)(yt().A,{size:32}):k,name:T,label:w})}function $t(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,d().HB)(e)}}function Qt(e){var t;let{spaceId:n,permissionGroup:o}=e;const{name:i,icon:r}=o,a=(null===(t=dt().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===o.group_id)))||void 0===t?void 0:t.memberCount)??0;return{name:i||(0,Y.jsx)(s().sA,{id:"teamPermissionSettings.untitled",defaultMessage:"Untitled"}),label:(0,Y.jsx)(_().A,{placement:R().W.Bottom,alignment:R().C.Start,disableTooltip:0===a,renderTooltip:()=>(0,Y.jsx)(xt().Q,{group:o,limit:10,noMembersMessage:void 0}),render:e=>(0,Y.jsxs)("div",{...e,children:[(0,Y.jsx)(s().sA,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,Y.jsx)(s().sA,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:a}})]})}),icon:r&&(0,Y.jsx)(bt().B6,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:i,size:18,icon:r&&n?{icon:r,pointer:{table:ft().NX,id:n}}:void 0}),isSelfUserPermission:!1}}var Zt=()=>n(689094),Xt=()=>n(47170),Jt=()=>n(224701);function en(e){let{teamStore:t,...n}=e;const l=(0,i().v3)(),d=(0,Xt().O)(),c=(0,s().tz)(),u=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),p=(0,o.useCallback)((e=>{k().D6({label:(0,Y.jsx)(s().sA,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),m=(0,o.useCallback)((async(e,n)=>{await D().Zd({environment:l,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await Jt().x(l):p(n)}),[l,p,t]),g=(0,o.useCallback)(((e,t)=>m({type:"member",entity_type:"user",user_id:e.id},t)),[m]),f=(0,o.useCallback)(((e,t)=>m({type:"member",entity_type:"group",group_id:e.group_id},t)),[m]),h=(0,r().K8)((()=>{if("groupToAdd"in n)return Qt({spaceId:d,permissionGroup:n.groupToAdd})}),[d,n]);if("memberToAdd"in n){const{memberToAdd:e}=n,t=(0,ht().c6)(c,e);return(0,Y.jsxs)("div",{style:u.container,children:[(0,Y.jsx)(Gt,{icon:(0,Y.jsx)(St().A,{userValue:e,size:32}),name:t,label:e.email}),tn((()=>{g(e,t)}))]})}{if(!d||!h)return(0,Y.jsx)(Y.Fragment,{});const{groupToAdd:e}=n;return(0,Y.jsxs)("div",{style:u.container,children:[(0,Y.jsx)(Gt,{icon:(0,Y.jsx)(yt().A,{size:32}),name:h.name,label:h.label,tag:(0,Y.jsx)("div",{style:u.pill,children:h.icon})}),tn((()=>{f(e,h.name)}))]})}}function tn(e){return(0,Y.jsx)(H().p,{isBlue:!0,onClick:e,iconLeading:Zt().W,children:(0,Y.jsx)(s().sA,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})})}var nn=()=>n(158359),on=()=>n(498474);function rn(e){let{sortType:t,onChangeSortType:n}=e;const o=(0,a().IS)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),i=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",r=e=>{const o=e===t.column&&!t.sortedAscending;n({column:e,sortedAscending:o})};return(0,Y.jsxs)("div",{style:o.container,children:[(0,Y.jsx)(an,{title:(0,Y.jsx)(s().sA,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>r("name")}),(0,Y.jsx)(an,{title:(0,Y.jsx)(s().sA,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>r("role")})]})}function an(e){let{sortedType:t,title:n,onClick:o}=e;const i=(0,a().IS)((e=>({button:{color:e.text.secondary,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.icon.secondary}})),[]);return(0,Y.jsxs)(H().p,{style:i.button,hoveredStyle:i.buttonHover,onClick:o,children:["ascending"===t&&(0,on().q)(i.sortIcon),"descending"===t&&(0,nn().P)(i.sortIcon),n]})}function sn(e){let{store:t}=e;const n=(0,a().IS)((e=>({container:{display:"block",overflow:"hidden"},noResult:{fontSize:c().J.UIRegular.desktop,color:e.text.secondary,marginTop:8},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),[l,d]=(0,o.useState)({column:"role",sortedAscending:!1}),u=(0,r().K8)((()=>f().A.state.memberFilterQuery),[]),p=function(e){const{teamStore:t,query:n,sort:a,limit:l}=e,d=(0,i().v3)(),c=(0,r().O$)(rt().subscriptionDataStoreInstance),u=(0,s().tz)(),p=(0,qe().X)(t),m=(0,r().K8)((()=>{const e=t.getSpaceStore(),n=v().default.state.currentUserStore;return!nt().A.state.shouldUseEdgeCache&&c&&e&&n?(0,it().Ye)(c).map((o=>{var i,r;const a=ot().L.createChildStore(n,{table:et().oo,id:o.userId}),s=(0,tt().dp)(e,o.userId);return{id:o.userId,email:(null==a?void 0:a.getEmail())??"",space_id:t.getSpaceId()??"",name:(null==a?void 0:a.getName())??"",profile_photo:null==a||null===(i=a.getModel())||void 0===i?void 0:i.profile_photo,membership_type:null==s?void 0:s.getMembershipType(),onboarding_completed:null==a||null===(r=a.getModel())||void 0===r?void 0:r.onboarding_completed,first_joined_space_time:o.firstJoinedSpaceTime??Date.now()}})):[]}),[t,c]),g=(0,r().K8)((()=>nt().A.state.shouldUseEdgeCache),[]),f=(0,Je().$)(),h=(0,r().K8)((()=>{if(c&&f)return new pt({members:m,teamStore:t,currentUserStore:f,environment:d,initialQuery:n,initialSort:a,limit:l,intl:u,shouldUseEdgeCache:g,canAddMembers:p})}),[d,g,u,f]);return(0,o.useEffect)((()=>{null==h||h.setSort(a)}),[h,a]),(0,o.useEffect)((()=>{null==h||h.setQuery(n)}),[h,n]),h}({teamStore:t,query:u,sort:l,limit:30}),{members:m}=(0,r().K8)((()=>({members:null==p?void 0:p.rowsStore.state.rows})),[p]),g=(0,Je().$)(),h=(0,o.useMemo)((()=>null==m?void 0:m.findIndex((e=>"to_add"===e.type))),[m]),y=(0,o.useCallback)(((e,t)=>t===h||0===t&&"joined"===e.type?82:52),[h]),b=Boolean(null==u?void 0:u.trim().length),S=m&&m.length>0;return!p||void 0===m?(0,Y.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,Y.jsx)(Ze().A,{})}):(0,Y.jsxs)("div",{style:n.container,children:[!S&&(0,Y.jsx)("div",{style:n.noResult,children:(0,Y.jsx)(s().sA,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})}),S&&(0,Y.jsx)("div",{style:{overflow:"hidden",width:"100%",display:"flex",flexDirection:"column",height:"500px"},children:(0,Y.jsx)(Xe().u,{listSource:p,renderRow:(e,o)=>(0,Y.jsxs)(Y.Fragment,{children:[0===o&&"joined"===e.type&&(0,Y.jsx)(P().A,{isSmall:!0,style:{height:30,alignContent:"end"},children:b?(0,Y.jsx)(s().sA,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,Y.jsx)(rn,{sortType:l,onChangeSortType:d})}),o===h&&(0,Y.jsx)(P().A,{isSmall:!0,style:{height:30,alignContent:"end"},children:(0,Y.jsx)(s().sA,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"})}),"joined"===e.type?(0,Y.jsx)(ln,{teamStore:t,currentUserStore:g,memberInfo:e.value}):(0,Y.jsx)(dn,{teamStore:t,memberToAdd:e.value}),(0,Y.jsx)("div",{style:n.memberDivider})]}),estimateSize:y})})]})}function ln(e){let{teamStore:t,currentUserStore:n,memberInfo:o}=e;const i=(0,r().K8)((()=>(0,m().mo)({currentUserStore:n,teamStore:t,member:o})),[n,t,o]);return i?(0,Y.jsx)(qt,{store:t,...i}):null}function dn(e){let{teamStore:t,memberToAdd:n}=e;return"group_id"in n?(0,Y.jsx)(en,{teamStore:t,groupToAdd:n}):(0,Y.jsx)(en,{teamStore:t,memberToAdd:n})}function cn(e){let{teamStore:t}=e;const n=(0,a().IS)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,Y.jsxs)("div",{style:n.content,children:[(0,Y.jsx)(Qe,{teamStore:t}),(0,Y.jsx)(sn,{store:t})]})}var un=()=>n(278238);function pn(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,s().tz)(),{teamGuestPermissionItem:l,teamPermissions:d}=(0,r().K8)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),c=E(t),u=(0,r().K8)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:o.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[o]),p=(0,a().IS)((e=>({button:{fontSize:12.5,marginRight:0,color:e.text.secondary}})),[]),m=l&&(0,Y.jsx)(Rt().Ay,{role:l.role,table:Bt().yK,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:c,buttonStyle:p.button,availableRoleItems:u,onChange:async e=>{if(d.filter((t=>((0,me().B2)(t)||(0,me().Ds)(t))&&(0,ge().dI)(e,t.role))).length>0){if(!(await(0,L().fT)()))return}j().createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:o=>{D().HU({environment:n,teamStore:t,newRole:e,transaction:o,permissionsToClear:[]})}})}}),g=(0,r().K8)((()=>t.getName()),[t]),f=(0,r().K8)((()=>t.getIcon()),[t]),h=f&&un().T8(f.icon)?un().VA(f.icon):"gray",v=f?{...f,icon:`/icons/user-circle_${h}.svg`}:void 0,y=(0,Y.jsx)(K().x,{disabled:!0,store:t,size:Z,icon:v});return m?(0,Y.jsx)(Yt,{permissionRoleSelectComponent:m,iconComponent:y,name:mn(g)}):null}function mn(e){return e?(0,Y.jsx)(s().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,Y.jsx)(s().sA,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function gn(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,a().DP)(),l=(0,s().tz)(),{teamPermissionItem:d,teamPermissions:c}=(0,r().K8)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=E(t),p=(0,r().K8)((()=>{var e;const n=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),o=l.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function i(e){return n&&e!==n.role&&(0,ge().$q)(e,n.role)===n.role&&!t.isDefault()?{role:e,disabledInfo:{isDisabled:!0,disabledMessage:o}}:{role:e,disabledInfo:void 0}}return[i("editor"),i("read_and_write"),i("comment_only"),i("reader")]}),[l,t]),m=d&&(0,Y.jsx)(Rt().Ay,{role:d.role,table:Bt().yK,type:(0,me().gl)(d)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:o.text.secondary},availableRoleItems:p,onChange:async e=>{const o=c.filter((t=>((0,me().B2)(t)||(0,me().Ds)(t))&&(0,ge().dI)(e,t.role)));if(o.length>0){if(!(await(0,L().fT)()))return}j().createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:n,canUndo:!0,perform:i=>{D().xp({environment:n,teamStore:t,newRole:e,transaction:i,permissionsToClear:o})}})}}),{teamName:g}=(0,r().K8)((()=>({teamName:t.getName()})),[t]),f=(0,Y.jsx)(K().x,{disabled:!0,store:t,size:Z});return(0,Y.jsx)(Yt,{permissionRoleSelectComponent:m,iconComponent:f,name:fn(g)})}function fn(e){return e?(0,Y.jsx)(s().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,Y.jsx)(s().sA,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var hn=()=>n(87043);const vn=Z,yn=16;function bn(e){let{ownerStores:t,teamStore:n,isSmall:o=!1}=e;const i=o?vn:hn().Ev,s=o?10:yn,l=(0,a().IS)((e=>({container:{position:"relative",width:i,height:i},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[i]),{teamName:d,teamIcon:c}=(0,r().K8)((()=>({teamName:n.getName(),teamIcon:n.getIcon()})),[n]),u=e=>(0,Y.jsx)(bt().B6,{disabled:!0,title:d,icon:c,isEmptyPage:!1,size:e,iconRecordCategory:"teamspace"});return 0===t.length?u(i):(0,Y.jsxs)("div",{style:l.container,children:[(0,Y.jsx)(Sn,{isSmall:o,store:t[0]}),(0,Y.jsx)("div",{style:l.teamBadge,children:u(s)})]})}function Sn(e){let{store:t,isSmall:n=!1,style:o={}}=e;const i=n?vn:hn().Ev,r=(0,a().IS)((e=>({icon:{width:i,height:i,borderRadius:i,boxShadow:e.avatarBoxShadow,...o}})),[i,o]);return(0,Y.jsx)("div",{style:r.icon,children:(0,Y.jsx)(St().A,{avatarShouldShowShadow:!0,userStore:t,size:i})})}function xn(e){const{teamStore:t,teamOwnerIds:n}=e,o=(0,a().DP)(),i=(0,r().K8)((()=>t.getName()),[t]),l=(0,r().K8)((()=>t.getTeamOwnerPermission()),[t]),d=(0,Je().$)(),c=(0,r().K8)((()=>d?n.map((e=>y().LU.createChildStore(d,{table:et().oo,id:e}))):[]),[d,n]);return(0,Y.jsx)(Yt,{tooltip:(0,Y.jsx)(s().sA,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,Y.jsx)(Rt().Ay,{role:"editor",table:Bt().yK,type:l&&(0,me().nl)(l)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:o.text.secondary,marginRight:0},availableRoleItems:[]}),iconComponent:(0,Y.jsx)(bn,{teamStore:t,ownerStores:c,isSmall:!0}),name:An(i)})}function An(e){return e?(0,Y.jsx)(s().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,Y.jsx)(s().sA,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Mn=()=>n(449552),wn=()=>n(579627);function kn(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,r().O$)(v().AppStoreCurrentSpaceStore),{iconComponent:a,spaceName:s}=(0,r().K8)((()=>{if(!o)return{iconComponent:void 0,spaceName:void 0};const e=(0,ee().GK)(n,o);return{iconComponent:(0,Y.jsx)(K().x,{disabled:!0,store:o,size:Z}),spaceName:e}}),[o,n]);return(0,Y.jsx)(Yt,{permissionRoleSelectComponent:(0,Y.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,Y.jsx)(Cn,{teamStore:t})}),iconComponent:a,name:jn(s)})}function jn(e){return e?(0,Y.jsx)(s().sA,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,Y.jsx)(s().sA,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function Cn(e){const{teamStore:t}=e,n=(0,i().v3)(),o=(0,a().DP)(),d=(0,r().K8)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),c=E(t),u=(0,r().K8)((()=>{const e=t.getSettingsStore().getValue();if(e)return be({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const p=u.permissionItemRoleOptions.spacePermission;if(1===p.length&&"none"===p[0])return(0,Y.jsx)(_().A,{renderTooltip:()=>(0,Y.jsx)(s().sA,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,Y.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,Mn().g)({width:14,height:14,fill:o.timelineRed,marginRight:4}),(0,Y.jsx)("div",{style:{fontSize:12.5,color:o.timelineRed,marginRight:8},children:(0,Y.jsx)(s().sA,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=l().Ul(p,(e=>-me().TE[e])).map((e=>({role:e})));return(0,Y.jsx)(Rt().Ay,{role:d.role,table:Bt().yK,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:c||1===p.length,buttonStyle:{fontSize:12.5,marginRight:0,color:o.text.secondary},availableRoleItems:e,onChange:e=>{const o={...d,role:e};j().createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:n,canUndo:!0,perform:e=>{wn().bo({environment:n,store:t,permissionItems:[o],transaction:e})}})}})}}function In(e){let{teamStore:t}=e;const n=(0,r().K8)((()=>t.isDefault()),[t]),o=(0,r().K8)((()=>t.getOwnerUserIds()),[t]),i=(0,r().K8)((()=>{const e=v().default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!n&&(0,wt().Qd)())}),[n]),s=(0,a().IS)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,Y.jsxs)("div",{style:s.container,children:[(0,Y.jsx)(xn,{teamStore:t,teamOwnerIds:o},"0"),(0,Y.jsx)(gn,{teamStore:t},"1"),i&&(0,Y.jsx)(pn,{teamStore:t},"2"),!n&&(0,Y.jsx)(kn,{teamStore:t},"3")]})}function Tn(e){let{teamStore:t}=e;const n=(0,a().IS)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(_n,{teamStore:t}),(0,Y.jsx)("div",{style:n.spacer}),(0,Y.jsx)(q,{title:(0,Y.jsx)(s().sA,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:n.heading}),(0,Y.jsx)(cn,{teamStore:t})]})}function _n(e){let{teamStore:t}=e;const n=(0,i().v3)(),l=(0,r().K8)((()=>t.getName()),[t]),d=(0,a().IS)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),c=(0,o.useCallback)(((e,o)=>{D().qH({environment:n,accessLevel:e,isDefault:o,store:t,teamName:l,from:"sidebar_team_modal"})}),[n,t,l]),u=(0,r().K8)((()=>t.getTeamAccessLevel()),[t]),p=[(0,Y.jsx)(te().u,{teamStore:t,currentAccessLevel:u,onChange:c,style:d.accessButton},"visibility"),(0,Y.jsx)(In,{teamStore:t},"permissions")];return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(X,{title:(0,Y.jsx)(s().sA,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:p,itemStyle:d.teamSettingsListItems}),(0,Y.jsx)(z().A,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,Y.jsx)(s().sA,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:d.learnMoreLinkContainer})]})}var Pn=()=>n(192940),Bn=()=>n(545805),Ln=()=>n(676007),Rn=()=>n(16006),Dn=()=>n(2143),Nn=()=>n(994006),On=()=>n(101919),En=()=>n(987017),Un=()=>n(824160);function Fn(e){return(0,Y.jsx)(Un().A,{...e,children:(0,Y.jsx)(s().sA,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function Vn(e){const{teamStore:t}=e,n=(0,r().K8)((()=>f().A.state.tab),[]);if(void 0===n)return null;switch(n){case f().p.General:return(0,Y.jsx)(Ve,{teamStore:t});case f().p.Members:return(0,Y.jsx)(Tn,{teamStore:t});case f().p.Security:return(0,Y.jsx)(De,{teamStore:t});default:(0,d().HB)(n)}}function zn(e){const{userId:t,currentSpaceStore:n}=e,{userStore:o,isDefined:i}=(0,r().K8)((()=>{const e=y().LU.createChildStore(n,{table:"notion_user",id:t,spaceId:n.id});return{userStore:e,isDefined:e.isDefined()}}),[n,t]);return i?(0,Y.jsx)(Nn().A,{avatarShouldShowShadow:!0,userStore:o,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function Kn(e){const{userIds:t,label:n,hasMarginTop:o}=e,i=(0,r().O$)(v().AppStoreCurrentSpaceStore);return i?(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(On().A,{hasMarginTop:o,children:n}),t.map((e=>(0,Y.jsx)(zn,{userId:e,currentSpaceStore:i},e)))]}):null}function Wn(){const e=(0,i().v3)(),t=(0,r().O$)(v().AppStoreCurrentSpaceStore),n=(0,r().O$)(v().AppStoreCurrentSpaceViewStore),y=(0,i().Y0)(),b=(0,a().IS)((e=>({modal:{width:y.isMobile?"auto":630,height:y.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.icon.secondary},icon:{marginRight:8,fontWeight:c().Wy.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.text.primary,fontWeight:c().Wy.regular,textTransform:"unset",fontSize:11}})),[y.isMobile]),A=(0,m().D5)(),{open:M,tab:w,teamStore:k,teamId:j}=(0,r().K8)((()=>{const{open:e,tab:t}=f().A.state,n=f().A.getTeamStore();return{open:e,tab:t,teamStore:n,teamId:null==n?void 0:n.id}}),[]),C=(0,g().T)(),I=(0,m().BJ)({userId:C,spaceStore:t,teamId:j??""}),T=(0,o.useMemo)((()=>A?I:k),[I,k,A]),_=(0,r().K8)((()=>null==T?void 0:T.getSettings()),[T]),P=(0,O().R)(T);if(!t||!n||!T)return null;const B=[f().p.General,f().p.Members,f().p.Security];return(0,Y.jsx)(Ln().a,{open:M,innerStyle:b.modal,onDismiss:()=>{f().A.reset()},render:()=>M?(0,Y.jsx)("div",{className:p().kYU,style:{height:"100%"},children:(0,Y.jsx)("div",{style:b.modalWrap,children:(0,Y.jsx)(Bn().A,{debugName:"SidebarTeamModal",capture:!0,onBackspace:l().D_,onLeft:l().D_,onRight:l().D_,onSelectAll:l().D_,onRedo:l().D_,onUndo:l().D_,onCut:l().D_,onCopy:l().D_,onPaste:l().D_,onKeypress:l().D_,onDelete:l().D_,onTab:l().D_,children:(0,Y.jsxs)("div",{style:b.innerWrap,children:[(0,Y.jsxs)("div",{style:b.header,children:[(0,Y.jsx)(K().x,{disabled:!0,store:T,size:24,style:b.icon}),(0,Y.jsx)(Rn().A,{store:T,style:{fontSize:16,fontWeight:c().Wy.semibold}}),(0,m().tM)(_)&&(0,Y.jsx)(x().A,{iconStyle:b.lockIcon}),(0,m().A2)({membership:T.getRawMembership()})&&(0,Y.jsx)("div",{style:{gap:5,display:"flex"},children:(0,Y.jsx)(Fn,{desktopStyle:b.unownedPill,mobileStyle:b.unownedPill,innerStyle:b.unownedPillInner})}),(0,Y.jsx)("div",{style:{flexGrow:1}}),(0,Y.jsx)(S().TeamJoinLeaveButton,{teamStore:T,onLeavingTeam:()=>f().A.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,Y.jsx)(En().Ay,{tabs:B.map((e=>function(e,t){switch(e){case f().p.General:return(0,Y.jsx)(s().sA,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case f().p.Members:return(0,Y.jsx)(Hn,{teamStore:t});case f().p.Security:return(0,Y.jsx)(s().sA,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,d().HB)(e)}}(e,T))),selectedIndex:(0,d().O9)(w)?B.indexOf(w):1,onChange:t=>{M&&(u().Vg(e,{store:T,tab_old_value:w??f().p.General,tab_new_value:B[t]}),f().A.update((e=>e.open?{...e,tab:B[t]}:e)))},tabStyle:{marginLeft:-8},style:b.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,Y.jsx)(Dn().H,{type:h().A.Y,style:b.scroller,children:(0,Y.jsx)("div",{style:b.contentWrap,children:(0,Y.jsx)(Vn,{currentSpaceStore:t,teamStore:T,userIsTeamOwner:P})})})]})})})}):null})}function Hn(e){let{teamStore:t}=e;const n=(0,Pn().h)(t),o=(0,a().DP)();return(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(s().sA,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,Y.jsx)("span",{children:" "}),(0,Y.jsx)("div",{style:{color:o.text.tertiary},children:n})]})}function Gn(e){let{title:t,caption:n,secondCaption:o,on:r,disabled:s,tooltip:l,style:d,switcherStyle:c,onChange:u,shouldTriggerUpsell:p,upsellTier:m,isLocked:g,lockedTooltip:f}=e;const h=(0,i().v3)(),v=(0,a().IS)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:p?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18,...c}})),[p,d,c]);return(0,Y.jsxs)("div",{style:v.root,onClick:()=>{if(p)return b().K(h,{from:"team_security_settings",upsell:{type:"product",product:m,limit:{type:"none"},trialability:"none"},dontOpenPlansOnCancel:!0})},children:[(0,Y.jsxs)("div",{style:v.title,children:[t,n&&(0,Y.jsx)(P().A,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:n}),o&&(0,Y.jsx)(P().A,{isSmall:!0,children:o})]}),(0,Y.jsx)("div",{style:v.switcherWrap,children:(0,Y.jsx)(_().A,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,Y.jsx)("div",{...e,children:(0,Y.jsx)(Ce().A,{on:r,disabled:s,onClick:u,isLocked:g,lockedTooltip:f})})})})]})}},375078:(e,t,n)=>{n.r(t),n.d(t,{maybeTurnCollectionViewIntoCollectionViewPage:()=>M,transformBlocks:()=>A,transformIntoColumnList:()=>w});n(581454);var o=()=>n(908006),i=()=>n(700500),r=()=>n(179034),a=()=>n(496603),s=()=>n(722101),l=()=>n(44729),d=()=>n(863168),c=()=>n(246826),u=()=>n(797265),p=()=>n(778417),m=()=>n(725614),g=()=>n(751156),f=()=>n(62287),h=()=>n(87017),v=()=>n(594794),y=()=>n(299545),b=()=>n(217429),S=()=>n(630116),x=()=>n(65269);function A(e){const{environment:t,blocks:n,blockType:x,transaction:A}=e;if(x!==i().xd.transclusionContainer)if(x===i().xd.callout&&b().default.checkGate({gateName:"create_v2_callouts"}))!function(e){const{environment:t,blocks:n,transaction:o}=e,a=n[0];if(!a)return;const s=a.getRecordStoreUIParent();if(!s||!(0,y().iU)(s))return;const u=s.getRecordStoreUIParent();if(!(u&&u instanceof S().Bv))return;const g=(0,v().Z1)({environment:t,table:r().ev,spaceId:u.getSpaceId()}),f=c().Wv({environment:t,id:g,type:i().xd.callout,inMemoryRecordCache:s.inMemoryRecordCache,transaction:o,spaceId:u.getSpaceId(),format:{callout_version:2}});l().NI({parentStore:s,childStore:f,after:a.id,transaction:o});k({newParentStore:f.getContentStore(),blocks:n,transaction:o}),d().s4({store:f,transaction:o}),m().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[f]})}({environment:t,blocks:n,transaction:A});else if(x!==i().xd.columnList)if(x!==i().xd.slide)if((0,i().ZK)(x)){const e=parseInt(x.replace("column","").replace("block","")),i=a().oE(a().Hn(e-1,(()=>h().insertTextBelow({environment:t,blocks:n,transaction:A})))),r=[...n,...i],s=w({environment:t,blocks:r,transaction:A});o().default.afterNextFlush((()=>{m().setSelectionAtStart({store:s[0].getBlockTitleStore()})}))}else for(const i of n)if(i.isCalloutV2()){const e=i.getParentBlockStore();if(e){const r=i.getContentStores();g().applyOperation({store:e,operation:{pointer:e.pointer,path:["content"],command:"insertChildrenAfter",args:{ids:r.map((e=>e.id)),after:i.id}},transaction:A}),l().zz({parentStore:e.getContentStore(),childStore:i,transaction:A});for(const e of r)f().pd({environment:t,block:e,blockType:x,transaction:A,isMultiBlockTransformation:n.length>1});o().default.afterNextFlush((()=>{u().dL(t,r.map((e=>e.id)))}))}}else f().pd({environment:t,block:i,blockType:x,transaction:A,isMultiBlockTransformation:n.length>1});else!function(e){const{environment:t,blocks:n,transaction:o}=e,a=n[0];if(!a)return;const s=a.getRecordStoreUIParent();if(!s||!(0,y().iU)(s))return;const d=s.getRecordStoreUIParent();if(!(d&&d instanceof S().Bv))return;const u=(0,v().Z1)({environment:t,table:r().ev,spaceId:d.getSpaceId()}),g=c().Wv({environment:t,id:u,type:i().xd.slide,inMemoryRecordCache:s.inMemoryRecordCache,transaction:o,spaceId:d.getSpaceId()});l().NI({parentStore:s,childStore:g,after:a.id,transaction:o});k({newParentStore:g.getContentStore(),blocks:n,transaction:o}),m().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[g]})}({environment:t,blocks:n,transaction:A});else w({environment:t,blocks:n,transaction:A});else!function(e){const{environment:t,blocks:n,transaction:o}=e,a=n[0];if(!a)return;const l=a.getRecordStoreUIParent();if(!l||!(0,y().iU)(l))return;const d=l.getRecordStoreUIParent();if(!d||!(0,y()._p)(d))return;if(!d.isDefined())return;const u=(0,v().Z1)({environment:t,table:r().ev,spaceId:d.getSpaceId()}),g=c().Wv({environment:t,id:u,type:i().xd.transclusionContainer,inMemoryRecordCache:l.inMemoryRecordCache,transaction:o,spaceId:d.getSpaceId()});s().WH({parentStore:l,insertStore:g,afterStore:a,transaction:o});k({newParentStore:g.getContentStore(),blocks:n,transaction:o}),m().clear({environment:t}),p().IU({environment:t}),p().td({environment:t,stores:[g]})}({environment:t,blocks:n,transaction:A})}function M(e){let{environment:t,blocks:n,transaction:o}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(n)&&A({environment:t,blocks:n,blockType:"collection_view_page",transaction:o})}function w(e){const{environment:t,blocks:n,transaction:o}=e,a=n[0];if(!a)return[];const l=a.recordStoreUIParentStore;if(null==l||!l.valueIs(x()._))return[];const d=(0,v().Z1)({environment:t,table:r().ev,spaceId:a.getSpaceId()}),u=c().Wv({environment:t,id:d,type:i().xd.columnList,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,spaceId:a.getSpaceId()}),{childStore:p}=s().nc({parentStore:l,insertStore:u,beforeStore:a,transaction:o});return n.map((e=>{const n=(0,v().Z1)({environment:t,table:r().ev,spaceId:a.getSpaceId()}),d=c().Wv({environment:t,id:n,type:i().xd.column,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,spaceId:a.getSpaceId()}),{childStore:u}=s().TF({parentStore:l,childToRemoveStore:e,transaction:o}),{childStore:m}=s().WH({parentStore:p.getContentStore(),insertStore:d,transaction:o}),{childStore:g}=s().WH({parentStore:m.getContentStore(),insertStore:u,transaction:o});return g}))}function k(e){const{newParentStore:t,blocks:n,transaction:o}=e;for(const i of n){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(x()._)&&(s().TF({parentStore:e,childToRemoveStore:i,transaction:o}),s().BC({parentStore:t,appendStore:i,transaction:o}))}}},381495:(e,t,n)=>{n.r(t),n.d(t,{CloseTemplatesPopupComponent:()=>ve,default:()=>se});var o=()=>n(624119),i=n(296540),r=()=>n(484714),a=()=>n(56366),s=()=>n(401497),l=()=>n(292119),d=()=>n(380048),c=()=>n(212050),u=()=>n(959013),p=()=>n(209199),m=()=>n(284371),g=()=>n(112873),f=()=>n(901389),h=()=>n(413677),v=()=>n(436572),y=()=>n(824622),b=()=>n(37546),S=()=>n(202106);function x(){return"web-mobile"===(0,r().Y0)().deviceType}var A=()=>n(345737),M=()=>n(78219),w=()=>n(396990),k=()=>n(765957),j=()=>n(714818),C=()=>n(712505),I=()=>n(757695);class T extends I().Store{getInitialState(){return{inMemoryRecordCache:new(n(221844).A)({name:"TemplateRecordCacheStore"})}}}var _=()=>n(112527),P=()=>n(704152),B=()=>n(285790),L=()=>n(331542),R=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(581454),()=>n(386164)),D=()=>n(388821),N=()=>n(861017),O=()=>n(179034),E=()=>n(824862),U=()=>n(798880),F=()=>n(919709),V=()=>n(449506),z=()=>n(276470),K=()=>n(620689),W=()=>n(54362),H=()=>n(780054),G=()=>n(484792),Y=()=>n(186445),q=()=>n(396831);class $ extends I().Store{getInitialState(){return{}}}const Q=$;var Z=()=>n(548821),X=()=>n(630116),J=()=>n(2143),ee=()=>n(299772),te=()=>n(13679),ne=n(474848);const oe=function(e){let{style:t,disabled:o,disablePointerEvents:s,previewRootId:l,previewSpaceId:d,isPaidTemplate:c,userHasAcquiredTemplate:p,templateRecordCacheStore:m}=e;const g=(0,r().v3)(),f=(0,a().uB)(m,T),h=(0,a().uB)(void 0,Q),v=(0,a().O$)(n(227440).A),y=(0,i.useCallback)(((e,n)=>(0,ne.jsx)(re,{err:e,store:n,style:t,disabled:o,disablePointerEvents:s,isPaidTemplate:c,userHasAcquiredTemplate:p,pageTemplatePreviewStore:h})),[t,o,s,h,c,p]),b=(0,i.useCallback)((e=>{const{rootId:t,spaceId:n}=e;return async function(e,t,n,o,i){if(i){return new(X().Bv)(n,{table:O().ev,id:e})}const r=await V().callApi({eventName:"loadBlockSubtree",environment:n,data:{block:{id:e,spaceId:t},shallow:!1},headers:(0,R().WS)({spaceId:t})});if("failed"===r.type)throw r.error;const{currentSpaceStore:a}=k().default.state,{inMemoryRecordCache:s}=o.state;s.clearCache(),s.isTemplatePreview=!0;const l=new Set,d=new Set,c=D().RecordMapWithRole.create(r.data.subtreeRecordMap);for(const f of c){const{pointer:e,model:t,role:o}=f;if(!o)return;if(s.setModelAndRole({pointer:e,userId:n.currentUser.id},t,"editor"),(null==t?void 0:t.table)===O().ev){const e=t.getProperties();for(const t of Object.keys(e)){const n=(0,F().Fbh)(e[t]);for(const e of n)l.add(e);const o=(0,F().jgW)(e[t]);for(const e of o)d.add(e)}t.created_by_table&&t.created_by_id&&(t.created_by_table===U().oo?l.add(t.created_by_id):d.add(t.created_by_id)),t.last_edited_by_table&&t.last_edited_by_id&&(t.last_edited_by_table===U().oo?l.add(t.last_edited_by_id):d.add(t.last_edited_by_id))}}const u=await Promise.all(Array.from(l).map((async e=>{if(a){const t=X().LU.createChildStore(a,{table:U().oo,id:e});await t.load();return t.getValue()}{const t=await(0,z().e)(n,{pointer:{table:U().oo,id:e},userId:n.currentUser.id,version:-1});return t&&t.value}})));for(const f of u)f&&s.setRecord({pointer:{table:U().oo,id:f.id},userId:n.currentUser.id},{role:"reader",value:f});const p=await Promise.all(Array.from(d).map((async e=>{if(a){const t=(0,X().Oo)(a,{table:E().GP,id:e,spaceId:a.id});await t.load();return t.getValue()}{const t=await(0,z().e)(n,{pointer:{table:E().GP,id:e},userId:n.currentUser.id,version:-1});return t&&t.value}})));for(const f of p)f&&s.setRecord({pointer:{table:E().GP,id:f.id,spaceId:f.space_id},userId:n.currentUser.id},{role:"reader",value:f});const{currentUserStore:m}=k().default.state;m&&(await m.load(),s.setRecord({pointer:m.pointer,userId:n.currentUser.id},{role:"editor",value:m.getValue()}));const g=new(X().Bv)(n,{table:O().ev,id:e},{inMemoryRecordCache:s});return g}(t,n,g,f,o)}),[g,f,o]),S=(0,i.useCallback)((e=>function(e,t,n){const{device:o}=t,i=(0,N().parseRoute)({url:e,isMobile:o.isMobile,baseUrl:H().A.domainBaseUrl,publicDomainName:H().A.publicDomainName,protocol:H().A.protocol,currentUrl:window.location.href});"page"===i.name&&(i.peekViewBlockId?n.setState({...n.state,navigatedRootId:i.peekViewBlockId}):n.setState({...n.state,navigatedRootId:i.blockId}))}(e,g,h)),[g,h]);return v.online?(0,ne.jsx)(G().B,{value:S,children:(0,ne.jsx)(n(251126).A,{request:{rootId:l,spaceId:d},performRequest:b,render:y})}):(0,ne.jsx)(G().B,{value:S,children:(0,ne.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...t},children:(0,ne.jsx)(n(125565).A,{isSmall:!0,children:(0,ne.jsx)(u().sA,{defaultMessage:"Please go online to view this template.",id:"pageTemplatePreview.offline.message"})})})})};function ie(e){const{device:t}=e;return{flex:1,...t.isSafari&&{zIndex:1}}}function re(e){let{store:t,style:n,disabled:o,disablePointerEvents:s,isPaidTemplate:l,userHasAcquiredTemplate:d,pageTemplatePreviewStore:c}=e;const p=(0,r().v3)(),m=(0,r().Y0)(),g=(0,a().uB)(c,Q),f=(0,a().K8)((()=>g.state.navigatedRootId),[g]),h=x(),y=(0,a().K8)((()=>t&&(0,Y().fl)({environment:p,store:t})),[p,t]);if((0,i.useEffect)((()=>{l&&!h&&v().D6({label:(0,ne.jsx)(u().sA,{defaultMessage:"Purchase is unavailable on this platform",id:"pageTemplatePreview.paidTemplate.message"}),durationMs:"keep"})}),[p,l,h,d]),t&&y){let e;return e=f?X().Bv.createChildStore(t,{table:O().ev,id:f}):t,(0,ne.jsx)("div",{style:n,children:(0,ne.jsx)(te().A,{store:e,isDefaultContainer:!0,droppable:!0,render:t=>{let{selectableEvents:n,selectableHoverMenuOverlay:i}=t;return(0,ne.jsx)(J().H,{style:ie(p),type:y,store:q().A,preventType:K().u5(p),...n,children:s?(0,ne.jsxs)("section",{inert:"",children:[i,(0,ne.jsx)(ee().Ay,{store:e,context:Z().Rr.InAppTemplatePreview,paddingBottom:(0,ee().Wj)(m),disabled:o})]}):(0,ne.jsxs)(ne.Fragment,{children:[i,(0,ne.jsx)(ee().Ay,{store:e,context:Z().Rr.InAppTemplatePreview,paddingBottom:(0,ee().Wj)(m),disabled:o})]})},e.id)}},e.id)})}return(0,ne.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...n},children:(0,ne.jsx)(L().A,{legacySize:W().Kh})})}const ae={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"};const se=function(){const e=(0,r().v3)(),t=(0,a().uB)(void 0,T),o=(0,i.useCallback)((()=>pe(e,t)),[e,t]),s=(0,i.useCallback)((()=>(0,ne.jsx)(ge,{templateRecordCacheStore:t})),[t]),{device:l}=e,d=(0,a().O$)(j().A),c=(0,a().O$)(k().AppStoreCurrentSpaceViewStore);return(0,i.useEffect)((()=>{d.open&&c&&n(751156).createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:e,canUndo:!0,perform:e=>{h().setTemplateVisited({item:d.item,spaceViewStore:c,transaction:e})}})}),[c,e,d.item,d.open]),l.isMobile?(0,ne.jsx)(n(897119).Ay,{open:d.open,render:s,forceFullScreenSlideUp:!0,onDismiss:o,popupType:n(377586).n.SlideUp}):null};function le(){return new Promise(((e,t)=>{f().ui({message:(0,ne.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:(0,ne.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:(0,ne.jsx)(u().sA,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}function de(e){h().close(e),g().xl()}function ce(e){var t,n;let{modalState:o,templateRecordCacheStore:i}=e;const r=(0,a().uB)(i,T);return(0,ne.jsx)(oe,{disablePointerEvents:o.disablePointerEvents,previewRootId:o.item.previewRootId,previewSpaceId:o.item.spaceId,isPaidTemplate:Boolean(null===(t=o.item.marketplaceTemplateMetadata)||void 0===t?void 0:t.isPaidTemplate),userHasAcquiredTemplate:Boolean(null===(n=o.item.marketplaceTemplateMetadata)||void 0===n?void 0:n.userHasAcquiredTemplate),style:ae,templateRecordCacheStore:r,disabled:!0},o.item.previewRootId)}function ue(e,t,n,o){const{inMemoryRecordCache:i}=n.state,r=j().A.state,{currentSpaceViewStore:a,currentSpaceStore:s,mainEditorCurrentBlockStore:l}=k().default.state;if(r.open&&a&&s){const n=l&&l.isEmptyPage()?l:void 0,d=C().default.state.open&&C().default.state.targetStore&&C().default.state.targetStore.isEmptyPage()?C().default.state.targetStore:void 0;h().accept({environment:t,item:r.item,spaceStore:s,spaceViewStore:a,useRecordCache:e?i:void 0,initializeStore:r.createNewPage?void 0:n||d,isPrivate:r.isPrivate,acceptFrom:r.createNewPage?"sidebar":"newPage",isEmailShared:o})}}async function pe(e,t){const{inMemoryRecordCache:n}=t.state;if(v().N2(),n.appliedTransaction){await le()?ue(!0,e,t):de(e)}else de(e)}async function me(e,t,n){var o,i,r,a;const{inMemoryRecordCache:s}=t.state;if(s.appliedTransaction){return void ue(!!(await le()),e,t)}const l=null===(o=j().A.state.item)||void 0===o||null===(o=o.marketplaceTemplateMetadata)||void 0===o?void 0:o.isPaidTemplate,d=null===(i=j().A.state.item)||void 0===i||null===(i=i.marketplaceTemplateMetadata)||void 0===i?void 0:i.marketplaceListingId,c=null===(r=j().A.state.item)||void 0===r||null===(r=r.marketplaceTemplateMetadata)||void 0===r?void 0:r.userHasAcquiredTemplate,u=null===(a=j().A.state.item)||void 0===a?void 0:a.id;if(j().A.state.open&&l&&d&&u&&!c)return A().A.setState({...A().A.state,from:"mobileApp",marketplaceListingId:d,templateId:u}),void j().A.setState({...j().A.state,isCheckout:!0});!c&&l||ue(!1,e,t,n)}function ge(e){var t,n,d,c,m;let{templateRecordCacheStore:g}=e;const f=(0,r().v3)(),h=(0,u().tz)(),C=(0,s().DP)(),I=x(),T=(0,a().K8)((()=>{var e;return(null===(e=k().default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||p().q}),[]),P=(0,a().K8)((()=>M().A.state.duplicationStatus),[]),B=(0,a().O$)(j().A),R=null===(t=B.item)||void 0===t||null===(t=t.marketplaceTemplateMetadata)||void 0===t?void 0:t.creator,D=null===(n=B.item)||void 0===n||null===(n=n.marketplaceTemplateMetadata)||void 0===n?void 0:n.emailCaptureType,N="duplicating"===P,O=Boolean(null===(d=B.item)||void 0===d||null===(d=d.marketplaceTemplateMetadata)||void 0===d?void 0:d.isPaidTemplate),E=null===(c=B.item)||void 0===c||null===(c=c.marketplaceTemplateMetadata)||void 0===c?void 0:c.paidTemplatePrice,U=Boolean(null===(m=B.item)||void 0===m||null===(m=m.marketplaceTemplateMetadata)||void 0===m?void 0:m.userHasAcquiredTemplate),F=(0,i.useCallback)((()=>{if("required"!==D&&"optional"!==D)return me(f,g);w().A.open({creator:R,emailRequirement:D,onSubmit:async e=>{await me(f,g,e)}})}),[f,D,R,g]),V=(0,i.useCallback)((()=>pe(f,g)),[f,g]),z=(0,i.useCallback)((()=>{v().N2(),j().A.state.open&&j().A.setState({...j().A.state,isCheckout:!1}),A().A.setState({...A().A.state,isModalOpen:!1,from:void 0,marketplaceListingId:void 0,templateId:void 0,creatorId:void 0,customerId:void 0})}),[]),K=(0,S().IT)(C,T);return B.open?(0,ne.jsx)(y().QA,{title:B.isCheckout?(0,ne.jsx)(u().sA,{defaultMessage:"Complete checkout",id:"pageTemplateModal.mobileModal.checkoutTitle"}):void 0,left:B.isCheckout?(0,ne.jsx)(he,{handleClick:z}):(0,ne.jsx)(ve,{handleClick:V,style:{marginLeft:20}}),right:B.isLoading?(0,ne.jsx)(L().A,{style:{marginRight:40}}):B.isCheckout?null:(0,ne.jsx)(fe,{handleClick:F,isDisabled:N||O&&!I,label:U?(0,ne.jsx)(u().sA,{id:"inApp.marketplace.template.addAgain",defaultMessage:"Add again"}):O&&E?(0,ne.jsx)(u().sA,{id:"inApp.marketplace.template.buyTemplate",defaultMessage:"Buy for <money></money>",values:{money:()=>(0,ne.jsx)(l().v,{cost:{amount:100*E,currencyCode:"USD"},intl:h,trailingZeroDisplay:"auto"})}}):void 0}),shouldRenderLeftDirectly:!0,shouldRenderRightDirectly:!0,onCancel:V,disableHeaderShadow:!0,forceFullScreenSlideUp:!0,children:B.isCheckout?(0,ne.jsx)(o().Elements,{stripe:(0,_().getStripe)(),options:K,children:(0,ne.jsx)(b().l,{})}):(0,ne.jsx)(ce,{templateRecordCacheStore:g,modalState:B})}):null}function fe(e){let{handleClick:t,isDisabled:n,label:o}=e;const i=(0,s().IS)((e=>({doneButton:{display:"flex",alignItems:"center",height:34,paddingLeft:14,paddingRight:14,marginRight:20,fontWeight:m().Wy.medium,color:n?e.text.secondary:e.text.primary,background:e.tint.regular,borderRadius:17}})),[n]);return(0,ne.jsx)(P().A,{style:i.doneButton,onClick:t,disabled:n,children:o||(0,ne.jsx)(u().sA,{defaultMessage:"Use template",id:"pageTemplateModal.mobileModal.useTemplateButton.label"})})}function he(e){let{handleClick:t}=e;const n=(0,u().tz)(),o=(0,s().IS)((e=>({iconButton:{borderRadius:17,width:34,height:34,marginLeft:20},icon:{width:20,height:20}})),[]);return(0,ne.jsx)(B().A,{icon:e=>(0,d().I)(o.icon),style:o.iconButton,color:"primary",onClick:t,ariaLabel:n.formatMessage({defaultMessage:"Back",id:"pageTemplateModal.mobileModal.checkout.backButton.label"})})}function ve(e){let{handleClick:t,style:n,disabled:o}=e;const i=(0,s().DP)(),r=(0,u().tz)(),a={background:i.tint.regular,borderRadius:17,width:34,height:34,...n};return(0,ne.jsx)(B().A,{disabled:o,icon:e=>(0,c().u)({width:20,height:20}),style:a,color:"primary",onClick:t,ariaLabel:r.formatMessage({defaultMessage:"Close",id:"pageTemplateModal.mobileModal.closeButton.label"})})}},391435:(e,t,n)=>{n.d(t,{Z:()=>w});n(944114),n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(401497),a=()=>n(529324),s=()=>n(644161),l=()=>n(185078),d=()=>n(959013),c=()=>n(778078),u=()=>n(2220),p=()=>n(722872),m=()=>n(760217),g=()=>n(419357),f=()=>n(928600),h=()=>n(939740),v=()=>n(64e3),y=()=>n(460292),b=()=>n(89924),S=()=>n(662971),x=n(474848);const A=1,M=(0,d().YK)({sourceLanguage:{id:"translation.languageMenuList.sourceLanguage",defaultMessage:"From"},selectLanguage:{id:"translation.languageMenuList.selectLanguage",defaultMessage:"To"},detectedLanguage:{id:"translation.languageMenuList.detectedLanguage",defaultMessage:"Detected language"},preferredLanguage:{id:"translation.languageMenuList.preferredLanguage",defaultMessage:"Preferred language"},languageSearchPlaceholder:{id:"translation.languageMenuList.languageSearchPlaceholder",defaultMessage:"Search languages…"}});function w(e){const{onSelectTargetLanguage:t,onSelectSourceLanguage:n,editorModeConfigTranslateState:a,sourceLanguage:l,detectedPageLanguage:c,preferredLanguage:p,subMenuPlacement:g,subMenuAlignment:f,pageId:v}=e,y=(0,i().v3)(),w=(0,d().tz)(),I="loading"===a.status,T=k(I),_=(0,r().IS)((e=>({menuItemSectionBottomBorder:{boxShadow:`${e.regularDividerColor} 0px 1px 0px`},...T})),[T]);(0,o.useEffect)((()=>{if("pre_activation"===a.status){const e=setTimeout((()=>{(0,u().u)({environment:y,event:{eventName:"translate_page_interaction",eventProperties:{type:"action_menu_rendered",page_id:v}}})}),750);return()=>clearTimeout(e)}}),[a.status,v,y]);const P=a.targetLanguage,B=C({disabled:I,filter:e=>l!==e,currentSelectedLanguage:a.targetLanguage,onSelectLanguage:e=>{t({targetLanguage:e})}});return(0,x.jsx)(h().Ay,{initialFocus:A,type:h().Oh.Vertical,sections:[{key:"sourceLanguage",render:e=>(0,x.jsx)(b().A,{...e,title:w.formatMessage(M.sourceLanguage),desktopTitleStyle:{marginLeft:2,marginRight:2},style:_.menuItemSectionBottomBorder}),items:[{key:l,render:(e,t)=>{let{onFocus:o}=t;return(0,x.jsx)(S().A,{...e,onFocus:o,disableDefaultClick:!0,placementToOrigin:g,alignmentToOrigin:f,renderOrigin:(e,t)=>(0,x.jsx)(m().A,{...e,disabled:I,buttonStyle:_.button,ref:t,title:w.formatMessage((0,s().Bj)(l)),caption:l===c?w.formatMessage(M.detectedLanguage):l===p?w.formatMessage(M.preferredLanguage):void 0}),renderExtension:e=>(0,x.jsx)(j,{disabled:I,extensionPopupButtonEvents:e,currentTargetLanguage:P,sourceLanguage:l,onSelectSourceLanguage:n})})},action:()=>{}}]},{key:"selectLanguage",render:e=>(0,x.jsx)(b().A,{...e,title:w.formatMessage(M.selectLanguage),desktopTitleStyle:{marginLeft:2,marginRight:2}}),items:B}]})}function k(e){return(0,r().IS)((t=>({button:{color:e?t.text.tertiary:t.text.primary}})),[e])}function j(e){const{extensionPopupButtonEvents:t,currentTargetLanguage:n,disabled:o,sourceLanguage:r,onSelectSourceLanguage:a}=e,{isMobile:s}=(0,i().Y0)(),l=C({disabled:o,filter:e=>e!==n,currentSelectedLanguage:r,onSelectLanguage:e=>{a({sourceLanguage:e})}}),d=s?{menuType:p().gu.ActionSheet,...t}:{menuType:p().gu.Popup,width:200,height:380,...t};return(0,x.jsx)(f().A,{...d,onClick:e=>{e.preventDefault()},children:(0,x.jsx)(h().Ay,{initialFocus:void 0,type:h().Oh.Vertical,sections:[{key:"originalLanguage",render:e=>(0,x.jsx)(b().A,{...e}),items:l}]})})}function C(e){const{disabled:t,filter:n,currentSelectedLanguage:r,onSelectLanguage:u}=e,p=(0,d().tz)(),{isMobile:f}=(0,i().Y0)(),[h,b]=(0,o.useState)(""),S=k(t),A=(0,o.useMemo)((()=>({key:"language-search-input",render:e=>(0,x.jsx)(g().Ay,{...e,disabled:t,placeholder:p.formatMessage(M.languageSearchPlaceholder),value:h,onChange:e=>b(e.target.value),autoFocus:!f,inputLeft:(0,x.jsx)(y().Q,{iconGroup:a().C,colorName:"lightGrayPrimary",variantName:"default"})}),action:()=>{}})),[h,t,p,f]),w=(0,o.useMemo)((()=>({key:"no-results",render:()=>(0,x.jsx)(v().A,{title:(0,x.jsx)(d().sA,{defaultMessage:"No results found",id:"TranslationLanguageMenuList.noResults"})}),action:()=>{}})),[]),j=(0,o.useMemo)((()=>{const e=[];for(const t of l().hr)if(n(t)){const n=p.formatMessage((0,s().Bj)(t));e.push({languageCode:t,languageName:n})}return e.sort(((e,t)=>e.languageName.localeCompare(t.languageName)))}),[n,p]),C=(0,o.useMemo)((()=>(0,c().Ay)(h,j,(e=>{let{languageName:t}=e;return t.toLowerCase()}))),[h,j]),I=(0,o.useMemo)((()=>C.map((e=>{let{languageCode:n,languageName:o}=e;return{key:n,render:e=>(0,x.jsx)(m().A,{...e,buttonStyle:S.button,disabled:t,title:o,isChecked:r===n}),action:()=>{t||u(n)}}}))),[C,t,r,u,S.button]);return 0===I.length?[A,w]:[A,...I]}},392331:(e,t,n)=>{n.r(t),n.d(t,{NotionCalendarLaunchModal:()=>D});var o=n(296540),i=()=>n(662303),r=()=>n(484714),a=()=>n(56366),s=()=>n(401497),l=()=>n(237829),d=()=>n(233842),c=()=>n(262462),u=()=>n(959013),p=()=>n(284371),m=()=>n(40970),g=()=>n(755636),f=()=>n(633457),h=()=>n(802790),v=()=>n(296798),y=()=>n(204063),b=()=>n(125565),S=()=>n(687039),x=()=>n(780054),A=()=>n(581495),M=()=>n(836251),w=()=>n(299487),k=()=>n(51367),j=()=>n(218429),C=()=>n(765957),I=()=>n(865241),T=()=>n(645200),_=()=>n(694498),P=()=>n(874913),B=n(474848);const L=(0,u().YK)({getNotionCalendar:{id:"notionCalendarLaunchButton.getNotionCalendar",defaultMessage:"Get Notion Calendar"},downloadApp:{id:"notionCalendarLaunchButton.downloadApp",defaultMessage:"Download app"},openCalendar:{id:"notionCalendarLaunchButton.openCalendar",defaultMessage:"Open Calendar"}});const R=function(e){let{style:t,openCalendarFrom:i,getNotionCalendarFrom:l,onOpenCalendarClick:d,onGetNotionCalendarClick:c,onDownloadClick:p}=e;const m=(0,r().v3)(),f=(0,s().IS)((e=>({button:{marginLeft:8,whiteSpace:"nowrap",...t}})),[t]),h=(0,a().K8)((()=>(0,n(583238).mX)()),[]),v=(0,a().K8)((()=>C().default.state.currentSpaceStore&&(0,n(640653).dT)({env:"production",spaceStore:C().default.state.currentSpaceStore})),[]),[{value:b}]=(0,n(187174).Yb)((async()=>{var e;return!(null===(e=P().electronApi)||void 0===e||!e.isProtocolRegistered)&&P().electronApi.isProtocolRegistered(x().A.calendar.desktopProtocol)}),[]),S=(0,o.useCallback)((()=>{T().Op({environment:m,spaceStore:void 0,collectionViewStore:void 0,from:i}),null==d||d()}),[m,i,d]),A=(0,o.useCallback)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t}=C().default.state;e&&t&&(T().Op({environment:m,spaceStore:t,collectionViewStore:void 0,from:l}),null==c||c())}),[m,l,c]),M=(0,o.useCallback)((()=>{g().f({environment:m,url:x().A.calendar.downloadUrl}),null==p||p()}),[m,p]);return m.device.isElectron?b?(0,B.jsx)(y().A,{style:f.button,size:"lg",onClick:S,children:(0,B.jsx)(u().sA,{...L.openCalendar})}):(0,B.jsx)(y().A,{style:f.button,size:"lg",onClick:M,children:(0,B.jsx)(u().sA,{...L.downloadApp})}):h||v?(0,B.jsx)(y().A,{style:f.button,size:"lg",onClick:S,children:(0,B.jsx)(u().sA,{...L.openCalendar})}):(0,B.jsx)(y().A,{style:f.button,color:"black",size:"lg",onClick:A,children:(0,B.jsx)(u().sA,{...L.getNotionCalendar})})};function D(){const e=(0,r().v3)(),t=(0,s().IS)((e=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.outlineButtonPressedBackground,width:18,height:18},closeButtonHovered:{background:e.outlineButtonPressedBackground},content:{padding:24,display:"flex",flexDirection:"column"},title:{fontWeight:p().Wy.bold,fontSize:25,display:"flex",marginBottom:6},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},learnMoreLink:{display:"flex",alignItems:"center",fontSize:12,color:e.text.secondary,padding:"0 4px",marginLeft:-4},inlineLearnMoreLink:{display:"inline-flex",fontSize:"inherit",marginLeft:0,padding:0},externalLinkIcon:{width:14,height:14,marginLeft:2},inlineExternalLinkIcon:{width:16,height:16},successCheckmark:{width:50,height:50,display:"flex",alignItems:"center",justifyContent:"center"},successCheckmarkIcon:{width:32,height:32,color:e.text.secondary},successTitle:{fontSize:25,fontWeight:p().Wy.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:e.cardBackground},downloadContent:{display:"flex",flexDirection:"column",paddingRight:8},downloadTitle:{fontSize:16,fontWeight:p().Wy.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"},notionCalendarLogoIcon:{width:56,height:58}})),[]);(0,o.useEffect)((()=>{const t=()=>{I().A.state.isVisible&&_().A.state.isConnectingCalendar&&(_().A.setState({isConnectingCalendar:!1}),f().oX({environment:e}))};return I().A.addListener(t),()=>{I().A.removeListener(t)}}),[e]);const n=(0,a().K8)((()=>_().A.state.signupCtaAttribution||"onboardingModalSignIn"),[]),P=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=C().default.state;t&&(k().Sq(e,{callout_key:"notion_calendar_launch_promo",dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),w().a(e,"notion_calendar_launch_promo"),T().MR({environment:e,userSettingsStore:t}),_().A.setState({signupCtaAttribution:void 0}))}),[e]),D=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=C().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),w().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}))}),[e]),O=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:n}=C().default.state;t&&n&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),e.device.isElectron&&w().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.getNotionCalendar",userSettingsStore:t}))}),[e]),E=(0,o.useCallback)((()=>{const{currentUserSettingsStore:t}=C().default.state;t&&(k().Y5(e,{callout_key:"notion_calendar_launch_promo",click_type:"primary_cta",placement_key:"Modal"}),w().a(e,"notion_calendar_launch_promo"),T().rI(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}))}),[e]),U=(0,a().K8)((()=>C().default.state.currentUserSettingsStore),[]),F=(0,a().K8)((()=>{const e=null==U?void 0:U.getSettings();return null==e?void 0:e.notion_calendar_launch_modal_phase}),[U]),V=()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(A().Rz,{onClick:P}),(0,B.jsxs)("div",{style:t.content,children:[(0,B.jsx)("div",{style:t.successCheckmark,children:(0,l().X)(t.successCheckmarkIcon)}),(0,B.jsx)("div",{style:t.successTitle,children:(0,B.jsx)(u().sA,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle"})}),(0,B.jsx)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,B.jsx)(u().sA,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,B.jsxs)("div",{style:t.downloadContainer,children:[(0,B.jsxs)("div",{style:t.downloadContent,children:[(0,B.jsx)("div",{style:t.downloadTitle,children:(0,B.jsx)(u().sA,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,B.jsx)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:(0,B.jsx)(u().sA,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,B.jsx)("div",{style:t.downloadButtonContainer,children:(0,B.jsx)(y().A,{style:t.downloadButton,onClick:()=>{m().Lt(e,{cta:"download"}),g().f({environment:e,url:x().A.calendar.downloadUrl}),E()},children:(0,B.jsx)(u().sA,{...L.downloadApp})})})]}),(0,B.jsx)("div",{style:t.notionCalendarLogo,children:(0,d().u)(t.notionCalendarLogoIcon)})]})]})]}),z=()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(S().A,{src:"https://player.vimeo.com/video/900939588?h=187435ef3c",defaultTextTrack:S().V[i().locale]||"en",options:{muted:!0,autoplay:!0,loop:!0,background:!0,playsinline:!0}}),(0,B.jsx)(A().Rz,{style:t.closeButton,hoveredStyle:t.closeButtonHovered,onClick:P}),(0,B.jsxs)("div",{style:t.content,children:[(0,B.jsx)("div",{style:t.title,children:(0,B.jsx)(u().sA,{defaultMessage:"Meet Notion Calendar",id:"notionCalendarLaunchModal.title"})}),(0,B.jsxs)(b().A,{isSecondaryColor:!0,isMultiline:!0,children:[(0,B.jsx)(u().sA,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your calendar events.",id:"notionCalendarLaunchModal.caption"})," "]})]}),(0,B.jsx)(h().A,{size:1,style:t.divider}),(0,B.jsxs)("div",{style:t.footer,children:[(0,B.jsxs)(v().A,{external:!0,href:(0,M().xS)("blog.notionCalendarLaunch"),style:{...t.learnMoreLink,...t.inlineLearnMoreLink},children:[(0,B.jsx)(u().sA,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"}),(0,c().M)({...t.externalLinkIcon,...t.inlineExternalLinkIcon})]}),(0,B.jsx)(R,{openCalendarFrom:"onboardingModalOpenCalendar",getNotionCalendarFrom:n,onOpenCalendarClick:()=>{m().be(e,{cta:"open_calendar"}),D()},onGetNotionCalendarClick:()=>{m().be(e,{cta:"get_calendar"}),O()},onDownloadClick:()=>{m().be(e,{cta:"download"}),E()}})]})]});return(0,B.jsx)(j().l,{messageKey:"notion_calendar_launch_promo",desktopRenderInner:()=>(0,B.jsx)(N,{launchModalPhase:F,renderChild:()=>"connected_notion_calendar"===F?V():z()}),desktopInnerStyle:t.container,desktopOnDismiss:P,phoneRenderInner:()=>null})}function N(e){let{launchModalPhase:t,renderChild:n}=e;const i=(0,r().v3)();return(0,o.useEffect)((()=>{"connected_notion_calendar"===t?m().Y8(i):m().aq(i)}),[i,t]),n()}},396831:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(17090).A)},417242:(e,t,n)=>{n.r(t),n.d(t,{MobileShareMenuRenderer:()=>m});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(482707),s=()=>n(321172),l=()=>n(765957),d=()=>n(529183),c=()=>n(538233),u=()=>n(897119),p=n(474848);function m(e){const t=(0,i().Y0)(),n=(0,r().O$)(c().A),a=(0,i().v3)(),l=(0,o.useCallback)((()=>{(0,s().XP)(a)}),[a]);return t.isMobile?(0,p.jsx)(u().Ay,{popupType:u().nl.BottomSheet,bottomSheetInitialState:"full",trapFocus:!0,open:n.open,render:()=>(0,p.jsx)(g,{menuState:n,onClose:l}),onDismiss:l}):null}function g(e){const t=(0,r().uB)(void 0,d().Ay),n=(0,r().O$)(l().AppStoreMainEditorCurrentBlockStore);return e.menuState.open&&n?(0,p.jsx)(a().k,{store:n,buttonPopupStore:c().A,location:"topbar_mobile",onClose:e.onClose,inviteTargetsStore:t}):null}},418426:(e,t,n)=>{n.d(t,{$:()=>l});n(898992),n(354520),n(581454);var o=()=>n(484714),i=()=>n(56366),r=()=>n(468006),a=()=>n(605402),s=()=>n(486130);function l(e){const t=(0,o().v3)().currentUser.id;return(0,i().K8)((()=>{if(!e.isDefined())return[];return(0,r().ri)({rawMembers:e.getRawMembership(),groupsInSpace:a().A.state.permissionGroupsAndMemberCounts.map((e=>e.group))}).filter((n=>s()._.getSpacePermissionGroupIds({userId:t,spaceId:e.getSpaceId()}).has(n.getGroupId())))}),[t,e])}},425497:(e,t,n)=>{n.d(t,{Ug:()=>p,YX:()=>g,_t:()=>h,x7:()=>y});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var o=()=>n(484714),i=()=>n(401497),r=()=>n(784892),a=()=>n(534177),s=()=>n(284371),l=()=>n(236030),d=()=>n(819527),c=()=>n(963589),u=()=>n(828180);function p(e){return e??r().NY.Medium}const m=new Set(["title","text","email","phone_number","number","url","date","created_time","last_edited_time","auto_increment_id"]);function g(e){return"empty"===e||"error"===e||m.has(e)}const f=new Set(["button","file"]);function h(e){return f.has(e)}const v=Object.create(null);function y(e){const{shouldSetCellHeight:t,format:n,shouldWrap:p,isLast:m,disabled:g,locked:f,showIfEmpty:h,isInvalidFormAnswer:y,isLargeModule:b}=e,S=(0,c().X)("db_ux_chrome"),{isPhone:x}=(0,o().Y0)(),A=(0,i().DP)(),M=[n,p,t,g,f,x,h,m,b,y,A.mode,S].join("|");if(v[M])return v[M];const w=function(e){const{isPhone:t,theme:n,shouldSetCellHeight:o,format:i,shouldWrap:c,isLast:p,disabled:m,locked:g,showIfEmpty:f,isInvalidFormAnswer:h,isLargeModule:v,isDBUXChromeEnabled:y}=e,b=(0,u()._Q)({isPhone:t}),S=t?l().Um:l().tt;switch(i){case"table":return{buttonStyle:{display:"block",fontSize:y&&t?u().hN:u().Mi,lineHeight:y&&t?u().G4:u().$g,overflow:"clip",width:"100%",whiteSpace:c?"normal":"nowrap",height:o?S:void 0,minHeight:S,cursor:m||g?"default":"pointer",padding:b.table.default},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},textStyle:{lineHeight:y&&t?u().G4:u().$g,whiteSpace:c?"pre-wrap":"nowrap",wordBreak:c?"break-word":"normal"},tokenWrapStyle:{display:"flex",flexWrap:c?"wrap":"nowrap",...u().Cn[r().NY.Medium]},textLineHeight:u().wd,sizing:y&&t?"large":"default",tokenFormat:y&&t?r().NY.Large:r().NY.Medium};case"gallery":return{buttonStyle:{display:"flex",overflow:"hidden",alignItems:"center",borderRadius:5,margin:"0 6px 2px 6px",padding:"0 5px",fontSize:t?u().Mi:u().gJ,minHeight:u().eW,whiteSpace:c?"normal":"nowrap",minWidth:f?"auto":"fit-content",width:f?"auto":"fit-content"},textStyle:{lineHeight:u().$g,whiteSpace:c?"pre-wrap":"nowrap",wordBreak:c?"break-word":"normal",overflow:"hidden"},tokenWrapStyle:{display:"flex",minWidth:0,flexShrink:0,flexWrap:c?"wrap":"nowrap",width:c?"100%":void 0,...u().Cn[t?r().NY.Medium:r().NY.Small]},textLineHeight:t?u().wd:u().Yu,sizing:t?"default":"small",tokenFormat:t?r().NY.Medium:r().NY.Small};case"board":return{buttonStyle:{display:"flex",overflow:"hidden",alignItems:"center",borderRadius:5,fontSize:u().gJ,margin:"0 6px 2px 6px",padding:b.board.default,minHeight:u().rO,whiteSpace:c?"normal":"nowrap",width:f?"auto":"fit-content"},textStyle:{lineHeight:u().$g,whiteSpace:c?"pre-wrap":"nowrap",wordBreak:c?"break-word":"normal"},tokenWrapStyle:{display:"flex",flexWrap:c?"wrap":"nowrap",...u().Cn[r().NY.Small]},textLineHeight:u().Yu,sizing:"small",tokenFormat:r().NY.Small};case"relation_section":return{buttonStyle:{display:"inline-flex",fontSize:u().gJ,overflow:"hidden",alignItems:"center",marginLeft:0,minHeight:u().Ih,padding:"0 8px",borderRadius:5},tokenWrapStyle:{display:"flex",minWidth:0,...u().Cn[r().NY.Small]},textLineHeight:u().Yu,sizing:"small",tokenFormat:r().NY.Small};case"relation":return{buttonStyle:{fontSize:u().gJ,overflow:"hidden",alignItems:"center",padding:"0 4px",borderRadius:5,display:"flex",marginLeft:t?0:8,marginRight:t?8:0,height:u().O0,minWidth:20},textStyle:{lineHeight:u().$g,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",minWidth:0,...u().Cn[r().NY.Small]},textLineHeight:u().Yu,sizing:"small",tokenFormat:r().NY.Small};case"list":return{buttonStyle:{fontSize:y?u().Mi:u().gJ,overflow:"hidden",alignItems:"center",padding:`0 ${d().iH}px`,borderRadius:5,display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",marginLeft:0,marginRight:t?2:0,minHeight:u().kx,minWidth:20},textStyle:{lineHeight:u().$g,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",minWidth:0,...u().Cn[r().NY.Inline]},textLineHeight:y?u().wd:u().Yu,sizing:"small",tokenFormat:r().NY.Inline};case"page":return{buttonStyle:{fontSize:u().Mi,overflow:"hidden",display:"inline-block",borderRadius:4,width:"100%",minHeight:u().at,padding:b.page.default},textStyle:{lineHeight:u().$g,wordBreak:"break-word",whiteSpace:"pre-wrap"},tokenWrapStyle:{display:"flex",flexWrap:"wrap",...u().Cn[r().NY.Medium]},textLineHeight:u().wd,sizing:"default",tokenFormat:r().NY.Medium};case"timeline":return{buttonStyle:{display:"flex",alignItems:"center",fontSize:u().gJ,marginRight:p?0:10},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},textStyle:{lineHeight:u().$g,wordBreak:"break-word",whiteSpace:"nowrap"},tokenWrapStyle:{display:"flex",minWidth:0,...u().Cn[r().NY.Small]},textLineHeight:u().Yu,sizing:"small",tokenFormat:r().NY.Inline};case"calendar":return{buttonStyle:{fontSize:u().gJ,display:"flex",alignItems:"center",height:u().CL,whiteSpace:"nowrap",width:"100%"},textStyle:{lineHeight:u().$g,whiteSpace:"nowrap",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexShrink:0,flexWrap:"nowrap",...u().Cn[r().NY.Small]},textLineHeight:u().Yu,sizing:"small",tokenFormat:r().NY.Small};case"feed":return{buttonStyle:{fontSize:y?u().Mi:u().gJ,overflow:"hidden",alignItems:"center",padding:"0 4px 0 4px",borderRadius:5,display:"flex",marginLeft:0,marginRight:t?2:0,minHeight:u().kx,minWidth:20},textStyle:{lineHeight:u().$g,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},tokenWrapStyle:{display:"flex",minWidth:0,...u().Cn[r().NY.Inline]},textLineHeight:y?u().wd:u().Yu,sizing:"small",tokenFormat:r().NY.Inline};case"compact_page":return{buttonStyle:{fontSize:u().Mi,overflow:"hidden",alignItems:"center",borderRadius:4,display:"flex",width:"100%",minHeight:u().MI,padding:b.compact_page.default},textStyle:{lineHeight:u().$g,wordBreak:"break-word",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",overflow:"hidden",alignItems:"center",...u().Cn[r().NY.CompactEssential]},textLineHeight:u().wd,sizing:"default",tokenFormat:r().NY.CompactEssential};case"mini":return{buttonStyle:{fontSize:u().Mi,overflow:"hidden",alignItems:"center",borderRadius:4,display:"flex",padding:"0 6px",minWidth:0,height:u().Bu,maxWidth:300},textStyle:{lineHeight:u().$g,wordBreak:"break-word",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",overflow:"hidden",alignItems:"center",...u().Cn[r().NY.Medium]},textLineHeight:u().wd,sizing:"default",tokenFormat:r().NY.Medium};case"property_module":const e={fontSize:v?u().KI:u().Mi,overflow:"hidden",display:"block",borderRadius:4,width:"100%",minHeight:u().at,padding:b.page.default};return{buttonStyle:e,emptyButtonStyle:{...e,padding:b.page.text},textStyle:{lineHeight:v?u().hR:u().$g,wordBreak:"break-word",whiteSpace:"pre-wrap",...v?{fontWeight:s().Wy.medium}:{}},emptyTextStyle:{fontSize:u().Mi,lineHeight:u().$g,wordBreak:"break-word"},tokenWrapStyle:{display:"flex",flexWrap:"wrap",...u().Cn[r().NY.Medium]},textLineHeight:v?u().aL:u().wd,sizing:v?"large":"default",tokenFormat:r().NY.Medium};case"form_editor":case"form_viewer":return{buttonStyle:{borderRadius:6,boxShadow:"form_viewer"===i&&h?n.inputRedFocusRing:`0 0 0 1px ${n.stroke.input} inset`,marginTop:8,padding:"0 10px",minHeight:38,display:"flex",alignItems:"center",fontSize:16,overflowX:"hidden",cursor:"text"},buttonHoveredStyle:{background:"unset"},buttonPressedStyle:{background:"unset"},tokenWrapStyle:{display:"flex",flexWrap:c?"wrap":"nowrap",...u().Cn[r().NY.Large]},textLineHeight:u().wd,sizing:"default",tokenFormat:r().NY.Medium};default:(0,a().HB)(i)}}({isPhone:x,theme:A,shouldSetCellHeight:t,format:n,shouldWrap:p,isLast:m,disabled:g,locked:f,showIfEmpty:h,isInvalidFormAnswer:y,isLargeModule:b,isDBUXChromeEnabled:S});return v[M]=w,w}},430923:(e,t,n)=>{n.d(t,{DV:()=>l,W5:()=>a,l7:()=>s,y7:()=>r});var o=()=>n(645873);const i={CollectionNewViewsPopupComponent:new(o().O2)("CollectionNewViewsPopupComponent",(async()=>await Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(93282),n.e(43678),n.e(90978),n.e(77213),n.e(61349),n.e(62620)]).then(n.bind(n,93709)))),CollectionViewSelect:new(o().O2)("CollectionViewSelect",(async()=>await Promise.all([n.e(35684),n.e(35756)]).then(n.bind(n,445689)))),CollectionLinkExistingModal:new(o().O2)("CollectionLinkExistingModal",(async()=>await Promise.all([n.e(75134),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(75078),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(93282),n.e(43678),n.e(90978),n.e(77213),n.e(5287)]).then(n.bind(n,901226)))),ModalOverlayCollectionView:new(o().O2)("ModalOverlayCollectionView",(async()=>await Promise.all([n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95541),n.e(93568),n.e(32413)]).then(n.bind(n,700868))))},r=(0,o()._h)(i.CollectionNewViewsPopupComponent,(e=>e.CollectionNewViewsPopupComponent)),a=(0,o()._h)(i.CollectionViewSelect,(e=>e.CollectionViewSelect)),s=(0,o()._h)(i.CollectionLinkExistingModal,(e=>e.CollectionLinkExistingModal)),l=(0,o()._h)(i.ModalOverlayCollectionView,(e=>e.ModalOverlayCollectionView))},435212:(e,t,n)=>{n.d(t,{Kz:()=>r,Sc:()=>a,as:()=>i});var o=()=>n(2220);function i(e,t){(0,o().u)({environment:e,event:{eventName:"open_customize_site",eventProperties:t}})}function r(e,t){(0,o().u)({environment:e,event:{eventName:"update_site_customization_settings",eventProperties:t}})}function a(e){(0,o().u)({environment:e,event:{eventName:"close_customize_site",eventProperties:{}}})}},438988:(e,t,n)=>{n.r(t),n.d(t,{CollectionTypedDatabaseMigrationModal:()=>le});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(66689),l=()=>n(959013),d=()=>n(346705),c=(n(581454),()=>n(148307)),u=()=>n(340498),p=n(474848);const m={viewBox:"0 0 20 20",fittedViewBox:"2.62 2.06 14.57 16.51",svg:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("path",{d:"m16.949 3.47-.618.619-1.164-1.165.625-.624a.823.823 0 0 1 1.157 0 .823.823 0 0 1 0 1.157zm-8.526 8.527 7.153-7.153-1.165-1.165-7.16 7.147a1.1 1.1 0 0 0-.247.414l-.303.978c-.055.206.137.4.33.33l.978-.303a.9.9 0 0 0 .414-.248"}),(0,p.jsx)("path",{d:"M9.578 5.438q.617 0 1.197.126l1.051-1.004a6.9 6.9 0 0 0-2.248-.372h-.35a6.603 6.603 0 0 0-6.603 6.602v.257c0 1.254.371 2.48 1.067 3.524a9.25 9.25 0 0 0 5.455 3.844l.514.129a.625.625 0 1 0 .303-1.213l-.513-.128a8 8 0 0 1-4.719-3.325 5.1 5.1 0 0 1-.857-2.831v-.257a5.353 5.353 0 0 1 5.353-5.352z"}),(0,p.jsx)("path",{d:"M12.444 15.748a6.47 6.47 0 0 1-5.471-1.878l1.387-.433a5.22 5.22 0 0 0 3.92 1.072l.08-.01a3.37 3.37 0 0 0 2.921-3.345 5.7 5.7 0 0 0-1.011-3.248l.904-.885a6.94 6.94 0 0 1 1.357 4.133 4.624 4.624 0 0 1-4.006 4.584z"})]})},g=(0,u().wt)("pencilAndOutline",m);var f=()=>n(822295),h=()=>n(284371),v=()=>n(972435),y=()=>n(755170),b=()=>n(997415),S=()=>n(854672),x=()=>n(132389),A=()=>n(125565);const M=(0,l().YK)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),w=[{icon:"📅",taskName:v().A.formatMessage(M.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,f().presentIcon)({width:u().Ev.sm,fill:"#448361"})},{icon:"📚",taskName:v().A.formatMessage(M.dummyTask2),status:"In Progress",teamspace:"Design",location:g({width:u().Ev.sm,fill:"#CB912F"})},{icon:"🎨",taskName:v().A.formatMessage(M.dummyTask3),status:"In Progress",teamspace:"Design",location:g({width:u().Ev.sm,fill:"#CB912F"})},{icon:"🛫",taskName:v().A.formatMessage(M.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,f().presentIcon)({width:u().Ev.sm,fill:"#448361"})},{icon:"🚧",taskName:v().A.formatMessage(M.dummyTask5),status:"Not Started",teamspace:"Design",location:g({width:u().Ev.sm,fill:"#CB912F"})},{icon:"👩‍💻",taskName:v().A.formatMessage(M.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,f().presentIcon)({width:u().Ev.sm,fill:"#448361"})}],k={Blocked:"red","In Progress":"blue","Not Started":"gray"};function j(){const e=T();return(0,p.jsx)(y().A,{title:(0,p.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),tooltip:void 0,icon:(0,p.jsx)("div",{style:{paddingLeft:4},children:(0,p.jsx)(S().A,{type:"app_package_asset",size:18,icon:c().A.images.appPackages.taskDbIconSvg})}),children:(0,p.jsx)("div",{style:e.dummyAssignedToMe,children:(0,p.jsx)(C,{})})})}function C(){const e=w.map(((e,t)=>(0,p.jsx)(I,{row:e},t)));return(0,p.jsx)("div",{style:{display:"flex",marginTop:4,paddingRight:16,flexDirection:"column"},children:e})}function I(e){let{row:t}=e;const n=T();return(0,p.jsxs)("div",{style:n.eachTask,children:[(0,p.jsxs)("div",{style:n.taskName,children:[(0,p.jsx)("span",{style:n.taskIcon,children:t.icon}),(0,p.jsx)(A().A,{style:n.taskTitle,children:t.taskName})]}),(0,p.jsx)("div",{style:n.taskStatus,children:(0,p.jsx)(b().X,{type:"status",value:v().A.formatMessage(M[t.status]),color:k[t.status],groupColor:void 0})}),(0,p.jsx)(x().A,{size:8}),(0,p.jsxs)("div",{style:n.location,children:[(0,p.jsx)("span",{style:n.locationIndicator,children:v().A.formatMessage(M.locationIndicator)}),(0,p.jsx)("div",{style:{...n.locationIcon,..."Design"===t.teamspace?{...n.designTeamspace}:{...n.engTeamspace}},children:t.location})]})]})}function T(){return(0,a().IS)((e=>({dummyAssignedToMe:{width:"60%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:220,display:"flex",...h().RC},taskIcon:{fontSize:14,marginRight:8},taskTitle:{color:e.text.primary,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:130},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.text.secondary,marginRight:4,maxWidth:48,...h().RC},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}n(898992),n(354520),n(803949),n(737550);var _=()=>n(584262),P=()=>n(128914),B=()=>n(743176),L=()=>n(668725),R=()=>n(689094),D=()=>n(381349),N=()=>n(128427),O=()=>n(436572),E=()=>n(751156),U=()=>n(521358),F=()=>n(617254),V=()=>n(313892),z=()=>n(895876),K=()=>n(609429),W=()=>n(722872),H=()=>n(696746),G=()=>n(700250),Y=()=>n(666429),q=()=>n(920773),$=()=>n(760217),Q=()=>n(406699),Z=()=>n(928600),X=()=>n(939740),J=()=>n(204063),ee=()=>n(89924),te=()=>n(690197);function ne(e){const{collectionContextStore:t,databaseType:n,containerStyle:c}=e,u=(0,i().v3)(),m=(0,l().tz)(),{isPhone:g,isMobileNative:f}=(0,i().Y0)(),h=g&&f,v=function(e){return(0,a().IS)((t=>({formTitle:{display:"inline-flex"},emojiTitle:{fontSize:36,marginRight:8},perPropertyInstruction:{color:t.text.secondary,fontSize:e?14:12,marginBottom:8},requiredPropertyError:{color:D().Ay.red,fontSize:e?14:12,marginRight:e?8:6},propertyMappingInstructions:{marginTop:6,marginBottom:24,fontSize:e?16:14,fontWeight:e?500:400},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:e?14:10,fill:t.icon.tertiary},propertyMappingTitle:{fontSize:e?16:14,color:t.text.tertiary},propertyMappingMenu:{borderRadius:6,border:`1px solid ${t.tableDividerColor}`,boxShadow:"none"},propertyConversionCallout:{display:"flex",alignItems:"center",marginLeft:4,marginTop:3,color:t.text.tertiary},a:{color:"white",cursor:"pointer"},propertyIcon:{fill:t.darkTextColor},buttons:{marginBlockStart:e?"auto":void 0},submitMigrationButton:{display:"flex",height:e?36:32,fontSize:e?16:14},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginLeft:0,width:"100%"},learnMoreButton:{display:"inline-flex",justifyContent:"center",width:"100%",height:26},closeButton:{width:"100%",height:36,marginTop:8,display:"inline-flex",justifyContent:"center",fontSize:16,color:t.text.tertiary}})),[e])}(g),y=(0,a().DP)(),[b,S]=(0,o.useState)(!1),M=(0,r().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema()}),[t]),w=(0,r().K8)((()=>V().YH((0,F().appConfigs)(),n)),[n]),k=(0,r().K8)((()=>{if(M&&w)return V().DH(w,M)}),[w,M]),j=(0,o.useCallback)(((e,t)=>{const n=t.type;return V().Kb(e,t,M??{}).map((e=>{let[t,o]=e;return{key:t,title:null==o?void 0:o.name,icon:(0,p.jsx)(B().zB,{size:16,style:v.propertyIcon,theme:y,icon:null==o?void 0:o.icon,type:(null==o?void 0:o.type)||n})}}))}),[y,v.propertyIcon,M]),C=(0,r().K8)((()=>{const e=Object.keys(w||{}).filter((e=>void 0!==(null==w?void 0:w[e])&&e.startsWith("notion://"))),t=Object.fromEntries(e.map((e=>[e,void 0])));return Object.entries(w||{}).forEach((e=>{let[n,o]=e;if(!o)return;const i=null==k?void 0:k[n];if(i)return void(t[n]=i);0===j(n,o).length&&(t[n]=P().Ul)})),t}),[w,k,j]),[I,T]=(0,o.useState)(C),ne=(0,o.useMemo)((()=>Object.entries(I).some((e=>{let[t,n]=e;if(t===s().yx.Status){const e=null==M?void 0:M[n||""];if("checkbox"===(null==e?void 0:e.type)||"select"===(null==e?void 0:e.type))return!0}}))),[M,I]),re=(0,o.useCallback)((e=>{const t=null==w?void 0:w[e],n={width:16,height:16,marginRight:10};if(!t)return null;const o=[...j(e,t),{key:P().Ul,title:m.formatMessage(oe.createNew),icon:(0,R().W)({width:n.width,fill:v.propertyIcon.fill}),type:void 0}],i=I[e],r=null==M?void 0:M[i||""],a=!i&&b,d=e===s().yx.Status;let c=null;return i===P().Ul?c=(0,R().W)(n):r&&(c=B().LE[null==r?void 0:r.type](n)),(0,p.jsx)(Q().Ay,{popupType:g?Q().z7.SlideUp:Q().z7.Popup,renderOrigin:t=>(0,p.jsxs)("div",{style:{marginBottom:24},children:[(0,p.jsx)(A().A,{isMultiline:!0,style:v.perPropertyInstruction,children:(0,p.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:m.formatMessage(ie[e])}})}),(0,p.jsx)($().A,{disabled:1===o.length,disabledFeedback:!0,focused:!1,right:(0,p.jsxs)("div",{style:v.propertyMappingDropdown,children:[a?(0,p.jsx)("span",{style:v.requiredPropertyError,children:(0,p.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,L().b)({...v.chevronDownIconEnabled,...a?{fill:D().Ay.red}:{}})]}),rightStyle:{marginRight:g?14:8},title:(0,p.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[c,i===P().Ul?m.formatMessage(oe.createNew):r?r.name:m.formatMessage(oe.select)]}),titleStyle:i?{display:"flex",alignItems:"center"}:v.propertyMappingTitle,itemMarginLeft:8,style:{...v.propertyMappingMenu,...a?{borderColor:D().Ay.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),d&&ne&&(0,p.jsx)(A().A,{isSmall:!0,isMultiline:!0,children:(0,p.jsx)("div",{style:v.propertyConversionCallout,children:(0,p.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxSelectMappingInfo",defaultMessage:"This property will be converted to a Status property type."})})})]}),placementToOrigin:G().UV.Bottom,alignmentToOrigin:G().MY.Start,render:t=>{const n=[{key:"propertyOptions",render:e=>(0,p.jsx)(ee().A,{...e,topBorder:0!==e.index}),items:o.map((n=>{const o={key:n.key,render:t=>(0,p.jsx)($().A,{...t,icon:n.icon,title:n.title,isChecked:I[e]===n.key}),action:()=>{T({...I,[e]:n.key}),S(!1),t.close()}};return o}))}],i=g?{menuType:W().gu.ActionSheet}:{menuType:W().gu.Popup,width:250};return(0,p.jsx)(Z().A,{...i,children:(0,p.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:void 0,sections:n})})}},e)}),[w,j,m,v,I,M,b,ne,g]),ae=(0,o.useCallback)((()=>{var e,o;const i=t.collectionStore(),r=t.collectionViewBlockStore();if(!i||!r)return;const a=(0,H().XH)("main"),c=null==a||null===(e=a.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==a?void 0:a.getRecordModel,pageVisitSource:_().y8.TypedDBConversionToast}),g=(0,H().XH)("myTasks"),f=null==g||null===(o=g.getModel())||void 0===o?void 0:o.getRenderUrl({getRecordModel:null==g?void 0:g.getRecordModel,pageVisitSource:_().y8.TypedDBConversionToast});!function(e){return!Object.values(e).includes(void 0)}(I)?S(!0):E().createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:u,canUndo:!0,perform:e=>{U().bC({environment:u,collectionViewBlockStore:r,collectionStore:i,databaseType:n,propertyMapping:{...I},typedPropertySchemas:{...w},transaction:e}),d().A.setState({isModalOpen:!1,collectionContextStore:void 0}),n===s().dC&&(K().e.locallyMutatedTasksDatabase=!0),(0,N().Y)({environment:u,database_type:n,property_mapping:I,collectionContextStore:t});const o=h?(0,p.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>My tasks</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage.nativePhone",values:{singularType:(0,z().$O)(n),databaseName:i.getName()||m.formatMessage(oe.defaultCollectionName),span:e=>(0,p.jsx)("span",{children:e}),a:e=>(0,p.jsx)("a",{style:v.a,href:f,children:e})}}):(0,p.jsx)(l().sA,{defaultMessage:"<span>{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.</span>",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,z().$O)(n),databaseName:i.getName()||m.formatMessage(oe.defaultCollectionName),span:e=>(0,p.jsx)("span",{children:e}),a:e=>(0,p.jsx)("a",{style:v.a,href:c,children:e})}});O().rL({item:{label:o,durationMs:Y().LX},undoFunc:()=>{E().createAndCommit({environment:u,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",canUndo:!0,perform:e=>{U().Fr({environment:u,collectionContextStore:t,transaction:e})}})}})}})}),[t,I,u,n,w,h,m,v.a]);return(0,p.jsxs)("div",{style:c,children:[(0,p.jsxs)("div",{style:v.formTitle,children:[g?(0,p.jsx)("span",{style:v.emojiTitle,children:"📋"}):null,(0,p.jsx)(A().A,{style:v.propertyMappingInstructions,isMultiline:!0,children:(0,p.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"Task databases require status, assignee, and due date properties."})})]}),g?(0,p.jsx)(x().A,{size:16}):null,Object.entries(C).map((e=>{let[t,n]=e;return re(t)})),(0,p.jsxs)("div",{style:v.buttons,children:[(0,p.jsx)(J().A,{style:v.submitMigrationButton,onClick:ae,children:(0,p.jsx)(l().sA,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,z().$O)(n)}})}),g?(0,p.jsx)(q().p,{style:v.closeButton,onClick:()=>d().A.reset(),children:(0,p.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Close",defaultMessage:"Close"})}):(0,p.jsx)(te().A,{title:(0,p.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,z().$O)(n)}}),analyticsFrom:"set_database_type",href:H().hI,style:v.learnMore,buttonStyle:v.learnMoreButton})]})]})}const oe=(0,l().YK)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SelectFieldPlaceholder",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),ie={[s().yx.Status]:oe.taskStatus,[s().yx.Assign]:oe.taskAssignee,[s().yx.DueDate]:oe.taskDueDate};var re=()=>n(676007),ae=()=>n(754002);const se=32;function le(){const e=pe(),t=(0,i().Y0)(),n=(0,r().O$)(d().A);return n.isModalOpen?t.isPhone?(0,p.jsx)(ae()._,{fullscreen:!0,innerStyle:e.phoneInner,renderInner:()=>(0,p.jsx)(ue,{collectionContextStore:n.collectionContextStore})}):(0,p.jsx)(re().a,{open:!0,onDismiss:()=>d().A.reset(),innerStyle:e.desktopInner,render:()=>(0,p.jsx)(ce,{collectionContextStore:n.collectionContextStore})}):null}const de=450;function ce(e){const t=pe();return(0,p.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:"relative"},children:[(0,p.jsxs)("div",{style:t.title,children:[(0,p.jsx)("span",{style:t.emojiTitle,children:"📋"}),(0,p.jsx)(A().A,{isMultiline:!0,style:t.previewTitle,children:(0,p.jsx)(l().sA,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,p.jsx)(x().A,{size:36}),(0,p.jsx)(j,{}),(0,p.jsx)(ne,{collectionContextStore:e.collectionContextStore,databaseType:s().dC,containerStyle:t.form})]})}function ue(e){const t=pe();return(0,p.jsx)(ne,{collectionContextStore:e.collectionContextStore,databaseType:s().dC,containerStyle:t.phoneForm})}function pe(){return(0,a().IS)((e=>({desktopInner:{width:768,height:de,padding:se},phoneInner:{width:"100%",height:"100%"},title:{display:"flex",maxWidth:"60%",alignItems:"center"},emojiTitle:{fontSize:36,marginRight:16},previewTitle:{color:e.text.primary,width:350,fontSize:17,fontWeight:500},form:{width:"45%",height:de,background:e.surface.wash,position:"absolute",top:-se,right:-se,padding:se,zIndex:1,borderLeft:`1px solid ${e.tableDividerColor}`,overflowY:"auto"},phoneForm:{display:"flex",flexDirection:"column",width:"100%",height:"100%",padding:se}})),[])}},440339:(e,t,n)=>{n.d(t,{oq:()=>re,aR:()=>J,zM:()=>te});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(148307),l=()=>n(954845),d=()=>n(289313),c=()=>n(66913),u=()=>n(206267),p=()=>n(68263),m=()=>n(959013),g=()=>n(534177),f=()=>n(284371),h=()=>n(703875),v=()=>n(854672),y=()=>n(285790),b=()=>n(125565),S=()=>n(987017),x=()=>n(38337),A=()=>n(115512),M=()=>n(436572),w=()=>n(704152),k=()=>n(859428),j=()=>n(962730),C=(n(16280),()=>n(449506)),I=()=>n(765957);var T=n(474848);function _(e){const{beamMetadata:t}=e,[n,r]=(0,o.useState)(!1),s=(0,i().v3)(),d=(0,a().IS)((e=>({beamIcon:{height:24,width:24},button:{borderRadius:6},tooltipWidth:{width:280}})),[]);return n||!t?null:(0,T.jsx)(k().A,{delayThreshold:500,placement:j().W.Bottom,renderTooltip:()=>(0,T.jsx)(m().sA,{defaultMessage:"Beam sends a real-time link of this page to your teammates who are online and on the same calendar event",id:"shareMenu.beam.tooltip"}),textWrap:!0,style:d.tooltipWidth,render:e=>(0,T.jsx)(w().A,{...e,style:d.button,onClick:async()=>{r(!0);const e=await function(e){var t,n;const{environment:o,beamMetadata:i}=e;if(!(null===(t=I().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id))throw new Error("No current page selected");if(!(null===(n=I().default.state.currentSpaceStore)||void 0===n?void 0:n.id))throw new Error("No current space selected");return C().callApi({eventName:"sendBeam",environment:o,data:{beamMetadata:i}})}({environment:s,beamMetadata:t});"failed"!==e.type?M().D6({label:(0,T.jsx)(m().sA,{id:"shareMenu.beam.sent",defaultMessage:"Beam sent!"})}):M().D6({label:(0,T.jsx)(m().sA,{id:"shareMenu.beam.failed",defaultMessage:"There was an issue sending the beam. Please try again later."})})},children:(0,l().J)(d.beamIcon)})})}n(898992),n(354520),n(581454);var P=()=>n(392890),B=()=>n(883626),L=()=>n(496603),R=()=>n(615234),D=()=>n(866515),N=()=>n(523239),O=()=>n(677169),E=()=>n(614016),U=()=>n(379560),F=()=>n(807778),V=(n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(672577),()=>n(861017)),z=()=>n(179034),K=()=>n(780054),W=()=>n(630116);function H(e){const{environment:t,currentSpaceStore:n}=e;let o=e.fileUrl;const i=(0,V().parseRoute)({url:o,isMobile:t.device.isMobile,baseUrl:K().A.domainBaseUrl,publicDomainName:K().A.publicDomainName,protocol:K().A.protocol,currentUrl:window.location.href}),r="page"===i.name?i.blockId:void 0;if(!r)return;const a=W().Bv.createChildStore(n,{table:z().ev,id:r});return a.load(),a.isReady()?a:void 0}function G(e){var t;return"block"===(null==e||null===(t=e.pointer)||void 0===t?void 0:t.table)}function Y(){const e=(0,i().v3)(),t=(0,r().K8)((()=>(0,F().Bh)()),[]),{botId:n}=(0,O().m)(),a=(0,r().O$)(I().AppStoreCurrentSpaceViewStore),s=(0,o.useRef)(!1),l=(0,o.useRef)(0);(0,o.useEffect)((()=>{s.current=!1,l.current=0;(async()=>{if(t&&!s.current&&n&&a&&l.current<3)try{await(0,N().qq)({environment:e,currentSpaceViewStore:a,botId:n,timeRange:(0,E().M)(),forceRefetch:!0,reason:"background_load"}),s.current=!0,l.current=0}catch(o){s.current=!1,l.current+=1}})()}),[e,a,n,t]);const[d,c]=(0,o.useState)([]),[u,p]=(0,r().K8)((()=>{const e=I().default.state.mainEditorCurrentBlockStore;if(!e)return[void 0,void 0];const t=e.getIcon();return[e.id,G(t)?t:void 0]}),[]),m=(0,r().O$)(I().AppStoreCurrentSpaceStore),g=(0,r().K8)((()=>U().A.getEvents()),[]),f=(0,o.useCallback)((()=>{if(!m||!t)return[];return g.filter((e=>{var t;if(e.isAllDay||"declined"===e.responseStatus)return!1;const n=new Date(e.start.dateTime),o=(0,P().A)(n,-5),i=new Date(e.end.dateTime),r=(0,P().A)(i,5),a=new Date;return((null===(t=e.attachments)||void 0===t?void 0:t.length)??0)>0&&r>=o&&a>=o&&a<=r}))}),[m,g,t]);(0,D().n)((()=>{if(!t)return;const e=f(),n=e.map((e=>e.id)),o=d.map((e=>e.id));(0,L().R9)(n,o).length>0&&c(e)}),2*R().Xb,!0);const h=(0,r().K8)((()=>{if(!t)return;if(!u||!m)return;const n=function(e){const{environment:t,upcomingEvents:n,currentBlockId:o,currentSpaceStore:i}=e;for(const r of n){const e=(r.attachments||[]).find((e=>{const n=H({environment:t,fileUrl:e.fileUrl,currentSpaceStore:i});return(null==n?void 0:n.id)===o}));if(e)return{event:r,attachment:e}}}({environment:e,upcomingEvents:d,currentBlockId:u,currentSpaceStore:m});if(!n)return;const o=n.event,i=n.attachment,r=null!=(a=o)&&a.attendees&&0!==a.attendees.length?Array.from(new Set(a.attendees.filter((e=>!e.self&&e.email)).map((e=>e.email)))).filter((e=>void 0!==e)):[];var a;return 0!==r.length?{beamType:"calendarAttendees",emails:r,attachment:i,recordIcon:p}:void 0}),[u,d,e,m,p,t]);if(h&&!(h.emails.length>B().Hs))return{beamType:h.beamType,emails:h.emails,attachment:h.attachment,recordIcon:h.recordIcon}}var q=()=>n(676870),$=()=>n(525700),Q=()=>n(380682),Z=()=>n(437487);const X=(0,m().YK)({seo:{defaultMessage:"Search engine indexing",id:"publishSiteSettings.SEO.title"},embed:{defaultMessage:"Embed this page",id:"embedSiteSettings.title"},shareOnSocial:{defaultMessage:"Share via social",id:"shareMenu.shareOnSocial"}});function J(e){let{inviteTargetsStore:t,mostPermissivePublicItem:n}=e;const{display:o,source:i}=(0,r().K8)((()=>{const{display:e}=Z().Ay.state;if(e===Z().pP.Invite){const{source:t}=Z().Ay.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(o){case Z().pP.MainShareMenu:case Z().pP.Publish:return(0,T.jsx)(te,{mostPermissivePublicItem:n});case Z().pP.Invite:if("notion"===i)return(0,T.jsx)(ne,{inviteTargetsStore:t});if("slack"===i||"google"===i)return(0,T.jsx)(oe,{source:i});throw(0,g().HB)(i);default:(0,g().HB)(o)}}const ee=[Z().QC.Share,Z().QC.Publish];function te(e){let{mostPermissivePublicItem:t}=e;const n=(0,i().v3)(),s=o.useRef(null),{isMobile:d}=n.device,c=(0,r().K8)((()=>(0,p().W8)(t.permissionItem)),[t.permissionItem]);(0,o.useEffect)((()=>{const e=Z().Ay.state,t=e.tab===Z().QC.Share&&e.display===Z().pP.MainShareMenu?e.source:void 0;c&&t!==Z().mc.InviteBackButton&&(Z().Ay.setState({tab:Z().QC.Publish,display:Z().pP.Publish,sessionId:u().JW(),isInitialized:!0}),(0,q().EN)(n,{source:"share_button"}))}),[n,c]);const g=(0,r().K8)((()=>Z().Ay.state.tab),[]),v=(0,a().IS)((e=>({tabStyle:{color:e.text.tertiary,...d&&{width:"50%",textAlign:"center"}},selectedTabStyle:{},tabTitleStyle:{color:"inherit",fontSize:(0,A().ny)(n,"UIRegular"),fontWeight:f().Wy.medium},style:d?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingLeft:16},tabBorderStyle:{left:0,right:0}})),[n,d]),y=(0,a().IS)((e=>({tabStyle:{width:"50%",textAlign:"center",borderRadius:10,color:e.text.secondary,fontWeight:f().Wy.regular,paddingTop:2,paddingBottom:2},tabBorderStyle:{borderBottom:"none"},selectedTabStyle:{borderRadius:8,background:"dark"===e.mode?e.tint.regular:e.surface.elevated},tabTitleStyle:{color:"inherit",fontSize:(0,A().ny)(n,"UIRegular"),fontWeight:f().Wy.regular},selectedTabTitleStyle:{fontWeight:f().Wy.medium},style:{justifyContent:"space-between",padding:2,background:e.tint.regular,borderRadius:10,marginBottom:0,height:34}})),[n]),b=(0,a().IS)((e=>({publishTabContainer:{display:"flex",alignItems:"center"},publishIcon:{height:16,width:16,marginLeft:4,opacity:g===Z().QC.Publish?1:.5},tabBarContainer:{paddingLeft:20,paddingRight:20,paddingTop:8,paddingBottom:16,backgroundColor:d?e.surface.wash:e.surface.page}})),[g,d]),M=(0,o.useCallback)((e=>{const t=ee[e];t!==g&&(h().N(n,{tab:t}),t===Z().QC.Share&&Z().Ay.setState({...Z().Ay.state,display:Z().pP.MainShareMenu,tab:Z().QC.Share,source:Z().mc.ShareTab}),t===Z().QC.Publish&&Z().Ay.setState({...Z().Ay.state,display:Z().pP.Publish,tab:Z().QC.Publish}))}),[g,n]),w=Y(),k=w&&w.emails.length>0,j=[(0,T.jsx)(o.Fragment,{children:(0,T.jsx)(m().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,T.jsxs)("div",{ref:s,style:b.publishTabContainer,className:x().hKK,children:[(0,T.jsx)(m().sA,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),c&&(0,l().J)(b.publishIcon)]},"publishTab")],C=(0,r().K8)((()=>Q().A.state.siteSettingContentType),[]);return"seo"===C?(0,T.jsx)(ae,{}):"embed"===C?(0,T.jsx)(se,{handleBackButtonClick:()=>{$().Bp("initial")}}):"social"===C?(0,T.jsx)(le,{handleBackButtonClick:()=>{$().Bp("initial")}}):d?(0,T.jsx)("div",{style:b.tabBarContainer,children:(0,T.jsx)(S().Ay,{...y,tabs:j,selectedIndex:ee.indexOf(g),onChange:M,hideTabBorder:!0})}):(0,T.jsx)(S().Ay,{...v,tabs:j,selectedIndex:ee.indexOf(g),onChange:M,right:k&&w?(0,T.jsx)(_,{beamMetadata:w}):null})}function ne(e){let{inviteTargetsStore:t}=e;const n=(0,a().IS)((e=>({container:{display:"flex",paddingLeft:12,paddingRight:12,marginBottom:16,height:40,boxShadow:`inset 0 -1px 0 ${e.regularDividerColor}`}})),[]),i=(0,o.useCallback)((()=>{t.reset(),Z().Ay.setState({...Z().Ay.state,display:Z().pP.MainShareMenu,tab:Z().QC.Share,source:Z().mc.InviteBackButton})}),[t]);return(0,T.jsx)("div",{style:n.container,children:(0,T.jsx)(re,{onClick:i,titleMessage:(0,T.jsx)(m().sA,{id:"shareMenu.sendInvite.labelV2",defaultMessage:"Invite"})})})}function oe(e){const{source:t}=e,n=(0,m().tz)(),i=(0,a().IS)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:f().Wy.semibold}})),[]),r=(0,o.useCallback)((()=>{Z().Ay.setState({...Z().Ay.state,tab:Z().QC.Share,display:Z().pP.Invite,source:Z().NL.Notion,focus:Z().yZ.Search,emailMessage:""})}),[]);return(0,T.jsxs)("div",{style:i.container,children:[(0,T.jsx)(b().A,{style:i.titleLabel,children:(0,T.jsx)(m().sA,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:(0,T.jsx)(ie,{source:t})}})}),(0,T.jsx)(y().A,{ariaLabel:n.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close external integration and go back to the main invite flow."}),icon:c().V,style:{borderRadius:"100%"},onClick:r})]})}function ie(e){let{source:t}=e;const n=(0,a().IS)((()=>({imageStyle:{marginLeft:4,marginRight:4}})),[]);return t===Z().NL.Slack?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(v().A,{type:"image_url",imageURL:s().A.images.externalIntegrations.slackIconPng,size:18,imageStyle:n.imageStyle}),(0,T.jsx)(m().sA,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]}):t===Z().NL.Google?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(v().A,{type:"image_url",imageURL:s().A.images.externalIntegrations.googleGIconPng,size:18,imageStyle:n.imageStyle}),(0,T.jsx)(m().sA,{defaultMessage:"Google",id:"shareMenu.googleContactsIntegrationName.label"})]}):void(0,g().HB)(t)}function re(e){const{onClick:t,titleMessage:n}=e,o=(0,i().v3)(),r=(0,m().tz)(),s=(0,a().IS)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:20,width:20,strokeWidth:f().Wy.semibold},sendInviteLabel:{fontWeight:f().Wy.medium,fontSize:(0,A().ny)(o,"UIRegular")}})),[o]);return(0,T.jsxs)("div",{style:s.topContainer,children:[(0,T.jsx)(y().A,{icon:d().Z,iconStyle:s.arrowIcon,style:s.iconButton,onClick:t,ariaLabel:r.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,T.jsx)(b().A,{style:s.sendInviteLabel,children:n})]})}function ae(){const e=(0,a().IS)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]),t=(0,o.useCallback)((()=>{$().Bp("initial")}),[]);return(0,T.jsx)("div",{style:e.container,children:(0,T.jsx)(re,{onClick:t,titleMessage:(0,T.jsx)(m().sA,{...X.seo})})})}function se(e){const t=(0,a().IS)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]);return(0,T.jsx)("div",{style:t.container,children:(0,T.jsx)(re,{onClick:e.handleBackButtonClick,titleMessage:(0,T.jsx)(m().sA,{...X.embed})})})}function le(e){const t=(0,a().IS)((e=>({container:{display:"flex",padding:"0 12px 0 8px",height:40,borderBottom:`1px solid ${e.stroke.secondary}`}})),[]);return(0,T.jsx)("div",{style:t.container,children:(0,T.jsx)(re,{onClick:e.handleBackButtonClick,titleMessage:(0,T.jsx)(m().sA,{...X.shareOnSocial})})})}},441532:(e,t,n)=>{n.d(t,{y:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("androidShare",{viewBox:"0 0 15 15",svg:(0,o.jsx)("path",{d:"M11.9952,10.6024 C11.4229,10.6024 10.9108,10.8283 10.51928,11.1822 L5.15029999,8.05723 C5.18794999,7.88404 5.21806999,7.71084 5.21806999,7.53012 C5.21806999,7.3494 5.18794999,7.1762 5.15029999,7.00301 L10.45904,3.90813 C10.8657,4.28464 11.4003,4.51807 11.9952,4.51807 C13.2452,4.51807 14.2542,3.50904 14.2542,2.25904 C14.2542,1.00904 13.2452,0 11.9952,0 C10.7452,0 9.73614999,1.00904 9.73614999,2.25904 C9.73614999,2.43976 9.76626999,2.61295 9.80391999,2.78614 L4.49517999,5.88102 C4.08854999,5.50452 3.55391999,5.27108 2.95903999,5.27108 C1.70903999,5.27108 0.699999988,6.28012 0.699999988,7.53012 C0.699999988,8.78012 1.70903999,9.78916 2.95903999,9.78916 C3.55391999,9.78916 4.08854999,9.55572 4.49517999,9.17922 L9.85662999,12.3117 C9.81897999,12.4699 9.79638999,12.6355 9.79638999,12.8012 C9.79638999,14.0136 10.7828,15 11.9952,15 C13.2075,15 14.194,14.0136 14.194,12.8012 C14.194,11.5889 13.2075,10.6024 11.9952,10.6024 Z"})})},446027:(e,t,n)=>{n.d(t,{A:()=>o});const o=new(n(463830).A)},448360:(e,t,n)=>{n.d(t,{W:()=>o});const o=n(757695).Store.createValue(!1,{name:"AiPageTranslationCalloutStore"})},457717:(e,t,n)=>{n.d(t,{F:()=>o});const o=new(n(463830).A)},466529:(e,t,n)=>{n.r(t),n.d(t,{HorizontalTemplatePicker:()=>X});n(898992),n(823215),n(354520),n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(792485),a=()=>n(56366),s=()=>n(401497),l=()=>n(575157),d=()=>n(589407),c=()=>n(383286),u=()=>n(284611),p=()=>n(169606),m=()=>n(421559),g=()=>n(340498),f=()=>n(179034),h=()=>n(959013),v=()=>n(534177),y=()=>n(160568),b=()=>n(246826),S=()=>n(33301),x=()=>n(751156),A=()=>n(178658),M=()=>n(732067),w=()=>n(226916),k=()=>n(264699),j=()=>n(828634),C=()=>n(549500),I=()=>n(862835),T=()=>n(249696),_=()=>n(68465),P=()=>n(972435),B=()=>n(478726),L=()=>n(963589),R=()=>n(806638),D=()=>n(962730),N=()=>n(377586),O=()=>n(227440),E=()=>n(970585),U=()=>n(611371),F=()=>n(922952),V=()=>n(317053),z=()=>n(155004),K=()=>n(364280),W=()=>n(939740),H=()=>n(8980),G=()=>n(897119),Y=()=>n(125565),q=()=>n(532731),$=()=>n(286611),Q=n(474848);const Z=8;function X(e){const{store:t,context:n,menuListStore:L,editorWidth:E}=e,X=te(),ie=(0,B().L5)(n),re=(0,s().IS)((e=>({root:{background:ie?e.peekModalBackground:e.contentBackground,paddingBottom:"min(48px, 5vh)",pointerEvents:"all"}})),[ie]),[ae,se]=function(e){const t=(0,i().v3)(),n=(0,a().K8)((()=>"editor"===e.getRole()),[e]),o={name:(0,h().tz)().formatMessage(ee.tableTemplateTitle),type:"database",iconFn:m().T,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>{const n=t.getParentStore();n&&(0,F().u)(n)&&(0,V().openTemplateOnboardingModal)({parentStore:n,template:void 0,version:(0,V().getTemplateOnboardingVersion)({template:void 0}),origin:"new_page_pills",navigateToOnFinish:"created_collection",onClose:o=>{"accepted_template"!==o.type&&"accepted_empty_collection"!==o.type||x().createAndCommit({environment:e,canUndo:!1,perform:e=>{if(b().zv({store:t,transaction:e,data:{alive:!1}}),n.table===f().ev){const o=n.getContentIds();b().zv({store:n,transaction:e,data:{content:o.filter((e=>e!==t.id))}})}},userAction:"clean_up_empty_new_page"})}})}},d=function(e){const{environment:t,store:n}=e,o=(0,h().tz)(),i=(0,r().S)(),s=(0,a().K8)((()=>null==i?void 0:i.publicEditModeStore.state),[null==i?void 0:i.publicEditModeStore]),l=(0,a().K8)((()=>(0,_().ZE)(s)),[s]);return{name:o.formatMessage(ee.askAi),type:"ai",iconFn:e=>(0,Q.jsx)(M().UY,{}),shouldShow:()=>l,onClick:()=>{x().createAndCommit({userAction:"HorizontalTemplatePicker.genericHelpMeWriteNewPageWithAI",environment:t,canUndo:!0,perform:e=>{S().n({environment:t,store:n,transaction:e,preventTextSelection:!1,onTextSelection(){(0,A().openHelpMeWriteGenericPopup)({environment:t,title:""})}})}})}}}({environment:t,store:e}),g=function(e){const t=(0,h().tz)(),n=(0,s().DP)(),o=(0,a().K8)((()=>(0,I().h)()),[]),i=(0,T().W)(),r=te();return{name:e?"":t.formatMessage(ee.dictate),type:"dictation",iconFn:t=>(0,c().E)({...t,width:10,...e?{height:16,marginTop:"2px",marginBottom:"2px",marginLeft:"2px",marginRight:"-6px"}:{},fill:r?n.icon.primary:"dark"===n.mode?n.palette.red[700]:n.palette.red[400]}),shouldShow:()=>o&&!i,onClick:async(e,t)=>{const{dictationActions:n}=await C().$O.load();n.startDictation({environment:e,blockStore:t,from:"horizontal_template_picker",includeSystemAudio:!1})}}}(!0),v=function(){const e=(0,h().tz)(),t=(0,s().DP)(),n=(0,T().W)();return{name:e.formatMessage(ee.transcription),type:"transcription",iconFn:e=>(0,u().b)({...e,fill:t.icon.primary}),shouldShow:()=>n,onClick:async(e,t)=>{const{transcriptionNewPageActions:n}=await C().$O.load();n.appendTranscriptionBlockToPage({environment:e})}}}(),y=function(e){const t=(0,i().v3)();return{name:(0,h().tz)().formatMessage(ee.formTemplateTitle),type:"quick-form",iconFn:l().D,shouldShow:()=>!0,onClick:async()=>{await(0,w().t)({environment:t,store:e})}}}(e),j=function(e){const{isTablet:t}=(0,i().Y0)();return{name:P().A.formatMessage(q().KQ.templates),type:"templates",iconFn:e=>(0,p().s)(e),shouldShow:()=>!t,onClick:e=>{(0,R().P)({environment:e})}}}(),B=[g,d,v,o,...n?[y]:[],j].filter((e=>e.shouldShow(t))),L=[...k()._,ne,q().zD];return[B,L]}(t),[le,de]=function(e){const{store:t,editorWidth:n,initialVisible:r,initialOverflow:a}=e,l=(0,i().v3)(),c=(0,h().tz)(),u=te(),p=(0,s().IS)((e=>({icon:{width:g().Ev.default,height:g().Ev.default,fill:e.icon.primary}})),[]),[m,f]=o.useState(void 0),[b,S]=o.useState([]),[x,A]=o.useState(void 0),[M,w]=o.useState(r.length);(0,o.useEffect)((()=>{if(!(n&&b.every(v().O9)&&x))return;let e=0,t=0;for(;t<r.length&&(e+=b[t]+Z,!(e+x>n+24));)t++;w(t)}),[b,n,r.length,x]);const k=r.slice(0,M).map(((e,n)=>{const o={key:"ai-skill"===e.type?`${e.type}-${n}`:e.type,render:o=>{var i;let{ref:r,...a}=o;return(0,Q.jsx)(j().EE,{onSizeChange:e=>{if(b[n]===e.width)return;const t=[...b];t[n]=e.width,S(t)},children:(0,Q.jsx)("div",{children:(0,Q.jsx)($().J,{...a,focused:m===n,onMouseEnter:o=>{var i;null===(i=e.onMouseEnter)||void 0===i||i.call(e,l,t),f(n)},onMouseLeave:n=>{var o;null===(o=e.onMouseLeave)||void 0===o||o.call(e,l,t),f(void 0)},format:"horizontal-new-page",title:(0,Q.jsx)(Y().A,{children:e.name}),type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,p.icon),locked:!1})})})},action:n=>{(0,U().EF)(l)&&(y().ki(l,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(l,t))}};return o})),[C,I]=o.useState(!1),T=M,_={key:"more",render:e=>{let{ref:n,...o}=e;return(0,Q.jsx)(G().Ay,{origin:(0,Q.jsx)(j().EE,{onSizeChange:e=>A(e.width),children:(0,Q.jsx)("div",{children:(0,Q.jsx)($().J,{...o,focused:m===T,onMouseEnter:e=>{f(T)},onMouseLeave:e=>{f(void 0)},format:"horizontal-new-page",title:u?null:(0,Q.jsx)(Y().A,{children:c.formatMessage(ee.more)}),type:"more",icon:(0,Q.jsx)(H().I,{icon:d().L,color:"secondary"}),locked:!1})})}),alignmentToOrigin:D().C.Start,placementToOrigin:D().W.Top,originGap:4,open:C,popupType:N().n.Popup,onDismiss:()=>I(!1),render:()=>(0,Q.jsx)(oe,{store:t,items:[...r.slice(M),...a]})})},action:e=>{y().ki(l,{is_keyboard:"keydown"===e.event.type,from:"horizontal_template_picker",template_type:"more"}),I(!0)}};return[k,_]}({store:t,editorWidth:E,initialVisible:ae,initialOverflow:se});return!(0,a().O$)(O().e)?null:(0,Q.jsx)(z().s,{allowSelectionWithin:!1,children:(0,Q.jsx)(W().Ay,{type:W().Oh.Horizontal,store:L,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Get started",render:e=>(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(J,{isInPeekView:ie}),(0,Q.jsx)("div",{style:re.root,children:(0,Q.jsxs)(K().VP,{gap:12,children:[(0,Q.jsx)(Y().A,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:500},children:X?(0,Q.jsx)(h().sA,{defaultMessage:"Get started with",id:"PageEditor.horizontalTemplatePicker.getStarted.label.new"}):(0,Q.jsx)(h().sA,{defaultMessage:"Get started",id:"PageEditor.horizontalTemplatePicker.getStarted.label"})}),(0,Q.jsx)("div",{style:{cursor:"pointer"},children:(0,Q.jsx)(K().fI,{gap:Z,children:e.children})})]},e.key)})]}),items:[...le,de]}]})})}function J(e){const t=(0,s().IS)((t=>({fade:{background:`linear-gradient(0deg, ${e.isInPeekView?t.peekModalBackground:t.contentBackground} 0%, ${t.contentBackgroundTransparent} 100%)`,height:140,width:"100%"}})),[e.isInPeekView]);return(0,Q.jsx)("div",{style:t.fade})}const ee=(0,h().YK)({askAi:{defaultMessage:"Ask AI",id:"newpage.templates.writeWithAiCondensed"},dictate:{defaultMessage:"Dictate",id:"newpage.templates.dictateIntoNewPage"},transcription:{defaultMessage:"Meet",id:"newpage.templates.transcription"},more:{defaultMessage:"More",id:"newpage.templates.more"},tableTemplateTitle:{defaultMessage:"Database",id:"newpage.templates.table"},formTemplateTitle:{defaultMessage:"Form",id:"newpage.templates.form"}});function te(){const e=(0,i().v3)(),{isTablet:t}=(0,i().Y0)(),n=(0,L().X)("tablet_refresh_template_pills_gate");return!(!t||!n)||!e.device.isMobile}const ne={name:"",type:"divider",iconFn:e=>null,shouldShow:()=>!0,onClick:()=>{}};function oe(e){const{store:t,items:n}=e,r=(0,i().v3)(),a=(0,o.useMemo)((()=>new(E().A)),[]),l=(0,s().IS)((e=>({menu:{width:200,cursor:"pointer",padding:"6px 4px"},icon:{width:g().Ev.default,fill:e.icon.primary},divider:{height:1,background:e.stroke.primary,margin:"6px -6px"}})),[]),d=n.filter((e=>e.shouldShow(r))).map((e=>{const n={key:e.name,render:t=>{var n;let{ref:o,...i}=t;return"divider"===e.type?(0,Q.jsx)("div",{style:l.divider}):(0,Q.jsx)($().J,{...i,format:"horizontal-new-page-submenu",title:(0,Q.jsx)(Y().A,{children:e.name}),type:e.type,icon:null===(n=e.iconFn)||void 0===n?void 0:n.call(e,l.icon),locked:!1})},action:n=>{(0,U().EF)(r)&&(y().ki(r,{is_keyboard:"keydown"===n.event.type,from:"horizontal_template_picker",template_type:e.type}),e.onClick(r,t))}};return n}));return(0,Q.jsx)(W().Ay,{type:W().Oh.Vertical,store:a,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,isEnterOnHoverEmpty:!0,disableKeyboard:!0,sections:[{key:"Items",render:e=>(0,Q.jsx)("div",{style:l.menu,children:(0,Q.jsx)(K().VP,{children:e.children},e.key)}),items:d}]})}},467935:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(584262),s=()=>n(133033),l=()=>n(959013),d=()=>n(148024),c=()=>n(857783),u=()=>n(836251),p=()=>n(765957);class m extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const g=new m;var f=()=>n(493823),h=()=>n(187485),v=()=>n(633783),y=n(474848);const b={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:n(284371).Wy.bold,marginRight:"auto"},S={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},x={padding:"24px 36px 24px",minWidth:300};const A=function(){const e=(0,r().O$)(g);return(0,y.jsx)(n(676007).a,{open:e.open,innerStyle:x,preventHideChildrenWhileOpening:!0,render:()=>(0,y.jsxs)(o.Fragment,{children:[(0,y.jsxs)("div",{style:S,children:[(0,y.jsx)("div",{style:b,children:(0,y.jsx)(l().sA,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,y.jsx)(M,{})]}),(0,y.jsx)("div",{children:(0,y.jsx)(k,{modalState:e})})]}),onDismiss:w})};function M(){const e=(0,i().v3)();return(0,y.jsx)(h().A,{href:(0,u().xS)("guides.import"),onClick:()=>d().FH(e,{from:"import"}),external:!0,children:(0,y.jsx)(f().p,{size:"sm",iconLeading:s().$,isGray:!0,children:(0,y.jsx)(l().sA,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function w(){g.setState({open:!1})}function k(e){let{modalState:t}=e;const n=(0,i().v3)(),{mainEditorCurrentBlockStore:o,currentSpaceStore:s,currentSpaceViewStore:l,currentUserSettingsStore:d}=(0,r().K8)((()=>{const{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}=p().default.state;return{mainEditorCurrentBlockStore:e,currentSpaceStore:t,currentSpaceViewStore:n,currentUserSettingsStore:o}}),[]);return o&&s&&l&&d?(0,y.jsx)(v().A,{pageStore:t.open&&t.pageStore?t.pageStore:o,spaceStore:s,spaceViewStore:l,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>function(e,t){g.setState({open:!1}),c().uK({environment:t,store:e,pageVisitSource:a().y8.Import})}(e,n),readOnlyCreditButton:!1}):null}},487443:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInviteWithModal:()=>l});n(296540);var o=()=>n(56366),i=()=>n(401497),r=()=>n(433876),a=()=>n(284331),s=n(474848);function l(e){let{store:t,permissionsInviteStore:n,origin:l}=e;const d=(0,o().K8)((()=>n.state.modalOpen),[n]),c=()=>{n.reset()},u=(0,i().IS)((()=>({modal:{alignSelf:"center",overflow:"visible",top:0,width:500},overlay:{display:"flex",flexDirection:"column",alignItems:"end",padding:22}})),[]);return(0,s.jsx)(r().A,{modalStyle:u.modal,open:d,onDismiss:c,renderContent:()=>(0,s.jsx)("div",{style:u.overlay,children:(0,s.jsx)(a().A,{store:t,permissionsInviteStore:n,isNewlyCreatedTeam:!1,onSubmitSuccessful:c,onDismiss:c})}),origin:l})}},500844:(e,t,n)=>{n.r(t),n.d(t,{TeamPermissionsInvite:()=>O});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(842599),l=()=>n(187174),d=()=>n(959013),c=()=>n(542056),u=()=>n(928600),p=()=>n(263919),m=()=>n(417555),g=()=>n(856952),f=()=>n(47373),h=()=>n(722872),v=()=>n(743260),y=()=>n(37433),b=()=>n(765957),S=()=>n(205618),x=()=>n(224701),A=()=>n(668725),M=()=>n(496603),w=()=>n(493823),k=()=>n(760217),j=()=>n(406699),C=()=>n(939740),I=()=>n(89924),T=()=>n(859428),_=()=>n(962730),P=()=>n(700250),B=()=>n(308228),L=()=>n(43450),R=n(474848);function D(e){const{selectedRole:t,allRoles:n,onChange:o,store:s,labelStyle:l}=e,{device:c}=(0,i().v3)(),p=(0,a().DP)(),m=(0,L().R)(s),g=(0,r().K8)((()=>{const{currentSpaceStore:e}=b().default.state;return null==e?void 0:e.canEditMembership()}),[]),f=(0,r().K8)((()=>s.isDefault()),[s]);return(0,R.jsx)(j().Ay,{popupType:c.isMobile?j().z7.SlideUp:j().z7.Popup,renderOrigin:e=>(0,R.jsxs)(w().p,{style:l,...e,children:[(0,R.jsx)(d().sA,{...y().Y7[t].label}),(0,A().b)({width:10,marginLeft:4,fill:p.icon.tertiary})]}),placementToOrigin:P().UV.Bottom,render:e=>{const i=[{key:"roles",render:e=>(0,R.jsx)(I().A,{...e,topBorder:0!==e.index}),items:n.map((n=>{const{isDisabled:i,disabledReason:r}=(0,B().m)({role:n,isCurrentUserTeamOwner:Boolean(m),userIsSpaceAdmin:Boolean(g),isDefaultTeam:f}),a={key:n,render:e=>(0,R.jsx)(T().A,{disableTooltip:!i,placement:_().W.Right,textWrap:!0,renderTooltip:()=>r,render:o=>(0,R.jsx)("span",{...o,children:(0,R.jsx)(k().A,{...e,isChecked:M().n4(n,t),disabled:i,disabledFeedback:i,title:(0,R.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,R.jsx)(d().sA,{...y().Y7[n].label})}),caption:(0,R.jsx)("span",{style:{color:p.text.secondary},children:(0,R.jsx)(d().sA,{...y().Y7[n].caption})}),shouldWrapCaption:!0})})}),action:()=>{o(n),e.close()}};return a}))}];let r;return r=c.isMobile?{menuType:h().gu.Modal,title:(0,R.jsx)(d().sA,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,R.jsx)(d().sA,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:h().gu.Popup,width:264},(0,R.jsx)(u().A,{...r,children:(0,R.jsx)(C().Ay,{type:C().Oh.Vertical,initialFocus:void 0,sections:i})})}})}const N="member";function O(e){const{store:t,onEmptySubmit:n}=e,o=(0,i().v3)();(0,l().Yb)((async()=>{await x().x(o)}),[]);const s=(0,r().uB)(e.permissionsInviteStore,S().A),d=(0,r().K8)((()=>Boolean(s.state.isFocused)),[s]),c=(0,r().K8)((()=>s.state.tokenQuery),[s]),m=(0,r().K8)((()=>d&&c.length>0),[d,c]),g=(0,a().IS)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.contentBackground,boxShadow:e.shadowLG,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){s.setState({...s.state,isFocused:e})}return(0,R.jsx)("div",{onFocus:()=>f(!0),onBlur:()=>f(!1),children:(0,R.jsx)(u().A,{menuType:h().gu.Popup,header:(0,R.jsx)(E,{store:t,permissionsInviteStore:s,setFocus:f,onEmptySubmit:n}),scrollerStyle:g.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:m&&(0,R.jsx)("div",{style:g.permissionsInviteSearchRequest,children:(0,R.jsx)(p().A,{permissionsInviteStore:s,store:t,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}function E(e){const{store:t,permissionsInviteStore:n,onEmptySubmit:l,setFocus:u}=e,p=(0,d().tz)(),f=(0,i().v3)(),h=(0,o.useRef)(null),y=(0,r().K8)((()=>Boolean(n.state.isFocused)),[n]),b=(0,r().K8)((()=>n.state.tokenQuery),[n]),S=(0,r().K8)((()=>n.state.inviteRole),[n]),x=(0,r().K8)((()=>n.state.inviteTargets),[n]),A=(0,a().IS)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:y?e.buttonBlueFocusRing:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[y]);function M(e){const t=n.state.inviteTargets.filter((t=>t!==e));n.setState({...n.state,inviteTargets:t,inviteRole:N})}const w=x.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,R.jsx)(m().A,{target:e,onClickRemove:M,role:S,shouldWrap:!0,style:A.inputTokenVerticalMargin,backgroundColor:(0,v().qv)(e)},t)}));return(0,R.jsx)(g().Ay,{ref:h,focus:y,onClick:()=>u(!0),format:g().le.Share,value:b,onChange:async e=>{await async function(e){const{environment:t,permissionsInviteStore:n,event:o,setFocus:i,inputRef:r}=e,a=o.target.value,{extractedEmails:l,newInputValue:d}=(0,s().Ct)(a),u=await c().Ah(t,l),p=u.filter((e=>!(0,v().mQ)({target:e,permissionsInviteStore:n}))),m=[...n.state.inviteTargets,...p];if(n.setState({...n.state,inviteTargets:m,tokenQuery:d}),m.length>0){if(!d){const e=r.current;e&&(e.value="")}i(!(p.length>0))}}({environment:f,event:e,permissionsInviteStore:n,setFocus:u,inputRef:h})},onEmptySubmit:l,type:"email",placeholder:p.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:w,tokenWrapStyle:{gap:4},onRemoveLastToken:function(){const e={...n.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.inviteRole=N),n.setState(e)},focusAfterAnimation:!0,right:(0,R.jsx)(U,{store:t,permissionsInviteStore:n}),style:A.tokenMenuItem,inputStyle:A.inputTokenVerticalMargin,inputDivStyle:A.inputDiv,inputFullWidth:!0})}function U(e){const{store:t,permissionsInviteStore:n}=e,o=(0,r().K8)((()=>{const e=b().default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,f().Qd)()}),[]),i=(0,r().K8)((()=>n.state.inviteRole),[n]),s=(0,a().IS)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){n.setState({...n.state,inviteRole:e})}return o?(0,R.jsx)(D,{store:t,selectedRole:i,allRoles:y().vm,onChange:l,labelStyle:s.teamRoleLabel}):(0,R.jsx)(D,{store:t,selectedRole:i,allRoles:y().H1,onChange:l,labelStyle:s.teamRoleLabel})}},501402:(e,t,n)=>{n.r(t),n.d(t,{PopupBottomSheet:()=>f});var o=n(296540),i=()=>n(484714),r=()=>n(852507),a=()=>n(56366),s=()=>n(401497),l=()=>n(751735),d=()=>n(347199),c=()=>n(574012),u=()=>n(881839),p=()=>n(348603),m=()=>n(56197),g=n(474848);function f(e){const{isAndroid:t}=(0,i().Y0)(),n=(0,s().IS)((n=>({container:{position:"absolute",top:0,left:0,width:"100vw",height:"100vh",overflow:"hidden",pointerEvents:"none"},content:{position:"absolute",bottom:0,left:0,right:0,maxHeight:"var(--full-viewport-height)"},overlay:{pointerEvents:"auto",position:"absolute",top:0,left:0,bottom:0,right:0,...e.disableDarkOverlayBackground?{}:{background:t?(0,l().X4)("black","light"===n.mode?.2:.8):(0,l().X4)("black","light"===n.mode?.12:.29)},transition:"opacity 0.5s cubic-bezier(0.32, 0.72, 0, 1)"}})),[e.disableDarkOverlayBackground,t]),r=(0,o.useRef)(null),[a,d]=(0,o.useState)(0);return e.open?(0,g.jsx)(u().L,{keepFocus:e.keepFocus,preventCaptureEsc:e.preventCaptureEsc,onDismiss:e.onDismiss,children:t=>(0,g.jsxs)("div",{...t,style:n.container,children:[(0,g.jsx)("div",{"aria-hidden":!0,tabIndex:-1,ref:r,style:{...n.overlay,opacity:a},onMouseDown:e=>e.preventDefault()},"overlay"),(0,g.jsx)("div",{style:n.content,children:(0,g.jsx)(h,{...e,overlayRef:r,setAnimationState:d,children:e.render()})})]})},"popup-keyboard-area"):null}function h(e){const{initialState:t,onDismiss:n,overlayRef:l,setAnimationState:u}=e,{WindowSizeStore:f,TabbedRouterStore:h}=(0,i().v3)(),{isAndroid:v,isTablet:y,isMobileNative:b}=(0,i().Y0)(),S=(0,a().K8)((()=>h.state.modal.length>0),[h]),x=(0,o.useRef)(!1),A="half"===t||"full"===t&&e.enableHalfSheet,M=(0,o.useMemo)((()=>window.innerHeight),[]),w=(0,o.useRef)(M),k=(0,o.useMemo)((()=>({closed:M,half:.5*M,open:0})),[M]),j=(0,a().K8)((()=>f.getSafePaddingTopCSS(v?16:10)),[f,v]),[C,I]=(0,o.useState)({transform:`translateY(${k.closed}px) translateZ(0)`});(0,r().w)((()=>{p().K.setState(!0),u(1),P({target:"half"===t?k.half:k.open,animate:!0})}));const T=(0,s().IS)((t=>({sheet:{backgroundColor:"contentBackground"===e.bottomSheetBackgroundColor?t.contentBackground:e.bottomSheetBackgroundColor?t.surface[e.bottomSheetBackgroundColor]:t.surface.wash,borderRadius:"12px 12px 0 0",maxWidth:640,margin:"0 auto",marginTop:j,boxShadow:v?void 0:t.shadowMD},dragHandle:{height:5,width:v?44:38,backgroundColor:t.stroke.primary,borderRadius:5,margin:"0px auto"}})),[j,v,e.bottomSheetBackgroundColor]),_=(0,o.useRef)(-1),P=(0,o.useCallback)((e=>{const{target:t,animate:n}=e,o=Math.max(Math.min(t,k.closed),k.open),i=_.current;window.cancelAnimationFrame(i),_.current=window.requestAnimationFrame((()=>{if(w.current=o,I({transform:`translateY(${o}px) translateZ(0)`,transition:n?"transform 0.5s cubic-bezier(0.32, 0.72, 0, 1)":void 0}),x.current){const e=Math.max(0,Math.min(o/k.closed,1)),t=.5-e<k.half?e:0,i=1-Math.max(0,Math.min(2*t,1));m().q.update((e=>({...e,attached:!0,animating:n,proportion:i})))}}))}),[_,w,k]),B=(0,a().K8)((()=>{const{phase:e}=c().A.state;return e===c().i.willShow||e===c().i.shown}),[]);(0,o.useEffect)((()=>{B&&w.current>50&&P({target:k.open,animate:!0})}),[B,k.open,w,P]),(0,o.useEffect)((()=>{const e=l.current;if(e){const t=e=>{P({target:k.closed,animate:!0})};return e.addEventListener("click",t),()=>e.removeEventListener("click",t)}}),[l,k.closed,P,n]);const L=(0,o.useCallback)((()=>{var e;return null===(e=d().A.MenuScroller)||void 0===e?void 0:e.getNode()}),[]),R=(0,o.useRef)(0),D=(0,o.useRef)(0),N=(0,o.useRef)(void 0),O=(0,o.useRef)(0),E=(0,o.useRef)(!1),U=(0,o.useCallback)((e=>{E.current=!1,N.current=void 0;const t={open:.3*M,half:M*(v?.55:.65)},n={open:M*(v?.3:.4)},o=Math.max(0,Date.now()-O.current),i=(w.current-R.current)/o;let r;r=i<-.5?k.open:i>1?A&&w.current<t.half?k.half:k.closed:A?w.current<t.open?k.open:w.current<t.half?k.half:k.closed:w.current<n.open?k.open:k.closed,void 0!==r&&P({target:r,animate:!0})}),[v,A,M,w,P,k]);(0,o.useEffect)((()=>{if(b&&!v&&!y&&!S&&!m().q.state.attached)return x.current=!0,m().q.update((e=>({...e,attached:!0}))),()=>{x.current=!1,m().q.update((e=>({...e,attached:!1})))}}),[b,v,y,S,w,M,k.half]);const F=(0,o.useCallback)((e=>{var t;const n=e.touches[0].clientY-D.current,o=n<0?"up":"down";N.current=e.touches[0].clientY;const i=L();if(0!==((null==i?void 0:i.scrollTop)??0))return;const r=(null===(t=L())||void 0===t?void 0:t.clientHeight)??0;if("up"===o&&r<k.half-17-100)return;if("up"===o&&0===w.current)return;e.preventDefault(),e.stopPropagation(),E.current=!0;const a=Math.max(0,R.current+n);P({target:a,animate:!1})}),[w,P,k.half,L]),V=(0,o.useCallback)((e=>{"transform"===e.propertyName&&p().K.setState(!0)}),[]),z=(0,o.useCallback)((e=>{"transform"===e.propertyName&&p().K.setState(!1)}),[]),K=(0,o.useRef)(null);return(0,o.useEffect)((()=>{const e=K.current;if(e)return e.addEventListener("touchmove",F),e.addEventListener("transitionrun",V),e.addEventListener("transitionend",z),()=>{e.removeEventListener("touchmove",F),e.removeEventListener("transitionrun",V),e.removeEventListener("transitionend",z)}}),[F,V,z]),(0,g.jsx)("div",{role:"none",ref:K,style:{...C,willChange:"transform"},onTransitionEnd:e=>{"transform"===e.propertyName&&w.current===k.closed&&(u(0),null==n||n(e))},onTouchStart:e=>{R.current=w.current,D.current=e.touches[0].clientY,O.current=Date.now(),w.current>0&&(E.current=!0)},onTouchEnd:U,children:(0,g.jsxs)("div",{role:"dialog","aria-label":e.ariaLabel,"aria-labelledby":e.ariaLabelledBy,"aria-describedby":e.ariaDescribedBy,"aria-modal":!!e.trapFocus||void 0,style:{...T.sheet,pointerEvents:E.current?"none":"auto",touchAction:E.current?"none":"auto"},children:[(0,g.jsx)("div",{style:{height:6}}),(0,g.jsx)("div",{style:T.dragHandle},"drag-spacer"),(0,g.jsx)("div",{style:{height:6}}),(0,g.jsx)("div",{style:{display:"flex",flexDirection:"column",height:`calc(var(--full-viewport-height) - 17px - ${j})`},children:e.children})]},"content")},"sheet")}},514799:(e,t,n)=>{n.d(t,{H:()=>s});var o=()=>n(484714),i=()=>n(56366),r=()=>n(185078),a=()=>n(910302);function s(e){const{detectedLanguage:t,canSuggestInConfidence:n}=function(e){const{pageStore:t,enabled:n,forceUpdate:r=!1}=e,s=(0,o().v3)();return(0,i().K8)((()=>n?a().bY({pageStore:t,environment:s,enabled:n,forceUpdate:r}):{detectedLanguage:void 0,canSuggestInConfidence:!1}),[t,s,n,r])}(e);return t&&!(0,r().cE)(t)?{detectedLanguage:void 0,canSuggestInConfidence:!1}:{detectedLanguage:t,canSuggestInConfidence:n}}},515512:(e,t,n)=>{n.d(t,{Q:()=>s});var o=()=>n(484714),i=()=>n(56366),r=()=>n(640653),a=()=>n(765957);function s(){const e=function(){const e=(0,o().v3)();return(0,i().K8)((()=>{const t=a().default.state.currentSpaceStore;if(!t)return{loading:!0};if(!r().IL(t))return{loading:!1,isUserTeamGuestOfSpace:!1};const n=a().default.state.currentSpaceViewStore;if(!n||!e.currentUser.id)return{loading:!0};const o=r().vb({userId:e.currentUser.id,spaceViewStore:n});return o.isLoaded?{loading:!1,isUserTeamGuestOfSpace:o.isTeamGuestInSpace}:{loading:!0}}),[e])}();return(0,i().K8)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},525700:(e,t,n)=>{n.d(t,{Bp:()=>R,DD:()=>F,E9:()=>J,H6:()=>_,HE:()=>P,HY:()=>D,JI:()=>G,Nf:()=>Y,P8:()=>Z,V_:()=>q,XL:()=>V,Xz:()=>z,aD:()=>B,aN:()=>H,d7:()=>W,d8:()=>C,j4:()=>$,n0:()=>Q,pu:()=>E,sd:()=>K,uH:()=>N,uY:()=>X,wl:()=>L,yF:()=>U,zV:()=>T});n(16280),n(944114),n(898992),n(354520),n(581454),n(296540);var o=()=>n(68263),i=()=>n(161479),r=()=>n(101628),a=()=>n(245241),s=()=>n(959013),l=()=>n(496603),d=()=>n(498212),c=()=>n(449506),u=()=>n(496414),p=()=>n(246826),m=()=>n(755636),g=()=>n(436572),f=()=>n(751156),h=()=>n(780054),v=()=>n(594794),y=()=>n(976721),b=()=>n(562800),S=()=>n(40226),x=()=>n(380682),A=()=>n(300451),M=()=>n(676870),w=()=>n(435212),k=n(474848);const j=(0,s().YK)({savingSiteSettings:{id:"siteSettingsActions.publishingSiteSettings.loadingMessage",defaultMessage:"Saving site settings…"}});function C(e){const{environment:t,store:n,type:o,header:a,domainId:s}=e,l=n.getSiteStore();if(l)return l.id;let d=s;var c;d||(d=null===(c=b().Nq(n.getSpaceStore()))||void 0===c?void 0:c.id);const u=(0,v().JH)({environment:t,table:r().Eu,spaceId:(0,i().e)(n.getSpaceId())});f().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const i=p().vt({environment:t,table:u.table,args:{id:u.id,type:o,spaceId:u.spaceId,blockId:n.id,domainId:d,currentUserId:t.currentUser.id,header:a??{}},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e});return p().zv({store:n.getFormatStore(),data:{site_id:i.id},transaction:e}),i.id}})}function I(e){const{environment:t,siteRootBlockStore:n,domainId:o}=e;let i=n.getSiteStore();if(i||(C({environment:t,type:"site",store:n,domainId:o}),i=n.getSiteStore()),i)return i}function T(e){const{environment:t,domainId:n,resetWatermark:o}=e,i=I(e);i&&i.isDefined()&&(f().createAndCommit({userAction:"publishSite.updatePublicDomain",environment:t,canUndo:!0,perform:e=>{i.getDomainId()!==n&&f().applyOperation({transaction:e,store:i,operation:i.getModel().ops.updatePublicDomainId({domainId:n,currentUserId:t.currentUser.id})})}}),f().createAndCommit({userAction:"publishSite.resetWatermark",environment:t,canUndo:!0,perform:e=>{if(o){const n=i.getHeader();f().applyOperation({transaction:e,store:i,operation:i.getModel().ops.updateHeader({header:{...n,hideWatermark:!1},currentUserId:t.currentUser.id})})}}}),g().D6({label:(0,k.jsx)(s().sA,{id:"publishSiteSettings.publicDomain.confirmation",defaultMessage:"Successfully updated domain for all pages within this site"})}))}function _(e){const{environment:t,siteRootBlockStore:n,isSearchEngineIndexingEnabled:o}=e,r=I(e);if(!r)return;"form"!==r.getType()&&f().createAndCommit({userAction:"publishSite.updateSeoEnabled",environment:t,canUndo:!0,perform:e=>{r&&r.isDefined()&&o!==r.isSearchEngineIndexingEnabled()&&(f().applyOperation({transaction:e,store:r,operation:r.getModel().ops.updateIsSearchEngineIndexingEnabled({isSearchEngineIndexingEnabled:o,currentUserId:t.currentUser.id})}),o&&e.postSubmitCallbacks.push((async e=>{e||await c().callApi({eventName:"enqueueScanContentTask",environment:t,data:{pagePointer:{id:n.id,table:"block",spaceId:(0,i().e)(n.pointer.spaceId)}}})})))}})}function P(e){const{environment:t,store:n,seoTitle:o,seoDescription:i}=e;f().createAndCommit({userAction:"publishSite.create",environment:t,canUndo:!0,perform:e=>{const r=n.getFormat().seo_title,a=n.getFormat().seo_description;r===o&&a===i||(p().zv({store:n.getFormatStore(),data:{seo_title:o,seo_description:i},transaction:e}),(0,M().NZ)(t,{target_block_id:n.id,new_title:o??null,new_description:i??null}),g().D6({label:(0,k.jsx)(s().sA,{id:"siteSettingsEditor.publishSeoChanges.confirmation",defaultMessage:"Successfully updated the SEO settings"})}))}})}function B(e){A().A.setState({...A().A.state,settingOpen:e})}function L(){A().A.setState({...A().A.state,settingOpen:"initial"})}function R(e){x().A.setState({...x().A.state,siteSettingContentType:e})}function D(e){var t,n,o;const{siteRootBlockStore:i,permissionItem:r,from:a,sudoModeStore:s}=e,l=i.getSiteStore(),d=null==l?void 0:l.getHeader(),c=(null==d||null===(t=d.customItems)||void 0===t?void 0:t.map((e=>e.blockId)))||[];A().A.setState({settingOpen:"initial",permissionItem:r,from:a,sudoModeStore:s,faviconUrl:(null==l?void 0:l.getFaviconUrl())||null,previewImageUrl:(null==l?void 0:l.getPreviewImageUrl())||null,hideBreadcrumbs:null==d?void 0:d.hideBreadcrumbs,hideSearch:null==d?void 0:d.hideSearch,hideShare:null==d?void 0:d.hideShare,hideWatermark:null==d?void 0:d.hideWatermark,enableDuplicateAsTemplate:r.allow_duplicate,customHeaderBlockIds:c,googleAnalyticsId:null==l?void 0:l.getGoogleAnalyticsId(),theme:null==l||null===(n=l.getSettings())||void 0===n?void 0:n.theme,enableQna:null==l||null===(o=l.getSettings())||void 0===o?void 0:o.enableQna})}async function N(e){var t;const{environment:n,store:i,siteRootBlockStore:r}=e,a=I({environment:n,siteRootBlockStore:r}),l=null==a?void 0:a.getType();if(!a||"form"===l)return;const p=A().A.getState(),m={},h=function(e,t){var n,o,i,r,a,s,l,d;const c=O(e.customHeaderBlockIds,null===(n=t.getHeader())||void 0===n?void 0:n.customItems);return e.faviconUrl!==(t.getFaviconUrl()||null)||e.previewImageUrl!==(t.getPreviewImageUrl()||null)||c||e.hideBreadcrumbs!==(null===(o=t.getHeader())||void 0===o?void 0:o.hideBreadcrumbs)||e.hideSearch!==(null===(i=t.getHeader())||void 0===i?void 0:i.hideSearch)||e.hideShare!==(null===(r=t.getHeader())||void 0===r?void 0:r.hideShare)||e.hideWatermark!==(null===(a=t.getHeader())||void 0===a?void 0:a.hideWatermark)||e.googleAnalyticsId!==t.getGoogleAnalyticsId()||e.theme!==(null===(s=t.getSettings())||void 0===s?void 0:s.theme)||e.enableQna!==(null===(l=t.getSettings())||void 0===l?void 0:l.enableQna)||(null===(d=e.permissionItem)||void 0===d?void 0:d.allow_duplicate)!==e.enableDuplicateAsTemplate&&e.permissionItem&&e.from}(p,a);if(!h)return;let v;if(u().m({message:j.savingSiteSettings}),p.enableQna)try{v=await async function(e){var t,n,o,i;const{environment:r,siteStore:a}=e,s=null===(t=a.getSettings())||void 0===t?void 0:t.siteUserId;if(s)return s;if(!((null===(n=a.getDomainStore())||void 0===n?void 0:n.getDomainName())??(null===(o=b().Nq(a.getSpaceStore()))||void 0===o?void 0:o.domain_name)))throw new Error("no domain on site");const l=b().Ix({spaceStore:a.getSpaceStore(),domainId:null===(i=a.getDomainStore())||void 0===i?void 0:i.id}).split(":")[0],u=`${(0,d().S2)(a.id)}@${l}`,p=await c().callApi({eventName:"createEmailUser",environment:r,data:{email:u}});if("failed"===p.type)throw new Error("failed to create qna user");return p.data.userId}({environment:n,siteStore:a})}catch{return u().V(),void g().D6({label:(0,k.jsx)(s().sA,{id:"siteSettingsEditor.publishChanges.failure",defaultMessage:"Something went wrong, please try again later"})})}const{serverCommitResult:S}=f().createAndCommit({userAction:"publishSite.updateSiteSettingsInEditor",environment:n,canUndo:!0,perform:e=>{if(a&&a.isDefined()){var t,o;(a.getFaviconUrl()||null)!==p.faviconUrl&&(f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateFaviconUrl({faviconUrl:p.faviconUrl,currentUserId:n.currentUser.id})}),m.favicon=p.faviconUrl);(a.getPreviewImageUrl()||null)!==p.previewImageUrl&&(f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updatePreviewImageUrl({previewImageUrl:p.previewImageUrl,currentUserId:n.currentUser.id})}),m.preview_image=p.previewImageUrl);const i=a.getHeader();let r=i;const s=O(p.customHeaderBlockIds,null==i?void 0:i.customItems);s&&(r={...r,customItems:s},m.custom_headers=s.map((e=>e.blockId))),(null==i?void 0:i.hideBreadcrumbs)!==p.hideBreadcrumbs&&(r={...r,hideBreadcrumbs:p.hideBreadcrumbs},m.hide_breadcrumbs=p.hideBreadcrumbs),(null==i?void 0:i.hideSearch)!==p.hideSearch&&(r={...r,hideSearch:p.hideSearch},m.hide_search=p.hideSearch),(null==i?void 0:i.hideShare)!==p.hideShare&&(r={...r,hideShare:p.hideShare},m.hide_share=p.hideShare),(null==i?void 0:i.hideWatermark)!==p.hideWatermark&&(r={...r,hideWatermark:p.hideWatermark},m.hide_watermark=p.hideWatermark),r&&i!==r&&f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateHeader({header:r,currentUserId:n.currentUser.id})});a.getGoogleAnalyticsId()!==p.googleAnalyticsId&&(f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateGoogleAnalyticsId({googleAnalyticsId:p.googleAnalyticsId,currentUserId:n.currentUser.id})}),m.google_analytics_id=p.googleAnalyticsId);(null===(t=a.getSettings())||void 0===t?void 0:t.theme)!==p.theme&&(f().applyOperation({transaction:e,store:a,operation:a.getModel().ops.updateTheme({theme:p.theme,currentUserId:n.currentUser.id})}),m.theme=p.theme);(null===(o=a.getSettings())||void 0===o?void 0:o.enableQna)!==p.enableQna&&(p.enableQna?v&&f().applyOperation({transaction:e,store:a,operation:{pointer:a.pointer,command:"update",path:["settings"],args:{enableQna:p.enableQna,siteUserId:v}}}):f().applyOperation({transaction:e,store:a,operation:{pointer:a.pointer,command:"update",path:["settings"],args:{enableQna:p.enableQna}}}))}}});try{await S}catch{return u().V(),void g().D6({label:(0,k.jsx)(s().sA,{id:"siteSettingsEditor.publishChanges.failure",defaultMessage:"Something went wrong, please try again later"})})}if((null===(t=p.permissionItem)||void 0===t?void 0:t.allow_duplicate)!==p.enableDuplicateAsTemplate&&p.permissionItem&&p.from){const e=(0,o().Yi)(p.from);if(!(await(0,y().Hc)({oldPermissionItem:p.permissionItem,newPermissionItem:{...p.permissionItem,allow_duplicate:p.enableDuplicateAsTemplate},wasInherited:e!==i.id,environment:n,store:i,sudoModeStore:p.sudoModeStore,location:"published_site_settings"})))return u().V(),void g().D6({label:(0,k.jsx)(s().sA,{id:"siteSettingsEditor.publishChanges.failure",defaultMessage:"Something went wrong, please try again later"})});m.enable_duplicate_as_template=p.enableDuplicateAsTemplate}u().V(),(0,w().Kz)(n,{settings_changed:m}),g().D6({label:(0,k.jsx)(s().sA,{id:"siteSettingsEditor.publishChanges.confirmation",defaultMessage:"Changes published"})})}function O(e,t){const n=e.map((e=>({type:"block",blockId:e})));if((t||0!==n.length)&&(!t||!(0,l().n4)(n,t)))return n}function E(e){A().A.setState({...A().A.state,faviconUrl:e})}function U(e){A().A.setState({...A().A.state,previewImageUrl:e})}function F(e){A().A.setState({...A().A.state,hideBreadcrumbs:e})}function V(e){A().A.setState({...A().A.state,hideSearch:e})}function z(e){A().A.setState({...A().A.state,hideWatermark:e})}function K(e){A().A.setState({...A().A.state,hideShare:e})}function W(e){A().A.setState({...A().A.state,enableDuplicateAsTemplate:e})}function H(e){const t=A().A.state.customHeaderBlockIds.concat([e]);A().A.setState({...A().A.state,customHeaderBlockIds:t})}function G(e){const t=A().A.state.customHeaderBlockIds.filter((t=>t!==e));A().A.setState({...A().A.state,customHeaderBlockIds:t})}function Y(e){A().A.setState({...A().A.state,googleAnalyticsId:e})}function q(e){A().A.setState({...A().A.state,theme:e})}async function $(e){const{environment:t,spaceStore:n,query:o,siteRootBlockId:i}=e;if(!n)return;const r=await c().callApi({eventName:"searchPagesInSite",environment:t,data:{query:o,spaceId:n.id,filters:a().N2({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,editedBy:[],ancestors:[i],inTeams:[]}),sort:{field:"relevance"},limit:10}});return"failed"!==r.type?r.data:void 0}async function Q(e){const{environment:t,blockStore:n,slug:o}=e,i=await c().callApi({eventName:"updatePublicPageSlug",environment:t,data:{spaceId:n.getSpaceId(),blockId:n.id,slug:o,clientVersion:h().A.version}});if("success"!==i.type)return{error:i};g().D6({label:(0,k.jsx)(s().sA,{id:"customSlugInput.updateSuccess.toast",defaultMessage:"Successfully updated URL for this page"})})}function Z(e){A().A.setState({...A().A.state,enableQna:e})}function X(e){const{environment:t,store:n,pageVisitSource:o}=e,i=S().R({store:n,pageVisitSource:o});m().f({environment:t,url:i})}function J(e){const{environment:t,siteStore:n,embedSettings:o}=e;f().createAndCommit({userAction:"embedSite.updateEmbedSettings",environment:t,canUndo:!0,perform:e=>{p().zv({store:n.getSettingsStore(),data:{embedSettings:o},transaction:e})}})}},529324:(e,t,n)=>{n.d(t,{C:()=>o});const o=(0,n(340498).xh)("magnifyingGlass",{default:{loader:()=>n.e(1827).then(n.bind(n,901827))},small:{loader:()=>n.e(41805).then(n.bind(n,741805))},mini:{loader:()=>n.e(20283).then(n.bind(n,420283))},large:{loader:()=>n.e(61969).then(n.bind(n,861969))}})},532731:(e,t,n)=>{n.d(t,{F1:()=>h,KQ:()=>d,Wt:()=>p,dB:()=>f,vP:()=>u,wL:()=>c,zD:()=>m});n(944114),n(898992),n(581454),n(908872);var o=()=>n(959013),i=()=>n(33301),r=()=>n(751156),a=()=>n(972435),s=()=>n(806638),l=()=>n(404141);const d=(0,o().YK)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),c={name:a().A.formatMessage(d.empty),iconFn:n(177148).Y,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{r().createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,canUndo:!0,perform:n=>{i().n({environment:e,store:t,transaction:n})}})}},u={name:a().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(948352).M)(e),shouldShow:()=>!0,onClick:e=>{(0,s().P)({environment:e})}},p={name:a().A.formatMessage(d.templates),type:"templates",iconFn:e=>(0,n(926329).b)(e),shouldShow:()=>!0,onClick:e=>{(0,s().P)({environment:e})}},m={name:a().A.formatMessage(d.import),type:"import",iconFn:n(820579).f,shouldShow:()=>!0,onClick:(e,t)=>{const o=n(206267).JW();n(522094).A.setState({flowId:o}),n(559926).kY(e,{from:"new_page",flowId:o}),l().A.setState({...l().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0})}},g=(0,o().YK)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),f=[{name:a().A.formatMessage(g.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{r().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().T({environment:e,store:t,transaction:n})}})}},{name:a().A.formatMessage(g.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{r().createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,canUndo:!0,perform:n=>{i().n({environment:e,store:t,transaction:n})}})}}];function h(e,t){const n=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(n.has(t)&&e.push(n.get(t)),e)),[])}},542371:(e,t,n)=>{n.d(t,{A:()=>o});class o extends(()=>n(757695))().Store{getInitialState(){}}},543950:(e,t,n)=>{n.r(t),n.d(t,{PermissionsInviteWithModal:()=>Me});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(148307),l=()=>n(959013),d=()=>n(534177),c=()=>n(980427),u=()=>n(134696),p=()=>n(701763),m=()=>n(542056),g=()=>n(743260),f=()=>n(299545),h=()=>n(47170),v=()=>n(852507),y=()=>n(38337),b=()=>n(224701),S=()=>n(204063),x=()=>n(159026),A=n(474848);const M=function(e){const{permissionsInviteStore:t,onInviteClick:a,inviteOrigin:s,sudoModeStore:d}=e,c=(0,i().v3)(),u=(0,l().tz)(),p=(0,n(58293).r)(),[g,f]=(0,o.useState)(!1),h=(0,r().uB)(void 0,x().Ay),v=(0,r().K8)((()=>t.state.inviteTargets.length>0),[t]),y=(0,o.useCallback)((e=>{e||n(436572).D6({label:(0,A.jsx)(l().sA,{id:"SpacePermissionsInviteButton.handleOnInviteComplete.genericError",defaultMessage:"Invite failed to send"})})}),[]),b=(0,o.useCallback)((async()=>{if(p){f(!0);try{await m().kW({environment:c,store:p,sudoModeStore:d,permissionsInviteStore:t,contextualInviteStore:h,onInviteClick:a,onInviteComplete:y,inviteOrigin:s,intl:u})}catch(e){}finally{f(!1)}}}),[h,c,u,s,a,t,p,d,y]);return(0,A.jsx)(S().A,{onClick:b,disabled:!v||g,children:(0,A.jsx)(l().sA,{id:"spacePermissionsInviteButton.label",defaultMessage:"Send invite"})})};var w=()=>n(554509),k=()=>n(10984);const j=function(e){const{permissionsInviteStore:t}=e,i=(0,r().K8)((()=>(0,k().dL)()),[]),s=(0,o.useCallback)((()=>{t.reset()}),[t]),d=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",gap:8},header:{display:"flex",justifyContent:"space-between"}})),[]);return(0,A.jsxs)("div",{style:d.container,children:[(0,A.jsxs)("div",{style:d.header,children:[(0,A.jsx)(w().D,{styleName:"Heading-17px/Semibold",children:(0,A.jsx)(l().sA,{id:"spacePermissionsInviteHeader.title",defaultMessage:"Invite members"})}),(0,A.jsx)(n(398208).A,{onClose:s})]}),(0,A.jsx)(n(125565).A,{isSecondaryColor:!0,isMultiline:!0,children:i?(0,A.jsx)(l().sA,{id:"spacePermissionsInviteHeader.freeDescription",defaultMessage:"Type or paste in emails below, separated by commas"}):(0,A.jsx)(l().sA,{id:"spacePermissionsInviteHeader.billedDescription",defaultMessage:"Type or paste in emails below, separated by commas. Your workspace will be billed by members."})})]})};var C=()=>n(456328),I=()=>n(623580);function T(e){const t=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:6,alignSelf:"stretch"}})),[]);return(0,A.jsxs)("div",{style:t.container,children:[(0,A.jsx)(w().D,{styleName:"UISmall-12px/Medium",colorName:"secondary",children:(0,A.jsx)(l().sA,{id:"spacePermissionsInviteMessageSection.label",defaultMessage:"Message"})}),(0,A.jsx)(_,{...e})]})}function _(e){const{permissionsInviteStore:t}=e,{emailMessage:n}=(0,r().K8)((()=>({emailMessage:t.state.emailMessage})),[t]),i=(0,l().tz)().formatMessage({id:"shareMenu.spacePermissionsInviteMessageInput.placeholder",defaultMessage:"Add a note to your invite..."}),a=1e3,s=n.length/a>=.8,d=(0,C().BS)(n),c=s||d,u=(0,o.useCallback)((e=>{t.setState({...t.state,emailMessage:e.target.value})}),[t]);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(I().A,{textarea:!0,focusInitial:!1,placeholder:i,maxlength:a,value:n,onChange:u}),c&&(0,A.jsx)(P,{messageLength:n.length,maxLength:a,shouldShowLengthWarning:s,shouldShowLinkWarning:d})]})}function P(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,messageLength:o,maxLength:i}=e;return(0,A.jsxs)(w().D,{styleName:"UISmall-12px/Medium",colorName:"tertiary",children:[t&&(0,A.jsx)(l().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:o,maxCharacters:i}}),t&&n&&" · ",n&&(0,A.jsx)(l().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})}n(944114),n(581454);var B=()=>n(668725),L=()=>n(760217),R=()=>n(406699),D=()=>n(928600),N=()=>n(939740),O=()=>n(897119),E=()=>n(89924),U=()=>n(747788),F=()=>n(103448),V=()=>n(722872),z=()=>n(553965),K=()=>n(731320),W=()=>n(962730),H=()=>n(991249),G=()=>n(643908),Y=()=>n(134217);function q(e){const{permissionsInviteStore:t}=e,n=(0,i().v3)(),s=(0,r().K8)((()=>{const e=(0,k().AI)();return(0,Y().fk)(e)}),[]);(0,v().l)((()=>{s||t.setState({...t.state,inviteTargets:[],inviteRole:"read_and_write"})}));const d=(0,r().K8)((()=>t.state.inviteRole?t.state.inviteRole:s?"editor":"read_and_write"),[s,t]),c=(0,r().K8)((()=>{const e=["editor"];return(0,K().Qu)()&&e.push("membership_admin"),s||e.push("read_and_write"),e}),[s]),u=(0,o.useCallback)((e=>{m().lf({environment:n,newRole:e,permissionsInviteStore:t})}),[n,t]),p=(0,a().IS)((e=>({menuItem:{width:"100%",backgroundColor:e.inputBackground,borderRadius:6,boxShadow:"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px inset"},dropdownButton:{display:"flex",minHeight:34,margin:0,width:"100%"},dropdownButtonContent:{display:"flex",alignItems:"center"},selectedRole:{width:"100%",color:e.text.secondary},downIcon:{width:10,marginLeft:4,fill:e.icon.tertiary}})),[]);function g(e){const t=c.map((t=>({key:t,render:e=>{const n=(0,U().R)({type:"space_permission",table:"space",role:t,isRemovable:!1,isCurrentUser:!1});return(0,A.jsx)(L().A,{title:(0,A.jsx)(l().sA,{...n.label}),caption:(0,A.jsx)(l().sA,{...n.caption}),shouldWrapCaption:!0,...e})},action:()=>{u(t),e.close()}})));return s&&t.push({key:"read_and_write",render:e=>(0,A.jsx)($,{menuListItemProps:e}),action:()=>{e.close()}}),t}return(0,A.jsx)(R().Ay,{popupType:O().nl.Popup,sameWidthAsOrigin:!0,render:e=>(0,A.jsx)(D().A,{menuType:V().gu.Popup,children:(0,A.jsx)(N().Ay,{type:N().Oh.Vertical,initialFocus:void 0,sections:[{key:"roles",render:e=>(0,A.jsx)(E().A,{...e}),items:g(e)}]})}),renderOrigin:e=>(0,A.jsx)(L().A,{style:p.menuItem,buttonStyle:p.dropdownButton,title:(0,A.jsxs)("div",{style:p.dropdownButtonContent,children:[(0,A.jsx)("div",{style:p.selectedRole,children:(0,A.jsx)(w().D,{styleName:"UIRegular-14px/Regular",children:(0,A.jsx)(l().sA,{...(0,U().R)({type:"space_permission",table:"space",role:d,isRemovable:!1,isCurrentUser:!1}).label})})}),(0,B().b)(p.downIcon)]}),focused:!1,...e})})}function $(e){let{menuListItemProps:t}=e;const n=(0,i().v3)(),r=(0,a().IS)((()=>({titleContainer:{display:"flex",alignItems:"center"},titleLabel:{marginRight:6}})),[]),d="space_permission_settings",c="plus",u=(0,o.useCallback)((()=>{(0,H().K)(n,{from:d,upsell:{type:"product",product:c,limit:{type:"none"},trialability:"none"}})}),[n]),p=(0,A.jsx)(F().A,{imageURL:s().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,A.jsx)(l().sA,{defaultMessage:"Members cannot change workspace settings or invite new members.",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.caption"}),title:(0,A.jsx)(l().sA,{defaultMessage:"Upgrade to add non-admin members",id:"spacePermissionsInviteRoleSection.spaceReadAndWriteUpgradeTooltip.title"})});return(0,A.jsx)(G().A,{requireUpgradeToTier:c,renderUpgradeTooltip:()=>p,analyticsName:d,tooltipPlacement:W().W.Left,render:(e,n)=>{const{focused:o,...i}=(0,z().A)(t,e),a=(0,U().R)({type:"space_permission",table:"space",role:"read_and_write",isRemovable:!1,isCurrentUser:!1});return(0,A.jsx)(L().A,{...i,title:(0,A.jsxs)("div",{style:r.titleContainer,children:[(0,A.jsx)("div",{style:r.titleLabel,children:(0,A.jsx)(l().sA,{...a.label})}),n]}),caption:(0,A.jsx)(l().sA,{...a.caption}),shouldWrapCaption:!0,focused:o})},onClick:u})}const Q=function(e){const t=(0,a().IS)((e=>({container:{display:"flex",flexDirection:"column",width:"100%",gap:8},roleText:{color:e.text.secondary}})),[]);return(0,A.jsxs)("div",{style:t.container,children:[(0,A.jsx)(w().D,{styleName:"UISmall-12px/Medium",customStyles:t.roleText,children:(0,A.jsx)(l().sA,{id:"spacePermissionsInviteRoleSection.label",defaultMessage:"Role"})}),(0,A.jsx)(q,{...e})]})};const Z=function(e){const{inviteOrigin:t,onInviteClick:s,permissionsInviteStore:l}=e,d=(0,i().v3)();(0,v().l)((async()=>{await b().x(d)}));const c=(0,o.useCallback)((()=>{l.setState({...l.state,inputFocus:"none"})}),[l]),u=(0,a().IS)((()=>({container:{width:460},body:{display:"flex",flexDirection:"column",gap:20,width:"100%"},footer:{display:"flex",justifyContent:"end"}})),[]),p=(0,r().K8)((()=>(0,n(807778).cF)()),[]);return(0,A.jsx)("div",{style:u.container,onClick:c,className:y().bFE,children:(0,A.jsx)(n(7674).tf,{header:(0,A.jsx)(j,{permissionsInviteStore:l}),footer:(0,A.jsx)("div",{style:u.footer,children:(0,A.jsx)(M,{inviteOrigin:t,onInviteClick:s,permissionsInviteStore:l})}),children:(0,A.jsxs)("div",{style:u.body,children:[(0,A.jsx)(n(334013).A,{permissionsInviteStore:l}),(0,A.jsx)(Q,{permissionsInviteStore:l}),p&&(0,A.jsx)(T,{permissionsInviteStore:l})]})})})};var X=()=>n(183804),J=()=>n(406792),ee=()=>n(957599),te=()=>n(749240),ne=()=>n(433876),oe=()=>n(381349),ie=()=>n(496603),re=()=>n(836251),ae=()=>n(640653),se=()=>n(630116),le=()=>n(960236),de=()=>n(962036),ce=()=>n(912913),ue=()=>n(654856),pe=()=>n(263919);function me(e){const{store:t,permissionsInviteStore:s,membersOnly:d,onUpgradeButtonClick:c,upgradeButtonName:u,inviteOrigin:p,onInviteClick:g}=e,h=(0,i().v3)();(0,v().l)((async()=>{await b().x(h)}));const S=(0,r().K8)((()=>(0,f().Yu)(t)),[t]),x=(0,o.useCallback)((async()=>{await m().iS({environment:h,permissionsInviteStore:s,from:"share_menu"})}),[h,s]),M=(0,a().IS)((()=>({right:{color:oe().Ay.blue}})),[]);return(0,A.jsxs)(D().A,{menuType:V().gu.Modal,title:S?(0,A.jsx)(l().sA,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,A.jsx)(l().sA,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,A.jsx)("div",{style:M.right,children:(0,A.jsx)(l().sA,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,A.jsx)(n(480095).CancelMenuText,{}),onClickLeft:x,onClickRight:g,header:(0,A.jsx)(ge,{...e,inviteOrigin:p,onInviteClick:g}),className:y().bFE,children:[(0,A.jsx)(E().A,{title:(0,A.jsx)(l().sA,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:(0,A.jsx)(ve,{store:t,onUpgradeButtonClick:c,upgradeButtonName:u,permissionsInviteStore:s})}),(0,A.jsx)("div",{children:(0,A.jsx)(fe,{store:t,permissionsInviteStore:s,membersOnly:d})}),(0,A.jsx)(he,{})]})}function ge(e){const{store:t,isSubscribed:n,onInviteClick:a,permissionsInviteStore:s,inviteOrigin:l}=e,d=(0,i().v3)(),c=(0,r().K8)((()=>g().LC({environment:d,store:t,isSubscribed:n})),[d,t,n]),p=(0,r().K8)((()=>{const e=s.state.inputFocus;return"invitee"===e||"invitee-popup-closed"===e}),[s]),f=(0,h().O)(),v=(0,le().lI)({spaceId:f}),y=(0,o.useMemo)((()=>ie().sg((()=>{u().D2(d,{invite_flow_id:s.state.flowId,billingData:v,invite_origin:l})}),1e3)),[d,s,l,v]),b=(0,o.useCallback)((async e=>{y(),await m().Pp({environment:d,event:e,permissionsInviteStore:s})}),[y,d,s]),S=(0,o.useCallback)((e=>{m().St({targetToRemove:e,permissionsInviteStore:s,defaultRoleForNonBot:c})}),[c,s]);return(0,A.jsx)(ue().A,{permissionsInviteStore:s,store:t,handleClickRemoveToken:S,handleInputChange:b,handleInputSubmit:a,origin:"share_modal",defaultRoleForNonBot:c,focus:p,handleFocus:()=>{}})}function fe(e){const{store:t,permissionsInviteStore:n,membersOnly:o}=e,i=(0,r().K8)((()=>(0,f()._p)(t)),[t]),a=(0,r().K8)((()=>t instanceof se().Bv&&(0,ae().hN)(t.getSpaceStore())),[t]);return(0,A.jsx)(pe().A,{permissionsInviteStore:n,store:t,shouldShowGroups:i,sectionRenderLimit:10,membersOnly:o,guestsMustBeRequested:a})}function he(){return(0,A.jsx)(E().A,{topBorder:!0,disableDesktopPadding:!0,children:(0,A.jsx)(de().A,{title:(0,A.jsx)(l().sA,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,re().xS)("guides.invitePerson"),analyticsFrom:"invite_person"})})}function ve(e){const t=(0,i().v3)(),{store:n,onUpgradeButtonClick:s,upgradeButtonName:l,permissionsInviteStore:d}=e,{inviteRole:c,table:u}=(0,r().K8)((()=>{const{inviteRole:e}=d.state;return{inviteRole:e,table:n.table}}),[d,n.table]),p=(0,r().K8)((()=>(0,f()._p)(n)?n.getType():void 0),[n]),g=(0,r().K8)((()=>(0,f().Yu)(n)&&!n.canAdmin()),[n]),h=(0,o.useCallback)((e=>{m().lf({environment:t,newRole:e,permissionsInviteStore:d})}),[t,d]),v=(0,a().IS)((()=>({button:{display:"flex",whiteSpace:"nowrap",height:26,color:oe().Ay.uiGray}})),[]);return c?(0,A.jsx)(ce().Ay,{disabled:g,role:c,table:u,type:"user_permission",blockType:p,isInvite:!0,onUpgradeButtonClick:s,upgradeButtonName:l,buttonStyle:v.button,isMenuItem:!0,onChange:h}):null}const ye=o.memo(me);var be=()=>n(430102),Se=()=>n(887080);function xe(e){const{store:t,origin:c,sudoModeStore:u,onInviteComplete:p,onInviteClick:v}=e,y=(0,i().v3)(),{isMobile:S}=y.device,M=(0,l().tz)(),w=(0,h().O)(),j=(0,n(714300).l)({spaceId:w}),C=(0,r().uB)(e.permissionsInviteStore,n(986229).A),I=(0,r().K8)((()=>C.state.modalOpen),[C]),T=e.analyticsFrom,_=(0,r().uB)(void 0,x().Ay),P=(0,o.useCallback)((async()=>{const e=J().default.DO_NOT_USE_markLegacy("share_menu.invite_user_lag");await m().kW({environment:y,store:t,sudoModeStore:u,permissionsInviteStore:C,contextualInviteStore:_,onInviteClick:v,onInviteComplete:p,inviteOrigin:T,intl:M}),J().default.DO_NOT_USE_measureLegacy(e,{environment:y})}),[y,t,u,C,_,v,p,T,M]);(0,o.useEffect)((()=>{I&&!(0,d().O9)(te().subscriptionDataStoreInstance.state)&&b().x(y)}),[y,I]);const B=(0,r().K8)((()=>Boolean(t.canEditMembership())),[t]),L=(0,r().K8)((()=>B&&(0,f().Yu)(t)&&(0,d().O9)(te().subscriptionDataStoreInstance.state)&&!k().El()),[B,t]),R=(0,r().K8)((()=>function(e){let{store:t,canEditMembership:n,showUpgrade:o}=e;if(!n&&(0,f().Yu)(t))return(0,A.jsx)(l().sA,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."});if(!n)return(0,A.jsx)(l().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."});if(o)return(0,A.jsx)(F().A,{imageURL:s().A.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,A.jsx)(l().sA,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,A.jsx)(l().sA,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})});return null}({store:t,canEditMembership:B,showUpgrade:L})),[B,L,t]),D=(0,o.useCallback)((()=>async function(e,t,n,o){const i=await(0,g().iQ)({environment:e,permissionsInviteStoreState:n.state,from:o??((0,f().Yu)(t)?"space_share_modal":"page_share_modal")});i||n.reset()}(y,t,C,e.analyticsFrom)),[y,t,C,e.analyticsFrom]),N=(0,o.useCallback)((()=>S?(0,A.jsx)(ye,{...e,onInviteClick:P,inviteOrigin:T,permissionsInviteStore:C,billingData:j}):(0,A.jsx)(Z,{inviteOrigin:T,onInviteClick:P,permissionsInviteStore:C})),[S,e,P,T,C,j]),O=(0,a().IS)((()=>({modal:{display:"flex",alignSelf:"center",top:0}})),[]);return(0,f().Yu)(t)?(0,A.jsx)(ne().A,{open:I,onDismiss:D,renderContent:N,modalStyle:O.modal,origin:(0,A.jsx)(n(859428).A,{renderTooltip:()=>R,disableTooltip:B,render:t=>(0,A.jsx)(Ae,{permissionsInviteStore:C,tooltipEvents:t,actionEnabled:B,showUpgrade:L,buttonInner:c,...e,...t})})}):(0,A.jsx)(ne().A,{open:I,onDismiss:D,renderContent:N,origin:null})}function Ae(e){let{tooltipEvents:t,showUpgrade:n,actionEnabled:s,store:d,isSubscribed:m,enableInviteDropdown:f,onInviteClick:h,onInviteComplete:v,upgradeButtonName:y,onUpgradeButtonClick:b,shouldGrow:x,buttonStyle:M,permissionsInviteStore:w,buttonInner:k}=e;const j=(0,i().v3)(),{forceImportDropdownOpen:C,shouldAddMembers:I}=(0,r().K8)((()=>ee().F.getState()),[]),T=(0,a().IS)((()=>({dropdownButton:{flex:x?1:0,...M},importListButton:{height:28,borderRadius:4,border:void 0,width:"100%"},importListButtonContainer:{padding:"0 6px",alignItems:"center"}})),[M,x]),_=(0,o.useCallback)((()=>function(e,t,n,o){(0,g().LH)({environment:e,permissionsInviteStore:o,store:t,renderInShareModal:!1,isSubscribed:n}),p().CW(e,{type:"invite"}),u().vX(e,{type:"invite",from:"settings_modal"})}(j,d,m,w)),[j,d,m,w]),P=(0,o.useCallback)((()=>n?function(e,t,n){H().K(t,{from:e,upsell:{type:"product",product:"plus",limit:{type:"none"},trialability:"none"}}),n&&n(),p().CW(t,{type:"upgrade"})}(y,j,b):_()),[j,_,b,n,y]);if(k)return(0,A.jsx)("div",{onClick:_,children:k});const B=(0,X().A)({onInviteClick:h,onInviteComplete:v,buttonStyle:T.importListButton,buttonContainerStyle:T.importListButtonContainer,shouldAddMembers:I});return f?(0,A.jsx)(R().Ay,{open:!!C||void 0,popupType:O().nl.Popup,alignmentToOrigin:R().yP.End,placementToOrigin:R().sx.Bottom,render:()=>(0,A.jsx)(Se().A,{importListItems:B}),originGap:12,onClose:()=>{C&&ee().F.closeImportDropdown()},renderOrigin:e=>(0,A.jsx)(be().I,{disabled:!s&&!n,style:T.dropdownButton,title:(0,A.jsx)(l().sA,{id:"inviteUserButton.addMemberLabel.dropdown",defaultMessage:"Add members"}),onClick:P,onDropdownClick:()=>{e.onClick(),c().V(j,{source:"add_members_button"})},color:"blue"})}):(0,A.jsx)(S().A,{size:"lg",onClick:P,disabled:!s&&!n,style:T.dropdownButton,...t,children:(0,A.jsx)(l().sA,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})}const Me=o.memo(xe)},552445:(e,t,n)=>{n.d(t,{N:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("pin",{viewBox:"0 0 13 19",svg:(0,o.jsx)("path",{d:"M1.25 12.875h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.304-3.359-4.109L8.617 4c.992-.648 1.93-1.383 2.328-1.914.211-.266.305-.531.305-.758 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .227.093.492.297.758.398.531 1.343 1.266 2.328 1.914L3.46 7.664C1.42 8.47.1 10.125.1 11.774c0 .664.446 1.101 1.149 1.101zm4.922-5.719c-.5 0-.984.047-1.438.14l.235-3.874c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102 0-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.969.867-2.14 1.468-.071.04-.095.079-.079.188l.234 3.875a7.177 7.177 0 00-1.437-.14zm-4.61 4.54c-.18 0-.257-.102-.226-.313.172-1.406 1.969-3.086 4.836-3.086 2.86 0 4.656 1.68 4.828 3.086.031.21-.047.312-.227.312h-9.21z"})})},554778:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Le});var o=n(296540),i=()=>n(662303),r=()=>n(56366),a=()=>n(604995),s=()=>n(416504),l=()=>n(971404),d=()=>n(959013),c=()=>n(780054),u=()=>n(722872),p=()=>n(963589),m=()=>n(691298),g=()=>n(838364),f=()=>n(117586),h=()=>n(594739),v=()=>n(805751),y=()=>n(928600),b=()=>n(480095),S=()=>n(89924),x=()=>n(597777),A=()=>n(760217),M=()=>n(946548),w=n(474848);function k(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("date"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:"00:00",time_zone:(0,s().P)(),reminder:(0,x().Lh)(t)?x().ex(t.reminder):void 0};null==n||n(e)}else if("daterange"===t.type){const e={type:"datetimerange",start_date:t.start_date,start_time:"00:00",end_date:t.end_date,end_time:"00:00",time_zone:(0,s().P)(),reminder:(0,x().Lh)(t)?x().ex(t.reminder):void 0};null==n||n(e)}else if("datetime"===t.type){const e={type:"date",start_date:t.start_date,reminder:(0,x().Lh)(t)?x().vW(t.reminder,(0,s().P)()):void 0};null==n||n(e)}else{const e={type:"daterange",start_date:t.start_date,end_date:t.end_date,reminder:(0,x().Lh)(t)?x().vW(t.reminder,(0,s().P)()):void 0};null==n||n(e)}}),[t,n]);return(0,w.jsx)(A().A,{focused:!1,onClick:i,title:(0,w.jsx)(d().sA,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,w.jsx)(M().A,{on:"date"!==t.type&&"daterange"!==t.type,onClick:i})})}var j=()=>n(244641),C=()=>n(595555),I=()=>n(484714),T=()=>n(401497),_=()=>n(381349),P=()=>n(534177),B=()=>n(284371),L=()=>n(541181),R=()=>n(805025),D=()=>n(807778),N=()=>n(704152),O=()=>n(493823),E=()=>n(498140),U=()=>n(458366);const F=Object.freeze({backgroundColor:_().Ay.blue,color:_().Ay.white}),V=Object.freeze({backgroundColor:_().Ay.blueWithAlpha(.43)});function z(e,t){switch(e){case f().dz.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case f().dz.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case f().dz.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}function K(e,t,n){return void 0===e||"relative"===e||"ll"===e?x().WA($(n,t)):x().c1(e)}function W(e,t){return e&&(e!==x().jk||t)?x().B4(e):x()._g}function H(){return(0,l().X)(i().locale).time}function G(e,t,n){return(0,E().FM)(e,W(t,!1),n)}function Y(e,t,n,o,i){return o.device.isMobile?(0,E().yc)(e,a().tr,t):(0,E().yc)(e,K(n,t,i),t)}function q(e,t,n,o){return!e||"number"==typeof e&&isNaN(e)?t&&(0,U().NN)(t)?function(e,t){var n,o;const i=(null==t||null===(n=t.getPropertyTypeSpecificConfig("date"))||void 0===n?void 0:n.endDate)??!1,r=(null==t||null===(o=t.getPropertyTypeSpecificConfig("date"))||void 0===o?void 0:o.includeTime)??!1,l=a().vF({timezone:(0,s().P)()});if(i&&r)return a().NC(l.startOf("day").valueOf(),l.startOf("day").valueOf(),(0,s().P)());if(i)return a().Mk(l.valueOf(),l.valueOf(),(0,s().P)());if(r)return a().Xo(l.startOf("day"));return e}(n,o):n:e}function $(e,t){return e||t.locale}function Q(e,t,n){return"date"===e.type?{...e,type:"daterange",end_date:t||e.start_date}:"datetime"===e.type?{...e,type:"datetimerange",end_date:t||e.start_date,end_time:n||e.start_time}:void(0,P().HB)(e)}function Z(e){let{store:t,dateValue:n,disabled:l,firstDayOfWeek:c,onChangeValue:m}=e;const g=(0,I().v3)(),h=(0,I().Y0)(),v=(0,u().Tf)(),y=(0,p().X)("nds_datepicker_refresh"),b=(0,r().K8)((()=>(0,D().D$)(g)),[g]),{focus:S,currentMonth:A}=(0,r().K8)((()=>({focus:t.state.focus,currentMonth:t.state.currentMonth})),[t]),M=(0,T().IS)((e=>({container:{textAlign:"center",...h.isMobile?{padding:"16px 14px 16px",background:e.popoverBackground,...!v&&{borderBottom:`1px solid ${e.regularDividerColor}`}}:{padding:y?`0 ${R().Qm}px`:"4px 0 4px"}},todayButton:{width:43,height:20},button:{background:"none",border:"none",cursor:"pointer",padding:0,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3},navButtonSize:{width:20,height:20},navButton:{width:"11px",height:"17px",color:_().Ay.uiGray}})),[h.isMobile,v,y]),k=a().AA(n,(0,s().P)()),E=A||k.start,U=k.start.toJSDate(),z=S===f().xQ.StartDate||S===f().xQ.StartTime,K=(0,o.useCallback)(((e,o,i)=>{if(l)return;const r=j().c9.fromJSDate(e).setLocale(x().M5).toFormat(a().tr);if(i.shiftKey&&("date"===n.type||"datetime"===n.type)){const e=Q(n,r);return null==m||m(e),void t.setState({...t.state,focus:f().xQ.EndDate})}let d;if(x().oM(n)||x().L3(n)){S===f().xQ.StartDate||S===f().xQ.StartTime?d={...n,start_date:r}:S===f().xQ.EndDate||S===f().xQ.EndTime?d={...n,end_date:r}:(0,P().HB)(S);const e=a().AA(d,(0,s().P)());e.end<e.start&&(x().oM(d)?d={...d,start_date:d.end_date,end_date:d.start_date}:x().L3(d)?d={...d,start_date:d.end_date,start_time:d.end_time,end_date:d.start_date,end_time:d.start_time}:(0,P().HB)(d),t.setState({...t.state,focus:S===f().xQ.StartDate||S===f().xQ.StartTime?f().xQ.EndDate:f().xQ.StartDate})),t.setState({...t.state,focus:S===f().xQ.StartDate||S===f().xQ.StartTime?f().xQ.EndDate:f().xQ.StartDate})}else d={...n,start_date:r};t.setState({...t.state,error:{...t.state.error,[S]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[S]:void 0}}),null==m||m(d)}),[n,l,S,m,t]),W=(0,o.useCallback)((e=>{t.setState({...t.state,currentMonth:j().c9.fromJSDate(e)})}),[t]),H=(0,o.useMemo)((()=>({todayButtonLabel:{id:"datePicker.todayButton.label",defaultMessage:"Today",description:"Label for the button that selects today's date in the calendar"},previousMonthLabel:{id:"datePicker.previousMonth.label",defaultMessage:"Go to previous month",description:"Aria label for the button that navigates to the previous month"},nextMonthLabel:{id:"datePicker.nextMonth.label",defaultMessage:"Go to next month",description:"Aria label for the button that navigates to the next month"}})),[]),G=(0,o.useMemo)((()=>{if(k.end){const e=k.end.toJSDate();return{modifiers:{range:{from:U,to:e},...z?{end:e,start:U}:{start:U,end:e}},modifiersStyles:{range:{backgroundColor:y?"transparent":_().Ay.blueWithAlpha(.15)},start:z?F:V,end:z?V:F}}}return{selected:U,modifiers:{start:U},modifiersStyles:{start:F}}}),[k.end,U,z,y]),Y=(0,o.useCallback)((e=>(0,w.jsx)("div",{className:"notion-calendar-caption",children:(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,w.jsx)(C().$J,{displayMonth:e.displayMonth}),(0,w.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,w.jsx)(O().p,{onClick:e=>{W(j().c9.now().toJSDate()),K(j().c9.now().toJSDate(),{},e)},isGray:!0,style:{...M.button,...M.todayButton,fontSize:12,fontWeight:B().Wy.medium},children:(0,w.jsx)(d().sA,{...H.todayButtonLabel})}),(0,w.jsx)(N().A,{onClick:()=>W(j().c9.fromJSDate(e.displayMonth).minus({months:1}).toJSDate()),style:{...M.button,...M.navButtonSize},"aria-label":H.previousMonthLabel.defaultMessage,children:(0,w.jsx)(C().Bu,{style:M.navButton})}),(0,w.jsx)(N().A,{onClick:()=>W(j().c9.fromJSDate(e.displayMonth).plus({months:1}).toJSDate()),style:{...M.button,...M.navButtonSize},"aria-label":H.nextMonthLabel.defaultMessage,children:(0,w.jsx)(C()._l,{style:M.navButton})})]})]})})),[K,M.button,M.navButtonSize,M.todayButton,M.navButton,W,H.nextMonthLabel,H.previousMonthLabel,H.todayButtonLabel]);return(0,w.jsx)("div",{style:M.container,children:b?(0,w.jsx)(L().n,{className:"notion-date-property-menu notranslate",components:{Caption:Y},numberOfMonths:1,weekStartsOn:c,defaultMonth:E.toJSDate(),month:E.toJSDate(),locale:i().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:K,onMonthSelected:W,...G}):(0,w.jsx)(L().n,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:c,defaultMonth:E.toJSDate(),month:E.toJSDate(),locale:i().locale,showOutsideDays:!0,fixedWeeks:!0,onDayClick:K,onMonthSelected:W,...G})})}function X(e){let{onChangeValue:t}=e;const n=(0,o.useCallback)((()=>{null==t||t(void 0)}),[t]);return(0,w.jsx)(A().A,{focused:!1,onClick:n,title:(0,w.jsx)(d().sA,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}function J(e){let{dateValue:t,onChangeValue:n}=e;const i=(0,o.useCallback)((()=>{if("datetimerange"===t.type){const e={type:"datetime",start_date:t.start_date,start_time:t.start_time,time_zone:t.time_zone,reminder:t.reminder};null==n||n(e)}else if("daterange"===t.type){const e={type:"date",start_date:t.start_date,reminder:t.reminder};null==n||n(e)}else{const e=Q(t);null==n||n(e)}}),[t,n]);return(0,w.jsx)(A().A,{focused:!1,onClick:i,title:(0,w.jsx)(d().sA,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,w.jsx)(M().A,{on:"daterange"===t.type||"datetimerange"===t.type,onClick:i})})}n(581454);var ee=()=>n(656704),te=()=>n(869190),ne=()=>n(68913),oe=()=>n(496603),ie=()=>n(679924);var re=()=>n(406699),ae=()=>n(113474),se=()=>n(939740),le=()=>n(8980);function de(e){let{dateValue:t,onChangeValue:n,defaultReminder:i}=e;const r=(0,p().X)("nds_datepicker_refresh"),a=(0,I().v3)(),l=c().A.isMobile,m=(0,d().tz)(),g=(0,p().X)("db_ux_mobile"),f=(0,p().X)("enable_no_reminder_setting"),h=(0,o.useCallback)((e=>{x().Mb(e)?f?null==n||n({...t,reminder:e}):null==n||n({...t,reminder:void 0}):x().fc(e)?null==n||n({...t,reminder:{...e,defaultTimeZone:(0,s().P)()}}):"datetime"!==t.type&&"datetimerange"!==t.type||null==n||n({...t,reminder:e}),function(e,t){(0,ie().v)(e,"set_reminder",{date:t.date,reminder:t.reminder})}(a,{date:t,reminder:e})}),[t,a,n,f]),v=(0,o.useCallback)((e=>(0,w.jsx)(ae()._,{...e,icon:r?void 0:(0,w.jsx)(le().I,{icon:ne().alarmIcon}),title:(0,w.jsx)(d().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:l,chevronType:"right",right:(0,ee().y)({reminder:void 0===t.reminder?i:t.reminder,intl:m,formatTime:te().fU})})),[t.reminder,l,m,r,i]),M=(0,o.useCallback)((e=>{let n;n=l?{menuType:u().gu.Modal,title:(0,w.jsx)(d().sA,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),...!g&&{right:(0,w.jsx)(b().DoneMenuText,{}),onClickRight:e.close}}:{menuType:u().gu.Popup,width:250};const o=("date"===t.type||"daterange"===t.type?x().vK:x().SA).map((n=>{const o=(0,ee().y)({reminder:n,shouldShowTime:!0,intl:m,formatTime:te().fU});return{key:o,action:()=>{h(n),e.close()},render:e=>{let r;return r=void 0===t.reminder?void 0===i?x().Mb(n):oe().n4(n,i):x().Mb(t.reminder)?x().Mb(n):oe().n4(n,t.reminder),(0,w.jsx)(A().A,{...e,title:o,isChecked:r})}}}));return(0,w.jsx)(y().A,{...n,children:(0,w.jsx)(se().Ay,{type:se().Oh.Vertical,sections:[{key:"reminder section",render:e=>(0,w.jsx)(S().A,{...e}),items:o}],initialFocus:void 0})})}),[t.type,t.reminder,l,m,h,g,i]);return(0,w.jsx)(re().Ay,{popupType:l?g?re().z7.BottomSheet:re().z7.SlideUp:re().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:re().sx.Right,renderOrigin:v,render:M})}function ce(e){let{dateValue:t,defaultReminder:n,shouldShowReminder:o,shouldShowEndDateControl:i,shouldShowAllDayControl:r,onChangeValue:a}=e;return c().A.isMobile?o||i||r?(0,w.jsxs)(S().A,{topBorder:!0,children:[o?(0,w.jsx)(de,{dateValue:t,onChangeValue:a,defaultReminder:n}):void 0,i?(0,w.jsx)(J,{dateValue:t,onChangeValue:a}):void 0,r?(0,w.jsx)(k,{dateValue:t,onChangeValue:a}):void 0]}):null:(0,w.jsxs)(w.Fragment,{children:[o?(0,w.jsx)(S().A,{topBorder:!0,children:(0,w.jsx)(de,{dateValue:t,onChangeValue:a,defaultReminder:n})}):void 0,i||r?(0,w.jsxs)(S().A,{topBorder:!0,children:[i?(0,w.jsx)(J,{dateValue:t,onChangeValue:a}):void 0,r?(0,w.jsx)(k,{dateValue:t,onChangeValue:a}):void 0]}):void 0]})}var ue=()=>n(933117);function pe(e){let{dateFormat:t,onChangeDateFormat:n}=e;const i=(0,p().X)("nds_datepicker_refresh"),r=(0,p().X)("db_ux_mobile"),{isMobile:a}=(0,I().Y0)(),s=(0,d().tz)(),l=t||x().vz,c=(0,o.useCallback)((e=>e),[]),m=(0,o.useCallback)((e=>{null==n||n(e)}),[n]),g=(0,o.useCallback)((e=>(0,w.jsx)(A().A,{...e,title:s.formatMessage(x().xz[e.value])})),[s]),f=(0,o.useCallback)((e=>(0,w.jsx)(ae()._,{...e,focused:!1,title:(0,w.jsx)(d().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),showExtensionArrow:a,chevronType:i?"right":"down",right:l?s.formatMessage(x().xz[l]):(0,w.jsx)(d().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"})})),[l,s,i,a]),h=(0,o.useMemo)((()=>({menuTitle:s.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:x().wJ,getKey:c,selectedItem:l,onSelect:m,renderItem:g,renderOrigin:f})),[l,c,s,m,g,f]);if(i){const e=e=>{const t=x().wJ.map((t=>({key:t,action:()=>{m(t),e.close()},render:e=>(0,w.jsx)(A().A,{...e,title:s.formatMessage(x().xz[t]),isChecked:t===l})})));let n={menuType:u().gu.Popup};return a&&(n={menuType:u().gu.Modal,title:(0,w.jsx)(d().sA,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),...!r&&{right:(0,w.jsx)(b().DoneMenuText,{}),onClickRight:e.close}}),(0,w.jsx)(y().A,{...n,children:(0,w.jsx)(se().Ay,{type:se().Oh.Vertical,initialFocus:void 0,sections:[{key:"date format section",render:e=>(0,w.jsx)(S().A,{...e}),items:t}]})})};return(0,w.jsx)(re().Ay,{popupType:a?re().z7.BottomSheet:re().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:re().sx.Right,renderOrigin:f,render:e})}return(0,w.jsx)(ue().A,{...h})}var me=()=>n(304422);function ge(e){let{dateValue:t,timeFormat:n,onChangeTimeFormat:i}=e;const r=(0,p().X)("nds_datepicker_refresh"),a=(0,p().X)("db_ux_mobile"),{isMobile:s}=(0,I().Y0)(),l=(0,d().tz)(),c="date"===t.type||"daterange"===t.type,m=W(n,!0),g=function(e){const t=W(e,!0),n=H();for(const o in n)if(n[o]===t)return o;return"12h"}(n),f=H(),h=(0,o.useCallback)((e=>e),[]),v=(0,o.useCallback)((e=>{const t=f[e];null==i||i(t)}),[i,f]),M=(0,o.useCallback)((e=>(0,w.jsx)(A().A,{...e,title:l.formatMessage(x().px[e.value])})),[l]),k=(0,o.useCallback)((e=>(0,w.jsx)(ae()._,{...e,focused:!1,title:(0,w.jsx)(d().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:c,showExtensionArrow:s,chevronType:r?"right":"down",right:!c&&(m?l.formatMessage(x().px[g]):(0,w.jsx)(d().sA,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"}))})),[l,c,r,s,g,m]),j=(0,o.useMemo)((()=>({menuTitle:l.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:x().ZD,selectedItem:g,disabled:c,getKey:h,onSelect:v,renderItem:M,renderOrigin:k})),[h,l,c,v,M,k,g]);if(r){if(c)return null;const e=e=>{const t=x().ZD.map((t=>({key:t,action:()=>{v(t),e.close()},render:e=>(0,w.jsx)(A().A,{...e,title:l.formatMessage(x().px[t]),isChecked:t===g})})));let n={menuType:u().gu.Popup};return s&&(n={menuType:u().gu.Modal,title:(0,w.jsx)(d().sA,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.mobileTimeFormatModal.title"}),...!a&&{right:(0,w.jsx)(b().DoneMenuText,{}),onClickRight:e.close}}),(0,w.jsx)(y().A,{...n,children:(0,w.jsx)(se().Ay,{type:se().Oh.Vertical,initialFocus:void 0,sections:[{key:"time format section",render:e=>(0,w.jsx)(S().A,{...e}),items:t}]})})};return(0,w.jsx)(re().Ay,{popupType:s?re().z7.BottomSheet:re().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:re().sx.Right,renderOrigin:k,render:e})}return(0,w.jsx)(ue().A,{...j})}function fe(e){const{dateValue:t,dateFormat:n,timeFormat:r,onChangeDateFormat:c,onChangeTimeFormat:m,onChangeValue:g}=e,f=(0,I().Y0)(),h=!l().V.includes(i().locale),v="date"===t.type||"daterange"===t.type,x="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,s().P)(),M=(0,o.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const n={...t,time_zone:e};null==g||g(n)}}),[t,g]),k=(0,p().X)("db_ux_mobile");return(0,w.jsxs)(w.Fragment,{children:[v?void 0:(0,w.jsx)(me().G,{enableRecents:!0,placementToOrigin:re().sx.Right,currentValue:x,onSelect:M,renderOrigin:e=>(0,w.jsx)(ae()._,{...e,title:(0,w.jsx)(d().sA,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!v&&a().GF(x),chevronType:"right"})}),(0,w.jsx)(re().Ay,{popupType:f.isMobile?k?re().z7.BottomSheet:re().z7.SlideUp:re().z7.Popup,bottomSheetInitialState:"half",placementToOrigin:re().sx.Right,renderOrigin:e=>(0,w.jsx)(A().A,{...e,title:(0,w.jsx)(d().sA,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.label"}),focused:!1,showExtensionArrow:!0}),render:e=>{let o;return o=f.isMobile?{menuType:u().gu.Modal,title:(0,w.jsx)(d().sA,{defaultMessage:"Date format",id:"datePropertyMenuFormatAndTimezone.dateFormat.title"}),...!k&&{right:(0,w.jsx)(b().DoneMenuText,{}),onClickRight:e.close}}:{menuType:u().gu.Popup,width:250},(0,w.jsx)(y().A,{...o,children:(0,w.jsxs)(S().A,{children:[(0,w.jsx)(pe,{dateFormat:n,onChangeDateFormat:c}),h?(0,w.jsx)(ge,{dateValue:t,timeFormat:r,onChangeTimeFormat:m}):void 0]})})}})]})}var he=()=>n(720665),ve=()=>n(962730),ye=()=>n(623580),be=()=>n(859428);const Se=12;function xe(e){let{store:t,disabled:n,locale:i,format:l,dateFormat:c,timeFormat:u,dateValue:m,formQuestionStore:g,onChangeValue:h}=e;const v=(0,I().v3)(),{device:y,WindowSizeStore:b}=v,S=(0,d().tz)(),A=(0,p().X)("nds_datepicker_refresh"),{focus:M,inputTemporaryValue:k,error:j}=(0,r().K8)((()=>({focus:t.state.focus,inputTemporaryValue:t.state.inputTemporaryValue,error:t.state.error})),[t]),{formQuestionHasEndDate:C,formQuestionIncludesTime:_}=(0,r().K8)((()=>{var e,t;return{formQuestionHasEndDate:(null==g||null===(e=g.getPropertyTypeSpecificConfig("date"))||void 0===e?void 0:e.endDate)??!1,formQuestionIncludesTime:(null==g||null===(t=g.getPropertyTypeSpecificConfig("date"))||void 0===t?void 0:t.includeTime)??!1}}),[g]),B=(0,o.useMemo)((()=>a().AA(m,(0,s().P)(),$(i,S))),[m,i,S]),L=l&&(0,U().NN)(l)?_:"datetime"===m.type||"datetimerange"===m.type,D=l&&(0,U().NN)(l)?C:"daterange"===m.type||"datetimerange"===m.type,N=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startDate;if(!e)return;const n=Y(e,S,c,v,i);if(!n)return f().dz.InvalidDate;const o={...m,start_date:n},r=a().Dz(o);if(!r)return f().dz.InvalidRange;t.setState({...t.state,currentMonth:r.start,error:{...t.state.error,[f().xQ.StartDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[f().xQ.StartDate]:void 0}}),null==h||h(o)}),[c,m,v,S,i,h,t]),O=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.startTime;if(!e)return;const n=G(e,u,S);if(!n)return f().dz.InvalidTime;if(x().L3(m)){const{newDate:e,currentMonth:o}=a().uj({previous:m,updatedStartTime:n});t.setState({...t.state,currentMonth:o,error:{...t.state.error,[f().xQ.StartTime]:void 0,[f().xQ.EndDate]:void 0,[f().xQ.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[f().xQ.StartTime]:void 0}}),null==h||h(e)}else{if(!x().Ar(m))return f().dz.InvalidTime;{const e={...m,start_time:n},o=a().Dz(e);t.setState({...t.state,currentMonth:o.start,error:{...t.state.error,[f().xQ.StartTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[f().xQ.StartTime]:void 0}}),null==h||h(e)}}}),[m,S,h,t,u]),E=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endDate;if(!e)return;const n=Y(e,S,c,v,i);if(!n)return f().dz.InvalidDate;if(!x().oM(m)&&!x().L3(m))return;const o={...m,end_date:n},r=a().Dz(o);if(!r)return f().dz.InvalidRange;t.setState({...t.state,currentMonth:r.end,error:{...t.state.error,[f().xQ.EndDate]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[f().xQ.EndDate]:void 0}}),null==h||h(o)}),[c,m,v,S,i,h,t]),F=(0,o.useCallback)((()=>{const e=t.state.inputTemporaryValue.endTime;if(!e)return;const n=G(e,u,S);if(!n)return f().dz.InvalidTime;if(!x().L3(m))return;const o={...m,end_time:n},i=a().Dz(o);if(!i)return f().dz.InvalidRange;t.setState({...t.state,currentMonth:i.end,error:{...t.state.error,[f().xQ.EndTime]:void 0},inputTemporaryValue:{...t.state.inputTemporaryValue,[f().xQ.EndTime]:void 0}}),null==h||h(o)}),[m,S,h,t,u]),V=(0,o.useCallback)((()=>{t.setState({...t.state,focus:f().xQ.StartDate,inputIsFocused:!0,currentMonth:B.start})}),[B.start,t]),z=(0,o.useCallback)((()=>{t.setState({...t.state,focus:f().xQ.StartTime,inputIsFocused:!0,currentMonth:B.start})}),[B.start,t]),K=(0,o.useCallback)((()=>{B.end&&t.setState({...t.state,focus:f().xQ.EndDate,inputIsFocused:!0,currentMonth:B.end})}),[B.end,t]),W=(0,o.useCallback)((()=>{B.end&&t.setState({...t.state,focus:f().xQ.EndTime,inputIsFocused:!0,currentMonth:B.end})}),[B.end,t]),H=(0,o.useCallback)((()=>{let e;if(t.state.focus===f().xQ.StartDate)e=N();else if(t.state.focus===f().xQ.StartTime)e=O();else if(t.state.focus===f().xQ.EndDate)e=E();else{if(t.state.focus!==f().xQ.EndTime)return(0,P().HB)(t.state.focus);e=F()}e?t.setState({...t.state,error:{...t.state.error,[t.state.focus]:e}}):t.setState({...t.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})}),[E,F,N,O,t]),q=(0,o.useCallback)((e=>{t.setState({...t.state,inputTemporaryValue:{...t.state.inputTemporaryValue,[t.state.focus]:e.target.value||""}}),y.isAndroid&&H()}),[y.isAndroid,H,t]),[Q,Z]=(0,r().K8)((()=>[y.isMobile?b.getSafePaddingLeftCSS(16):A?R().Qm:14,y.isMobile?b.getSafePaddingRightCSS(16):A?R().Qm:14]),[y.isMobile,A,b]),X=(0,T().IS)((e=>({container:{paddingTop:y.isMobile?16:8,paddingBottom:y.isMobile?16:8,paddingLeft:Q,paddingRight:Z,display:L?"block":"flex",...y.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:y.isMobile?e.popoverBackground:void 0}})),[y.isMobile,Q,Z,L]);return(0,w.jsxs)("div",{style:X.container,children:[(0,w.jsx)(Ae,{inputDateValue:k.startDate,inputTimeValue:k.startTime,rangeValue:B.start,disabled:n,dateError:j.startDate,timeError:j.startTime,isDateFocused:M===f().xQ.StartDate,isTimeFocused:M===f().xQ.StartTime,hasTime:L,hasEndDate:D,locale:i,dateFormat:c,timeFormat:u,onChange:q,onDateFocus:V,onTimeFocus:z,onBlur:H,onSubmit:H}),D?(0,w.jsx)("div",{style:{width:12,height:8}}):void 0,B.end?(0,w.jsx)(Ae,{inputDateValue:k.endDate,inputTimeValue:k.endTime,rangeValue:B.end,disabled:n,dateError:j.endDate,timeError:j.endTime,isDateFocused:M===f().xQ.EndDate,isTimeFocused:M===f().xQ.EndTime,hasTime:L,hasEndDate:D,locale:i,dateFormat:c,timeFormat:u,onChange:q,onDateFocus:K,onTimeFocus:W,onBlur:H,onSubmit:H}):void 0]})}function Ae(e){let{inputDateValue:t,inputTimeValue:n,rangeValue:i,disabled:r,dateError:s,timeError:l,isDateFocused:c,isTimeFocused:u,hasTime:p,hasEndDate:m,locale:g,dateFormat:f,timeFormat:h,onChange:v,onDateFocus:y,onTimeFocus:b,onBlur:S,onSubmit:A}=e;const M=(0,I().Y0)(),k=(0,d().tz)(),j=(0,P().O9)(s)||(0,P().O9)(l),C=c||u,_=(0,T().IS)((e=>({input:Me(M,e,j,C,m),separator:{height:14,width:1,background:e.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})),[M,j,C,m]),B=(0,o.useCallback)((()=>z(s,k)),[s,k]),L=(0,o.useCallback)((()=>z(l,k)),[l,k]),R=(0,o.useCallback)((()=>{if(M.isMobile){const e=(0,he().pN)(t)?i.toFormat(a().tr):t;return(0,w.jsx)(ye().A,{type:"date",format:ye().C.Transparent,value:e,onChange:v,onFocus:y,onBlur:S,onSubmit:A,disabled:r,size:1})}{const e=(0,he().pN)(t)?i.toFormat(K(f,k,g)):t;return(0,w.jsx)(ye().A,{selectAll:!0,format:ye().C.Transparent,value:e,focusInitial:c,onChange:v,onFocus:y,onBlur:S,onSubmit:A,disabled:r,size:1})}}),[f,M.isMobile,r,S,v,y,A,t,k,c,g,i]),D=(0,o.useCallback)((()=>{if(M.isMobile){const e=(0,he().pN)(n)?i.toFormat(x().GE):n;return(0,w.jsx)(ye().A,{type:"time",format:ye().C.Transparent,value:e,onChange:v,onFocus:b,onBlur:S,onSubmit:A,size:1,disabled:r})}{const e=(0,he().pN)(n)?i.toFormat(W(h,!1)):n;return(0,w.jsx)(ye().A,{format:ye().C.Transparent,value:e,focusInitial:u,onChange:v,onFocus:b,onBlur:S,onSubmit:A,size:1,disabled:r})}}),[M.isMobile,r,S,v,A,b,n,u,i,h]);return(0,w.jsxs)("div",{style:_.input,children:[(0,w.jsx)(be().A,{renderTooltip:B,originGap:Se,forceVisibleState:(0,P().O9)(s),placement:ve().W.Left,render:R}),p?(0,w.jsx)("div",{style:_.separator}):void 0,p?(0,w.jsx)(be().A,{renderTooltip:L,originGap:Se,forceVisibleState:(0,P().O9)(l),placement:ve().W.Right,render:D}):void 0]})}function Me(e,t,n,o,i){return{display:"flex",alignItems:"center",borderRadius:6,height:28,lineHeight:1.2,paddingLeft:8,paddingRight:8,flexBasis:"50%",flexGrow:1,fontSize:e.isMobile?16:14,...n?{background:_().Ay.redWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${_().Ay.red}`}:o&&i?{background:_().Ay.blueWithAlpha(.15),boxShadow:`inset 0 0 0 2px ${_().Ay.blue}`}:{background:t.inputBackground,boxShadow:t.inputBoxShadow}}}var we=()=>n(836251),ke=()=>n(962036),je=()=>n(64901);function Ce(){return(0,I().Y0)().isMobile?(0,w.jsx)(je().A,{href:(0,we().xS)("guides.reminders"),analyticsFrom:"date_selector"}):(0,w.jsx)(ke().A,{title:(0,w.jsx)(d().sA,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,we().xS)("guides.reminders"),analyticsFrom:"date_selector"})}function Ie(e){const{dateValue:t,onChangeValue:n}=e,{isMobile:i}=(0,I().Y0)(),r="date"===t.type||"daterange"===t.type,l="datetime"===t.type||"datetimerange"===t.type?t.time_zone:(0,s().P)(),c=(0,o.useCallback)((e=>{if("datetime"===t.type||"datetimerange"===t.type){const o={...t,time_zone:e};null==n||n(o)}}),[t,n]);return r?null:(0,w.jsx)(me().G,{enableRecents:!0,placementToOrigin:re().sx.Right,currentValue:l,onSelect:c,renderOrigin:e=>(0,w.jsx)(ae()._,{...e,title:(0,w.jsx)(d().sA,{defaultMessage:"Timezone",id:"datePropertyMenuFormatAndTimezone.timezone.label"}),focused:!1,right:!r&&a().GF(l),showExtensionArrow:i,chevronType:"right"})})}var Te=()=>n(173979),_e=()=>n(422464);function Pe(e){const{onChangeValue:t}=e,n=(0,d().tz)();return(0,w.jsx)(S().A,{title:(0,w.jsx)(d().sA,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,w.jsx)(A().A,{title:(0,w.jsx)(_e().W,{templateVariableType:e}),caption:(0,Te().EC)(e,n),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}function Be(e){let{store:t,value:n,header:m,isTemplatePage:f,shouldShowReminder:v,shouldShowControls:x=!0,canConfigureCollection:A,disabled:M,format:j,dateFormat:C,timeFormat:I,defaultReminder:T,firstDayOfWeek:_,formQuestionStore:P,onChangeValue:B,onChangeDateFormat:L,onChangeTimeFormat:R,onDismiss:D}=e;const N=c().A.isMobile,O=(0,p().X)("nds_datepicker_refresh"),E=(0,p().X)("db_ux_mobile"),U=(0,o.useMemo)((()=>a().Ec((0,s().P)())),[]),F=(0,r().K8)((()=>q(n,j,U,P)),[n,j,U,P]),V=(0,r().K8)((()=>t.state.inputIsFocused),[t]),z=(0,o.useMemo)((()=>N?{menuType:u().gu.Modal,title:(0,w.jsx)(d().sA,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),...!E&&{right:(0,w.jsx)(b().DoneMenuText,{}),onClickRight:D},left:v?(0,w.jsx)(Ce,{}):void 0,header:(0,w.jsx)(S().A,{children:(0,w.jsx)(xe,{store:t,disabled:M,locale:i().locale,format:j,dateFormat:C,timeFormat:I,dateValue:F,formQuestionStore:P,onChangeValue:B})}),includeFixedHeaderSpacing:E,scrollerStyle:E?{paddingBottom:g().Hc}:void 0}:{menuType:u().gu.Popup,maxHeight:"none",width:O?"min-content":270,header:m}),[C,F,N,M,j,P,m,O,B,D,v,t,I,E]),K=!l().V.includes(i().locale);return(0,w.jsxs)(y().A,{...z,children:[(0,w.jsx)(h().A,{show:V}),f&&(0,w.jsx)(Pe,{onChangeValue:B}),(0,w.jsxs)(S().A,{topBorder:f,children:[!N&&(0,w.jsx)(xe,{store:t,disabled:M,locale:i().locale,format:j,dateFormat:C,timeFormat:I,dateValue:F,formQuestionStore:P,onChangeValue:B}),(0,w.jsx)(Z,{store:t,dateValue:F,firstDayOfWeek:_,disabled:M,onChangeValue:B})]}),M?null:(0,w.jsxs)(w.Fragment,{children:[O&&(v||x)?(0,w.jsxs)(S().A,{topBorder:!0,children:[x&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(J,{dateValue:F,onChangeValue:B}),A&&(0,w.jsx)(pe,{dateFormat:C,onChangeDateFormat:L}),(0,w.jsx)(k,{dateValue:F,onChangeValue:B}),A&&K&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(ge,{dateValue:F,timeFormat:I,onChangeTimeFormat:R}),(0,w.jsx)(Ie,{dateValue:F,onChangeValue:B})]})]}),v&&(0,w.jsx)(de,{dateValue:F,onChangeValue:B,defaultReminder:T})]}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(ce,{dateValue:F,shouldShowReminder:v,shouldShowEndDateControl:x,shouldShowAllDayControl:x,onChangeValue:B,defaultReminder:T}),A&&x&&(0,w.jsx)(S().A,{topBorder:!0,children:(0,w.jsx)(fe,{dateValue:F,dateFormat:C,timeFormat:I,onChangeDateFormat:L,onChangeTimeFormat:R,onChangeValue:B})})]}),(0,w.jsx)(S().A,{topBorder:!0,children:(0,w.jsx)(X,{onChangeValue:B})}),!N&&v&&(0,w.jsx)(S().A,{topBorder:!0,children:(0,w.jsx)(Ce,{})})]})]})}function Le(e){const t=(0,r().uB)(void 0,f().Ay),n=(0,r().K8)((()=>t.state.inputIsFocused),[t]);return(0,m().A)({shouldPreserveTextSelection:!0,shouldPreserveBlockSelection:!0,shouldRestoreSelection:!0}),(0,w.jsx)(v().A,{debugName:"DatePropertyMenu",capture:n,allowEsc:!0,children:(0,w.jsx)(v().A,{debugName:"DatePropertyMenu",allowEsc:!0,capture:!0,allowUndo:!0,children:(0,w.jsx)(Be,{store:t,...e})})})}},572748:(e,t,n)=>{n.d(t,{t:()=>g});n(581454);var o=()=>n(484714),i=()=>n(56366),r=()=>n(401497),a=()=>n(187174),s=()=>n(959013),l=()=>n(524539),d=()=>n(372657),c=()=>n(810703),u=()=>n(765957),p=()=>n(845566),m=()=>n(258805);function g(e){let{allTargetsAreNavigable:t,forceShowPrivatePageOption:n,isAddTo:g,isCreateIn:f,isTurnIntoPage:h,onAccept:v,parentBlockId:y,query:b,searchResults:S,targets:x}=e;const A=(0,s().tz)(),M=(0,r().DP)(),w=(0,o().v3)(),k=(0,i().uB)(void 0,p().A),j=(0,i().O$)(u().AppStoreCurrentSpaceStore),C=(0,i().K8)((()=>(0,m().wc)(k)),[k]),[I]=(0,a().Yb)((async()=>C?await(0,c().pw)({spaceStore:C,currentUserId:w.currentUser.id}):void 0),[C,w.currentUser.id]),[T]=(0,a().Yb)((async()=>!b&&C?await l()._P(C,C.id):void 0),[b,C]),{blockResults:_,topLevelBlockResults:P,templateResults:B,recentPageResults:L}=(0,i().K8)((()=>{if(!C)return{blockResults:[],topLevelBlockResults:[],templateResults:[],recentPageResults:[]};const e=S.results.map((e=>({blockId:e.id,collectionId:e.collectionId})));return(0,m()._B)({chosenSpaceStore:C,environment:w,isCreateIn:f,query:b,recentPageIds:T.value,searchResults:e,targets:x})}),[C,w,f,b,T.value,S.results,x],{useDeepEqual:!0}),R=(0,i().K8)((()=>d().n6()),[]),[D]=(0,a().Yb)((async()=>{if(R&&C&&I.value)return await(0,m().N$)({chosenSpaceStore:C,savedQuickAddParent:I.value,query:b,blockResults:_,recentPageResults:L},w,f,v,x,g,k,t)}),[R,C,I.value,b,_,L,w,f,v,x,g,k,t]);return(0,i().K8)((()=>R?D.value??[]:C&&j&&I.value?f?(0,m().wU)({allTargetsAreNavigable:t,blockResults:_,chosenSpaceStore:C,environment:w,isAddTo:g,isCreateIn:f,isTurnIntoPage:h,moveToSpaceMenuStore:k,onAccept:v,parentBlockId:y,query:b,recentPageResults:L,targets:x,templateResults:B,topLevelBlockResults:P}):(0,m().OC)({allTargetsAreNavigable:t,blockResults:_,chosenSpaceStore:C,environment:w,forceShowPrivatePageOption:n,intl:A,isAddTo:g,isCreateIn:f,moveToSpaceMenuStore:k,onAccept:v,query:b,recentPageResults:L,savedQuickAddParent:I.value,targets:x,theme:M}):[]),[t,_,C,j,w,n,A,g,f,h,k,v,y,b,L,I.value,R,x,B,M,P,D.value])}},577466:(e,t,n)=>{n.d(t,{B:()=>r});var o=()=>n(401497),i=()=>n(963589);function r(e){const t=(0,i().X)("more_rounded_block_container");return(0,o().IS)((e=>({wrapper:{background:e.surface.wash,borderRadius:t?10:5,padding:"8px 12px",userSelect:"none",width:"100%"}})),[t])}},578030:(e,t,n)=>{n.r(t),n.d(t,{ShareMenuContainer:()=>li});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(959013),l=()=>n(778417),d=()=>n(725614),c=()=>n(805751),u=()=>n(928600),p=()=>n(480095),m=()=>n(125565),g=()=>n(64901),f=()=>n(780054),h=()=>n(38337),v=()=>n(722872),y=()=>n(836251),b=()=>n(645873),S=()=>n(58293),x=()=>n(646736),A=()=>n(131448),M=()=>n(146842),w=()=>n(284371),k=()=>n(987017),j=()=>n(115512),C=()=>n(901273),I=()=>n(598697),T=()=>n(463830),_=n(474848);function P(e){const{store:t,calculatedPermissions:n,permissionItemArgs:o,onClose:l}=e,d=(0,i().Y0)(),g=(f=d.isMobile,(0,a().IS)((e=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:f?e.surface.page:void 0}})),[f]));var f;const y=(0,r().uB)(void 0,T().A),b=d.isMobile?{menuType:v().gu.Modal,disableHeaderShadow:!0,title:(0,_.jsx)(m().A,{isMobile:d.isMobile,style:g.title,children:(0,_.jsx)(s().sA,{defaultMessage:"Share",id:"loggedOutShareMenu.title"})}),topbarStyle:g.topbarStyle,right:(0,_.jsx)(p().DoneMenuText,{}),onClickRight:l,whiteBackground:!0}:{menuType:v().gu.Popup,maxHeight:"90vh"};return(0,_.jsx)(u().A,{...b,className:h().NXe,children:(0,_.jsx)(c().A,{debugName:"LoggedOutShareMenuContainer",capture:!0,allowEsc:!0,children:(0,_.jsx)(B,{store:t,isMobile:d.isMobile,calculatedPermissions:n,permissionItemArgs:o,buttonPopupStore:y})})})}function B(e){let{store:t,isMobile:n,calculatedPermissions:r,permissionItemArgs:c,buttonPopupStore:u}=e;const p=(0,i().v3)(),m=function(e){const t=(0,i().v3)();return(0,a().IS)((n=>({tabStyle:{color:n.text.tertiary,...e&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:w().Wy.medium},tabTitleStyle:{color:"inherit",fontSize:(0,j().ny)(t,"UIRegular"),fontWeight:w().Wy.medium},style:e?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:16,paddingLeft:16},tabBorderStyle:{left:0,right:0}})),[t,e])}(n),g=[(0,_.jsx)(o.Fragment,{children:(0,_.jsx)(s().sA,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title")];return(0,o.useEffect)((()=>{l().IU({environment:p}),d().clear({environment:p})}),[p]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(k().Ay,{...m,tabs:g,selectedIndex:0,onChange:()=>{}}),(0,_.jsx)(I().GeneralAccessPermissionSection,{store:t,calculatedPermissions:r,permissionItemArgs:c}),(0,_.jsx)(C().A,{store:t,buttonPopupStore:u,calculatedPermissions:r,permissionItemArgs:c})]})}var L=()=>n(326589),R=()=>n(315841),D=()=>n(159026),N=()=>n(103674),O=()=>n(726360),E=()=>n(928074),U=()=>n(437487),F=()=>n(134696),V=()=>n(495867),z=()=>n(534177),K=()=>n(475355);async function W(e,t,n,o,i){if(i.state.inviteStage===D().d5.closed||i.state.inviteStage===D().d5.share_page)return;const{selection:r}=i.state;switch(r){case D().NJ.request_workspace_member:F().RH(e,{...V().nE(e,i),from:"share_menu"}),await V().xi({environment:e,spaceStore:t,originId:n.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:i,intl:o});break;case D().NJ.workspace_member:F()._u(e,V().nE(e,i));const a=i.state.invitedUsers.length>0;if(!t.isTeamsEnabled()&&a){i.setState({...i.state,inviteStage:D().d5.closed});if(!(await K().oH({environment:e,flowId:i.state.flowId??"",trackCreateTeamComplete:!1})))return}await V().Lg({environment:e,spaceStore:t,contextualInviteStore:i,from:"page_contextual_invite",intl:o});break;case D().NJ.page_guest:case D().NJ.unselected:case D().NJ.closed:F().l8(e,V().nE(e,i)),i.reset();break;default:(0,z().HB)(r)}}n(581454);var H=()=>n(575157),G=()=>n(90907),Y=()=>n(835607),q=()=>n(792071),$=()=>n(798880),Q=()=>n(84817),Z=()=>n(8980),X=()=>n(554509),J=()=>n(864943),ee=()=>n(581495),te=()=>n(305837),ne=()=>n(453697);function oe(e){let{users:t}=e;const n=(0,a().IS)((e=>({avatarsContainer:{marginLeft:"16px",display:"flex"},avatarWrapper:{marginLeft:"-16px"},upgradeWrapper:{alignSelf:"end",marginLeft:"-14px",borderRadius:"50%",background:e.surface.wash},upgradeIcon:{height:16,width:16,fill:e.icon.uiBluePrimary}})),[]);return(0,_.jsxs)("div",{style:n.avatarsContainer,children:[t.slice(0,10).map(((e,t)=>(0,_.jsx)("div",{style:n.avatarWrapper,children:(0,_.jsx)(ne().A,{userValue:e,size:40})},t))),(0,_.jsx)("div",{style:n.upgradeWrapper,children:(0,te().H)(n.upgradeIcon)})]})}function ie(e){const{guestEmails:t,spaceStore:n,contextualInviteStore:o,blockStore:l,paysPerSeat:d}=e,c=(0,i().v3)(),u=(0,s().tz)(),p=(0,r().K8)((()=>o.state.inviteStage===D().d5.request_workspace),[o]),m=(0,r().K8)((()=>t.map((e=>{const t=o.state.invitedEmailToUserIdMap[e];return q().Bj6.fromValue($().oo,{id:t,email:e,version:1})}))),[o,t]),g=(0,a().IS)((e=>({cta:{flex:1},facepileContainer:{display:"flex",justifyContent:"center"}})),[]);return(0,_.jsxs)("div",{className:h().NXe,children:[(0,_.jsx)(ee().Rz,{onClick:()=>o.reset()}),(0,_.jsxs)(Q().Y1,{padding:"24px 22px 18px 22px",gap:24,children:[(0,_.jsxs)(Q().Y1,{gap:20,children:[(0,_.jsx)("div",{style:g.facepileContainer,children:(0,_.jsx)(oe,{users:m})}),(0,_.jsxs)(Q().Y1,{gap:8,children:[(0,_.jsx)(X().D,{styleName:"Heading-17px/Semibold",children:(0,_.jsx)(s().sA,{id:"ContextualInvite.variantD.header",defaultMessage:"{inviteCount, plural, one {Upgrade guest to member?} other {Upgrade {inviteCount} guests to members?}}",values:{inviteCount:t.length}})}),(0,_.jsxs)(Q().Y1,{gap:20,children:[(0,_.jsx)(X().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:d?p?(0,_.jsx)(s().sA,{id:"ContextualInvite.variantD.description.request",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features.} one {{firstGuest} and 1 other will have access to these features.} other {{firstGuest} and {otherInviteCount} others will have access to these features.}} A workspace admin will review your request.",values:{firstGuest:t[0],otherInviteCount:t.length-1}}):(0,_.jsx)(s().sA,{id:"ContextualInvite.variantD.description",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}} and {totalInviteCount, plural, one {this workspace will be billed for 1 member} other {this workspace will be billed for {totalInviteCount} members}}",values:{firstGuest:t[0],totalInviteCount:t.length,otherInviteCount:t.length-1}}):(0,_.jsx)(s().sA,{id:"ContextualInvite.variantD.description.free",defaultMessage:"{otherInviteCount, plural, =0 {{firstGuest} will have access to these features} one {{firstGuest} and 1 other will have access to these features} other {{firstGuest} and {otherInviteCount} others will have access to these features}}",values:{firstGuest:t[0],otherInviteCount:t.length-1}})}),(0,_.jsxs)(Q().Y1,{gap:14,children:[(0,_.jsxs)(Q().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,_.jsx)(Z().I,{icon:G().h,color:"secondary"}),(0,_.jsx)(X().D,{styleName:"UIRegular-14px/Regular",children:(0,_.jsx)(s().sA,{id:"ContextualInvite.variantD.memberBenefits.private",defaultMessage:"Create private pages and drafts"})})]}),(0,_.jsxs)(Q().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,_.jsx)(Z().I,{icon:H().D,color:"secondary"}),(0,_.jsx)(X().D,{styleName:"UIRegular-14px/Regular",children:(0,_.jsx)(s().sA,{id:"ContextualInvite.variantD.memberBenefits.public",defaultMessage:"Access all public pages in the workspace"})})]}),(0,_.jsxs)(Q().Y1,{gap:8,direction:"horizontal",align:"center-left",children:[(0,_.jsx)(Z().I,{icon:Y().peopleIcon,color:"secondary"}),(0,_.jsx)(X().D,{styleName:"UIRegular-14px/Regular",children:(0,_.jsx)(s().sA,{id:"ContextualInvite.variantD.memberBenefits.collaboration",defaultMessage:"Unlimited collaboration with others"})})]})]})]})]})]}),(0,_.jsxs)(Q().Y1,{direction:"horizontal",gap:10,children:[(0,_.jsx)(J().A,{size:"lg",style:g.cta,onClick:async()=>{!function(e){e.setState({...e.state,selection:D().NJ.page_guest})}(o),await W(c,n,l,u,o)},children:(0,_.jsx)(s().sA,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"})}),(0,_.jsx)(J().A,{size:"lg",style:g.cta,onClick:async()=>{o.state.inviteStage===D().d5.share_workspace&&function(e){e.setState({...e.state,selection:D().NJ.workspace_member})}(o),o.state.inviteStage===D().d5.request_workspace&&function(e){e.setState({...e.state,selection:D().NJ.request_workspace_member})}(o),await W(c,n,l,u,o)},children:p?(0,_.jsx)(s().sA,{id:"ContextualInvite.variantD.request",defaultMessage:"Request upgrade"}):(0,_.jsx)(s().sA,{id:"ContextualInvite.variantD.upgrade",defaultMessage:"Upgrade to member"})})]})]})]})}function re(e){const{spaceStore:t,blockStore:o}=e,a=(0,i().v3)(),s=(0,n(714300).l)({spaceId:t.id}),l=(0,r().K8)((()=>(0,n(37433).L3)(a,s)),[a,s]),d=(0,r().uB)(e.contextualInviteStore,D().Ay),c=n(762433).OK(s),u=(0,r().K8)((()=>d.getGuestEmails()),[d]),p=(0,r().K8)((()=>(0,n(640653).hN)(t)),[t]);return(0,n(852507).l)((()=>{!function(e,t){t&&e.setState({...e.state,selection:D().NJ.page_guest})}(d,l),F().bT(a,V().nE(a,d))})),u.length?(0,_.jsx)(ie,{contextualInviteStore:d,spaceStore:t,blockStore:o,useZeroTeamsExperience:l,paysPerSeat:c,guestEmails:u,useGuestInviteRequestExperience:p}):null}const ae=o.memo(re);var se=()=>n(340498);const le=(0,se().wt)("wifiSlash",{viewBox:"0 0 32 32",svg:(0,_.jsx)("path",{d:"M5.33984 5.32812L8.04688 8.04688C6.17969 8.8125 4.50781 9.97656 3.03125 11.5391C2.90625 11.6719 2.75781 11.7422 2.58594 11.75C2.42188 11.75 2.27734 11.6836 2.15234 11.5508L0.5 9.89844C0.390625 9.78125 0.332031 9.65625 0.324219 9.52344C0.324219 9.38281 0.371094 9.25391 0.464844 9.13672C1.08984 8.39453 1.8125 7.70312 2.63281 7.0625C3.46094 6.41406 4.36328 5.83594 5.33984 5.32812ZM13.6719 6.91016L10.3203 3.54688C10.9688 3.42187 11.5938 3.32812 12.1953 3.26562C12.8047 3.20313 13.4023 3.17188 13.9883 3.17188C15.8086 3.17188 17.5703 3.42969 19.2734 3.94531C20.9844 4.46094 22.5469 5.17188 23.9609 6.07812C25.375 6.97656 26.5625 7.99609 27.5234 9.13672C27.6172 9.25391 27.6641 9.38281 27.6641 9.52344C27.6641 9.65625 27.6016 9.78125 27.4766 9.89844L25.8359 11.5391C25.7109 11.6719 25.5664 11.7422 25.4023 11.75C25.2383 11.75 25.0977 11.6914 24.9805 11.5742C23.543 10.0898 21.9141 8.94531 20.0938 8.14062C18.2812 7.33594 16.2852 6.91016 14.1055 6.86328C14.0352 6.86328 13.9609 6.86719 13.8828 6.875C13.8125 6.88281 13.7422 6.89453 13.6719 6.91016ZM10.6016 10.5781L13.7773 13.7656C13.0273 13.7812 12.2969 13.9023 11.5859 14.1289C10.875 14.3555 10.207 14.6641 9.58203 15.0547C8.96484 15.4375 8.42188 15.8828 7.95312 16.3906C7.82031 16.5312 7.67188 16.6094 7.50781 16.625C7.34375 16.6328 7.19141 16.5703 7.05078 16.4375L5.21094 14.6328C5.10156 14.5234 5.03906 14.4023 5.02344 14.2695C5.01562 14.1367 5.0625 14.0117 5.16406 13.8945C5.78906 13.1602 6.56641 12.5039 7.49609 11.9258C8.43359 11.3398 9.46875 10.8906 10.6016 10.5781ZM22.0859 15.3242L17.3398 10.5781C18.4492 10.8594 19.4922 11.2969 20.4688 11.8906C21.4453 12.4844 22.2344 13.1523 22.8359 13.8945C22.9219 14.0117 22.9609 14.1367 22.9531 14.2695C22.9531 14.4023 22.8945 14.5234 22.7773 14.6328L22.0859 15.3242ZM14 16.9531C14.8281 16.9531 15.5898 17.1367 16.2852 17.5039C16.9805 17.8711 17.5312 18.3125 17.9375 18.8281C18.0312 18.9453 18.0703 19.0742 18.0547 19.2148C18.0391 19.3555 17.9766 19.4766 17.8672 19.5781L15.0078 22.3438C14.7734 22.5703 14.582 22.7227 14.4336 22.8008C14.293 22.8867 14.1484 22.9297 14 22.9297C13.8594 22.9297 13.7188 22.8867 13.5781 22.8008C13.4375 22.7227 13.2461 22.5703 13.0039 22.3438L10.1328 19.5781C10.0312 19.4844 9.96484 19.3789 9.93359 19.2617C9.91016 19.1367 9.93359 19.0234 10.0039 18.9219C10.4102 18.375 10.9688 17.9102 11.6797 17.5273C12.3906 17.1445 13.1641 16.9531 14 16.9531ZM23.8906 21.7812L4.09766 2C3.91797 1.82812 3.82812 1.60938 3.82812 1.34375C3.82812 1.07812 3.91797 0.855469 4.09766 0.675781C4.26953 0.496094 4.48828 0.410156 4.75391 0.417969C5.01953 0.417969 5.24219 0.507813 5.42188 0.6875L25.2031 20.4688C25.3906 20.6484 25.4844 20.8672 25.4844 21.125C25.4844 21.3828 25.3906 21.6016 25.2031 21.7812C25.0312 21.9609 24.8164 22.0508 24.5586 22.0508C24.3008 22.0508 24.0781 21.9609 23.8906 21.7812Z"})});var de=()=>n(529183),ce=()=>n(440339),ue=()=>n(962277);function pe(e){const{store:t,mostPermissivePublicItem:n,permissionItemArgs:o}=e,{permissionItem:i}=n;return(0,r().K8)((()=>(0,ue().W)(i)),[i])?(0,_.jsx)(R().d,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location,showManageAllDomains:!0,showAllPublishedSites:!0,shouldAskForConfirmationOnPublish:!1}):(0,_.jsx)(R().Js,{store:t,mostPermissivePublicItem:n,sudoModeStore:o.sudoModeStore,location:o.location})}n(898992),n(354520);var me=()=>n(842599),ge=()=>n(196131),fe=()=>n(84262),he=()=>n(545805),ve=()=>n(792223),ye=()=>n(366858),be=()=>n(535279),Se=()=>n(108944),xe=()=>n(963589),Ae=()=>n(970585),Me=()=>n(308227),we=()=>n(329304),ke=()=>n(616092);function je(e){const{type:t}=e;switch(t){case"newUser":case"existingUser":return e.value.email;case"invalidUser":case"group":return;default:(0,z().HB)(t)}}var Ce=()=>n(623275);var Ie=()=>n(343247),Te=()=>n(529601),_e=()=>n(622963),Pe=()=>n(751735),Be=()=>n(920773),Le=()=>n(460292),Re=()=>n(364499),De=()=>n(404141),Ne=()=>n(408095),Oe=()=>n(749240);function Ee(e){const{spaceId:t,userId:n,spaceModel:o,spaceUserModel:i,teamModel:l,domains:d,blockStore:c}=e,u=(0,s().tz)(),p=(0,we()._X)({name:"internal_guests",spaceId:t,userId:n,amount:1}),m=(0,Re().o)({store:c}),g=(0,we().P9)({name:"non_admin_members",spaceId:t,userId:n}),f=(0,a().IS)((e=>{const t=p&&!(0,fe().e2)(p),n=t?20:5,o=t?e.palette.orange[100]:"transparent",i=t?e.palette.orange[400]:e.fill.uiBlue;return{container:{borderImage:`repeating-linear-gradient(-45deg, ${o}, ${o} ${n}px, ${i} ${n}px, ${i} ${2*n}px) 5 0`,borderWidth:"4px 0 0 0",borderStyle:"solid",background:t?(0,Pe().X4)(e.palette.orange[400],.15):(0,Pe().X4)(e.fill.uiBlue,.15),position:"relative",padding:10,zIndex:5},fill:{background:e.surface.elevated,border:`1px solid ${e.stroke.secondary}`},button:{height:"auto",width:"calc(100% + 16px)",padding:8,margin:-8}}}),[p]),h=(0,r().K8)((()=>{var e;const t=(0,_e()._y)((null===(e=Oe().subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)??"free");return Ne().qY[t].label}),[]),v=(0,r().K8)((()=>null==i?void 0:i.isWorkspaceOwner()),[i]),y=(0,r().K8)((()=>null==i?void 0:i.isMember()),[i]);let b;b=v?"You are a workspace owner":y?"You are a member":"You are a guest";const S=(0,r().K8)((()=>[{label:"Allow members to invite guests to pages",isEnabled:!!o&&o.getDisableGuests()},{label:"Allow members to request adding guests",isEnabled:(null==o?void 0:o.getSettings().enable_guest_invite_requests)??!1},{label:"Allow members to request adding other members",isEnabled:!(null!=o&&o.getSettings().disable_membership_requests)}]),[o]),x=(0,r().K8)((()=>[{label:"Disable guests",isEnabled:(null==l?void 0:l.getSettings().disable_guests)??!1}]),[l]),A=(0,r().K8)((()=>{if(!o||!d||!i)return;const{autojoinDomains:e}=(0,Te().SJ)({space:o,spaceUser:i,domains:d});return e}),[o,i,d]),M=(0,r().K8)((()=>{if(!o||!i)return;const{type:e}=(0,Te().yQ)({space:o,spaceUser:i,team:l,publicPageDataGuestSetting:m});switch(e){case"can_add":return"You can add guests.";case"can_request":return"You can request to add guests.";case"cannot_add":return"You can't add or request to add guests.";default:(0,z().HB)(e)}}),[o,i,l,m]),w=(0,r().K8)((()=>{if(!o||!d||!i)return;const{type:e}=(0,Te().SJ)({space:o,spaceUser:i,domains:d});switch(e){case"can_add":return"You can add members.";case"can_request":return"You can request to add members.";case"cannot_add":return"You can't add or request to add members.";default:(0,z().HB)(e)}}),[o,i,d]),k=(0,r().K8)((()=>{if(!o||!i||!d)return!1;return"can_add"===(0,Te().SJ)({space:o,spaceUser:i,domains:d}).type}),[o,i,d]),j=(0,r().K8)((()=>{if(!p)return;const e=p.type;switch(e){case"available":return"You can add an internal guest.";case"unavailable":return k?g?"Internal guests will be added to the space with member access.":"Internal guests will be added to the space with workspace owner access.":"You can't add internal guests.";default:(0,z().HB)(e)}}),[p,g,k]),C=(0,r().K8)((()=>{if(!p)return"Guest limit data is unavailable";if("cumulative"===p.limit.type){const{current:e,total:t}=p.limit;return"unlimited"===t?"No guest limit":`Space has ${e} of ${t} guests`}}),[p]),I=e=>{De().A.setState({open:!0,openedFrom:"misc",currentTab:e,defaultSubtab:void 0,highlightedSetting:void 0})};return(0,_.jsxs)(Q().Y1,{gap:10,style:f.container,children:[(0,_.jsxs)(Q().Y1,{gap:12,borderRadius:6,padding:10,style:f.fill,children:[(0,_.jsx)(Be().p,{onClick:()=>I("security"),style:f.button,children:(0,_.jsxs)(Q().Y1,{gap:4,children:[(0,_.jsx)(X().D,{styleName:"UISmall-12px/Medium",children:"Space security settings"}),S.map(((e,t)=>(0,_.jsxs)(Q().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,_.jsx)(Ue,{isEnabled:e.isEnabled}),(0,_.jsx)(X().D,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]})}),(0,_.jsxs)(Q().Y1,{gap:4,children:[(0,_.jsx)(X().D,{styleName:"UISmall-12px/Medium",children:"Team security settings"}),x.map(((e,t)=>(0,_.jsxs)(Q().Y1,{direction:"horizontal",gap:4,align:"center-left",children:[(0,_.jsx)(Ue,{isEnabled:e.isEnabled}),(0,_.jsx)(X().D,{colorName:e.isEnabled?"secondary":"tertiary",styleName:"UISmall-12px/Regular",children:e.label})]},t)))]}),(0,_.jsx)(Be().p,{onClick:()=>I("billing"),style:f.button,children:(0,_.jsxs)(Q().Y1,{gap:4,children:[(0,_.jsx)(X().D,{styleName:"UISmall-12px/Medium",children:"Subscription"}),(0,_.jsx)(X().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:`${u.formatMessage(h)} plan`}),(0,_.jsx)(X().D,{colorName:"secondary",styleName:"UISmall-12px/Regular",children:C})]})}),(0,_.jsx)(Be().p,{onClick:()=>I("settings"),style:f.button,children:(0,_.jsxs)(Q().Y1,{gap:4,children:[(0,_.jsx)(X().D,{styleName:"UISmall-12px/Medium",children:"Allowed email domains"}),null==A?void 0:A.map((e=>(0,_.jsx)(X().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:e},e))),0===(null==A?void 0:A.length)&&(0,_.jsx)(X().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:"None"})]})})]}),(0,_.jsxs)(Q().Y1,{gap:4,borderRadius:6,padding:10,style:f.fill,children:[(0,_.jsx)(X().D,{styleName:"UISmall-12px/Medium",children:b}),(0,_.jsx)(X().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:w}),(0,_.jsx)(X().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:M}),(0,_.jsx)(X().D,{styleName:"UISmall-12px/Regular",colorName:"secondary",children:j})]})]})}function Ue(e){const{isEnabled:t}=e,n=(0,a().IS)((e=>({circle:{width:10,height:10,borderRadius:"50%",border:`1px solid ${e.icon.quaternary}`}})),[]);return t?(0,_.jsx)(Le().Q,{iconGroup:Ie().d,variantName:"mini",colorName:"secondary"}):(0,_.jsx)(Q().Y1,{width:14,height:14,align:"center",children:(0,_.jsx)("div",{style:n.circle})})}var Fe=()=>n(617871),Ve=()=>n(449506),ze=()=>n(2143),Ke=()=>n(232461),We=()=>n(756279),He=()=>n(765957),Ge=()=>n(217429),Ye=()=>n(53137),qe=()=>n(321172),$e=()=>n(456328),Qe=()=>n(623580);function Ze(e){const{shouldShowLengthWarning:t,shouldShowLinkWarning:n,value:o,maxLength:i}=e,r=(0,a().IS)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.text.tertiary,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,_.jsx)("div",{style:r.container,children:(0,_.jsxs)("div",{style:r.warning,children:[t&&(0,_.jsx)(s().sA,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:o.length,maxCharacters:i}}),t&&n&&" · ",n&&(0,_.jsx)(s().sA,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}const Xe=100;function Je(e){const{open:t,focus:n,value:o,maxLength:i,onFocus:r,onChange:l,onCancel:d}=e,c=(0,s().tz)(),u=o.length/i>=.8,p=(0,$e().BS)(o),m=u||p,g=(0,a().IS)((e=>({container:{maxHeight:t?Xe:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),f=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,_.jsxs)("div",{style:g.container,children:[m?(0,_.jsx)(Ze,{value:o,maxLength:i,shouldShowLengthWarning:u,shouldShowLinkWarning:p}):void 0,(0,_.jsx)(Qe().A,{textarea:!0,focusInitial:!1,format:Qe().C.Transparent,placeholder:f,maxlength:i,focus:n,value:o,onFocus:r,onChange:l,inputStyle:g.input,onCancel:d})]})}var et=()=>n(134589),tt=()=>n(803557),nt=()=>n(980427),ot=()=>n(493823),it=()=>n(406699),rt=()=>n(887080),at=()=>n(183804),st=()=>n(787766),lt=()=>n(377586),dt=()=>n(804800);function ct(e){const{shouldShowSlackImportContactsButton:t,shouldShowGoogleImportContactsButton:n,emailMessage:o,inviteTargetsStore:r,flowId:s,originStyle:l={},containerStyle:d={},source:c,titleStyle:u={}}=e,p=(0,i().v3)(),m=(0,a().IS)((e=>({importContactsContainer:{height:36,bottom:0,width:"100%",pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.text.primary}})),[]),g=(0,st().Hc)(),f=(0,xe().X)("disconnect_contact_import"),h=(e,t)=>{t&&f&&"share_menu"===c?dt().L.setState({open:!0,type:e}):(U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:o}),r.setState({...r.state,tokenQuery:""}))};if(t&&n){const e=(0,at().C)({onClickAuthenticated:h,hideChevronIcon:!0,containerStyle:g.importListButtonContainer,buttonStyle:g.importListButton,flowId:s});return(0,_.jsx)(it().Ay,{popupType:lt().n.Popup,alignmentToOrigin:it().yP.Start,placementToOrigin:it().sx.Left,render:()=>(0,_.jsx)(rt().A,{importListItems:e}),originGap:12,renderOrigin:e=>(0,_.jsx)("div",{style:{...m.importContactsContainer,...d},children:(0,_.jsx)(ot().p,{style:{...m.importContactsButton,...l},onClick:()=>{e.onClick(),nt().V(p,{source:c})},children:(0,_.jsx)("div",{style:g.labelContainer,children:(0,_.jsx)(ut,{titleStyle:u})})})})})}return t?(0,_.jsx)(tt().Xx,{onClickAuthenticated:()=>h(U().NL.Slack),title:(0,_.jsx)(ut,{titleStyle:u}),containerStyle:m.importContactsContainer,buttonStyle:m.importContactsButtonV2,from:"share_menu",inviteOrigin:"page_share_modal",flowId:s,loadContacts:!0,hideChevronIcon:!0}):null}function ut(e){const{titleStyle:t={}}=e,n=(0,a().IS)((e=>({integrationName:{display:"flex"},importContactsButtonTitle:{display:"flex",alignItems:"center",fill:e.text.primary,gap:8,...t}})),[t]);return(0,_.jsxs)("div",{style:n.importContactsButtonTitle,children:[(0,_.jsx)("div",{style:n.integrationName,children:(0,_.jsx)(Z().I,{color:"secondary",icon:et().R})}),(0,_.jsx)(s().sA,{defaultMessage:"Import contacts",id:"importContactsButton.importContacts.label"})]})}n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(672577),n(803949),n(908872),n(737550);var pt=()=>n(187174);const mt={viewBox:"0 0 16 16",fittedViewBox:"3.66 3.66 8.68 8.68",directional:!0,svg:(0,_.jsx)("path",{d:"M4.288 3.663a.625.625 0 0 0-.625.625v6.109a.625.625 0 1 0 1.25 0v-4.6l6.368 6.368c.24.24.63.232.873-.01a.62.62 0 0 0 .01-.874L5.797 4.913h4.601a.625.625 0 1 0 0-1.25z"})},gt=(0,se().wt)("arrowDiagonalUpLeftSmall",mt);var ft=()=>n(97835),ht=()=>n(889154),vt=()=>n(68263),yt=()=>n(848538),bt=()=>n(778078),St=()=>n(542056),xt=()=>n(843189),At=()=>n(760217),Mt=()=>n(939740),wt=()=>n(64e3),kt=()=>n(897119),jt=()=>n(89924),Ct=()=>n(859428),It=()=>n(267155),Tt=()=>n(558034),_t=()=>n(743260),Pt=()=>n(423657),Bt=()=>n(17281),Lt=()=>n(423817),Rt=()=>n(962730),Dt=()=>n(21735),Nt=()=>n(630116),Ot=()=>n(715392),Et=()=>n(134217),Ut=()=>n(10984),Ft=()=>n(98866),Vt=()=>n(386164);var zt=()=>n(913348),Kt=()=>n(264154);function Wt(e){const{emailMessage:t,inviteTargetsStore:n,flowId:o,googleContacts:r=[],slackContacts:l=[],totalContactsCount:d=0}=e,c=(0,i().v3)(),u=(0,a().IS)((e=>({importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:4,color:e.text.secondary,borderRadius:"6px"},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.text.primary},icon:{color:e.icon.tertiary}})),[]),p=(0,st().Hc)(),m=(0,xe().X)("disconnect_contact_import"),g=r.length>0||l.length>0,f=(0,at().C)({onClickAuthenticated:(e,o)=>{m&&o?dt().L.setState({open:!0,type:e}):(U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:t}),n.setState({...n.state,tokenQuery:""}))},hideChevronIcon:!0,containerStyle:p.importListButtonContainer,buttonStyle:p.importListButton,flowId:o});return(0,_.jsx)(it().Ay,{popupType:lt().n.Popup,alignmentToOrigin:it().yP.Center,placementToOrigin:it().sx.Bottom,render:()=>(0,_.jsx)(rt().A,{importListItems:f}),originGap:12,renderOrigin:e=>(0,_.jsxs)(ot().p,{style:{...u.importContactsButton},onClick:()=>{e.onClick(),nt().V(c,{source:"share_menu_inline_dropdown"})},children:[g?(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.numContacts",defaultMessage:"{numContacts} contacts",values:{numContacts:d}}):(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.importContactsInlineDropdown.noContacts",defaultMessage:"None"}),(0,_.jsx)(Le().Q,{iconGroup:Kt().l,variantName:"fillSmall",style:u.icon})]})})}var Ht=()=>n(12193);function Gt(e){const{publicPermission:t}=e,n=(0,a().IS)((e=>({banner:{...(0,Ce().kJ)({theme:e}),display:"flex",flexDirection:"row",alignItems:"center",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:14,lineHeight:"20px",color:e.text.secondary,flex:"1 0 0",paddingLeft:4},iconContainer:{height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"},manageButton:{color:e.text.uiBluePrimary,fontWeight:w().Wy.medium}})),[]),o=t.permissionItem.role;if(!vt().Tt(o))return null;const i=(0,vt().W8)(t.permissionItem);return(0,_.jsxs)("div",{style:n.banner,children:[(0,_.jsxs)("div",{style:n.content,children:[(0,_.jsx)("div",{style:n.iconContainer,children:(0,_.jsx)(Z().I,{icon:Ht().globeIcon,color:"secondary"})}),(0,_.jsx)(m().A,{style:n.label,isMultiline:!0,children:(0,_.jsx)(Yt,{role:o,hasSitePublicPermission:i})})]}),(0,_.jsx)(ot().p,{size:"sm",style:n.manageButton,onClick:()=>{i?U().Ay.setState({...U().Ay.state,display:U().pP.Publish,tab:U().QC.Publish}):U().Ay.setState({...U().Ay.state,display:U().pP.MainShareMenu,tab:U().QC.Share,source:U().mc.PublicPermissionLevelBanner})},children:(0,_.jsx)(s().sA,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Settings"})})]})}function Yt(e){const{role:t,hasSitePublicPermission:n}=e;switch(t){case"read_and_write":return(0,_.jsx)(s().sA,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,_.jsx)(s().sA,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return n?(0,_.jsx)(s().sA,{id:"shareMenu.publicPermissionBanner.canReadSite",defaultMessage:"This site can be viewed by anyone on the web"}):(0,_.jsx)(s().sA,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,z().HB)(t)}}var qt=()=>n(148307),$t=()=>n(831310),Qt=()=>n(704152),Zt=()=>n(854672),Xt=()=>n(619338),Jt=()=>n(231039),en=()=>n(870092),tn=()=>n(623742),nn=()=>n(698449);function on(e){let{inviteTarget:t,isMobile:o,captionOverride:i}=e;const l=(0,s().tz)(),d=(0,r().O$)(He().AppStoreCurrentSpaceStore),c=(0,r().K8)((()=>(0,nn().Pf)({groupName:t.value.name,intl:l})),[t,l]),u=(0,r().K8)((()=>{if(d&&t.value.icon)return{pointer:{table:d.table,id:d.id},icon:t.value.icon}}),[d,t]),p=(0,r().K8)((()=>(0,nn().xQ)({groupId:t.value.group_id})),[t]),g=(0,a().IS)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:void 0,paddingBottom:void 0,marginLeft:void 0,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[]);return(0,_.jsxs)("div",{style:g.titleContainer,children:[(0,_.jsx)(n(946928).A,{groupIcon:null==u?void 0:u.icon,spaceId:t.value.space_id}),(0,_.jsxs)("div",{style:g.groupInfoContainer,children:[(0,_.jsx)("div",{style:g.nameAndIconContainer,children:(0,_.jsx)(m().A,{style:g.groupNameLabel,children:c})}),(0,_.jsx)(m().A,{isSmall:!0,style:g.groupMembersLabel,children:i||(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(s().sA,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,_.jsx)(s().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:p}})]})})]})]})}const rn=o.memo(on);function an(e,t){let{store:n,isInvited:o,disabled:i,spaceVisibleUserMap:r,inviteTarget:s,id:l,focused:d,onClick:c,onAuxClick:u,onMouseEnter:p,role:m,disallowTabbing:g,ignoreLocalHoverState:f,isMobile:h}=e;const v=(0,a().IS)((()=>({container:(0,Ce().sH)()})),[]);return(0,_.jsx)(At().A,{ref:t,buttonStyle:v.container,title:"group"===s.type?(0,_.jsx)(rn,{inviteTarget:s,isMobile:h}):(0,_.jsx)(sn,{store:n,inviteTarget:s,spaceVisibleUserMap:r}),disabled:i,right:!i&&(0,_.jsx)(ln,{onClick:c,checked:o}),id:l,focused:d,onClick:c,onAuxClick:u,onMouseEnter:p,role:m,disallowTabbing:g,ignoreLocalHoverState:f})}function sn(e){let{store:t,inviteTarget:n,spaceVisibleUserMap:i}=e;const s=(0,r().K8)((()=>"existingUser"===n.type?(0,Xt().p)({spaceVisibleUserMap:i,userId:n.value.id,store:t}):void 0),[n,i,t]),l=(0,o.useMemo)((()=>"existingUser"===n.type?{actorStore:en().L.createChildStore(t,{table:$().oo,id:n.value.id}),avatar:void 0}:"newUser"===n.type?{actorStore:void 0,avatar:{email:n.value.email,..."slack"===n.source||"google"===n.source?{name:n.value.name,avatarUrl:n.value.avatar_url}:{name:void 0,avatarUrl:void 0}}}:void(0,z().HB)(n)),[n,t]),d=(0,a().IS)((()=>({cellMemberAvatarContainer:{},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[]),c="on"===(0,r().K8)((()=>Ge().default.getEligibleGroup({experimentId:"contact_import_notion_account",parameter:"variant",defaultGroup:"control"})),[])&&"newUser"===n.type&&("google"===n.source||"slack"===n.source)&&n.value.user_id;return(0,_.jsx)(tn().A,{isLarge:!0,...l,containerStyle:d.cellMemberAvatarContainer,avatarBadge:(()=>{const e=(()=>{if("newUser"!==n.type)return null;switch(n.source){case"slack":return qt().A.images.externalIntegrations.slackIconPng;case"google":return qt().A.images.externalIntegrations.googleGIconPng;default:return null}})();return e?(0,_.jsx)(Zt().A,{type:"image_url",imageURL:e,size:18,style:d.iconBox,imageStyle:d.iconBoxImage}):null})(),spaceRole:s,caption:c&&(0,_.jsx)(Jt().N,{inviteTarget:n})})}function ln(e){const{checked:t}=e,n=(0,a().IS)((e=>{const n=n=>{switch(n){case"default":return{background:t?e.checkboxBackground:"transparent",borderColor:t?e.checkboxBackground:e.icon.tertiary};case"hovered":return{background:t?e.checkboxHoveredBackground:e.uncheckedCheckboxHoveredBackground,borderColor:t?e.checkboxHoveredBackground:e.icon.tertiary};case"pressed":return{background:t?e.checkboxPressedBackground:e.uncheckedCheckboxPressedBackground,borderColor:t?e.checkboxPressedBackground:e.icon.tertiary};default:return(0,z().ub)(n),{}}};return{circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,...n("default"),marginRight:6},hovered:n("hovered"),pressed:n("pressed"),checkIcon:{height:9,width:9,color:"white"}}}),[t]);return(0,_.jsx)(Qt().A,{onClick:e.onClick,style:n.circleCheckmark,hoveredStyle:n.hovered,pressedStyle:n.pressed,children:t&&(0,$t().o)(n.checkIcon)})}const dn=o.memo(o.forwardRef(an));var cn=()=>n(273900),un=()=>n(433847),pn=()=>n(179034),mn=()=>n(47170),gn=()=>n(328403),fn=()=>n(678634),hn=()=>n(801191),vn=()=>n(810727);function yn(e){let{blockStore:t,permissionItem:n,inviteTarget:o,mostPermissivePermissions:i,spaceVisibleUserMap:r,permissionItemArgs:a,...s}=e;return"group"===o.type?(0,_.jsx)(Sn,{inviteTarget:o,blockStore:t,permissionItem:n,mostPermissivePermissions:i,permissionItemArgs:a,menuListItemProps:s}):"existingUser"===o.type?(0,_.jsx)(bn,{inviteTarget:o,blockStore:t,permissionItem:n,mostPermissivePermissions:i,permissionItemArgs:a,spaceVisibleUserMap:r,menuListItemProps:s}):((0,z().ub)(o),null)}function bn(e){let{inviteTarget:t,blockStore:n,permissionItem:o,mostPermissivePermissions:a,spaceVisibleUserMap:l,permissionItemArgs:d,menuListItemProps:c}=e;const u=(0,s().tz)(),p=(0,r().K8)((()=>Nt().LU.createChildStore(n,{table:$().oo,id:t.value.id}).getDisplayName(u)||void 0),[n,u,t]),m=(0,vn().z)({permissionItem:o,targetType:"user",targetName:p,store:n}),g="user_permission"===(null==a?void 0:a[0].permissionItem.type)?a[0]:{from:{table:pn().ev,blockId:n.id},permissionItem:{role:o.role,type:"user_permission",user_id:t.value.id}},f=(0,i().v3)().currentUser.id,h=f&&g.permissionItem.user_id===f;return(0,_.jsx)(gn().A,{store:n,userPermission:g,showInherited:!1,selectFooter:(0,_.jsx)(hn().n,{targetName:p,targetType:"user",mostPermissivePermissions:a,hasInaccessiblePermissions:!1,isCurrentUser:Boolean(h)}),spaceVisibleUserMap:l,permissionItemArgs:d,tooltip:m,menuListItemProps:c})}function Sn(e){let{inviteTarget:t,blockStore:n,permissionItem:o,mostPermissivePermissions:i,permissionItemArgs:a,menuListItemProps:s}=e;const l=(0,mn().O)(),d=t.value.name,c=(0,vn().z)({permissionItem:o,targetType:"group",targetName:d,store:n}),u=(0,r().K8)((()=>function(e){var t;let{targetType:n,targetName:o,mostPermissivePermissions:i}=e;const r=null==i||null===(t=i.filter("user"===n?un().bn:An))||void 0===t?void 0:t[0];if(!r)return[];const a=(0,vt().PW)(r.permissionItem.role)?r.permissionItem.role:"none";if("none"===a)return[];return xn.map((e=>{if((0,cn().sO)(e,a))return;return{role:e,disabledInfo:{isDisabled:!0,disabledMessage:(0,_.jsx)(Mn,{targetType:n,permissionItem:r.permissionItem,targetName:o})}}})).filter(z().O9)}({targetType:"group",targetName:d,mostPermissivePermissions:i})),[i,d]),p="group_permission"===(null==i?void 0:i[0].permissionItem.type)?i[0]:{from:{table:pn().ev,blockId:n.id},permissionItem:{role:o.role,type:"group_permission",group_id:t.value.group_id}};return l?(0,_.jsx)(zt().A,{store:n,groupPermission:p,spaceId:l,showInherited:!1,isRemovableOverride:!0,permissionItemArgs:a,tooltip:c,roleItemOverrides:u,menuListItemProps:s}):null}const xn=["none","reader","comment_only","content_only_editor","read_and_write","membership_admin","editor"];function An(e){switch(e.permissionItem.type){case"space_permission":case"space_owner_permission":case"team_permission":case"team_owner_permission":case"explicit_team_permission":case"explicit_team_owner_permission":case"explicit_team_guest_permission":return!0;case"group_permission":case"bot_permission":case"deleted_permission":case"exclusive_user_permission":case"public_permission":case"restricted_permission":case"trusted_domain_permission":case"user_permission":case"collection_property_permission":return!1;default:return(0,z().ub)(e.permissionItem),!1}}function Mn(e){let{permissionItem:t,targetType:n,targetName:o}=e;return o&&"user"===n?(0,_.jsx)(s().sA,{id:"searchTargetPermissionItem.disabledMessage",defaultMessage:"To restrict {targetUserName}’s access, modify the “{permissionItemName}” setting on this page",values:{targetUserName:o,permissionItemName:(0,_.jsx)(fn()._,{permissionItem:t})}}):o&&"group"===n?(0,_.jsx)(s().sA,{id:"searchTargetPermissionItem.disabledMessageForGroup",defaultMessage:"To restrict the {targetGroupName} group’s access, modify the “{permissionItemName}” setting on this page",values:{targetGroupName:o,permissionItemName:(0,_.jsx)(fn()._,{permissionItem:t})}}):(0,_.jsx)(s().sA,{id:"searchTargetPermissionItem.disabledMessageWithoutName",defaultMessage:"To restrict access, modify the “{permissionItemName}” setting on this page",values:{permissionItemName:(0,_.jsx)(fn()._,{permissionItem:t})}})}const wn=o.memo(yn);function kn(e){var t,n;const{store:o,shouldShowSlackOnly:l,shouldShowGoogleOnly:d,calculatedPermissions:c,permissionItemArgs:u,tokenQuery:p,showShimmer:g,error:f,ready:h,result:v}=e,y=(0,i().v3)(),b=(0,s().tz)(),S=(0,r().uB)(e.inviteTargetsStore,de().Ay),x=(0,r().K8)((()=>U().Ay.state.display===U().pP.Invite&&U().Ay.state.focus&&"message"===U().Ay.state.focus),[]),A=(0,r().uB)(e.menuListStore,Ae().A),M=(0,Ft().x)(),w=(0,a().IS)((e=>({googleSlackIcons:{position:"relative",width:32,height:32},icons:{width:20,height:20,borderRadius:"50%",padding:2,border:`1px solid ${e.stroke.secondary}`,backgroundColor:e.palette.gray[0],position:"absolute"},sectionMenuItem:{display:"flex",flexDirection:"column",paddingTop:0,paddingLeft:8,paddingRight:8,paddingBottom:8},keepTypingMessage:{paddingLeft:Ce().rL,paddingRight:Ce().rL,marginTop:6,marginBottom:8,fontWeight:500},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.text.secondary,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:40,marginBottom:40},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:36,width:36,marginBottom:12,fill:e.icon.secondary},arrowUpLeftIcon:{width:se().Ev.sm,height:se().Ev.sm,marginTop:2,color:e.icon.tertiary}})),[]),k=(0,r().K8)((()=>o.getSpaceId()),[o]),j=function(e,t){const n=(0,i().v3)(),o=(0,r().K8)((()=>{if(0!==t.length)return{spaceId:e,userIds:t}}),[e,t],{useDeepEqual:!0}),[{value:a}]=(0,pt().Yb)((async()=>{if(void 0===o)return{};const t=await Ve().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:n,data:o,headers:(0,Vt().WS)({cellId:void 0,spaceId:e})});return"success"===t.type?t.data.userToGroupMap:{}}),[n,o,e],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3});return a}(k,(null==v?void 0:v.inviteUsers.map((e=>e.value.id)).filter((e=>void 0!==e)))??[]),C=c.pagePermissionUIModel,{inPageTargets:I,notInPageTargets:T,filteredImportedContacts:P,totalContactsCount:B}=(0,r().K8)((()=>{const{inviteUsers:e,inviteGroups:t,importedContacts:n=[],totalContactsCount:i}=v??{inviteUsers:[],inviteGroups:[],importedContacts:[],totalContactsCount:0},r=[...e,...t],a=[],s=[],l=new Set;r.forEach((e=>{"group"!==e.type&&l.add(e.value.email.toLowerCase());const t=Boolean(_t().wF({store:o,target:e}));if("existingUser"===e.type&&!Boolean(e.spaceRole)){let t;if(Dt().A.state.shouldUseEdgeCache){var n;const i=null===(n=Ot().W.getData(y,{userId:e.value.id,spaceId:o.getSpaceId()}))||void 0===n?void 0:n.membership_type;t=i?(0,yt().$N)(i):void 0}else{var i;t=null===(i=M.get(e.value.id))||void 0===i?void 0:i.role}e.spaceRole=t||"not_in_space"}const r=(0,E().NV)({inviteTarget:e,store:o,calculatedPermissions:c,userToGroupMap:j});void 0!==r&&(t||vt().Tt(r.permissionItem.role??"none"))&&"newUser"!==e.type?r&&a.push({inviteTarget:e,...r}):"newUser"!==e.type&&s.push({inviteTarget:e,...r})}));const d=n.filter((e=>!l.has(e.value.email.toLowerCase())));return{inPageTargets:a,notInPageTargets:s,filteredImportedContacts:d,totalContactsCount:i}}),[v,o,c,j,y,M]),{isValidEmail:L,isEmailInTargets:R}=(0,r().K8)((()=>{const e=(0,me().qh)(p);return{isValidEmail:(0,me().DT)(e),isEmailInTargets:[...I.map((e=>{let{inviteTarget:t}=e;return t})),...T.map((e=>{let{inviteTarget:t}=e;return t}))].some((t=>"group"!==t.type&&t.value.email===e))}}),[p,I,T]),D=(0,r().K8)((()=>S.state.inviteTargets.length>0),[S]),N=(0,Ke().J)(),O=(0,r().K8)((()=>!(!N||l||d)&&"empty_state"===Ge().default.getEligibleGroup({experimentId:"sharing_import_contacts_share_menu",parameter:"variant",defaultGroup:"control"})),[N,l,d]),F=L&&!R,V=c.showRestrictedPermissionBanner,K=!l&&!d&&T.length>0&&(0===p.length||0===(null==v?void 0:v.tokenQuery.length)),W=!l&&!d&&p.length>0&&Boolean(null==v||null===(t=v.tokenQuery)||void 0===t?void 0:t.length)&&I.length>0,H=!l&&!d&&T.length>0&&p.length>0&&Boolean(null==v||null===(n=v.tokenQuery)||void 0===n?void 0:n.length),G=P.filter((e=>"slack"===e.source)),Y=P.filter((e=>"google"===e.source)),q=G.length>0&&!O,Q=Y.length>0&&!O,Z=O&&(G.length>0||Y.length>0),X={key:"imported slack contacts",render:e=>(0,_.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.importedSlackContactsSection.title",defaultMessage:"From Slack"}),loading:!h}),items:jn({filteredContacts:G,environment:y,inviteTargetsStore:S,blockStore:o,spaceVisibleUserMap:M,tokenQuery:p,menuListStore:A})},J={key:"imported google contacts",render:e=>(0,_.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.importedGoogleContactsSection.title",defaultMessage:"From Google"}),loading:!h}),items:jn({filteredContacts:Y,environment:y,inviteTargetsStore:S,blockStore:o,spaceVisibleUserMap:M,tokenQuery:p,menuListStore:A})},ee={key:"mixed contacts",render:e=>(0,_.jsx)(jt().A,{...e,style:w.sectionMenuItem,loading:!h}),items:jn({filteredContacts:[...Y,...G].sort(((e,t)=>(e.value.name??"").localeCompare(t.value.name??""))),environment:y,inviteTargetsStore:S,blockStore:o,spaceVisibleUserMap:M,tokenQuery:p,menuListStore:A})},te=F||!K&&!W&&!H&&!q&&!Q&&!l&&!d&&p.length>0,ne=(0,xe().X)("edge_cache_member_email_domains"),oe=(0,Bt().h)(k),ie=(0,r().K8)((()=>{const e=Oe().subscriptionDataStoreInstance.state,{currentSpaceStore:t}=He().default.state;return t&&e?Et().Ye(e).map((n=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(n.userId)){const e=Nt().LU.createChildStore(t,{table:$().oo,id:n.userId}).getEmail();return e&&(0,me().zN)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]),re=ne?oe??[]:ie,ae=(0,Pt().A)(o);if(f)return(0,_.jsx)(It().z,{loading:!h,children:(0,_.jsx)(wt().A,{title:(0,_.jsx)(s().sA,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!h&&g)return(0,_.jsx)(Lt().J,{areaHeight:window.innerHeight});const le={key:"user results",render:e=>(0,_.jsx)(jt().A,{...e,style:w.sectionMenuItem,loading:!h,title:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:Nn({tokenQuery:p,possibleDomains:re,shouldShowAutoFillEmail:te,isGuestInviteRequestRequired:ae.isGuestRequestRequired,environment:y,inviteTargetsStore:S,menuListStore:A,styles:w})},ce={key:"import contacts",render:e=>(0,_.jsx)(jt().A,{...e,style:w.sectionMenuItem,loading:!h}),items:[{key:"import contacts",render:()=>(0,_.jsx)(At().A,{focused:!1,style:{cursor:"default"},caption:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.importContacts.caption",defaultMessage:"Add contacts from Google, Slack"}),icon:(0,_.jsxs)("div",{style:w.googleSlackIcons,children:[(0,_.jsx)(Le().Q,{iconGroup:Tt().mt,variantName:"default",style:{...w.icons,top:0,left:0}}),(0,_.jsx)(Le().Q,{iconGroup:Tt().jJ,variantName:"default",style:{...w.icons,bottom:0,right:0}})]}),right:(0,_.jsx)(Wt,{emailMessage:e.emailMessage??"",inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId,googleContacts:Y,slackContacts:G,totalContactsCount:B??0}),title:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.importContacts.title",defaultMessage:"Import contacts"})}),action:()=>{}}]},ue={key:"suggested",render:e=>(0,_.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!h}),items:T.map(((e,t)=>{let{inviteTarget:n,mostPermissivePermissions:i}=e;return{key:"newUser"===n.type?n.value.email:n.value.id,render:e=>{const t=be().P4({target:n,inviteTargetsStore:S});return(0,_.jsx)(Pn,{...e,intl:b,isMobile:y.device.isMobile,disabled:!1,inviteTarget:n,isInvited:t,spaceVisibleUserMap:M,store:o,mostPermissivePermissions:i})},action:()=>In({inviteTarget:n,inviteTargetsStore:S,menuListStore:A,rank:t,tokenQuery:p,environment:y,type:"suggested"})}}))},pe={key:"in page",render:e=>(0,_.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.inPageSection.titleRedesign",defaultMessage:"Already invited"}),loading:!h}),items:I.map(((e,t)=>{const{inviteTarget:n,permissionItem:i,mostPermissivePermissions:r}=e,{type:a}=n;if("existingUser"===a){if(!!r&&r.length>1)return{key:n.value.id,render:e=>(0,_.jsx)(Tn,{...e,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:r,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:V}),action:()=>{}};return C.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===n.value.id))?{key:n.value.id,render:e=>(0,_.jsx)(Tn,{...e,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:V}),action:()=>{}}:{key:n.value.id,render:e=>(0,_.jsx)(Tn,{...e,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:V}),action:()=>In({inviteTarget:n,inviteTargetsStore:S,menuListStore:A,rank:t,tokenQuery:p,environment:y,type:"in_page"})}}if("group"===a){if(!!r&&r.length>1)return{key:n.value.id,render:r=>(0,_.jsx)(Tn,{...r,blockStore:o,inviteTarget:n,permissionItem:i,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:V}),action:()=>{}};{const e=C.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===n.value.group_id));return e?{key:n.value.id,render:t=>(0,_.jsx)(At().A,{...t,itemMarginLeft:0,itemMarginRight:0,title:(0,_.jsx)(zt().A,{store:o,groupPermission:e,spaceId:o.getSpaceId(),showInherited:!0,permissionItemArgs:u})}),action:()=>{}}:{key:n.value.id,render:e=>(0,_.jsx)(Tn,{...e,blockStore:o,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:M,permissionItemArgs:u,rank:t,tokenQuery:p,isRestricted:V}),action:()=>In({inviteTarget:n,inviteTargetsStore:S,menuListStore:A,rank:t,tokenQuery:p,environment:y,type:"in_page"})}}}(0,z().HB)(a)}))},ge={key:"not in page",render:e=>(0,_.jsx)(jt().A,{...e,style:w.sectionMenuItem,title:p.length>0&&(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.notInPageSection.titleRedesign",defaultMessage:"Not invited to page"}),loading:!h}),items:T.map(((e,t)=>{let{inviteTarget:n,mostPermissivePermissions:i}=e;return{key:"newUser"===n.type?n.value.email:n.value.id,render:e=>(0,_.jsx)(Pn,{...e,disabled:!1,intl:b,isMobile:y.device.isMobile,inviteTarget:n,isInvited:be().P4({target:n,inviteTargetsStore:S}),spaceVisibleUserMap:M,store:o,mostPermissivePermissions:i}),action:()=>In({inviteTarget:n,inviteTargetsStore:S,menuListStore:A,rank:t,tokenQuery:p,environment:y,type:"not_in_page"})}}))};let fe=[];if(F&&fe.push(le),K&&fe.push(ue),W&&fe.push(pe),H&&fe.push(ge),q&&fe.push(X),Q&&fe.push(J),Z&&fe.push(ee),l&&(fe=[X],0===X.items.length))return(0,_.jsx)(Bn,{styles:w,importContactType:"slack"});if(d&&(fe=[J],0===J.items.length))return(0,_.jsx)(Bn,{styles:w,importContactType:"google"});if(0===fe.length){if(fe=[le],0===p.length&&!D)return O?(0,_.jsx)(Rn,{emailMessage:e.emailMessage,inviteTargetsStore:e.inviteTargetsStore,flowId:e.flowId}):(0,_.jsx)(Ln,{styles:w});if(0===p.length&&D)return(0,_.jsx)("div",{style:w.keepTypingMessage,children:(0,_.jsx)(m().A,{isSecondaryColor:!0,isSmall:!0,children:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})})})}else O&&fe.unshift(ce);return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(Gt,{publicPermission:c.mostPermissivePublicItem}),(0,_.jsx)(Mt().Ay,{type:Mt().Oh.Vertical,initialFocus:p.length>0?0:void 0,sections:fe,store:A,disableKeyboard:x})]})}function jn(e){const{filteredContacts:t,environment:n,inviteTargetsStore:o,blockStore:i,spaceVisibleUserMap:r,tokenQuery:a,menuListStore:s}=e;return t.map(((e,t)=>({key:e.value.email,render:t=>(0,_.jsx)(dn,{...t,isMobile:n.device.isMobile,disabled:!1,inviteTarget:e,isInvited:be().P4({target:e,inviteTargetsStore:o}),spaceVisibleUserMap:r,store:i}),action:()=>{be().P4({target:e,inviteTargetsStore:o})?o.setState({...o.state,inviteTargets:o.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(F().kH(n,{invite_token_query:a,selected_user_token:e,selected_user_token_rank:t,from:"share_modal_invite",subscription_tier:(0,Ut().AI)(),type:Cn(e)}),o.setState({inviteTargets:[...o.state.inviteTargets,e],tokenQuery:""}),s.unsetFocus())}})))}function Cn(e){return"google"===e.source?"google_contacts":"slack"===e.source?"slack":void(0,z().HB)(e.source)}function In(e){const{inviteTarget:t,inviteTargetsStore:n,menuListStore:o,rank:i,tokenQuery:r,environment:a,type:s}=e;be().lW({inviteTargetsStore:n,inviteTarget:t})&&F().kH(a,{invite_token_query:r,selected_user_token:t,selected_user_token_rank:i,from:"share_modal_invite",subscription_tier:(0,Ut().AI)(),type:s}),o.unsetFocus()}const Tn=o.forwardRef((function(e,t){const{inviteTarget:n}=e,o=n.type;switch(o){case"group":case"existingUser":return(0,_.jsx)(wn,{...e,inviteTarget:n});default:(0,z().HB)(o)}}));function _n(e,t,n){var o,i,r;return"group"===e.type?{targetType:"group",targetName:e.value.name,permissionItem:(null==n||null===(o=n[0])||void 0===o?void 0:o.permissionItem)??{type:"group_permission",role:"none",group_id:e.value.group_id}}:"existingUser"===e.type?{targetType:"user",targetName:q().Bj6.fromValue($().oo,e.value).getDisplayName(t),permissionItem:(null==n||null===(i=n[0])||void 0===i?void 0:i.permissionItem)??{type:"user_permission",role:"none",user_id:e.value.id}}:"newUser"===e.type?{targetType:"user",targetName:e.value.email,permissionItem:(null==n||null===(r=n[0])||void 0===r?void 0:r.permissionItem)??{type:"user_permission",role:"none",user_id:e.value.email}}:void(0,z().HB)(e)}function Pn(e){const{mostPermissivePermissions:t,inviteTarget:n,store:o,intl:i}=e,r=(0,a().IS)((()=>({tooltip:{maxWidth:240}})),[]),s=(0,vn().z)({store:o,..._n(n,i,t)});return(0,_.jsx)(Ct().A,{delayThreshold:0,placement:Rt().W.Left,textWrap:!0,style:r.tooltip,disableTooltip:!(0,z().O9)(s),renderTooltip:()=>s,render:t=>(0,_.jsx)("div",{...t,children:(0,_.jsx)(dn,{...e})})})}function Bn(e){const{styles:t,importContactType:n}=e,o="google"===n?"Google account":"Slack workspace";return(0,_.jsxs)("div",{style:t.zeroState,children:[(0,ht().G)(t.zeroStateIcon),(0,_.jsxs)("div",{style:t.zeroStateText,children:[(0,_.jsx)("div",{style:{fontWeight:w().Wy.semibold,marginBottom:4},children:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,_.jsx)("div",{children:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different {externalIntegrationCopy} or typing an email address",values:{externalIntegrationCopy:o}})})]})]})}function Ln(e){const{styles:t}=e;return(0,_.jsxs)("div",{style:t.zeroState,children:[(0,ft().x)(t.zeroStateIcon),(0,_.jsxs)("div",{style:t.zeroStateText,children:[(0,_.jsx)("div",{style:{fontWeight:w().Wy.semibold,marginBottom:4},children:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Members and guests will appear here"})}),(0,_.jsx)("div",{children:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try inviting someone with their email address or importing contacts"})})]})]})}function Rn(e){const{inviteTargetsStore:t,flowId:n,emailMessage:o}=e,r=(0,a().IS)((e=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,textAlign:"center",fontSize:14,position:"relative",pointerEvents:"auto",marginTop:32,marginBottom:24,gap:14},logos:{display:"flex",gap:12,alignItems:"center",justifyContent:"center"},text:{marginTop:6,textAlign:"center"},subtext:{color:e.text.secondary},button:{padding:"8px 12px"}})),[]),l=(0,st().Hc)(),d=(0,i().v3)(),c=(0,xe().X)("disconnect_contact_import"),u=(0,at().C)({onClickAuthenticated:e=>{c?dt().L.setState({open:!0,type:e}):(U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e,emailMessage:o??""}),t.setState({...t.state,tokenQuery:""}))},hideChevronIcon:!0,containerStyle:l.importListButtonContainer,buttonStyle:l.importListButton,flowId:n});return(0,_.jsxs)("div",{style:r.container,children:[(0,_.jsxs)("div",{style:r.logos,children:[(0,_.jsx)(Le().Q,{iconGroup:Tt().mt,variantName:"default",style:{height:22,width:22}}),(0,_.jsx)(Le().Q,{iconGroup:Tt().jJ,variantName:"default",style:{height:22,width:22}})]}),(0,_.jsxs)("div",{style:r.text,children:[(0,_.jsx)("div",{style:{fontWeight:w().Wy.semibold,marginBottom:4},children:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.title",defaultMessage:"Import contacts"})}),(0,_.jsx)("div",{style:r.subtext,children:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.text",defaultMessage:"Connect with Google or Slack"})})]}),(0,_.jsx)("div",{children:(0,_.jsx)(it().Ay,{popupType:kt().nl.Popup,alignmentToOrigin:it().yP.Start,placementToOrigin:it().sx.Left,render:()=>(0,_.jsx)(rt().A,{importListItems:u}),originGap:12,renderOrigin:e=>(0,_.jsx)(xt().E,{...e,onClick:()=>{var t;null===(t=e.onClick)||void 0===t||t.call(e),nt().V(d,{source:"share_menu_empty_state"})},style:r.button,children:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.getStartedImportContacts.button",defaultMessage:"Get started"})})})})]})}function Dn(e){let{tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:o}=e;const i=(0,bt().Ay)(t,function(e,t,n){return n?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,n)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:n}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,n,o),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:t,weight:0}]:i}function Nn(e){let{tokenQuery:t,possibleDomains:n,isGuestInviteRequestRequired:o,shouldShowAutoFillEmail:i,environment:r,inviteTargetsStore:a,menuListStore:l,styles:d}=e;return Dn({tokenQuery:t,possibleDomains:n,shouldShowAutoFillEmail:i}).map(((e,n)=>({key:e.tokenQuery,render:t=>(0,_.jsx)(At().A,{icon:(0,ft().x)({width:20,height:20}),title:(0,_.jsx)(On,{tokenQuery:e.tokenQuery,shouldShowAutofillEmail:i,isGuestInviteRequestRequired:o}),caption:o?(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:i&&(0,_.jsx)(Z().I,{icon:gt,size:"sm",color:"tertiary"}),...t}),action:async()=>{const o=(0,me().qh)(e.tokenQuery);if(!(0,me().DT)(o)){const t={type:"invalidUser",value:{text:e.tokenQuery}};return void(be().P4({target:t,inviteTargetsStore:a})||a.setState({inviteTargets:[...a.state.inviteTargets,t],tokenQuery:""}))}const i=await St().Ah(r,[o]);if(!i.length)return;const s=i[0];be().P4({target:s,inviteTargetsStore:a})||(F().kH(r,{invite_token_query:t,selected_user_token:s,selected_user_token_rank:n,from:"share_modal_invite",subscription_tier:(0,Ut().AI)(),type:"autofill"}),a.setState({inviteTargets:[...a.state.inviteTargets,s],tokenQuery:""}),l.unsetFocus())}})))}function On(e){const{tokenQuery:t,shouldShowAutofillEmail:n,isGuestInviteRequestRequired:o}=e;return o?(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):n?(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"“{tokenQuery}”",values:{tokenQuery:t}}):(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const En=function(e){const t=(0,i().v3)(),n=(0,s().tz)(),[a,l]=(0,o.useState)(!0),d=(0,r().K8)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,r().K8)((()=>{if(e.shouldShowSlackOnly||e.shouldShowGoogleOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=Ye().A.completeSlackAuthentications.state.length>0,n=Ye().A.externalAuthentications.state.filter((e=>e.integration_id===Fe().E8)).length>0;return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t||n?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly,e.shouldShowGoogleOnly]),u=(0,r().K8)((()=>{const e=Dt().A.state.shouldUseEdgeCache,t=Ge().default.checkGate({gateName:"edge_cache_share_menu"});return e&&t}),[]),[{value:p,status:m}]=(0,pt().Yb)((async()=>({...await St().hQ({query:d,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:n,shouldUseEdgeCacheRollout:u}).finally((()=>l(!1))),tokenQuery:d})),[t,n,e.membersOnly,d,c,u],{debounce:40});return(0,_.jsx)(kn,{...e,tokenQuery:d,showShimmer:a,ready:"pending"!==m&&"idle"!==m,error:"rejected"===m,result:p})};function Un(e){const t=(0,i().v3)(),n=(0,r().uB)(e.inviteTargetsStore,de().Ay),l=(0,r().K8)((()=>n.state.inviteTargets),[n]),{display:d,source:c,focus:u,emailMessage:p}=(0,r().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),g=(0,r().O$)(He().AppStoreCurrentSpaceStore),f=d===U().pP.Invite&&l.length>0,h=(0,r().K8)((()=>c===U().NL.Notion&&0===l.length),[l.length,c]),v=(0,r().O$)(Ye().A.completeSlackAuthentications),y=(0,r().K8)((()=>c===U().NL.Notion&&0===l.length),[l.length,c]),b=(0,r().K8)((()=>Ye().A.externalAuthentications.state.filter((e=>e.integration_id===Fe().E8))),[]),[S,x]=(0,o.useState)(!1),A=f&&!h,M=(0,o.useCallback)((()=>{n.reset()}),[n]);(0,o.useEffect)((()=>{if(g&&!S&&(h||y)){if(h)for(const e of v)Ve().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:g.id,integrationId:Fe().zG,importContactType:"slack"}}).catch((e=>{}));if(y)for(const e of b)Ve().callApi({eventName:"loadContacts",environment:t,data:{botId:e.id,spaceId:g.id,integrationId:Fe().E8,importContactType:"google"}}).catch((e=>{}));x(!0)}}),[h,y]);const w=function(e){let{scrollerMarginBottom:t}=e;const n=(0,i().v3)();return(0,a().IS)((e=>({scroller:{flexGrow:1,marginBottom:t},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8},importContactsButtonV2:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9,gap:8,fill:e.text.primary},warningLabel:{...(0,Ce().kJ)({theme:e,isMobile:n.device.isMobile}),display:"flex",alignItems:"center",gap:2,color:e.text.secondary}})),[t,n])}({scrollerMarginBottom:A?Xe:0}),k=(0,r().K8)((()=>!(0,E().Aj)({store:e.store})),[e.store]),j=(0,Ke().J)(),C=(0,r().K8)((()=>!(!j||c===U().NL.Slack||c===U().NL.Google)&&"empty_state"===Ge().default.getEligibleGroup({experimentId:"sharing_import_contacts_share_menu",parameter:"variant",defaultGroup:"control"})),[j,c]);return d!==U().pP.Invite?null:(0,_.jsxs)(_.Fragment,{children:[k&&(0,_.jsx)(m().A,{style:w.warningLabel,isMultiline:!0,children:(0,_.jsx)(s().sA,{id:"shareMenuSearchRequest.suggestedSectionWarning.title",defaultMessage:"Some users may already have access through a parent page or teamspace"})}),(0,_.jsx)(ze().H,{type:We().A.Y,style:w.scroller,children:(0,_.jsx)(En,{inviteTargetsStore:n,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:c===U().NL.Slack,shouldShowGoogleOnly:c===U().NL.Google,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,emailMessage:p,flowId:e.flowId})}),C?null:(0,_.jsx)(ct,{shouldShowSlackImportContactsButton:h,shouldShowGoogleImportContactsButton:y,emailMessage:p,inviteTargetsStore:n,emailMessageOpen:A,flowId:e.flowId,source:"share_menu"}),(0,_.jsx)(Je,{open:f&&!h,focus:u===U().yZ.Message,value:p,onFocus:()=>{c&&d===U().pP.Invite&&U().Ay.setState({...U().Ay.state,focus:U().yZ.Message,tab:U().QC.Share,display:d,source:c,emailMessage:p})},onChange:e=>{U().Ay.setState({...U().Ay.state,focus:u,tab:U().QC.Share,display:d,source:c,emailMessage:e.target.value})},onCancel:async()=>{await qe().T({environment:t,inviteTargetsStore:n})&&(qe().XP(t),M())},maxLength:1e3})]})}var Fn=()=>n(381349),Vn=()=>n(912913),zn=()=>n(891078),Kn=()=>n(107683),Wn=()=>n(49210);const Hn=(0,se().xh)("personCropCircleBadgeExclamationPoint",{default:{loader:()=>n.e(50710).then(n.bind(n,223331))},small:{loader:()=>n.e(50710).then(n.bind(n,577829))},fill:{loader:()=>n.e(50710).then(n.bind(n,565711))},fillSmall:{loader:()=>n.e(50710).then(n.bind(n,429926))}},["person","alert","exclamation","warning","user"]);var Gn=()=>n(7674),Yn=()=>n(204063),qn=()=>n(592674),$n=()=>n(868146);function Qn(e){const{email:t}=e;return(0,_.jsx)(ne().A,{avatar:{email:t},size:28})}function Zn(e){const{children:t}=e,n=(0,a().IS)((()=>({wrapper:{position:"relative"},shield:{position:"absolute",left:17,top:18}})),[]);return(0,_.jsxs)("div",{style:n.wrapper,children:[t,(0,_.jsx)("div",{style:n.shield,children:(0,_.jsx)(Le().Q,{iconGroup:$n().u,colorName:"secondary",variantName:"mini"})})]})}function Xn(e){const{rows:t,internalDomains:n}=e,o=(0,a().IS)((e=>({inviteTargetList:{background:e.surface.wash,borderRadius:12,maxHeight:227,overflowY:"auto",padding:"12px 16px",width:"100%"}})),[]);return(0,_.jsx)(ze().H,{type:We().A.Y,style:o.inviteTargetList,children:(0,_.jsx)(Q().Y1,{gap:16,children:t.map((e=>{const{type:t}=e;switch(t){case"new":return(0,_.jsx)(Jn,{email:e.email,internalDomains:n},e.email);case"existing":return(0,_.jsx)(eo,{userStore:e.userStore,internalDomains:n},e.userStore.id);default:(0,z().HB)(t)}}))})})}function Jn(e){const{email:t,internalDomains:n}=e,o=(0,ge().C7)(t,n);return(0,_.jsx)(to,{avatar:o?(0,_.jsx)(Zn,{children:(0,_.jsx)(Qn,{email:t})}):(0,_.jsx)(Qn,{email:t}),name:t,email:t})}function eo(e){const{userStore:t,internalDomains:n}=e,o=(0,s().tz)(),{name:i,email:a}=(0,r().K8)((()=>({name:t.getDisplayName(o),email:t.getEmail()})),[t,o]);if(!i||!a)return null;const l=(0,ge().C7)(a,n);return(0,_.jsx)(to,{avatar:l?(0,_.jsx)(Zn,{children:(0,_.jsx)(ne().A,{userStore:t,size:28})}):(0,_.jsx)(ne().A,{userStore:t,size:28}),name:i,email:a})}function to(e){const{avatar:t,name:n,email:o}=e;return(0,_.jsxs)(Q().Y1,{direction:"horizontal",gap:10,align:"center-left",children:[t,(0,_.jsxs)(Q().Y1,{gap:2,children:[(0,_.jsx)(X().D,{styleName:"Body-14px/Medium",children:n}),(0,_.jsx)(X().D,{styleName:"Caption-12px/Regular",colorName:"secondary",children:o})]})]})}function no(e){const{type:t}=e;switch(t){case"new":return e.email;case"existing":return e.userStore.getEmail();default:(0,z().HB)(t)}}function oo(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:a,onClickAddMembers:l,onClickManageGuests:d}=e,c=(0,i().v3)(),u=(0,s().tz)(),[p,m]=(0,r().K8)((()=>[n.id,n.getName()]),[n]),g=(0,r().K8)((()=>null==a?void 0:a.getUserId()),[a]),f=(0,r().K8)((()=>{var e;return(null===(e=qn().A.getData(c,{spaceId:p}))||void 0===e?void 0:e.filter((e=>e.hasGuests)).map((e=>e.domain)))??[]}),[c,p]),h=(0,we()._X)({name:"internal_guests",spaceId:p,userId:g,amount:0}),v=(0,o.useCallback)((()=>{const e=t.map(no).filter(z().O9);l(e)}),[t,l]);return h&&f?(0,_.jsx)(he().A,{debugName:"AddAsMembersModalContent",capture:!0,onEnter:v,children:(0,_.jsx)(Gn().tf,{header:(0,_.jsx)(Gn().YA,{iconAndTitle:(0,_.jsx)(Gn().ZQ,{iconGroup:Hn,iconColorName:"secondary",title:u.formatMessage(ro.title,{spaceName:m,guestLimit:h.limit.total})}),description:u.formatMessage(ro.description,{domain:f[0].url,p:e=>(0,_.jsx)(X().D,{colorName:"uiBluePrimary",children:(0,_.jsx)("p",{children:e})})})}),footer:(0,_.jsx)(io,{rowCount:t.length,onClickAddMembers:v,onClickManageGuests:d}),children:(0,_.jsx)(Xn,{rows:t,internalDomains:f})})}):null}function io(e){const{rowCount:t,onClickAddMembers:n,onClickManageGuests:o}=e,i=(0,s().tz)(),r=i.formatMessage(ro.addMember,{rowCount:t});return(0,_.jsxs)(Q().Y1,{gap:16,children:[(0,_.jsxs)(Q().Y1,{gap:8,children:[(0,_.jsx)(Yn().A,{"aria-label":r,onClick:n,style:{height:32},children:r}),(0,_.jsx)(J().A,{size:"lg","aria-label":i.formatMessage(ro.manageGuestsInSettings),onClick:o,children:i.formatMessage(ro.manageGuestsInSettings)})]}),(0,_.jsx)("div",{style:{textAlign:"center"},children:(0,_.jsx)(X().D,{styleName:"Caption-12px/Regular",colorName:"secondary",children:i.formatMessage(ro.billingNotice)})})]})}const ro=(0,s().YK)({title:{id:"addAsMembersModal.title",defaultMessage:"{spaceName} is over the guest limit of {guestLimit}"},description:{id:"addAsMembersModal.description",defaultMessage:"Shares to work email domains ending with ‘@{domain}’ must be added as members with access to your entire workspace."},addMember:{id:"addAsMembersModal.addMember",defaultMessage:"Add {rowCount, plural, one {member} other {{rowCount} members}}"},manageGuestsInSettings:{id:"addAsMembersModal.manageGuestsInSettings",defaultMessage:"Manage guests in settings"},billingNotice:{id:"addAsMembersModal.billingNotice",defaultMessage:"Each new member will be billed as an additional seat"}});n(16280);var ao=()=>n(857639),so=()=>n(319625),lo=()=>n(763824),co=()=>n(901389),uo=()=>n(436572),po=()=>n(402390),mo=()=>n(579627),go=()=>n(972435);async function fo(e){const{environment:t,email:n}=e,o=await Ve().callApi({eventName:"findUser",environment:t,data:{email:n}});if("success"===o.type){const e=o.data;if(e.value)return e.value.value.id}return await async function(e){const{environment:t,email:n}=e,o=await Ve().callApi({eventName:"createEmailUser",environment:t,data:{email:n,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:(0,po().H)(go().A.getIntl())}});if("failed"===o.type)throw o.error;return o.data.userId}({environment:t,email:n})}async function ho(e){const{blockPermissionItem:t,blockStore:n,environment:o,metadata:i,sudoModeStore:r}=e;await mo().J4({environment:o,store:n,sudoModeStore:r,permissionItems:[t],invite:i,skipGuestLimitValidation:!0})}var vo=()=>n(31082);const yo=(0,s().YK)({nonAdminCannotEditPermissions:{defaultMessage:"You do not have permission to invite guests to this page. Ask an admin to send the invite.",id:"permissions.nonAdminCannotEditPermissions.message"},guestsAreNotAllowed:{defaultMessage:"Members cannot invite guests to pages in this workspace. Ask an admin to send the invite.",id:"shareMenu.guestsAreNotAllowed.message"},unexpectedProcessInviteFailure:{defaultMessage:"Failed to process invite",id:"shareMenu.unexpectedProcessInviteFailure.message"}});async function bo(e){const{environment:t,intl:n,internalDomains:o,destination:i,invites:r,metadata:a,sudoModeStore:s,contextualInviteStore:l}=e,d=await async function(e){const{environment:t,invites:n,destination:o,metadata:i,sudoModeStore:r,contextualInviteStore:a}=e,s=(await(0,lo().lX)(n,20,(e=>async function(e){const{invite:t,environment:n,destination:o}=e,{blockStore:i,spaceStore:r}=o,{defaultAddability:a}=t;try{switch(a.type){case"none":throw new Error("Cannot send invite with none addability type");case"member":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:r,defaultAddability:a}=n;if(void 0===r)throw new Error("Expected invite.invitee to be defined");const{email:s}=r,{blockRole:l,blockStore:d,spaceRole:c,spaceStore:u}=o,{inviteOrigin:p}=i,m=await fo({environment:t,email:s});if(!m)throw new Error("Invitee user not found");const g={type:"user_permission",role:c,user_id:m},f={type:"user_permission",role:l,user_id:m};await async function(e){const{blockPermissionItem:t,blockStore:n,environment:o,inviteOrigin:i,spacePermissionItem:r,spaceStore:a,sudoModeStore:s}=e;if(t.user_id!==r.user_id)throw new Error("User IDs for block and space permission items must match");if(!a.isTeamsEnabled()&&!(await K().oH({environment:o,flowId:"",trackCreateTeamComplete:!1})))throw new Error("Failed to enable teams before creating member.");await mo().J4({environment:o,store:a,sudoModeStore:s,permissionItems:[r],invite:{inviteOrigin:i}}),await mo().J4({environment:o,store:n,sudoModeStore:s,permissionItems:[t],skipGuestLimitValidation:!0,invite:{inviteOrigin:i}})}({blockPermissionItem:f,blockStore:d,environment:t,inviteOrigin:p,spacePermissionItem:g,spaceStore:u});const h="member"===a.type&&"over_internal_guest_limit"===a.reason;return{type:"createdMember",invite:n,inviteeUserId:m,spacePermissionItem:g,blockPermissionItem:f,wasInternalDomainEnforced:h}}(e);case"member_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e,{invitee:r,internalDomain:a}=n;if(void 0===r)throw new Error("Expected invite.invitee to be defined");const{email:s}=r,{spaceStore:l}=o,{inviteMessage:d}=i,c=await fo({environment:t,email:s});if(!c)throw new Error("Invitee user not found");await async function(e){const{environment:t,spaceStore:n,inviteeUserId:o,inviteMessage:i}=e;if(n.canAdmin())throw new Error("This operation is not valid for workspace owners, because member requests are immediately approved when created by a workspace owner. Use createMember instead.");const r=await Ve().callApi({eventName:"requestAccess",environment:t,data:{type:"actor-to-space",forActorId:o,spaceId:n.id,message:i}});if("failed"===r.type)throw r.error}({environment:t,inviteeUserId:c,inviteMessage:d,spaceStore:l});const u=void 0!==a;return{type:"createdMemberRequest",invite:n,wasInternalDomainEnforced:u}}(e);case"guest":case"guest_page_add":case"member_page_add":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:r}=e,{invitee:a}=n;if(void 0===a)throw new Error("Expected invite.invitee to be defined");const{email:s}=a,{blockRole:l,blockStore:d}=o,c=await fo({environment:t,email:s});if(!c)throw new Error("Invitee user not found");const u={type:"user_permission",role:l,user_id:c};return await ho({blockPermissionItem:u,blockStore:d,environment:t,metadata:i,sudoModeStore:r}),{type:"addedUserPermission",invite:n,inviteeUserId:c,blockPermissionItem:u}}(e);case"guest_request":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i}=e;if(void 0===n.invitee)throw new Error("Expected invite.invitee to be defined");const{email:r}=n.invitee,{blockRole:a,blockStore:s,spaceStore:l}=o,{inviteMessage:d}=i,c={id:s.id,spaceId:l.id},u=await fo({environment:t,email:r});if(!u)return;return await async function(e){const{block:t,blockRole:n,environment:o,inviteeUserId:i,inviteMessage:r}=e,a=await Ve().callApi({eventName:"requestAccess",environment:o,data:{type:"guest-invite-request",block:t,forActorId:i,message:void 0,attributes:{role:n,inviteMessage:r}}});if("failed"===a.type)throw a.error}({block:c,blockRole:a,environment:t,inviteeUserId:u,inviteMessage:d}),{type:"createdGuestRequest",invite:n}}(e);case"group":return await async function(e){const{environment:t,invite:n,destination:o,metadata:i,sudoModeStore:r}=e,{blockRole:a,blockStore:s}=o;if("group"!==n.inviteTarget.type)throw new Error("Expected invite.inviteTarget to be a group");const l=n.inviteTarget.value,d={type:"group_permission",role:a,group_id:l.group_id};return await ho({blockPermissionItem:d,blockStore:s,environment:t,metadata:i,sudoModeStore:r}),{type:"addedGroupPermission",invite:n,group:l,blockPermissionItem:d}}(e);default:(0,z().HB)(a)}}catch(l){var s;const e=(0,so().A)(l).message,o={miscDataToConvertToString:{message:e,spaceId:r.id,blockId:i.id,actorUserId:n.currentUser.id,inviteeEmail:null===(s=t.invitee)||void 0===s?void 0:s.email,defaultAddabilityType:a.type}};let d,c;e.toLowerCase().includes("non-admin cannot edit permissions")?(d=!0,c="nonAdminCannotEditPermissions"):e.toLowerCase().includes("guests are not allowed")?(d=!0,c="guestsAreNotAllowed"):(d=!1,c="unexpectedProcessInviteFailure"),ao().log({level:d?"info":"error",from:"processInvite",type:c,data:o});const u=go().A.formatMessage(yo[c]);return void(d?co().rG({message:u}):co().f1(u))}}({environment:t,invite:e,destination:o,metadata:i,sudoModeStore:r})))).filter(z().O9);if(a){const e={};for(const t of s)"addedUserPermission"!==t.type&&"createdMember"!==t.type||"group"===t.invite.inviteTarget.type||(e[t.invite.inviteTarget.value.email]=t.inviteeUserId);a.setState({...a.state,invitedEmailToUserIdMap:e})}return s}({destination:i,environment:t,invites:r,metadata:a,sudoModeStore:s,contextualInviteStore:l});return(0,vo().Bw)({destination:i,environment:t,internalDomains:o,inviteResults:d,metadata:a}),0!==d.length&&(uo().D6({label:So({invites:r,intl:n})}),!0)}function So(e){var t;const{invites:n,intl:o}=e,i=null===(t=n[0].invitee)||void 0===t?void 0:t.email;i||o.formatMessage({id:"shareMenu.inviteResultsToast.label",defaultMessage:"Successfully sent"});const r=n.length-1;return n.filter((e=>{var t;return"member"!==(null===(t=e.invitee)||void 0===t?void 0:t.currentRole)})).length===n.length?r<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuest.label",defaultMessage:"Invite sent to {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.inviteGuests.label",defaultMessage:"Invite sent to {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:r}):r<=0?o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMember.label",defaultMessage:"Shared with {firstInvitee}"},{firstInvitee:i}):o.formatMessage({id:"shareMenu.inviteResultsToast.shareWithMultiple.label",defaultMessage:"Shared with {firstInvitee} and {numAdditionalInvites, plural, one {{numAdditionalInvites} other person} other {{numAdditionalInvites} others}}"},{firstInvitee:i,numAdditionalInvites:r})}function xo(e){e.reset(),U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.MainShareMenu,source:U().mc.ShareTopbarButton})}async function Ao(e){const{addAsMembersResult:t,destination:n,environment:o,internalDomains:i,intl:r,invites:a,inviteTargetsStore:s,metadata:l}=e;var d;t&&("manageGuests"===t?(d="members",De().A.setState({currentTab:d,defaultSubtab:void 0,highlightedSetting:void 0,open:!0,openedFrom:"share_menu"})):"addMembers"===t?(xo(s),await bo({destination:n,environment:o,internalDomains:i,invites:a,intl:r,metadata:l})):(0,z().HB)(t))}async function Mo(e){const{destination:t,contextualInviteStore:n,defaultAddabilities:o,metadata:i,invites:r,environment:a,internalDomains:s,intl:l,inviteTargetsStore:d,spaceStore:c,spaceUserStore:u,sudoModeStore:p}=e,m=r.map((e=>e.defaultAddability)).some((e=>"member"===e.type&&"over_internal_guest_limit"===e.reason)),g=r.map((e=>e.defaultAddability)).some((e=>["guest","guest_request","guest_page_add"].includes(e.type)));if(m){const e=r.map((e=>function(e){const{inviteTarget:t,environment:n}=e,{type:o}=t;switch(o){case"existingUser":return{type:"existing",userStore:new(Nt().LU)(n,{table:$().oo,id:t.value.id})};case"newUser":return{type:"new",email:t.value.email};case"group":return;default:(0,z().HB)(o)}}({environment:a,inviteTarget:e.inviteTarget}))).filter(z().O9),n=await async function(e){const{inviteUserListRows:t,spaceStore:n,spaceUserStore:o}=e;return await Wn().T.showAsyncModal((e=>(0,_.jsx)(Kn().s,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{type:"fixed",length:400}},render:()=>(0,_.jsx)(oo,{inviteUserListRows:t,spaceStore:n,spaceUserStore:o,onClickAddMembers:()=>{e.resolve("addMembers")},onClickManageGuests:()=>{e.resolve("manageGuests")}})})))}({inviteUserListRows:e,spaceStore:c,spaceUserStore:u});await Ao({addAsMembersResult:n,destination:t,environment:a,internalDomains:s,intl:l,invites:r,inviteTargetsStore:d,metadata:i})}else{xo(d);if(!(await bo({destination:t,environment:a,internalDomains:s,intl:l,invites:r,metadata:i,sudoModeStore:p,contextualInviteStore:n})))return;const e=r.map((e=>e.invitee)).filter(z().O9);g&&function(e){const{contextualInviteStore:t,defaultAddabilities:n,environment:o,invitees:i,spaceStore:r}=e,a=i.filter((e=>function(e){const t=e.type;return["guest","guest_request","guest_page_add"].includes(t)}(n[e.email]))).map((e=>({email:e.email,isGuest:"member"!==(null==e?void 0:e.currentRole)})));t.setState({...t.state,invitedUsers:a}),V().BY({environment:o,spaceStore:r,contextualInviteStore:t})}({contextualInviteStore:n,environment:a,spaceStore:c,defaultAddabilities:o,invitees:e})}}function wo(e){const{tooltip:t,disabled:n,onClick:o}=e;return(0,_.jsx)(Ct().A,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,_.jsx)(Yn().A,{size:"lg",style:{marginLeft:8,borderRadius:6,paddingLeft:12,paddingRight:12},disabled:n,onClick:o,...e,children:(0,_.jsx)(s().sA,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}var ko=()=>n(496603),jo=()=>n(401996),Co=()=>n(856952),Io=()=>n(381374),To=()=>n(126818),_o=()=>n(167355),Po=()=>n(822423),Bo=()=>n(234194),Lo=()=>n(120251);const Ro=(0,s().YK)({autojoinMember:{defaultMessage:"{email} will automatically be added to the workspace since @{domain} is an allowed email domain",id:"inviteTargetToken.autojoinMember.tooltip"},guestsDisabledMember:{defaultMessage:"Since guests are disabled, {email} will automatically be added to the workspace as a member",id:"inviteTargetToken.guestsDisabledMember.tooltip"},guestV2:{defaultMessage:"Invite {email} as a guest",id:"inviteTargetToken.guest.tooltipV2"},guestRequest:{id:"inviteTargetToken.guestRequest.tooltip",defaultMessage:"This guest must be approved by a workspace owner first"},invalidUser:{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip"},overInternalGuestLimit:{id:"inviteTargetToken.overInternalGuestLimit.tooltip",defaultMessage:"This workspace has reached its internal guest limit"},disabledByAdmins:{id:"inviteTargetToken.disabledByAdmins.tooltip",defaultMessage:"Inviting users has been disabled by admins for this page"},notAuthorizedDomain:{id:"inviteTargetToken.notAuthorizedDomain.tooltip",defaultMessage:"{email} does not belong to an allowed email domain"}});function Do(e){const{inviteTarget:t,defaultAddability:n,onClickRemove:i}=e,r=function(e,t){if("group"===e.type)return"gray";if("invalidUser"===e.type)return"red";if("existingUser"!==e.type&&"newUser"!==e.type)return(0,z().HB)(e);if(void 0===t)return"red";if("member"===t.type)return"autojoin_domain"===t.reason||"guests_disabled"===t.reason?"green":"over_internal_guest_limit"===t.reason?"yellow":(0,z().HB)(t.reason);if("member_request"===t.type)return"red";if("member_page_add"===t.type)return"gray";if("guest"===t.type)return"yellow";if("guest_request"===t.type)return"yellow";if("guest_page_add"===t.type)return"yellow";if("none"===t.type){if("must_upgrade"===t.reason)return"yellow";if("over_internal_guest_limit"===t.reason)return"red";if("over_general_guest_limit"===t.reason)return"red";if("disabled_by_admins"===t.reason)return"red";if("not_authorized_domain"===t.reason)return"red";if("invalid_email"===t.reason)return"red";if("other"===t.reason)return"red";(0,z().HB)(t.reason)}else(0,z().HB)(t)}(t,n),a=(0,s().tz)(),l=Oo(r),d=(0,o.useCallback)((()=>{i(t)}),[t,i]),c=function(e){const{inviteTarget:t,defaultAddability:n,intl:o}=e,i=je(t),r=t.type;if("group"===r)return;if("invalidUser"===r)return o.formatMessage(Ro.invalidUser,{text:t.value.text});if(!i)return;if("existingUser"!==r&&"newUser"!==r)return(0,z().HB)(r);if(void 0===n)return;if("none"===n.type){if("must_upgrade"===n.reason)return;if("other"===n.reason)return;if("over_internal_guest_limit"===n.reason)return o.formatMessage(Ro.overInternalGuestLimit);if("over_general_guest_limit"===n.reason)return o.formatMessage(Ro.overInternalGuestLimit);if("disabled_by_admins"===n.reason)return o.formatMessage(Ro.disabledByAdmins);if("not_authorized_domain"===n.reason)return o.formatMessage(Ro.notAuthorizedDomain,{email:i});if("invalid_email"===n.reason)return o.formatMessage(Ro.invalidUser,{text:"unknown"});(0,z().HB)(n.reason)}if("member"===n.type)return"autojoin_domain"===n.reason?o.formatMessage(Ro.autojoinMember,{email:i,domain:(0,me().zN)(i)}):"guests_disabled"===n.reason?o.formatMessage(Ro.guestsDisabledMember,{email:i}):"over_internal_guest_limit"===n.reason?i:(0,z().HB)(n.reason);if("member_request"===n.type)return o.formatMessage(Ro.disabledByAdmins);if("member_page_add"===n.type)return i;if("guest"===n.type)return o.formatMessage(Ro.guestV2,{email:i});if("guest_request"===n.type)return o.formatMessage(Ro.guestRequest);if("guest_page_add"===n.type)return o.formatMessage(Ro.guestV2,{email:i});(0,z().HB)(n)}({inviteTarget:t,defaultAddability:n,intl:a});return(0,_.jsx)(Ct().A,{placement:Rt().W.Top,renderTooltip:()=>c,disableTooltip:!c,render:e=>(0,_.jsx)("div",{style:{maxWidth:"100%"},...e,children:(0,_.jsxs)(Q().Y1,{gap:2,style:l.token,borderRadius:4,padding:"2px 4px",width:"hug",children:[(0,_.jsxs)(Q().Y1,{align:"center-left",borderRadius:3,direction:"horizontal",gap:4,width:"hug",children:[(0,_.jsx)(No,{inviteTarget:t,tokenColor:r}),(0,_.jsx)(X().D,{colorName:Eo(r),styleName:"UIRegular-14px/Regular",customStyles:l.label,children:zo(t,a)}),(0,_.jsx)(Qt().A,{hoveredStyle:l.removeButtonHovered,pressedStyle:l.removeButtonPressed,onClick:d,children:(0,_.jsx)(Le().Q,{iconGroup:Lo().k,colorName:"secondary",variantName:"small"})})]}),(0,_.jsx)(Me().A,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,_.jsx)("div",{style:{marginLeft:24,paddingBottom:2},children:(0,_.jsx)(X().D,{colorName:"secondary",styleName:"UISmall-12px/Medium",children:null==n?void 0:n.type})}),whenDisabled:null})]})})})}function No(e){const{inviteTarget:t,tokenColor:n}=e,o=Oo(n);switch(n){case"green":return(0,_.jsx)(Le().Q,{iconGroup:To().g,colorName:"greenPrimary",variantName:"default"});case"yellow":return(0,_.jsx)(Le().Q,{iconGroup:Po().u,colorName:"yellowPrimary",variantName:"default"});case"red":return(0,_.jsx)(Le().Q,{iconGroup:_o().F,colorName:"uiRedPrimary",variantName:"default"});case"gray":return"existingUser"===t.type?(0,_.jsx)(Q().Y1,{align:"center",width:20,height:20,children:(0,_.jsx)(ne().A,{userValue:t.value,size:16})}):(0,_.jsx)("div",{style:o.iconCircle,children:(0,Bo().M)(o.icon)});default:(0,z().HB)(n)}}function Oo(e){return(0,a().IS)((t=>({token:Uo(e,t),iconCircle:{alignItems:"center",backgroundColor:t.white,borderRadius:"50%",display:"flex",height:16,justifyContent:"center",width:16},icon:{color:t.icon.secondary,height:12,width:12},label:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},removeButtonHovered:{background:"transparent",opacity:.8},removeButtonPressed:{background:"transparent",opacity:.6}})),[e])}function Eo(e){switch(e){case"green":return"greenPrimary";case"yellow":return"yellowPrimary";case"red":return"uiRedPrimary";case"gray":return"grayPrimary";default:(0,z().HB)(e)}}function Uo(e,t){return{background:Fo(e,t),border:Vo(e,t)}}function Fo(e,t){switch(e){case"green":return t.fill.greenPrimary;case"yellow":return t.fill.yellowSecondary;case"red":return t.tint.uiRed;case"gray":return t.legacyDefaultSelectColor;default:(0,z().HB)(e)}}function Vo(e,t){switch(e){case"red":return`1px dashed ${t.stroke.uiRedPrimary}`;case"green":case"yellow":case"gray":return;default:(0,z().HB)(e)}}function zo(e,t){const{type:n}=e;switch(n){case"newUser":return e.value.email.trim();case"invalidUser":return e.value.text.trim();case"existingUser":return q().Bj6.fromValue($().oo,e.value).getDisplayName(t);case"group":return(0,nn().Pf)({intl:t,groupName:e.value.name});default:(0,z().HB)(n)}}function Ko(e){const{addabilities:t,disabled:n,metadata:s,focus:l,onFocus:d,onInputChanged:c,onSubmit:u,placeholder:p,right:m,showEmptyError:g,setAutoFocusInput:h}=e,v=(0,i().v3)(),y=(0,r().uB)(e.inviteTargetsStore,de().Ay),b=(0,r().K8)((()=>y.state.inviteTargets),[y]),S=function(e){const{disabled:t,hasTokens:n}=e;return(0,a().IS)((e=>({tokenSpan:{maxWidth:"100%"},inputRightItemStyle:{alignSelf:"flex-start"},inputOuterStyle:{borderRadius:6,...t&&{background:e.inputBackground,color:e.text.secondary,fill:Fn().Ay.white,opacity:.4},alignItems:"flex-start"},inputAndTokenWrapRight:{gap:2},inputInnerStyle:{...!n&&{padding:2}},warningMessage:{color:"#DE5550"}})),[n,t])}({disabled:n,hasTokens:b.length>0}),x=(0,r().K8)((()=>y.state.tokenQuery),[y]),{inputFieldText:A}=(0,r().K8)((()=>({inputFieldText:y.state.tokenQuery.trim()})),[y]),M=(0,o.useCallback)((e=>{jo().S({inviteTargetsStore:y,targetToRemove:e})}),[y]);return b?(0,_.jsx)(Co().Ay,{focus:l,focusAfterAnimation:!0,onClick:()=>{f().A.isMobile||null==d||d()},format:Co().le.Share,value:x,onChange:e=>{if(0===A.length){const e=U().Ay.state;U().Ay.setState({...e,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e.display===U().pP.Invite?e.source:U().NL.Notion,emailMessage:e.display===U().pP.Invite?e.emailMessage:""}),null==h||h(!1)}jo().P({environment:v,event:e,inviteTargetsStore:y,inviteOrigin:s.inviteOrigin,flowId:s.inviteFlowId,onInputChanged:c})},type:"email",tokens:b.map(((e,n)=>(0,_.jsx)(Do,{inviteTarget:e,onClickRemove:M,defaultAddability:Wo(e,t)},n))),disabled:n,autoComplete:"off",placeholder:p,onRemoveLastToken:()=>{y.setState({...y.state,inviteTargets:y.state.inviteTargets.slice(0,-1)})},right:m,rightWrapStyle:S.inputRightItemStyle,showBorder:!0,inputStyle:S.inputInnerStyle,inputAndTokenWrapRightStyle:S.inputAndTokenWrapRight,style:S.inputOuterStyle,onSubmit:u,inputFullWidth:!0,message:(0,_.jsx)(Io().p,{invalidInvites:(0,ko().oE)(b.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:g,styles:S.warningMessage})}):null}function Wo(e,t){const n=je(e);if(n)return null==t?void 0:t[n]}var Ho=()=>n(133507);function Go(e){const{onClick:t,featureAvailability:n}=e;return(0,_.jsx)(Ct().A,{disableTooltip:!1,renderTooltip:()=>(0,_.jsx)(Ho().j,{featureAvailability:n}),render:e=>(0,_.jsx)(Yn().A,{size:"lg",style:{marginLeft:8},onClick:t,...e,children:(0,_.jsx)(s().sA,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}const Yo=1e3;function qo(e){const{blockStore:t,contextualInviteStore:n,defaultAddabilities:l,internalDomains:d,inviteTargetsStore:c,invites:u,metadata:p,spaceRole:m,spaceStore:g,spaceUserStore:f,sudoModeStore:h}=e,v=(0,i().v3)(),y=(0,s().tz)(),b=(0,a().IS)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:24,borderRadius:4,color:Fn().Ay.uiGray}})),[]),[S,x]=(0,o.useState)("editor"),[A,M]=(0,o.useState)(!1),{source:w,focus:k,emailMessage:j,display:C}=(0,r().K8)((()=>{const{display:e}=U().Ay.state;return e===U().pP.Invite?U().Ay.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),I=(0,r().K8)((()=>t.getType()),[t]),{inviteTargets:T,inputFieldText:P}=(0,r().K8)((()=>({inviteTargets:(0,be().U1)({inviteTargetsStore:c,includeInputFieldText:!0}),inputFieldText:c.state.tokenQuery.trim()})),[c]),B=async()=>{if(!A&&l&&d){if(0===T.length){const e=U().Ay.state;return U().Ay.setState({...e,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:e.display===U().pP.Invite?e.source:U().NL.Notion,emailMessage:e.display===U().pP.Invite?e.emailMessage:""}),void F().UC(v,{source:"invite_button"})}M(!0);try{const e={blockRole:S,blockStore:t,spaceRole:m,spaceStore:g};await Mo({contextualInviteStore:n,defaultAddabilities:l,destination:e,environment:v,internalDomains:d,intl:y,invites:u,inviteTargetsStore:c,metadata:p,spaceStore:g,spaceUserStore:f,sudoModeStore:h})}finally{M(!1)}}},L=(0,Te().sf)(u.map((e=>e.invitee)).filter(z().O9)),R=(0,r().K8)((()=>f.getUserId()),[f]),D=(0,we()._X)({name:"guests",spaceId:g.id,userId:R,amount:L}),N=(0,r().K8)((()=>t.canEditMembership()),[t]),O=(0,zn().i0)(t),E=(0,zn().ty)(t),V=Object.values(l??{}).some((e=>"none"===e.type||"member_request"===e.type)),K=j.length>Yo,W=A||!N||O||E,[H,G]=(0,o.useState)(!W);return(0,_.jsx)(Ct().A,{disableTooltip:N&&!O&&!E,placement:Rt().W.Left,renderTooltip:()=>N?O?(0,_.jsx)(s().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.pageInTrash",defaultMessage:"Restore page from trash to add people"}):E?(0,_.jsx)(s().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.hasAIEdits",defaultMessage:"Resolve pending edits to add people"}):void 0:(0,_.jsx)(s().sA,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip.needFullAccessRedesign",defaultMessage:"Request full access to share with others"}),render:e=>(0,_.jsxs)("div",{style:{display:"flex"},...e,children:[(0,_.jsx)(Ko,{inviteTargetsStore:c,metadata:p,focus:k===U().yZ.Search||C===U().pP.MainShareMenu&&H,setAutoFocusInput:G,addabilities:l,disabled:W,onFocus:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:w||U().NL.Notion,emailMessage:j||""}),F().Wd(v,{source:w||U().NL.Notion}),0===T.length&&F().UC(v,{source:"invite_button"})},onSubmit:()=>{P.length>0||B()},placeholder:y.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}),right:P.length>0&&U().Ay.getState().display===U().pP.Invite||T.length>0?(0,_.jsx)(Vn().Ay,{disabled:!N||O||E,role:S,table:"block",type:"user_permission",blockType:I,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:b.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>x(e)}):void 0}),D&&(0,we().N9)(D,{available:()=>(0,_.jsx)(wo,{tooltip:j.length>Yo?(0,_.jsx)(s().sA,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,disabled:!N||O||E||V||K,onClick:B}),unavailable:e=>(0,_.jsx)(Go,{featureAvailability:e,onClick:()=>{U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:void 0,source:w||U().NL.Notion,emailMessage:j||""}),St().D6({environment:v,upgradeButtonName:"user_permission_item"})}})})]})})}var $o=()=>n(347930);const Qo=function(e){const t=(0,a().DP)(),{buttonStyle:n}=(0,a().IS)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,whiteSpace:"nowrap",height:28,borderRadius:6,boxShadow:e.shadow2XS,background:e.inputBackground,color:e.text.secondary,fill:Fn().Ay.white,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontSize:14}})),[]);return(0,_.jsx)(Qt().A,{hovered:e.hovered,onClick:e.onClick,disabled:e.disabled,disabledFeedback:!0,style:{...n,...e.isLarge&&{height:32},...e.style},hoveredStyle:{background:t.buttonHoveredBackground},pressedStyle:{background:t.buttonPressedBackground},onFocus:e.onFocus,onBlur:e.onBlur,onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,className:e.className,children:e.children})};const Zo=function(e){const{store:t}=e,{isMobile:o}=(0,i().Y0)(),l=(0,r().K8)((()=>t.canEditMembership()),[t]),d=(0,zn().i0)(t),c=(0,zn().ty)(t),u=(0,a().IS)((e=>({buttonContainer:{display:"flex",alignItems:"center",gap:$e().Y3},inputButton:{flex:1,justifyContent:"flex-start",overflow:"hidden",background:e.tint.regular,borderRadius:10,color:e.text.tertiary,boxShadow:"none",height:o?36:30},inputContent:{display:"flex",alignItems:"center",fontSize:16,fontWeight:400,...w().RC},iconContainer:{fill:e.icon.secondary,marginRight:8},blueButton:{minWidth:$e().CO}})),[o]);return(0,_.jsx)(Ct().A,{renderTooltip:()=>c?(0,_.jsx)(s().sA,{id:"inviteUserButton.tooltip.resolveAIEditsMessage",defaultMessage:"Resolve pending edits to add people"}):(0,_.jsx)(s().sA,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:l&&!d&&!c,render:t=>(0,_.jsxs)("div",{style:u.buttonContainer,...t,children:[(0,_.jsx)(Qo,{onClick:e.onClick,disabled:!l||d||c,style:u.inputButton,children:(0,_.jsx)("div",{style:u.inputContent,children:o?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{style:u.iconContainer,children:(0,n(381138).q)({height:16,width:16})}),(0,_.jsx)(s().sA,{defaultMessage:"Invite people, emails, groups...",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots.mobile"})]}):(0,_.jsx)(s().sA,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!o&&(0,_.jsx)(Yn().A,{size:"lg",onClick:e.onClick,disabled:!l||d||c,style:u.blueButton,children:(0,_.jsx)(s().sA,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function Xo(e){const{store:t,permissionItemArgs:n}=e,{onUpgradeButtonClick:l}=n,d=(0,i().v3)(),c=(0,i().WS)(),u=(0,r().uB)(void 0,N().A),p=(0,r().K8)((()=>u.state.permissionsInviteStore),[u]),m=(0,r().K8)((()=>u.stage),[u]),g=(0,r().K8)((()=>p.state.modalOpen),[p]),f=(0,r().K8)((()=>t.canAdmin()),[t]),h=(0,r().K8)((()=>{const e=Oe().subscriptionDataStoreInstance.state;return Boolean(e&&Et().Fq(e))}),[]),v=(0,r().K8)((()=>(0,E().Xh)({store:t})),[t]),y=(0,a().IS)((e=>({button:{display:"flex",alignItems:"center",minHeight:0,marginBottom:16},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[]),b=(0,o.useCallback)(((e,t)=>{e&&t>0&&uo().D6({label:(0,_.jsx)(s().sA,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:c?y.requestedUsersToast:void 0})}),[c,y.requestedUsersToast]);return m!==D().d5.closed||c&&!f?null:(0,_.jsx)(Qt().A,{disabled:!0,style:y.button,children:(0,_.jsxs)("div",{style:y.buttonInner,children:[g&&(0,_.jsx)($o().H,{store:t,disabled:!f,membersOnly:v,isSubscribed:h,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:y.modalButton,permissionsInviteStore:p,onInviteComplete:b,analyticsFrom:"mobile_invite"}),(0,_.jsx)(Zo,{store:t,onClick:()=>(0,_t().LH)({environment:d,permissionsInviteStore:p,store:t,isSubscribed:h,renderInShareModal:!1})})]})})}var Jo=()=>n(42476),ei=()=>n(179030);function ti(e){const{spaceName:t,domainUrl:n}=e,o=(0,s().tz)();return(0,_.jsx)(ei().l,{tint:"gray",iconGroup:Jo().A,label:o.formatMessage(ni.label,{spaceName:t}),description:o.formatMessage(ni.description,{domain:n}),display:"inline"})}const ni=(0,s().YK)({label:{id:"shareMenu.overLimitBanner.label",defaultMessage:"{spaceName} is over the guest limit"},description:{id:"shareMenu.overLimitBanner.description",defaultMessage:"If you share this page to a ‘@{domain}’ email, the invite will be sent to your workspace owners as a request to add them as a member with full access to the workspace."}});function oi(e){const{blockStore:t,contextualInviteStore:n,inviteTargetsStore:s,permissionItemArgs:l,spaceStore:d,spaceUserStore:c}=e,u=(0,i().Y0)(),p=u.isMobile,{spaceId:m,spaceName:g,userId:f,spaceModel:h}=(0,r().K8)((()=>({spaceId:d.getSpaceId(),spaceName:d.getName(),userId:c.getUserId(),spaceModel:d.getModel()})),[d,c]),v=(0,r().K8)((()=>(0,Se().Uo)(t)),[t]),[y,b]=(0,r().K8)((()=>[null==c?void 0:c.getModel(),null==v?void 0:v.getModel()]),[c,v]),S=(0,r().K8)((()=>U().Ay.state.display),[]),A=function(e){return(0,a().IS)((()=>({container:{position:"relative",height:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:e?"80vh":530}})),[e])}((0,xe().X)("collection_property_permissions")),M=(0,r().uB)(void 0,Ae().A),w=(0,r().K8)((()=>n.state.flowId),[n]),k=function(e){const t=(0,i().Y0)();return(0,o.useCallback)((n=>{n.preventDefault(),t.isMobile||e!==U().pP.MainShareMenu||U().Ay.setState({...U().Ay.state,tab:U().QC.Share,display:U().pP.Invite,focus:U().yZ.Search,source:U().NL.Notion,emailMessage:""})}),[t,e])}(S),j=(0,r().K8)((()=>(0,be().U1)({inviteTargetsStore:s,includeInputFieldText:!0}).map((e=>{const t=function(e){const{inviteTarget:t,spaceStore:n}=e,o=je(t);if(!o||"invalidUser"===t.type||"group"===t.type)return;if("newUser"===t.type)return{email:o,currentRole:void 0};const i=(0,x().dp)(n,t.value.id);if(!i.isReady())return;return{email:o,currentRole:i.isPageGuest()?"guest":i.isMember()?"member":void 0}}({inviteTarget:e,spaceStore:d});return{inviteTarget:e,invitee:t}})).filter(z().O9)),[s,d]),C=(0,ke().mF)({space:d,spaceUser:c,team:v,invitees:j.map((e=>e.invitee)).filter(z().O9),store:t}),T=(0,ye().A)(d),P=j.map((e=>e.invitee)).filter((e=>void 0!==e&&void 0===e.currentRole&&T&&(0,ge().C7)(e.email,T))),B=(0,we()._X)({name:"internal_guests",spaceId:m,userId:f,amount:P.length}),L=(0,we().P9)({name:"non_admin_members",spaceId:m,userId:f})?"read_and_write":"editor",R=(0,ve().r1)({spaceStore:d}),D=(0,r().K8)((()=>{const e=U().Ay.state,t=e.display===U().pP.Invite?e.emailMessage:"";return{inviteFlowId:n.state.flowId,inviteMessage:t,inviteOrigin:"share_menu",shareMenuSessionId:e.sessionId}}),[n]),N=(0,r().K8)((()=>C?j.map((e=>{const{inviteTarget:t,invitee:n}=e,o=null==n?void 0:n.email;let i,r;return"group"===t.type?r={type:"group"}:o?(i=(0,ge().CH)(o,T??[]),r=C[o]??{type:"none",reason:"other"}):r={type:"none",reason:"other"},{defaultAddability:r,internalDomain:i,invitee:n,inviteTarget:t}})):[]),[j,C,T]),O=(0,fe().Vi)(B,(()=>{if(!g)return;if(R)return;const e=P[0];if(!e)return;const t=(0,me().zN)(e.email);return t?(0,_.jsx)(ti,{spaceName:g,domainUrl:t}):void 0})),E=(0,xe().X)("share_menu_inheritance_banner");return(0,_.jsx)(he().A,{debugName:"ShareMenuShareTab",capture:!0,onTab:k,children:(0,_.jsxs)("div",{style:A.container,children:[(0,_.jsxs)(Q().Y1,{direction:"vertical",gap:16,padding:p?`0 ${Ce().u6}px 0px ${Ce().u6}px`:`0 ${Ce().rL}px 8px ${Ce().rL}px`,children:[u.isMobile?(0,_.jsx)(Xo,{store:t,permissionItemArgs:l}):(0,_.jsx)(qo,{blockStore:t,contextualInviteStore:n,defaultAddabilities:C,internalDomains:T,invites:N,inviteTargetsStore:s,metadata:D,spaceRole:L,spaceStore:d,spaceUserStore:c,sudoModeStore:l.sudoModeStore}),O]}),S===U().pP.MainShareMenu&&(0,_.jsx)(I().default,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:l,showPermissionInheritanceBanner:E}),S===U().pP.Invite&&!u.isMobile&&(0,_.jsx)(Un,{store:t,inviteTargetsStore:s,menuListStore:M,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:w}),(0,_.jsx)(Me().A,{featureGateId:"guest_limit_debug_ui",whenEnabled:(0,_.jsx)(Ee,{domains:T,spaceId:m,spaceModel:h,userId:f,spaceUserModel:y,teamModel:b,blockStore:t}),whenDisabled:null})]})})}const ii=function(e){const{store:t,sudoModeStore:o}=e,i=(0,r().K8)((()=>o.state.changePermissionsEnabled),[o]),l=(0,r().K8)((()=>o&&o.shouldUserHaveAccessToPrivatePageBlock()&&!o.doesUserAlreadyHaveEditorAccess(t.pointer)&&o.state.privatePageStore),[o,t]),d=(0,a().IS)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.shadow2XS,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:w().Wy.medium,justifyContent:"center",marginTop:8,opacity:i?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:i?"rotate(-90deg)":void 0}})),[i]);return l?(0,_.jsxs)("div",{style:d.container,children:[(0,_.jsx)(m().A,{isMultiline:!0,children:(0,_.jsx)(s().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,_.jsx)("b",{children:t})}}})}),(0,_.jsxs)(J().A,{size:"lg",disabled:i,style:d.button,onClick:()=>{o.setState({...o.state,changePermissionsEnabled:!0})},children:[(0,n(126553).x)(d.icon),i?(0,_.jsx)(s().sA,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,_.jsx)(s().sA,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function ri(e){const t=(0,r().K8)((()=>U().Ay.state.tab),[]);switch(t){case U().QC.Share:return(0,_.jsx)(oi,{...e,blockStore:e.store});case U().QC.Publish:return(0,_.jsx)(pe,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,z().HB)(t)}}function ai(){const e=(0,i().Y0)(),t=(0,a().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",height:276},offlineMessageHeadline:{fontWeight:w().Wy.medium},iconStyle:{width:32,height:32,marginBottom:10,fill:e.icon.tertiary}})),[]);return(0,_.jsxs)("div",{style:t.container,children:[le(t.iconStyle),(0,_.jsx)("div",{style:t.offlineMessageHeadline,children:(0,_.jsx)(m().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,_.jsx)(s().sA,{defaultMessage:"You're offline",id:"blockPermissionsSettings.offline.headline"})})}),(0,_.jsx)(m().A,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,_.jsx)(s().sA,{defaultMessage:"Go online to share and publish",id:"blockPermissionsSettings.offline.prompt"})})]})}const si=function(e){const{store:t,permissionItemArgs:o}=e,i=(0,r().uB)(e.inviteTargetsStore,de().Ay),s=(0,a().IS)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]),l=(0,r().O$)(n(227440).e);return(0,_.jsxs)("div",{style:s.container,children:[o.sudoModeStore&&(0,_.jsx)(ii,{store:t,sudoModeStore:o.sudoModeStore}),!f().A.isMobile&&(0,_.jsx)(ce().aR,{inviteTargetsStore:i,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),l?(0,_.jsx)(ri,{inviteTargetsStore:i,...e}):(0,_.jsx)(ai,{})]})};function li(e){const{store:t,sudoModeStore:n,onUpgradeButtonClick:l,location:d}=e,w=(0,i().v3)(),k=(0,i().Y0)();(0,b().fJ)(R().Ns.publishSite),(0,b().fJ)(R().Ns.publishedSiteSettings);const j=(0,r().uB)(e.universalMemberInviteStore,N().A),I=(0,r().K8)((()=>j.state.contextualInviteStore),[j]),T=(0,O().H)(),B=(0,S().r)(),F=(0,x().HI)(),V=(0,r().K8)((()=>E().dR({store:t,environment:w,trustedDomainsStore:T})),[w,t,T]),z=(0,r().K8)((()=>I.state.inviteStage),[I]),K=(0,r().K8)((()=>U().Ay.state.tab),[]),W=(0,a().IS)((e=>({title:{fontSize:16},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto",background:k.isMobile?e.surface.wash:void 0}})),[k.isMobile]),H=(0,o.useMemo)((()=>({onUpgradeButtonClick:l,sudoModeStore:n,location:d})),[l,n,d]),G=(0,r().K8)((()=>A().default.isVisible(M().PUBLIC_SHARE_LINK_TOOLTIP_ID)),[]),Y=(0,r().K8)((()=>(0,L().g)()),[]);if(!B)return Y?(0,_.jsx)(P,{calculatedPermissions:V,store:t,permissionItemArgs:H,onClose:e.onClose}):null;if(!(f().A.isMobile||z!==D().d5.share_workspace&&z!==D().d5.request_workspace||G))return(0,_.jsx)(ae,{blockStore:t,spaceStore:B,contextualInviteStore:I});const q=f().A.isMobile?{menuType:v().gu.Modal,disableHeaderShadow:!0,title:(0,_.jsx)(m().A,{isMobile:f().A.isMobile,style:W.title,children:(0,_.jsx)(s().sA,{defaultMessage:"Share settings",id:"blockPermissionsSettings.mobileShareMenu.titleV2"})}),additionalTopbarContent:(0,_.jsx)(ce().zM,{mostPermissivePublicItem:V.mostPermissivePublicItem}),left:(0,_.jsx)(g().A,{href:(0,y().xS)("guides.sharing"),analyticsFrom:"sharing"}),footer:K===U().QC.Share&&(0,_.jsx)(C().A,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:V,permissionItemArgs:H}),topbarStyle:W.topbarStyle,right:(0,_.jsx)(p().DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!1}:{menuType:v().gu.Popup,maxHeight:"90vh"};return F?(0,_.jsx)(u().A,{...q,className:h().NXe,children:(0,_.jsx)(c().A,{debugName:"ShareMenuContainer",capture:!0,allowEsc:!0,children:(0,_.jsx)(di,{store:t,spaceStore:B,spaceUserStore:F,permissionItemArgs:H,calculatedPermissions:V,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:I})})}):null}function di(e){let{store:t,spaceStore:n,spaceUserStore:r,permissionItemArgs:a,calculatedPermissions:s,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:p}=e;const m=(0,i().v3)();return(0,o.useEffect)((()=>{l().IU({environment:m}),d().clear({environment:m})}),[m]),(0,_.jsx)(si,{store:t,spaceStore:n,spaceUserStore:r,permissionItemArgs:a,calculatedPermissions:s,buttonPopupStore:c,inviteTargetsStore:u,contextualInviteStore:p})}},587989:(e,t,n)=>{n.d(t,{b:()=>v,c:()=>y});n(898992),n(672577);var o=n(296540),i=()=>n(56366),r=()=>n(959013),a=()=>n(251126),s=()=>n(939740),l=()=>n(64e3),d=()=>n(89924),c=()=>n(361330),u=()=>n(188669),p=()=>n(284371),m=n(474848);function g(e){let{loading:t,menuListItemProps:o}=e;const i=(0,n(484714).v3)(),{isMobile:a}=i.device,s=(0,n(401497).IS)((e=>({button:{display:"flex",flexDirection:"row",alignItems:"center",color:e.text.tertiary,...a?{fontSize:p().J.UIRegular.mobile,lineHeight:p().K_.UIRegular.mobile,padding:4}:{fontSize:p().J.UIRegular.desktop,lineHeight:p().K_.UIRegular.desktop,margin:"0px 4px 4px",padding:4,borderRadius:4}},icon:{width:14,height:14,marginRight:8,marginLeft:8,fill:e.icon.tertiary},loadingSpinner:{marginLeft:8}})),[a]);return(0,m.jsxs)(n(704152).A,{style:s.button,...o,children:[(0,n(158359).P)(s.icon),(0,m.jsx)(r().sA,{defaultMessage:"Load more",id:"moveToMenu.loadMoreButtonTitle"}),t?(0,m.jsx)(n(331542).A,{size:"sm",style:s.loadingSpinner}):void 0]})}const f=o.memo(g),h=1e3;function v(e){let{query:t,spaceId:n,menuListStore:r,requestStore:s,getAutocompleteItems:l}=e;const d=(0,i().K8)((()=>s.state.loading),[s]),p=(0,i().K8)((()=>u().Ay.state.isOpen&&u().Ay.state.canLoadMore),[]),g=(0,o.useCallback)((async()=>{!u().Ay.state.isOpen||u().Ay.state.queryLimit>=h||(u().Ay.setState({...u().Ay.state,queryLimit:u().Ay.state.queryLimit+20}),await s.refresh())}),[s]);return(0,m.jsx)(a().A,{request:{query:t,spaceId:n},render:(e,n)=>(0,m.jsx)(y,{sections:n,error:e,menuListStore:r,initialFocus:Boolean(t)?0:void 0,loading:d,canLoadMore:p,onLoadMore:g}),requestStore:s,debounce:c().tu,performRequest:l})}function y(e){let{sections:t,error:n,menuListStore:i,initialFocus:a,onLoadMore:c,canLoadMore:u,loading:p}=e;const g=(0,o.useMemo)((()=>u&&(null==t?void 0:t.find((e=>"pages"===e.key)))),[u,t]);if(n)return(0,m.jsx)(d().A,{children:(0,m.jsx)(l().A,{title:(0,m.jsx)(r().sA,{defaultMessage:"Something went wrong.",id:"moveBlockMenu.errorOnMove.label"})})});if(t&&0===t.length)return(0,m.jsx)(d().A,{children:(0,m.jsx)(l().A,{title:(0,m.jsx)(r().sA,{defaultMessage:"No results",id:"moveBlockMenu.noResults.label"})})});const h=[...t||[],...g?[{key:"moveTo load more section",render:e=>(0,m.jsx)(d().A,{disableDesktopPadding:!0,...e}),items:[{key:"moveTo load more button",render:e=>(0,m.jsx)(f,{menuListItemProps:e,loading:p}),action:c}]}]:[]];return(0,m.jsx)("div",{children:(0,m.jsx)(s().Ay,{type:s().Oh.Vertical,initialFocus:a,sections:h,store:i})})}},600144:(e,t,n)=>{n.r(t),n.d(t,{PublicTopbarMoreMenu:()=>j});n(898992),n(823215),n(354520),n(581454),n(908872);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(584262),s=()=>n(179034),l=()=>n(189308),d=()=>n(741496),c=()=>n(435009),u=()=>n(492414),p=()=>n(722872),m=()=>n(494043),g=()=>n(311337),f=()=>n(578872),h=()=>n(765957),v=()=>n(411671),y=()=>n(630116),b=()=>n(575143),S=()=>n(452558),x=()=>n(928600),A=()=>n(187820),M=()=>n(16006),w=()=>n(89924),k=n(474848);function j(e){let{blockStore:t,onDismiss:n,isPublicShareLink:j}=e;const C=(0,i().v3)(),{isMobile:I}=C.device,T=(0,r().K8)((()=>v().A.getMode(C,t)),[C,t]),_=(0,r().K8)((()=>t.isFormBlock()),[t]),[P,B]=(0,o.useState)(I&&!_?"initialActions":"more"),L=(0,o.useMemo)((()=>({environment:C,blocks:[t],publicEditMode:T,analyticsFrom:"topbar_more_menu"})),[C,t,T]);let R;R=I?{menuType:p().gu.ActionSheet}:{menuType:p().gu.Popup,width:210,maxHeight:"80vh"};const D=(0,o.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=h().default.state;if(t){const n=t.getType();var o;if(n)(0,d().N)(C,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:t.id,block_type:n,is_toggleable:(0,m().Yt)(n,t.getFormat()),collection_id:null===(o=t.getCollectionStore())||void 0===o?void 0:o.id,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}e.closeParentMenu&&n()}),[C,n]),N=(0,r().K8)((()=>{var e;if(!I)return;const n=t.getSpaceStore();if(!n)return;const o=f().GN(t),i=null==o||null===(e=o.getSiteStore())||void 0===e||null===(e=e.getHeader())||void 0===e?void 0:e.customItems;if(!i)return;return{key:"custom nav",render:e=>(0,k.jsx)(w().A,{...e}),actions:i.filter((e=>"block"===e.type)).map((e=>{const o=y().Bv.createChildStore(n,{table:s().ev,id:e.blockId}),i=o.getIcon(),r=(0,u().Ay)({store:o,preferPublicLink:!0,pageVisitSource:a().y8.SiteCustomHeader});return{key:e.blockId,analyticsName:e.blockId,displayName:e.blockId,searchName:e.blockId,render:e=>(0,k.jsx)(b().A,{...e,left:i&&(0,k.jsx)(A().B6,{icon:i,store:t,disabled:!0,isEmptyPage:o.isEmptyPage(),size:18,emojiSize:18,disableShrinking:!0}),title:(0,k.jsx)(M().A,{store:o,maxLength:30})}),action:()=>{c().oo({environment:C,url:r})},closeParentMenu:!0}}))}}),[C,I,t]),O=(0,l().B2)((()=>{B("more")})),E=(0,l().pJ)((()=>{B("more")})),U=(0,r().K8)((()=>(0,g().y)(C)),[C]),F=(0,o.useMemo)((()=>U?[E]:N?[N,O]:[O]),[U,E,N,O]),V=(0,r().K8)((()=>1===F.reduce(((e,t)=>e+t.actions.filter((e=>!e.validators||e.validators.every((e=>e(L))))).length),0)),[F,L]);return"initialActions"!==P||V?(0,k.jsx)(x().A,{...R,children:(0,k.jsx)(S().A,{sections:j?l().Sg:l()._4,context:L})}):(0,k.jsx)(x().A,{...R,children:(0,k.jsx)(S().A,{sections:F,onAccept:D,context:L})})}},607810:(e,t,n)=>{n.d(t,{s:()=>a});var o=n(296540),i=()=>n(120997),r=n(474848);const a=o.memo((function(e){let{area:t,viewsMainTabId:a,children:s,className:l,style:d}=e;const{layoutBuilderModuleSelectionStore:c,layoutStore:u}=(0,n(937199).LH)(),p=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().p)(o,t)&&("page_main"===t&&u.isTabbedPageLayout()||c.setState({...e,draggingModuleFinalArea:{..."views_main_tab_modules"===t?{area:t,viewsMainTabId:a}:{area:t}}}))}),[t,c,u,a]),m=(0,o.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const n=e.moduleId,o=u.getModuleById(n);o&&(0,i().p)(o,t)&&c.setState({...e,draggingModuleFinalArea:e.draggingModuleInitialArea})}),[t,c,u]);return(0,r.jsx)("div",{onMouseEnter:p,onMouseLeave:m,className:l,style:d,children:s})}))},613735:(e,t,n)=>{n.d(t,{b:()=>a});n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var o=()=>n(278238),i=()=>n(945778),r=()=>n(267419);function a(e){let{icon:t,theme:n}=e;if(t)return(0,i().A)(t)?r().A.state.emojiByColorProcessed[t]:(0,o().T8)(t)?function(e){var t;let{uri:n,theme:i}=e;const r=null===(t=n.match(/\/icons\/[\w\-]*_(.+)\.svg/))||void 0===t?void 0:t[1];if(!function(e){if(!e)return!1;return s.has(e)}(r))return;return o().l8[i.mode][r]}({uri:t,theme:n}):void 0}const s=new Set((0,n(534177).uv)(o().l8.light))},628302:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreMenu:()=>Zt});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(381138),l=()=>n(959013),d=()=>n(284371),c=(n(16280),n(18107),n(967357),n(898992),n(672577),n(581454),n(737550),()=>n(662303)),u=()=>n(584262),p=()=>n(700500),m=()=>n(112665),g=()=>n(104077),f=()=>n(274570),h=()=>n(340498),v=n(474848);const y=(0,h().wt)("fontStyleMono",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"M6.817 12 6.08 9.513H3.017L2.28 12H1.192l2.675-8.725h1.388L7.93 12zM4.605 4.388h-.113L3.267 8.6H5.83zm10.008 7.399q0 1.338-.75 2.1-.75.763-2.088.763-1.45 0-2.313-.888l.588-.687q.676.7 1.737.7 1.825 0 1.825-1.925v-1.075h-.05q-.625 1.2-1.987 1.2-1.175 0-1.85-.875-.675-.888-.675-2.412t.675-2.4q.675-.888 1.85-.888 1.361 0 1.988 1.2h.05V5.55h1zm-2.65-.7q.7 0 1.175-.35t.475-.974v-2.15q0-.626-.476-.975-.474-.35-1.175-.35-.862 0-1.35.525-.487.524-.487 1.412v.925q0 .888.488 1.412.487.526 1.35.526Z"})})}),b=(0,h().wt)("fontStyleSans",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"m.76 12 3.248-8.807h.842v1.422h-.348L1.914 12H.761Zm1.472-2.52.341-.935h3.98l.342.934H2.232ZM7.188 12 4.6 4.615V3.193h.494L8.341 12zm4.557 2.32q-.793 0-1.385-.226a2.26 2.26 0 0 1-.947-.63 1.86 1.86 0 0 1-.433-.94l.012-.005h1.099l.006.006q.085.373.513.61.427.244 1.135.244.885 0 1.38-.402.5-.398.5-1.123v-1.331h-.098a2.24 2.24 0 0 1-1.22 1.007q-.39.128-.843.128-.848 0-1.47-.403a2.7 2.7 0 0 1-.953-1.123q-.336-.714-.336-1.635v-.013q0-.922.336-1.635.342-.72.964-1.13.623-.415 1.484-.415.464 0 .854.147t.69.415q.305.269.506.64h.074V5.42h1.062v6.488q0 .733-.36 1.276a2.27 2.27 0 0 1-1.014.836q-.66.3-1.556.3m-.049-3.602q.61 0 1.044-.28.44-.288.671-.788.238-.5.238-1.153v-.013q0-.653-.238-1.16a1.84 1.84 0 0 0-.671-.793q-.434-.287-1.044-.287t-1.037.287a1.83 1.83 0 0 0-.647.794 2.9 2.9 0 0 0-.22 1.16v.012q0 .653.22 1.153.225.5.646.787.428.282 1.038.281"})})}),S=(0,h().wt)("fontStyleSerif",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"M.29 12v-.416l.753-.299 3.16-7.982.441-.065.455-.13 2.99 8.177.884.286V12h-3.34v-.429l1.104-.299-.793-2.275H2.772l-.754 2.119 1.248.455V12zm4.08-7.462L3.058 8.217h2.613L4.384 4.538h-.013Zm10.764 2.106-1.482-.078-.013.039c.325.273.663.754.663 1.443 0 1.417-1.287 2.327-2.587 2.327q-.488 0-.936-.156c-.3.234-.455.455-.455.65 0 .182.182.429.48.442l2.458.143c1.287.078 1.859.65 1.859 1.456 0 1.079-1.391 2.405-3.81 2.405-1.234 0-2.352-.52-2.352-1.469 0-.481.325-1.027.949-1.365l.312-.169v-.026l-.923-.884c.26-.663.546-.988 1.027-1.391C9.726 9.647 9.297 9.01 9.297 8.1c0-1.417 1.105-2.379 2.496-2.379.598 0 1.014.143 1.534.325l1.807-.195zM11.87 9.816c.689 0 1.248-.611 1.248-1.599 0-1.391-.624-1.989-1.404-1.989-.767 0-1.222.572-1.222 1.56 0 1.274.533 2.028 1.378 2.028m1.274 2.691-2.457-.156c-.195.208-.56.689-.56 1.157 0 .481.43 1.157 1.795 1.157 1.599 0 2.262-.767 2.262-1.365 0-.455-.3-.741-1.04-.793"})})});var x=()=>n(735790),A=()=>n(11356);const M={viewBox:"0 0 20 20",fittedViewBox:"1.89 4.31 16.61 11.72",svg:(0,v.jsx)("path",{d:"m8.965 12.538 1.125 3.077a.625.625 0 1 0 1.174-.43L7.526 4.961a.987.987 0 0 0-1.854 0L1.934 15.185a.625.625 0 1 0 1.174.43l1.125-3.078zm-.457-1.25H4.69l1.909-5.223zm7.334 4.554a.625.625 0 0 1-.884 0l-2.475-2.475a.625.625 0 0 1 .884-.884l1.408 1.408V4.994a.625.625 0 1 1 1.25 0v8.897l1.408-1.408a.625.625 0 1 1 .884.884z"})},w=(0,h().wt)("textSmall",M),k=(0,h().wt)("textStyleIcon",{viewBox:"0 0 16 16",svg:(0,v.jsx)("g",{children:(0,v.jsx)("path",{d:"M.74 13.097c-.355 0-.574-.212-.574-.554 0-.116.02-.226.075-.37l3.206-8.55q.226-.625.862-.623c.437 0 .717.212.875.629l3.206 8.538a1 1 0 0 1 .075.37c0 .34-.233.56-.595.56-.355 0-.533-.137-.663-.52l-.882-2.413H2.292l-.882 2.413c-.13.383-.307.52-.67.52m1.887-3.972h3.356l-1.66-4.6h-.035zm9.604 4.02c-1.449 0-2.454-.875-2.454-2.181 0-1.272.964-2.071 2.694-2.167l2.208-.123v-.588c0-.957-.636-1.552-1.702-1.552-.89 0-1.47.37-1.853 1.162-.103.192-.267.274-.479.274-.293 0-.519-.199-.519-.5 0-.143.055-.307.13-.478.39-.882 1.463-1.449 2.748-1.449 1.736 0 2.83.964 2.83 2.454v4.56c0 .369-.232.594-.56.594-.322 0-.554-.225-.554-.567v-.902h-.028c-.423.888-1.408 1.463-2.46 1.463Zm.28-.95c1.204 0 2.168-.855 2.168-1.942v-.725l-2.065.13c-1.073.069-1.654.554-1.654 1.279 0 .752.629 1.257 1.552 1.257Z"})})});var j=()=>n(931075),C=()=>n(381349),I=()=>n(496603),T=()=>n(896628),_=()=>n(696384),P=()=>n(246826),B=()=>n(751156),L=()=>n(679924),R=()=>n(799832),D=()=>n(930545),N=()=>n(575143),O=()=>n(89924),E=()=>n(553965),U=()=>n(962730),F=()=>n(704152),V=()=>n(939740),z=()=>n(859428),K=()=>n(125565);function W(e,t){return e.isFiltering?function(e){return(0,v.jsx)(N().A,{...e,title:e.caption,caption:void 0})}(e):function(e,t){let{id:n,caption:r,focused:s,isActive:l,onClick:d,onMouseDown:c,onMouseEnter:u,onMouseLeave:p,role:m,style:g,tooltip:f,ignoreLocalHoverState:h,disallowTabbing:y}=e;const b=(0,i().Y0)(),{isMenuListFocusVisible:S}=(0,o.useContext)(V().VU),x=(0,a().IS)((e=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...b.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:l?C().Ay.blue:"inherit",...s&&S&&{boxShadow:e.buttonBlueFocusRing}}})),[l,b,S,s]);return(0,v.jsx)(z().A,{renderTooltip:()=>f,placement:U().W.Bottom,delayThreshold:80,render:e=>{const o=(0,E().A)(e,{onMouseEnter:u,onMouseLeave:p}),{onMouseDown:i,...a}=o;return(0,v.jsx)(F().A,{...a,id:n,role:m,ref:t,onClick:d,onMouseDown:o.onMouseDown||c,hovered:s,style:x.button,ignoreLocalHoverState:h,disallowTabbing:y,className:"notranslate",children:(0,v.jsxs)("div",{style:x.optionItem,children:[(0,v.jsx)("div",{style:{...g,height:25},children:"Ag"}),(0,v.jsx)(K().A,{isSmall:!0,style:{marginTop:4},children:r})]})})}})}(e,t)}const H=o.forwardRef(W);const G=function(e){const{children:t}=e,n=(0,i().v3)(),{mobileStyle:o,desktopStyle:r}=(0,a().IS)((e=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${e.regularDividerColor}`,background:e.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",padding:"0px 8px"}})),[]);return(0,v.jsx)(O().A,{...e,children:(0,v.jsx)("div",{style:n.device.isMobile?o:r,children:t})})};var Y=()=>n(53528),q=()=>n(534177),$=()=>n(470928);function Q(e){const{intl:t,blockStore:n}=e,o=(0,$().i1)(n);if("none"!==o.type){if("expired"===o.type)return t.formatMessage(Z.expiredVerification);if("verified"===o.type){if(o.isIndefinite)return t.formatMessage(Z.indefiniteVerification);{const e=o.dateTimeRange.end,n=(0,Y().OH)({dateTime:e,intl:t,shortenDateAndRange:!0});return t.formatMessage(Z.verificationWithEndDate,{date:n})}}(0,q().HB)(o)}}const Z=(0,l().YK)({expiredVerification:{defaultMessage:"Expired",id:"verificationHelpers.mobileAction.subtitle.expiredVerification"},indefiniteVerification:{defaultMessage:"No expiration",id:"verificationHelpers.mobileAction.subtitle.indefiniteVerification"},verificationWithEndDate:{defaultMessage:"Until {date}",id:"verificationHelpers.mobileAction.subtitle.datedVerification"}});var X=()=>n(94985),J=()=>n(558687),ee=()=>n(416726),te=()=>n(435009),ne=()=>n(878377),oe=()=>n(597755),ie=()=>n(492414);const re=(0,l().YK)({openInMacAppName:{id:"action.openInMacApp.name",defaultMessage:"Open in Mac app"},openInWindowsAppName:{id:"action.openInWindowsApp.name",defaultMessage:"Open in Windows app"},openIniOSAppName:{id:"action.openIniOSApp.name",defaultMessage:"Open in iOS app"},openInAndroidAppName:{id:"action.openInAndroidApp.name",defaultMessage:"Open in Android app"}}),ae=(0,ee().Ls)({key:"open in mac app",displayName:re.openInMacAppName,analyticsName:re.openInMacAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().AU6(ne().FrL),ne().cX8,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:(0,oe().P)(o),environment:n})}}),se=(0,ee().Ls)({key:"open in windows app",displayName:re.openInWindowsAppName,analyticsName:re.openInWindowsAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().AU6(ne().FrL),ne().uFH,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:(0,oe().P)(o),environment:n})}}),le=(0,ee().Ls)({key:"open in ios app",displayName:re.openIniOSAppName,analyticsName:re.openIniOSAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().un6,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:o,environment:n})}}),de=(0,ee().Ls)({key:"open in android app",displayName:re.openInAndroidAppName,analyticsName:re.openInAndroidAppName.defaultMessage,svg:J().notionIcon,validators:[ne().vXb,ne().AU6(ne().ibx),ne().m01,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const o=(0,ie().Ay)({store:t[0],fullyQualified:!1,pageVisitSource:u().y8.AppRedirect,embedded:!1});te().eG({url:o,environment:n})}});function ce(){return[ae,se,le,de]}var ue=()=>n(877235),pe=()=>n(910302),me=()=>n(722872),ge=()=>n(430483),fe=()=>n(227440),he=()=>n(77246),ve=()=>n(928600),ye=()=>n(480095),be=()=>n(147294);function Se(e){const{blockStore:t,menuListItemProps:s,title:d,onFocus:c,closeParentMenu:u}=e,p=(0,i().v3)(),m=(0,a().DP)(),g=(0,me().Tf)(),f=(0,r().K8)((()=>ge().zD.isFullPageTranslateEnabled()),[]),{detectedLanguage:h}=(0,n(514799).H)({pageStore:t,enabled:f}),y=(0,n(5580).n)(),[b,S]=(0,o.useState)(void 0),x=b??h??y,{isTranslating:A,editorModeConfigTranslateState:M}=(0,r().K8)((()=>{const e=he().Uv.getTranslateModeForBlock(t.id);return e?{isTranslating:!0,editorModeConfigTranslateState:e}:{isTranslating:!1,editorModeConfigTranslateState:{mode:"translate_unlocked",status:"pre_activation",sourceLanguage:x}}}),[t,x]),w=!(0,r().O$)(fe().e),k=(0,o.useCallback)((e=>{const{sourceLanguage:t}=e;S(t)}),[]),j=(0,o.useCallback)((e=>{const{targetLanguage:n}=e;pe().Z9({pageStore:t,environment:p}),pe().Ww({pageStore:t,targetLanguage:n,sourceLanguage:x,environment:p,triggeredFrom:"action_menu"}),u()}),[t,x,p,u]),C=(0,r().K8)((()=>(0,ee().cz)(m,A)),[A,m]);return"pre_activation"!==M.status||w?(0,v.jsx)(N().A,{...s,title:d,badge:(0,v.jsx)(be().Ee,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"}),svg:ue().H,right:C,onClick:()=>{pe().DL({pageStore:t,environment:p,triggeredFrom:"action_menu"}),u()},disabled:w,disabledFeedback:w,tooltipText:w?(0,v.jsx)(l().sA,{...ee().AY.unavailableOfflineTooltip}):void 0}):(0,v.jsx)(n(662971).A,{...s,disableDefaultClick:!0,onFocus:c,focused:s.focused,disableCloseOnEnter:!0,renderExtension:(e,o)=>{const i=p.device.isMobile?{menuType:me().gu.Modal,right:g?void 0:(0,v.jsx)(ye().DoneMenuText,{}),left:g?(0,v.jsx)(ye().MobileModalBackButton,{}):void 0,onClickRight:g?void 0:o.close,onClickLeft:g?o.close:void 0,shouldRenderMobileRefresh:g,paddingTop:g?10:void 0,title:d,...e}:{menuType:me().gu.Popup,height:480,...e};return(0,v.jsx)(ve().A,{...i,onClick:e=>{e.stopPropagation()},children:(0,v.jsx)(n(391435).Z,{onSelectTargetLanguage:j,onSelectSourceLanguage:k,editorModeConfigTranslateState:M,sourceLanguage:x,detectedPageLanguage:h,preferredLanguage:y,subMenuPlacement:U().W.Left,pageId:t.id})})},renderOrigin:(e,t)=>(0,v.jsx)(N().A,{...e,ref:t,title:d,badge:(0,v.jsx)(be().Ee,{newBadgeKey:"ai_page_translation_topbar_more_action",didUserEngage:!1,keyType:"date"}),svg:ue().H,right:C})})}var xe=()=>n(972435),Ae=()=>n(600871),Me=()=>n(538075),we=()=>n(178998),ke=()=>n(12974),je=()=>n(869562),Ce=()=>n(737230),Ie=()=>n(765957),Te=()=>n(217429),_e=()=>n(404141),Pe=()=>n(795179),Be=()=>n(488923),Le=()=>n(102172);const Re=(0,l().YK)({aiCoEditingName:{id:"action.aiCoEditing.name",defaultMessage:"AI co-editing"}}),De=(0,ee().fi)({key:"ai_co_editing",displayName:Re.aiCoEditingName,label:xe().A.formatMessage(Re.aiCoEditingName),getSvgIcon:()=>n(824375).sparklesIcon,isChecked:e=>e.isNavigableBlock()&&(0,Le().Wv)(e,e.environment),validators:[ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3),ne().AU6(ne().ln6),()=>ge().zD.isAiEnabled(),ne().SQN("ai_co_editing")],action:async(e,t,n)=>{if(!t.isNavigableBlock())return;const o=(0,Le().Wv)(t,e);if(await(0,Be().ne)({environment:e,pageId:t.id,active:!o}),o){(await(0,Be().gY)()).clearStore()}}});var Ne=()=>n(795168),Oe=()=>n(797583),Ee=()=>n(654056),Ue=()=>n(142015),Fe=()=>n(168345);const Ve={viewBox:"0 0 20 20",fittedViewBox:"2.37 3.13 15.26 14.86",svg:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("path",{d:"M10 5.88c.345 0 .625.28.625.625V8.38H12.5a.625.625 0 1 1 0 1.25h-1.875v1.875a.625.625 0 1 1-1.25 0V9.63H7.5a.625.625 0 1 1 0-1.25h1.875V6.505c0-.345.28-.625.625-.625"}),(0,v.jsx)("path",{d:"M15.5 3.13c1.174 0 2.125.951 2.125 2.125v7.5A2.125 2.125 0 0 1 15.5 14.88h-4.935l-3.871 2.978a.625.625 0 0 1-1.006-.496V14.88H4.5a2.125 2.125 0 0 1-2.125-2.125v-7.5c0-1.174.951-2.125 2.125-2.125zm.875 2.125a.875.875 0 0 0-.875-.875h-11a.875.875 0 0 0-.875.875v7.5c0 .483.392.875.875.875h1.813c.345 0 .625.28.625.625v1.838l3.033-2.334a.63.63 0 0 1 .381-.13H15.5a.875.875 0 0 0 .875-.874z"})]})},ze=(0,h().wt)("commentAdd",Ve);var Ke=()=>n(33376),We=()=>n(525884),He=()=>n(848392),Ge=()=>n(454531),Ye=()=>n(158574),qe=()=>n(189158),$e=()=>n(182034),Qe=()=>n(900967),Ze=()=>n(449195),Xe=()=>n(489348),Je=()=>n(883497),et=()=>n(592968);const tt=(0,l().YK)({addCover:{id:"mobile_page_actions.add_cover",defaultMessage:"Add cover"},changeCover:{id:"mobile_page_actions.change_cover",defaultMessage:"Change cover"},addComment:{id:"mobile_page_actions.add_comment",defaultMessage:"Add comment"},viewComments:{id:"mobile_page_actions.view_comments",defaultMessage:"View comments"},backlinks:{id:"mobile_page_actions.backlinks",defaultMessage:"Backlinks"},addDescription:{id:"mobile_page_actions.add_description",defaultMessage:"Add description"},showDescription:{id:"mobile_page_actions.show_description",defaultMessage:"Show description"},hideDescription:{id:"mobile_page_actions.hide_description",defaultMessage:"Hide description"},viewBreadcrumb:{id:"mobile_page_actions.view_breadcrumb",defaultMessage:"View breadcrumb"}});function nt(e){const{blockStore:t,environment:n}=e;return(0,ee().Ls)({key:"add comment",displayName:tt.addComment,svg:ze,analyticsName:tt.addComment.defaultMessage,validators:[ne().pxM,ne().AU6(ne().omD),D().tm,ne().AU6(D().tC)],closeParentMenu:!0,track:{actionName:"add_comment"},action:async(e,o,i)=>{await(0,$e().O)({blockStore:t,environment:n})}})}function ot(e){const{environment:t,intl:n,blockStore:o}=e,i=Boolean(o.getCover());return(0,ee().Ls)({key:"add page cover",displayName:i?tt.changeCover:tt.addCover,svg:He().M,analyticsName:i?tt.changeCover.defaultMessage:tt.addCover.defaultMessage,validators:[ne().p2L,ne()._fc,ne().AU6(ne().oy3),ne().or([ne().FFM,ne().Kq2]),ne().AU6(ne().J$q)],closeParentMenu:!0,action:(e,i)=>{Ge().W({environment:t,intl:n,store:o,rect:e.originRect,from:"action_registry"})}})}function it(e){const{environment:t,blockStore:n}=e,o=(0,Qe().J)(n,t).backlinksCount;if(o<=0)return;return"section_hide"!==(0,Ze().nl)(n.getFormat().page_section_visibility)?(0,ee().Ls)({key:"view backlinks",displayName:tt.backlinks,analyticsName:"view_backlinks",validators:[ne().pxM],track:{actionName:"view_backlinks"},closeParentMenu:!0,render:e=>(0,v.jsx)(N().A,{...e,title:(0,v.jsx)(l().sA,{id:"topbarMoreMenuActions.viewBacklinks",defaultMessage:"{numberOfBacklinks, plural, =0 {No backlinks} one {{numberOfBacklinks} backlink} other {{numberOfBacklinks} backlinks}}",values:{numberOfBacklinks:o}}),svg:Ue().D}),action:(e,t,n)=>{et().F.setState({isOpen:!0})}}):void 0}function rt(e){const{blockStore:t}=e;if(!t.isCollectionView())return;const n=Xe().A.getPageViewBlockStore(t);if(!n)return;const{currentUserSettingsStore:o}=Ie().default.state,i=t.getCollectionViewSourceDescriptionStoreIfSingleSource(),r=Ye().OW(i),a=n.state.isPageDescriptionExpanded;return r&&a?at({shouldShow:!1,blockStore:t,descriptionStore:i,pageViewBlockStore:n,userSettingsStore:o}):r&&!a?at({shouldShow:!0,blockStore:t,descriptionStore:i,pageViewBlockStore:n,userSettingsStore:o}):function(e){const{blockStore:t,descriptionStore:n,pageViewBlockStore:o,userSettingsStore:i}=e;return(0,ee().Ls)({key:"add collection description",displayName:tt.addDescription,analyticsName:"add_collection_description",validators:[ne().Kq2,ne().p2L],closeParentMenu:!0,svg:We().infoCircleIcon,track:{actionName:"add_collection_description"},action:(e,r,a)=>{Ye().de({environment:r.environment,pageId:t.id,store:o,userSettingsStore:i,isExpanded:!0,descriptionStore:n})}})}({blockStore:t,descriptionStore:i,pageViewBlockStore:n,userSettingsStore:o})}function at(e){const{shouldShow:t,blockStore:n,descriptionStore:o,pageViewBlockStore:i,userSettingsStore:r}=e;return(0,ee().Ls)({key:t?"show collection description":"hide collection description",displayName:t?tt.showDescription:tt.hideDescription,analyticsName:t?"show_collection_description":"hide_collection_description",validators:[ne().Kq2,ne().p2L],closeParentMenu:!0,svg:We().infoCircleIcon,track:{actionName:t?"show_collection_description":"hide_collection_description"},action:(e,t,a)=>{Ye().Bq({toggleStore:i,pageId:n.id,descriptionStore:o,environment:t.environment,userSettingsStore:r})}})}function st(e){return(0,ee().Ls)({key:"view breadcrumb",displayName:tt.viewBreadcrumb,analyticsName:"view_breadcrumb",validators:[ne().or([ne().pxM,ne().Kq2])],closeParentMenu:!0,svg:Ke().E,track:{actionName:"view_breadcrumb"},action:(t,n,o)=>{(0,qe().f)(n.environment,e.blockStore)}})}var lt=()=>n(354406),dt=()=>n(137743),ct=()=>n(692996),ut=()=>n(189308),pt=()=>n(346552),mt=()=>n(910702),gt=()=>n(921385);const ft=(0,l().YK)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontComicName:{id:"action.setPageFont.comic.fuzzySearchKeywords",defaultMessage:"Font Comic"},fontComicCaption:{id:"action.setPageFont.comic.caption",defaultMessage:"Comic"},fontComicTooltip:{id:"action.setPageFont.comic.tooltip",defaultMessage:"Playful but cringe"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},importName:{id:"action.import.name",defaultMessage:"Import"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},floatingTableOfContents:{id:"action.floatingTableOfContents.name",defaultMessage:"Table of contents"},notifyMe:{id:"action.notifyMe.name",defaultMessage:"Notify me"},pageVerification:{id:"action.pageVerification.name",defaultMessage:"Verify page"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"View edit history"},pageHistoryNewName:{id:"action.pageHistoryNew.name",defaultMessage:"Version history"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},textFontStyle:{id:"action.textFontStyle.name",defaultMessage:"Text style"},suggestEditsName:{id:"action.suggestEdits.name",defaultMessage:"Suggest edits"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},viewUpdatesAndAnalyticsName:{id:"action.updatesAndAnalytics.name",defaultMessage:"Updates & analytics"},openPageLayoutEditor:{id:"action.layoutEditor.open",defaultMessage:"Customize layout"},translate:{id:"action.translate",defaultMessage:"Translate"}});function ht(e){const{environment:t,intl:n,context:o,isFiltering:i}=e,r=o.blocks[0],a=r.getFollowSettingsKey(),s=(0,ke().jj)(Ie().default.state.currentSpaceStore),l=Me().H8({followSettingsKey:a,environment:t,blockStore:r,from:"more_menu"});if(r.isSystemBlock())return[(0,ee().gy)({key:"system block all actions",render:e=>(0,v.jsx)(O().A,{...e}),actions:[...s?[zt,Tt]:[],Ne().qQ,Ne().Zk,gt().p6,_t,...ce()]})];const d=(0,Ae().aD)(t.device);return[i?xt(t,r.getFormat().page_font||"default"):bt,(0,ee().gy)({key:"topbar primary actions",render:e=>(0,v.jsx)(O().A,{...e,topBorder:!1}),actions:[Ne().qQ,Ne().Zk,gt().p6,_t,Pt,Ee().TR,Ee().kl,Ee().J8,Ee().lb,dt().t,ct().dl]}),(0,ee().gy)({key:"page style and layout",render:e=>(0,v.jsx)(O().A,{...e}),actions:[...d?(0,I().oE)([Ne().Xv,ot({environment:t,intl:n,blockStore:r}),nt({blockStore:r,environment:t}),(0,ee().Ls)({key:"view comments",displayName:tt.viewComments,svg:Fe().L,analyticsName:tt.viewComments.defaultMessage,validators:[ne().pxM,ne().AU6(ne().omD),D().tm,D().XX],closeParentMenu:!0,track:{actionName:"view_comments"},action:(e,t,n)=>{Je().A.setState({open:!0})}}),it({environment:t,blockStore:r}),rt({blockStore:r}),st({blockStore:r})]):[],Bt({environment:t,intl:n,blockStore:r}),...(0,I().oE)([At,Mt,jt,zt,Tt])]}),lt().LQ,(0,ee().gy)({key:"viewing of page content",render:e=>(0,v.jsx)(O().A,{...e}),actions:[wt,we().Z,De,Ne().fg,Ne().Fh,Ne().cy]}),(0,ee().gy)({key:"editing of page content",render:e=>(0,v.jsx)(O().A,{...e}),actions:[Ct,Oe().DI,It]}),(0,ee().gy)({key:"undo",render:e=>(0,v.jsx)(O().A,{...e}),actions:[gt().tN]}),(0,ee().gy)({key:"topbar import actions",render:e=>(0,v.jsx)(O().A,{...e}),actions:[Ft,Ne().TD,Vt]}),(0,ee().gy)({key:"topbar wiki actions",render:e=>(0,v.jsx)(O().A,{...e}),actions:(0,I().oE)([mt().H0,mt().hk])}),Ut(),Et(t,l),(0,X().A)(o),(0,ee().gy)({key:"report page actions",render:e=>(0,v.jsx)(O().A,{...e}),actions:[pt().H,ut().X,ut().aj]}),(0,ee().gy)({key:"topbar view options",render:e=>(0,v.jsx)(O().A,{...e}),actions:ce()})]}function vt(e){return(0,ee().Ls)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().p2L,ne().AU6(ne().oy3),...e.extraValidators],render:(t,n)=>{const o=n.blocks[0].getFormat().page_font,i=e.font===o||!e.font&&!o;return(0,v.jsx)(H,{...t,isActive:i,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption,isFiltering:e.isFiltering,isChecked:e.checkStatus,svg:e.svg})},closeParentMenu:!!e.isFiltering,track:{actionName:"set_font"},action:(t,n,o)=>{let{blocks:i,environment:r}=n;const{serverCommitResult:a}=B().createAndCommit({userAction:"actionRegistry.createFontAction",environment:r,canUndo:!0,perform:t=>{T().zA({stores:i,update:{page_font:e.font},transaction:t}),function(e,t){(0,L().v)(e,"change_font_type",t)}(r,{type:e.font||"default"})}});a.then(t)}})}const yt=[{font:"default",action:function(e){const{isFiltering:t,pageFont:n}=e;return vt({displayName:ft.fontDefaultName,caption:(0,v.jsx)(l().sA,{...ft.fontDefaultCaption}),font:void 0,tooltip:(0,v.jsx)(l().sA,{...ft.fontDefaultTooltip}),style:t?{}:{fontSize:24,fontFamily:d().vc(c().locale).sans,position:"relative",top:-2},extraValidators:[],isFiltering:t,checkStatus:"default"===n,svg:b})}},{font:"serif",action:function(e){const{isFiltering:t,pageFont:n}=e;return vt({displayName:ft.fontSerifName,caption:(0,v.jsx)(l().sA,{...ft.fontSerifCaption}),font:"serif",tooltip:(0,v.jsx)(l().sA,{...ft.fontSerifTooltip}),style:t?{}:{fontSize:25,fontFamily:d().vc(c().locale).serif},extraValidators:[],isFiltering:t,checkStatus:"serif"===n,svg:S})}},{font:"mono",action:function(e){const{isFiltering:t,pageFont:n}=e;return vt({displayName:ft.fontMonoName,caption:(0,v.jsx)(l().sA,{...ft.fontMonoCaption}),font:"mono",tooltip:(0,v.jsx)(l().sA,{...ft.fontMonoTooltip}),style:t?{}:{fontSize:26,fontFamily:d().vc(c().locale).mono,position:"relative",top:-3,letterSpacing:-1},extraValidators:[],isFiltering:t,checkStatus:"mono"===n,svg:y})}},{font:"comic",action:function(e){const{isFiltering:t,pageFont:n}=e;return vt({displayName:ft.fontComicName,caption:(0,v.jsx)(l().sA,{...ft.fontComicCaption}),font:"comic",tooltip:(0,v.jsx)(l().sA,{...ft.fontComicTooltip}),style:{fontSize:t?14:26,fontFamily:d().vc(c().locale).comic,position:"relative",top:-3,letterSpacing:-1},extraValidators:[ne().or([ne().SQN("comic_sans"),e=>e.blocks.some((e=>"comic"===e.getFormatStore().getKeyStore("page_font").getValue()))])],isFiltering:t,checkStatus:"comic"===n})}}],bt=(0,ee().gy)({key:"font section",title:void 0,render:e=>(0,v.jsx)(G,{...e}),actions:yt.map((e=>e.action({isFiltering:!1})))});function St(e){return(0,ee().gy)({key:"font extension menu",render:e=>(0,v.jsx)(O().A,{...e}),actions:yt.map((t=>t.action({isFiltering:!0,pageFont:e})))})}function xt(e,t){const n=(0,C().O4)({theme:e.ThemeModeStore.state}),o=yt.map((e=>e.font)).findIndex((e=>e===t))??0;return(0,ee().gy)({key:"textStyleAction",render:e=>(0,v.jsx)(O().A,{...e}),actions:[(0,ee().uk)({key:"font style section",displayName:ft.textFontStyle,analyticsName:ft.textFontStyle.defaultMessage,svg:k,right:(0,v.jsx)(v.Fragment,{children:t.charAt(0).toUpperCase()+t.slice(1)}),rightStyle:{color:n.text.tertiary,marginRight:5},width:300,validators:[ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().p2L,ne().AU6(ne().oy3)],subActions:()=>[St(t)],initialFocus:o,hideSubActions:!0,fuzzySearchKeywordsArray:[ft.fontDefaultName,ft.fontSerifName,ft.fontMonoName]})]})}const At=(0,ee().fi)({key:"small text",displayName:ft.fontSmallTextKeywords,label:xe().A.formatMessage(ft.fontSmallTextLabel),getSvgIcon:()=>w,isChecked:e=>Boolean(e.getFormat().page_small_text),validators:[ne().AU6(ne().FrL),ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().p2L,ne().AU6(ne().oy3)],track:{actionName:"set_text_size"},action:(e,t,n)=>T().zA({stores:[t],update:{page_small_text:!t.getFormat().page_small_text},transaction:n}),afterAction:(e,t)=>{(0,L().v)(t,"change_font_size",{type:e?"small":"large"})}}),Mt=(0,ee().fi)({key:"full width",displayName:ft.fullWidthLabel,getSvgIcon:()=>n(665589).l,label:xe().A.formatMessage(ft.fullWidthLabel),isChecked:e=>e.isFullWidth(),validators:[ne().AU6(ne().tpB),ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3)],track:{actionName:"set_width"},action:(e,t,n)=>{T().zA({stores:[t],update:{page_full_width:!t.isFullWidth()},transaction:n})},afterAction:(e,t)=>{(0,L().v)(t,"change_page_width",{type:e?"full_width":"default_width"})}}),wt=(0,ee().fi)({key:"page lock",displayName:ft.lockPageName,label:xe().A.formatMessage(ft.lockPageName),getSvgIcon:e=>{let{isChecked:t}=e;return e=>(0,v.jsx)(n(124524).I,{isLocked:t,style:e})},isChecked:e=>e.isLockedForAllUsers(),validators:[ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3)],action:(e,t,n)=>P().zv({store:t.getFormatStore(),data:{block_locked:!t.isLockedForAllUsers(),block_locked_by:e.currentUser.id},transaction:n}),afterAction:()=>null}),kt=[ne().AU6(ne().Kq2),ne().p2L,ne().AU6(ne().oy3),ne().AU6(ne().FrL),ne().or([ne().wTm])],jt=(0,ee().fi)({key:"floating table of contents",displayName:ft.floatingTableOfContents,getSvgIcon:()=>n(358359).L,label:xe().A.formatMessage(ft.floatingTableOfContents),isChecked:e=>{var t;return"off"!==(null===(t=e.getModel())||void 0===t?void 0:t.getFloatingTableOfContentsState())},validators:kt,action:(e,t,n)=>{var o;const i="off"!==(null===(o=t.getModel())||void 0===o?void 0:o.getFloatingTableOfContentsState());P().zv({store:t.getFormatStore(),data:{page_floating_table_of_contents:{state:i?"off":"minimal"}},transaction:n})},afterAction:(e,t)=>{(0,n(2220).u)({environment:t,event:{eventName:"edit_page_table_of_contents_toggle",eventProperties:{is_table_of_contents_on:e}}})}}),Ct=(0,ee().Ls)({key:"suggest edits",displayName:ft.suggestEditsName,analyticsName:ft.suggestEditsName.defaultMessage,validators:[ne().AU6(ne().ln6),ne().AU6(ne().FrL),ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().$9,ne().AU6(ne().oy3)],render:(e,t)=>{const o="suggest"===he().Uv.getMode(t.blocks[0]),i=(0,C().O4)({theme:t.environment.ThemeModeStore.state});return(0,v.jsx)(N().A,{...e,title:(0,v.jsx)(l().sA,{...ft.suggestEditsName}),svg:n(209416).a,right:(0,ee().cz)(i,o)})},action:e=>{const t="suggest"===he().Uv.getMode(e.blocks[0])?"default":"suggest";"suggest"===t&&Pe().A.reset(),n(473227).PD({environment:e.environment,navigableBlockStore:e.blocks[0],mode:t,location:"page_more_actions"})},closeParentMenu:!0}),It=(0,ee().Ls)({key:"translate",displayName:ft.translate,analyticsName:"open_translate_bar_from_topbar",validators:[ne().yI5,ne().pxM],closeParentMenu:!0,render:(e,t,n)=>{let{onFocus:o}=n;const i=t.blocks.at(0);if(i)return(0,v.jsx)(Se,{onFocus:o,closeParentMenu:()=>{Pe().A.reset()},blockStore:i,menuListItemProps:e,title:(0,v.jsx)(l().sA,{...ft.translate})})},action:()=>{}}),Tt=(0,ee().Ls)({key:"customize page",displayName:ft.customizePageLabel,analyticsName:ft.customizePageLabel.defaultMessage,svg:x().M,validators:[ne().AU6(ne().wTm),ne().VNy,ne().AU6(ne().oy3),ne().or([ne().AU6(ne().Kq2),ne().Afv]),ne().or([ne().FrL,ne().AU6(ne().omD),ne().UC4]),ne().AU6(ne().Po5)],closeParentMenu:!0,render:e=>(0,v.jsx)(N().A,{...e,title:(0,v.jsx)(l().sA,{...ft.customizePageLabel}),svg:x().M}),action:e=>{n(334261).ho({originRect:e.originRect})}}),_t=(0,ee().Fw)({key:"copy link to block non-desktop",displayName:ee().AY.copyLinkNavigableTypeName,analyticsName:ee().AY.copyLinkNavigableTypeName.defaultMessage,svg:n(742852).w,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[ne().M3g,ne().vXb,ne().AU6(ne().b8R),ne().AU6(ne().oy3),ne().AU6(ne().Po5)],closeParentMenu:!0,track:{actionName:"copy_block_link"},action:(e,t,o)=>{let{lazyDependencies:i,environment:r,blocks:a}=t;const{clipboardActions:s}=i;s?s.copyLinkToBlock({environment:r,blockStore:a[0],callback:e}):n(857639).log({data:{miscDataToConvertToString:{actionKey:"copy link to block non-desktop"}},from:"topbarMoreActionRegistry",level:"info",type:"lazyDependencies:missingClipboardActions"})}}),Pt=(0,ee().Fw)({key:"duplicate",displayName:ee().AY.duplicateName,analyticsName:ee().AY.duplicateName.defaultMessage,svg:n(764781).V,validators:[ne()._fc,ne().p2L,ne().MIU,ne().GNM,ne().AU6(ne().Xjv(p().xd.externalObjectInstancePage)),ne().AU6(ne().UC4),ne().AU6(ne().PfK),ne().AU6(ne().oy3)],shortcuts:["duplicate"],closeParentMenu:!0,track:{actionName:"duplicate"},action:async(e,t,o)=>{let{environment:i}=t;const r=n(186445).FQ();if(!r)return;const a=r.getAssociatedCollectionStore();if(!a)return;if(!(0,n(611371).EF)(i))return;const s=new(n(414834).A)(i);if(s.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:a}),(0,n(405417).ls)(r,s))return void(await n(60867).HF({environment:i,blocks:[r],collectionContextStore:s,callback:e}));const{duplicateBlock:l}=await(0,n(855801).D6)(),{serverCommitResult:d}=B().createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:i,canUndo:!0,perform:e=>{const{blockStores:t}=l({environment:i,stores:[r],transaction:e,targetSpaceId:(0,n(161479).e)(a.pointer.spaceId),preferDuplicateLocation:"local",options:{addCopyName:(0,n(53664).A)(r),allowRedundancy:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!r.isInsideTemplate()}}),o=t[0];n(44729).X$({childStore:o,parentStore:a,transaction:e}),r.isTemplate()&&n(722101).BC({parentStore:a.getTemplatePagesStore(),appendStore:o,transaction:e}),n(857783).uK({environment:i,store:o,pageVisitSource:u().y8.Duplicate})}});d.then(e)},disabled:()=>!fe().A.state.online,renderTooltip:()=>xe().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online});function Bt(e){const{environment:t,intl:n,blockStore:o}=e,i=(0,C().O4)({theme:t.ThemeModeStore.state});return(0,ee().Ls)({key:"open page verification menu",analyticsName:"Open page verification",displayName:ft.pageVerification,render:e=>(0,v.jsx)(N().A,{...e,svg:m().J,title:(0,v.jsx)(l().sA,{...ft.pageVerification}),right:(0,v.jsx)("div",{style:{color:i.text.tertiary,marginRight:0},children:Q({intl:n,blockStore:o})}),rightStyle:{marginRight:5},showExtensionArrow:!0}),validators:[ne().FrL,e=>ne().p2L(e),()=>(0,$().Io)(),()=>{var e;const t=null===(e=Ie().default.state.currentSpaceStore)||void 0===e?void 0:e.getModel();return Boolean(t&&(0,j().Xi)(t))}],closeParentMenu:!1,action:()=>{_().h()}})}const Lt=(0,ee().Ls)({key:"open page updates",analyticsName:"Open page updates",displayName:ft.pageUpdates,svg:f().clockIcon,validators:[D().tm,ne().FrL],closeParentMenu:!0,action:()=>{n(446027).A.setState({open:!0})},disabled:()=>!fe().A.state.online}),Rt=(0,ee().Ls)({key:"action page history",displayName:ft.pageHistoryName,analyticsName:ft.pageHistoryName.defaultMessage,svg:A().G,validators:[ne().or([ne().hfc,ne().Xmj]),ne()._fc,ne().M3g,ne().AU6(ne().vP$),ne().AU6(ne().PfK),ne().AU6(ne().Qp$),ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;return n(82926).WE({environment:t,blockStore:o[0],from:"topbar"})},render:(e,t)=>{let{onClick:o,key:i,...r}=e,{environment:a}=t;return(0,v.jsx)(n(643908).A,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:o,alwaysAllowClick:!0,render:(e,t)=>{const n=!fe().A.state.online;return(0,v.jsx)(N().A,{...(0,E().A)(r,e),title:xe().A.formatMessage(ft.pageHistoryNewName),svg:A().G,dontShrinkRight:!0,right:t,tooltipText:n?xe().A.formatMessage(ee().AY.unavailableOfflineTooltip):void 0,disabled:n,disabledFeedback:n})},renderUpgradeTooltip:()=>{}},i)}}),Dt=(0,ee().Ls)({key:"view analytics",displayName:ft.viewAnalyticsName,analyticsName:ft.viewAnalyticsName.defaultMessage,svg:n(489538).o,validators:[ne().JYi,ne().AU6(ne().Po5)],closeParentMenu:!0,action:e=>{je().handleSidebarButtonClick(e.environment,e.blocks[0],Ce().tF.Updates,"more_menu"),Ce().Ay.setState({...Ce().Ay.state,updatesSubTab:Ce().VE.Analytics})},disabled:()=>!fe().A.state.online,renderTooltip:()=>xe().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online}),Nt=(0,ee().Ls)({key:"view updates and analytics",displayName:ft.viewUpdatesAndAnalyticsName,analyticsName:ft.viewUpdatesAndAnalyticsName.defaultMessage,validators:[ne().JYi,ne().AU6(ne().Po5)],svg:f().clockIcon,closeParentMenu:!0,action:e=>{const{currentUserSettingsStore:t}=Ie().default.state;t&&B().createAndCommit({environment:e.environment,userAction:"topbarMoreActonRegistry.openUpdatesAndAnalytics",canUndo:!0,perform:e=>{n(755199).mJ({userSettingsStore:t,transaction:e,data:{opened_new_top_bar_updates_entrypoint:!0}})}}),je().handleSidebarButtonClick(e.environment,e.blocks[0],Ce().tF.Updates,"more_menu")},disabled:()=>!fe().A.state.online,renderTooltip:()=>xe().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online});function Ot(e,t){var n;const o=(0,C().O4)({theme:e.ThemeModeStore.state});return(0,ee().uk)({key:"notifications",displayName:ft.notifyMe,analyticsName:ft.notifyMe.defaultMessage,svg:g().r,right:null===(n=t.find((e=>e.isSelectedOption)))||void 0===n?void 0:n.action.displayName,rightStyle:{color:o.text.tertiary,marginRight:5},width:300,initialFocus:t.findIndex((e=>e.isSelectedOption))??0,validators:[ne().AU6(ne().oy3),ne().AU6(ne().Po5)],subActions:()=>[(0,ee().gy)({key:"notifications",render:e=>(0,v.jsx)(O().A,{...e}),actions:t.map((e=>{let{action:t}=e;return t}))})],hideSubActions:!0,fuzzySearchKeywordsArray:(0,I().oE)(t.map((e=>{let{action:t}=e;return t.displayName?Me().aE(t.displayName):void 0})))})}function Et(e,t){return(0,ee().gy)({key:"notifyMe",render:e=>(0,v.jsx)(O().A,{...e}),actions:[Ot(e,t)]})}function Ut(){const e="on"===Te().default.getEligibleGroup({experimentId:"remove_updates_topbar_button_v2",defaultGroup:"control",disableExposureLogging:!0});return(0,ee().gy)({key:"editorActions",render:e=>(0,v.jsx)(O().A,{...e}),actions:(0,I().oE)([Lt,e?Nt:Dt,Rt])})}const Ft=(0,ee().Ls)({key:"open import modal",displayName:ft.importName,analyticsName:ft.importName.defaultMessage,svg:n(820579).f,validators:[ne().IRu,ne().p2L,ne().AU6(ne().Xjv(p().xd.externalObjectInstancePage)),ne().AU6(ne().PfK),ne().AU6(ne().oy3)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e,i=!1;if(1===t.length){const[e]=t;i=e.isCollectionView()}i?n(41432).A.setState({open:!0}):(n(559926).kY(o,{from:"topbar",flowId:n(522094).A.createFlowId()}),_e().A.setState({..._e().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"topbar"}))},disabled:()=>!fe().A.state.online,renderTooltip:()=>xe().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online}),Vt=(0,ee().Ls)({key:"export block",displayName:ft.exportName,analyticsName:ft.exportName.defaultMessage,validators:[ne().M3g,ne().y9r,ne().AU6(ne().Po5)],closeParentMenu:!0,render:e=>{const t=!fe().A.state.online;return(0,v.jsx)(N().A,{...e,svg:n(419178).Q,title:(0,v.jsx)(l().sA,{...ft.exportName}),tooltipText:t?(0,v.jsx)(l().sA,{...ee().AY.unavailableOfflineTooltip}):(0,v.jsx)(l().sA,{...ft.exportCaption}),disabled:t,disabledFeedback:t})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];if(!i.isDefined())return;let r=!0;const a=(0,R().U)(t[0]);if(a){const e=null==a?void 0:a.collectionStore();null!=e&&e.isPageTreeCollection()&&(r=!1)}n(91709).Ss({environment:o,root:{id:i.id,table:"block",spaceId:i.getSpaceId()},isCollectionViewExportTypeSupported:r})}}),zt=(0,ee().Ls)({key:"open page layout editor",displayName:ft.openPageLayoutEditor,analyticsName:ft.openPageLayoutEditor.defaultMessage,validators:[ne().wTm],closeParentMenu:!0,render:function(e){const t=!fe().A.state.online;return(0,v.jsx)(N().A,{...e,disabled:t,disabledFeedback:t,svg:n(167170)._,title:(0,v.jsx)(n(21140).Ye,{children:(0,v.jsx)(l().sA,{...ft.openPageLayoutEditor})}),tooltipText:t?(0,v.jsx)(l().sA,{...ee().AY.unavailableOfflineTooltip}):void 0})},action:function(e){let t,o,i,r,{environment:a,blocks:s}=e;for(const n of s)if(n.isCollectionView()){const e=n.getCollectionStore();if(e){t=n,o=e;const a=(0,R().U)(n);i=null==a?void 0:a.collectionViewStore(),r="customize_database_button_in_three_dot_menu";break}}else{const e=n.getAssociatedCollectionStore();if(e&&!e.isPageTreeCollection()){t=n,o=e,r="customize_page_button_in_three_dot_menu";break}}if(!o||!t||!r)throw new Error("Could not edit page layout: Could not find collection");n(447934).nh({environment:a,blockStore:t,collectionStore:o,collectionViewStore:i,from:r})},disabled:()=>!fe().A.state.online,renderTooltip:()=>xe().A.formatMessage(ee().AY.unavailableOfflineTooltip),disableTooltip:()=>fe().A.state.online});var Kt=()=>n(836251),Wt=()=>n(857437),Ht=()=>n(819493),Gt=()=>n(452558),Yt=()=>n(419357),qt=()=>n(678553),$t=()=>n(962036),Qt=()=>n(715011);function Zt(e){const{blockStore:t,onClickOriginRect:n,handleAccept:c,handleDismiss:u}=e,p=(0,i().v3)(),m=(0,i().Y0)(),g=(0,l().tz)(),[f,h]=(0,o.useState)(""),[y,b]=(0,Wt().$)(),S=(0,r().K8)((()=>({environment:p,blocks:[t],originRect:n,publicEditMode:void 0,analyticsFrom:"topbar_more_menu"})),[p,t,n]),{initialSections:x,filterSections:A}=(0,r().K8)((()=>({initialSections:ht({environment:p,intl:g,context:S,isFiltering:!1}),filterSections:ht({environment:p,intl:g,context:S,isFiltering:!0})})),[p,g,S]),M=(0,r().K8)((()=>0===f.length&&!t.isCollectionView()&&t.canEdit()&&t.hasContent()&&!t.isPersonProfile()),[t,f]),w=(0,r().K8)((()=>0===f.length&&t.canEdit()&&!t.isPersonProfile()),[t,f.length]),k=(0,r().K8)((()=>t.canEdit()&&t.isCollectionView()),[t]),j=(0,a().IS)((e=>({caption:{color:e.text.tertiary},icon:{color:e.icon.secondary,width:16,height:16},menuPropIcon:{color:e.palette.gray[500]}})),[]),C=(0,r().K8)((()=>m.isMobile&&!Te().default.checkGate({gateName:"mobile_topbar_more_menu_search"})||t.isPersonProfile()),[m,t]),I=(0,v.jsxs)(v.Fragment,{children:[M&&!w?(0,v.jsx)(qt().Ay,{caption:(0,v.jsx)("span",{style:j.caption,children:(0,v.jsx)(l().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,v.jsx)(Qt().A,{store:t})}})})}):void 0,w?(0,v.jsx)("div",{style:{marginBottom:1},children:(0,v.jsx)(Ht().$,{store:t,isPageMoreButton:!0,showWordCount:M})}):void 0]}),T=m.isMobile?{menuType:me().gu.Modal,title:(0,v.jsx)(l().sA,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),leftRightButtonStyle:j.menuPropIcon,onClickRight:u,titleOuterStyle:{fontSize:17,fontWeight:d().Wy.bold},paddingTop:10,enableMobileRefresh:!0}:{menuType:me().gu.Popup,maxHeight:"80vh"};return(0,v.jsxs)(ve().A,{...T,children:[C?(0,v.jsx)(Gt().A,{sections:x,onAccept:c,context:S}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(O().A,{isInput:!0,children:(0,v.jsx)(Yt().Ay,{value:f,onChange:e=>h(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:g.formatMessage({defaultMessage:"Search actions…",id:"topbarMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0,inputLeft:(0,s().q)({...j.icon}),showClearButton:!0,...y})}),(0,v.jsx)(Gt().A,{sections:x,filterSections:A,onAccept:c,context:S,filter:f,showNoResultsMessage:!0,initialFocus:f.length>0?0:void 0,comboboxProps:b})]}),M||w?m.isMobile?(0,v.jsx)(v.Fragment,{children:I}):(0,v.jsx)(O().A,{topBorder:!0,children:I}):void 0,k?(0,v.jsx)(Xt,{}):void 0]})}function Xt(){return(0,v.jsx)(O().A,{topBorder:!0,children:(0,v.jsx)($t().A,{title:(0,v.jsx)(l().sA,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,Kt().xS)("guides.database"),analyticsFrom:"topbar_more_button"})})}},637096:(e,t,n)=>{n.d(t,{W:()=>c});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(40970),s=()=>n(765957),l=()=>n(645200),d=()=>n(583238);function c(e){const{collectionContextStore:t,entrypoint:n}=e,c=(0,i().v3)(),u=(0,r().O$)(s().AppStoreCurrentSpaceStore),p=(0,r().K8)((()=>(0,d().mX)()),[]);return(0,o.useCallback)((()=>{const e=t.collectionViewStore(),o=t.collectionStore(),i=null==o?void 0:o.getParentBlockStore();e&&o&&i&&u&&(a().tC(c,{is_calendar_connected:p,collection_id:o.id,collection_view_id:e.id,collection_view_block_id:i.id,entrypoint:n}),l().Op({environment:c,collectionViewStore:e,spaceStore:u,from:"openInCalendarButton"}))}),[c,t,u,p,n])}},637433:(e,t,n)=>{n.d(t,{Y:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,n(474848).jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25m2.817 4.808a.625.625 0 0 1 0 .884L10.884 10l1.933 1.933a.625.625 0 1 1-.884.884L10 10.884l-1.933 1.933a.625.625 0 1 1-.884-.884L9.116 10 7.183 8.067a.625.625 0 1 1 .884-.884L10 9.116l1.933-1.933a.625.625 0 0 1 .884 0"})},i=(0,n(340498).wt)("xMarkCircleFill",o)},650843:(e,t,n)=>{n.r(t),n.d(t,{LargeSurfaceRenderError:()=>s});n(296540);var o=()=>n(167355),i=()=>n(840071),r=()=>n(113414),a=n(474848);function s(e){return(0,a.jsx)(i().L,{...e,iconGroup:o().F,children:(0,a.jsx)(r().g,{})})}},654856:(e,t,n)=>{n.d(t,{A:()=>u});n(581454);var o=n(296540),i=()=>n(56366),r=()=>n(959013),a=()=>n(743260),s=()=>n(299545),l=()=>n(417555),d=()=>n(856952),c=n(474848);const u=function(e){const{origin:t,permissionsInviteStore:u,store:p,handleClickRemoveToken:m,handleInputChange:g,handleInputSubmit:f,defaultRoleForNonBot:h,right:v,focus:y,handleFocus:b}=e,S=(0,i().K8)((()=>0!==(0,n(731320).Qo)()),[]),x="share_menu"===t||"add_members"===t,A="add_members"===t,[M,w]=(0,i().$y)(u),k=(0,n(484714).v3)(),{device:j}=k,C=(0,r().tz)(),{tokenQuery:I}=M,T=(0,n(101749).N)(p),_=M.inviteTargets.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`,i=(0,a().yi)(e),s="newUser"===e.type||"existingUser"===e.type?e.value.email:void 0,d=i?T:void 0,u={key:t,target:e,onClickRemove:m,role:M.inviteRole,shouldWrap:x,showInfoIcon:Boolean(d)};return x&&s?(0,c.jsx)(n(859428).A,{placement:n(962730).W.Top,disableTooltip:A,renderTooltip:()=>i?d||(0,c.jsx)(r().sA,{defaultMessage:"{email} will be invited as a guest",id:"ContextualInvite.permissions_invites.guest.tooltip",values:{email:s}}):s,render:n=>(0,o.createElement)("span",{...n,key:t},(0,c.jsx)(l().A,{...u,backgroundColor:(0,a().qv)(e)}))},t):(0,o.createElement)(l().A,{...u,key:t})})),P=0===M.inviteTargets.length;return(0,c.jsx)(d().Ay,{focus:j.isMobile?void 0:y,focusInitial:j.isMobile,focusAfterAnimation:!0,onClick:()=>{j.isMobile||null==b||b()},format:d().le.Share,value:I,onChange:g,type:"email",tokens:_,disabled:!1,autoComplete:"off",placeholder:x?S?C.formatMessage({defaultMessage:"Add people, groups, or emails…",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithTeams"}):C.formatMessage({defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"}):(0,s().Yu)(p)||(0,s().nw)(p)?C.formatMessage({id:"inviteUserModal.searchInput.placeholder",defaultMessage:"Search name or emails"}):C.formatMessage({id:"permissionsInvite.searchInput.placeholder",defaultMessage:"Search emails, names, or groups"}),onRemoveLastToken:()=>{const e={...M};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.inviteRole=h),w(M)},right:v,inputFullWidth:!0,inputAndTokenWrapRightStyle:{paddingTop:k.device.isMobile||"add_members"===t?0:P?7:6,paddingBottom:k.device.isMobile||x?0:4},onEmptySubmit:()=>f(),dontShowBorderBottom:j.isAndroid,showBorder:x,...!x&&{style:{padding:"10px  9px 4px 9px"}},...x&&{style:{borderRadius:4,paddingTop:P?3:0,paddingBottom:0,...y&&{background:"none"}}}})}},655784:(e,t,n)=>{n.d(t,{A:()=>c});n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(959013),s=()=>n(496603),l=()=>n(418426),d=n(474848);const c=function(e){const{teamStore:t,from:c,onLeavingTeam:u,style:p,hoveredStyle:m,icon:g,isRed:f,placement:h,alignment:v,buttonInternals:y}=e,b=(0,i().v3)(),S=(0,r().O$)(n(765957).AppStoreCurrentSpaceStore),x=(0,l().$)(t),A=(0,o.useCallback)((async()=>{if(!S)return;await n(848237).JC({environment:b,teamStore:t,from:c,userGroupsInTeam:x})&&(null==u||u())}),[S,b,t,c,x,u]),M=(0,d.jsx)(a().sA,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),w=function(e){let{teamStore:t}=e;const n=(0,i().v3)(),o=n.currentUser.id,{isDefaultTeam:c}=(0,r().K8)((()=>({isDefaultTeam:t.isDefault()})),[t]),u=(0,l().$)(t),p=(0,r().K8)((()=>{if(!t.isReady())return!1;const{ownerUserIds:e,ownerGroupIds:n}=t.getAllOwnerIds();return Boolean(o&&t.isOwner(o)&&e.length+n.length===1)}),[t,o]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:n,userGroupsInTeam:o}=e;if(t)return(0,d.jsx)(a().sA,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You can’t leave this teamspace because everyone in the workspace must be a member"});if(n)return(0,d.jsx)(a().sA,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(o.length>0)return(0,d.jsx)(a().sA,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:s().oE(o.map((e=>e.name))).join()}})}({isDefaultTeam:c,isOnlyTeamOwner:p,userGroupsInTeam:u})}({teamStore:t}),k=Boolean(w),j=k?w:M;return(0,d.jsx)(n(859428).A,{style:k?{width:240}:void 0,disableTooltip:!Boolean(j),renderTooltip:e=>(0,d.jsx)("div",{...e,children:j}),textWrap:k,placement:h,alignment:v,render:e=>(0,d.jsx)(n(493823).p,{...e,style:p,hoveredStyle:m,onClick:A,disabled:k,disabledFeedback:k,iconLeading:g,isRed:f,children:y||(0,d.jsxs)(d.Fragment,{children:[(0,n(831310).o)({width:12.5,marginRight:4}),(0,d.jsx)(a().sA,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},667193:(e,t,n)=>{n.d(t,{p:()=>a});var o=()=>n(484714),i=()=>n(56366),r=()=>n(186445);function a(){const e=(0,o().v3)();return(0,i().O$)((0,r().rp)(e))}},669548:(e,t,n)=>{n.d(t,{w:()=>c});n(16280),n(18107),n(967357);var o=()=>n(388821),i=()=>n(179034),r=()=>n(184468),a=()=>n(594794),s=()=>n(765957),l=()=>n(970330),d=()=>n(863168);function c(e){var t,n,c;const{environment:u,createBlockItem:p,from:m,inMemoryRecordCache:g,transaction:f,selection:h}=e;if(!p.templateRootBlockId||!p.createTemplate)throw new Error("Invalid createBlock item.");const v=(h.length>0?h[0].getSpaceId():void 0)??(null===(t=s().default.state.currentSpaceStore)||void 0===t?void 0:t.id)??(null===(n=s().default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.getSpaceId()),y=v?u.idCreator.getSpaceIdCreatorSync(v):void 0,{targetBlockStore:b}=(0,r().j)({environment:u,sourceBlockId:p.templateRootBlockId,targetBlockPointer:(0,a().zP)({environment:u,table:i().ev,spaceId:v}),sourceBlockSubtree:(0,o().partialRecordMapToRecordMap)(p.createTemplate(u)),targetRecordCache:g,transaction:f,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,spaceIdCreator:y});if(null===(c=p.postCreateCallback)||void 0===c||c.call(p,b,u,f),d().eY({environment:u,store:b,transaction:f}),m&&p.blockType){var S,x;const e=p.collectionViewType,t="full_page"===e,n=0!==h.length?null===(S=h[0])||void 0===S?void 0:S.getParentCollectionIdUpToTwoLevels():void 0;let o,i,r,a;if("chart"===e){var A,M;const e=null===(A=b.getCollectionViewStores())||void 0===A?void 0:A.at(0);o=null==e||null===(M=e.getChartConfig())||void 0===M?void 0:M.type,i=null==e?void 0:e.getChartPlaceholderType()}if("form_editor"===e){var w;const e=null===(w=b.getCollectionViewStores())||void 0===w?void 0:w.at(0),t=null==e?void 0:e.getFormBlockStore();r=null==t?void 0:t.id,a=null==e?void 0:e.id}l().v(u,{from:m,type:p.blockType,collection_id:b.getAssociatedCollectionId()??(null===(x=b.getCollectionStore())||void 0===x?void 0:x.id),view_type:"inline"===e||"full_page"===e?"table":e,is_toggleable:p.isToggleable,automation_id:b.getAutomationId(),new_page_id:"page"===p.blockType?b.id:void 0,creating_block_id:b.id,parent_collection_id:n,is_full_screen:t,chart_type:"placeholder"===o?i:o,is_chart_placeholder:"placeholder"===o,form_id:r,view_id:a})}return b}},673898:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{active:!1,stringValue:""}}}const i=new o},676870:(e,t,n)=>{n.d(t,{EN:()=>i,Ex:()=>r,NZ:()=>a,T6:()=>l,i_:()=>s,kW:()=>d});var o=()=>n(2220);function i(e,t){(0,o().u)({environment:e,event:{eventName:"open_publish_modal",eventProperties:t}})}function r(e,t){(0,o().u)({environment:e,event:{eventName:"change_domain",eventProperties:t}})}function a(e,t){(0,o().u)({environment:e,event:{eventName:"update_seo_settings",eventProperties:t}})}function s(e,t){(0,o().u)({environment:e,event:{eventName:"site_set_link_expiration",eventProperties:t}})}function l(e,t){(0,o().u)({environment:e,event:{eventName:"page_unpublish",eventProperties:t}})}function d(e,t){(0,o().u)({environment:e,event:{eventName:"page_publish",eventProperties:t}})}},677169:(e,t,n)=>{n.d(t,{f:()=>c,m:()=>d});n(898992),n(354520),n(672577),n(737550);var o=n(296540),i=()=>n(56366),r=()=>n(617871),a=()=>n(765957),s=()=>n(217429),l=()=>n(53137);function d(){const e=(0,o.useRef)(void 0);return(0,i().K8)((()=>{if(void 0===e.current){if(!s().default.isStatsigReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};e.current=s().default.checkGate({gateName:"calendar_home_tile_caching"})}return e.current?c():function(){var e,t,n;const o=l().A.bots.state.filter((e=>e.integration_id===r().io)),i=null===(e=a().default.state.currentSpaceViewStore)||void 0===e?void 0:e.getSelectedCalendarBotId(),s=!l().A.state.loaded||!(null!==(t=a().default.state.currentSpaceViewStore)&&void 0!==t&&t.isReady()),{spaceId:d,userId:c}=l().A.state.loaded?l().A.state:{spaceId:void 0,userId:void 0},u=null===(n=o[0])||void 0===n?void 0:n.id;if(!i)return{loading:s,botId:u,botSpaceId:d,botUserId:c};const p=o.find((e=>e.id===i));return{loading:s,botId:(null==p?void 0:p.id)??u,botSpaceId:d,botUserId:c}}()}),[])}function c(){var e;const{currentSpaceViewStore:t}=a().default.state;if(!t||!t.isReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};const n=t.getSelectedCalendarBotId();if(n&&!l().A.state.loaded)return{loading:!1,botId:n,botSpaceId:t.getSpaceId(),botUserId:t.getUserId()};const{spaceId:o,userId:i}=l().A.state.loaded?l().A.state:{spaceId:void 0,userId:void 0},s=l().A.bots.state.filter((e=>e.integration_id===r().io)),d=null===(e=s[0])||void 0===e?void 0:e.id,c=n&&s.some((e=>e.id===n))?n:d;return{loading:!l().A.state.loaded||l().A.state.loading,botId:c,botSpaceId:o,botUserId:i}}},681546:(e,t,n)=>{n.d(t,{i:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("arrowLeft",{viewBox:"0 0 30 30",directional:!0,svg:(0,o.jsx)("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},687039:(e,t,n)=>{n.d(t,{A:()=>s,V:()=>r});n(898992),n(430670);var o=n(296540),i=n(474848);const r={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function a(e){return e.src?(0,i.jsx)("img",{style:e.style,src:e.src}):null}const s=o.forwardRef((function(e,t){const r=(0,n(401497).DP)(),s=o.useRef(e);s.current=e,o.useEffect((()=>{const t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",document.body.appendChild(t);const n=window.Vimeo;if(!n)return()=>{};const o=document.getElementById(e.src),i=new n.Player(o);return i?(i.on("play",(e=>{var t,n;null===(t=(n=s.current).onPlay)||void 0===t||t.call(n,e)})),i.on("pause",(e=>{var t,n;null===(t=(n=s.current).onPause)||void 0===t||t.call(n,e)})),i.on("ended",(e=>{var t,n;null===(t=(n=s.current).onEnd)||void 0===t||t.call(n,e)})),()=>{i.off("play"),i.off("pause"),i.off("ended")}):()=>{}}),[e.src,s.current.src]);const l=function(e,t){const o=(0,n(534177).WP)(t).flatMap((e=>{let[t,n]=e;return`${t}=${n}`})).join("&");return`${e}&${o}`}(s.current.src,{texttrack:s.current.defaultTextTrack,playsinline:!1,...s.current.options}),d={position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,boxShadow:`0 1px 0 0 ${r.stroke.secondary}`};return(0,i.jsxs)(n(25500).A,{ratio:s.current.aspectRatioOverride??9/16,children:[(0,i.jsx)(a,{style:d,src:s.current.preloadThumbnailSrc}),(0,i.jsx)("iframe",{ref:t,id:s.current.src,className:s.current.className,allowFullScreen:!0,src:l,style:{...d,...s.current.style}})]})}))},687110:(e,t,n)=>{n.r(t),n.d(t,{PageAnalyticsPageOptOut:()=>y,TopbarPageAnalyticsOptOutMenu:()=>v,TopbarPageAnalyticsOptOutMenuStore:()=>h});n(296540);var o=()=>n(484714),i=()=>n(56366),r=()=>n(959013),a=()=>n(72234),s=()=>n(836251),l=()=>n(962730),d=()=>n(377586),c=()=>n(765957),u=()=>n(364280),p=()=>n(897119),m=()=>n(719147),g=()=>n(702723),f=n(474848);const h=n(757695).Store.createValue({isOpen:!1,rect:void 0},{name:"TopbarPageAnalyticsOptOutMenuStore"});function v(){const e=(0,o().v3)(),t=(0,i().K8)((()=>h.state.isOpen),[]),n=(0,i().K8)((()=>h.state.rect),[]),a=(0,i().O$)(c().AppStoreMainEditorCurrentBlockStore);return a?(0,f.jsx)(p().Ay,{popupType:e.device.isMobile?d().n.SlideUp:d().n.Popup,alignmentToOrigin:l().C.Center,open:t,render:()=>(0,f.jsx)("div",{style:{minWidth:360,padding:16},children:(0,f.jsxs)(u().VP,{gap:16,children:[(0,f.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,f.jsx)(r().sA,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,f.jsx)(y,{store:a})]})}),originRect:n,onDismiss:()=>h.setState({isOpen:!1,rect:void 0})}):null}function y(e){const t=(0,o().v3)(),n=(0,i().K8)((()=>{const e=c().default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),l=(0,i().K8)((()=>{const t=null==n?void 0:n.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[n,e.store.id]);return(0,f.jsx)(g().A,{type:"dropdown",currentOption:l?"do_not_record":"record",options:[{key:"record",label:(0,f.jsx)(r().sA,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,f.jsx)(r().sA,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don’t record"})}],onSelectOption:n=>{"do_not_record"===n?a().Oy(t,e.store.id):a().F3(t,e.store.id)},isMobile:t.device.isMobile,title:(0,f.jsx)(r().sA,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,f.jsx)(r().sA,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,f.jsx)(m().A,{external:!0,href:(0,s().xS)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},692996:(e,t,n)=>{n.d(t,{dl:()=>k,LV:()=>T});n(18107),n(944114),n(967357),n(898992),n(672577),n(296540);var o=()=>n(584262),i=()=>n(818044),r=n(474848);const a=(0,n(340498).wt)("pinStrikethrough",{viewBox:"0 0 15 19",svg:(0,r.jsx)("path",{d:"M3.094 1.328c0 .227.094.492.297.758.398.531 1.343 1.266 2.328 1.914l-.055.86 1.149 1.156.156-2.594c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102.007-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.961.867-2.14 1.468-.071.04-.087.079-.079.188l.234 3.875a7.12 7.12 0 00-1.437-.14h-.203l1.203 1.226c2.164.219 3.758 1.984 3.758 3.234 0 .04-.008.078-.008.117l.844.97c.257-.157.468-.477.468-.93 0-1.649-1.32-3.313-3.359-4.11L10.617 4c.992-.648 1.93-1.383 2.336-1.914.203-.266.297-.531.297-.758 0-.476-.367-.828-.914-.828H4.008c-.555 0-.914.352-.914.828zM.367 2.656l14.125 14.11a.603.603 0 00.852 0 .597.597 0 000-.852L1.227 1.804a.606.606 0 00-.86 0 .618.618 0 000 .852zm1.735 9.117c0 .665.445 1.102 1.148 1.102h4.234v3.648c0 1.196.493 2.188.688 2.188.195 0 .687-.992.687-2.188V12.97h.446L8.03 11.695H3.562c-.171 0-.257-.101-.226-.312.094-.875.828-1.805 1.984-2.399l-.82-.82c-1.477.867-2.398 2.234-2.398 3.61z"})});var s=()=>n(236262),l=()=>n(959013),d=()=>n(857783),c=()=>n(751156),u=()=>n(89924),p=()=>n(878377),m=()=>n(640653);n(354520);function g(e){let{blockId:t,transaction:o,spaceViewStore:i}=e;const r=((null==i?void 0:i.getPublicShareLinkPages())??[]).filter((e=>e!==t)),a=null==i?void 0:i.getBookmarkedPageIds().filter((e=>e!==t));n(246826).zv({store:i,data:{public_share_link_pages:r,bookmarked_pages:a},transaction:o})}var f=()=>n(869562),h=()=>n(765957),v=()=>n(795168),y=()=>n(599364),b=()=>n(654056),S=()=>n(416726),x=()=>n(910702);const A=(0,l().YK)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"},editFormName:{id:"action.editForm.name",defaultMessage:"Edit form"}}),M=(0,S().Ls)({key:"remove pinned shared page",displayName:A.unpinName,analyticsName:A.unpinName.defaultMessage,svg:a,validators:[p().p9k,p().qKm,p().AU6(p().nGR)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;const{currentSpaceViewStore:i,currentUserSettingsStore:r}=h().default.state;i&&r&&(c().createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:o,canUndo:!0,perform:e=>{for(const n of t)f().unpinSharedPage({environment:o,transaction:e,spaceViewStore:i,userSettingsStore:r,store:n})}}),n(899963).Nj(o,{type:"shared",from:"sidebar_dropdown_menu"}))}}),w=(0,S().Ls)({key:"edit form",displayName:A.editFormName,analyticsName:A.editFormName.defaultMessage,svg:n(173019).r,validators:[p().kD4,p().$68],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;const i=t[0],r=i.getFormBlockParentBlockStore();var a;r&&d().uK({environment:n,store:r,collectionViewId:null===(a=i.getParentStore())||void 0===a?void 0:a.id,pageVisitSource:o().y8.FormInternalPage})}}),k=(0,S().Ls)({key:"delete block without shortcuts",displayName:S().AY.moveToTrashName,analyticsName:S().AY.moveToTrashName.defaultMessage,svg:s().trashIcon,isRed:!0,validators:[p().or([p()._fc,p().t7S,p().IuJ]),p().SvZ,p().AU6(p().xqI),p().AU6(p().Xjv(n(700500).xd.externalObjectInstancePage)),p().AU6(p().PfK),p().zrb,p().AU6(p().oy3),p().AU6(p().Po5)],closeParentMenu:!0,track:{actionName:"move_to_trash"},render:(e,t,o)=>{const i=p().dj5(t.blocks.at(0));return(0,r.jsx)(n(859428).A,{renderTooltip:()=>(0,r.jsx)("div",{style:{maxWidth:400,whiteSpace:"pre-wrap"},children:(0,r.jsx)(l().sA,{...S().AY.cannotDeleteBlockTooltip})}),render:()=>(0,r.jsx)(n(575143).A,{...e,title:(0,r.jsx)(l().sA,{...S().AY.moveToTrashName}),svg:s().trashIcon,isRed:!0,disabled:i,disabledFeedback:i,tooltipText:i?(0,r.jsx)(l().sA,{...S().AY.cannotDeleteBlockTooltip}):void 0})})},action:async(e,t,o)=>{let{blocks:i,environment:r}=t;await n(797265).Af({environment:r,blocks:i,shouldCheckSuggestEdit:!1,callback:e})}}),j=(0,S().Ls)({key:"leave shared page",displayName:A.leaveName,analyticsName:A.leaveName.defaultMessage,svg:i().k,validators:[p().p9k,p().zq3,p().AU6(p().qsB)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;c().createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:n,canUndo:!0,perform:e=>{f().leaveBlocks({environment:n,blocks:t,transaction:e})}})}}),C=(0,S().Ls)({key:"leave public share link shared page",displayName:A.leaveName,analyticsName:A.leaveName.defaultMessage,svg:i().k,validators:[p().oRh,p().qsB],closeParentMenu:!0,action:e=>{var t,i,r;let{blocks:a,environment:s}=e;const{currentSpaceViewStore:l,currentUserSettingsStore:u,currentSpaceStore:p,mainEditorCurrentBlockStore:m}=h().default.state;if(!l||!u||!p)return;const f=null===(t=l.getSpaceStore())||void 0===t?void 0:t.id;if(!f)return;const v=n(90873).A.getSharedPagesState({spaceId:f,userId:u.id}),y=l.getPublicShareLinkPageStores().find((e=>e.id!==a[0].id)),b=null!=v&&null!==(i=v.currentPageIds)&&void 0!==i&&i[0]?n(148832).B.createChildStore(p.getPagesStore(),{table:n(179034).ev,id:null==v||null===(r=v.currentPageIds)||void 0===r?void 0:r[0],spaceId:p.id}):void 0;c().createAndCommit({userAction:"actionRegistry.leavePublicShareLinkSharedPage",environment:s,canUndo:!0,perform:e=>{g({blockId:a[0].id,transaction:e,spaceViewStore:l})}});(null==m?void 0:m.id)===a[0].id&&(y?d().uK({environment:s,store:y,pageVisitSource:o().y8.LeaveOrRemove}):b?d().uK({environment:s,store:b,pageVisitSource:o().y8.LeaveOrRemove}):n(435009).kc(s))}}),I=(0,S().uk)({key:"duplicate to workspace",displayName:A.duplicateToName,analyticsName:A.duplicateToName.defaultMessage,svg:n(212439).V,validators:[p()._fc,p().PaP,p().Km9,p().AU6(p().MIU),p().aAU],subActions:e=>{let{blocks:t,environment:o}=e;const{currentUserRootStore:i}=h().default.state;if(!i)return[];const a=t[0],s=n(186445).jU(i),l=[];for(const d of s){const e=d.getSpaceStore();if(e){const t=(0,m().GK)(o,e),i=(0,m().c2)(o,e);l.push({key:d.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await n(624550).w7({environment:o,store:a,spaceStore:e,spaceViewStore:d,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,o)=>{let{environment:a}=o;return(0,r.jsx)(n(760217).A,{title:t,icon:(0,r.jsx)(n(187820).B6,{icon:i,isEmptyPage:!1,title:t,size:a.device.isMobile?24:20,disabled:!0,iconRecordCategory:"workspace"}),...e})}})}}return[(0,S().gy)({key:"duplicate-to",render:e=>(0,r.jsx)(u().A,{...e}),actions:l})]}}),T=[n(354406).LQ,{key:"outliner organization actions",render:e=>(0,r.jsx)(u().A,{...e}),actions:[v()._J,v().wy,M,j,C]},{key:"outliner available offline action",render:e=>(0,r.jsx)(u().A,{...e}),actions:[n(178998).Z]},{key:"outliner primary actions",render:e=>(0,r.jsx)(u().A,{...e}),actions:[y().ko,y().oc,v().O5,v().tA,b().As,b().nK,b().J8,b().lb,I,w,n(22913).U,n(137743).t,k]},{key:"turn page into",render:e=>(0,r.jsx)(u().A,{...e}),actions:[x().zk,x().wm,x().Js]},{key:"outliner navigation",render:e=>(0,r.jsx)(u().A,{...e}),actions:n(909437).YO}]},696384:(e,t,n)=>{n.d(t,{V:()=>r,h:()=>i});var o=()=>n(91669);function i(){o().z.setState({isOpen:!0})}function r(){o().z.setState({isOpen:!1})}},697650:(e,t,n)=>{n.d(t,{BN:()=>l,Qo:()=>d,xf:()=>c});var o=()=>n(56366),i=()=>n(416504),r=()=>n(792071),a=()=>n(959013),s=()=>n(46986);function l(e){var t;let{collectionStore:n,intl:o,isWorkflowsContainerWithCreationEnabled:i}=e;return(null==n||null===(t=n.getModel())||void 0===t?void 0:t.getEmptyTitlePlaceholder({intl:o,isWorkflowsContainerWithCreationEnabled:i,getRecordModel:n.getRecordModel}))??o.formatMessage(r().WBy.messages.newDatabase)}function d(e){var t;const{collectionStore:n,intl:o,isWorkflowsContainerWithCreationEnabled:r}=e;return(null==n||null===(t=n.getModel())||void 0===t?void 0:t.getRenderTitleWithPlaceholder({intl:o,isWorkflowsContainerWithCreationEnabled:r,getRecordModel:n.getRecordModel,userTimeZone:(0,i().P)()}))??l(e)}function c(e){const t=(0,a().tz)(),n=(0,s().x6)();return(0,o().K8)((()=>d({collectionStore:e,intl:t,isWorkflowsContainerWithCreationEnabled:n})),[e,t,n])}},703875:(e,t,n)=>{n.d(t,{N:()=>r,V:()=>i});var o=()=>n(679924);function i(e){(0,o().v)(e,"view_public_site_click")}function r(e,t){(0,o().v)(e,"share_menu_tab_click",t)}},704907:(e,t,n)=>{n.d(t,{A:()=>g});var o=n(296540),i=()=>n(56366),r=()=>n(433847),a=()=>n(959013),s=()=>n(901389),l=()=>n(579627),d=()=>n(247123),c=()=>n(878377),u=()=>n(108944),p=()=>n(125565),m=n(474848);const g=function(e){let{store:t}=e;const g=(0,n(401497).DP)(),f=(0,n(484714).v3)(),h=(0,o.useMemo)((()=>({environment:f,blocks:[t],publicEditMode:void 0})),[f,t]),v=(0,i().K8)((()=>c().Uo6([c().Ezz,c().AU6(c().p2L)])(h)),[h]),y=(0,i().K8)((()=>c().Uo6([c()._mr,c().AU6(c().Km9)])(h)),[h]);if(v){const{device:e}=f;return(0,m.jsx)("div",{style:{backgroundColor:g.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${g.regularDividerColor}`,marginTop:e.isMobile?28:1},children:(0,m.jsxs)(n(704152).A,{disabled:!y,style:{padding:12},onClick:()=>async function(e,t){if(!e.isDefined())return;const n=e.getPermissionItems(),o=u().KA(e),i=o?r().wD(u().E(o)):[],c=r().Cd(e.getModel(),n,i),p={type:"restore",permissionChanges:c},{accept:g}=await s().Gh({message:(0,d().r6)(p),acceptLabel:(0,d().QU)(p),cancelLabel:(0,m.jsx)(a().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"}),description:(0,m.jsx)(d().f2,{openState:p})});g&&l().YD({environment:t,store:e})}(t,f),children:[(0,m.jsx)(p().A,{isMultiline:!0,isSmall:!0,children:(0,m.jsx)(a().sA,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),y?(0,m.jsx)(p().A,{style:{marginTop:6,fontWeight:n(284371).Wy.semibold},children:(0,m.jsx)(a().sA,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})}):void 0]})})}return null}},705630:(e,t,n)=>{n.r(t),n.d(t,{TopbarMoreButton:()=>T,messages:()=>_});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(589407),l=()=>n(340498),d=()=>n(959013),c=()=>n(741496),u=()=>n(679924);var p=()=>n(778417),m=()=>n(645873);const g=new(m().O2)("topbarMoreMenu",(async()=>await Promise.all([n.e(75134),n.e(9304),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(62475),n.e(3151),n.e(98629),n.e(49889),n.e(97727),n.e(22900),n.e(85128),n.e(95555),n.e(14659),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(93282),n.e(43678),n.e(15019),n.e(90978),n.e(3910),n.e(77213),n.e(6912),n.e(21194),n.e(30291),n.e(39541),n.e(12913),n.e(45620),n.e(54220),n.e(19930),n.e(81768),n.e(58102),n.e(52836),n.e(26483),n.e(19687),n.e(6463),n.e(68137),n.e(50569),n.e(40925),n.e(24975),n.e(282),n.e(87250),n.e(93847),n.e(79928),n.e(7203),n.e(61349),n.e(55197),n.e(94256),n.e(76690),n.e(29669),n.e(24930),n.e(62573),n.e(33882),n.e(44763),n.e(1440),n.e(5044),n.e(31782),n.e(93449),n.e(63996),n.e(895),n.e(66559),n.e(35986),n.e(45683),n.e(78862),n.e(38536),n.e(92924),n.e(64819),n.e(67378),n.e(40186),n.e(97339),n.e(55717),n.e(63797),n.e(56352),n.e(52811),n.e(28398),n.e(21367),n.e(65351),n.e(22686),n.e(4112),n.e(31889),n.e(36009),n.e(81973),n.e(2600),n.e(77663),n.e(97832),n.e(75681)]).then(n.bind(n,628302)))),f=(0,m()._h)(g,(e=>e.TopbarMoreMenu));var h=()=>n(494043),v=()=>n(448360),y=()=>n(765957),b=()=>n(816013),S=()=>n(318890),x=()=>n(594607),A=()=>n(953006),M=n(474848);function w(e){const{originRef:t}=e,n=(0,a().IS)((e=>({aiTranslateIcon:{height:18,width:18,fill:e.text.uiBluePrimary}})),[]);return(0,M.jsx)(x().U,{calloutId:"ai_page_translation",children:(0,M.jsx)(A().k,{origin:t,placementToOrigin:"bottom",header:(0,M.jsxs)("div",{style:{display:"flex",fontSize:14,gap:12,paddingLeft:4,paddingRight:4},children:[(0,S().K)(n.aiTranslateIcon),(0,M.jsx)(d().sA,{id:"aiPageTranslationTooltip.header",defaultMessage:"You can always find translation in the top right menu"})]}),showPointer:!1,pointerOffset:6,content:null,onCloseClick:()=>{v().W.reset()},style:{width:300},onPrimaryButtonClick:()=>{v().W.reset()},nextButtonContent:(0,M.jsx)(d().sA,{id:"aiPageTranslationTooltip.dismiss",defaultMessage:"Got it"})})})}var k=()=>n(406699),j=()=>n(612900),C=()=>n(782473);function I(e){let{originRef:t}=e;return(0,M.jsx)(x().U,{calloutId:"wiki_promo",children:(0,M.jsx)(A().k,{origin:t,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{b().r.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:C().Sw}})})}function T(e){let{buttonPopupStore:t,store:n,isLastButton:s,renderOrigin:l}=e;const d=(0,i().v3)(),{device:m}=d,[g,S]=(0,o.useState)(void 0),x=(0,o.useRef)(null),A=(0,o.useCallback)((()=>{b().r.reset(),v().W.reset(),p().IU({environment:d});const e=x.current;e&&S(e.getBoundingClientRect()),function(e){(0,u().v)(e,"open_more_menu")}(d)}),[x,d]),C=(0,r().K8)((()=>b().r.state.showConvertTooltip),[]),T=(0,r().O$)(v().W),_=(0,a().IS)((e=>({mobilePopupStyle:{borderRadius:12,backgroundColor:e.surface.wash}})),[]),P=(0,M.jsxs)(M.Fragment,{children:[C?(0,M.jsx)(I,{originRef:x}):T?(0,M.jsx)(w,{originRef:x}):null,(0,M.jsx)(k().Ay,{popupType:m.isMobile?k().z7.BottomSheet:k().z7.Popup,buttonPopupStore:t,renderOrigin:l||(e=>(0,M.jsx)(L,{ref:x,buttonPopupEvents:e,isLastButton:s})),onClick:A,render:()=>(0,M.jsx)(f,{blockStore:n,onClickOriginRect:g,handleAccept:e=>function(e,t,n){const{mainEditorCurrentBlockStore:o}=y().default.state;if(o){const t=o.getType();var i;if(t)(0,c().N)(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:o.id,block_type:t,is_toggleable:(0,h().Yt)(t,o.getFormat()),collection_id:null===(i=o.getCollectionViewSourceCollectionStore())||void 0===i?void 0:i.id,parent_collection_id:o.getParentCollectionIdUpToTwoLevels(),form_id:o.getFirstFormIdInCollectionViewBlock()})}e.closeParentMenu&&B(t)}(e,t,d),handleDismiss:()=>B(t)}),originGap:m.isElectronWindows?12:8,forceInitialInbound:!0,style:m.isMobile?_.mobilePopupStyle:{width:256,maxHeight:"80vh"}})]}),R=(0,r().K8)((()=>y().default.state.inAppCalloutStore.getCalloutVisibility("ai_page_translation").canShow),[]);return T&&R?(0,M.jsx)(j().u,{shape:"square",borderRadius:6,children:P}):P}const _=(0,d().YK)({actions:{defaultMessage:"Actions",id:"topbar.actions"}});function P(e,t,o){const{device:i}=e;if(!i.isMobile){const{iconButton:{width:e,height:o}}=(0,n(863059).Hh)(t);return{display:"flex",alignItems:"center",justifyContent:"center",width:e,height:o,borderRadius:6}}const r=(0,n(978578).aD)(t).iconContainer;return o?{...r,marginLeft:i.isTablet?-6:void 0,marginRight:0}:{...r,marginLeft:i.isTablet?-6:void 0,marginRight:i.isTablet?-6:r.marginRight}}function B(e){e.setState({...e.state,open:!1})}const L=o.forwardRef((function(e,t){let{buttonPopupEvents:o,isLastButton:r}=e;const c=(0,a().DP)(),u=(0,i().v3)(),{device:p}=u,m=(0,d().tz)();return(0,M.jsx)(n(859428).A,{renderTooltip:()=>u.currentUser.isLoggedIn()?(0,M.jsx)(d().sA,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,M.jsx)(d().sA,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:n(962730).W.Bottom,originGap:p.isElectronWindows?10:void 0,delayThreshold:400,render:e=>(0,M.jsx)(n(704152).A,{ref:t,style:P(u,c,r),className:n(38337).ug9,ariaLabel:m.formatMessage(_.actions),...(0,n(553965).A)(o,e),children:p.isMobile?(0,s().L)({height:l().lD.lg,width:l().lD.lg,fill:c.icon.primary}):(0,s().L)({width:l().Ev.lg,height:l().Ev.lg,fill:c.icon.primary})})})}))},712493:(e,t,n)=>{n.r(t),n.d(t,{DummyModal:()=>d});n(296540);var o=()=>n(148307),i=()=>n(959013),r=()=>n(766676),a=n(474848);function s(e){const{messageKey:t}=e,n={id:"",key:t,type:"static",props:{}};return(0,a.jsx)(r().C,{...e,message:n})}const l=(0,i().YK)({title:{id:"dummyModal.title",defaultMessage:"Dummy Modal"},body:{id:"dummyModal.body",defaultMessage:"This is the body for the dummy modal."},primaryButton:{id:"dummyModal.primaryButton",defaultMessage:"Primary"},secondaryButton:{id:"dummyModal.secondaryButton",defaultMessage:"Secondary"},learnMore:{id:"dummyModal.learnMore",defaultMessage:"Learn More"}});function d(){const e=(0,i().tz)();return(0,a.jsx)(s,{messageKey:"dummy_modal",title:e.formatMessage(l.title),body:e.formatMessage(l.body),heroMedia:{src:o().A.images.sites.sitesLaunchModalPng,alt:"Dummy Modal",type:"image"},primary:{text:e.formatMessage(l.primaryButton)},secondary:{text:e.formatMessage(l.secondaryButton)},link:{text:e.formatMessage(l.learnMore),external:!0}})}},715011:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(296540),i=()=>n(959013),r=()=>n(409268),a=n(474848);function s(e){const t=(0,o.useMemo)((()=>(0,r().s)(e.store)),[e.store]);return(0,a.jsx)(i().sA,{id:"pageWordCount.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:t}})}},729650:(e,t,n)=>{n.d(t,{M:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("collectionInbox",{viewBox:"0 0 14 14",svg:(0,o.jsx)("path",{d:"M11.0918,0 C11.5383,0 11.9307,0.295898 12.0533,0.725586 L13.9615,7.40332 C13.9871,7.49316 14,7.58594 14,7.67871 L14,13 C14,13.5527 13.5522,14 13,14 L1,14 C0.447754,14 0,13.5527 0,13 L0,7.67871 C0,7.58594 0.0129395,7.49316 0.0384521,7.40332 L1.94666,0.725586 C2.06934,0.295898 2.46167,0 2.9082,0 L11.0918,0 Z M4.27271,1.5 C3.83728,1.5 3.45178,1.78223 3.31982,2.19727 L1.91455,6.61328 C1.70947,7.25879 2.1908,7.91699 2.86755,7.91699 L4.70837,7.91699 C4.70837,8.93652 5.16663,10.168 7,10.168 C8.83337,10.168 9.29163,8.93652 9.29163,7.91699 L11.1478,7.89355 C11.8201,7.88477 12.2927,7.22852 12.0876,6.58887 L10.681,2.19531 C10.5485,1.78125 10.1635,1.5 9.72864,1.5 L4.27271,1.5 Z"})})},731120:(e,t,n)=>{n.d(t,{A:()=>o});class o extends(()=>n(757695))().Store{getInitialState(){return{isOpen:!1}}}},736026:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const i=new o},751237:(e,t,n)=>{n.r(t),n.d(t,{AiAssistantIntroModal:()=>G,useAssistantIntroModalStyles:()=>q,useIdleFaceAsset:()=>Q,useSetLastExposedToQnaAtTimestamp:()=>oe});n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(852507),a=()=>n(56366),s=()=>n(401497),l=()=>n(218275),d=()=>n(471095),c=()=>n(340498),u=()=>n(959013),p=()=>n(534177),m=()=>n(284371),g=()=>n(352097),f=()=>n(246826),h=()=>n(201938),v=()=>n(435009),y=()=>n(751156),b=()=>n(323714),S=()=>n(140022),x=()=>n(501305),A=()=>n(229977),M=()=>n(146535),w=()=>n(737497),k=()=>n(656633);var j=()=>n(581495),C=()=>n(614415),I=()=>n(645873),T=()=>n(299487),_=()=>n(218429),P=()=>n(765957),B=()=>n(430483),L=()=>n(84817),R=()=>n(296798),D=()=>n(509657),N=()=>n(204063),O=()=>n(125565),E=()=>n(719147),U=n(474848);const F=24,V=254,z=170,K=(0,u().YK)({shareDataTitle:{defaultMessage:"You’re in control of your data",id:"AiAssistantWelcomeModal.intro.titleShareData"},shareDataHeader:{defaultMessage:"By default, Notion does not train on your content",id:"AiAssistantWelcomeModal.intro.shareDataHeader"},shareDataDescription:{defaultMessage:"But, if you’d like to help improve our models and features, please opt-in below:",id:"AiAssistantWelcomeModal.intro.shareDataDescription"},welcomeTitle:{defaultMessage:"Meet the new Notion AI",id:"AiAssistantWelcomeModal.intro.title"},subtitle:{defaultMessage:"One AI tool that does it all. Search, generate, analyze, and chat—right inside Notion.",id:"AiAssistantWelcomeModal.intro.subtitle"},findInSlack:{defaultMessage:"Find in Slack",id:"AiAssistantIntroModal.findInSlack"},findInGoogleDrive:{defaultMessage:"Find in Google Drive",id:"AiAssistantIntroModal.findInGoogleDrive"},attachFile:{defaultMessage:"Analyze PDF",id:"AiAssistantIntroModal.attachPDF"}}),W=[{id:g().Fi.searchQnA.id,label:g().Fi.searchQnA,icon:n(207207).J,color:"blue"},{id:g().Fi.chatKeyPoints.id,label:g().Fi.chatKeyPoints,icon:n(202017).n,color:"green"},{id:g().Fi.brainstormIdeas.id,label:g().Fi.brainstormIdeas,icon:n(123411).X,color:"green"},{id:g().Fi.writeCode.id,label:g().Fi.writeCode,icon:n(481721).codeIcon,color:"green"},{id:g().Fi.draftDiagram.id,label:g().Fi.draftDiagram,icon:n(413364).E,color:"purple"},{id:"attachment",label:K.attachFile,icon:n(609616).o},{id:g().Fi.draftTable.id,label:g().Fi.draftTable,icon:n(421559).T,color:"purple"},{id:g().Fi.draftMeetingAgenda.id,label:g().Fi.draftMeetingAgenda,icon:n(105819).pencilLineIcon,color:"purple"},{id:g().Fi.translate.id,label:g().Fi.translate,icon:n(877235).H,color:"green"},{id:g().Fi.improveWriting.id,label:g().Fi.improveWriting,icon:n(116089).x,color:"purple"},{id:"findInGoogleDrive",label:K.findInGoogleDrive,icon:n(74007).googleDriveIcon},{id:"findInSlack",label:K.findInSlack,icon:n(888382).slackIcon}],H=W.concat(W).concat(W);function G(){const e=(0,i().v3)(),t=(0,o.useCallback)((t=>{let{source:n}=t;const{currentUserSettingsStore:o}=P().default.state;o&&((0,S().trackAssistantIntroModalClose)(e,{source:n}),(0,b().setAssistantOnboardingPhase)(e,{phase:"tooltip",transactionUserAction:"AiAssistantIntroModal.dismissModal",userSettingsStore:o}),T().a(e,"ai_assistant_announcement"))}),[e]);return oe(),(0,U.jsx)(_().l,{messageKey:"ai_assistant_announcement",desktopRenderInner:()=>(0,U.jsx)(J,{onDismiss:t}),phoneRenderInner:()=>null})}function Y(){const e=q();return(0,U.jsxs)("div",{style:e.rowItemWrapper,children:[(0,U.jsx)("div",{style:e.rowItemIconWrapper,children:(0,d().i)(e.rowItemIcon)}),(0,U.jsxs)("div",{style:e.textWrapper,children:[(0,U.jsx)("div",{style:e.sharedataTitle,children:(0,U.jsx)(u().sA,{...K.shareDataHeader})}),(0,U.jsx)(O().A,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,U.jsx)(u().sA,{...K.shareDataDescription})})]})]})}function q(){const e=ie();return(0,s().IS)((t=>({...e,rowItemWrapper:{display:"flex",alignItems:"start",marginBottom:12},rowItemIconWrapper:{color:t.palette.uiBlue[600],background:t.palette.uiBlue[100],display:"flex",alignItems:"center",justifyContent:"center",borderRadius:100,marginRight:8},rowItemIcon:{height:30,width:30,padding:8},sharedataTitle:{fontWeight:m().Wy.medium,fontSize:14,marginBottom:4},textWrapper:{display:"flex",flexDirection:"column",maxWidth:"100%"},icon:{width:16,height:16,marginTop:2},sparklesIcon:{fill:t.palette.translucentGray[800],width:14},contentWrapper:{paddingLeft:24,paddingRight:26,width:424},assistantIntroHeaderWrapper:{height:200},title:{fontSize:25,fontWeight:700,paddingBottom:8},subtitle:{fontSize:m().J.UIRegular.desktop,fontWeight:m().Wy.regular,color:t.text.secondary},body:{fontWeight:400,fontSize:14,color:t.text.secondary},faceImg:{pointerEvents:"none",width:72,height:72,boxShadow:t.shadowSM,borderRadius:100,flexGrow:0},imgWrap:{display:"flex",alignItems:"center",paddingTop:40,paddingBottom:30,paddingLeft:24},spacer:{marginTop:20,marginBottom:20},footer:{paddingTop:8,paddingBottom:24,marginTop:20},simpleFooter:{paddingBottom:24},helpTitle:{fontSize:14,fontWeight:600},consentButton:{fontWeight:600,height:"36px"},firstSelector:{fontWeight:400,border:"none"},lastSelector:{fontWeight:400,border:"none"},introAnimationWrapper:{height:294,overflowY:"hidden",maskImage:"linear-gradient(to bottom, rgba(0, 0, 0,0) 24px, rgba(0, 0, 0) 50%, rgba(0,0,0,0) 265px"},introAnimationWrapperLeapStep:{height:140,marginTop:8},faceWrapper:{alignContent:"center",paddingLeft:2},faceWrapperLeapStep:{height:"100%",alignContent:"center",paddingLeft:2,paddingTop:40,paddingBottom:30},skillListWrapper:{display:"flex",flexDirection:"column",gap:8,marginLeft:24,overflowY:"hidden"},pillWrapper:{display:"flex",alignItems:"start",padding:"8px 16px 8px 12px",borderRadius:18,backgroundColor:t.tint.regular,color:t.text.primary,fontSize:14,flexWrap:"nowrap",fontWeight:m().Wy.medium,gap:8,width:"fit-content"},blue:{color:t.palette.uiBlue[500]},green:{color:t.palette.green[500]},purple:{color:t.palette.purple[500]}})),[e])}function $(e){const{label:t,icon:n,color:o}=e,i=q(),r=o?i[o]:{},{value:a}=(0,I().fJ)(C().fM);if(!a)return null;const{motion:s}=a;return(0,U.jsxs)(s.div,{style:i.pillWrapper,children:[n({...i.icon,...r}),(0,U.jsx)(u().sA,{...t})]})}function Q(){const e=(0,s().DP)();return(0,o.useMemo)((()=>"dark"===e.mode?M():w()),[e])}function Z(e){const t=q(),{phase:n}=e,o="welcome"===n,i=Q(),{value:r}=(0,I().fJ)(C().fM);if(!r)return null;const{motion:a}=r;return(0,U.jsx)("div",{style:o?t.introAnimationWrapper:t.introAnimationWrapperLeapStep,children:(0,U.jsxs)(L().Y1,{gap:0,direction:"horizontal",height:"fill",align:o?"center":"center-left",children:[(0,U.jsx)(a.div,{layoutId:"face",style:t.faceWrapper,children:(0,U.jsx)("img",{style:t.faceImg,src:i,alt:"Notion AI logo"})}),(0,U.jsx)(a.div,{initial:{y:45},animate:{y:-45*(W.length-1)},transition:{repeat:1/0,duration:22,ease:"linear"},style:{...t.skillListWrapper,opacity:o?1:0},children:H.map(((e,t)=>(0,U.jsx)($,{label:e.label,icon:e.icon,color:e.color},e.id+t)))})]})})}function X(e){const{environment:t}=e,n=B().zD.getNavigationTargetForTryAssistantNowButton();switch(n){case"fullPage":v().oo({environment:t,url:"/chat"});break;case"corner":(0,x().openAssistantRightHandSideMenu)({environment:t,from:"assistant_intro_modal"});break;case"writer":h().f({environment:t,prefill:void 0});break;default:(0,p().HB)(n)}}function J(e){const{onDismiss:t}=e,n=(0,i().v3)(),[r,s]=(0,o.useState)("welcome"),l=(0,a().K8)((()=>{const e=P().default.state.currentSpaceStore,t=P().default.state.currentSpaceViewStore;return!(!e||!t)&&function(e){var t;const{environment:n,assistantFeatureGateStore:o,currentSpaceViewStore:i,currentSpaceStore:r}=e;return!(!i||!r)&&!!r.canAdmin()&&!(0,k().vp)(n,r.id)&&!Boolean(null===(t=i.getSettings())||void 0===t?void 0:t.has_user_seen_leap_modal)&&!Boolean(r.getSettings().enable_ai_training)&&o.isWorkspaceLeapEligible()}({environment:n,assistantFeatureGateStore:B().zD,currentSpaceStore:e,currentSpaceViewStore:t})}),[n]),d=(0,o.useCallback)((()=>{l?s("leap"):((0,S().trackAssistantIntroModalTryNow)(n,{}),t({source:"tryNow"}),X({environment:n}))}),[l,n,t]),c=(0,o.useCallback)((()=>{if(t({source:"closeButton"}),l){const e=P().default.state.currentSpaceViewStore;if(!e)return;y().createAndCommit({userAction:"AiAssistantIntroModal.updateLeapModalSeen",environment:n,canUndo:!0,perform:t=>{y().applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),has_user_seen_leap_modal:!0}},transaction:t})}})}}),[t,l,n]),p=(0,o.useCallback)((()=>{A().assistantAnalyticsActions.trackLeapDismissed(n),c()}),[n,c]);(0,o.useEffect)((()=>{const e=Date.now();return()=>{const t=Date.now();(0,S().trackAssistantIntroModalRead)(n,{reading_time:t-e})}}),[]);const m=q(),g=(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Z,{phase:"welcome"}),(0,U.jsx)("div",{style:m.title,children:(0,U.jsx)(u().sA,{...K.welcomeTitle})}),(0,U.jsx)("div",{style:m.subtitle,children:(0,U.jsx)(u().sA,{...K.subtitle})}),(0,U.jsxs)(L().Y1,{align:"center",direction:"horizontal",gap:"auto",style:m.footer,children:[(0,U.jsx)(ne,{}),(0,U.jsx)(L().Y1,{align:"center-right",direction:"horizontal",gap:12,width:"hug",children:(0,U.jsx)(N().A,{color:"black",size:"xl",onClick:d,children:(0,U.jsx)(u().sA,{defaultMessage:"Try it",id:"AssistantIntroMessage.intro.signup.nextMessage"})})})]})]});return(0,U.jsxs)("div",{children:[(0,U.jsx)(j().Rz,{onDismiss:c}),(0,U.jsx)(L().Y1,{gap:0,children:(0,U.jsx)("div",{style:m.contentWrapper,children:"leap"===r?(0,U.jsx)(ee,{onDismiss:p}):g})})]})}function ee(e){const{onDismiss:t}=e,[n,a]=(0,o.useState)(),l=void 0===n,d=(0,i().v3)(),c=(0,o.useCallback)((e=>{a(e),A().assistantAnalyticsActions.trackLeapPreferenceSelect(d,{will_share:e})}),[d]),m=(0,o.useCallback)((e=>{const t=P().default.state.currentSpaceStore;t&&y().createAndCommit({userAction:"AiAssistantIntroModal.updateWorkspaceShouldTrain",environment:d,canUndo:!0,perform:n=>{f().zv({store:t,data:{settings:{...t.getSettings(),enable_ai_training:e}},transaction:n})}})}),[d]),g=(0,o.useCallback)((()=>{(0,p().O9)(n)&&(m(n),A().assistantAnalyticsActions.trackLeapSubmit(d,{will_share:n})),t(),X({environment:d})}),[d,t,n,m]);(0,r().l)((()=>{A().assistantAnalyticsActions.trackLeapPresented(d)}));const h=q(),v=(0,s().IS)((()=>({...h,titleLeap:{marginBottom:12}})),[h]);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(Z,{phase:"leap"}),(0,U.jsx)("div",{style:{...v.title,...v.titleLeap},children:(0,U.jsx)(u().sA,{...K.shareDataTitle})}),(0,U.jsx)(Y,{}),(0,U.jsxs)(L().Y1,{direction:"vertical",children:[(0,U.jsx)(D().a,{style:v.firstSelector,label:(0,U.jsx)(u().sA,{defaultMessage:"Share data to help improve Notion AI",id:"AiAssistantWelcomeModal.admin.shareData"}),onChange:()=>{},isSelected:!0===n,onClick:()=>c(!0),value:"share_data",selectType:"radio"}),(0,U.jsx)(D().a,{style:v.lastSelector,label:(0,U.jsx)(u().sA,{defaultMessage:"Do not share data",id:"AiAssistantWelcomeModal.admin.doNotShareData"}),onChange:()=>{},selectType:"radio",isSelected:!1===n,onClick:()=>c(!1),value:"do_not_share_data"})]}),(0,U.jsxs)(L().Y1,{align:"center",direction:"horizontal",gap:"auto",style:v.footer,children:[(0,U.jsx)(te,{}),(0,U.jsx)(L().Y1,{align:"center-right",direction:"horizontal",gap:12,width:"hug",children:(0,U.jsx)(N().A,{color:"black",size:"xl",onClick:g,disabled:l,children:(0,U.jsx)(u().sA,{defaultMessage:"Confirm",id:"AssistantIntroMessage.intro.signup.confirmMessage"})})})]})]})}function te(){const e=(0,s().DP)(),t=(0,i().v3)(),n=(0,o.useCallback)((e=>{A().assistantAnalyticsActions.trackLeapLinkClick(t,{link:e})}),[t]);return(0,U.jsx)("div",{style:{color:e.text.secondary,fontSize:12,width:256},children:(0,U.jsx)("div",{children:(0,U.jsx)(u().sA,{defaultMessage:"If you choose to share data, you are agreeing to these <terms>Terms</terms>. <learnmore>Learn more</learnmore>",id:"AiAssistantIntroModal.AdminAgreeToTerms",values:{terms:e=>(0,U.jsx)(E().A,{onClick:()=>n("terms"),external:!0,href:"https://www.notion.so/notion/Notion-AI-Learning-and-Early-Access-Program-Terms-0c55d702d0154a788d9e70c4ee396399",children:e}),learnmore:e=>(0,U.jsxs)("span",{style:{display:"inline-flex",alignItems:"center",gap:"2px"},children:[(0,U.jsx)(E().A,{onClick:()=>n("faq"),external:!0,href:"https://www.notion.so/help/notion-ai-leap-program-faqs",children:e}),(0,l().arrowUpRightSquareSmallIcon)({width:c().Ev.sm,height:c().Ev.sm})]})}})})})}function ne(){const e=ie(),t=(0,i().v3)(),n=(0,o.useCallback)((()=>{(0,S().trackLearnMoreAboutAssistantClicked)(t,{})}),[t]);return(0,U.jsx)("div",{style:e.learnMoreCopy,children:(0,U.jsxs)(R().A,{onClick:n,style:e.learnMoreLink,innerStyle:e.learnMoreLinkInner,href:"https://www.notion.so/help/guides/everything-you-can-do-with-notion-ai",external:!0,children:[(0,U.jsx)(u().sA,{defaultMessage:"Learn more",id:"AiAssistantIntroModal.LearnMoreAboutAssistantButton"}),(0,l().arrowUpRightSquareSmallIcon)({width:c().Ev.sm,height:c().Ev.sm,marginTop:2,marginLeft:4})]})})}function oe(){const e=(0,o.useRef)(!1),t=(0,i().v3)();(0,a().K8)((()=>{const{currentUserSettingsStore:n}=P().default.state;if(!n||!n.isReady())return;if(!B().zD.showRemindersToUseQnA())return;const o=n.getSettingsStore().getKeyStore("last_exposed_to_ai_qna_at").getValue();(0,p().O9)(o)||e.current||(e.current=!0,(0,b().setLastExposedToQnaAtToCurrentTimestamp)(t,{userSettingsStore:n}))}),[t])}function ie(){return(0,s().IS)((e=>({betaBadge:{borderRadius:4,display:"inline-block",fontSize:11,fontWeight:500,padding:"1px 4px"},importDisclaimerWrap:{marginTop:10,display:"flex",alignItems:"center",gap:2},clockIcon:{width:14,height:14,color:e.text.secondary},footer:{borderTop:`1px solid ${e.tableLightDividerColor}`},introCopyArea:{paddingLeft:F,paddingRight:F},introTitle:{fontWeight:m().Wy.bold,fontSize:25,display:"flex"},learnMoreCopy:{color:e.text.secondary,fontSize:12,textDecoration:"underline"},learnMoreLink:{width:"max-content",marginLeft:-4},learnMoreLinkInner:{display:"flex",alignItems:"center",paddingLeft:4,paddingRight:4},mainCopyText:{width:350},notionAiText:{marginTop:2,paddingLeft:4,color:e.palette.gray[900],fontWeight:m().Wy.medium},sparklesIcon:{width:14},stubPng:{width:"100%",height:V},smallVariantVideoStubPng:{width:"100%",height:z}})),[])}},751348:(e,t,n)=>{n.d(t,{n:()=>r});var o=()=>n(56366),i=()=>n(303742);function r(e){return(0,o().K8)((()=>(0,i().o)(e)),[e])}},755170:(e,t,n)=>{n.d(t,{A:()=>y});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(340498),l=()=>n(284371),d=()=>n(859428),c=()=>n(115512),u=()=>n(962730),p=()=>n(430483),m=()=>n(665579),g=()=>n(534177),f=n(474848);const h=function(e){let{additionalStyles:t,transitionMs:o,force:i,children:r}=e;const s=(0,n(827912).j)(),l=(0,a().IS)((()=>{let e;switch(i){case"forceShow":e=1;break;case"forceHide":e=0;break;case void 0:e=s?1:0;break;default:(0,g().HB)(i)}return{hoverStyle:{opacity:e,transition:`opacity ${(0,g().O9)(o)?o:200}ms ease-in`,...t}}}),[t,i,s,o]);return(0,f.jsx)("div",{style:l.hoverStyle,children:r})};function v(e){let{icon:t,title:n,tooltip:o,hasRightElement:m,iconContainerStyle:g}=e;const h=(0,i().v3)(),v=(0,r().O$)(p().gA),y=(0,a().IS)((e=>({panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,c().ny)(h,"UISmall"),fontWeight:l().Wy.medium,color:e.text.secondary,fill:e.icon.secondary,flexShrink:0,maxWidth:m?200:"100%"},title:{...l().RC},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:s().Ev.sm,height:s().Ev.sm,marginRight:v?6:8,marginTop:1,...g}})),[h,g,m,v]);return n?(0,f.jsx)(d().A,{renderTooltip:()=>o,disableTooltip:!o,placement:u().W.Top,alignment:u().C.Start,render:e=>(0,f.jsxs)("div",{style:y.panelTitleAndIcon,...e,children:[(0,f.jsx)("div",{style:y.panelIconContainer,children:t}),(0,f.jsx)("span",{style:y.title,children:n})]})}):null}const y=function(e){let{children:t,title:s,icon:l,tooltip:d,iconContainerStyle:c,panelStyle:u,headerStyle:p,rightStyle:g,actions:y,right:b,disableRightFadeIn:S,disableActionsFadeIn:x,hideWrapStyle:A,actionsGap:M,userSelectOverride:w}=e;const k=(0,i().WS)(),j=Boolean(s),C=Boolean(b),I=(0,r().uB)(void 0,n(620090).B),T=(0,r().uB)(void 0,n(1248)._),_=(0,o.useMemo)((()=>({isHoveredOnPanelStore:I,sizeStore:T})),[I,T]),P=(0,o.useCallback)((()=>I.setState(!0)),[I]),B=(0,o.useCallback)((()=>I.setState(!1)),[I]),L=(0,o.useCallback)((e=>{e.width<m().Xy?T.setState("narrow"):T.setState("wide")}),[T]),R=(0,a().IS)((e=>({tile:{userSelect:w??"none",WebkitUserSelect:w??"none"},panel:A?{}:{paddingLeft:12,paddingRight:12,...(0,m().V$)({isPhone:k,theme:e}),...u},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:32,paddingBottom:14,marginLeft:m().Fq,...p},rightActions:{display:"flex",flexDirection:"row",alignItems:"center"},actions:{display:"flex",alignItems:"center",gap:M??6,paddingLeft:6}})),[k,A,u,p,M,w]),D=(j||C)&&(0,f.jsxs)("div",{style:R.headerContainer,children:[(0,f.jsx)(v,{title:s,icon:l,tooltip:d,hasRightElement:C,iconContainerStyle:c}),(C||y)&&(0,f.jsxs)("div",{style:R.rightActions,children:[C&&(0,f.jsx)(h,{force:S?"forceShow":void 0,additionalStyles:g,children:b}),y&&(0,f.jsx)(h,{force:x?"forceShow":void 0,additionalStyles:R.actions,children:y})]})]});return(0,f.jsx)(n(273923).R.Provider,{value:_,children:(0,f.jsxs)("div",{style:R.tile,onMouseEnter:P,onMouseLeave:B,children:[D,(0,f.jsx)(n(828634).EE,{onSizeChange:L,children:(0,f.jsx)("div",{style:R.panel,children:t})})]})})}},756581:(e,t,n)=>{n.d(t,{C:()=>d,V:()=>l});var o=()=>n(47170),i=()=>n(249847),r=()=>n(963589),a=()=>n(329304),s=()=>n(722038);function l(){const e=(0,s().y)(),t=(0,r().X)("offline_monetization"),n=(0,o().O)(),l=(0,i().T)(),d=(0,a()._X)({name:"offline_auto_sync",spaceId:n,userId:l});if(e)return t?d:{expiry:void 0,limit:{type:"none"},type:"available",upsell:void 0}}function d(){const e=l();return Boolean("available"===(null==e?void 0:e.type))}},756710:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ae});n(296540);var o=()=>n(484714),i=()=>n(56366),r=()=>n(854150),a=()=>n(959013),s=()=>n(496603),l=()=>n(534177),d=()=>n(795168),c=()=>n(89924),u=n(474848);const p=[{key:"block in comment menu primary",render:e=>(0,u.jsx)(c().A,{...e}),actions:[n(254452).z,d().b2,d().qI]}];var m=()=>n(692996),g=()=>n(599364);const f=[{key:"page mention context menu primary",render:e=>(0,u.jsx)(c().A,{...e}),actions:[...n(909437).YO,g().oc,g().ko]}];var h=()=>n(741496),v=()=>n(901265),y=()=>n(186445),b=()=>n(476492),S=()=>n(722872),x=()=>n(836251),A=()=>n(494043),M=()=>n(857437),w=()=>n(691298),k=()=>n(696746),j=(n(581454),()=>n(933152)),C=()=>n(764781),I=()=>n(236262),T=()=>n(637433),_=()=>n(381349),P=()=>n(416726),B=()=>n(896628),L=()=>n(751156),R=()=>n(575143),D=()=>n(878377),N=()=>n(972435),O=()=>n(919878);const E=(0,a().YK)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),U=(0,P().fi)({key:"simple table header column",displayName:E.simpleTableHeaderColumn,label:N().A.formatMessage(E.simpleTableHeaderColumn),getSvgIcon:()=>n(696575).X,validators:[D().p2L,D().AU6(D().wFE),D().xCr,D().z5D],isChecked:e=>Boolean(e.getFormat().table_block_row_header),action:(e,t,n)=>B().zA({stores:[t],update:{table_block_row_header:!t.getFormat().table_block_row_header},transaction:n})}),F=(0,P().fi)({key:"simple table header row",displayName:E.simpleTableHeaderRow,label:N().A.formatMessage(E.simpleTableHeaderRow),getSvgIcon:()=>n(464291).p,validators:[D().p2L,D().AU6(D().wFE),D().nRE],isChecked:e=>{const t=e.getParentBlockStore();return!(null==t||!t.isType("table"))&&Boolean(t.getFormat().table_block_column_header)},action:(e,t,n)=>{const o=t.getParentBlockStore();null!=o&&o.isType("table")&&B().zA({stores:[o],update:{table_block_column_header:!o.getFormat().table_block_column_header},transaction:n})}}),V=(0,P().Ls)({key:"insert column left",displayName:E.simpleTableInsertColumnLeft,analyticsName:E.simpleTableInsertColumnLeft.defaultMessage,svg:n(526278).w,validators:[D().p2L,D().AU6(D().vEP),D().xCr,D().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,canUndo:!0,perform:e=>{O().T4({environment:t,transaction:e})}})}}),z=(0,P().Ls)({key:"insert column right",displayName:E.simpleTableInsertColumnRight,analyticsName:E.simpleTableInsertColumnRight.defaultMessage,svg:n(940563).P,validators:[D().p2L,D().AU6(D().vEP),D().xCr,D().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,canUndo:!0,perform:e=>{O().sf({environment:t,transaction:e})}})}}),K=(0,P().Fw)({key:"duplicate columns",displayName:P().AY.duplicateName,analyticsName:P().AY.duplicateName.defaultMessage,svg:C().V,validators:[D().p2L,D().AU6(D().vEP),D().xCr,D().Pqm],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,canUndo:!0,perform:e=>{O().V0({transaction:e})}})}}),W=(0,P().Fw)({key:"delete columns",displayName:P().AY.deleteName,analyticsName:P().AY.deleteName.defaultMessage,svg:I().trashIcon,validators:[D().p2L,D().AU6(D().vEP),D().xCr,D().Jt9,D().Pqm],shortcuts:["delete","backspace"],closeParentMenu:!0,render:e=>(0,u.jsx)(R().A,{...e,isRed:!0,svg:I().trashIcon,title:(0,u.jsx)(a().sA,{...P().AY.deleteName}),shortcut:"delete"}),action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,canUndo:!0,perform:e=>{O().LL({environment:t,transaction:e})}})}}),H=(0,P().Ls)({key:"clear column contents",displayName:E.simpleTableClearContents,analyticsName:E.simpleTableClearContents.defaultMessage,svg:T().Y,validators:[D().p2L,D().AU6(D().vEP),D().xCr,D().Pqm],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,canUndo:!0,perform:e=>{O()._D({environment:t,transaction:e})}}),O().wr()}}),G=(0,P().Ls)({key:"insert row above",displayName:E.simpleTableInsertRowAbove,analyticsName:E.simpleTableInsertRowAbove.defaultMessage,svg:n(112282).s,validators:[D().p2L,D().AU6(D().vEP),D().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,canUndo:!0,perform:e=>{O().pW({environment:t,transaction:e})}})}}),Y=(0,P().Ls)({key:"insert row below",displayName:E.simpleTableInsertRowBelow,analyticsName:E.simpleTableInsertRowBelow.defaultMessage,svg:n(655923).v,validators:[D().p2L,D().AU6(D().vEP),D().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,canUndo:!0,perform:e=>{O().pc({environment:t,transaction:e})}})}}),q=(0,P().Fw)({key:"duplicate rows",displayName:P().AY.duplicateName,analyticsName:P().AY.duplicateName.defaultMessage,svg:C().V,validators:[D().p2L,D().AU6(D().vEP),D().Hcy],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t,lazyDependencies:{duplicateActions:n}}=e;L().createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,canUndo:!0,perform:e=>{n&&O().n2({environment:t,transaction:e,duplicateActions:n})}})}}),$=(0,P().Fw)({key:"delete rows",displayName:P().AY.deleteName,analyticsName:P().AY.deleteName.defaultMessage,svg:I().trashIcon,validators:[D().p2L,D().AU6(D().vEP),D().ZLr,D().Hcy],shortcuts:["delete","backspace"],closeParentMenu:!0,render:e=>(0,u.jsx)(R().A,{...e,isRed:!0,svg:I().trashIcon,title:(0,u.jsx)(a().sA,{...P().AY.deleteName}),shortcut:"delete"}),action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,canUndo:!0,perform:e=>{O().pf({environment:t,transaction:e})}})}}),Q=(0,P().Ls)({key:"clear row contents",displayName:E.simpleTableClearContents,analyticsName:E.simpleTableClearContents.defaultMessage,svg:T().Y,validators:[D().p2L,D().AU6(D().vEP),D().Hcy],closeParentMenu:!0,action:e=>{let{environment:t}=e;L().createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,canUndo:!0,perform:e=>{O()._D({environment:t,transaction:e})}}),O().wr()}}),Z=[D().p2L,D().AU6(D().vEP),D().xCr,D().Pqm],X=[D().p2L,D().AU6(D().vEP),D().Hcy];function J(e,t,o,i){const r=i||(0,n(27178).qo)(e),a=(0,P().Ls)({key:`color ${o||e}`,displayName:r,analyticsName:r.defaultMessage,fuzzySearchKeywords:(0,P().Mf)(e),validators:"column"===t?Z:X,action:t=>{let{blocks:n,environment:o}=t;L().createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:o,canUndo:!0,perform:t=>{O().wW(o,e,t)}})},closeParentMenu:!0,render:t=>(0,u.jsx)(n(491073).Ay,{...t,color:e,overrideDisplayName:a.displayName}),nativeImageReference:t=>{let{environment:n}=t;return(0,P().Kg)(n,e,o)}});return a}const ee=(0,P().gy)({key:"simple table column background color actions",title:P().AY.backgroundSection,overrideSearchTitle:P().AY.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().AQ.map((e=>J(e,"column")))]}),te=(0,P().gy)({key:"simple table column text color actions",title:P().AY.colorSection,overrideSearchTitle:P().AY.colorSection,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().N.map((e=>J(e,"column")))]}),ne=(0,P().gy)({key:"simple table row background color actions",title:P().AY.backgroundSection,overrideSearchTitle:P().AY.backgroundSectionKeywords,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().AQ.map((e=>J(e,"row")))]}),oe=(0,P().gy)({key:"simple table row text color actions",title:P().AY.colorSection,overrideSearchTitle:P().AY.colorSection,render:e=>(0,u.jsx)(c().A,{...e}),actions:[..._().N.map((e=>J(e,"row")))]}),ie=(0,P().uk)({key:"set column color",displayName:P().AY.colorName,analyticsName:P().AY.colorName.defaultMessage,svg:j().M,validators:Z,subActions:()=>[{key:0,title:N().A.formatMessage(E.textColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:te.actions},{key:1,title:N().A.formatMessage(E.backgroundColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:ee.actions}]}),re=(0,P().uk)({key:"set row color",displayName:P().AY.colorName,analyticsName:P().AY.colorName.defaultMessage,svg:j().M,validators:X,subActions:()=>[{key:0,title:N().A.formatMessage(E.textColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:oe.actions},{key:1,title:N().A.formatMessage(E.backgroundColorSection),render:e=>(0,u.jsx)(c().A,{...e}),actions:ne.actions}]}),ae=[(0,P().gy)({key:"column section",render:e=>(0,u.jsx)(c().A,{...e}),actions:[U,ie,V,z,K,H,W]}),(0,P().gy)({key:"row section",render:e=>(0,u.jsx)(c().A,{...e}),actions:[F,re,G,Y,q,Q,$]})];var se=()=>n(962730),le=()=>n(377586),de=()=>n(765957),ce=()=>n(407054),ue=()=>n(630116),pe=()=>n(502438),me=()=>n(704907),ge=()=>n(819493),fe=()=>n(452558),he=()=>n(419357),ve=()=>n(545805),ye=()=>n(928600),be=()=>n(480095),Se=()=>n(897119),xe=()=>n(962036);function Ae(){const e=(0,o().Y0)();return e.isMobileNative&&e.isIOS&&e.isPhone?(0,u.jsx)(Me,{}):(0,u.jsx)(we,{})}function Me(){const e=(0,i().O$)(ce().A);return(0,w().A)({shouldPreserveTextSelection:e.isActive,shouldPreserveBlockSelection:!1,shouldRestoreSelection:!0}),(0,u.jsx)(we,{})}function we(){const e=(0,o().Y0)(),t=(0,i().O$)(ce().A);return(0,u.jsx)(Se().Ay,{popupType:e.isPhone?le().n.BottomSheet:le().n.Popup,bottomSheetInitialState:t.isActive?t.bottomSheetInitialState:void 0,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Te,placementToOrigin:se().W.Bottom,alignmentToOrigin:se().C.Start,originGap:0,preventScaleTransition:!0,render:()=>(0,u.jsx)(ke,{}),preventBlockRenderQueueOnEnter:e.isMobile,trapFocus:!0})}function ke(){var e;const t=(0,o().v3)(),n=(0,o().WS)(),c=(0,S().Tf)(),g=(0,i().O$)(ce().A),y=null===(e=g.stores)||void 0===e?void 0:e[0],x=(0,i().K8)((()=>null==y?void 0:y.isCollectionView()),[y]),w=(0,i().K8)((()=>g.isActive?function(e){switch(e){case"default":return d().JS;case"simple_table":return ae;case"page_mention":return f;case"sidebar_outliner":return m().LV;case"comment_media":return p;case"block_in_collection_timeline_view":return d().bH;case"block_in_collection":return d().SH;default:(0,l().HB)(e)}}(null==g?void 0:g.actionSectionGroupKey):[]),[g]),[k,j]=(0,M().$)();if(!g.isActive||!y)return null;const{originBlockRect:C,inputValue:I,publicEditMode:T}=g||{},_={environment:t,blocks:g.stores,originRect:C,publicEditMode:T,analyticsFrom:g.analyticsFrom},P=g.showInput&&(0,u.jsx)(Ie,{inputComboboxProps:k}),B=n?{menuType:S().gu.Modal,title:(0,u.jsx)(a().sA,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:c?void 0:(0,u.jsx)(be().DoneMenuText,{}),onClickRight:c?void 0:Te,header:P}:{menuType:S().gu.Popup,width:265,header:P};return(0,u.jsx)(ve().A,{debugName:"BlockMenu",capture:!0,onBackspace:s().D_,children:(0,u.jsxs)(ye().A,{...B,children:[(0,u.jsx)(fe().A,{filter:I,context:_,sections:w,onAccept:e=>function(e,t){const n=ce().A.state;if(!n.isActive)return;const{stores:o}=pe().default.state,{analyticsFrom:i,collectionContextStore:a}=n,s=o[0];if(s){const n=s.getParentTable(),o=s.getType();if(o&&n){let l;if(n===r().yK){const e=s.getParentId(),{currentSpaceStore:t}=de().default.getState();t&&void 0!==e&&(l=ue().h4.createChildStore(t,{table:r().yK,id:e}))}const d=(0,b().sl)(a)||{};(0,h().N)(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:i,block_id:s.id,block_type:o,parentTeamStore:l,is_toggleable:(0,A().Yt)(o,s.getFormat()),parent_collection_id:s.getParentCollectionIdUpToTwoLevels(),...d})}}e.closeParentMenu&&v().VN()}(e,t),initialFocus:I?0:void 0,comboboxProps:g.showInput?j:void 0,shouldShowBlockTypeTitle:!0}),I?void 0:(0,u.jsx)(Ce,{}),I?void 0:(0,u.jsx)(me().A,{store:y}),!I&&x?(0,u.jsx)(je,{}):void 0]})})}function je(){const[e,t]=(0,i().K8)((()=>{const e=ce().A.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,y().sj)(t.id)]}),[]);return e?t?(0,u.jsx)(c().A,{topBorder:!0,children:(0,u.jsx)(xe().A,{title:(0,u.jsx)(a().sA,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:k().hI,analyticsFrom:"block_menu"})}):(0,u.jsx)(c().A,{topBorder:!0,children:(0,u.jsx)(xe().A,{title:(0,u.jsx)(a().sA,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,x().xS)("guides.database"),analyticsFrom:"block_menu"})}):null}function Ce(){const e=(0,o().v3)(),t=(0,i().O$)(ce().A),n=(0,i().K8)((()=>e.currentUser.isLoggedIn()),[e]),r=(0,i().K8)((()=>t.isActive&&1===t.stores.length&&(0,y().sj)(t.stores[0].id)),[t]);return n?!t.isActive||t.stores.length>1||r?null:(0,u.jsx)(ge().$,{store:t.stores[0],isPageMoreButton:!1}):null}function Ie(e){const t=(0,a().tz)(),n=(0,o().WS)(),r=(0,i().O$)(ce().A);if(!r.isActive||n)return null;const{inputValue:s}=r;return(0,u.jsx)(c().A,{isInput:!0,children:(0,u.jsx)(he().Ay,{value:s,onChange:_e,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0,preventCaptureSpacebarWhenEmpty:!0,...e.inputComboboxProps})})}function Te(){v().VN()}function _e(e){ce().A.state.isActive&&ce().A.setState({...ce().A.state,inputValue:e.target.value})}},761660:(e,t,n)=>{n.d(t,{J:()=>q});n(16280),n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(728396),l=()=>n(251822),d=()=>n(145214),c=()=>n(439264),u=()=>n(218557),p=()=>n(953418),m=()=>n(170253),g=()=>n(978846),f=()=>n(970176),h=()=>n(316397),v=()=>n(933951),y=(n(18107),n(967357),n(898992),n(354520),()=>n(72645)),b=()=>n(155185),S=()=>n(959013),x=()=>n(285790),A=()=>n(859428),M=()=>n(38337),w=()=>n(104129),k=()=>n(962730),j=()=>n(160241),C=()=>n(3197),I=()=>n(937199),T=n(474848);const _=(0,S().YK)({formLayoutAddModule:{id:"addModuleHoverMenu.formLayout.add",defaultMessage:"Add question"},pageLayoutAddModule:{id:"addModuleHoverMenu.pageLayout.add",defaultMessage:"Add"}}),P=32;function B(e){if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");const t=(0,S().tz)(),{layoutStore:n,addModuleHoverMenuStore:o,currentModuleSelection:i}=(0,I().LH)(),s=(0,r().K8)((()=>{if(o.state.isOpen)return o.state.moduleId}),[o]),l=(0,r().K8)((()=>{if(!s)return;const e=w().A.findModuleContainer({layoutStore:n,moduleId:s});return e?e.getNode():void 0}),[s,n]),c=(0,r().K8)((()=>{if(!i||"new_module"===i.type)return!1;const e=n.getModuleById(i.moduleId);return"placeholder"===(null==e?void 0:e.type)}),[i,n]),u=(0,r().K8)((()=>{var t;if("views_main_tab_modules"===e.area)throw new Error("[ViewsMain Not Implemented] AddModuleHoverMenu not implemented for views_main_tab_modules");if("form_conditional_modules"===e.area)return!1;const i=n.getModules()[e.area].filter((e=>(0,b()._)(e))),r=0===i.length||(null===(t=i.at(-1))||void 0===t?void 0:t.id)===s;return o.state.isOpen&&!c&&!r}),[o,s,c,n,e.area]),p=(0,C().t)({area:e.area,afterModuleId:s}),m=(0,j().d)(),g=(0,a().IS)((e=>({bigRoundButton:{...m.button,width:P,height:P,borderTopLeftRadius:"100%",borderTopRightRadius:"100%",borderBottomLeftRadius:"100%",transform:"rotate(-45deg)"},bigRoundButtonHovered:{...m.buttonHovered},bigRoundButtonPressed:{...m.buttonPressed}})),[m]),f="form"===(0,r().K8)((()=>{var e;return null===(e=n.getModel())||void 0===e?void 0:e.getLayoutType()}),[n])?t.formatMessage(_.formLayoutAddModule):t.formatMessage(_.pageLayoutAddModule),h=l?l.offsetLeft-40:void 0,v=l?l.offsetTop+l.offsetHeight-4:void 0;return void 0===h||void 0===v?null:(0,T.jsx)(d().A,{visible:u,animate:{opacity:1,scale:1,transformOrigin:"center right"},initial:{opacity:0,scale:.3,transformOrigin:"center right"},exit:{opacity:0,scale:.3,transformOrigin:"center right"},style:{position:"absolute",left:h,top:v},children:(0,T.jsx)(A().A,{placement:k().W.Left,renderTooltip:()=>f,render:e=>(0,T.jsx)(x().A,{...e,style:g.bigRoundButton,hoveredStyle:g.bigRoundButtonHovered,className:M().kew,pressedStyle:g.bigRoundButtonPressed,onClick:p,icon:y().b,iconStyle:{width:16,height:16,transform:"rotate(45deg)"},color:"uiBluePrimary",ariaLabel:f})})})}var L=()=>n(21140),R=()=>n(612900),D=()=>n(645873);const N={BuilderAddModuleButtonEducationTooltip:new(D().O2)("BuilderAddModuleButtonEducationTooltip",(()=>n.e(63538).then(n.bind(n,889989))))},O=(0,D()._h)(N.BuilderAddModuleButtonEducationTooltip,(e=>e.default));var E=()=>n(817942);const U=(0,S().YK)({addPageModule:{id:"pageLayout.builder.addModuleToPage.button.ariaLabel",defaultMessage:"Add page module"},addQuestionModuleTooltip:{id:"pageLayout.builder.addModuleToPage.button.addQuestionModuleTooltip",defaultMessage:"Add question"},addModuleToPanelButton:{id:"pageLayout.builder.addModuleToPanel.button.label",defaultMessage:"Add to panel"}}),F=o.forwardRef((function(e,t){const{area:o}=e,{layoutStore:i}=(0,I().LH)(),s=(0,r().K8)((()=>i.getLayoutType()),[i]),l=(0,S().tz)(),d=(0,j().d)(),c=(0,a().IS)((e=>({bigRoundButton:{...d.button,width:32,height:32,borderRadius:"100%"},bigRoundButtonHovered:{...d.buttonHovered},bigRoundButtonPressed:{...d.buttonPressed},emptyModuleAreaAddButton:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 16px 8px 12px",fontSize:14,lineHeight:"20px",fontWeight:500,background:"light"===e.mode?e.palette.uiBlue[100]:e.palette.uiBlue[200],color:e.palette.uiBlue[600],borderRadius:28,transition:"background 0.2s"},emptyModuleAreaAddButtonHover:{...d.buttonHovered},emptyModuleAreaAddButtonPressed:{...d.buttonPressed}})),[d]),u=(0,C().t)("views_main_tab_modules"===o?{area:o,viewsMainTabId:e.viewsMainTabId}:{area:o});if("form_conditional_modules"===o)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const p=(0,r().K8)((()=>{var t;const n=i.getModules();return("views_main_tab_modules"===o?(null===(t=n[o])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[o]).length>0}),[i,o,e.viewsMainTabId]);return"page_details"!==o||p?(0,T.jsx)(A().A,{renderTooltip:()=>l.formatMessage(U.addQuestionModuleTooltip),disableTooltip:"form"!==s,placement:k().W.Bottom,render:e=>(0,T.jsx)(x().A,{style:c.bigRoundButton,hoveredStyle:c.bigRoundButtonHovered,pressedStyle:c.bigRoundButtonPressed,onClick:u,icon:y().b,iconStyle:{width:16,height:16},color:"uiBluePrimary",className:M().kew,ariaLabel:l.formatMessage(U.addPageModule),ref:t,...e})}):(0,T.jsxs)(n(197190).A,{style:c.emptyModuleAreaAddButton,onClick:u,hoveredStyle:c.emptyModuleAreaAddButtonHover,pressedStyle:c.emptyModuleAreaAddButtonPressed,ref:t,children:[(0,n(464699).b)({width:12,marginRight:4}),(0,T.jsx)(S().sA,{...U.addModuleToPanelButton})]})})),V=o.memo((function(e){var t;const{shouldShowTooltip:i}=(0,n(384130).J)(),{area:a}=e,s=i&&"page_main"===a,l=i&&"form_layout_schema"!==a,d=o.useRef(null),{currentModuleSelection:c,layoutStore:u,setModuleSelection:p,isPropertyTypeSearchInputDirtyStore:m}=(0,I().LH)(),g=(0,r().K8)((()=>"existing_module"===(null==c?void 0:c.type)?u.getModuleById(c.moduleId):void 0),[c,u]),f=(0,r().K8)((()=>{var t;if("form_conditional_modules"===a)throw new Error("[Forms Conditional Logic Not Implemented] AddPageLayoutModuleButton not implemented for form_conditional_modules yet.");const n=u.getModules();return("views_main_tab_modules"===a?(null===(t=n[a])||void 0===t?void 0:t[e.viewsMainTabId])||[]:n[a]).length>0}),[u,a,e.viewsMainTabId]),[h,v]=o.useState(!1),y=o.useCallback((()=>{m.state||p(void 0)}),[m,p]);return"new_module"===(null==c?void 0:c.type)&&c.area===e.area?(0,T.jsx)(n(545805).A,{onUndo:y,capture:!0,priority:1,debugName:"AddPageLayoutModuleButton",children:(0,T.jsx)(z,{})}):"placeholder"===(null==g?void 0:g.type)?null:s||l?(0,T.jsxs)(L().Ye,{justifyContent:"center",style:null===(b=e.styles)||void 0===b?void 0:b.buttonContainer,className:E().hg,children:[(0,T.jsx)(R().u,{shape:"page_main"===e.area?"circle":"pill",size:"page_main"===e.area||f?32:34,onDependencyLoaded:()=>v(!0),children:(0,T.jsx)(F,{isEducationCalloutVisible:s,...e,ref:d})}),s&&h&&(0,T.jsx)(O,{buttonRef:d})]}):(0,T.jsx)(L().Ye,{justifyContent:"center",style:null===(t=e.styles)||void 0===t?void 0:t.buttonContainer,className:E().hg,children:(0,T.jsx)(F,{isEducationCalloutVisible:!1,ref:d,...e})});var b}));function z(){const e=(0,a().IS)((e=>({ghostPageModuleContainer:{paddingBottom:12},ghostPageModule:{width:"100%",height:160,background:e.palette.uiBlue[75],borderRadius:12,boxShadow:`0px 0px 0px 0px ${e.stroke.uiBlueSecondary}, inset 0px 0px 0px 1px ${e.stroke.uiBlueSecondary}`}})),[]);return(0,T.jsx)("div",{style:e.ghostPageModuleContainer,className:E().hg,children:(0,T.jsx)(R().u,{shape:"square",borderRadius:e.ghostPageModule.borderRadius,width:e.ghostPageModule.width,height:e.ghostPageModule.height,children:(0,T.jsx)("div",{style:e.ghostPageModule})})})}var K=()=>n(496603);const W=12;function H(){const{addModuleHoverMenuStore:e}=(0,I().LH)(),t=(0,h().z)(),n=(0,o.useCallback)((n=>{const o=w().A.getMembersByDOMOrder({filter:e=>"cover"!==e.moduleType&&"form_conditional_modules"!==e.area});let i=null;for(const e of o){const o=e.getNode();if(!o)continue;const r=o.getBoundingClientRect();if(n.clientX>r.right||n.clientX<r.left&&r.left-n.clientX>300)continue;if(n.clientY<=r.bottom&&r.bottom-n.clientY<W||n.clientY>r.bottom&&n.clientY-r.bottom<W+t){i=e;break}}if(i)e.setState({isOpen:!0,moduleId:i.moduleId,menuIsOpen:!1});else{const t=e.getState();t.isOpen&&!t.menuIsOpen&&e.setState({isOpen:!1})}}),[e,t]),i=K().nF(n,30);return(0,o.useEffect)((()=>(window.addEventListener("mousemove",i),()=>{window.removeEventListener("mousemove",i)})),[i]),null}var G=()=>n(940186);const Y={display:void 0};function q(e){const{area:t}=e;if("form_conditional_modules"===t)throw new Error("[Forms Conditional Logic] Can't render builder layout modules for nested form_conditional_modules directly.");const n=(0,i().v3)(),{sessionId:y,layoutStore:b,currentModuleSelection:S,setModuleSelection:x,canEditLayout:A,layoutBuilderModuleSelectionStore:M}=(0,I().LH)(),w=(0,o.useRef)(null),k=(0,v().ub)({layoutStore:b,pageStoreId:void 0}),j=(0,r().K8)((()=>b.isTabbedPageLayout()),[b]),C=(0,h().z)(),{nonMoveableHeaderModules:_,moveableModules:P,nonMoveableFooterModules:L}=(0,r().K8)((()=>{var n;const o="views_main_tab_modules"===t?(null===(n=k[t])||void 0===n?void 0:n[null==e?void 0:e.viewsMainTabId])||[]:k[t];return(0,l().jS)(t,o)}),[t,k,null==e?void 0:e.viewsMainTabId],{useDeepEqual:!0}),R=(0,r().K8)((()=>{const e=M.state;if(null!=e&&e.isDragging){const n=e.draggingModuleInitialArea,o=e.draggingModuleFinalArea;return{isDraggingIntoThisArea:n.area!==t&&o.area===t,isDraggingFromThisAreaToOtherArea:n.area===t&&o.area!==t,isDraggingAnyModuleList:!0,dragArea:o}}return{isDraggingIntoThisArea:!1,isDraggingFromThisAreaToOtherArea:!1,isDraggingAnyModuleList:!1,dragArea:void 0}}),[t,M]),D=(0,o.useMemo)((()=>P.map((e=>"form_layout_schema"===t?{key:e.id,draggable:"placeholder"!==e.type}:{key:e.id,draggable:!0}))),[t,P]),N=(0,o.useMemo)((()=>new(m().A)),[]),O=(0,r().K8)((()=>N.state.isDragging),[N]),U=(0,r().K8)((()=>{var e;return null===(e=b.getModel())||void 0===e?void 0:e.getLayoutType()}),[b]);(0,o.useEffect)((()=>{w.current&&R.isDraggingIntoThisArea&&(0,p().$v)({element:w.current,environment:n,additionalPadding:{top:200,bottom:200}})}),[R.isDraggingIntoThisArea,n]);const F=(0,o.useCallback)((n=>{const o="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:t};x({type:"existing_module",moduleId:n,isDragging:!0,draggingModuleInitialArea:o,draggingModuleFinalArea:o})}),[t,e.viewsMainTabId,x]),z=(0,o.useCallback)((e=>{e&&x({type:"existing_module",moduleId:e,isDragging:!1})}),[x]),K=(0,o.useCallback)((()=>{const e=M.state,t=b.getLayoutType();t&&(0,s().Hc)(t)?x(void 0):null!=e&&e.isDragging&&M.setState({...e,isDragging:!1,draggingModuleInitialArea:void 0,draggingModuleFinalArea:void 0})}),[M,x,b]),W=(0,o.useCallback)((e=>{const o=M.state,i=null!=o&&o.isDragging?o.draggingModuleFinalArea:void 0;"form_conditional_modules"!==(null==i?void 0:i.area)&&(null!=e&&e.key&&i&&i.area!==t&&((0,g().E)({environment:n,position:{type:"area_relative",location:"end_moveable",..."views_main_tab_modules"===i.area?{area:i.area,viewId:i.viewsMainTabId}:{area:i.area}},moduleId:e.key,layoutStore:b,sessionId:y}),(0,f().z)({moduleId:e.key,layoutStore:b,environment:n})),K())}),[M,t,K,n,b,y]),q=(0,o.useCallback)(((o,i)=>{let{key:r,endPosition:a,startPosition:s}=i;if(R.isDraggingFromThisAreaToOtherArea)return;const l=_.length,d="views_main_tab_modules"===t?{area:"views_main_tab_modules",viewId:e.viewsMainTabId}:{area:t};(0,g().E)({environment:n,layoutStore:b,position:{type:"absolute",index:l+a,...d},moduleId:r,sessionId:y}),(0,f().z)({moduleId:r,layoutStore:b,environment:n})}),[R.isDraggingFromThisAreaToOtherArea,_.length,t,e.viewsMainTabId,n,b,y]),$=(0,a().IS)((e=>({draggableList:{display:"flex",flexDirection:"column",gap:C,marginBottom:C},addButtonContainer:{paddingTop:"page_in_collection"===U?8:0,marginBottom:"form"===U?0:12,width:"100%"},dropzoneHalo:{background:u().to,height:u().NZ,marginTop:-u().NZ},hiddenModuleStyle:{display:"none"}})),[C,U]),Q=(0,o.useCallback)((e=>{const n="existing_module"===(null==S?void 0:S.type)&&S.moduleId===e,o=n&&O;return(0,T.jsx)(G().n,{active:n,pageModuleId:e,isDragging:o,area:t,style:o&&R.isDraggingFromThisAreaToOtherArea?$.hiddenModuleStyle:void 0},e)}),[R.isDraggingFromThisAreaToOtherArea,S,O,$.hiddenModuleStyle,t]),Z=(0,o.useMemo)((()=>_.length?_.map((e=>Q(e.id))):null),[_,Q]),X=(0,o.useMemo)((()=>L.length?L.map((e=>Q(e.id))):null),[L,Q]),J=(0,o.useMemo)((()=>({enter:{opacity:0},animate:{opacity:1},exit:{opacity:0}})),[]),ee=(0,o.useMemo)((()=>({buttonContainer:$.addButtonContainer})),[$.addButtonContainer]);if(!b)return null;let te;return te=!!A&&(!j||("views_main_tab_modules"===t||"page_details"===t)),(0,T.jsxs)(T.Fragment,{children:[Z,Boolean(D.length)&&(0,T.jsx)(c().Ay,{forceDragKeyIndex:R.isDraggingFromThisAreaToOtherArea?D.length-1:void 0,className:E().hg,store:N,keys:D,direction:"vertical",onDraggingKeyChanged:F,onDrop:q,onDragCancel:K,onDragEnd:W,onClick:z,style:$.draggableList,draggingStyle:Y,draggingStyleForNonDraggedItems:Y,renderKey:Q,disabled:!A,...j?{}:{hoverCursorStyleOverride:R.isDraggingAnyModuleList?"grabbing":void 0}}),(0,T.jsx)(d().A,{visible:R.isDraggingIntoThisArea,initial:J.enter,animate:J.animate,exit:J.exit,skip:!R.isDraggingAnyModuleList,className:"layout-content",ref:w,style:$.dropzoneHalo}),te&&(0,T.jsx)(V,{...e,styles:ee}),"form"===U&&A&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(H,{}),(0,T.jsx)(B,{area:t})]}),X]})}},766676:(e,t,n)=>{n.d(t,{C:()=>f});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(543906),s=()=>n(297872),l=()=>n(676007),d=()=>n(404141),c=()=>n(299487),u=()=>n(51367),p=()=>n(131448),m=()=>n(196163),g=n(474848);function f(e){const{message:t}=e,n=(0,i().v3)(),f=(0,r().K8)((()=>!d().A.state.open&&!n.device.isMobile),[n]),h=(0,r().K8)((()=>f&&p().default.isVisible(t.key)),[t,f]);(0,a().A)((()=>{u().DL(n,{callout_key:t.key,placement_key:"Modal"})}),h);const v=(0,o.useCallback)((()=>{u().Sq(n,{callout_key:t.key,dismiss_type:"modal_dismiss_clicked",placement_key:"Modal"}),c().OX(n,t)}),[n,t]),y=(0,o.useCallback)(((e,o)=>()=>{u().Y5(n,{callout_key:t.key,click_type:e,placement_key:"Modal"}),null==o||o()}),[n,t]);let b;var S;e.primary&&(b={...e.primary,onClick:y("primary_cta",null===(S=e.primary)||void 0===S?void 0:S.onClick)});let x;var A;e.secondary&&(x={...e.secondary,onClick:y("secondary_cta",null===(A=e.secondary)||void 0===A?void 0:A.onClick)});let M;var w;e.link&&(M={...e.link,onClick:y("learn_more",null===(w=e.link)||void 0===w?void 0:w.onClick)});return h?(0,g.jsx)(l().a,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:v,render:()=>(0,g.jsx)(s().A,{capture:!0,allowEsc:!0,render:()=>(0,g.jsx)(m().T,{...e,onDismiss:v,primary:b,secondary:x,link:M})})}):null}},775812:(e,t,n)=>{n.d(t,{A:()=>l});n(296540);var o=()=>n(496603),i=()=>n(383594),r=()=>n(962730),a=()=>n(377586),s=n(474848);const l=function(){const{isMobile:e,isTablet:t}=(0,n(484714).Y0)(),i=(0,n(56366).O$)(n(969141).A),l=(0,n(963589).X)("mobile_icon_picker_bottom_sheet");return(0,s.jsx)(n(897119).Ay,{popupType:e?l?a().n.BottomSheet:a().n.SlideUp:a().n.Popup,bottomSheetInitialState:t?"full":"half",open:i.isActive,originRect:i.isActive?i.originRect:void 0,originGap:i.isActive?i.originGap:void 0,placementToOrigin:r().W.Bottom,alignmentToOrigin:r().C.Center,preventScaleTransition:!0,onDismiss:d,render:()=>{if(i.isActive)return(0,s.jsx)(n(545805).A,{debugName:"MediaMenu",capture:!0,onUp:o().D_,onDown:o().D_,children:(0,s.jsx)(n(278611).Ay,{...i,onCancel:d})})},trapFocus:!0})};function d(){i().I()}},778450:(e,t,n)=>{n.d(t,{e:()=>a});var o=()=>n(857639),i=()=>n(449506),r=()=>n(63728);async function a(e){if(r().l.state)return r().l.state;const t=e.device.os;if("mac"!==t&&"windows"!==t)return!1;const n=await i().callApi({eventName:"getDesktopAppRegistration",environment:e,data:{os:t}});if("failed"===n.type)return o().log({level:"error",from:"getDesktopAppRegistered",type:"api:getDesktopAppRegistration",error:n.error}),!1;const a=n.data.isRegistered||Boolean(n.data.isRegistered30Day);return a&&r().l.setState(!0),a}},782473:(e,t,n)=>{n.d(t,{Nu:()=>a,Sw:()=>o,gO:()=>i,j$:()=>r});const o=220,i=24,r=-7,a=-3},788941:(e,t,n)=>{n.d(t,{b:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("pinFilled",{viewBox:"0 0 13 19",svg:(0,o.jsx)("path",{d:"M.102 11.773c0 .665.445 1.102 1.148 1.102h4.227v3.648c0 1.196.5 2.188.695 2.188.187 0 .687-.992.687-2.188v-3.648h4.227c.703 0 1.148-.438 1.148-1.102 0-1.648-1.32-3.39-3.515-4.187L8.46 4c1.14-.648 2.078-1.383 2.484-1.906.203-.266.305-.531.305-.766 0-.476-.367-.828-.914-.828H2.008c-.555 0-.914.352-.914.828 0 .234.093.5.297.766.406.523 1.343 1.258 2.484 1.906l-.258 3.586C1.422 8.383.102 10.125.102 11.773z"})})},794831:(e,t,n)=>{n.r(t),n.d(t,{GenerateSocialMediaPreviewImageWrapper:()=>u});var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(919709),s=()=>n(496603),l=()=>n(6027),d=()=>n(217429),c=()=>n(24157);function u(e){const{store:t}=e;return function(e){const t=(0,i().v3)(),[n,u]=(0,o.useState)("uninitialized"),[p,m,g,f,h]=(0,r().K8)((()=>{var n,o;return e.pathIsDead()||"on"!==d().default.getEligibleGroup({experimentId:"dynamic_social_preview_image",defaultGroup:"unassigned"})||e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:t.currentUser.id})?[!1]:[e.isReady(),a().q4_(e.getTitleValue()),null===(n=e.getIcon())||void 0===n?void 0:n.icon,null===(o=e.getCover())||void 0===o?void 0:o.cover,e.getFormat().page_font]}),[t.currentUser.id,e]);(0,o.useEffect)((()=>{"storeReady"===n?u("generateImage"):p&&u("storeReady")}),[p,m,g,f,h]);const v=(0,o.useMemo)((()=>(0,s().sg)((()=>{u("storeReady"),l().F({environment:t,store:e})}),5e3)),[t,e]);(0,r().K8)((()=>{"generateImage"===n&&(c().default.state,v())}),[n,v])}(t),null}},807831:(e,t,n)=>{n.d(t,{V:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("subItem",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.88642 2.43778C1.98215 2.3846 2.09567 2.35999 2.22362 2.35999C2.41846 2.35999 2.58374 2.42299 2.71309 2.55179C2.84789 2.67678 2.91386 2.84079 2.91386 3.03655C2.91386 3.161 2.90926 3.28545 2.90008 3.40989C2.8956 3.52687 2.89335 3.66669 2.89335 3.82952C2.89335 4.6672 2.99989 5.34012 3.20906 5.85192C3.42107 6.35987 3.76386 6.73052 4.23921 6.9683C4.72178 7.20285 5.37665 7.32288 6.20897 7.32288H10.9303L12.4002 7.41264L10.2433 5.44074L8.72396 3.8939C8.66786 3.83269 8.6225 3.76177 8.58753 3.68184L8.58532 3.67681C8.55515 3.59133 8.54022 3.50307 8.54022 3.41252C8.54022 3.22504 8.60443 3.06601 8.73414 2.94147C8.86699 2.81372 9.02934 2.74963 9.21678 2.74963C9.40179 2.74963 9.5677 2.81976 9.71223 2.95431L9.71419 2.95614L14.2523 7.49436C14.4062 7.63869 14.4871 7.81019 14.4871 8.00627C14.4871 8.20241 14.4062 8.37593 14.2528 8.52459L9.72696 13.0436C9.57465 13.191 9.40407 13.2698 9.21678 13.2698C9.03026 13.2698 8.86827 13.2086 8.73525 13.0858L8.73305 13.0838C8.60434 12.9551 8.54022 12.7943 8.54022 12.6069C8.54022 12.5163 8.55535 12.4281 8.58551 12.3426C8.61631 12.2554 8.66304 12.1796 8.72601 12.1166L10.2463 10.5689L12.3938 8.61275L10.9258 8.69663L6.14745 8.69651C4.516 8.69651 3.32454 8.32105 2.59311 7.55211C1.86303 6.77991 1.50604 5.55355 1.50604 3.89104C1.50604 3.68942 1.51062 3.50571 1.51983 3.34C1.52904 3.17413 1.54527 3.03558 1.56915 2.92552C1.58898 2.82668 1.62376 2.73465 1.67362 2.64989C1.72566 2.56142 1.79795 2.48982 1.88642 2.43778Z"})})},807926:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const i=new o},816013:(e,t,n)=>{n.d(t,{r:()=>o});const o=n(757695).Store.createValue({showConvertTooltip:!1,forceShow:!1},{name:"WikiPromoStore"})},819493:(e,t,n)=>{n.d(t,{$:()=>j,b:()=>C});n(898992),n(908872),n(296540);var o=()=>n(662303),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(764880),l=()=>n(869190),d=()=>n(959013),c=()=>n(777092),u=()=>n(921855),p=()=>n(972435),m=()=>n(963589),g=()=>n(154060),f=()=>n(303742),h=()=>n(311337),v=()=>n(962730),y=()=>n(765957),b=()=>n(706965),S=()=>n(678553),x=()=>n(89924),A=()=>n(859428),M=()=>n(125565),w=()=>n(715011),k=n(474848);function j(e){let{isPageMoreButton:t,hideTopBorder:n,store:o,wordCountStores:l,showWordCount:c}=e;const u=(0,r().K8)((()=>C(o)),[o]),{device:m}=(0,i().v3)(),j=(0,r().K8)((()=>m.isPhone),[m]),T=p().A.getIntl(),_=(0,i().v3)(),P=(0,a().IS)((()=>({menuItem:{paddingTop:j?8:n?0:6,paddingBottom:j?8:16}})),[n,j]);return(0,r().K8)((()=>{var e;const t=(0,g().A)(_)&&o.getSpaceId()!==(null===(e=y().default.state.currentSpaceStore)||void 0===e?void 0:e.id);return(0,h().y)(_)||t||(0,f().o)(y().default.state.currentSpaceStore)}),[_,o])||u&&!u.canAccess?null:(0,k.jsx)(x().A,{topBorder:!t&&!n,style:{paddingTop:t?0:8,paddingBottom:t?0:8},children:(0,k.jsx)(S().Ay,{style:u?void 0:P.menuItem,shouldWrapTitle:!0,title:u?(0,k.jsx)(A().A,{placement:v().W.Right,render:e=>(0,k.jsxs)("div",{...e,children:[c?(0,k.jsx)(M().A,{isSmall:!0,isSecondaryColor:!0,isMobile:m.isPhone,isMultiline:!0,style:{marginBottom:4,marginTop:8},children:(0,k.jsx)(d().sA,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,k.jsx)(w().A,{store:o})}})}):void 0,l?(0,k.jsx)(I,{stores:l}):void 0,(0,k.jsx)(M().A,{isSmall:!0,isSecondaryColor:!0,isMobile:m.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,k.jsx)(d().sA,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:u.lastEditedBy.asActor?(0,s().lR)(T,u.lastEditedBy):void 0}})}),(0,k.jsx)(M().A,{isSmall:!0,isSecondaryColor:!0,isMobile:m.isPhone,style:{marginBottom:c?8:0},children:u.lastEditedTime})]}),renderTooltip:()=>(0,k.jsx)(b().A,{store:o,compactFormat:!0})}):void 0,loading:!u})})}function C(e){const t=e.getCreatedByPointer(),n=e.getCreatedTime(),i=e.getLastEditedByPointer(),r=e.getLastEditedTime(),a=p().A.getIntl();if(!e.canRead())return{canAccess:!1};if(t&&n&&r&&i){const s=(0,c().vt)({parentStore:e,pointer:t}),d=(0,l().jE)(n,o().locale,a),u=(0,c().vt)({parentStore:e,pointer:i}),p=(0,l().jE)(r,o().locale,a);if(!u)return;return{canAccess:!0,createdBy:s,createdTime:d,lastEditedBy:u,lastEditedTime:p}}}function I(e){const{stores:t}=e,n=(0,m().X)("selectable_word_count"),o=(0,r().K8)((()=>n?T(t):0),[n,t]);return n?(0,k.jsx)(M().A,{isSmall:!0,isSecondaryColor:!0,style:{marginBottom:4},children:(0,k.jsx)(d().sA,{id:"blockMetadataMenuItem.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:o}})}):null}function T(e){return e.reduce(((e,t)=>{const n=(0,u().r4)(t.getTitleValue(),t);return e+(0,u().sQ)(n)+T(t.getContentStores())}),0)}},819527:(e,t,n)=>{n.d(t,{G1:()=>r,PB:()=>a,iH:()=>d,kG:()=>l,mA:()=>s,qR:()=>c,r2:()=>i,w_:()=>o});const o=10,i=32,r=36,a=220,s=5,l=22,d=8,c=5},822295:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>o,presentIcon:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.72 1.77 14.55 15.51",svg:(0,n(474848).jsx)("path",{d:"M4.625 4.535a2.765 2.765 0 0 1 3.307-2.711l.07.014a3.26 3.26 0 0 1 2.01 1.297c.481-.66 1.2-1.14 2.044-1.309 1.706-.34 3.319.96 3.319 2.71 0 .558-.166 1.079-.451 1.514h.776c.87 0 1.575.705 1.575 1.575v1.9c0 .613-.35 1.144-.86 1.404V15.7c0 .87-.706 1.575-1.576 1.575H5.161c-.87 0-1.575-.705-1.575-1.575v-4.77a1.58 1.58 0 0 1-.861-1.405v-1.9c0-.87.705-1.575 1.575-1.575h.777a2.75 2.75 0 0 1-.452-1.515m6 2.765v2.55H15.7c.18 0 .325-.145.325-.325v-1.9A.325.325 0 0 0 15.7 7.3zm-1.25 0H4.3a.325.325 0 0 0-.325.325v1.9c0 .18.145.325.325.325h5.075zm0-1.25V5.038c0-.96-.677-1.786-1.618-1.974l-.07-.014a1.515 1.515 0 1 0-.297 3zm3.25 0c.83-.008 1.5-.683 1.5-1.515 0-.95-.882-1.671-1.824-1.483a2.084 2.084 0 0 0-1.676 2.035v.963zm-2 5.05v4.925h4.214c.18 0 .325-.145.325-.325v-4.6zm-1.25 0h-4.54v4.6c0 .18.146.325.326.325h4.214z"})},i=(0,n(340498).wt)("present",o)},823541:(e,t,n)=>{n.d(t,{V:()=>l});n(296540);var o=()=>n(84817),i=()=>n(8980),r=()=>n(554509),a=()=>n(404520),s=n(474848);function l(e){const{icon:t,title:n,description:l,secondaryDescription:d,source:c,...u}=e;return(0,s.jsxs)(o().Y1,{align:"center",padding:"20px 0px",gap:6,width:340,children:[(0,s.jsx)(i().I,{icon:t,size:"xl",color:"tertiary"}),(0,s.jsxs)(o().Y1,{align:"center",gap:16,children:[(0,s.jsxs)(o().Y1,{align:"center",gap:2,children:[(0,s.jsx)(r().D,{styleName:"UIRegular-14px/Medium",colorName:"secondary",children:n}),(0,s.jsx)("span",{style:{textAlign:"center",textWrap:"balance"},children:(0,s.jsx)(r().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",children:l})}),d?(0,s.jsx)(r().D,{styleName:"UIRegular-14px/Regular",colorName:"tertiary",children:d}):null]}),(0,s.jsx)(a().R,{display:"button",width:"hug",source:c,...u})]})]})}},828180:(e,t,n)=>{n.d(t,{$g:()=>d,Bu:()=>M,CL:()=>A,Cn:()=>C,G4:()=>c,Ih:()=>b,KI:()=>r,MI:()=>h,Mi:()=>a,O0:()=>S,Yu:()=>g,_Q:()=>j,aL:()=>p,at:()=>f,eW:()=>x,gJ:()=>s,hN:()=>l,hR:()=>u,kx:()=>y,rO:()=>v,wd:()=>m});var o=()=>n(784892),i=()=>n(236030);const r="28px",a="14px",s="12px",l="16px",d=1.5,c=1.25,u=1.25,p=35,m=21,g=18,f=34,h=30,v=28,y=30,b=32,S=24,x=24,A=24,M=30,w={table:{default:`${i().Nh}px ${i().Ke}px`,text:`${i().Zs}px ${i().Ke}px`,token:`${i().hB}px ${i().Ke}px`,checkbox:`${i().Nl}px ${i().Ke}px`,button:`${i().Mk}px ${i().Ke}px`},page:{default:"7px 6px",text:"6px",token:void 0,checkbox:"9px 6px",button:"5px 6px"},compact_page:{default:"5px 6px",text:"4px 6px",token:"5px 6px",checkbox:"7px 6px",button:"3px 6px"},board:{default:"5px",text:"5px",token:void 0,checkbox:"5px",button:"4px"}},k={table:{default:`${i().A4}px ${i().Ke}px`,text:`${i().Wh}px ${i().Ke}px`,token:`${i().Sh}px ${i().Ke}px`,checkbox:`${i().IH}px ${i().Ke}px`,button:`${i().DX}px ${i().Ke}px`},page:w.page,compact_page:w.compact_page,board:w.board};function j(e){const{isPhone:t}=e;return t?k:w}const C={[o().NY.ExtremeSmall]:void 0,[o().NY.ExtraSmall]:void 0,[o().NY.Small]:{columnGap:6,rowGap:4},[o().NY.CompactEssential]:{columnGap:4,rowGap:6},[o().NY.Medium]:{columnGap:8,rowGap:6},[o().NY.Large]:{columnGap:10,rowGap:10},[o().NY.Inline]:{columnGap:6,rowGap:4}}},840071:(e,t,n)=>{n.d(t,{L:()=>s});n(296540);var o=()=>n(84817),i=()=>n(577466),r=()=>n(434663),a=n(474848);function s(e){let{backgroundColor:t,children:n,...s}=e;const l=(0,i().B)(t),d={wrapper:{...l.wrapper,background:t?l.wrapper.background:"initial",height:"100%",padding:"20px 12px"}};return(0,a.jsx)(o().Y1,{style:d.wrapper,align:"center",children:(0,a.jsx)(r().r,{...s,direction:"vertical",overrideSize:()=>48,children:n})})}},845566:(e,t,n)=>{n.d(t,{A:()=>r});n(898992),n(672577);var o=()=>n(765957);class i extends(()=>n(757695))().Store{getInitialState(){return{chosenSpaceId:void 0}}getChosenSpaceId(){const{chosenSpaceId:e}=this.state,{currentSpaceStore:t}=o().default.state;return e||(null==t?void 0:t.id)}getChosenSpaceStore(){var e;return null===(e=this.getChosenSpaceViewStore())||void 0===e?void 0:e.getSpaceStore()}getChosenSpaceViewStore(){const{chosenSpaceId:e}=this.state,{currentSpaceViewStore:t,currentUserRootStore:n}=o().default.state;if(!e&&t)return t;if(e&&n){return n.getSpaceViewStores().find((t=>t.getSpaceId()===e))}}}const r=i},853306:(e,t,n)=>{n.d(t,{A:()=>A});n(581454);var o=n(296540),i=()=>n(662303),r=()=>n(56366),a=()=>n(401497),s=()=>n(66913),l=()=>n(284371),d=()=>n(115512),c=()=>n(141333),u=()=>n(265665),p=()=>n(484595),m=()=>n(704152),g=()=>n(864943),f=()=>n(204063),h=()=>n(125565),v=n(474848);const y=20;function b(e){var t;let{icon:s,iconStyle:u,title:p,subtitle:m,confirmText:b,confirmTextStyle:A="blue",confirmTextPerRadioOption:M,cancelText:w,hideCancelButton:k=!1,radioOptions:j,defaultSelectedRadioOption:C,onDismiss:I,onSelectRadio:T,onConfirm:_,width:P,footer:B}=e;const L=(0,n(484714).v3)(),[R,D]=(0,o.useState)(C??(null===(t=j[0])||void 0===t?void 0:t.key)),N=(0,r().uB)(void 0,n(17090).A),O=(0,r().K8)((()=>null==N?void 0:N.state.elementRef),[N]),E=(0,c().CR)(O),U=(0,c().yE)(O),F=(0,c().o7)(O),V=U>0,z=Math.ceil(U+F)<Math.floor(E),K=(0,o.useCallback)((e=>{e!==R&&(D(e),null==T||T(e))}),[T,R]),W=(0,o.useCallback)((()=>{_(R)}),[_,R]),H=(0,a().IS)((e=>{const t={marginLeft:-20,marginRight:-20,height:1,borderTop:`1px solid ${e.regularDividerColor}`,transition:"opacity 200ms"};return{container:{display:"flex",position:"relative",flexDirection:"column",justifyContent:"center",overflow:"hidden",width:`min(${P??400}px, calc(100vw - 40px))`,maxHeight:"80vh",padding:y,borderRadius:6,alignItems:"stretch"},icon:{width:36,height:36,fill:e.icon.secondary,marginBottom:6,...u},iconContainer:{width:"100%",display:"flex",justifyContent:"center"},title:{fontFamily:l().vc(i().locale).sans,fontSize:17,lineHeight:"22px",fontWeight:l().Wy.medium,textAlign:"center",marginBottom:14},subtitle:{fontFamily:l().vc(i().locale).sans,fontSize:(0,d().ny)(L,"UIRegular"),lineHeight:(0,d().ks)(L,"UIRegular"),fontWeight:l().Wy.regular,marginTop:6,marginBottom:6,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column",gap:8},topDivider:{...t,opacity:V?1:0},bottomDivider:{...t,opacity:z?1:0},scroller:{marginLeft:-20,marginRight:-20,paddingLeft:y,paddingRight:y},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{marginTop:8,justifyContent:"center"},dismissButton:{position:"absolute",top:10,right:10,zIndex:1}}}),[L,u,z,V,P]),G=(null==M?void 0:M[R])??b;return(0,v.jsxs)("div",{style:H.container,children:[(0,v.jsx)("div",{style:H.dismissButton,children:(0,v.jsx)(S,{onClick:I})}),s&&(0,v.jsx)("div",{style:H.iconContainer,children:s(H.icon)}),(0,v.jsx)(h().A,{isMultiline:!0,style:H.title,children:p}),m&&(0,v.jsx)(h().A,{isSmall:!0,style:H.subtitle,isMultiline:!0,children:m}),j.length>0&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:H.topDivider}),(0,v.jsx)(n(2143).H,{type:n(756279).A.Y,style:H.scroller,store:N,children:(0,v.jsx)("div",{style:H.radioContainer,children:j.map((e=>(0,v.jsx)(x,{radioItem:e,isSelected:e.key===R,onSelectRadio:K,left:e.left},e.key)))})}),(0,v.jsx)("div",{style:H.bottomDivider})]}),(0,v.jsxs)("div",{style:H.actionButtonsContainer,children:["blue"===A?(0,v.jsx)(f().A,{size:"lg",onClick:W,children:G}):"red"===A?(0,v.jsx)(f().A,{size:"lg",onClick:W,isRed:!0,children:G}):(0,v.jsx)(g().A,{size:"lg",onClick:W,children:G}),!k&&(0,v.jsx)(g().A,{size:"lg",onClick:I,style:H.cancelButton,children:w??(0,v.jsx)(n(959013).sA,{id:"radioModal.cancel",defaultMessage:"Cancel"})})]}),B]})}function S(e){let{onClick:t}=e;const n=(0,a().IS)((e=>({button:{display:"flex",justifyContent:"center",alignItems:"center",width:24,height:24,borderRadius:"100%",background:e.lightGrayButtonBackground},buttonHovered:{background:e.lightGrayButtonHoveredBackground},buttonPressed:{background:e.lightGrayButtonPressedBackground},closeIcon:{width:16,height:16,fill:e.icon.secondary}})),[]);return(0,v.jsx)(m().A,{style:n.button,hoveredStyle:n.buttonHovered,pressedStyle:n.buttonPressed,onClick:t,children:(0,s().V)(n.closeIcon)})}function x(e){let{radioItem:t,isSelected:n,onSelectRadio:o,left:i}=e;const r=(0,a().IS)((e=>({button:{display:"flex",justifyContent:"space-between",gap:10,height:"auto",minHeight:70,borderRadius:8,paddingTop:12,paddingBottom:12,paddingLeft:14,paddingRight:14-p().p,border:void 0,boxShadow:n?`inset 0 0 0 1px ${e.icon.uiBluePrimary}`:`inset 0 0 0 1px ${e.stroke.primary}`},buttonText:{display:"flex",flexDirection:"column",gap:2,...l().RC},optionTitle:{fontWeight:l().Wy.medium},optionSubtitle:{whiteSpace:"break-spaces"},left:{display:"flex",alignItems:"center",justifyContent:"center"}})),[n]);return(0,v.jsxs)(g().A,{size:"lg",onClick:()=>o(t.key),style:r.button,children:[i&&(0,v.jsx)("div",{style:r.left,children:i}),(0,v.jsxs)("div",{style:r.buttonText,children:[(0,v.jsx)(h().A,{style:r.optionTitle,children:(0,v.jsx)(u().j,{children:t.title})}),t.subtitle&&(0,v.jsx)(h().A,{isSmall:!0,isMultiline:!0,style:r.optionSubtitle,children:t.subtitle})]}),(0,v.jsx)(p().A,{isSelected:n})]})}const A=o.memo(b)},867159:(e,t,n)=>{n.d(t,{J8:()=>g,kS:()=>m,p7:()=>p});n(296540);var o=()=>n(484714),i=()=>n(401497),r=()=>n(668725),a=()=>n(959013),s=()=>n(493823),l=()=>n(406699),d=()=>n(74263),c=()=>n(26517),u=n(474848);function p(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(a().sA,{...d().vG[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().aj,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function m(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(a().sA,{...d().Bb[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().qg,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function g(e){const{buttonPopupStore:t,disabled:n,currentVisibility:o}=e,i=(0,u.jsx)(a().sA,{...d().PP[o]});return(0,u.jsx)(f,{disabled:n,buttonPopupStore:t,currentVisibilityLabel:i,renderVisibilityLevelsMenu:t=>(0,u.jsx)(c().f3,{...e,onClose:()=>{var n;null===(n=e.onClose)||void 0===n||n.call(e),t.close()}})})}function f(e){const t=(0,o().Y0)(),{buttonPopupStore:n,currentVisibilityLabel:a,renderVisibilityLevelsMenu:d,disabled:c}=e,p=(0,i().IS)((e=>({chevronDownIcon:{width:10,marginLeft:4,marginRight:4,fill:e.icon.tertiary},currentVisibilityLabel:{color:e.text.secondary,paddingRight:4,height:t.isMobile?32:22}})),[t.isMobile]);return(0,u.jsx)(l().Ay,{popupType:l().z7.Popup,buttonPopupStore:n,renderOrigin:e=>(0,u.jsxs)(s().p,{style:p.currentVisibilityLabel,disabled:c,...e,children:[a,(0,r().b)(p.chevronDownIcon)]}),render:d})}},877263:(e,t,n)=>{n.r(t),n.d(t,{ImportIntoNewPageModal:()=>f,default:()=>h});n(296540);var o=()=>n(484714),i=()=>n(56366);const r=(0,n(340498).xh)("docBadgePlus",{default:{loader:()=>n.e(94802).then(n.bind(n,758105))},small:{loader:()=>n.e(94802).then(n.bind(n,424451))},fill:{loader:()=>n.e(94802).then(n.bind(n,528265))},fillSmall:{loader:()=>n.e(94802).then(n.bind(n,301136))}},["IPR","initial page render","recent document","recent page","recents","page history"]);var a=()=>n(959013),s=()=>n(559926),l=()=>n(41432),d=()=>n(522094),c=()=>n(404141),u=()=>n(7674),p=()=>n(107683),m=n(474848);function g(){l().A.setState({open:!1})}function f(){const e=(0,o().v3)(),t=(0,i().O$)(l().A);return(0,m.jsx)(p().s,{isOpen:t.open,onDismiss:g,onClosed:g,areaConstraint:{width:{type:"fixed",length:300}},render:()=>(0,m.jsx)(u().tf,{header:(0,m.jsx)(u().YA,{iconAndTitle:(0,m.jsx)(u().ZQ,{iconGroup:r,title:(0,m.jsx)(a().sA,{defaultMessage:"Import into new page?",id:"importIntoNewPageModal.title"})}),description:(0,m.jsx)(a().sA,{id:"importIntoNewPageModal.description",defaultMessage:"Since this page already has content, we’ll need to create a new page for you and import contents there."})}),footer:(0,m.jsx)(u().aO,{layout:"vertical",primaryButtons:[{buttonType:"primary",label:(0,m.jsx)(a().sA,{defaultMessage:"Yes, continue",id:"importIntoNewPageModal.importButton"}),onClick:()=>{c().A.setState({open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0,openedFrom:"collection"}),s().kY(e,{from:"topbar",flowId:d().A.createFlowId()}),g()}}],secondaryButtons:[{buttonType:"secondary",label:"Cancel",onClick:g}]})})})}const h=f},883626:(e,t,n)=>{n.d(t,{Hs:()=>i,nw:()=>a,vI:()=>s});var o=()=>n(720665);const i=100,r=5*o().Xb,a=15*o().TD;function s(e){return!!e.sendDateMs&&Date.now()-e.sendDateMs<=r}},887480:(e,t,n)=>{n.d(t,{Ay:()=>i().A,yQ:()=>a});var o=()=>n(645873),i=()=>n(853306);const r=new(o().O2)("radioModalRenderer",(()=>n.e(35818).then(n.bind(n,415995)))),a=(0,o()._h)(r,(e=>e.default))},887539:(e,t,n)=>{n.r(t),n.d(t,{AppComponents:()=>$c});var o=n(296540),i=()=>n(484714),r=()=>n(257615),a=()=>n(430923),s=()=>n(774733),l=()=>n(580546),d=()=>n(645873);const c=new(d().O2)("desktop",(async()=>{const[{Notification:e},{default:t}]=await Promise.all([n.e(7097).then(n.bind(n,15121)),n.e(7097).then(n.bind(n,91063))]);return{Notification:e,ElectronContextMenu:t}})),u=(0,d()._h)(c,(e=>e.ElectronContextMenu));var p=()=>n(75858),m=()=>n(251994),g=(n(898992),n(354520),()=>n(56366)),f=()=>n(919709),h=()=>n(496603),v=()=>n(901997),y=()=>n(98244),b=()=>n(751156),S=()=>n(928600),x=()=>n(897119),A=()=>n(722872),M=()=>n(231722),w=()=>n(333665),k=()=>n(486666),j=()=>n(962730),C=()=>n(377586),I=()=>n(797162),T=()=>n(24157),_=()=>n(97270),P=()=>n(828265),B=n(474848);function L(){const e=(0,i().Y0)(),{open:t,filter:n,emojiTextStore:r,popupOpen:a,originRect:s,alwaysShowPopup:l}=(0,g().K8)((()=>{const e=_().A.state,t=e.open;if(!t)return{open:t,popupOpen:!1};const n=function(e){if(!e.textStore)return;return w().vD(e.textStore,e.oldTextValue,!0)}(e)||"",{textStore:o,showPopupWithEmptyFilter:i,selectionRect:r}=e,a=Boolean(i);return{open:t,filter:n,emojiTextStore:o,popupOpen:n.length>0||a,originRect:r,alwaysShowPopup:a}}),[]),{textMode:d,prevChar:c,singleTextSelectionStore:u}=(0,g().K8)((()=>{var e;const t=T().default.state,{mode:n}=t;if("editing"!==n)return{mode:n};const{multiSelection:o}=t,i=f().qAZ(o.start.store.getValue());return{textMode:n,prevChar:i?i[o.start.index-1]:void 0,singleTextSelectionStore:null===(e=(0,M().H7)(o))||void 0===e?void 0:e.store}}),[]),p=(0,g().K8)((()=>I().A.state.open),[]);return(0,o.useEffect)((()=>{t&&!p&&("editing"!==d||!n&&":"!==c||u!==r||void 0===n||":"===n||n.startsWith(" ")||n.includes("\n"))&&y().VN()}),[r,n,p,t,c,u,d]),(0,B.jsx)(x().Ay,{popupType:e.isMobileNative&&!e.isTablet?C().n.SlideUp:C().n.Popup,open:a,originRect:s,placementToOrigin:j().W.Bottom,alignmentToOrigin:j().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:D,render:()=>(0,B.jsx)(R,{open:t,filter:n||"",alwaysShowPopup:l}),keepFocus:!0})}function R(e){let{open:t,filter:n,alwaysShowPopup:r}=e;const a=(0,i().v3)(),s=(0,i().Y0)(),l=(0,o.useRef)(null),d=s.isMobileNative&&!s.isTablet?{menuType:A().gu.ActionSheet}:{menuType:A().gu.Popup,width:k().jv,onClickOutside:y().VN};const c=(0,o.useMemo)((()=>h().sg((e=>{v().P$(a,{searchQuery:e})}),500)),[a]);return t?!Boolean(r)&&n.length<1?null:(0,B.jsx)(S().A,{innerRef:l,...d,children:(0,B.jsx)(P().p,{filter:n,onSubmit:e=>N(e,a),onNoResults:function(){if(!t)return;if(!n||0===n.length)return;const e=n.charAt(n.length-1);e&&(/\s/g.test(e)?y().VN():c(n))},isCallout:!1,menuRef:l,isInline:!0,onUpload:{onComplete:e=>{N(e,a)}}})}):null}function D(){y().VN()}function N(e,t){b().createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:t,canUndo:!0,perform:n=>{y().Ju({environment:t,emoji:e,transaction:n})}})}var O=()=>n(592678),E=()=>n(37433),U=(n(944114),n(803949),n(581454),()=>n(813206)),F=()=>n(584262),V=()=>n(416504),z=()=>n(921997),K=()=>n(959044),W=()=>n(959013),H=()=>n(848259),G=()=>n(449506),Y=()=>n(874913),q=()=>n(780054),$=()=>n(909470),Q=()=>n(299545),Z=()=>n(941541),X=()=>n(21899),J=()=>n(303742),ee=()=>n(179534),te=()=>n(524450),ne=()=>n(765957),oe=()=>n(217429),ie=()=>n(865241),re=()=>n(630116),ae=()=>n(477293),se=()=>n(963589);function le(e){const{currentSpaceViewStore:t,currentSpaceStore:n,currentUserRootStore:r}=(0,g().O$)(ne().default),a=(0,g().K8)((()=>e?null==n?void 0:n.userId:void 0),[e,null==n?void 0:n.userId]),s=(0,g().K8)((()=>(0,J().o)(n)?(0,X().f)({currentUserRootStore:r}):[]),[r,n]),l=(0,g().K8)((()=>ie().A.state.isVisible),[]),d=(0,W().tz)(),c=(0,i().v3)(),u=(0,o.useRef)(),p=(0,o.useRef)(),m=(0,o.useRef)(-1),f=(0,o.useCallback)((()=>{const{mobileNative:e}=c,{allSpaces:t,currentSpace:n}=de();e&&(t===u.current&&n===p.current||e.setBadgeNumber(t,n),p.current=n),t!==u.current&&(t>0?Y().setBadge(`${t}`):Y().setBadge("")),u.current=t}),[c]),v=(0,o.useMemo)((()=>h().Oo(f)),[f]),y="on"===(0,ae().r)("inbox_activity_split"),b=(0,se().X)("inbox_page_grouping"),S=(0,o.useCallback)((async(e,o)=>{if(o===m.current||!n&&!(0,J().o)(n))return;if(m.current=o,!function(e){if(0===ee().A.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(o)))return;const i=await(async e=>{const t=[],n=G().callMultiCellApi({eventName:"getUserNotifications",environment:c,data:{size:1e3,isInboxV2:!0,splitInboxActivity:y,inboxPageGrouping:b,markNotificationsAsReceived:e},headers:{}});for await(const o of n)"success"===o.type&&t.push(...o.data.results);return t})(l);ee().A.setState({results:i}),v();const r=h().KC.apply(null,i.map((e=>e.unreceived.notificationIds)));for(const a of r)(0,J().o)(n)?s.forEach((e=>{const t=e.getSpaceStore();t&&ce(a,t,e,d,c)})):n&&t&&ce(a,n,t,d,c)}),[n,t,s,v,c,y,b,d,l]);(0,o.useEffect)((()=>{l&&S("visibilityChange",m.current)}),[l,S]);const x=(0,o.useMemo)((()=>h().nF(S,1e3)),[S]);(0,o.useEffect)((()=>{if(!a)return;let e;const t=e=>{let{key:t,value:n}=e;te().A.whenActive((()=>{x(t,n)}))};if(a){const n=(0,z().dp)(a);e=Z().Ay.addListener(n,void 0,t,void 0,c),S("initializeListener",-1)}return ee().A.addListener(f),c.mobileNative&&ne().default.addListener(f),()=>{e&&Z().Ay.removeListener(e,c),ee().A.addListener(f),c.mobileNative&&ne().default.removeListener(f)}}),[a,c,S,x,f])}function de(){const e="on"===oe().default.getEligibleGroup({experimentId:"inbox_activity_split",defaultGroup:"control"})?"comments":"mentions";return{allSpaces:ee().A.getTotalUnreadCountForType(e),currentSpace:ee().A.getUnreadCountForCurrentSpace()[e]??0}}async function ce(e,t,n,o,i){const r=(0,re().Oo)(t,{table:K()._p,id:e});await r.load();const a=r.getKeyStore("activity_id").getValue(),s=r.getKeyStore("space_id").getValue();if(!s||!a)return;const l=(0,Q().jA)(r,a,s);await l.load();const d=l.getModel(),{currentUserStore:u}=ne().default.state;if(u&&n&&d&&!d.invalid&&!U().zP(d,u.id)&&await Y().isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await n.load(),!n.isDefined())return;if(!d.isMentionType())return;if("reacted"===d.getType())return;if(!n.getNotifyDesktop())return;if(!i.device.isDesktop)return;const e=(0,(await c.load()).Notification)({activity:d,getRecordValue:r.getRecordValue,userTimeZone:(0,V().P)(),intl:o,pageVisitSource:F().y8.PushNotification,recipientUser:u.getModel(),experimentService:oe().default,collectionFeatureGates:(0,$().i)()});if(!e)return;const{subject:t,body:a}=e,s=new Notification(t,{body:a,silent:!0}),p=U().JT(d.type),m={medium:"desktop_push",type:p,badge_number:de().allSpaces,notification_id:r.id,activity_id:l.id},g=e=>H().Gj({environment:i,args:m,action:e});g("sent"),s.addEventListener("show",(()=>g("shown"))),s.addEventListener("close",(()=>g("closed"))),s.addEventListener("click",(()=>{const e=U().KP({activity:d,getRecordModel:r.getRecordModel,baseUrl:q().A.domainBaseUrl,pageVisitSource:F().y8.PushNotification}),t=(0,F().p3)(e,[p,"desktop_push"],F().y8.PushNotification);Y().openNotificationUrl(t,i),g("clicked")}))}}const ue=new(d().O2)("linkMenu",(()=>n.e(4586).then(n.bind(n,323779)))),pe=(0,d()._h)(ue,(e=>e.default)),me=new(d().O2)("message-store-debug-panel",(async()=>await n.e(64199).then(n.bind(n,572107)))),ge=(0,d()._h)(me,(e=>e.MessageStoreDebugPanel));var fe=()=>n(971320);function he(){return(0,g().K8)((()=>fe().A.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,B.jsx)(ge,{}):null}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var ve=()=>n(386164);function ye(){const e=(0,i().v3)(),{shouldTrigger:t,spaceId:n,userId:r}=(0,g().K8)((()=>{const e={shouldTrigger:!1,spaceId:void 0,userId:void 0},{currentSpaceStore:t,currentSpaceViewStore:n,spaceTransitionStatus:o}=ne().default.state;if(!oe().default.checkGate({gateName:"auto_manage_people_collection"}))return e;if((0,ne().isTransitioningSpaces)(o))return e;if(!t||!t.canRead())return e;const i=null==n?void 0:n.getUserId();return i?{shouldTrigger:!0,spaceId:t.getSpaceId(),userId:i}:e}),[]);return(0,o.useEffect)((()=>{t&&(be.has(n)||(be.add(n),G().callApi({eventName:"scheduleSetupPeopleCollection",environment:e,data:{spaceId:n},userId:r,headers:(0,ve().WS)({cellId:void 0,recordId:n,spaceId:n})})))}),[e,t,n,r]),null}const be=new Set;var Se=()=>n(187174);const xe=(0,h().sg)(G().callApi,1e3,{leading:!0,trailing:!0}),Ae=function(){const e=(0,i().v3)(),t=(0,g().K8)((()=>function(e){let{environment:t}=e;const{currentSpaceViewStore:n,currentSpaceStore:o,currentUserStore:i,spaceTransitionStatus:r}=ne().default.state,a=null==n?void 0:n.getUserId(),s=null==n?void 0:n.getSpaceId(),l={readyForHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0,spaceViewSpaceId:void 0};return null!=n&&n.isDefined()&&n.getAlive()&&n.canRead()&&a&&s?(0,ne().isTransitioningSpaces)(r)||t.currentUser.id!==a||(null==i?void 0:i.id)!==a||(null==o?void 0:o.id)!==s?l:(0,E().$H)()?{readyForHomePagesRequest:!0,spaceViewId:n.id,spaceViewUserId:a,spaceViewSpaceId:s}:l:l}({environment:e})),[e]);return(0,Se().Yb)((async()=>{t.readyForHomePagesRequest&&await xe({eventName:"getUserHomePages",environment:e,data:{spaceViewId:t.spaceViewId,spaceId:t.spaceViewSpaceId},userId:t.spaceViewUserId,headers:(0,ve().WS)({cellId:void 0,recordId:t.spaceViewId,spaceId:t.spaceViewSpaceId})})}),[e,t.readyForHomePagesRequest,t.spaceViewId,t.spaceViewUserId,t.spaceViewSpaceId]),null};var Me=()=>n(362749),we=()=>n(171510),ke=()=>n(793531),je=()=>n(205682),Ce=()=>n(77238),Ie=()=>n(93658),Te=()=>n(578136);function _e(){const e=(0,i().v3)(),t=(0,g().K8)((()=>{const t=e.RouterStore.state.route;if("team"===t.name)return t.teamId}),[e]),n=(0,g().K8)((()=>function(e){let{environment:t,currentTeamId:n}=e;const{currentSpaceViewStore:o,currentSpaceStore:i,currentUserStore:r,spaceTransitionStatus:a}=ne().default.state,s=t.deviceStore.state,l=null==o?void 0:o.getUserId(),d=null==o?void 0:o.getSpaceId(),c={readyForTeamHomePagesRequest:!1,spaceViewUserId:void 0,spaceViewId:void 0,spaceViewSpaceId:void 0,currentTeamId:void 0};return null!=o&&o.isDefined()&&o.getAlive()&&o.canRead()&&l&&d&&n?(0,ne().isTransitioningSpaces)(a)||t.currentUser.id!==l||(null==r?void 0:r.id)!==l||(null==i?void 0:i.id)!==d?c:(0,Te().D)({isMobileNative:s.isMobileNative,disableExposureLogging:!0})?{readyForTeamHomePagesRequest:!0,spaceViewId:o.id,spaceViewUserId:l,spaceViewSpaceId:d,currentTeamId:n}:c:c}({environment:e,currentTeamId:t})),[e,t]);return(0,Se().Yb)((async()=>{n.readyForTeamHomePagesRequest&&await Pe({eventName:"createCollectionViewBlockForPosts",environment:e,data:{teamId:n.currentTeamId,spaceId:n.spaceViewSpaceId},userId:n.spaceViewUserId,headers:(0,ve().WS)({cellId:void 0,recordId:n.spaceViewId,spaceId:n.spaceViewSpaceId})})}),[n.readyForTeamHomePagesRequest,n.spaceViewSpaceId,n.spaceViewUserId,n.spaceViewId,e,n.currentTeamId]),null}const Pe=(0,h().sg)(G().callApi,1e3,{leading:!0,trailing:!0});var Be=()=>n(999830);function Le(){const e=(0,i().v3)(),t=e.currentUser.id,{currentSpaceStore:n}=(0,g().O$)(ne().default);(0,o.useEffect)((()=>{void 0!==t&&void 0!==n&&Be().q.fetchUnfetchedTeams({userId:t,spaceId:n.id,teamTypes:new Set(["Joined"]),environment:e,callGetTeamsV2ApiFn:E().FK})}),[t,n,e]);const r=(0,g().K8)((()=>new Set(Object.keys(Be().q.state).map((e=>Object.keys(Be().q.state[e]))).flat())),[]);return(0,o.useEffect)((()=>{const t=Array.from(r).map((t=>Z().Ay.addListener((0,z().um)(t),void 0,(n=>{let{value:o,passThroughData:i}=n;if(null!=o)for(const r in Be().q.state)if(t in Be().q.state[r]){if(Be().q.state[r][t].lastEmitValue===o)continue;Be().q.state[r][t].lastEmitValue=o,Be().q.refetchTeams({userId:r,spaceId:t,teamIds:Array.isArray(i)?new Set(i):"all",environment:e,callGetTeamsV2ApiFn:E().FK})}}),void 0,e))).filter((e=>void 0!==e));return()=>{for(const n of t)Z().Ay.removeListener(n,e)}}),[r,e]),null}var Re=()=>n(263928),De=()=>n(634157);function Ne(){const e=(0,i().v3)(),{currentSpaceStore:t}=(0,g().O$)(ne().default),n=e.currentUser.id,r=(0,g().K8)((()=>null==t?void 0:t.id),[t]);return(0,o.useEffect)((()=>{if(!r||!n)return;const t=Z().Ay.addListener((0,z().Li)({userId:n,spaceId:r}),void 0,(async t=>{let{value:o}=t;(function(e){var t;let{spaceId:n,userId:o,emitValue:i}=e;const r=null===(t=De().A.getUserJoinedTeamsState({userId:o,spaceId:n}))||void 0===t?void 0:t.lastEmitValue;if(r===i)return!1;if(void 0===r&&De().A.getHasFetched({userId:o,spaceId:n}))return!1;return!0})({spaceId:r,userId:n,emitValue:o})&&await Re().u({environment:e,spaceId:r,userId:n,emitValue:o});const i=De().A.getUserJoinedTeamsState({userId:n,spaceId:r});i&&De().A.setUserJoinedTeamsState({userId:n,spaceId:r,state:{...i,lastEmitValue:o}})}),void 0,e);return function(){t&&Z().Ay.removeListener(t,e)}}),[e,n,r]),null}var Oe=()=>n(195795),Ee=()=>n(401497),Ue=()=>n(66913),Fe=()=>n(133033),Ve=()=>n(284371),ze=()=>n(296511),Ke=()=>n(725614),We=()=>n(921855),He=()=>n(792540),Ge=()=>n(836251),Ye=()=>n(24973),qe=()=>n(285790),$e=()=>n(859428),Qe=()=>n(524702);const Ze=(0,W().YK)({learnTooltip:{defaultMessage:"Learn more about alt text",id:"altTextMenuPopup.helpButton.tooltip"}});function Xe(){const e=(0,i().v3)(),{device:t}=e,n=(0,W().tz)(),r=(0,Ee().IS)((e=>({wrapper:{padding:t.isMobile?16:12,display:"flex",flexDirection:"column",fontSize:t.isMobile?Ve().J.UIRegular.mobile:Ve().J.UIRegular.desktop,wordBreak:"break-word",maxHeight:t.isMobile?"35vh":"200px",overflowY:"auto"},closeButton:{borderRadius:"100%",width:22,height:22,float:"right",marginLeft:8},input:{marginTop:t.isMobile?16:12,padding:t.isMobile?"8px 12px":"4px 10px",width:"100%",borderRadius:6,boxShadow:e.inputBoxShadow,background:e.surface.page,cursor:"text",overflowX:"hidden"},helpText:{color:e.text.secondary,display:"inline"},helpButton:{marginLeft:2,display:"inline-flex",position:"absolute",transform:t.isMobile?void 0:"translateY(-1px)"}})),[t.isMobile]),{altTextStore:a,altText:s,canEdit:l}=(0,g().K8)((()=>{const e=Ye().A.state.blockStore;return{altTextStore:null==e?void 0:e.getPropertyStore("alt_text"),altText:e?(0,We().r4)(null==e?void 0:e.getPropertyValue("alt_text"),e):void 0,canEdit:(null==e?void 0:e.canEdit())&&!(null!=e&&e.isNavigableAncestorNonEditableState())}}),[]);return(0,o.useEffect)((()=>{a&&Ke().setSelectionAtEnd({store:a})}),[a]),(0,B.jsx)(S().A,{menuType:t.isMobile?A().gu.ActionSheet:A().gu.Popup,width:t.isMobile?"100vw":310,children:(0,B.jsxs)("div",{style:r.wrapper,children:[(0,B.jsxs)("div",{children:[(0,B.jsx)(qe().A,{style:r.closeButton,hovered:!0,icon:Ue().V,onClick:()=>ze().V(e),ariaLabel:n.formatMessage({id:"altTextMenuPopup.closeButton",defaultMessage:"Close"})}),l?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("div",{style:r.helpText,children:(0,B.jsx)(W().sA,{id:"altTextMenuPopup.description",defaultMessage:"Add alt text to describe this image. This makes your page more accessible to people who are vision-impaired or blind"})}),(0,B.jsx)($e().A,{renderTooltip:()=>n.formatMessage(Ze.learnTooltip),render:e=>(0,B.jsx)(qe().A,{ariaLabel:n.formatMessage(Ze.learnTooltip),icon:Fe().$,external:!0,href:(0,Ge().xS)("guides.altText"),style:r.helpButton,color:"tertiary",...e})})]}):s]}),l&&a?(0,B.jsx)(Qe().A,{store:a,disabled:!1,pasteBehavior:"plaintext",style:r.input,placeholderStyle:r.input,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableInsertText:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableMentions:!0,disableEmbedMenu:!0,disableMobileActionBar:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:()=>ze().V(e),onEsc:()=>ze().V(e),onTab:()=>!0,placeholder:n.formatMessage({id:"altTextMenuPopup.placeholder",defaultMessage:"Add alt text..."}),inPageFind:He().Os.none}):void 0]})})}const Je=function(){const e=(0,i().v3)(),{device:t}=e,n=(0,Ee().IS)((e=>({popup:{background:e.altTextPopupBackground,borderTopLeftRadius:t.isMobile?12:6,borderTopRightRadius:t.isMobile?12:6,left:t.isMobile?0:8}})),[t.isMobile]),{open:o,originRect:r}=(0,g().K8)((()=>{const{open:e}=Ye().A.state;return e?{open:e,originRect:Ye().A.state.originRect}:{open:e,originRect:void 0}}),[]);return(0,B.jsx)(x().Ay,{popupType:t.isMobile?C().n.SlideUp:C().n.Popup,open:o,originRect:r,originGap:8,placementToOrigin:j().W.Bottom,alignmentToOrigin:j().C.End,onDismiss:()=>ze().V(e),render:()=>(0,B.jsx)(Xe,{}),sameWidthAsOrigin:!1,style:n.popup,trapFocus:!0})};var et=()=>n(112873),tt=()=>n(517223),nt=()=>n(644914),ot=()=>n(737230),it=()=>n(372154),rt=()=>n(700500),at=()=>n(534177),st=()=>n(273321),lt=()=>n(555776),dt=()=>n(116008),ct=()=>n(756279),ut=()=>n(332006),pt=()=>n(545805),mt=()=>n(480095),gt=()=>n(13679),ft=()=>n(987017);const ht=[it().c.Open,it().c.Resolved];const vt=function(e){let{discussionIds:t,blockStore:o,recursivelyLoadAllDiscussions:r,tab:a,property_id:s}=e;const l=(0,i().v3)(),{resolved:d,unresolved:c}=(0,g().K8)((()=>{const e=Q().Bw(o,{recursivelyLoadAllDiscussions:r,includePropertyDiscussions:!0}).filter((e=>{if(t&&!t.includes(e.id)&&!Q().j3(e))return!1;return!Boolean(s)||e.getPropertyId()===s})).sort(((e,t)=>t.getReactionStores().length-e.getReactionStores().length)),{resolved:n,unresolved:i}=Q().uy(e);return{resolved:n,unresolved:i}}),[o,r,t,s]),{device:u}=l;let p;return p=u.isMobile?{menuType:A().gu.Modal,title:(0,B.jsx)(W().sA,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:(0,B.jsx)(xt,{tab:a,resolved:d,unresolved:c}),right:(0,B.jsx)(mt().DoneMenuText,{}),onClickRight:et().xl,whiteBackground:!0}:{menuType:A().gu.Popup,header:(0,B.jsx)(xt,{tab:a,resolved:d,unresolved:c}),width:480,maxHeight:"50vh",onClickOutside:et().xl},(0,B.jsx)(n(700180).A,{capture:!0,preventType:ct().A.All,children:(0,B.jsx)(n(297872).A,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,B.jsx)(pt().A,{debugName:"BlockDiscussionMenu",capture:!0,onEsc:et().xl,onBackspace:St,onDelete:St,children:(0,B.jsx)(gt().A,{store:o,droppable:!0,render:()=>(0,B.jsx)(S().A,{...p,children:(0,B.jsx)(Mt,{tab:a,blockStore:o,resolved:d,unresolved:c})})},o.id)})})})};function yt(e){let{message:t}=e;const n=(0,i().v3)(),{device:o}=n,r=(0,Ee().IS)((e=>({emptyState:{textAlign:"center",padding:o.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:e.text.secondary}})),[o.isMobile]);return(0,B.jsx)("div",{style:r.emptyState,children:t})}function bt(e){const t=it().A.state;t.open&&it().A.setState({...t,tab:ht[e]})}function St(e){null==e||e.preventDefault(),et().xl()}function xt(e){let{tab:t,resolved:n,unresolved:o}=e;const r=(0,i().v3)(),{device:a}=r,s=o.length,l=n.length,d=(0,Ee().IS)((e=>({openCountStyle:{color:e.text.tertiary},resolvedCountStyle:{color:e.text.quaternary}})),[]);return 0===l||0===s?null:(0,B.jsx)(ft().Ay,{tabs:[(0,B.jsxs)("div",{children:[(0,B.jsx)(W().sA,{defaultMessage:"Open",id:"blockDiscussionMenu.openDiscussionsTab.title"},"openDiscussionsTitle")," ",(0,B.jsx)("span",{style:d.openCountStyle,children:s})]},"openDiscussions"),(0,B.jsxs)("div",{children:[(0,B.jsx)(W().sA,{defaultMessage:"Resolved",id:"blockDiscussionMenu.resolvedDiscussionsTab.title"},"resolvedDiscussionsTitle")," ",(0,B.jsx)("span",{style:d.resolvedCountStyle,children:l})]},"resolvedDiscussions")],selectedIndex:ht.indexOf(t),onChange:bt,style:{...a.isAndroid&&{borderBottom:"none"}}})}function At(e){const{value:t}=(0,d().fJ)(s().commentsDependency),n=(0,i().v3)(),o=(0,g().K8)((()=>dt().A.state.open&&lt().A.state.overlapsExistingDiscussionMenu),[]),r=(0,g().K8)((()=>it().A.state.open&&it().A.state.tab===it().c.Open),[]),a=(0,g().K8)((()=>it().A.state.open&&it().A.state.keepNewDiscussionAtBottom),[]),l=(0,g().K8)((()=>(dt().A.state.open&&lt().A.state.overlapsExistingDiscussionMenu)??!1),[]);if(0===e.discussionStores.length)return null;const c=a?e.discussionStores[0]:void 0;return(0,B.jsxs)(B.Fragment,{children:[t?e.discussionStores.slice(c?1:0).map(((n,o,i)=>(0,B.jsx)(s().PW,{store:n,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:0===o,isOnly:1===i.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:et().xl},n.id))):void 0,c&&t?(0,B.jsx)(s().PW,{store:c,format:t.discussionHelpers.DiscussionFormat.Menu,isFirst:1===e.discussionStores.length,isOnly:1===e.discussionStores.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:e.blockStore,onDismiss:et().xl},c.id):void 0,o&&r?(0,B.jsx)(st().A,{environment:n,shouldShowTopDividerLine:!0,shouldExpandDiscussionWidth:l,noBackgroundColors:!0}):void 0]})}function Mt(e){let{tab:t,blockStore:n,resolved:r,unresolved:a}=e;const l=(0,Ee().DP)(),c=(0,i().v3)(),{device:u}=c,p=(0,g().K8)((()=>n.getType()),[n]),m=(0,g().K8)((()=>ut().B(n)),[n]),{value:f}=(0,d().fJ)(s().commentsDependency);if(!f)return null;if(t===it().c.Open){if(a.length){const e=p&&(0,at().O)(rt().kt,p);return u.isMobile&&e&&m?(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${l.regularDividerColor}`,marginBottom:1},children:(0,B.jsx)(m,{store:n,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),(0,B.jsx)(At,{discussionStores:a,blockStore:n})]}):(0,B.jsx)(At,{discussionStores:a,blockStore:n})}return(0,B.jsx)(yt,{message:(0,B.jsx)(W().sA,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return r.length?(0,B.jsx)(At,{discussionStores:r,blockStore:n}):(0,B.jsx)(yt,{message:(0,B.jsx)(W().sA,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}const wt=function(){const e=(0,i().v3)(),{device:t}=e,r=(0,g().K8)((()=>it().A.state.rect),[]),{pageSortedUnreadDiscussions:a}=(0,n(487441).i)(),s=(0,g().K8)((()=>{if(!it().A.state.open)return!1;if(a.length>0)return!1;let t=!1;const o=it().A.state.property_id;if(it().A.state.open&&o){var i;const e=null===(i=it().A.state.blockStore)||void 0===i||null===(i=i.getAssociatedCollectionStore())||void 0===i?void 0:i.getLayoutStore();e&&(t=(0,tt().Hc)({layoutStore:e,propertyId:o}).isPropertyInPageDetails)}const r=(0,n(835066).$N)(e,it().A.state.blockStore);return!!t||(ot().Ay.state.currentTab!==ot().tF.Comments||!(0,nt().Nk)(e))&&!r}),[e,a.length]),l=(0,o.useCallback)((()=>{et().xl()}),[]),d=(0,o.useCallback)((()=>{if(it().A.state.open)return(0,B.jsx)(vt,{tab:it().A.state.tab,blockStore:it().A.state.blockStore,discussionIds:it().A.state.discussionIds,recursivelyLoadAllDiscussions:it().A.state.recursivelyLoadAllDiscussions,property_id:it().A.state.property_id})}),[]),c=(0,se().X)("comment_sidebar_for_you");return(0,B.jsx)(x().Ay,{popupType:t.isMobile?c?C().n.BottomSheet:C().n.SlideUp:C().n.Popup,bottomSheetInitialState:"half",open:s,originRect:r,placementToOrigin:j().W.Bottom,alignmentToOrigin:j().C.Center,disableMouseCapture:!0,originGap:4,render:d,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:l,trapFocus:!0})};var kt=()=>n(925193),jt=()=>n(847832),Ct=()=>n(857639),It=()=>n(412975),Tt=()=>n(129518),_t=()=>n(541372),Pt=()=>n(178658),Bt=()=>n(2220),Lt=()=>n(732067),Rt=()=>n(949575),Dt=()=>n(945710),Nt=()=>n(352097),Ot=()=>n(310770),Et=()=>n(390849),Ut=()=>n(517545),Ft=()=>n(186445),Vt=()=>n(38337),zt=()=>n(495159),Kt=()=>n(972435),Wt=()=>n(84349),Ht=()=>n(525569),Gt=()=>n(502438),Yt=()=>n(760217),qt=()=>n(939740),$t=()=>n(8980),Qt=()=>n(89924);const Zt=(0,W().YK)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"},pasteItem:{defaultMessage:"Paste",id:"blockPasteMenu.actions.paste.label"},suggestedActionsSectionTitle:{defaultMessage:"Suggested actions",id:"blockPasteMenu.actions.suggestedActionsSectionTitle"}});const Xt=function(){const e=(0,i().Y0)(),t=(0,i().v3)(),r=(0,g().O$)(Wt().A),{stores:a,phase:s}=(0,g().O$)(Gt().default);(0,o.useEffect)((()=>{r.open&&((0,n(821062).A)(a,r.blocks)&&s===Gt().SelectionPhase.Selected||_t().VN(t))}),[r,a,s,t]);const l=(0,o.useCallback)((()=>{_t().VN(t)}),[t]),d=r.open&&"ai_actions"===r.type;return(0,B.jsx)(x().Ay,{popupType:e.isMobileNative&&!e.isTablet?C().n.SlideUp:C().n.Popup,open:r.open,originRect:r.open?r.rect:void 0,placementToOrigin:d?j().W.Right:j().W.Bottom,alignmentToOrigin:d?j().C.Start:j().C.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,B.jsx)(en,{}),onDismiss:l,disableFlippingPlacement:d})};function Jt(e){const{menuItemProps:t}=e,{isMobile:n}=(0,i().Y0)(),o=n?{mobileIconStyle:{marginLeft:18,marginRight:2}}:{};return(0,B.jsx)(Yt().A,{...t,title:Kt().A.formatMessage(zt().VT.askAI),icon:(0,B.jsx)(Lt().vF,{}),...o})}function en(){const e=(0,i().v3)(),t=(0,Ee().DP)(),{device:n}=e,o=(0,g().K8)((()=>{const n=Wt().A.state;return n.open?"ai_actions"===n.type?function(e,t,n){var o;const i=(0,Ft().ao)();if(!i)return null;const r=(0,Rt().clientSkillToAssistantSurfaceAction)((0,Dt().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),a={type:"entrypoint",entrypoint:"blockPasteMenu",isMobile:t.device.isMobile,pageStore:i,selectionState:Gt().default.state,textSelectionState:T().default.state,userSettings:null===(o=ne().default.state.currentUserSettingsStore)||void 0===o?void 0:o.getSettings()},s=(0,Rt().filterAssistantSurfaceActionsForContext)(r,a),l=(0,Ot().d7)({assistantSuggestionContext:a,validatedActions:s}).filter(Dt().isAssistantSurfaceActionWithClientSkill),d=(0,Rt().clientSkillToAssistantSurfaceAction)(l),c=(0,kt().gC)();return[{key:"ai_actions_paste_menu",render:e=>(0,B.jsx)(Qt().A,{...e,title:Kt().A.formatMessage(Zt.suggestedActionsSectionTitle)}),items:[{key:"paste",render:e=>(0,B.jsx)(Yt().A,{...e,icon:(0,B.jsx)($t().I,{icon:It().R}),title:Kt().A.formatMessage(Zt.pasteItem)}),action:()=>{(0,Bt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"paste"}}}),_t().VN(t)}},...d.map((e=>({key:e.skillType,render:t=>(0,B.jsx)(Yt().A,{...t,title:Kt().A.formatMessage(Ut().DZ.writerGlobalSkill,{displayName:Kt().A.formatMessage(e.displayName),acceptsParameters:(0,jt().yH)(e.skillType)||(0,jt().SH)(e.skillType)}),icon:(0,B.jsx)(Tt().O1,{svg:e.icon,svgFill:(0,Nt().vJ)(e.category).color(n).color})}),action:async()=>{try{(0,Bt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"client_skill",skill_type:e.skillType}}}),_t().VN(t),await(0,Pt().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c});const n=Ht().default.state;if(!n||"assistantCompletionPopup"!==n.type||"initialPrompt"!==n.stage)return;await Et().assistantWriterActions.triggerAssistantSkillCompletion({environment:t,context:n.context,clientSkillWithParameterValues:(0,Dt().dangerouslyCreateClientSkillWithParameterValues)(e),updater:Ht().default.createUpdater(),sessionId:c,from:"block_paste_menu",assistantSurfaceType:t.device.isMobile?"mobileWriter":"writer"})}catch{Ct().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantSkillCompletionError",error:{message:"Error triggering assistant skill completion"},data:{miscDataToConvertToString:{skillType:e.skillType}}})}}}))),{key:"ask_ai",render:e=>(0,B.jsx)(Jt,{menuItemProps:e}),action:async()=>{try{(0,Bt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:"ai_actions",action:"ask_ai"}}}),_t().VN(t),await(0,Pt().toggleInitialPrompt)({from:"block_paste_menu",environment:t,sessionId:c})}catch{Ct().log({level:"info",from:"BlockPasteMenu",type:"triggerAssistantWriterError",error:{message:"Error opening assistant writer"}})}}}]}]}(0,e,t):"blocks"===n.type||"links"===n.type?function(e,t){const{blocks:n}=e,{currentSpaceStore:o}=ne().default.state,i=[];if("blocks"===e.type){const{copiedStores:r,pageSource:a}=e;_t().GV({currentSpaceId:null==o?void 0:o.id,blocks:n,copiedStores:r})&&i.push({name:Kt().A.formatMessage(Zt.createTransclusion),action:async()=>{(0,Bt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"create_transclusion"}}}),await _t().Ce({environment:t,blocks:n,copiedBlockIds:r.map((e=>e.id))})}}),_t().h8({blocks:n})&&i.push({name:Kt().A.formatMessage(Zt.linkToPage),action:async()=>((0,Bt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),_t().Xw({environment:t,blocks:n,source:{type:"blocks",copiedStores:r,pageSource:a}}))})}return"links"===e.type&&i.push({name:Kt().A.formatMessage(Zt.linkToPage),action:async()=>((0,Bt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"link_to_page"}}}),_t().Xw({environment:t,blocks:n,source:{type:"links",copiedLinks:e.copiedLinks}}))}),[{key:"embed section",render:e=>(0,B.jsx)(Qt().A,{...e}),items:[{key:"dismiss",render:e=>(0,B.jsx)(Yt().A,{...e,title:Kt().A.formatMessage(Zt.dismissItem)}),action:()=>{(0,Bt().u)({environment:t,event:{eventName:"block_paste_menu_action",eventProperties:{type:e.type,action:"dismiss"}}}),_t().VN(t)}},...i.map((e=>{let{name:t,action:n}=e;return{key:`embed ${t}`,render:e=>(0,B.jsx)(Yt().A,{...e,title:t}),action:n}}))]}]}(n,e):void(0,at().HB)(n):null}),[e,t]);if(null===o)return null;let r;return r=n.isMobile?{menuType:A().gu.ActionSheet}:{menuType:A().gu.Popup,width:320,maxHeight:"40vh"},(0,B.jsx)(S().A,{...r,className:Vt().poM,children:(0,B.jsx)(qt().Ay,{type:qt().Oh.Vertical,sections:o,initialFocus:0})})}var tn=()=>n(673898),nn=()=>n(623580),on=()=>n(125565);const rn=function(){const e=(0,i().v3)(),{device:t}=e,{active:n,stringValue:o}=(0,g().K8)((()=>{const{active:e,stringValue:t}=tn().A.state;return{active:e,stringValue:t}}),[]),r=window.innerWidth/2-150,a=window.innerHeight/2,s=t.isMobileNative?(0,B.jsx)(W().sA,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,B.jsx)(W().sA,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,B.jsx)(x().Ay,{popupType:t.isMobileNative?C().n.SlideUp:C().n.Popup,open:n,originRect:{top:a,left:r},onDismiss:an,placementToOrigin:j().W.Bottom,alignmentToOrigin:j().C.Start,originGap:0,render:()=>(0,B.jsx)(pt().A,{debugName:"ClipboardInputRenderer",capture:!0,onEnter:h().D_,onCommandEnter:h().D_,onCommandShiftEnter:h().D_,onCommandSlash:h().D_,onDelete:h().D_,onBackspace:h().D_,onEsc:h().D_,onLeft:h().D_,onRight:h().D_,onUntab:h().D_,onTab:h().D_,onSelectAll:h().D_,onRedo:h().D_,onUndo:h().D_,onToggleBold:h().D_,onToggleItalics:h().D_,onToggleStrike:h().D_,onToggleCode:h().D_,onCut:h().D_,onCopy:h().D_,onPaste:h().D_,onKeypress:h().D_,children:(0,B.jsxs)("div",{style:{padding:8,width:300},children:[(0,B.jsx)(nn().A,{style:{width:"100%",fontSize:12},value:o,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,B.jsx)(on().A,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:s})]})})})};function an(){tn().A.setState({...tn().A.state,active:!1,stringValue:""})}var sn=()=>n(817722),ln=()=>n(588264),dn=()=>n(861841),cn=()=>n(269380),un=()=>n(177158);const pn=function(){const e=(0,g().O$)(dn().Hf);return(0,B.jsx)(un().A,{open:e,children:(0,B.jsx)(mn,{})})};function mn(){const e=(0,g().O$)(dn().Ay),t=(0,g().K8)((()=>function(){const e=dn().Ay.state;if(!e.isDragging)return;const{startX:t,startY:n,currentX:o,currentY:i}=e;return{position:"absolute",top:0,left:0,transform:`translate3d(${o-t}px, ${i-n}px, 0)`}}()),[]);if(!e.isDragging)return null;const n=e.draggedStores.map(((t,n)=>(0,B.jsx)("div",{children:e.ghostElements[n].map(((e,t)=>(0,B.jsx)(cn().A,{element:e},t)))},n)));return(0,B.jsx)("div",{style:t,children:n})}var gn=()=>n(887480),fn=()=>n(605402);const hn=function(){const e=(0,i().v3)(),{currentSpaceStore:t}=(0,g().K8)((()=>({currentSpaceStore:ne().default.state.currentSpaceStore})),[]);return(0,o.useEffect)((()=>{if(!t)return;const o=Z().Ay.addListener((0,z().On)(t.id),void 0,(async o=>{let{value:i}=o;if(!fn().A.shouldRefetch({currentSpaceId:t.id,emitValue:i}))return;const r=await G().callApi({eventName:"getAllSpacePermissionGroupsWithMemberCount",environment:e,data:{spaceId:t.id},headers:(0,ve().WS)({cellId:void 0,spaceId:t.id})});if("failed"===r.type)return Ct().rateLimitedLog({from:"CurrentSpacePermissionGroupsListener",level:"error",type:"getAllCurrentSpacePermissionGroupsFailed"}),[];fn().A.setState({permissionGroupsAndMemberCounts:r.data.groupsWithMemberCount.map((e=>({group:n(792071).Bj6.fromValue("space_permission_group",e.group),memberCount:e.memberCount}))),lastEmitData:{spaceId:t.id,value:i}})}),void 0,e);return function(){o&&Z().Ay.removeListener(o,e)}}),[t,e]),null};var vn=()=>n(486130);const yn=function(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n}=(0,g().O$)(ne().default),r=null==n?void 0:n.id;return(0,o.useEffect)((()=>{if(!t||!r)return;const n=Z().Ay.addListener((0,z().yp)({spaceId:t.id,userId:r}),void 0,(async n=>{let{value:o}=n;if(!vn()._.shouldRefetch({spaceId:t.id,userId:r,emitValue:o}))return;const i=await G().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:e,data:{spaceId:t.id,userIds:[r]},headers:(0,ve().WS)({cellId:void 0,spaceId:t.id})});if("failed"===i.type)return Ct().rateLimitedLog({from:"CurrentUserSpaceGroupMembershipListener",level:"error",type:"getSpacePermissionGroupIdsContainingMembers"}),[];const a=vn()._.getState();vn()._.setState({...a,[r]:{...a[r],[t.id]:{spacePermissionGroupIds:new Set(i.data.userToGroupMap[r]||[]),lastEmitValue:o}}})}),void 0,e);return function(){n&&Z().Ay.removeListener(n,e)}}),[t,r,e]),null};var bn=()=>n(666144),Sn=()=>n(245865),xn=()=>n(423219);function An(e){const{environment:t,pointers:n,userIdToCloneFrom:o}=e;for(const i of n)bn().PC({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:i,model:t.defaultRecordCache.inMemoryRecordCache.getRecordModel({pointer:i,userId:o}),role:"reader",updatePaths:[[]],debugSource:"CustomEmojisListener"})}const Mn=new(n(99895).G)((()=>0));const wn=function(){const e=(0,i().v3)(),[t,r]=(0,o.useState)(!1);(0,o.useEffect)((()=>{!async function(){await n(807054).waitForInitialPageRenderToComplete(),r(!0)}()}),[]);const a=(0,g().K8)((()=>{var e;return null===(e=(0,n(87878).vZ)())||void 0===e?void 0:e.id}),[]),s=e.currentUser.id,l=(0,g().K8)((()=>{const e=xn().A.getKeys();return a&&s?e.includes(a)?e:[...e,a]:e}),[a,s]);return function(e,t){const n=(0,i().v3)();(0,o.useEffect)((()=>{const o=Mn.get(e)+1;Mn.set(e,o);const i=()=>{};Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:`useRetainRecordsInMemory(${e} ${o})`});for(const e of t)n.defaultRecordCache.inMemoryRecordCache.addListenerToRecord(e,i),Sn().cancelEviction({pointer:e,userId:n.currentUser.id});return()=>{for(const e of t)n.defaultRecordCache.inMemoryRecordCache.removeListenerToRecord(e,i),Sn().unsubscribeAfterDelay({environment:n,pointer:e,userId:n.currentUser.id})}}),[e,n,t])}("CustomEmojis",(0,g().K8)((()=>{if(!t)return[];const n=[];for(const t of l){const o=xn().A.getDataWithoutRefetch(e,{spaceId:t});if(!o)continue;const i=o.pointers,r=o.lastFetchedBy;t===a&&r!==s&&An({environment:e,pointers:i,userIdToCloneFrom:r}),n.push(...i)}return n}),[l,a,s,e,t])),function(e){const t=(0,i().v3)();(0,o.useEffect)((()=>{const n=[];for(const o of e){const e=Z().Ay.addListener((0,z().VW)(o),void 0,(e=>{let{value:t}=e;xn().A.emit({spaceId:o},t)}),void 0,t);e&&n.push(e)}return()=>{for(const e of n)Z().Ay.removeListener(e,t)}}),[t,e])}(l),null};var kn=()=>n(597777),jn=()=>n(220719),Cn=()=>n(743336),In=()=>n(319975),Tn=()=>n(536131);const _n=function(){const e=(0,i().v3)(),{device:t}=e,n=(0,g().O$)(Tn().A);return(0,B.jsx)(x().Ay,{popupType:t.isMobile?C().n.BottomSheet:C().n.Popup,open:n.open,originRect:n.originRect,onDismiss:Cn().V,render:()=>(0,B.jsx)(Pn,{shouldShowReminder:!!n.open&&n.allowReminders}),trapFocus:!0})};function Pn(e){let{shouldShowReminder:t}=e;const n=(0,i().v3)(),o=(0,g().K8)((()=>Bn()),[]);if(!o)return null;const r="default",{date_format:a,time_format:s,dateValue:l}=o;return(0,B.jsx)(d().u2,{dependency:p().cm,children:e=>{let{DatePropertyMenu:o}=e;return(0,B.jsx)(o,{firstDayOfWeek:Ft().XX.state,value:l,canConfigureCollection:!0,onChangeValue:e=>function(e,t,n){if(!e)return void function(e,t){const n=Bn();if(!n)return;const{textStore:o,textValue:i,tokenIndex:r}=n,a=f().AhH(i.slice(0,r)),s=f().AhH(i.slice(0,r+1));b().createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,canUndo:!0,perform:t=>{In().jQ({environment:e,store:o,selection:{startIndex:a,endIndex:s},transaction:t})}})}(t);if(!kn().kC(e))return;const o=Bn();if(!o)return;const{date_format:i,time_format:r}=o;Ln({date_format:i,time_format:r,...e},t,n)}(e,n,r),dateFormat:a,onChangeDateFormat:e=>function(e,t,n){const o=Bn();if(!o)return;const{dateValue:i,time_format:r}=o;Ln({date_format:e,time_format:r,...i},t,n)}(e,n,r),timeFormat:s,onChangeTimeFormat:e=>function(e,t,n){const o=Bn();if(!o)return;const{dateValue:i,date_format:r}=o;Ln({date_format:r,time_format:e,...i},t,n)}(e,n,r),onDismiss:Cn().V,disabled:!1,shouldShowReminder:t,isTemplatePage:!1})}})}function Bn(){const e=Tn().A.state;if(e.open){const{textStore:t,tokenIndex:n}=e,o=t.getValue();if(o){const e=o[n];if(e){(0,jn().MX)(f().qXl(e),"Token should be a mention token");const i=f().uPN(e),r=f().$CJ(i);if(r){const{date_format:a,time_format:s,...l}=f().K7D(r);return{textStore:t,textValue:o,tokenIndex:n,token:e,annotations:i,date_format:a,time_format:s,dateValue:l}}}}}}function Ln(e,t,n){const o=Bn();if(!o)return;const{textStore:i,textValue:r,tokenIndex:a,token:s,annotations:l}=o,d=l.map((t=>f().qsB(t)?["d",e]:t)),c=f().Ey_(s[0],d),u=f().AhH(r.slice(0,a)),p=f().AhH(r.slice(0,a+1));b().createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,canUndo:!0,perform:e=>{In().jQ({environment:t,store:i,selection:{startIndex:u,endIndex:p},transaction:e}),In().yr({environment:t,store:i,tokens:[c],index:u,transaction:e}),oe().default.checkGate({gateName:"mobile_clear_selection_on_date_mention_menu_change_kill_switch"})||Ke().clear({environment:t})}})}n(737550);var Rn=()=>n(852507),Dn=()=>n(90023),Nn=()=>n(304740),On=()=>n(861017),En=()=>n(179034),Un=()=>n(720665),Fn=()=>n(437219),Vn=()=>n(131581),zn=()=>n(664133);var Kn=()=>n(108944);const Wn={quip:"Quip",evernote:"Evernote",workflowy:"Workflowy",monday:"Monday",confluence:"Confluence",trello:"Trello"},Hn=(Object.values(Wn),[{name:Wn.quip,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.quip\\.com)\\/(?<docId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}]),Gn=[{name:Wn.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/shard\\/(?<shardId>[^\\/]+)\\/nl\\/(?<userId>[^\\/]+)\\/(?<noteId>[a-zA-Z0-9]+)\\/?(?:.*)?$"},{name:Wn.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\?b=(?<notebookId>[^&]+)&n=(?<noteId>[^&]+)$"},{name:Wn.evernote,attributes:[],regex:"^(?<site>https:\\/\\/www\\.evernote\\.com)\\/client\\/web#\\/note\\/(?<noteId>[a-f0-9-]+)(?:\\?.*)?$"}],Yn=[{name:Wn.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/s\\/(?<shareId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"},{name:Wn.workflowy,attributes:[],regex:"^(?<site>https:\\/\\/workflowy\\.com)\\/#\\/(?<nodeId>[a-zA-Z0-9-_]+)\\/?(?:.*)?$"}],qn=[{name:Wn.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/views\\/(?<viewId>\\d+)\\/?(?:.*)?$"},{name:Wn.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/boards\\/(?<boardId>\\d+)\\/?(?:.*)?$"},{name:Wn.monday,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.monday\\.com)\\/items\\/(?<itemId>\\d+)\\/?(?:.*)?$"}],$n=[{name:Wn.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/pages\\/(?<pageId>\\d+)\\/(?<pageTitle>[^\\/?#]+)\\/?(?:.*)?$"},{name:Wn.confluence,attributes:[],regex:"^(?<site>https:\\/\\/[a-zA-Z0-9_-]+\\.atlassian\\.net)\\/wiki\\/spaces\\/(?<spaceKey>[a-zA-Z0-9_-]+)\\/?(?:.*)?$"}],Qn=[{name:Wn.trello,attributes:[],regex:"^(?<site>https:\\/\\/trello\\.com)\\/b\\/(?<boardId>[a-zA-Z0-9]+)(?:\\/(?<title>[^\\/?#]+))?\\/?(?:\\?.*)?$"}],Zn={[Wn.quip]:Hn,[Wn.evernote]:Gn,[Wn.workflowy]:Yn,[Wn.monday]:qn,[Wn.confluence]:$n,[Wn.trello]:Qn};function Xn(e){if(!e||"string"!=typeof e)return{type:"failure"};for(const[t,n]of Object.entries(Zn))for(const o of n)if(new RegExp(o.regex).test(e)&&Jn(t))return{type:"success",importName:t,pattern:o};return{type:"failure"}}function Jn(e){return Object.values(Wn).some((t=>t===e))}var eo=()=>n(176106),to=()=>n(666803),no=()=>n(404141),oo=()=>n(160475),io=()=>n(802790),ro=()=>n(331542),ao=()=>n(515918);const so=(0,W().YK)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed Excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Maps",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),lo=(0,W().YK)({mentionPage:{defaultMessage:"Mention",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention",id:"embedMenu.actions.mentionBlock.title"},createLinkedViewOfDatabase:{defaultMessage:"Linked database view",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Bookmark",id:"embedMenu.actions.createBookmark.title"},newBookmarkMenuItem:{defaultMessage:"Preview",id:"embedMenu.actions.createNewBookmark.title"},createTransclusionItem:{defaultMessage:"Synced block",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"URL",id:"embedMenu.actions.dismiss.title"},linkMention:{defaultMessage:"Mention",id:"embedMenu.actions.linkMention.title"},pagePreview:{defaultMessage:"Preview",id:"embedMenu.actions.pagePreview.title"},embed:{defaultMessage:"Embed",id:"embedMenu.actions.embed.title"}}),co="3rd party import section",uo={image:Kt().A.formatMessage(so.image),video:Kt().A.formatMessage(so.video),tweet:Kt().A.formatMessage(so.tweet),drive:Kt().A.formatMessage(so.drive),gist:Kt().A.formatMessage(so.gist),figma:Kt().A.formatMessage(so.figma),invision:Kt().A.formatMessage(so.invision),abstract:Kt().A.formatMessage(so.abstract),framer:Kt().A.formatMessage(so.framer),whimsical:Kt().A.formatMessage(so.whimsical),mixpanel:Kt().A.formatMessage(so.mixpanel),miro:Kt().A.formatMessage(so.miro),sketch:Kt().A.formatMessage(so.sketch),excalidraw:Kt().A.formatMessage(so.excalidraw),replit:Kt().A.formatMessage(so.replit),audio:Kt().A.formatMessage(so.audio),maps:Kt().A.formatMessage(so.maps),loom:Kt().A.formatMessage(so.loom),typeform:Kt().A.formatMessage(so.typeform),codepen:Kt().A.formatMessage(so.codepen),pdf:Kt().A.formatMessage(so.pdf),embed:Kt().A.formatMessage(so.embed),hex:Kt().A.formatMessage(so.hex),deepnote:Kt().A.formatMessage(so.deepnote),drawing:Kt().A.formatMessage(so.drawing)};const po=function(){const e=(0,i().v3)(),t=(0,i().Y0)(),n=(0,g().O$)(eo().A);return(0,B.jsx)(x().Ay,{popupType:t.isMobileNative&&!t.isTablet?C().n.SlideUp:C().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:j().W.Bottom,alignmentToOrigin:j().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:t.isMobile,keepFocus:t.isMobile,render:()=>n.loading?(0,B.jsx)(ro().A,{}):(0,B.jsx)(xo,{}),onDismiss:()=>mo(e)})};function mo(e){const t=eo().A.state;if(!t.open)return;const{url:n}=t;Fn().ol(e,{url:n,type:"close"}),Vn().VN()}function go(e,t){const n=eo().A.state;if(!n.open)return;const{url:o}=n;Vn().Ju({environment:t,type:e}),"form"!==e&&Fn().ol(t,{url:o,type:e})}function fo(e){let{environment:t,importType:n,isImportGateEnabled:o}=e;return o?{key:co,render:e=>(0,B.jsx)(Qt().A,{...e}),items:[{key:"import",render:e=>(0,B.jsx)(ho,{environment:t,importType:n,menuItemProps:e}),action:()=>function(e,t){let n;(0,oo().t)({environment:e,action:"click",from:"paste_link"}),t&&(n=function(e){switch(e){case"Evernote":return"evernote";case"Monday":return"monday";case"Confluence":return"confluence";case"Trello":return"trello";case"Workflowy":return"workflowy";case"Quip":return"quip";default:return}}(t)),no().A.setState({...no().A.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:n,openedFrom:"link_paste"}),Vn().VN()}(t,n)}]}:null}function ho(e){let{environment:t,importType:n,menuItemProps:o}=e;return(0,Rn().w)((()=>{(0,oo().t)({environment:t,action:"view",from:"paste_link"})})),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(io().A,{size:4}),(0,B.jsx)(Yt().A,{...o,title:(0,B.jsx)(W().sA,{id:"embedMenu.actions.import.title",defaultMessage:"Import from {importType}",values:{importType:n}})})]})}function vo(e,t,n){const{device:o}=t,{url:i,textStore:r}=e,{currentSpaceStore:a}=ne().default.state,s=[],l=(0,On().parseRoute)({url:i,baseUrl:q().A.domainBaseUrl,publicDomainName:q().A.publicDomainName,isMobile:o.isMobile,protocol:q().A.protocol,currentUrl:window.location.href}),d=["youtube.com","youtu.be","instagram.com","twitter.com","x.com","facebook.com","linkedin.com","pinterest.com","tiktok.com","spotify.com","maps.google.com","drive.google.com","docs.google.com","slides.google.com","sheets.google.com","forms.google.com","indify.co","open.spotify.com","music.youtube.com","figma.com","amazon","wikipedia.org","medium.com","naver.com","canva.com","miro.com","reddit.com","calendly.com","forms.gle"],c=r.getRecordStoreUIParent(),u="page"===l.name?l.blockId:"team"===l.name?l.peekViewBlockId:void 0,p="page"===l.name&&l.scrollToBlockId,m="page"===l.name?l.collectionViewId:void 0;if(u){const e=re().Bv.createChildStore(r,{table:En().ev,id:u});e.isType("form")&&s.push({name:Kt().A.formatMessage(lo.embed),validator:()=>!Vn().en(r)&&So(c)&&(null==a?void 0:a.id)===e.getSpaceId(),type:rt().xd.form});const t=p?re().Bv.createChildStore(r,{table:En().ev,id:p}):void 0;s.push({name:Kt().A.formatMessage(lo.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!Vn().en(r)&&(!e.isCollectionViewPageWithContent()||!function(e,t){const n=e.getCollectionViewStores(),o=h().I6(n,(e=>e.id===t&&"page"===e.getType()));return Boolean(o)}(e,m))&&!function(e,t){const n=e.getCollectionViewStores(),o=h().I6(n,(e=>e.id===t&&"form_editor"===e.getType()));return Boolean(o)}(e,m)&&(null==a?void 0:a.id)===e.getSpaceId()&&So(c)&&bo(e),type:rt().xd.collectionView}),s.push({name:Kt().A.formatMessage(void 0===t?lo.mentionPage:lo.mentionBlock),validator:()=>bo(e),type:"mention-page"}),s.push({name:Kt().A.formatMessage(lo.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!Vn().en(r)&&!t.isNonEditableState()&&!t.isNavigableAncestorNonEditableState()&&!function(e){const t=e.getParentBlockStore();return!(null==t||!t.isTranscriptionBlock())&&t.getContentIds().includes(e.id)}(t)&&t.canEdit()&&t.getSpaceId()===(null==a?void 0:a.id)&&So(c)&&bo(e)),type:"create-transclusion"}),oe().default.checkGate({gateName:"enable_page_previews"})&&s.push({name:Kt().A.formatMessage(lo.pagePreview),validator:()=>!t&&!e.isCollectionView()&&!Vn().en(r)&&bo(e)&&So(c)&&!e.isType("form"),type:"page-preview"})}const g=Un().HP(uo);for(const h of g)"embed"!==h&&s.push({name:uo[h],validator:e=>Nn().dA[h](e)&&So(c),type:h});s.push({name:Kt().A.formatMessage(lo.bookmarkMenuItem),validator:e=>!Vn().en(r)&&So(c)&&Nn().Vp(e),type:rt().xd.bookmark}),s.push({name:uo.embed,validator:e=>!Vn().en(r)&&So(c)&&Nn().dA.embed(e),type:"embed"});const f=h().oE(s.map((e=>{let{name:n,validator:o,type:r}=e;if(o({url:i,baseUrl:q().A.domainBaseUrl,publicDomainName:q().A.publicDomainName})){return{key:`embed ${n}`,render:e=>(0,B.jsx)(Yt().A,{...e,title:n}),action:()=>go(r,t)}}}))),v={key:"link-mention",render:e=>(0,B.jsx)(Yt().A,{...e,title:Kt().A.formatMessage(lo.linkMention)}),action:()=>go("link-mention",t)},y={key:"dismiss",render:e=>(0,B.jsx)(Yt().A,{...e,title:Kt().A.formatMessage(lo.dismissItem)}),action:()=>mo(t)};if(0===f.length)return[];(0,On().Jx)(l)?f.push(y):(yo(i,d)?("embed Create bookmark"!==f[0].key||f.reverse(),f.push(y)):f.unshift(y),oe().default.checkGate({gateName:"enable_link_mentions"})&&f.splice(0,0,v));const b={key:"embed section",render:e=>(0,B.jsx)(Qt().A,{...e}),items:f},S={key:"import section",render:e=>(0,B.jsx)(Qt().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:[{key:"jira-sync",render:e=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(io().A,{size:4}),(0,B.jsx)(Yt().A,{...e,title:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(W().sA,{id:"embedMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,B.jsx)(ao().A,{style:{display:"inline"}})]})})]}),action:()=>function(e){var t,n;const o=eo().A.state;if(!o.open)return;const{url:i}=o,r=ne().default.state.mainEditorCurrentBlockStore,a=r&&(null===(t=(0,Kn().Uo)(r))||void 0===t?void 0:t.id),s=null===(n=i.match(/\/projects\/(\w+)\//))||void 0===n?void 0:n[1];to().Ay.setState({...to().Ay.state,teamSpaceId:a,projectKeys:s?[s]:[]}),zn().jh({environment:e,from:"external_object_instance_block",action:"show_teamspaces"}),(0,Bt().u)({environment:e,event:{eventName:"external_sync_entry_point",eventProperties:{integration:"jira",flowId:to().Ay.createNewFlowId(),from:"link_paste_menu"}}}),Vn().VN(),Fn().ol(e,{url:i,type:"jira-sync"})}(t)}]},x=Xn(i),A="success"===x.type?x.importName:void 0,M=fo({environment:t,importType:A,isImportGateEnabled:n});return yo(i,["atlassian.net/jira","/jira/"])?[b,S]:n&&function(e){return"success"===Xn(e).type}(i)&&M?[b,M]:[b]}function yo(e,t){return t.some((t=>e.includes(t)))}function bo(e){const t=e.getSystemBlockTypeStore().getValue();return!(0,Dn().xm)(t)}function So(e){if(!(e instanceof re().Bv))return!1;const t=e.getType();return!!t&&(0,rt().IU)(t,e.getFormat())}function xo(){const e=(0,i().v3)(),{device:t}=e,n=(0,se().X)("contextualized_import_entrypoints"),r=(0,g().K8)((()=>{const t=eo().A.state;return t.open?vo(t,e,n):null}),[e,n]),a=(0,g().K8)((()=>!!eo().A.state.loading),[]),s=(null==r?void 0:r.length)??0;(0,o.useEffect)((()=>{a||0!==s||Vn().VN()}),[s,a]),function(){const e=(0,g().O$)(eo().A),t=(0,g().O$)(T().default);(0,o.useEffect)((()=>{if(e.open&&"editing"===t.mode){const{multiSelection:n}=t;(0,M().KP)(n)&&n.start.store.id===e.textStore.id&&n.end.index===e.urlSelection.endIndex||Vn().VN()}}),[e,t])}();const l=(0,Ee().IS)((e=>({header:t.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Ve().Wy.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:Ve().J.UISmall.desktop,fontWeight:450,fontStyle:"normal",font:"SF Pro"}})),[t]);if(null===r)return null;let d;return d=t.isMobile?{menuType:A().gu.ActionSheet}:{menuType:A().gu.Popup,width:r.some((e=>e.key===co))?270:r.some((e=>"import section"===e.key))?260:200,maxHeight:"40vh"},(0,B.jsx)(B.Fragment,{children:a?(0,B.jsx)(ro().A,{style:{marginLeft:3,marginRight:3}}):(0,B.jsx)(S().A,{...d,className:Vt().poM,header:(0,B.jsx)(on().A,{style:l.header,isSmall:!t.isMobile,isSecondaryColor:!t.isMobile,children:(0,B.jsx)(W().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,B.jsx)(qt().Ay,{type:qt().Oh.Vertical,sections:r,initialFocus:0})})})}var Ao=()=>n(633457),Mo=()=>n(47170),wo=()=>n(523713);function ko(){const e=(0,i().v3)(),t=e.currentUser.id,n=(0,Mo().O)(),r=(0,g().K8)((()=>(0,wo().x)({isPhone:e.device.isPhone,spaceStore:ne().default.state.currentSpaceStore})),[e.device]);return(0,o.useEffect)((()=>{if(!n||!t||!r)return;const o=Z().Ay.addListener((0,z().DZ)({notionUserId:t,spaceId:n}),void 0,(0,Z().AY)((t=>{let{version:n}=t;-1!==n&&jo(e)})),void 0,e);return function(){o&&Z().Ay.removeListener(o,e)}}),[e,t,n,r]),null}const jo=(0,h().sg)((e=>{Ao().oX({environment:e})}),5e3,{leading:!0,trailing:!0});var Co=()=>n(908006),Io=()=>n(522419),To=()=>n(681546),_o=()=>n(452951),Po=()=>n(340498);const Bo=(0,Po().wt)("collapse",{viewBox:"0 0 16 16",svg:(0,B.jsx)("path",{d:"M2.477 7.51h3.787c.396 0 .701-.106.916-.32.214-.22.321-.525.321-.917V2.534a.723.723 0 00-.745-.745.731.731 0 00-.54.212.736.736 0 00-.205.533v.486l.15 2.146-1.6-1.682-1.968-1.982a.695.695 0 00-.52-.219.791.791 0 00-.574.219.736.736 0 00-.219.554.78.78 0 00.055.294.917.917 0 00.17.253L3.482 4.57l1.675 1.593-2.153-.143h-.526a.723.723 0 00-.746.745.723.723 0 00.746.745zm6.74 6.912a.71.71 0 00.526-.212.7.7 0 00.212-.526v-.554l-.143-2.14 1.6 1.682 2.002 2.016a.69.69 0 00.526.22c.224 0 .41-.074.561-.22a.725.725 0 00.226-.553.707.707 0 00-.062-.294.728.728 0 00-.164-.246l-2.01-2.017-1.688-1.586 2.16.144h.588a.736.736 0 00.533-.205.711.711 0 00.219-.534.72.72 0 00-.219-.54.723.723 0 00-.533-.211H9.702c-.392 0-.697.109-.916.328-.214.214-.321.517-.321.909v3.8a.7.7 0 00.212.527.746.746 0 00.54.212z"})});var Lo=()=>n(812318),Ro=()=>n(236190),Do=()=>n(689094),No=()=>n(343666),Oo=()=>n(381349),Eo=()=>n(124952),Uo=()=>n(235116),Fo=()=>n(35622),Vo=()=>n(797265),zo=()=>n(778417),Ko=()=>n(569912),Wo=()=>n(129522),Ho=()=>n(640867),Go=()=>n(145214),Yo=()=>n(493823);const qo={background:"rgba(255, 255, 255, 0.055)"},$o={padding:"6px 10px 6px 6px"},Qo={padding:"6px 6px 6px 10px"},Zo={display:"flex",borderRadius:4,background:Oo().Ay.blackWithAlpha(.65)},Xo=.5,Jo=.5,ei=2,ti=-.002,ni=-.004;function oi(e){let{visible:t,isOpen:n,zoomScale:o,handleZoomIn:r,handleZoomOut:a,handleNext:s,handlePrevious:l,setZoomScale:d,disableZoomEditing:c,enableZoomEditing:u,resetHideControlsTimeout:p,clearHideControlsTimeout:m,isSaving:h,isEditingZoom:v,handleClose:y}=e;const b=(0,i().Y0)(),S=(0,i().v3)(),{blockStore:x,imageUrl:A}=(0,g().K8)((()=>({blockStore:Ho().A.state.blockStore,imageUrl:Ho().A.state.imageUrl})),[]),M=(0,g().K8)((()=>{var e;return Boolean(x&&(A||(null===(e=x.getProperties())||void 0===e?void 0:e.source)&&f().q4_(x.getProperties().source)))}),[x,A]);if(b.isMobile)return null;return(0,B.jsxs)(Go().A,{visible:t,initial:{opacity:1},exit:{opacity:0},animate:{opacity:1},style:pi(n),onClick:e=>{!function(e){e.stopPropagation()}(e),p(),c()},children:[(0,B.jsx)("div",{style:{...Zo,marginRight:10},children:(0,B.jsx)(ri,{handlePrevious:l,handleNext:s})}),(0,B.jsxs)("div",{style:Zo,children:[(0,B.jsx)(ii,{zoomScale:o,handleZoomIn:r,handleZoomOut:a,setZoomScale:d,disableZoomEditing:c,enableZoomEditing:u,isEditingZoom:v}),(0,B.jsx)(yi,{}),M?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(ai,{onClick:()=>{if(!x||!M)return;Ho().A.setState({...Ho().A.state,isSaving:!0}),m();const e=null==x?void 0:x.getProperties();let t,n;if(t=A||f().q4_(null==e?void 0:e.source),t){if((0,Io()._J)(t)){const o=f().q4_(null==e?void 0:e.title)||(0,Io().Jt)(t);n=Uo().KE(S,{url:t,download:!0,downloadName:o,permissionRecord:x.pointer})}else{const o=f().q4_(null==e?void 0:e.caption);n=(0,Io().pJ)(t,null==x?void 0:x.pointer,q().A.domainBaseUrl,S.currentUser.id,o)}n.then((()=>{Ho().A.setState({...Ho().A.state,isSaving:!1}),(0,Eo().d)(S,{type:"download",triggered_by:"click"}),p()}))}},loading:h}),(0,B.jsx)(yi,{})]}):void 0,(0,B.jsx)(si,{onClick:y})]})]})}function ii(e){let{zoomScale:t,handleZoomIn:n,handleZoomOut:r,setZoomScale:a,disableZoomEditing:s,enableZoomEditing:l,isEditingZoom:d}=e;const c=(100*t).toFixed(0),u=(0,i().v3)(),p=(0,o.useCallback)((e=>{const t=e.target,n=parseInt(t.value);if(!isNaN(n)){const e=n/100;(0,Eo().d)(u,{type:"set_zoom",new_zoom:e}),a(e)}s()}),[s,u,a]);return(0,B.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,B.jsx)($e().A,{renderTooltip:()=>(0,B.jsx)(vi,{primaryText:(0,B.jsx)(W().sA,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:t<=Jo,render:e=>(0,B.jsx)(Yo().p,{...e,disabled:t<=Jo,style:{...fi(t<=Jo),...Qo},onClick:r,iconLeading:e=>(0,Ro().c)({...e,fill:mi(),height:16,margin:0,width:16})})}),d?(0,B.jsx)(li,{initialValue:c,onSubmit:p,onCancel:s,primaryColor:mi(),secondaryColor:gi()}):(0,B.jsx)(Yo().p,{onClick:e=>{e.stopPropagation(),l()},style:{color:gi(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${c}%`}),(0,B.jsx)($e().A,{renderTooltip:()=>(0,B.jsx)(vi,{primaryText:(0,B.jsx)(W().sA,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:t>=ei,render:e=>(0,B.jsx)(Yo().p,{...e,disabled:t>=ei,style:fi(t>=ei),onClick:n,iconLeading:e=>(0,Do().W)({...e,fill:mi(),height:16,margin:0,width:16})})})]})}function ri(e){let{handlePrevious:t,handleNext:n}=e;const o=(0,B.jsx)("div",{}),{blockStore:i,allImageBlocksOnPage:r}=(0,g().K8)((()=>{const{blockStore:e}=Ho().A.state;return{blockStore:e,allImageBlocksOnPage:e?ci():[]}}),[]);if(!i)return o;if(r.length<=1)return o;const a=r.findIndex((e=>e.id===(null==i?void 0:i.id)))??-1;if(-1===a)return o;const s=r.length;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)($e().A,{renderTooltip:()=>(0,B.jsx)(vi,{primaryText:(0,B.jsx)(W().sA,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,B.jsx)(hi,{imageIndex:a-1,totalImageCount:s})}),disableTooltip:0===a,render:e=>(0,B.jsx)(Yo().p,{...e,disabled:a<=0,style:{...fi(a<=0),...Qo},hoveredStyle:qo,onClick:()=>t(),iconLeading:e=>(0,To().i)({...e,fill:mi(),height:16,margin:0,width:16})})}),(0,B.jsx)($e().A,{renderTooltip:()=>(0,B.jsx)(vi,{primaryText:(0,B.jsx)(W().sA,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,B.jsx)(hi,{imageIndex:a+1,totalImageCount:s})}),disableTooltip:a+1===s,render:e=>(0,B.jsx)(Yo().p,{...e,disabled:a>=s-1,style:{...fi(a>=s-1),...$o},hoveredStyle:qo,onClick:()=>n(),iconLeading:e=>(0,_o().Z)({...e,fill:mi(),height:16,margin:0,width:16})})})]})}function ai(e){let{onClick:t,loading:n}=e;return(0,B.jsx)($e().A,{renderTooltip:()=>(0,B.jsx)(vi,{primaryText:(0,B.jsx)(W().sA,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:e=>(0,B.jsx)(Yo().p,{...e,disabled:n,onClick:t,style:fi(!1),hoveredStyle:qo,children:n?(0,B.jsx)(ro().A,{size:"sm"}):(0,Lo().k)({fill:mi(),width:16})})})}function si(e){let{onClick:t}=e;return(0,B.jsx)($e().A,{renderTooltip:()=>(0,B.jsx)(vi,{primaryText:(0,B.jsx)(W().sA,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,B.jsx)(Yo().p,{...e,onClick:t,style:{...fi(!1),...$o},hoveredStyle:qo,iconLeading:e=>Bo({...e,fill:mi(),height:16,margin:0,width:16})})})}function li(e){const[t,n]=(0,o.useState)(e.initialValue);return(0,B.jsx)(nn().A,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;n(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:nn().C.Transparent,right:(0,B.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}const di=function(){const e=(0,i().v3)(),t=(0,o.useRef)(!1),r=(0,o.useRef)(),a=(0,o.useRef)(),[s,l]=(0,o.useState)(!1),[d,c]=(0,o.useState)(void 0),[u,p]=(0,o.useState)(!1),{isOpen:m,rendered:f,fullScreenNodeRect:v,fullscreenNodeAnimationComplete:y,contentAspectRatio:b,zoomScale:S,panOffset:x,skipAnimations:A,isSaving:M,blockStore:w,panStartPosition:k}=(0,g().K8)((()=>{var e;const{state:t}=Ho().A;return{isOpen:t.isOpen,rendered:null===(e=t.renderFullScreenNode)||void 0===e?void 0:e.call(t),fullScreenNodeRect:t.fullScreenNodeRect,fullscreenNodeAnimationComplete:t.fullscreenNodeAnimationComplete,contentAspectRatio:t.contentAspectRatio,zoomScale:t.zoomScale,panOffset:t.panOffset,skipAnimations:t.skipAnimations,isSaving:Boolean(t.isSaving),blockStore:t.blockStore,panStartPosition:t.panStartPosition}}),[]),j=(0,g().K8)((()=>{const t=e.WindowSizeStore.state.width;return Fo().wX(t)}),[e.WindowSizeStore]);(0,n(388487).A)({capture:m,preventType:ct().A.All});const C=(0,o.useCallback)((()=>{r.current&&clearTimeout(r.current)}),[]),I=(0,o.useCallback)((()=>{p(!0),C(),s||M||(r.current=setTimeout((()=>p(!1)),2e3))}),[C,s,M]),T=(0,o.useCallback)((e=>{I();const t=Math.max(Math.min(e,ei),Jo),n=t<=1?{x:0,y:0}:x;Ho().A.setState({...Ho().A.state,zoomScale:t,panOffset:n})}),[x,I]),_=(0,o.useCallback)((e=>{const t=Ai(e,d);t&&(e.x!==t.x&&(k.x=k.x+(e.x-t.x)),e.y!==t.y&&(k.y=k.y+(e.y-t.y)),Ho().A.setState({...Ho().A.state,panOffset:t,panStartPosition:k}))}),[d,k]),P=(0,o.useCallback)((()=>{l(!1),Ho().A.setState({...Ho().A.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}),[]),L=(0,o.useCallback)((()=>{l(!0),C()}),[C]),R=(0,o.useCallback)((()=>{l(!1),I()}),[I]),D=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Fo().VN(),(0,Eo().d)(e,{type:"close",triggered_by:t?"keypress":"click"}),zo().IU({environment:e}),xi(),Co().default.afterNextFlush((()=>{P()}))}),[e,P]),N=(0,o.useCallback)((e=>{(0,O().Vt)(e)||D()}),[D]),E=(0,o.useCallback)((e=>{if(e.stopPropagation(),(0,O().Vt)(e))return;let t,n;t=S<1?1:S<1.5?1.5:1,n=t<=1?{x:0,y:0}:Ai({x:(window.innerWidth/2-e.clientX)/(t/(t-1)),y:(window.innerHeight/2-e.clientY)/(t/(t-1))},d)??x,Ho().A.setState({...Ho().A.state,zoomScale:t,panOffset:n}),I(),R()}),[d,R,x,I,S]),U=(0,o.useCallback)((function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!w)return;const o=ci();if(!o)return;const i=o.findIndex((e=>e.id===w.id));if(i+t<0||i+t>=o.length)return;(0,Eo().d)(e,{type:t>0?"next":"previous",image_count:o.length,image_index:i+t,triggered_by:n?"keypress":"click"}),Ho().A.setState({...Ho().A.state,skipAnimations:!0}),a.current&&clearTimeout(a.current),a.current=setTimeout((()=>{Ho().A.setState({...Ho().A.state,skipAnimations:!1})}),250);const r=o[i+t];Vo().iy({environment:e,blockStore:r}),P()}),[w,e,P]),F=(0,o.useCallback)((function(){U(-1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[U]),V=(0,o.useCallback)((function(){U(1,arguments.length>0&&void 0!==arguments[0]&&arguments[0])}),[U]),z=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.ceil(2*(S-Xo))/2;S-n<.25&&(n-=Xo),(0,Eo().d)(e,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,S]),K=(0,o.useCallback)((function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=Math.floor(2*(S+Xo))/2;n-S<.25&&(n+=Xo),(0,Eo().d)(e,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),T(n)}),[e,T,S]),W=(0,o.useCallback)((e=>{d&&1===e.buttons&&ui()&&_({x:e.clientX/S-k.x,y:e.clientY/S-k.y})}),[d,k.x,k.y,_,S]),H=(0,o.useCallback)((e=>{switch(e.key){case"+":case"=":K(!0);break;case"-":case"_":z(!0)}}),[K,z]);(0,o.useEffect)((()=>{const e=e=>{T(S+e)},n=t=>{m&&(t.preventDefault(),t.ctrlKey?t.deltaY?e(t.deltaY*ni):t.deltaX&&e(t.deltaX*ni):t.metaKey?t.deltaY?e(t.deltaY*ti):t.deltaX&&e(t.deltaX*ti):ui()&&_({x:x.x-t.deltaX,y:x.y-t.deltaY}))};return m&&(window.addEventListener("wheel",n,{passive:!1}),t.current=!0),()=>{window.removeEventListener("wheel",n),t.current=!1}}),[m,x.x,x.y,_,T,S]);const G=window.innerWidth,Y=window.innerHeight-2*j;let q=G-2*j;const $=b??(v?v.width/v.height:void 0);if(void 0===$)return null;let Q=q/$;if(Q>Y){const e=Q/Y;Q/=e,q/=e}const Z={opacity:0},X={scale:S,opacity:1,translateX:x.x,translateY:x.y,width:"100%",height:"100%"};let J;return J=u?S>=1.5?"zoom-out":"zoom-in":"none",(0,B.jsx)(un().A,{open:m||!y,children:(0,Ko().A)((e=>(0,B.jsx)(pt().A,{debugName:"FullScreenRenderer",capture:m,onEsc:()=>{D(!0)},onEnter:h().D_,onSpace:()=>D(!0),onCommandEnter:()=>D(!0),onCommandShiftEnter:h().D_,onCommandSlash:h().D_,onUp:h().D_,onDown:h().D_,onDelete:h().D_,onBackspace:h().D_,onLeft:()=>F(!0),onRight:()=>V(!0),onUntab:h().D_,onTab:h().D_,onSelectAll:h().D_,onRedo:h().D_,onUndo:h().D_,onToggleBold:h().D_,onToggleItalics:h().D_,onToggleStrike:h().D_,onToggleCode:h().D_,onCut:h().D_,onCopy:h().D_,onPaste:h().D_,onKeypress:H,children:(0,B.jsxs)("div",{style:Mi({isOpen:m,showControls:u}),...e,onClick:N,onMouseMove:I,children:[m?(0,B.jsx)(n(552713).B,{}):void 0,(0,B.jsx)(Go().A,{visible:m,initial:Z,exit:Z,animate:X,skip:A,forceCompositeLayer:!0,style:{display:"flex",cursor:J,maxWidth:q,maxHeight:Q,justifyContent:"center"},ref:e=>{e&&!d&&c({width:e.clientWidth,height:e.clientHeight})},onClick:E,onMouseDown:Si,onMouseUp:xi,onMouseLeave:xi,onMouseMove:W,onAnimationEnd:bi,children:f}),(0,B.jsx)(oi,{visible:u,isOpen:m,zoomScale:S,handleZoomIn:K,handleZoomOut:z,handlePrevious:F,handleNext:V,setZoomScale:T,disableZoomEditing:R,enableZoomEditing:L,clearHideControlsTimeout:C,resetHideControlsTimeout:I,isSaving:M,isEditingZoom:s,handleClose:D})]})})))})};function ci(){const{blockStore:e}=Ho().A.state;if(!e)return[];if(function(){const{blockStore:e}=Ho().A.state;return(null==e?void 0:e.getParentTable())===No().SN}()){return e.getParentStore().getContentStores().filter((e=>"image"===e.getType())).filter((e=>Boolean(e.getProperties().source)))}const t=Gt().default.getCurrentRootStore();return Wo().K.getMembersByDOMOrder({filter:e=>"image"===e.renderedType&&Boolean(e.getBlockStore().findRecordStoreUIAncestor((e=>Boolean(t&&e===t))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function ui(){const{zoomScale:e}=Ho().A.state;return e>1}function pi(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function mi(){return Oo().Ay.white}function gi(){return Oo().Ay.whiteWithAlpha(.5)}function fi(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function hi(e){let{imageIndex:t,totalImageCount:n}=e;return(0,B.jsx)(W().sA,{values:{currentIndex:t+1,totalCount:n},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function vi(e){const{primaryText:t,secondaryText:n}=e;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("span",{style:{marginRight:n?4:void 0},children:t}),n?(0,B.jsx)("span",{style:{color:gi()},children:n}):void 0]})}function yi(){return(0,B.jsx)("span",{style:{borderLeft:`1px solid ${Oo().Ay.whiteWithAlpha(.25)}`,height:"100%"}})}function bi(){const{isOpen:e}=Ho().A.state;e||Ho().A.setState({...Ho().A.state,fullscreenNodeAnimationComplete:!0})}function Si(e){const{panOffset:t,zoomScale:n}=Ho().A.state;Ho().A.setState({...Ho().A.state,panStartPosition:{x:e.clientX/n-t.x,y:e.clientY/n-t.y},skipAnimations:!0})}function xi(){Ho().A.setState({...Ho().A.state,skipAnimations:!1})}function Ai(e,t){if(!t)return;let n,o;n=t.width*ei>window.innerWidth?(t.width*ei-window.innerWidth)/(2*ei):(window.innerWidth-t.width*ei)/(2*ei),o=t.height*ei>window.innerHeight?(t.height*ei-window.innerHeight)/(2*ei):(window.innerHeight-t.height*ei)/(2*ei);return{x:Math.min(Math.max(e.x,-1*n),n),y:Math.min(Math.max(e.y,-1*o),o)}}function Mi(e){const{isOpen:t,showControls:n}=e;return{zIndex:999,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:n?void 0:"none"}}var wi=()=>n(791194),ki=()=>n(448619),ji=()=>n(969197),Ci=()=>n(792002),Ii=()=>n(569777);const Ti=function(){const e=(0,i().v3)(),t=(0,o.useRef)(null),r=(0,o.useCallback)((n=>function(e,t,n){if(!Ii().A.isOpen())return;if(!n.current)return;const o=n.current.getSelection();if(!o)return;const i=Ii().A.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&o.startIndex===i&&o.endIndex===i&&(Bi(t),ki().IV())}(n,e,t)),[e]),a=(0,o.useCallback)((n=>function(e,t,n){if(!n.current)return;const o=n.current.getSelection();if(!o)return;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===o.startIndex&&0===o.endIndex&&(Bi(t),ki().IV(Ii().q.Backward))}(n,e,t)),[e]),s=(0,o.useCallback)((()=>Bi(e)),[e]),l=(0,g().K8)((()=>Ii().A.state),[]),c=(0,g().K8)((()=>function(){if(!Ii().A.isOpen())return;return Ii().A.state.savedTextSelectionRect}()),[]),u=(0,g().K8)((()=>function(){var e;if("editing"!==T().default.state.mode&&!Ii().A.isOpen())return!0;const t=Ii().A.isOpen()?null===(e=(0,M().H7)(Ii().A.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,ji().TL)(t);if(e&&e.isNonEditableState())return!0}const n={[f().Ifu.User]:f().Ifu.User,[f().Ifu.Page]:f().Ifu.Page,[f().Ifu.CustomEmoji]:f().Ifu.CustomEmoji,[f().Ifu.Comment]:f().Ifu.Comment,[f().Ifu.Bot]:f().Ifu.Bot,[f().Ifu.Date]:f().Ifu.Date,[f().Ifu.ExternalObjectInstance]:f().Ifu.ExternalObjectInstance,[f().Ifu.TemporaryPage]:f().Ifu.TemporaryPage,[f().Ifu.TemplateVariable]:f().Ifu.TemplateVariable,[f().Ifu.FormulaPageProperty]:f().Ifu.FormulaPageProperty,[f().Ifu.FormulaContextValue]:f().Ifu.FormulaContextValue,[f().Ifu.Group]:f().Ifu.Group,[f().Ifu.Team]:f().Ifu.Team,[f().Ifu.Citation]:f().Ifu.Citation,[f().Ifu.LinkMention]:f().Ifu.LinkMention,[f().Ifu.AssistantInstructionsCollection]:f().Ifu.AssistantInstructionsCollection,[f().Ifu.Place]:f().Ifu.Place,[f().Ifu.SlackSpecialMention]:f().Ifu.SlackSpecialMention,[f().Ifu.TemporarySearchFilter]:f().Ifu.TemporarySearchFilter,[f().Ifu.TitleOnly]:f().Ifu.TitleOnly};for(const o of Object.values(n))if((0,Ci().y_)(o))return!0;return!1}()),[]);if(!l.open)return null;const p=l.value,m=l.error;return(0,B.jsx)(d().u2,{dependency:n(354584).y,children:e=>l.open?(0,B.jsx)(n(548901).A,{Prism:e,ref:t,isOpen:!0,equationValue:p,error:m,displayMode:"inline",disabled:u,originRect:c,originGap:8,onDismiss:Pi,onChange:_i,onSubmit:s,onLeft:a,onRight:r}):null})};function _i(e,t){Ii().A.isOpen()&&Ii().A.setState({...Ii().A.state,value:e,error:t})}function Pi(){ki().IV()}function Bi(e){b().createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,canUndo:!0,perform:t=>{ki().t5({environment:e,equationStore:Ii().A,transaction:t})}})}var Li=()=>n(813743),Ri=()=>n(728611),Di=()=>n(487494),Ni=()=>n(525112);function Oi(e){switch(e){case Di().A.Preview:return(0,B.jsx)(W().sA,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"});case Di().A.Mention:return(0,B.jsx)(W().sA,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"});case Di().A.Link:return(0,B.jsx)(W().sA,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Link"});default:(0,at().HB)(e)}}const Ei=function(){const e=(0,i().v3)(),t=(0,o.useRef)(null),[n]=(0,g().$y)(Ni().A),r=(0,o.useCallback)((t=>{if(n.open){var o;if(!t)Li().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!1});Ni().A.setState({open:!1})}}),[e,n]),a=(0,o.useCallback)((e=>{n.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&r(void 0)}),[r,n.open]),s=(0,o.useCallback)((e=>{if(!n.open||!e.target)return;const o=t.current;o&&(o.contains(e.target)||r(void 0))}),[r,n.open]);(0,o.useEffect)((()=>((0,Ri().P4)(window,"keydown",a),(0,Ri().P4)(window,"mousedown",s),()=>{(0,Ri().Ol)(window,"keydown",a),(0,Ri().Ol)(window,"mousedown",s)})),[a,s]);const l=(0,o.useRef)(!1);function d(t){var o;n.open&&void 0!==t.indexGlobal&&(Ni().A.setState({...n,focusedIndex:t.indexGlobal}),Li().fS({actionType:t.indexGlobal,environment:e,commentStore:null===(o=n.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0}))}(0,g().K8)((()=>{var t,o;const i=(n.open&&(null===(t=n.args.commentStore)||void 0===t?void 0:t.state)&&(null===(o=n.args.commentStore.state)||void 0===o?void 0:o.isReady()))??!1;var r;i&&!l.current&&n.open&&Li().fS({actionType:n.focusedIndex,environment:e,commentStore:null===(r=n.args.commentStore)||void 0===r?void 0:r.state,useTempStores:!0});l.current=i}),[e,n]);const c=(0,g().K8)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),u=e.device.isMobile;return(0,B.jsx)(x().Ay,{popupType:c?C().n.SlideUp:C().n.Popup,open:n.open,originRect:n.open?n.selectionRect:void 0,placementToOrigin:j().W.Top,alignmentToOrigin:j().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:u,keepFocus:u,render:function(){var o;const{device:i}=e;if(!n.open)return;const r=function(t){const{url:n,args:o}=t,i=[];i.push({title:Oi(Di().A.Preview),validator:()=>!0,type:Di().A.Preview}),i.push({title:Oi(Di().A.Mention),validator:()=>!0,type:Di().A.Mention}),i.push({title:Oi(Di().A.Link),validator:()=>!0,type:Di().A.Link});return[{key:"menu section",render:e=>(0,B.jsx)(Qt().A,{...e}),items:h().oE(i.map((t=>{let{title:i,validator:r,type:a}=t;if(r({url:n,baseUrl:q().A.domainBaseUrl,publicDomainName:q().A.publicDomainName})){return{key:`item ${a}`,render:t=>(0,B.jsx)(Yt().A,{...t,title:i,onMouseEnter:n=>{var i;t.onMouseEnter(n),Li().fS({actionType:a,environment:e,commentStore:null===(i=o.commentStore)||void 0===i?void 0:i.state,useTempStores:!0})}}),action:()=>{var t;return Li().fS({actionType:a,environment:e,commentStore:null===(t=o.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(n),a=i.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Ve().Wy.semibold,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:Ve().Wy.semibold};let s;return s=i.isMobile?{menuType:A().gu.ActionSheet}:{menuType:A().gu.Popup,width:200,maxHeight:"40vh"},null!==(o=n.args.commentStore)&&void 0!==o&&o.state&&n.args.commentStore.state.isReady()?(0,B.jsx)(S().A,{...s,className:Vt().poM,ref:t,header:(0,B.jsx)(on().A,{style:a,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,B.jsx)(W().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,B.jsx)(qt().Ay,{type:qt().Oh.Vertical,sections:r,onKeyboardArrow:d,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,B.jsx)(S().A,{...s,className:Vt().poM,ref:t,header:(0,B.jsx)(on().A,{style:a,isSmall:!i.isMobile,isSecondaryColor:!i.isMobile,children:(0,B.jsx)(W().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,B.jsx)(Qt().A,{style:{display:"flex",justifyContent:"center"},children:(0,B.jsx)(ro().A,{})})})},onDismiss:()=>r(void 0)})};var Ui=()=>n(775812),Fi=(n(672577),()=>n(829300)),Vi=()=>n(536612),zi=()=>n(663038),Ki=()=>n(691298),Wi=()=>n(875497),Hi=()=>n(529183),Gi=()=>n(757695);class Yi extends Gi().Store{getInitialState(){return{formulaTypecheckContextValue:void 0}}}const qi=Yi;var $i=()=>n(375447),Qi=()=>n(472090),Zi=()=>n(278132),Xi=()=>n(743176),Ji=()=>n(247331),er=()=>n(977345),tr=()=>n(380048),nr=()=>n(455971),or=()=>n(603533),ir=()=>n(17022);class rr extends Gi().Store{getInitialState(){}}const ar=new rr;function sr(e){const{isFirefox:t}=(0,i().Y0)();return(0,o.useCallback)((n=>{ir().e.withListenerIgnored((()=>{var o;const i=$i().Ay.state;if(!i.open)return;if(!n)return void i.temporaryInputData.setState(void 0);const{title:r,icon:a,allowTabCompletion:s}=n,l=e.current??"",d=r.toLowerCase().startsWith(l)?i.oldTextValue&&0!==(null===(o=i.oldTextValue)||void 0===o?void 0:o.length)?"":r.slice(l.length):"";ar.setState(s?d:void 0);const c=t?void 0:a;i.temporaryInputData.setState({prefix:i.insertionType,suffix:"[["===i.insertionType&&l.endsWith("]]")?"]]":"",completion:d,prefixIcon:c})}))}),[e,t])}const lr=(0,W().YK)({backButtonAriaLabel:{defaultMessage:"Back",id:"formulaMentionMenu.backButton.ariaLabel"},possessiveContextValueProperty:{defaultMessage:"{contextValueName}'s {propertyName}",id:"formulaMentionMenu.possessiveContextValueProperty.title"}}),dr=o.memo((function(e){const{mentionMenuCurrentFormulaStore:t,queryRef:n}=e,r=(0,g().K8)((()=>(0,or().W)()),[]),a=(0,g().K8)((()=>{const e=t.state.formulaTypecheckContextValue;if(e&&e.kind===Ji().FormulaContextValueKind.ContextValue)return e}),[t]),s=function(e){const{contextValue:t,queryRef:n,setTemporaryInputData:o}=e,r=(0,i().v3)(),a=(0,W().tz)(),s=(0,g().K8)((()=>{if(!t)return;const e=Ft().oc();return e?function(e,t){const n=function(e){if("block"!==e.type.type||!(0,at().O9)(e.type.collection))return;return e.type.collection}(t);if(!n)return;const o=re().md.createChildStore(e,n);return o.getSchema()}(e,t):void 0}),[t]);if(!t||!s)return[];const l=(0,er().sM)(t);return(0,h().oE)(Object.entries(s).map((e=>{let[i,s]=e;if(s&&Ji().FORMULAS_SUPPORTED_COLLECTION_PROPERTY_TYPES.includes(s.type))return{action:e=>{b().createAndCommit({userAction:"FormulaMentionMenu.menuItem",environment:r,canUndo:!0,perform:o=>{const d=(0,f().ESw)({contextValueId:t.id,name:(0,Zi().Nl)(a,l,s.name),property:i,valueSnapshot:"current"});Fi().Ju({annotations:[d],editorMode:"default",environment:r,mentionType:"formulaContextVariable",menuListItemAction:e,query:n.current??"",transaction:o})}})},key:`formula property ${i}`,render:e=>(e.focused&&o({allowTabCompletion:!0,icon:(0,B.jsx)(nr().sL,{}),title:a.formatMessage(lr.possessiveContextValueProperty,{contextValueName:l,propertyName:s.name})}),(0,B.jsx)(Yt().A,{...e,icon:(0,B.jsx)(cr,{children:Xi().LE[s.type]({height:17,width:17})}),title:s.name}))}})))}({contextValue:a,queryRef:n,setTemporaryInputData:sr(n)}),l=function(e){const{contextValue:t,items:n,mentionMenuCurrentFormulaStore:i}=e,r=(0,W().tz)(),a=(0,o.useCallback)((()=>{i.setState({formulaTypecheckContextValue:void 0}),$i().Ay.updateOpenState({showFormulaProperty:!1})}),[i]),s=(0,Ee().IS)((()=>({backButton:{height:20,width:20},backButtonIcon:{width:17},sectionDesktopTitle:{paddingInline:10},titleHeader:{display:"inline-flex",alignItems:"center",gap:2}})),[]);if(0===n.length||!t)return[];const l=(0,er().sM)(t);return[{items:n,key:"formula properties section",render:e=>(0,B.jsx)(Qt().A,{...e,desktopTitleStyle:s.sectionDesktopTitle,title:(0,B.jsxs)("header",{style:s.titleHeader,children:[(0,B.jsx)(qe().A,{ariaLabel:r.formatMessage(lr.backButtonAriaLabel),icon:tr().I,iconStyle:s.backButtonIcon,onClick:a,style:s.backButton}),(0,B.jsx)(W().sA,{defaultMessage:"Property from {contextValueName}",id:"formulaMentionMenu.formulaPropertiesSection.title",values:{contextValueName:l}})]})})}]}({contextValue:a,items:s,mentionMenuCurrentFormulaStore:t});if(!l||0===l.length)return null;const d={menuType:A().gu.Popup,width:r};return(0,B.jsx)(S().A,{...d,children:(0,B.jsx)(qt().Ay,{initialFocus:0,sections:l,type:qt().Oh.Vertical})})}));function cr(e){const{children:t}=e,n=(0,Ee().IS)((()=>({wrapper:{display:"inline-flex",alignItems:"center",justifyContent:"center",height:20,width:20}})),[]);return(0,B.jsx)("div",{style:n.wrapper,children:t})}class ur extends Gi().Store{getInitialState(){return{userId:"",userEmail:"",displayName:""}}}const pr=ur;function mr(e,t){return t?$i().Ay.state.open&&"@"===$i().Ay.state.insertionType&&e.device.isAndroid&&t.startsWith("@")?t.slice(1).trim():$i().Ay.state.open&&"[["===$i().Ay.state.insertionType&&t.endsWith("]]")?t.slice(0,-2).trim():t.trim():""}var gr=()=>n(567141),fr=()=>n(966505),hr=()=>n(766637);function vr(e,t){const n=(0,g().K8)((()=>$i().Ay.getMentionMenuContext()),[]);return(0,o.useCallback)((()=>{let o,i=Date.now();const r=$i().Ay.state;if(r.open&&(i=r.openTime,o=r.flowId),r.open){var a;const s=Date.now(),{numServerRequests:l}=hr().A.state,d=r.sessionId,c=r.showMentionAndShare;gr().sM(e,{timeToAbandonInMs:s-i,analyticsFrom:n,queryLength:(null===(a=t.current)||void 0===a?void 0:a.length)??0,flowId:o,searchSessionId:d,searchSessionFlowNumber:l,stage:c?"share":"user_selection"})}r.open&&r.showInvite&&fr().F$(e,{origin:$i().Ay.getInviteOrigin(),invite_flow_id:r.flowId}),Fi().VN()}),[n,e,t])}function yr(e){let{usePopupOnMobile:t}=e;const n=(0,i().Y0)();return!t&&(n.isMobileNative&&!n.isTablet)}var br=()=>n(963248);function Sr(e){let{clearSavedSelection:t,filter:n}=e;const o=(0,i().v3)(),r=(0,g().O$)($i().Ay),a=(0,g().K8)((()=>(0,or().W)()),[]);if(!r.open)return null;const s="block"===r.textStore.table?r.textStore.id:void 0;return(0,B.jsx)(br().v,{targetBlocks:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{Fi().eh({environment:o,titleText:mr(o,n),clearSavedSelection:t,createInValue:e,menuListItemAction:void 0})},parentBlockId:s,onAutocompleteQueryChange:xr,autocompleteQuery:r.createInQuery,desktopWidth:a,onCancel:Ar})}function xr(e){$i().Ay.updateOpenState({createInQuery:e})}function Ar(){$i().Ay.updateOpenState({showCreateIn:!1,createInQuery:""})}var Mr=()=>n(690490);function wr(e){let{inviteTargetsStore:t,personPropertyInviteStore:n,filter:r}=e;const a=(0,i().v3)(),s=(0,o.useCallback)((()=>kr(a,t,n)),[a,t,n]),l=(0,g().K8)((()=>Ft().ao()),[]),d=(0,g().K8)((()=>$i().Ay.getInviteOrigin()),[]);return l?(0,B.jsx)(Mr().A,{inviteOrigin:d,store:l,onInviteCompleteFn:e=>{if(!e.success)return kr(a,t,n),null;const{invitedUsers:o,requestedUsers:i}=e,s=h().xW(Object.values(o),Object.values(i));s.length?b().createAndCommit({userAction:"MentionMenu.inviteMenu",environment:a,canUndo:!0,perform:e=>{Fi().Ju({environment:a,editorMode:"default",annotations:s.map((e=>(0,f().P4h)(e))),transaction:e,menuListItemAction:void 0,query:mr(a,r),mentionType:"user"})}}):kr(a,t,n)},handleBackButtonClick:s,inviteTargetsStore:t,personPropertyInviteStore:n}):null}function kr(e,t,n){const o=$i().Ay.state;o.open&&(fr().F$(e,{origin:$i().Ay.getInviteOrigin(),invite_flow_id:o.flowId}),t.setState({tokenQuery:"",inviteTargets:[]}),n.setState({...n.state,emailMessage:""}),$i().Ay.updateOpenState({showInvite:!1}))}var jr=()=>n(353147),Cr=()=>n(97835),Ir=()=>n(763884),Tr=()=>n(134696),_r=()=>n(579627),Pr=()=>n(436572),Br=()=>n(574012),Lr=()=>n(773706);function Rr(e){const t=(0,i().v3)(),n=(0,g().K8)((()=>Ft().ao()),[]),{mentionMenuCurrentMentionStore:o,menuPopupType:r}=e,{userId:a,displayName:s,userEmail:l}=(0,g().K8)((()=>o.getState()),[o]),d=(0,g().K8)((()=>Br().A.mobileNativeBottomPadding(t)),[t]),c=(0,g().K8)((()=>$i().Ay.state.open),[]);if(!n)return null;const u={key:"invite buttons",render:e=>(0,B.jsx)(Qt().A,{...e}),items:[{key:"MentionMenu.MentionWithoutSharing",render:e=>(0,B.jsx)(Yt().A,{title:(0,B.jsx)(W().sA,{defaultMessage:"Mention without sharing",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharing"}),caption:(0,B.jsx)(W().sA,{defaultMessage:"Mention {userDisplayName} without sharing this document",id:"mentionMenu.peopleSection.invitePrompt.mentionWithoutSharingCaption",values:{userDisplayName:s}}),icon:(0,jr().b)({width:18}),...e}),action:()=>{b().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Fi().Ju({environment:t,editorMode:"default",annotations:[(0,f().P4h)(a)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_without_share"})}}),Ir().K.set({userId:t.currentUser.id,key:(0,Lr().T)(n.id),value:!0})}},{key:"MentionMenu.MentionAndShare",render:e=>(0,B.jsx)(Yt().A,{title:(0,B.jsx)(W().sA,{defaultMessage:"Mention and share",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShare"}),caption:(0,B.jsx)(W().sA,{defaultMessage:"Grant {userDisplayName} full access",id:"mentionMenu.peopleSection.invitePrompt.mentionAndShareCaption",values:{userDisplayName:s}}),icon:(0,B.jsx)($t().I,{icon:Cr().x}),...e}),action:()=>{b().createAndCommit({userAction:"MentionMenu.menuItem",environment:t,canUndo:!0,perform:e=>{Fi().Ju({environment:t,editorMode:"default",annotations:[(0,f().P4h)(a)],transaction:e,menuListItemAction:void 0,query:"",mentionType:"user",shareMenuSelection:"mention_and_share"})}}),b().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission",environment:t,canUndo:!0,perform:e=>{_r().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"editor",user_id:a}],pagePermissionChangeLocation:"mention_share_menu"})}}),Tr().Jg(t,{role:"editor",is_space:!1,invite_targets:[{type:"existingUser",value:{id:a,version:0,email:l}}],is_onboarding:!1,invite_origin:"mention_menu",permission_items:[{type:"user_permission",role:"editor",user_id:a}],invite_message_length:0}),Pr().rL({item:{label:(0,B.jsx)(W().sA,{id:"mentionMenu.mentionShareMenu.mentionAndShare.snackbarMessage",defaultMessage:"Successfully granted {user} full access",values:{user:s}})},undoFunc:()=>b().createAndCommit({userAction:"MentionAndInviteUserComponent.setPermission.undoShare",environment:t,canUndo:!0,perform:e=>{_r().zP({environment:t,transaction:e,store:n,permissionItems:[{type:"user_permission",role:"none",user_id:a}],pagePermissionChangeLocation:"mention_share_menu"})}})})}}]},p=r===A().gu.ActionSheet?{menuType:A().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${d}px)`}:{menuType:A().gu.Popup};return(0,B.jsxs)(S().A,{...p,children:[(0,B.jsx)(pt().A,{debugName:"MentionMenu",capture:c}),(0,B.jsx)(qt().Ay,{type:qt().Oh.Vertical,initialFocus:0,sections:[u]})]})}const Dr=(0,W().YK)({noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"}}),Nr=(0,W().YK)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"}}),Or=o.memo((function(e){const{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:r,mentionMenuCurrentMentionStore:a,mentionMenuCurrentFormulaStore:s}=e;return(0,B.jsx)(Er,{query:t,queryRef:n,clearSavedSelection:o,inviteTargetsStore:i,personPropertyInviteStore:r,mentionMenuCurrentMentionStore:a,mentionMenuCurrentFormulaStore:s})}));function Er(e){let{query:t,queryRef:r,clearSavedSelection:a,inviteTargetsStore:s,personPropertyInviteStore:l,mentionMenuCurrentMentionStore:d,mentionMenuCurrentFormulaStore:c}=e;const u=(0,W().tz)(),p=(0,i().v3)(),m=(0,g().O$)($i().Ay),f=(0,g().O$)(n(227440).e),h=Boolean(m.open&&m.usePopupOnMobile),v=sr(r),y=(0,n(756436).p)({clearSavedSelection:a,query:t,inviteTargetsStore:s,personPropertyInviteStore:l,mentionMenuCurrentMentionStore:d,mentionMenuCurrentFormulaStore:c,setTemporaryInputData:v}),b=(0,n(575301).o_)();(0,o.useEffect)((()=>{if(!f)return;const e=m.mentionTypes.user,t=m.mentionTypes.page,o=m.mentionTypes.date;let i="";e&&t&&o?i=u.formatMessage(Nr.mentionAll):e&&t?i=u.formatMessage(Nr.mentionPersonPage):e&&o?i=u.formatMessage(Nr.mentionPersonDate):t&&o?i=u.formatMessage(Nr.mentionPageDate):e?i=u.formatMessage(Nr.mentionPerson):o?i=u.formatMessage(Nr.mentionDate):t&&m&&(i=m.open&&"+"===m.insertionType?u.formatMessage(n(653475).D.addPage):u.formatMessage(Nr.mentionPage)),v({title:i,icon:(0,B.jsx)(nr().gf,{insertionType:m.open?m.insertionType:"+"}),allowTabCompletion:!1})}),[f,v,u,m]);const x=(0,Ee().IS)((e=>({offlineMessage:{display:"flex",gap:4,alignItems:"center",background:e.surface.wash,borderRadius:4,padding:"8px 12px",margin:"12px 12px 0"},offlineIcon:{height:18,width:18,fill:e.icon.secondary}})),[]);let M;f||(M=(0,B.jsxs)("div",{style:x.offlineMessage,children:[(0,n(553034).C)(x.offlineIcon),(0,B.jsx)(on().A,{isSmall:!0,isMobile:q().A.isMobile,showTooltipWhenTruncated:!0,children:(0,B.jsx)(W().sA,{defaultMessage:"Offline: Connect to see all options",id:"mentionMenu.offlineMessage"})})]}));const{device:w}=p,k=(0,g().K8)((()=>(0,or().W)()),[]),j=vr(p,r);let C;C=yr({usePopupOnMobile:h})?{menuType:A().gu.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${b}px)`}:{menuType:A().gu.Popup,width:k,maxHeight:w.isMobile?"30vh":"40vh",onClickOutside:j};const I=(0,o.useCallback)((e=>{(function(e){return""===e})(r.current??"")&&(e.preventDefault(),j())}),[r,j]);return(0,B.jsxs)(S().A,{...C,header:M,children:[(0,B.jsx)(pt().A,{debugName:"MentionMenu",capture:m.open,onBackspace:I}),(0,B.jsx)(qt().Ay,{type:qt().Oh.Vertical,initialFocus:0,sections:y,onEmptyEnter:j,resetInitialFocusOnSectionChange:!0,performHandleEnterOnTab:!0}),0===y.length&&(0,B.jsx)(Qt().A,{children:(0,B.jsx)(n(64e3).A,{title:(0,B.jsx)(W().sA,{...Dr.noResults})})})]})}function Ur(){const e=(0,i().v3)(),t=(0,g().O$)($i().Ay),n=t.open&&t.showCreateIn,r=t.open&&t.showInvite,a=t.open&&t.showMentionAndShare,s=t.open&&t.showFormulaProperty,l=Boolean(t.usePopupOnMobile),d=(0,g().uB)(void 0,Hi().Ay),c=(0,g().uB)(void 0,Wi().A),u=(0,g().uB)(void 0,pr),p=(0,g().uB)(void 0,qi),m=(0,g().K8)((()=>{if(t.open)return w().aX(t.textStore,t.oldTextValue,t.isEmptyPageTitle?"":t.insertionType)}),[t]),f=(0,g().K8)((()=>{if(m&&t.open)return w().mX(t.textStore,m)}),[m,t]),h=(0,g().K8)((()=>mr(e,f)),[e,f]),v=(0,o.useRef)(h);(0,o.useEffect)((()=>{v.current=h}),[h]);const y=(0,g().K8)((()=>!!t.open&&("+"!==t.insertionType||""!==h)),[h,t]),b=(0,g().K8)((()=>Ft().ao()),[]),S=y&&(b&&(n||r)||a),{clearSavedSelection:k,getSavedSelection:I}=(0,Ki().A)({shouldPreserveTextSelection:S,shouldPreserveBlockSelection:!1,shouldRestoreSelection:S});(0,o.useEffect)((()=>{const e=$i().Ay.state;if(e.open){var t;const n=T().default.state,o="editing"===n.mode?(0,M().H7)(n.multiSelection):void 0,i=(null==o?void 0:o.store)===e.textStore,r=I().textSelectionState,a=r&&"editing"===r.mode&&(null===(t=(0,M().H7)(r.multiSelection))||void 0===t?void 0:t.store)===e.textStore;if(!i&&!a)return void Fi().VN();const s=i&&(null==o?void 0:o.selection);if(m&&s&&(s.startIndex<m.filter.startIndex||s.endIndex>m.filter.endIndex))return void Fi().VN();const l=f&&f[0];if("+"===e.insertionType&&l&&!(0,zi().D$)(l))return void Fi().VN();if("@"===e.insertionType&&l&&(0,zi().Yv)(l))return void Fi().VN();if(void 0===f&&!e.isEmptyPageTitle)return void Fi().VN()}}),[f,I,m]);const{device:_}=e,[P,L]=(0,o.useState)(void 0),R=Vi().A.getSize(),D=(0,g().K8)((()=>{if(_.isMobile&&0!==R)return Vi().A.find((e=>e.isCaptured()))}),[_,R]);(0,o.useEffect)((()=>{const e=null==D?void 0:D.getNode();if(e){const t=new(Qi().E);return t.observe(e),t.rect.addListener((e=>{L({height:`calc(100vh - ${e.state.height}px)`})})),()=>t.destroy()}}),[D]);const N=yr({usePopupOnMobile:l}),O=N?C().n.SlideUp:C().n.Popup,E=vr(e,v);return(0,B.jsx)(x().Ay,{popupType:O,open:y,originRect:t.open?t.selectionRect?{...t.selectionRect,left:t.selectionRect.left-22}:t.selectionRect:void 0,slideUpWrapStyle:P,placementToOrigin:j().W.Bottom,alignmentToOrigin:j().C.Start,originGap:12,disableMouseCapture:!r,disableContentScroll:!0,onDismiss:E,disableDarkOverlayBackground:_.isMobile,keepFocus:!0,trapFocus:!1,render:()=>_.isMobile?(0,B.jsxs)(B.Fragment,{children:[!a&&(0,B.jsx)(Or,{query:h,queryRef:v,clearSavedSelection:k,inviteTargetsStore:d,personPropertyInviteStore:c,mentionMenuCurrentMentionStore:u,mentionMenuCurrentFormulaStore:p}),(0,B.jsx)(x().Ay,{popupType:C().n.SlideUp,render:()=>(0,B.jsx)(Sr,{clearSavedSelection:k,filter:f}),open:n,keepFocus:!0,trapFocus:!1}),(0,B.jsx)(x().Ay,{popupType:C().n.SlideUp,render:()=>(0,B.jsx)(wr,{inviteTargetsStore:d,personPropertyInviteStore:c,filter:f}),open:r,keepFocus:!0,trapFocus:!1}),(0,B.jsx)(x().Ay,{popupType:O,render:()=>(0,B.jsx)(Rr,{mentionMenuCurrentMentionStore:u,menuPopupType:N?A().gu.ActionSheet:A().gu.Popup}),open:a,keepFocus:!0,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:P,placementToOrigin:j().W.Bottom,alignmentToOrigin:j().C.Start,originGap:12,isFullWidthOnMobile:!0,trapFocus:!1}),(0,B.jsx)(x().Ay,{keepFocus:!0,open:s,popupType:C().n.SlideUp,render:()=>(0,B.jsx)(dr,{mentionMenuCurrentFormulaStore:p,queryRef:v}),trapFocus:!1})]}):n?(0,B.jsx)(Sr,{clearSavedSelection:k,filter:f}):r?(0,B.jsx)(wr,{inviteTargetsStore:d,personPropertyInviteStore:c,filter:f}):a?(0,B.jsx)(Rr,{mentionMenuCurrentMentionStore:u,menuPopupType:A().gu.Popup}):s?(0,B.jsx)(dr,{mentionMenuCurrentFormulaStore:p,queryRef:v}):(0,B.jsx)(Or,{query:h,queryRef:v,clearSavedSelection:k,inviteTargetsStore:d,personPropertyInviteStore:c,mentionMenuCurrentMentionStore:u,mentionMenuCurrentFormulaStore:p})})}var Fr=()=>n(415651),Vr=()=>n(490884),zr=()=>n(559926),Kr=()=>n(209660),Wr=()=>n(812182),Hr=()=>n(755199),Gr=()=>n(680074),Yr=()=>n(522094);const qr={...Vr().k2,csv:[...Vr().k2.csv,"text/csv"]},$r=Vr().fF.filter((e=>["csv","docx","html","txt","markdown","pdf"].includes(e)));function Qr(e){return Object.keys(qr).includes(e)}function Zr(e){var t;const{type:n,environment:o}=e,i=function(e){for(const t of Object.keys(qr)){if(!Qr(t))continue;const n=qr[t];if((Array.isArray(n)?n.flat(1/0):[n]).includes(e))return t}}(n);if(!i||"string"!=typeof n||!$r.includes(i))return;const r=(0,Gr().R$)(o),a=null==r||null===(t=r.getSettings())||void 0===t?void 0:t.adoption_entry_points,s=a?null==a?void 0:a.import_nudge_on_drag:void 0;if(s&&s.length>0)return;oe().default.checkGate({gateName:"contextualized_import_entrypoints"})&&((0,oo().t)({environment:o,action:"view",from:"import_nudge_on_drag"}),Wr().Iz({message:Kt().A.formatMessage(Xr.triggerNudgeOnDragDescription),presentationType:"transient",id:"nudge-on-drag",title:Kt().A.formatMessage(Xr.triggerNudgeOnDragTitle),onUserDismiss:()=>{(0,oo().t)({environment:o,action:"dismiss",from:"import_nudge_on_drag"})},onDismiss:()=>{Hr().pr(o,{entryPoint:"import_nudge_on_drag"})},actions:{primary:{title:Kt().A.formatMessage(Xr.triggerNudgeOnDragPrimaryAction),onAction:()=>{const e=Yr().A.getOrCreateFlowId();(0,oo().t)({environment:o,action:"click",from:"import_nudge_on_drag"}),zr().kY(o,{from:"import_nudge_on_drag",flowId:e}),Wr().UW("nudge-on-drag"),Kr().Ow({currentTab:"imports",openedFrom:"import_nudge_on_drag",subtab:i})}}}}))}const Xr=(0,W().YK)({triggerNudgeOnDragTitle:{id:"adoption.nudgeOnDrag.title",defaultMessage:"Try importing your file"},triggerNudgeOnDragDescription:{id:"adoption.nudgeOnDrag.description",defaultMessage:"You can import this file to directly edit your content in a Notion database"},triggerNudgeOnDragPrimaryAction:{id:"adoption.nudgeOnDrag.primaryAction",defaultMessage:"Import now"}});const Jr=function(){const e=(0,i().v3)(),t=(0,o.useRef)(void 0);return(0,o.useEffect)((()=>{const n=t=>{var n;if(null!==(n=t.dataTransfer)&&void 0!==n&&n.types.includes("application/x.notion.tab-id"))return t.dataTransfer.dropEffect="move",void t.preventDefault();t.preventDefault(),function(e,t){const n=Fr().v7(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0});n&&zo().IU({environment:t})}(t,e),o(t)},o=h().nF((n=>{t.current&&window.clearTimeout(t.current),t.current=window.setTimeout(ta,function(e){const{device:t}=e;if(t.isLinux)return 2e3;if(t.isIOS&&oe().default.checkGate({gateName:"ios_native_drag_handler_delay"}))return 1e3;return 200}(e),e),Fr().GB(e,{currentX:n.clientX,currentY:n.clientY})}),ea),i=t=>{!function(e,t){var n;e.preventDefault();const o=Array.from((null===(n=e.dataTransfer)||void 0===n?void 0:n.files)||[]);o.length>0&&(Zr({environment:t,type:o[0].type}),Fr().b({environment:t,files:o,analyticsFrom:"native_drag"}))}(t,e)};return window.addEventListener("dragover",n),window.addEventListener("drop",i),()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",i)}}),[e]),null},ea=62.5;function ta(e){Fr().Pt(e)}var na=()=>n(857783),oa=()=>n(211716),ia=()=>n(906537),ra=()=>n(35392);const aa=function(){const e=(0,i().v3)(),t=(0,g().K8)((()=>{const e=T().default.state;if("editing"!==e.mode)return null;const t=(0,M().H7)(e.multiSelection);if(!t)return null;const{store:n,selection:o}=t;if(o.endIndex!==o.startIndex+1)return null;const i=n.getValue(),r=f().ANx(i,o.startIndex);if(!r||!f().rjO(r))return null;const[a]=f().N5L([r]);return{pageId:a,store:n}}),[]),n=(0,o.useCallback)((()=>(0,B.jsx)(sa,{pageMentionTokenStoreState:t})),[t]);if(e.device.isMobile)return null;const r=ia().getSelectionRect();return(0,B.jsx)($e().A,{render:()=>{},renderTooltip:n,originRect:r,forceVisibleState:Boolean(t&&r),placement:j().W.Bottom})};function sa(e){let{pageMentionTokenStoreState:t}=e;const n=(0,Ee().DP)(),r=(0,i().v3)(),a=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault();const r=re().Bv.createChildStore(i,{table:En().ev,id:o});na().uK({store:r,environment:t,visitType:oa().ig.Link,openInNew:"tab",pageVisitSource:F().y8.MentionInPage})}(e,r,t)),[r,t]),s=(0,o.useCallback)((e=>function(e,t,n){if(!n)return;const{pageId:o,store:i}=n;if(!o)return;e.preventDefault&&e.preventDefault();const r=re().Bv.createChildStore(i,{table:En().ev,id:o});na().uK({store:r,environment:t,visitType:oa().ig.Link,pageVisitSource:F().y8.MentionInPage})}(e,r,t)),[r,t]);return(0,B.jsx)(pt().A,{debugName:"PageMentionOverlay",capture:!0,onEnter:s,onCommandEnter:a,children:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(W().sA,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,B.jsx)("div",{children:(0,B.jsx)(ra().A,{onlyShowFirst:!0,name:"enter",style:{color:n.text.contrastSecondary}})})]})})}var la=()=>n(569577),da=()=>n(315957),ca=()=>n(46986);function ua(){const e=(0,W().tz)(),t=(0,Ee().DP)(),n=(0,i().v3)(),r=(0,ca().x6)(),{device:a}=n,s=(0,g().K8)((()=>da().A.state.blockStore),[]),l=(0,g().K8)((()=>null==s?void 0:s.getTitleStore()),[s]),d=(0,g().K8)((()=>(null==s?void 0:s.canEdit())??!1),[s]),c=(0,g().K8)((()=>{var t;return(null==s||null===(t=s.getModel())||void 0===t?void 0:t.getEmptyTitlePlaceholder({getRecordModel:s.getRecordModel,userTimeZone:(0,V().P)(),intl:e,isWorkflowsContainerWithCreationEnabled:r}))??""}),[s,e,r]);if((0,o.useEffect)((()=>{const{blockStore:e}=da().A.state;if(!e)return;const t=e.getTitleStore();t&&Ke().selectAllText({environment:n,store:t,canSelectAllBlocks:!1})}),[n]),!s||!l)return null;let u;return u=a.isMobile?{menuType:A().gu.ActionSheet}:{menuType:A().gu.Popup,width:380},(0,B.jsx)(S().A,{...u,children:(0,B.jsx)("div",{style:ma(t),children:(0,B.jsx)(Qe().A,{store:l,disabled:!d,onEsc:()=>la().V(n),onEnter:()=>la().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:c,style:ga(t),pasteBehavior:"inline",inPageFind:He().Os.none})})})}const pa=function(){const e=(0,i().v3)(),{device:t}=e,{blockStore:n,originRect:o}=(0,g().K8)((()=>{const{blockStore:e,originRect:t}=da().A.state;return{blockStore:e,originRect:t}}),[]);return(0,B.jsx)(x().Ay,{popupType:t.isMobile?C().n.SlideUp:C().n.Popup,open:Boolean(n),originRect:o,placementToOrigin:j().W.Bottom,alignmentToOrigin:j().C.Center,originGap:4,onDismiss:()=>la().V(e),render:()=>(0,B.jsx)(ua,{}),trapFocus:!0})};function ma(e){return{display:"flex",alignItems:"center",color:e.text.primary,fontSize:"13px",padding:"4px 8px"}}function ga(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}var fa=()=>n(735384),ha=()=>n(246826),va=()=>n(898286),ya=()=>n(270710),ba=()=>n(187820);function Sa(e){const t=(0,W().tz)(),n=(0,i().v3)(),{device:r}=n,a=(0,ca().x6)(),s=(0,g().K8)((()=>ya().A.state.clonedBlockStore),[]),l=(0,g().K8)((()=>null==s?void 0:s.getTitleStore()),[s]),d=(0,g().K8)((()=>(null==s?void 0:s.canEdit())??!1),[s]),c=(0,g().K8)((()=>{var e;if(s)return null===(e=s.getModel())||void 0===e?void 0:e.getEmptyTitlePlaceholder({getRecordModel:s.getRecordModel,userTimeZone:(0,V().P)(),intl:t,isWorkflowsContainerWithCreationEnabled:a})}),[s,t,a]);(0,o.useEffect)((()=>{if(!s)return;const e=s.getTitleStore();e&&Ke().selectAllText({environment:n,store:e,canSelectAllBlocks:!1})}),[s,n]);const u=(0,Ee().IS)((e=>({wrapper:{display:"flex",alignItems:"center",color:e.text.primary,fontSize:"13px",padding:"4px 8px"},input:{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}})),[]);if(!s||!l)return null;const{renderDelete:p}=e;let m;return m=r.isMobile?{menuType:A().gu.ActionSheet}:{menuType:A().gu.Popup,width:380},(0,B.jsx)(S().A,{...m,children:(0,B.jsxs)("div",{style:u.wrapper,children:[(0,B.jsx)(wa,{blockStore:s}),(0,B.jsx)(Qe().A,{store:l,disabled:!d,onEsc:()=>va().V(n),onEnter:()=>va().V(n),onTab:()=>!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:c,style:u.input,pasteBehavior:"inline",inPageFind:He().Os.none}),p&&d&&(0,B.jsx)(Aa,{})]})})}const xa=function(){const e=(0,i().v3)(),{device:t}=e,{clonedBlockStore:n,originRect:o}=(0,g().K8)((()=>{const{clonedBlockStore:e,originRect:t}=ya().A.state;return{clonedBlockStore:e,originRect:t}}),[]);return(0,B.jsx)(x().Ay,{popupType:t.isMobile?C().n.SlideUp:C().n.Popup,open:Boolean(n),originRect:o,placementToOrigin:j().W.Bottom,alignmentToOrigin:j().C.Center,originGap:4,onDismiss:()=>va().V(e),render:()=>(0,B.jsx)(Ma,{}),trapFocus:!0})};function Aa(){const e=(0,i().v3)(),t=(0,W().tz)();return(0,B.jsx)(qe().A,{ariaLabel:t.formatMessage({id:"renamePageMenu.deleteButton.ariaLabel",defaultMessage:"Delete"}),icon:e=>(0,fa().I)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,color:"primary",showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=ya().A.state;t&&await Vo().Af({environment:e,blocks:[t],shouldCheckSuggestEdit:!0}),va().V(e)}})}function Ma(){const e=(0,g().K8)((()=>ya().A.state.renderDelete),[]);return(0,B.jsx)(Sa,{renderDelete:Boolean(e)})}function wa(e){let{blockStore:t}=e;const n=(0,Ee().DP)(),o=(0,i().v3)(),r={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${n.darkDividerColor}`},a=(0,g().K8)((()=>t.canEdit()),[t]),s=(0,g().K8)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),l=(0,g().K8)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.id}),[t]),d=(0,g().K8)((()=>t.getIcon()),[t]),c=(0,g().K8)((()=>t.isEmptyPage()),[t]),u=(0,g().K8)((()=>t.getType()),[t]),p=(0,g().K8)((()=>(0,ba().Te)(t)),[t]);return a?(0,B.jsx)(ba().B6,{disabled:!1,bucket:"secure",store:t,icon:d,iconRecordCategory:p,isEmptyPage:c,size:18,style:r,iconLoggingData:{recordTable:s,source:"breadcrumb",block_type:u,collection_id:"collection"===s?l:void 0},onChange:e=>function(e,t){const{clonedBlockStore:n}=ya().A.state;if(n){const o=n.getIconStore();o&&b().createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,canUndo:!0,perform:t=>{ha().KY({store:o,value:e,transaction:t})}})}}(e,o)}):(0,B.jsx)(ba().B6,{disabled:!0,icon:d,iconRecordCategory:p,isEmptyPage:c,size:18,style:r})}n(823215);var ka=()=>n(792485),ja=()=>n(713998);const Ca=(0,Po().wt)("bold",{viewBox:"0 0 16 16",svg:(0,B.jsx)("g",{children:(0,B.jsx)("path",{d:"M5.067 13.014c-.772 0-1.223-.451-1.223-1.238V4.36c0-.786.45-1.237 1.223-1.237h3.5c1.949 0 3.131.943 3.131 2.488 0 1.1-.793 1.97-1.948 2.12v.061c1.401.068 2.4 1.046 2.4 2.386 0 1.716-1.347 2.837-3.466 2.837H5.067zm1.238-5.81h1.34c1.025 0 1.633-.459 1.633-1.225 0-.738-.553-1.168-1.483-1.168h-1.49v2.392zm0 4.142h1.6c1.148 0 1.742-.472 1.742-1.347 0-.854-.642-1.32-1.804-1.32H6.305v2.667z"})})});var Ia=()=>n(668725),Ta=()=>n(815883),_a=()=>n(339764);const Pa=(0,Po().wt)("italic",{viewBox:"0 0 16 16",svg:(0,B.jsx)("g",{children:(0,B.jsx)("path",{d:"M5.02 13.014c-.397 0-.67-.24-.67-.63 0-.382.266-.614.663-.614H6.42l1.593-7.404H6.612c-.396 0-.67-.239-.67-.629 0-.383.267-.615.663-.615h4.382c.397 0 .663.232.663.615 0 .39-.273.63-.67.63H9.586l-1.6 7.403h1.409c.396 0 .663.232.663.615 0 .39-.274.629-.67.629H5.02z"})})});var Ba=()=>n(657222);const La=(0,Po().wt)("strikethrough",{viewBox:"0 0 16 16",svg:(0,B.jsx)("g",{children:(0,B.jsx)("path",{d:"M7.973 13.191a5.695 5.695 0 01-1.75-.253 3.694 3.694 0 01-1.306-.71 2.376 2.376 0 01-.71-1.101 1.514 1.514 0 01-.062-.424c0-.205.061-.369.184-.492a.71.71 0 01.513-.185c.155 0 .28.034.376.103a.92.92 0 01.273.328c.128.296.31.554.547.772.237.215.52.379.848.493.328.114.69.17 1.087.17.45 0 .847-.066 1.19-.198.345-.136.614-.321.806-.553.196-.237.294-.506.294-.807 0-.383-.15-.688-.451-.916-.301-.232-.796-.43-1.484-.595L7.043 8.53c-.939-.21-1.636-.528-2.092-.957-.451-.433-.677-.998-.677-1.695 0-.574.158-1.082.472-1.524.32-.443.757-.787 1.313-1.033.556-.25 1.191-.376 1.907-.376.601 0 1.148.09 1.64.267.497.173.91.415 1.238.725.328.31.547.67.656 1.08a.82.82 0 01.034.177c.01.055.014.11.014.164a.625.625 0 01-.185.472c-.123.119-.29.178-.499.178-.287 0-.506-.132-.656-.397a2.244 2.244 0 00-.506-.745 1.98 1.98 0 00-.752-.458 2.897 2.897 0 00-.984-.157c-.406 0-.766.064-1.08.191a1.742 1.742 0 00-.745.527 1.233 1.233 0 00-.267.78c0 .36.148.648.444.867.301.214.784.399 1.45.554l1.169.267c1.016.227 1.756.553 2.221.977.47.42.704.998.704 1.736 0 .611-.162 1.147-.485 1.607-.32.456-.77.809-1.354 1.06-.578.25-1.262.375-2.05.375zM2.552 8.386a.363.363 0 01-.267-.11.378.378 0 01-.11-.266c0-.1.037-.187.11-.26a.352.352 0 01.267-.116h10.89c.104 0 .193.039.266.116.073.073.11.16.11.26s-.037.189-.11.266a.363.363 0 01-.267.11H2.551z"})})}),Ra=(0,Po().wt)("underline",{viewBox:"0 0 16 16",svg:(0,B.jsx)("g",{children:(0,B.jsx)("path",{d:"M8 13.191c-.843 0-1.572-.152-2.188-.458a3.46 3.46 0 01-1.421-1.292c-.333-.551-.5-1.191-.5-1.92V3.724c0-.242.071-.431.213-.568.14-.141.33-.212.567-.212.246 0 .44.071.58.212.147.137.22.326.22.568v5.653c0 .488.098.914.294 1.278.2.36.49.64.868.841.378.2.834.3 1.367.3.798 0 1.417-.22 1.86-.662.446-.442.67-1.028.67-1.757V3.724c0-.242.07-.431.211-.568.142-.141.33-.212.568-.212.246 0 .44.071.58.212.147.137.22.326.22.568V9.52c0 .729-.167 1.369-.5 1.92-.332.552-.809.982-1.428 1.292-.616.306-1.342.458-2.181.458zm-3.623 2.174a.487.487 0 01-.349-.136.464.464 0 01-.136-.342c0-.137.045-.25.136-.342a.487.487 0 01.349-.137h7.24c.14 0 .257.046.348.137a.453.453 0 01.143.342c0 .136-.048.25-.143.341a.472.472 0 01-.349.137H4.377z"})})});var Da=()=>n(519831),Na=()=>n(843005),Oa=()=>n(741496),Ea=()=>n(21869),Ua=()=>n(332751);function Fa(e){const{clientSkill:t}=e,n=(0,W().tz)(),o=(0,g().K8)((()=>n.formatMessage(t.displayName)),[t,n]);return(0,B.jsx)(B.Fragment,{children:o})}var Va=()=>n(602098);function za(e){if(e.inMemoryRecordCache.isMockTextStore){const t=e.getRecordStoreAtRootPath();if(t.table===En().ev){if("automation_id"in t.getProperties())return!0}}return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof re().bx||e instanceof re().dn)).ancestor)}var Ka=()=>n(704152);function Wa(e){const t=(0,i().v3)(),{isMobile:r}=(0,i().Y0)(),a=(0,o.useRef)(null),s=async()=>{const o=T().default.state;if("empty"===o.mode)return;const i=await n(862292).T.formulas.load();n(441467).of({environment:t,blockStore:e.blockStore,multiSelection:o.multiSelection,formulasModule:i})};return(0,B.jsx)($e().A,{renderTooltip:()=>(0,B.jsx)("div",{children:(0,B.jsx)(W().sA,{defaultMessage:"React to selected text",id:"inlineReactionButton.tooltip"})}),render:t=>(0,B.jsxs)(Ka().A,{ref:a,style:{display:"flex",justifyContent:"center",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",...e.style},disabled:e.disabled,disabledFeedback:e.disabled,onClick:s,...t,children:[(0,n(350124).s)({width:r?22:20,height:r?22:20,marginTop:r?0:1,marginRight:e.iconOnly?0:4}),!r&&!e.iconOnly&&(0,B.jsx)(W().sA,{defaultMessage:"React",id:"inlineReactionButton.reactLabel"})]})})}Wa.displayName="InlineReactionButton";const Ha=Wa;var Ga=()=>n(755206),Ya=()=>n(553965),qa=()=>n(962845),$a=()=>n(478726),Qa=()=>n(494043),Za=()=>n(441199),Xa=()=>n(397248),Ja=()=>n(430483),es=()=>n(337567),ts=()=>n(77246),ns=()=>n(195613),os=()=>n(396831),is=()=>n(285288),rs=()=>n(170722),as=()=>n(369241),ss=()=>n(496889),ls=()=>n(452558),ds=()=>n(406699),cs=()=>n(720263),us=()=>n(880922),ps=()=>n(473227);function ms(e){const t=(0,i().v3)(),{isMobile:n}=(0,i().Y0)(),r=(0,g().K8)((()=>"suggest"===ts().Uv.getMode(e.blockStore)),[e.blockStore]),a=()=>{const n=e.blockStore.getRecordStoreUIRoot();n&&n instanceof re().Bv&&n.isNavigableBlock()&&ps().PD({environment:t,navigableBlockStore:n,mode:r?"default":"suggest",location:"rich_text_menu"})},s=(0,Ee().IS)((t=>({button:{display:"flex",alignItems:"center",padding:e.iconOnly?6:"0 10px",whiteSpace:"nowrap",color:r?t.blueColor:t.icon.primary,...e.style},icon:{width:n?18:16,height:n?18:16,marginTop:n?0:1,marginRight:e.iconOnly?0:4}})),[n,r,e.iconOnly,e.style]);return(0,B.jsx)($e().A,{renderTooltip:()=>(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)("div",{children:r?(0,B.jsx)(W().sA,{defaultMessage:"Turn off suggesting",id:"inlineSuggestButton.tooltipDisable"}):(0,B.jsx)(W().sA,{defaultMessage:"Suggest edits",id:"inlineSuggestButton.tooltipEnable"})}),(0,B.jsx)("div",{})]}),render:t=>(0,B.jsxs)(Ka().A,{style:s.button,disabled:e.disabled,disabledFeedback:e.disabled,onClick:a,...t,children:[(0,us().A)(s.icon),!n&&!e.iconOnly&&(r?(0,B.jsx)(W().sA,{defaultMessage:"Suggesting",id:"inlineSuggestButton.suggestingLabel"}):(0,B.jsx)(W().sA,{defaultMessage:"Suggest",id:"inlineSuggestButton.suggestLabel"}))]})})}var gs=()=>n(236228),fs=()=>n(777849),hs=()=>n(780243);function vs(){var e;if(!(0,se().X)("selectable_word_count"))return null;const t=null===(e=ia().get())||void 0===e?void 0:e.cloneContents(),n=t?ys(t):0;return 0===n?null:(0,B.jsx)("div",{style:{justifyContent:"center",alignSelf:"center",whiteSpace:"pre-wrap",padding:"0px 6px"},children:(0,B.jsx)(W().sA,{id:"richTextMenu.wordCount",defaultMessage:"{count, plural, one {# word} other {# words}}",values:{count:n}})})}function ys(e){if(0===e.childNodes.length)return 0;let t=0;for(let n=0;n<e.childNodes.length;n++){const o=e.childNodes[n];o.childNodes.length>0?t+=ys(o):o.textContent&&(t+=(0,We().sQ)(o.textContent))}return t}const bs={[rt().xd.button]:new Set(["showActionButton","showCompletions","showDiscuss","showReact","showSuggest","showTurnInto"]),[rt().xd.code]:new Set(["showCode","showCompletions"]),[rt().xd.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[rt().xd.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},Ss={[rt().xd.factory]:!0};const xs=function(){const e=(0,ka().S)(),t=(0,i().v3)(),r=(0,i().Y0)(),a=(0,g().O$)(rs().A),{isActive:s,blockTarget:l,isAnimatingClosed:d}=a,c=(0,g().O$)(ne().AppStoreMainEditorCurrentBlockStore),u=(0,g().K8)((()=>Ja().zD.isRichTextMenuSuggestionEnabled()),[]),p=(0,g().K8)((()=>{var e;return"slack_notification"===(null===(e=n(217827).A.getState().automationActionStore)||void 0===e?void 0:e.getType())}),[]),[m,f]=(0,o.useState)(void 0),v=(0,o.useCallback)((()=>{var e;if(!u||!c)return;const n=(0,Rt().filterAndRankAssistantSurfaceActionsForContext)((0,Rt().clientSkillToAssistantSurfaceAction)((0,Dt().getAllClientSkills)({currentPageRecordPointer:void 0,currentCollectionRecordPointer:void 0})),{type:"entrypoint",entrypoint:"richTextMenu",pageStore:c,selectionState:Gt().default.state,textSelectionState:T().default.state,isMobile:t.device.isMobile,userSettings:null===(e=ne().default.state.currentUserSettingsStore)||void 0===e?void 0:e.getSettings()});return n.length?n[0]:void 0}),[u,c,t]),y=(0,g().K8)((()=>{const t=l,o=T().default.state;if(!s||"empty"===o.mode)return;const{multiSelection:i}=o,r=(0,qa().$W)(i),a=r.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),d=(0,M().KP)(i),c=T().default.isEditingComment(),u=T().default.isEditingFormQuestion(),g=t&&"form"===t.getType(),f=u||g,h=T().default.isEditingCaption(),v=t&&t.getParentTable()===Da().Vl,y=d&&t&&i.start.store===t.getCollectionViewSourceDescriptionStoreIfSingleSource(),b=n(747100).Gb(),S=e&&e.publicEditModeStore.state,x=!(0,n(731320).QT)(S)&&(i.start.store.canEdit()&&i.end.store.canEdit()),A=t&&"suggest"===ts().Uv.getMode(t),w=oe().default.checkGate({gateName:"block_reactions"}),k=a.some(((e,t)=>{const n=r[t].store.table===No().SN&&!r[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n})),j=x&&!k&&!r.some((e=>e.editable.props.disableFormattingAnnotations)),C=t&&t.getType(),I=C&&bs[C],_=null==t?void 0:t.isType("button"),P=(0,Va().u)(i.start.store)||(0,Va().u)(i.end.store),B=za(i.start.store)||za(i.end.store);let L=!1;const R=je().A.state.isOpen?je().A.state:Ce().A.state.isOpen?Ce().A.state:void 0;if(R){const e=R.store.getParentStore();if((null==e?void 0:e.table)===Da().Vl){const t=e.getSchema(),n=R.property,o=(0,ja()._g)({schema:t,property:n});"text"!==(null==o?void 0:o.type)||o.ai_inference||(L=!0)}}const D={isSingleStoreSelection:d,showTurnInto:Boolean(d&&!c&&!v&&!y&&!h&&t&&j&&!_&&!A&&!f&&(P||!B)),showBold:Boolean(j),showItalic:Boolean(j),showStrikethrough:Boolean(j),showUnderline:Boolean(j)&&!p,showCode:Boolean(j)&&!p,showLink:Boolean(d&&j),showHighlight:Boolean(j)&&!p,showDiscuss:Boolean(!c&&t&&(L||!v)&&!y&&!f&&!B),showReact:Boolean(w&&!c&&t&&!v&&!y&&!B&&!f),showSuggest:Boolean(!c&&t&&!r.some((e=>e.editable.props.disableSuggestEdit))&&!v&&!y&&!B&&!b&&!k&&!f),showEquation:Boolean(d&&j&&!A&&!f&&!p),showActionButton:Boolean(d&&!c&&!h&&t&&!v&&!f&&!r.some((e=>e.editable.props.disableRichTextActions))&&(P||!B)),targetBlockStore:t,isComment:c,showCompletions:Boolean((0,n(68465).ZE)(S)&&j&&!c&&!h&&t&&!v&&!y&&!_&&!B&&!A&&!f),topRankedSkill:m};if(I&&I.size>0)for(const e of I)D[e]=!1;return D}),[l,s,e,m,p]),[b,S]=(0,o.useState)(y);(0,o.useEffect)((()=>{y&&S(y)}),[y]);const x=(0,g().K8)((()=>t.WindowSizeStore.state.height),[t.WindowSizeStore]),A=(0,g().K8)((()=>y&&y.showDiscuss&&!y.showBold),[y]),w=(0,o.useCallback)((()=>{if(n(711319).A.state.open||as().A.state.open)return;if(n(620149).l.state)return Ua().I();const e=T().default.state;if("empty"===e.mode)return Ua().I();const o=(0,qa().$W)(e.multiSelection);if(0===o.length)return Ua().I();if(!o.every((e=>{let{store:t}=e;return t.table===En().ev||t.table===No().SN||t.table===Da().Vl||t.table===n(37165).lo})))return Ua().I();if(!t.currentUser.isLoggedIn()||!o.every((e=>{let{store:t}=e;return t.canComment()})))return;const i=ia().get();if(Ft().fI())return Ua().I();if(o.some((e=>{let{editable:t}=e;return t.props.disableStyleAnnotations})))return Ua().I();const s=o.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(s.some((e=>e&&e.pathIsDead())))return Ua().I();if(s.some((e=>e&&(0,es().dL)(e))))return Ua().I();if(s.some(((e,t)=>{const n=o[t].store.canComment(),i=o[t].store.table===No().SN&&o[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return Ua().I();const l=o.some((e=>{let{store:t}=e;const n=t.getRecordStoreAtRootPath();if(!(n instanceof re().Bv))return!1;const o=n.getValue();return!!o&&Ss[o.type]}));if(l)return Ua().I();const d=i?ia().getRect(i):void 0;if(d&&!Xa().HY(d,(0,n(59728).A)()))return Ua().I();if(ya().A.isActive()||da().A.isActive()||Ii().A.isOpen()||l||Za().default.isPeekDismissableState()||!i||!function(){const e=ia().get();return void 0!==e&&!e.collapsed&&"empty"!==T().default.state.mode&&!(0,M().kM)(T().default.state.multiSelection)}()||n(807926).A.state.open||"assistantCompletionPopup"===Ht().default.state.type)return Ua().I();let c=0,u=0;if(d){c=d.left;const e=25,t=d.top-36-e,o=n(175947).ek(r.isElectronMac),i=x-36-e;u=Math.min(Math.max(t,o),i)}0===Math.abs(rs().A.state.top-u)&&Math.abs(rs().A.state.left-c)<10&&(u=rs().A.state.top,c=rs().A.state.left),f(v()),rs().A.setState({...a,isActive:!0,isAnimatingClosed:!1,top:u,left:c,blockTarget:Gt().default.state.stores[0]})}),[t.currentUser,x,r.isElectronMac,a,f,v]),k=(0,o.useMemo)((()=>h().nF(w,200,{leading:!1})),[w]);(0,o.useEffect)((()=>(Gt().default.addListener(k),T().default.addListener(k),ns().A.addListener(w),is().A.addListener(w),os().A.addListener(w),Za().default.addListener(w),()=>{T().default.removeListener(k),Gt().default.removeListener(k),ns().A.removeListener(w),is().A.removeListener(w),os().A.removeListener(w),Za().default.removeListener(w)})),[w,k]);const j=(0,g().K8)((()=>function(e){const t=null==e?void 0:e.getParentStore();if((null==t?void 0:t.table)===En().ev)return!!t&&(0,$a().fc)(t);return!1}(l)),[l]),C=(0,o.useCallback)((()=>{a.isActive||rs().A.setState({...a,isAnimatingClosed:!1}),S(y)}),[a,y]);return(0,B.jsx)(un().A,{open:s||d,children:(0,B.jsx)(Ms,{handleAnimationEnd:C,isActive:s,isExternallyImportedAndSyncedCollectionPageBlockTarget:j,lastRenderState:b,richTextMenuStoreState:a,canOnlyDiscuss:A})})},As=o.forwardRef((function(e,t){let{lastRenderState:n,richTextMenuStoreState:o,canOnlyDiscuss:i,style:r}=e;const{top:a,left:s}=o,l=Math.max(i?s:s-60,0),d=i?"12px 0":12;return(0,B.jsxs)("div",{className:Vt().Vl,style:{pointerEvents:"none",position:"absolute",top:a,left:0,display:"flex",width:"100%",...r},ref:t,children:[(0,B.jsx)("div",{style:{flexShrink:1,width:l,minWidth:24}}),(0,Ko().A)((e=>(0,B.jsx)("div",{style:{pointerEvents:"none",padding:d},...e,children:n&&(0,B.jsx)(Es,{renderState:n})}))),(0,B.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})}));function Ms(e){let{handleAnimationEnd:t,isActive:n,isExternallyImportedAndSyncedCollectionPageBlockTarget:o,lastRenderState:i,richTextMenuStoreState:r,canOnlyDiscuss:a}=e;return(0,B.jsx)(Go().A,{tag:As,visible:n&&!o,initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},onAnimationEnd:t,config:{duration:120},lastRenderState:i,richTextMenuStoreState:r,canOnlyDiscuss:a})}function ws(e){let{theme:t,styles:n}=e;return(0,B.jsx)("div",{style:{height:24,width:1,borderRight:`1px solid ${t.regularDividerColor}`,margin:"auto 6px",...n}})}function ks(e){let{blockStore:t}=e;const n=(0,Ee().DP)(),o=(0,i().v3)(),r=(0,W().tz)();let a=(0,B.jsx)(W().sA,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const s=(0,g().K8)((()=>t.getType()),[t]);if(s){const e=Ga().ry[s];a=e&&e.displayName||a}return(0,B.jsx)(ds().Ay,{popupType:ds().z7.Popup,buttonPopupStore:as().A,originGap:4,renderOrigin:e=>(0,B.jsx)($e().A,{renderTooltip:()=>r.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:t=>(0,B.jsxs)(Ka().A,{style:{display:"flex",alignItems:"center",paddingLeft:7,paddingRight:6,whiteSpace:"nowrap",color:n.icon.primary,borderRadius:6},...(0,Ya().A)(e,t),children:[a,(0,Ia().b)({width:10,marginLeft:4,fill:n.icon.tertiary})]})}),render:()=>(0,B.jsx)(S().A,{menuType:A().gu.Popup,children:(0,B.jsx)(ls().A,{context:{blocks:[t],environment:o,publicEditMode:void 0,analyticsFrom:"rich_text_menu"},sections:[Na().t3],onAccept:e=>{const n=t.getType(),i=t.getFormat();Ua().I(),(0,Oa().N)(o,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"rich_text_menu",block_id:t.id,block_type:n,is_toggleable:n?(0,Qa().Yt)(n,i):void 0,parent_collection_id:t.getParentCollectionIdUpToTwoLevels()})}})}),onClick:()=>{(0,Ea().s)(o,{action:"turn_into"})}})}function js(){const e=(0,Ee().DP)();return(0,B.jsx)(gs().A,{type:"b",tooltipLabel:(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(W().sA,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(ra().A,{style:{color:e.text.contrastSecondary},name:"toggleBold"})})]}),children:Ca({width:16,height:16})})}function Cs(){const e=(0,Ee().DP)();return(0,B.jsx)(gs().A,{type:"i",tooltipLabel:(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(W().sA,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(ra().A,{style:{color:e.text.contrastSecondary},name:"toggleItalics"})})]}),children:Pa({width:16,height:16})})}function Is(){const e=(0,Ee().DP)();return(0,B.jsx)(gs().A,{type:"s",tooltipLabel:(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(W().sA,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(ra().A,{style:{color:e.text.contrastSecondary},name:"toggleStrike"})})]}),children:La({width:16,height:16})})}function Ts(){const e=(0,Ee().DP)();return(0,B.jsx)(gs().A,{type:"_",tooltipLabel:(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(W().sA,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(ra().A,{style:{color:e.text.contrastSecondary},name:"toggleUnderline"})})]}),children:Ra({width:16,height:16})})}function _s(){const e=(0,Ee().DP)();return(0,B.jsx)(gs().A,{type:"c",tooltipLabel:(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)("div",{children:(0,B.jsx)(W().sA,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(ra().A,{style:{color:e.text.contrastSecondary},name:"toggleCode"})})]}),children:(0,Ta().N)({width:16,height:16})})}function Ps(e){let{}=e;const t=(0,Ee().DP)();return(0,B.jsx)(hs().A,{children:(0,B.jsxs)("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[(0,Ba().w)({width:16,height:16,color:t.icon.primary}),(0,Ia().b)({width:10,fill:t.icon.tertiary})]})})}function Bs(e){let{intl:t,topRankedSkill:n}=e;const o=(0,Ee().DP)(),r=(0,i().v3)(),a=(0,g().K8)((()=>Ja().zD.isXMLAssistantEnabled()),[]);return(0,B.jsxs)(B.Fragment,{children:[n&&(0,B.jsxs)(Ka().A,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",borderRadius:6},onClick:()=>{(0,Tt().Nj)({environment:r,clientSkillWithParameterValues:(0,Dt().dangerouslyCreateClientSkillWithParameterValues)(n),from:"rich_text_menu",assistantSurfaceType:r.device.isMobile?"mobileWriter":"writer"}),(0,Ea().s)(r,{action:"completions"})},children:[n.icon({width:16,height:16,marginRight:6,fill:(0,Nt().vJ)(n.category).color(o).color}),(0,B.jsx)("span",{children:(0,B.jsx)(Fa,{clientSkill:n})})]}),(0,B.jsx)($e().A,{renderTooltip:()=>(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("div",{children:a?t.formatMessage({defaultMessage:"Make edits, find answers, and more",id:"richTextMenu.assist.assistantTooltip"}):t.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,B.jsx)("div",{children:(0,B.jsx)(ra().A,{style:{color:o.text.contrastSecondary},name:"commandJ"})})]}),render:e=>(0,B.jsxs)(Ka().A,{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 6px",whiteSpace:"nowrap",borderRadius:6,height:28},...e,onClick:()=>{(0,Pt().toggleInitialPrompt)({from:"rich_text_menu",environment:r}),(0,Ea().s)(r,{action:"completions"})},children:[(0,B.jsx)(Lt().Su,{}),(0,B.jsx)("span",{style:{marginLeft:6,marginRight:2},children:(0,B.jsx)(W().sA,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})]})}function Ls(){const e=(0,i().v3)();return(0,B.jsx)(fs().A,{onClick:()=>{(0,Ea().s)(e,{action:"e"}),Ua().I()},children:(0,_a().c)({width:16,height:16})})}function Rs(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,Ee().DP)(),i=(0,W().tz)();return(0,B.jsx)(cs().A,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28},iconOnly:n,blockStore:t,ariaLabel:i.formatMessage({id:"richTextMenu.Discussions.OpenDiscussionButton",defaultMessage:"Write a comment"})})}function Ds(e){let{targetBlockStore:t,iconOnly:n}=e;const o=(0,Ee().DP)();return(0,B.jsx)(Ha,{style:{borderRadius:6,color:o.icon.primary,fill:o.icon.primary,height:28,width:n?28:void 0},iconOnly:n,blockStore:t})}function Ns(e){let{targetBlockStore:t,iconOnly:n}=e;return(0,B.jsx)(ms,{style:{borderRadius:6,height:28},iconOnly:n,blockStore:t})}function Os(e){let{targetBlockStore:t}=e;const n=(0,Ee().DP)(),o=(0,i().v3)();return(0,B.jsx)(ss().A,{store:t,style:{borderRadius:6,padding:6,width:28,height:28},iconStyle:{fill:n.icon.primary},fadeIn:!1,onClick:()=>{(0,Ea().s)(o,{action:"more"})}})}function Es(e){let{renderState:t}=e;const o=(0,W().tz)(),i=(0,Ee().DP)(),r=(0,g().K8)((()=>rs().A.state.isActive),[]),a=t.showDiscuss||t.showReact||t.showSuggest,s=t.showBold||t.showItalic||t.showUnderline||t.showStrikethrough||t.showCode||t.showEquation||t.showHighlight,l=s;return(0,B.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:36,background:i.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:8,boxShadow:i.shadowMD,pointerEvents:r?"auto":"none",padding:"4px"},onMouseDown:e=>e.preventDefault(),children:[t.showCompletions&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Bs,{intl:o,topRankedSkill:t.topRankedSkill}),(0,B.jsx)(ws,{theme:i})]}),a&&t.targetBlockStore&&(0,B.jsxs)(B.Fragment,{children:[t.showDiscuss&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Rs,{targetBlockStore:t.targetBlockStore,iconOnly:!1}),!l&&(t.showReact||t.showSuggest)&&(0,B.jsx)(ws,{theme:i})]}),t.showReact&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(Ds,{targetBlockStore:t.targetBlockStore,iconOnly:l}),!l&&t.showSuggest&&(0,B.jsx)(ws,{theme:i})]}),t.showSuggest&&(0,B.jsx)(Ns,{targetBlockStore:t.targetBlockStore,iconOnly:l}),s&&(0,B.jsx)(ws,{theme:i})]}),s&&(0,B.jsxs)(B.Fragment,{children:[t.showTurnInto&&t.targetBlockStore&&(0,B.jsx)(ks,{blockStore:t.targetBlockStore}),(0,B.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[t.showBold&&(0,B.jsx)(js,{}),t.showItalic&&(0,B.jsx)(Cs,{}),t.showUnderline&&(0,B.jsx)(Ts,{}),t.showStrikethrough&&(0,B.jsx)(Is,{}),t.showCode&&(0,B.jsx)(_s,{}),t.showEquation&&(0,B.jsx)(Ls,{})]}),t.showLink&&(0,B.jsx)(Ps,{}),t.showHighlight&&(0,B.jsx)(n(213799).A,{blockStore:t.targetBlockStore})]}),(0,B.jsx)(vs,{}),t.showActionButton&&t.targetBlockStore&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(ws,{theme:i}),(0,B.jsx)(Os,{targetBlockStore:t.targetBlockStore})]})]})}var Us=()=>n(402014),Fs=()=>n(489348),Vs=()=>n(869562),zs=()=>n(749687),Ks=()=>n(730591),Ws=()=>n(712505);const Hs=5,Gs=18,Ys=.38;const qs=function(){const e=(0,i().v3)(),t=(0,o.useRef)(void 0),n=(0,o.useRef)(void 0),r=(0,o.useRef)(1/0),a=(0,o.useRef)(void 0),s=(0,g().K8)((()=>e.WindowSizeStore.state.width),[e]);return(0,o.useEffect)((()=>{s<Vs().OnlyOneSidebarVisibleWidthThreshold&&(0,nt().Nk)(e)&&(0,nt().KB)(e)&&Vs().setExpand({environment:e,isExpanded:!1,from:"sidebar_listener",saveDetailsSidebarPreference:!1})}),[e,s]),(0,o.useEffect)((()=>{const o=o=>{!function(e){let{e:t,environment:n,timerRef:o,cachedPageViewRectRef:i,previousMousePositionRef:r,mouseSpeedRef:a}=e;(0,Us().SQ)({event:t,context:Us().y$.SidebarMouseMove,callback:()=>{Qs(i),void 0!==r.current&&(a.current=Math.sqrt(Math.pow(t.clientX-r.current.x,2)+Math.pow(t.clientY-r.current.y,2))),function(e){let{x:t,y:n,timerRef:o,previousMousePositionRef:i}=e;i.current={x:t,y:n},clearTimeout(o.current),o.current=setTimeout((()=>{i.current=void 0}),100)}({x:t.clientX,y:t.clientY,timerRef:o,previousMousePositionRef:r});const e=oe().default.checkGate({gateName:"sidebar_hover_expansion_v3"});if(i.current){const o=zs().sidebarOpenStore.state,r=t.clientX,s=i.current.left,l=Math.max(s*Ys,Gs,zs().sidebarMousePeekXStore.state);r<l&&!Ws().default.isCenterPeekOpen()&&!Ks().A.getState().open&&a.current<Hs&&0!==a.current&&!o&&!e&&Vs().open({fromElectron:!1}),r>(0,nt().r6)(n)&&r>l&&o&&Vs().close()}}})}({e:o,environment:e,timerRef:a,cachedPageViewRectRef:t,previousMousePositionRef:n,mouseSpeedRef:r})};return window.addEventListener("mousemove",o),window.addEventListener("mouseout",$s),()=>{window.removeEventListener("mousemove",o),window.removeEventListener("mouseout",$s)}}),[e]),(0,B.jsx)(B.Fragment,{})};function $s(e){e.toElement||e.relatedTarget||Vs().close()}const Qs=h().nF((function(e){const t=function(){const{mainEditorCurrentBlockStore:e}=ne().default.state,t=Fs().A.find((t=>t.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}();e.current=t?t.getBoundingClientRect():document.body.getBoundingClientRect()}),500);var Zs=()=>n(171789),Xs=()=>n(662303),Js=()=>n(148307),el=()=>n(484392),tl=()=>n(869190),nl=()=>n(177167);const ol=(0,Po().xh)("page",{default:{loader:()=>n.e(82985).then(n.bind(n,982985))},small:{loader:()=>n.e(88931).then(n.bind(n,188931))},mini:{loader:()=>n.e(35189).then(n.bind(n,735189))},large:{loader:()=>n.e(86763).then(n.bind(n,686763))},extraLarge:{loader:()=>n.e(83295).then(n.bind(n,683295))}});var il=()=>n(246760),rl=()=>n(25729),al=()=>n(26440),sl=()=>n(846693),ll=()=>n(161479),dl=()=>n(232802),cl=()=>n(979340),ul=()=>n(148024),pl=()=>n(901389),ml=()=>n(435009),gl=()=>n(82926),fl=()=>n(675925),hl=()=>n(120303),vl=()=>n(112995),yl=()=>n(650843),bl=()=>n(878377),Sl=()=>n(777092),xl=()=>n(600871),Al=()=>n(891078),Ml=()=>n(62856),wl=()=>n(570323),kl=()=>n(548821),jl=()=>n(991249),Cl=()=>n(324561),Il=()=>n(807778),Tl=()=>n(134217),_l=()=>n(10984),Pl=()=>n(201145),Bl=()=>n(138405),Ll=()=>n(667474),Rl=()=>n(270812),Dl=()=>n(71743),Nl=()=>n(749240),Ol=()=>n(823541),El=()=>n(958846),Ul=()=>n(187485),Fl=()=>n(460292),Vl=()=>n(554509),zl=()=>n(864943),Kl=()=>n(204063),Wl=()=>n(16006),Hl=()=>n(2143),Gl=()=>n(64901),Yl=()=>n(221844),ql=()=>n(970013),$l=()=>n(452540),Ql=()=>n(388821),Zl=()=>n(696706),Xl=()=>n(869558),Jl=()=>n(798880),ed=()=>n(763824),td=()=>n(498212),nd=()=>n(299772);const od=function(e){const t=(0,i().v3)(),r=(0,i().Y0)(),{isMobile:a}=r,s=(0,g().K8)((()=>e.blockStore.getAssociatedCollectionStore()),[e.blockStore]),l=(0,g().K8)((()=>{var e;return null==s||null===(e=s.getLayoutStore())||void 0===e?void 0:e.getModules()}),[s]),d=(0,g().K8)((()=>{if(!s)return 0;const{count:e}=(0,tt().pm)({collectionStore:s});return e}),[s])>0&&!a,c=(0,Ee().IS)((e=>({spinnerWrapper:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},scroller:{background:e.contentBackground,zIndex:1,flexGrow:1,...d&&{paddingLeft:70,paddingRight:70}},container:{display:"flex",flexDirection:"row",flexGrow:1,overflow:"hidden"},layoutDetailsSidebar:{width:n(154807).xt,flexShrink:0,borderLeft:`1px solid ${e.stroke.secondary}`}})),[d]),u=(0,o.useCallback)((e=>{gl().un(),ml().oo({environment:t,url:e})}),[t]),p=e.blockStore.id,m=e.timestamp,[v]=(0,Se().Yb)((async()=>await async function(e,t,n){const{timestamp:o}=e,i=e.block.id,r=await G().callApi({eventName:"getSnapshotContents",environment:n,data:e});if("failed"===r.type)throw r.error;const a=Ql().RecordMapWithRole.create(r.data.contentMap),s=n.currentUser.id,l=new(Yl().A)({name:"PageSnapshotPreview"});for(const{pointer:m,model:g}of a)g&&l.setModelAndRole({pointer:m,userId:s},g,"reader");l.snapshotData={blockId:i,timestamp:o};const d=new Map,c=e=>{const n=l.getRecord({pointer:e,userId:s}),o=(0,$l().jV)(e);n||!(0,td().uj)(e.id)||d.has(o)||d.set(o,(0,re().Oo)(t,e))},u=[];for(const{model:m}of a)if(m)if(m.table===En().ev){const e=m,t=e.getProperties(),n=Zl().L3.uniq(h().Bq(Object.keys(t).map((e=>t[e])).map(f().moK)));for(const d of n)c(d);const o=Zl().L3.uniq(h().Bq(Object.keys(t).map((e=>t[e])).map(ja().n)));for(const d of o)c(d);const i=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of i)c({table:En().ev,id:d});const r=e.getCollectionPointer();r&&(c(r),u.push(r.id));const a=h().sb(h().Bq(Object.keys(t).map((e=>t[e])).map(f().Fbh)));for(const d of a)c({table:Jl().oo,id:d});const s=m.getCreatedByPointer();s&&c(s);const l=m.getLastEditedByPointer();l&&c(l)}else if(m.table===Xl().Gy){var p;const e=null===(p=m.getFormat())||void 0===p?void 0:p.collection_pointer;e&&c(e)}else if(m.table===No().SN){const e=m.getCreatedByPointer();e&&c(e)}return await id({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:s}),u.forEach((e=>{var t;const n=null===(t=l.getRecord({pointer:{table:Da().Vl,id:e},userId:s}))||void 0===t?void 0:t.value;n&&n.schema&&Object.keys(n.schema).forEach((e=>{var t;const o=null===(t=n.schema)||void 0===t?void 0:t[e],i=o&&(0,ql().nC)(o)?(0,ql().zO)(o):void 0;i&&c({table:Da().Vl,id:i})}))})),await id({relatedStoresMap:d,inMemoryRecordCache:l,currentUserId:s}),{blockStore:new(re().Bv)(n,{table:En().ev,id:i},{inMemoryRecordCache:l}),timestamp:o}}({block:{id:p,spaceId:(0,ll().e)(e.blockStore.pointer.spaceId)},timestamp:m},e.blockStore,t)),[p,t,e.blockStore,m]),y="pending"!==v.status&&"idle"!==v.status,b=v.value,S=v.error,x=(0,Ml().A)(!y||!b,400,400),A=(0,g().K8)((()=>{if(x)return(0,B.jsx)("div",{style:c.spinnerWrapper,children:(0,B.jsx)(ro().A,{})});if(S)return(0,B.jsx)("div",{style:{padding:32},children:(0,B.jsx)(W().sA,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})});const o=(0,Ft().fl)({environment:t,store:e.blockStore});return b?(0,B.jsxs)(n(21140).Ye,{style:c.container,children:[(0,B.jsx)(gt().A,{store:b.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:t}=e;return(0,B.jsx)(Hl().H,{style:c.scroller,type:o,...t,children:(0,B.jsx)(nd().Ay,{store:b.blockStore,disabled:!0,context:kl().Rr.InPageSnapShot,paddingBottom:(0,nd().Wj)(r),layoutModulesByArea:l})})}},b.timestamp),d&&(null==l?void 0:l.page_details)&&(0,B.jsx)(Hl().H,{style:c.layoutDetailsSidebar,type:ct().A.Y,children:(0,B.jsx)(n(146594).H,{store:b.blockStore,context:kl().Rr.InPageSnapShot,disabled:!0,shownAs:"static_sidebar",modules:l.page_details})})]}):void 0}),[x,S,t,e.blockStore,b,c.spinnerWrapper,c.container,c.layoutDetailsSidebar,c.scroller,d,l,r]);return(0,B.jsx)(vl().K,{from:"PageSnapshotPreview",fallback:e=>{let{error:t,errorId:n}=e;return(0,B.jsx)(yl().LargeSurfaceRenderError,{error:t,errorId:n})},children:(0,B.jsx)(n(484792).B,{value:u,children:A})})};async function id(e){const{relatedStoresMap:t,inMemoryRecordCache:n,currentUserId:o}=e,i=Array.from(t.values());await(0,ed().lX)(i,25,(async e=>{await e.load();const t=e.getValue();t&&n.setRecord({pointer:e.pointer,userId:o},{role:"reader",value:t})}))}const rd={SnapshotAdminDebugButton:new(d().O2)("SnapshotAdminDebugButton",(async()=>await n.e(14201).then(n.bind(n,523402))))},ad=(0,d().jQ)(rd.SnapshotAdminDebugButton,(e=>e.SnapshotAdminDebugButton));var sd=()=>n(147577);const ld={display:"flex",justifyContent:"center",padding:32},dd=(0,W().YK)({restoreSnapshotError:{id:"historyModal.restoreSnapshot.errorMessage",defaultMessage:"Failed to restore version."}});const cd=function(){const e=(0,W().tz)(),t=(0,i().v3)(),{device:o}=t,r=(0,g().O$)(wl().A),a=Td();return o.isMobile?(0,B.jsx)(x().Ay,{ariaLabel:vd(e),popupType:C().n.SlideUp,open:r.open,render:()=>(0,B.jsx)(Id,{}),onDismiss:gl().un}):(0,B.jsx)(n(676007).a,{ariaLabel:vd(e),open:r.open,innerStyle:a.modal,onDismiss:gl().un,render:()=>(0,B.jsx)(Id,{}),className:Vt().uMd})},ud=(0,B.jsx)(W().sA,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function pd(){return sl().MO.filter((e=>"personal"!==e.tier))}function md(e){const t=pd(),n=t.findIndex((t=>t.tier===e));if(!(n<=0))return t[n-1]}function gd(e){var t;if(q().A.isAdminMode)return;const{nextFutureSnapshot:n}=e;if(!n)return;const o=(i=n,(Date.now()-parseInt(i.timestamp))/Un().nD);var i;if((0,_l().sP)()&&o<=sl().et.plus.days)return;const r=function(e){return pd().filter((t=>t.days>e)).map((e=>e.tier))}(o);if((0,_l().bw)(r))return;const a=r[0]??"enterprise";return(0,cl().dL)(a)?void 0:{tier:a,message:(0,B.jsx)(W().sA,{defaultMessage:"Please upgrade to the {upsellTier} plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,el().A)((0,cl().$P)(a)?"plus":a),snapshotLimitDays:(null===(t=md(a))||void 0===t?void 0:t.days)??Math.floor(o)}})}}function fd(){return(0,B.jsx)(Gl().A,{href:(0,Ge().xS)("guides.pageHistory"),analyticsFrom:"page_history"})}function hd(e,t){const{device:n}=t;return!n.isMobile||"personal"===e&&(0,xl().mM)({environment:t})}function vd(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function yd(e){const{device:t}=e;return t.isMobile?24:20}function bd(e){let{menuState:t}=e;const n=(0,i().v3)(),r=(0,g().K8)((()=>t.blockStore.getIcon()),[t.blockStore]),a=(0,g().K8)((()=>t.blockStore.isEmptyPage()),[t.blockStore]),s=Td();return t.snapshot?(0,B.jsxs)(o.Fragment,{children:[(0,B.jsxs)("div",{style:s.header,children:[r?(0,B.jsx)(ba().B6,{disabled:!0,icon:r,isEmptyPage:a,size:yd(n)}):null,r?null:(0,B.jsx)(Fl().Q,{iconGroup:ol,variantName:"default",colorName:"secondary"}),(0,B.jsx)(Vl().D,{styleName:"Body-14px/Regular",colorName:"tertiary",customStyles:{minWidth:0,flex:1},children:(0,B.jsx)(Wl().A,{store:t.blockStore,style:{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}})})]}),(0,B.jsx)(od,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp})]}):null}function Sd(e,t){jl().K(t,{from:"history_modal",upsell:{type:"product",product:e,limit:{type:"none"},trialability:"none"}})}function xd(e){let{message:t,showUpgradeButtonForTier:n}=e;const o=(0,i().v3)(),{device:r}=o,a=(0,g().K8)((()=>Tl().qc(Nl().subscriptionDataStoreInstance.state)),[]),s=Td();let l=hd(n,o);return l&&(0,xl().mM)({environment:o})&&"personal"===n&&!a&&(l=!1),a||(l=!1),(0,B.jsxs)("div",{style:r.isMobile?s.unavailableMessageComponentMobile:s.unavailableMessageComponent,children:[hd(n,o)?(0,B.jsx)("img",{src:Js().A.images.icons.clockArrowLockSvg,alt:"locked clock icon"}):null,(0,B.jsx)("div",{style:{...!r.isMobile&&{maxWidth:283}},children:t}),l&&n?(0,B.jsx)(zl().A,{size:"lg",onClick:()=>Sd(n,o),style:s.upsell,iconLeading:()=>(0,B.jsx)(Fl().Q,{iconGroup:rl().k,variantName:"fill",colorName:"uiBluePrimary"}),children:(0,B.jsx)(W().sA,{defaultMessage:"Upgrade plan",id:"historyModal.upgradeForHistoryButton.labelVHR"})}):null]})}function Ad(e){const t=(0,W().tz)(),{requestUpgradeTier:n}=e,{requestState:o,openModal:i}=(0,Rl().E)({type:"product",product:n,entrypoint:"version_history",analyticsEntrypoint:"version_history",isOptimisticUpsell:!1}),r=(0,Ll().j)(o,t),a=(0,Bl().k)(o,t),s=Td();return(0,B.jsxs)("div",{style:s.unavailableMessageComponent,children:[(0,B.jsx)("img",{src:Js().A.images.icons.clockArrowLockSvg,alt:"locked clock icon"}),(0,B.jsx)("div",{style:{maxWidth:283},children:(0,B.jsx)(W().sA,{defaultMessage:"Your workspace owners must upgrade to the {requestUpgradeTier} plan to restore this page.",id:"historyModal.desktopModal.requestUpgradeMessage",values:{requestUpgradeTier:(0,el().A)(n)}})}),(0,B.jsx)(Dl().U,{onClick:i,label:r,testId:`${n}-request-button`,disabledTooltip:a,tooltipPlacement:j().W.Bottom,useOutlineButton:!0})]})}function Md(e){const t=(0,i().v3)(),n=(0,W().tz)(),{device:r}=t,{menuState:a,loadingMore:s}=e,l=(0,Ml().A)(s,300,100),d=Td();const c=function(e){const t=new Map;return e.forEach((e=>{const n=(0,tl().W_)(parseInt(e.timestamp),"very_short",Xs().locale),o=t.get(n)??0;t.set(n,o+1)})),t}(e.snapshotValues),u=(0,o.useCallback)((e=>{const t=e>Date.now()-6*Un().nD,n=c.get((0,tl().W_)(e,"very_short",Xs().locale));return!!n&&(n>1||t)}),[c]),p=(0,g().K8)((()=>h().oE(e.snapshotValues.map(((o,i)=>{const s=i>0?e.snapshotValues[i-1]:void 0,l=!gd({snapshot:o,nextFutureSnapshot:s});return{key:o.id,action:()=>{gl().Xn({environment:t,snapshot:o,nextFutureSnapshot:s})},render:e=>{const t=o.authors||[],i=n.formatList(h().oE(t.map((e=>(0,Sl().JQ)({parentStore:a.blockStore,pointer:e}).getDisplayName(n)))),{type:"conjunction",style:"narrow"}),s=(0,B.jsx)("div",{style:{...Ve().RC},children:i}),c=Boolean(a.snapshot&&a.snapshot.id===o.id),p=parseInt(o.timestamp),m=u(p),g=new Date(p).getFullYear()!==(new Date).getFullYear()?"long":"month_day_long",f=m?(0,tl().jE)(p,Xs().locale,n,"·",g):(0,tl().W_)(p,g,Xs().locale);return l?(0,B.jsx)(Yt().A,{...e,title:f,focused:!r.isMobile&&c,caption:s,buttonStyle:d.buttonMenuItem,itemMarginLeft:8,right:q().A.isAdminMode?(0,B.jsx)(ad,{snapshot:o}):null}):(0,B.jsx)(Yt().A,{...e,title:(0,B.jsx)("div",{style:d.menuItem,children:(0,B.jsx)("div",{style:{...r.isMobile&&{display:"flex",flex:1},...Ve().RC},children:f})}),focused:!r.isMobile&&c,caption:s,right:(0,B.jsx)(Fl().Q,{iconGroup:nl().x,variantName:"small",colorName:"tertiary"}),buttonStyle:d.buttonMenuItem,itemMarginLeft:8,rightStyle:{marginRight:"7px"}})}}})))),[e.snapshotValues,r.isMobile,t,n,a.blockStore,a.snapshot,d,u]),m=a.snapshot&&a.snapshot.id,f=p.findIndex((e=>m===e.key)),v=[{key:"snapshots",render:e=>(0,B.jsx)(Qt().A,{...e}),items:p}];return(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)(qt().Ay,{type:qt().Oh.Vertical,initialFocus:f,sections:v}),(0,B.jsx)(El().A,{loading:s,fetchSize:a.size,resultSize:e.snapshotValues.length,onLoadMore:gl().p2}),l&&(0,B.jsx)("div",{style:ld,children:(0,B.jsx)(ro().A,{})})]})}function wd(e){let{menuState:t,onRestoreSnapshot:n}=e;const o=(0,i().v3)();return(0,B.jsx)(x().Ay,{popupType:C().n.SlideUp,open:Boolean(t.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!t.snapshot)return null;const e=gd({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot}),i=!e,r=i?(0,B.jsx)(od,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp}):(0,B.jsx)(xd,{message:e.message,showUpgradeButtonForTier:e.tier}),a=!i&&o.device.isMobileBrowser;return(0,B.jsx)(S().A,{menuType:A().gu.Modal,title:(0,tl().jE)(parseInt(t.snapshot.timestamp),Xs().locale,Kt().A.getIntl()),right:(0,B.jsx)(mt().DoneMenuText,{}),onClickRight:gl().j8,leftDisabled:!i&&!o.device.isMobileBrowser,left:a?(0,B.jsx)(W().sA,{defaultMessage:"Upgrade",id:"historyModal.mobileSnapshotMenu.upgradeButton.label"}):(0,B.jsx)(W().sA,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>(async()=>{a?Sd(e.tier,o):await n()})(),whiteBackground:i,forceFullScreenSlideUp:!0,children:r})}})}function kd(e){const t=(0,i().v3)(),{menuState:n}=e,o=(0,Al().i0)(n.blockStore),r=(0,Al().ty)(n.blockStore),a=(0,g().K8)((()=>Boolean(n.snapshot&&!o&&!r&&!gd({snapshot:n.snapshot,nextFutureSnapshot:n.nextFutureSnapshot})&&function(e,t){return(0,bl().Xmj)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(n,t))),[t,n,o,r]),s=Td();return(0,B.jsxs)("div",{style:s.sidebarStyle,children:[(0,B.jsxs)("div",{style:s.sidebarHeader,children:[(0,B.jsx)(Vl().D,{styleName:"Heading-17px/Semibold",colorName:"primary",customStyles:{fontSize:16},children:(0,B.jsx)(W().sA,{id:"historyModal.desktopModal.sidebar.title",defaultMessage:"Version history"})}),(0,B.jsx)(hl().R,{onClick:gl().un,style:s.dismiss})]}),(0,B.jsx)(Hl().H,{type:ct().A.Y,style:{flex:1},children:(0,B.jsx)(Md,{...e})}),(0,B.jsxs)("div",{style:s.actions,children:[(0,B.jsx)(Yo().p,{size:"lg",style:s.learnMoreButton,onClick:()=>{ul().FH(t,{from:"page_history"}),ml().oo({environment:t,url:(0,Ge().xS)("guides.pageHistory"),openInNew:"tab"})},iconLeading:()=>(0,B.jsx)(Fl().Q,{iconGroup:il().G,variantName:"small",colorName:"secondary"}),children:(0,B.jsx)(Vl().D,{colorName:"secondary",children:(0,B.jsx)(W().sA,{defaultMessage:"Learn more",id:"historyModal.desktopModal.learnMoreButtonVHR.label"})})}),(0,B.jsx)($e().A,{disableTooltip:a,renderTooltip:()=>r?(0,B.jsx)(W().sA,{defaultMessage:"Resolve pending edits to restore snapshots.",id:"historyModal.desktopModal.sidebar.resolvePendingEdits.tooltip"}):o?(0,B.jsx)(W().sA,{defaultMessage:"Restore page from trash to restore snapshots.",id:"historyModal.desktopModal.sidebar.restorePageFromTrashMessage.tooltip"}):(0,B.jsx)(W().sA,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:t=>(0,B.jsx)(Kl().A,{size:"lg",onClick:e.onRestoreSnapshot,disabled:!a,...t,style:s.restoreButton,children:(0,B.jsx)(W().sA,{defaultMessage:"Restore",id:"historyModal.desktopModal.restoreButtonVHR.label"})})})]})]})}function jd(e){let t,n;return e.loadingMore||0!==e.snapshotValues.length||(t=(0,B.jsx)(xd,{message:ud,showUpgradeButtonForTier:!1})),n=e.error?(0,B.jsx)("div",{style:ld,children:(0,B.jsx)(W().sA,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,B.jsx)("div",{style:ld,children:(0,B.jsx)(ro().A,{})}):(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)(Hl().H,{type:ct().A.Y,children:(0,B.jsx)(Md,{...e})}),(0,B.jsx)(wd,{...e})]}),(0,B.jsx)(S().A,{menuType:A().gu.Modal,title:(0,B.jsx)(W().sA,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,B.jsx)(fd,{}),right:(0,B.jsx)(mt().DoneMenuText,{}),onClickRight:gl().un,header:t,children:(0,B.jsx)(vl().K,{from:"MobileHistory",fallback:e=>{let{error:t,errorId:n}=e;return(0,B.jsx)(yl().LargeSurfaceRenderError,{error:t,errorId:n})},children:n})})}function Cd(e){const t=(0,i().Y0)(),n=(0,g().K8)((()=>(0,Il().P4)()),[]),o=(0,g().K8)((()=>e.menuState.snapshot?gd({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot}):null),[e.menuState.nextFutureSnapshot,e.menuState.snapshot]),r=Td(),a=(0,g().K8)((()=>(0,nd().Wj)(t)),[t]),s=(0,Cl().f_)({spaceId:e.menuState.blockStore.pointer.spaceId}),l=(0,Pl().y)(s),d=(0,g().K8)((()=>(0,Il().NV)()),[]);let c;return c=e.error?(0,B.jsx)("div",{style:ld,children:(0,B.jsx)(W().sA,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})}):e.initialLoading?(0,B.jsx)("div",{style:ld,children:(0,B.jsx)(ro().A,{})}):o?n?(0,B.jsxs)("div",{style:r.blurContainer,children:[(0,B.jsx)("div",{style:t.isMobile?r.unavailableMessageComponentMobile:r.unavailableMessageComponent,children:(0,B.jsx)(Ol().V,{icon:al().w,title:(0,B.jsx)(W().sA,{defaultMessage:"Get more version history",id:"historyModal.upgradeEmptyState.title"}),description:o.message,source:"history_modal",upsell:{type:"product",product:o.tier,limit:{type:"none"},trialability:"none"}})}),(0,B.jsx)("div",{style:r.snapshotBlur,children:(0,B.jsx)(nd().Ay,{store:e.menuState.blockStore,disabled:!0,context:kl().Rr.InPageSnapShot,paddingBottom:a})})]}):d&&(0,dl().rU)(o.tier)&&l?(0,B.jsxs)("div",{style:r.blurContainer,children:[(0,B.jsx)("div",{style:r.unavailableMessageText,children:(0,B.jsx)(Ad,{requestUpgradeTier:o.tier})}),(0,B.jsx)("div",{style:r.snapshotBlur,children:(0,B.jsx)(nd().Ay,{store:e.menuState.blockStore,disabled:!0,context:kl().Rr.InPageSnapShot,paddingBottom:a})})]}):(0,B.jsxs)("div",{style:r.blurContainer,children:[(0,B.jsx)("div",{style:r.unavailableMessageText,children:(0,B.jsx)(xd,{message:o.message,showUpgradeButtonForTier:o.tier})}),(0,B.jsx)("div",{style:r.snapshotBlur,children:(0,B.jsx)(nd().Ay,{store:e.menuState.blockStore,disabled:!0,context:kl().Rr.InPageSnapShot,paddingBottom:a})})]}):e.loadingMore||0!==e.snapshotValues.length?(0,B.jsx)(bd,{menuState:e.menuState}):(0,B.jsx)(xd,{message:ud,showUpgradeButtonForTier:!1}),(0,B.jsxs)(vl().K,{from:"DesktopHistory",fallback:e=>{let{errorId:t}=e;return(0,B.jsx)(yl().LargeSurfaceRenderError,{errorId:t})},children:[(0,B.jsx)("div",{style:r.preview,children:c}),(0,B.jsx)(kd,{...e})]})}function Id(){const e=(0,i().v3)(),{device:t}=e,n=(0,g().O$)(wl().A),[o]=(0,Se().Yb)((async()=>{if(n.open)return await async function(e,t,n){const{device:o}=n,i=await G().callApi({eventName:"getSnapshotsList",environment:n,data:e});if("failed"===i.type)throw i.error;const{snapshots:r}=i.data;if(t.pageHasCollection=r.some((e=>{var t;const n="collection"===e.parent_table,o=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return n||o&&0!==o})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),o=r.findIndex((t=>parseInt(t.timestamp)<e));0===r.length||(0===o?gl().Xn({environment:n,snapshot:r[o],nextFutureSnapshot:void 0}):o>0?gl().Xn({environment:n,snapshot:r[o-1],nextFutureSnapshot:o>1?r[o-2]:void 0}):r.length<t.size?gl().Xn({environment:n,snapshot:r[r.length-1],nextFutureSnapshot:r.length>1?r[r.length-2]:void 0}):gl().p2())}else Boolean(t.snapshot)||o.isMobile||wl().A.setState({...t,snapshot:r[0],nextFutureSnapshot:void 0});return i.data}({block:{id:n.blockStore.id,spaceId:(0,ll().e)(n.blockStore.pointer.spaceId)},size:n.size},n,e)}),[e,n]),r="pending"!==o.status&&"idle"!==o.status,a=o.error,s=o.value,l=(0,Ml().A)(Boolean(n.open&&(!s||s.snapshots.length>=n.size&&n.openSnapshotNearTimestamp)),400,100);if(!n.open)return null;const d=t.isMobile?jd:Cd;return(0,B.jsx)(d,{snapshotValues:s?s.snapshots:[],menuState:n,onRestoreSnapshot:async function(){if(!n.open)return;const t="restore_collection",o=n.pageHasCollection?[{key:t,text:(0,B.jsx)(W().sA,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(W().sA,{defaultMessage:"All database pages and their properties from this version will be restored, which may impact other users or database views. To restore database page content, restore an earlier version for each page.",id:"historyModal.confirmDialog.selectOption.collection.description"})," ",(0,B.jsx)(Ul().A,{external:!0,href:(0,Ge().xS)("guides.pageHistoryRestore"),style:{display:"inline",textDecoration:"underline"},children:(0,B.jsx)(W().sA,{id:"historyModal.confirmDialog.selectOption.collection.learnMore",defaultMessage:"Learn more"})})]})}]:void 0,{accept:i,selectionResult:r}=await pl().Gh({message:(0,B.jsx)("div",{style:{fontWeight:Ve().Wy.semibold,fontSize:"medium"},children:(0,B.jsx)(W().sA,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,B.jsx)(W().sA,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:o,mode:o?"wide":void 0,textAlign:"left"});if(i){try{await(0,fl().o)(e,{action:"restore_snapshot",from:"snapshot_history_modal",block_type:void 0},(n=>gl().n5(e,null==r?void 0:r[t]).then(n)))}catch{pl().f1(Kt().A.formatMessage(dd.restoreSnapshotError))}gl().un()}},error:a,initialLoading:l,loadingMore:!r})}function Td(){return(0,Ee().IS)((e=>({sidebarStyle:{display:"flex",flexDirection:"column",flexShrink:0,width:sd().pN,padding:"10px 8px 0px 8px",borderLeft:`\n\t\t\t1px solid ${e.regularDividerColor}\n\t\t`},sidebarHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",alignSelf:"stretch",padding:"4px 4px 4px 8px"},actions:{display:"flex",padding:"12px 12px 12px 6px",borderTop:`\n\t\t\t\t\t1px solid ${e.regularDividerColor}\n\t\t\t\t`,justifyContent:"space-between",marginLeft:"-8px",marginRight:"-8px"},learnMoreButton:{padding:"0px 8px",borderRadius:"6px",gap:4},preview:{display:"flex",flexDirection:"column",width:`calc(100% - ${sd().pN}px)`,boxShadow:`1px 0 0 ${e.regularDividerColor}`,overflow:"hidden"},restoreButton:{backgroundColor:e.text.uiBluePrimary,borderRadius:"6px",boxShadow:"none"},buttonMenuItem:{marginLeft:"0px",marginRight:"0px",width:"100%",borderRadius:"6px"},menuItem:{display:"flex",alignItems:"center",justifyContent:"space-between"},header:{display:"flex",alignItems:"center",flexShrink:0,height:45,paddingLeft:14,paddingRight:14,gap:6,width:"100%",overflow:"hidden"},modal:{height:`${sd().fi}vh`,width:`${sd().oR}vw`,overflow:"hidden",display:"flex",borderRadius:"12px"},blurContainer:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},unavailableMessageText:{position:"absolute",width:"100%",height:"100%",zIndex:1},snapshotBlur:{position:"relative",pointerEvents:"none",filter:"blur(20px)",opacity:"30%",margin:"-5px"},unavailableMessageComponentMobile:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,position:"relative",zIndex:1,background:e.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t\t0 -1px 0 ${e.regularDividerColor},\n\t\t\t\t\t\t\t\t0 1px 0 ${e.regularDividerColor}\n\t\t\t\t\t\t\t`},unavailableMessageComponent:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:16,textAlign:"center",fontSize:14,height:"100%",gap:16},upsell:{gap:4,paddingLeft:"8px",paddingRight:"12px",borderRadius:"6px"},dismiss:{position:"unset"}})),[])}var _d=()=>n(988499);async function Pd(e){const{environment:t,emitValue:n,spaceStore:o,currentUserId:i,lastEmitData:r}=e,a=function(e){const{emitValue:t,spaceStore:n,currentUserId:o,lastEmitData:i}=e;if(void 0===t)return!0;const r=n.id!==i.spaceId,a=o!==i.userId,s=t!==i.value;return r||a||s}({emitValue:n,spaceStore:o,currentUserId:i,lastEmitData:r});if(!a)return;const s=await(0,E().qd)({fromCache:!1,environment:t,spaceStore:o,currentUserId:i,includeArchived:!1});if(!s)return;const{teams:l,teamAggregateData:d}=s;_d().A.setState({teams:l,teamAggregateData:d,lastEmitData:{spaceId:o.id,userId:i,value:n}})}const Bd=function(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n}=(0,g().O$)(ne().default),r=null==n?void 0:n.id;return(0,o.useEffect)((()=>{if(!t||!r)return;const n=Z().Ay.addListener((0,z().Dh)(t.id),void 0,(async n=>{let{value:o}=n;await Pd({environment:e,emitValue:o,spaceStore:t,currentUserId:r,lastEmitData:_d().A.state.lastEmitData})}),void 0,e);return function(){n&&Z().Ay.removeListener(n,e)}}),[t,r,e]),null};var Ld=()=>n(510683),Rd=()=>n(444768);const Dd=function(){const e=(0,Ee().DP)(),t=(0,i().v3)(),o=(0,g().O$)(Rd().A),r=(0,g().O$)(n(661179).A);if(!o.open)return null;const a=o.integration.info.icon;return a?(0,B.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:e.popoverBackground,borderRadius:4,boxShadow:e.shadowSM,position:"absolute",bottom:65+r,right:16+r,width:240,zIndex:111,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,B.jsx)(n(854672).A,{type:"image_url",imageURL:a,size:38,style:{marginBottom:6}}),(0,B.jsx)("div",{style:{color:e.text.primary,fontSize:14,fontWeight:Ve().Wy.semibold,marginBottom:6,textAlign:"center"},children:(0,B.jsx)(W().sA,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:o.integration.name}})}),(0,B.jsxs)("div",{style:{color:e.text.secondary,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,B.jsx)(W().sA,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,B.jsx)(n(719147).A,{href:(0,Ge().xS)("guides.unfurling"),external:!0,children:(0,B.jsx)(W().sA,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,B.jsx)(Kl().A,{onClick:()=>async function(e){const t=Rd().A.state,{currentSpaceStore:n}=ne().default.state;if(!t.open||!n)return;await Ld().Jq({environment:e,integration:t.integration,spaceId:n.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),Nd(t.integration.id,e),Rd().A.reset()}(t),style:{width:"100%"},children:(0,B.jsx)(W().sA,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,B.jsx)(qe().A,{icon:n(212050).u,onClick:()=>function(e){const t=Rd().A.state;t.open&&Nd(t.integration.id,e);Rd().A.reset()}(t),style:{position:"absolute",top:6,right:6}})]}):null};function Nd(e,t){const{currentUserSettingsStore:n}=ne().default.state;n&&b().createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,canUndo:!0,perform:t=>{Hr().Cw({transaction:t,userSettingsStore:n,integrationId:e})}})}n(18107),n(967357);var Od=()=>n(617871),Ed=()=>n(650829),Ud=()=>n(398209),Fd=()=>n(147294);const Vd=function(){const e=(0,g().uB)(Ud().A),t=(0,i().v3)(),n=(0,o.useRef)(null),r=(0,i().Y0)(),[a,s]=(0,g().K8)((()=>[e.state.open,e.state.open?e.state.renderRect:void 0]),[e]);return(0,o.useEffect)((()=>{const e=e=>{a&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&Yd(t)},o=e=>{if(!a||!e.target||!n.current)return;const o=n.current;o&&o!==e.target&&Yd(t)};return(0,Ri().P4)(window,"keydown",e),(0,Ri().P4)(window,"mousedown",o),()=>{(0,Ri().Ol)(window,"keydown",e),(0,Ri().Ol)(window,"mousedown",o)}}),[a,n,t]),(0,B.jsx)(x().Ay,{popupType:r.isMobileNative&&!r.isTablet?C().n.SlideUp:C().n.Popup,open:Boolean(a&&s),originRect:a?s:void 0,placementToOrigin:j().W.Top,alignmentToOrigin:j().C.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:r.isMobile,keepFocus:r.isMobile,render:()=>(0,B.jsx)(zd,{}),onDismiss:Yd})};function zd(){const e=(0,g().uB)(Ud().A),t=(0,i().v3)(),n=(0,i().Y0)(),r=(0,o.useRef)(null),a=(0,W().tz)(),[s,l,d,c]=(0,g().K8)((()=>[e.state.open,e.state.open?e.state.allOptionTypes:[],e.state.open?e.state.integration:void 0,e.state.open?e.state.url:void 0]),[e]),u=(0,Ee().IS)((e=>({header:n.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:Ve().Wy.semibold,background:e.surface.wash,height:45}:{paddingLeft:16,paddingRight:16,paddingTop:10,color:e.text.secondary,fontSize:Ve().J.UISmall.desktop,fontWeight:450,font:"SF Pro"}})),[n]);if(!s)return null;const p={fontSize:Ve().J.UIRegular.desktop,fontWeight:Ve().Wy.regular,font:"SF Pro"},m={key:"embed section",render:e=>(0,B.jsx)(Qt().A,{...e,style:{paddingTop:6,paddingBottom:0}}),items:l.filter((e=>"import"!==e)).map((e=>({key:e,render:n=>(0,B.jsx)(Yt().A,{...n,title:(0,B.jsx)(Kd,{optionType:e,integration:d}),onMouseEnter:o=>{n.onMouseEnter(o),Wd(e,a,t)},style:p}),action:()=>Hd(e,t)})))},f={key:"import section",render:e=>(0,B.jsx)(Qt().A,{...e,style:{paddingTop:0,paddingBottom:6}}),items:l.filter((e=>"import"===e)).map(((e,n)=>({key:e,render:n=>function(e){let{props:t,optionType:n,integration:o,environment:i,intl:r,menuTextStyle:a}=e;return(0,B.jsx)(qd,{props:t,optionType:n,integration:o,environment:i,intl:r,menuTextStyle:a})}({props:n,optionType:e,integration:d,environment:t,intl:a,menuTextStyle:p}),action:()=>Hd(e,t)})))},h=[m,f];return(0,B.jsx)(Ed().LazyAssistantUnfurlingMenuWithAiSection,{url:c,integration:d,headerStyle:u.header,menuTextStyle:p,updateUnfurlingOptionType:Wd,handleDismiss:Hd,renderMenu:e=>{let o,{maybeAiActionSection:i}=e;return o=n.isMobile?{menuType:A().gu.ActionSheet}:{menuType:A().gu.Popup,width:l.includes("import")?260:Boolean(i)?220:200,maxHeight:"40vh",onClickOutside:()=>Yd(t)},(0,B.jsx)(S().A,{...o,className:Vt().Uvd,ref:r,header:(0,B.jsx)(on().A,{style:u.header,isSmall:!n.isMobile,isSecondaryColor:!n.isMobile,children:(0,B.jsx)(W().sA,{id:"embedMenu.header",defaultMessage:"Paste as"})}),children:(0,B.jsx)(qt().Ay,{type:qt().Oh.Vertical,sections:i?[...h,i]:h,initialFocus:0,onKeyboardArrow:e=>function(e,t,n,o){const i=Ud().A.state;if(!i.open||void 0===e.indexGlobal)return;const r=i.allOptionTypes.at(e.indexGlobal);if(!r)return void(o&&Wd("preview",t,n));Wd(r,t,n)}(e,a,t,Boolean(i)),priority:1,disallowBackspace:!0})})}})}function Kd(e){let{optionType:t,integration:n}=e;return"preview"===t?(0,B.jsx)(W().sA,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Preview"}):"mention"===t?(0,B.jsx)(W().sA,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Mention"}):"link"===t?(0,B.jsx)(W().sA,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"URL"}):"drive"===t?(0,B.jsx)(W().sA,{id:"unfurlingMenu.actions.pasteAsDrive.title",defaultMessage:"Embed"}):"collection"===t?(0,B.jsx)(W().sA,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Database"}):"import"===t?(null==n?void 0:n.id)===Od().me?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(W().sA,{id:"unfurlingMenu.actions.import.jiraTitle",defaultMessage:"Sync Jira projects and issues"}),(0,B.jsx)(ao().A,{style:{display:"inline"}})]}):(null==n?void 0:n.id)===Od().mn?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(W().sA,{id:"unfurlingMenu.actions.import.salesforceTitle",defaultMessage:"Sync Reports"}),(0,B.jsx)(Fd().Ee,{style:{display:"inline"},newBadgeKey:"salesforce_sync_unfurling_option",didUserEngage:!1,keyType:"date"})]}):(0,B.jsx)(W().sA,{id:"unfurlingMenu.actions.import.title",defaultMessage:"Import from {integration}",values:{integration:null==n?void 0:n.name}}):void(0,at().HB)(t)}function Wd(e,t,n){b().createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:n,canUndo:!1,perform:o=>{Ao().Oi({environment:n,type:Gd(e),useTemporaryRecordCache:!0,transaction:o,intl:t})}})}function Hd(e,t){const n=Ud().A.state;zr().Gp(t,{unfurl_option_type:e||"default",integration:n.open?n.integration.name:"default"}),"import"===e&&n.open?(b().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:e=>{Ao().VN({environment:t,setType:"link",transaction:e})}}),Ao().z1({environment:t,integration:n.integration,url:n.url,blockStore:n.stores.blockStore})):b().createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,canUndo:!0,perform:n=>{Ao().VN({environment:t,setType:e?Gd(e):void 0,transaction:n})}})}function Gd(e){return"import"===e?"link":e}function Yd(e){Hd(void 0,e)}function qd(e){let{props:t,optionType:n,integration:o,environment:i,intl:r,menuTextStyle:a}=e;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(io().A,{size:4}),(0,B.jsx)(Yt().A,{...t,title:(0,B.jsx)(Kd,{optionType:n,integration:o}),onMouseEnter:e=>{t.onMouseEnter(e),Wd(n,r,i)},style:a})]})}var $d=()=>n(999752),Qd=()=>n(664713),Zd=()=>n(367014),Xd=()=>n(349990),Jd=()=>n(751348),ec=()=>n(90873);const tc=10;function nc(){const e=(0,i().v3)(),{currentSpaceStore:t,currentUserStore:n,currentUserRootStore:r}=(0,g().O$)(ne().default),a=null==n?void 0:n.id,s=(0,Jd().n)(t),l=(0,Xd().l)(),d=(0,g().K8)((()=>h().oE(s?(0,X().f)({currentUserRootStore:r}).map((e=>e.getSpaceId())):l?(0,Zd().k)({currentUserRootStore:r}).map((e=>e.getSpaceId())):[null==t?void 0:t.id])),[s,l,t,r]);return(0,o.useEffect)((()=>{if(!a)return;const t=async(t,n)=>{const o=ec().A.getSharedPagesState({userId:a,spaceId:t});o&&o.emitValue===n||await Qd().Z({environment:e,userId:a,spaceId:t,emitValue:n})},n=d.length>tc?new($d().O)(tc):void 0,o=d.map((o=>{const i=h().nF((async e=>{let{value:i}=e;return n?n.enqueue((async()=>t(o,i))):t(o,i)}),5e3);return{listener:Z().Ay.addListener((0,z().Rs)({userId:a,spaceId:o}),void 0,i,void 0,e),throttledHandler:i}}));return function(){null==n||n.cancel(),o&&o.forEach((t=>{let{listener:n,throttledHandler:o}=t;n&&Z().Ay.removeListener(n,e),o&&o.cancel()}))}}),[d,a,e]),null}n(16280);var oc=()=>n(721908),ic=()=>n(592269),rc=()=>n(921598),ac=()=>n(854150),sc=()=>n(313892),lc=()=>n(799832),dc=()=>n(199896),cc=()=>n(854502),uc=()=>n(666710);const pc=200,mc=30,gc=125,fc=25;var hc=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(hc||{});function vc(e){return e.type===hc.Selectable?{type:dn().OX.Selectable,store:e.target.props.store,direction:e.direction}:{type:dn().OX.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function yc(e){const{target:t,device:n,direction:o,points:i}=e;return o===dn().bH.Onto||!n.isPhone||t.props.dropzoneShouldNeverUseOrigin?i.mousePoint:{x:i.originPoint.x,y:i.mousePoint.y}}function bc(e){return(0,dc().MS)(e)?{type:hc.Selectable,target:e}:{type:hc.DropTarget,target:e}}function Sc(e){if(!e||!(0,dc().MS)(e))return!1;let t=e;const n=dn().Ay.state;if(!n.isDragging)return!1;const{draggedStores:o}=n;for(;t;){if(o.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function xc(e){const{dropzoneMustBeWithinHorizontalBound:t,device:n}=e;return t?0:n.isPhone?9999:0}function Ac(e){switch(e.direction){case dn().bH.Onto:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:r,priority:a,canAcceptDrop:s}=e,l=dn().bH.Onto,d=yc({device:t,target:i,direction:l,points:r});if((n?i.props.canNativeDropOnto:i.props.canDropOnto)&&wc(d,o)&&!Sc(i)&&s(i,l))return{...bc(i),direction:l,left:o.left,top:o.top,width:o.width,height:o.height,priority:a}}(e);case dn().bH.Left:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:r,priority:a,optionKeyDown:s,canAcceptDrop:l}=e,d=dn().bH.Left,c=yc({device:t,target:i,direction:d,points:r});if((n?i.props.canNativeDropLeft:i.props.canDropLeft)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.left)<=pc&&(s||!Sc(i))&&l(i,d))return{...bc(i),direction:d,left:o.left,top:o.top,width:0,height:o.height,priority:a}}(e);case dn().bH.Right:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:r,priority:a,optionKeyDown:s,canAcceptDrop:l}=e,d=dn().bH.Right,c=yc({device:t,target:i,direction:d,points:r});if((n?i.props.canNativeDropRight:i.props.canDropRight)&&o&&c.y>=o.top&&c.y<=o.bottom&&Math.abs(c.x-o.right)<=pc&&(s||!Sc(i))&&l(i,d))return{...bc(i),direction:d,left:o.right,top:o.top,width:0,height:o.height,priority:a}}(e);case dn().bH.Above:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:r,priority:a,optionKeyDown:s,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??mc,c=xc({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=dn().bH.Above,p=yc({device:t,target:i,direction:u,points:r});if((n?i.props.canNativeDropAbove:i.props.canDropAbove)&&o&&p.x>=o.left-d-c&&p.x<=o.right+c&&(s||!Sc(i))&&Math.abs(p.y-o.top)<=gc&&(o.height<=2*fc||p.y<=o.top+fc)&&l(i,u))return{...bc(i),direction:u,left:o.left,top:o.top,width:o.width,height:0,priority:a}}(e);case dn().bH.Below:return function(e){const{device:t,isNativeDrag:n,rect:o,target:i,points:r,priority:a,optionKeyDown:s,canAcceptDrop:l}=e,d=i.props.verticalDropZoneExtraLeftEdgeOffset??mc,c=xc({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),u=gc,p=i.props.isLastItem?Number.MAX_SAFE_INTEGER:gc,m=dn().bH.Below,g=yc({device:t,target:i,direction:m,points:r});if((n?i.props.canNativeDropBelow:i.props.canDropBelow)&&o&&g.x>=o.left-d-c&&g.x<=o.right+c&&o.bottom-g.y<=u&&g.y-o.bottom<=p&&(o.height<=2*fc||g.y>=o.bottom-fc)&&(s||i.props.isLastItem||!Sc(i))&&l(i,dn().bH.Below))return{...bc(i),direction:dn().bH.Below,left:o.left,top:o.bottom,width:o.width,height:0,priority:a}}(e)}}function Mc(e){const{device:t,rect:n,target:o,points:i,optionKeyDown:r}=e;return wc(yc({device:t,target:o,direction:dn().bH.Onto,points:i}),n)&&Sc(o)&&!r}function wc(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var kc=()=>n(281322),jc=()=>n(776894),Cc=()=>n(396301),Ic=()=>n(49650),Tc=()=>n(585533),_c=()=>n(182106),Pc=()=>n(696152),Bc=()=>n(695625),Lc=()=>n(444570),Rc=()=>n(915440),Dc=()=>n(871399);const Nc=2,Oc=20,Ec=7;function Uc(){const e=(0,o.useRef)(!1),t=(0,o.useRef)(!1),n=(0,o.useRef)(void 0),r=(0,i().Y0)(),a=(0,i().v3)(),s=(0,ka().S)(),l=(0,oc().d)((e=>ir().e.withListenerIgnored((()=>(e=>{const o=Dc().default.state;if(!(e&&e.target instanceof Element)||o.isOpen&&o.menuIsOpen||(n.current={target:e.target,x:e.clientX,y:e.clientY}),t.current)return void(t.current=!1);const{isDragging:i}=dn().Ay.state;if(i)g();else{if(!n.current)return;zc(a,n.current.target,n.current.x,n.current.y)}})(e)))),60),d=(0,o.useCallback)((()=>{e.current||l(void 0)}),[l]),c=h().nF((()=>{const{isDragging:e}=dn().Ay.state;Co().default.afterNextFlush((()=>{n.current&&!e&&zc(a,n.current.target,n.current.x,n.current.y)}))}),60),u=(0,o.useMemo)((()=>new WeakMap),[]),p=(0,o.useCallback)((e=>{const t=u.get(e);if(u.has(e))return t??!1;const n=(0,bl().x7S)({environment:a,blocks:e,publicEditMode:s&&s.publicEditModeStore.state});return u.set(e,n),n??!1}),[a,s,u]),m=(0,o.useCallback)((()=>{const e=dn().Ay.state;if(!e.isDragging)return;const{draggedStores:t,currentX:n,currentY:o,offsetX:i,offsetY:r,isNativeDrag:l}=e,d=function(e){const{points:t,draggingStore:n,isNativeDrag:o,environment:i,pageContext:r,canDragFn:a}=e,{device:s}=i,l=kc().r(),d=function(){const{selectableRectMap:e}=uc().default.state,{dropTargetRectMap:t}=cc().A.state,n=new Map;return e.forEach(((e,t)=>{n.set(t,e)})),t.forEach(((e,t)=>{n.set(t,e)})),n}(),c=d.keys();let u=c.next();const p=Bc().T.findSelectableFromStore(n),m=p?p.getContextSelectableContainer():void 0;let g=[];for(;!u.done;){const e=u.value;u=c.next();const n=d.get(e),p=e.getContextSelectableContainer();if(s.isPhone&&p!==m)continue;if(!p||p.getProps().disable)continue;const f=Vc(p),v={device:s,isNativeDrag:o,rect:n,target:e,points:t,priority:f,optionKeyDown:l.option,canAcceptDrop:(e,t)=>qc({target:e,direction:t,optionKeyDown:l.option,environment:i,pageContext:r,canDragFn:a})};if(Mc(v))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};g.push(...h().oE([Ac({...v,direction:dn().bH.Onto}),Ac({...v,direction:dn().bH.Left}),Ac({...v,direction:dn().bH.Right}),Ac({...v,direction:dn().bH.Above}),Ac({...v,direction:dn().bH.Below})]))}g=function(e){const t=Wc(h().Sk(e,Wc));return e.filter((e=>Wc(e)===t))}(g);const f=g.filter((e=>e.direction===dn().bH.Above||e.direction===dn().bH.Below)),v=h().wq(f,(e=>Math.abs(e.top-Kc(e,t,i).y)));if(v&&v.target===p)return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};let y=f.filter((e=>{let{top:t}=e;return Math.abs(t-(v?v.top:0))<=Nc}));if(y.length>1){y=y.filter((e=>{const n=Kc(e,t,i).x,o=xc({device:s});return n>=e.left-o&&n<=e.left+e.width+o})),y=h().Ul(y,(e=>{let{left:t}=e;return t}));let e=0;for(;e<y.length-1;e++){const n=y[e+1],o=Kc(n,t,i).x;if(n.left>o)break}y=y.slice(0,e+1),y.reverse()}const b=y.map(vc);let S;const x=g.filter((e=>e.direction===dn().bH.Onto)),A=h().wq(x,(e=>e.height));if(A){f.some((e=>{const n=Kc(e,t,i).y;return Math.abs(e.top-n)<Ec}))||(S=vc(A))}let M;const w=g.filter((e=>e.direction===dn().bH.Left||e.direction===dn().bH.Right)).sort(((e,t)=>e.height-t.height));let k=h().wq(w,(e=>{const n=Kc(e,t,i).x;return Math.abs(e.left-n)}));if(k){const e=k,t=w.filter((t=>Math.abs(t.left-e.left)<Oc));t.length>0&&(k=h().wq(t,(e=>e.left)))}if(k){const e=k;f.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(M=vc(k))}return{ontoDropZone:S,verticalDropZone:M,horizontalDropZones:b}}({points:{mousePoint:{x:n,y:o},originPoint:{x:n-i,y:o-r}},draggingStore:t[0],isNativeDrag:l,environment:a,pageContext:s,canDragFn:p});if(d.ontoDropZone)dn().Ay.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)dn().Ay.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],n=h().RT(d.horizontalDropZones);if(t.type===dn().OX.Selectable){const o=Bc().T.findSelectableFromStore(t.store);if(o){const i=o.getContextClosestSelectable();let r;return i&&i.props.store!==t.store&&i.props.shouldShowParentHalo&&(r=i.props.store),void dn().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:r})}}else{if(Tc().A.findDropTargetFromKey(t.key))return void dn().Ay.setState({...e,currentDropZone:t,currentHintDropZones:n,currentParentStore:void 0})}}dn().Ay.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}),[a,p,s]),g=(0,o.useCallback)((()=>{if(e.current)throw new Error("Assertion failure, updateDragState() called when isUpdatingDragState === true!");e.current=!0;try{m()}finally{e.current=!1}}),[m]),f=(0,o.useCallback)((()=>{const{isDragging:e}=dn().Ay.state;e&&g()}),[g]),v=(0,o.useCallback)((()=>{t.current=!0}),[]);(0,o.useEffect)((()=>(window.addEventListener("mousemove",l),Gt().default.addListener(c),r.isIOS&&window.addEventListener("touchend",v),window.addEventListener("keydown",f),window.addEventListener("keyup",f),dn().Ay.addListener(d),window.addEventListener("scroll",Hc,!0),window.addEventListener("resize",Gc),Ft().RR.addListener(Yc),zo().sf(),()=>{window.removeEventListener("mousemove",l),Gt().default.removeListener(c),r.isIOS&&window.removeEventListener("touchend",v),window.removeEventListener("keydown",f),window.removeEventListener("keyup",f),dn().Ay.removeListener(d),window.removeEventListener("scroll",Hc,!0),window.removeEventListener("resize",Gc),Ft().RR.removeListener(Yc)})),[r.isIOS,d,c,f,l,v])}function Fc(){const e=Dc().default.state;e.isOpen&&!e.menuIsOpen&&Dc().default.reset()}function Vc(e){return(Gt().default.state.droppableContainerStack||[]).indexOf(e)}function zc(e,t,n,o){var i,r;const a=Dc().default.state;if(a.isOpen&&a.menuIsOpen)return;const s=function(e){const{environment:t,target:n,x:o,y:i,rightMarginCommentActionsEnabled:r}=e;if(Rc().A.state.isResizing||dn().Ay.state.isDragging||Ie().default.state.isActive||Ft().RR.state)return;const{selectableRectMap:a}=uc().default.state,s=Pc().A.getMembersByDOMOrder({filter:e=>{const t=e.getNode();return Boolean(t&&t.contains(n))}})[0];if(!s)return;const l=a.keys();let d=l.next();const c=[],u=[];for(;!d.done;){const e=d.value,n=a.get(e),p=Lc().TH({environment:t,store:e.props.store,selectableBoundingRect:n}),m=Lc().KG({store:e.props.store,selectableBoundingRect:n,containerWidth:p}),g=Lc().mC(e);if((e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===s&&n&&Xa().ux((0,Dc().getExpandedSelectableRect)(n,r,p,m,g),o,i)){for(const t of Dc().HOVER_REGIONS)Xa().ux((0,Dc().getHoverRegionOfRect)(n,t,p,m,g),o,i)&&u.push({selectable:e,hoveredRegion:t});Xa().ux((0,Dc().getExactSelectableRect)(n,r),o,i)&&c.push(e)}d=l.next()}const p=h().Ul(c,(e=>{const t=a.get(e);return t?-t.left:1/0})),m=p.find((e=>{const t=e.getNode();return!t||!p.find((n=>{if(n!==e){const e=n.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return m?{exactSelectable:m,nearbySelectables:u,container:s}:{nearbySelectables:u,container:s}}({environment:e,target:t,x:n,y:o,rightMarginCommentActionsEnabled:!0});if(!s)return void Dc().default.reset();const l=!a.isOpen||(null===(i=s.exactSelectable)||void 0===i?void 0:i.props.store)!==a.currentStore,d=a.isOpen&&(null===(r=s.exactSelectable)||void 0===r?void 0:r.props.store)===a.currentStore;var c,u;l?Dc().default.setState({...a,isOpen:!0,menuIsOpen:!1,container:s.container,nearbySelectables:s.nearbySelectables,currentStore:null===(c=s.exactSelectable)||void 0===c?void 0:c.props.store,selectableBoundingRect:null===(u=s.exactSelectable)||void 0===u||null===(u=u.getNode())||void 0===u?void 0:u.getBoundingClientRect(),mouseX:n,mouseY:o}):d&&Dc().default.setState({...a,nearbySelectables:s.nearbySelectables,mouseX:n,mouseY:o})}function Kc(e,t,n){return yc({device:n.device,target:e.target,points:t})}function Wc(e){return(null==e?void 0:e.priority)??0}function Hc(){zo().AP(),Fc()}function Gc(){zo().AP(),Fc()}function Yc(){const e=Dc().default.state,t=Ft().RR.state;e.isOpen&&!e.menuIsOpen&&t&&Dc().default.reset()}function qc(e){const{target:t,direction:n,optionKeyDown:o,environment:i,pageContext:r,canDragFn:a}=e;if(je().A.state.isOpen&&!Ws().default.state.open)return!1;if(Ce().A.state.isOpen)return!1;const s=dn().Ay.state,l=s.isDragging?s.draggedStores:[],d=!!s.isDragging&&s.isNativeDrag;let c,u,p,m=!1,g=!1;l.find((e=>{const t=_c().A.findOutlinerItemFromStore(e);return!!t&&(c=t,u=t.type,m=t.isTopLevelItem,!0)}));const f=(0,dc().MS)(t)?_c().A.findOutlinerItemFromStore(t.props.store):void 0,h=null==f?void 0:f.parentStore;var v;f&&(p=f.type,g=f.isTopLevelItem||"team"===(null===(v=f.parentStore)||void 0===v?void 0:v.table));if(function(e){var t;const{draggingOutlinerItem:n,selectableOutlinerItemParent:o,direction:i}=e;if(n&&"team"===n.type&&n.isTopLevelItem&&(null===(t=n.parentStore)||void 0===t?void 0:t.pointer.table)===ac().yK){const e=n.parentStore;if(!(n.store.getParentId()===e.pointer.id||o&&o.pointer.id===e.pointer.id&&i!==dn().bH.Onto))return!0}return!1}({draggingOutlinerItem:c,selectableOutlinerItemParent:h,direction:n}))return!1;if(!(0,dc().MS)(t))return t.props.canAcceptDrop({direction:n,draggingStores:l,isNativeDrag:d});const y=t.props.store;if(y.pathIsDead())return!1;if((0,es().dL)(y))return!1;if("suggest"===ts().Uv.getMode(y))return!1;const b=(0,lc().U)(y);if(b&&b.isInTrashStore.state)return!1;const S=y.getAssociatedCollectionStore();if(n===dn().bH.Onto&&S){const e=S.id,t=(0,lc().U)(y),n=null==t?void 0:t.collectionViewBlockStore(),o=null==t?void 0:t.collectionViewStore();if(n&&o&&"page"!==o.getType()){if(l.find((o=>{const i=o.getAssociatedCollectionStore(),r=(0,lc().U)(o);return Boolean(o instanceof re().Bv&&i&&i.id===e)||Boolean(r===t&&y.id!==n.id)})))return!1}}if(n!==dn().bH.Onto){const e=(0,lc().U)(y);if("collectionTypedView"===(null==e?void 0:e.contextType)&&e.databaseType){if(!l.find((t=>{const n=(0,lc().U)(t);return(null==n?void 0:n.databaseType)===e.databaseType})))return!1}}if(t.props.groupsPointer){var x;const e=null===(x=y.getCollectionStore())||void 0===x?void 0:x.getSchema();if(Boolean(t.props.groupsPointer.find((t=>!(0,ic().wj)(t,(null==S?void 0:S.getSchema())??e))))){if(l.find((e=>{var n;const o=Bc().T.findSelectableFromStore(e);return(null==o||null===(n=o.props)||void 0===n?void 0:n.groupsPointer)&&t.props.groupsPointer&&!(0,rc().PZ)(o.props.groupsPointer,t.props.groupsPointer)})))return!1}}if((0,jc().qy)({targets:l,destination:y,direction:n,draggingOutlinerType:u}))return!1;if(o&&l.find((e=>e.isTypedCollectionViewBlock()||(0,sc().sZ)(e))))return!1;if(f&&n!==dn().bH.Onto&&!g&&!(0,bl().ecY)({environment:i,blocks:[f.store],publicEditMode:null==r?void 0:r.publicEditModeStore.state}))return!1;if(p&&d)return!1;if("bookmarks"===u&&m&&("bookmarks"!==p||!g||n===dn().bH.Onto))return!1;if("bookmarks"===p&&g&&n!==dn().bH.Onto&&("bookmarks"!==u||!m))return!1;if(c&&c.isTopLevelItem&&"team"===c.type&&c.parentStore&&c.parentStore.table===ac().yK){const e=c.parentStore,t=re().h4.createChildStore(e,{...e.pointer,table:ac().yK});if(t&&!(0,Cc().dp)({teamStore:t,environment:i}))return!1}if(f&&f.isTopLevelItem&&"team"===f.type&&f.parentStore&&f.parentStore.table===ac().yK){const e=f.parentStore,t=re().h4.createChildStore(e,{...e.pointer,table:ac().yK});if(t&&!(0,Cc().dp)({teamStore:t,environment:i}))return!1}const{currentSpaceViewStore:A}=ne().default.state,M=p?Cc().Kv[p]:void 0;if(A&&f&&c&&M&&f.isTopLevelItem&&n!==dn().bH.Onto&&c.type!==p){const{sortOption:e}=(0,Cc().RQ)({spaceViewStore:A,type:M});if("lastEdited"===e)return!1}if("shared"===p&&g&&n!==dn().bH.Onto&&("shared"!==u||!m))return!1;if(p&&g&&n!==dn().bH.Onto){if(l.find((e=>{const t=e.getType();return Boolean(!t||!rt().BJ[t])})))return!1}const{device:w}=i;if(p&&w.isMobile&&n===dn().bH.Onto&&g)return!1;if(l.some((e=>Boolean(Ic().A.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(Ic().A.findCollectionTemplatePickerItemFromStore(y)))return!1;if(n===dn().bH.Onto&&y&&!(0,bl().p2L)({environment:i,blocks:[y],publicEditMode:null==r?void 0:r.publicEditModeStore.state}))return!1;if(!a(l))return!1;if(l.some((e=>e.isTransclusionType()))){if(y.findRecordStoreUIAncestor((e=>{if(e===y)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getKeyStore("type").getValue();return Boolean(t&&(0,rt().Mp)(t))})).ancestor)return!1}return!0}function $c(){const e=(0,i().Y0)(),t=(0,i().v3)(),{isMobile:n,isElectron:d}=e;(0,o.useEffect)((()=>{if(n){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[n]),(0,o.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,o.useEffect)((()=>{function e(e){Ie().default.state.isActive&&(e.preventDefault(),r().K1({environment:t,currentX:Ie().default.state.currentX,currentY:Ie().default.state.currentY,toggle:e.shiftKey}))}function n(e){Ie().default.state.isActive&&(e.preventDefault(),r().K1({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function o(e){Ie().default.state.isActive&&((0,O().Mb)(e)||e.preventDefault(),r().OG(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",n),window.addEventListener("mouseup",o),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",o)}}),[t]);const c=t.currentUser.isLoggedIn();le(c),Uc();const g=(0,E().D5)();return(0,B.jsxs)(o.Fragment,{children:[(0,B.jsx)(wt,{}),(0,B.jsx)(s().Gc,{}),(0,B.jsx)(s().MC,{}),(0,B.jsx)(he,{}),(0,B.jsx)(Oe().A,{priority:-1,capture:!0,debugName:"AppComponents"}),c&&!n?(0,B.jsx)(qs,{}):void 0,c?(0,B.jsx)(we().AuthSyncListener,{}):void 0,!g&&c?(0,B.jsx)(Bd,{}):void 0,c?(0,B.jsx)(hn,{}):void 0,c?(0,B.jsx)(yn,{}):void 0,!g&&c?(0,B.jsx)(Ne,{}):void 0,c?(0,B.jsx)(ko,{}):void 0,c?(0,B.jsx)(Ae,{}):void 0,c?(0,B.jsx)(_e,{}):void 0,c?(0,B.jsx)(ye,{}):void 0,c?(0,B.jsx)(nc,{}):void 0,g&&c?(0,B.jsx)(Le,{}):void 0,(0,B.jsx)(pn,{}),(0,B.jsx)(Jr,{}),(0,B.jsx)(p().Li,{}),(0,B.jsx)(xa,{}),(0,B.jsx)(pa,{}),(0,B.jsx)(di,{}),(0,B.jsx)(rn,{}),n?void 0:(0,B.jsx)(xs,{}),(0,B.jsx)(Ti,{}),(0,B.jsx)(aa,{}),(0,B.jsx)(Ui().A,{}),(0,B.jsx)(sn().C4,{store:je().A}),(0,B.jsx)(sn().C4,{store:Ce().A}),(0,B.jsx)(a().DV,{}),(0,B.jsx)(Ur,{}),(0,B.jsx)(ke().Tm,{}),(0,B.jsx)(L,{}),(0,B.jsx)(po,{}),(0,B.jsx)(Me().Sd,{}),(0,B.jsx)(Vd,{}),(0,B.jsx)(Ei,{}),(0,B.jsx)(Dd,{}),(0,B.jsx)(Xt,{}),(0,B.jsx)(Zs().A,{}),(0,B.jsx)(pe,{}),d?(0,B.jsx)(u,{}):void 0,(0,B.jsx)(_n,{}),(0,B.jsx)(ln().Y,{}),c?(0,B.jsx)(cd,{}):void 0,(0,B.jsx)(wi().nJ,{}),(0,B.jsx)(Je,{}),(0,B.jsx)(gn().yQ,{}),c?(0,B.jsx)(wn,{}):void 0,(0,B.jsx)(m().h,{}),c?(0,B.jsx)(l()._,{}):void 0]})}},910702:(e,t,n)=>{n.d(t,{zk:()=>k,wm:()=>M,Js:()=>C,H0:()=>T,hk:()=>_});n(296540);var o=()=>n(3284),i=()=>n(919709),r=()=>n(959013),a=()=>n(751156),s=()=>n(67103),l=()=>n(401497),d=()=>n(553965),c=()=>n(962730),u=()=>n(575143),p=()=>n(515918),m=()=>n(859428),g=n(474848);function f(e){let{menuListItemProps:t,title:n,caption:o,icon:i,disabled:r,tooltipText:a,showNewBadge:s}=e;const f=(0,l().IS)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,g.jsx)(m().A,{placement:c().W.Right,disableTooltip:!a,renderTooltip:()=>a,render:e=>(0,g.jsx)(u().A,{...(0,d().A)(t,e),style:f.menuItem,title:n,caption:o,captionStyle:o?f.caption:void 0,svg:i,disabled:r,disabledFeedback:r,right:s&&(0,g.jsx)(p().A,{})})})}var h=()=>n(878377),v=()=>n(37433),y=()=>n(10984),b=()=>n(416726),S=()=>n(843005);const x=(0,r().YK)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}});function A(e,t){return(0,b().Ls)({key:"turn page into team",displayName:t,analyticsName:x.createTeamFromPageFullName.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,render:(e,o)=>{const a=function(e){const{blockStore:t,environment:n}=e;if(!n.currentUser.id)return null;if(0===i().q4_(t.getTitleValue()).length)return(0,g.jsx)(r().sA,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,v().UY)(t).accessLevel&&!(0,y().HO)())return(0,g.jsx)(r().sA,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"});return null}({environment:o.environment,blockStore:o.blocks[0]});return(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(r().sA,{...t}),caption:(0,g.jsx)(r().sA,{...x.createTeamFromPageCaption}),disabled:Boolean(a),tooltipText:a,icon:n(234748).I})},action:e=>{let{blocks:t,environment:o}=e;const i=t[0];n(475355).Vs({environment:o,page:i})}})}const M=A([h().Uo6([h().w2Y,h().AU6(h().d2I)])],x.createTeamFromPageFullName),w=A([h().w2Y],x.createTeamFromPageName),k=(0,b().uk)({key:"turn into teamspace or wiki",displayName:S().DZ.turnIntoSection,analyticsName:S().DZ.turnIntoSection.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:[h().w2Y,h().d2I],subActions:()=>[(0,b().gy)({key:"turn into teamspace or wiki",render:e=>(0,g.jsx)(n(89924).A,{...e}),actions:[w,I]})],width:300});function j(e,t){return(0,b().Ls)({key:"turn page into wiki",displayName:t,analyticsName:x.turnPageIntoWikiFullName.defaultMessage,svg:o().arrowSquarePathUpDownIcon,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:o}=e;"bottom_right"===n(217429).default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?n(816013).r.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:o[0]}):a().createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,canUndo:!0,perform:e=>{s().hJ({environment:t,blocks:o,transaction:e,source:"page_menu"})}})},render:e=>{const i=!n(227440).A.state.online;return(0,g.jsx)(f,{menuListItemProps:e,title:(0,g.jsx)(r().sA,{...t}),disabled:i,icon:o().arrowSquarePathUpDownIcon,tooltipText:i?(0,g.jsx)(r().sA,{...b().AY.unavailableOfflineTooltip}):(0,g.jsx)(r().sA,{...x.turnPageIntoWikiCaption})})}})}const C=j([h().Uo6([h().d2I,h().AU6(h().w2Y)]),h().AU6(h().oy3)],x.turnPageIntoWikiFullName),I=j([h().d2I],x.turnPageIntoWikiName);const T=j([h().d2I,h().AU6(h().oy3)],x.turnPageIntoWikiFullName),_=(0,b().Ls)({key:"undo turn page into wiki",displayName:x.undoTurnPageIntoWikiName,analyticsName:x.undoTurnPageIntoWikiName.defaultMessage,svg:n(454503).arrowUTurnUpLeftIcon,validators:[h().vXb,h().VNy,h().AU6(h().ln6),h().Afv,h().Km9,h().AU6(h().oy3)],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:o}=e;const{accept:l}=await n(901389).Gh({message:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(r().sA,{defaultMessage:'Turn "{pageName}" back into a normal page?',id:"action.undoTurnIntoWiki.message",values:{pageName:i().q4_(o[0].getTitleValue())}})}),description:(0,g.jsx)("div",{style:{textAlign:"center"},children:(0,g.jsx)(r().sA,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})});l&&a().createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,canUndo:!0,isUndoTransaction:!0,perform:e=>{s().nQ({environment:t,blocks:o,transaction:e,source:"page_menu"})}})}})},913687:(e,t,n)=>{n.d(t,{A:()=>o});const o=(0,n(959013).YK)({inputPlaceholder:{defaultMessage:"Property name",id:"database.viewSettings.propertyTab.propertyName"},autofillOffLabel:{defaultMessage:"Off",id:"database.viewSettings.propertyTab.autofillOffLabel"},autofillOnLabel:{defaultMessage:"On",id:"database.viewSettings.propertyTab.autofillOnLabel"},keptUpToDateWithNotionAITooltip:{defaultMessage:"Auto-updated by AI",id:"database.tableHeaderCell.tooltipAiAutofillDescription"},buttonPropertyErrorTooltip:{defaultMessage:"Button property has an error",id:"database.tableHeaderCell.tooltipButtonPropertyError"},offlineWarningFormula:{id:"database.tableHeaderCell.offlineWarning.formula",defaultMessage:"Formula results may not be accurate when offline"},offlineWarningAutoUpdate:{id:"database.tableHeaderCell.offlineWarning.autoUpdate",defaultMessage:"Content will not auto-update when offline"}})},942906:(e,t,n)=>{n.d(t,{Lj:()=>s,W2:()=>l,xw:()=>a});var o=()=>n(416504),i=()=>n(751156),r=()=>n(755199);function a(e){const{environment:t,userSettingsStore:n}=e,i=n.getSettings(),r=null==i?void 0:i.time_zone,a=(0,o().P)();r!==a&&s({environment:t,userSettingsStore:n,timeZone:a})}function s(e){const{environment:t,userSettingsStore:n,timeZone:o}=e;i().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{r().mJ({userSettingsStore:n,transaction:e,data:{time_zone:o}})},userId:n.id})}function l(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:o}=e;i().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{r().mJ({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:o}})},userId:n.id})}},946576:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var o=n(296540),i=()=>n(484714),r=()=>n(401497),a=()=>n(75756),s=()=>n(959013),l=()=>n(284371),d=()=>n(673998),c=()=>n(991385),u=()=>n(799089),p=()=>n(455215),m=()=>n(493823),g=()=>n(204063),f=n(474848);function h(){const e=(0,i().v3)().currentUser.id;(0,o.useEffect)((()=>{if(!e)return;(0,c().S)(e);const t=window.setInterval((()=>{(0,c().S)(e)}),n(720665).nD);return()=>{window.clearInterval(t)}}),[e]);const t=(0,n(56366).K8)((()=>u().A.state.open),[]),r=S();return(0,f.jsx)(n(641514).A,{onDismiss:n(496603).lQ,render:()=>(0,f.jsx)("div",{style:r.modal,children:(0,f.jsxs)(n(21140).Ye,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,f.jsx)("img",{style:r.image,src:n(148307).A.images.feedbackThankYouPng}),(0,f.jsx)("div",{style:r.title,children:(0,f.jsx)(s().sA,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,f.jsx)("div",{style:r.description,children:(0,a().Qq)(d().N6,"banner")}),(0,f.jsx)(v,{}),(0,f.jsx)(y,{}),(0,f.jsx)(b,{})]})}),isOpen:t})}function v(){const e=S(),t=(0,i().v3)();return(0,f.jsx)(g().A,{size:"lg",style:e.acceptAllButton,onClick:()=>{d().Vg(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),u().A.setState({open:!1}),d().wB()},children:(0,f.jsx)(s().sA,{...a().LS.acceptAllButtonLabel})})}function y(){const e=S(),t=(0,i().v3)();return(0,f.jsx)(m().p,{size:"lg",isGray:!0,style:e.moreOptionsButton,onClick:()=>{d().Vg(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),u().A.setState({open:!1}),d().wB()},children:(0,f.jsx)(s().sA,{...a().LS.rejectAllButtonLabel})})}function b(){const e=S();return(0,f.jsx)(p().A,{hasDismissButton:!0,onDismiss:()=>{u().A.setState({open:!1})},renderOrigin:t=>(0,f.jsx)(m().p,{...t,size:"lg",isGray:!0,style:e.moreOptionsButton,children:(0,f.jsx)(s().sA,{...a().LS.moreOptionsButtonLabel})})})}function S(){return(0,r().IS)((e=>({modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.text.primary,fontWeight:l().Wy.semibold,fontSize:18},description:{color:e.text.secondary,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}})),[])}const x=o.memo(h)},952305:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});n(296540);var o=()=>n(484714),i=()=>n(56366),r=()=>n(401497),a=()=>n(148307),s=()=>n(959013),l=()=>n(284371),d=()=>n(209660),c=()=>n(963575),u=()=>n(931432),p=()=>n(493823),m=()=>n(676007),g=()=>n(204063),f=n(474848);function h(){const e=(0,o().Y0)(),t=(0,i().K8)((()=>u().A.state.open),[]),n=()=>{u().A.state.open&&u().A.state.onDecline&&u().A.state.onDecline(),u().A.setState({open:!1})},h=()=>{u().A.state.open&&u().A.state.onConfirm(),u().A.setState({open:!1})},v=()=>{n(),d().Ow({currentTab:"connected_apps"})},y=(0,r().IS)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:l().Wy.medium,marginTop:15,marginBottom:20,color:e.text.secondary}})),[]);return(0,f.jsx)(m().a,{open:t,innerStyle:y.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,f.jsxs)("div",{style:y.modalHeaderWrap,children:[(0,f.jsx)("img",{src:a().A.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,f.jsx)("div",{style:y.modalMessage,children:(0,f.jsx)(s().sA,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,f.jsx)("div",{style:y.modalMessage,children:(0,f.jsx)(s().sA,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,f.jsx)(g().A,{size:"lg",onClick:h,children:(0,f.jsx)(s().sA,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),e.isMobile?void 0:(0,f.jsx)("div",{style:{display:"block",marginTop:c().A.vertical.tiny},children:(0,f.jsx)(p().p,{isGray:!0,size:"xs",showUnderline:!0,onClick:v,children:(0,f.jsx)(s().sA,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]}),onDismiss:n})}},954845:(e,t,n)=>{n.d(t,{J:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("blueCircleDot",{viewBox:"0 0 16 16",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("circle",{cx:"8",cy:"8",r:"8",fill:"none",stroke:"#2383E2",children:[(0,o.jsx)("animate",{attributeName:"r",from:"3",to:"8",dur:"1s",begin:"0s",repeatCount:"indefinite"}),(0,o.jsx)("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",begin:"0s",repeatCount:"indefinite"})]}),(0,o.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"#2383E2"})]})})},955450:(e,t,n)=>{n.d(t,{K:()=>d});var o=()=>n(484714),i=()=>n(56366),r=()=>n(106412),a=()=>n(963589),s=()=>n(765957),l=()=>n(583238);function d(e){const{collectionContextStore:t}=e,n=(0,o().v3)(),d=(0,r().Zp)(),c=(0,i().O$)(t.normalizedSchemaStore),u=(0,i().K8)((()=>t.collectionViewStore()),[t]),p=(0,i().K8)((()=>null==u?void 0:u.getType()),[u]),m=(0,a().X)("notion_calendar_db_integration_non_time_views"),g=(0,i().K8)((()=>(0,l().JF)({environment:n,spaceStore:s().default.state.currentSpaceStore,schema:c,collectionContextType:t.contextType,collectionViewType:p,enableForNonTimeBasedViews:m})),[n,c,t,p,m]);return Boolean(g)&&!(null!=d&&d.disablePageLinks)}},957568:(e,t,n)=>{n.r(t),n.d(t,{createRelationViewsModule:()=>m});var o=()=>n(970013),i=()=>n(206267),r=()=>n(179034),a=()=>n(869558),s=()=>n(183558),l=()=>n(44729),d=()=>n(246826),c=()=>n(751156),u=()=>n(594794),p=()=>n(630116);function m(e){const{environment:t,layoutStore:n,collectionStore:m,relationPropertyId:g}=e,f=m.getSchema(),h=g?f[g]:void 0;if(!h||!(0,o().nC)(h))return;const v=o().Nv(h);if(!v)return;const y=h.property;if(!y)return;const b=p().md.createChildStore(m,v);if(!b)return;const S=b.getParentBlockStore();if(!S)return;const{performResult:x}=c().createAndCommit({environment:t,perform:e=>{const{inMemoryRecordCache:o}=S,p=d().Wv({environment:t,type:"collection_view",inMemoryRecordCache:o,transaction:e}),m=S.getSpaceId(),g=(0,s().Ay)(),f=(0,u().JH)({environment:t,table:a().Gy,spaceId:m}).id,v=p.pointer,x={id:f,type:"table",parent_id:v.id,parent_table:r().ev,space_id:m,alive:!0,name:h.name,format:{collection_pointer:b.pointer,property_filters:[{id:i().JW(),filter:{property:y,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"current_page_in_related_collection"}}}}}],subitem_display_mode:"disabled",hide_linked_collection_name:!0}};c().applyOperation({store:p,operation:{pointer:p.pointer,path:["view_ids"],command:"listAfter",args:{id:f}},transaction:e}),l().NI({childStore:p,parentStore:n,transaction:e}),d().eC({environment:t,table:a().Gy,value:x,inMemoryRecordCache:o,transaction:e});return{id:g,type:"views",collection_view_block_pointer:{...v,spaceId:m}}},canUndo:!0,userAction:"viewsModuleActions.createRelationViewsModule"});return x}},963248:(e,t,n)=>{n.d(t,{v:()=>M});n(898992),n(823215);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(401497),s=()=>n(245241),l=()=>n(959013),d=()=>n(372657),c=()=>n(810703),u=()=>n(135599),p=()=>n(963589),m=()=>n(765957),g=()=>n(970585),f=()=>n(845566),h=()=>n(188669),v=()=>n(40851),y=()=>n(572748),b=()=>n(587989),S=()=>n(258805),x=()=>n(142662),A=n(474848);function M(e){return(0,p().X)("move_to_menu_use_search_results_hook")?(0,A.jsx)(k,{...e}):(0,A.jsx)(w,{...e})}function w(e){const{targetBlocks:t,isCreateIn:n,onAccept:s,isAddTo:u,isTurnIntoPage:p,parentBlockId:h,autocompleteQuery:y,forceShowPrivatePageOption:M=!1}=e,w=(0,l().tz)(),k=(0,a().DP)(),j=(0,i().v3)(),C=(0,r().uB)(void 0,g().A),I=(0,r().uB)(void 0,v().A),T=(0,r().uB)(void 0,f().A),_=(0,r().K8)((()=>t.length>0&&t.every((e=>e.isNavigableBlock()))),[t]),P=(0,o.useCallback)((e=>async function(e,t,n,o,i,r,a,s,l,u,p,g,f){const{currentUserRootStore:h,currentSpaceStore:v}=m().default.state,{query:y}=e,b=p.getChosenSpaceStore();if(!h||!b||!v)return[];const x=(0,c().pw)({spaceStore:b,currentUserId:t.currentUser.id}),{blockResults:A,topLevelBlockResults:M,templateResults:w,recentPageResults:k}=await(0,S().aE)(b,y,o,i,t,v),j=await x;if(d().n6())return await(0,S().N$)({chosenSpaceStore:b,savedQuickAddParent:j,query:y,blockResults:A,recentPageResults:k},t,i,r,o,a,p,g);if(i)return(0,S().wU)({allTargetsAreNavigable:g,blockResults:A,chosenSpaceStore:b,environment:t,isAddTo:a,isCreateIn:i,isTurnIntoPage:s,moveToSpaceMenuStore:p,onAccept:r,parentBlockId:l,query:y,recentPageResults:k,targets:o,templateResults:w,topLevelBlockResults:M});return(0,S().OC)({allTargetsAreNavigable:g,blockResults:A,chosenSpaceStore:b,environment:t,forceShowPrivatePageOption:f,intl:u,isAddTo:a,isCreateIn:i,moveToSpaceMenuStore:p,onAccept:r,query:y,recentPageResults:k,savedQuickAddParent:j,targets:o,theme:n})}(e,j,k,t,n,s,u,p,h,w,T,_,M)),[j,k,t,n,s,u,p,h,w,T,_,M]),B=(0,r().K8)((()=>{var e;return null===(e=(0,S().wc)(T))||void 0===e?void 0:e.id}),[T]),L=(0,r().K8)((()=>!I.state.ready&&y.length>0),[I,y]);return(0,A.jsx)(x().du,{...e,isLoading:L,allTargetsAreNavigable:_,autocompleteComponent:(0,A.jsx)(b().b,{query:y,spaceId:B,menuListStore:C,requestStore:I,getAutocompleteItems:P})})}function k(e){const{autocompleteQuery:t,forceShowPrivatePageOption:n=!1,isAddTo:o,isCreateIn:i,isTurnIntoPage:a,onAccept:l,parentBlockId:d,targetBlocks:c}=e,p=(0,r().uB)(void 0,g().A),m=(0,r().uB)(void 0,f().A),v=(0,r().K8)((()=>(0,S().wc)(m)),[m]),M=(0,r().K8)((()=>c.length>0&&c.every((e=>e.isNavigableBlock()))),[c]),w=(0,r().K8)((()=>(0,S().L2)(h().Ay.state)),[]),k=(0,u().W)({type:s().Vz.BlocksInSpace,query:t,limit:w,source:"move_to_menu",filters:{requireEditPermissions:!1,excludeTemplates:!1},options:{disable:!1,overrideSpaceStore:v}}),j=(0,y().t)({allTargetsAreNavigable:M,forceShowPrivatePageOption:n,isAddTo:o,isCreateIn:i,isTurnIntoPage:a,onAccept:l,parentBlockId:d,query:t,searchResults:k,targets:c});return(0,A.jsx)(x().du,{...e,isLoading:k.isResultsLoading,allTargetsAreNavigable:M,autocompleteComponent:(0,A.jsx)(b().c,{sections:j,error:void 0,menuListStore:p,initialFocus:t?0:void 0,loading:k.isResultsLoading,canLoadMore:k.hasMoreResults,onLoadMore:()=>{var e;return null===(e=k.fetchAdditionalServerResultsOnChange)||void 0===e?void 0:e.call(k,w)}})})}},965731:(e,t,n)=>{n.r(t),n.d(t,{ConfigureViewsMainModuleAddViewButton:()=>v});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(484714),r=()=>n(56366),a=()=>n(970013),s=()=>n(959013),l=()=>n(686526),d=()=>n(760217),c=()=>n(939740),u=()=>n(89924),p=()=>n(962730),m=()=>n(377586),g=()=>n(937199),f=n(474848);const h=(0,s().YK)({relatedToDatabase:{defaultMessage:"Related to {database}",id:"pageLayout.configureViews.relatedToDatabase"},linkExistingDatabase:{defaultMessage:"Link existing database",id:"pageLayout.configureViews.linkAnExistingDatabase"}}),v=o.memo((function(e){const{renderOrigin:t,onClose:s}=e,d=(0,i().v3)(),[c,u]=(0,o.useState)(!1),h=(0,o.useRef)(null),{layoutStore:v}=(0,g().LH)(),S=(0,o.useContext)(g().sf),x=null==S?void 0:S.moduleStateByIdStore,A=(0,r().K8)((()=>{var e;const t=v.getModuleByType("viewsMain");if(t)return null==x||null===(e=x.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[v,x]),M=(0,o.useCallback)(((e,t)=>{A&&((0,n(180762).t)({environment:d,collectionContextStore:A,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),l().Ow({collectionContextStore:A,collectionSettingsStore:A.settingsStore,closeOnEscape:!1}))}),[d,A]),w=(0,r().K8)((()=>{var e;const t=null===(e=v.getParentStore())||void 0===e?void 0:e.getModel();if((null==t?void 0:t.table)===n(519831).Vl)return t}),[v]),k=(0,r().K8)((()=>{const e=null==w?void 0:w.getNormalizedSchema();return Object.entries(e??{}).filter((e=>{let[t,o]=e;return(0,n(534177).O9)(o)&&(0,a().nC)(o)&&o.property}))}),[w]),j=(0,o.useCallback)((()=>{u(!1),null==s||s()}),[s]),C=(0,o.useCallback)((()=>{u(!0)}),[u]),I=(0,o.useMemo)((()=>n(757695).Store.createValue({open:!1,stack:[]},{name:"newViewsCreationMenuCollectionSettingsStore"})),[]),T=(0,o.useCallback)((()=>{const e=null==A?void 0:A.viewsModuleContextStore.getViewsModule();e&&l().R8({collectionSettingsStore:I,item:{type:"selectViewsModuleSource",module:e}})}),[null==A?void 0:A.viewsModuleContextStore,I]),_=(0,o.useCallback)((()=>{l().os({collectionSettingsStore:I})}),[I]),P=(0,o.useCallback)((()=>(0,f.jsx)(y,{setIsOpen:u,onClose:s,relations:k,setCurrentViewPointer:M,collectionModel:w,viewsMainModuleCollectionContextStore:A,openViewsCreationPopup:T})),[s,k,M,w,A,T]),B=(0,o.useCallback)((e=>t(e)),[t]);return A&&w?(0,f.jsxs)("div",{ref:h,children:[(0,f.jsx)(n(406699).Ay,{alignmentToOrigin:p().C.Center,popupType:m().n.Popup,onClose:j,onClick:C,open:c,render:P,renderOrigin:B,disablePopup:!0}),(0,f.jsx)(b,{buttonRef:h,viewsMainModuleCollectionContextStore:A,viewsCreationMenuCollectionSettingsStore:I,openViewsCreationPopup:T,closeViewsCreationPopup:_})]}):null})),y=o.memo((function(e){const{setIsOpen:t,onClose:r,relations:l,setCurrentViewPointer:p,collectionModel:m,viewsMainModuleCollectionContextStore:v,openViewsCreationPopup:y}=e,b=(0,i().v3)(),S=(0,n(401497).DP)(),{layoutStore:x,setModuleSelection:A}=(0,g().LH)(),M=(0,o.useMemo)((()=>{if(0!==l.length)return{key:0,items:[],render:e=>(0,f.jsx)(u().A,{...e,title:(0,f.jsx)(s().sA,{...h.relatedToDatabase,values:{database:null==m?void 0:m.getName()}}),children:l.map((e=>{let[t,o]=e;return(0,f.jsx)(d().A,{title:null==o?void 0:o.name,icon:(0,f.jsx)(n(743176).zB,{size:16,theme:S,icon:null==o?void 0:o.icon,type:"relation"}),focused:!1,onClick:()=>{if(!v)return;const{viewsMainModule:e,collectionViewPointer:i}=(0,n(626318).ZX)({environment:b,layoutStore:x,relationPropertyId:(null==o?void 0:o.property)??t,targetCollectionPointer:(0,a().Nv)(o)??(null==m?void 0:m.pointer),viewName:null==o?void 0:o.name,viewIcon:null==o?void 0:o.icon});e&&A({type:"existing_module",moduleId:e.id,isDragging:!1}),i&&(n(908006).default.afterNextFlush((()=>{p(i,null==e?void 0:e.id),null==r||r()})),v&&(0,n(154017).b)({environment:b,view_type:"table",collectionContextStore:v,from:"viewsMain"}))}},t)}))})}}),[v,m,b,x,r,l,p,A,S]),w=(0,o.useMemo)((()=>{const e=l.length>0;return{key:1,items:[],render:t=>(0,f.jsx)(u().A,{...t,topBorder:e,children:(0,f.jsx)(d().A,{title:(0,f.jsx)(s().sA,{...h.linkExistingDatabase}),icon:(0,f.jsx)(n(745266).h,{color:"regular",viewType:"table"}),onClick:()=>{y()},focused:!1},"link_existing_database")})}}),[y,l.length]);return(0,f.jsx)(n(928600).A,{menuType:n(722872).gu.Popup,onClick:()=>t(!1),width:270,paddingBottom:2,children:(0,f.jsx)(c().Ay,{initialFocus:void 0,sections:[M,w].filter((e=>void 0!==e)),type:c().Oh.Vertical})})})),b=o.memo((function(e){var t;const{buttonRef:i,viewsMainModuleCollectionContextStore:a,viewsCreationMenuCollectionSettingsStore:s,closeViewsCreationPopup:l}=e,d=(0,r().K8)((()=>s.state.open),[s]),c=(0,o.useCallback)((()=>{l()}),[l]),u=(0,o.useCallback)((()=>(0,f.jsx)(n(578565)._,{context:n(525432).Bd.TopbarFilterPopup,collectionContextStore:a,collectionSettingsStore:s,hideDesktopHeader:!0})),[s,a]);return(0,f.jsx)(n(897119).Ay,{open:d,trapFocus:!0,popupType:m().n.Popup,render:u,originRect:null===(t=i.current)||void 0===t?void 0:t.getBoundingClientRect(),alignmentToOrigin:p().C.Center,placementToOrigin:p().W.Bottom,enableOutsideClickDismiss:!0,originGap:4,onDismiss:c})}))},966711:(e,t,n)=>{n.d(t,{m:()=>r});var o=()=>n(56366),i=()=>n(396301);function r(){return(0,o().K8)((()=>(0,i().VR)()),[])}},971320:(e,t,n)=>{n.d(t,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const i=new o},975081:(e,t,n)=>{n.r(t),n.d(t,{PageLayoutEditor:()=>io});var o=n(296540),i=()=>n(402014),r=()=>n(484714),a=()=>n(56366),s=()=>n(401497),l=()=>n(387964),d=()=>n(22634),c=()=>n(959013),u=()=>n(534177),p=()=>n(145214),m=()=>n(285790),g=()=>n(2143),f=()=>n(852302),h=()=>n(859428),v=()=>n(21140),y=()=>n(972435),b=()=>n(962730),S=()=>n(756279),x=()=>n(204521),A=()=>n(524165),M=()=>n(812412),w=()=>n(542371),k=()=>n(263711),j=()=>n(148307),C=()=>n(651124),I=()=>n(390066),T=()=>n(738418),_=()=>n(284371),P=()=>n(334261),B=()=>n(896628),L=()=>n(751156),R=()=>n(115552),D=()=>n(678553),N=()=>n(946548),O=()=>n(867159),E=()=>n(645873);const U={switchFromSimpleToTabbedLayoutActions:new(E().O2)("switchFromSimpleToTabbedLayoutActions",(async()=>n.e(63990).then(n.bind(n,288143)))),switchFromTabbedToSimpleLayoutActions:new(E().O2)("switchFromTabbedToSimpleLayoutActions",(async()=>n.e(61362).then(n.bind(n,434867)))),createRelationViewsModuleActions:new(E().O2)("createRelationViewsModuleActinos",(async()=>Promise.resolve().then(n.bind(n,957568)))),deleteViewsModuleDependenciesActions:new(E().O2)("deleteViewsModuleDependenciesActions",(async()=>Promise.resolve().then(n.bind(n,658616))))};n(944114),n(581454);var F=()=>n(970013),V=()=>n(743176),z=()=>n(340498),K=n(474848);const W=(0,z().wt)("propertyText",{viewBox:"0 0 26 17",svg:(0,K.jsx)("path",{d:"M0.066 16V15.296L1.342 14.79L6.688 1.282L7.436 1.172L8.206 0.952L13.266 14.79L14.762 15.274V16H9.108V15.274L10.978 14.768L9.636 10.918H4.268L2.992 14.504L5.104 15.274V16H0.066ZM6.974 3.372L4.752 9.598H9.174L6.996 3.372H6.974ZM18.5422 16.33C17.3762 16.33 15.9022 15.516 15.9022 13.756C15.9022 11.996 17.1782 11.204 19.4442 10.61L21.7102 10.016V8.872C21.6662 7.178 20.7862 6.298 19.6202 6.298C18.9602 6.298 18.4102 6.584 18.2342 6.694L18.1462 8.872C18.1462 8.872 17.5962 8.938 17.2662 8.938C16.5622 8.938 16.2102 8.586 16.2102 7.992C16.2102 6.98 18.1462 5.374 20.4122 5.374C22.6342 5.374 23.6022 6.386 23.6022 8.564V14.504C23.6022 14.944 23.7122 15.098 24.3282 15.098H25.4282V15.714C25.4282 15.714 24.1522 16.264 23.3382 16.264C22.2162 16.264 21.7542 15.494 21.7542 14.548H21.6882C20.4562 15.714 19.9282 16.33 18.5422 16.33ZM19.7082 14.834C20.7642 14.834 21.4462 14.042 21.7102 13.646V10.742L19.5982 11.446C18.5642 11.798 17.9042 12.216 17.9042 13.14C17.9042 14.262 18.7622 14.834 19.7082 14.834Z"})});var H=()=>n(381138),G=()=>n(760217),Y=()=>n(419357),q=()=>n(939740),$=()=>n(89924),Q=()=>n(175116),Z=()=>n(852353),X=()=>n(937199),J=()=>n(369186),ee=()=>n(183558),te=()=>n(978846);function ne(e){const{propertyId:t,propertyType:n,environment:o,transaction:i,layoutStore:r,collectionStore:a,currentModuleSelection:s,sessionId:l,isPropertyCreation:d}=e,c=r.getModel(),u=a.getModel();if(!c||!u||"new_module"!==(null==s?void 0:s.type))return;const p={id:(0,ee().Ay)(),type:"property",propertyId:t,style:"expanded"};if("person"===n||"created_by"===n||"last_edited_by"===n?p.config={property_person:{style:"compact"}}:"number"===n&&(p.config={property_number:{style:"large"}}),"form_conditional_modules"===s.area)return;const m=(0,J().dI)({collectionModel:u,module:p});return(0,te().UQ)({environment:o,transaction:i,layoutStore:r,position:"views_main_tab_modules"===s.area?{type:"area_relative",area:s.area,viewId:s.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:s.area,location:"end_moveable"},module:m,sessionId:l,isPropertyCreation:d}),p}function oe(){const e=(0,r().v3)(),{layoutStore:t,currentModuleSelection:i,setModuleSelection:a,sessionId:s}=(0,X().LH)(),{collectionStore:l}=(0,X().bi)();return(0,o.useCallback)((o=>{let{propertyType:r,isPropertyCreation:d}=o;const{performResult:c}=L().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.handleCreateNewStandardProperty",environment:e,canUndo:!0,perform:o=>{const a=t.getModel(),c=l.getModel();if(!a||!c||"new_module"!==(null==i?void 0:i.type))return;return ne({propertyId:n(235191).IL({environment:e,collectionStore:l,collectionViewArgs:void 0,propertyName:Z().dC[r],propertyType:r,transaction:o}),propertyType:r,environment:e,transaction:o,layoutStore:t,collectionStore:l,currentModuleSelection:i,sessionId:s,isPropertyCreation:d})}});c&&a({type:"existing_module",moduleId:c.id,isDragging:!1})}),[e,a,t,l,i,s])}function ie(){const e=(0,r().v3)(),{layoutStore:t,currentModuleSelection:n,setModuleSelection:i,sessionId:a}=(0,X().LH)(),{collectionStore:s}=(0,X().bi)();return(0,o.useCallback)((o=>{const{propertyId:r,propertyType:l}=o,{performResult:d}=L().createAndCommit({userAction:"AddPageLayoutModuleEditorSidebar.AddPropertyAsNewModule",environment:e,canUndo:!0,perform:o=>ne({propertyId:r,propertyType:l,environment:e,transaction:o,layoutStore:t,collectionStore:s,currentModuleSelection:n,sessionId:a,isPropertyCreation:!1})});return d?(i({type:"existing_module",moduleId:d.id,isDragging:!1}),d):null}),[e,i,t,s,n,a])}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520);var re=()=>n(713998),ae=()=>n(778781),se=()=>n(248064);function le(e){return void 0!==e[1]}function de(e){let{propertySortPriority:t,defaultCount:i,moreButtonStyle:r,moreButtonTitleStyle:s,isSearching:l}=e;const{layoutStore:d}=(0,X().LH)(),{collectionStore:p}=(0,X().bi)(),m=(0,se().h)(),g=(0,a().K8)((()=>{const e=d.getModules();return new Set((0,n(36682).Q)(e).filter(ae().gx).map((e=>e.propertyId)))}),[d]),[f,h]=o.useState(!1);return(0,a().K8)((()=>{const e=p.getSchema();if(!d.getModel())return[];const o=(0,u().WP)(e).filter(le).sort(((e,n)=>{const o=e[1],i=n[1];return(t[o.type]??1/0)-(t[i.type]??1/0)})).map((e=>{let[t,o]=e;if(t!==F().rn&&!g.has(t))return(0,F().JY)(o)?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"compact"}:(0,F().AM)(o)?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"large"}:"formula"===o.type?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:(0,n(708685).isNumberFormulaPropertySchema)(o)?"large":"small"}:"file"===o.type?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"landscape"}:"place"===o.type?{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t,style:"map"}:{id:(0,ee().Ay)(),type:`property_${o.type}`,propertyId:t}})).filter(u().O9).map((t=>{const o=(0,re()._g)({schema:e,property:t.propertyId});if(o)return{key:t.id,keywords:[o.name,Z().dC[o.type]],render:e=>{let{ref:o,...i}=e;return(0,K.jsx)(n(63667).k,{...i,propertyId:t.propertyId})},action:()=>{m({layoutModule:t})}}})).filter(u().O9),a={keywords:[],key:"use-existing-property-show-more",render:e=>(0,K.jsx)(G().A,{...e,buttonStyle:r,desktopTitleStyle:s,title:f?(0,K.jsx)(c().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,K.jsx)(c().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>h((e=>!e))};return o.length>i&&!l?[...f?o:o.slice(0,i),a]:o}),[m,p,d,g,t,i,f,r,s,l])}var ce=()=>n(478573);function ue(e){const{propertyId:t}=e,{collectionStore:n}=(0,X().bi)(),o=(0,s().DP)(),i=(0,a().K8)((()=>{const e=n.getSchema();return(0,re()._g)({schema:e,property:t})}),[n,t]);return i?(0,K.jsx)(ce().A,{...e,icon:(0,K.jsx)(V().zB,{size:16,theme:o,icon:i.icon,type:i.type}),name:i.name}):null}function pe(){const{layoutStore:e,currentModuleSelection:t}=(0,X().LH)(),{collectionStore:i}=(0,X().bi)(),s=(0,n(963589).X)("collection_view_module"),l=(0,r().v3)(),d=(0,se().h)(),c=(0,o.useCallback)((t=>{const o=(0,n(957568).createRelationViewsModule)({environment:l,collectionStore:i,relationPropertyId:t,layoutStore:e});o&&d({layoutModule:o})}),[d,i,e,l]),p=(0,a().K8)((()=>"new_module"===(null==t?void 0:t.type)&&"page_details"===t.area),[t]);return(0,a().K8)((()=>{if(!s||p)return[];const t=i.getSchema();if(!e.getModel())return[];return Object.keys(t).filter((e=>{const n=null==t?void 0:t[e];return n&&(0,F().nC)(n)&&(0,u().O9)(n.property)})).map((e=>{const n=(0,re()._g)({schema:t,property:e});if(n)return{key:e,keywords:[n.name],render:t=>{let{ref:n,...o}=t;return(0,K.jsx)(ue,{...o,propertyId:e})},action:()=>{c(e)}}})).filter(u().O9)}),[s,p,i,e,c])}const me=(0,c().YK)({addToPage:{id:"AddPageLayoutModuleEditorSidebar.addToPage",defaultMessage:"Add to page"},addToPanel:{id:"AddPageLayoutModuleEditorSidebar.addToPanel",defaultMessage:"Add to panel"},suggestedModulesSectionTitle:{defaultMessage:"Suggested",id:"AddPageLayoutModuleEditorSidebar.suggestedModulesSectionTitle"},existingPropertiesSectionTitle:{defaultMessage:"Use an existing property",id:"AddPageLayoutModuleEditorSidebar.existingPropertiesSectionTitle"},relatedCollectionPropertiesSectionTitle:{defaultMessage:"Add a database view",id:"AddPageLayoutModuleEditorSidebar.relatedCollectionPropertiesSectionTitle"},createNewPropertyModuleSectionTitle:{defaultMessage:"Create new property",id:"AddPageLayoutModuleEditorSidebar.createNewPropertyModuleSectionTitle"},closeAddModulesMenu:{defaultMessage:"Close add modules menu",id:"AddPageLayoutModuleEditorSidebar.closeAddModulesMenu"},searchInputPlaceholder:{defaultMessage:"Search...",id:"AddPageLayoutModuleEditorSidebar.searchInputPlaceholder"},propertyFileCaption:{id:"AddPageLayoutModuleButton.tooltip.files.caption",defaultMessage:"Add images, videos, or files"},propertyAiSummaryCaption:{id:"AddPageLayoutModuleButton.tooltip.aiSummary.caption",defaultMessage:"Use AI to summarize the page"},propertyPersonCaption:{id:"AddPageLayoutModuleButton.tooltip.person.caption",defaultMessage:"Add anyone in your workspace"},propertyTextCaption:{id:"AddPageLayoutModuleButton.tooltip.text.caption",defaultMessage:"Just start writing with plain text"},propertyNumberCaption:{id:"AddPageLayoutModuleButton.tooltip.number.caption",defaultMessage:"Display numbers with rings or bars"}}),ge={file:{icon:j().A.images.layouts.configuration.propertyFilesMediaPreviewJpg,tooltip:{image:j().A.images.layouts.configuration.propertyFilesMediaPreviewLargePng,caption:me.propertyFileCaption}},ai_summary:{icon:j().A.images.layouts.configuration.propertyAiSummaryPreviewPng,tooltip:{image:j().A.images.layouts.configuration.propertyAiSummaryPreviewLargePng,caption:me.propertyAiSummaryCaption}},person:{icon:j().A.images.layouts.configuration.propertyPersonPreviewPng,tooltip:{image:j().A.images.layouts.configuration.propertyPersonPreviewLargePng,caption:me.propertyPersonCaption}},text:{icon:W,tooltip:{image:j().A.images.tooltips.blocks.textPng,caption:me.propertyTextCaption}},number:{icon:j().A.images.layouts.configuration.propertyNumberPreviewPng,tooltip:{image:j().A.images.layouts.configuration.propertyNumberPreviewLargePng,caption:me.propertyNumberCaption}}},fe={file:1,ai_summary:2,number:3,text:4,person:5},he=o.memo((function(){const e=(0,r().v3)(),t=(0,s().DP)(),i=(0,c().tz)(),{currentModuleSelection:l,isPropertyTypeSearchInputDirtyStore:d}=(0,X().LH)(),u=(0,Q().ET)(),p="new_module"===(null==l?void 0:l.type)&&"page_details"===l.area,m=(0,a().K8)((()=>[...(0,Z().xm)({collectionContextStore:u,environment:e}),"ai_summary"].sort(((e,t)=>(fe[e]??1/0)-(fe[t]??1/0)))),[u,e]),g=pe(),[f,h]=(0,o.useState)(!1),[y,b]=(0,o.useState)(),S=(0,o.useCallback)((e=>{d.setState(!0),b(e.target.value)}),[d]);o.useEffect((()=>()=>{d.setState(!1)}),[d]);const x=oe(),A=ie(),M=(0,o.useMemo)((()=>({actionHandler:e=>x({propertyType:e,isPropertyCreation:!0}),tooltip:e=>{const t=ge[e];return null==t?void 0:t.tooltip},renderIcon:e=>{const n=ge[e],o="dark"===t.mode&&null!=n&&n.darkModeIcon?null==n?void 0:n.darkModeIcon:null==n?void 0:n.icon;return o&&"string"!=typeof o?o({width:20,fill:"light"===t.mode?"rgba(79, 79, 79, 1)":(0,V().P0)({theme:t,willShowOnTooltip:!1})}):(0,K.jsx)(V().zB,{size:o?36:16,theme:t,type:e,icon:o,style:{fill:(0,F().hN)(e)?t.aiPurpleColor:void 0}})},propertySettingsPopupProps:e=>"relation"!==e?null:{settingsViewToOpen:{property:void 0,type:"selectRelationSource",formatKey:"page_view_properties"},isPropertyEditComplete:e=>Boolean((0,F().nC)(e)&&e.collection_id),onPropertyEditComplete:t=>{A({propertyId:t,propertyType:e})},rollbackIfEditIncomplete:!0}})),[x,t,A]),w=(0,n(959733).g)(M),k=(0,s().IS)((e=>({sidebarHeading:{fontSize:16,lineHeight:"24px",fontWeight:_().Wy.medium,marginLeft:8,paddingBottom:2},searchInputContainer:{marginTop:8,marginBottom:14,marginLeft:6},searchInput:{background:e.contentBackground},searchInputIcon:{fill:e.icon.secondary,width:10},moreButton:{marginLeft:0},moreButtonTitle:{margin:0,color:e.text.tertiary,fontSize:12,padding:"0 0 0 6px"},sectionTitle:{padding:"0 0 0 6px"}})),[]),j=(0,a().K8)((()=>{const e=y||f,t={keywords:[],key:"create-new-property-more",render:e=>(0,K.jsx)(G().A,{...e,buttonStyle:k.moreButton,desktopTitleStyle:k.moreButtonTitle,title:f?(0,K.jsx)(c().sA,{defaultMessage:"Less",id:"layoutBuilderProperties.less.buttonTitle"}):(0,K.jsx)(c().sA,{defaultMessage:"More",id:"layoutBuilderProperties.more.buttonTitle"})}),action:()=>h((e=>!e))};return[...m.slice(0,e?void 0:5).map(w),...y?[]:[t]]}),[m,f,w,y,k.moreButton,k.moreButtonTitle]),C=de({propertySortPriority:fe,defaultCount:4,moreButtonStyle:k.moreButton,moreButtonTitleStyle:k.moreButtonTitle,isSearching:Boolean(y)}),I=(0,o.useMemo)((()=>{const e=[];return C.length>0&&e.push({key:"existing-properties",render:e=>(0,K.jsx)($().A,{title:i.formatMessage(me.existingPropertiesSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:C}),e.push({key:"create-new-properties",render:e=>(0,K.jsx)($().A,{title:i.formatMessage(me.createNewPropertyModuleSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:j}),g.length>0&&e.push({key:"related-collection-properties",render:e=>(0,K.jsx)($().A,{title:i.formatMessage(me.relatedCollectionPropertiesSectionTitle),desktopTitleStyle:k.sectionTitle,...e}),items:g}),e}),[j,C,i,g,k.sectionTitle]);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(v().Ye,{style:k.sidebarHeading,alignItems:"center",children:(0,K.jsx)(c().sA,{...p?me.addToPanel:me.addToPage})}),(0,K.jsx)(Y().Ay,{focusInitial:!0,onChange:S,placeholder:i.formatMessage(me.searchInputPlaceholder),showClearButton:!0,value:y||"",style:k.searchInputContainer,inputOuterStyle:k.searchInput,inputLeft:(0,H().q)(k.searchInputIcon),itemMarginLeft:0}),(0,K.jsx)(n(387881).j,{filterQuery:y,initialFocus:0,type:q().Oh.Vertical,sections:I})]})}));var ve=()=>n(435930),ye=(n(803949),()=>n(124672)),be=()=>n(623186),Se=()=>n(171018),xe=(n(430670),n.n(n(844751))),Ae=()=>n(757695),Me=()=>n(591779),we=()=>n(643707),ke=()=>n(135154),je=()=>n(953418);function Ce(e){const{propertyGroups:t,propertyIdsToExclude:n,mergedPropertiesMap:i}=e,s=o.useMemo((()=>Ae().Store.createValue("")),[]),[l,d]=o.useState([]),[c,u]=o.useState({}),[p,m]=o.useState(null),g=o.useMemo((()=>{let e=t?t.flatMap((e=>e.propertyIds||[])):Object.keys(i);return n&&(e=e.filter((e=>!n.has(e)))),e}),[i,t,n]),f=(0,a().O$)(s),h=(0,Me().lW)(f,100,((e,t)=>e===t));o.useEffect((()=>{const e=[],t={};if(""!==h)for(const n of g){const o=i[n];o&&null!==xe().match(h,o.name)&&(e.push(n),t[n]=e.length-1)}(l.length!==e.length||e.some(((e,t)=>e!==l[t])))&&(d(e),u(t))}),[g,l,h,i]),o.useEffect((()=>{if(0===l.length)return void m(null);const e=null!==p?l[p]:null;e&&void 0!==c[e]?m(c[e]):m(0)}),[p,l,c]);const v=(0,r().v3)(),y=null!==p?l[p]:null;return o.useEffect((()=>{const e=document.getElementsByClassName(we().wT).item(0);e&&!(0,ke().E)({element:e})&&(0,je().uf)({el:e,environment:v,windowHeight:window.innerHeight,minEdgeDist:16})}),[v,y]),{searchInputValueStore:s,searchMatchesMap:c,searchMatches:l,activeSearchMatchIndex:p,moveToNextSearchMatch:()=>{if(null===p||l.length<=1)return;const e=p+1;m(e<=l.length-1?e:0)},moveToPreviousSearchMatch:()=>{if(null===p||l.length<=1)return;const e=p-1;m(e>=0?e:l.length-1)}}}var Ie=()=>n(530041);function Te(e){let{propertyGroupId:t,pagePropertiesStore:n}=e;const{collectionStore:o}=(0,X().bi)(),i=(0,s().IS)((e=>({button:{color:e.text.secondary,paddingLeft:8,height:34},buttonIcon:{fill:e.icon.secondary,marginRight:8}})),[]);return(0,K.jsx)(Ie().Xt,{style:i.button,iconStyle:i.buttonIcon,collectionStore:o,isInPeekRenderer:!1,propertyGroupId:t,pagePropertiesStore:n})}const _e=o.memo(Te);n(16280);var Pe=()=>n(158359),Be=()=>n(498474),Le=()=>n(957963),Re=()=>n(735384),De=()=>n(919709),Ne=()=>n(496603),Oe=()=>n(493823),Ee=()=>n(406699),Ue=()=>n(57232),Fe=()=>n(805751),Ve=()=>n(623580),ze=()=>n(928600),Ke=()=>n(897119),We=()=>n(204063),He=()=>n(722872),Ge=()=>n(463830),Ye=()=>n(395963);class qe extends Ae().Store{getInitialState(){return{}}isRenameInputForcedOpenForGroup(e){var t;return(null===(t=this.getState())||void 0===t?void 0:t.forceOpenRenameInputForGroupId)===e}resetForceRenameInputOpen(){const e=this.getState();return this.setState({...e,forceOpenRenameInputForGroupId:void 0})}}const $e=new qe;function Qe(e){const{title:t,propertyGroupId:n,isFirstPropertyGroup:i,isLastPropertyGroup:l,styles:d}=e,u=(0,a().uB)(void 0,Ge().A),p=(0,a().K8)((()=>$e.isRenameInputForcedOpenForGroup(n)),[n]),[m,g]=(0,o.useState)(p);(0,o.useEffect)((()=>{u.setState({...u.state,open:p})}),[u,p]);const f=(0,o.useCallback)((()=>{g(!1),$e.resetForceRenameInputOpen()}),[]),h=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,r().v3)();return(0,o.useCallback)((n=>{L().createAndCommit({environment:t,perform(t){(0,Ye().Px)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),v=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,r().v3)();return(0,o.useCallback)((n=>{L().createAndCommit({environment:t,perform(t){(0,Ye().Tk)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),y=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,r().v3)();return(0,o.useCallback)((n=>{L().createAndCommit({environment:t,perform(t){(0,Ye().QI)({collectionStore:e,groupId:n,transaction:t})},canUndo:!0,userAction:"ConfigurePropertyGroupModuleGroupHeading.deleteCollectionPropertyGroup"})}),[e,t])}(),S=(0,s().IS)((e=>({container:{display:"flex",alignItems:"center",padding:"0 2px",...(null==d?void 0:d.container)||{}},titleContainer:{display:"flex",alignItems:"center",marginRight:"auto",paddingLeft:5,borderRadius:4,height:"auto",width:"100%"},label:{fontSize:"12px",lineHeight:"24px",color:e.text.secondary,fontWeight:500,padding:"0 8px 0 5px",display:"block",..._().RC},menuIcon:{width:16,height:16},dragIcon:{fill:e.icon.secondary}})),[d]);return(0,K.jsx)("div",{style:S.container,children:(0,K.jsx)(Ee().Ay,{style:{width:268},onClose:f,popupType:Ke().nl.Popup,renderOrigin:e=>(0,K.jsxs)(Oe().p,{...e,style:S.titleContainer,children:[(0,K.jsx)(Ue().A,{iconSize:12,iconStyle:S.dragIcon}),(0,K.jsx)("div",{style:S.label,children:t})]}),buttonPopupStore:u,alignmentToOrigin:b().C.Start,render:e=>{return m?(0,K.jsx)(Ze,{propertyGroupId:n,value:t||"",afterSubmit:e.close}):(0,K.jsx)(ze().A,{menuType:He().gu.Popup,children:(0,K.jsx)(q().Ay,{type:q().Oh.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,K.jsx)($().A,{...e}),items:(o=e.close,(0,Ne().oE)([{key:"rename",render:e=>(0,K.jsx)(G().A,{...e,icon:(0,Le().j)(S.menuIcon),title:(0,K.jsx)(c().sA,{defaultMessage:"Rename",id:"ConfigurePropertyGroupModuleGroupHeading.rename"})}),action:()=>{g(!0)}},!i&&{key:"move-up",render:e=>(0,K.jsx)(G().A,{...e,icon:(0,Be().q)(S.menuIcon),title:(0,K.jsx)(c().sA,{defaultMessage:"Move up",id:"ConfigurePropertyGroupModuleGroupHeading.moveUp"})}),action:()=>{v(n),o()}},!l&&{key:"move-down",render:e=>(0,K.jsx)(G().A,{...e,icon:(0,Pe().P)(S.menuIcon),title:(0,K.jsx)(c().sA,{defaultMessage:"Move down",id:"ConfigurePropertyGroupModuleGroupHeading.moveDown"})}),action:()=>{y(n),o()}},{key:"delete",render:e=>(0,K.jsx)(G().A,{...e,icon:(0,Re().I)({width:16,height:16}),title:(0,K.jsx)(c().sA,{defaultMessage:"Delete",id:"ConfigurePropertyGroupModuleGroupHeading.delete"}),caption:(0,K.jsx)(c().sA,{defaultMessage:"No properties will be deleted",id:"ConfigurePropertyGroupModuleGroupHeading.deleteCaption"})}),action:()=>{h(n),o()}}]))}]})});var o}})})}function Ze(e){let{propertyGroupId:t,afterSubmit:n,value:i}=e;const[a,l]=(0,o.useState)(i),d=(0,s().IS)((()=>({container:{display:"flex",padding:"6px"},input:{marginRight:4,flexGrow:1},button:{}})),[]),u=function(){const{collectionStore:e}=(0,X().bi)(),t=(0,r().v3)();return(0,o.useCallback)(((n,o)=>{const i=e.getNormalizedPropertyGroups();if(void 0===i)throw new Error("Error renaming property group. Collection Does not have property groups.");const r=i.map((e=>e.id===n?{...e,title:o}:e));L().createAndCommit({environment:t,perform(t){B().zA({stores:[e],update:{property_groups:r},transaction:t})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.renameCollectionPropertyGroup"})}),[e,t])}(),p=(0,o.useCallback)((()=>{const e=(0,De().xV3)(a).trim();0!==e.length&&(u(t,e),n())}),[n,u,a,t]),m=(0,o.useCallback)((e=>{l(e.target.value)}),[]);return(0,K.jsx)(Fe().A,{debugName:"ConfigurePropertyGroupHeader",capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,K.jsxs)("div",{style:d.container,children:[(0,K.jsx)(Ve().A,{style:d.input,onSubmit:p,selectAll:!0,value:a,onChange:m,focusInitial:!0}),(0,K.jsx)(We().A,{style:d.button,onClick:p,children:(0,K.jsx)(c().sA,{id:"ConfigurePropertyGroupModuleGroupHeading.updatePropertyGroupTitle",defaultMessage:"Done"})})]})})}var Xe=()=>n(387358),Je=()=>n(439264);n(18107);function et(e){let{sections:t,onDrop:n,renderKey:i,getInvalidDropIndices:r,direction:a}=e;const[l,d]=o.useState({type:"notDragging"}),c=(0,o.useMemo)((()=>{const e={};for(const n of t)e[ot(n.key)]=n;return e}),[t]),p=(0,o.useCallback)((e=>(0,u().O9)(c[ot(e)])),[c]),m=(0,o.useMemo)((()=>t.flatMap((e=>[e.key,...e.items]))),[t]),g=(0,o.useMemo)((()=>m.map(ot)),[m]),f=(0,o.useMemo)((()=>{const e={};for(const t of m)e[ot(t)]=t;return e}),[m]),h=o.useCallback(((e,o)=>{let{key:i}=o;p(i)?n({newSections:nt({orderedSectionKeys:e.filter(p),originalSections:t}),droppedKey:i,isSection:!0}):n({newSections:tt({flattenedKeys:e.map((e=>f[e])),getIsSection:p}),droppedKey:i,isSection:!1})}),[p,n,t,f]),v=o.useCallback((e=>{p(e)?d({type:"draggingSection",key:e}):d({type:"draggingItem",key:e})}),[p]),y=o.useCallback((()=>d({type:"notDragging"})),[]),b=(0,o.useCallback)((e=>{let t;t=p(e)?new Set(m.flatMap(((e,t)=>p(e)?[]:[t]))):new Set([0]);const n=null==r?void 0:r({flattenedKeys:g,...p(e)?{isSection:!0,key:e}:{isSection:!1,key:e}});return n?new Set([...t,...n]):t}),[r,p,m,g]),S=(0,s().IS)((e=>{const t={opacity:1,transition:"opacity 0.2s ease"},n={...t,opacity:.7};return{container:{},undraggedSection:t,draggedSection:n,undraggedItem:{...t,width:"100%"},draggedItem:{...n,width:"100%"},itemInDraggedSection:{...t,opacity:0,width:"100%"}}}),[]),x=(0,o.useMemo)((()=>{const e="draggingSection"===l.type?l.key:void 0,n="draggingItem"===l.type?l.key:void 0,o={};return t.forEach(((t,n)=>{const r=ot(t.key),a=e===r;o[r]=(0,K.jsx)("div",{style:a?S.draggedSection:S.undraggedSection,children:i({key:r,isDraggable:it(t.key),isSection:!0,sectionIndex:n,sectionLength:t.items.length})})})),t.forEach(((t,r)=>{const a=e===ot(t.key);return t.items.forEach(((e,s)=>{const l=n===ot(e),d=t.items.length,c=ot(e);o[c]=(0,K.jsx)("div",{style:l?S.draggedItem:a?S.itemInDraggedSection:S.undraggedItem,children:i({key:ot(e),isDraggable:it(e),isSection:!1,sectionIndex:r,itemIndex:s,sectionLength:d})})}))})),o}),[l,i,t,S.draggedItem,S.draggedSection,S.itemInDraggedSection,S.undraggedItem,S.undraggedSection]);return(0,K.jsx)(Je().Ay,{style:S.container,direction:a,keys:m,renderKey:e=>x[e],onDraggingKeyChanged:v,onDragEnd:y,onDrop:h,getInvalidDropIndices:b})}function tt(e){let{flattenedKeys:t,getIsSection:n}=e;const o=function(e){let{orderedList:t,getIsSection:n}=e;const o=t.findIndex((e=>n(e)));if(-1===o||0===o)return t;return[t[o],...t.slice(0,o),...t.slice(o+1)]}({orderedList:t,getIsSection:n}),i=[];for(const r of o)if(n(r))i.push({key:r,items:[]});else{const e=r,t=i.at(-1);t&&t.items.push(e)}return i}function nt(e){let{orderedSectionKeys:t,originalSections:n}=e;const o={};for(const i of n)o[ot(i.key)]={key:i.key,items:i.items};return t.flatMap((e=>o[e]?[o[e]]:[]))}function ot(e){return"string"==typeof e?e:e.key}function it(e){return"string"==typeof e||(e.draggable??!0)}const rt=o.memo(et);function at(e){const{collectionFormat:t,mergedProperties:n,renderPropertyRow:i}=e,{collectionStore:r}=(0,X().bi)(),s=(0,a().K8)((()=>null==n?void 0:n.map((e=>e.property))),[n]),l=(0,o.useCallback)(((e,t)=>i({propertyId:e,rowIndex:t})),[i]),d=(0,be().Od)({collectionStore:r,format:t});return s?(0,K.jsx)(Je().Ay,{keys:s,onDrop:d,direction:"vertical",renderKey:l}):null}function st(e){const{renderPropertyRow:t,renderPropertyGroupRow:n,renderAddPropertyButton:i}=e,s=(0,r().v3)(),{collectionStore:l}=(0,X().bi)(),d=(0,a().K8)((()=>l.getNormalizedPropertyGroups()??[]),[l]),c=(0,o.useMemo)((()=>Object.fromEntries(d.map((e=>[e.id,e])))),[d]),p=(0,a().K8)((()=>d.map((e=>{var t;return{key:{key:e.id,draggable:!0},items:[...(null===(t=e.propertyIds)||void 0===t?void 0:t.map((e=>({key:e,draggable:!0}))))??[],(0,Xe().Op)(e.id)]}}))),[d]),m=(0,o.useCallback)((e=>{let{flattenedKeys:t,isSection:n}=e;return n?new Set(t.flatMap(((e,t)=>(0,u().O9)(c[e])?[]:[t]))):new Set(t.flatMap(((e,t)=>(0,Xe().k9)(e)?[t+1]:[])))}),[c]),g=(0,o.useCallback)((e=>{var o;return e.isSection?n({groupId:e.key,groupTitle:null===(o=c[e.key])||void 0===o?void 0:o.title,rowIndex:e.sectionIndex}):(0,Xe().k9)(e.key)?i((0,Xe().qB)(e.key)):t({propertyId:e.key,rowIndex:e.sectionIndex})}),[c,i,n,t]),f=(0,o.useCallback)((e=>{const t=e.newSections.map((e=>{var t;const n=e.items.map((e=>"string"==typeof e?e:e.key)).filter((e=>!(0,Xe().k9)(e))),o="string"==typeof e.key?e.key:e.key.key;return{id:o,title:null===(t=c[o])||void 0===t?void 0:t.title,propertyIds:n}}));L().createAndCommit({environment:s,perform(e){(0,Ye().Yf)({collectionStore:l,newGroups:t,transaction:e})},canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"})}),[l,s,c]);return(0,K.jsx)(rt,{direction:"vertical",sections:p,renderKey:g,onDrop:f,getInvalidDropIndices:m})}var lt=()=>n(851979),dt=()=>n(369);const ct=(0,z().wt)("eyelash",{viewBox:"0 0 16 16",svg:(0,K.jsx)("path",{fillRule:"evenodd",d:"M2.1488 5.12366C1.94088 4.76541 1.48191 4.64354 1.12366 4.85145C0.76541 5.05937 0.643537 5.51833 0.851451 5.87659C1.05856 6.23345 1.30425 6.56012 1.58188 6.85746L0.46967 7.96967C0.176777 8.26256 0.176777 8.73744 0.46967 9.03033C0.762563 9.32322 1.23744 9.32322 1.53033 9.03033L2.73804 7.82262C3.18107 8.11266 3.66308 8.35645 4.17017 8.55584L3.30384 10.7217C3.15001 11.1062 3.33707 11.5427 3.72166 11.6966C4.10624 11.8504 4.54272 11.6633 4.69656 11.2787L5.61111 8.99235C6.14972 9.11164 6.70058 9.18864 7.25 9.22519V11.5C7.25 11.9142 7.58579 12.25 8 12.25C8.41421 12.25 8.75 11.9142 8.75 11.5V9.2252C9.29955 9.18866 9.85054 9.11164 10.3893 8.99232L11.3038 11.2787C11.4577 11.6633 11.8942 11.8504 12.2787 11.6966C12.6633 11.5427 12.8504 11.1062 12.6966 10.7217L11.8302 8.55579C12.3372 8.35643 12.8191 8.11269 13.2621 7.82272L14.4697 9.03033C14.7626 9.32322 15.2374 9.32322 15.5303 9.03033C15.8232 8.73744 15.8232 8.26256 15.5303 7.96967L14.4182 6.85759C14.6959 6.56021 14.9417 6.2335 15.1488 5.87659C15.3567 5.51833 15.2348 5.05937 14.8766 4.85145C14.5183 4.64354 14.0594 4.76541 13.8515 5.12366C12.883 6.79244 10.5428 7.75012 8.00012 7.75012C5.45748 7.75012 3.11728 6.79244 2.1488 5.12366Z"})});var ut=()=>n(68350);function pt(e){let{collectionStore:t,pageStore:n,layoutModule:i,pagePropertiesStore:r,propertyId:l,draggable:d,rightButton:c,searchHighlighted:u}=e;const p=(0,a().K8)((()=>n.isNonEditableState()),[n]),{collectionSchema:m,collectionFormat:g,canEditCollection:f}=(0,a().K8)((()=>({collectionSchema:t.getSchema(),collectionFormat:t.getFormat(),canEditCollection:t.canEdit()})),[t]),h=(0,s().IS)((()=>({propertyRowContainer:{width:"100%",minWidth:"100%",display:"grid",alignItems:"center",gridTemplateColumns:"1fr auto",gap:2,paddingLeft:2}})),[]),v=(0,o.useMemo)((()=>({color:"primary",size:"medium",fontWeight:"regular",width:{variant:"fixed",widthDesktop:"100%",widthMobile:"100%"}})),[]),y=Boolean(u),b=Boolean(u&&u.active);return(0,K.jsxs)("div",{style:h.propertyRowContainer,children:[(0,K.jsx)(ut().I,{schema:m,styleVariants:v,format:g,property:l,collectionStore:t,disabled:!1,locked:p,canConfigureCollection:f,isInPeekRenderer:!1,hideDragHandle:!d,showDragHandleAsIcon:!0,dragHandleStyle:{width:16,marginRight:2},blockStore:n,pagePropertiesStore:r,layoutModule:i,forceHighlight:y,forceFocusedHighlight:b}),c?c():null]})}function mt(e){const{propertyId:t,propertyFormat:n,pagePropertiesStore:i,collectionStore:s,pageStore:l,searchHighlighted:d}=e,u=(0,c().tz)(),p=(0,r().v3)(),g=(0,a().K8)((()=>s.getSchema()),[s]),f=(0,a().K8)((()=>(0,I().L)(s.getFormat(),g,void 0,C().jf.Collection)),[s,g]),h=g[t],v=(0,o.useCallback)((e=>{L().createAndCommit({environment:p,userAction:"LayoutBuilder.propertiesConfiguration.toggleVisibility",canUndo:!0,perform:n=>{P().D7({property:t,visibility:e,store:s,format:f,transaction:n})}})}),[f,s,p,t]),y="show"===(null==n?void 0:n.visibility)?lt().h:"hide_if_empty"===(null==n?void 0:n.visibility)?dt().R:ct,S="show"===(null==n?void 0:n.visibility)||"hide_if_empty"===(null==n?void 0:n.visibility);if(!h)return null;return(0,K.jsx)(pt,{pageStore:l,collectionStore:s,propertyId:t,pagePropertiesStore:i,draggable:!0,rightButton:()=>(0,K.jsx)(Ee().Ay,{popupType:Ke().nl.Popup,renderOrigin:e=>(0,K.jsx)(m().A,{ariaLabel:u.formatMessage(ft.visibilityToggleIconAriaLabel,{propertyName:h.name}),icon:y,color:S?"primary":"secondary",...e}),alignmentToOrigin:b().C.Start,render:e=>(0,K.jsx)(gt,{parentClose:e.close,setVisibilityOfProperty:v})}),searchHighlighted:d,layoutModule:e.layoutModule})}function gt(e){const{setVisibilityOfProperty:t,parentClose:n}=e,i=(0,o.useMemo)((()=>[{key:0,render:e=>(0,K.jsx)($().A,{...e}),items:[{key:"always_show",render:e=>(0,K.jsx)(G().A,{...e,icon:(0,lt().h)({width:16,height:16}),title:(0,K.jsx)(c().sA,{defaultMessage:"Always show",id:"ConfigurePropertiesPropertyRow.visibility.alwaysShow"})}),action:()=>{t("show"),n()}},{key:"hide_if_empty",render:e=>(0,K.jsx)(G().A,{...e,icon:(0,dt().R)({width:16,height:16}),title:(0,K.jsx)(c().sA,{defaultMessage:"Hide when empty",id:"ConfigurePropertiesPropertyRow.visibility.hide_when_empty"})}),action:()=>{t("hide_if_empty"),n()}},{key:"hide",render:e=>(0,K.jsx)(G().A,{...e,icon:ct({width:16,height:16}),title:(0,K.jsx)(c().sA,{defaultMessage:"Always hide",id:"ConfigurePropertiesPropertyRow.visibility.alwaysHide"})}),action:()=>{t("hide"),n()}}]}]),[n,t]);return(0,K.jsx)(ze().A,{menuType:He().gu.Popup,children:(0,K.jsx)(q().Ay,{type:q().Oh.Vertical,initialFocus:0,sections:i})})}const ft=(0,c().YK)({visibilityToggleIconAriaLabel:{id:"pageLayout.configureProperties.visibilityToggleIconAriaLabel",defaultMessage:"Toggle the visibility {propertyName}"}}),ht=(0,c().YK)({filterPropertiesInputPlaceholder:{id:"layouts.configurePropertiesModule.filterProperties.input.placeholder",defaultMessage:"Search..."},notFound:{id:"layouts.configurePropertiesModule.filterProperties.input.notFound",defaultMessage:"Not Found"},arrowButtonDownAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonDown.ariaLabel",defaultMessage:"Button to navigate to the next result"},arrowButtonUpAriaLabel:{id:"layouts.configurePropertiesModule.filterProperties.input.arrowButtonUp.ariaLabel",defaultMessage:"Button to navigate to the previous result"}});function vt(e){const{searchInputValueStore:t,activeSearchMatchIndex:n,searchMatches:i,moveToNextSearchMatch:r,moveToPreviousSearchMatch:l}=e,d=(0,a().O$)(t),u=(0,c().tz)(),p=o.useCallback((e=>{"Enter"===e.key?(e.preventDefault(),r()):"ArrowUp"===e.key?l():"ArrowDown"===e.key&&r()}),[r,l]),g=(0,s().IS)((e=>({searchMatchCount:{fontSize:".8rem",color:e.text.tertiary,userSelect:"none",cursor:"default",flexShrink:0,marginRight:4},searchMatchArrowButton:{padding:3,width:void 0,height:void 0,cursor:"pointer"},searchMatchArrowIcon:{width:12,height:12,color:e.icon.secondary,strokeWidth:.4,stroke:"currentcolor"},searchInputIcon:{fill:e.icon.secondary,width:10},searchInputOuter:{background:e.white}})),[]),f=o.useMemo((()=>{if(""!==d)return(0,K.jsxs)(v().Ye,{alignItems:"center",gap:8,children:[(0,K.jsx)("div",{children:null!==n?`${n+1} of ${i.length}`:u.formatMessage(ht.notFound)}),null!==n&&(0,K.jsxs)(v().Ye,{gap:0,alignItems:"center",children:[(0,K.jsx)(m().A,{icon:Pe().P,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:u.formatMessage(ht.arrowButtonDownAriaLabel),onClick:r}),(0,K.jsx)(m().A,{icon:Be().q,iconStyle:g.searchMatchArrowIcon,style:g.searchMatchArrowButton,ariaLabel:u.formatMessage(ht.arrowButtonUpAriaLabel),onClick:l})]})]})}),[d,n,i.length,u,g,r,l]);return(0,K.jsx)(Y().Ay,{focusInitial:!0,itemMarginLeft:0,itemMarginRight:0,onChange:e=>{t.setState(e.target.value.trim())},onKeyDown:p,placeholder:u.formatMessage(ht.filterPropertiesInputPlaceholder),showClearButton:!0,value:d,inputLeft:(0,H().q)(g.searchInputIcon),inputOuterStyle:g.searchInputOuter,inputRightStyle:g.searchMatchCount,inputRight:f})}function yt(e){const{module:t}=e,{layoutStore:n}=(0,X().LH)(),{collectionStore:i,pageStore:r}=(0,X().bi)(),l=(0,a().K8)((()=>n.getModules()),[n]),d=(0,a().K8)((()=>i.getSchema()),[i]),c=(0,a().K8)((()=>(0,I().L)(i.getFormat(),d,void 0,C().jf.Collection)),[i,d]),p=(0,o.useMemo)((()=>new Set((0,ye().q)({modulesByArea:l,collectionSchema:d,collectionFormat:c}))),[c,l,d]),m=(0,o.useMemo)((()=>new(Se().YB)),[]),f=(0,a().K8)((()=>i.getNormalizedPropertyGroups()),[i]),h=(0,a().K8)((()=>{const e={};return null==f||f.forEach(((t,n)=>{e[t.id]=n})),e}),[f]),y=(0,be().z7)({store:r,format:c,schema:d,collectionStore:i}),b=(0,o.useMemo)((()=>{const e={};return y.forEach((t=>e[t.property]=t)),e}),[y]),{searchInputValueStore:x,searchMatches:A,searchMatchesMap:M,activeSearchMatchIndex:w,moveToNextSearchMatch:k,moveToPreviousSearchMatch:j}=Ce({mergedPropertiesMap:b,propertyGroups:f,propertyIdsToExclude:p}),T=(0,o.useCallback)((e=>{let{propertyId:n}=e;if(p.has(n))return null;const o=void 0!==M[n]&&null!==w?{active:n===A[w]}:void 0;return(0,K.jsx)(mt,{propertyId:n,propertyFormat:b[n],collectionStore:i,pagePropertiesStore:m,pageStore:r,searchHighlighted:o,layoutModule:t})}),[w,i,b,t,m,r,p,A,M]),_=(0,o.useCallback)((e=>{let{groupId:t,groupTitle:n}=e;const o=h[t],i=0===o,r=(0,u().O9)(f)&&o===f.length-1,a={container:i?void 0:{marginTop:20}};return(0,K.jsx)(Qe,{title:n,propertyGroupId:t,isFirstPropertyGroup:i,isLastPropertyGroup:r,styles:a})}),[h,f]),P=(0,o.useCallback)((e=>(0,K.jsx)(_e,{propertyGroupId:e,pagePropertiesStore:m})),[m]),B=Boolean(y.length&&y.length>p.size),L=(0,s().IS)((e=>({addPropertyButtonContainer:{marginLeft:2,paddingBottom:8},container:{marginTop:B?4:8,height:"100%",overflow:"visible hidden",marginLeft:-Jt,width:`calc(100% + ${2*Jt}px)`},searchInputContainer:{marginRight:Jt,marginLeft:Jt,flexShrink:0,paddingTop:2,overflow:"visible",marginBottom:14,paddingLeft:6,paddingRight:6},listContainer:{padding:`0 ${Jt}px 56px`}})),[B]);return(0,K.jsxs)(v().wt,{style:L.container,children:[B&&(0,K.jsx)("div",{style:L.searchInputContainer,children:(0,K.jsx)(vt,{searchInputValueStore:x,activeSearchMatchIndex:w,searchMatches:A,moveToNextSearchMatch:k,moveToPreviousSearchMatch:j})}),(0,K.jsx)(g().H,{type:S().A.Y,style:L.listContainer,children:Boolean(f)?(0,K.jsx)(st,{renderPropertyRow:T,renderPropertyGroupRow:_,renderAddPropertyButton:P}):(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(at,{collectionFormat:c,mergedProperties:y,renderPropertyRow:T}),(0,K.jsx)("div",{style:L.addPropertyButtonContainer,children:(0,K.jsx)(_e,{pagePropertiesStore:m})})]})})]})}var bt=()=>n(464699),St=()=>n(115512);const xt=(0,c().YK)({addSection:{id:"NewCollectionPropertyGroupButton.label",defaultMessage:"Add section"},newSection:{id:"NewCollectionPropertyGroupButton.newItemName",defaultMessage:"New section"}});function At(){const{collectionStore:e}=(0,X().bi)(),t=(0,r().v3)(),n=(0,c().tz)(),i=(0,s().IS)((e=>({button:{fontSize:(0,St().ny)(t,"UISmall"),color:e.text.secondary,padding:8,fontWeight:_().Wy.medium},icon:{fill:e.icon.secondary,marginRight:4}})),[t]),a=(0,o.useCallback)((()=>{const o=n.formatMessage(xt.newSection),{performResult:i}=L().createAndCommit({environment:t,perform:t=>(0,Ye().PA)({collectionStore:e,newGroupTitle:o,transaction:t}),canUndo:!0,userAction:"ConfigurePropertyExplorerModule.onDrop"});i&&$e.setState({forceOpenRenameInputForGroupId:i})}),[e,t,n]);return(0,K.jsx)(Oe().p,{iconLeading:bt().b,onClick:a,style:i.button,iconStyle:i.icon,children:(0,K.jsx)(c().sA,{...xt.addSection})})}function Mt(e){const{title:t}=e;return(0,K.jsxs)(v().Ye,{justifyContent:"space-between",children:[t,(0,K.jsx)(At,{})]})}var wt=()=>n(686526),kt=()=>n(59400),jt=()=>n(525432);function Ct(e){return(0,K.jsx)("div",{style:{marginLeft:-8,marginRight:-8},children:e.children})}function It(e){let{module:t}=e;const{collectionStore:n}=(0,X().bi)(),i=(0,Q().ET)(),r=(0,a().K8)((()=>n.getSchema()),[n]),s=(0,a().K8)((()=>{if((0,ae().gx)(t))return t}),[t]),l=(0,a().K8)((()=>s&&r[s.propertyId]),[s,r]);if((0,o.useEffect)((()=>{if(s)return wt().Ow({collectionContextStore:i,collectionSettingsStore:i.settingsStore,closeOnEscape:!1}),wt().dP({collectionSettingsStore:i.settingsStore,item:{type:"property",property:s.propertyId,formatKey:void 0}}),()=>{wt().os({collectionSettingsStore:i.settingsStore})}}),[i,s]),!l||!s)return null;const d=(0,K.jsx)("span",{style:{fontSize:16,lineHeight:"24px",fontWeight:_().Wy.medium},children:Z().dC[l.type]});return(0,K.jsx)(Ct,{children:(0,K.jsx)(kt().m$,{collectionContextStore:i,collectionSettingsStore:i.settingsStore,context:jt().Bd.ViewSettings,collectionSettingsPropertyTitleOverride:d,fullHeight:!0})})}n(672577);var Tt=()=>n(487929);function _t(e){let{module:t}=e;const{collectionStore:n,pageStore:o}=(0,X().bi)(),i=(0,s().IS)((e=>({configureContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:12,marginTop:16},configureDescription:{fontSize:_().J.UISmall.desktop,fontWeight:_().Wy.regular,color:e.text.secondary,marginLeft:8}})),[]);return(0,K.jsxs)("div",{style:i.configureContainer,children:[(0,K.jsx)("div",{style:i.configureDescription,children:(0,K.jsx)(c().sA,{defaultMessage:"Relations can be shown as either minimal or responsive page sections",id:"pageLayout.ConfigureRelationsGroupModule.moduleDescription"})}),(0,K.jsx)(Pt,{layoutModule:t,pageStore:o,collectionStore:n})]})}function Pt(e){let{collectionStore:t,pageStore:n,layoutModule:i}=e;const s=(0,r().v3)(),l=(0,o.useMemo)((()=>new(Se().YB)),[]),{collectionPagePropertySections:d}=(0,a().K8)((()=>{const e=t.getSchema(),n=t.getFormat();return{collectionPagePropertySections:(0,Tt().T)({format:n,schema:e,visibilityLevels:["inline","minimal"]})}}),[t]),c=d.map((e=>e.section)),u=(0,o.useCallback)((e=>{if(!d)return;const n=e.map((e=>{const t=d.find((t=>t.section===e));if(!t)throw Error("collection does not have a section corresponding to one of the dropped keys");return t}));L().createAndCommit({userAction:"ConfigureRelationsGroupModule.onDraggablePageSectionsDrop",environment:s,canUndo:!0,perform:e=>{P().LK({environment:s,pageSectionFormats:n,store:t,transaction:e})}})}),[d,t,s]);return d.length?(0,K.jsx)(Je().Ay,{direction:"vertical",keys:c,renderKey:e=>(0,K.jsx)(pt,{pageStore:n,collectionStore:t,propertyId:e,pagePropertiesStore:l,layoutModule:i,draggable:!0}),onDrop:e=>u(e)}):null}var Bt=()=>n(552445),Lt=()=>n(788941),Rt=()=>n(410730),Dt=()=>n(447934),Nt=()=>n(33218);function Ot(e){const{environment:t,layoutModule:n,collectionStore:o,layoutStore:i,propertyId:r}=e,a=o.getSchema(),s=i.getModel(),l=null==s?void 0:s.getPageModuleAreaById(n.id);if(!l||!s||"normalizedTitleWithIcon"!==n.type)return;const{pinnedPropertyIds:d}=function(e,t,n){let o,i=[...t??[]];return i.includes(e)?(i=i.filter((t=>t!==e)),o=!1):(i.push(e),i.length>Rt().U&&(i=(0,re().Vl)(i,n)),o=!0),{isNowPinned:o,pinnedPropertyIds:i}}(r,n.propertyIds,a),c={...n,propertyIds:d};L().createAndCommit({environment:t,perform(e){(0,Dt().HD)({environment:t,transaction:e,property:r,layoutStore:i}),(0,Nt().UQ)({environment:t,transaction:e,layoutStore:i,position:{area:l,moduleId:n.id},updatedModule:c})},canUndo:!0,userAction:"titleWithIconActions.togglePinnedProperty"})}var Et=()=>n(557198);function Ut(e){let{module:t}=e;const{collectionStore:n,pageStore:i}=(0,X().bi)(),l=(0,r().v3)(),{layoutStore:d}=(0,X().LH)(),p=(0,a().K8)((()=>n.getSchema()),[n]),m=(0,a().K8)((()=>(0,I().L)(n.getFormat(),p,void 0,C().jf.Collection)),[n,p]),g=(0,o.useMemo)((()=>new(Se().YB)),[]),f=(0,o.useMemo)((()=>"normalizedTitleWithIcon"!==t.type?[]:(0,re().Vl)(t.propertyIds,p)),[t,p]),y=(0,o.useMemo)((()=>new Set(f)),[f]),S=(0,a().K8)((()=>{var e;return null===(e=m.property_visibility||[])||void 0===e?void 0:e.map((e=>e.property)).filter((e=>!(0,F().NM)(e)&&!y.has(e)))}),[m.property_visibility,y]),x=(0,a().K8)((()=>(0,u().uv)(p)),[p]),A=(0,be().z7)({store:i,format:m,schema:p,collectionStore:n,propertyIds:x}),M=(0,o.useMemo)((()=>{const e={};for(const t of A)e[t.property]=t;return e}),[A]),{searchInputValueStore:w,searchMatches:k,activeSearchMatchIndex:j,moveToNextSearchMatch:T,moveToPreviousSearchMatch:P,searchMatchesMap:B}=Ce({mergedPropertiesMap:M,propertyGroups:void 0,propertyIdsToExclude:void 0}),R=function(e){const t=(0,r().v3)(),{layoutStore:n}=(0,X().LH)();return(0,o.useCallback)((o=>{const i=n.getModel(),r=null==i?void 0:i.getPageModuleAreaById(e.id);if(!r||!i)return;const a={...e,propertyIds:o};L().createAndCommit({environment:t,perform(o){(0,Nt().UQ)({environment:t,transaction:o,layoutStore:n,position:{area:r,moduleId:e.id},updatedModule:a})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handlePinnedPropertyReorderDrop"})}),[t,e,n])}(t),E=(0,s().IS)((e=>{const t={fontSize:_().J.UISmall.desktop,lineHeight:"24px",color:e.text.secondary,fontWeight:500};return{container:{height:"100%",overflow:"visible hidden",gap:14,marginLeft:-Jt,width:`calc(100% + ${2*Jt}px)`},propertySearchInputContainer:{flexShrink:0,margin:`10px ${Jt+6}px 0`},scrollableContainer:{padding:`0 ${Jt}px 56px`,flexGrow:1,overflow:"hidden auto"},pinnedPropertiesLabel:{...t,marginLeft:8},optionsContainer:{marginTop:24},optionsLabel:{...t,marginLeft:6,marginBottom:6},switcherButton:{marginRight:0},addPropertyButton:{color:e.text.secondary,height:34},addPropertyButtonIcon:{color:e.text.secondary}}}),[]),U=f.length?(0,K.jsx)(Je().Ay,{keys:f,onDrop:R,direction:"vertical",renderKey:e=>(0,K.jsx)(Vt,{layoutModule:t,propertyId:e,isPinned:!0,draggable:!0,pinButtonDisabled:!1,pagePropertiesStore:g,searchHighlighted:null!==j&&void 0!==B[e]?{active:e===k[j]}:void 0})}):null,V=f.length>=Rt().U,z=S.map((e=>(0,K.jsx)(Vt,{layoutModule:t,propertyId:e,isPinned:!1,draggable:!1,pinButtonDisabled:V,pagePropertiesStore:g,searchHighlighted:null!==j&&void 0!==B[e]?{active:e===k[j]}:void 0},e))),W=Ft(t),H=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,K.jsx)(Ie().Xt,{...e,style:E.addPropertyButton,iconStyle:E.addPropertyButtonIcon,collectionStore:n,isInPeekRenderer:!1,pagePropertiesStore:g,onPropertyAdded:W,disabled:V})},{backlinksVisibility:G,updateBacklinksVisibility:Y}=(0,Et().Ap)({store:n,format:m}),q=(0,c().tz)(),$=(0,o.useCallback)((()=>{const e="show"===t.propertyLabels||!t.propertyLabels;L().createAndCommit({environment:l,perform(n){var o;const i=null===(o=d.getModel())||void 0===o?void 0:o.getPageModuleAreaById(t.id);i&&(0,Nt().UQ)({environment:l,transaction:n,layoutStore:d,position:{area:i,moduleId:t.id},updatedModule:{...t,propertyLabels:e?"hide":"show"}})},canUndo:!0,userAction:"ConfigureTitleAndIconModule.handleShowPropertyLabels"})}),[t,l,d]),Q=(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{style:{...E.pinnedPropertiesLabel},children:(0,K.jsx)(c().sA,{...zt.pinnedPropertiesLabel})}),U,(0,K.jsx)("div",{style:{marginLeft:2},children:V?(0,K.jsx)(h().A,{placement:b().W.Left,render:e=>H(e),renderTooltip:()=>q.formatMessage(zt.maxPinnedPropertiesAddPropertyTooltip,{br:(0,K.jsx)("br",{})})}):H()}),z.length>0&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{style:{...E.pinnedPropertiesLabel,marginTop:24},children:(0,K.jsx)(c().sA,{...zt.unpinnedPropertiesLabel})}),z]})]});return(0,K.jsxs)(v().wt,{style:E.container,children:[(0,K.jsx)("div",{style:E.propertySearchInputContainer,children:(0,K.jsx)(vt,{activeSearchMatchIndex:j,searchMatches:k,moveToNextSearchMatch:T,moveToPreviousSearchMatch:P,searchInputValueStore:w})}),(0,K.jsxs)("div",{style:E.scrollableContainer,children:[Q,(0,K.jsxs)("div",{style:E.optionsContainer,children:[(0,K.jsx)("div",{style:E.optionsLabel,children:(0,K.jsx)(c().sA,{...zt.optionsLabel})}),(0,K.jsx)(D().Ay,{title:(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.showPropertyLabels",defaultMessage:"Property labels"}),onClick:$,right:(0,K.jsx)(N().A,{on:"show"===t.propertyLabels||void 0===t.propertyLabels}),rightStyle:E.switcherButton}),(0,K.jsx)(D().Ay,{right:(0,K.jsx)(O().p7,{currentVisibility:G,onSelect:Y}),rightStyle:E.switcherButton,title:(0,K.jsx)(c().sA,{...zt.showBacklinksOption})})]})]})]})}function Ft(e){const{layoutStore:t}=(0,X().LH)(),{collectionStore:n}=(0,X().bi)(),i=(0,r().v3)();return(0,o.useCallback)((o=>{Ot({environment:i,layoutModule:e,collectionStore:n,layoutStore:t,propertyId:o})}),[i,e,n,t])}function Vt(e){let{layoutModule:t,propertyId:n,isPinned:o,pinButtonDisabled:i,...r}=e;const l=(0,c().tz)(),d=(0,s().DP)(),{collectionStore:u,pageStore:p}=(0,X().bi)(),g=(0,a().K8)((()=>u.getSchema()),[u])[n],f=Ft(t);if(!g)return null;const v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,K.jsx)(m().A,{...e,disabled:i,ariaLabel:o?l.formatMessage(zt.toggleUnpinnedAriaLabel,{propertyName:g.name}):l.formatMessage(zt.togglePinnedAriaLabel,{propertyName:g.name}),icon:o?Lt().b:Bt().N,iconStyle:{fill:d.icon.primary},onClick:()=>f(n)})};return(0,K.jsx)(pt,{pageStore:p,collectionStore:u,propertyId:n,layoutModule:t,rightButton:()=>i?(0,K.jsx)(h().A,{placement:b().W.Left,render:e=>v(e),renderTooltip:()=>l.formatMessage(zt.maxPinnedPropertiesTooltip,{br:(0,K.jsx)("br",{})})}):v(),...r})}const zt=(0,c().YK)({togglePinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.togglePinnedAriaLabel",defaultMessage:"Show {propertyName} as pinned"},toggleUnpinnedAriaLabel:{id:"pageLayout.configurePinnedProperties.toggleUnpinnedAriaLabel",defaultMessage:"Do not show {propertyName} as pinned"},pinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.pinnedPropertiesLabel",defaultMessage:"Pinned properties"},unpinnedPropertiesLabel:{id:"pageLayout.configurePinnedProperties.unpinnedPropertiesLabel",defaultMessage:"Unpinned properties"},maxPinnedPropertiesTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to pin another."},maxPinnedPropertiesAddPropertyTooltip:{id:"pageLayout.configurePinnedProperties.maxPinnedPropertiesAddPropertyTooltip",defaultMessage:"Maximum number of pinned properties reached. {br} Unpin a property to create a new pinned property."},optionsLabel:{id:"pageLayout.configurePinnedProperties.optionsLabel",defaultMessage:"Options"},showBacklinksOption:{id:"pageLayout.configurePinnedProperties.showBacklinksOption",defaultMessage:"Backlinks"}});var Kt=()=>n(180762);const Wt=o.memo((function(e){let{module:t}=e;const{moduleStateByIdStore:o}=(0,X().bi)(),i=(0,a().K8)((()=>{var e;return null===(e=o.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[o,t.id]),r=(0,a().K8)((()=>{var e;return null==i||null===(e=i.collectionViewStore())||void 0===e?void 0:e.id}),[i]),l=(0,a().K8)((()=>null==i?void 0:i.settingsStore),[i]),d=(0,s().IS)((()=>({titleWrapper:{...$t,marginBottom:6,display:"flex"},viewsContainer:{marginTop:8,width:"100%",display:"flex",flexDirection:"column"}})),[]),u=(0,a().K8)((()=>{var e;return null==i||null===(e=i.settingsStore)||void 0===e?void 0:e.getState().open}),[i]);return"viewsMain"===t.type&&i&&l&&u?(0,K.jsx)(Ct,{children:(0,K.jsx)(Q().p2.Provider,{value:i,children:(0,K.jsx)(kt().m$,{collectionContextStore:i,collectionSettingsStore:l,context:jt().Bd.ViewSettings})})}):(0,K.jsxs)("div",{children:[(0,K.jsx)("div",{style:d.titleWrapper,children:(0,K.jsx)(c().sA,{...ve().s.viewsMain})}),(0,K.jsxs)("div",{style:d.viewsContainer,children:[(0,K.jsx)(Ht,{collectionContextStore:i,currentViewId:r,module:t}),"viewsMain"===t.type&&(0,K.jsx)(n(965731).ConfigureViewsMainModuleAddViewButton,{renderOrigin:e=>(0,K.jsx)(Oe().p,{iconLeading:n(689094).W,isGray:!0,...e,children:(0,K.jsx)(c().sA,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"})})})]})]})}));function Ht(e){let{collectionContextStore:t,currentViewId:o,module:i}=e;const s=(0,r().v3)(),l=(0,a().K8)((()=>{if(!t)return[];const e=t.collectionViewBlockStore(),n=null==e?void 0:e.getCollectionViewStores();return null==n?void 0:n.map((e=>{var t;return{id:e.id,icon:null===(t=e.getFormat())||void 0===t?void 0:t.collection_view_icon,type:e.getType(),name:e.getName(),pointer:e.pointer}}))}),[t]);return"editor"===i.type?(0,K.jsx)(Oe().p,{children:(0,K.jsx)("div",{style:{fontWeight:600},children:(0,K.jsx)(c().sA,{...ve().s.editor})})},"editor"):l&&t?(0,K.jsx)(K.Fragment,{children:l.map((e=>(0,K.jsx)(Oe().p,{iconLeading:t=>(0,K.jsx)(n(745266).h,{viewIcon:e.icon,viewType:e.type,color:"regular",style:t}),onClick:()=>{(0,Kt().t)({environment:s,collectionContextStore:t,collectionViewId:e.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1}),wt().Ow({collectionContextStore:t,collectionSettingsStore:t.settingsStore})},children:(0,K.jsx)("div",{style:{fontWeight:e.id===o?600:void 0},children:void 0!==e.type?(0,n(519839).OO)({collectionViewName:e.name,collectionViewType:e.type}):(0,K.jsx)(c().sA,{...Gt.newView})})},e.id)))}):null}const Gt=(0,c().YK)({newView:{defaultMessage:"New view",id:"database.viewSettings.createViewTab.newView"}});function Yt(e){let{module:t}=e;const{moduleStateByIdStore:n}=(0,X().bi)(),o=(0,a().K8)((()=>{var e;return null===(e=n.get(t.id))||void 0===e?void 0:e.collectionContextStore}),[n,t.id]),i=(0,a().K8)((()=>null==o?void 0:o.settingsStore),[o]);return t&&o&&i?(0,K.jsx)(Ct,{children:(0,K.jsx)(Q().p2.Provider,{value:o,children:(0,K.jsx)(kt().m$,{collectionContextStore:o,collectionSettingsStore:i,context:jt().Bd.ViewSettings})})}):null}function qt(e){let{moduleId:t}=e;const{layoutStore:n}=(0,X().LH)(),o=(0,a().K8)((()=>n.getModuleById(t)),[n,t]),i=(0,s().IS)((()=>({container:{display:"flex",flexDirection:"column",..."properties"!==(null==o?void 0:o.type)&&"normalizedTitleWithIcon"!==(null==o?void 0:o.type)?{paddingBottom:80}:{height:"100%"}}})),[null==o?void 0:o.type]);return o?(0,K.jsxs)("div",{style:i.container,children:[(r=o,"viewsMain"!==r.type&&"editor"!==r.type&&!(0,ae().gx)(r)&&(0,K.jsx)(Qt,{module:o})),(0,K.jsx)(Zt,{module:o})]}):null;var r}const $t={fontWeight:_().Wy.medium,marginBottom:0,marginLeft:6,fontSize:16,lineHeight:"24px"};function Qt(e){const{module:t}=e,n=(0,K.jsx)("div",{style:$t,children:(0,K.jsx)(c().sA,{...ve().s[t.type]})});return"properties"===t.type?(0,K.jsx)(Mt,{title:n}):n}function Zt(e){const{module:t}=e;if((0,ae().gx)(t))return(0,K.jsx)(It,{module:t});const{type:n}=t;switch(n){case"properties":return(0,K.jsx)(yt,{module:t});case"normalizedTitleWithIcon":return(0,K.jsx)(Ut,{module:t});case"relationsGroup":return(0,K.jsx)(_t,{module:t});case"views":return(0,K.jsx)(Yt,{module:t});case"viewsMain":case"editor":return(0,K.jsx)(Wt,{module:t});case"deleted_property":case"cover":case"inlinePageSections":case"expandedBacklinks":case"discussions":case"bottomControls":case"transcript":case"formQuestion":case"formTitle":case"formSubmit":case"placeholder":case"recentActivity":case"collaborators":case"teamspaces":return null;default:(0,u().HB)(n)}return null}const Xt=290,Jt=16;function en(){const{currentModuleSelection:e,layoutStore:t,sessionId:n}=(0,X().LH)(),{collectionStore:o,pageStore:i}=(0,X().bi)(),r=(0,a().K8)((()=>{const e=o.getFormat(),t=o.getSchema();return(0,I().L)(e,t,void 0,C().jf.Collection)}),[o]),l=(0,s().IS)((t=>({container:{padding:`8px ${Jt}px ${"existing_module"===(null==e?void 0:e.type)?"0":"24px"}`,minWidth:Xt,width:Xt,maxWidth:Xt},title:{fontSize:16,lineHeight:"24px",fontWeight:_().Wy.medium,margin:"0px 8px 0px 8px"},label:{fontSize:_().J.UISmall.desktop,fontWeight:_().Wy.medium,margin:"24px 8px 6px 8px",color:t.text.secondary},switcherButton:{marginRight:0}})),[e]),d=(0,a().K8)((()=>Boolean(o.getFormat().external_object_id)),[o]);return e?(0,K.jsxs)(g().H,{type:S().A.Y,style:l.container,children:["existing_module"===e.type&&(0,K.jsx)(qt,{moduleId:e.moduleId}),"new_module"===e.type&&(0,K.jsx)(he,{})]}):(0,K.jsxs)("div",{style:l.container,children:[(0,K.jsx)("div",{style:l.title,children:(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.title",defaultMessage:"Page settings"})}),(0,K.jsx)(tn,{collectionStore:o,layoutStore:t,sessionId:n,styles:l}),(0,K.jsx)("div",{style:l.label,children:(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.options",defaultMessage:"Options"})}),(0,K.jsx)(on,{disabled:d,collectionStore:o,normalizedCollectionFormat:r,styles:l}),(0,K.jsx)(nn,{disabled:d,collectionStore:o,normalizedCollectionFormat:r,styles:l}),(0,K.jsx)(rn,{layoutStore:t,styles:l}),(0,K.jsx)(an,{pageStore:i,layoutStore:t,styles:l})]})}function tn(e){const{collectionStore:t,layoutStore:n,sessionId:i,styles:s}=e,l=(0,r().v3)(),d=(0,a().K8)((()=>n.isTabbedPageLayout()),[n]),{value:p}=(0,E().fJ)(U.switchFromSimpleToTabbedLayoutActions),{value:m}=(0,E().fJ)(U.switchFromTabbedToSimpleLayoutActions),g=!p||!m,f=d?"tabbed":"simple",h=(0,o.useMemo)((()=>({available:["simple","tabbed"],appearance:{simple:{label:(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.structure.simple",defaultMessage:"Simple"}),image:{src:j().A.images.layouts.configuration.simplePageLayoutStructurePng,width:112,height:80}},tabbed:{label:(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.structure.tabbed",defaultMessage:"Tabbed"}),image:{src:j().A.images.layouts.configuration.tabbedPageLayoutStructurePng,width:112,height:80}}}})),[]),v=(0,o.useCallback)((async e=>{p&&m&&("simple"===e?m.switchFromTabbedToSimpleLayout({environment:l,layoutStore:n}):"tabbed"===e?await p.switchFromSimpleToTabbedLayout({environment:l,layoutStore:n}):(0,u().HB)(e),(0,x().GF)({environment:l,layoutId:n.id,collectionId:t.id,sessionId:i,structure:e}))}),[p,m,l,n,t.id,i]);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)("div",{style:s.label,children:(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.structure",defaultMessage:"Structure"})}),(0,K.jsx)(R().A,{disabled:g,options:h,selectedOption:f,onOptionSelected:v,height:"tall"})]})}function nn(e){var t;const{disabled:n,collectionStore:i,normalizedCollectionFormat:a,styles:s}=e,l=(0,r().v3)(),d="section_hide"===(null===(t=a.page_section_visibility)||void 0===t?void 0:t.comments)?"section_hide":"section_show",u=(0,o.useCallback)((e=>{const t=i.getFormat(),n=i.getSchema(),o=(0,I().L)(t,n,void 0,C().jf.Collection);P().OD({environment:l,pageSection:"comments",visibility:e,store:i,format:o})}),[i,l]);return(0,K.jsx)(D().Ay,{title:(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.pageDiscussions",defaultMessage:"Page discussions"}),right:(0,K.jsx)(O().kS,{disabled:n,currentVisibility:d,onSelect:u}),rightStyle:s.switcherButton})}function on(e){var t;const n=(0,r().v3)(),{disabled:i,collectionStore:a,normalizedCollectionFormat:s,styles:l}=e,d="minimal"===(null===(t=s.page_section_visibility)||void 0===t?void 0:t.margin_comments)?"minimal":"inline",u=(0,o.useCallback)((e=>{const t=a.getFormat(),o=a.getSchema(),i=(0,I().L)(t,o,void 0,C().jf.Collection);P().OD({environment:n,pageSection:"margin_comments",visibility:e,store:a,format:i})}),[a,n]);return(0,K.jsx)(D().Ay,{title:(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.inlineComments",defaultMessage:"Inline comments"}),right:(0,K.jsx)(O().J8,{disabled:i,currentVisibility:d,onSelect:u}),rightStyle:l.switcherButton})}function rn(e){const{layoutStore:t,styles:n}=e,i=(0,r().v3)(),s=(0,a().K8)((()=>{var e;return"show"===((null===(e=t.getFormat())||void 0===e?void 0:e.property_icons_visibility)??"show")}),[t]),l=(0,o.useCallback)((()=>{L().createAndCommit({environment:i,userAction:"pageLayoutActions.handleShowPropertyIcons",canUndo:!0,perform:e=>{var n;B().zA({stores:[t],update:{property_icons_visibility:"hide"===(null===(n=t.getFormat())||void 0===n?void 0:n.property_icons_visibility)?"show":"hide"},transaction:e})}})}),[t,i]);return(0,K.jsx)(D().Ay,{title:(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.showPropertyIcons",defaultMessage:"Property icons"}),onClick:l,right:(0,K.jsx)(N().A,{on:s}),rightStyle:n.switcherButton})}function an(e){const{pageStore:t,layoutStore:n,styles:i}=e,l=(0,r().v3)(),d=(0,a().K8)((()=>{var e;return null===(e=n.getFormat())||void 0===e?void 0:e.page_full_width}),[n]),u=(0,o.useCallback)((()=>{L().createAndCommit({environment:l,userAction:"pageLayoutActions.handleShowFullWidth",canUndo:!0,perform:e=>{var o;const i=!(null!==(o=n.getFormat())&&void 0!==o&&o.page_full_width);B().zA({stores:[n],update:{page_full_width:i},transaction:e}),void 0!==t.getFormatStore().getKeyValue("page_full_width")&&B().zA({stores:[t],update:{page_full_width:void 0},transaction:e})}})}),[n,l,t]),p=(0,s().IS)((e=>({icon:{height:14,width:14,color:e.icon.secondary},title:{display:"flex",alignItems:"center",gap:"4px"},tooltip:{maxWidth:240,width:"max-content",overflowWrap:"break-word",textWrap:"wrap"}})),[]);return(0,K.jsx)(D().Ay,{title:(0,K.jsxs)("div",{style:p.title,children:[(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth",defaultMessage:"Full width"}),(0,K.jsx)(h().A,{placement:b().W.Bottom,renderTooltip:()=>(0,K.jsx)(c().sA,{id:"PageLayoutConfigurationSidebar.showFullWidth.tooltip",defaultMessage:"Page width can be overwritten on individual pages."}),render:e=>(0,K.jsx)("div",{...e,children:(0,T().G)(p.icon)}),style:p.tooltip})]}),onClick:u,right:(0,K.jsx)(N().A,{on:Boolean(d)}),rightStyle:i.switcherButton})}var sn=()=>n(761660),ln=()=>n(607810),dn=()=>n(817942),cn=()=>n(604341),un=()=>n(475140),pn=()=>n(179034),mn=()=>n(507807);function gn(e){var t;const{layoutStore:o,tabToFocus:i,moduleStateByIdStore:r,environment:a}=e,s=o.pointer,l=o.getModules(),d=(0,un().EX)(l,(e=>"viewsMain"===e.type));if(!d||!(0,ae().y6)(d.module))return;const{module:c}=d,p=null==r||null===(t=r.get(c.id))||void 0===t?void 0:t.collectionContextStore;if(!p)return;const m=n(148832).B.createChildStore(o,c.collection_view_block_pointer).getCollectionViewStores();let g;"viewId"===(null==i?void 0:i.type)?g=null==m?void 0:m.find((e=>{var t;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id)===i.viewId})):"contentTab"===(null==i?void 0:i.type)?g=null==m?void 0:m.find((e=>{var t;if("page"!==e.getType())return!1;return(null===(t=e.getFormat().page_layout_pointer)||void 0===t?void 0:t.id)===s.id})):(0,u().HB)(i),g&&(0,Kt().t)({environment:a,collectionContextStore:p,collectionViewId:g.id,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}var fn=()=>n(792071),hn=()=>n(763824),vn=()=>n(414360),yn=()=>n(630116);async function bn(e){const{environment:t,layoutStore:n,blockPointer:o}=e,i=yn().Bv.createChildStore(n,o);if(await i.load(),!i.isCollectionView())return;const r=i.getCollectionViewStores();await(0,hn().lX)(r,25,(e=>e.load()));const a=r.filter((e=>"page"===e.getType()));if(a.length<=1)return;const s=n.getModules(),l=(0,un().JO)(s,ae().gp);if(!l||"views_main_tab_modules"!==l.area)return;const d=l.viewId,c=a.find((e=>{var t;const n=null===(t=e.getFormat())||void 0===t?void 0:t.page_layout_pointer;return!!n&&n.views_main_tab_id===d}));if(!c)return;const u=a.filter((e=>e!==c));0!==u.length&&L().createAndCommit({environment:t,userAction:"cleanupDuplicateContentTabsInTabbedCollectionViewBlock",canUndo:!1,perform:e=>{for(const r of u){var t,o;const a=null===(t=r.getFormat())||void 0===t||null===(t=t.page_layout_pointer)||void 0===t?void 0:t.views_main_tab_id;if((0,vn().T)({collectionViewBlockStore:i,collectionViewStore:r,transaction:e}),!a)continue;const s=(null===(o=n.getRawModules())||void 0===o||null===(o=o.views_main_tab_modules)||void 0===o?void 0:o[a])||[];for(const t of s.reverse())L().applyOperation({store:n,transaction:e,operation:fn().N4X.putModuleBeforeOrAfter({pointer:n.pointer,area:"views_main_tab_modules",viewId:d,module:t,direction:"before",beforeOrAfterId:void 0})});L().applyOperation({store:n,transaction:e,operation:fn().N4X.deleteViewTabModulesTab({pointer:n.pointer,viewId:a})})}}})}async function Sn(e){const{environment:t,layoutStore:o}=e;await async function(e){const{environment:t,layoutStore:n}=e;if(!n.isTabbedPageLayout())return;const o=n.getBlockChildrenPointers();for(const r of o){var i;null!==(i=n.getModel())&&void 0!==i&&i.isTabbedLayoutCollectionViewBlockPointer(r)&&await bn({environment:t,layoutStore:n,blockPointer:r})}}({environment:t,layoutStore:o}),(0,n(210748).O)({environment:t,layoutStore:o})}const xn=o.memo((function(e){let{children:t,collectionStore:i,pageStore:s,sessionId:l,layoutBuilderModuleSelectionStore:d}=e;const c=(0,r().v3)(),u=(0,a().K8)((()=>{var e;return null===(e=n(765957).default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),p=(0,a().K8)((()=>i.getSpaceId()),[i]),m=(0,o.useMemo)((()=>(null==s?void 0:s.id)??(0,n(594794).Z1)({environment:c,table:pn().ev,spaceId:p})),[c,null==s?void 0:s.id,p]),g=(0,o.useCallback)((e=>{var t;if(e.operation.pointer.id===m)return!1;if((null===(t=e.operation)||void 0===t||null===(t=t.args)||void 0===t?void 0:t.parent_id)===m)throw new Error("Unexpected operation on temporary page.");return!0}),[m]),f=(0,mn().S)(n(342).oB,{canUndo:!1,shouldPersistOperation:s?void 0:g}),h=(0,a().K8)((()=>{if(s)return s.clone(f.cache);return L().createAndCommit({environment:c,perform(e){const t=n(246826).Wv({environment:c,type:"page",id:m,inMemoryRecordCache:f.cache,transaction:e});return L().applyOperation({store:t,operation:n(134025).op.update({pointer:{id:t.pointer.id,table:pn().ev,spaceId:t.pointer.spaceId},path:[],args:{parent_id:i.id,parent_table:i.table}}),transaction:e}),t},userAction:"PageLayoutEditorContext.createEmptyPageStore",canUndo:!1}).performResult}),[i,f.cache,c,s,m]),v=function(e,t){const i=(0,r().v3)(),s=(0,o.useMemo)((()=>new(n(414834).A)(i)),[i]),l=(0,mn().f)(e,t),d=(0,a().K8)((()=>null==t?void 0:t.getParentBlockStore()),[t]);return(0,o.useEffect)((()=>{s.setContext({type:"collectionPage",collectionViewBlockStore:d,collectionStore:l})}),[s,l,d]),s}(f,i),{unpersistedCollectionStore:y,unpersistedLayoutStore:b,modulesByArea:S}=(0,a().K8)((()=>{const e=v.collectionStore(),t=null==e?void 0:e.getLayoutStore();return{unpersistedCollectionStore:e,unpersistedLayoutStore:t,modulesByArea:null==t?void 0:t.getModules()}}),[v]),[x,A]=(0,o.useState)(void 0);(0,n(543906).A)((()=>{A((0,Ne().mg)(S))}),Boolean(S));const M=(0,a().uB)(void 0,n(731120).A),w=o.useRef(!1);(0,a().K8)((()=>{u&&y&&!b&&(L().createAndCommit({environment:c,perform:e=>Dt().$L({environment:c,transaction:e,collectionStore:y,userId:u}),userAction:"PageLayoutEditorContext.initCollectionLayout",canUndo:!1}),w.current=!0)}),[c,y,b,u]);const k=(0,o.useCallback)((async()=>{if(u&&b)return await Sn({environment:c,layoutStore:b}),f.persist("PageLayoutEditorContext.updateLayout")}),[f,c,b,u]),j=(0,o.useCallback)((()=>{f.reset();const e=i.getLayoutStore();return!!e&&(L().createAndCommit({environment:c,perform(t){Nt().gL({environment:c,transaction:t,layoutStore:e,collectionStore:i})},userAction:"PageLayoutEditorContext.resetLayoutToDefault",canUndo:!1}),!0)}),[i,f,c]),C=(0,a().K8)((()=>d.getState()),[d]),I=(0,a().K8)((()=>h.isReady()&&(null==b?void 0:b.isReady())),[b,h]),[T,_]=(0,o.useState)([]),P=(0,o.useMemo)((()=>new(n(265515).G)),[]),B=(0,o.useCallback)((e=>{if(d.setState(e),b&&e&&"existing_module"===e.type&&e.moduleId){const t=null==b?void 0:b.getModules();if(!t)return;const n=(0,un().EX)(t,(t=>t.id===e.moduleId));n&&"views_main_tab_modules"===n.position.area&&gn({tabToFocus:{type:"contentTab"},layoutStore:b,moduleStateByIdStore:P,environment:c})}}),[c,d,P,b]),R=Ae().Store.createValue(!1),D=(0,o.useMemo)((()=>b&&{layoutStore:b,collectionStore:y,currentModuleSelection:C,setModuleSelection:B,sessionId:l,addModuleHoverMenuStore:M,canEditLayout:!0,isPropertyTypeSearchInputDirtyStore:R,layoutBuilderModuleSelectionStore:d}),[b,y,C,B,l,M,R,d]),N=(0,o.useMemo)((()=>y&&{pageStore:h,hasUnsavedChanges:f.hasChanges,saveChanges:k,moduleIdsMovedFromSidebar:T,setModuleIdsMovedFromSidebar:_,isNewLayout:w.current,initialLayoutModulesByArea:x,resetLayoutToDefault:j,moduleStateByIdStore:P,collectionContextStore:v,collectionStore:y}),[y,h,f.hasChanges,k,T,x,j,P,v]);return I&&b&&D&&N?(0,K.jsx)(Q().RI,{value:v,children:(0,K.jsx)(X().Op.Provider,{value:D,children:(0,K.jsxs)(X().sf.Provider,{value:N,children:[(0,cn().isConsoleEnabled)()&&(0,K.jsx)(An,{}),t]})})}):null}));function An(){return(0,o.useEffect)((()=>()=>{(0,cn().exposeDebugValue)("baseLayoutEditorContext",void 0),(0,cn().exposeDebugValue)("pageLayoutEditorContext",void 0)}),[]),(0,cn().exposeDebugValue)("baseLayoutEditorContext",(0,X().LH)()),(0,cn().exposeDebugValue)("pageLayoutEditorContext",(0,X().bi)()),null}var Mn=n.n(n(32485)),wn=()=>n(212050),kn=()=>n(175947),jn=()=>n(187820),Cn=()=>n(16006),In=()=>n(38337),Tn=()=>n(948914),_n=()=>n(615244),Pn=()=>n(668725),Bn=()=>n(245241),Ln=()=>n(331542),Rn=()=>n(64e3),Dn=()=>n(958378),Nn=()=>n(553965),On=()=>n(135599);function En(e){let{collectionStore:t}=e;const n=(0,o.useRef)(null),[i,r]=o.useState(""),{pageStore:s}=(0,X().bi)(),{results:l,isResultsLoading:d}=(0,On().W)({query:i,type:Bn().Vz.BlocksInCollection,source:"layout_builder_page_selector",limit:10,collectionId:t.id,options:{disable:!1}}),u=(0,a().K8)((()=>d?[{key:"loading",action:()=>{},render:e=>(0,K.jsx)(Rn().A,{...e,title:(0,K.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,K.jsx)(Ln().A,{})})})}]:0===l.length?[{key:"no_results",action:()=>{},render:e=>(0,K.jsx)(Rn().A,{...e,title:(0,K.jsx)(c().sA,{id:"pageLayoutEditor.pagePicker.noResults",defaultMessage:"No results."})})}]:l.map((e=>{const t=(null==s?void 0:s.id)===e.id;return{key:e.id,render:n=>(0,K.jsx)(Dn().A,{...n,store:e.store,hidePath:!0,isChecked:t}),action:()=>{if(t)return;if(!k().g.state.isOpen||"layout-editor"!==k().g.state.mode)throw new Error("Expected page layout editor to be open.");const n={isOpen:k().g.state.isOpen,mode:"layout-editor",pageStore:e.store,sessionId:k().g.state.sessionId,collectionStore:k().g.state.collectionStore};k().g.setState(n)}}}))),[null==s?void 0:s.id,d,l]),p=(0,K.jsx)($().A,{isInput:!0,style:{paddingBottom:0},desktopTitleStyle:{paddingBottom:0,marginBottom:0},children:(0,K.jsx)(Y().Ay,{ref:n,value:i,placeholder:y().A.formatMessage(Fn.searchPlaceholder),focusAfterAnimation:!0,showClearButton:!0,style:{marginBottom:10},onChange:e=>{r(e.target.value)},focusInitial:l.length>0||void 0})}),m=(0,K.jsx)(ze().A,{menuType:He().gu.Popup,header:p,width:300,children:(0,K.jsx)(q().Ay,{type:q().Oh.Vertical,style:{marginBottom:0},sections:[{key:"results",items:u,render:e=>(0,K.jsx)($().A,{...e})}],initialFocus:l.length>0?0:void 0})});return(0,K.jsx)(Ee().Ay,{popupType:Ee().z7.Popup,renderOrigin:e=>(0,K.jsx)(Un,{...e,pageStore:s}),originGap:2,render:()=>m,onClose:()=>r("")})}function Un(e){const{pageStore:t,...n}=e,o=(0,s().IS)((e=>({previewButton:{color:e.text.secondary,fontWeight:_().Wy.medium,display:"flex",gap:6,alignItems:"center",justifyContent:"center",padding:"3px 6px",height:void 0,fontSize:12,overflow:"hidden",maxWidth:"100%"},recordTitle:{..._().RC,flexGrow:1},previewLabelContainer:{display:"flex",gap:3,minWidth:0},previewLabel:{flexShrink:0},chevronDownIcon:{flexShrink:0,width:10}})),[]);return(0,K.jsx)(h().A,{placement:b().W.Right,renderTooltip:()=>(0,K.jsx)(c().sA,{defaultMessage:"Choose page to preview",id:"PageLayoutEditorHeader.pagePicker.title"}),render:e=>(0,K.jsxs)(Oe().p,{...(0,Nn().A)(e,n),style:o.previewButton,children:[(0,K.jsxs)("div",{style:o.previewLabelContainer,children:[(0,K.jsx)("div",{style:o.previewLabel,children:(0,K.jsx)(c().sA,{defaultMessage:"Preview:",id:"PageLayoutEditorHeader.pagePicker.titlePrefix"})}),(0,K.jsx)(Cn().A,{store:t,style:o.recordTitle})]}),(0,Pn().b)(o.chevronDownIcon)]})})}const Fn=(0,c().YK)({searchPlaceholder:{id:"pageLayoutEditor.pagePicker.searchPlaceholder",defaultMessage:"Search pages..."}});const Vn=function(){const e=(0,c().tz)(),t=(0,r().v3)(),{setModuleSelection:i,currentModuleSelection:a,layoutStore:l,sessionId:d}=(0,X().LH)(),u=void 0===a,p=(0,o.useCallback)((()=>{var e;null==i||i(void 0),(0,x().L3)({environment:t,layoutId:l.id,collectionId:null===(e=l.getCollectionModel())||void 0===e?void 0:e.id,sessionId:d,from:"page_settings_button_click"})}),[i,t,l,d]),m=(0,s().IS)((e=>({button:{...u&&{background:e.state.hover}},icon:{width:z().Ev.default,height:z().Ev.default}})),[u]);return i?(0,K.jsx)(Oe().p,{"aria-label":e.formatMessage({id:"pageLayoutEditorPageSettingsButton.ariaLabel",defaultMessage:"Page settings"}),iconLeading:n(735790).M,iconStyle:m.icon,onClick:p,style:m.button,size:"lg",children:(0,K.jsx)(c().sA,{id:"pageLayoutEditorPageSettingsButton.label",defaultMessage:"Page settings"})}):null},zn=(0,z().xh)("arrowUTurnUpLeft",{default:{loader:()=>n.e(75152).then(n.bind(n,454503))},small:{loader:()=>n.e(75152).then(n.bind(n,613601))},fill:{loader:()=>n.e(75152).then(n.bind(n,357715))},fillSmall:{loader:()=>n.e(75152).then(n.bind(n,139274))}},["uturn","left","reverse","direction","turn","undo","back"]);var Kn=()=>n(701545),Wn=()=>n(112452),Hn=()=>n(901389),Gn=()=>n(7674),Yn=()=>n(107683),qn=()=>n(430102),$n=()=>n(716108),Qn=()=>n(377586);const Zn={id:"pageLayoutAreas.page_main",defaultMessage:"main page",description:"Name for the main area of the page"},Xn={id:"pageLayoutAreas.page_details",defaultMessage:"sidebar",description:"Name for the details sidebar"},Jn={id:"pageLayoutAreas.form_layout_schema",defaultMessage:"form",description:"Name for the form area"},eo=(0,c().YK)({page_main:Zn,page_layout_schema:Zn,page_details:Xn,page_info_layout_schema:Xn,form_layout_schema:Jn,form_conditional_modules:Jn,views_main_tab_modules:{id:"pageLayoutAreas.views_main_tab_modules",defaultMessage:"views main tab",description:"Name for the views main tab"},person_profile_page_main:{id:"pageLayoutAreas.person_profile_page_main",defaultMessage:"person profile main column",description:"Name for the person profile page main area (primary column)"},person_profile_page_details:{id:"pageLayoutAreas.person_profile_page_details",defaultMessage:"person profile details column",description:"Name for the person profile page details area (secondary column)"},generic:{id:"pageLayoutEditor.generic",defaultMessage:"area"}});function to(){const{collectionStore:e,hasUnsavedChanges:t,saveChanges:n,isNewLayout:i,initialLayoutModulesByArea:l,resetLayoutToDefault:d}=(0,X().bi)(),{sessionId:u,layoutStore:p}=(0,X().LH)(),m=(0,r().v3)(),g=(0,c().tz)(),[f,h]=(0,o.useState)(!1),y=(0,a().K8)((()=>p.getModules()),[p]),S=(0,s().IS)((e=>({saveButton:{height:32},saveButtonCheckMarkIcon:{width:14,height:14},saveButtonInner:{lineHeight:1.2,fontSize:14,fontWeight:_().Wy.medium},saveButtonRevertItemTitle:{fontSize:_().J.UIRegular.desktop,lineHeight:"20px",color:e.text.primary},saveButtonRevertItemIcon:{width:16,height:16,marginTop:2,fill:e.primaryBlack},saveButtonRevertItem:{margin:"4px",padding:"0 4px 4px"},saveButtonSectionMenuItem:{minWidth:254,padding:0}})),[]),A=(0,o.useCallback)((t=>{Dt().Fv({environment:m}),x().do({environment:m,sessionId:u,collectionId:e.id,existingLayoutId:i?void 0:p.id,layoutSaved:t,context:"layout",initialLayoutModulesByArea:l,finalModulesByArea:y})}),[e.id,m,l,i,p.id,u,y]),M=(0,o.useCallback)((async()=>{if(t){h(!0);try{await n(),A(!0)}catch(e){if(h(!1),!(e instanceof $n().rS))throw e;{const t=e.clientData;if("cannot_move_unmoveable_module"===(null==t?void 0:t.type))Hn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeMoved",defaultMessage:"The {moduleType} module cannot be moved."},{moduleType:g.formatMessage(ve().s[t.moduleType]).toLowerCase()}));else if("cannot_remove_undeletable_module"===(null==t?void 0:t.type))Hn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.moduleCannotBeDeleted",defaultMessage:"The {moduleType} module cannot be removed."},{moduleType:g.formatMessage(ve().s[t.moduleType]).toLowerCase()}));else if("unallowed_module_in_area"===(null==t?void 0:t.type)){const e={moduleType:g.formatMessage(ve().s[t.moduleType]).toLowerCase(),area:"page_layout_schema"===t.area?g.formatMessage(eo.page_main):"page_info_layout_schema"===t.area?g.formatMessage(eo.page_details):g.formatMessage(eo.generic)};Hn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.unallowedModuleInArea",defaultMessage:"The {moduleType} module is not allowed in {area}."},e))}else{if("multiple_views_main_content_tabs"!==(null==t?void 0:t.type)){const e=g.formatMessage({id:"layoutBuilder.saveButton.error.fallback",defaultMessage:"Something went wrong while saving layout."});return void Hn().f1(e)}Hn().f1(g.formatMessage({id:"layoutBuilder.saveButton.error.multipleViewsMainContentTabs",defaultMessage:"Tabbed layouts may not have multiple content tabs. Please reset your layout to remove the duplicate tab."}))}}}}else A(!1)}),[A,t,g,n]),w=(0,o.useCallback)((()=>{d(),x().kA({environment:m,context:"layout",sessionId:u,collectionId:e.id,layoutId:i?void 0:p.id}),j(!1),A(!0)}),[A,e.id,m,i,p.id,d,u]),[k,j]=o.useState(!1);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(Ee().Ay,{popupType:Qn().n.Popup,alignmentToOrigin:b().C.End,originGap:4,render:e=>(0,K.jsx)($().A,{style:S.saveButtonSectionMenuItem,children:(0,K.jsx)(G().A,{onClick:()=>{j(!0),e.close()},focused:!1,itemMarginLeft:0,itemMarginRight:0,style:S.saveButtonRevertItem,body:(0,K.jsxs)(v().Ye,{gap:10,children:[(0,Wn()._)(S.saveButtonRevertItemIcon),(0,K.jsxs)(v().wt,{children:[(0,K.jsx)("div",{style:S.saveButtonRevertItemTitle,children:(0,K.jsx)(c().sA,{id:"pageLayoutEditor.revertToOriginalLayout",defaultMessage:"Reset to original page layout"})}),(0,K.jsx)("div",{children:(0,K.jsx)(c().sA,{id:"pageLayoutEditor.revertToOriginalLayoutSubtitle",defaultMessage:"No properties will be deleted"})})]})]})})}),renderOrigin:e=>(0,K.jsx)(qn().I,{style:S.saveButton,mainButtonStyle:S.saveButtonInner,title:(0,K.jsx)(c().sA,{id:"pageLayoutEditor.saveAndClose",defaultMessage:"Apply to all pages"}),color:"blue",onClick:M,disableDropdown:!1,iconLeading:Kn().p,iconStyle:S.saveButtonCheckMarkIcon,onDropdownClick:e.onClick,isLoading:f})}),k&&(0,K.jsx)(Yn().s,{isOpen:!0,showCloseIcon:!0,allowDismissByEscape:!0,onDismiss:()=>j(!1),areaConstraint:{width:{type:"min",length:300}},render:e=>{let{sizeRange:t}=e;return(0,K.jsx)(Gn().tf,{header:(0,K.jsx)(Gn().YA,{iconAndTitle:(0,K.jsx)(Gn().ZQ,{iconGroup:zn,title:(0,K.jsx)(c().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.title",defaultMessage:"Reset to original page layout?"})}),description:(0,K.jsx)(c().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.subtitle",defaultMessage:"No properties will be deleted."})}),footer:(0,K.jsx)(Gn().aO,{layout:"vertical",primaryButtons:[{buttonType:"destructive",label:(0,K.jsx)(c().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.revertButton",defaultMessage:"Reset"}),onClick:w}],secondaryButtons:[{buttonType:"dismiss",label:(0,K.jsx)(c().sA,{id:"pageLayoutEditor.revertToOriginalLayout.modal.cancelButton",defaultMessage:"Cancel"})}]}),sizeRange:t})}})]})}function no(){const e=(0,r().v3)(),{device:t}=e,{isElectron:n,isElectronMac:i}=t,{sessionId:l,layoutStore:d}=(0,X().LH)(),{collectionStore:u,hasUnsavedChanges:p,isNewLayout:m,initialLayoutModulesByArea:g}=(0,X().bi)(),f=(0,a().K8)((()=>d.getModules()),[d]),h=(0,a().O$)(Tn().b),y=n&&!h,b=(0,a().K8)((()=>(0,kn().ek)(i)),[i]),S=(0,o.useCallback)((async()=>{x().do({environment:e,sessionId:l,collectionId:u.id,existingLayoutId:m?void 0:d.id,layoutSaved:!1,context:"layout",initialLayoutModulesByArea:g,finalModulesByArea:f});const t=()=>Dt().Fv({environment:e});if(!p)return void t();await(0,_n().$)()&&t()}),[e,l,u.id,m,d.id,g,f,p]),A=(0,s().IS)((e=>{const t={pointerEvents:"auto"};return{header:{zIndex:1},headerContent:{display:"flex",position:"relative",margin:"8px 16px 8px 16px"},topbarPlaceholder:{minHeight:b,background:e.onboardingPreviewBackground,borderBottom:`1px solid ${e.stroke.primary}`},sideButtonsContainer:{display:"flex",justifyContent:"space-between",width:"100%",height:"100%",gap:"6px",position:"absolute",left:0,top:0,pointerEvents:"none"},rightButtons:{...t},pageSettingsButtonContainer:{display:"flex",...t},titlePreviewContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flexGrow:1,position:"relative",..._().RC},titlePreviewElementContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:400,overflow:"hidden"}}}),[b]);return(0,K.jsxs)("header",{style:A.header,children:[y?(0,K.jsx)("div",{style:A.topbarPlaceholder,className:Mn()({[In().N_7]:!0,[In().sbV]:!0})}):null,(0,K.jsxs)("div",{style:A.headerContent,children:[(0,K.jsx)("div",{style:A.titlePreviewContainer,children:(0,K.jsxs)("div",{style:A.titlePreviewElementContainer,children:[(0,K.jsx)(oo,{collectionStore:u}),(0,K.jsx)(En,{collectionStore:u})]})}),(0,K.jsxs)(v().Ye,{style:A.sideButtonsContainer,alignItems:"center",justifyContent:"space-between",children:[(0,K.jsx)("div",{style:A.pageSettingsButtonContainer,children:(0,K.jsx)(Vn,{})}),(0,K.jsxs)(v().Ye,{gap:8,alignItems:"center",style:A.rightButtons,children:[(0,K.jsx)(Oe().p,{onClick:S,iconLeading:wn().u,size:"lg",children:(0,K.jsx)(c().sA,{id:"pageLayoutEditor.close",defaultMessage:"Cancel"})}),(0,K.jsx)(to,{})]})]})]})]})}function oo(e){let{collectionStore:t}=e;const n=(0,s().IS)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,color:e.text.primary,fontWeight:_().Wy.medium,width:"100%",..._().RC}})),[]),o=(0,a().K8)((()=>t.getIcon()),[t]);return(0,K.jsxs)("div",{style:n.container,children:[(0,K.jsx)(jn().B6,{icon:o,size:20,iconRecordCategory:"collection",isEmptyPage:!1,disabled:!0}),(0,K.jsx)(Cn().A,{store:t})]})}function io(e){const t=(0,s().IS)((e=>({container:{width:"100%",backgroundColor:e.surface.wash,cursor:"default"},innerContainer:{overflowY:"auto",padding:"20px 0 0 24px",height:"100%",marginTop:-20,minWidth:M().ok,zIndex:0,position:"relative"}})),[]),n=(0,a().K8)((()=>k().g.getState()),[]),i=n.isOpen&&"layout-editor"===n.mode?n.initialSelectedModuleId:void 0,r=(0,a().uB)(e.layoutBuilderModuleSelectionStore,w().A),l=n.isOpen&&"layout-editor"===n.mode;return(0,o.useEffect)((()=>{l&&r.setState(i?{type:"existing_module",moduleId:i,isDragging:!1}:void 0)}),[i,l,r]),n.isOpen&&"layout-editor"===n.mode?(0,K.jsxs)(xn,{...n,layoutBuilderModuleSelectionStore:r,children:[e.debugChildForTestsOnly,(0,K.jsxs)(p().A,{tag:v().wt,initial:{translateY:5,opacity:0},animate:{translateY:0,opacity:1},config:{duration:650,timingFunction:"ease-in-out"},style:t.container,children:[(0,K.jsx)(no,{}),(0,K.jsxs)(v().Ye,{style:t.innerContainer,children:[(0,K.jsx)(ro,{}),(0,K.jsx)(en,{})]})]})]}):null}function ro(){const{pageStore:e}=(0,X().bi)(),{setModuleSelection:t,layoutBuilderModuleSelectionStore:n,layoutStore:l,sessionId:d}=(0,X().LH)(),c=(0,r().v3)(),p=(0,a().K8)((()=>{var e;return Boolean(null===(e=n.state)||void 0===e?void 0:e.isDragging)}),[n]),m=(0,a().K8)((()=>{const t=(0,M().dV)(c);switch(t){case"xSmall":case"small":return"layout-editor-narrow";case"medium":case"large":case"xLarge":return e.isFullWidth()?"layout-editor-wide":"layout-editor";default:(0,u().HB)(t)}}),[c,e]),h=(0,a().K8)((()=>(0,A().oQ)(c).totalWidth),[c]),v=(0,a().K8)((()=>Boolean(e.getCover())),[e]),y=(0,s().IS)((e=>({container:{height:"100%",background:e.contentBackground,flexGrow:3,borderRadius:"12px 12px 0 0",boxShadow:"0px 9px 12px 0px rgba(15, 15, 15, 0.1)",borderColor:e.palette.gray[75],borderWidth:1,overflowY:"auto",display:"flex",...p?{cursor:"grabbing"}:{}},mainPage:{flex:3,paddingTop:v?void 0:28},sidebarScroller:{borderLeft:`solid 1px ${e.outlineBlueButtonPressedBackground}`,height:"100%"},mainPageContainer:{flex:1,height:"100%"},mainPageScrollContainer:{height:"100%"},sidebar:{padding:`${A().MH}px ${A().uZ}px`,marginBottom:100,flex:1,minWidth:h,maxWidth:h,width:h,transition:"width 0.1s, min-width 0.1s, max-width 0.1s"}})),[p,v,h]),[b,w]=(0,o.useState)(!0);return(0,K.jsxs)("div",{role:"presentation",style:y.container,onClick:e=>{(0,i().SQ)({event:e,context:i().y$.Click,callback:()=>{var e;t(void 0),(0,x().L3)({environment:c,layoutId:l.id,collectionId:null===(e=l.getCollectionModel())||void 0===e?void 0:e.id,sessionId:d,from:"background_click"})}})},children:[(0,K.jsx)(ln().s,{area:"page_main",style:y.mainPageContainer,children:(0,K.jsx)(f().l,{children:(0,K.jsx)(g().H,{type:S().A.Y,style:y.mainPageScrollContainer,children:(0,K.jsx)("div",{style:y.mainPage,children:(0,K.jsx)(dn().Mx,{type:m,children:(0,K.jsx)(sn().J,{area:"page_main"})})})})})}),b&&(0,K.jsx)(ln().s,{area:"page_details",children:(0,K.jsxs)(g().H,{type:S().A.Y,style:y.sidebarScroller,children:[(0,K.jsx)(ao,{isSidebarOpen:!0,setIsSidebarOpen:w}),(0,K.jsx)("div",{style:y.sidebar,children:(0,K.jsx)(sn().J,{area:"page_details"})})]})}),!b&&(0,K.jsx)(ao,{isSidebarOpen:!1,setIsSidebarOpen:w})]})}function ao(e){let{isSidebarOpen:t,setIsSidebarOpen:n}=e;const i=(0,s().IS)((()=>({container:{position:"relative",height:0,zIndex:1},button:{position:"absolute",right:t?void 0:4,left:t?4:void 0,top:4}})),[t]),r=(0,o.useCallback)((()=>{n((e=>!e))}),[n]);return(0,K.jsx)("div",{style:i.container,children:(0,K.jsx)(h().A,{renderTooltip:()=>t?(0,K.jsx)(c().sA,{...so.hideSidebar}):(0,K.jsx)(c().sA,{...so.showSidebar}),placement:b().W.Top,render:e=>(0,K.jsx)(m().A,{icon:t?d().O:l().S,...e,onClick:r,style:i.button,ariaLabel:t?y().A.formatMessage(so.hideSidebar):y().A.formatMessage(so.showSidebar)})})})}const so=(0,c().YK)({hideSidebar:{defaultMessage:"Hide sidebar",id:"pageLayout.builder.hideSidebar"},showSidebar:{defaultMessage:"Show sidebar",id:"pageLayout.builder.showSidebar"}})},978578:(e,t,n)=>{n.d(t,{MS:()=>s,aD:()=>a,bu:()=>r,uO:()=>i,uZ:()=>l});var o=()=>n(628182);function i(){return{flex:1,marginLeft:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?0:8,overflow:"hidden",marginRight:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?16:8,whiteSpace:"nowrap",height:"100%",minWidth:0,maxWidth:"100%",textOverflow:"ellipsis"}}const r=36;function a(e){return{iconStyle:{height:26,width:26,fill:e.icon.primary},iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",marginRight:14,color:e.icon.secondary,width:26},redesignedIconStyle:{height:24,width:24,fill:e.icon.primary},redesignedCircleIconContainer:{background:e.surface.page,color:e.icon.primary,display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:18,width:r,height:r},redesignedCoverPhotoIconContainer:{background:e.surface.page,color:e.icon.primary,display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:18,width:r,height:r,boxShadow:"0px 2px 4px -1px rgba(0, 0, 0, 0.06), 0px 14px 28px -6px rgba(0, 0, 0, 0.10)"}}}function s(e){const{WindowSizeStore:t}=e;return{marginTop:t.state.paddingTop,paddingLeft:t.getSafePaddingLeftPx(0),paddingRight:t.getSafePaddingRightPx(0)}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o().s1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=1/(window.devicePixelRatio||1);return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100%",height:t,boxShadow:n?`0 ${i}px 0 ${e.regularDividerColor}`:"none",background:e.contentBackground,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}},986863:(e,t,n)=>{n.d(t,{u:()=>r});var o=()=>n(645873);const i=new(o().O2)("teamPermissionsInviteWithModal",(async()=>await Promise.all([n.e(75134),n.e(9304),n.e(16471),n.e(58550),n.e(44711),n.e(53321),n.e(90825),n.e(96346),n.e(55373),n.e(37353),n.e(29151),n.e(78191),n.e(62475),n.e(3151),n.e(98629),n.e(49889),n.e(97727),n.e(22900),n.e(85128),n.e(95555),n.e(14659),n.e(92845),n.e(84468),n.e(5605),n.e(48486),n.e(95794),n.e(13677),n.e(56952),n.e(48632),n.e(74562),n.e(27711),n.e(4422),n.e(11341),n.e(46414),n.e(95168),n.e(28271),n.e(34877),n.e(36908),n.e(17254),n.e(84185),n.e(32421),n.e(15315),n.e(24587),n.e(78708),n.e(43777),n.e(74752),n.e(91194),n.e(81197),n.e(98659),n.e(20502),n.e(6266),n.e(8184),n.e(83884),n.e(65881),n.e(99809),n.e(93282),n.e(43678),n.e(15019),n.e(90978),n.e(3910),n.e(77213),n.e(6912),n.e(21194),n.e(30291),n.e(39541),n.e(12913),n.e(45620),n.e(54220),n.e(19930),n.e(81768),n.e(58102),n.e(52836),n.e(26483),n.e(19687),n.e(6463),n.e(68137),n.e(50569),n.e(40925),n.e(24975),n.e(282),n.e(87250),n.e(93847),n.e(79928),n.e(7203),n.e(61349),n.e(55197),n.e(94256),n.e(76690),n.e(29669),n.e(24930),n.e(62573),n.e(33882),n.e(44763),n.e(1440),n.e(5044),n.e(31782),n.e(93449),n.e(63996),n.e(895),n.e(66559),n.e(35986),n.e(45683),n.e(78862),n.e(38536),n.e(92924),n.e(64819),n.e(67378),n.e(40186),n.e(97339),n.e(55717),n.e(63797),n.e(56352),n.e(52811),n.e(28398),n.e(21367),n.e(65351),n.e(22686),n.e(4112),n.e(31889),n.e(36009),n.e(81973),n.e(2600),n.e(77663),n.e(97832),n.e(75681)]).then(n.bind(n,487443)))),r=(0,o()._h)(i,(e=>e.TeamPermissionsInviteWithModal))},996594:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A,getSpaceViewMenuItems:()=>M});n(944114),n(296540);var o=()=>n(484714),i=()=>n(56366),r=()=>n(959013),a=()=>n(624550),s=()=>n(34542),l=(n(898992),n(354520),()=>n(496603));var d=()=>n(722872),c=()=>n(640653),u=()=>n(719431),p=()=>n(377586),m=()=>n(765957),g=()=>n(520257),f=()=>n(760217),h=()=>n(928600),v=()=>n(939740),y=()=>n(480095),b=()=>n(187820),S=()=>n(89924),x=n(474848);const A=function(){const e=(0,o().v3)(),{device:t}=e,r=(0,i().O$)(g().A);return(0,x.jsx)(n(897119).Ay,{popupType:t.isMobile?p().n.SlideUp:p().n.Popup,open:r.open,render:()=>(0,x.jsx)(w,{}),originGap:8,onDismiss:a().Ew,originRect:r.originRect,enableRounding:!0})};function M(e,t){const{device:n}=e,{currentUserRootStore:o}=m().default.state;if(!o)return[];const{editableStores:i}=function(e){const t=l().hS(e.getSpaceViewStores(),(e=>e.getSpaceId())),n=t.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())})),o=n.filter((e=>{const t=e.getSpaceStore();return e.isReady()&&(null==t?void 0:t.isReady())&&t.canEdit()}));return{total:t.length,loaded:n.length,editable:o.length,editableStores:o}}(o),r=[];for(const a of i){const o=a.getSpaceStore();if(null!=o&&o.isReady()&&o.canEdit()){const i=(0,c().GK)(e,o),l=(0,c().c2)(e,o);r.push({key:a.id,action:async()=>{await s().Fq({environment:e,blockStore:t,spaceStore:o,spaceViewStore:a})},render:e=>(0,x.jsx)(f().A,{title:i,icon:(0,x.jsx)(b().B6,{icon:l,iconRecordCategory:"workspace",isEmptyPage:!1,title:i,size:n.isMobile?24:20,disabled:!0}),...e})})}}return r}function w(){const e=(0,o().v3)(),{device:t}=e,n=(0,i().O$)(g().A),s=(0,i().K8)((()=>m().default.state.currentUserRootStore),[]),l=(0,i().K8)((()=>n.store?M(e,n.store):[]),[e,n]);if(!n.open||!s)return null;const c=[{key:"spaces",render:e=>(0,x.jsx)(S().A,{title:t.isMobile?void 0:(0,x.jsx)(r().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.chooseWorkspace.menuItem.title"}),...e}),items:l},{key:"logout",render:e=>(0,x.jsx)(S().A,{...e,topBorder:!0}),items:[{key:"logout",action:()=>u().logout(e),render:e=>(0,x.jsx)(k,{...e})}]}];let p;return p=t.isMobile?{menuType:d().gu.Modal,title:(0,x.jsx)(r().sA,{defaultMessage:"Choose a workspace",id:"duplicatePagePopup.choooseWorkspaceMobileMenu.title"}),right:(0,x.jsx)(y().CancelMenuText,{}),onClickRight:a().Ew}:{menuType:d().gu.Popup},(0,x.jsx)(h().A,{...p,children:(0,x.jsx)(v().Ay,{type:v().Oh.Vertical,sections:c,initialFocus:1})})}function k(e){const t=(0,i().K8)((()=>{const{currentUserStore:e}=m().default.state;return(null==e?void 0:e.getEmail())||""}),[]);return(0,x.jsx)(f().A,{caption:(0,x.jsx)(r().sA,{defaultMessage:"Log out ({email})",id:"duplicatePagePopup.buttonMenuItem.logoutButton.label",values:{email:t}}),...e})}}}]);