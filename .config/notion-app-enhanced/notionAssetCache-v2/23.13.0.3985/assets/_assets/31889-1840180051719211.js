"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[31889],{31082:(e,s,i)=>{i.d(s,{Bw:()=>l,V0:()=>g});i(898992),i(354520),i(581454);var t=()=>i(534177),n=()=>i(134696),o=()=>i(2220),r=()=>i(680074),a=()=>i(159026);function l(e){const{environment:s,internalDomains:i,inviteResults:o,destination:l,metadata:g}=e;0!==o.length&&(function(e){var s;const{addedPermissions:i,environment:t,internalDomains:o,metadata:a,destination:l}=e;if(0===i.length)return;const m=i.map((e=>e.invite.inviteTarget)),d=i.map((e=>e.blockPermissionItem)),u=i.filter(c).filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId));n().Jg(t,{domainType:(0,r().FX)(),internal_domains:o??[],invite_flow_id:a.inviteFlowId,invite_message_length:(null===(s=a.inviteMessage)||void 0===s?void 0:s.length)??0,invite_origin:a.inviteOrigin,invite_targets:m,invitee_ids_with_internal_domain:u,invitee_ids_with_internal_domain_enforced:[],is_onboarding:!1,is_space:!1,permission_items:d,role:l.blockRole,share_menu_session_id:a.shareMenuSessionId})}({addedPermissions:o.filter(u),environment:s,internalDomains:i,destination:l,metadata:g}),function(e){var s;const{createdMembers:i,environment:t,internalDomains:o,metadata:a,destination:l}=e;if(0===i.length)return;const m=i.map((e=>e.invite.inviteTarget)),d=i.map((e=>e.spacePermissionItem)),c=i.filter((e=>void 0!==e.invite.internalDomain)).map((e=>e.inviteeUserId)),u=i.filter((e=>e.wasInternalDomainEnforced)).map((e=>e.inviteeUserId));if(n().Jg(t,{domainType:(0,r().FX)(),internal_domains:o??[],invite_flow_id:a.inviteFlowId,invite_message_length:(null===(s=a.inviteMessage)||void 0===s?void 0:s.length)??0,invite_origin:a.inviteOrigin,invite_targets:m,invitee_ids_with_internal_domain:c,invitee_ids_with_internal_domain_enforced:u,is_onboarding:!1,is_space:!0,permission_items:d,role:l.spaceRole,share_menu_session_id:a.shareMenuSessionId}),u.length>0){const e=o?o.map((e=>e.url)):[];n().hp(t,{invite_flow_id:a.inviteFlowId,invite_origin:a.inviteOrigin,user_ids:u,internal_domains:e})}}({createdMembers:o.filter(p),environment:s,internalDomains:i,destination:l,metadata:g}),function(e){const{createdGuestRequests:s,environment:i,destination:o,metadata:r}=e;if(0===s.length)return;const a=s.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var s;return null===(s=e.invite.invitee)||void 0===s?void 0:s.email})).filter(t().O9);n().xF(i,{internal_guest_enforcement:!1,invite_flow_id:r.inviteFlowId,is_bot:!1,is_internal_domain:a.length>0,invitee_emails_with_internal_domain:a,invitee_emails_with_internal_domain_enforced:[],role:o.blockRole,space_role:o.spaceRole,user_count:s.length})}({createdGuestRequests:o.filter(m),environment:s,destination:l,metadata:g}),function(e){const{createdMemberRequests:s,environment:i,destination:o,metadata:r}=e;if(0===s.length)return;const l=s.filter((e=>void 0!==e.invite.internalDomain)).map((e=>{var s;return null===(s=e.invite.invitee)||void 0===s?void 0:s.email})).filter(t().O9),m=s.filter((e=>e.wasInternalDomainEnforced)).map((e=>{var s;return null===(s=e.invite.invitee)||void 0===s?void 0:s.email})).filter(t().O9);n().RH(i,{from:"share_menu",invite_flow_id:r.inviteFlowId,invite_space_role_selection:a().NJ.workspace_member,is_bot:!1,is_internal_domain:l.length>0,internal_guest_enforcement:m.length>0,invitee_emails_with_internal_domain:l,invitee_emails_with_internal_domain_enforced:m,role:o.blockRole,space_role:o.spaceRole,user_count:s.length})}({createdMemberRequests:o.filter(d),environment:s,destination:l,metadata:g}))}function m(e){return"createdGuestRequest"===e.type}function d(e){return"createdMemberRequest"===e.type}function c(e){return"addedUserPermission"===e.type}function u(e){return!(!c(e)&&!function(e){return"addedGroupPermission"===e.type}(e))}function p(e){return"createdMember"===e.type}function g(e){let{environment:s,spaceId:i,pageId:t,pageVisibility:n,hasTrustedDomainPermission:r,hasPublicShareLinkPermission:a,shareMenuSessionId:l}=e;(0,o().u)({environment:s,event:{eventName:"general_access_menu_open",eventProperties:{spaceId:i,pageId:t,pageVisibility:n,hasTrustedDomainPermission:r,hasPublicShareLinkPermission:a,shareMenuSessionId:l}}})}},98866:(e,s,i)=>{i.d(s,{x:()=>r});i(898992),i(803949);var t=()=>i(56366),n=()=>i(134217),o=()=>i(749240);function r(){return(0,t().K8)((()=>{const e=o().subscriptionDataStoreInstance.state,s=e?n().Be(e):[],i=new Map;return s.forEach((e=>{i.set(e.userId,e)})),i}),[])}},146842:(e,s,i)=>{i.r(s),i.d(s,{PUBLIC_SHARE_LINK_TOOLTIP_ID:()=>g,PublicShareLinkTutorialTooltip:()=>h});i(296540);var t=()=>i(484714),n=()=>i(56366),o=()=>i(12193),r=()=>i(959013),a=()=>i(594607),l=()=>i(953006),m=()=>i(21140),d=()=>i(299487),c=()=>i(131448),u=()=>i(962730),p=i(474848);const g="public_share_link_tooltip";function h(e){const{originRef:s,onPrimaryButtonClick:i}=e,h=(0,t().v3)(),b=(0,n().K8)((()=>c().default.isVisible(g)),[]);return(0,p.jsx)(a().B,{shouldShow:b,calloutId:g,children:(0,p.jsx)(l().k,{style:{width:260},pointerLength:25,pointerPosition:"50%",origin:s,placementToOrigin:"bottom",alignmentToOrigin:u().C.Start,numSteps:1,header:(0,p.jsxs)(m().wt,{gap:10,children:[(0,o().globeIcon)({height:20,width:20}),(0,p.jsx)(r().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.header",defaultMessage:"Share your page with anyone"})]}),content:(0,p.jsx)(r().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.content",defaultMessage:"You can now change your page settings to collaborate with anyone on the web with the link"}),finalButtonContent:(0,p.jsx)(r().sA,{id:"generalAccessPermissions.publicShareLink.tutorialTooltip.finalButtonContent",defaultMessage:"Try it out"}),onPrimaryButtonClick:()=>{(0,d().a)(h,g),i()},shouldDismissUponOutsideClick:!0,onCloseClick:()=>{(0,d().a)(h,g)}})})}},180925:(e,s,i)=>{i.d(s,{A:()=>r});var t=i(296540),n=i(474848);function o(e){let{onClick:s,hovered:o,expanded:r,children:a}=e;const l=(0,i(484714).Y0)().isMobile,[m,d]=t.useState(!1),c=(0,t.useCallback)((()=>d(!0)),[]),u=(0,t.useCallback)((()=>d(!1)),[]),p=(0,i(401497).IS)((e=>{const s=(0,i(623275).iM)({theme:e,size:26,useLargeBorderRadius:!0,useLightBackgroundColor:!0}),t={position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",top:"auto",left:"auto",opacity:o?1:0,transition:"opacity 150ms ease, background 150ms ease",...s,width:24,height:24,borderRadius:4};return{container:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},chevronButton:{...t,background:"unset"},chevronContainerHovered:{...t,background:s.background},childrenContainer:{opacity:o?0:1,transition:"opacity 200ms"},chevronIconInnerContainer:{background:"unset",height:24,width:24,borderRadius:4},chevronIcon:{transform:`rotate(${r?90:0}deg)`,transition:"transform 150ms ease",width:16,height:16}}}),[r,o]);return l?(0,n.jsx)(n.Fragment,{children:a}):(0,n.jsxs)("div",{style:p.container,onMouseEnter:c,onMouseLeave:u,children:[(0,n.jsx)(i(704152).A,{disabled:!1,style:m?p.chevronContainerHovered:p.chevronButton,onClick:s,children:(0,n.jsx)(i(99756).A,{type:"square",iconType:"function",iconFn:i(742117).V,containerStyle:p.chevronIconInnerContainer,iconStyle:p.chevronIcon,isMobile:l})}),(0,n.jsx)("div",{style:p.childrenContainer,children:a})]})}const r=t.memo(o)},328403:(e,s,i)=>{i.d(s,{A:()=>C});i(296540);var t=()=>i(484714),n=()=>i(56366),o=()=>i(401497),r=()=>i(792071),a=()=>i(798880),l=()=>i(695608),m=()=>i(959013),d=()=>i(919172),c=()=>i(678553),u=()=>i(125565),p=()=>i(453697),g=()=>i(747788),h=()=>i(762433),b=()=>i(979340),f=()=>i(963589),v=()=>i(765957),y=()=>i(324561);var x=()=>i(87043),I=()=>i(810727),P=i(474848);function S(e){const{userValue:s,guestLabel:i}=e;return(0,P.jsx)(c().Ay,{title:(0,P.jsx)(A,{userValue:s,guestLabel:i}),caption:(0,P.jsx)(_,{userValue:s}),icon:(0,P.jsx)(j,{userValue:s}),desktopIconStyle:{marginLeft:16}})}function j(e){const{userValue:s,isInvited:i}=e,n=(0,t().Y0)().isMobile,r=(0,o().IS)((e=>({iconPlaceholder:{height:n?x().Bj:x().Ev,width:n?x().Bj:x().Ev,borderRadius:20},invitedIcon:{borderRadius:20,outlineColor:e.palette.gray[300]}})),[n]);return s?(0,P.jsx)(p().A,{borderStyle:i?"dashed":void 0,iconStyle:i?r.invitedIcon:void 0,userValue:s,size:n?x().Bj:x().Ev}):(0,P.jsx)(M,{style:r.iconPlaceholder})}function A(e){const{userValue:s,guestLabel:i}=e,t=(0,m().tz)(),r=(0,n().K8)((()=>{const{currentUserStore:e}=v().default.state;return!!e&&(!!s&&e.id===s.id)}),[s]),a=(0,o().IS)((e=>({titlePlaceholder:{height:8,width:81,borderRadius:4},titleYouIndicator:{color:"dark"===e.mode?e.text.secondary:e.text.tertiary}})),[]);if(!s)return(0,P.jsx)(M,{style:a.titlePlaceholder});const c=(0,l().c6)(t,s);return(0,P.jsx)(P.Fragment,{children:c?(0,P.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,P.jsx)(u().A,{className:"notranslate",children:r?(0,P.jsx)(m().sA,{id:"cellMemberAvatar.displayName.title",defaultMessage:"{userFullDisplayName} <youIndicatorText>(You)</youIndicatorText>",values:{userFullDisplayName:c,youIndicatorText:e=>(0,P.jsx)("span",{style:a.titleYouIndicator,children:e})}}):c}),i?(0,P.jsx)(d().Q,{labelType:i,shouldUseTabStyle:!0}):void 0]}):(0,P.jsx)(m().sA,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"})})}function _(e){const{userValue:s,permissionRole:i}=e,{isMobile:n}=(0,t().Y0)(),r=(0,o().IS)((()=>({subtitlePlaceholder:{height:8,width:139,borderRadius:4,marginTop:10}})),[]);if(n&&i){const e=(0,g().R)({type:"user_permission",role:i,table:"block",isRemovable:!1,isCurrentUser:!1}).label;return(0,P.jsx)(u().A,{isSmall:!0,children:(0,P.jsx)(m().sA,{...e})})}return null!=s&&s.email?(0,P.jsx)(u().A,{isSmall:!0,children:s.email}):(0,P.jsx)(M,{style:r.subtitlePlaceholder})}function M(e){const s=(0,o().IS)((s=>({placeholder:{...e.style,background:s.lightDividerColor}})),[e.style]);return(0,P.jsx)("div",{style:s.placeholder})}function k(e){const{userValue:s,permissionItem:i,store:t}=e,n=(0,m().tz)(),o=r().Bj6.fromValue(a().oo,s),l=null==o?void 0:o.getDisplayName(n),d=!(null!=s&&s.onboarding_completed||null!=s&&s.mobile_onboarding_completed),c=(0,I().z)({permissionItem:i,targetType:"user",targetName:l,store:t});return d?(0,P.jsx)(m().sA,{defaultMessage:"User has not yet created an account",id:"blockPermissionsSettings.notOnboarded.message"}):c||null}const C=function(e){const{store:s,userPermission:o,spaceVisibleUserMap:r,fromPermissionWrapper:l}=e,m=(0,t().v3)().device.isMobile,d=(0,n().K8)((()=>i(630116).LU.createChildStore(s,{table:a().oo,id:o.permissionItem.user_id}).getValue()),[s,o.permissionItem.user_id]),c=function(){const e=(0,n().O$)(v().AppStoreCurrentSpaceStore),s=(0,y().f_)({spaceId:null==e?void 0:e.id}),i=(0,n().K8)((()=>{if(!e)return!1;const i=(0,h().AI)(s);return(0,b().dL)(i)||(0,b().Pg)(i)}),[e,s]),t=(0,f().X)("personal_sharing_distinguish_guest_type");return i&&t}(),u=(0,n().K8)((()=>{const e=(null==d?void 0:d.onboarding_completed)||(null==d?void 0:d.mobile_onboarding_completed);return null==d||!d.id||!e&&c?null!=d&&d.id&&!e&&c?"invited":void 0:(0,i(619338).p)({spaceVisibleUserMap:r,userId:d.id,store:s})}),[s,r,d,c]),p="invited"===u;return(0,P.jsx)("div",{children:(0,P.jsx)(x().Ay,{store:s,permissionItem:o.permissionItem,from:o.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,P.jsx)(j,{userValue:d,isInvited:p}),title:(0,P.jsx)(A,{userValue:d,guestLabel:u}),subtitle:p?void 0:(0,P.jsx)(_,{userValue:d,permissionRole:o.permissionItem.role}),selectHeader:m?(0,P.jsx)(S,{userValue:d,guestLabel:u}):void 0,selectFooter:e.selectFooter,showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:l,roleItemOverrides:e.roleItemOverrides,nonInheritedTooltip:e.tooltip?e.tooltip:(0,P.jsx)(k,{userValue:d,permissionItem:o.permissionItem,store:s}),menuListItemProps:e.menuListItemProps,style:e.style,...e.permissionItemArgs})},o.permissionItem.user_id)}},439616:(e,s,i)=>{i.d(s,{A:()=>R});i(944114),i(581454);var t=i(296540),n=()=>i(662303),o=()=>i(484714),r=()=>i(56366),a=()=>i(401497),l=()=>i(869190),m=()=>i(68263),d=()=>i(959013),c=()=>i(720665),u=()=>i(760217),p=()=>i(406699),g=()=>i(928600),h=()=>i(939740),b=()=>i(8980),f=()=>i(89924),v=()=>i(125565),y=()=>i(573351),x=()=>i(662971),I=()=>i(186445),P=()=>i(722872),S=()=>i(700250),j=()=>i(991249),A=()=>i(118849),_=()=>i(807778),M=()=>i(134217),k=()=>i(404520),C=i(474848);function w(e,s){const{permissionItem:t,hideIcon:n,onChange:r,buttonStyle:a}=e,l=(0,o().Y0)();return(0,C.jsx)(i(811979).A,{...e,popupType:l.isMobile?p().z7.SlideUp:p().z7.Popup,renderOrigin:o=>(0,C.jsx)(i(585293).a,{...(0,i(553965).A)(e,o),ref:s,title:(0,C.jsx)(d().sA,{defaultMessage:"Link expires",id:"publishSiteSettings.linkExpiration.settingTitle"}),icon:!n&&(0,C.jsx)(b().I,{icon:i(274570).clockIcon,color:"secondary"}),right:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(T,{permissionItem:t}),(0,C.jsx)(b().I,{icon:i(324254).arrowChevronSingleDownSmallIcon,size:"sm",color:"tertiary"})]}),buttonStyle:a}),alignmentToOrigin:S().MY.End,placementToOrigin:S().UV.Bottom,render:e=>(0,C.jsx)(N,{value:t.expiration_timestamp,onChange:r,onClose:()=>{e.close()}})})}function T(e){const{permissionItem:s}=e,i=(0,d().tz)(),t=(0,a().IS)((e=>({container:{color:e.text.secondary}})),[]);if(!s.expiration_timestamp||(0,m().OA)(s))return(0,C.jsx)(v().A,{style:t.container,children:(0,C.jsx)(d().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})});const o=l().jE(s.expiration_timestamp,n().locale,i);return(0,C.jsx)(v().A,{style:t.container,children:o})}function N(e){const{value:s,onChange:i,onClose:l}=e,m=(0,o().v3)(),p=m.device,b=(0,r().K8)((()=>(0,_().P4)()),[]),v=(0,r().K8)((()=>!M().qC()),[]),y=(0,r().K8)((()=>M().Si(m)),[m]),x=(0,t.useCallback)((e=>{void 0!==e&&e<=(new Date).getTime()||(i(e),l())}),[i,l]),I=(0,a().IS)((e=>({disabledContainer:{display:"flex",gap:6},disabledText:{color:e.text.tertiary}})),[]),S=function(){const e=Date.now(),s=e+c().pT,i=e+c().nD,t=e+7*c().nD;return[{key:"none",time:void 0,title:(0,C.jsx)(d().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})},{key:"hour",time:s,title:(0,C.jsx)(d().sA,{defaultMessage:"In an hour",id:"publishSiteSettings.linkExpiration.oneHour"}),caption:new Intl.DateTimeFormat(n().locale,{hour:"numeric",minute:"numeric"}).format(s)},{key:"day",time:i,title:(0,C.jsx)(d().sA,{defaultMessage:"In a day",id:"publishSiteSettings.linkExpiration.oneDay"}),caption:new Intl.DateTimeFormat(n().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(i)},{key:"week",time:t,title:(0,C.jsx)(d().sA,{defaultMessage:"In a week",id:"publishSiteSettings.linkExpiration.oneWeek"}),caption:new Intl.DateTimeFormat(n().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)}]}().map((e=>({key:e.key,action:()=>{x(e.time)},render:s=>(0,C.jsx)(u().A,{...s,title:e.title,titleStyle:v?I.disabledText:{},caption:e.caption,captionStyle:v?I.disabledText:{},disabled:v})}))),w=[{key:"predefined-expiration",render:e=>(0,C.jsx)(f().A,{...e}),items:S},{key:"custom-expiration",render:e=>(0,C.jsx)(f().A,{...e,topBorder:!0}),items:[B(x,s,v,I.disabledText)]}];return y&&v&&!b&&w.push({key:"upgrade-for-expiration",render:e=>(0,C.jsx)(f().A,{...e,topBorder:!0}),items:[{key:"upsell",action:()=>{j().K(m,{from:"public_permission_item_expiration",upsell:{type:"product",product:y,limit:{type:"none"},trialability:"none"}})},render:e=>(0,C.jsx)(u().A,{...e,focused:e.focused,title:(0,C.jsxs)("div",{style:I.disabledContainer,children:[(0,C.jsx)(d().sA,{defaultMessage:"Unlock link expiration",id:"publishSiteSettings.linkExpiration.upgrade"}),(0,C.jsx)(A().A,{subscriptionTier:y,analyticsName:"public_permission_item_expiration"})]})})}]}),(0,C.jsxs)(g().A,{menuType:p.isMobile?P().gu.ActionSheet:P().gu.Popup,width:271,children:[b&&v&&y&&(0,C.jsx)("div",{style:{padding:"10px 10px 4px 10px"},children:(0,C.jsx)(k().R,{source:"public_permission_item_expiration",display:"button",upsell:{type:"product",product:y,limit:{type:"none"},trialability:"none"}})}),(0,C.jsx)(h().Ay,{type:h().Oh.Vertical,initialFocus:void 0,sections:w})]})}function B(e,s,i){let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{key:"custom",action:()=>{window.parent.close()},render:(n,o)=>(0,C.jsx)(x().A,{...n,renderOrigin:e=>(0,C.jsx)(u().A,{...e,disabled:i,title:(0,C.jsx)(d().sA,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"}),titleStyle:i?t:{}}),onFocus:o.onFocus,disableDefaultClick:!0,renderExtension:(t,n)=>(0,C.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,C.jsx)(y().A,{...t,firstDayOfWeek:I().XX.state,value:s||Date.now(),onChange:s=>{e(s),n.close()},disabledDays:i||{before:new Date}})})})}}const R=t.forwardRef(w)},453597:(e,s,i)=>{i.d(s,{jV:()=>u,E3:()=>c,nc:()=>d});i(296540);var t=()=>i(484714),n=()=>i(56366),o=()=>i(401497),r=()=>i(959013),a=()=>i(284371),l=()=>i(125565),m=i(474848);function d(){return(0,m.jsx)(u,{children:(0,m.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.generalAccessAttribution",defaultMessage:"General access"})})}function c(){return(0,m.jsx)(u,{children:(0,m.jsx)(r().sA,{id:"blockPermissionsSettings.permissionsList.collectionPropertyPermissionsAttribution",defaultMessage:"Page-level access"})})}function u(e){const{children:s}=e,{WindowSizeStore:i}=(0,t().v3)(),{isMobile:r}=(0,t().Y0)(),{paddingLeft:d,paddingRight:c}=(0,n().K8)((()=>{const e=r?0:8;return{paddingLeft:i.getSafePaddingLeftCSS(e),paddingRight:i.getSafePaddingRightCSS(e)}}),[i,r]),u=(0,o().IS)((e=>({label:{color:e.text.secondary,fontWeight:a().Wy.medium,paddingLeft:d,paddingRight:c,paddingTop:0,paddingBottom:4,overflow:"visible",textWrap:"wrap",...r?{fontSize:15,paddingTop:0,color:e.text.secondary}:{}}})),[r,d,c]);return(0,m.jsx)(l().A,{isSmall:!0,style:u.label,children:s})}},545340:(e,s,i)=>{i.d(s,{A:()=>n});class t extends(()=>i(757695))().Store{getInitialState(){return{trustedDomainPointers:[],enabledTrustedEmailDomains:[],trustedDomains:[],lastEmitData:{value:-1,spaceId:void 0}}}getForSpace(e){if(!e)return;const{enabledTrustedEmailDomains:s,trustedDomainPointers:i,trustedDomains:t,lastEmitData:n}=this.state;return n.spaceId===e.id?{enabledTrustedEmailDomains:s,trustedDomainPointers:i,trustedDomains:t}:void 0}shouldRefetchTrustedDomains(e){let{currentSpaceId:s,emitValue:i}=e;const{spaceId:t,value:n}=this.state.lastEmitData;return s!==t||i!==n}}const n=t},585293:(e,s,i)=>{i.d(s,{a:()=>o});var t=i(296540),n=i(474848);const o=t.forwardRef(((e,s)=>{const t=(0,i(401497).IS)((s=>({buttonStyle:{paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2,width:"100%",marginLeft:0,background:"transparent",...e.buttonStyle},menuItemStyle:{gap:6,background:"transparent",...e.style},innerContainer:{marginLeft:0,paddingLeft:0,minWidth:"auto",color:e.disabled?s.text.secondary:void 0,background:"transparent"},desktopIconStyle:{margin:0},rightStyle:{display:"flex",alignItems:"center",gap:6,color:s.text.secondary,margin:0,...e.rightStyle}})),[e.disabled,e.rightStyle,e.buttonStyle,e.style]);return(0,n.jsx)(i(760217).A,{role:"button",...e,ref:s,style:t.menuItemStyle,buttonStyle:t.buttonStyle,textWrapperStyle:t.innerContainer,desktopIconStyle:t.desktopIconStyle,rightStyle:t.rightStyle})}));o.displayName="SiteSettingButtonMenuItem"},598697:(e,s,i)=>{i.r(s),i.d(s,{GeneralAccessPermissionSection:()=>Ai,InheritedPermissionsListV2:()=>ji,MOBILE_SHARE_MENU_HORIZONTAL_PADDING:()=>Ii,default:()=>Ci});i(517642),i(658004),i(733853),i(845876),i(432475),i(515024),i(731698),i(898992),i(823215),i(354520),i(672577),i(803949),i(581454);var t=i(296540),n=()=>i(484714),o=()=>i(56366),r=()=>i(401497),a=()=>i(187174),l=()=>i(386164),m=()=>i(68263),d=()=>i(798880),c=()=>i(695608),u=()=>i(959013),p=()=>i(496603),g=()=>i(701763),h=()=>i(449506),b=()=>i(89924),f=()=>i(780054),v=()=>i(731320),y=()=>i(698449),x=()=>i(141333),I=()=>i(963589),P=()=>i(646736),S=()=>i(756279),j=()=>i(765957),A=()=>i(605402),_=()=>i(630116),M=()=>i(928074),k=()=>i(623275),C=()=>i(98866),w=()=>i(437487),T=()=>i(913348),N=()=>i(328403),B=()=>i(30626),R=()=>i(704152),L=()=>i(125565),D=i(474848);function O(e){let{permissions:s}=e;const i=(0,n().v3)().device.isMobile,[o,a]=(0,t.useState)(!1),l=(0,r().IS)((e=>({button:{display:o?"none":"inline-flex",padding:8,alignItems:"center",...(0,k().CY)(),width:"calc(100% - 16px)",height:48},icon:{width:14,transform:"rotate(90deg)",fill:e.icon.tertiary},list:{display:o?"block":"none"},dotsIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:32,marginRight:(0,k().qj)({isMobile:i})}})),[i,o]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(R().A,{onClick:()=>a(!0),style:l.button,children:[(0,D.jsx)("div",{style:l.dotsIconContainer,children:(0,B()._)(l.icon)}),(0,D.jsx)(L().A,{isSmall:!1,isSecondaryColor:!0,children:(0,D.jsx)(u().sA,{id:"blockPermissionsSettings.permissionsList.expandButtonV2",defaultMessage:"See {count} more",values:{count:s.length}})})]}),(0,D.jsx)("div",{style:l.list,children:s})]})}var U=()=>i(464192),W=()=>i(12193),K=()=>i(340498),E=()=>i(747788),G=()=>i(38337);function V(e,s){const i=e.getPublicPermission()??{type:"public_permission",role:"none"},t=(0,p().o8)(i);t.role=s;const{is_site:n}=t;return"none"===s?n?{...t,role:"reader",is_public_share_link:!1}:{...t,is_public_share_link:!1}:{...t,is_public_share_link:!0}}var F=()=>i(439616),z=()=>i(463830),H=()=>i(976721),q=()=>i(742117),Y=()=>i(493823),$=()=>i(406699),X=()=>i(897119),Q=()=>i(962730),J=()=>i(534177),Z=()=>i(284371),ee=()=>i(760217),se=()=>i(928600),ie=()=>i(939740),te=()=>i(722872);var ne=()=>i(726360);function oe(e){const{permission:s,includeHybrid:i}=e;return"none"===s.role?"private":i?"open_unlisted_hybrid":s.unlisted_timestamp?"unlisted":"open"}var re=()=>i(367049);var ae=()=>i(859428),le=()=>i(805025),me=()=>i(629027),de=()=>i(217429);function ce(e){const{store:s,publicPermission:i,permissionItemArgs:o,menuListItemProps:a,onClose:l}=e,{permissionItem:d,from:c}=i,{sudoModeStore:p,location:g}=o,h=(0,n().v3)(),{isPhone:b}=(0,n().Y0)(),v=f().A.isMobile,y=(0,U().v)(i.permissionItem),x=(0,me().P)({store:s}),I=x.disabled,P=(0,t.useCallback)((async()=>{const e=(0,m().Yi)(c),i=de().default.getEligibleGroup({experimentId:"public_share_link_default_role",defaultGroup:"control"}),t=V(s,"read_and_write"===i?"read_and_write":"comment_only"===i?"comment_only":"reader");await(0,H().Hc)({oldPermissionItem:d,newPermissionItem:t,wasInherited:e!==s.id,environment:h,store:s,sudoModeStore:p,location:g}),l()}),[h,s,d,c,p,g,l]),S=(0,r().IS)((e=>({menuItemIcon:{height:20,width:20,fill:e.icon.secondary,...I&&{fill:e.icon.tertiary}},menuItemDesktopIconStyle:{...v?{marginTop:5,marginBottom:4,marginLeft:13,marginRight:6}:{marginLeft:0},alignSelf:"center"},menuItemContainer:{minHeight:28,marginBottom:2,lineHeight:"unset",...b&&{paddingTop:le().T3,paddingBottom:le().T3},color:e.text.primary,...I&&{color:e.text.tertiary}}})),[v,b,I]);let j;return I&&"space"===x.disabledBy&&(j=(0,D.jsx)(u().sA,{defaultMessage:"Workspace admin has disabled this sharing permission",id:"publicShareLinkItem.menuItemTooltip.publicSharingDisabledWorkspace"})),I&&"team"===x.disabledBy&&(j=(0,D.jsx)(u().sA,{defaultMessage:"Teamspace admin has disabled this sharing permission",id:"publicShareLinkItem.menuItemTooltip.publicSharingDisabledTeamspace"})),(0,D.jsx)(ae().A,{renderTooltip:e=>j,placement:Q().W.Bottom,disableTooltip:!I,render:e=>(0,D.jsx)(ee().A,{...a,...e,title:(0,D.jsx)(u().sA,{defaultMessage:"Anyone on the web with link",id:"publicShareLinkItem.menuItem.title"}),shouldWrapTitle:!0,shouldWrapCaption:!0,style:S.menuItemContainer,icon:(0,W().globeIcon)(S.menuItemIcon),desktopIconStyle:S.menuItemDesktopIconStyle,isChecked:y,disabled:I,onClick:P})})}var ue=()=>i(471095),pe=()=>i(898808);const ge=K().Ev.default,he=[{key:"private",title:e=>{let{type:s}=e;return"full"===s?(0,D.jsx)(u().sA,{id:"linkSharingPill.visibilityTitle.inviteOnlyFullLength",defaultMessage:"Only people invited"}):(0,D.jsx)(u().sA,{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"})},caption:()=>(0,D.jsx)(u().sA,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:e=>{let{style:s}=e;return(0,ue().i)({...s,marginTop:1})}},{key:"unlisted",title:e=>{let{spaceName:s}=e;return(0,D.jsx)(u().sA,{id:"linkSharingPill.visibilityTitle.anyoneWithLinkRedesign",defaultMessage:"Anyone at {spaceName} with the link",values:{spaceName:s}})},caption:()=>(0,D.jsx)(u().sA,{id:"linkSharingPill.visibilityCaption.anyoneWithLinkRedesign",defaultMessage:"Workspace members can access with the link"}),icon:e=>{let{style:s}=e;return(0,i(742852).w)({...s,marginTop:1})}},{key:"open",title:e=>{let{spaceName:s}=e;return(0,D.jsx)(u().sA,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:s}})},caption:()=>(0,D.jsx)(u().sA,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspaceV2",defaultMessage:"Workspace members can access and discover in search"}),icon:e=>{let{spaceStore:s,teamspaceIconSize:i}=e;return(0,D.jsx)(pe().x,{disabled:!0,store:s,size:i,style:{marginLeft:(ge-i)/2,marginRight:(ge-i)/2}})}},{key:"open_unlisted_hybrid",title:e=>{let{spaceName:s,visibility:i}=e;return"unlisted"===i?(0,D.jsx)(u().sA,{id:"blockPermissionsSettings.permissionItem.workspaceAccessNew.unlisted",defaultMessage:"Everyone at {spaceName} with the link",values:{spaceName:s}}):(0,D.jsx)(u().sA,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:s}})},caption:()=>{},icon:e=>{let{spaceStore:s,teamspaceIconSize:i}=e;return(0,D.jsx)(pe().x,{disabled:!0,store:s,size:i,style:{marginLeft:(ge-i)/2,marginRight:(ge-i)/2}})}}];const be={key:"publicShareLink",title:()=>{},caption:()=>{},icon:()=>{}};function fe(e){const{store:s,spacePermission:a,sudoModeStore:l,location:d,isRestricted:c,trustedDomainPermission:p,publicPermission:g,showPublicShareLinkPermission:h,parentCloseCallback:f,handleSpacePermissionChange:v,permissionItemArgs:y,onlyShowPrivateSpaceVisibility:x}=e,P=(0,n().v3)(),{isMobile:S,isTablet:A}=(0,n().Y0)(),_=(0,o().O$)(j().AppStoreCurrentSpaceStore),k=oe({permission:a.permissionItem,includeHybrid:!0}),C=oe({permission:a.permissionItem,includeHybrid:!1}),T=a.from,N=(0,m().Yi)(T),B=!(T.table===s.table&&N===s.id),R=(0,o().K8)((()=>{const{currentSpaceStore:e}=j().default.state;return!!e&&s.isTopLevelWorkspacePage(e.id)}),[s]),O=(0,i(653953).X)(),W=(0,o().K8)((()=>{const e=M().QJ({store:s});return e?oe({permission:e,includeHybrid:!1}):"private"}),[s]),K=(0,m().Tt)((null==p?void 0:p.permissionItem.role)??"none"),E=(0,ne().H)(),G=(0,o().K8)((()=>(0,M().pQ)({trustedDomainsStore:E})),[E]),F=function(e){const{onlyShowPrivateSpaceVisibility:s,hideOpenAndUnlistedOption:i}=e;return he.filter((e=>{let{key:t}=e;return s||i?"private"===t:"private"===t||"open_unlisted_hybrid"===t}))}({onlyShowPrivateSpaceVisibility:x,hideOpenAndUnlistedOption:function(){const e=(0,I().X)("personal_sharing_hide_workspace_permission"),s=(0,I().X)("sharing_anyone_with_the_link");return(0,re().X)()&&e&&s}()});(0,t.useEffect)((()=>{null!=_&&_.id&&i(31082).V0({environment:P,spaceId:_.id,pageId:s.id,pageVisibility:C,hasTrustedDomainPermission:K,hasPublicShareLinkPermission:!(null==g||!g.permissionItem)&&(0,U().v)(g.permissionItem),shareMenuSessionId:w().Ay.state.sessionId})}),[null==_?void 0:_.id,s.id,C,K,P,g]);const z=h?[...F,be]:F,q=(0,r().IS)((e=>({icon:{fill:S?e.icon.primary:e.text.primary,width:ge},iconContainer:{...S?{marginLeft:13,marginTop:5,marginBottom:4}:{marginLeft:0},marginRight:0,alignSelf:"center"},selectedTitle:{},titleStyle:S?{marginLeft:4}:{},mobileScroller:{background:e.surface.wash},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${e.regularDividerColor}`},sectionMenuItem:{...S?{}:{paddingTop:4,paddingBottom:4},...S?{overflow:"hidden",background:e.buttonBackground,borderRadius:12,marginLeft:16,marginRight:16,marginBottom:16,borderWidth:1,borderStyle:"solid",borderColor:e.stroke.secondary,padding:void 0}:{}},menuList:{...S?{width:"100%",margin:"0 auto"}:{}},header:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",background:e.surface.wash,paddingTop:12,paddingBottom:20},headerLabel:{fontSize:16,fontWeight:Z().Wy.semibold}})),[S]);if(!_)return null;const Y=!!g&&(0,U().v)(g.permissionItem);return(0,D.jsx)(se().A,{menuType:te().gu.Popup,disableScroller:!0,scrollerStyle:S?q.mobileScroller:{},height:S?A?"100%":"50vh":void 0,minWidth:S?"100%":void 0,maxWidth:S?"100%":void 0,maxHeight:S?"100%":void 0,header:S?(0,D.jsx)("div",{style:q.header,children:(0,D.jsx)(L().A,{style:q.headerLabel,children:(0,D.jsx)(u().sA,{defaultMessage:"General access",id:"PermissionRoleSelect.Header.GeneralAccess"})})}):void 0,children:(0,D.jsx)(ie().Ay,{type:ie().Oh.Vertical,initialFocus:void 0,style:S?q.menuList:void 0,sections:[{key:"visibilityOptions",render:e=>(0,D.jsx)(b().A,{...e,disableDesktopPadding:S,style:q.sectionMenuItem}),items:z.map(((e,i)=>{const t=e.key;if("publicShareLink"===t)return g?{key:"public_share_link",action:()=>{},render:e=>(0,D.jsx)(ce,{store:s,publicPermission:g,permissionItemArgs:y,menuListItemProps:e,onClose:f})}:void 0;const n=function(e){const{oldVisibility:s,newVisibility:i,hasPublicShareLinkPublicPermission:t}=e;if(t)return!1;if(s===i)return!0;if("unlisted"===s&&"open"===i||"open"===s&&"unlisted"===i)return!0;return!1}({oldVisibility:k,newVisibility:t,hasPublicShareLinkPublicPermission:Y}),o=i!==he.length-1,r={minHeight:28,...S?q.mobileButton:{},...S&&o?q.mobileButtonDivider:{},...o&&!S&&{marginBottom:2}};return{key:t,render:s=>(0,D.jsx)(ee().A,{title:(0,D.jsx)(L().A,{isMultiline:!0,children:e.title({spaceName:O,type:"full",visibility:C})}),icon:e.icon({style:q.icon,spaceStore:_,teamspaceIconSize:20}),desktopIconStyle:q.iconContainer,titleStyle:{...q.titleStyle,...n&&!S?q.selectedTitle:{}},isChecked:n,buttonStyle:{borderRadius:6},style:r,shouldWrapTitle:!0,...s}),action:async()=>{if(n)return;const e=a.permissionItem,i={type:"space_permission",role:ve(e,C,t)};"unlisted"===t&&(i.unlisted_timestamp=Date.now());const o=function(e,s){if(e===s)return!1;switch(s){case"open":case"open_unlisted_hybrid":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,J().HB)(s)}}(W,t)&&!c&&!R,r=await(0,H().Hc)({oldPermissionItem:e,newPermissionItem:i,wasInherited:B,environment:P,store:s,sudoModeStore:l,location:d,restrictingVisibility:o,trustedDomainsLoggingData:{trustedDomainsPointers:null==E?void 0:E.state.trustedDomainPointers,hasTrustedDomainPermission:K,isTrustedDomainItemEnabled:G}});r&&v&&v({before:e,after:i}),r&&"private"===t&&g&&Y&&function(e){const{environment:s,store:i,publicPermission:t,wasInherited:n,location:o,sudoModeStore:r}=e,a=t.permissionItem,l=V(i,"none");(0,H().Hc)({environment:s,store:i,oldPermissionItem:a,newPermissionItem:l,wasInherited:n,location:o,sudoModeStore:r})}({environment:P,store:s,publicPermission:g,wasInherited:B,location:d,sudoModeStore:l}),f()}}})).filter(J().O9)}]})})}function ve(e,s,i){return"private"===i?"none":"private"===s?"editor":e.role}const ye=t.memo((function(e){let{store:s,spacePermission:a,trustedDomainPermission:l,publicPermission:m,showPublicShareLinkPermission:d,isRestricted:c,permissionItemArgs:u,hideHoverStyles:p,buttonPopupStore:g,isDisplayOnly:h,handleSpacePermissionChange:b,title:f,onlyShowPrivateSpaceVisibility:v}=e;const y=(0,n().v3)().device.isMobile,x=(0,i(891078).i0)(s),I=(0,o().K8)((()=>s.canAdmin()),[s]),P=!I||h||x,S=(0,t.useCallback)((()=>g.setState({...g.state,open:!0})),[g]),j=(0,r().IS)((e=>({origin:{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:6,marginLeft:-6,height:void 0,paddingTop:4,paddingBottom:4,maxWidth:250},icon:{width:10,marginLeft:4,fill:e.icon.secondary,display:"inline"},privacyMenu:{...!y&&{width:330,borderRadius:10},...y&&{maxWidth:"100%"}},title:{fontSize:14,whiteSpace:"normal"},mobileButton:{display:"flex",alignItems:"center",whiteSpace:"normal",marginBottom:4,height:void 0}})),[y]);return P?(0,D.jsx)("div",{style:j.title,children:f}):(0,D.jsx)($().Ay,{renderOrigin:e=>y?(0,D.jsx)("div",{style:j.title,...e,children:(0,D.jsxs)("div",{style:j.mobileButton,children:[f,(0,q().V)(j.icon)]})}):(0,D.jsxs)(Y().p,{style:j.origin,hoveredStyle:p?{background:"unset"}:void 0,pressedStyle:p?{background:"unset"}:void 0,disabled:P,...e,children:[(0,D.jsx)(i(265665).j,{children:f}),I?(0,i(883234)._)(j.icon):null]}),disabled:P,onClick:S,buttonPopupStore:g,style:j.privacyMenu,alignmentToOrigin:Q().C.Start,popupType:y?X().nl.BottomSheet:X().nl.Popup,render:e=>a?(0,D.jsx)(fe,{store:s,spacePermission:a,parentCloseCallback:e.close,trustedDomainPermission:l,publicPermission:m,showPublicShareLinkPermission:d,isRestricted:c,sudoModeStore:u.sudoModeStore,location:u.location,permissionItemArgs:u,handleSpacePermissionChange:b,onlyShowPrivateSpaceVisibility:v}):null})}));var xe=()=>i(87043),Ie=()=>i(99756);const Pe={type:"public_permission",role:"none",is_public_share_link:!1};function Se(e){const{store:s,spacePermission:i,publicPermission:a,trustedDomainPermission:l,permissionItemArgs:d,fromPermissionWrapper:c,isRestricted:u}=e,{permissionItem:p,from:g}=a,{location:h,sudoModeStore:b}=d,v=(0,n().v3)(),y=f().A.isMobile,x=(0,o().uB)(void 0,z().A),I=(0,o().K8)((()=>!v.currentUser.isLoggedIn()),[v.currentUser]),P="none"!==i.permissionItem.role,S=(0,U().v)(p)?p:{...p,...Pe},j=(0,t.useCallback)((()=>{x.setState({open:!0})}),[x]),A=(0,t.useCallback)((async e=>{const i=(0,m().Yi)(g)!==s.id;if("string"!=typeof e||!(e in m().TE))return!1;const t=V(s,e);return await(0,H().Hc)({environment:v,store:s,oldPermissionItem:p,newPermissionItem:t,wasInherited:i,location:h,sudoModeStore:b})}),[v,s,p,g,h,b]),_=(0,t.useCallback)((async e=>{const i=(0,m().Yi)(g)!==s.id,t={...p,expiration_timestamp:e};return await(0,H().Hc)({environment:v,store:s,oldPermissionItem:p,newPermissionItem:t,wasInherited:i,location:h,sudoModeStore:b})}),[v,s,p,g,h,b]),M=(0,r().IS)((e=>({container:{width:"100%"},linkExpirationContainer:y?{minHeight:0}:{},linkExpirationButton:y?{paddingLeft:16,paddingRight:16,paddingTop:12,paddingBottom:12,width:void 0,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.stroke.secondary,background:e.surface.elevated}:{padding:0}})),[y]),k=(0,t.useMemo)((()=>[{role:"none",prefixItem:{key:"link-expiration",render:e=>(0,D.jsx)("div",{...e,children:(0,D.jsx)(F().A,{permissionItem:p,hideIcon:!0,onChange:_,focused:!1,buttonStyle:M.linkExpirationButton,style:M.linkExpirationContainer})}),action:()=>{}}}]),[p,_,M.linkExpirationButton,M.linkExpirationContainer]);return(0,D.jsx)("div",{style:M.container,className:G().VRj,children:(0,D.jsx)(xe().Ay,{store:s,permissionItem:S,from:g,shouldDisable:I,fromPermissionWrapper:c,onClick:j,onChange:A,roleItemOverrides:k,icon:(0,D.jsx)(je,{}),title:(0,D.jsx)(ye,{store:s,spacePermission:i,trustedDomainPermission:l,publicPermission:a,showPublicShareLinkPermission:!0,isRestricted:u,permissionItemArgs:d,fromPermissionWrapper:c,buttonPopupStore:x,hideHoverStyles:!1,isDisplayOnly:d.shouldDisable??!1,title:(0,D.jsx)(Ae,{}),onlyShowPrivateSpaceVisibility:P}),subtitle:y?(0,D.jsx)(_e,{role:p.role}):void 0,upgradeButtonName:"public_share_link_item",isRemovableOverride:!0,renderTitleWithoutUILabelWrapper:!0,...d})})}function je(){const e=f().A.isMobile,s=(0,r().IS)((()=>({globeIcon:{width:e?24:K().Ev.default,height:e?24:K().Ev.default}})),[e]);return(0,D.jsx)(Ie().A,{type:"square",iconType:"function",iconFn:W().globeIcon,iconStyle:s.globeIcon,isMobile:e})}function Ae(){const e=(0,r().IS)((()=>({title:{fontSize:14,whiteSpace:"normal"}})),[]);return(0,D.jsx)("div",{style:e.title,children:(0,D.jsx)(u().sA,{defaultMessage:"Anyone on the web with link",id:"publicShareLinkItem.permissionItem.title"})})}function _e(e){const{role:s}=e;return f().A.isMobile?(0,D.jsx)(u().sA,{...(0,E().R)({type:"public_permission",role:s,table:"block",isRemovable:!1,isCurrentUser:!1,isPublicShareLink:!0}).label}):null}var Me=()=>i(115512),ke=()=>i(326589);function Ce(e){let{}=e;const s=(0,n().v3)(),{device:o}=s,a=(0,t.useCallback)((()=>{w().Ay.update((e=>({...e,tab:w().QC.Publish,display:w().pP.Publish})))}),[]),l=(0,r().IS)((e=>({container:{padding:12,backgroundColor:e.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${e.regularDividerColor}`,marginTop:o.isMobile?28:1},link:{textDecoration:"underline",display:"inline"}})),[o.isMobile]);return(0,D.jsx)(L().A,{style:l.container,isMultiline:!0,isSmall:!0,children:(0,D.jsx)(u().sA,{id:"publicItemFooter.caption",defaultMessage:"Anyone on the web can access this published page · <link>Site settings</link>",values:{link:e=>(0,D.jsx)(i(187485).A,{style:l.link,onClick:a,children:e})}})})}const we=t.memo(Ce);function Te(e){let{store:s,publicPermissionItem:i,permissionItemArgs:a}=e;const l=(0,n().v3)(),[m,d]=(0,t.useState)(!1),c=(0,o().K8)((()=>s.canAdmin()),[s]),p=(0,o().K8)((()=>!(0,ke().g)()),[]),h=(0,t.useCallback)((()=>{w().Ay.update((e=>({...e,tab:w().QC.Publish,display:w().pP.Publish})))}),[]),b=(0,t.useCallback)((()=>{const e=!1===m;d(!m),e&&g().lD(l,{share_menu_session_id:w().Ay.state.sessionId,type:"public_link"})}),[l,m,d]),f=(0,r().IS)((e=>({link:{textDecoration:"underline",fontSize:(0,Me().ny)(l,"UISmall"),color:e.text.secondary,paddingTop:0,paddingBottom:0,height:20,paddingLeft:4,paddingRight:4,marginTop:-4,marginLeft:-4,overflow:"hidden"},linkUILabelStyle:{overflow:"unset"}})),[l]);return(0,D.jsx)(xe().Ay,{store:s,permissionItem:i.permissionItem,from:i.from,nonInheritedTooltip:(0,D.jsx)(u().sA,{id:"publicLinkPermissionItem.tooltip",defaultMessage:"Anyone on the web can access this published page"}),icon:(0,D.jsx)(Ne,{}),title:(0,D.jsx)(u().sA,{defaultMessage:"Anyone with published link",id:"publicLinkPermissionItem.title"}),subtitle:p&&(0,D.jsx)(Y().p,{style:f.link,onClick:h,children:c?(0,D.jsx)(u().sA,{defaultMessage:"Edit site settings",id:"publicLinkPermissionItem.manageSettings"}):(0,D.jsx)(u().sA,{defaultMessage:"View site settings",id:"publicLinkPermissionItem.viewSettings"})}),selectFooter:(0,D.jsx)(we,{}),subtitleStyle:f.linkUILabelStyle,onClick:b,upgradeButtonName:"public_permission_item",...a})}function Ne(){const e=(0,r().IS)((e=>({backgroundContainer:{background:e.regularDividerColor,width:32,height:32,borderRadius:4,display:"flex",justifyContent:"center",alignItems:"center"},globeIcon:{width:20,fill:e.icon.secondary}})),[]);return(0,D.jsx)("div",{style:e.backgroundContainer,children:(0,W().globeIcon)(e.globeIcon)})}var Be=()=>i(946548);function Re(e){const{permissionItem:s,onToggle:i,focused:t}=e,a=(0,u().tz)(),{isMobile:l}=(0,n().Y0)(),m=(0,o().K8)((()=>Boolean(s)&&!Boolean(s.unlisted_timestamp)),[s]),d=(0,r().IS)((e=>({visibilityToggle:{display:"flex",alignItems:"start",justifyContent:"space-between",marginLeft:12,paddingLeft:4},buttonMenuItemStyleMobile:{backgroundColor:e.surface.elevated,paddingTop:12,paddingBottom:12,marginRight:12,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.stroke.secondary,width:"100%"}})),[]),c=a.formatMessage({id:"spacePermissionItem.visibilityPicker.unlistedToggle",defaultMessage:"Hide in search"});return(0,D.jsx)("div",{children:(0,D.jsx)(ee().A,{onClick:i,focused:t,style:l?d.buttonMenuItemStyleMobile:{},title:c,shouldWrapTitle:!0,right:(0,D.jsx)("div",{style:l?{}:d.visibilityToggle,children:(0,D.jsx)(Be().A,{disabled:!1,on:!m,onClick:i})})})})}var Le=()=>i(640653),De=()=>i(645873);const Oe=new(De().O2)("PublicShareLinkTutorialTooltip",(()=>Promise.resolve().then(i.bind(i,146842)))),Ue=(0,De()._h)(Oe,(e=>e.PublicShareLinkTutorialTooltip));var We=()=>i(484578);function Ke(e){let{store:s}=e;const i=(0,n().v3)(),t=i.device.isMobile,a=(0,o().K8)((()=>{var e,t;return s instanceof _().SL?null===(e=(0,Le().c2)(i,s))||void 0===e?void 0:e.icon:null===(t=s.getIcon())||void 0===t?void 0:t.icon}),[i,s]),l=(0,r().IS)((e=>({teamOrSpaceIcon:(0,k().iM)({theme:e,size:t?xe().Bj:xe().Ev,useLargeBorderRadius:!0,useLightBackgroundColor:!0,icon:a}),iconBoxStyles:{color:e.icon.secondary}})),[a,t]),{innerEmojiOrFlatIconSize:m,innerInitialSize:d}=function(e){let{baseSize:s}=e;return{innerEmojiOrFlatIconSize:.65*s,innerInitialSize:.75*s}}({baseSize:t?xe().Bj:xe().Ev});return(0,D.jsx)(pe().x,{disabled:!0,store:s,size:t?xe().Bj:xe().Ev,iconContainerStyles:l.teamOrSpaceIcon,iconBoxStyles:l.iconBoxStyles,innerEmojiOrFlatIconSize:m,innerInitialSize:d})}const Ee=t.memo(Ke);function Ge(e){let{visibility:s,spaceStore:i}=e;const t=(0,n().v3)(),r=(0,o().K8)((()=>(0,Le().GK)(t,i)),[t,i]);switch(s){case"private":return(0,D.jsx)(u().sA,{id:"spacePermissionVisibilityPicker.private",defaultMessage:"Only people invited"});case"unlisted":return(0,D.jsx)(u().sA,{id:"blockPermissionsSettings.permissionItem.workspaceAccessNew.unlisted",defaultMessage:"Everyone at {spaceName} with the link",values:{spaceName:r}});case"open":case"open_unlisted_hybrid":return(0,D.jsx)(u().sA,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:r}});default:(0,J().HB)(s)}}const Ve=new(i(178624).R)({key:"shareMenuRoleSelectCalloutCount",namespace:i(419494).Bq,important:!0,trackingType:"necessary"});function Fe(e){let{visibility:s,spaceStore:i,isMobile:t}=e;const n=(0,r().IS)((()=>({lockIcon:{width:t?24:18,height:t?24:18}})),[t]);return"private"===s?(0,D.jsx)(Ie().A,{type:"square",iconType:"function",iconFn:ue().i,iconStyle:n.lockIcon,isMobile:t}):"unlisted"===s||"open"===s||"open_unlisted_hybrid"===s?(0,D.jsx)(Ee,{store:i}):void(0,J().HB)(s)}function ze(e){let{store:s,spacePermission:i,trustedDomainPermission:t,publicPermission:n,showPublicShareLinkPermission:o,isRestricted:r,permissionItemArgs:a,fromPermissionWrapper:l,buttonPopupStore:m,visibility:d,spaceStore:c,hideHoverStyles:u,isDisplayOnly:p,handleSpacePermissionChange:g}=e;return(0,D.jsx)(ye,{store:s,spacePermission:i,trustedDomainPermission:t,publicPermission:n,showPublicShareLinkPermission:o,isRestricted:r,permissionItemArgs:a,fromPermissionWrapper:l,buttonPopupStore:m,hideHoverStyles:u,isDisplayOnly:p,handleSpacePermissionChange:g,title:(0,D.jsx)(Ge,{visibility:d,spaceStore:c})})}const He=function(e){let{trustedDomainPermission:s,isRestricted:a,publicPermission:l,showPublicShareLinkPermission:d,shouldShowPublicShareLinkTooltip:c,...g}=e;const{store:h,spacePermission:b,fromPermissionWrapper:f}=g,v=(0,n().v3)(),y=v.device.isMobile,x=(0,t.useRef)(null),I=(0,o().uB)(void 0,z().A);(0,t.useEffect)((()=>{c&&(0,i(299487).HH)(v,i(146842).PUBLIC_SHARE_LINK_TOOLTIP_ID)}),[v,c]);const P=m().Ni(b.permissionItem)&&"none"!==b.permissionItem.role,S=(0,We().QX)(b),A=(0,o().O$)(j().AppStoreCurrentSpaceStore),_=(0,o().K8)((()=>{const e=j().default.state.currentSpaceStore;return null==e||!e.isDefined()}),[]),k=(0,o().K8)((()=>{const e=j().default.state.currentSpaceStore;return!!e&&(0,Le().IL)(e)}),[]),C=(0,o().K8)((()=>(0,M().WG)()),[]),w=(0,o().K8)((()=>de().default.checkGate({gateName:"domain_link_sharing_redesign_override",disableExposureLogging:!0})||"on"===de().default.getEligibleGroup({experimentId:"domain_link_sharing_redesign",defaultGroup:"control"})),[]),T=(0,ne().H)(),N=(0,o().K8)((()=>{var e;return null==T||null===(e=T.getForSpace(A))||void 0===e?void 0:e.trustedDomains}),[T,A]),B=(0,o().K8)((()=>(0,i(965597).Hb)({space:null==A?void 0:A.getModel(),trustedDomains:N,enableTrustedDomainPermissionRedesign:w})),[A,N,w]),R=(0,o().K8)((()=>!!A&&h.isTopLevelWorkspacePage(A.id)),[h,A]),L=(0,o().K8)((()=>{const e=(0,M().QJ)({store:h});return e?oe({permission:e,includeHybrid:!1}):"private"}),[h]),O=(0,o().K8)((()=>Ve.getState()??0),[]),[U,W]=(0,t.useState)(!1),K=(0,t.useCallback)((e=>{let{before:s,after:i}=e,t=!1;const n=(0,We().QX)(s),o=(0,We().QX)(i);"private"===n&&"private"!==o&&O<3&&(t=!0,Ve.setState(O+1)),W(t)}),[O]),V=(0,t.useCallback)((()=>{I.setState({open:!0})}),[I]),F=(0,t.useCallback)((async()=>{const e=b.permissionItem,s=(0,p().mg)(e);let i;"unlisted"===("open"===S?"unlisted":"open")?(s.unlisted_timestamp=Date.now(),i="open"===L):(delete s.unlisted_timestamp,i=!1);const t=b.from,n=(0,m().Yi)(t),o=!(t.table===h.table&&n===h.id);i=i&&!R&&!a,await(0,H().Hc)({oldPermissionItem:e,newPermissionItem:s,wasInherited:o,environment:v,store:h,restrictingVisibility:i,sudoModeStore:g.permissionItemArgs.sudoModeStore,location:g.permissionItemArgs.location})}),[v,b,R,g.permissionItemArgs,S,h,a,L]),q=(0,r().IS)((e=>({container:{width:"100%"}})),[]),Y=(0,t.useMemo)((()=>[{role:"none",prefixItem:{key:"can-find-in-search-toggle",render:e=>(0,D.jsx)(ae().A,{placement:Q().W.Left,renderTooltip:()=>(0,D.jsx)("div",{style:{width:250,whiteSpace:"normal"},children:(0,D.jsx)(u().sA,{defaultMessage:"Hide this page in search results from users without the link or who haven’t visited it before",id:"spacePermissionItem.unlistedToggle.tooltip"})}),render:s=>(0,D.jsx)("div",{...e,...s,children:(0,D.jsx)(Re,{permissionItem:b.permissionItem,onToggle:F,focused:e.focused})})}),action:()=>{}}}]),[b,F]),$="private"===S;if(!A)return null;if(_)return k?(0,D.jsx)("div",{style:q.container,className:P?void 0:G().VRj,children:(0,D.jsx)(xe().Ay,{store:h,permissionItem:b.permissionItem,from:b.from,icon:(0,D.jsx)(Fe,{visibility:S,spaceStore:A,isMobile:v.device.isMobile}),iconStyle:void 0,title:(0,D.jsx)(ze,{store:h,spaceStore:A,spacePermission:b,trustedDomainPermission:s,publicPermission:l,showPublicShareLinkPermission:d,isRestricted:!0,permissionItemArgs:g.permissionItemArgs,fromPermissionWrapper:f,buttonPopupStore:I,visibility:S,hideHoverStyles:$,isDisplayOnly:!0,handleSpacePermissionChange:K}),subtitle:y&&!$?(0,D.jsx)(u().sA,{...(0,E().R)({type:"space_permission",role:b.permissionItem.role,table:"block",isRemovable:!1,isCurrentUser:!1}).label}):void 0,upgradeButtonName:"space_permission_item",fromPermissionWrapper:f,isRemovableOverride:!0,hideRoleSelectButton:$,renderTitleWithoutUILabelWrapper:!0,...g.permissionItemArgs,shouldDisable:!0})}):null;const X=C&&(null==B?void 0:B.length)>0&&("open"===S||"unlisted"===S),J=X?(0,D.jsx)(u().sA,{defaultMessage:"Anyone with a {trustedDomain} email can also view this page",id:"blockPermissionsSettings.spacePermission.trustedDomainTooltip",values:{trustedDomain:B[0]}}):void 0;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Ue,{originRef:x,onPrimaryButtonClick:V}),(0,D.jsx)("div",{style:q.container,className:P?void 0:G().VRj,ref:x,children:(0,D.jsx)(xe().Ay,{store:h,permissionItem:b.permissionItem,from:b.from,icon:(0,D.jsx)(Fe,{visibility:S,spaceStore:A,isMobile:v.device.isMobile}),iconStyle:void 0,title:(0,D.jsx)(ze,{store:h,spaceStore:A,spacePermission:b,trustedDomainPermission:s,publicPermission:l,showPublicShareLinkPermission:d,isRestricted:a,permissionItemArgs:g.permissionItemArgs,fromPermissionWrapper:f,buttonPopupStore:I,visibility:S,hideHoverStyles:$,isDisplayOnly:g.permissionItemArgs.shouldDisable??!1,handleSpacePermissionChange:K}),selectHeader:y?(0,D.jsx)(i(678553).Ay,{title:(0,D.jsx)(ze,{store:h,spaceStore:A,spacePermission:b,trustedDomainPermission:s,publicPermission:l,showPublicShareLinkPermission:d,isRestricted:a,permissionItemArgs:g.permissionItemArgs,fromPermissionWrapper:f,buttonPopupStore:I,visibility:S,hideHoverStyles:$,isDisplayOnly:!0,handleSpacePermissionChange:K}),icon:(0,D.jsx)(Fe,{visibility:S,spaceStore:A,isMobile:v.device.isMobile}),desktopIconStyle:{marginLeft:16}}):void 0,onClick:V,inheritedTooltip:X?J:void 0,nonInheritedTooltip:J,subtitle:y&&!$?(0,D.jsx)(u().sA,{...(0,E().R)({type:"space_permission",role:b.permissionItem.role,table:"block",isRemovable:!1,isCurrentUser:!1}).label}):void 0,upgradeButtonName:"space_permission_item",fromPermissionWrapper:f,isRemovableOverride:!0,hideRoleSelectButton:$,renderTitleWithoutUILabelWrapper:!0,roleItemOverrides:Y,openRoleSelectMenuOnRender:U,...g.permissionItemArgs})})]})};function qe(e){const{store:s,spacePermission:i,showSpacePermission:t,trustedDomainPermission:n,publicPermission:o,showSitePublicPermission:r,showPublicShareLinkPermission:a,permissionItemArgs:l,isRestricted:m}=e,d=(0,U().v)(o.permissionItem);return(0,D.jsxs)(D.Fragment,{children:[t&&Ye(i,o,a)&&(0,D.jsx)(He,{store:s,spacePermission:i,publicPermission:o,showPublicShareLinkPermission:a&&!d,trustedDomainPermission:n,permissionItemArgs:l,fromPermissionWrapper:"permission_list",isRestricted:m,shouldShowPublicShareLinkTooltip:!d}),a&&d&&(0,D.jsx)(Se,{store:s,spacePermission:i,publicPermission:o,trustedDomainPermission:n,permissionItemArgs:l,fromPermissionWrapper:"permission_list",isRestricted:m}),r&&o&&(0,D.jsx)(Te,{store:s,publicPermissionItem:o,permissionItemArgs:l})]})}function Ye(e,s,i){return!i||("none"!==e.permissionItem.role||"none"===e.permissionItem.role&&!(0,U().v)(s.permissionItem))}var $e=()=>i(179034);const Xe=function(e){const{store:s}=e,t=(0,r().IS)((e=>({icon:{width:17,height:17,fill:e.icon.secondary},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),n={table:$e().ev,blockId:s.id};return(0,D.jsx)(xe().Ay,{icon:(0,i(400835).D)(t.icon),iconStyle:t.iconContainer,title:(0,D.jsx)(u().sA,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:(0,D.jsx)(u().sA,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you don't have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:(0,D.jsx)(D.Fragment,{}),store:s,permissionItem:{type:"display_only_hidden_permission"},from:n,upgradeButtonName:"team_permission_item"})};var Qe=()=>i(453597),Je=()=>i(878377),Ze=()=>i(584262),es=()=>i(433847),ss=()=>i(946141),is=()=>i(296798),ts=()=>i(187820),ns=()=>i(16006),os=()=>i(492414),rs=()=>i(108944),as=()=>i(632709),ls=()=>i(848237),ms=()=>i(613850),ds=()=>i(901389),cs=()=>i(579627),us=()=>i(751156),ps=()=>i(761652),gs=()=>i(247123);async function hs(e){const{environment:s,useSudoMode:i,store:t,permissionChanges:n,from:o,shareMenuSessionId:r,parentStore:a}=e,l={type:"restore",permissionChanges:n};(!(l.permissionChanges.length>0)||(await ds().Gh({message:(0,gs().r6)(l),description:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(L().A,{isSmall:!0,isMultiline:!0,children:(0,D.jsx)(u().sA,{id:"restrictedPermissionConfirmationModal.relink.caption",defaultMessage:"The following settings will be restored to match {parentName}",values:{parentName:(0,D.jsx)(ps().A,{store:a,style:{fontWeight:Z().Wy.regular},useInvertedColors:!1,maxLength:45})}})}),(0,D.jsx)(gs().f2,{openState:l})]}),acceptColor:"blue",acceptLabel:(0,gs().QU)(l),icon:(0,ms().G)({height:K().Ev.xl,width:K().Ev.xl})})).accept)&&(t.getPermissionItemsStore().canAdmin()?us().createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:s,canUndo:!0,useSudoMode:i,perform:e=>{cs().P8({environment:s,store:t,transaction:e,from:o,shareMenuSessionId:r})}}):cs().YD({environment:s,store:t,from:o,shareMenuSessionId:r}))}function bs(e){const{store:s,sudoModeStore:i}=e,a=(0,n().v3)(),{isMobile:l}=(0,n().Y0)(),m=(0,o().K8)((()=>function(e){const{store:s,environment:i}=e;return Je().Uo6([Je().Km9,Je().AU6(Je().oy3)])({environment:i,blocks:[s],publicEditMode:void 0})}({store:s,environment:a})),[s,a]),d=(0,o().K8)((()=>s.isRestricted()),[s]),c=(0,o().K8)((()=>rs().fU(s)[1]),[s]),u=(0,o().K8)((()=>(0,es().wD)(rs().E(c))),[c]),p=(0,t.useCallback)((async()=>{const e=!!i&&i.shouldSaveTransactionWithSudoMode(s);if(s.isDefined()&&c)if(d){const i=s.getPermissionItems(),t=(0,es().Cd)(s.getModel(),i,u);await hs({environment:a,useSudoMode:e,store:s,permissionChanges:t,from:"inheritance_banner",shareMenuSessionId:w().Ay.state.sessionId,parentStore:c})}else await(0,H().Dw)({environment:a,useSudoMode:e,store:s,permissionItem:void 0,fromPermissionWrapper:"inheritance_banner",shouldInherit:!1})}),[a,i,s,d,c,u]),g=(0,r().IS)((e=>({container:{...(0,k().kJ)({theme:e,isMobile:l}),paddingLeft:12,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:8},labelContainer:{display:"flex",flexDirection:"row",justifyContent:"flex-start"},rightContainer:{flexShrink:0}})),[l]);return!m&&d?null:c?u.length<2?null:(0,D.jsxs)("div",{style:g.container,children:[(0,D.jsx)("div",{style:g.labelContainer,children:(0,D.jsx)(L().A,{isMultiline:!0,isSmall:!0,children:(0,D.jsx)(fs,{store:s,navigableParentStore:c,showToggle:m})})}),m&&(0,D.jsx)("div",{style:g.rightContainer,children:(0,D.jsx)(Be().A,{on:!d,onClick:p})})]}):null}function fs(e){let{store:s,navigableParentStore:i,showToggle:t}=e;const a=(0,n().v3)(),l=(0,o().K8)((()=>{if(i instanceof _().Bv)return(0,os().Ay)({store:i,fullyQualified:!1,pageVisitSource:Ze().y8.ShareMenu})}),[i]),m=(0,o().K8)((()=>(0,ts().Te)(i)),[i]),d=(0,o().K8)((()=>i.getIcon()),[i]),c=(0,r().IS)((e=>({recordContainer:{display:"inline",alignItems:"center"},title:{display:"inline"},recordIcon:{display:"inline-block",marginRight:2,verticalAlign:"text-bottom"}})),[]),p=(0,D.jsxs)("div",{style:c.recordContainer,children:[(0,D.jsx)(ts().B6,{disabled:!0,icon:d,iconRecordCategory:m,size:14,isEmptyPage:!1,style:c.recordIcon}),(0,D.jsx)(is().A,{inline:!0,underline:!0,onClick:()=>{i instanceof _().h4&&(ls().F2({environment:a,teamId:i.id,tab:as().p.Members,from:"share_menu"}),ss().ks(a,{store:i,option:"view",from:"share_menu"}))},href:l,style:c.recordContainer,children:(0,D.jsx)(ns().A,{shouldWrap:!0,store:i,style:c.title})})]});return t?(0,D.jsx)(u().sA,{id:"pageShareMenu.inheritingFromParentPageBanner.switchLabel",defaultMessage:"Share with everyone who has access to {parentPageTitle}",values:{parentPageTitle:p}}):(0,D.jsx)(u().sA,{id:"pageShareMenu.inheritingFromParentPageBanner.readOnlyLabel",defaultMessage:"Shared with everyone who has access to {parentPageTitle}",values:{parentPageTitle:p}})}var vs=()=>i(243581),ys=()=>i(105239),xs=()=>i(126617),Is=()=>i(735790),Ps=()=>i(854150),Ss=()=>i(285790),js=()=>i(8980);async function As(e){const{environment:s,useSudoMode:i,store:t}=e,n={type:"restoreTeamPermissions",permissionChanges:[]},{accept:o}=await ds().Gh({message:(0,gs().r6)(n),acceptLabel:(0,gs().QU)(n),cancelLabel:(0,D.jsx)(u().sA,{id:"restrictedPermissionConfirmationModal.actionButton.close",defaultMessage:"Close"})});o&&us().createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:s,canUndo:!0,useSudoMode:i,perform:e=>{cs().zE({environment:s,store:t,transaction:e})}})}function _s(e){const{showRestoreButton:s,store:i,type:t,sudoModeStore:a}=e,l=(0,n().v3)(),{isMobile:m}=(0,n().Y0)(),d=(0,o().K8)((()=>rs().fU(i)[1]),[i]),c=(0,o().K8)((()=>i.canAdmin()),[i]),u=(0,r().IS)((e=>({banner:{...(0,k().kJ)({theme:e,isMobile:m}),display:"flex",flexDirection:"row",alignItems:"flex-start",gap:8},content:{display:"flex",alignItems:"flex-start",gap:2,flex:"1 0 0"},label:{fontSize:(0,Me().ny)(l,"UIRegular"),lineHeight:"20px",color:e.text.secondary,flex:"1 0 0",paddingLeft:4},iconContainer:{paddingTop:2,height:20,width:20,display:"flex",alignItems:"center",justifyContent:"center"}})),[l,m]);return c?m?(0,D.jsxs)("div",{style:u.banner,children:[(0,D.jsxs)("div",{style:u.content,children:["restricted"===t&&(0,D.jsx)("div",{style:u.iconContainer,children:(0,D.jsx)(js().I,{icon:vs().r,color:"secondary"})}),(0,D.jsx)(L().A,{style:u.label,isMultiline:!0,children:(0,D.jsx)(Ms,{type:t,navigableParentStore:d,showRestoreButton:s,store:i})})]}),s&&(0,D.jsx)(ks,{type:t,store:i,sudoModeStore:a})]}):(0,D.jsxs)("div",{style:u.banner,children:[(0,D.jsxs)("div",{style:u.content,children:["restricted"===t&&(0,D.jsx)("div",{style:u.iconContainer,children:(0,D.jsx)(js().I,{icon:vs().r,color:"secondary"})}),(0,D.jsx)(L().A,{style:u.label,isMultiline:!0,children:(0,D.jsx)(Ms,{store:i,type:t,navigableParentStore:d,showRestoreButton:s})})]}),s&&(0,D.jsx)(ks,{type:t,store:i,sudoModeStore:a})]}):null}function Ms(e){const{store:s,type:i,navigableParentStore:t}=e,a=(0,n().v3)(),l=(0,o().K8)((()=>{if(t instanceof _().Bv)return(0,os().Ay)({store:t,fullyQualified:!1,pageVisitSource:Ze().y8.ShareMenu})}),[t]),m=(0,o().K8)((()=>t instanceof _().h4),[t]),d=(0,o().K8)((()=>t.getIcon()),[t]),c=(0,o().K8)((()=>s.isCollectionView()?"database":"page"),[s]),p=(0,r().IS)((e=>({recordContainer:{display:"inline",alignItems:"center",gap:2,marginLeft:2},title:{display:"inline"},recordIcon:{display:"inline-block",marginRight:2,verticalAlign:"text-bottom"}})),[]),g=t instanceof _().h4?(0,D.jsx)(is().A,{inline:!0,underline:!0,onClick:()=>{ls().F2({environment:a,teamId:t.id,tab:as().p.Members,from:"permission_item"}),ss().ks(a,{store:t,option:"view",from:"share_menu"})},children:(0,D.jsx)(ns().A,{shouldWrap:!0,maxLength:30,store:t,style:p.title})}):(0,D.jsxs)("div",{style:p.recordContainer,children:[d&&(0,D.jsx)(ts().B6,{disabled:!0,icon:d,iconRecordCategory:"database"===c?"collectionViewBlock":"pageBlock",size:14,isEmptyPage:!1,style:p.recordIcon}),(0,D.jsx)(is().A,{inline:!0,href:l,style:p.recordContainer,children:(0,D.jsx)(ns().A,{shouldWrap:!1,maxLength:30,store:t,style:p.title,underline:!0})})]});switch(i){case"elevated":return m?"database"===c?(0,D.jsx)(u().sA,{id:"pageShareMenu.restoreTeamspacePermissionsBannerDatabase.label",defaultMessage:"Share settings on this database differ from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:g}}):(0,D.jsx)(u().sA,{id:"pageShareMenu.restoreTeamspacePermissionsBanner.label",defaultMessage:"Share settings on this page differ from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:g}}):"database"===c?(0,D.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBannerDatabase.label",defaultMessage:"Share settings on this database differ from the parent page {parentPageTitle}",values:{parentPageTitle:g}}):(0,D.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.label",defaultMessage:"Share settings on this page differ from the parent page {parentPageTitle}",values:{parentPageTitle:g}});case"restricted":return m?"database"===c?(0,D.jsx)(u().sA,{id:"pageShareMenu.restrictedAccessFromTeamspaceBannerDatabase.label",defaultMessage:"Share settings on this database are unlinked from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:g}}):(0,D.jsx)(u().sA,{id:"pageShareMenu.restrictedAccessFromTeamspaceBanner.label",defaultMessage:"Share settings on this page are unlinked from the {teamspaceTitle} teamspace default",values:{teamspaceTitle:g}}):"database"===c?(0,D.jsx)(u().sA,{id:"pageShareMenu.restrictedAccessFromParentPageBannerDatabase.label",defaultMessage:"Share settings on this database are unlinked from the parent page {parentPageTitle}",values:{parentPageTitle:g}}):(0,D.jsx)(u().sA,{id:"pageShareMenu.restrictedAccessFromParentPageBanner.label",defaultMessage:"Share settings on this page are unlinked from the parent page {parentPageTitle}",values:{parentPageTitle:g}});default:(0,J().HB)(i)}}function ks(e){const{type:s,store:i,sudoModeStore:t}=e,a=(0,n().v3)(),{isMobile:l}=(0,n().Y0)(),m=(0,u().tz)(),d=(0,o().K8)((()=>!!t&&t.shouldSaveTransactionWithSudoMode(i)),[i,t]),c=(0,o().K8)((()=>(0,rs().fU)(i)[1]),[i]),p=c.table===Ps().yK,g=(0,o().K8)((()=>{if(c instanceof _().Bv)return(0,os().Ay)({store:c,fullyQualified:!1,pageVisitSource:Ze().y8.ShareMenu})}),[c]),h=(0,r().IS)((e=>({icon:{fill:e.icon.secondary,height:16,width:16},mobileRestoreButton:{fontSize:(0,Me().ny)(a,"UIRegular"),fontWeight:Z().Wy.medium,flexShrink:0,borderRadius:4,paddingLeft:4,paddingRight:4,color:e.text.uiBluePrimary}})),[a]),f=[p?{key:"showTeamSettings",render:e=>(0,D.jsx)(ee().A,{...e,icon:(0,D.jsx)(js().I,{icon:Is().M}),title:(0,D.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.viewDefaults.label",defaultMessage:"View defaults"})}),action:()=>{c.table===Ps().yK&&(ls().F2({environment:a,teamId:c.id,tab:as().p.Members,from:"permission_item"}),ss().ks(a,{store:c,option:"view",from:"share_menu"}))}}:g?{key:"showParentPageSettings",render:e=>(0,D.jsx)(ee().A,{...e,icon:(0,D.jsx)(js().I,{icon:Is().M}),title:(0,D.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.viewDefaults.label",defaultMessage:"View defaults"}),href:g}),action:()=>{}}:void 0,{key:"restore",action:async()=>{if("elevated"===s)await As({environment:a,useSudoMode:d,store:i});else if("restricted"===s){if(!i.isDefined())return;const e=i.getPermissionItems(),s=rs().fU(i)[1];if(!s)return;const t=(0,es().wD)(rs().E(s)),n=(0,es().Cd)(i.getModel(),e,t);await hs({environment:a,useSudoMode:d,store:i,permissionChanges:n,from:"unlinked_banner",shareMenuSessionId:w().Ay.state.sessionId,parentStore:s})}else(0,J().HB)(s)},render:e=>(0,D.jsx)(ee().A,{...e,title:(0,D.jsx)(u().sA,{id:"pageShareMenu.restoreParentPagePermissionsBanner.restoreSettings.label",defaultMessage:"Restore settings"}),icon:(0,D.jsx)(js().I,{icon:ys().N})})}].filter(J().O9),v=[{key:"all",render:e=>(0,D.jsx)(b().A,{...e}),items:f}];return l?(0,D.jsx)(R().A,{style:h.mobileRestoreButton,onClick:async()=>{if("elevated"===s)await As({environment:a,useSudoMode:d,store:i});else if("restricted"===s){if(!i.isDefined())return;const e=i.getPermissionItems(),s=rs().fU(i)[1];if(!s)return;const t=(0,es().wD)(rs().E(s)),n=(0,es().Cd)(i.getModel(),e,t);await hs({environment:a,useSudoMode:d,store:i,permissionChanges:n,from:"unlinked_banner",shareMenuSessionId:w().Ay.state.sessionId,parentStore:s})}else(0,J().HB)(s)},children:(0,D.jsx)(u().sA,{defaultMessage:"Restore",id:"pageShareMenu.restoreParentPagePermissionsBanner.restore.mobile.label"})}):(0,D.jsx)($().Ay,{render:()=>(0,D.jsx)(se().A,{menuType:te().gu.Popup,children:(0,D.jsx)(ie().Ay,{type:ie().Oh.Vertical,sections:v,initialFocus:void 0})}),renderOrigin:e=>(0,D.jsx)(Ss().A,{icon:xs().Y,iconStyle:h.icon,ariaLabel:m.formatMessage({id:"pageShareMenu.restorePagePermissionsBanner.restoreOptionsButton.label",defaultMessage:"See restore permissions options"}),...e}),popupType:$().z7.Popup,placementToOrigin:Q().W.Bottom,alignmentToOrigin:Q().C.End})}function Cs(e){const{store:s}=e,i=(0,n().v3)(),t=(0,o().K8)((()=>function(e){const{store:s,environment:i}=e;return Je().or([Je().Km9,Je().Uo6([Je()._mr,Je().AU6(Je().Km9)])])({environment:i,blocks:[s],publicEditMode:void 0})}({store:s,environment:i})),[s,i]);return(0,D.jsx)(_s,{type:"restricted",showRestoreButton:t,store:s,sudoModeStore:e.sudoModeStore})}function ws(e){const{store:s}=e;return(0,o().K8)((()=>(0,M().le)({store:s})),[s])?(0,D.jsx)(_s,{type:"elevated",showRestoreButton:!1,store:s,sudoModeStore:e.sudoModeStore}):null}const Ts=function(e){const{store:s,showRestrictedPermissionBanner:i,showPermissionInheritanceBanner:t}=e,{canAccessParent:n}=(0,o().K8)((()=>(0,M().iG)({store:s})),[s]);return n?t?(0,D.jsx)(bs,{store:s,sudoModeStore:e.sudoModeStore}):i?(0,D.jsx)(Cs,{store:s,sudoModeStore:e.sudoModeStore}):(0,D.jsx)(ws,{store:s,sudoModeStore:e.sudoModeStore}):null};var Ns=()=>i(173783),Bs=()=>i(37433);function Rs(e){const{teamName:s,isCompact:i}=e;return i?(0,D.jsx)(u().sA,{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}):s?(0,D.jsx)(u().sA,{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:s}}):(0,D.jsx)(u().sA,{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function Ls(e){let{teamGuestsCount:s,isCompact:i}=e;return 0===s?null:(0,D.jsx)(u().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamGuestPermission.subtitle",values:{membersCount:s}})}function Ds(e){const{teamName:s}=e,i=(0,r().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return s?(0,D.jsx)("div",{style:i.tooltip,children:(0,D.jsx)(u().sA,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:s},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})}):null}const Os=function(e){let{store:s,blockTeamGuestPermission:i,isExternalTeam:t,fromPermissionWrapper:a,teamGuestsCount:l,permissionItemArgs:d}=e;const{isMobile:c}=(0,n().Y0)(),{permissionItem:u}=i,p=(0,o().O$)(j().AppStoreCurrentSpaceStore),g=(0,o().K8)((()=>{var e;return m().un(u)?u.team_id:null===(e=rs().Uo(s))||void 0===e?void 0:e.id}),[u,s]),{teamStore:h,teamIsDefined:b,teamName:f}=(0,o().K8)((()=>{if(!p||!g)return{};const e=_().h4.createChildStore(p,{table:Ps().yK,id:g,spaceId:p.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName()}:{}}),[p,g]),v=(0,o().K8)((()=>{if(l)return l;if(void 0!==h){const e=(0,Bs().PF)({teamStore:h});if(void 0!==e)return e.memberCountWithGuests-e.memberCount}}),[h,l]),y=!t,x=(0,r().IS)((()=>({container:{width:"100%"}})),[]);return h?(0,D.jsx)("div",{style:x.container,className:G().rkF,children:(0,D.jsx)(xe().Ay,{isCompact:y,store:s,permissionItem:u,icon:(0,D.jsx)(Ns().A,{size:c?xe().Bj:xe().Ev}),title:(0,D.jsx)(Rs,{teamName:f,isCompact:y}),nonInheritedTooltip:(0,D.jsx)(Ds,{teamName:f}),from:i.from,subtitle:b&&(0,D.jsx)(Ls,{teamGuestsCount:v??0,isCompact:y}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:a,...d})}):null};function Us(e){let{teamName:s,isCompact:i}=e;return i?(0,D.jsx)(u().sA,{defaultMessage:"Members",id:"blockPermissionsSettings.permissionItem.teamAccessV3"}):s?(0,D.jsx)(u().sA,{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}):(0,D.jsx)(u().sA,{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function Ws(e){let{membersCount:s,permissionItem:i}=e;const{isMobile:t}=(0,n().Y0)();return 0===s?null:t&&i?(0,D.jsxs)("div",{children:[(0,D.jsx)(u().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamMembersPermission.subtitle",values:{membersCount:s}})," · ",(0,D.jsx)(u().sA,{...(0,E().R)({type:i.type,role:i.role,table:Ps().yK,isRemovable:!1,isCurrentUser:!1}).label})]}):(0,D.jsx)(u().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamMembersPermission.subtitle",values:{membersCount:s}})}function Ks(e){const{teamName:s}=e,i=(0,r().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return s?(0,D.jsx)("div",{style:i.tooltip,children:(0,D.jsx)(u().sA,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:s},id:"blockPermissionsSettings.teamPermission.tooltip"})}):null}const Es=function(e){let{store:s,blockTeamPermission:i,isExternalTeam:t,fromPermissionWrapper:a,teamMembersCount:l,permissionItemArgs:d}=e;const{isMobile:c}=(0,n().Y0)(),{permissionItem:u}=i,p=(0,o().O$)(j().AppStoreCurrentSpaceStore),g=(0,o().K8)((()=>{var e;return m().gl(u)?u.team_id:null===(e=rs().Uo(s))||void 0===e?void 0:e.id}),[u,s]),{teamStore:h,teamIsDefined:b,teamName:f}=(0,o().K8)((()=>{if(!p||!g)return{};const e=_().h4.createChildStore(p,{table:Ps().yK,id:g,spaceId:p.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[p,g]),v=!t,y=(0,o().K8)((()=>{return l||(void 0!==h?null===(e=(0,Bs().PF)({teamStore:h,spaceId:null==p?void 0:p.id}))||void 0===e?void 0:e.memberCount:void 0);var e}),[h,l,p]),x=(0,r().IS)((()=>({container:{width:"100%"}})),[]);return h?(0,D.jsx)("div",{style:x.container,className:G().rkF,children:(0,D.jsx)(xe().Ay,{isCompact:v,store:s,permissionItem:i.permissionItem,from:i.from,icon:(0,D.jsx)(Ns().A,{size:c?xe().Bj:xe().Ev}),title:(0,D.jsx)(Us,{teamName:f,isCompact:v}),nonInheritedTooltip:(0,D.jsx)(Ks,{teamName:(0,D.jsx)(ps().A,{store:h,useInvertedColors:!0})}),subtitle:b&&(0,D.jsx)(Ws,{membersCount:y??0,permissionItem:i.permissionItem}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:a,...d})}):null};function Gs(e){let{teamName:s,isCompact:i}=e;return i?(0,D.jsx)(u().sA,{defaultMessage:"Owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV3"}):s?(0,D.jsx)(u().sA,{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",values:{teamName:s}}):(0,D.jsx)(u().sA,{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function Vs(e){let{teamOwnersCount:s,isCompact:i,permissionItem:t}=e;const{isMobile:o}=(0,n().Y0)();return 0===s?null:o&&t?(0,D.jsxs)("div",{children:[(0,D.jsx)(u().sA,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:s}})," · ",(0,D.jsx)(u().sA,{...(0,E().R)({type:t.type,role:t.role,table:Ps().yK,isRemovable:!1,isCurrentUser:!1}).label})]}):(0,D.jsx)(u().sA,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:s}})}function Fs(e){const{teamName:s}=e,i=(0,r().IS)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return s?(0,D.jsx)("div",{style:i.tooltip,children:(0,D.jsx)(u().sA,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:s},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})}):null}const zs=function(e){let{store:s,blockTeamOwnerPermission:i,isExternalTeam:t,fromPermissionWrapper:a,teamOwnersCount:l,permissionItemArgs:d}=e;const{isMobile:c}=(0,n().Y0)(),{permissionItem:u}=i,p=(0,o().O$)(j().AppStoreCurrentSpaceStore),g=(0,o().K8)((()=>{var e;return m().nl(u)?u.team_id:null===(e=rs().Uo(s))||void 0===e?void 0:e.id}),[u,s]),{teamStore:h,teamName:b}=(0,o().K8)((()=>{if(!p||!g)return{undefined:void 0};const e=_().h4.createChildStore(p,{table:Ps().yK,id:g,spaceId:p.id});return{teamStore:e,teamName:e.getName()}}),[p,g]),f=!t,v=(0,o().K8)((()=>{return l||(void 0!==h?null===(e=(0,Bs().PF)({teamStore:h}))||void 0===e?void 0:e.ownerCount:void 0);var e}),[h,l]),y=(0,r().IS)((()=>({container:{width:"100%"}})),[]);return h?(0,D.jsx)("div",{style:y.container,className:G().D3T,children:(0,D.jsx)(xe().Ay,{isCompact:f,store:s,permissionItem:i.permissionItem,from:i.from,icon:(0,D.jsx)(Ns().A,{size:c?xe().Bj:xe().Ev}),title:(0,D.jsx)(Gs,{teamName:b,isCompact:f}),nonInheritedTooltip:(0,D.jsx)(Fs,{teamName:(0,D.jsx)(ps().A,{store:h,useInvertedColors:!0})}),subtitle:(0,D.jsx)(Vs,{teamOwnersCount:v??0,isCompact:f,permissionItem:i.permissionItem}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:a,...d})}):null},Hs=(0,K().wt)("expandThin",{viewBox:"0 0 16 16",svg:(0,D.jsx)("path",{d:"M7.992.61c.156 0 .3.033.43.1.13.069.27.16.422.274l5.265 4.25a.948.948 0 01.368.774 1 1 0 01-.149.547c-.099.156-.229.28-.39.375a1.013 1.013 0 01-.508.133 1.07 1.07 0 01-.399-.079 1.6 1.6 0 01-.375-.226L7.992 3.016 3.336 6.758a1.74 1.74 0 01-.383.226 1.056 1.056 0 01-.906-.055 1.145 1.145 0 01-.383-.374 1 1 0 01-.148-.547c0-.318.122-.576.367-.774L7.148.984C7.3.87 7.44.78 7.57.711a.9.9 0 01.422-.102zm0 14.85a.901.901 0 01-.422-.1 2.288 2.288 0 01-.422-.274l-5.265-4.25a.962.962 0 01-.367-.774 1.055 1.055 0 01.531-.914 1.01 1.01 0 01.906-.062c.125.052.253.128.383.226l4.656 3.743 4.664-3.742a1.6 1.6 0 01.375-.227c.13-.052.263-.078.399-.078a.97.97 0 01.508.14 1.036 1.036 0 01.539.915c0 .312-.123.57-.368.773l-5.265 4.258a2.512 2.512 0 01-.422.265.917.917 0 01-.43.102z"})});var qs=()=>i(710149),Ys=()=>i(180925);function $s(e){let{teamName:s}=e;return s?(0,D.jsx)(u().sA,{defaultMessage:"People in {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccessV2",values:{teamName:s}}):(0,D.jsx)(u().sA,{defaultMessage:"People in a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hiddenV2"})}function Xs(e){let{membersCount:s,teamPermissionItem:i}=e;const{isMobile:t}=(0,n().Y0)(),o=(0,r().IS)((e=>({container:{display:"flex",alignItems:"center",gap:2}})),[]),a=s?(0,D.jsx)("div",{children:(0,D.jsx)(u().sA,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.memberCount.subtitle",values:{membersCount:s}})}):(0,D.jsxs)("div",{style:o.container,children:[(0,D.jsx)(qs().A,{style:{height:12,width:14,borderRadius:4,marginRight:2,marginLeft:2}}),(0,D.jsx)(u().sA,{defaultMessage:"people",id:"blockPermissionsSettings.teamPermission.subtitle.people",values:{membersCount:s}})]});return t?(0,D.jsxs)("div",{style:o.container,children:[a,i&&(0,D.jsxs)(D.Fragment,{children:[" · ",(0,D.jsx)(u().sA,{...(0,E().R)({type:i.type,role:i.role,table:"block",isRemovable:!1,isCurrentUser:!1}).label})]})]}):(0,D.jsxs)("div",{style:o.container,children:[(0,D.jsx)(u().sA,{defaultMessage:"Teamspace",id:"blockPermissionsSettings.teamPermission.subtitle.teamspace"})," · ",a]})}const Qs=function(e){let{store:s,blockTeamMemberPermission:a,blockTeamOwnerPermission:l,blockTeamGuestPermission:d,permissionItemArgs:c}=e;const p=(0,n().v3)(),h=p.device.isMobile,[b,f]=(0,t.useState)(!1),[v,y]=(0,t.useState)(!1),{permissionItem:x}=a,I=(0,o().O$)(j().AppStoreCurrentSpaceStore),P=(0,o().K8)((()=>{var e;return m().gl(x)?x.team_id:null===(e=rs().Uo(s))||void 0===e?void 0:e.id}),[x,s]),S=l.permissionItem.role,A=x.role,M={type:"display_only_overview_permission",role:S===A?A:"none"===A||"none"===S?"limited":"access"},{teamStore:C,teamIsDefined:T,teamName:N}=(0,o().K8)((()=>{if(!I||!P)return{undefined:void 0};const e=_().h4.createChildStore(I,{table:Ps().yK,id:P,spaceId:I.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[I,P]),B=(0,o().K8)((()=>{if(void 0!==C)return(0,Bs().PF)({teamStore:C,spaceId:null==I?void 0:I.id})}),[C,I]),{membersCount:R,totalMembersAndGuestsCount:L,ownersCount:O,teamGuestsCount:U}=void 0!==B?{membersCount:B.memberCount,totalMembersAndGuestsCount:B.memberCountWithGuests,ownersCount:B.ownerCount,teamGuestsCount:B.memberCountWithGuests-B.memberCount}:{membersCount:0,totalMembersAndGuestsCount:void 0,ownersCount:0,teamGuestsCount:0},W=(0,o().K8)((()=>{if(!I)return!1;return!I.getDisableTeamGuests()&&((null==C||!C.isDefault())&&(0,i(47373).Qd)())}),[I,C]),K=(0,t.useCallback)((()=>f(!0)),[]),G=(0,t.useCallback)((()=>f(!1)),[]),V=(0,t.useCallback)((()=>{const e=!1===v;if(y(!v),e){if(!C)return;g().lD(p,{share_menu_session_id:w().Ay.state.sessionId,type:"team",team_id:C.id})}}),[p,v,y,C]),F=(0,r().IS)((e=>({teamPermissionsContainer:{paddingLeft:16,display:v?"block":"none"},roleButton:{color:e.text.secondary,fontSize:(0,k().kx)({environment:p})},mobileTitleContainer:{display:"flex",alignItems:"center"},mobileTextContainer:{dislay:"block",overflow:"hidden"},mobileChevronIcon:{marginLeft:4,fill:e.icon.secondary,transform:`rotate(${v?90:0}deg)`,transition:"transform 150ms ease"}})),[v,p]);if(!C)return null;const z=T?(0,D.jsx)(Ee,{store:C}):(0,i(425736).s)(),H=(0,D.jsx)(Ys().A,{expanded:v,hovered:b,onClick:V,children:z});return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(xe().Ay,{store:s,permissionItem:M,from:a.from,onMouseEnter:K,onMouseLeave:G,icon:H,title:h?(0,D.jsxs)("div",{style:F.mobileTitleContainer,children:[(0,D.jsx)("div",{style:F.mobileTextContainer,children:(0,D.jsx)($s,{teamName:N})}),(0,D.jsx)("div",{style:F.mobileChevronIcon,children:(0,q().V)({height:12,width:12})})]}):(0,D.jsx)($s,{teamName:N}),subtitle:T&&(0,D.jsx)(Xs,{membersCount:L,teamPermissionItem:M}),nonInheritedTooltip:(0,D.jsx)(u().sA,{id:"TeamPermissionItem.access",defaultMessage:"People in the {inlineIconAndName} teamspace",values:{inlineIconAndName:(0,D.jsx)(ps().A,{store:C,useInvertedColors:!0})}}),upgradeButtonName:"team_permission_item",onClick:V,permissionRoleSelect:!v&&(0,D.jsx)(E().Y,{type:M.type,role:M.role,icon:Hs,disabled:!0,buttonStyle:F.roleButton,table:$e().ev,isCurrentUser:!1,from:"shareMenu"}),isCollapsible:!0,...c}),(0,D.jsxs)("div",{style:F.teamPermissionsContainer,children:[l&&(0,D.jsx)(zs,{store:s,permissionItemArgs:c,blockTeamOwnerPermission:l,teamOwnersCount:O,fromPermissionWrapper:"expandable_permission"}),a&&(0,D.jsx)(Es,{store:s,permissionItemArgs:c,blockTeamPermission:a,teamMembersCount:R,fromPermissionWrapper:"expandable_permission"}),W&&d&&(0,D.jsx)(Os,{store:s,permissionItemArgs:c,blockTeamGuestPermission:d,teamGuestsCount:U,fromPermissionWrapper:"expandable_permission"})]})]})};i(737550);var Js=()=>i(406533),Zs=()=>i(519831),ei=()=>i(147294),si=(i(944114),()=>i(743176)),ii=()=>i(922189);const ti={viewBox:"0 0 20 20",fittedViewBox:"1.59 1.59 16.81 16.81",svg:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("path",{d:"M10 5.875c.345 0 .625.28.625.625v2.875H13.5a.625.625 0 0 1 0 1.25h-2.875V13.5a.625.625 0 0 1-1.25 0v-2.875H6.5a.625.625 0 1 1 0-1.25h2.875V6.5c0-.345.28-.625.625-.625"}),(0,D.jsx)("path",{d:"M8.497 2.222c.83-.83 2.176-.83 3.006 0l6.275 6.275c.83.83.83 2.176 0 3.006l-6.275 6.275c-.83.83-2.176.83-3.006 0l-6.275-6.275a2.125 2.125 0 0 1 0-3.006zm2.122.884a.875.875 0 0 0-1.238 0L3.106 9.38a.875.875 0 0 0 0 1.238l6.275 6.275a.875.875 0 0 0 1.238 0l6.275-6.275a.875.875 0 0 0 0-1.238z"})]})},ni=(0,K().wt)("plusDiamond",ti);var oi=()=>i(204063),ri=()=>i(912913);function ai(e){let{store:s,collectionStore:i,calculatedPermissions:r,permissionItemArgs:a,disabled:l}=e;const m=(0,o().uB)(void 0,z().A),{isMobile:d}=(0,n().Y0)(),c=(0,t.useCallback)((e=>(0,D.jsx)(li,{buttonPopupEvents:e,disabled:l,collectionStore:i})),[l,i]);return i?(0,D.jsx)($().Ay,{popupType:d?$().z7.BottomSheet:$().z7.Popup,forceInitialInbound:!0,buttonPopupStore:m,renderOrigin:c,originGap:d?void 0:8,style:{},onClick:()=>{},render:e=>(0,D.jsx)(mi,{blockStore:s,collectionStore:i,onCreateRuleComplete:()=>e.close()}),onDismiss:()=>{},onClose:()=>{}}):null}function li(e){let{buttonPopupEvents:s,disabled:i,collectionStore:t}=e;const{isMobile:a}=(0,n().Y0)(),l=(0,r().IS)((e=>({button:{height:"unset",...a?{width:"100%",padding:"6px 0px"}:{padding:"6px 8px"}},textContainer:{display:"flex",flexDirection:"column",paddingLeft:a?12:10},buttonSubtitle:{color:e.text.tertiary},iconContainer:{background:e.tint.uiBlue},icon:{fill:e.icon.uiBluePrimary}})),[a]),m=(0,o().K8)((()=>t.getPropertyPermissionItems({filterOutInvalidItems:!0}).length>0),[t]);return(0,D.jsxs)(Y().p,{...s,style:l.button,disabled:i,disabledFeedback:i,children:[(0,D.jsx)(Ie().A,{type:"square",iconType:"function",iconFn:ni,containerStyle:l.iconContainer,iconStyle:l.icon,isMobile:a}),(0,D.jsxs)("div",{style:l.textContainer,children:[(0,D.jsx)("span",{children:(0,D.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionButton.title",defaultMessage:"Add a new rule"})}),!m&&!a&&(0,D.jsx)("span",{style:l.buttonSubtitle,children:(0,D.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionButton.subtitle",defaultMessage:"Ex. Anyone selected in Assignees should have edit access"})})]})]})}function mi(e){let{blockStore:s,collectionStore:i,onCreateRuleComplete:a}=e;const{isMobile:l}=(0,n().Y0)(),m=(0,n().v3)(),d=(0,I().X)("nds_default_property_noticon"),c=(0,o().K8)((()=>i.getSchema()),[i]),p=(0,o().K8)((()=>i.getPropertyPermissionItems({filterOutInvalidItems:!0})),[i]),g=(0,t.useMemo)((()=>c?Object.entries(c).filter((e=>{let[s,i]=e;return"person"===(null==i?void 0:i.type)})).map((e=>{let[s,i]=e;return s})):[]),[c]),h=(0,r().DP)(),f=l?36:28,v=(0,r().IS)((e=>({roleSelectButton:{display:"flex",justifyContent:"space-between",background:e.surface.wash,border:`1px solid ${e.text.quaternary}`,marginTop:12,marginBottom:10,height:f},createRuleButton:{width:"100%",height:f},noPropertiesAvailableMenuItem:{color:e.text.tertiary}})),[f]),[y,x]=t.useState("read_and_write"),[P,S]=t.useState(void 0),j=(0,t.useCallback)((()=>{if(!i||!P)return;const e=(0,_().G_)(i,i.pointer,"permissions");a(),us().createAndCommit({userAction:"AddNewPropertyPermissionPopup.onCreateRule",environment:m,canUndo:!0,perform:s=>{us().applyOperation({store:e,operation:{pointer:e.pointer,command:"setPermissionItem",path:e.path,args:{type:"collection_property_permission",property_info:P,role:y}},transaction:s})}})}),[i,m,P,y,a]),A=(0,t.useMemo)((()=>["editor","read_and_write","comment_only","reader"]),[]),M=(0,o().K8)((()=>{const e=p.some((e=>"page_creator"===e.property_info.type)),s=[];for(const i of g){if(p.some((e=>"person"===e.property_info.type&&e.property_info.property_id===i)))continue;const e=null==c?void 0:c[i];e&&s.push({key:i,action:()=>{S({type:"person",property_id:i})},render:s=>(0,D.jsx)(ee().A,{...s,title:e.name,icon:(0,D.jsx)(si().zB,{type:e.type,icon:e.icon,size:20,theme:h,style:{fill:h.icon.primary},isDefaultNoticonEnabled:d}),isChecked:"person"===(null==P?void 0:P.type)&&(null==P?void 0:P.property_id)===i,focused:s.focused,buttonStyle:{padding:0}})})}e||s.push({key:"page_creator",action:()=>{S({type:"page_creator"})},render:e=>(0,D.jsx)(ee().A,{...e,title:(0,D.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.pageCreator",defaultMessage:"Created by"}),icon:(0,ii().personCircleFillIcon)({width:20}),isChecked:"page_creator"===(null==P?void 0:P.type),focused:e.focused,buttonStyle:{padding:0}})}),0===s.length&&s.push({key:"no_available_properties",action:()=>{},render:e=>(0,D.jsx)(ee().A,{...e,style:v.noPropertiesAvailableMenuItem,disabled:!0,title:(0,D.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.noPropertiesMessage",defaultMessage:"No available properties"})})});return[{key:"title_section",items:[],render:e=>(0,D.jsx)(b().A,{...e,title:(0,D.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.title",defaultMessage:"For each page, grant access to people in…"}),desktopTitleStyle:{fontSize:14},style:{paddingBottom:0}})},{key:"options_section",items:s,render:e=>(0,D.jsx)(b().A,{...e,style:{paddingBottom:8}})},{key:"buttons_section",items:[{key:"roleSelectButton",action:()=>{},render:e=>(0,D.jsx)(ri().Ay,{table:"collection",type:"collection_property_permission",role:y,upgradeButtonName:"collection_property_permissions",onChange:e=>{x(e)},buttonStyle:v.roleSelectButton,availableRoleItems:A.map((e=>({role:e})))})},{key:"createRuleButton",action:()=>{},render:()=>(0,D.jsx)(oi().A,{disabled:!P,style:v.createRuleButton,onClick:j,children:(0,D.jsx)(u().sA,{id:"shareTab.collectionPropertyPermissions.addNewPropertyPermissionPopup.createButton",defaultMessage:"Create rule"})})}],render:e=>(0,D.jsx)(b().A,{...e,topBorder:!0,topBorderExtendToEdge:!0,style:{paddingTop:0}})}]}),[A,c,p,d,j,g,P,y,v.createRuleButton,v.noPropertiesAvailableMenuItem,v.roleSelectButton,h]);return(0,D.jsx)(se().A,{menuType:te().gu.Popup,maxWidth:l?"100%":void 0,width:l?"100%":320,children:(0,D.jsx)("div",{style:{padding:l?8:6},children:(0,D.jsx)(ie().Ay,{type:ie().Oh.Vertical,initialFocus:void 0,sections:M})})})}const di={viewBox:"0 0 20 20",fittedViewBox:"1.59 1.59 16.81 16.81",svg:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("path",{d:"M9.834 13.113a.675.675 0 1 1 0 1.35.675.675 0 0 1 0-1.35m.142-6.874c1.408 0 2.792.934 2.792 2.361 0 .84-.509 1.527-1.176 1.933l-.769.524.001.001a.9.9 0 0 0-.406.723.625.625 0 0 1-1.25 0c0-.706.368-1.352.945-1.751l.003-.002.799-.546.027-.018c.394-.24.576-.566.576-.864 0-.493-.552-1.111-1.542-1.111-.84 0-1.401.477-1.513.925A.625.625 0 0 1 7.25 8.11c.287-1.15 1.478-1.872 2.726-1.872"}),(0,D.jsx)("path",{d:"M8.498 2.221c.83-.83 2.175-.83 3.005 0l6.275 6.277c.83.83.83 2.175 0 3.005l-6.275 6.275c-.83.83-2.175.83-3.005 0L2.22 11.503a2.125 2.125 0 0 1 0-3.005zm2.12.885a.875.875 0 0 0-1.236 0L3.106 9.381a.875.875 0 0 0 0 1.238l6.276 6.275a.875.875 0 0 0 1.237 0l6.275-6.275a.875.875 0 0 0 0-1.238z"})]})},ci=(0,K().wt)("questionDiamond",di);function ui(e){const{collectionStore:s,disabled:i}=e,t=(0,o().K8)((()=>s.getPropertyPermissionItems({filterOutInvalidItems:!1})),[s]);return 0===t.length?null:(0,D.jsx)(D.Fragment,{children:t.map(((e,t)=>(0,D.jsx)(pi,{collectionStore:s,permissionItem:e,disabled:i},t)))})}function pi(e){let{collectionStore:s,permissionItem:i,disabled:a}=e;const l=(0,n().v3)().device.isMobile,m=(0,o().K8)((()=>s.getSchema()),[s]),d=(0,I().X)("nds_default_property_noticon"),c=(0,r().IS)((e=>({errorText:{color:e.text.orangeSecondary},errorStateIcon:{fill:e.icon.orangeSecondary},errorStateIconContainer:{background:e.fill.orangeSecondary}})),[]),p=i.property_info.type,g=(0,o().K8)((()=>{if("person"===p){const e=i.property_info.property_id,s=m[e];return s?"person"!==s.type?"incorrect_property_type":void 0:"property_not_found"}}),[p,m,i]),h=(0,r().DP)(),b=l?26:18,f=(0,o().K8)((()=>{switch(p){case"page_creator":return(0,D.jsx)(Ie().A,{type:"square",iconType:"function",iconFn:ii().personCircleFillIcon,isMobile:l,iconStyle:{width:b,height:b}});case"person":const e=i.property_info.property_id,s=m[e];return"property_not_found"===g?(0,D.jsx)(Ie().A,{type:"square",iconType:"function",iconFn:ii().personCircleFillIcon,isMobile:l,iconStyle:c.errorStateIcon,containerStyle:c.errorStateIconContainer}):"incorrect_property_type"===g?(0,D.jsx)(Ie().A,{type:"square",iconType:"function",iconFn:ci,isMobile:l,iconStyle:c.errorStateIcon,containerStyle:c.errorStateIconContainer}):s?(0,D.jsx)(Ie().A,{type:"square",iconType:"element",element:(0,D.jsx)(si().zB,{type:s.type,icon:s.icon,size:b,theme:h,isDefaultNoticonEnabled:d}),iconSize:l?xe().Bj:xe().Ev}):null}}),[p,d,l,c.errorStateIconContainer,c.errorStateIcon,i.property_info,m,g,h,b]),v=(0,t.useMemo)((()=>{switch(p){case"page_creator":return(0,D.jsx)(u().sA,{defaultMessage:"Page creator",id:"propertyPermissions.pageCreator.label"});case"person":const e=i.property_info.property_id,s=null==m?void 0:m[e];return"property_not_found"===g?(0,D.jsx)("div",{style:c.errorText,children:(0,D.jsx)(u().sA,{defaultMessage:"Missing property",id:"propertyPermissionItem.person.missingProperty.label"})}):"incorrect_property_type"===g?(0,D.jsx)("div",{style:c.errorText,children:(0,D.jsx)(u().sA,{defaultMessage:"Incorrect property type",id:"propertyPermissionItem.person.incorrectPropertyType.label"})}):(0,D.jsx)(u().sA,{defaultMessage:"Anyone in {propertyName}",id:"propertyPermissions.personProperty.label",values:{propertyName:(null==s?void 0:s.name)??""}});default:(0,J().HB)(p)}}),[p,i,m,g,c.errorText]),y=(0,t.useMemo)((()=>{if(!l)return null;const e=(0,E().R)({type:i.type,role:i.role,table:"block",isRemovable:!1,isCurrentUser:!1}).label;return(0,D.jsx)(L().A,{isSmall:!0,children:(0,D.jsx)(u().sA,{...e})})}),[l,i]);return(0,D.jsx)(xe().Ay,{store:s,permissionItem:i,from:{table:Zs().Vl,collectionId:s.id},icon:f,title:v,subtitle:y,upgradeButtonName:"collection_property_permissions",isRemovableOverride:!0,shouldDisable:a})}function gi(e){let{blockStore:s,calculatedPermissions:i,permissionItemArgs:t}=e;const n=(0,o().K8)((()=>{const e=s.getParentStore(),i=s.getCollectionStoreIfSingleSource();return(null==e?void 0:e.table)===Zs().Vl?{renderMode:"page_in_collection",collectionStore:e}:i?{renderMode:"collection",collectionStore:i}:void 0}),[s]),a=(0,u().tz)(),l=(0,o().K8)((()=>{var e;return null==n||null===(e=n.collectionStore)||void 0===e?void 0:e.canAdmin()}),[n]),d=(0,o().K8)((()=>"collection"!==(null==n?void 0:n.renderMode)||!l),[l,null==n?void 0:n.renderMode]),c=(0,o().K8)((()=>((null==n?void 0:n.collectionStore.getPropertyPermissionItems({filterOutInvalidItems:!0}))||[]).length>0),[n]),p=(0,o().K8)((()=>{var e;return null==n||null===(e=n.collectionStore)||void 0===e?void 0:e.isPageTreeCollection()}),[n]),g=(0,r().IS)((e=>({helpIcon:{width:16,height:16,color:e.icon.tertiary}})),[]),h=(0,o().K8)((()=>s.getPermissionItems().some(m().T6)),[s]);return!(null!=n&&n.collectionStore)||p||!c&&"page_in_collection"===(null==n?void 0:n.renderMode)||h&&"page_in_collection"===(null==n?void 0:n.renderMode)?null:(0,D.jsxs)(b().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{paddingLeft:8,paddingRight:8,paddingBottom:8},mobileStyle:{paddingTop:8,paddingLeft:Ii,paddingRight:Ii,paddingBottom:8},children:[(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,D.jsx)("span",{style:{paddingTop:2},children:(0,D.jsx)(Qe().E3,{})}),(0,D.jsx)(Ss().A,{icon:()=>(0,Js().questionMarkCircleIcon)(g.helpIcon),onClick:()=>{},ariaLabel:a.formatMessage({id:"collectionPropertyPermissionsSection.help",defaultMessage:"Help"})}),"collection"===(null==n?void 0:n.renderMode)&&(0,D.jsx)(ei().Ee,{newBadgeKey:"collection_property_permissions",didUserEngage:!1,keyType:"date"})]}),(0,D.jsx)(ui,{collectionStore:n.collectionStore,disabled:d}),"collection"===(null==n?void 0:n.renderMode)&&(0,D.jsx)(ai,{store:s,collectionStore:n.collectionStore,calculatedPermissions:i,permissionItemArgs:t,disabled:d})]})}function hi(e){const{store:s,isExpanded:i,numberOfPeopleInvited:a,inheritedPermissionRole:l,permissionItemArgs:m,onToggle:d}=e,c=(0,n().v3)(),p=c.device.isMobile,g=(0,o().K8)((()=>(0,rs().fU)(s)[1]),[s]),[h,b]=t.useState(!1),f=(0,o().K8)((()=>{const e=(0,rs().fU)(s)[1];if(e instanceof _().h4)return{icon:(0,D.jsx)(pe().x,{disabled:!0,store:e,size:p?xe().Bj:xe().Ev}),title:e.getName()};if(e instanceof _().Bv){if("page"===e.getType()){const s=e.isEmptyPage();return{icon:(0,D.jsx)(ts().B6,{disabled:!0,icon:e.getIcon(),size:20,isEmptyPage:s,iconRecordCategory:(0,ts().Te)(e)}),title:(0,D.jsx)(ns().A,{shouldWrap:!0,store:e}),fromTable:$e().ev,fromId:e.id}}return"collection_view"===e.getType()||"collection_view_page"===e.getType()?{icon:(0,D.jsx)(ts().B6,{disabled:!0,icon:e.getIcon(),size:20,isEmptyPage:e.isDefined(),iconRecordCategory:(0,ts().Te)(e)}),title:(0,D.jsx)(ns().A,{shouldWrap:!0,store:e}),fromTable:$e().ev,fromId:e.id}:void 0}}),[s,p]),v=(0,t.useCallback)((()=>b(!0)),[]),y=(0,t.useCallback)((()=>b(!1)),[]),x=(0,r().IS)((e=>({mobileTitleContainer:{display:"flex",alignItems:"center"},mobileTextContainer:{dislay:"block",overflow:"hidden"},mobileChevronIcon:{marginLeft:4,fill:e.icon.secondary,transform:`rotate(${i?90:0}deg)`,transition:"transform 150ms ease"},roleButton:{color:e.text.secondary,fontSize:(0,k().kx)({environment:c})},selectContainer:{opacity:i?0:1},loadingSubtitleContainer:{display:"flex",alignItems:"center"},placeholderSubtitle:{height:12,width:14,borderRadius:4,marginRight:2}})),[c,i]),I={type:"display_only_inherited_permission",role:l??"access"};return f?(0,D.jsx)(xe().Ay,{icon:f.icon&&(0,D.jsx)(Ys().A,{onClick:d,expanded:i,hovered:h,children:(0,D.jsx)(Ie().A,{type:"circle",iconType:"element",element:f.icon,isMobile:p})}),store:s,permissionItem:I,onMouseEnter:v,onMouseLeave:y,from:{table:$e().ev,blockId:f.fromId?f.fromId:s.id},title:p?(0,D.jsxs)("div",{style:x.mobileTitleContainer,children:[(0,D.jsx)("div",{style:x.mobileTextContainer,children:(0,D.jsx)(u().sA,{id:"permissionsListV2.inheritedPermissions",defaultMessage:"People invited to {title}",values:{title:f.title}})}),(0,D.jsx)("div",{style:x.mobileChevronIcon,children:(0,q().V)({height:12,width:12})})]}):(0,D.jsx)(u().sA,{id:"permissionsListV2.inheritedPermissions",defaultMessage:"People invited to {title}",values:{title:f.title}}),subtitle:a?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(u().sA,{id:"inheritedPermissionItem.numberOfPeopleInvited",defaultMessage:"{numberOfPeopleInvited, plural, one {{numberOfPeopleInvited} person} other {{numberOfPeopleInvited} people}}",values:{numberOfPeopleInvited:a}}),p&&(0,D.jsxs)(D.Fragment,{children:[" · ",(0,D.jsx)(u().sA,{...(0,E().R)({type:I.type,role:I.role,table:"block",isRemovable:!1,isCurrentUser:!1}).label})]})]}):(0,D.jsxs)("div",{style:x.loadingSubtitleContainer,children:[(0,D.jsx)(qs().A,{style:x.placeholderSubtitle}),(0,D.jsx)(u().sA,{id:"inheritedPermissionItem.subtitle.people",defaultMessage:"people",values:{numberOfPeopleInvited:a}}),p&&(0,D.jsxs)(D.Fragment,{children:[" · ",(0,D.jsx)(u().sA,{...(0,E().R)({type:I.type,role:I.role,table:"block",isRemovable:!1,isCurrentUser:!1}).label})]})]}),inheritedTooltip:a&&a>0?(0,D.jsx)(u().sA,{id:"inheritedPermissionItem.numberOfPeopleInvited.tooltip",defaultMessage:"{numberOfPeopleInvited, plural, one {{numberOfPeopleInvited} person has } other {{numberOfPeopleInvited} people have}} access through the parent page {inlineIconAndName}",values:{numberOfPeopleInvited:a,inlineIconAndName:(0,D.jsx)(ps().A,{store:g,useInvertedColors:!0})}}):null,upgradeButtonName:"team_permission_item",onClick:d,permissionRoleSelect:(0,D.jsx)("div",{style:x.selectContainer,children:(0,D.jsx)(E().Y,{type:I.type,role:I.role,icon:Hs,disabled:!0,buttonStyle:x.roleButton,table:$e().ev,isCurrentUser:!1,from:"shareMenu"})}),isCollapsible:!0,style:e.style,...m}):null}const bi=t.memo(hi);var fi=()=>i(801191),vi=()=>i(852507);const yi=(0,u().YK)({commenter:{id:"permissionsLevelBanner.commenter.labelV2",defaultMessage:"You can only comment on this page"},reader:{id:"permissionsLevelBanner.reader.labelV2",defaultMessage:"You can only view this page"}});function xi(e){let{store:s}=e;const i=(0,n().v3)(),{isMobile:a}=(0,n().Y0)(),l=(0,o().K8)((()=>s.getRole()),[s]),[m,d]=(0,t.useState)("noRequest"),c=(0,I().X)("share_menu_inheritance_banner");(0,vi().l)((()=>{g().VJ(i,{share_menu_session_id:w().Ay.state.sessionId,role:l})}));const p=(0,r().IS)((e=>({container:{...(0,k().kJ)({theme:e,isMobile:a}),display:"flex",alignItems:"center",justifyContent:"space-between"},bannerBodyContainer:{display:"flex",alignItems:"center"},bannerLabel:{display:"flex"},pendingAccessRequestLabel:{color:e.text.tertiary},accessRequestLabel:{color:e.text.uiBluePrimary},accessRequestButton:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:Z().Wy.medium,flexShrink:0,borderRadius:4,paddingLeft:6,paddingRight:6,margin:-4,height:24}})),[a]),b=(0,t.useCallback)((async()=>{var e;if("reader"!==l&&"comment_only"!==l)return;const t=await h().callApi({eventName:"requestAccess",environment:i,data:{type:"current-actor-to-block",block:{id:s.id,spaceId:s.getSpaceId()},attributes:{origin_type:"share_menu",add_permissions_on_approval:!1,role:"read_and_write",existing_permissions:l},message:void 0}});"success"===t.type&&t.data.request?(d("requested"),g().T_(i,{request_access_type:"page",previous_access_level:l,requested_access_level:"read_and_write",requestId:t.data.requestId})):"failed"===t.type&&"UserRateLimitResponse"===(null===(e=t.body)||void 0===e?void 0:e.name)&&d("rateLimited")}),[i,l,s]),f=l?function(e){switch(e){case"comment_only":return yi.commenter;case"reader":return yi.reader;case"editor":case"read_and_write":case"none":case"membership_admin":case"content_only_editor":return null;default:(0,J().HB)(e)}}(l):void 0;return f?(0,D.jsxs)("div",{style:p.container,children:[(0,D.jsx)("div",{style:p.bannerBodyContainer,children:(0,D.jsx)(L().A,{style:p.bannerLabel,isMultiline:!0,isSmall:c,children:(0,D.jsx)(u().sA,{...f})})}),(0,D.jsx)(Y().p,{isBlue:!0,style:p.accessRequestButton,onClick:b,disabled:"noRequest"!==m,children:(0,D.jsx)(L().A,{isSmall:c,style:"noRequest"===m?p.accessRequestLabel:p.pendingAccessRequestLabel,children:"requested"===m?(0,D.jsx)(u().sA,{defaultMessage:"Requested edit access",id:"permissionsLevelBanner.requestPermission.accessRequestedV2"}):"rateLimited"===m?(0,D.jsx)(u().sA,{defaultMessage:"Try again later",id:"permissionsLevelBanner.requestPermission.rateLimited"}):(0,D.jsx)(u().sA,{defaultMessage:"Request edit access",id:"permissionsLevelBanner.requestPermission.requestEdit"})})})]}):null}const Ii=20;function Pi(e){let{dividerType:s,scrollerStore:i}=e;const n=(0,o().K8)((()=>(null==i?void 0:i.state.elementRef)??{current:null}),[i]),a=(0,x().CR)(n),l=(0,x().yE)(n),m=(0,x().o7)(n),d=(0,t.useMemo)((()=>{if("top"===s)return l>0;return Math.ceil(l+m+10)<Math.floor(a)}),[s,m,a,l]),c=(0,r().IS)((e=>({divider:{opacity:d?1:0,height:1,borderTop:`1px solid ${e.regularDividerColor}`,padding:"0px 16px",transition:"opacity 200ms",margin:"0px 16px"}})),[d]);return(0,D.jsx)("div",{style:c.divider})}function Si(e){let{store:s,calculatedPermissions:i,permissionItemArgs:t}=e;const{showTeamPermission:n,mostPermissiveAncestorTeamGuestItem:o,mostPermissiveAncestorTeamMemberItem:r,mostPermissiveAncestorTeamOwnerItem:a,pagePermissionUIModel:l}=i;return(0,D.jsxs)(D.Fragment,{children:[n&&a&&r&&(0,D.jsx)(Qs,{store:s,blockTeamOwnerPermission:a,blockTeamMemberPermission:r,blockTeamGuestPermission:o,permissionItemArgs:t}),Mi({store:s,mostPermissiveTeamPermissions:l.mostPermissiveTeamPermissions,permissionItemArgs:t})]})}function ji(e){const{store:s,permissionItemArgs:i,inheritedPagePermissions:o,hasInaccessiblePermissions:l}=e,m=(0,n().v3)(),[d,c]=t.useState(!1),{mostPermissiveGroupPermissions:u,mostPermissiveUserPermissions:p}=o,b=function(e){var s,i;const{mostPermissiveGroupPermissions:t,mostPermissiveUserPermissions:n}=e;let o="access";const r=(null===(s=n[0])||void 0===s?void 0:s.permissionItem.role)||(null===(i=t[0])||void 0===i?void 0:i.permissionItem.role)||"access",a=!(n.length>0)||n.every((e=>e.permissionItem.role===r)),l=!(t.length>0)||t.every((e=>e.permissionItem.role===r));a&&l&&(o=r);return o}(o),[{value:f}]=(0,a().Yb)((async()=>{const e=j().default.state.currentSpaceStore;return e?await async function(e){let{environment:s,mostPermissiveUserPermissions:i,mostPermissiveGroupPermissions:t,spaceStore:n}=e;const o=new Set;for(const{permissionItem:a}of i)o.add(a.user_id);const r=new Set;for(const{permissionItem:a}of t)r.add(a.group_id);if(r.size>0){const e=await h().callApi({eventName:"getSpacePermissionGroupMembers",environment:s,data:{groupIds:Array.from(r),spaceId:n.id}});if("success"===e.type)for(const[,{userIds:s}]of Object.entries(e.data.groupUsersMap)){const e=s.filter((e=>{var s;return null===(s=(0,P().sE)(n,e))||void 0===s?void 0:s.isMember()}));for(const s of e)o.add(s)}}return o.size}({environment:m,mostPermissiveUserPermissions:p,mostPermissiveGroupPermissions:u,spaceStore:e}):0}),[m,u,p]),v=ki(o),y=(0,r().IS)((()=>({inheritedPagePermissionsContainer:v?{paddingLeft:k().zr}:{}})),[v]);return(0,D.jsxs)(D.Fragment,{children:[v&&(0,D.jsx)(bi,{store:s,isExpanded:d,onToggle:()=>{c((e=>!e)),g().lD(m,{share_menu_session_id:w().Ay.state.sessionId,type:"inherited_page"})},numberOfPeopleInvited:f??0,inheritedPermissionRole:b,permissionItemArgs:i,style:e.style}),d&&(0,D.jsx)("div",{style:y.inheritedPagePermissionsContainer,children:(0,D.jsx)(_i,{store:s,pagePermissions:o,numberPermissionsAlreadyRendered:0,permissionItemArgs:i,forceExpanded:!0,hasInaccessiblePermissions:l,isInherited:!0})})]})}function Ai(e){let{store:s,calculatedPermissions:i,permissionItemArgs:t}=e;const{showSpacePermission:n,mostPermissiveTrustedDomainItem:o,mostPermissiveSpaceItem:r,mostPermissivePublicItem:a,showSitePublicPermission:l,showPublicShareLinkPermission:m,showRestrictedPermissionBanner:d}=i;return(0,D.jsxs)(b().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{paddingTop:12,paddingLeft:8,paddingRight:8,paddingBottom:8},children:[(0,D.jsx)(Qe().nc,{}),(0,D.jsx)(qe,{store:s,spacePermission:r,showSpacePermission:n,publicPermission:a,showSitePublicPermission:l,showPublicShareLinkPermission:m,trustedDomainPermission:o,permissionItemArgs:t,fromPermissionWrapper:"permission_list",isRestricted:d})]})}function _i(e){const s=(0,u().tz)(),i=(0,o().K8)((()=>{const e=j().default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),t=(0,n().v3)(),r=t.currentUser.id,{store:m,pagePermissions:g,numberPermissionsAlreadyRendered:b,permissionItemArgs:f,forceExpanded:x,isInherited:I,hasInaccessiblePermissions:P}=e,{showUserPermissions:S,mostPermissiveGroupPermissions:M,mostPermissiveUserPermissions:k}=g,w=(0,C().x)(),[{value:B}]=(0,a().Yb)((async()=>{const e=await h().callApi({eventName:"getSpacePermissionGroupIdsContainingMembers",environment:t,data:{spaceId:i,userIds:k.map((e=>e.permissionItem.user_id))},headers:(0,l().WS)({cellId:void 0,spaceId:i})});return"success"===e.type?e.data.userToGroupMap:{}}),[t,i,k],{debugName:"userToPermissionGroupIds",debounce:300,throttle:1e3}),R=(0,o().K8)((()=>{const e=S?function(e){const{mostPermissiveUserPermissions:s,spaceVisibleUserMap:i,userToPermissionGroupIds:t,hasInaccessiblePermissions:n,currentUserId:o}=e,r={};return s.forEach((s=>{const a=(0,v().ex)({userId:s.permissionItem.user_id,store:e.store,userPermissionGroupIds:new Set((null==t?void 0:t[s.permissionItem.user_id])??[])}),l=_().LU.createChildStore(e.store,{table:d().oo,id:s.permissionItem.user_id}),m=l.getModel();let p;l.isReady()&&m&&(p=(0,c().c6)(e.intl,m));const g=o&&s.permissionItem.user_id===o;r[s.permissionItem.user_id]=(0,D.jsx)(N().A,{store:e.store,userPermission:s,selectFooter:(0,D.jsx)(fi().n,{targetName:p,targetType:"user",mostPermissivePermissions:a,hasInaccessiblePermissions:n,isCurrentUser:Boolean(g)}),tooltip:n&&"editor"!==s.permissionItem.role?(0,D.jsx)(u().sA,{defaultMessage:"This user may have higher permission access through a parent page or teamspace that you don’t have access to",id:"blockPermissionsSettings.maybeHigherUserPermission.tooltip"}):void 0,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:i,fromPermissionWrapper:"permission_list"},s.permissionItem.user_id)})),r}({store:m,mostPermissiveUserPermissions:k,permissionItemArgs:f,spaceVisibleUserMap:w,userToPermissionGroupIds:B??{},intl:s,hasInaccessiblePermissions:P,currentUserId:r}):{};return p().oE(Object.keys(e).map((i=>{const t=_().LU.createChildStore(m,{table:d().oo,id:i}),n=t.getModel();if(t.isReady()&&n)return{title:(0,c().c6)(s,n),isSelfPermission:Boolean(r)&&t.id===r,permissionItem:e[i]}})))}),[S,m,k,f,w,s,r,B,P]),L=(0,o().K8)((()=>{const e=i?function(e){const{spaceId:s,mostPermissiveGroupPermissions:i,isInherited:t}=e,n={},o=new Set(A().A.state.permissionGroupsAndMemberCounts.map((e=>e.group.group_id)));return i.forEach((i=>{const r=i.permissionItem.group_id;o.has(r)&&(n[r]=(0,D.jsx)(T().A,{store:e.store,groupPermission:i,spaceId:s,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list",disableExpansion:t,tooltip:e.hasInaccessiblePermissions&&"editor"!==i.permissionItem.role?(0,D.jsx)(u().sA,{defaultMessage:"Some users in this group may have higher permission access through a parent page or teamspace that you don’t have access to",id:"blockPermissionsSettings.maybeHigherGroupPermission.tooltip"}):void 0}))})),n}({store:m,spaceId:i,mostPermissiveGroupPermissions:M,permissionItemArgs:f,hasInaccessiblePermissions:P,isInherited:I}):{};return Object.keys(e).map((i=>{const t=A().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===i));return{title:t?(0,y().Pf)({intl:s,groupName:t.group.name}):"",isSelfPermission:!1,permissionItem:e[i]}}))}),[P,s,I,M,f,i,m]);R.sort(((e,s)=>e.isSelfPermission?-1:s.isSelfPermission?1:e.title.localeCompare(s.title))),L.sort(((e,s)=>e.title.localeCompare(s.title)));const U=[...R,...L].map((e=>{let{permissionItem:s}=e;return s})),W=U.length;if(0===W)return null;const K=Math.max(4,7-b);return!x&&W>K?(0,D.jsxs)(D.Fragment,{children:[U.slice(0,2),(0,D.jsx)(O,{permissions:U.slice(2)})]}):(0,D.jsx)(D.Fragment,{children:U})}function Mi(e){const{store:s,mostPermissiveTeamPermissions:i,permissionItemArgs:t}=e;return i.map((e=>m().nl(e.permissionItem)?(0,D.jsx)(zs,{store:s,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):m().un(e.permissionItem)?(0,D.jsx)(Os,{store:s,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,D.jsx)(Es,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:t,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}function ki(e){return e.mostPermissiveUserPermissions.length>0||e.mostPermissiveGroupPermissions.length>0}const Ci=function(e){const s=(0,n().v3)(),{device:a}=s,l=a.isMobile,{store:m,permissionItemArgs:d,calculatedPermissions:c,showPermissionInheritanceBanner:u}=e,{sudoModeStore:p}=d,h=(0,o().uB)(void 0,i(17090).A),{pagePermissionUIModel:v,showRestrictedPermissionBanner:y,showSpacePermission:x,showSitePublicPermission:P,showTeamPermission:j}=c,{inheritedPermissions:A,pagePermissions:_}=(0,M().kT)({store:m,pagePermissionUIModel:v,currentUserId:s.currentUser.id}),k=ki(_),C=ki(A),w=(0,o().K8)((()=>!(0,M().Aj)({store:m})),[m]),T=a.isMobile?S().A.None:S().A.Y,N=(0,r().IS)((()=>({scroller:{paddingLeft:l?Ii:0,paddingRight:l?Ii:0}})),[l]);(0,t.useEffect)((()=>{g().Fn({environment:s,calculatedPermissions:c})}),[]);const B=Number(x)+Number(P),R=(0,o().K8)((()=>(0,i(311337).y)(s)),[s]),L=B+Number(j)+Number(C),O=(0,o().K8)((()=>e.showFooter??!f().A.isMobile??!0),[e.showFooter]),U=(0,I().X)("collection_property_permissions"),W=(0,o().K8)((()=>m.getSpaceId()),[m]),K=(0,i(329304).P9)({name:"block_read_and_write_role",spaceId:W,userId:s.currentUser.id}),E=(0,o().K8)((()=>K&&void 0!==m.getRole()&&m.canRead()&&!m.canEdit()&&(0,i(90023).jH)(m.getSystemBlockTypeStore().getValue())),[K,m]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Pi,{dividerType:"top",scrollerStore:h}),(0,D.jsxs)(i(2143).H,{type:T,style:N.scroller,store:h,children:[E?(0,D.jsx)(xi,{store:m}):(0,D.jsx)(Ts,{store:m,showRestrictedPermissionBanner:y,showPermissionInheritanceBanner:u,sudoModeStore:p}),!R&&(0,D.jsxs)(b().A,{disableMobilePadding:!0,disableMobileBorders:!0,style:{padding:"0px 8px"},children:[k&&(0,D.jsx)(_i,{store:m,pagePermissions:_,numberPermissionsAlreadyRendered:L,permissionItemArgs:d,forceExpanded:!(C||c.showTeamPermission),hasInaccessiblePermissions:w}),C&&(0,D.jsx)(ji,{store:m,inheritedPagePermissions:A,permissionItemArgs:d,hasInaccessiblePermissions:w}),(0,D.jsx)(Si,{store:m,calculatedPermissions:c,permissionItemArgs:d}),w&&(0,D.jsx)(Xe,{store:m})]})]}),(0,D.jsx)(Pi,{dividerType:"bottom",scrollerStore:h}),B>0&&!f().A.isMobile&&(0,D.jsx)(Ai,{store:m,calculatedPermissions:c,permissionItemArgs:d}),U&&(0,D.jsx)(gi,{blockStore:m,calculatedPermissions:c,permissionItemArgs:d}),O&&(0,D.jsx)(i(901273).A,{store:m,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:c,permissionItemArgs:d})]})}},619338:(e,s,i)=>{i.d(s,{p:()=>o});var t=()=>i(468006),n=()=>i(108944);function o(e){const{spaceVisibleUserMap:s,store:i,userId:o}=e,r=s.get(o);if(!r||"none"!==r.role)return;if(!r.isTeamGuest)return"guest";const a=n().Uo(i),l=null==a?void 0:a.getModel();if(!l)return"guest";return(0,t().CG)({team:l,userId:o})?"team_level_guest":"guest"}},629027:(e,s,i)=>{i.d(s,{P:()=>o});var t=()=>i(56366),n=()=>i(928153);function o(e){let{store:s}=e;return(0,t().K8)((()=>(0,n().C)({store:s})),[s])}},653953:(e,s,i)=>{i.d(s,{X:()=>l});var t=()=>i(484714),n=()=>i(56366),o=()=>i(959013),r=()=>i(640653),a=()=>i(765957);function l(){const e=(0,t().v3)(),s=(0,o().tz)();return(0,n().K8)((()=>{const{currentSpaceStore:i}=a().default.state;return i?(0,r().GK)(e,i):s.formatMessage({defaultMessage:"Untitled workspace",id:"spaceHelpers.getSpaceName.untitledWorkspace.name"})}),[e,s])}},678634:(e,s,i)=>{i.d(s,{_:()=>h});i(898992),i(672577);var t=i(296540),n=()=>i(484714),o=()=>i(56366),r=()=>i(519831),a=()=>i(854150),l=()=>i(959013),m=()=>i(534177),d=()=>i(511303),c=()=>i(765957),u=()=>i(605402),p=()=>i(630116),g=i(474848);function h(e){let{permissionItem:s,from:i}=e;const h=(0,n().v3)(),{organizationOwnerRecordCache:b}=(0,t.useContext)(d().N),f=(0,o().O$)(c().AppStoreCurrentSpaceStore),v=(0,o().K8)((()=>null==f?void 0:f.getName()),[f]),y=(0,o().K8)((()=>{var e;if("group_permission"!==s.type)return;const i=s.group_id;return null===(e=u().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===i)))||void 0===e?void 0:e.group.name}),[s]),x=(0,o().K8)((()=>{if("explicit_team_permission"!==s.type&&"explicit_team_owner_permission"!==s.type)return;const e=s.team_id;return new(p().h4)(h,{id:e,table:a().yK},{inMemoryRecordCache:b}).getName()}),[s,h,b]),I=(0,o().K8)((()=>{if("collection_property_permission"!==s.type||(null==i?void 0:i.table)!==r().Vl)return;const e=i.collectionId;return new(p().md)(h,{id:e,table:r().Vl}).getName()}),[h,i,s.type]);switch(s.type){case"space_permission":return f?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.spacePermission",defaultMessage:"{name} workspace",values:{name:v}}):null;case"space_owner_permission":case"user_permission":case"bot_permission":case"exclusive_user_permission":case"public_permission":case"deleted_permission":case"restricted_permission":case"trusted_domain_permission":return null;case"explicit_team_permission":case"team_permission":return(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.teamPermission",defaultMessage:"{name} teamspace",values:{name:x}});case"team_owner_permission":case"explicit_team_owner_permission":return(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.teamOwnersPermission",defaultMessage:"{name} teamspace",values:{name:x}});case"explicit_team_guest_permission":return(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.teamGuestsPermission",defaultMessage:"Team guests"});case"group_permission":return y?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.groupPermission",defaultMessage:"{groupName} group",values:{groupName:y}}):(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.groupPermissionWithoutName",defaultMessage:"Group"});case"collection_property_permission":return I?(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.collectionPropertyPermission",defaultMessage:"permission rule on the {collectionName} database",values:{collectionName:I}}):(0,g.jsx)(l().sA,{id:"searchTargetPermissionItem.collectionPropertyPermissionWithoutName",defaultMessage:"permission rule on a database"});default:return(0,m().ub)(s),null}}},726360:(e,s,i)=>{i.d(s,{H:()=>o,U:()=>n});var t=i(296540);const n=(0,t.createContext)(new(i(545340).A));function o(){return(0,t.useContext)(n)}n.displayName="TrustedDomainsContext"},801191:(e,s,i)=>{i.d(s,{n:()=>p});i(898992),i(354520),i(296540);var t=()=>i(401497),n=()=>i(433847),o=()=>i(68263),r=()=>i(959013),a=()=>i(802790),l=()=>i(125565),m=()=>i(972435),d=()=>i(678634),c=i(474848);const u={none:m().A.formatMessage(n().Sf.noAccessDescription),reader:m().A.formatMessage(n().Sf.canReadDescription),comment_only:m().A.formatMessage(n().Sf.canCommentDescription),content_only_editor:m().A.formatMessage(n().Sf.canEditContentDescription),read_and_write:m().A.formatMessage(n().Sf.canEditDescription),membership_admin:m().A.formatMessage(n().Sf.membershipAdminDescription),editor:m().A.formatMessage(n().Sf.fullAccessDescription)};function p(e){let{targetType:s,targetName:i,mostPermissivePermissions:p,hasInaccessiblePermissions:g,isCurrentUser:h}=e;const b=(0,t().IS)((e=>({divider:{color:`${e.regularDividerColor}`},label:{marginLeft:12,marginRight:12,paddingTop:8,paddingBottom:8}})),[]);let f=function(e){var s;let{targetType:i,targetName:t,mostPermissivePermissions:a}=e;const l=null==a||null===(s=a.filter((e=>"user"===i?(0,n().bn)(e)||(0,o().tb)(e.permissionItem):(0,n().bn)(e))))||void 0===s?void 0:s[0];if(!l)return null;const p=(0,o().PW)(l.permissionItem.role)?l.permissionItem:void 0,g=(0,o().PW)(l.permissionItem.role)?l.from:void 0;if(!p||!p.role||"string"!=typeof p.role||"none"===p.role)return null;const h=u[p.role]||m().A.formatMessage(n().Sf.defaultAccessLabel);return(0,c.jsx)(r().sA,{id:"permissionsItem.generalAccess",defaultMessage:"{userName} will still have {accessLevel} from the {permissionItemName}",values:{permissionItemName:(0,c.jsx)(d()._,{permissionItem:p,from:g}),userName:t,accessLevel:h}})}({targetType:s,targetName:i,mostPermissivePermissions:p});return f||!g||h||(f=(0,c.jsx)(r().sA,{id:"permissionsItem.unknownInheritedAccess",defaultMessage:"{userName} may have a different access level from a parent page, group, or teamspace",values:{userName:i}})),f?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a().A,{dividerColor:b.divider.color,size:1}),(0,c.jsx)(l().A,{style:b.label,isSmall:!0,isMultiline:!0,children:f})]}):null}},810727:(e,s,i)=>{i.d(s,{z:()=>b});i(898992),i(672577),i(296540);var t=()=>i(56366),n=()=>i(401497),o=()=>i(854150),r=()=>i(959013),a=()=>i(534177),l=()=>i(284371),m=()=>i(16006),d=()=>i(108944),c=()=>i(605402),u=()=>i(630116),p=()=>i(898808),g=()=>i(678634),h=i(474848);function b(e){let{permissionItem:s,targetType:i,targetName:b,store:f}=e;const v=(0,n().IS)((()=>({groupOrTeamName:{fontWeight:l().Wy.bold}})),[]),y=(0,t().K8)((()=>{var e;if("group_permission"!==s.type)return;const i=null===(e=c().A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===s.group_id)))||void 0===e?void 0:e.group.name;return i?(0,h.jsx)("span",{style:v.groupOrTeamName,children:i}):void 0}),[s,v.groupOrTeamName]),x=(0,t().K8)((()=>{var e;if("team_permission"!==s.type&&"explicit_team_permission"!==s.type&&"team_owner_permission"!==s.type&&"explicit_team_owner_permission"!==s.type&&"explicit_team_guest_permission"!==s.type)return;const i="team_permission"===s.type||"team_owner_permission"===s.type?null===(e=(0,d().Uo)(f))||void 0===e?void 0:e.id:s.team_id;if(!i)return;const t=u().h4.createChildStore(f,{table:o().yK,id:i,spaceId:f.getSpaceId()});return(0,h.jsxs)("span",{style:{...v.groupOrTeamName,display:"inline-flex",gap:4},children:[(0,h.jsx)(p().x,{store:t,size:14,style:{margin:1}}),(0,h.jsx)(m().A,{store:t,shouldWrap:!0})]})}),[s,f,v.groupOrTeamName]);if("none"===s.role)return;const I=(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.withoutUserName",defaultMessage:"Access is from the “{permissionItemName}”",values:{permissionItemName:(0,h.jsx)(g()._,{permissionItem:s})}});if("group"===i&&"group_permission"===s.type)return b?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithGroupName",defaultMessage:"The {targetGroupName} group has access to this page",values:{targetGroupName:b}}):(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithoutGroupName",defaultMessage:"This group has access to this page"});if("user"===i&&("user_permission"===s.type||"exclusive_user_permission"===s.type))return b?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.userWithUserName",defaultMessage:"{targetUserName} has access to this page",values:{targetUserName:b}}):void 0;switch(s.type){case"space_permission":return b&&"user"===i?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.spaceWithUserName",defaultMessage:"{targetUserName} has access from the “{permissionItemName}” setting on this page",values:{targetUserName:b,permissionItemName:(0,h.jsx)(g()._,{permissionItem:s})}}):b&&"group"===i?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.spaceWithGroupName",defaultMessage:"The {targetGroupName} group has access from the “{permissionItemName}” setting on this page",values:{targetGroupName:b,permissionItemName:(0,h.jsx)(g()._,{permissionItem:s})}}):I;case"space_owner_permission":return I;case"team_permission":case"explicit_team_permission":return"user"===i&&b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.member.teamWithUserName",defaultMessage:"{targetUserName} has access as a member of the {teamspaceName} teamspace",values:{targetUserName:b,teamspaceName:x}}):"group"===i&&b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.group.teamWithUserName",defaultMessage:"The {targetGroupName} group has access from the {teamspaceName} teamspace",values:{targetGroupName:b,teamspaceName:x}}):I;case"team_owner_permission":case"explicit_team_owner_permission":return"user"===i&&b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.owner.teamWithUserName",defaultMessage:"{targetUserName} has access as an owner of the {teamspaceName} teamspace",values:{targetUserName:b,teamspaceName:x}}):"group"===i&&b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.group.teamWithUserName",defaultMessage:"The {targetGroupName} group has access from the {teamspaceName} teamspace",values:{targetGroupName:b,teamspaceName:x}}):I;case"explicit_team_guest_permission":return b&&x?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.guest.teamWithUserName",defaultMessage:"{targetUserName} has access as a guest of the {teamspaceName} teamspace",values:{targetUserName:b,teamspaceName:x}}):I;case"group_permission":return b&&y?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.groupWithUserName",defaultMessage:"{targetUserName} has access as a member of the {groupName} group",values:{targetUserName:b,groupName:y}}):I;case"user_permission":case"exclusive_user_permission":return b?(0,h.jsx)(r().sA,{id:"searchTargetPermissionItem.accessReasonTooltip.userWithUserName",defaultMessage:"{targetUserName} has access to this page",values:{targetUserName:b}}):void 0;case"bot_permission":case"deleted_permission":case"public_permission":case"restricted_permission":case"trusted_domain_permission":case"collection_property_permission":return;default:return void(0,a().ub)(s)}}},901273:(e,s,i)=>{i.d(s,{A:()=>k});i(296540);var t=()=>i(484714),n=()=>i(401497),o=()=>i(584262),r=()=>i(742852),a=()=>i(340498),l=()=>i(68263),m=()=>i(959013),d=()=>i(502492),c=()=>i(284371),u=()=>i(884107),p=()=>i(679924),g=()=>i(864943),h=()=>i(204063),b=()=>i(125565),f=()=>i(780054),v=()=>i(492414),y=i(474848);function x(e){const s=(0,t().v3)(),{device:o,WindowSizeStore:r}=s,l=(0,i(56366).K8)((()=>({left:r.getSafePaddingLeftCSS(8),right:r.getSafePaddingRightCSS(12)})),[r]),d=(0,n().IS)((e=>({button:{display:"flex",alignItems:"center",width:o.isMobile?"100%":void 0,height:o.isMobile?44:32,paddingTop:o.isMobile?12:4,paddingBottom:o.isMobile?12:4,paddingLeft:l.left,paddingRight:l.right},questionMarkCircleSmall:{width:a().Ev.sm,height:a().Ev.sm,fill:o.isMobile?e.icon.secondary:e.icon.tertiary}})),[o.isMobile,l]);return(0,y.jsx)(i(187485).A,{href:(0,i(836251).xS)("guides.sharing"),onClick:()=>i(148024).FH(s,{from:"sharing"}),style:{width:o.isMobile?"100%":void 0},external:!0,children:(0,y.jsxs)(i(493823).p,{size:"sm",style:{...d.button,...e.style},disabled:Boolean(e.disableHover),children:[(0,y.jsx)("div",{style:{marginLeft:o.isMobile?2:0,marginRight:o.isMobile?8:6},children:(0,i(721479).questionMarkCircleSmallIcon)(d.questionMarkCircleSmall)}),(0,y.jsx)(b().A,{isMobile:o.isMobile,isSecondaryColor:!o.isMobile,children:(0,y.jsx)(m().sA,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"})})]})})}x.displayName="LearnAboutSharingLink";const I=x;function P(e){const{store:s,buttonPopupStore:i,events:r}=e,a=(0,t().v3)(),{device:l,mobileNative:u}=a,p=l.isMobile,g=(0,n().IS)((e=>({button:{flex:1,height:36,minHeight:36,borderRadius:12,marginTop:12,...p?{minHeight:48,fontSize:c().J.UIRegular.mobile}:{}}})),[p]);return(0,y.jsx)(h().A,{onClick:()=>{var e;l.isMobileNative?function(e){const{store:s,mobileNative:i}=e,t=(0,d().kb)({schemeUrl:(0,v().Ay)({store:s,pageVisitSource:o().y8.CopyLink}),baseUrl:f().A.domainBaseUrl});i&&i.share(t)}({store:s,mobileNative:u}):A({store:s,buttonPopupStore:i,environment:a});const t=null===(e=s.getCollectionStore())||void 0===e?void 0:e.id,n=s.getParentCollectionIdUpToTwoLevels();M(a,{collection_id:t,parent_collection_id:n})},style:g.button,...r,children:l.isMobileNative?(0,y.jsx)(m().sA,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):(0,y.jsx)(m().sA,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function S(e){const{store:s,buttonPopupStore:i,events:o,trustedDomainPermissionItem:l}=e,d=(0,t().v3)(),c=(0,n().IS)((e=>({icon:{width:a().Ev.default,height:a().Ev.default,fill:e.icon.secondary,marginLeft:0,marginRight:6},label:{color:e.text.primary},button:{paddingLeft:10,paddingRight:12,paddingTop:6,paddingBottom:6,color:e.text.primary,justifyContent:"center",borderRadius:6}})),[]);return(0,y.jsxs)(g().A,{size:"lg",onClick:()=>{var e;A({store:s,buttonPopupStore:i,environment:d,keepPopupOpen:!0});const t=null===(e=s.getCollectionStore())||void 0===e?void 0:e.id,n=s.getParentCollectionIdUpToTwoLevels();M(d,{collection_id:t,parent_collection_id:n,trusted_domain_permission_role:l.role})},style:c.button,...o,children:[(0,r().w)(c.icon),(0,y.jsx)(b().A,{style:c.label,children:(0,y.jsx)(m().sA,{id:"blockPermissionsSettings.copyLinkButtonV2.label",defaultMessage:"Copy link"})})]})}function j(e){const{calculatedPermissions:s,spaceName:i}=e,t=s.mostPermissivePublicItem.permissionItem;if((0,l().Tt)(t.role))return(0,y.jsx)(m().sA,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const n=s.mostPermissiveSpaceItem.permissionItem;return(0,l().Tt)(n.role)?i?(0,y.jsx)(m().sA,{defaultMessage:"Anyone at {spaceName} can access with this link",id:"blockPermissionsSettings.workspacePermissions.tooltipV2",values:{spaceName:i}}):(0,y.jsx)(m().sA,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):s.permissionItemsCount>1?(0,y.jsx)(m().sA,{defaultMessage:"Only people invited to this page can access with this link",id:"blockPermissionsSettings.userPermissions.tooltipV2"}):(0,y.jsx)(m().sA,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function A(e){const{store:s,buttonPopupStore:i,environment:t,keepPopupOpen:n}=e,r=(0,v().Ay)({store:s,pageVisitSource:o().y8.CopyLink}),a=await u().R.clipboardActions.load();await a.copyString({environment:t,stringValue:r,copiedMessage:a.clipboardMessages.copiedLinkToClipboard}),i&&!n&&i.setState({open:!1})}const _=function(e){const{store:s,buttonPopupStore:o,calculatedPermissions:r}=e,{device:a}=(0,t().v3)(),l=(0,i(653953).X)(),m=(0,n().IS)((e=>({tooltip:{width:280}})),[]);return(0,y.jsxs)(y.Fragment,{children:[!a.isMobile&&(0,y.jsx)(I,{}),(0,y.jsx)(i(859428).A,{delayThreshold:500,placement:i(962730).W.Bottom,renderTooltip:()=>(0,y.jsx)(j,{calculatedPermissions:r,spaceName:l}),textWrap:!0,style:m.tooltip,render:e=>a.isMobile?(0,y.jsx)(P,{store:s,buttonPopupStore:o,events:e}):(0,y.jsx)(S,{store:s,buttonPopupStore:o,events:e,trustedDomainPermissionItem:r.mostPermissiveTrustedDomainItem.permissionItem})})]})};function M(e,s){(0,p().v)(e,"copy_link_from_permissions_setting",s)}const k=function(e){const{isMobile:s}=(0,t().Y0)(),o=(0,n().IS)((e=>({container:{display:"flex",alignItems:s?"normal":"center",flexDirection:s?"column":"row",justifyContent:"space-between",padding:s?"16px 20px 20px":"12px 12px",borderTop:s?`0.5px solid ${e.stroke.primary}`:`1px solid ${e.stroke.secondary}`}})),[s]);return(0,y.jsx)("div",{style:o.container,children:s?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(i(598697).GeneralAccessPermissionSection,{store:e.store,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs}),(0,y.jsx)(_,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]}):(0,y.jsx)(_,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})})}},913348:(e,s,i)=>{i.d(s,{A:()=>y});i(898992),i(672577),i(581454);var t=i(296540),n=()=>i(484714),o=()=>i(56366),r=()=>i(401497),a=()=>i(187174),l=()=>i(959013),m=()=>i(449506),d=()=>i(453697),c=()=>i(698449),u=()=>i(765957),p=()=>i(87043),g=()=>i(946928),h=i(474848);function b(e){const{group:s,store:i,groupPermission:t}=e,l=(0,n().v3)(),d=(0,o().O$)(u().AppStoreCurrentSpaceStore),[{value:p}]=(0,a().Yb)((async()=>{const e=await m().callApi({eventName:"getSpacePermissionGroupMembers",environment:l,data:{groupIds:[s.group_id],spaceId:s.space_id}});if("success"===e.type){var i;const t=null===(i=e.data.groupUsersMap[s.group_id])||void 0===i?void 0:i.userIds,{limitedUserStores:n}=(0,c().gA)({userIds:t,limit:void 0,spaceStore:d});return n}}),[d,l,s.group_id,s.space_id]),g=(0,r().IS)((e=>({container:{paddingLeft:16}})),[]);return(0,h.jsx)("div",{style:g.container,children:null==p?void 0:p.map((e=>(0,h.jsx)("div",{children:(0,h.jsx)(f,{userStore:e,store:i,groupPermission:t})},e.id)))})}function f(e){const{userStore:s,store:i,groupPermission:t}=e,r=(0,n().v3)(),{isMobile:a}=r.device,m=(0,l().tz)(),c=(0,o().K8)((()=>s.getDisplayName(m)),[m,s]),u=(0,o().K8)((()=>s.getEmail()),[s]);return(0,h.jsx)(p().Ay,{store:i,permissionItem:{type:"display_only_group_member_permission"},from:t.from,icon:(0,h.jsx)(d().A,{userStore:s,avatarShouldShowShadow:!1,size:a?p().Bj:p().Ev,hasTooltip:!1}),title:c||u,subtitle:u,upgradeButtonName:"permission_groups"})}function v(e){const{group:s}=e,i=(0,l().tz)(),t=(0,c().Pf)({intl:i,groupName:s.name});return(0,h.jsx)(l().sA,{defaultMessage:"People in {groupName} have access to the page",values:{groupName:t},id:"blockPermissionsSettings.groupPermission.tooltipV2"})}const y=function(e){const{store:s,groupPermission:a,spaceId:m,fromPermissionWrapper:d,disableExpansion:f}=e,{isMobile:y}=(0,n().Y0)(),x=(0,l().tz)(),[I,P]=(0,t.useState)(!1),[S,j]=(0,t.useState)(!1),{group:A,memberCount:_}=(0,o().K8)((()=>{const{currentSpaceStore:e}=u().default.state;if(!e)return{};return{...i(605402).A.state.permissionGroupsAndMemberCounts.find((e=>e.group.group_id===a.permissionItem.group_id))}}),[a.permissionItem.group_id]),M=!f&&!(!A||!_||0===_),k=(0,t.useCallback)((()=>P(!0)),[]),C=(0,t.useCallback)((()=>P(!1)),[]),w=(0,t.useCallback)((()=>{M&&j(!S)}),[S,M]),T=(0,r().IS)((e=>({mobileChevronIcon:{marginLeft:4,fill:e.icon.secondary,transform:`rotate(${S?90:0}deg)`,transition:"transform 150ms ease"},mobileTitleContainer:{display:"flex",alignItems:"center"}})),[S]);if(!A)return null;const N=(0,c().Pf)({intl:x,groupName:A.name}),B=M?(0,h.jsx)(i(180925).A,{expanded:S,hovered:I,onClick:w,children:(0,h.jsx)(g().A,{groupIcon:A.icon,spaceId:m})}):(0,h.jsx)(g().A,{groupIcon:A.icon,spaceId:m});return(0,h.jsxs)("div",{style:{fontWeight:400},className:i(38337).HlM,children:[(0,h.jsx)(p().Ay,{onMouseEnter:k,onMouseLeave:C,onClick:M?w:void 0,isCollapsible:M,store:s,permissionItem:a.permissionItem,from:a.from,icon:B,title:(0,h.jsxs)("div",{style:T.mobileTitleContainer,children:[N,M&&y?(0,h.jsx)("div",{style:T.mobileChevronIcon,children:(0,i(742117).V)({height:12,width:12})}):void 0]}),ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:e.tooltip?e.tooltip:(0,h.jsx)(v,{group:A}),subtitle:y?(0,h.jsxs)("div",{children:[(0,h.jsx)(l().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:_}})," · ",(0,h.jsx)(l().sA,{...(0,i(747788).R)({type:"group_permission",role:a.permissionItem.role,table:"block",isRemovable:!1,isCurrentUser:!1}).label})]}):(0,h.jsxs)("div",{children:[(0,h.jsx)(l().sA,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,h.jsx)(l().sA,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:_}})]}),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:d,roleItemOverrides:e.roleItemOverrides,menuListItemProps:e.menuListItemProps,style:e.style,...e.permissionItemArgs}),S?(0,h.jsx)(b,{group:A,store:s,groupPermission:a}):void 0]},A.id)}},928153:(e,s,i)=>{i.d(s,{C:()=>a});var t=()=>i(534177),n=()=>i(247450),o=()=>i(765957),r=()=>i(108944);function a(e){let{store:s}=e;const i=(0,n().h)({blockId:s.id,setting:"publicAccess"});if((0,t().O9)(i))return i;const a=o().default.state.currentSpaceStore,l=(0,r().Uo)(s);return l?{disabled:Boolean(l.getDisablePublicAccess()),disabledBy:"team"}:!l&&null!=a&&a.getDisablePublicAccess()?{disabled:!0,disabledBy:"space"}:{disabled:!1}}},946928:(e,s,i)=>{i.d(s,{A:()=>a});var t=i(296540),n=()=>i(99756),o=i(474848);function r(e){let{groupIcon:s,spaceId:t}=e;const{isMobile:r}=(0,i(484714).Y0)(),a=(0,i(401497).IS)((e=>({icon:{fill:e.icon.secondary}})),[]);return s&&t?(0,o.jsx)(n().A,{type:"circle",iconType:"recordIcon",icon:{icon:s,pointer:{table:i(96689).NX,id:t}},isMobile:r}):(0,o.jsx)(n().A,{type:"circle",iconType:"function",iconFn:i(658985).$,iconStyle:a.icon,isMobile:r})}const a=t.memo(r)}}]);