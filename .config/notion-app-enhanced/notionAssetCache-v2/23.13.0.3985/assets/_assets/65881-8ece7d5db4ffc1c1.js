"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[65881],{134539:(e,t,o)=>{o.d(t,{NU:()=>v,O:()=>y,Rf:()=>f,SU:()=>h,cV:()=>g,fn:()=>I});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(581454);var n=()=>o(536095),r=()=>o(888325),i=()=>o(970013),l=()=>o(278238),a=()=>o(919709),c=()=>o(534177),s=()=>o(403905),p=()=>o(972435),d=()=>o(630116),u=()=>o(913454),m=()=>o(476219);function f(e){var t;const{collectionViewBlockStore:o,collectionStore:f,instanceMap:y}=e,v=f.id,g=(0,r()._)({table:"collection",id:v}),I=y[g]??{};if(!o.isReady()||!f.isReady())return;let b,w=!1;const _=o.getCollectionViewIds().map((e=>{const t=d().pS.createChildStore(o,{table:"collection_view",id:e}),r=t.getModel();if(!r)return void(w=!0);const i=t.getCollectionStore();if(!i)return void(w=!0);let l=!1;return b||"table"!==r.getType()||(b=e,l=!0),i.id===v?function(e){const{collectionViewStore:t,templateIdToInstancePointersMap:o,schema:r,isFirstTableView:i}=e,l=t.id;let a=t.getName();const c=t.getType(),d=h(o,"collection_view",l);let m;i&&!a&&(m=n().Gs,a=(0,u().getWorkflowTemplateName)(u().globalWorkflowTemplates.fromId(m)));!a&&c&&(a=p().A.intl.formatMessage(s().X[c]));return{type:"collection_view",name:a,id:l,viewType:c,format:t.getNormalizedFormat(r)??{},query:t.getRawQuery(),templateId:d,isFirstTableView:i,defaultBuiltinTemplateIdToMapTo:m}}({collectionViewStore:t,templateIdToInstancePointersMap:I,schema:i.getSchema(),isFirstTableView:l}):void 0})).filter(c().O9);if(w)return;const T=[];for(const n of _)if(n.isFirstTableView){const e=n.format;if(e.table_properties){for(const t of e.table_properties)t.visible&&T.push(t.property);if(T.length>0)break}}const S=f.getSchema(),C=Object.entries(S).map((e=>{let[t,o]=e;if(o)return function(e){const{propertyId:t,schema:o,instanceMap:n,templateIdToInstancePointersMap:l}=e,a="relation"===o.type?(0,i().zO)(o):void 0,c=a?function(e,t){const o=(0,r()._)({table:"collection",id:t});return h(e[o]??{},"collection",t)}(n,a):void 0;return{type:"property",id:t,name:o.name,schema:o,relatedCollectionTemplateId:c,templateId:h(l,"property",t),isSupported:m().Pg(o)}}({propertyId:t,schema:o,instanceMap:y,templateIdToInstancePointersMap:I})})).filter(c().O9),x=f.getLayoutStore();if(x&&!x.isReady())return;const M=null==x?void 0:x.getModel(),k=M?function(e){const{layoutModel:t,templateIdToInstancePointersMap:o}=e,n=h(o,"layout",t.id);let r;if(n){const e=u().globalWorkflowTemplates.fromId(n);"layout"===e.type&&(r=e.name)}return{id:t.id,type:"layout",templateId:n,name:r,layout:t.getRawModules(),spaceId:t.spaceId}}({layoutModel:M,templateIdToInstancePointersMap:I}):void 0,O=f.getAutomationStores().map((e=>e.pointer)),j=null===(t=f.getIcon())||void 0===t?void 0:t.icon,P=j&&(0,l().T8)(j)?j:void 0,$=f.getDescription();return{type:"collection",id:v,description:$,descriptionAsString:(0,a().q4_)($),schema:S,templateId:h(I,"collection",v),name:(0,a().q4_)(f.getName()),pageTemplateIds:f.getTemplatePages(),format:f.getFormat(),icon:P,properties:C,collectionViews:_,firstTableViewId:b,layout:k,templateIdToInstancePointersMap:I,tableOrderPropertyIds:T,automationPointers:O}}function y(e){return"property"===e.type&&"title"===e.id}function v(e){return y(e)&&"Name"===e.schema.name}function g(e){const{collectionInfo:t,pageStore:o,instanceMap:n,recordMap:i}=e,l=(0,a().q4_)(o.getTitleValue())||"Untitled",c=n[(0,r()._)({table:"collection",id:t.id})]??{},s=new Set,p=o.getProperties();for(const r of Object.keys(p))"title"!==r&&s.add(r);return{type:"block",id:o.id,recordMap:i,templateId:h(c,"block",o.id),name:l,propertyIds:s,spaceId:o.getSpaceId()}}function h(e,t,o){var n;return null===(n=I(e,t,o))||void 0===n?void 0:n.templateId}function I(e,t,o){for(const[n,r]of Object.entries(e))for(const e of r)if(e.type===t&&e.id===o)return{...e,templateId:n}}},247211:(e,t,o)=>{o.d(t,{D6:()=>_,Jp:()=>d,OU:()=>g,PT:()=>w,To:()=>v,rW:()=>h,rs:()=>f,vO:()=>y});o(898992),o(354520),o(672577),o(581454);var n=()=>o(496603),r=()=>o(534177),i=()=>o(913454),l=()=>o(134539);const a="content",c="item",s="items",p="optionalDefaultOn",d="/icons/document_gray.svg",u={collection_view:"View",layout:"Layout",collection:"Collection",property:"Property",compound:"Compound",block:"Block",automation:"Automation"},m=Symbol("BuilderKey"),f=y({type:"property",id:o(970013).rn});function y(e){return(0,r().GV)(`${e.type}:${e.id}`,m)}function v(e){if("explicit-undefined"!==e)return e}function g(e){return void 0===e?"explicit-undefined":e}function h(e,t){var o;const n=y(t),u=null===(o=e.state.builderSettings)||void 0===o?void 0:o[n],m=b(e,t),f=m?function(e,t){const o={},n=e.templateRegistryMap.get(t);if(!n)return o;o.name=(0,i().getWorkflowTemplateName)(n),"property"!==n.type&&"collection_view"!==n.type&&"block"!==n.type&&(o.description=n.description);"property"===n.type&&(o.propertyOptionsType=n.propertyOptionsType,o.relatedCollectionTemplateId=n.relatedCollectionTemplateId);if("collection"===n.type){var l;o.hasMinimalOnboarding=null===(l=n.value.onboarding)||void 0===l?void 0:l.isMinimal,o.singularItemName=n.value.targetCollection.itemName.singular,o.pluralItemName=n.value.targetCollection.itemName.plural,o.category=n.category}if("collection"!==n.type&&e.sourceCollectionTemplate){const n=e.sourceCollectionTemplate.value.templateItems.find((e=>e.pointer===t));n?(o.optionality=n.optionality,o.isInSettings=n.isInSettings):o.includeInCollectionTemplate=!1}"compound"===n.type&&(o.icon=n.icon,o.templateItems=n.value.templateItems.map((t=>{const o=e.templateIdToBuilderKeyMap.get(t.pointer);if(o)return{pointer:o,optionality:t.optionality}})).filter(r().O9));return o}(e,e.state.createCopy&&t.templateId?t.templateId:m):{};return{templateId:m,isDeleted:(null==u?void 0:u.isDeleted)??"uninstantiated_template"===t.type,description:((null==u?void 0:u.description)??f.description)||void 0,category:(null==u?void 0:u.category)??f.category,optionality:(0,l().O)(t)?"required":(null==u?void 0:u.optionality)??f.optionality??p,hasMinimalOnboarding:(null==u?void 0:u.hasMinimalOnboarding)??f.hasMinimalOnboarding??!1,singularItemName:(null==u?void 0:u.singularItemName)??f.singularItemName??c,pluralItemName:(null==u?void 0:u.pluralItemName)??f.pluralItemName??s,isInSettings:(null==u?void 0:u.isInSettings)??f.isInSettings??!1,propertyOptionsType:(null==u?void 0:u.propertyOptionsType)??(null==f?void 0:f.propertyOptionsType)??a,includeInCollectionTemplate:(null==u?void 0:u.includeInCollectionTemplate)??(null==f?void 0:f.includeInCollectionTemplate)??!0,templateItems:(null==u?void 0:u.templateItems)??(null==f?void 0:f.templateItems)??[],name:(null==u?void 0:u.name)??(null==f?void 0:f.name)??t.name??("layout"===t.type?"Layout":""),icon:(null==u?void 0:u.icon)??(null==f?void 0:f.icon)??d,bypassCreateCopy:I(u,t),relatedCollectionTemplateId:(null==u?void 0:u.relatedCollectionTemplateId)??(null==f?void 0:f.relatedCollectionTemplateId),ignore:(null==u?void 0:u.ignore)??!!(0,l().NU)(t),shouldMapToTemplate:(null==u?void 0:u.shouldMapToTemplate)??!("collection_view"!==t.type||!t.defaultBuiltinTemplateIdToMapTo)}}function I(e,t){return void 0!==(null==e?void 0:e.bypassCreateCopy)?e.bypassCreateCopy:"property"===t.type&&"relation"===t.schema.type}function b(e,t){var o;const n=y(t),r=null===(o=e.state.builderSettings)||void 0===o?void 0:o[n],i=I(r,t),a=e.state.createCopy&&!i?void 0:t.templateId;if(void 0!==(null==r?void 0:r.templateId))return null==r?void 0:r.templateId;if(void 0!==a)return a;const c="collection"===t.type?"":`${b(e,e.collectionInfo)}.`;return(0,l().O)(t)?`${c}title${u.property}`:"collection_view"===t.type&&t.defaultBuiltinTemplateIdToMapTo&&!1!==(null==r?void 0:r.shouldMapToTemplate)?t.defaultBuiltinTemplateIdToMapTo:t.name&&"uninstantiated_template"!==t.type?c+(s=t.name,p=t.type,`${w(s)}${u[p]}`):"layout"===t.type?`${c}default${u.layout}`:"automation"===t.type?`${c}${t.referrerName}${u.automation}`:void 0;var s,p}function w(e){return(0,n().xQ)(e)}function _(e,t){let o,n,r,{includeType:i=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof t?(n=t,r=e.featureInfoMap.get(t)):(r=t,n=y(r)),r){const t=h(e,r);o=`${t.name||t.templateId}${i?` (${l=r,l.type.replace(/_/g," ")})`:""}`}var l;return o||n}},290966:(e,t,o)=>{o.d(t,{E_:()=>O,HQ:()=>$,I5:()=>j,ZQ:()=>k});o(16280),o(898992),o(823215),o(354520),o(581454),o(296540);var n=()=>o(662303),r=()=>o(536095),i=()=>o(134025),l=()=>o(912720),a=()=>o(179034),c=()=>o(519831),s=()=>o(869558),p=()=>o(144081),d=()=>o(921515),u=()=>o(959013),m=()=>o(496603),f=()=>o(534177),y=()=>o(284371),v=()=>o(966759),g=()=>o(235191),h=()=>o(901389),I=()=>o(751156),b=()=>o(67103),w=()=>o(16006),_=()=>o(972435),T=()=>o(470928),S=()=>o(630116),C=()=>o(913454),x=()=>o(204067),M=o(474848);function k(e){let{transaction:t,collectionStore:o,templateId:n,instance:r,logger:u}=e;u.debug(`Creating/updating ${d().rM} record for "${n}".`);const m=o.getSpaceId(),y=r.id;if("automation"===r.type){const e={table:l().yB,id:y,spaceId:m};I().applyOperation({store:S().dn.createChildStore(o,e),operation:i().op.set({pointer:e,path:["properties","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("block"===r.type){const e={table:a().ev,id:y,spaceId:m};I().applyOperation({store:S().Bv.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection"===r.type){const e={table:c().Vl,id:y,spaceId:m};I().applyOperation({store:o,operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection_view"===r.type){const e={table:s().Gy,id:y,spaceId:m};I().applyOperation({store:S().pS.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("layout"===r.type){const e={table:p().zx,id:y,spaceId:m};I().applyOperation({store:S().K_.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("compound"===r.type){if(r.instancePointers.length<2)throw new Error(`Compound template instance ${r.id} must contain 2 or more instances`);const e=r.instancePointers.map((e=>{switch(e.type){case"automation":return{type:"automation",id:e.id};case"block":return{type:"block",id:e.id};case"collection_view":return{type:"collection_view",id:e.id};case"layout":return{type:"layout",id:e.id};case"property":return{type:"property",id:e.id}}(0,f().HB)(e)}));I().applyOperation({store:o,operation:{command:"keyedObjectListUpdate",pointer:o.pointer,path:["format","compound_workflow_template_instances"],args:{value:{template_id:n,id:r.id,instance_pointers:e}}},transaction:t})}else"property"===r.type?I().applyOperation({store:o,operation:i().op.update({pointer:o.pointer,path:["schema",r.id],args:{workflow_template_instance:{template_id:n}}}),transaction:t}):(0,f().HB)(r)}function O(e){let{environment:t,collectionStore:o,propertyId:n,compoundTemplateInstancesToDelete:i,collectionContextStore:l,from:a}=e;if(!i.every((e=>e.templateId===r().z$)))return!1;if(!(0,T().Io)())return!1;const c=(0,x().aL)({environment:t,collectionStore:o,compoundTemplateInstancesToDelete:i}),s=m().sb(c.filter((e=>"property"===e.type)).map((e=>e.id))),p=o.getSchema(),d=s.map((e=>{var t;if(e===n)return;const o=p[e];if(!o)throw new Error(`Property ${e} not found`);if(o.name)return o.name;const r=null===(t=o.workflow_template_instance)||void 0===t?void 0:t.template_id;if(!r)throw new Error(`Property ${e} has no workflow template id`);const i=C().globalWorkflowTemplates.fromId(r);return(0,C().getWorkflowTemplateName)(i)})).filter(f().O9);return P({environment:t,collectionStore:o,propertyIds:s,otherPropertyNames:d,collectionContextStore:l,from:a}),!0}function j(e){let{environment:t,collectionStore:o,propertyId:n,collectionContextStore:r,from:i}=e;const l=o.getSchema(),a=Object.keys(l).filter((e=>(0,T().Do)({collectionStore:o,propertyId:e})||(0,T().k$)(e))),c=a.map((e=>{var t;if(e===n)return;const r=null===(t=l[e])||void 0===t?void 0:t.name;if(r)return r;if((0,T().Do)({collectionStore:o,propertyId:e}))return _().A.formatMessage(b().Gl.verificationPropertyName);if((0,T().k$)(e))return _().A.formatMessage(b().Gl.ownerPropertyName);throw new Error(`Property ${e} must be a verification or owner property`)})).filter(f().O9);return P({environment:t,collectionStore:o,propertyIds:a,otherPropertyNames:c,collectionContextStore:r,from:i}),!0}function P(e){let{environment:t,collectionStore:o,propertyIds:r,otherPropertyNames:i,collectionContextStore:l,from:a}=e;const c=[{label:(0,M.jsx)(u().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deleteOption",defaultMessage:"{count, plural, one {Delete {count} property} other {Delete {count} properties}}",values:{count:r.length}}),color:"red",onAccept:()=>function(e){let{environment:t,collectionStore:o,collectionContextStore:n,propertyIds:r,from:i}=e;I().createAndCommit({userAction:"workflowTemplateInstanceActions.handleDeleteAccept",environment:t,canUndo:!0,perform:e=>{const l=o.getSchema();for(const a of r){g().BJ({environment:t,collectionStore:o,schema:l,property:a,transaction:e});const r=l[a];r&&(0,v().i)({environment:t,collectionContextStore:n,property_type:r.type,from:i,property:a})}}})}({environment:t,collectionStore:o,collectionContextStore:l,propertyIds:r,from:a})}],s=new Intl.ListFormat(n().locale,{style:"long",type:"conjunction"}),p=(0,M.jsx)(u().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deletePropertyFromDb",defaultMessage:"Delete this property from <bold>{databaseName}</bold>? {otherPropertyNames} will also be deleted",values:{bold:e=>(0,M.jsx)("span",{style:{fontWeight:y().Wy.bold},children:e}),databaseName:(0,M.jsx)(w().A,{style:{display:"inline",fontWeight:y().Wy.bold},shouldWrap:!0,store:o}),otherPropertyNames:s.format(i)}});h().ui({message:(0,M.jsx)("span",{children:p}),showCancel:!0,keepFocus:!0,innerStyle:{width:400},items:c})}function $(e){const{environment:t,transaction:o,collectionStore:n,instance:r}=e;(0,x().aI)({environment:t,instancePointer:r,inMemoryRecordCache:n.inMemoryRecordCache})||I().applyOperation({store:n,operation:{pointer:n.pointer,command:"keyedObjectListRemove",path:["format","compound_workflow_template_instances"],args:{remove:{id:r.id}}},transaction:o})}},339600:(e,t,o)=>{o.d(t,{Cy:()=>C,iK:()=>S,qT:()=>x});o(898992),o(354520),o(581454);var n=o(296540),r=()=>o(560198),i=()=>o(484714),l=()=>o(401497),a=()=>o(925907),c=()=>o(595797),s=()=>o(335098),p=()=>o(558842),d=()=>o(959013),u=()=>o(381349),m=()=>o(496603),f=()=>o(284371),y=()=>o(884107),v=()=>o(354584),g=()=>o(645873),h=()=>o(962730),I=()=>o(285790),b=()=>o(859428),w=()=>o(125565),_=o(474848);const T=(0,d().YK)({copyColor:{defaultMessage:"Copied ‘{stringValue}’",id:"uidoc.colors.copied"}});function S(e){let{children:t,style:o}=e;const n=(0,l().IS)((e=>({subheader:{fontSize:24,fontWeight:f().Wy.semibold,marginTop:36,marginBottom:8,lineHeight:1,...o}})),[o]);return(0,_.jsx)("div",{style:n.subheader,children:t})}function C(e){let{children:t,style:o,scrollContentRef:r}=e;const p=function(){const e=(0,i().v3)();return(0,n.useCallback)((async t=>{const o=t.length>P?`${t.slice(0,P)}...`:t;(await y().R.clipboardActions.load()).copyString({copiedMessage:{...T.copyColor,defaultMessage:`Copied '${o}'`},environment:e,stringValue:t})}),[e])}(),[u,f]=(0,n.useState)(!1),h=(0,n.useRef)(null),{value:b}=(0,g().fJ)(v().y),{renderChildren:w,githubUrl:S}=(0,n.useMemo)((()=>{if($(t)){var e;const o=`https://github.com/makenotion/notion-next/tree/main/${t.fileName}#L${(null===(e=t.start)||void 0===e?void 0:e.line)??"1"}`;return{renderChildren:(t.source&&function(e){const t=e.split("\n"),o=t.map((e=>{var t;return(null===(t=e.match(/^\s*/))||void 0===t?void 0:t[0])??""})).filter(((e,t)=>""!==e&&0!==t));if(0===o.length)return e;const n=m().wq(o,(e=>e.length));if(!n||0===n.length)return e;return t.map((e=>e.startsWith(n)?e.slice(n.length):e)).join("\n")}(t.source))??t.source??t.value,githubUrl:o}}return{renderChildren:t}}),[t]),C=(0,l().IS)((e=>({code:{fontSize:"80%",fontFamily:"monospace",color:e.text.primary,borderRadius:"0.25em",background:"rgba(135, 131, 120, 0.15)",padding:"0.2em 0.4em",position:"relative",tabSize:2,margin:0,...o},buttonBar:{position:"absolute",right:2,top:2,display:"flex",gap:4},button:{width:"1.55em",height:"1.55em"}})),[o]);(0,n.useLayoutEffect)((()=>{var e;const o="string"==typeof t?t:null===(e=h.current)||void 0===e?void 0:e.innerText;if(b&&o&&h.current){const e=s().y.TypeScript,t=b.languages[e],n=b.highlight(o,t,e);h.current.innerHTML=n}}));const x=(0,d().tz)();return(0,_.jsxs)("pre",{onMouseEnter:()=>{f(!0)},onMouseLeave:()=>{f(!1)},style:C.code,ref:r,children:[(0,_.jsx)("div",{ref:h,children:w}),u&&(0,_.jsxs)("div",{style:C.buttonBar,children:[S&&(0,_.jsx)(I().A,{ariaLabel:x.formatMessage({id:"uidoc.code.openInGithub",defaultMessage:"Open in Github"}),style:C.button,hasBackground:!0,icon:c().F,showShadow:!0,href:S,external:!0}),(0,_.jsx)(I().A,{ariaLabel:x.formatMessage({id:"uidoc.code.copy",defaultMessage:"Copy code"}),style:C.button,hasBackground:!0,icon:a().n,showShadow:!0,onClick:()=>{p((null==w?void 0:w.toString())||"")}})]})]})}function x(e){const[t,o]=(0,n.useState)(!1);return(0,_.jsx)("div",{onMouseEnter:()=>{o(!0)},onMouseLeave:()=>{o(!1)},children:(0,_.jsx)(M,{marginTopBottom:e.marginTopBottom,isInverted:e.isInverted,children:(0,_.jsx)(k,{showSize:e.showSize??t,showInsets:e.showInsets??t,insetSize:24,children:(0,_.jsx)(j,{isInverted:e.isInverted,children:e.children})})})})}function M(e){const{marginTopBottom:t}=e,o=(0,l().DP)(),r=O(),i=e.isInverted?r:o,a=(0,n.useMemo)((()=>({borderRadius:4,overflow:"hidden",border:`1px solid ${i.regularDividerColor}`,backgroundColor:i.contentBackground,marginTop:t??12,marginBottom:t??12,color:i.text.primary})),[i,t]);return(0,_.jsx)("div",{style:a,children:e.children})}function k(e){const{showInsets:t,showSize:o,insetSize:r,children:i}=e,a=(0,n.useRef)(null),c=(0,l().IS)((e=>{const o=t?"rgba(255, 105, 180, 1)":"rgba(255, 105, 180, 0)",n=`1px dashed ${o}`,i=`${r}px`,l="all 0.1s ease-in-out",a={t:{borderBottom:n,transition:l},l:{borderRight:n,transition:l},r:{borderLeft:n,transition:l},b:{borderTop:n,transition:l,position:"relative"}};return{grid:{display:"grid",gridTemplateColumns:`${i} auto ${i}`,gridTemplateRows:`${i} auto ${i}`,...a.t,...a.l,...a.r,...a.b},...a,tl:{...a.t,...a.l},tr:{...a.t,...a.r},bl:{...a.b,...a.l},br:{...a.b,...a.r},c:{position:"relative"},insetText:{color:o,fontSize:10,paddingLeft:(r-10)/2,fontFamily:f().Tf.githubMono,lineHeight:i,maxHeight:r,transition:l,position:"absolute"}}}),[t,r]);return(0,_.jsxs)("div",{style:c.grid,children:[(0,_.jsx)("div",{style:c.tl}),(0,_.jsx)("div",{style:c.t}),(0,_.jsx)("div",{style:c.tr}),(0,_.jsx)("div",{style:c.l}),(0,_.jsx)("div",{style:c.c,ref:a,children:i}),(0,_.jsx)(b().A,{forceVisibleState:o??t,renderTooltip:()=>{var e;return`${null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect().height}px`},placement:h().W.Right,render:()=>(0,_.jsx)("div",{style:c.r})}),(0,_.jsx)("div",{style:c.bl}),(0,_.jsx)(b().A,{placement:h().W.Bottom,forceVisibleState:o??t,renderTooltip:()=>{var e;return`${null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect().width}px`},render:()=>(0,_.jsx)("div",{style:c.b,children:(0,_.jsx)(w().A,{style:c.insetText,children:`${r}px inset`})})}),(0,_.jsx)("div",{style:c.br})]})}function O(){const{mode:e}=(0,l().DP)();return(0,u().O4)({theme:"light"===e?"dark":"light"})}function j(e){let{children:t,isInverted:o}=e;const{mode:n}=O();return o?(0,_.jsx)(r().wX,{mode:n,children:t}):(0,p().Du)(t)}const P=25;function $(e){return Boolean(e&&"object"==typeof e&&("isSourceMacroResult"in e||"value"in e&&"source"in e))}const B=(0,n.createContext)(!1);B.displayName="UIDocExpandAllCode"},466934:(e,t,o)=>{o.d(t,{bd:()=>m,UA:()=>p,C8:()=>u,XM:()=>s,ET:()=>d,aO:()=>I,gP:()=>_,OX:()=>f,gM:()=>y,hq:()=>h,Wm:()=>g,Rh:()=>b,pp:()=>w,QT:()=>v,Ll:()=>S});o(16280),o(944114),o(898992),o(354520),o(672577),o(581454);var n=()=>o(663077);const r={select_and_customize_template:["templateSelection","features","viewsSelection"],customize_template:["features","viewsSelection"],select_and_build_with_ai:["templateSelection","setupGeneratorInput","setupGeneratorBuilding","features","viewsSelection"],build_with_ai:["setupGeneratorInput","setupGeneratorBuilding","features","viewsSelection"],new_user_template_onboarding:["templateSelection","setupGeneratorBuilding","features","viewsSelection"]};var i=()=>o(498212),l=()=>o(534177),a=()=>o(913454);const c=3;function s(e){let{origin:t,parentStore:o,flowId:n}=e;return{collectionTemplate:void 0,origin:t,flowId:n??(0,i().Ay)(),collectionTemplatesSearchQuery:void 0,parentStore:o}}function p(e){let{collectionViewTemplates:t,featureTemplateSelections:o}=e;const r=[];for(const i of t)r.push(...(0,n().CA)({template:i,dependencyMap:i.dependencyMap||{}}).map((e=>e.templateId)));return o.filter((e=>"required"!==e.optionality&&!r.includes(e.template.templateId)&&v(e.template)))}function d(e){let{template:t}=e;return{recordTitles:new Array(c).fill(""),featureTemplateSelections:t.value.templateItems.map((e=>m(e.pointer,e.optionality)))}}function u(e){const{collectionTemplate:t,origin:o,flowId:n,parentStore:r}=e;return{collectionTemplate:t,userCustomizations:d({template:t}),origin:o,flowId:n??(0,i().Ay)(),parentStore:r,collectionTemplatesSearchQuery:void 0,previewCollectionInfo:void 0}}function m(e,t){const o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:a().globalWorkflowTemplates).fromId(e);if(!(0,n().Jb)(o))throw new Error(`Template ${e} in collection template is not a feature template`);return"required"===t?{template:o,optionality:"required",selected:!0}:"optionalDefaultOn"===t?{template:o,optionality:"optionalDefaultOn",selected:!0}:"optionalDefaultOff"===t?{template:o,optionality:"optionalDefaultOff",selected:!1}:void(0,l().HB)(t)}function f(e){if(!e.collectionTemplate)throw new Error("Collection template cannot be undefined");return{collectionTemplate:e.collectionTemplate,userCustomizations:e.userCustomizations,origin:e.origin,flowId:e.flowId,collectionTemplatesSearchQuery:e.collectionTemplatesSearchQuery,parentStore:e.parentStore,previewCollectionInfo:e.previewCollectionInfo}}function y(e){var t,o,n,r;return{origin:e.origin,has_selection_modal_search_query:((null===(t=e.collectionTemplatesSearchQuery)||void 0===t?void 0:t.length)??0)>0,flow_id:e.flowId,collection_template_id:null===(o=e.collectionTemplate)||void 0===o?void 0:o.templateId,destination_type:null===(n=e.parentStore)||void 0===n?void 0:n.table,destination_id:null===(r=e.parentStore)||void 0===r?void 0:r.id}}function v(e){return"property"===e.type&&"relation"!==e.value.type||"compound"===e.type}function g(e){const{version:t}=e;return r[t]}function h(e){const{currentStepIndex:t}=e;return g(e)[t]}function I(e,t){const{currentStepIndex:o,collectionTemplate:n}=e,r=g(e);for(let i=o+1;i<r.length;i++){const e=r[i];if(!(n&&T({step:e,template:n,action:"next",isPhone:t})))return i}return-1}function b(e,t){return I(e,t)>=0}function w(e,t){return _(e,t)>=0}function _(e,t){const{currentStepIndex:o,collectionTemplate:n}=e,r=g(e);for(let i=o-1;i>=0;i--){const e=r[i];if(!(n&&T({step:e,template:n,action:"previous",isPhone:t})))return i}return-1}function T(e){let{step:t,template:o,action:n,isPhone:r}=e;switch(t){case"viewsSelection":return r||a().globalWorkflowTemplates.allOfType({templateIds:o.value.templateItems.map((e=>e.pointer)),type:"collection_view"}).length<=1;case"templateSelection":case"features":case"setupGeneratorInput":return!1;case"setupGeneratorBuilding":return"previous"===n;default:(0,l().HB)(t)}}function S(e){let{userCustomizations:t,templateId:o}=e;const n=t.featureTemplateSelections,r=n.find((e=>e.template.templateId===o));if(!r||"required"===r.optionality)return t;const i={...r,selected:!r.selected};return{...t,featureTemplateSelections:n.map((e=>e.template.templateId===o?i:e)),prevFeatureTemplateSelections:n}}},476219:(e,t,o)=>{o.d(t,{Kg:()=>c,Pg:()=>s,nN:()=>p,vW:()=>d});o(944114),o(898992),o(672577);var n=()=>o(663077),r=()=>o(970013),i=()=>o(496603),l=()=>o(534177),a=()=>o(247211);function c(e){var t;let{propertyId:o,propertyTemplate:n,firstTableViewInfo:r}=e;const i=null==r||null===(t=r.format.table_properties)||void 0===t?void 0:t.find((e=>e.property===o));if(i){const{property:e,...t}=i;n.tablePropertyFormat=t}}function s(e){const{type:t}=e;switch(t){case"title":case"text":case"checkbox":case"number":case"person":case"file":case"url":case"email":case"phone_number":case"created_time":case"created_by":case"last_edited_time":case"last_edited_by":case"last_visited_time":case"date":case"select":case"multi_select":case"status":case"formula":case"relation":case"auto_increment_id":case"button":return!0;case"rollup":case"location":case"verification":case"place":return!1;default:(0,l().HB)(t)}}function p(e){if("relation"===e.type)return{type:"relation",name:e.name,autoRelate:e.autoRelate};const t=(0,i().mg)(e);if(delete t.workflow_template_instance,(0,r().DQ)(t)&&t.options)for(const o of t.options)delete o.collectionIds;return t}function d(e){let{propertyTemplateValue:t,mapper:o}=e;const r=[];if((0,n().$G)({object:t,callback:e=>{const t=e.property;r.push(t)}}),0===r.length)return;const i={};for(const n of r)o.populateDependencyMap((0,a().vO)({type:"property",id:n}),i);return i}},731638:(e,t,o)=>{o.d(t,{CF:()=>a,f:()=>i});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(581454);var n=()=>o(247211),r=()=>o(204067);function i(e){let{collectionStore:t,modules:o,dependencyMap:n}=e;return c({modules:o,mapper:l(t,n)})}function l(e,t){return o=>(0,r().CB)({collectionStore:e,sourceTemplateType:"property",sourcePrimitiveId:o,dependencyMap:t})}function a(e){const t=new Set;return c({modules:e,mapper:e=>(t.add((0,n().vO)({type:"property",id:e})),e)}),t}function c(e){let{modules:t,mapper:o}=e;const n=e=>e?e.map((e=>function(e){let{module:t,mapper:o}=e;switch(t.type){case"bottomControls":case"relationsGroup":case"cover":case"discussions":case"editor":case"expandedBacklinks":case"formQuestion":case"formSubmit":case"formTitle":case"inlinePageSections":case"placeholder":case"properties":case"transcript":case"viewsMain":return t;case"property":return{...t,propertyId:o(t.propertyId)};case"titleWithIcon":return{...t,propertyIds:t.propertyIds?t.propertyIds.map(o):void 0};case"views":return{...t,relation_pointer:t.relation_pointer?{...t.relation_pointer,property:o(t.relation_pointer.property)}:void 0}}return t}({module:e,mapper:o}))):void 0;return{page_layout_schema:n(t.page_layout_schema),page_info_layout_schema:n(t.page_info_layout_schema),form_layout_schema:n(t.form_layout_schema),person_profile_page_main:n(t.person_profile_page_main),person_profile_page_details:n(t.person_profile_page_details)}}}}]);