"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[52811],{62900:(e,t,n)=>{n.d(t,{n:()=>i});n(296540);const o={viewBox:"0 0 16 16",fittedViewBox:"2.12 3.05 11.76 9.9",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M2.16 8.206q.046.13.148.236l4.32 4.32a.625.625 0 0 0 .884-.884L4.259 8.625h8.991a.625.625 0 1 0 0-1.25H4.259l3.253-3.253a.625.625 0 1 0-.884-.884l-4.32 4.32a.62.62 0 0 0-.148.648"})},i=(0,n(340498).wt)("arrowStraightLeftSmall",o)},105157:(e,t,n)=>{n.d(t,{A:()=>r});n(296540);var o=()=>n(284371),i=()=>n(398217),s=n(474848);function r(e){const{propertySchema:t,dontShowColon:n}=e,r=t.name;return(0,s.jsx)("div",{style:{display:"inline-flex",paddingTop:2},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"start",lineHeight:"110%",minWidth:0,fontSize:13,fill:"dark"},children:[(0,s.jsx)(i().Rl,{iconStyle:{marginTop:1},propertySchema:t,iconSize:12}),(0,s.jsx)("div",{style:{...o().RC,marginLeft:4,maxWidth:100},children:(0,s.jsx)("span",{children:`${r}`})}),(0,s.jsx)("span",{style:{...o().RC,marginRight:4},children:n?null:":"})]})})}},165492:(e,t,n)=>{n.d(t,{A:()=>p});n(814603),n(147566),n(198721);var o=n(296540),i=()=>n(401497),s=()=>n(284371),r=()=>n(496889),a=()=>n(704152),l=()=>n(960715),c=()=>n(8980),d=()=>n(859428),u=()=>n(369767),m=n(474848);function p(e){let{title:t,source:n,size:p,file:g,store:f,onClick:v,showBlockActionMenuButton:h}=e;(0,o.useEffect)((()=>()=>{"local"===(null==g?void 0:g.type)&&null!=g&&g.dataURL&&URL.revokeObjectURL(g.dataURL)}),[g]);const y=(0,i().IS)((e=>({justBackgroundHovered:{background:e.surface.wash},wrapper:{height:48,width:214,background:e.surface.page,border:`1px solid ${e.regularDividerColor}`,borderRadius:12,padding:"7px 10px 8px 8px",cursor:v?"pointer":"default"},wrapperHoveredStyle:{background:e.surface.wash},iconContainer:{height:32,width:32,minWidth:32,background:e.tint.regular,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"},fileName:{fontSize:14,fontWeight:s().Wy.medium,lineHeight:"18px",color:e.text.primary,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},fileSizeText:{fontSize:12,lineHeight:"15px",color:e.text.secondary},actionMenuHoveredStyle:{background:e.tint.regular}})),[v]),S=(0,u().getIcon)(n);return(0,m.jsx)(a().A,{style:y.wrapper,hoveredStyle:f?y.wrapperHoveredStyle:y.justBackgroundHovered,pressedStyle:f?y.wrapperHoveredStyle:y.justBackgroundHovered,onClick:v,children:(0,m.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,m.jsx)("div",{style:y.iconContainer,children:(0,m.jsx)(c().I,{icon:S,size:"lg",color:"primary"})}),(0,m.jsx)("div",{style:{overflow:"hidden",flexGrow:1},children:(0,m.jsx)(d().A,{renderTooltip:()=>(0,m.jsx)("div",{children:t}),render:e=>(0,m.jsxs)("div",{style:{display:"flex",flexDirection:"column"},...e,children:[(0,m.jsx)("div",{style:y.fileName,children:t}),p&&(0,m.jsx)("span",{style:y.fileSizeText,children:(0,u().formatFileSize)(p)})]})})}),f&&h&&(0,m.jsx)(r().A,{store:f,fadeIn:!1,actionSectionGroupKey:"comment_media",hideFilterActionsInput:!0,style:{borderRadius:l().VJ.md},hoveredStyle:y.actionMenuHoveredStyle})]})})}},369767:(e,t,n)=>{n.r(t),n.d(t,{DiscussionFormat:()=>D,DiscussionLocationToAvatarSize:()=>q,anyDiscussionCommentsLoading:()=>W,commentComparator:()=>N,discussionLocationToDiscussionFormat:()=>Z,formatFileSize:()=>J,getAndSortCommentStoresByTime:()=>P,getDiscussions:()=>F,getDiscussionsForSidebar:()=>U,getFirstComment:()=>E,getIcon:()=>M,getLatestRelevantComment:()=>T,getSetOfUsersInDiscussions:()=>$,hasCommentChanged:()=>G,inputIsEmpty:()=>V,isCommentAllEmojis:()=>O,lineClampForCommentCount:()=>L,sortDiscussionStoresByLatestComment:()=>K});n(898992),n(354520),n(581454),n(737550);var o=()=>n(764880),i=(n(296540),()=>n(340498)),s=n(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"1.79 1.87 16.47 15.5",svg:(0,s.jsx)("path",{d:"M9.66 1.977a.63.63 0 0 1 .785.08l2.647 2.647.08.097a.626.626 0 0 1-.866.867l-.098-.08-1.579-1.58v6.95l6.018 3.475-.577-2.155a.626.626 0 0 1 1.207-.324l.97 3.615.019.121a.625.625 0 0 1-.462.645l-3.614.967a.625.625 0 0 1-.325-1.207l2.158-.579-6.015-3.472-5.97 3.55 2.165.55.118.043a.626.626 0 0 1-.301 1.188l-.125-.02-3.627-.922a.625.625 0 0 1-.451-.76l.921-3.626a.625.625 0 0 1 1.212.308L3.4 14.52l5.98-3.554V4.008L7.8 5.588l-.099.08a.626.626 0 0 1-.786-.964l2.647-2.647z"})},a=(0,i().wt)("arrow3D",r);var l=()=>n(300985),c=()=>n(575157);const d={viewBox:"0 0 20 20",fittedViewBox:"4.12 2.37 11.75 15.25",svg:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("path",{d:"M9.134 5.001c-.236-.667-1.18-.667-1.415 0L6.28 9.084a.5.5 0 1 0 .943.332l.276-.784h1.857l.276.784a.5.5 0 0 0 .944-.332zm-.708 1.001.576 1.63h-1.15zM10.75 5a.5.5 0 0 0 0 1h2.5a.5.5 0 0 0 0-1zm.313 3a.5.5 0 0 1 .5-.5h1.687a.5.5 0 0 1 0 1h-1.687a.5.5 0 0 1-.5-.5M6.75 10.708a.5.5 0 0 0-.5.5v3.715a.5.5 0 0 0 .845.362l1.101-1.05a.25.25 0 0 1 .347.003l.675.657a.5.5 0 0 0 .734-.038l1.189-1.435a.25.25 0 0 1 .375-.01l1.368 1.467a.5.5 0 0 0 .866-.341v-3.33a.5.5 0 0 0-.5-.5zm2.554 2.435a.696.696 0 1 1 0-1.393.696.696 0 0 1 0 1.393"}),(0,s.jsx)("path",{d:"M6.25 2.375A2.125 2.125 0 0 0 4.125 4.5v11c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-11a2.125 2.125 0 0 0-2.125-2.125zM5.375 4.5c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v11a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"})]})},u=(0,i().wt)("docRichText",d);var m=()=>n(177148),p=()=>n(11356),g=()=>n(435644),f=()=>n(421559),v=()=>n(973231),h=()=>n(578717),y=()=>n(916813),S=()=>n(630417),x=()=>n(811563),b=()=>n(919709),w=()=>n(496603),C=()=>n(534177),_=()=>n(939768),I=()=>n(299545),k=()=>n(842677);const A=()=>n(43371),j={doc:c().D,docx:c().D,pages:c().D,md:c().D,txt:c().D,rtf:c().D,xls:f().T,xlsx:f().T,csv:f().T,tsv:f().T,ods:f().T,pdf:u,pptx:p().G,ppt:p().G,zip:h().p,br:h().p,bz2:h().p,gz:h().p,"7z":h().p,dmg:h().p,pkg:h().p,jar:h().p,rar:h().p,tar:h().p,xar:h().p,stl:a,obj:a,fbx:a,amf:a,iges:a,mp3:v().$,m4a:v().$,wav:v().$,aac:v().$,ogg:v().$,flac:v().$,alac:v().$,wma:v().$,exe:n(465505).P,otf:g().a,ttf:g().a,woff:g().a,eof:g().a,py:l().Z,java:l().Z,js:l().Z,ts:l().Z,tsx:l().Z,c:l().Z,h:l().Z,cpp:l().Z,go:l().Z,rs:l().Z,css:l().Z,php:l().Z,swift:l().Z,kt:l().Z,lua:l().Z,m:l().Z,bash_profile:l().Z,bashrc:l().Z,zshrc:l().Z,vimrc:l().Z,vim:l().Z};function M(e){const t=function(e){if(!e)return"";const{pathname:t}=_().qg(e);if(!t)return"";const n=t.split(".");return n[n.length-1]}(e).toLowerCase();return j[t]??m().Y}let D=function(e){return e[e.Menu=0]="Menu",e[e.Page=1]="Page",e[e.Sidebar=2]="Sidebar",e[e.Margin=3]="Margin",e[e.Unfurl=4]="Unfurl",e}({});function T(e){let{recordStore:t,currentUserId:n,timestamp:o}=e;return H({recordStore:t,currentUserId:n,timestamp:o})||E(t)}const B=6,R=3;function L(e){return e>1?R:B}function F(e){return e?I().Bw(e,{recursivelyLoadAllDiscussions:!0,includeLoadingDiscussions:!0}):[]}function U(e){let{blockStore:t,currentUserId:n,ignoreAfterTime:o}=e;if(!t)return[];return I().Bw(t,{recursivelyLoadAllDiscussions:!0,includeLoadingDiscussions:!0,includePropertyDiscussions:!0}).sort(((e,t)=>{const i=T({recordStore:e,currentUserId:n,timestamp:o}),s=T({recordStore:t,currentUserId:n,timestamp:o});return null!=i&&i.isDefined()?null!=s&&s.isDefined()?-(i.getCreatedTime()-s.getCreatedTime()):1:-1}))}function N(e,t){return e&&e.isDefined()?t&&t.isDefined()?e.getCreatedTime()-t.getCreatedTime():1:-1}function P(e){return I().wc(e).sort(((e,t)=>N(e,t)))}function E(e){return P(e)[0]}function z(e){return H({recordStore:e,currentUserId:void 0})}function H(e){let{recordStore:t,currentUserId:n,timestamp:o}=e;const i=I().wc(t).filter((e=>o?e.isDefined()&&e.getCreatedTime()<o:e.isDefined())).sort(((e,t)=>N(e,t)));return i[i.length-1]}function K(e){return e.sort(((e,t)=>N(z(e),z(t))))}function V(e){const t=e.state.textStore.getValue(),n=(e.state.files??[]).length>0,o=t&&t.length>0;return!n&&!o}function G(e,t){const n=e.state.textStore.getValue(),o=e.state.files;if(!t)return n&&0!==n.length||o&&o.length>0;const i=I().gp(t).getValue();return!w().n4(i,n)||function(e,t){const n=e.state.files,o=I().dd(t);if(o.length!==n.length)return!0;return o.some(((e,t)=>e.id!==n[t].id))}(e,t)}function W(e){if(e.some((e=>!e.isReady())))return!0;return!!e.map((e=>I().wc(e))).flat().some((e=>!e.isReady()||!e.getCreatedTime()))}function Z(e){switch(e){case"block_menu":case"ai_reject_all_suggestions":case"reply_menu_mentions_comments":case"reply_menu_all_updates":case"reply_menu_archive":case"reply_menu_updates_sidebar":case"updates_menu_mentions_comments":case"updates_menu_all_updates":case"updates_menu_archive":return D.Menu;case"page_discussion":case"post_top_level_discussion":return D.Page;case"updates_sidebar":return D.Sidebar;case"margin_comments":return D.Margin;case"comment_unfurl":return D.Unfurl;default:(0,C().HB)(e)}}function $(e){return w().hS(w().qI(e,(e=>I().wc(e).map((e=>({store:e,pointer:e.getCreatedByPointer()}))))),(e=>{var t;return null===(t=e.pointer)||void 0===t?void 0:t.id})).filter((e=>(0,C().O9)(e.pointer))).map((e=>{let{store:t,pointer:n}=e;return k().RecordStores.createChildStore(t,n)})).map((e=>e.getModel())).filter(C().O9).map((e=>e instanceof x().F?(0,o().A7)(e):e instanceof S().Hj?(0,o().qt)(e):e instanceof y().T?(0,o().Mq)(e):void(0,C().HB)(e))).filter(C().O9)}function O(e){for(const n of e){if(!n.length)return!1;if(!n[1]||!n[1].some(b().nNl)){var t;const e=n[0].trim(),o=A()();if((null===(t=e.match(o))||void 0===t?void 0:t.join(""))!==e)return!1}}return!0}const q={updates_menu_all_updates:28,updates_menu_mentions_comments:28,updates_menu_archive:28,block_menu:20,reply_menu_all_updates:20,reply_menu_mentions_comments:20,reply_menu_archive:20,reply_menu_updates_sidebar:20,page_discussion:20,post_top_level_discussion:20,updates_sidebar:23,margin_comments:20,comment_unfurl:32,ai_reject_all_suggestions:28};function J(e){return((null==e?void 0:e.match(/[0-9.]+|[a-z]+/gi))??[]).join(" ")}},419123:(e,t,n)=>{n.d(t,{P:()=>d,k:()=>c});n(898992),n(354520);var o=()=>n(56366),i=()=>n(774733),s=()=>n(645873),r=()=>n(217429),a=()=>n(486130),l=()=>n(756214);function c(e){const{navigableBlockStore:t}=e,{value:n}=(0,s().fJ)(i().commentsDependency),r=(0,o().K8)((()=>t&&n?n.discussionHelpers.getDiscussionsForSidebar({blockStore:t,currentUserId:t.userId,ignoreAfterTime:0}):[]),[n,t]);return(0,o().K8)((()=>t&&t.userId?(0,l().R)({userId:t.userId,blockStore:t,discussionStores:r,groupIdsUserIsIn:a()._.getSpacePermissionGroupIds({userId:t.userId,spaceId:t.getSpaceId()})}):[]),[t,r])}function d(e){const{navigableBlockStore:t,forceIncludeDiscussionIds:n}=e,i=c({navigableBlockStore:t});return(0,o().K8)((()=>{const e=r().default.getConfigKey("assume_comment_read","last_seen_at");return i.filter((t=>(null==n?void 0:n.has(t.id))||t.isUnread(e)))}),[i,n])}},457190:(e,t,n)=>{n.d(t,{v:()=>a});var o=()=>n(835338),i=()=>n(848259),s=()=>n(246826),r=()=>n(751156);function a(e){const{environment:t,key:n,selectedKey:a,following:l,followSettings:c,navigableBlockId:d,userId:u,spaceId:m,from:p}=e;r().createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{s().vt({environment:e.environment,table:o().Cy,args:{following:l,followSettings:c,navigableBlockId:d,userId:u,spaceId:m},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),l?i().KN(t,{from:"page_updates"}):i().tm(t,{from:"page_updates"}),a!==n&&i().EV(t,{from:p,navigableBlockId:d,oldSetting:a,newSetting:n})}},518773:(e,t,n)=>{n.d(t,{A:()=>s});var o=()=>n(835338),i=()=>n(534177);function s(e,t){switch(e){case"all":return{following:!0,followSettings:{...(0,o().JY)({explicitly_set_by_user:!0}),feed_setting:t}};case"important":return{following:!0,followSettings:{...(0,o().gK)({explicitly_set_by_user:!0}),feed_setting:t}};case"comments":return{following:!0,followSettings:{...(0,o().lx)({explicitly_set_by_user:!0}),feed_setting:t}};case"none":return{following:!1,followSettings:{...(0,o().gU)({explicitly_set_by_user:!0}),feed_setting:t}};default:(0,i().HB)(e)}}},538075:(e,t,n)=>{n.d(t,{H8:()=>f,I7:()=>h,aE:()=>g});n(296540);var o=()=>n(66689),i=()=>n(959013),s=()=>n(534177),r=()=>n(416726),a=()=>n(457190),l=()=>n(436572),c=()=>n(575143),d=()=>n(765957),u=()=>n(518773),m=n(474848);const p=(0,i().YK)({repliesAndMentions:{id:"pageNotificationSettings.repliesAndMentions.displayName",defaultMessage:"Mentions"},comments:{id:"pageNotificationSettings.comments.displayName",defaultMessage:"Comments"},allUpdates:{id:"pageNotificationSettings.allUpdates.displayName",defaultMessage:"All"},importantUpdates:{id:"pageNotificationSettings.importantUpdates.displayName",defaultMessage:"Important"}});function g(e){switch(e){case"Mentions":return p.repliesAndMentions;case"Comments":return p.comments;case"All":return p.allUpdates;case"Important":return p.importantUpdates;default:return}}function f(e){const{followSettingsKey:t,environment:n,blockStore:s,from:r}=e,a=v({key:"none",selectedKey:t,title:(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),displayName:p.repliesAndMentions,environment:n,blockStore:s,from:r}),l=v({key:"comments",selectedKey:t,title:(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),displayName:p.comments,environment:n,blockStore:s,from:r}),c=v({key:"all",selectedKey:t,title:(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),displayName:p.allUpdates,environment:n,blockStore:s,from:r}),d=s.getAssociatedCollectionStore();if(!d)return[l,a];const u=d.getDatabaseType();if(u===o().dC){return[c,v({key:"important",selectedKey:t,title:(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),displayName:p.importantUpdates,environment:n,blockStore:s,from:r}),a]}if(u===o().Tw){return[c,v({key:"important",selectedKey:t,title:(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),displayName:p.importantUpdates,environment:n,blockStore:s,from:r}),a]}return[c,v({key:"comments",selectedKey:t,title:(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),displayName:p.comments,environment:n,blockStore:s,from:r}),a]}function v(e){const{key:t,title:n,caption:o,selectedKey:i,environment:s,blockStore:p,from:g,displayName:f}=e,v=h({key:t,userSelectedKey:i}),S={icon:{width:14,height:14}};return{action:(0,r().Ls)({key:t,displayName:f,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=d().default.state;if(e){const{following:n,followSettings:o}=(0,u().A)(t),r=e.id,c=p.id,d=p.getSpaceId();a().v({environment:s,following:n,followSettings:o,navigableBlockId:c,spaceId:d,userId:r,from:g,key:t,selectedKey:i}),"inbox"!==g&&"more_menu"!==g||l().rL({item:{label:y(t)},undoFunc:()=>{const{following:e,followSettings:n}=(0,u().A)(i);a().v({environment:s,following:e,followSettings:n,navigableBlockId:c,spaceId:d,userId:r,from:g,key:t,selectedKey:i})}})}},render:e=>(0,m.jsx)(c().A,{...e,title:n,caption:o,shouldWrapCaption:!0,isChecked:v,right:!v&&(0,m.jsx)("div",{style:S.icon}),rightStyle:S.right})}),title:n,isSelectedOption:v}}function h(e){const{key:t,userSelectedKey:n}=e;return"important"===n||"comments"===n?"important"===t||"comments"===t:t===n}function y(e){switch(e){case"none":return(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,m.jsx)(i().sA,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,s().HB)(e)}}},617640:(e,t,n)=>{n.d(t,{m:()=>i});n(296540);var o=n(474848);const i=(0,n(340498).wt)("mention",{viewBox:"0 0 16 16",svg:(0,o.jsx)("path",{d:"M0.870117 8.40625C0.870117 4.01758 3.86426 1.09863 8.14355 1.09863C12.2109 1.09863 15.123 3.68945 15.123 7.6543C15.123 10.293 13.9131 12.1318 11.9443 12.1318C10.8506 12.1318 10.0439 11.5645 9.87988 10.6279H9.79785C9.4082 11.5781 8.62207 12.1318 7.57617 12.1318C5.77148 12.1318 4.53418 10.6143 4.53418 8.42676C4.53418 6.2666 5.76465 4.77637 7.52148 4.77637C8.52637 4.77637 9.36035 5.28906 9.70215 6.12305H9.79102V5.4668C9.79102 5.03613 10.0371 4.77637 10.4473 4.77637C10.8574 4.77637 11.0967 5.03613 11.0967 5.4668V9.85547C11.0967 10.5801 11.4932 11.0039 12.1904 11.0039C13.2363 11.0039 13.8926 9.69141 13.8926 7.74316C13.8926 4.26367 11.3223 2.28125 8.12988 2.28125C4.56836 2.28125 2.18262 4.81055 2.18262 8.44727C2.18262 12.2207 4.69141 14.4629 8.42383 14.4629C9.29883 14.4629 9.94141 14.3398 10.6797 14.1689C10.8164 14.1416 10.9326 14.1279 11.0283 14.1279C11.3428 14.1279 11.5547 14.3398 11.5547 14.6338C11.5547 14.9141 11.3975 15.1533 10.9463 15.3037C10.3242 15.5088 9.31934 15.6523 8.19824 15.6523C3.93262 15.6523 0.870117 12.8975 0.870117 8.40625ZM7.84277 10.9014C8.99805 10.9014 9.73633 9.93066 9.73633 8.41309C9.73633 6.92285 9.00488 5.98633 7.84961 5.98633C6.71484 5.98633 5.99707 6.93652 5.99707 8.44043C5.99707 9.95117 6.70801 10.9014 7.84277 10.9014Z"})})},640753:(e,t,n)=>{n.d(t,{A:()=>X});n(898992),n(354520),n(803949),n(581454),n(814603),n(147566),n(198721);var o=n(296540),i=()=>n(484714),s=()=>n(56366),r=()=>n(401497),a=()=>n(763884),l=()=>n(959013),c=()=>n(496603),d=()=>n(878523),u=()=>n(319975),m=()=>n(725614),p=()=>n(751156),g=()=>n(892632),f=()=>n(780054),v=()=>n(38337),h=()=>n(231722),y=()=>n(24157),S=()=>n(369767),x=()=>n(285790),b=()=>n(859428),w=()=>n(140862),C=n(474848);const _=function(e){const t=(0,i().v3)(),{icon:n,onClick:o,tooltip:s,onMouseDown:r}=e,a=(0,w().A)(!0);return(0,C.jsx)(b().A,{renderTooltip:()=>s,render:e=>(0,C.jsx)(x().A,{ariaLabel:s,icon:n,iconStyle:{width:t.device.isMobile?20:16,height:t.device.isMobile?20:16},style:{marginLeft:t.device.isMobile?16:0},onClick:o,...e,...a,onMouseDown:r})})};const I=function(e){const t=(0,l().tz)(),o=(0,i().v3)(),{device:s}=o,a=(0,w().A)(!0),c=(0,r().IS)((e=>({cancelIcon:{background:e.icon.secondary,borderRadius:"50%",pointerEvents:"auto",height:20,width:20,marginLeft:o.device.isMobile?4:0},cancelIconHovered:{background:e.icon.tertiary}})),[o.device.isMobile]),{canSend:d,visible:u,onSend:m,onCancel:p,isEditing:g,animated:f,onMention:v,onAttach:h,sendTooltip:y}=e;return(0,C.jsx)(n(145214).A,{initial:{opacity:0},exit:{opacity:0,position:"absolute"},animate:{opacity:1},skip:!f,visible:u,style:{display:"flex",flexDirection:"column-reverse",alignItems:"end",pointerEvents:u?void 0:"none",width:"min-content"},children:(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:6},children:[(0,C.jsx)(_,{icon:n(819713).j,onClick:h,tooltip:t.formatMessage({id:"discussionInput.uploadFile.button.tooltip",defaultMessage:"Attach file"}),onMouseDown:e=>{e.preventDefault()}}),!s.isMobileBrowser&&(0,C.jsx)(_,{icon:n(617640).m,onClick:e=>{e.preventDefault(),v()},tooltip:t.formatMessage({id:"discussionInput.insertMention.button.tooltip",defaultMessage:"Mention a person, page, or date"}),onMouseDown:e=>{e.preventDefault()}}),g&&(0,C.jsx)("div",{style:{height:14,marginRight:6},children:(0,C.jsx)(n(802790).A,{type:"vertical",size:1})}),g?(0,C.jsx)(x().A,{ariaLabel:t.formatMessage({id:"discussionInput.cancelButton.ariaLabel",defaultMessage:"Cancel editing comment"}),icon:n(66913).V,color:"primary",onClick:p,iconStyle:{fill:"white",height:o.device.isMobile?18:16,width:o.device.isMobile?18:16},style:c.cancelIcon,hoveredStyle:c.cancelIconHovered,...a}):null,g?(0,C.jsx)(x().A,{ariaLabel:t.formatMessage({id:"discussionInput.updateButton.ariaLabel",defaultMessage:"Update comment"}),icon:n(162402).q,onClick:m,color:d?"uiBluePrimary":"secondary",disabled:!d,iconStyle:{height:o.device.isMobile?23:21,width:o.device.isMobile?23:21},style:{pointerEvents:"auto",marginLeft:o.device.isMobile?16:2,height:24,width:24},...a}):(0,C.jsx)(b().A,{disableTooltip:!(0,n(534177).O9)(y),renderTooltip:()=>(0,C.jsx)(C.Fragment,{children:y}),render:e=>(0,C.jsx)(x().A,{ariaLabel:t.formatMessage({id:"discussionInput.sendButton.ariaLabel",defaultMessage:"Send comment"}),icon:n(102777).b,onClick:m,color:d?"uiBluePrimary":"secondary",disabled:!d,iconStyle:{height:o.device.isMobile?26:24,width:o.device.isMobile?26:24},style:{pointerEvents:"auto",marginLeft:o.device.isMobile?16:0,height:24,width:24},...(0,n(553965).A)(a,e)})})]})})},k=(0,l().YK)({defaultPlaceholder:{defaultMessage:"Add a comment…",id:"discussionInput.defaultPlaceholder.addComment"},pasteFileIntoCommentNotAllowed:{id:"clipboardActions.pasteFileIntoCommentError.message",defaultMessage:"Sorry, you cannot paste files into a comment."},replyInputPlaceholder:{defaultMessage:"Reply...",id:"updateSidebar.placeholder.addComment"}});var A=()=>n(304740),j=()=>n(807683),M=()=>n(360083);function D(e){const{url:t,imageNaturalHeight:n,imageNaturalWidth:i}=e,s=(0,o.useMemo)((()=>({display:"block",width:`min(${i}px, 100%)`,height:`min(${n}px, 100%)`,pointerEvents:"auto",objectFit:"cover"})),[i,n]);return(0,C.jsx)("div",{style:T,children:(0,C.jsx)(j().Ay,{src:t,style:s,placeholderLoadedStyle:{display:"flex",justifyContent:"center",alignItems:"center"}})})}const T={alignSelf:"center",margin:"0 auto",position:"relative",height:"100%",width:"100%",overflow:"hidden"};const B=function(e){let{file:t,isLarge:s}=e;const a=(0,o.useRef)(null),l=(0,i().v3)(),c=(0,r().IS)((e=>({imageThumbnail:{...{border:`1px solid ${e.stroke.secondary}`,borderRadius:8,cursor:"zoom-in"},...s?{objectFit:"contain",width:"auto",height:"auto",maxWidth:240,maxHeight:240,minWidth:48,minHeight:48}:{width:48,height:48}}})),[s]),d=(0,o.useCallback)((()=>{var e;const n=null===(e=a.current)||void 0===e?void 0:e.getImageDimensions();if(!n)return;const{naturalHeight:o,naturalWidth:i}=n;return"local"===t.type?(0,C.jsx)(D,{url:t.dataURL,imageNaturalHeight:o,imageNaturalWidth:i}):(0,C.jsx)(M().A,{url:t.source,render:(e,t)=>(0,C.jsx)(D,{url:t,error:e,imageNaturalHeight:o,imageNaturalWidth:i}),isAuthenticated:!0,permissionRecord:t.store.pointer})}),[t]),u=(0,o.useCallback)((e=>{var t;e.stopPropagation();const o=null===(t=a.current)||void 0===t?void 0:t.getImageDimensions();o&&n(35622).o9({environment:l,renderFullScreenNode:d,fullScreenNodeRect:o.clientRect,contentAspectRatio:o.naturalWidth/o.naturalHeight})}),[d,l]);return"local"===t.type?(0,C.jsx)(j().Ay,{src:t.dataURL,style:c.imageThumbnail,placeholderStyle:c.imageThumbnail,onClick:u,ref:a}):(0,C.jsx)(M().A,{url:t.source,isAuthenticated:!0,permissionRecord:t.store.pointer,render:(e,t)=>(0,C.jsx)(j().Ay,{src:t,style:c.imageThumbnail,placeholderStyle:c.imageThumbnail,onClick:u,ref:a})})};var R=()=>n(165492),L=()=>n(973753),F=()=>n(995847),U=()=>n(704152);function N(e){let{children:t,handleRemoveFileClicked:n}=e;const[s,r]=(0,o.useState)(!1),a=(0,i().v3)(),c=(0,l().tz)(),d=s||a.device.isMobile;return(0,C.jsxs)(U().A,{onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),style:E,hoveredStyle:z,pressedStyle:z,children:[t,d&&(0,C.jsx)(x().A,{icon:F().xMarkSmallIcon,style:P,hasBackground:!0,color:"primary",hovered:!1,showShadow:!0,onClick:n,ariaLabel:c.formatMessage({id:"discussionInputAttachment.removeFileButton.label",defaultMessage:"Remove file"})})]})}const P={position:"absolute",top:-4,right:-3,height:18,width:18,borderRadius:18},E={position:"relative",cursor:"pointer",width:"min-content",height:"min-content",background:"transparent"},z={background:"transparent"},H=3,K=3;function V(e){let{files:t,onRemoveFile:n}=e;const{images:o,nonImages:i}=(0,s().K8)((()=>{const[e,n]=c().jB(t,(e=>function(e){if("local"===e.type){const t=e.file.type,[n]=t.split("/");if("image"===n)return!0}const t=(0,A().WT)({url:"local"===e.type?e.file.name:e.source,baseUrl:f().A.domainBaseUrl,publicDomainName:f().A.publicDomainName});return"image"===t}(e)&&"local"===e.type&&e.dataURL));return{images:e,nonImages:n}}),[t]);return(0,C.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:4,marginTop:4},children:[(0,C.jsx)(G,{files:o,onRemoveFile:n}),(0,C.jsx)(W,{files:i,onRemoveFile:n})]})}function G(e){let{files:t,onRemoveFile:n}=e;return 0===t.length?null:t.length<=H?(0,C.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:t.map((e=>(0,C.jsx)(N,{handleRemoveFileClicked:()=>n(e),children:(0,C.jsx)(B,{file:e,isLarge:!0})},e.id)))}):(0,C.jsx)(L().A,{children:t.map((e=>(0,C.jsx)(N,{handleRemoveFileClicked:()=>n(e),children:(0,C.jsx)(B,{file:e,isLarge:!1})},e.id)))})}function W(e){let{files:t,onRemoveFile:n}=e;if(0===t.length)return null;const o=t.map((e=>{const t=e.name??"",o="remote"===e.type?e.source:t,i=e.size??"";return(0,C.jsx)(N,{handleRemoveFileClicked:()=>n(e),children:(0,C.jsx)(R().A,{title:t,source:o,size:i,showBlockActionMenuButton:!1})},e.id)}));return t.length<=K?(0,C.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:o}):(0,C.jsx)(L().A,{children:o})}const Z=o.forwardRef((function(e,t){var x;const b=(0,i().v3)(),{device:w,currentUser:_}=b,{onFileUploaded:A}=e,[j,M,D]=(0,s().$y)(e.discussionInputStore),{textStore:T,files:B}=j,R=(0,s().K8)((()=>T.getValue()),[T]),[L,F]=(0,o.useState)(!1),U=(0,o.useRef)(null),{commentStore:N,adjustWidthForDraftDiscussions:P,dontMoveCursorToInputEndOnFocus:E}=e,z=e.discussionFormat!==S().DiscussionFormat.Page;(0,o.useImperativeHandle)(t,(()=>({uploadFiles:ee})));const H=(0,s().K8)((()=>(0,n(186445)._m)(b)),[b]),K=(0,o.useRef)(null===(x=e.blockStore)||void 0===x?void 0:x.clone()),G=(0,s().K8)((()=>{const e=y().default.state;return"editing"===e.mode&&(0,h().KP)(e.multiSelection)&&e.multiSelection.start.store===T}),[T]),W=(0,s().K8)((()=>({isEmpty:(0,S().inputIsEmpty)(D),hasChanged:(0,S().hasCommentChanged)(D,N),hasNewLineCharacter:D.hasNewLineCharacter()})),[D,N]),Z=(0,s().K8)((()=>G||!W.isEmpty),[W.isEmpty,G]),X=(0,o.useCallback)((async()=>{const e=y().default.state;"editing"===e.mode&&(0,h().KP)(e.multiSelection)&&e.multiSelection.start.store===T||(m().setSelectionAtEnd({store:T}),await n(908006).default.afterNextFlush())}),[T]),Q=(0,s().K8)((()=>Boolean(e.blockStore&&(0,n(337567).dL)(e.blockStore))),[e.blockStore]),ee=(0,o.useCallback)((async e=>{if(await X(),B.length+e.length>10)return void n(901389).f1((0,C.jsx)(l().sA,{id:"discussionInput.uploadFile.tooManyFilesErrorMessage",defaultMessage:"You cannot upload more than {maxFiles} files per comment.",values:{maxFiles:10}}));const t=e.map(g().x9);M({...j,files:[...B,...t]}),null==A||A()}),[X,B,M,j,A]),te=e.discussionFormat===S().DiscussionFormat.Margin,ne=e.discussionFormat===S().DiscussionFormat.Sidebar;(0,o.useEffect)((()=>{e.commentStore&&n(182034).e(D,e.commentStore)}),[D,e.commentStore]);const oe=(0,o.useRef)(!1),ie=(0,o.useCallback)((t=>{t?a().K.set({userId:_.id,key:Y(e.parentStore.id,e.inReplyToDiscussionId),value:t??null}):a().K.remove({userId:_.id,key:Y(e.parentStore.id,e.inReplyToDiscussionId)})}),[_.id,e.inReplyToDiscussionId,e.parentStore.id]);(0,o.useEffect)((()=>{e.shouldSaveUnsentComments&&oe.current&&ie(R),oe.current=!0}),[e.shouldSaveUnsentComments,ie,R]);const se=(0,o.useRef)(T);(0,o.useEffect)((()=>{if(!n(263711).g.state.isOpen&&e.shouldSaveUnsentComments){const t=a().K.get({userId:_.id,key:Y(e.parentStore.id,e.inReplyToDiscussionId)});t&&p().createAndCommit({userAction:"DiscussionInput.willMount",environment:b,canUndo:!0,perform:e=>{u().R9({environment:b,store:se.current,value:t,transaction:e})}})}}),[b,_.id,e.inReplyToDiscussionId,e.parentStore.id,e.shouldSaveUnsentComments]);const re=(0,o.useRef)(B);(0,o.useEffect)((()=>{re.current=B}),[B]),(0,o.useEffect)((()=>()=>{re.current&&re.current.forEach((e=>{"local"===e.type&&e.dataURL&&URL.revokeObjectURL(e.dataURL)}))}),[]),(0,o.useEffect)((()=>{if(!K.current||!L)return;const e=n(695625).T.findSelectableFromStore(K.current);e&&n(620689).pb({environment:b,handle:e,vertical:{reveal:"bottom"},horizontal:{reveal:"closest"},animate:!0})}),[b,L]);const ae=(0,o.useCallback)((()=>{var e;return null===(e=U.current)||void 0===e?void 0:e.focus()}),[]),{autoFocus:le=!1}=e;(0,n(852507).l)((()=>{le&&ae()}));const ce=B&&B.length>0,de=e.discussionFormat===S().DiscussionFormat.Menu&&e.inReplyToDiscussionId,ue=!e.disableFocusRing&&!de&&(ne||te&&!e.isNewComment),me=void 0!==e.showCtaButtons?e.showCtaButtons:e.isEditingExistingComment||Z||L,pe=!e.isMobileSlideUpMenu,ge=(te||ne)&&!e.isNewComment,fe=(0,r().IS)((e=>({inputWrapper:{display:"flex",width:P?"calc(100% + 6px)":"100%",fontSize:14,borderRadius:6,transition:"background 300ms ease",cursor:me?"text":"pointer",alignSelf:"center",position:"relative",flexWrap:"wrap",justifyContent:"flex-end",background:"transparent",alignItems:"center",rowGap:4,columnGap:6,padding:"3.5px 4px 3px 4px",margin:"-3.5px -4px 0 -4px"},textFieldStyle:{fontSize:14,maxHeight:w.isMobileNative?"50vh":"70vh",WebkitOverflowScrolling:"touch",userSelect:"auto",WebkitUserSelect:"auto",lineHeight:"20px",overflow:"auto",whiteSpace:"pre-wrap",padding:"2.5px",margin:"-2.5px"},textFieldWrapper:{flexGrow:1,display:"flex",minHeight:24,paddingTop:2,width:W.hasNewLineCharacter||f().A.isMobile?"100%":""}})),[P,me,w.isMobileNative,W.hasNewLineCharacter]),ve=(0,s().K8)((()=>0===(T.getValue()||[]).length),[T]),he=function(e){const{isEditing:t,onEditPreviousComment:n,textRef:o}=e;if(!t)return{};const i=e=>{"key"in e&&(e.metaKey||e.ctrlKey)&&o.current&&m().setSelectionAtStart({store:o.current.getProps().store})},s=e=>{"key"in e&&(e.metaKey||e.ctrlKey)&&o.current&&m().setSelectionAtEnd({store:o.current.getProps().store})};return{onUp:n??i,onDown:s}}({isEditing:G,shouldTrapCursorInInput:z,onEditPreviousComment:ve?e.onEditPreviousComment:void 0,textRef:U}),ye=()=>{ie(void 0),e.onSubmit()},Se=(0,C.jsx)(I,{visible:me,onAttach:async()=>{const e=await g().dA({environment:b,supportsMobileNativeFileUpload:!0,multiple:!0});await ee(e),d().Sd(b,{type:"file_picker"})},onMention:async()=>{await X(),n(829300).Gf({environment:b,mentionTypes:{page:!0,heading:!0,createPage:!1,user:!0,inviteUserToWorkspace:!0,inviteUserToPage:!0,bot:!0,date:!0,reminder:!1,templateVariable:!1,group:!0,team:!0,formulaContextVariable:!1,slackSpecialMention:!1}})},canSend:!W.isEmpty&&!Q,onSend:ye,onCancel:e.onCancel,isEditing:e.isEditingExistingComment||!1,animated:Boolean(te||f().A.isMobile),inline:!0,sendTooltip:Q?(0,C.jsx)(l().sA,{id:"discussionInput.cannotSubmitBecauseOfAIEdits",defaultMessage:"Resolve pending edits before commenting"}):void 0});return(0,C.jsx)(n(545805).A,{debugName:"DiscussionInput",capture:G,onCommandEnter:c().D_,children:(0,C.jsx)(J,{enabled:Boolean(K.current)&&Boolean(e.canDrop),store:K.current,onNativeDrop:async e=>{let{files:t}=e;await ee(t),d().Sd(b,{type:"drop"})},children:(0,C.jsx)("div",{className:e.isEditingExistingComment?v().d1T:v().rgg,style:{...$,...e.containerStyle||{}},onFocus:t=>{const o=t.target;var i;o instanceof HTMLElement&&(0,n(819121).p)(o)&&(null===(i=e.onFocus)||void 0===i||i.call(e),F(!0))},onBlur:t=>{var n;null===(n=e.onBlur)||void 0===n||n.call(e),F(!1)},children:(0,C.jsxs)("div",{style:O,children:[e.showAvatar&&(0,C.jsx)(n(453697).A,{userStore:H,size:n(848565).eQ,avatarShouldShowShadow:!1,style:{...q,marginTop:0,marginRight:8}}),(0,C.jsxs)("div",{className:ue?v().CCX:"",onClick:ae,style:fe.inputWrapper,tabIndex:-1,children:[(0,C.jsx)("div",{dir:"auto",style:fe.textFieldWrapper,children:(0,C.jsx)(n(524702).A,{style:fe.textFieldStyle,store:T,parentStore:e.parentStore,disabled:!1,onEnter:()=>{if(!f().A.isMobile)return void ye();const e="editing"===y().default.state.mode&&y().default.state.multiSelection;e&&p().createAndCommit({userAction:"DiscussionInput.handleEnter",environment:b,canUndo:!0,perform:t=>{u().$D({environment:b,editorMode:"default",string:"\n",multiSelection:e,disableMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}})},onCommandEnter:ye,onPasteFiles:async e=>{await ee(e.files),d().Sd(b,{type:"paste"})},onEsc:e.onCancel,...he,placeholder:n(972435).A.formatMessage(ge?k.replyInputPlaceholder:k.defaultPlaceholder),ref:U,isDiscussionInput:!0,disableSlashCommands:!0,disableInsertText:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEmbedMenu:!0,disabledMentionTypes:{reminder:!0},disableMobileActionBar:!0,disableStyleAnnotations:w.isMobileBrowser,disableInsertedDeletedAnnotations:w.isMobileBrowser,pasteBehavior:"inline",inPageFind:n(792540).Os.none,className:"discussion-input-text-block",disableMoveCursorToEndOnFocus:E})}),ce&&(0,C.jsx)(V,{files:B,onRemoveFile:e=>{const t=D.state;D.setState({...t,files:t.files.filter((t=>t.id!==e.id))})}}),Se]}),pe&&(0,C.jsx)(n(594739).A,{show:G,onDismiss:()=>m().clear({environment:b})})]})})})})})),$={display:"flex",flexDirection:"column",width:"100%",cursor:"pointer"},O={display:"flex",alignItems:"center",flexGrow:1},q={flexShrink:0,flexGrow:0,marginRight:6,alignSelf:"flex-start",marginTop:6};function J(e){const{enabled:t,children:o,store:i,onNativeDrop:s}=e;return t&&i?(0,C.jsx)(n(199896).Ay,{store:i,analyticsName:"discussion_input",canNativeDropOnto:!0,onNativeDrop:s,keepTextSelectionOnDrop:!0,shouldShowDropZone:!0,children:o}):(0,C.jsx)(C.Fragment,{children:o})}function Y(e,t){return t?`UnsentDiscussion-${e}-${t}`:`UnsentDiscussion-${e}`}const X=o.memo(Z)},756214:(e,t,n)=>{n.d(t,{R:()=>r});n(898992),n(354520),n(581454),n(737550);var o=()=>n(919709);function i(e){const{userId:t,isFollowingPage:n,discussions:i,discussionToComments:s,groupIdsUserIsIn:r,includeDiscussionsWhereUserOnlyAuthor:a}=e,l=n?i:i.filter((e=>function(e){const{userId:t,comments:n,groupIdsUserIsIn:i}=e;return Boolean(n.some((e=>e.getCreatedById()===t||function(e){const{userId:t,comment:n,groupIdsUserIsIn:i}=e,s=o().Fbh(n.getText());if(s.includes(t))return!0;const r=o().FAS(n.getText());if(r.some((e=>i.has(e.groupId))))return!0;return!1}({userId:t,comment:e,groupIdsUserIsIn:i}))))}({userId:t,comments:s(e),groupIdsUserIsIn:r})));return a?l:l.filter((e=>function(e){const{userId:t,comments:n}=e;return Boolean(n.some((e=>e.getCreatedById()&&e.getCreatedById()!==t)))}({userId:t,comments:s(e)})))}var s=()=>n(534177);function r(e){var t;const{userId:n,blockStore:o,discussionStores:r,groupIdsUserIsIn:a}=e;return i({userId:n,isFollowingPage:Boolean(null===(t=o.getFollowStore())||void 0===t||null===(t=t.getModel())||void 0===t?void 0:t.isFollowingAllComments()),discussions:r,discussionToComments:e=>e.getCommentStores().map((e=>e.getModel())).filter(s().O9),groupIdsUserIsIn:a,includeDiscussionsWhereUserOnlyAuthor:!0})}},789557:(e,t,n)=>{n.d(t,{DZ:()=>T,E3:()=>j,L6:()=>D,QA:()=>k,Tu:()=>A,lV:()=>M});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949);var o=()=>n(908006),i=()=>n(785082),s=()=>n(955825),r=()=>n(496603),a=()=>n(878523),l=()=>n(112873),c=()=>n(722101),d=()=>n(246826),u=()=>n(620689),m=()=>n(255460),p=()=>n(319975),g=()=>n(751156),f=()=>n(892632),v=()=>n(299545),h=()=>n(906537),y=()=>n(630116),S=()=>n(606846),x=()=>n(374026),b=()=>n(807060),w=()=>n(337090),C=()=>n(855821),_=()=>n(741817),I=()=>n(301523);function k(e){var t,n;const{environment:o,store:s,text:r,files:l,transaction:c,discussionLocation:d,property_id:u,blockStore:m}=e,g=v().eK(s);if(!g)return;const{filesToCreate:f,fileStoresToDelete:h}=function(e,t){const n=[],o=new Set;t.forEach((e=>{"local"===e.type?n.push(e.file):o.add(e.id)}));const i=v().dd(e),s=i.filter((e=>e.getAlive()&&!o.has(e.id)));return{filesToCreate:n,fileStoresToDelete:s}}(s,l);D({commentStore:s,fileBlocks:h,transaction:c}),(0,C().t)({commentStore:s,files:f,environment:o,transaction:c});const y=v().gp(s);p().R9({environment:o,store:y,value:r,transaction:c}),(0,I().x)(s,c);const x=null==s||null===(t=s.getParentStore())||void 0===t?void 0:t.getParentStore(),w=i().eR.includes(d),_=null==g||null===(n=g.getParentStore())||void 0===n?void 0:n.getNavigableBlockStore(),{property_type:k,collection_id:A,collection_view_id:j,view_type:M,collection_view_block_id:T}=(0,b().q)(u,m);a().ZM(o,{from:d,comment_id:s.id,discussion_id:g.id,discussion_type:g.getType(),parent_block_id:g.getParentId(),parent_collection_id:null==x?void 0:x.getParentCollectionIdUpToTwoLevels(),...w&&{inbox_session_id:S().Ay.state.sessionId,notification_page_id:null==_?void 0:_.id},property_type:k,collection_id:A,collection_view_id:j,view_type:M,collection_view_block_id:T})}function A(e){var t,n;const{environment:o,commentStore:s,transaction:r,discussionLocation:l}=e,c=v().eK(s);if(!c)return;const u=v().uB(c),m=u.getValue();if(!m)return;D({commentStore:s,fileBlocks:v().dd(s),transaction:r}),d().zv({store:s,transaction:r,data:{alive:!1}}),g().applyOperation({store:u,operation:{pointer:u.pointer,path:u.path,command:"listRemove",args:{id:s.id}},transaction:r}),(0===m.length||1===m.length&&m[0]===s.id)&&(0,_().v)({environment:o,discussionStore:c,transaction:r}),(0,I().x)(s,r);const p=i().eR.includes(l),f=null==c||null===(t=c.getParentStore())||void 0===t?void 0:t.getNavigableBlockStore();a().gN(o,{from:e.discussionLocation,discussion_id:c.id,discussion_type:c.getType(),comment_id:s.id,parent_block_id:c.getParentId(),parent_collection_id:null===(n=c.getParentStore())||void 0===n?void 0:n.getParentCollectionIdUpToTwoLevels(),...p&&{inbox_session_id:S().Ay.state.sessionId,notification_page_id:null==f?void 0:f.id}})}function j(e){var t,n;const{environment:o,commentStore:s,discussionStore:r,transaction:l,discussionLocation:c}=e;d().zv({store:r,data:{resolved:!1},transaction:l});const u=i().eR.includes(c),m=null==r||null===(t=r.getParentStore())||void 0===t?void 0:t.getNavigableBlockStore();a().Jg(o,{comment_id:s.id,discussion_id:r.id,from:e.discussionLocation,parent_block_id:r.getParentId(),parent_collection_id:null===(n=r.getParentStore())||void 0===n?void 0:n.getAssociatedCollectionId(),...u&&{inbox_session_id:S().Ay.state.sessionId,notification_page_id:null==m?void 0:m.id}})}function M(e){var t,n;const{environment:o,discussionStore:s,textValue:l,transaction:c,files:d,property_id:u,blockStore:m}=e,{id:p}=o.currentUser;if(!p)return;const g=f().JC(d);if(r().n4(l,[])&&0===g.length)return;const v=(0,w().G)({discussionStore:s,text:l,files:g,markDiscussionRead:!0,environment:o,transaction:c}),h=i().eR.includes(e.discussionLocation),y=null===(t=s.getParentStore())||void 0===t?void 0:t.getNavigableBlockStore(),{property_type:x,collection_id:C,collection_view_id:_,view_type:I,collection_view_block_id:k}=(0,b().q)(u,m);a().mw(o,{from:e.discussionLocation,comment_id:v.id,discussion_id:s.id,discussion_type:s.getType(),parent_block_id:s.getParentId(),parent_collection_id:null==s||null===(n=s.getParentStore())||void 0===n?void 0:n.getParentCollectionIdUpToTwoLevels(),...h&&{inbox_session_id:S().Ay.state.sessionId,notification_page_id:null==y?void 0:y.id},property_type:x,collection_id:C,collection_view_id:_,view_type:I,collection_view_block_id:k})}function D(e){const{commentStore:t,fileBlocks:n,transaction:o}=e,i=v().eP(t);n.forEach((e=>{d().zv({store:e,data:{alive:!1},transaction:o}),c().TF({parentStore:i,childToRemoveStore:e,transaction:o})}))}async function T(e){var t;let{discussionStore:n,currentBlockStore:i,environment:r,analyticsFrom:a,currentEl:c}=e;if(!i)return null;if(!n.isDefined())return;function d(e){const t=(0,x().S)({discussionId:n.id,blockId:e});if(!t)return;const o=document.getElementsByClassName((0,s().wV)({discussionId:n.id}))[0];return o?u().hT({element:o,environment:r,scrollerContext:t.getScrollerContext(),vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}):u().pb({environment:r,handle:t,vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}),t.displaySelectionHalo(750),t}const p=(null===(t=n.getRecordStoreUIParent())||void 0===t?void 0:t.id)??n.getParentId();d(p)||(await m().NH(i,[p]),await o().default.afterNextFlush(),d(p));const g=y().Bv.createChildStore(i,n.getParentPointer()),f=h().get(),v=null==f?void 0:f.commonAncestorContainer,S=!(null!=f&&f.collapsed)&&v&&(c===v||(null==c?void 0:c.contains(v)));l().B4({environment:r,blockStore:g||i,analyticsFrom:a,discussionIds:[n.id],shouldFocusDiscussion:!S,recursivelyLoadAllDiscussions:!1})}},846583:(e,t,n)=>{n.d(t,{A:()=>w,T:()=>C});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(296540);var o=()=>n(662303),i=()=>n(56366),s=()=>n(401497),r=()=>n(700500),a=()=>n(713998),l=()=>n(313028),c=()=>n(601813),d=()=>n(792071),u=()=>n(179034),m=()=>n(797809),p=()=>n(919709),g=()=>n(959013),f=()=>n(381349),v=()=>n(284371),h=()=>n(710648),y=()=>n(972435),S=()=>n(105157),x=n(474848);const b=new Set([r().xd.toggle,r().xd.bulletedList,r().xd.numberedList,r().xd.quote,r().xd.toDo,r().xd.code,r().xd.callout,r().xd.header,r().xd.subHeader,r().xd.subSubHeader,r().xd.tableRow]);function w(e){const t=(0,s().DP)(),n=(0,g().tz)(),f=(0,i().K8)((()=>{var t;return e.store.isDefined()?null===(t=e.store.getParentStore())||void 0===t?void 0:t.getValue():null}),[e.store]),w=(0,i().K8)((()=>e.blockStore.getSpaceId()),[e.blockStore]),_=(0,i().K8)((()=>{const t=e.store.getParentStore();if(null==t||!t.isType("alias"))return;const n=t.getAliasTargetStore();return(null==n?void 0:n.table)===u().ev&&n.isFormBlock()?{store:n,value:n.getValue()}:void 0}),[e.store]);let I=(0,i().K8)((()=>{if(!e.store.isDefined())return;const t=e.store.getContext(),o=t?(0,c().l8)({discussionContextData:t,discussionType:e.store.getType(),discussionId:e.store.id,intl:n}):void 0;if(!o)return;let i=p().JJ$(o,(t=>!p().iQL(t)||p().Orm(t)===e.store.id));return p().AhH(i)>50&&(i=p().JG8(i,50),i.push((0,p().Ey_)("…"))),i}),[e.store,n]);const k=(0,i().K8)((()=>{const t=e.blockStore.getAssociatedCollectionStore();if(!t||"collection"!==t.table)return;const n=t.getSchema(),o=e.store.getPropertyId();return void 0!==o?(0,a()._g)({schema:n,property:o}):void 0}),[e.blockStore,e.store]),A=n=>{let{textValue:i,propertySchema:s,discussionParentValue:a}=n;const c=(0,x.jsx)("div",{style:{overflow:"hidden",lineHeight:"18px",maxHeight:72},children:(0,x.jsx)(h().vY,{value:{value:i,spaceId:w},propertySchema:s,labeled:!1,rootStore:e.blockStore,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0})});if(!a)return c;const d=a.type;return d===r().xd.code?(0,x.jsx)(l().A,{title:(0,h().Ab)(a),theme:t,style:{marginTop:0,marginBottom:0},children:(0,x.jsx)("span",{style:{fontFamily:v().vc(o().locale).mono,fontSize:12,tabSize:2},children:c})}):(0,h().ux)(d)?(0,x.jsx)(l().A,{title:(0,h().ux)(d),theme:t,style:{marginTop:0,marginBottom:0},children:c}):c},j={display:"flex",width:"100%",marginTop:6,marginBottom:6,fontSize:13,color:t.text.secondary};function M(e){I||(I=[[""]]);const t=(0,m().RX)(y().A.getIntl()).title;return t?(0,x.jsx)("div",{style:j,children:(0,x.jsxs)("div",{style:{display:"flex",width:"100%"},children:[(0,x.jsx)(C,{}),k&&(0,x.jsx)(S().A,{propertySchema:k,dontShowColon:""===I[0][0]}),A({textValue:I,discussionParentValue:e,propertySchema:t})]})}):null}if("updates_sidebar"===e.discussionLocation){if(!f)return null;if("text"!==f.type&&void 0===k){const t=null!=_&&_.value?_.value:f,n=null!=_&&_.store?_.store:e.blockStore;return(0,x.jsx)("div",{onClick:e.onClick,style:{display:"flex",cursor:d().Bj6.fromBlock(f).isType(r().Si)?"text":void 0},children:I&&b.has(f.type)?M(f):(0,x.jsxs)("div",{style:j,children:[(0,x.jsx)(C,{}),(0,x.jsx)(h().Ay,{blockValue:t,rootStore:n,blockPreviewLocation:"comments_sidebar"})]})})}}return(0,x.jsx)("div",{onClick:e.onClick,style:{cursor:"text"},children:M()})}function C(){const e=(0,s().IS)((e=>({bar:{width:2,marginLeft:1,borderRadius:4,marginRight:8,background:(0,f().eb)(e.mode),flexShrink:0}})),[]);return(0,x.jsx)("div",{style:e.bar})}},973231:(e,t,n)=>{n.d(t,{$:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.62 2.52 14.76 14.95",svg:(0,n(474848).jsx)("path",{d:"M8.65 2.525c.345 0 .625.28.625.625v13.7a.625.625 0 1 1-1.25 0V3.15c0-.345.28-.625.625-.625M6.575 5.45a.625.625 0 1 0-1.25 0v9.1a.625.625 0 1 0 1.25 0zm-2.7 3.2a.625.625 0 0 0-1.25 0v2.7a.625.625 0 1 0 1.25 0zm10.8-2.7a.625.625 0 1 0-1.25 0v8.1a.625.625 0 0 0 1.25 0zm2.075 2.075c.345 0 .625.28.625.625v2.7a.625.625 0 1 1-1.25 0v-2.7c0-.345.28-.625.625-.625m-4.775-.775a.625.625 0 1 0-1.25 0v5.5a.625.625 0 1 0 1.25 0z"})},i=(0,n(340498).wt)("waveform",o)},973753:(e,t,n)=>{n.d(t,{A:()=>b});var o=n(296540),i=()=>n(484714),s=()=>n(56366),r=()=>n(401497),a=()=>n(62900),l=()=>n(569397),c=()=>n(959013),d=()=>n(285790),u=()=>n(8980),m=()=>n(2143),p=()=>n(728611),g=()=>n(953418),f=()=>n(141333),v=()=>n(756279),h=()=>n(17090),y=n(474848);const S=.8,x=(0,c().YK)({scrollLeftButtonAriaLabel:{defaultMessage:"Scroll left",id:"FilmStrip.scrollLeftButtonAriaLabel"},scrollRightButtonAriaLabel:{defaultMessage:"Scroll right",id:"FilmStrip.scrollRightButtonAriaLabel"}});function b(e){let{children:t,shouldShowGrayFog:n}=e;const b=(0,c().tz)(),w=(0,o.useRef)(null),C=(0,i().v3)(),_=(0,s().uB)(void 0,h().A),I=(0,s().K8)((()=>_.state.elementRef),[_]),k=(0,f().HD)(I),A=(0,f().Xg)(I),j=(0,f().sj)(I),M=(0,o.useCallback)((()=>{var e;null===(e=w.current)||void 0===e||e.getClientRect()}),[]);(0,o.useEffect)((()=>(p().P4(window,"resize",M),()=>{p().Ol(window,"resize",M)})),[M]),(0,o.useEffect)((()=>{M()}),[M]);const D=j>0,T=Math.ceil(j+k)<A,B=(0,o.useCallback)((e=>{var t;e.stopPropagation(),g().HN({element:null===(t=w.current)||void 0===t?void 0:t.getNode(),environment:C,options:{left:-S*k,behavior:"smooth"}})}),[k,C]),R=(0,o.useCallback)((e=>{var t;e.stopPropagation(),g().HN({element:null===(t=w.current)||void 0===t?void 0:t.getNode(),environment:C,options:{left:S*k,behavior:"smooth"}})}),[k,C]),L=(0,r().IS)((e=>({scrollerWrapper:{display:"flex",position:"relative"},scroller:{overflow:"auto",display:"flex",gap:4,zIndex:0,paddingTop:6,marginTop:-6,paddingRight:4},commonArrowStyles:{position:"absolute",borderRadius:12,width:24,height:24,background:e.tint.regular,top:12,boxShadow:"none"},iconHoveredStyle:{background:e.tint.regular},leftArrowStyle:{left:0},rightArrowStyle:{right:4},leftArrowContainer:{position:"absolute",height:"100%",width:30,background:`linear-gradient(to right, ${n?e.hoveredMarginDiscussionBackground:e.selectedMarginDiscussionBackground} 0px, ${e.contentBackgroundTransparent} 30px`},rightArrowContainer:{position:"absolute",height:"100%",width:30,right:0,background:`linear-gradient(to left, ${n?e.hoveredMarginDiscussionBackground:e.selectedMarginDiscussionBackground} 0px, ${e.contentBackgroundTransparent} 30px`}})),[n]);return(0,y.jsxs)("div",{style:L.scrollerWrapper,children:[(0,y.jsx)(m().H,{ref:w,type:v().A.X,store:_,onScroll:M,style:L.scroller,children:t}),D&&(0,y.jsx)("div",{style:L.leftArrowContainer,children:(0,y.jsx)(d().A,{icon:()=>(0,y.jsx)(u().I,{icon:a().n,size:"sm",color:"secondary"}),hovered:!1,showShadow:!0,onClick:B,ariaLabel:b.formatMessage(x.scrollLeftButtonAriaLabel),style:{...L.commonArrowStyles,...L.leftArrowStyle},hoveredStyle:L.iconHoveredStyle})}),T&&(0,y.jsx)("div",{style:L.rightArrowContainer,children:(0,y.jsx)(d().A,{icon:()=>(0,y.jsx)(u().I,{icon:l().C,size:"sm",color:"secondary"}),hovered:!1,showShadow:!0,onClick:R,ariaLabel:b.formatMessage(x.scrollRightButtonAriaLabel),style:{...L.commonArrowStyles,...L.rightArrowStyle},hoveredStyle:L.iconHoveredStyle})})]})}}}]);