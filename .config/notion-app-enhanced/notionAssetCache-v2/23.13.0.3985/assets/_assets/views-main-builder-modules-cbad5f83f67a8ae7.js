"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[70605],{3197:(e,t,o)=>{o.d(t,{t:()=>s});var n=o(296540),r=()=>o(183558),a=()=>o(248064),i=()=>o(384130),l=()=>o(937199);function s(e){const{setModuleSelection:t,layoutStore:o}=(0,l().LH)(),s=(0,a().h)(),{dismissTooltip:d}=(0,i().J)();return(0,n.useCallback)((()=>{var n;"form"===(null===(n=o.getModel())||void 0===n?void 0:n.getLayoutType())&&"form_conditional_modules"!==e.area?s({layoutModule:{type:"placeholder",id:(0,r().Ay)()},position:e.afterModuleId?{type:"module_relative",area:e.area,direction:"below",relativeToModuleId:e.afterModuleId}:void 0}):(t({type:"new_module",isDragging:!1,..."views_main_tab_modules"===e.area?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:e.area}}),"page_main"===e.area&&d())}),[o,e,s,t,d])}},158359:(e,t,o)=>{o.d(t,{P:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("arrowDown",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 1.57715C7.5625 1.57715 7.25488 1.88477 7.25488 2.33594V10.8262L7.30957 12.3027L5.50488 10.2861L3.95312 8.75488C3.82324 8.625 3.63184 8.53613 3.42676 8.53613C3.0166 8.53613 2.70898 8.85059 2.70898 9.26758C2.70898 9.46582 2.78418 9.64355 2.94141 9.80762L7.44629 14.3193C7.59668 14.4697 7.79492 14.5586 8 14.5586C8.20508 14.5586 8.40332 14.4697 8.55371 14.3193L13.0586 9.80762C13.2158 9.64355 13.291 9.46582 13.291 9.26758C13.291 8.85059 12.9902 8.53613 12.5801 8.53613C12.3682 8.53613 12.1836 8.625 12.0469 8.75488L10.4951 10.2861L8.69043 12.2959L8.74512 10.8262V2.33594C8.74512 1.88477 8.44434 1.57715 8 1.57715Z"})})},248064:(e,t,o)=>{o.d(t,{h:()=>s});var n=o(296540),r=()=>o(484714),a=()=>o(56366),i=()=>o(978846),l=()=>o(937199);function s(){const{layoutStore:e,currentModuleSelection:t,setModuleSelection:o,sessionId:s}=(0,l().LH)(),d=(0,r().v3)(),c=(0,a().K8)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e]),p="form"===c?"form_layout_schema":"new_module"===(null==t?void 0:t.type)?t.area:void 0;return(0,n.useCallback)((n=>{const{layoutModule:r,transaction:a}=n;if(!e.getModel()||!p||"form_conditional_modules"===p)return;let l;if("form"===c)l=n.position??{type:"area_relative",area:"form_layout_schema",location:"end_moveable"};else{if("new_module"!==(null==t?void 0:t.type))return;if("form_conditional_modules"===t.area)return;l="views_main_tab_modules"===t.area?{type:"area_relative",area:t.area,viewId:t.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:t.area,location:"end_moveable"}}(0,i().UQ)({environment:d,sessionId:s,layoutStore:e,position:l,module:r,transaction:a,isPropertyCreation:!1}),o({type:"existing_module",moduleId:r.id,isDragging:!1})}),[p,t,d,e,c,s,o])}},290966:(e,t,o)=>{o.d(t,{E_:()=>T,HQ:()=>L,I5:()=>D,ZQ:()=>A});o(16280),o(898992),o(823215),o(354520),o(581454),o(296540);var n=()=>o(662303),r=()=>o(536095),a=()=>o(134025),i=()=>o(912720),l=()=>o(179034),s=()=>o(519831),d=()=>o(869558),c=()=>o(144081),p=()=>o(921515),m=()=>o(959013),u=()=>o(496603),y=()=>o(534177),f=()=>o(284371),v=()=>o(966759),w=()=>o(235191),g=()=>o(901389),h=()=>o(751156),b=()=>o(67103),_=()=>o(16006),S=()=>o(972435),C=()=>o(470928),I=()=>o(630116),x=()=>o(913454),M=()=>o(204067),k=o(474848);function A(e){let{transaction:t,collectionStore:o,templateId:n,instance:r,logger:m}=e;m.debug(`Creating/updating ${p().rM} record for "${n}".`);const u=o.getSpaceId(),f=r.id;if("automation"===r.type){const e={table:i().yB,id:f,spaceId:u};h().applyOperation({store:I().dn.createChildStore(o,e),operation:a().op.set({pointer:e,path:["properties","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("block"===r.type){const e={table:l().ev,id:f,spaceId:u};h().applyOperation({store:I().Bv.createChildStore(o,e),operation:a().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection"===r.type){const e={table:s().Vl,id:f,spaceId:u};h().applyOperation({store:o,operation:a().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("collection_view"===r.type){const e={table:d().Gy,id:f,spaceId:u};h().applyOperation({store:I().pS.createChildStore(o,e),operation:a().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("layout"===r.type){const e={table:c().zx,id:f,spaceId:u};h().applyOperation({store:I().K_.createChildStore(o,e),operation:a().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:n}}),transaction:t})}else if("compound"===r.type){if(r.instancePointers.length<2)throw new Error(`Compound template instance ${r.id} must contain 2 or more instances`);const e=r.instancePointers.map((e=>{switch(e.type){case"automation":return{type:"automation",id:e.id};case"block":return{type:"block",id:e.id};case"collection_view":return{type:"collection_view",id:e.id};case"layout":return{type:"layout",id:e.id};case"property":return{type:"property",id:e.id}}(0,y().HB)(e)}));h().applyOperation({store:o,operation:{command:"keyedObjectListUpdate",pointer:o.pointer,path:["format","compound_workflow_template_instances"],args:{value:{template_id:n,id:r.id,instance_pointers:e}}},transaction:t})}else"property"===r.type?h().applyOperation({store:o,operation:a().op.update({pointer:o.pointer,path:["schema",r.id],args:{workflow_template_instance:{template_id:n}}}),transaction:t}):(0,y().HB)(r)}function T(e){let{environment:t,collectionStore:o,propertyId:n,compoundTemplateInstancesToDelete:a,collectionContextStore:i,from:l}=e;if(!a.every((e=>e.templateId===r().z$)))return!1;if(!(0,C().Io)())return!1;const s=(0,M().aL)({environment:t,collectionStore:o,compoundTemplateInstancesToDelete:a}),d=u().sb(s.filter((e=>"property"===e.type)).map((e=>e.id))),c=o.getSchema(),p=d.map((e=>{var t;if(e===n)return;const o=c[e];if(!o)throw new Error(`Property ${e} not found`);if(o.name)return o.name;const r=null===(t=o.workflow_template_instance)||void 0===t?void 0:t.template_id;if(!r)throw new Error(`Property ${e} has no workflow template id`);const a=x().globalWorkflowTemplates.fromId(r);return(0,x().getWorkflowTemplateName)(a)})).filter(y().O9);return P({environment:t,collectionStore:o,propertyIds:d,otherPropertyNames:p,collectionContextStore:i,from:l}),!0}function D(e){let{environment:t,collectionStore:o,propertyId:n,collectionContextStore:r,from:a}=e;const i=o.getSchema(),l=Object.keys(i).filter((e=>(0,C().Do)({collectionStore:o,propertyId:e})||(0,C().k$)(e))),s=l.map((e=>{var t;if(e===n)return;const r=null===(t=i[e])||void 0===t?void 0:t.name;if(r)return r;if((0,C().Do)({collectionStore:o,propertyId:e}))return S().A.formatMessage(b().Gl.verificationPropertyName);if((0,C().k$)(e))return S().A.formatMessage(b().Gl.ownerPropertyName);throw new Error(`Property ${e} must be a verification or owner property`)})).filter(y().O9);return P({environment:t,collectionStore:o,propertyIds:l,otherPropertyNames:s,collectionContextStore:r,from:a}),!0}function P(e){let{environment:t,collectionStore:o,propertyIds:r,otherPropertyNames:a,collectionContextStore:i,from:l}=e;const s=[{label:(0,k.jsx)(m().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deleteOption",defaultMessage:"{count, plural, one {Delete {count} property} other {Delete {count} properties}}",values:{count:r.length}}),color:"red",onAccept:()=>function(e){let{environment:t,collectionStore:o,collectionContextStore:n,propertyIds:r,from:a}=e;h().createAndCommit({userAction:"workflowTemplateInstanceActions.handleDeleteAccept",environment:t,canUndo:!0,perform:e=>{const i=o.getSchema();for(const l of r){w().BJ({environment:t,collectionStore:o,schema:i,property:l,transaction:e});const r=i[l];r&&(0,v().i)({environment:t,collectionContextStore:n,property_type:r.type,from:a,property:l})}}})}({environment:t,collectionStore:o,collectionContextStore:i,propertyIds:r,from:l})}],d=new Intl.ListFormat(n().locale,{style:"long",type:"conjunction"}),c=(0,k.jsx)(m().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deletePropertyFromDb",defaultMessage:"Delete this property from <bold>{databaseName}</bold>? {otherPropertyNames} will also be deleted",values:{bold:e=>(0,k.jsx)("span",{style:{fontWeight:f().Wy.bold},children:e}),databaseName:(0,k.jsx)(_().A,{style:{display:"inline",fontWeight:f().Wy.bold},shouldWrap:!0,store:o}),otherPropertyNames:d.format(a)}});g().ui({message:(0,k.jsx)("span",{children:c}),showCancel:!0,keepFocus:!0,innerStyle:{width:400},items:s})}function L(e){const{environment:t,transaction:o,collectionStore:n,instance:r}=e;(0,M().aI)({environment:t,instancePointer:r,inMemoryRecordCache:n.inMemoryRecordCache})||h().applyOperation({store:n,operation:{pointer:n.pointer,command:"keyedObjectListRemove",path:["format","compound_workflow_template_instances"],args:{remove:{id:r.id}}},transaction:o})}},384130:(e,t,o)=>{o.d(t,{J:()=>c});var n=o(296540),r=()=>o(484714),a=()=>o(56366),i=()=>o(751156),l=()=>o(755199),s=()=>o(186445),d=()=>o(765957);function c(){return function(e){let{userSettingsDismissibleKey:t}=e;const o=(0,r().v3)(),c=(0,a().K8)((()=>d().default.state.currentUserSettingsStore),[]),p=(0,a().K8)((()=>{const e=null==c?void 0:c.getSettings();return!e||Boolean(e[t])}),[t,c]),m=(0,a().K8)((()=>{const e=(0,s()._m)(o),t=null==c?void 0:c.getSettings();return Boolean(e)&&Boolean(t)&&!o.device.isMobile&&!p}),[o,c,p]),u=n.useCallback((()=>{c&&!p&&m&&i().createAndCommit({environment:o,userAction:"LayoutInfoPanelButtonEducationTooltip.dismiss",canUndo:!1,perform:e=>{l().mJ({userSettingsStore:c,transaction:e,data:{[t]:Date.now()}})}})}),[o,m,t,c,p]);return{shouldShowTooltip:m,dismissTooltip:u}}({userSettingsDismissibleKey:"layout_builder_add_module_button_education_tooltip_dismissed_at"})}},402137:(e,t,o)=>{o.d(t,{w:()=>s});o(18107),o(967357),o(814603),o(147566),o(198721);const n="://",r="www.",a=/.+\..+\..+/,i=/\.{2,}/,l=/.+\..+/;function s(e){const t=e.trim();if(0===t.length)return!1;if(-1===t.indexOf(".")&&-1===t.indexOf("localhost"))return!1;if("."===t.at(t.length-1)||-1!==t.indexOf(" "))return!1;let o,s=`${-1===t.indexOf(n)?"http://":""}${t}`;try{o=new URL(s)}catch(c){const e=-1===s.indexOf(r),[t,a]=s.split(n);s=`${t}${n}${e?"www.":""}${a}`;try{o=new URL(s)}catch(c){return!1}}const d=o.hostname;return!i.test(d)&&(!(t.includes(r)&&"localhost"!==d&&!a.test(d))&&!("localhost"!==d&&!l.test(d)))}},412532:(e,t,o)=>{o.d(t,{l:()=>r});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.03 2.29 11.93 10.46",svg:(0,o(474848).jsx)("path",{d:"M13.165 12.75a.8.8 0 0 0 .69-1.203L8.692 2.693a.8.8 0 0 0-1.382 0l-5.165 8.854a.8.8 0 0 0 .691 1.203z"})},r=(0,o(340498).wt)("arrowCaretUpFillSmall",n)},471095:(e,t,o)=>{o.d(t,{i:()=>r});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.97 1.95 12.05 15.66",svg:(0,o(474848).jsx)("path",{d:"M6 5.95a4 4 0 1 1 8 0v1.433a2.426 2.426 0 0 1 2.025 2.392v5.4A2.425 2.425 0 0 1 13.6 17.6H6.4a2.425 2.425 0 0 1-2.425-2.425v-5.4c0-1.203.876-2.201 2.025-2.392zm6.75 1.4v-1.4a2.75 2.75 0 1 0-5.5 0v1.4zm-2.2 5.458a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"})},r=(0,o(340498).wt)("lockFill",n)},498474:(e,t,o)=>{o.d(t,{q:()=>r});o(296540);var n=o(474848);const r=(0,o(340498).wt)("arrowUp",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},607810:(e,t,o)=>{o.d(t,{s:()=>i});var n=o(296540),r=()=>o(120997),a=o(474848);const i=n.memo((function(e){let{area:t,viewsMainTabId:i,children:l,className:s,style:d}=e;const{layoutBuilderModuleSelectionStore:c,layoutStore:p}=(0,o(937199).LH)(),m=(0,n.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const o=e.moduleId,n=p.getModuleById(o);n&&(0,r().p)(n,t)&&("page_main"===t&&p.isTabbedPageLayout()||c.setState({...e,draggingModuleFinalArea:{..."views_main_tab_modules"===t?{area:t,viewsMainTabId:i}:{area:t}}}))}),[t,c,p,i]),u=(0,n.useCallback)((()=>{const e=c.state;if(null==e||!e.isDragging)return;const o=e.moduleId,n=p.getModuleById(o);n&&(0,r().p)(n,t)&&c.setState({...e,draggingModuleFinalArea:e.draggingModuleInitialArea})}),[t,c,p]);return(0,a.jsx)("div",{onMouseEnter:m,onMouseLeave:u,className:s,style:d,children:l})}))},626466:(e,t,o)=>{o.r(t),o.d(t,{arrowChevronSingleDownFillIcon:()=>r,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.72 6.72 12.56 7.16",svg:(0,o(474848).jsx)("path",{d:"M9.381 13.619a.875.875 0 0 0 1.238 0l5.4-5.4A.875.875 0 1 0 14.78 6.98L10 11.763 5.219 6.98A.875.875 0 1 0 3.98 8.22z"})},r=(0,o(340498).wt)("arrowChevronSingleDownFill",n)},754199:(e,t,o)=>{function n(e){return/^(\+\d{1,2}[\s.-])?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function r(e){return/^[0-9 .()\-\+]{7,}$/.test(e)}o.d(t,{W:()=>n,e:()=>r})},854593:(e,t,o)=>{o.d(t,{q:()=>w});o(944114),o(296540);var n=()=>o(302107),r=()=>o(959013),a=()=>o(284371),i=()=>o(521358),l=()=>o(16006),s=()=>o(972435),d=()=>o(685889),c=()=>o(470928),p=()=>o(290966),m=()=>o(204067),u=()=>o(27732),y=()=>o(901389),f=()=>o(751156),v=o(474848);async function w(e){const{environment:t,collectionContextStore:o,property:w,handleDeleteAccept:g}=e,h=o.collectionStore();if(!h)return;if(h.isTypedProperty(w)){if(await i().nD({environment:t,property:w,collectionContextStore:o,theme:e.theme,from:e.from}))return}const b=(0,m().R5)({environment:t,collectionStore:h,propertyId:w});if(b.length>0){if((0,p().E_)({environment:t,collectionStore:h,propertyId:w,compoundTemplateInstancesToDelete:b,collectionContextStore:o,from:e.from}))return}else if(((0,c().k$)(w)||(0,c().Do)({collectionStore:h,propertyId:w}))&&(0,c().aF)(h)&&(0,c().Io)()){if((0,p().I5)({environment:t,collectionStore:h,propertyId:w,collectionContextStore:o,from:e.from}))return}const _=o.normalizedSchemaStore.state,S=_[w],C=d().pg(o,S);await(null==C?void 0:C.load());const I=C&&d().D5(o,w,C),x=C&&d().uf(C),M=C&&h.id===C.id,k=[{label:(0,v.jsx)(r().sA,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:g}];let A,T;if(I&&h&&x&&!M&&k.push({label:(0,v.jsx)(r().sA,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{f().createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,canUndo:!0,perform:e=>{if(S&&"relation"===S.type&&S.property&&C){const o=S.property,n=C.getSchema();u().C4({environment:t,collectionStore:C,propertySchema:n[o],property:o,targetPropertyID:void 0,autoRelate:h.isSyncedCollection()&&!C.isSyncedCollection()?{enabled:!1}:S.autoRelate,transaction:e})}u().t$({environment:t,collectionStore:h,property:w,transaction:e})}})}}),"auto_increment_id"===(null==S?void 0:S.type))A=d().me(_)?(0,v.jsx)(r().sA,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,v.jsx)(r().sA,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==S?void 0:S.type)){const e=d().AX(_);if(e){const t=e.connectedRelation.automation;t&&t[w]&&(A=(0,v.jsx)(r().sA,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else C&&x&&!M&&I?A=(0,v.jsx)(r().sA,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,v.jsx)(l().A,{style:{display:"inline",fontWeight:a().Wy.medium},store:C})}}):S&&(0,n().dR)({propertyId:w,propertyType:S.type,permissionItems:h.getPermissionItems()})&&(T=s().A.formatMessage(n().DZ.deletePropertyTypeWarningMessage),A=s().A.formatMessage(n().DZ.deletePropertyTypeWarningDescription));y().ui({message:T||(0,v.jsx)("span",{children:(0,v.jsx)(r().sA,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property from {databaseName}? It will be removed from all views.",values:{databaseName:(0,v.jsx)(l().A,{style:{display:"inline",fontWeight:a().Wy.bold},shouldWrap:!0,store:h})}})}),description:A,showCancel:!0,keepFocus:!0,items:k,mode:"wide"})}},984318:(e,t,o)=>{o.r(t),o.d(t,{ViewsMainBuilderModules:()=>m});var n=o(296540),r=()=>o(402014),a=()=>o(484714),i=()=>o(204521),l=()=>o(937199),s=()=>o(817942),d=()=>o(761660),c=()=>o(607810),p=o(474848);function m(e){const t=(0,a().v3)(),{setModuleSelection:o,layoutStore:m,sessionId:u}=(0,l().LH)(),{viewsMainTabId:y,pageLayoutType:f}=e,v=(0,n.useCallback)((e=>{(0,r().SQ)({event:e,context:r().y$.Click,callback:()=>{var e;o(void 0),(0,i().L3)({environment:t,layoutId:m.id,collectionId:null===(e=m.getCollectionModel())||void 0===e?void 0:e.id,sessionId:u,from:"background_click"})}})}),[t,m,u,o]);return(0,p.jsx)("div",{role:"presentation",onClick:v,children:(0,p.jsx)(c().s,{area:"views_main_tab_modules",viewsMainTabId:y,children:(0,p.jsx)(s().Mx,{type:f,style:{"--margin-width":"0px"},children:(0,p.jsx)(d().J,{area:"views_main_tab_modules",viewsMainTabId:y})})})})}}}]);