"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[91325],{315841:(e,t,s)=>{s.d(t,{Js:()=>a,Ns:()=>n,d:()=>o});var i=()=>s(645873);const n={publishSite:new(i().O2)("PublishSite",(async()=>await Promise.all([s.e(9304),s.e(39541),s.e(35658),s.e(16345)]).then(s.bind(s,142650)))),publishedSiteSettings:new(i().O2)("PublishedSiteSettings",(async()=>await Promise.all([s.e(9304),s.e(39541),s.e(9066),s.e(39301)]).then(s.bind(s,348651))))},o=(0,i()._h)(n.publishedSiteSettings,(e=>e.default)),a=(0,i()._h)(n.publishSite,(e=>e.default))},548945:(e,t,s)=>{s.d(t,{A:()=>j});var i=s(296540),n=()=>s(484714),o=()=>s(56366),a=()=>s(401497),r=()=>s(149375),l=()=>s(954845),c=()=>s(179034),d=()=>s(959013),u=()=>s(284371),p=()=>s(285790),g=()=>s(125565),h=()=>s(120303),b=()=>s(928074),m=()=>s(315841),x=()=>s(525700),S=()=>s(380682),y=()=>s(630116),f=s(474848);function j(e){let{spaceStore:t,blockId:s,onClose:i,onUnpublish:a}=e;const r=(0,n().v3)(),l=y().Bv.createChildStore(t,{table:c().ev,id:s}),d=(0,o().K8)((()=>b().dR({store:l,environment:r}).mostPermissivePublicItem),[r,l]);return"none"===d.permissionItem.role?(i(),null):(0,f.jsx)(v,{store:l,mostPermissivePublicItem:d,onClose:i,onUnpublish:a})}function v(e){const{store:t,mostPermissivePublicItem:s,onClose:n,onUnpublish:r}=e,c=(0,o().K8)((()=>"seo"===S().A.state.siteSettingContentType||"embed"===S().A.state.siteSettingContentType),[]),p=(0,i.useCallback)((()=>{x().Bp("initial")}),[]),b=(0,a().IS)((()=>({container:{flex:1,paddingBottom:8},titleContainer:{display:"flex",alignItems:"center",gap:4,padding:20,fontSize:14,lineHeight:1.25,fontWeight:u().Wy.semibold,paddingLeft:c?8:20},publishIcon:{height:16,width:16}})),[c]);return(0,f.jsxs)("div",{style:b.container,children:[(0,f.jsxs)("div",{style:b.titleContainer,children:[c&&(0,f.jsx)(k,{onClick:p}),(0,f.jsx)(g().A,{children:(0,f.jsx)(d().sA,{defaultMessage:"Publish settings",id:"publishSiteSettings.settings.title"})}),(0,l().J)(b.publishIcon),(0,f.jsx)(h().R,{onClick:n})]}),(0,f.jsx)(m().d,{store:t,mostPermissivePublicItem:s,sudoModeStore:void 0,location:"published_site_settings",showManageAllDomains:!1,showAllPublishedSites:!1,onUnpublish:r,shouldAskForConfirmationOnPublish:!0})]})}function k(e){const{onClick:t}=e,s=(0,d().tz)(),i=(0,a().IS)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:u().Wy.semibold}})),[]);return(0,f.jsx)("div",{style:i.topContainer,children:(0,f.jsx)(p().A,{icon:r().v,iconStyle:i.arrowIcon,style:i.iconButton,onClick:t,ariaLabel:s.formatMessage({id:"publishSiteSettings.settings.backbutton.ariaLabel",defaultMessage:"Go back to publish settings."})})})}},591978:(e,t,s)=>{s.d(t,{A:()=>n});class i extends(()=>s(757695))().Store{getInitialState(){return{formShareMenuType:"initial"}}}const n=new i},692536:(e,t,s)=>{s.r(t),s.d(t,{PublicPagesSection:()=>lt});var i=s(296540),n=()=>s(484714),o=()=>s(56366),a=()=>s(187174),r=()=>s(963589),l=(s(16280),s(944114),()=>s(388821)),c=()=>s(179034),d=()=>s(919709),u=()=>s(496603),p=()=>s(763824),g=()=>s(449506),h=()=>s(751156),b=()=>s(630116),m=()=>s(757695);class x extends m().Store{getInitialState(){return{forms:{},sortAscending:!1,sortColumn:"published-date",type:"forms"}}initializeResultsForSpace(e,t){this.state.forms[e]=t,this.emit()}resetSpace(e){this.state.forms[e]=void 0}getDataForSpace(e){return this.state.forms[e]}}const S=new x;class y extends m().Store{getInitialState(){return{publicShareLinks:{},sortAscending:!1,sortColumn:"published-date",type:"publicShareLinks"}}initializeResultsForSpace(e,t){this.state.publicShareLinks[e]=t,this.emit()}getDataForSpace(e){return this.state.publicShareLinks[e]}resetSpace(e){this.state.publicShareLinks[e]=void 0}}const f=new y;s(898992),s(354520);class j extends m().Store{getInitialState(){return{sites:{},sortAscending:!1,sortColumn:"published-date",type:"sites"}}initializeResultsForSpace(e,t){this.state.sites[e]=t,this.emit()}resetSpace(e){this.state.sites[e]=void 0}getDataForSpace(e){return this.state.sites[e]}unpublishSiteFromSpace(e,t){const s=this.state.sites[e];s&&(this.state.sites[e]=s.filter((e=>e.store.id!==t)),this.emit())}}const v=new j,k=5e3;async function C(e){const{environment:t,spaceStore:s,store:i,limit:n}=e;if(!s.id)return;const o=i.getDataForSpace(s.id)?0:1500,[a]=await Promise.all([g().callApi({eventName:"getPublicBlocksForUser",environment:t,data:{spaceId:s.id,limit:n||k,fetchPublishedMetadata:!0,type:i.state.type}}),(0,p().wR)(o)]);if("failed"===a.type)throw new Error("Failed to fetch published pages.");if(a.data.recordMap){const e=[],t=l().RecordMapWithRole.create(a.data.recordMap),n=a.data.publishedEdits;for(const{model:i}of t)if(i&&i.table===c().ev){var r;const t=b().Bv.createChildStore(s,{table:c().ev,id:i.id}),o=n[t.id],a=null==o||null===(r=o.authors)||void 0===r?void 0:r[0],l={publishedTime:null==o?void 0:o.timestamp,publishedBy:a};e.push({store:t,publishedMetadata:l})}return i.initializeResultsForSpace(s.id,e),e}}function P(e){const{settingsTabStore:t,spaceId:s,intl:i}=e,{sortAscending:n,sortColumn:o}=t.state,a=t.getDataForSpace(s);if(a)switch(o){case"page":return u().My(a,(e=>d().q4_(e.store.getTitleValue()).toLowerCase()),n?"asc":"desc");case"published-by":return u().My(a,(e=>{const t=e.publishedMetadata.publishedBy,s=t?b().sk.createChildStore(e.store,t):void 0;return null==s?void 0:s.getDisplayName(i).toLowerCase()}),n?"asc":"desc");case"published-date":return u().My(a,(e=>{var t;return null===(t=e.store.getPublicPermission())||void 0===t?void 0:t.added_timestamp}),n?"asc":"desc");default:return a}}class A extends m().Store{getInitialState(){return{view:"landing"}}setTabView(e){this.state.view=e,this.emit()}}const w=new A;var I=()=>s(959013),T=(s(581454),()=>s(401497)),B=()=>s(84817),M=()=>s(317182),L=()=>s(383716),R=()=>s(244641),_=()=>s(584262),D=()=>s(869190),O=()=>s(589407),F=()=>s(406699),W=()=>s(285790),z=()=>s(107683),V=()=>s(380682),H=()=>s(962730),N=()=>s(591978),U=()=>s(764781),E=()=>s(212727),K=()=>s(12193),$=()=>s(884107),G=()=>s(755636),X=()=>s(760217),Y=()=>s(928600),J=()=>s(939740),q=()=>s(8980),Q=()=>s(89924),Z=()=>s(859428),ee=()=>s(722872),te=()=>s(553965),se=()=>s(534177),ie=()=>s(492414),ne=()=>s(40226);function oe(e){const{settingsTabStore:t,store:s,pageVisitSource:i}=e,n=t.state.type;switch(n){case"forms":return(0,ie().Ay)({store:s,preferPublicLink:!0,pageVisitSource:i});case"sites":return ne().R({store:s,pageVisitSource:i});case"publicShareLinks":return(0,ie().Ay)({store:s,pageVisitSource:i});default:(0,se().HB)(n)}}var ae=s(474848);function re(e){const{store:t,settingsTabStore:s,parent:i,isSettingsDisabled:o,onOpenSettingsModal:a}=e,r=(0,n().v3)(),l=(0,T().IS)((e=>({button:{padding:"4px"},disabledSettingsButton:{color:e.text.tertiary},sectionMenuItem:{padding:"4px"}})),[]),c=[{key:"copy",render:e=>(0,ae.jsx)(X().A,{...e,icon:(0,ae.jsx)(q().I,{icon:U().V}),title:(0,ae.jsx)(I().sA,{id:"publicPages.tables.copy",defaultMessage:"Copy link"}),style:l.button}),action:async()=>{const e=oe({store:t,settingsTabStore:s,pageVisitSource:_().y8.CopyLink}),n=await $().R.clipboardActions.load();await n.copyString({environment:r,stringValue:e,copiedMessage:n.clipboardMessages.copiedLinkToClipboard}),i.close()}},{key:"view",render:e=>(0,ae.jsx)(X().A,{...e,icon:(0,ae.jsx)(q().I,{icon:K().globeIcon}),title:(0,ae.jsx)(I().sA,{id:"publicPages.tables.view",defaultMessage:"View"}),style:l.button}),action:()=>{const e=oe({store:t,settingsTabStore:s,pageVisitSource:_().y8.PublicPageSettings});G().f({environment:r,url:e}),i.close()}}],d=(0,ae.jsx)(I().sA,{id:"publicPages.tables.settings",defaultMessage:"Settings"}),u=[{key:"settings",render:e=>o?(0,ae.jsx)(Z().A,{renderTooltip:()=>(0,ae.jsx)(I().sA,{id:"publicPages.settingsActions.noEditAccess",defaultMessage:"You do not have access to update the settings for this public page."}),placement:H().W.Bottom,render:t=>(0,ae.jsx)(X().A,{...(0,te().A)(t,e),icon:(0,ae.jsx)(q().I,{icon:E().gearIcon}),title:d,disabled:o,style:{...l.button,...l.disabledSettingsButton}})}):(0,ae.jsx)(X().A,{...e,icon:(0,ae.jsx)(q().I,{icon:E().gearIcon}),title:d,style:l.button}),action:()=>{a(t.id),i.close()}}];return(0,ae.jsx)(Y().A,{menuType:ee().gu.Popup,minWidth:140,children:(0,ae.jsx)(J().Ay,{initialFocus:void 0,type:J().Oh.Vertical,sections:[{key:"link",render:e=>(0,ae.jsx)(Q().A,{...e,style:l.sectionMenuItem}),items:c},{key:"settings",render:e=>(0,ae.jsx)(Q().A,{...e,style:l.sectionMenuItem,topBorder:!0}),items:u}]})})}var le=()=>s(548945),ce=()=>s(954845),de=()=>s(284371),ue=()=>s(274041),pe=()=>s(125565),ge=()=>s(175116),he=()=>s(581495),be=()=>s(414834);function me(e){const{blockStore:t,onClose:s}=e,i=(0,n().v3)(),a=(0,o().K8)((()=>{const e=new(be().A)(i),s=t.getFormBlockParentBlockStore(),n=null==s?void 0:s.getCollectionStore();return n&&s&&s.isCollectionView()?(e.setContext({type:"collectionPage",collectionViewBlockStore:s,collectionStore:n}),e):null}),[i,t]),r=(0,T().IS)((()=>({container:{flex:1,paddingBottom:8},titleContainer:{display:"flex",alignItems:"center",gap:4,padding:"20px 20px 16px 20px",fontSize:14,lineHeight:1.25,fontWeight:de().Wy.semibold},publishIcon:{height:16,width:16}})),[]);return a?(0,ae.jsxs)("div",{style:r.container,children:[(0,ae.jsxs)("div",{style:r.titleContainer,children:[(0,ae.jsx)(pe().A,{children:(0,ae.jsx)(I().sA,{defaultMessage:"Share settings",id:"publicPages.formSettings.title"})}),(0,ce().J)(r.publishIcon),(0,ae.jsx)(he().Rz,{onClick:s})]}),(0,ae.jsx)(ge().RI,{value:a,children:(0,ae.jsx)(ue().h5,{formBlockStore:t,parent:{close:s}})})]}):null}var xe=()=>s(928074);function Se(e){const{blockStore:t,onClose:s}=e,i=(0,n().v3)(),a=(0,o().K8)((()=>xe().dR({store:t,environment:i})),[i,t]),r=(0,T().IS)((()=>({container:{flex:1,paddingBottom:8},titleContainer:{display:"flex",alignItems:"center",gap:4,padding:"20px 20px 8px 20px",fontSize:14,lineHeight:1.25,fontWeight:de().Wy.semibold,paddingLeft:20},publishIcon:{height:16,width:16}})),[]);return(0,ae.jsxs)("div",{style:r.container,children:[(0,ae.jsxs)("div",{style:r.titleContainer,children:[(0,ae.jsx)(pe().A,{children:(0,ae.jsx)(I().sA,{defaultMessage:"Share settings",id:"publicPages.publicShareLinkSettings.title"})}),(0,ce().J)(r.publishIcon),(0,ae.jsx)(he().Rz,{onClick:s})]}),(0,ae.jsx)(ue().cN,{store:t,calculatedPermissions:a,permissionItemArgs:{location:"public_pages_settings"}})]})}function ye(e){const{blockStore:t,settingsTabStore:s,onClose:i,spaceStore:n}=e,a=(0,o().O$)(s).type;switch(a){case"sites":return(0,ae.jsx)(le().A,{blockId:t.id,onClose:i,onUnpublish:()=>{v.unpublishSiteFromSpace(n.id,t.id)},spaceStore:n});case"publicShareLinks":return(0,ae.jsx)(Se,{blockStore:t,onClose:i});case"forms":return(0,ae.jsx)(me,{blockStore:t,onClose:i});default:(0,se().HB)(a)}}function fe(e){const t=(0,I().tz)(),s=(0,n().v3)(),{blockStore:o,settingsTabStore:a,isSettingsDisabled:r,spaceStore:l}=e,[c,d]=(0,i.useState)(!1),u=(0,i.useCallback)((e=>{d(!0)}),[d]),p=(0,i.useCallback)((async()=>{d(!1),V().A.setState({...V().A.state,siteSettingContentType:"initial"}),N().A.setState({...N().A.state,formShareMenuType:"initial"}),await C({environment:s,spaceStore:l,store:a})}),[d,s,l,a]),g=(0,T().IS)((()=>({settingButtonIcon:{width:18,height:18}})),[]);return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(F().Ay,{alignmentToOrigin:H().C.End,renderOrigin:e=>(0,ae.jsx)(W().A,{...e,ariaLabel:t.formatMessage({id:"publicPages.tables.settingsEllipsis",defaultMessage:"Settings"}),icon:O().L,iconStyle:g.settingButtonIcon}),popupType:F().z7.Popup,render:e=>(0,ae.jsx)(re,{store:o,settingsTabStore:a,parent:e,isSettingsDisabled:r,onOpenSettingsModal:u})}),(0,ae.jsx)(z().s,{isOpen:c,onDismiss:p,areaConstraint:{width:{type:"fixed",length:480}},render:()=>(0,ae.jsx)(ye,{blockStore:o,settingsTabStore:a,onClose:p,spaceStore:l})})]})}function je(e){const{text:t}=e,s=(0,T().IS)((e=>({text:{width:"fit-content",maxWidth:"98%",...de().RC}})),[]);return t?(0,ae.jsx)("div",{style:s.text,children:t}):null}var ve=()=>s(926401),ke=()=>s(500066),Ce=()=>s(296798),Pe=()=>s(187820),Ae=()=>s(16006),we=()=>s(915019),Ie=()=>s(404141);function Te(e){const{store:t,style:s,hideIcon:n}=e,a=(0,o().K8)((()=>{if(t)return{icon:t.getIcon(),isEmptyPage:t.isEmptyPage(),url:(0,ie().J8)({store:t,pageVisitSource:_().y8.PublicPageSettings})}}),[t]),r=(0,i.useCallback)((e=>{e.metaKey||Ie().A.setState({...Ie().A.state,open:!1})}),[]),l=(0,T().IS)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden",cursor:"default"},emptyPageIcon:{height:18,width:18,fill:e.palette.gray[500]},iconContainer:{position:"relative",width:20,height:20,marginRight:4},linkBox:{borderRadius:3,maxWidth:"100%"},linkIcon:{position:"absolute",width:10,height:10,right:0,bottom:0},pageRecordContainer:{display:"flex",alignItems:"center",paddingTop:2,paddingBottom:2,paddingRight:4,paddingLeft:4,...s},pageTitle:{wordBreak:"break-word",borderBottom:`0.05em solid ${e.lightDividerColor}`}})),[s]);if(!t||!a)return null;const c=(0,ae.jsxs)("div",{style:l.pageRecordContainer,children:[n?void 0:(0,ae.jsxs)("div",{style:l.iconContainer,children:[a.icon?(0,ae.jsx)(Pe().B6,{icon:a.icon,iconRecordCategory:"pageBlock",store:t,disabled:!0,size:16,isEmptyPage:a.isEmptyPage,emojiSize:20}):(0,ve().n)(l.emptyPageIcon),(0,ke().G)(l.linkIcon)]}),(0,ae.jsx)(Ae().A,{store:t,style:l.pageTitle})]});return(0,ae.jsx)("div",{style:l.container,children:(0,ae.jsx)(we().A,{store:t,render:e=>(0,ae.jsx)(Ce().A,{href:null==a?void 0:a.url,style:l.linkBox,...(0,te().A)(e,{onClick:r}),children:c})})})}s(814603),s(147566),s(198721);var Be=()=>s(493823);function Me(e){const{url:t}=e,s=new URL(t),i=`${s.host}${s.pathname}`,o=(0,n().v3)(),a=(0,T().IS)((e=>({copyUrl:{color:e.text.secondary},domainButton:{width:"fit-content",maxWidth:"98%",background:e.lightGrayButtonBackground},domainButtonHover:{background:e.lightGrayButtonHoveredBackground},domainButtonPressed:{background:e.lightGrayButtonPressedBackground},relativeUrl:{color:e.text.tertiary}})),[]);return(0,ae.jsx)(Z().A,{allowHover:!0,renderTooltip:()=>(0,ae.jsxs)(ae.Fragment,{children:[i,(0,ae.jsx)("div",{style:a.copyUrl,children:(0,ae.jsx)(I().sA,{id:"publicPages.publicShareLinks.copyLink",defaultMessage:"Click to copy full URL"})})]}),render:e=>(0,ae.jsx)("div",{...e,children:(0,ae.jsx)(Be().p,{onClick:async()=>{const e=await $().R.clipboardActions.load();await e.copyString({environment:o,stringValue:t,copiedMessage:e.clipboardMessages.copiedLinkToClipboard})},style:a.domainButton,size:"xs",hoveredStyle:a.domainButtonHover,pressedStyle:a.domainButtonPressed,children:(0,ae.jsxs)("span",{style:{...de().RC},children:[i,(0,ae.jsx)("span",{style:a.relativeUrl,children:"/..."})]})})}),placement:H().W.Bottom})}var Le=()=>s(994006),Re=()=>s(870092);function _e(e){const{publisher:t,store:s}=e,i=(0,T().IS)((e=>({uiUser:{width:"fit-content",maxWidth:"98%"}})),[]),n=(0,I().tz)(),a=t?b().sk.createChildStore(s,t):void 0,r=(0,o().K8)((()=>null==a?void 0:a.getDisplayName(n)),[a,n]);return a instanceof Re().L?(0,ae.jsx)(Le().A,{userStore:a,avatarSize:20,style:i.uiUser}):(0,ae.jsx)(je,{text:r})}var De=()=>s(802790);function Oe(){const e=(0,T().IS)((e=>({message:{textAlign:"center",marginTop:12,marginBottom:12,color:e.text.tertiary}})),[]);return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(pe().A,{style:e.message,children:(0,ae.jsx)(I().sA,{id:"publicPages.table.empty",defaultMessage:"There are no public pages of this type"})}),(0,ae.jsx)(De().A,{size:1})]})}var Fe=()=>s(126158),We=()=>s(704152);function ze(e){const{header:t,settingsTabStore:s,column:n}=e,a=(0,T().IS)((e=>({wrapper:{display:"flex"},sortButton:{display:"flex",alignItems:"center",padding:"3px 5px 3px 0px",overflow:"hidden",maxWidth:"100%",borderRadius:4},sortIcon:{fill:e.text.secondary,width:12,height:12,marginLeft:4}})),[]),{sortColumn:r,sortAscending:l}=(0,o().O$)(s),c=(0,i.useCallback)((e=>{const{sortColumn:t,sortAscending:i}=s.state,n=e!==t||!i;s.setState({...s.state,sortAscending:n,sortColumn:e})}),[s]),d=["page","published-by","published-date"].includes(n),u=()=>{if(n===r)return(0,Fe().m)({...a.sortIcon,...!l&&{transform:"rotate(180deg)"}})};return t&&d?(0,ae.jsx)("div",{style:a.wrapper,children:(0,ae.jsxs)(We().A,{style:a.sortButton,onClick:()=>c(n),children:[t,u()]})}):t?(0,ae.jsx)("div",{style:a.wrapper,children:t}):null}function Ve(e){const{spaceStore:t,store:s,pageHeader:i}=e,n=(0,T().IS)((e=>({container:{minWidth:750,maxHeight:"100%",overflow:"auto"},tableBox:{tableLayout:"fixed"},cell:{paddingRight:12,height:44}})),[]),a=function(e){const t=(0,I().tz)(),{spaceStore:s,settingsTabStore:i}=e;return(0,o().K8)((()=>{const e=P({settingsTabStore:i,spaceId:s.id,intl:t});if(!e)return;const n=[];for(const t of e){var o;const{store:e,publishedMetadata:a}=t,r=e.canAdmin(),l=e.id,c=null===(o=e.getPublicPermission())||void 0===o?void 0:o.added_timestamp,d=c?(0,D().eV)({value:R().c9.fromMillis(c),preset:"medium"}):"",u=oe({store:e,settingsTabStore:i,pageVisitSource:_().y8.CopyLink}),p=[(0,ae.jsx)(Te,{store:e},`${l}-public-page-record`),(0,ae.jsx)(Me,{url:u},`${l}-table-link-tooltip`),(0,ae.jsx)(_e,{publisher:a.publishedBy,store:e},`${l}-table-publisher`),(0,ae.jsx)(je,{text:d},`${l}-published-on`),(0,ae.jsx)(fe,{blockStore:e,settingsTabStore:i,isSettingsDisabled:!r,spaceStore:s},`${l}-actions`)];n.push({key:l,columns:p})}return n}),[s,i,t])}({spaceStore:t,settingsTabStore:s}),r=function(e){const{table:t}=e;return[{key:"page",header:(0,ae.jsx)(I().sA,{id:"publicPages.table.pageColumnHeader",defaultMessage:"Page"}),style:{width:"32%"}},{key:"sites"===t?"domain":"link",header:"sites"===t?(0,ae.jsx)(I().sA,{id:"publicPages.table.domainColumnHeader",defaultMessage:"Domain"}):(0,ae.jsx)(I().sA,{id:"publicPages.table.linkColumnHeader",defaultMessage:"Link"}),style:{width:"28%"}},{key:"published-by",header:(0,ae.jsx)(I().sA,{id:"publicPages.table.publishedByColumnHeader",defaultMessage:"First published by"}),style:{width:"20%"}},{key:"published-date",header:(0,ae.jsx)(I().sA,{id:"publicPages.table.publishedDateColumnHeader",defaultMessage:"Published date"}),style:{width:"16%"}},{key:"edit",header:null,style:{width:"4%"}}]}({table:(0,o().O$)(s).type}).map((e=>({key:e.key,header:(0,ae.jsx)(ze,{column:e.key,header:e.header,settingsTabStore:s}),style:e.style})));return(0,ae.jsx)(B().Y1,{direction:"vertical",padding:"36px 60px",style:n.container,children:(0,ae.jsxs)(B().Y1,{direction:"vertical",gap:16,children:[(0,ae.jsx)(L().n,{title:i,goBack:()=>{w.setTabView("landing")}}),(0,ae.jsx)(M().A,{columns:r,rows:a??[],tableStyle:n.tableBox,cellStyle:n.cell}),0===(null==a?void 0:a.length)?(0,ae.jsx)(Oe,{}):void 0]})})}function He(e){const t=(0,ae.jsx)(I().sA,{id:"publicPagesTab.forms.title",defaultMessage:"Public forms"}),{spaceStore:s}=e;return(0,ae.jsx)(Ve,{spaceStore:s,store:S,pageHeader:t})}var Ne=()=>s(721672),Ue=(s(672577),()=>s(554509));function Ee(e){const{spaceStore:t,settingsTabStore:s,emptyMessageDescriptor:i}=e,n=(0,I().tz)(),{icon:a,store:r,numPages:l}=(0,o().K8)((()=>{const e=P({settingsTabStore:s,spaceId:t.id,intl:n}),i=null==e?void 0:e.find((e=>(0,se().O9)(e.store.getIcon()))),o=i||(null==e?void 0:e[0]);return o?{icon:o.store.getIcon(),store:o.store,numPages:(null==e?void 0:e.length)??0}:{icon:void 0,store:void 0,numPages:void 0}}),[t.id,s,n]),c=(0,T().IS)((e=>({bottomContainer:{display:"flex",gap:"4px",alignItems:"center",height:"28px"},bottomPlus:{fontSize:"10px",alignSelf:"center",color:e.text.secondary},page:{display:"flex",alignItems:"center",gap:"4px",backgroundColor:e.lightGrayBannerBackground,padding:"4px",borderRadius:"4px"},title:{fontSize:"12px"}})),[]);return(0,se().O9)(r)?(0,ae.jsxs)("div",{style:c.bottomContainer,children:[(0,ae.jsxs)("div",{style:c.page,children:[(0,ae.jsx)(Pe().B6,{icon:a,iconRecordCategory:"pageBlock",size:17,disabled:!0,isEmptyPage:!0}),(0,ae.jsx)(Ae().A,{store:r,maxLength:20,style:c.title})]}),l&&l>1?(0,ae.jsx)("div",{style:c.bottomPlus,children:(0,ae.jsx)(I().sA,{id:"publicPages.tile.pageCount",defaultMessage:"+{count}",values:{count:l-1}})}):null]}):(0,ae.jsx)("div",{style:c.bottomContainer,children:(0,ae.jsx)(Ue().D,{colorName:"tertiary",styleName:"UISmall-12px/Regular",children:(0,ae.jsx)(I().sA,{...i})})})}function Ke(e){const{spaceStore:t}=e,{formsCount:s}=(0,o().K8)((()=>{const e=S.state.forms[t.id];return e?{formsCount:e.length}:{formsCount:void 0}}),[t.id]);return(0,r().X)("public_pages_settings_tab")?(0,ae.jsx)(Ne().W,{headerText:(0,ae.jsx)(I().sA,{id:"publicPages.tile.publicForms.header",defaultMessage:"Public forms"}),mainText:(0,ae.jsx)(I().sA,{id:"publicPages.tile.publicForms.count",defaultMessage:"{count}",values:{count:s}}),bottom:(0,ae.jsx)(Ee,{spaceStore:t,settingsTabStore:S,emptyMessageDescriptor:{id:"publicPages.tile.publicForms.empty",defaultMessage:"No public forms",description:"Empty message for the public forms tile in public pages settings"}}),onClick:()=>{w.setTabView("forms")},isLoading:!(0,se().O9)(s),disabled:!(0,se().O9)(s)}):null}var $e=()=>s(979340),Ge=()=>s(946548),Xe=()=>s(459401),Ye=()=>s(573660),Je=()=>s(508490),qe=()=>s(765957);function Qe(e){const{spaceStore:t}=e,s=(0,n().v3)(),i=(0,T().IS)((e=>({settingsTitle:{fontWeight:"normal",color:e.text.primary},settingsByline:{color:e.text.secondary},headerContainer:{marginTop:32}})),[]),{currentSpaceStore:a}=(0,o().O$)(qe().default),l=(0,o().K8)((()=>null==a?void 0:a.getSettings().hide_sites_banner),[a]),c=(0,r().X)("allow_disable_sites_banner"),d=(0,o().K8)((()=>(0,$e().OX)(null==a?void 0:a.getSubscriptionTier())),[a]),u=(0,o().K8)((()=>t.canAdmin()),[t]);if(!a||!u||!d&&!c)return null;return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:i.headerContainer,children:(0,ae.jsx)(Ue().D,{children:(0,ae.jsx)(I().sA,{id:"publicPages.settings.title",defaultMessage:"Settings"})})}),d?(0,ae.jsx)(Je().A,{icon:K().globeIcon,title:(0,ae.jsx)(I().sA,{id:"publicPages.settings.disablePublishing.title",defaultMessage:"Disable publishing public pages in the <bold>Security</bold> tab",values:{bold:e=>(0,ae.jsx)("span",{style:{fontWeight:de().Wy.semibold},children:e})}}),deeplinkTab:{currentTab:"security",defaultSubtab:"security"}}):void 0,c?(0,ae.jsx)(Xe().L,{children:(0,ae.jsx)(Ye().y,{title:(0,ae.jsx)("div",{style:i.settingsTitle,children:(0,ae.jsx)(I().sA,{id:"publicPages.settings.showBanner.title",defaultMessage:"Always show published banner on sites"})}),byline:(0,ae.jsx)("div",{style:i.settingsByline,children:(0,ae.jsx)(I().sA,{id:"publicPages.settings.showBanner.description",defaultMessage:"Published pages will display a blue banner at the top"})}),item:(0,ae.jsx)(Ge().A,{on:!l,onClick:()=>function(e){const{environment:t,spaceStore:s,hidePublishedPageBanner:i}=e;h().createAndCommit({environment:t,userAction:"publicPagesActions.updateSpacePublishedPageBanner",canUndo:!0,perform:e=>{h().applyOperation({store:s,operation:{pointer:s.pointer,path:["settings"],command:"update",args:{hide_sites_banner:i}},transaction:e})}})}({environment:s,spaceStore:a,hidePublishedPageBanner:!l})})})}):null]})}function Ze(e){const{spaceStore:t}=e,{publicShareLinksCount:s}=(0,o().K8)((()=>{const e=f.state.publicShareLinks[t.id];return e?{publicShareLinksCount:e.length}:{publicShareLinksCount:void 0}}),[t.id]);return(0,r().X)("public_pages_settings_tab")?(0,ae.jsx)(Ne().W,{headerText:(0,ae.jsx)(I().sA,{id:"publicPages.tile.publicLinks.header",defaultMessage:"Anyone with the link"}),mainText:(0,ae.jsx)(I().sA,{id:"publicPages.tile.publicLinks.count",defaultMessage:"{count}",values:{count:s}}),bottom:(0,ae.jsx)(Ee,{spaceStore:t,settingsTabStore:f,emptyMessageDescriptor:{id:"publicPages.tile.publicLinks.empty",defaultMessage:"No public share links",description:"Empty message for the public share links tile in public pages settings"}}),onClick:()=>{w.setTabView("publicShareLinks")},isLoading:!(0,se().O9)(s),disabled:!(0,se().O9)(s)}):null}s(517642),s(658004),s(733853),s(845876),s(432475),s(515024),s(731698);var et=()=>s(562800),tt=()=>s(578872),st=()=>s(449418);function it(e,t){var s;if(e)return null===(s=function(e){if(!e)return[];return(0,u().oE)(e.getPublicDomainIds().map((t=>e.getRecordModel({id:t,table:st()._6,spaceId:e.id}))))}(e))||void 0===s?void 0:s.find((e=>e.id===t))}function nt(e){const{spaceStore:t}=e,s=(0,T().IS)((e=>({bottomContainer:{minHeight:"28px",display:"flex",gap:4,alignItems:"flex-end"},domainText:{backgroundColor:e.lightGrayBannerBackground,padding:4,borderRadius:4},domainPlus:{paddingBottom:4,color:e.text.tertiary}})),[]),{sitesCount:i,sitesDomains:n}=(0,o().K8)((()=>{const e=v.state.sites[t.id];if(!e)return{sitesCount:void 0,sitesDomains:void 0};const s=new Set(e.map((e=>tt().UP(e.store)))),i=Array.from(s).map((e=>{const s=it(t,e);return null==s?void 0:s.getDomainName()})).filter((e=>(0,se().O9)(e)));return{sitesCount:e.length,sitesDomains:i}}),[t]);if(!(0,r().X)("public_pages_settings_tab"))return null;return(0,ae.jsx)(Ne().W,{headerText:(0,ae.jsx)(I().sA,{id:"publicPages.tile.publishedSites.header",defaultMessage:"Published sites"}),mainText:(0,ae.jsx)(I().sA,{id:"publicPages.tile.publishedSites.count",defaultMessage:"{sitesCount}",values:{sitesCount:i}}),bottom:(0,se().O9)(i)?(0,ae.jsx)("div",{style:s.bottomContainer,children:i>0?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(Ue().D,{styleName:"UISmall-12px/Regular",colorName:"primary",style:s.domainText,children:(0,et().MN)({domainName:(null==n?void 0:n[0])??""})}),(0,se().O9)(n)&&n.length>1?(0,ae.jsx)(Ue().D,{styleName:"UIMini-10px/Regular",style:s.domainPlus,children:"+"+(n.length-1)}):void 0]}):(0,ae.jsx)(Ue().D,{styleName:"UISmall-12px/Regular",colorName:"tertiary",children:(0,ae.jsx)(I().sA,{id:"publicPages.tile.publishedSites.empty",defaultMessage:"No published sites"})})}):null,onClick:()=>{w.setTabView("sites")},isLoading:!(0,se().O9)(i),disabled:!(0,se().O9)(i)})}function ot(e){const{spaceStore:t}=e,s=(0,T().IS)((e=>({container:{minWidth:750},domainStyles:{marginTop:36},cellStyles:{marginTop:28}})),[]);return(0,r().X)("public_pages_settings_tab")?(0,ae.jsx)(B().Y1,{direction:"vertical",padding:"36px 60px",style:s.container,children:(0,ae.jsxs)(B().Y1,{direction:"vertical",children:[(0,ae.jsx)(L().n,{title:(0,ae.jsx)(I().sA,{id:"publicPages.header.title",defaultMessage:"Public Pages"})}),(0,ae.jsxs)(B().Y1,{direction:"horizontal",gap:14,style:s.cellStyles,children:[(0,ae.jsx)(nt,{spaceStore:t}),(0,ae.jsx)(Ke,{spaceStore:t}),(0,ae.jsx)(Ze,{spaceStore:t})]}),(0,ae.jsx)("div",{style:s.domainStyles,children:(0,ae.jsx)(ue().$O,{spaceStore:t})}),(0,ae.jsx)(Qe,{spaceStore:t})]})}):null}function at(e){const t=(0,ae.jsx)(I().sA,{id:"publicPagesTab.publicShareLinks.title",defaultMessage:"Anyone with the link"}),{spaceStore:s}=e;return(0,ae.jsx)(Ve,{spaceStore:s,store:f,pageHeader:t})}function rt(e){const t=(0,ae.jsx)(I().sA,{id:"publicPagesTab.sites.title",defaultMessage:"Published sites"}),{spaceStore:s}=e;return(0,ae.jsx)(Ve,{spaceStore:s,store:v,pageHeader:t})}function lt(e){const{spaceStore:t}=e,s=(0,n().v3)();(0,a().Yb)((async()=>{await async function(e){const{environment:t,spaceStore:s}=e;await Promise.all([C({environment:t,spaceStore:s,store:S}),C({environment:t,spaceStore:s,store:v}),C({environment:t,spaceStore:s,store:f})])}({environment:s,spaceStore:t})}),[s,t]),(0,i.useEffect)((()=>()=>{w.setTabView("landing")}),[]);const l=(0,o().O$)(w).view;if(!(0,r().X)("public_pages_settings_tab"))return null;switch(l){case"landing":return(0,ae.jsx)(ot,{spaceStore:t});case"sites":return(0,ae.jsx)(rt,{spaceStore:t});case"forms":return(0,ae.jsx)(He,{spaceStore:t});case"publicShareLinks":return(0,ae.jsx)(at,{spaceStore:t})}}},915019:(e,t,s)=>{s.d(t,{A:()=>r});var i=s(296540),n=()=>s(962730),o=s(474848);function a(e){let{store:t,...a}=e;const r=(0,i.useCallback)((e=>(0,o.jsx)(s(791194).yf,{store:t,events:e})),[t]);return(0,o.jsx)(s(859428).A,{noStyle:!0,delayThreshold:400,placement:n().W.Bottom,alignment:n().C.Start,renderTooltip:r,...a})}const r=i.memo(a)},954845:(e,t,s)=>{s.d(t,{J:()=>n});s(296540);var i=s(474848);const n=(0,s(340498).wt)("blueCircleDot",{viewBox:"0 0 16 16",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("circle",{cx:"8",cy:"8",r:"8",fill:"none",stroke:"#2383E2",children:[(0,i.jsx)("animate",{attributeName:"r",from:"3",to:"8",dur:"1s",begin:"0s",repeatCount:"indefinite"}),(0,i.jsx)("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",begin:"0s",repeatCount:"indefinite"})]}),(0,i.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"#2383E2"})]})})}}]);