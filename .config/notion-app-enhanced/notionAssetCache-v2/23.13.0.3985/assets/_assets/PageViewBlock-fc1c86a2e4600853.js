"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[9304],{299772:(e,t,o)=>{o.d(t,{AP:()=>$,Ay:()=>le,By:()=>re,DX:()=>J,JK:()=>Y,NS:()=>ve,T1:()=>te,Wj:()=>ce,Y4:()=>ee,dp:()=>ne,g1:()=>fe,mv:()=>de,nu:()=>be,rK:()=>ye,uD:()=>ae,y_:()=>ie,zs:()=>Z});o(944114),o(898992),o(672577);var n=o(296540),r=()=>o(662303),i=()=>o(484714),a=()=>o(56366),s=()=>o(721908),l=()=>o(757695),d=()=>o(519831),c=()=>o(959013),u=()=>o(496603),g=()=>o(534177),p=()=>o(284371),m=()=>o(934839),S=()=>o(473227),v=()=>o(915086),b=()=>o(778417),f=()=>o(725614),y=()=>o(662453),k=()=>o(766081),h=()=>o(780054),C=()=>o(175116),P=()=>o(964345),A=()=>o(135552),_=()=>o(458366),B=()=>o(478726),K=()=>o(108944),M=()=>o(747100),x=()=>o(470928),w=()=>o(891078),T=()=>o(696746),R=()=>o(106628),E=()=>o(792415),I=()=>o(765957),D=()=>o(463830),O=()=>o(353643),V=()=>o(77246),j=()=>o(217429),F=()=>o(150193),H=()=>o(732770),z=()=>o(375447),L=()=>o(205682),N=()=>o(548821),U=()=>o(612587),q=()=>o(77238),Q=()=>o(712505),W=()=>o(93658),X=()=>o(502438),G=o(474848);const Z=p().vc(r().locale).sans,$={serif:p().vc(r().locale).serif,mono:p().vc(r().locale).mono,comic:p().vc(r().locale).comic},Y={serif:1.6,mono:1.6},J={serif:0,mono:.055},ee={serif:15,mono:14},te={serif:17,mono:15},oe={width:"100%",display:"flex",flexDirection:"column",position:"relative",alignItems:"center",flexGrow:1},ne=14,re=17,ie=16,ae=16;function se(e,t){var r,p;const T=(0,n.useRef)();T.current=performance.now();const{store:F,context:L,disabled:U,onTitleEsc:q,styleOverrides:X,disableTopControls:Z}=e,$=(0,a().K8)((()=>{var e;return null===(e=F.getSpaceStore())||void 0===e?void 0:e.getFreezeSettings()}),[F]),Y=(0,o(973454).p)($),J=U||"active"===Y,ee=(0,i().v3)(),te=(0,i().Y0)(),ne=(0,o(792485).S)(),re=(0,w().bx)(F,J),ie=(0,w().HX)(F,J),ae=(0,a().K8)((()=>F.isReady()&&ie&&!F.isNonEditableState()&&!(0,B().sV)(F)&&!(0,B().fc)(F)),[ie,F]),se=(0,a().O$)(o(227440).e),le=(0,a().K8)((()=>F.isCollectionView()),[F]),ce=(0,a().K8)((()=>Boolean((0,o(851941).X2)(F.id))?"v8":"v4"),[F]),ke=(0,a().K8)((()=>F.isCollectionViewPageWithContent()),[F]),he=(0,a().K8)((()=>"workflow"===F.getType()),[F]),Ce=(0,a().K8)((()=>{const e=F.getAssociatedCollectionStore(),t=null==e?void 0:e.getLayoutStore();return Boolean(t)}),[F]),Pe=(0,o(551619).no)(F),Ae=(0,n.useMemo)((()=>({layout:{translateX:-1*Pe},layoutFull:{translateX:Pe}})),[Pe]),_e=(0,a().K8)((()=>l().Store.createValue(!1,{name:"headerFocusStore"})),[]),Be=(0,a().O$)(_e),{isInPeek:Ke,isInsideSidePeek:Me}=(0,a().K8)((()=>({isInPeek:(0,M().cq)(F),isInsideSidePeek:(0,B().mb)(F)})),[F]),xe=(0,n.useMemo)((()=>new(N().Ay)),[]),we=(0,n.useMemo)((()=>new(D().A)),[]),Te=(0,n.useMemo)((()=>new(D().A)),[]),Re=(0,n.useMemo)((()=>new(o(970585).A)),[]),Ee=(0,a().K8)((()=>l().Store.createValue(!1,{name:"forceControlHoverVisibleStore"})),[]),Ie=(0,a().O$)(Ee),De=(0,n.useMemo)((()=>({headerFocusStore:_e,pageViewBlockStore:xe,resolvedDiscussionButtonPopupStore:we,backlinksButtonPopupStore:Te,templatePickerMenuListStore:Re,forceControlHoverVisibleStore:Ee})),[_e,xe,we,Te,Re,Ee]),[Oe,Ve]=(0,n.useState)(!1),[je,Fe]=(0,n.useState)(!1),[He,ze]=(0,n.useState)(""),Le=(0,n.useCallback)((()=>{we.setState({open:!0}),xe.setState({...xe.state,forceDiscussionOpen:!0})}),[xe,we]),Ne=(0,n.useCallback)((()=>{const e=qe.current;if(e){if(function(e){if(!e.isIOS)return!1;return!0}(te))return{paddingLeft:0,paddingRight:0};const t=getComputedStyle(e),o=parseFloat(t.getPropertyValue("padding-left")),n=parseFloat(t.getPropertyValue("padding-right"));return{paddingLeft:u().yr(o)?0:o,paddingRight:u().yr(n)?0:n}}}),[te]),Ue=(0,n.useCallback)((()=>{const e=qe.current;if(e){const t=e.getBoundingClientRect().width,o=Ne()??{paddingLeft:0,paddingRight:0};return t-o.paddingLeft-o.paddingRight}}),[Ne]),qe=(0,n.useRef)(null),Qe=(0,n.useRef)(null),We=(0,n.useRef)(null),Xe=(0,n.useCallback)((()=>qe.current),[]),Ge=(0,n.useCallback)((()=>Qe.current),[]),Ze=(0,n.useMemo)((()=>new(o(414834).A)(ee)),[]);(0,o(790748).b)(o(489348).A,(()=>({store:F,blockContext:L,openResolvedDiscussionPopup:Le,getContentInnerWidth:Ue,getContentWrapEl:Xe,getLayoutEl:Ge,collectionContextStore:Ze,headerFocusStore:_e,pageViewBlockStore:xe,resolvedDiscussionButtonPopupStore:we,backlinksButtonPopupStore:Te,templatePickerMenuListStore:Re,forceControlHoverVisibleStore:Ee,headerMouseStore:void 0,detailsFocusStore:void 0,detailsMouseStore:void 0,renderedType:"page",getBlockStore:()=>F,getNode:()=>We.current})),[F,L,Le,Ue,Ne,Xe,Ge,Ze,De]);const $e=(0,n.useRef)(!1),Ye=(0,a().K8)((()=>F.getTitleStore()),[F]),Je=(0,a().K8)((()=>F.isInsideFactoryOrDuplicateBlocksAction()),[F]),et=(0,a().K8)((()=>{const e=E().A.state.publicPageData;return Boolean(null==e?void 0:e.isDLSViewer)}),[]),tt=(0,o(600871).D1)(te),ot=(0,n.useCallback)((()=>!!Ye&&(!!e.forceSelectTitleOnMount||!le&&(!(h().A.isMobile&&te.isPhone&&o(210737).A.hasOpenMobileSlideUps())&&(!o(919709).q4_(Ye.getValue())||(0,B().In)(F)&&!h().A.isMobile)))),[te.isPhone,le,e.forceSelectTitleOnMount,F,Ye]),nt=(0,a().K8)((()=>F.isFormBlock()),[F]),[rt,it]=(0,a().K8)((()=>[Boolean(F.getIcon()),Boolean(F.getCover())]),[F]),at=(0,a().K8)((()=>{const e=o(21735).A.state.shouldUseEdgeCache,t=j().default.checkGate({gateName:"edge_cache_mentions"});return e&&t}),[]);(0,o(67141).v)(),(0,n.useEffect)((()=>{if(async function(e){const{environment:t,shouldUseEdgeCache:o}=e;o||z().Ay.state.emptyQueryUserRequestStore.setState({...z().Ay.state.emptyQueryUserRequestStore.state,ready:!1,loading:!0});await I().default.waitUntil((()=>Boolean(I().default.state.currentSpaceStore&&I().default.state.mainEditorCurrentBlockStore)));const n=await R().T.searchActions.load(),r=await n.searchVisibleSpaceUsers({environment:t,query:"",membersOnly:!1,minFuzzyScore:25,placeSelfFirst:!1});o||z().Ay.state.emptyQueryUserRequestStore.setState({ready:!0,loading:!1,result:r})}({environment:ee,shouldUseEdgeCache:at}),(0,o(63467).y)(),te.isPhone&&!tt){const{PageScroller:e}=o(347199).A;if(e){const t=e.getNode();if(t&&re&&!it){const e=be(L,te);t.scrollTo({top:e})}}}var e;Ye&&ot()&&(b().hc({environment:ee,store:F}),f().setSelectionAtEnd({store:Ye}),te.isAndroid&&te.isMobileNative&&(null===(e=ee.mobileNative)||void 0===e||e.forceKeyboardVisibility(!0)));if(v().updateMetricDataWithIsPushTag(ee),L!==N().Rr.Frame||le||nt||(T.current&&o(606932).A.markPageViewBlockRender(T.current),v().measurePageRenderMetrics({environment:ee,isEditable:ae,isHomePage:!1,isWikiHome:!1,isPageWithCustomLayout:Ce,idSchema:ce}),function(e,t,o){var n;Se(e,t,o)&&(null===(n=t.mobileNative)||void 0===n||n.markTransitionReady({environment:t,type:"new_page",id:e.id,sendImmediately:!0}))}(F,ee,te)),Ze){const e=(0,o(476492).kz)(Ze);o(406792).default.DO_NOT_USE_measureLegacy("collections.open_item_page_lag",{environment:ee,data:{...e,peek_mode:Q().default.getPeekMode()}})}!async function(e,t){const{aiOnboardingActions:o}=await y().aiDependency.load(),{getAiOnboardingPhase:n,AiOnboardingQueuedSelectedStore:r}=o;if("space_for_ai"!==n())return;const i=e.getContentStores()[0],a=r.state;if(!i||i.id!==a)return;b().hc({environment:t,store:i}),f().setSelectionAtEnd({store:i.getBlockTitleStore()})}(F,ee)}),[]);const st=(0,a().K8)((()=>F.getFormat()),[F]),lt=(0,a().K8)((()=>{var e;return null===(e=V().Uv.getStateForBlock(F.id))||void 0===e?void 0:e.mode}),[F.id]),dt=(0,a().K8)((()=>{var e;const t=P().ei.state,n=(0,g().O9)(t)&&(null===(e=K().Nq(t))||void 0===e?void 0:e.id)===F.id;return P().gZ.state&&n&&"disconnected"===o(165121).A.state}),[F.id]),ct=(0,a().K8)((()=>{var e;return K().ze(F)||Boolean(null===(e=E().A.state.publicPageData)||void 0===e?void 0:e.isDeleted)&&(0,B().jN)(L)}),[F,L]),ut=(0,a().K8)((()=>ne&&ne.publicEditModeStore.state),[ne]),gt=(0,a().K8)((()=>F.isTemplate()),[F]),pt=(0,a().K8)((()=>F.isDraft()),[F]),mt=(0,o(963589).X)("feed_sidebar_item"),St=(0,a().K8)((()=>{const e=ye(ee),t=Q().default.state.mode===o(868840).O&&"posts"===ee.RouterStore.state.route.name;return mt?t:e}),[ee,mt]),vt=(0,o(596698).V)(ee,F);(0,n.useEffect)((()=>{if(L===N().Rr.Frame){const e=me(L);null==ut||!ut.hasPublicPermission||"edit"!==ut.permission||gt||(0,o(326589).g)()?m().zA({bannerStore:e,id:"EditingPageBanner"}):m().HQ({bannerStore:e,id:"EditingPageBanner",contentKey:"editing_page",styleKey:A().q.White});o(864260).A.state.pageMap[F.id]?m().HQ({bannerStore:e,id:"ImportingEvernotePage",contentKey:"importing_evernote",styleKey:A().q.Blue,blockStore:F}):m().zA({bannerStore:e,id:"ImportingEvernotePage"})}if((0,B().Zz)(L)){const e=me(L),t=K().Gg(F),n=K().Cf(F);if((0,o(322769).vW)(t))m().HQ({bannerStore:e,id:"SpaceContentDuplicationPage",contentKey:"space_content_duplication",styleKey:A().q.Red,blockStore:F});else if(!ct||nt||Se(F,ee,te))if(n)m().HQ({bannerStore:e,id:"ArchivedTeamPage",contentKey:"page_in_archived_team",styleKey:A().q.Red});else for(const o of["SpaceContentDuplicationPage","DeletedPage","ArchivedTeamPage"])m().zA({bannerStore:e,id:o});else m().HQ({bannerStore:e,id:"DeletedPage",contentKey:"deleted_or_moved_page",blockStore:F,styleKey:A().q.Red});pt&&St?m().HQ({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner",contentKey:"draft_post_in_expanded_feed_composer",styleKey:A().q.Blue,blockStore:F}):m().zA({bannerStore:e,id:"DraftPostInExpandedFeedComposerBanner"}),dt?m().HQ({bannerStore:e,id:"DictationConnectionBanner",styleKey:A().q.Yellow,contentKey:"dictation_connection",blockStore:F}):m().zA({bannerStore:e,id:"DictationConnectionBanner"}),lt&&(0,V().Or)(lt)?m().HQ({bannerStore:e,id:"TranslateBanner",styleKey:A().q.Blue,contentKey:"translate",blockStore:F}):m().zA({bannerStore:e,id:"TranslateBanner"}),et&&!(0,M().cq)(F)?m().HQ({bannerStore:e,id:"TrustedDomainPageBanner",styleKey:A().q.LightGray,contentKey:"trusted_domain_page",blockStore:F}):m().zA({bannerStore:e,id:"TrustedDomainPageBanner"}),gt?m().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_page",styleKey:A().q.Beige,blockStore:F,context:L,disabled:J}):Je?m().HQ({bannerStore:e,id:"CollectionTemplatePage",contentKey:"template_in_button",styleKey:A().q.Beige,blockStore:F,context:L,disabled:J}):m().zA({bannerStore:e,id:"CollectionTemplatePage"}),(null!=st&&st.is_asana_imported_project||null!=st&&st.is_asana_imported_task)&&(null!=st&&st.dismissed_asana_import_banner?m().zA({bannerStore:e,id:"AsanaImporterBanner"}):m().HQ({bannerStore:e,id:"AsanaImporterBanner",contentKey:"asana_importer_banner",blockStore:F,styleKey:A().q.ImportNotification})),"sites"===(null==vt?void 0:vt.type)?m().HQ({id:"Site",bannerStore:e,styleKey:A().q.Blue,contentKey:"site",blockStore:F}):"marketplace_template"===(null==vt?void 0:vt.type)?m().HQ({id:"MarketplaceTemplateBanner",bannerStore:e,styleKey:A().q.Blue,contentKey:"marketplace_template",template:vt.template,blockStore:F}):(m().zA({bannerStore:e,id:"Site"}),m().zA({bannerStore:e,id:"MarketplaceTemplateBanner"}))}return()=>{(0,B().Zz)(L)&&(m().zA({bannerStore:me(L),id:"DeletedPage"}),m().zA({bannerStore:me(L),id:"CollectionTemplatePage"}),m().zA({bannerStore:me(L),id:"Site"}),m().zA({bannerStore:me(L),id:"MarketplaceTemplateBanner"}),m().zA({bannerStore:me(L),id:"CrdtPage"}),m().zA({bannerStore:me(L),id:"TrustedDomainPageBanner"}),m().zA({bannerStore:me(L),id:"TranslateBanner"}),m().zA({bannerStore:me(L),id:"AsanaImporterBanner"}),m().zA({bannerStore:me(L),id:"DraftPostInExpandedFeedComposerBanner"}))}}),[ee,ut,L,J,F,ct,nt,Je,null==st?void 0:st.is_asana_imported_project,null==st?void 0:st.is_asana_imported_task,null==st?void 0:st.dismissed_asana_import_banner,lt,dt,et,gt,pt,St,te,vt]),(0,o(852507).l)((()=>{"suggest"===V().Uv.getMode(F,!0)?S().Nz({environment:ee,location:"page_navigation",navigableBlockStore:F}):h().A.isMobile||F.canEdit()||!F.canComment()||F.isLocked()||le&&!ke||V().Uv.hasModeSet(F)||F.useCrdt()||F.isFormBlock()||L===N().Rr.PostInFullPageOrPeek||(0,o(142748).ot)(K().E(F))||S().PD({environment:ee,navigableBlockStore:F,mode:"suggest",location:"default_on_for_comment_only_user"})})),(0,o(892008).Bs)({pageId:F.id,isFrameContext:(0,B().jN)(L)}),(0,n.useEffect)((()=>()=>{"suggest"===V().Uv.getMode(F,!0)&&S().eB({environment:ee,location:"page_navigation",navigableBlockStore:F})}),[ee,F]);const bt=(0,a().K8)((()=>ge(F)),[F]),ft=(0,a().K8)((()=>null==bt?void 0:bt.getParentBlockStore()),[bt]),yt=(0,a().K8)((()=>null==Ze?void 0:Ze.collectionStore()),[Ze]);bt&&bt!==yt&&Ze.setContext({type:"collectionPage",collectionViewBlockStore:ft,collectionStore:bt});const kt=(0,a().K8)((()=>{const e=(0,o(110750).Xz)(ee.TabbedRouterStore.state);if("web"===e.type){var t,n;if("page"===(null===(t=e.redirectedTo)||void 0===t?void 0:t.route.name))return null===(n=e.redirectedTo)||void 0===n?void 0:n.route.blockId;if("page"===e.route.name)return e.route.blockId}}),[ee]),ht=(0,n.useRef)(void 0);(0,n.useEffect)((()=>{if(ee.mobileNative&&He===kt){var e;const t=kt!==ht.current;null===(e=ee.mobileNative)||void 0===e||e.markTransitionReady({environment:ee,type:"page",id:F.id,sendImmediately:!0,isNavigationEvent:t}),ht.current=kt}}),[ee,kt,He,F.id]),(0,n.useEffect)((()=>{ze(F.id)}),[F]);const Ct=(0,n.useCallback)((()=>{Ke||O().A.state.isDragging||W().default.state.isActive||Ve(!0)}),[Ke]),Pt=(0,n.useCallback)((()=>{Ke||O().A.state.isDragging||W().default.state.isActive||Ve(!1)}),[Ke]),At=(0,n.useCallback)((()=>{O().A.state.isDragging||W().default.state.isActive||Fe(!0)}),[]),_t=(0,n.useCallback)((()=>{O().A.state.isDragging||W().default.state.isActive||Fe(!1)}),[]),Bt=(0,s().d)(At,100),Kt=(0,s().d)(_t,100),Mt=(0,n.useCallback)((e=>{Ye&&(b().hc({environment:ee,store:F}),e.isAtStartOfLine?f().setSelectionAtStart({store:Ye}):f().setSelectionAtEnd({store:Ye}))}),[ee,F,Ye]),xt=(0,n.useCallback)((e=>{f().clear({environment:ee}),b().IU({environment:ee}),q&&q(e)}),[ee,q]),wt=(0,n.useCallback)((e=>{if(le)return!0;if(e.preventDefault(),function(e){return Boolean(ge(e))}(F)){const e=(0,B().gV)(F);if(e&&e.collection_page_properties){const t=e.collection_page_properties.find(((e,t)=>function(e,t){const o=ge(t);if(!o)return!1;const n=function(e){return e.getSchema()}(t);return(0,_().B2)(n[e])}(e.property,F)));t&&o(908006).default.afterNextFlush((()=>{o(522986).ho({environment:ee,blockPropertyValueOverlayStore:pe(L),collectionContextStore:Ze,store:F,property:t.property,format:"page"})}))}}}),[Ze,L,ee,le,F]),Tt=(0,n.useCallback)((e=>{if(le)return!0;xt(e)}),[xt,le]),Rt=(0,n.useCallback)((()=>{Re.reset()}),[Re]),Et=(0,n.useCallback)((e=>{e.target===We.current&&null===e.relatedTarget&&document.hasFocus()&&b().IU({environment:ee})}),[ee]),It=(0,a().K8)((()=>ve((0,o(835066).dC)(ee,F),F,L,te)),[ee,F,L,te]),Dt=(0,a().K8)((()=>{const e=F.isDraft(),t=F.isPublishedDraft(),o=F.isTeamPost();return L===N().Rr.DraftPostInInlineComposer?N().Rr.DraftPostInInlineComposer:o?t?N().Rr.PostInFullPageOrPeek:e?N().Rr.DraftPostInFullPageComposer:void 0:void 0}),[F,L]),Ot=(0,o(933951).sS)({pageStore:F,postContext:Dt,collectionStore:bt,pageViewBlockStore:De.pageViewBlockStore}),Vt=(0,a().K8)((()=>Q().default.state.topHoverAreaEntered),[]),jt=(0,n.useCallback)((e=>{const{isBottomControl:t,forceVisible:o}=e??{},n=Ke?Vt:Oe;let r;return r=!!h().A.isMobile||(!!o||(!!Ie||(t?je&&!H().A.state.isKeyboardMode:n&&!H().A.state.isKeyboardMode||Be))),fe(r)}),[je,Be,Oe,Ke,Vt,Ie]),Ft=(0,a().K8)((()=>jt({isBottomControl:!1})),[jt]),Ht=(0,a().K8)((()=>"suggest"===V().Uv.getMode(F)),[F]),zt=(0,a().K8)((()=>(0,x().$3)({environment:ee,collectionStore:F.getAssociatedCollectionStore()})),[ee,F]),Lt=(0,a().K8)((()=>(0,x().xE)(ee)),[ee]),Nt=(0,a().K8)((()=>(0,x().Wk)({environment:ee,blockStore:F,showUpsell:zt})),[ee,F,zt]),Ut=(0,o(400851).X)({environment:ee,blockStore:F,from:"topControls",blockContext:L}),qt=(0,n.useCallback)((e=>{let{from:t}=e;const n=le?F.getCollectionStore():ge(F);n&&(0,o(447934).nh)({environment:ee,blockStore:F,collectionStore:n,from:t})}),[ee,le,F]),Qt=(0,n.useMemo)((()=>{if(Z||tt)return[];const e=[];return!ae||rt||Ht||e.push((0,G.jsx)(n.Fragment,{children:(0,G.jsx)(o(790324).A,{store:F,afterOnClick:()=>{$e.current=!0},style:Ft,label:te.isSmallPhone?(0,G.jsx)(c().sA,{id:"PageViewBlock.icon.pageIconMobile",defaultMessage:"Icon"}):(0,G.jsx)(c().sA,{id:"PageViewBlock.icon.pageIcon",defaultMessage:"Add icon"})})},"add-icon")),!se||!ae||it||Ht||Dt||e.push((0,G.jsx)(n.Fragment,{children:(0,G.jsx)(o(605243).A,{store:F,style:Ft,label:te.isSmallPhone?(0,G.jsx)(c().sA,{id:"PageViewBlock.cover.pageCoverMobile",defaultMessage:"Cover"}):(0,G.jsx)(c().sA,{id:"PageViewBlock.cover.pageCover",defaultMessage:"Add cover"}),from:"page_header"})},"add-cover")),Nt&&e.push((0,G.jsx)(n.Fragment,{children:(0,G.jsx)(o(527580).ui,{store:F,style:Ft,showUpsell:zt,showNewBadge:Lt})},"verify-page")),Ut&&!Dt&&e.push((0,G.jsx)(o(941112).E,{blockStore:F,onClick:()=>qt({from:"customize_page_button_above_title"}),style:Ft},"customize-layout")),ae&&!h().A.isMobile&&e.push((0,G.jsx)(n.Fragment,{children:(0,G.jsx)(o(538776).l,{store:F})},"generate-preview-image")),e}),[Z,tt,ae,rt,Ht,se,it,Dt,Nt,Ut,te.isSmallPhone,F,Ft,zt,Lt,qt]),Wt=(0,a().K8)((()=>{const{WindowSizeStore:e}=ee,t=le?"20vh":(null==X?void 0:X.pageCoverHeight)??de,n=(null==X?void 0:X.paddingX)??(0,B().OU)(L,ee);return(0,G.jsx)(o(155004).s,{allowSelectionWithin:!1,style:(0,o(601726).E)(F,ee),children:(0,G.jsx)(o(544862).A,{height:t,store:F,disabled:!ae,paddingLeft:e.getSafePaddingLeftCSS(n),paddingRight:e.getSafePaddingRightCSS(n),proxyWidth:e.state.width})})}),[ee,le,null==X?void 0:X.pageCoverHeight,null==X?void 0:X.paddingX,L,F,ae]),Xt=(0,a().K8)((()=>{const e=ee.currentUser.isLoggedIn(),t=ne&&ne.publicEditModeStore.state;let n;return L===N().Rr.Frame?n=I().default.state.currentLoadingContainerStore:L===N().Rr.PeekView&&Q().default.state.open&&(n=Q().default.state.loadingContainerStore),Boolean(F&&n&&F.isDefined()&&!F.isNonEditableState()&&F.canEdit()&&!F.hasContent()&&e&&(!(null!=t&&t.hasPublicPermission)||"edit"===(null==t?void 0:t.permission))&&!(Boolean(o(302022).A.state.pageMap[F.id])||o(66496).A.state.pages.has(F.id))&&n.state.ready&&!(0,B().sV)(F)&&!(0,B().fc)(F)&&(!(0,o(68465).ZE)(t)||"completionPopup"!==o(525569).default.state.type))}),[ee.currentUser,ne,F,L]),Gt=(0,n.useMemo)((()=>({store:F,isEditable:ae,hasCover:it,isInSidePeek:Me,openMenuOnMountCallback:()=>{$e.current=!1}})),[it,ae,Me,F]),Zt=(0,a().K8)((()=>Boolean(F.getAssociatedCollectionStore())),[F]),$t=(0,a().K8)((()=>h().A.isMobile&&!te.isTablet&&(te.isIOS||"on"===j().default.getEligibleGroup({experimentId:"android_lightweight_editor_prompt",defaultGroup:"control"}))&&!Zt&&!le),[te.isTablet,te.isIOS,Zt,le]),Yt=(0,a().K8)((()=>{var t;const o=(null===(t=e.styleOverrides)||void 0===t?void 0:t.paddingX)??(0,B().OU)(L,ee);let n=e.titlePlaceholder;return $t&&(n=""),{store:F,disabled:!re,isInSidePeek:Me,paddingLeft:o,paddingRight:o,extraStyles:e.titleStyle,titlePlaceholder:n,collectionContextStore:Ze,shouldShowTemplatePicker:Xt,onTitleChange:Rt,onTitleEditText:Mt,onTitleEsc:xt,onTitleUntab:Tt,onTitleTab:wt}}),[null===(r=e.styleOverrides)||void 0===r?void 0:r.paddingX,e.titleStyle,e.titlePlaceholder,L,ee,F,re,Ze,Xt,Rt,Mt,xt,Tt,wt,Me,$t]),Jt=(0,n.useCallback)((e=>{"page"===e&&v().measurePageRenderMetrics({environment:ee,isEditable:ae,isHomePage:!1,isWikiHome:!0,isPageWithCustomLayout:!1,idSchema:ce})}),[ee,ae,ce]),eo=(0,a().K8)((()=>{var t,n;const r=(0,G.jsx)(o(155129).X.Provider,{value:Pe,children:(0,G.jsx)(o(145214).A,{tag:o(817942).Mx,animate:Ae.layout,type:It,withBottomPadding:L!==N().Rr.DraftPostInInlineComposer&&L!==N().Rr.Presentation,ref:Qe,children:(0,G.jsx)(o(259140).A,{context:L,postContext:Dt,onHeaderMouseEnter:Ct,onHeaderMouseLeave:Pt,onDetailMouseEnter:Bt,onDetailMouseLeave:Kt,pageCoverHeight:(null===(t=e.styleOverrides)||void 0===t?void 0:t.pageCoverHeight)??de,modules:(null===(n=e.layoutModulesByArea)||void 0===n?void 0:n.page_main)??Ot.page_main,styleOverrides:e.styleOverrides,templatePickerMenuListStore:De.templatePickerMenuListStore,topControls:Qt,getControlHoverStyle:jt,pageViewBlockStores:De,...Gt,openMenuOnMount:$e.current,...Yt,disabled:J,pageViewBlockAccessor:Ge,editorContentContainerRef:qe,layoutRef:Qe})})});return Ze&&Ze.contextType?(0,G.jsx)(C().RI,{value:Ze,children:r}):r}),[Pe,Ae.layout,It,L,Dt,Ct,Pt,Bt,Kt,e.styleOverrides,null===(p=e.layoutModulesByArea)||void 0===p?void 0:p.page_main,Ot.page_main,De,Qt,jt,Gt,Yt,J,Ge,Ze]),to=(0,a().K8)((()=>F.getType()===o(700500).xd.copyIndicator&&(F.getParentTable()!==d().Vl||F.getParentTable()===d().Vl&&0===Object.keys(F.getProperties()).length)?(0,G.jsx)(o(388139).F,{}):o(777932).A.state.isDuplicating?(0,G.jsx)(k().R,{store:F,peekMode:void 0,forceShowIcon:!0}):le?(0,G.jsx)(C().RI,{value:Ze,children:(0,G.jsx)(o(529933).m,{canEdit:re,context:N().Rr.CollectionViewBlockFullScreen,controlHoverStyle:Ft,handleHeaderMouseEnter:Ct,handleHeaderMouseLeave:Pt,headerFocusStore:De.headerFocusStore,pageCover:Wt,topControls:Qt,...Gt,openMenuOnMount:$e.current,...Yt,store:F,productUseCase:"full_page",onCollectionViewBlockMount:Jt,editorContentContainerRef:qe,pageViewBlockStore:xe})}):nt?(0,G.jsx)(o(620137).e,{renderLoading:()=>(0,G.jsx)(k().R,{store:F,peekMode:void 0}),innerRenderLoading:()=>(0,G.jsx)(k().R,{store:F,peekMode:void 0}),store:F}):he?(0,G.jsx)(o(563615).eN,{store:F}):(0,G.jsx)(o(261237).c,{displayName:"PageContent",style:{...oe,...e.style},disabled:!re||F.isNonEditableState(),onBlur:Et,shouldSelectOnEnter:ue,ref:We,children:(0,G.jsx)(o(11048).A,{name:"PageContent",children:eo})})),[F,le,nt,he,e.style,re,Et,eo,Ze,Ft,Ct,Pt,De.headerFocusStore,Wt,Qt,Gt,Yt,Jt,xe]);return(0,w().NW)(F,t,(0,n.useMemo)((()=>({store:F,blockContext:L,openResolvedDiscussionPopup:Le,getContentInnerWidth:Ue,getContentWrapEl:Xe,getLayoutEl:Ge,collectionContextStore:Ze,...De,renderedType:"page",getBlockStore:()=>F,getNode:()=>We.current})),[F,L,Ze,Ue,Xe,Ge,Le,De]),to)}const le=n.memo(n.forwardRef(se),o(821062).A),de=h().A.isMobile?200:"30vh";function ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.isTablet?380:e.isIOS?Math.max(350,t):h().A.isMobile?400:"30vh"}function ue(){return 0===X().default.state.stores.length}function ge(e){return e.getAssociatedCollectionStore()}function pe(e){return(0,B().L5)(e)?q().A:L().A}function me(e){return(0,B().L5)(e)?U().A:(0,B().jN)(e)?F().A:(0,g().HB)(e)}function Se(e,t,o){const{RouterStore:n}=t,{route:r}=n.state,i=e;return o.isMobileNative&&"page"===r.name&&r.showMoveTo&&i.isEmptyTitle()&&i.isEmptyPage()}function ve(e,t,o,n){return o===N().Rr.DraftPostInInlineComposer?"create-post":o===N().Rr.Presentation?"presentation-mode":n.isPhone?"phone":n.isTablet?(0,B().Ck)(t,o,n)?"wide":"tablet":(0,B().L5)(o)?(0,B().mb)(t)?"side-peek":"center-peek":(0,B().A7)(o)||(0,B().Vi)(o)?"template-preview":(0,B().Ck)(t,o,n)?e?"wide-right-margin-expanded":"wide":"default"}function be(e,t){return 28+(0,B().XD)(e)}function fe(e){return{opacity:e?1:0,pointerEvents:e?"auto":"none",transition:"opacity 100ms ease"}}function ye(e){if(!Q().default.isSidePeekOpen()&&!Q().default.isCenterPeekOpen())return!1;const t=I().default.state.mainEditorCurrentBlockStore;return(0,T().lU)(t)}}}]);