"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[46990,90068],{59400:(e,t,o)=>{o.d(t,{nR:()=>c,m$:()=>s,m4:()=>l,Dy:()=>d,FZ:()=>p});o(296540);var r=()=>o(645873),n=o(474848);function i(e){const{shouldShowSpinner:t,collectionSettingsProps:r}=e;return(0,n.jsx)(o(735695).Ay,{collectionSettingsStore:r.collectionSettingsStore,fullHeight:r.fullHeight,hideDesktopHeader:r.hideDesktopHeader,children:t&&(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden",paddingBottom:20},children:(0,n.jsx)(o(331542).A,{})})})}const a=new(r().O2)("collectionSettings",(()=>Promise.all([o.e(75134),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(75078),o.e(25497),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(30291),o.e(19930),o.e(58102),o.e(26483),o.e(6463),o.e(40925),o.e(282),o.e(61349),o.e(62573),o.e(1440),o.e(63996),o.e(66559),o.e(35986),o.e(92924),o.e(64819),o.e(97339),o.e(55717),o.e(63797),o.e(21367),o.e(22686),o.e(99108)]).then(o.bind(o,409198)))),s=(0,r()._h)(a,(e=>e.CollectionSettings),{renderLoading:(e,t)=>(0,n.jsx)(i,{shouldShowSpinner:e,collectionSettingsProps:t})}),l=(0,r()._h)(a,(e=>e.CollectionSettingsButtonOptions)),d=(0,r()._h)(a,(e=>e.CollectionSettingsPropertyTypeMenuItem)),c=(0,r()._h)(a,(e=>e.CollectionEditButtonAutomationOption)),u=new(r().O2)("TableHeaderPropertyCreationMenu",(()=>Promise.all([o.e(75134),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(75078),o.e(25497),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(61349),o.e(35986),o.e(43935)]).then(o.bind(o,908800)))),p=(0,r()._h)(u,(e=>e.TableHeaderPropertyCreationMenu))},70128:(e,t,o)=>{o.d(t,{M:()=>s});var r=o(296540),n=()=>o(484714),i=()=>o(496603),a=()=>o(36951);function s(e){const{textValue:t,isEnabled:o,clientStore:s,configs:l}=e,d=(0,n().v3)(),c=(0,r.useCallback)((()=>{o&&t&&!s.state.userSelectedConfig&&(0,a().xh)({environment:d,clientStore:s,message:t,configs:l})}),[t,s,l,d,o]),u=(0,r.useMemo)((()=>(0,i().sg)(c,200)),[c]);(0,r.useEffect)((()=>()=>{u.cancel()}),[u]),(0,r.useEffect)((()=>{o&&u()}),[t,o,u])}},97835:(e,t,o)=>{o.d(t,{x:()=>i});o(296540);var r=o(474848);const n={viewBox:"0 0 20 20",fittedViewBox:"3.68 2.37 15.82 17.13",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M10 2.375c-1.137 0-2.054.47-2.674 1.242-.608.757-.9 1.765-.9 2.824s.292 2.066.9 2.824c.62.772 1.537 1.241 2.674 1.241s2.055-.469 2.675-1.241c.608-.758.9-1.766.9-2.824 0-1.059-.292-2.067-.9-2.824-.62-.773-1.538-1.242-2.675-1.242M7.676 6.441c0-.842.233-1.554.624-2.042.38-.473.937-.774 1.7-.774s1.32.301 1.7.774c.391.488.624 1.2.624 2.042s-.233 1.554-.624 2.041c-.38.473-.937.774-1.7.774s-1.32-.3-1.7-.774c-.391-.487-.624-1.2-.624-2.041M10 11.63c-2.7 0-5.101 1.315-6.12 3.305-.361.706-.199 1.421.23 1.923.412.48 1.06.767 1.74.767h5.845a4.6 4.6 0 0 1-.28-1.25H5.85c-.342 0-.634-.148-.79-.33-.138-.162-.172-.336-.067-.54.761-1.488 2.672-2.626 5.007-2.626.83 0 1.605.144 2.294.395.269-.364.59-.688.952-.96A7.9 7.9 0 0 0 10 11.63"}),(0,r.jsx)("path",{d:"M16 19.5a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7m2.594-3.469a.625.625 0 0 0-.625-.625h-1.375v-1.375a.625.625 0 0 0-1.25 0v1.375h-1.375a.625.625 0 0 0 0 1.25h1.375v1.375a.625.625 0 1 0 1.25 0v-1.375h1.375c.345 0 .625-.28.625-.625"})]})},i=(0,o(340498).wt)("inviteMember",n)},118789:(e,t,o)=>{o.d(t,{n:()=>f});o(898992),o(354520),o(581454);var r=o(296540),n=()=>o(484714),i=()=>o(56366),a=()=>o(798880),s=()=>o(959013),l=()=>o(21735),d=()=>o(576737),c=()=>o(630116),u=()=>o(585428),p=()=>o(134217),h=()=>o(749240),g=()=>o(58293),m=()=>o(646736);function f(e){const{query:t,filter:o,limit:f,disable:y,sort:v}=e,b=(0,i().O$)(h().subscriptionDataStoreInstance),w=(0,i().K8)((()=>l().A.state.shouldUseEdgeCache),[]),x=(0,s().tz)(),A=(0,g().r)(),C=(0,n().v3)(),k=(0,i().K8)((()=>{if(y||w||!b||!A)return[];return p().Be(b).map((e=>{var t,o;const r=c().LU.createChildStore(A,{table:a().oo,id:e.userId}),n=(0,m().dp)(A,e.userId);return{id:e.userId,email:r.getEmail()||"",space_id:A.id,name:r.getDisplayName(x),profile_photo:null===(t=r.getModel())||void 0===t?void 0:t.profile_photo,membership_type:n.getMembershipType(),onboarding_completed:null===(o=r.getModel())||void 0===o?void 0:o.onboarding_completed,first_joined_space_time:S(e)}}))}),[y,w,b,A,x]),M=(0,r.useMemo)((()=>y?void 0:w&&A?new(u().e)({users:void 0,environment:C,spaceId:A.id,initialMembershipFilter:o,initialSort:v,initialQuery:t,limit:f}):new(d().z)({users:k,initialMembershipFilter:o,initialSort:v,initialQuery:t})),[y,w,A,C]);return(0,r.useEffect)((()=>{M instanceof d().z&&M.setUsers(k)}),[M,k]),(0,r.useEffect)((()=>{null==M||M.setSort(v)}),[M,v]),(0,r.useEffect)((()=>{null==M||M.setQuery(t)}),[M,t]),(0,r.useEffect)((()=>{null==M||M.setFilter(o)}),[M,o]),M}function S(e){return"firstJoinedSpaceTime"in e?e.firstJoinedSpaceTime??Date.now():Date.now()}},124749:(e,t,o)=>{o.d(t,{$:()=>i});var r=()=>o(56366);const n=new(o(496506).ComputedStore)((()=>o(765957).default.state.currentUserStore),{debugName:"AppStoreCurrentUserStore"});function i(){return(0,r().O$)(n)}},132855:(e,t,o)=>{o.r(t),o.d(t,{arrowInCircleUpFillIcon:()=>n,iconDefinition:()=>r});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,o(474848).jsx)("path",{d:"M10 17.625a7.625 7.625 0 1 0 0-15.25 7.625 7.625 0 0 0 0 15.25m3.042-8.07a.625.625 0 0 1-.884 0L10.625 8.02v5.466a.625.625 0 1 1-1.25 0V8.021L7.842 9.554a.625.625 0 1 1-.884-.883l2.6-2.6a.625.625 0 0 1 .884 0l2.6 2.6a.625.625 0 0 1 0 .883"})},n=(0,o(340498).wt)("arrowInCircleUpFill",r)},160992:(e,t,o)=>{o.d(t,{K:()=>l});o(581454);var r=()=>o(484714),n=()=>o(56366),i=()=>o(186445),a=()=>o(765957),s=()=>o(174674);function l(){const e=(0,r().v3)(),t=(0,n().O$)(a().default),o=(0,n().K8)((()=>(0,i()._m)(e)),[e]);return(0,n().K8)((()=>{var e;if(!o)return[];const r=(null===(e=t.currentSpaceViewStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.agent_chat_modules)??[];return 0===r.length?[]:r.map((e=>({defaultEnabled:e.defaultEnabled,workflowModuleStore:s().P.createChildStore(o,e.pointer)})))}),[t.currentSpaceViewStore,o])}},173019:(e,t,o)=>{o.d(t,{r:()=>n});o(296540);var r=o(474848);const n=(0,o(340498).wt)("pencil",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},199734:(e,t,o)=>{o.d(t,{U:()=>n});o(296540);var r=o(474848);const n=(0,o(340498).wt)("collectionSearch",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M0 6.35938C0 9.86719 2.85156 12.7188 6.35938 12.7188C7.66406 12.7188 8.85938 12.3203 9.85938 11.6406L13.4531 15.2344C13.6719 15.4609 13.9766 15.5625 14.2812 15.5625C14.9453 15.5625 15.4219 15.0625 15.4219 14.4141C15.4219 14.1016 15.3125 13.8125 15.1016 13.5938L11.5312 10.0156C12.2734 8.99219 12.7188 7.72656 12.7188 6.35938C12.7188 2.85156 9.86719 0 6.35938 0C2.85156 0 0 2.85156 0 6.35938ZM1.65625 6.35938C1.65625 3.76562 3.75781 1.65625 6.35938 1.65625C8.95312 1.65625 11.0625 3.76562 11.0625 6.35938C11.0625 8.95312 8.95312 11.0625 6.35938 11.0625C3.75781 11.0625 1.65625 8.95312 1.65625 6.35938Z"})})},240865:(e,t,o)=>{o.d(t,{V:()=>i});var r=()=>o(56366),n=()=>o(765957);function i(e){return(0,r().K8)((()=>{var t;return e?e.getMemberCountFromPublicSpaceData()??void 0:(null===(t=n().default.state.currentSpaceStore)||void 0===t?void 0:t.getMemberCountFromPublicSpaceData())??void 0}),[e])}},271084:(e,t,o)=>{o.d(t,{k:()=>n});o(581454);class r extends(()=>o(757695))().Store{getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}getSortedUserIds(){return Object.entries(this.state||{}).sort(((e,t)=>{let[o,r]=e,[n,i]=t;return i-r})).map((e=>{let[t,o]=e;return t}))}}const n=new r;(0,o(604341).exposeDebugValue)("UserSimilarityStore",n)},278105:(e,t,o)=>{o.d(t,{i:()=>i});var r=o(296540),n=()=>o(725614);function i(e){const{textStore:t,initialFocus:o}=e,i=(0,r.useCallback)((()=>{n().setSelectionAtEnd({store:t})}),[t]);return(0,r.useEffect)((()=>{o&&i()}),[o,i]),i}},308903:(e,t,o)=>{o.d(t,{l:()=>y});var r=o(296540),n=()=>o(484714),i=()=>o(56366),a=()=>o(401497),s=()=>o(370657),l=()=>o(12193),d=()=>o(959013),c=()=>o(2220),u=()=>o(285790),p=()=>o(859428),h=()=>o(553965),g=()=>o(962730),m=()=>o(390898),f=o(474848);const S=(0,d().YK)({tooltipLabel:{id:"aiInferenceTranscript.webSearchButton.tooltipLabel",defaultMessage:"Web sources"},webSearchDownTooltip:{id:"aiInferenceTranscript.webSearchButton.webSearchDownTooltip",defaultMessage:"Web search is currently unavailable"}});function y(e){const{clientStore:t,webSearchDown:o,threadStore:y}=e,v=(0,n().v3)(),b=(0,d().tz)(),w=(0,i().K8)((()=>t.state.configForNewTranscripts),[t]),x=(0,r.useMemo)((()=>(0,s().bm)(w)&&w.useWebSearch),[w]),A=(0,r.useCallback)((()=>{if((0,s().bm)(w)){const e=!w.useWebSearch,o={...w,useWebSearch:e};t.setState({...t.state,configForNewTranscripts:o}),y&&(0,m().kh)({threadStore:y,config:o,environment:v}),(0,c().u)({environment:v,event:{eventName:"clicked_ai_chat_toggle_web_search_button",eventProperties:{mode:w.type,enabled_web_search:e}}})}}),[t,w,v,y]),C=(0,a().IS)((e=>({icon:{width:20,height:20,transition:"fill 150ms ease"},buttonHovered:{backgroundColor:x?e.palette.uiBlue[50]:void 0},buttonPressed:{backgroundColor:x?e.palette.uiBlue[100]:void 0}})),[x]);return(0,f.jsx)(p().A,{placement:g().W.Bottom,alignment:g().C.Start,renderTooltip:()=>o?(0,f.jsx)(d().sA,{...S.webSearchDownTooltip}):(0,f.jsx)(d().sA,{...S.tooltipLabel}),render:e=>(0,f.jsx)(u().A,{disabled:o,...(0,h().A)(e,{onClick:A}),ariaLabel:b.formatMessage(S.tooltipLabel),icon:l().globeIcon,iconStyle:C.icon,color:x?"uiBluePrimary":"tertiary",size:"md",hoveredStyle:C.buttonHovered,pressedStyle:C.buttonPressed})})}},381138:(e,t,o)=>{o.d(t,{q:()=>n});o(296540);var r=o(474848);const n=(0,o(340498).wt)("search",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M.281 6.438c0-.875.164-1.696.492-2.461a6.484 6.484 0 011.375-2.032A6.237 6.237 0 016.64.078 6.2 6.2 0 019.11.57c.77.328 1.447.787 2.03 1.375a6.374 6.374 0 011.368 2.032c.333.765.5 1.586.5 2.46 0 .688-.107 1.342-.32 1.961a6.28 6.28 0 01-.868 1.696l3.563 3.578c.11.104.19.226.242.367.057.14.086.29.086.445 0 .22-.05.417-.149.594a1.122 1.122 0 01-1 .57c-.156 0-.307-.028-.453-.086a1.058 1.058 0 01-.382-.25l-3.586-3.585c-.5.333-1.047.596-1.641.789a6.089 6.089 0 01-1.86.28 6.237 6.237 0 01-2.468-.491 6.4 6.4 0 01-2.024-1.367A6.509 6.509 0 01.773 8.913a6.256 6.256 0 01-.492-2.476zm1.664 0c0 .65.12 1.26.36 1.828a4.775 4.775 0 001.015 1.5c.433.427.933.763 1.5 1.007a4.548 4.548 0 001.82.368c.652 0 1.261-.123 1.829-.368a4.747 4.747 0 002.508-2.507 4.567 4.567 0 00.367-1.829c0-.645-.123-1.252-.367-1.82a4.776 4.776 0 00-1.016-1.5A4.578 4.578 0 008.469 2.11a4.567 4.567 0 00-1.828-.367c-.646 0-1.253.123-1.82.367a4.667 4.667 0 00-1.5 1.008c-.433.432-.772.932-1.016 1.5a4.633 4.633 0 00-.36 1.82z"})})},430102:(e,t,o)=>{o.d(t,{I:()=>u});var r=o(296540),n=()=>o(401497),i=()=>o(854705),a=()=>o(381349),s=()=>o(704152),l=()=>o(960715),d=()=>o(859428),c=o(474848);const u=r.memo(r.forwardRef((function(e,t){const{style:o,color:r,title:i,onClick:a,onDropdownClick:s,mainButtonTooltip:d,dropdownTooltip:u,iconLeading:g,iconStyle:m,mainButtonStyle:f,isLoading:S,className:y,disabled:v,disableDropdown:b,size:w,variant:x="solid"}=e,A=(0,n().IS)((e=>{const t=(0,l().qq)({size:w,isButtonGapEnabled:!1});return{wrap:{position:"relative",display:"inline-flex",flexShrink:0,borderRadius:6,overflow:"hidden",height:t.height,...o},border:{position:"absolute",pointerEvents:"none",border:"outline"===x?`1px solid ${e.outlineButtonBorder}`:void 0,borderRadius:t.borderRadius,top:0,left:0,right:0,bottom:0}}}),[w,x,o]);return(0,c.jsxs)("div",{style:A.wrap,className:y,children:[(0,c.jsx)(p,{ref:t,color:r,disabled:v,icon:g,iconStyle:m,isLoading:S,mainButtonStyle:f,mainButtonTooltip:d,onClick:a,title:i,variant:x}),(0,c.jsx)(h,{ref:t,color:r,disabled:b,dropdownTooltip:u,isLoading:S,onDropdownClick:s,variant:x}),(0,c.jsx)("div",{style:A.border})]})}))),p=r.memo(r.forwardRef((function(e,t){const{mainButtonTooltip:r,onClick:i,disabled:u,isLoading:p,icon:h,title:m,color:f,variant:S,mainButtonStyle:y,iconStyle:v,size:b}=e,w=(0,n().IS)((e=>{const t=(0,l().qq)({size:b,isButtonGapEnabled:!1}),r={background:g(f,S,{outline:void 0,solid:{blue:a().Ay.blue,black:a().Ay.frontBlackButtonBackground,orange:e.palette.orange["dark"===e.mode?100:50]}}),color:g(f,S,{outline:{blue:e.text.uiBluePrimary,black:e.text.primary,orange:e.text.orangeSecondary},solid:{blue:a().Ay.white,black:a().Ay.white,orange:e.palette.orange["dark"===e.mode?600:400]}})};return{mainButton:{display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderTopLeftRadius:6,borderBottomLeftRadius:6,paddingLeft:t.paddingLeft,paddingRight:t.paddingRight,fontSize:t.fontSize,fontWeight:o(284371).Wy.medium,...r,...y},icon:{width:12,marginRight:6,fill:g(f,S,{outline:r.color,solid:{blue:a().Ay.white,black:a().Ay.white,orange:e.palette.orange[400]}}),...v},buttonHoveredStyle:{background:g(f,S,{outline:{blue:e.tint.uiBlueHover,black:e.tint.primaryHover,orange:e.tint.uiRedHover},solid:{blue:e.blueButtonHoveredBackground,black:a().Ay.frontBlackButtonBackgroundHovered,orange:e.palette.orange["dark"===e.mode?200:100]}})},buttonPressedStyle:{background:g(f,S,{outline:{blue:e.tint.uiBluePressed,black:e.tint.primaryPressed,orange:e.tint.uiRedPressed},solid:{blue:e.blueButtonPressedBackground,black:a().Ay.frontBlackButtonBackgroundPressed,orange:e.palette.orange["dark"===e.mode?300:200]}})}}}),[f,v,y,b,S]);return r?(0,c.jsx)(d().A,{renderTooltip:()=>r,render:e=>(0,c.jsxs)(s().A,{ref:t,style:w.mainButton,onClick:i,disabled:u,disabledFeedback:!0,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,...e,children:[h?h(w.icon):null,m]})}):(0,c.jsxs)(s().A,{ref:t,style:w.mainButton,onClick:i,disabled:u||p,disabledFeedback:!0,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,children:[p?(0,c.jsx)(o(331542).A,{style:{marginRight:4}}):null,h?h(w.icon):null,m]})}))),h=r.memo(r.forwardRef((function(e,t){const{disableDropdown:u,disabled:p,dropdownTooltip:h,onDropdownClick:m,isLoading:f,size:S,color:y,variant:v}=e,{isMobile:b}=(0,o(484714).Y0)(),w=(0,n().IS)((e=>{const t=(0,l().qq)({size:S,isButtonGapEnabled:!1}),r={background:g(y,v,{outline:void 0,solid:{blue:a().Ay.blue,black:a().Ay.frontBlackButtonBackground,orange:e.palette.orange["dark"===e.mode?100:50]}}),color:g(y,v,{outline:{blue:e.text.uiBluePrimary,black:e.text.primary,orange:e.text.orangeSecondary},solid:{blue:a().Ay.white,black:a().Ay.white,orange:e.palette.orange["dark"===e.mode?600:400]}})};return{dropdownButton:{display:"flex",alignItems:"center",justifyContent:"center",width:b?28:24,alignSelf:"stretch",borderTopRightRadius:t.borderRadius,borderBottomRightRadius:t.borderRadius,boxShadow:"outline"===v||"blue"===y||"black"===y?`inset 1px 0 0 ${e.darkDividerColor}`:"orange"===y?`${e.palette.orange["dark"===e.mode?200:100]} 1px 0 0 inset`:(0,o(534177).HB)(y),...r},dropdownButtonIcon:{width:o(340498).Ev.sm,marginTop:2,fill:g(y,v,{outline:r.color,solid:{blue:a().Ay.white,black:a().Ay.white,orange:e.palette.orange["dark"===e.mode?500:400]}})},buttonHoveredStyle:{background:g(y,v,{outline:{blue:e.tint.uiBlueHover,black:e.tint.primaryHover,orange:e.tint.uiRedHover},solid:{blue:e.blueButtonHoveredBackground,black:a().Ay.frontBlackButtonBackgroundHovered,orange:e.palette.orange["dark"===e.mode?200:100]}})},buttonPressedStyle:{background:g(y,v,{outline:{blue:e.tint.uiBluePressed,black:e.tint.primaryPressed,orange:e.tint.uiRedPressed},solid:{blue:e.blueButtonPressedBackground,black:a().Ay.frontBlackButtonBackgroundPressed,orange:e.palette.orange["dark"===e.mode?300:200]}})}}}),[y,b,S,v]),x=(0,r.useCallback)((e=>(0,c.jsx)(s().A,{ref:t,style:w.dropdownButton,onClick:m,disabledFeedback:!0,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,...e,children:(0,i().arrowChevronSingleDownFillSmallIcon)(w.dropdownButtonIcon)})),[m,t,w.buttonHoveredStyle,w.buttonPressedStyle,w.dropdownButton,w.dropdownButtonIcon]),A=(0,r.useCallback)((()=>h),[h]);return u||p?null:h?(0,c.jsx)(d().A,{renderTooltip:A,render:x}):(0,c.jsx)(s().A,{ref:t,style:w.dropdownButton,onClick:m,disabledFeedback:!0,hoveredStyle:w.buttonHoveredStyle,pressedStyle:w.buttonPressedStyle,disabled:f,children:(0,i().arrowChevronSingleDownFillSmallIcon)(w.dropdownButtonIcon)})})));function g(e,t,o){return"object"!=typeof o[t]?o[t]:o[t][e]}},458366:(e,t,o)=>{o.d(t,{B2:()=>j,F1:()=>C,Kc:()=>x,NN:()=>I,UY:()=>w,br:()=>_,lA:()=>k,lh:()=>A,pi:()=>y,w_:()=>b,zP:()=>v});o(898992),o(737550);var r=()=>o(584262),n=()=>o(443239),i=()=>o(970013),a=()=>o(713998),s=()=>o(882262),l=()=>o(415566),d=()=>o(177256),c=()=>o(72135),u=()=>o(919709),p=()=>o(496603),h=()=>o(534177),g=()=>o(939768),m=()=>o(720665),f=()=>o(492414),S=()=>o(972435);function y(e){return Boolean(e.state.isOpen&&e.state.collectionsBulkActionsToolbarStore)}function v(e){switch(e){case"table":return"table";case"board":return"board";case"list":return"list";case"gallery":return"gallery";case"feed":return"feed";case"relation":case"relation_section":return"relation_section";case"timeline":return"timeline";case"calendar":return"calendar";case"page":return"page_properties";case"compact_page":return"compact_page";case"mini":return"mini_peek";case"form_editor":case"form_viewer":case"property_module":return"property_module";default:(0,h().HB)(e)}}function b(e){return{backgroundImage:`linear-gradient(\n\t\tto right,\n\t\t${e.darkDividerColor} 0%,\n\t\t${e.darkDividerColor} 100%\n\t)`,backgroundRepeat:"repeat-x",backgroundPosition:"0 100%",backgroundSize:"100% 1px"}}function w(e){const{store:t,property:o,propertySchema:n}=e,i=null==n?void 0:n.type;if("title"===i)return(0,f().Ay)({store:t,fullyQualified:!1,pageVisitSource:r().y8.LinkInPage});{const e=t.getPropertyValue(o);return a().UY(i,e)}}function x(e){let t=(0,u().k4p)(e);if(!t||""===t.trim()||t.trim().includes(" "))return{domain:void 0,restOfUrl:void 0};t=t.trim();let o=g().qg(t),r=o.host;if(o.protocol&&r||(o=g().qg(`http://${t}`),r=o.host),!r)return{domain:void 0,restOfUrl:void 0};r&&(r=r.replace(/^www./i,""));const n=t.toLowerCase().indexOf(r.toLowerCase());if(-1===n)return{domain:void 0,restOfUrl:void 0};r=t.slice(n,n+r.length);return{domain:r,restOfUrl:t.slice(n+r.length)}}function A(e){const{numberValue:t,numberFormat:o,numberShowAs:r}=e;if(!(p().yr(t)||m().pN(t)||"bar"!==(null==r?void 0:r.type)&&"ring"!==(null==r?void 0:r.type))){const e=S().A.getIntl();return"percent"===o?c().ZV(t,"percent",e):`${t} / ${r.maxValue}`}}function C(e){const{property:t,collectionStore:o}=e,r=o.isSyncedCollection();return Boolean(r)&&(0,n().u)(t)}function k(e,t){switch(e){case"side_peek":return{icon:d().A,tooltip:S().A.formatMessage(M.openInSidePeekTooltip),caption:t?"":S().A.formatMessage(M.openAsPageTitle)};case"center_peek":return{icon:l().q,tooltip:S().A.formatMessage(M.openInCenterPeekTooltip),caption:t?"":S().A.formatMessage(M.openAsPageTitle)};case"full_page":return{icon:s().m,tooltip:S().A.formatMessage(M.openAsPageTooltip),caption:t?"":S().A.formatMessage(M.openAsPageTitle)};default:(0,h().HB)(e)}}const M=(0,o(959013).YK)({openAsPageTitle:{defaultMessage:"Open",id:"database.actionButton.openAsPageTitle"},openAsPageTooltip:{defaultMessage:"Open as page",id:"database.actionButton.openAsPageTooltip"},openInCenterPeekTooltip:{defaultMessage:"Open in center peek",id:"database.actionButton.openInCenterPeekTooltip"},openInSidePeekTooltip:{defaultMessage:"Open in side peek",id:"database.actionButton.openInSidePeekTooltip"}});function _(e){const{store:t,additionalStores:o,collectionContextStore:r}=e,n=t.getAssociatedCollectionStore();return!("collectionTypedView"!==(null==r?void 0:r.contextType)||!n)&&o.some((e=>{var t;return(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.id)!==n.id}))}function I(e){return"form_editor"===e||"form_viewer"===e}function j(e){return Boolean(e&&!i().dA.includes(e.type))}},461924:(e,t,o)=>{o.d(t,{o:()=>r});o(898992),o(354520);class r{constructor(e){this.rowsStore=new n,this.sort=void 0,this.filter=void 0,this.abortController=void 0,this._isFetching=!1,this.rowsStore.setState({rows:e,hasMore:!0})}async _maybeFetch(){if(!this._isFetching){this._isFetching=!0;try{return await this.fetch()}finally{this._isFetching=!1}}}async loadMore(){const e=await this._maybeFetch();e&&this.rowsStore.setState({rows:[...this.rowsStore.getState().rows??[],...e.rows??[]],hasMore:e.hasMore})}async setSort(e){this.sort=e,await this.refresh()}async setFilter(e){this.filter=e,await this.refresh()}async refresh(){var e;null===(e=this.abortController)||void 0===e||e.abort(),this._isFetching=!1;const t=await this._maybeFetch();t&&this.rowsStore.setState({rows:t.rows,hasMore:t.hasMore})}}class n extends(()=>o(757695))().Store{getInitialState(){return{rows:void 0,hasMore:!0}}}},477293:(e,t,o)=>{o.d(t,{r:()=>i});var r=()=>o(56366),n=()=>o(217429);function i(e){let{disableExposureLogging:t,disableEventTrailLogging:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r().K8)((()=>n().default.getEligibleGroup({experimentId:e,defaultGroup:"control",disableExposureLogging:t,disableEventTrailLogging:o})),[e,t,o])}},497222:(e,t,o)=>{o.d(t,{A:()=>h});o(296540);var r=()=>o(804773),n=()=>o(401497),i=()=>o(906380),a=()=>o(30626),s=()=>o(284371),l=()=>o(760217),d=()=>o(8980),c=()=>o(612900),u=()=>o(700251),p=o(474848);function h(e){const{icon:t,iconStyle:o,title:h,caption:g,right:m,rightStyle:f,isRed:S,isGray:y,isOrange:v,onClick:b,onMouseDown:w,onMouseEnter:x,onMouseLeave:A,disabled:C,showChevron:k,chevronStyle:M,rotateChevron:_,showDragHandle:I,focused:j,textWrapperStyle:B,shouldWrapCaption:P,desktopIconStyle:T,buttonStyle:D,desktopTitleStyle:F,source:R,menuListItemProps:E,isPulsing:L}=e,O=(0,u().y$)(),U=(0,n().IS)((e=>({style:{...(e=>y?{color:e.text.secondary,fill:e.icon.secondary}:v?{color:e.icon.orangePrimary,fill:e.icon.orangePrimary}:{color:e.text.primary,fill:e.icon.primary})(e),opacity:C?.4:void 0,...D},leftIconStyle:{width:O,height:O,...t===a()._&&{height:3},...o},rightStyle:{display:"flex",alignItems:"center",color:C?e.text.primary:e.text.tertiary,fill:C?e.icon.primary:e.icon.tertiary,flexShrink:0,...f},rightChevronStyle:{marginLeft:"tableHeaderMenu"===R?0:6,transition:"transform 200ms ease-in-out",..._&&{transform:"rotate(90deg)"},...M}})),[y,v,C,o,t,M,f,D,O,_,R]),{itemRef:z,isTabbable:H,onKeyDown:V,onFocus:K}=(0,r().e)(),N=(0,p.jsx)(l().A,{ref:z,icon:null==t?void 0:t(U.leftIconStyle),focused:j||!1,disabled:C,title:h,caption:g,shouldWrapCaption:P,desktopTitleStyle:{flexGrow:1,flexShrink:1,...F},onKeyDown:V,onFocus:K,disallowTabbing:!H,showDragHandle:I,buttonStyle:U.style,rightStyle:U.rightStyle,isRedOnHover:S,ignoreLocalHoverState:!!C||void 0,right:(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{style:{...s().RC,display:"flex"},children:m}),!C&&k?(0,p.jsx)(d().I,{icon:i().arrowChevronSingleRightSmallIcon,size:"sm",color:"tableHeaderMenu"===R?"secondary":"tertiary",style:U.rightChevronStyle}):null]}),onClick:b,onMouseDown:w,onMouseEnter:x,onMouseLeave:A,textWrapperStyle:B,desktopIconStyle:T,...E});return L?(0,p.jsx)(c().u,{borderRadius:6,shape:"square",children:N}):N}},528782:(e,t,o)=>{o.d(t,{m:()=>n});o(296540);var r=o(474848);const n=(0,o(340498).wt)("stop",{viewBox:"0 0 20 20",svg:(0,r.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 19 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("rect",{y:"0.793945",width:"18.8027",height:"18.8027",rx:"9.40137",fill:"#37352F"}),(0,r.jsx)("rect",{x:"5.91028",y:"6.7041",width:"6.98255",height:"6.98255",rx:"0.783447",fill:"white"})]})})},576737:(e,t,o)=>{o.d(t,{z:()=>n});o(898992),o(354520),o(581454);var r=()=>o(848538);class n extends(()=>o(461924))().o{constructor(e){const{users:t,initialMembershipFilter:o,initialSort:r,initialQuery:n,limit:i}=e;super([]),this._allUsers=void 0,this._filteredAndSortedUsers=[],this._currentPage=0,this._limit=void 0,this._query=void 0,this._allUsers=[...t],this._limit=i??20,this._query=void 0,this.filter=o,this.sort=r,this._query=n,this._updateFilteredAndSortedUsers(),this.refresh()}_updateFilteredAndSortedUsers(){let e=this._applyMembershipFilter(this._allUsers);this._query&&(e=this._applySearch(e)),this.sort&&(e=this._applySort(e)),this._filteredAndSortedUsers=e}_applyMembershipFilter(e){return this.filter?e.filter((e=>"members"===this.filter?void 0!==e.membership_type&&(0,r().MN)(e.membership_type):"guests"!==this.filter||void 0!==e.membership_type&&(0,r().P)(e.membership_type))):e}_applySearch(e){return this._query&&0!==this._query.length?(0,o(778078).Ay)(this._query,e,(e=>[e.name,e.email].filter(Boolean).join(" "))):e}_applySort(e){if(!this.sort)return e;const{field:t,direction:o}=this.sort,r="asc"===o?1:-1,n=e.map((e=>{let o,r;switch(t){case"name_normalized":o=this._normalizeName(e.name)||e.email.toLowerCase();break;case"type":o=this._getMembershipTypeRank(e.membership_type),r=this._normalizeName(e.name)||e.email.toLowerCase();break;case"first_joined":o=e.first_joined_space_time||0;break;default:o=null}return{user:e,sortValue:o,secondarySortValue:r}}));return n.sort(((e,o)=>{if(null===e.sortValue&&null===o.sortValue);else{if(null===e.sortValue)return Number(r);if(null===o.sortValue)return-1*r;if(e.sortValue<o.sortValue)return-1*r;if(e.sortValue>o.sortValue)return Number(r)}if("type"===t&&e.secondarySortValue&&o.secondarySortValue){if(e.secondarySortValue<o.secondarySortValue)return-1;if(e.secondarySortValue>o.secondarySortValue)return 1}return(e.user.id<o.user.id?-1:1)*r})),n.map((e=>e.user))}_normalizeName(e){return null==e?void 0:e.normalize("NFKD").toLowerCase().replace(/\p{Diacritic}/gu,"")}_getMembershipTypeRank(e){switch(e){case"owner":return 6;case"membership_admin":return 5;case"member":return 4;case"restricted_member":return 3;case"page_guest":return 2;case"none":return 1;default:return 0}}async setUsers(e){this._allUsers=[...e],this._updateFilteredAndSortedUsers(),await this.refresh()}async setFilter(e){this.filter!==e&&(this._currentPage=0,this.filter=e,this._updateFilteredAndSortedUsers(),await this.refresh())}async setSort(e){var t,o;(null===(t=this.sort)||void 0===t?void 0:t.field)===(null==e?void 0:e.field)&&(null===(o=this.sort)||void 0===o?void 0:o.direction)===(null==e?void 0:e.direction)||(this._currentPage=0,this.sort=e,this._updateFilteredAndSortedUsers(),await this.refresh())}async setQuery(e){this._query!==e&&(this._query=e,this._currentPage=0,this._updateFilteredAndSortedUsers(),await this.refresh())}async fetch(){const e=this._currentPage*this._limit,t=e+this._limit,o=this._filteredAndSortedUsers.slice(e,t),r=t<this._filteredAndSortedUsers.length;return Promise.resolve({rows:o,hasMore:r})}async loadMore(){this._currentPage++,await super.loadMore()}async refresh(){this._currentPage=0,await super.refresh()}TEST_ONLY_setLimit(e){this._limit=e}}},585428:(e,t,o)=>{o.d(t,{e:()=>r});o(16280),o(898992),o(354520);class r extends(()=>o(461924))().o{constructor(e){let{users:t,environment:o,spaceId:r,initialMembershipFilter:n,initialSort:i,initialQuery:a,limit:s}=e;super(t),this._spaceId=void 0,this._environment=void 0,this._cursor=void 0,this._limit=void 0,this._query=void 0,this._environment=o,this._limit=s??20,this._cursor=void 0,this._query=void 0,this._spaceId=r,this.filter=n,this.sort=i,this._query=a,this.refresh()}async setFilter(e){this.filter!==e&&(this._cursor=void 0,this.filter=e,await this.refresh())}async setSort(e){var t,o;(null===(t=this.sort)||void 0===t?void 0:t.field)===(null==e?void 0:e.field)&&(null===(o=this.sort)||void 0===o?void 0:o.direction)===(null==e?void 0:e.direction)||(this._cursor=void 0,this.sort=e,await this.refresh())}async setQuery(e){this._query!==e&&(this._query=e,this._cursor=void 0,await this.refresh())}async refresh(){this._cursor=void 0,await super.refresh()}async fetch(){return await(0,o(532313).L5)({fn:async()=>{var e,t;const{callApi:r}=await Promise.resolve().then(o.bind(o,449506));this.abortController=new AbortController;const n=await r({eventName:"listUsers",environment:this._environment,data:{cursor:this._cursor,membershipFilter:this.filter,limit:this._limit,sort:null===(e=this.sort)||void 0===e?void 0:e.field,sortDirection:null===(t=this.sort)||void 0===t?void 0:t.direction,query:this._query,spaceId:this._spaceId},abortSignal:this.abortController.signal});if(this.abortController=void 0,"success"===n.type)return this._cursor=n.data.nextCursor,{rows:n.data.users,hasMore:n.data.hasMore};if("failed"===n.type&&(n.offline||429===n.status||503===n.status||504===n.status))throw new Error(`RetryableError:${n.status}`)},handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:[1e3,2e3,4e3],retryAttemptRandomOffsetMS:500,initialInput:void 0})}}},610101:(e,t,o)=>{o.d(t,{A:()=>n});class r extends(()=>o(757695))().Store{getInitialState(){return!1}}const n=new r},854705:(e,t,o)=>{o.r(t),o.d(t,{arrowChevronSingleDownFillSmallIcon:()=>n,iconDefinition:()=>r});o(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"2.94 5.31 10.15 5.84",svg:(0,o(474848).jsx)("path",{d:"M7.47 10.93a.75.75 0 0 0 1.06 0l4.32-4.32a.75.75 0 1 0-1.06-1.06L8 9.34 4.21 5.55a.75.75 0 0 0-1.06 1.06z"})},n=(0,o(340498).wt)("arrowChevronSingleDownFillSmall",r)},882262:(e,t,o)=>{o.d(t,{m:()=>n});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"3.23 3.23 13.54 13.53",svg:(0,o(474848).jsx)("path",{d:"M4.485 8.86V5.369l4.073 4.073a.625.625 0 0 0 .884-.884L5.369 4.485h3.49a.625.625 0 1 0 0-1.25h-5a.625.625 0 0 0-.624.625v5a.625.625 0 0 0 1.25 0m10.146 6.655-4.07-4.07a.625.625 0 0 1 .884-.884l4.07 4.07V11.14a.625.625 0 1 1 1.25 0v5c0 .345-.28.625-.625.625h-5a.625.625 0 1 1 0-1.25z"})},n=(0,o(340498).wt)("arrowExpandDiagonal",r)},882720:(e,t,o)=>{o.r(t),o.d(t,{AgentChatInput:()=>qe});var r=o(296540),n=()=>o(484714),i=()=>o(56366),a=()=>o(401497),s=()=>o(715256),l=()=>o(383286),d=()=>o(102777),c=()=>o(528782),u=()=>o(919709),p=()=>o(724639),h=()=>o(959013),g=()=>o(277942),m=()=>o(319975),f=()=>o(751156),S=()=>o(285790),y=()=>o(545805),v=()=>o(859428),b=()=>o(524702),w=()=>o(549500),x=()=>o(792540),A=()=>o(963589),C=()=>o(691298),k=()=>o(301421),M=()=>o(278105),_=()=>o(321843),I=()=>o(765957),j=()=>o(308227),B=()=>o(298182),P=()=>o(46986),T=()=>o(390898),D=()=>o(717375),F=()=>o(70128),R=()=>o(915619),E=()=>o(756219),L=()=>o(308903),O=()=>o(764235),U=()=>o(82008),z=(o(16280),o(944114),o(898992),o(354520),o(581454),()=>o(153321)),H=()=>o(792071),V=()=>o(696706),K=()=>o(728272),N=()=>o(798880),G=()=>o(496603),q=()=>o(534177),W=()=>o(220331),$=()=>o(493823),Q=()=>o(406699),Y=()=>o(419357),Z=()=>o(928600),J=()=>o(678553),X=()=>o(939740),ee=()=>o(460292),te=()=>o(864943),oe=()=>o(187820),re=()=>o(958378),ne=()=>o(89924),ie=()=>o(320865),ae=()=>o(241303),se=()=>o(603533),le=()=>o(62088),de=()=>o(542129),ce=()=>o(722872),ue=()=>o(962730),pe=()=>o(712505),he=()=>o(630116),ge=o(474848);const me=(0,h().YK)({inputPlaceholder:{id:"AgentChatContextChips.menu.searchPlaceholder",defaultMessage:"Search..."}});function fe(e){const{clientStore:t,threadStore:o}=e,n=(0,a().IS)((()=>({chipsContainer:{flexGrow:1,padding:"12px 12px 0px",display:"flex",flexWrap:"wrap",gap:"4px 6px",overflow:"hidden"}})),[]),s=(0,i().O$)(I().AppStoreMainEditorCurrentBlockStore),l=(0,i().O$)(pe().default.peekTargetStore),d=(0,i().K8)((()=>{if(o)return t.getOrCreateClientAIChatThreadStore(o.id)}),[t,o]),c=(0,r.useCallback)((e=>{var t;const o=null==d||null===(t=d.state.stagedData)||void 0===t?void 0:t.mentionStagedData,r=o&&o.size()>0?[...o??[]]:[null==s?void 0:s.pointer,null==l?void 0:l.pointer].filter(q().O9),n=new(K().d)(r);n.delete(e),null==d||d.setState({...d.state,stagedData:{...d.state.stagedData,mentionStagedData:n}})}),[d,s,l]),u=(0,i().K8)((()=>[...(null==d?void 0:d.state.stagedData.mentionStagedData)??[]].map((e=>(0,ge.jsx)(Se,{pointer:e,onRemove:c},V().L3.toKey(e))))),[d,c]);return 0===u.length?null:(0,ge.jsx)("div",{style:n.chipsContainer,children:u})}const Se=r.memo((function(e){const{pointer:t,onRemove:r}=e,n=(0,h().tz)(),s=(0,i().O$)(I().AppStoreCurrentSpaceStore),[l,d]=(0,o(554283).B)(),c=(0,a().IS)((e=>({chipRemoveButton:{width:18,height:18,display:"flex",alignItems:"center",justifyContent:"center",color:e.text.secondary},chipIcon:{display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20,flexShrink:0},chipRemoveButtonHovered:{background:"light"===e.mode?"rgba(0, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)",borderRadius:1e3,color:e.text.primary},chipContainer:{maxWidth:"50%",borderRadius:1e3,fontSize:12,fontWeight:400,height:28,padding:"2px 10px 2px 4px",borderWidth:"0.5px",display:"flex",alignItems:"center",gap:4,outline:"none",position:"relative"},chipGradientOverlay:{position:"absolute",right:0,top:0,bottom:0,width:40,background:`linear-gradient(to right, transparent 0%, ${"dark"===e.mode?e.palette.gray[200]:e.surface.elevated} 30%)`,borderRadius:"0 1000px 1000px 0",zIndex:1,pointerEvents:"none"},chipText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:0,flex:1},chipRemoveButtonContainer:{position:"absolute",right:6,width:16,height:16,zIndex:2,display:"flex",alignItems:"center",justifyContent:"center"}})),[]);return(0,i().K8)((()=>{if(!s)return null;const e=(0,ge.jsx)($().p,{style:c.chipRemoveButton,hoveredStyle:c.chipRemoveButtonHovered,onClick:()=>{r(t)},children:(0,ge.jsx)(ee().Q,{iconGroup:o(120251).k,variantName:"small",overrideSize:()=>14})});if(t.table===o(179034).ev){const r=he().Bv.createChildStore(s,t);return(0,ge.jsxs)(te().A,{style:c.chipContainer,hoveredBackgroundColor:"none",ref:l,children:[(0,ge.jsx)("div",{style:c.chipIcon,children:(0,ge.jsx)(oe().B6,{disabled:!0,icon:r.getIcon(),isEmptyPage:!1,size:16,iconRecordCategory:(0,oe().Te)(r)})}),(0,ge.jsx)("div",{style:c.chipText,children:(0,ge.jsx)(o(16006).A,{store:r})}),(0,ge.jsx)(z().P.div,{style:c.chipGradientOverlay,initial:!1,animate:{opacity:d?1:0}}),(0,ge.jsx)(z().P.div,{initial:!1,animate:{opacity:d?1:0,scale:d?1:.8},style:c.chipRemoveButtonContainer,children:e})]},t.id)}if(t.table===N().oo){var i;const r=he().LU.createChildStore(s,t),a=null===(i=r.getModel())||void 0===i?void 0:i.getFullName(n);return(0,ge.jsxs)(te().A,{style:c.chipContainer,hoveredBackgroundColor:"none",ref:l,children:[(0,ge.jsx)("div",{style:c.chipIcon,children:(0,ge.jsx)(o(453697).A,{userStore:r,size:16})}),(0,ge.jsx)("div",{style:c.chipText,children:a}),(0,ge.jsx)(z().P.div,{style:c.chipGradientOverlay,initial:!1,animate:{opacity:d?1:0}}),(0,ge.jsx)(z().P.div,{initial:!1,animate:{opacity:d?1:0,scale:d?1:.8},style:c.chipRemoveButtonContainer,children:e})]},t.id)}(0,q().HB)(t)}),[l,n,d,s,r,t,c.chipContainer,c.chipIcon,c.chipRemoveButton,c.chipRemoveButtonHovered,c.chipGradientOverlay,c.chipRemoveButtonContainer,c.chipText])}));function ye(e){const{clientStore:t,threadStore:o}=e,n=(0,i().K8)((()=>{if(o)return t.getOrCreateClientAIChatThreadStore(o.id)}),[t,o]),a=(0,r.useCallback)((e=>{null==n||n.setState({...n.state,stagedData:{...n.state.stagedData,mentionStagedData:new(K().d)([...n.state.stagedData.mentionStagedData??[],e.pointer])}})}),[n]),s=(0,i().K8)((()=>new(K().d)([...(null==n?void 0:n.state.stagedData.mentionStagedData)??[]])),[n]);return(0,ge.jsx)(Q().Ay,{render:e=>(0,ge.jsx)(ve,{onSelect:t=>{a(t),e.close()},selected:s}),renderOrigin:e=>(0,ge.jsx)(W().q,{...e}),popupType:Q().z7.Popup,placementToOrigin:ue().W.Top})}function ve(e){const{selected:t,onSelect:o}=e,a=(0,n().v3)(),s=(0,h().tz)(),[l,d]=(0,r.useState)(""),c=(0,i().O$)(I().AppStoreMainEditorCurrentBlockStore),u=(0,i().O$)(pe().default.peekTargetStore),{results:p,isLoading:g}=(0,le().u)({query:l,environment:a,intl:s,disabled:!1,useMentionMenuStore:!1,open:!0}),{results:m,isLoading:f}=(0,de().h)(l,{useMentionMenuStore:!1,open:!0}),S=(0,r.useMemo)((()=>{if(g)return{key:"loading-users",items:[{key:"loading",render:()=>(0,ge.jsx)(ie().A,{}),action:()=>{}}],render:e=>(0,ge.jsx)(ne().A,{...e,title:"Users"})};const e=p.filter((e=>!t.has({id:e.id,table:N().oo})));return 0!==e.length?{key:"users",items:e.map((e=>({key:e.id,render:t=>(0,r.createElement)(ae().A,{...t,key:e.id,user:e}),action:()=>{const{model:t}=H().Fvx.create(e);o(t)}}))),render:e=>(0,ge.jsx)(ne().A,{...e,title:"Users"})}:void 0}),[g,o,t,p]),y=(0,r.useMemo)((()=>{if(f)return{key:"loading-pages",items:[{key:"loading",render:()=>(0,ge.jsx)(ie().A,{}),action:()=>{}}],render:e=>(0,ge.jsx)(ne().A,{...e,title:"Pages"})};const e=m.filter((e=>{let{pageStore:o}=e;return!t.has(o.pointer)})),r=[];""===l&&(u&&!t.has(u.pointer)&&r.push(u),c&&!t.has(c.pointer)&&r.push(c));const n=new(K().d)(r.map((e=>e.pointer))),i=e.filter((e=>{let{pageStore:t}=e;return!n.has(t.pointer)})),a=[...r,...i.map((e=>e.pageStore))];if(0===a.length)return;const s=a.filter(q().O9).map((e=>({key:e.id,render:t=>(0,ge.jsx)(re().A,{...t,store:e,showVerifiedPageBadge:!0}),action:()=>{const t=e.getModel();if(!t)throw new Error("Expected to find model");o(t)}})));return{key:"pages",items:s,render:e=>(0,ge.jsx)(ne().A,{...e,title:(0,ge.jsx)(h().sA,{id:"AgentChatContextMenu.pageSectionTitle",defaultMessage:"Pages"})})}}),[c,o,m,f,u,l,t]),v=(0,r.useMemo)((()=>{const e=S||y?(0,G().oE)([y,S]):[{key:"no-results",items:[{key:"no-results",action:()=>{},render:e=>(0,ge.jsx)(J().Ay,{...e,title:"No results"})}],render:e=>(0,ge.jsx)(ne().A,{...e})}];return(0,G().oE)([{key:"input-section",render:e=>(0,ge.jsx)(ne().A,{...e}),items:[{key:"input",render:e=>(0,ge.jsx)(Y().Ay,{...e,focus:!0,placeholder:s.formatMessage(me.inputPlaceholder),value:l,onChange:e=>{d(e.target.value)}}),action:()=>{}}]},...e])}),[s,y,l,S]);return(0,ge.jsx)(Z().A,{menuType:ce().gu.Popup,width:(0,se().W)(),children:(0,ge.jsx)(X().Ay,{type:X().Oh.Vertical,initialFocus:1,sections:v})})}var be=()=>o(203066),we=()=>o(28070);function xe(e){const{loadAttachmentsData:{threadStore:t},clientStore:o,children:r}=e,n=(0,a().IS)((e=>({filePreviewWrapper:{width:"100%",padding:8},motionWrapper:{overflow:"hidden",width:"100%",borderBottom:`1px solid ${e.stroke.secondary}`}})),[]),s=(0,i().K8)((()=>o.getOrCreateClientAIChatThreadStore(t.id)),[o,t.id]),l=(0,i().K8)((()=>s.getStagedAttachmentUploadStoreIfExists()),[s]),d=(0,we().Jp)(l);return(0,ge.jsx)(be().N,{initial:!1,children:d&&d.length>0&&(0,ge.jsx)(z().P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15,ease:"easeInOut"},style:n.motionWrapper,children:(0,ge.jsx)("div",{style:n.filePreviewWrapper,children:r})})})}o(672577),o(803949);var Ae=()=>o(81986),Ce=()=>o(948621),ke=()=>o(589222),Me=()=>o(236262),_e=()=>o(978234),Ie=()=>o(563452),je=()=>o(736767),Be=()=>o(760217),Pe=()=>o(8980),Te=()=>o(574036),De=()=>o(958637),Fe=()=>o(186445),Re=()=>o(594794),Ee=()=>o(686594),Le=()=>o(614842),Oe=()=>o(388821),Ue=()=>o(246826),ze=()=>o(72234),He=()=>o(555102);function Ve(e){const{environment:t,spaceStore:o,threadStore:r,userStore:n,workflowModuleModels:i}=e;if(0===i.length)return;const a=r.getTranscript(),{activeIntegrationPointers:s,inactiveIntegrationPointers:l}=(0,Ie().It)(a),d=s.slice(0),c=l.slice(0),u=new(K().d)(d),p=new(K().d)(c),h=Oe().RecordMap.create();for(const f of i)u.has(f.pointer)&&u.delete(f.pointer),p.add(f.pointer),h.addModel(f);const g=Array.from(u),m=Array.from(p);f().createAndCommit({userAction:"agentPersistenceHelpers.deleteAgentChatModuleStep",environment:t,canUndo:!1,perform:e=>{(0,T().Vn)({addSteps:[(0,He().yQ)({environment:t,activeRecordPointers:g,inactiveRecordPointers:m,recordMap:h,spaceStore:o})],environment:t,spaceStore:o,threadStore:r,transaction:e,userStore:n})}})}var Ke=()=>o(160992);const Ne={action:()=>{},key:"agent_integration_no_integrations",render:e=>(0,ge.jsx)(J().Ay,{...e,title:(0,ge.jsx)(h().sA,{id:"AgentChatSettingsMenu.AgentChatModulesSection.NoIntegrationsTitle",defaultMessage:"No integrations"})})};function Ge(e){const{threadStore:t}=e,o=(0,a().IS)((()=>({settingsButton:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",flex:"none"}})),[]),s=function(e,t){const o=(0,h().tz)(),a=(0,n().v3)(),s=(0,i().K8)((()=>(0,Fe()._m)(a)),[a]),l=(0,i().O$)(I().AppStoreCurrentSpaceStore),d=(0,i().O$)(I().AppStoreCurrentSpaceViewStore),[c,u]=(0,r.useState)(!1),p=(0,i().K8)((()=>{const e=new(K().d),o=null==t?void 0:t.getTranscript();if(!o)return e;const{activeIntegrationPointers:r}=(0,Ie().It)(o);return new(K().d)(r)}),[t]),g=(0,r.useCallback)((o=>()=>{d&&t&&s&&l&&o.isDefined()&&(!function(e){let{environment:t,spaceStore:o,spaceViewStore:r,threadStore:n,userStore:i,workflowModuleStore:a}=e;Ve({environment:t,spaceStore:o,threadStore:n,userStore:i,workflowModuleModels:[a.getModel()]}),f().createAndCommit({canUndo:!1,environment:t,perform:e=>{var t;const o=(null===(t=r.getSettings())||void 0===t?void 0:t.agent_chat_modules)??[];ze().AG(r,e,{agent_chat_modules:o.filter((e=>!V().L3.isEqual(e.pointer,a.pointer)))}),Ue().zv({data:{alive:!1},store:a,transaction:e})},userAction:"agentPersistenceHelpers.deleteAgentChatModule"})}({environment:a,spaceStore:l,spaceViewStore:d,threadStore:t,userStore:s,workflowModuleStore:o}),e.length<=1&&u(!1))}),[e.length,s,a,l,d,t]),m=(0,r.useCallback)((e=>o=>{d&&t&&s&&l&&e.isDefined()&&(p.has(e.pointer)?Ve({environment:a,spaceStore:l,threadStore:t,userStore:s,workflowModuleModels:[e.getModel()]}):function(e){const{environment:t,spaceStore:o,threadStore:r,userStore:n,workflowModuleModels:i}=e;if(0===i.length)return;const a=r.getTranscript(),{activeIntegrationPointers:s,inactiveIntegrationPointers:l}=(0,Ie().It)(a),d=s.slice(0),c=l.slice(0),u=new(K().d)(d),p=new(K().d)(c),h=Oe().RecordMap.create();for(const f of i)p.has(f.pointer)&&p.delete(f.pointer),u.add(f.pointer),h.addModel(f);const g=Array.from(u),m=Array.from(p);f().createAndCommit({userAction:"agentPersistenceHelpers.addAgentChatModuleStep",environment:t,canUndo:!1,perform:e=>{(0,T().Vn)({addSteps:[(0,He().yQ)({environment:t,activeRecordPointers:g,inactiveRecordPointers:m,recordMap:h,spaceStore:o})],environment:t,spaceStore:o,threadStore:r,transaction:e,userStore:n})}})}({environment:a,spaceStore:l,threadStore:t,userStore:s,workflowModuleModels:[e.getModel()]}))}),[s,p,a,l,d,t]),y=(0,r.useCallback)((()=>{if(!s||!d)return;const e=window.prompt("Enter the name of the MCP to add");if(null===e)return;const t=window.prompt("Enter the URL of the MCP to add");if(null===t)return;const o=d.pointer.id,r=V().L3.fromPointerLike({table:_e().yM,id:(0,Re().Z1)({environment:a,table:_e().yM,spaceId:o}),spaceId:o});!function(e){let{currentUserPointer:t,environment:o,workflowModuleIcon:r,workflowModuleName:n,workflowModulePointer:i,workflowModuleServerUrl:a}=e;f().createAndCommit({canUndo:!1,environment:o,perform:e=>{Ue().vt({environment:o,table:_e().yM,args:{createdByPointer:t,id:i.id,module_type:"mcpServer",parentPointer:t,space_id:i.spaceId,alive:!0,data:{icon:r,id:i.id,name:n,serverUrl:a}},inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e})},userAction:"agentPersistenceHelpers.createAgentChatModule"})}({environment:a,currentUserPointer:s.pointer,workflowModulePointer:r,workflowModuleIcon:"🤖",workflowModuleName:e,workflowModuleServerUrl:t}),function(e){var t;let{environment:o,spaceViewStore:r,workflowModulePointer:n}=e;const i=(null===(t=r.getSettings())||void 0===t?void 0:t.agent_chat_modules)??[];f().createAndCommit({canUndo:!1,environment:o,perform:e=>{ze().AG(r,e,{agent_chat_modules:[...i,{pointer:n,defaultEnabled:!1}]})},userAction:"agentPersistenceHelpers.addAgentChatModule"})}({environment:a,spaceViewStore:d,workflowModulePointer:r})}),[s,a,d]),v=(0,i().K8)((()=>(0,G().oE)(e.map((e=>{const{workflowModuleStore:t}=e;if(!t.isDefined())return;const r=t.getDataStore().getKeyValue("name")??(0,ge.jsx)(h().sA,{id:"AgentChatSettingsMenu.AgentChatModulesSection.UnknownModuleTitle",defaultMessage:"Unknown module"}),n=Le().d.getIcon(t.getModuleType()),i=p.has(t.pointer);return{action:()=>{},key:`agent_integration_${e.workflowModuleStore.pointer.id}`,render:e=>c?(0,ge.jsx)(J().Ay,{...e,icon:(0,ge.jsx)(Pe().I,{icon:n}),right:(0,ge.jsx)(S().A,{ariaLabel:o.formatMessage({defaultMessage:"Delete {moduleName} integration",id:"AgentChatSettingsMenu.AgentChatModulesSection.DeleteButtonTitle"},{moduleName:r}),icon:Me().trashIcon,hasBackground:!0,onClick:g(t)}),title:r}):(0,ge.jsx)(Te().A,{...e,icon:(0,ge.jsx)(Pe().I,{icon:n}),on:i,onClick:m(t),title:r})}})))),[e,p,g,m,o,c]),b=(0,A().X)("workflows_mcp_server_module_available")?{action:y,key:"agent_change_module_add",render:e=>(0,ge.jsx)(Be().A,{...e,icon:(0,ge.jsx)(ee().Q,{colorName:"lightGrayPrimary",iconGroup:ke().h,variantName:"small"}),title:(0,ge.jsx)(h().sA,{id:"AgentChatSettingsMenu.AgentChatModulesSection.AddModuleButtonTitle",defaultMessage:"Add MCP integration"})})}:void 0,w=(0,r.useCallback)((()=>{u((e=>!e))}),[]),x=v.length>0;return{items:x?(0,G().oE)([...v,b]):(0,G().oE)([Ne,b]),key:"agent_integrations",render:e=>(0,ge.jsx)(ne().A,{...e,title:"Integrations",right:x?(0,ge.jsx)($().p,{isBlue:!0,size:"xs",onClick:w,children:c?(0,ge.jsx)(h().sA,{id:"AgentChatSettingsMenu.AgentChatModulesSection.DoneButtonTitle",defaultMessage:"Done"}):(0,ge.jsx)(h().sA,{id:"AgentChatSettingsMenu.AgentChatModulesSection.EditButtonTitle",defaultMessage:"Edit"})}):null})}}((0,Ke().K)(),t),l=function(){const e=(0,r.useContext)(De().p);if(!e)throw new Error("useFeatureGate must be used within a FeatureGateContextProvider");const t=(0,i().K8)((()=>Ae().QT.map(((t,o)=>{const r=(0,Ae().MI)(t,(t=>e.withoutExposureLogging(t,!1)));return{action:()=>{},key:`agent_feature_gate_${o}`,render:e=>(0,ge.jsx)(Te().A,{...e,on:r,onClick:()=>{if(t.featureGates.forEach((e=>{Ee().A.updateLocalOverrideGate(e,!r)})),!r)if("agent_automations"===t.id){const e=Ae().QT.find((e=>"custom_agents"===e.id));e&&e.featureGates.forEach((e=>{Ee().A.updateLocalOverrideGate(e,!0)}))}else if("experimental_integrations"===t.id){const e=Ae().QT.find((e=>"agent_integrations"===e.id));e&&e.featureGates.forEach((e=>{Ee().A.updateLocalOverrideGate(e,!0)}))}},title:t.label})}}))),[e]);return{items:[...t,{action:()=>{},key:"agent_feature_gates_info_caption",render:e=>(0,ge.jsx)(je().A,{...e,caption:(0,ge.jsx)(h().sA,{defaultMessage:"You will need to start a new thread when changing feature gates.",id:"AgentChatSettingsMenu.AgentFeatureGatesSection.InfoCaption"}),shouldWrapCaption:!0})}],key:"agent_feature_gates",render:e=>(0,ge.jsx)(ne().A,{...e,title:(0,ge.jsx)(h().sA,{id:"AgentChatSettingsMenu.AgentFeatureGatesSection.Title",defaultMessage:"Feature Gates"})})}}();(0,r.useCallback)((()=>{const e=(0,G().oE)([s,l]);return(0,ge.jsx)(Z().A,{menuType:ce().gu.Popup,children:(0,ge.jsx)(X().Ay,{initialFocus:void 0,sections:e,type:X().Oh.Vertical})})}),[s,l]),(0,r.useCallback)((e=>(0,ge.jsx)($().p,{...e,style:o.settingsButton,children:(0,ge.jsx)(ee().Q,{colorName:"lightGrayPrimary",iconGroup:Ce().i,variantName:"default"})})),[o.settingsButton]);return null}function qe(e){const t=(0,h().tz)(),{store:o,onSubmit:z,onChange:H,clientStore:V,threadStore:K,showInitialModePicker:N,aiChatFeatureController:G,config:q,loadAttachmentData:W}=e,$=(0,n().v3)(),[Q,Y]=r.useState(!1),[Z,J]=r.useState(!1);(0,M().i)({textStore:o,initialFocus:G.shouldHaveInitialFocusOnInput}),(0,r.useEffect)((()=>{K&&requestAnimationFrame((()=>{const e=k().n.findNodeFromStore(o);e&&e.focus()}))}),[K,o]),(0,C().A)({shouldPreserveBlockSelection:!0,shouldPreserveTextSelection:!0,shouldRestoreSelection:!0});const X=(0,i().K8)((()=>0===(0,u().AhH)(o.getValue()||[])),[o]),ee=(0,i().K8)((()=>o.getValue()),[o]),te=(0,i().K8)((()=>Boolean(void 0!==(null==K?void 0:K.getCurrentInferenceId())||(null==K?void 0:K.id)&&V.getOrCreateClientAIChatThreadStore(K.id).state.loading)),[K,V]),oe=(0,T().zS)({clientStore:V}),re=(0,r.useCallback)((async()=>{const{dictationActions:e}=await w().$O.load(),t=(0,u().q4_)(o.getValue()||[]);await e.StreamingDictationManager.start({environment:$,onTranscription:e=>{const r=t?`${t}\n${e}`:e;f().createAndCommit({userAction:"AIChatInput.handleDictation",environment:$,canUndo:!0,perform:e=>{m().R9({environment:$,store:o,value:(0,u().x9d)(r),transaction:e})}})}}),Y(!0)}),[$,o]),ne=(0,r.useCallback)((async()=>{const{dictationActions:e}=await w().$O.load();await e.StreamingDictationManager.stop(),Y(!1)}),[]);(0,r.useEffect)((()=>()=>{ne()}),[ne]);const ie=(0,i().O$)(I().AppStoreCurrentSpaceStore),ae=(0,i().K8)((()=>{var e;return null===(e=I().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),se=(0,i().K8)((()=>(0,D().ak)({spaceStore:ie})),[ie]),le=N&&G.supportsModePicker,de=(0,P().i7)(),ce=(0,A().X)("agent_model_picker"),ue=de&&q&&"workflow"===q.type&&ce,[pe,he]=(0,r.useState)({});(0,F().M)({textValue:ee,isEnabled:G.supportsAutoRouting,clientStore:V,configs:se});const me=(0,r.useCallback)((e=>{he((t=>t?{...t,searchScopes:e}:t))}),[]),Se=(0,r.useMemo)((()=>({...q,...pe})),[q,pe]),ve=(0,a().IS)((e=>({stagingAndInputWrap:{overflow:"inherit",flexGrow:1,flexShrink:1,borderRadius:12,outline:Z?`2px solid ${e.palette.uiBlue[500]}`:void 0},wrap:{display:"flex",fontSize:12,alignItems:"center",flexWrap:"wrap",boxShadow:`0px 0px 0px 0.5px ${e.stroke.primary}, 0px 4px 12px -2px rgba(0, 0, 0, 0.08)`,backgroundColor:"dark"===e.mode?e.surface.elevated:e.contentBackground,borderRadius:16,overflow:"inherit",position:"relative"},textContainer:{flexGrow:1,padding:12,minHeight:56,maxHeight:240,overflow:"auto",fontSize:G.chonkyStyles?16:14},placeholder:{opacity:1,cursor:"text",minHeight:56},rightGutter:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,marginLeft:"auto"},leftGutter:{display:"flex",alignItems:"center",gap:2,minWidth:0},sendButtonIcon:{width:30,height:30},sendButton:{width:30,height:30,borderRadius:30},microphoneIcon:{width:28},stopIcon:{width:30,height:30},inputActionsRow:{display:"flex",width:"100%",justifyContent:"space-between",overflow:"hidden",padding:"0px 8px 8px 12px",gap:12,flexShrink:0}})),[G,Z]),be=(0,i().K8)((()=>!K||K.canEdit()),[K]),we=(0,r.useCallback)((()=>{be&&!te&&(null==z||z({prompt:o.getValue(),config:Se}),requestAnimationFrame((()=>{const e=k().n.findNodeFromStore(o);e&&e.focus()})))}),[z,o,te,be,Se]),Ae=(0,r.useCallback)((()=>{null==H||H(o.getValue())}),[H,o]),Ce=(0,i().K8)((()=>V.state.configForNewTranscripts),[V]),ke=(0,i().K8)((()=>(0,O().iu)({config:{type:"workflow"},threadStore:K,intl:t})),[K,t]),Me=(0,r.useCallback)((()=>{te&&oe({userAction:"AgentChatTranscript.StopInference.keyboardInterrupt"})}),[oe,te]),_e=G.supportsTranscription,Ie=(0,i().K8)((()=>G.supportsWebSearch(Ce.type)),[Ce,G]),je=(0,i().K8)((()=>_().R.isWebSearchDown()),[]),Be=(0,i().K8)((()=>!(null==ie||!ie.id)&&_().R.isInferenceTranscriptConfigTypeDown({configType:Ce.type,spaceId:ie.id,actor:ae??s().S3})),[Ce.type,ie,ae]),Pe=(0,i().K8)((()=>G.shouldSupportAttachments(Ce.type)&&W),[G,Ce.type,W]);return(0,ge.jsx)("div",{style:ve.stagingAndInputWrap,tabIndex:0,onDrop:e=>{if(e.preventDefault(),J(!1),!Pe)return;const t=Array.from(e.dataTransfer.files);t.length>0&&null!=W&&W.onDropFiles&&W.onDropFiles(t)},onDragOver:e=>{e.preventDefault(),Pe&&J(!0)},onDragLeave:e=>{e.preventDefault(),J(!1)},children:(0,ge.jsx)(y().A,{onEsc:Me,debugName:"AgentChatInput",capture:!0,children:(0,ge.jsxs)("div",{style:ve.wrap,children:[G.shouldSupportAttachments(Ce.type)&&W&&(0,ge.jsx)(xe,{clientStore:V,loadAttachmentsData:W,children:(0,ge.jsx)(R().Yo,{clientStore:V,loadAttachmentsData:W})}),(0,ge.jsx)(fe,{clientStore:V,threadStore:K}),(0,ge.jsx)(b().A,{style:ve.textContainer,placeholder:ke,disabled:!1,store:o,placeholderStyle:ve.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!1,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableEnter:!1,onEnter:we,onEsc:Me,onChange:Ae,disableMobileActionBar:!0,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!0,disableSuggestEdit:!0,inPageFind:x().Os.none,usePopupForMentionOnMobile:!0,disableMentions:!G.shouldAllowMentions,disabledMentionTypes:B().md,onPasteFiles:null==W?void 0:W.onPasteFiles}),(0,ge.jsxs)("div",{style:ve.inputActionsRow,children:[le&&(0,ge.jsx)("div",{style:ve.leftGutter,children:(0,ge.jsx)(g()._,{clientStore:V,configs:se,threadStore:K})}),(0,ge.jsxs)("div",{style:ve.leftGutter,children:[(0,ge.jsx)(Ge,{threadStore:K}),G.shouldSupportAttachments(Ce.type)&&W&&(0,ge.jsx)(R().Wn,{loadAttachmentsData:W,clientStore:V}),(0,ge.jsx)(ye,{clientStore:V,threadStore:K}),Ie&&(0,ge.jsx)(L().l,{clientStore:V,threadStore:K,webSearchDown:je}),"workflow"===Se.type&&(0,ge.jsx)(j().A,{featureGateId:"workflows_multi_scope",whenEnabled:(0,ge.jsx)(U().q,{value:(0,p().n_)(Se)??[],onChange:me}),whenDisabled:null}),ue&&(0,ge.jsx)(g().rm,{clientStore:V})]}),(0,ge.jsxs)("div",{style:ve.rightGutter,children:[G.supportsSearchScopePopup(Ce.type)&&(0,ge.jsx)(E().d,{clientStore:V,threadStore:K,aiChatFeatureController:G}),Q?(0,ge.jsx)(S().A,{icon:c().m,style:ve.sendButton,onClick:ne,iconStyle:ve.stopIcon,ariaLabel:t.formatMessage({id:"aiInferenceTranscript.stopRecording",defaultMessage:"Stop recording"})},"stop-recording"):te?(0,ge.jsx)(S().A,{icon:c().m,style:ve.sendButton,onClick:()=>{oe({userAction:"AgentChatTranscript.StopInference.stopButtonClick"})},iconStyle:ve.stopIcon,ariaLabel:t.formatMessage({id:"aiInferenceTranscript.stopInference",defaultMessage:"Stop AI message"})},"stop-inference"):(0,ge.jsxs)(ge.Fragment,{children:[!Q&&_e&&(0,ge.jsx)(S().A,{icon:l().E,onClick:re,iconStyle:ve.microphoneIcon,ariaLabel:t.formatMessage({id:"aiInferenceTranscript.startRecording",defaultMessage:"Start recording"})},"start-recording"),(0,ge.jsx)(v().A,{disableTooltip:!Be,renderTooltip:e=>(0,ge.jsx)("div",{...e,children:(0,ge.jsx)(h().sA,{..._().$.cannotSubmitMessage})}),render:e=>(0,ge.jsx)(S().A,{icon:d().b,onClick:we,style:ve.sendButton,iconStyle:ve.sendButtonIcon,color:X||Be?"secondary":"primary",size:"lg",disabled:X||Be,ariaLabel:t.formatMessage({id:"aiInferenceTranscript.submitAiMessage",defaultMessage:"Submit AI message"}),...e},"send-message")})]})]})]})]})})})}},915619:(e,t,o)=>{o.d(t,{PF:()=>_,Wn:()=>k,Yo:()=>M});o(581454);var r=o(296540),n=()=>o(484714),i=()=>o(56366),a=()=>o(401497),s=()=>o(370657),l=()=>o(609616),d=()=>o(234459),c=()=>o(155792),u=()=>o(959013),p=()=>o(436572),h=()=>o(2220),g=()=>o(624652),m=()=>o(28070),f=()=>o(128555),S=()=>o(515692),y=()=>o(356983),v=()=>o(285790),b=()=>o(859428),w=()=>o(594794),x=()=>o(140862),A=()=>o(805126),C=o(474848);function k(e){const{loadAttachmentsData:t,style:o}=e,{isMobile:i}=(0,n().Y0)(),s=(0,u().tz)(),d=(0,r.useCallback)((async()=>{t&&await t.uploadFile()}),[t]),c=(0,x().A)(!0),p=s.formatMessage({id:"assistantRichTextInput.insertAttachment.button.tooltip",defaultMessage:"Attach file"}),h=(0,a().IS)((e=>({tooltipSecondaryText:{color:e.text.contrastSecondary}})),[]);return(0,C.jsx)(b().A,{renderTooltip:()=>(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{children:p}),(0,C.jsx)("div",{style:h.tooltipSecondaryText,children:(0,C.jsx)(u().sA,{id:"assistantRichTextInput.insertAttachment.tooltip.supportedFormats",defaultMessage:"Most images and PDFs"})})]}),render:e=>(0,C.jsx)(v().A,{ariaLabel:p,icon:l().o,iconStyle:{width:i?19:20,height:i?19:20},style:{marginLeft:0,marginRight:0,width:(0,S().h6)(i),height:(0,S().h6)(i),...o},onClick:d,...e,...c})})}function M(e){const{loadAttachmentsData:{threadStore:t},clientStore:o}=e,n=(0,a().IS)((e=>({filePreviewWrapper:{width:"100%",paddingTop:4,paddingBottom:4,marginLeft:4}})),[]),s=(0,i().K8)((()=>o.getOrCreateClientAIChatThreadStore(t.id)),[o,t.id]),l=(0,i().K8)((()=>s.getStagedAttachmentUploadStoreIfExists()),[s]),d=(0,m().Jp)(l),c=(0,r.useCallback)((e=>{l&&(l.onDeleteFileUpload(e),s.unstageAttachmentInferenceTranscriptStep({fileId:e}))}),[l,s]);return d&&0!==d.length?(0,C.jsx)("div",{style:n.filePreviewWrapper,children:d.map((e=>{const{fileName:o}=e;return(0,C.jsx)(m().kp,{uploadProgress:e,permissionRecordOverride:t.pointer,onDeleteFile:"complete"===e.status?()=>c(e.fileUrl):void 0},o)}))}):null}function _(e){const{clientAiChatStore:t,threadStore:o,spaceStore:a,config:l,aiChatFeatureController:m}=e,S=(0,n().v3)(),v=(0,i().K8)((()=>{if(o&&t)return t.getOrCreateClientAIChatThreadStore(o.id)}),[t,o]),b=(0,i().K8)((()=>null==v?void 0:v.getTemporaryAttachmentStagedDataOrInstantiate().stagedAttachmentUploadStore),[v]),x=(0,r.useCallback)((e=>{if(!v||!a)return;const t=v.getTemporaryAttachmentStagedDataOrInstantiate(),o=(0,w().Z1)({environment:S,table:c().mS,spaceId:a.id}),r=(0,s().jx)({uploadedFileData:e,id:o});v.stageAttachmentInferenceTranscriptStep({step:r}),t.stagedAttachmentUploadStore.onFileUploadCompleted(e.uploadIdentifier,e),(0,h().u)({environment:S,event:{eventName:"assistant_attachment_upload_successful",eventProperties:{content_type:r.contentType,source:"custom_upload",framework:"inference_transcript"}}})}),[v,S,a]),C=(0,i().K8)((()=>m.analyticsSource(o)),[m,o]),k=(0,i().K8)((()=>(0,A().zj)({threadStore:o,clientStore:t})),[t,o]),M=(0,g().X)({currentSpaceId:null==a?void 0:a.id,progressOverrides:{threadPointer:o&&a?{spaceId:a.id,table:d().To,id:null==o?void 0:o.id}:void 0,onSuccess:x,progressStore:b},analyticsArgs:{configType:k.type,source:C}}),_=(0,y().z)({threadClientStore:v,config:l,clientChatStore:t,aiChatFeatureController:m}),I=(0,u().tz)(),j=(0,r.useCallback)((e=>{0!==e.files.length&&(_.canUpload?M({file:e.files[0],method:"paste"}):p().D6({label:I.formatMessage(f().E[_.reason])}))}),[_,I,M]),B=(0,r.useCallback)((async e=>{0!==e.length&&(_.canUpload?(await M({file:e[0],method:"paste"}),e.length>1&&p().D6({label:I.formatMessage({id:"aiInferenceTranscript.multipleFilesNotSupported",defaultMessage:"Only one attachment is supported at this time."})})):p().D6({label:I.formatMessage(f().E[_.reason])}))}),[_,I,M]);return{uploadAttachment:M,onPasteFiles:j,onDropFiles:B}}},948621:(e,t,o)=>{o.d(t,{i:()=>r});const r=(0,o(340498).xh)("gear",{default:{loader:()=>o.e(34616).then(o.bind(o,212727))},small:{loader:()=>o.e(34616).then(o.bind(o,274065))},fill:{loader:()=>o.e(34616).then(o.bind(o,682563))},fillSmall:{loader:()=>o.e(34616).then(o.bind(o,830586))}},["gear","settings","cog","options","tools"])}}]);