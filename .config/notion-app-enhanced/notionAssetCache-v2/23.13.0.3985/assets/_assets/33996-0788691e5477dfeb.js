"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[33996],{161165:(e,t,i)=>{i.d(t,{Bq:()=>m,P8:()=>p,tA:()=>g,v1:()=>f});i(296540);var s=()=>i(902006),n=()=>i(676370),r=()=>i(762433),a=()=>i(97065),o=()=>i(166386),l=()=>i(959013),d=()=>i(534177),u=i(474848);const c={ai:{title:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.v2.ai.title.v2",defaultMessage:"Get Notion AI"}),subtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.ai.description",defaultMessage:"Search, generate, analyze, and chatâ€”right inside Notion"}),fiftyPercentSubtitle:(0,u.jsx)(l().sA,{id:"addOnUpgrade.studentAiOffer.confirmation.description",defaultMessage:"Your personal teaching assistant, code reviewer, brainstorming partner, and more â€” right in your workspace"})},plus:{title:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.title.plusPlan",defaultMessage:"Upgrade to the Plus plan"}),plusAiTitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.title.plusPlanPlusAi",defaultMessage:"Upgrade to Plus + AI"}),subtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.oneLiner.v2.plusSubtitle",defaultMessage:"Do more with unlimited charts, files, automations & integrations"}),resurrectionOfferSubtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.oneLiner.v2.plusResurrectionOfferSubtitle",defaultMessage:"Unlimited content, charts and more. Upgrade to Plus to get 50% off for 3 months."}),lic50Subtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.oneLiner.lic50.offerSubtitle",defaultMessage:"Unlimited content, charts and more. Upgrade to Plus to get 50% off for 12 months."}),lic25Subtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.oneLiner.plus.lic25.offerSubtitle",defaultMessage:"Unlimited content, charts and more. Upgrade to Plus to get 25% off for 12 months."})},business:{title:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlan",defaultMessage:"Upgrade to the Business plan"}),aiCoreTitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanAiCoreTitle",defaultMessage:"Get Notion AI and more"}),aiConnectorsTitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanAiConnectorsTitle",defaultMessage:"Get AI Connectors and more"}),researchModeTitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanResearchModeTitle",defaultMessage:"Get Research Mode and more"}),meetingNotesTitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanMeetingNotesTitle",defaultMessage:"Get AI Meeting Notes and more"}),aiForNotionMailTitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanAiForNotionMailTitle",defaultMessage:"Get AI for Notion Mail and more"}),plusAiTitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanPlusAi",defaultMessage:"Upgrade to Business + AI"}),subtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.oneLiner.v2.business",defaultMessage:"Find answers across tools, build team workflows, and automate with AI"}),lic50Subtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.oneLiner.lic50.biz.offerSubtitle",defaultMessage:"Unlimited content, charts and more. Upgrade to Business to get 50% off for 12 months."}),lic25Subtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.oneLiner.plus.lic25.biz.offerSubtitle",defaultMessage:"Unlimited content, charts and more. Upgrade to Business to get 25% off for 12 months."}),aiCoreSubtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanAiCoreSubtitle",defaultMessage:"Upgrade to the Business plan to access the full suite of Notion AI features"}),aiConnectorsSubtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanAiConnectorsSubtitle",defaultMessage:"Upgrade to the Business plan to access the full suite of Notion AI features"}),researchModeSubtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanResearchModeSubtitle",defaultMessage:"Upgrade to the Business plan to access the full suite of Notion AI features"}),meetingNotesSubtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanMeetingNotesSubtitle",defaultMessage:"Upgrade to the Business plan to access the full suite of Notion AI features"}),aiForNotionMailSubtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.upgradeToBusinessDialog.businessPlanAiForNotionMailSubtitle",defaultMessage:"Upgrade to the Business plan to access the full suite of Notion AI features"})},enterprise:{title:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.title.enterprise",defaultMessage:"Upgrade to the Enterprise plan"}),plusAiTitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.title.enterprisePlusAi",defaultMessage:"Upgrade to Enterprise + AI"}),subtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.oneLiner.v2.enterprise",defaultMessage:"Advanced controls & support to run your entire organization"})},enterpriseLimited:{title:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.title.enterpriseLimited",defaultMessage:"Upgrade to the Enterprise Limited plan"}),plusAiTitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.title.enterpriseLimitedPlusAi",defaultMessage:"Upgrade to Enterprise Limited + AI"}),subtitle:(0,u.jsx)(l().sA,{id:"subscriptionUpgradeModal.oneLiner.v2.enterpriseLimited",defaultMessage:"Advanced controls & support to run your entire organization"})}};function p(e){const{product:t,coupon:i,isOnTrialWithAiProduct:r,from:a,may13PackagingChangesEnabled:l}=e;switch(t){case"ai":const e=c.ai.title;return"ai_fifty_percent"===i?{title:e,subtitle:c.ai.fiftyPercentSubtitle}:{title:e,subtitle:c.ai.subtitle};case"sites_custom_hostnames":default:return{};case"plus":const t=r?c.plus.plusAiTitle:c.plus.title;return(0,o().u6)(i)?{title:t,subtitle:c.plus.resurrectionOfferSubtitle}:"lic_50"===i?{title:t,subtitle:c.plus.lic50Subtitle}:"lic_25"===i?{title:t,subtitle:c.plus.lic25Subtitle}:{title:t,subtitle:c.plus.subtitle};case"business":if(a&&l){if((0,d().Xk)(n().zj,a))return{title:c.business.aiCoreTitle,subtitle:c.business.aiCoreSubtitle,featureWithCustomImage:"coreAI"};if((0,d().Xk)(s().My,a))return{title:c.business.aiConnectorsTitle,subtitle:c.business.aiConnectorsSubtitle,featureWithCustomImage:"aiConnectors"};if((0,d().Xk)(n().uv,a))return{title:c.business.researchModeTitle,subtitle:c.business.researchModeSubtitle,featureWithCustomImage:"researchMode"};if((0,d().Xk)(n().CT,a))return{title:c.business.meetingNotesTitle,subtitle:c.business.meetingNotesSubtitle,featureWithCustomImage:"meetingNotes"};if(["mail_app"].includes(a))return{title:c.business.aiForNotionMailTitle,subtitle:c.business.aiForNotionMailSubtitle,featureWithCustomImage:"notionAIForMail"}}const u=r?c.business.plusAiTitle:c.business.title;return"lic_50"===i?{title:u,subtitle:c.business.lic50Subtitle}:"lic_25"===i?{title:u,subtitle:c.business.lic25Subtitle}:{title:u,subtitle:c.business.subtitle};case"enterprise":return{title:r?c.enterprise.plusAiTitle:c.enterprise.title,subtitle:c.enterprise.subtitle};case"enterprise_limited":return{title:r?c.enterpriseLimited.plusAiTitle:c.enterpriseLimited.title,subtitle:c.enterpriseLimited.subtitle}}}function m(e,t){const{subtotal:i,discount:s,balance:n}=e;return i.minus(s).minus(n).plus(t).zeroIfNegative()}function g(e,t){if(!e)return!1;const i=(0,r().q8)(e);return Boolean(t)&&"year"===i}function f(e,t,i){return(0,r().TB)(e)&&t&&(0,a().DH)(t.offer.campaign)&&i===(0,o().i)(t)}},275764:(e,t,i)=>{i.d(t,{G5:()=>c,Ux:()=>g,g3:()=>p,jn:()=>u,o2:()=>m});i(898992),i(581454),i(908872);var s=()=>i(484714),n=()=>i(187174),r=()=>i(762433),a=()=>i(643819),o=()=>i(786508),l=()=>i(166386),d=()=>i(449506);function u(e){const{items:t,promo:i}=e;return t.map((e=>e.price.getDiscountPerBillingInterval({quantity:e.quantity,promo:i}))).reduce(((e,t)=>e.plus(t)))}function c(e){const{items:t,coupon:i}=e,s=i?(0,l().Pz)((0,o().Pq)(i)):void 0;return t.map((e=>e.price.getCostPerBillingInterval({quantity:e.quantity,offer:s}))).reduce(((e,t)=>e.plus(t)))}function p(e){const{taxAmount:t,calculatingTax:i,currencyCode:s}=e,n=t&&!i?t:0;return new(a().W)(s,n)}function m(e,t){const i=Math.min(0,(0,r().o2)(e,t).amount);return new(a().W)(t,-i)}function g(e){const t=(0,s().v3)(),[i]=(0,n().Yb)((async()=>{if(!e)return;const i=await d().callApi({eventName:"getPromoCode",environment:t,data:{code:e.code}});return"failed"!==i.type?i.data.promo:void 0}),[t,e]);return"resolved"===i.status?i.value:void 0}},369773:(e,t,i)=>{i.d(t,{P:()=>g});var s=i(296540),n=()=>i(484714),r=()=>i(401497),a=()=>i(959013),o=()=>i(2220),l=()=>i(84817),d=()=>i(554509),u=()=>i(73332),c=()=>i(836251),p=()=>i(208993),m=i(474848);function g(e){let{message:t,isChecked:i,onChange:g,error:f,isFirstTerm:b,hideTooltip:h,paddingTop:v,checkboxId:y}=e;const A=(0,a().tz)(),x=function(e){return(0,r().IS)((t=>({termsContainer:{display:"flex",flexDirection:"column",gap:8,paddingTop:16,borderTop:e?`1px solid ${t.stroke.primary}`:void 0}})),[e])}(b??!1),S=(0,n().v3)(),M=s.useRef(null);return s.useEffect((()=>{f&&M.current&&M.current.scrollIntoView({behavior:"smooth",block:"center"})}),[f]),(0,m.jsx)("div",{ref:M,style:{...x.termsContainer,paddingTop:v??x.termsContainer.paddingTop},children:(0,m.jsxs)(l().Y1,{direction:"horizontal",align:"top-left",gap:8,children:[(0,m.jsx)(u().T,{size:14,checked:i,onClick:()=>{(0,o().u)({environment:S,event:{eventName:"click_subscription_terms_checkbox",eventProperties:{checked:!i}}}),g(!i)},id:y,style:{margin:1},"aria-required":!0}),(0,m.jsxs)(l().Y1,{direction:"vertical",gap:8,children:[(0,m.jsxs)(d().D,{styleName:"UISmall-12px/Regular",colorName:"primary",as:"label",htmlFor:y,children:[t,(0,m.jsx)("div",{style:{display:"inline-block",position:"absolute",paddingLeft:1},children:h?null:(0,m.jsx)(p().W,{tooltipTitle:A.formatMessage({id:"onboardingTimedTrials.termsOfService.tooltip",defaultMessage:"Read full terms and conditions"}),buttonProps:{href:(0,c().xS)("terms"),external:!0}})})]}),f?(0,m.jsx)(d().D,{styleName:"UISmall-12px/Regular",colorName:"uiRedPrimary",children:f}):null]})]})})}},533996:(e,t,i)=>{i.r(t),i.d(t,{CheckoutUpgradeModal:()=>Se});var s=()=>i(624119),n=i(296540),r=()=>i(484714),a=()=>i(56366),o=()=>i(762433),l=()=>i(107683),d=()=>i(38337),u=()=>i(240865),c=()=>i(506090),p=()=>i(224701),m=()=>i(112527),g=()=>i(134217),f=()=>i(981046),b=(i(16280),i(944114),i(898992),i(354520),i(581454),i(737550),()=>i(852507)),h=()=>i(401497),v=()=>i(857639);const y=(0,i(340498).xh)("infoBubble",{default:{loader:()=>i.e(89306).then(i.bind(i,889306))},small:{loader:()=>i.e(87344).then(i.bind(i,487344))},mini:{loader:()=>i.e(72612).then(i.bind(i,272612))},large:{loader:()=>i.e(78596).then(i.bind(i,778596))}});var A=()=>i(984380),x=()=>i(622963),S=()=>i(979340),M=()=>i(959013),C=()=>i(496603),I=()=>i(534177),j=()=>i(252105),w=()=>i(209660),T=()=>i(84817),U=()=>i(187485),_=()=>i(460292),P=()=>i(554509),k=()=>i(21140),N=()=>i(836251),D=()=>i(640653),E=()=>i(876853),B=()=>i(6208),L=()=>i(765957),F=()=>i(227440),O=()=>i(404141),R=()=>i(606456),q=()=>i(19575),z=()=>i(779795),K=()=>i(601203),Y=()=>i(889173),W=()=>i(637833),G=()=>i(704073),V=()=>i(807778),H=()=>i(275764),Q=()=>i(814927),X=()=>i(10984),J=()=>i(960236),Z=()=>i(906195),$=()=>i(775916),ee=()=>i(816953),te=()=>i(803025),ie=()=>i(651390),se=()=>i(931783),ne=()=>i(662866),re=()=>i(960389),ae=()=>i(81465),oe=()=>i(369773),le=()=>i(161165),de=()=>i(581495),ue=()=>i(270511),ce=i(474848);const pe=493;function me(e){let{header:t,paymentContent:i,orderOptions:s,footer:n,showDismissButton:o}=e;const l=(0,r().v3)(),{isMobile:d}=(0,r().Y0)(),u=(0,a().K8)((()=>(0,ue().A)(l)),[l])||!s,c=function(e){return(0,h().IS)((()=>({wrapper:{...!e&&{minWidth:506,minHeight:600}},mobile:{display:"grid",gridTemplateRows:"1fr auto",overflow:"hidden auto"}})),[e])}(d),p=(0,V().aD)(),m=(0,ce.jsxs)(T().Y1,{direction:u?"vertical":"horizontal",gap:u?20:32,style:{...d&&c.mobile},children:[(0,ce.jsx)(T().Y1,{direction:"vertical",gap:u?20:28,width:u?"fill":420,height:p?d?void 0:pe:void 0,children:i}),(0,ce.jsxs)(T().Y1,{direction:"vertical",gap:u?20:28,width:u?"fill":312,children:[s,n]})]});return(0,ce.jsxs)(T().Y1,{direction:"vertical",gap:u?28:36,padding:"24px 32px 32px 32px",width:"hug",height:"hug",style:c.wrapper,children:[t,m,o&&(0,ce.jsx)(de().Rz,{})]})}var ge=()=>i(323063),fe=()=>i(643819),be=()=>i(166386),he=()=>i(802790),ve=()=>i(331542),ye=()=>i(86089);function Ae(e){var t;const{state:i,promo:s,billingData:r,dueAtPeriodEnd:l,billingInterval:d,products:c}=e,{coupon:p,calculatingTax:m,taxAmount:g}=i,[b,h]=n.useState(!1),v=H().Ux(s),y=(0,a().K8)((()=>f().A.state.selectedCurrencyCode??"USD"),[]),A=(0,ye().o)(),x=(0,u().V)()??1;if(0===A.length)return(0,ce.jsx)(ve().A,{});const S=c.map((e=>(0,ge().vk)(A,{product:e,interval:d,currency:y}))),M={numSeats:x,numCustomHostnames:(null===(t=(0,o().KH)(r,"sites_custom_hostnames"))||void 0===t?void 0:t.quantity)??0},C=S.map((e=>(0,ge().ng)(e,M))),I=c.some((e=>(0,be().Jf)(p,e,d))),j=H().G5({items:C,coupon:I?p:void 0});let w;if(0!==A.length&&"year"===d){const e=I?"year":"month",t=c.map((t=>(0,ge().vk)(A,{product:t,interval:e,currency:y}))).map((e=>(0,ge().ng)(e,M)));w=H().G5({items:t}).withMultipliedAmount(I?1:12)}else if(0!==A.length&&"month"===d){const e="month",t=c.map((t=>(0,ge().vk)(A,{product:t,interval:e,currency:y}))).map((e=>(0,ge().ng)(e,M)));w=H().G5({items:t})}const U=w?w.minus(j):void 0,_=H().g3({calculatingTax:m,taxAmount:g,currencyCode:y}),P=H().jn({items:C,promo:v}),k=r?H().o2(r,y):new(fe().W)(y,0),N=j.plus(_).minus(P).minus(k),D=N.amount<0?N.withMultipliedAmount(0):N,E=function(e){var t;let{hasDiscount:i,dueAtPeriodEnd:s,billingData:n,billingInterval:r}=e;if(i)return{chargeType:"immediate"};if(s&&null!=n&&null!==(t=n.subscription)&&void 0!==t&&t.currentPeriodEnd)return{chargeType:"nextPeriod",periodEnd:n.subscription.currentPeriodEnd};return{chargeType:void 0,billingInterval:r}}({hasDiscount:0!==P.amount&&0!==k.amount,dueAtPeriodEnd:l,billingData:r,billingInterval:d});return(0,ce.jsxs)(T().Y1,{gap:20,children:[(0,ce.jsx)(re().BB,{total:D,originalSubtotal:w,tax:_,handleToggleExpanded:()=>h((e=>!e)),isExpanded:b,discount:P,accountBalance:k,annualPriceDifference:U,coupon:I?p:void 0,isTotalLoading:m,...E}),(0,ce.jsx)(re()._z,{isExpanded:b,children:(0,ce.jsxs)(T().Y1,{gap:12,children:[(0,ce.jsx)(re().f5,{items:C,coupon:I?p:void 0}),(0,ce.jsx)(he().A,{size:1}),(0,ce.jsx)(re().Qs,{subtotal:j,tax:_,discount:P,accountBalance:k,showDiscountLine:0!==P.amount&&v&&!p,isCalculatingTax:m}),(0,ce.jsx)(he().A,{size:1})]})})]})}function xe(e){const{state:t,data:i,spaceStore:l,spaceViewStore:d}=e,p=(0,r().v3)(),m=(0,M().tz)(),de=(0,s().useStripe)(),ue=(0,s().useElements)(),{isMobile:pe,isPhone:ge}=(0,r().Y0)(),fe=(0,J().lh)({spaceId:l.id}),be=(0,te().q)(),he=(0,a().K8)((()=>L().default.state.currentUserRootStore),[]),ve=(0,$().p)(),ye=(0,u().V)()??1,xe=(0,h().IS)((e=>({footer:{borderWidth:1,borderColor:e.stroke.primary,borderStyle:"solid",borderRadius:8,padding:16}})),[]),Se=(0,a().K8)((()=>{if(c().A.state.open)return c().A.state.dismissMobilePlansModal}),[]),Me=(0,a().O$)(F().e),{availableCurrencyCodes:Ce,currencyCode:Ie}=(0,a().K8)((()=>({availableCurrencyCodes:f().A.availableCurrencyCodes,currencyCode:f().A.selectedCurrencyCode??"USD"})),[]),je=(0,ee().A)(),we=(0,B().L)(),Te=(0,J().UL)(),Ue=(0,Z().D)(),_e=(0,a().K8)((()=>t.addOnFeature??(0,x()._y)(t.subscriptionTier)),[t.addOnFeature,t.subscriptionTier]),Pe=(0,a().K8)((()=>(0,V().Q3)()),[]),ke=(0,le().v1)(fe,ve,_e);(0,b().w)((()=>{const e=g().qc(i);c().A.update((t=>{var s;return{...t,appliedPromo:e?null===(s=i.customerData)||void 0===s?void 0:s.stripe.promo:void 0}})),e&&void 0!==(null==fe?void 0:fe.address)&&c().A.setAddressField(null==fe?void 0:fe.address)}));const Ne=ke&&(0,o().eh)(fe,"ai"),De=(0,a().K8)((()=>(0,V().Le)()),[]),Ee=(0,X().YS)({product:_e,currentSubscriptionTier:(0,o().AI)(fe),salesStatus:be,packagingChangesEnabled:De}),Be=(0,H().Ux)(t.appliedPromo),Le=(0,a().K8)((()=>{const e=[_e];return!((0,o().ji)(fe)??[]).includes("ai")&&!ke&&!De&&e.push("ai"),e}),[_e,fe,ke,De]),[{billingInterval:Fe,addOnFeature:Oe,vatId:Re,termsAccepted:qe,customerAddress:ze},Ke]=n.useState({billingInterval:"ai"===_e?"year":"month",vatId:je?"":void 0,termsAccepted:void 0,customerAddress:{name:we??"",businessName:"",addressLine1:"",addressLine2:"",city:"",state:"",zipCode:"",country:""}}),[Ye,We]=n.useState({}),[Ge,Ve]=n.useState(),[He,Qe]=n.useState(!1),Xe=(0,V().aD)(),Je=n.useCallback((e=>{Ve(void 0),e.customerAddress&&We((e=>({...e,customerAddress:void 0}))),void 0!==e.termsAccepted&&We((e=>({...e,termsAccepted:void 0}))),Ke((t=>({...t,...e})))}),[]),Ze=n.useMemo((()=>(0,C().sb)((0,C().oE)([_e,Oe,...Ne?["ai"]:[]]))),[_e,Oe,Ne]),[$e,et]=n.useState(!1);n.useEffect((()=>{Te&&!t.coupon&&c().A.update((e=>({...e,coupon:"ai_fifty_percent"})))}),[t.coupon,Te,p]),n.useEffect((()=>{Ue&&("month"===Fe&&"plus"===_e&&(c().A.update((e=>({...e,coupon:"resurrection_offer"}))),$e||et(!0)),"year"===Fe&&"plus"===_e&&c().A.update((e=>({...e,coupon:void 0}))))}),[t.coupon,Ue,Fe,_e,p,$e]);const tt=(0,a().K8)((()=>Ze.map((e=>(0,Q().g)(e,Fe,p))).filter(I().O9)),[Ze,Fe,p]),it=n.useMemo((()=>tt.map((e=>(0,K().sM)({price:e,quantity:ye,promo:Be}))).filter(I().O9)),[tt,ye,Be]);n.useEffect((()=>{K().Qe({environment:p,billingInterval:Fe,vatId:Re,billingData:fe,lineItems:it,memberCount:ye,addOn:Oe,onlyShowAddOn:"ai"===_e,promo:Xe?Be:void 0,address:ze,isCheckoutAddressFormExperimentEnabled:Xe})}),[p,Fe,Oe,Re,fe,_e,ye,Ze,it,Be,ze,Xe]);const st={month:(0,ie().H)({billingInterval:"month",priceStore:f().A,products:Le}),year:(0,ie().H)({billingInterval:"year",priceStore:f().A,products:Le})},nt=(0,se()._)({asyncPrice:st[Fe??"month"].ai}),rt=(0,le().tA)(fe,Te),at=(0,se()._)({asyncPrice:st.month[_e]}),ot=(0,se()._)({asyncPrice:st.year[_e]}),lt=n.useCallback((()=>{const e={};if(!(0,E().r)(ze.name)){const t=m.formatMessage({id:"spaceSubscriptionUpgradeModal.name.required.error",defaultMessage:"Please enter a valid name."});e.customerAddress=t}return Pe&&!qe&&(e.termsAccepted=m.formatMessage({id:"spaceSubscriptionUpgradeModal.terms.required.error",defaultMessage:"Please agree to the terms & conditions"})),We((t=>({...t,...e}))),e}),[ze.name,Pe,qe,m]),dt=n.useCallback((async e=>{Ve(void 0);const i=lt();if(!(0,C().Im)(i))return;if(j().Fp(p,{modal_id:t.sessionId,from:t.from}),Qe(!0),!ue||!de)return(0,v().log)({level:"error",from:"SpaceSubscriptionUpgradeModal",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}}),Ve(m.formatMessage({id:"spaceSubscriptionUpgradeModal.payment.genericError",defaultMessage:"Your payment could not be processed. Please try again."})),void Qe(!1);const s=await(0,D().Pu)({environment:p,spaceId:l.id})??1,n=await async function(e){const{billingEmail:t,coupon:i,currencyCode:s,environment:n,elements:r,billingInterval:a,customerAddress:o,name:l,businessName:d,vatId:u,intl:c,modalId:p,promo:m,quantity:g,selectedProducts:f,stripe:b,useTestClock:h,from:v,postUpgradeCallback:y,isCheckoutAddressFormExperimentEnabled:A}=e,x=await R().mR({modalId:p,environment:n,intl:c,elements:r,stripe:b,isCheckoutAddressFormExperimentEnabled:A});if("error"in x)return{error:x.error};try{await R().ge({address:A?o:{name:l??"",businessName:d??"",addressLine1:"",addressLine2:"",zipCode:x.address.zipCode??"",city:"",state:"",country:x.address.country??""},billingEmail:t,billingInterval:a,coupon:i,currencyCode:s,environment:n,modalId:p,paymentData:x.paymentData,promo:m,quantity:g,selectedProducts:f,stripe:b,vatId:u,useTestClock:h,intl:c,from:v,postUpgradeCallback:y})}catch(S){return{error:S instanceof Error?S.message:"Unknown error"}}}({billingEmail:g().Nl(t,fe),coupon:t.coupon,currencyCode:Ie,environment:p,elements:ue,intl:m,billingInterval:Fe,name:ze.name,businessName:ze.businessName,customerAddress:ze,vatId:Xe||je?Re:void 0,modalId:t.sessionId,promo:t.appliedPromo,quantity:s,selectedProducts:Ze,stripe:de,useTestClock:e.useTestClock,from:t.from,postUpgradeCallback:t.postUpgradeCallback,isCheckoutAddressFormExperimentEnabled:Xe});return null!=n&&n.error?(Ve(n.error),void Qe(!1)):(R().Oo({environment:p,modalId:t.sessionId}),"ai"===_e?(O().A.reset(),R().Tq({environment:p,spaceStore:l,spaceViewStore:d,intl:m,currentUserRootStore:he}),void(pe&&(null==Se||Se()))):void(ge?null==Se||Se():w().Ow({currentTab:"billing"})))}),[fe,Fe,Ie,he,ze,ue,p,m,Xe,pe,ge,Se,_e,Ze,l,d,t,de,lt,je,Re]),ut=(0,a().K8)((()=>(0,V().Ir)()&&!1),[]),ct=[{buttonType:"primary",isDisabled:He,isLoading:He,label:A().Kq.some((e=>e===_e))?(0,ce.jsx)(M().sA,{id:"subscriptionUpgradeModal.upgradeButton.upgradeToPlan",defaultMessage:"Upgrade to {plan}",values:{plan:(0,S().u2)({product:Ee,intl:m})}}):(0,ce.jsx)(M().sA,{id:"subscriptionUpgradeModal.upgradeButton.upgradeAi",defaultMessage:"Upgrade now"}),onClick:()=>dt({useTestClock:!1})}];ut&&ct.push({buttonType:"primary",isDisabled:He,label:"ðŸš§ Upgrade with Test Clock ðŸš§",onClick:()=>dt({useTestClock:!0})});const pt=["business","enterprise"].includes(_e)?[{buttonType:"plain",label:(0,ce.jsxs)(T().Y1,{direction:"horizontal",gap:6,align:"center",children:[(0,ce.jsx)(_().Q,{iconGroup:y,variantName:"default",colorName:"primary"}),(0,ce.jsx)(M().sA,{id:"spaceSubscriptionSettings.upgradeModal.contactSales",defaultMessage:"Contact sales"})]}),onClick:()=>(0,q().lK)({initialQuestion:"enterprise"===_e?"interest_in_enterprise":"interest_in_business",openedFrom:"enterprise"===_e?"enterprise_checkout_modal":"business_checkout_modal"})}]:void 0;if(!Me)return(0,ce.jsx)(ne()._,{});const mt=(0,le().P8)({product:Ee,coupon:t.coupon,isOnTrialWithAiProduct:Ne,from:t.from,may13PackagingChangesEnabled:De});ke&&(mt.subtitle=(0,ce.jsx)(P().D,{styleName:"UIRegular-14px/Regular",colorName:"secondary",customStyles:{maxWidth:525},children:(0,ce.jsx)(M().sA,{id:"subscriptionUpgradeModal.upgradeDuringTrial",defaultMessage:"Access to our most loved team features. If you choose not to upgrade, you will be on a free plan with restricted usage."})}));const gt=(0,Y().f)({headerContent:mt,primaryProduct:_e});return(0,ce.jsx)(me,{showDismissButton:!0,header:(0,ce.jsx)(re().K4,{...mt,image:gt}),paymentContent:(0,ce.jsx)(G().P,{style:{padding:4,height:"100%"},disabled:!Xe,children:(0,ce.jsx)(ae().z,{customerAddress:ze,vatId:Re,sessionId:t.sessionId,onChange:Je,validationErrors:Ye,gap:14})}),orderOptions:rt?null:(0,ce.jsxs)(T().Y1,{gap:20,children:[(0,ce.jsx)(re().TJ,{selectedBillingInterval:Fe,monthlyUnitPrice:at,yearlyUnitPrice:ot,onChange:e=>{j().bT(p,{billingInterval:e,modal_id:t.sessionId}),Je({billingInterval:e})},product:_e,coupon:t.coupon}),Le.includes("ai")&&"ai"!==_e?(0,ce.jsx)(re().nB,{selectedAddOn:Oe,unitPrice:nt,onChange:e=>{j().Gs(p,{addOnFeatures:e?[e]:void 0,modal_id:t.sessionId}),Je({addOnFeature:e})},coupon:t.coupon,billingInterval:Fe}):null,(0,ce.jsx)("div",{style:{position:"absolute",top:-8,right:0},children:(0,ce.jsx)(W().y,{availableCurrencyCodes:Ce,selectedCurrencyCode:Ie,onSelectCurrency:z().cP,from:"upgrade_modal"})})]}),footer:(0,ce.jsxs)(k().wt,{gap:8,children:[(0,ce.jsx)(P().D,{styleName:"UISmall-12px/Medium",colorName:"tertiary",children:(0,ce.jsx)(M().sA,{defaultMessage:"Confirm upgrade",id:"checkout.confirmUpgrade"})}),(0,ce.jsxs)(T().Y1,{gap:16,style:xe.footer,children:[(0,ce.jsx)(Ae,{state:t,billingInterval:Fe,products:Ze,promo:Be,billingData:fe,dueAtPeriodEnd:ke}),Pe?(0,ce.jsx)(oe().P,{paddingTop:0,hideTooltip:!0,isChecked:Boolean(qe),onChange:e=>{Je({termsAccepted:e})},error:Ye.termsAccepted,message:(0,ce.jsx)(P().D,{styleName:"UIMini-10px/Regular",colorName:"secondary",children:(0,ce.jsx)(M().sA,{defaultMessage:"Your Notion subscription will auto-renew each month at the above price per seat + taxes unless canceled. Cancel via the Billing tab prior to renewal to avoid future charges ({terms})",id:"checkout.termsOfService",values:{terms:(0,ce.jsx)(U().A,{href:(0,N().xS)("terms"),external:!0,style:{display:"inline",textDecoration:"underline"},children:(0,ce.jsx)(M().sA,{defaultMessage:"terms",id:"checkout.terms"})})}})}),checkboxId:"terms-checkbox-upgrade-modal"}):null,(0,ce.jsx)(re().iu,{primaryButtons:ct,secondaryButtons:pt}),Ge?(0,ce.jsx)(P().D,{styleName:"Caption-12px/Regular",colorName:"uiRedPrimary",children:Ge}):null]})]})})}function Se(e){let{data:t,billingData:i,spaceStore:s,spaceViewStore:o}=e;const u=(0,r().v3)();(0,n.useEffect)((()=>{p().o2({environment:u,spaceStore:s})}),[u,s]);const m=(0,a().K8)((()=>c().A.state),[]);return(0,ce.jsx)(l().s,{ariaLabelledBy:d().Kvs,isOpen:m.open,onClosed:()=>p().dl(u),animateSizeTransition:!1,areaConstraint:{width:{type:"min",length:400}},render:()=>m.open?(0,ce.jsx)("div",{style:{overflowY:"auto"},children:(0,ce.jsx)(Me,{state:m,billingData:i,data:t,spaceStore:s,spaceViewStore:o})}):null})}function Me(e){const{state:t,billingData:i,data:r,spaceStore:l,spaceViewStore:d}=e,{subscriptionTier:c,onlyShowAddOn:p,calculatingTax:b,temporaryBillingInterval:h,taxAmount:v,addOnFeature:y,coupon:A}=t,x=(0,a().K8)((()=>(0,o().Ry)(i)??f().A.selectedCurrencyCode),[i]),S=(0,u().V)()??1,{payAmount:M}=g().TQ({billingData:i,subscriptionTier:c,memberCount:S,currencyCode:x,promo:t.appliedPromo,onlyShowAddOn:p,calculatingTax:b,billingInterval:h??"year",taxAmount:v,addOnFeature:y,coupon:A}),C=(0,m().useElementsOptions)({type:"subscription",amount:M.amount,currency:M.currencyCode}),I=(0,n.useMemo)((()=>(0,m().getStripe)()),[]);return(0,ce.jsx)(s().Elements,{stripe:I,options:C,children:(0,ce.jsx)(xe,{spaceViewStore:d,state:t,data:r,spaceStore:l})})}},606456:(e,t,i)=>{i.d(t,{Oo:()=>F,mR:()=>O,Tq:()=>q,ge:()=>R});i(16280),i(898992),i(354520),i(737550);var s=()=>i(244641),n=(i(296540),()=>i(584262)),r=()=>i(857639),a=()=>i(967786),o=()=>i(179034),l=()=>i(762433),d=()=>i(323063),u=()=>i(166386),c=()=>i(807487),p=()=>i(959013),m=()=>i(496603),g=()=>i(252105),f=()=>i(901389),b=()=>i(496414),h=()=>i(209660),v=()=>i(857783),y=()=>i(436572),A=()=>i(34542),x=()=>i(211716),S=()=>i(770769),M=()=>i(765957),C=()=>i(57605),I=()=>i(814431),j=()=>i(630116),w=()=>i(506090),T=()=>i(399995),U=()=>i(106196),_=i(474848);function P(e){const{onClick:t}=e;return(0,_.jsx)(U().N,{buttonInfo:{onClick:t,label:(0,_.jsx)(p().sA,{id:"spaceSubscriptionUpgradeModal.upgradeAi.getStarted",defaultMessage:"Get started"})}})}var k=()=>i(807778),N=()=>i(112527),D=()=>i(51473),E=()=>i(779795),B=()=>i(411341);const L=(0,p().YK)({cancelFailedSubscription:{id:"subscription.upgrade.cancel_failed_subscription",defaultMessage:"Cancelling subscription..."}});function F(e){const{environment:t,modalId:i}=e;w().A.reset(),g().OC(t,{modal_id:i})}async function O(e){const{modalId:t,modalType:i,environment:s,intl:n,elements:r,stripe:a,isCheckoutAddressFormExperimentEnabled:o}=e,l=n.formatMessage({id:"spaceSubscriptionUpgradeModal.payment.genericError",defaultMessage:"Your payment could not be processed. Please try again."}),{error:d}=await r.submit();if(d)return g().qC(s,{error:"could not submit form",error_type:"payment_method",modal_id:t,modal_type:i}),{error:l};const{error:u,paymentMethod:p}=await a.createPaymentMethod({elements:r});if(u)return g().qC(s,{error:u.message,error_type:"payment_method",modal_id:t,modal_type:i}),g().cr(s,{error:u.code,stripe_decline_code:u.decline_code}),{error:N().translateStripeError(n,u)};if(!p)return g().qC(s,{error:"could not create token",error_type:"payment_method",modal_id:t,modal_type:i}),{error:l};const m={type:"paymentMethodId",value:p.id};if(o){const e=p.billing_details,{line1:t,line2:i,city:s,state:n,postal_code:r,country:a}=e.address??{};return{paymentData:m,address:{name:e.name??"",addressLine1:t??"",addressLine2:i??"",city:s??"",state:n??"",zipCode:r??"",country:a??"US"}}}{const e=p.billing_details.address;return{paymentData:m,address:{zipCode:(null==e?void 0:e.postal_code)??"",country:c()._q.includes(p.type)?"KR":(null==e?void 0:e.country)??""}}}}async function R(e){var t;const{address:i,billingEmail:n,billingInterval:r,coupon:o,currencyCode:c,environment:v,isStartingTrial:y,modalId:A,modalType:x,offerInfo:S,paymentData:j,promo:w,quantity:U,selectedProducts:P,stripe:N,useTestClock:F,vatId:O,intl:R,from:q,postUpgradeCallback:z}=e,K=M().default.state.currentSpaceStore;if(!K)return;const Y=await E().p_({environment:v,spaceId:K.id}),W=await C().A.awaitData(v,{spaceId:null==K?void 0:K.id});if(!W)throw new Error("Billing data not loaded");const G=(null===(t=(0,l().KH)(W,"sites_custom_hostnames"))||void 0===t?void 0:t.quantity)??0,V=(0,l().lQ)(W),H=y?s().c9.now().plus({days:14}):void 0,Q=(0,m().oE)(P).filter((e=>"free"!==e)),X=(0,k().Le)(),J=(0,d().ef)({state:{...V,trialEnd:H},prices:Y,quantities:{numSeats:U,numCustomHostnames:G},params:{interval:r,currency:c},products:Q,flags:{isMay13PackagingChangesEnabled:X}}),Z=Q.some((e=>(0,u().Jf)(o,e,r)));try{const e=await B().updateSubscription({environment:v,spaceStore:K,desiredState:(0,d().Vr)(Y,J,r),paymentData:j,billingEmail:n,coupon:"coupon"===(null==w?void 0:w.source)?w.code:void 0,customerName:i.name,businessName:i.businessName,addressLine1:i.addressLine1,addressCity:i.city,addressZip:i.zipCode,addressState:i.state,addressCountry:i.country,vatId:O??void 0,offerInfo:S,promoCodeId:w&&"promo_code"===w.source?w.code:void 0,from:q??"subscription_upgrade_modal",useTestClock:F,sessionId:A,inAppOffer:Z?o:void 0,postUpgradeCallback:z});await B().handlePaymentIntentNextActions({paymentIntentData:e,stripe:N,onSuccess:()=>{g().dI(v,{payment_intent_id:e.paymentIntentId,modal_id:A,modal_type:x})},onFailure:async()=>{await async function(e){const{updateSubscriptionResponse:t,environment:i,modalId:s,modalType:n,spaceStore:r,currencyCode:a,intl:o}=e,{subscriptionStatus:l,paymentIntentId:d}=t,u=r.id;await I().L.resetData(i,{spaceId:u});const c=await I().L.awaitData(i,{spaceId:u})??[];f().ui({message:"trialing"===l?(0,_.jsx)(p().sA,{id:"subscription.upgrade.payment_failed.trial",defaultMessage:"Please provide an alternate payment method to complete your upgrade."}):(0,_.jsx)(p().sA,{id:"subscription.upgrade.payment_failed",defaultMessage:"Your payment could not be processed. Please provide an alternate payment method or you will lose access to Notion."}),showCancel:!1,keepFocus:!1,disableBackgroundDismiss:!0,items:[{label:(0,_.jsx)(p().sA,{id:"subscription.upgrade.payment_failed.pay_invoice",defaultMessage:"Complete payment"}),onAccept:()=>{if(g().GB(i,{payment_intent_id:d,modal_id:s,modal_type:n}),(0,k().Ug)())return(0,T().U)(i,r,a,[c[0]],o);window.open(t.invoiceUrl,"_blank")},color:"red"},{label:(0,_.jsx)(p().sA,{id:"subscription.upgrade.payment_failed.cancel",defaultMessage:"Cancel upgrade"}),onAccept:async()=>{g().WB(i,{payment_intent_id:t.paymentIntentId,modal_id:s,modal_type:n}),b().m({message:L.cancelFailedSubscription}),await B().updateSubscription({environment:i,spaceStore:r,from:"subscription_upgrade_modal-failed_payment",desiredState:{items:[],trialEnd:void 0}}),b().V(),D().A.close(),h().Ow({currentTab:"plans"})}}]})}({updateSubscriptionResponse:e,environment:v,modalId:A,spaceStore:K,currencyCode:c,intl:R})}}),w&&(0,a().rP)(v.currentUser.id)}catch($){throw g().WB(v,{modal_id:A,modal_type:x}),$}}function q(e){const{environment:t,spaceStore:i,spaceViewStore:s,intl:a,currentUserRootStore:l}=e,d=(0,S().getAIUpgradeTemplate)({intl:a});if(!d)throw new Error("AI template not found");if(!l)throw new Error("Cannot create BlockStore: currentUserRootStore not found");const u=j().Bv.createChildStore(l,{table:o().ev,id:d.rootId});(0,A().Fq)({environment:t,blockStore:u,spaceStore:i,spaceViewStore:s,hideModal:!0,disableRedirect:!0,showDuplicationStartedToast:!1,showDuplicationFinishedToast:!1}).then((e=>{if(!e)return;y().D6({label:a.formatMessage({id:"spaceSubscriptionUpgradeModal.upgradeAi.success",defaultMessage:"You now have Notion AI"}),style:{gap:8,display:"flex"},right:(0,_.jsx)(P,{onClick:()=>{v().uK({environment:t,store:e,visitType:x().ig.Link,pageVisitSource:n().y8.Duplicate})}})})})).catch((e=>{r().log({from:"client/checkoutActions",level:"error",type:"aiUpgrade.duplicationFailed",data:{message:"AI Upgrade duplication failed.  Block store not found"}})}))}},814927:(e,t,i)=>{i.d(t,{g:()=>n});var s=()=>i(981046);function n(e,t,i){const n=s().A.getPrice(i,(i=>i.product===e&&i.billingInterval===t));return null==n?void 0:n.result}},816953:(e,t,i)=>{i.d(t,{A:()=>l});var s=()=>i(484714),n=()=>i(660237),r=()=>i(187174),a=()=>i(816758),o=()=>i(449506);function l(){var e;const t=(0,s().v3)(),[i]=(0,r().Yb)((async()=>{const e=await o().callApi({eventName:"getGeoIpLocation",environment:t,data:{}});if("success"===e.type)return e.data}),[t]),l=null==i||null===(e=i.value)||void 0===e?void 0:e.countryCodeFromIp;return!!(0,n().Ef)(l)&&(0,a().Lv)(l)}},889173:(e,t,i)=>{i.d(t,{f:()=>m});i(296540);var s=()=>i(148307),n=()=>i(132855),r=()=>i(401497),a=i(474848);function o(e){const{style:t,shadowVariant:i="strong",wrapStyle:s,imageSrc:n,variant:o="medium",alt:l,wrapWithPadding:d=!0}=e;let u=36;"medium"===o?u=36:"large"===o&&(u=48);const c=(0,r().IS)((e=>({faceImgWrap:{width:u,height:u,borderRadius:"100%",background:e.assistantCornerButtonBackground,..."strong"===i&&{boxShadow:e.shadowMD},..."light"===i&&{borderRadius:"50%",boxShadow:e.shadowSM},overflow:"hidden",...s},faceImg:{height:u,width:u,...d&&{pointerEvents:"none"},...t}})),[i,s,d,t,u]),p=(0,a.jsx)("img",{style:c.faceImg,src:n,alt:l});return d?(0,a.jsx)("div",{children:(0,a.jsx)("div",{style:c.faceImgWrap,children:p})}):p}function l(){const e=(0,r().IS)((e=>({meetingNotesLight:{width:104,height:104,top:-17,left:-31,bottom:-28,position:"absolute"}})),[]);let t;return t="dark"===(0,r().eP)()?(0,a.jsx)("img",{src:s().A.images.subscriptions.meetingNotesDarkSvg,alt:"Notion AI Meeting Notes"}):(0,a.jsx)("img",{src:s().A.images.subscriptions.meetingNotesLightSvg,alt:"Notion AI Meeting Notes",style:e.meetingNotesLight}),(0,a.jsx)("div",{style:{width:47,height:49},children:t})}var d=()=>i(200424);function u(){const e=(0,r().IS)((e=>({wrapper:{display:"inline-block",position:"relative",width:52,height:52},mailIcon:{position:"absolute",width:24,objectFit:"cover",right:0,bottom:0}})),[]);return(0,a.jsxs)("div",{style:e.wrapper,children:[(0,a.jsx)(o,{imageSrc:d(),variant:"large",alt:"Notion AI Mail Icon"}),(0,a.jsx)("img",{style:e.mailIcon,src:s().A.images.subscriptions.notionAiMailSvg,alt:"Notion AI Mail Icon"})]})}var c=()=>i(732067),p=()=>i(8980);function m(e){const{headerContent:t,primaryProduct:i}=e;if("featureWithCustomImage"in t)switch(t.featureWithCustomImage){case"coreAI":case"aiConnectors":return(0,a.jsx)(c().cG,{variant:"medium_large"});case"meetingNotes":return(0,a.jsx)(l,{});case"researchMode":return(0,a.jsx)(o,{imageSrc:s().A.images.subscriptions.researchModeSvg,variant:"large",alt:"Notion Research Mode"});case"notionAIForMail":return(0,a.jsx)(u,{})}else if("ai"===i)return(0,a.jsx)(c().cG,{variant:"medium_large"});return(0,a.jsx)(p().I,{icon:n().arrowInCircleUpFillIcon,color:"uiBluePrimary",size:"xl",style:{marginLeft:-4}})}},906195:(e,t,i)=>{i.d(t,{D:()=>b});var s=i(296540),n=()=>i(484714),r=()=>i(56366),a=()=>i(786508),o=()=>i(166386),l=()=>i(449506),d=()=>i(640653),u=()=>i(58293),c=()=>i(765957),p=()=>i(749356),m=()=>i(714300),g=()=>i(762433),f=()=>i(807778);function b(){const e=(0,n().v3)(),t=(0,u().r)(),i=null==t?void 0:t.id,b=(0,m().l)({spaceId:i}),[h,v]=(0,s.useState)(!1),{currentSpaceStore:y}=(0,r().K8)((()=>{const{currentSpaceStore:e}=c().default.state;return{currentSpaceStore:e}}),[]),A=(0,r().K8)((()=>y?(0,d().GK)(e,y):void 0),[y,e]),x=function(e){return(0,r().K8)((()=>(0,f().vv)()&&Boolean("free"===(0,g().AI)(e))),[e])}(b),S=(0,r().K8)((()=>null==t?void 0:t.canAdmin()),[t]);return(0,s.useEffect)((()=>{!async function(){if(x&&i&&S)try{const t=await l().callApi({eventName:"getCustomerOffer",environment:e,data:{spaceId:i,offerCampaign:"resurrection_offer"}});if("failed"===t.type)return;if("offer"in t.data){const i=(0,a().RS)(t.data.offer);(0,o().u6)(i)&&(v(!0),A&&(0,p().Zc)({environment:e,spaceName:A,offerCampaign:"resurrection_offer"}))}}catch(t){return}}()}),[e,i,x,A,S]),h}}}]);