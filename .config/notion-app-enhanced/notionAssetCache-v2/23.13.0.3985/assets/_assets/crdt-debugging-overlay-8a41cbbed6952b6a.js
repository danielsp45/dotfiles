"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[61488],{2e3:(t,e,n)=>{n.d(e,{A:()=>i});class o extends(()=>n(757695))().Store{getInitialState(){return{open:!1}}}const i=new o},361859:(t,e,n)=>{n.r(e),n.d(e,{CrdtDebuggingOverlay:()=>f});n(944114),n(898992),n(803949),n(581454);var o=n(296540),i=()=>n(56366),r=()=>n(301421),s=()=>n(397248),c=()=>n(2e3),l=n(474848);function f(t){return(0,i().K8)((()=>c().A.state.open),[],{debugName:"CrdtDebuggingOverlay.isOpen"})?(0,l.jsx)(a,{}):null}function a(t){const[e,n]=(0,o.useState)([]);return(0,o.useEffect)((()=>{let t=!1,e=window.requestAnimationFrame((function o(){const i=[];r().n.forEach((t=>{const e=t.props.store.getRecordStoreAtRootPath();if("block"!==e.table||!e.useCrdt())return;const n=e.getBlockTitleTextSliceTree();if(!n)return;const o=t.getContentEditableLeaf();if(!o)return;const r=o.getNode();r&&i.push(...d(e.id,n,r))})),n(i),t||(e=window.requestAnimationFrame(o))}));return()=>{t=!0,window.cancelAnimationFrame(e)}}),[]),(0,l.jsx)("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:0,pointerEvents:"none",zIndex:999},children:e.map(((t,e)=>(0,l.jsxs)(o.Fragment,{children:[(0,l.jsx)("div",{style:{position:"absolute",top:t.rect.top,left:t.rect.left,width:t.rect.width,height:t.rect.height,backgroundColor:"rgba(0, 0, 255, 0.25)"}}),(0,l.jsx)("div",{style:{position:"absolute",top:t.rect.bottom,left:t.rect.left,color:"blue",fontSize:10},children:t.clock})]},e)))})}function u(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{textOffset:0};if(e-n.textOffset==0)return{container:t,offset:0};for(let o=0;o<t.childNodes.length;o++){const i=t.childNodes[o];if(i.nextSibling,i.nodeType===i.TEXT_NODE){if(null===i.nodeValue)continue;if(i.nodeValue.length+n.textOffset>=e)return{container:i,offset:e-n.textOffset};n.textOffset+=i.nodeValue.length}else if(i instanceof Element){const t=u(i,e,n);if(t)return t}}}function d(t,e,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{infos:[],textOffset:0};const i=e.getTextSlice(),r=u(n,o.textOffset),c=u(n,o.textOffset+1);if(r&&c){const{textInstanceId:e}=i;try{const n=document.createRange();n.setStart(r.container,r.offset),n.setEnd(c.container,c.offset),o.infos.push({blockId:t,textInstanceId:e,clock:i.opClock.getValue(),rect:s().z8.from(n.getBoundingClientRect())})}catch(l){console.log("Error attempting to find bounding box for beginning of text slice",e,"in block",t,l)}}o.textOffset+=i.getText().length;for(const s of e.children)d(t,s,n,o);return o.infos}}}]);