"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[23133],{3197:(e,t,o)=>{o.d(t,{t:()=>s});var r=o(296540),n=()=>o(183558),i=()=>o(248064),l=()=>o(384130),a=()=>o(937199);function s(e){const{setModuleSelection:t,layoutStore:o}=(0,a().LH)(),s=(0,i().h)(),{dismissTooltip:d}=(0,l().J)();return(0,r.useCallback)((()=>{var r;"form"===(null===(r=o.getModel())||void 0===r?void 0:r.getLayoutType())&&"form_conditional_modules"!==e.area?s({layoutModule:{type:"placeholder",id:(0,n().Ay)()},position:e.afterModuleId?{type:"module_relative",area:e.area,direction:"below",relativeToModuleId:e.afterModuleId}:void 0}):(t({type:"new_module",isDragging:!1,..."views_main_tab_modules"===e.area?{area:"views_main_tab_modules",viewsMainTabId:e.viewsMainTabId}:{area:e.area}}),"page_main"===e.area&&d())}),[o,e,s,t,d])}},158359:(e,t,o)=>{o.d(t,{P:()=>n});o(296540);var r=o(474848);const n=(0,o(340498).wt)("arrowDown",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 1.57715C7.5625 1.57715 7.25488 1.88477 7.25488 2.33594V10.8262L7.30957 12.3027L5.50488 10.2861L3.95312 8.75488C3.82324 8.625 3.63184 8.53613 3.42676 8.53613C3.0166 8.53613 2.70898 8.85059 2.70898 9.26758C2.70898 9.46582 2.78418 9.64355 2.94141 9.80762L7.44629 14.3193C7.59668 14.4697 7.79492 14.5586 8 14.5586C8.20508 14.5586 8.40332 14.4697 8.55371 14.3193L13.0586 9.80762C13.2158 9.64355 13.291 9.46582 13.291 9.26758C13.291 8.85059 12.9902 8.53613 12.5801 8.53613C12.3682 8.53613 12.1836 8.625 12.0469 8.75488L10.4951 10.2861L8.69043 12.2959L8.74512 10.8262V2.33594C8.74512 1.88477 8.44434 1.57715 8 1.57715Z"})})},248064:(e,t,o)=>{o.d(t,{h:()=>s});var r=o(296540),n=()=>o(484714),i=()=>o(56366),l=()=>o(978846),a=()=>o(937199);function s(){const{layoutStore:e,currentModuleSelection:t,setModuleSelection:o,sessionId:s}=(0,a().LH)(),d=(0,n().v3)(),c=(0,i().K8)((()=>{var t;return null===(t=e.getModel())||void 0===t?void 0:t.getLayoutType()}),[e]),p="form"===c?"form_layout_schema":"new_module"===(null==t?void 0:t.type)?t.area:void 0;return(0,r.useCallback)((r=>{const{layoutModule:n,transaction:i}=r;if(!e.getModel()||!p||"form_conditional_modules"===p)return;let a;if("form"===c)a=r.position??{type:"area_relative",area:"form_layout_schema",location:"end_moveable"};else{if("new_module"!==(null==t?void 0:t.type))return;if("form_conditional_modules"===t.area)return;a="views_main_tab_modules"===t.area?{type:"area_relative",area:t.area,viewId:t.viewsMainTabId,location:"end_moveable"}:{type:"area_relative",area:t.area,location:"end_moveable"}}(0,l().UQ)({environment:d,sessionId:s,layoutStore:e,position:a,module:n,transaction:i,isPropertyCreation:!1}),o({type:"existing_module",moduleId:n.id,isDragging:!1})}),[p,t,d,e,c,s,o])}},290966:(e,t,o)=>{o.d(t,{E_:()=>T,HQ:()=>L,I5:()=>D,ZQ:()=>A});o(16280),o(898992),o(823215),o(354520),o(581454),o(296540);var r=()=>o(662303),n=()=>o(536095),i=()=>o(134025),l=()=>o(912720),a=()=>o(179034),s=()=>o(519831),d=()=>o(869558),c=()=>o(144081),p=()=>o(921515),u=()=>o(959013),m=()=>o(496603),f=()=>o(534177),y=()=>o(284371),S=()=>o(966759),v=()=>o(235191),g=()=>o(901389),h=()=>o(751156),w=()=>o(67103),_=()=>o(16006),C=()=>o(972435),I=()=>o(470928),b=()=>o(630116),x=()=>o(913454),M=()=>o(204067),k=o(474848);function A(e){let{transaction:t,collectionStore:o,templateId:r,instance:n,logger:u}=e;u.debug(`Creating/updating ${p().rM} record for "${r}".`);const m=o.getSpaceId(),y=n.id;if("automation"===n.type){const e={table:l().yB,id:y,spaceId:m};h().applyOperation({store:b().dn.createChildStore(o,e),operation:i().op.set({pointer:e,path:["properties","workflow_template_instance"],args:{template_id:r}}),transaction:t})}else if("block"===n.type){const e={table:a().ev,id:y,spaceId:m};h().applyOperation({store:b().Bv.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:r}}),transaction:t})}else if("collection"===n.type){const e={table:s().Vl,id:y,spaceId:m};h().applyOperation({store:o,operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:r}}),transaction:t})}else if("collection_view"===n.type){const e={table:d().Gy,id:y,spaceId:m};h().applyOperation({store:b().pS.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:r}}),transaction:t})}else if("layout"===n.type){const e={table:c().zx,id:y,spaceId:m};h().applyOperation({store:b().K_.createChildStore(o,e),operation:i().op.set({pointer:e,path:["format","workflow_template_instance"],args:{template_id:r}}),transaction:t})}else if("compound"===n.type){if(n.instancePointers.length<2)throw new Error(`Compound template instance ${n.id} must contain 2 or more instances`);const e=n.instancePointers.map((e=>{switch(e.type){case"automation":return{type:"automation",id:e.id};case"block":return{type:"block",id:e.id};case"collection_view":return{type:"collection_view",id:e.id};case"layout":return{type:"layout",id:e.id};case"property":return{type:"property",id:e.id}}(0,f().HB)(e)}));h().applyOperation({store:o,operation:{command:"keyedObjectListUpdate",pointer:o.pointer,path:["format","compound_workflow_template_instances"],args:{value:{template_id:r,id:n.id,instance_pointers:e}}},transaction:t})}else"property"===n.type?h().applyOperation({store:o,operation:i().op.update({pointer:o.pointer,path:["schema",n.id],args:{workflow_template_instance:{template_id:r}}}),transaction:t}):(0,f().HB)(n)}function T(e){let{environment:t,collectionStore:o,propertyId:r,compoundTemplateInstancesToDelete:i,collectionContextStore:l,from:a}=e;if(!i.every((e=>e.templateId===n().z$)))return!1;if(!(0,I().Io)())return!1;const s=(0,M().aL)({environment:t,collectionStore:o,compoundTemplateInstancesToDelete:i}),d=m().sb(s.filter((e=>"property"===e.type)).map((e=>e.id))),c=o.getSchema(),p=d.map((e=>{var t;if(e===r)return;const o=c[e];if(!o)throw new Error(`Property ${e} not found`);if(o.name)return o.name;const n=null===(t=o.workflow_template_instance)||void 0===t?void 0:t.template_id;if(!n)throw new Error(`Property ${e} has no workflow template id`);const i=x().globalWorkflowTemplates.fromId(n);return(0,x().getWorkflowTemplateName)(i)})).filter(f().O9);return P({environment:t,collectionStore:o,propertyIds:d,otherPropertyNames:p,collectionContextStore:l,from:a}),!0}function D(e){let{environment:t,collectionStore:o,propertyId:r,collectionContextStore:n,from:i}=e;const l=o.getSchema(),a=Object.keys(l).filter((e=>(0,I().Do)({collectionStore:o,propertyId:e})||(0,I().k$)(e))),s=a.map((e=>{var t;if(e===r)return;const n=null===(t=l[e])||void 0===t?void 0:t.name;if(n)return n;if((0,I().Do)({collectionStore:o,propertyId:e}))return C().A.formatMessage(w().Gl.verificationPropertyName);if((0,I().k$)(e))return C().A.formatMessage(w().Gl.ownerPropertyName);throw new Error(`Property ${e} must be a verification or owner property`)})).filter(f().O9);return P({environment:t,collectionStore:o,propertyIds:a,otherPropertyNames:s,collectionContextStore:n,from:i}),!0}function P(e){let{environment:t,collectionStore:o,propertyIds:n,otherPropertyNames:i,collectionContextStore:l,from:a}=e;const s=[{label:(0,k.jsx)(u().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deleteOption",defaultMessage:"{count, plural, one {Delete {count} property} other {Delete {count} properties}}",values:{count:n.length}}),color:"red",onAccept:()=>function(e){let{environment:t,collectionStore:o,collectionContextStore:r,propertyIds:n,from:i}=e;h().createAndCommit({userAction:"workflowTemplateInstanceActions.handleDeleteAccept",environment:t,canUndo:!0,perform:e=>{const l=o.getSchema();for(const a of n){v().BJ({environment:t,collectionStore:o,schema:l,property:a,transaction:e});const n=l[a];n&&(0,S().i)({environment:t,collectionContextStore:r,property_type:n.type,from:i,property:a})}}})}({environment:t,collectionStore:o,collectionContextStore:l,propertyIds:n,from:a})}],d=new Intl.ListFormat(r().locale,{style:"long",type:"conjunction"}),c=(0,k.jsx)(u().sA,{id:"workflowTemplateInstanceActions.deleteRequiredProperty.deletePropertyFromDb",defaultMessage:"Delete this property from <bold>{databaseName}</bold>? {otherPropertyNames} will also be deleted",values:{bold:e=>(0,k.jsx)("span",{style:{fontWeight:y().Wy.bold},children:e}),databaseName:(0,k.jsx)(_().A,{style:{display:"inline",fontWeight:y().Wy.bold},shouldWrap:!0,store:o}),otherPropertyNames:d.format(i)}});g().ui({message:(0,k.jsx)("span",{children:c}),showCancel:!0,keepFocus:!0,innerStyle:{width:400},items:s})}function L(e){const{environment:t,transaction:o,collectionStore:r,instance:n}=e;(0,M().aI)({environment:t,instancePointer:n,inMemoryRecordCache:r.inMemoryRecordCache})||h().applyOperation({store:r,operation:{pointer:r.pointer,command:"keyedObjectListRemove",path:["format","compound_workflow_template_instances"],args:{remove:{id:n.id}}},transaction:o})}},384130:(e,t,o)=>{o.d(t,{J:()=>c});var r=o(296540),n=()=>o(484714),i=()=>o(56366),l=()=>o(751156),a=()=>o(755199),s=()=>o(186445),d=()=>o(765957);function c(){return function(e){let{userSettingsDismissibleKey:t}=e;const o=(0,n().v3)(),c=(0,i().K8)((()=>d().default.state.currentUserSettingsStore),[]),p=(0,i().K8)((()=>{const e=null==c?void 0:c.getSettings();return!e||Boolean(e[t])}),[t,c]),u=(0,i().K8)((()=>{const e=(0,s()._m)(o),t=null==c?void 0:c.getSettings();return Boolean(e)&&Boolean(t)&&!o.device.isMobile&&!p}),[o,c,p]),m=r.useCallback((()=>{c&&!p&&u&&l().createAndCommit({environment:o,userAction:"LayoutInfoPanelButtonEducationTooltip.dismiss",canUndo:!1,perform:e=>{a().mJ({userSettingsStore:c,transaction:e,data:{[t]:Date.now()}})}})}),[o,u,t,c,p]);return{shouldShowTooltip:u,dismissTooltip:m}}({userSettingsDismissibleKey:"layout_builder_add_module_button_education_tooltip_dismissed_at"})}},402137:(e,t,o)=>{o.d(t,{w:()=>s});o(18107),o(967357),o(814603),o(147566),o(198721);const r="://",n="www.",i=/.+\..+\..+/,l=/\.{2,}/,a=/.+\..+/;function s(e){const t=e.trim();if(0===t.length)return!1;if(-1===t.indexOf(".")&&-1===t.indexOf("localhost"))return!1;if("."===t.at(t.length-1)||-1!==t.indexOf(" "))return!1;let o,s=`${-1===t.indexOf(r)?"http://":""}${t}`;try{o=new URL(s)}catch(c){const e=-1===s.indexOf(n),[t,i]=s.split(r);s=`${t}${r}${e?"www.":""}${i}`;try{o=new URL(s)}catch(c){return!1}}const d=o.hostname;return!l.test(d)&&(!(t.includes(n)&&"localhost"!==d&&!i.test(d))&&!("localhost"!==d&&!a.test(d)))}},412532:(e,t,o)=>{o.d(t,{l:()=>n});o(296540);const r={viewBox:"0 0 16 16",fittedViewBox:"2.03 2.29 11.93 10.46",svg:(0,o(474848).jsx)("path",{d:"M13.165 12.75a.8.8 0 0 0 .69-1.203L8.692 2.693a.8.8 0 0 0-1.382 0l-5.165 8.854a.8.8 0 0 0 .691 1.203z"})},n=(0,o(340498).wt)("arrowCaretUpFillSmall",r)},471095:(e,t,o)=>{o.d(t,{i:()=>n});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"3.97 1.95 12.05 15.66",svg:(0,o(474848).jsx)("path",{d:"M6 5.95a4 4 0 1 1 8 0v1.433a2.426 2.426 0 0 1 2.025 2.392v5.4A2.425 2.425 0 0 1 13.6 17.6H6.4a2.425 2.425 0 0 1-2.425-2.425v-5.4c0-1.203.876-2.201 2.025-2.392zm6.75 1.4v-1.4a2.75 2.75 0 1 0-5.5 0v1.4zm-2.2 5.458a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"})},n=(0,o(340498).wt)("lockFill",r)},498474:(e,t,o)=>{o.d(t,{q:()=>n});o(296540);var r=o(474848);const n=(0,o(340498).wt)("arrowUp",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},542371:(e,t,o)=>{o.d(t,{A:()=>r});class r extends(()=>o(757695))().Store{getInitialState(){}}},626466:(e,t,o)=>{o.r(t),o.d(t,{arrowChevronSingleDownFillIcon:()=>n,iconDefinition:()=>r});o(296540);const r={viewBox:"0 0 20 20",fittedViewBox:"3.72 6.72 12.56 7.16",svg:(0,o(474848).jsx)("path",{d:"M9.381 13.619a.875.875 0 0 0 1.238 0l5.4-5.4A.875.875 0 1 0 14.78 6.98L10 11.763 5.219 6.98A.875.875 0 1 0 3.98 8.22z"})},n=(0,o(340498).wt)("arrowChevronSingleDownFill",r)},731120:(e,t,o)=>{o.d(t,{A:()=>r});class r extends(()=>o(757695))().Store{getInitialState(){return{isOpen:!1}}}},754199:(e,t,o)=>{function r(e){return/^(\+\d{1,2}[\s.-])?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function n(e){return/^[0-9 .()\-\+]{7,}$/.test(e)}o.d(t,{W:()=>r,e:()=>n})},766911:(e,t,o)=>{o.r(t),o.d(t,{CollectionFormEditorView:()=>H});var r=o(296540),n=()=>o(56366),i=()=>o(757695),l=()=>o(101981),a=()=>o(145214),s=()=>o(630116),d=(o(16280),o(898992),o(672577),()=>o(402014)),c=()=>o(908006),p=()=>o(484714),u=()=>o(118884),m=()=>o(591779),f=()=>o(206267),y=()=>o(919709),S=()=>o(686526),v=()=>o(725614),g=()=>o(175116),h=()=>o(454305),w=()=>o(953418),_=()=>o(47170),C=()=>o(963589),I=()=>o(640868),b=()=>o(937199),x=()=>o(761660),M=()=>o(817942),k=()=>o(731120),A=()=>o(542371),T=()=>o(104129);class D extends i().Store{getInitialState(){return{openTooltip:void 0}}}class P extends i().Store{getInitialState(){return{conditionalGroupCollapsedStates:{}}}}var L=()=>o(24157),B=()=>o(611371),j=()=>o(134217),E=()=>o(749240);class O extends i().Store{getInitialState(){}autofocusQuestionDescription(e){let{questionId:t}=e;this.setState({questionId:t,questionInputType:"description"})}autofocusQuestionTitle(e){let{questionId:t}=e;this.setState({questionId:t,questionInputType:"title"})}clear(){this.setState(void 0)}}var R=()=>o(348241),K=o(474848);function $(e){let{collectionContextStore:t,collectionViewStore:o,layoutStore:i,isCollectionEmpty:l}=e;const a=(0,p().v3)(),s=(0,n().uB)(void 0,A().A),d=(0,n().uB)(void 0,P),c=(0,n().uB)(void 0,D),u=(0,_().O)(),m=(0,n().O$)(E().subscriptionDataStoreInstance);return(0,r.useEffect)((()=>{m&&u&&j().V$(a,m,u)&&B().He(a)}),[a,m,u]),(0,K.jsx)(V,{collectionContextStore:t,collectionViewStore:o,layoutStore:i,layoutBuilderModuleSelectionStore:s,formConditionalGroupsStore:d,formAddConditionalLogicTooltipStore:c,isCollectionEmpty:l,children:(0,K.jsx)(W,{children:(0,K.jsx)(M().Mx,{type:"form",children:(0,K.jsx)(x().J,{area:"form_layout_schema"})})})})}function V(e){let{children:t,collectionContextStore:o,collectionViewStore:l,layoutStore:a,layoutBuilderModuleSelectionStore:s,formConditionalGroupsStore:d,formAddConditionalLogicTooltipStore:m,isCollectionEmpty:_}=e;const C=(0,p().v3)(),x=(0,n().K8)((()=>o.collectionStore()),[o]),[M]=(0,r.useState)(f().JW()),A=(0,n().K8)((()=>s.getState()),[s]),D=(0,n().uB)(void 0,k().A),P=(0,n().uB)(void 0,O),L=(0,n().uB)(void 0,h().A),B=i().Store.createValue(!1,{name:"headerFocusStore"}),j=(0,n().K8)((()=>o.permissionScopesStore.state.canConfigureCollection),[o]),E=(0,n().K8)((()=>l.getFormBlockStore()),[l]),$=(0,n().K8)((()=>C.WindowSizeStore.state.height),[C.WindowSizeStore]),V=(0,r.useCallback)((e=>{var t;const r=s.getState(),n=a.getModules();if(r&&"existing_module"===r.type){var i;const t=null===(i=n.form_conditional_modules)||void 0===i?void 0:i[r.moduleId],o=void 0!==t?t:n.form_layout_schema.find((e=>e.id===r.moduleId));!o||"placeholder"!==o.type||t||e&&("existing_module"!==e.type||r.moduleId===e.moduleId)||(0,I().U)({environment:C,position:{area:t?"form_conditional_modules":"form_layout_schema",moduleId:o.id},layoutStore:a,sessionId:M})}if(s.setState(e),(e||r)&&v().clear({environment:C}),!e||"existing_module"!==e.type||e.isDragging)return;if(!x)return;const l=a.getModuleById(e.moduleId);if(!l)return;const d=void 0!==(null===(t=n.form_conditional_modules)||void 0===t?void 0:t[l.id]);c().default.afterNextFlush((()=>{const t=T().A.findModuleContainer({layoutStore:a,moduleId:l.id}),r=null==t?void 0:t.getNode(),n={current:r??null},i=null==r?void 0:r.getBoundingClientRect();switch(((null==i?void 0:i.bottom)??0)+120>$&&(0,w().vq)(r,{edgeDist:.5*$,animate:!0}),l.type){case"formQuestion":S().Ow({collectionContextStore:o,collectionSettingsStore:o.settingsStore,ref:n}),S().dP({collectionSettingsStore:o.settingsStore,item:{type:"formQuestionEditSettings",formQuestionId:l.formQuestionId,moduleId:l.id},ref:n});break;case"placeholder":S().Ow({collectionContextStore:o,collectionSettingsStore:o.settingsStore}),S().dP({collectionSettingsStore:o.settingsStore,item:{type:"formQuestionCreateSettings",moduleId:l.id,area:d?"form_conditional_modules":"form_layout_schema",parentModuleId:l.parentModuleId,parentConditionalGroupId:l.parentConditionalGroupId},ref:n});break;default:throw new Error("Unexpected module type")}s.setState(e)}))}),[s,x,a,C,M,$,o]),W=i().Store.createValue(!1),F=(0,r.useMemo)((()=>({collectionStore:x,layoutStore:a,currentModuleSelection:A,setModuleSelection:V,sessionId:M,addModuleHoverMenuStore:D,canEditLayout:j,isPropertyTypeSearchInputDirtyStore:W,layoutBuilderModuleSelectionStore:s})),[x,a,A,V,M,D,j,W,s]),H=(0,r.useMemo)((()=>{if(!x||!E)throw new Error("Need a collection store and form block store to build the form context");return{formConditionalGroupsStore:d,formAddConditionalLogicTooltipStore:m,autofocusedQuestionTextStore:P,formBlockStore:E,headerMouseStore:L,headerFocusStore:B,collectionStore:x,isCollectionEmpty:_}}),[P,E,d,m,B,L,x,_]);(0,r.useEffect)((()=>{o.formsBaseLayoutEditorContextValueStore.setState(F),o.formsSpecificLayoutEditorContextValueStore.setState(H)}),[o,F,H]);const N=(0,r.useRef)(!1);(0,r.useEffect)((()=>{if(!1===N.current&&E&&E.isReady()){N.current=!0;const e=E.getTitleStore();e&&!y().q4_(e.getValue())&&v().setSelectionAtEnd({store:e})}}),[E,N]);const q=(0,r.useCallback)((()=>{V(void 0),S().os({collectionSettingsStore:o.settingsStore})}),[o.settingsStore,V]);return(0,u().X)(q),x&&l?(0,K.jsx)(g().RI,{value:o,children:(0,K.jsx)(b().Op.Provider,{value:F,children:(0,K.jsx)(R().zi.Provider,{value:H,children:t})})}):null}function W(e){let{children:t}=e;const o=(0,C().X)("db_ux_chrome"),{setModuleSelection:i,currentModuleSelection:l,layoutStore:a}=(0,b().LH)(),s=(0,g().ET)(),c=(0,n().K8)((()=>s.settingsStore.state.open),[s]),p=(0,m().ZC)(c),u=(0,r.useCallback)((()=>{i(void 0)}),[i]);(0,r.useEffect)((()=>{p&&!c&&u()}),[u,c,p]);const f=(0,n().K8)((()=>(L().default.state,L().default.getRootFormQuestionStoreOfSelection())),[]),y=(0,n().K8)((()=>"existing_module"===(null==l?void 0:l.type)?a.getModuleById(l.moduleId):void 0),[l,a]);return(0,r.useEffect)((()=>{f&&y&&"formQuestion"===(null==y?void 0:y.type)&&f.id!==y.formQuestionId&&(u(),S().os({collectionSettingsStore:s.settingsStore}))}),[u,s.settingsStore,y,f]),(0,K.jsx)("div",{style:{marginTop:o?12:void 0,paddingBottom:96,cursor:"default"},onClick:e=>{(0,d().SQ)({event:e,context:d().y$.Click,callback:()=>{u()}})},children:t})}const F=i().Store.createClass(void 0,{name:"ReducerResultStore"});function H(e){const{paddingLeft:t,paddingRight:o,collectionContextStore:r}=e,i=(0,n().K8)((()=>r.collectionViewStore()),[r]),d=(0,n().K8)((()=>{if(i)return i.getFormBlockStore()}),[i]),c=(0,n().K8)((()=>{if(!d)return;const e=null==d?void 0:d.getFormat().form_layout_pointer;return e?s().K_.createChildStore(d,e):void 0}),[d]),p=(0,n().K8)((()=>null==c?void 0:c.isDefined()),[c]),u=(0,n().K8)((()=>null==d?void 0:d.isDefined()),[d]),m=(0,n().uB)(void 0,F),f=(0,n().K8)((()=>!!m.state&&0===m.state.blockIds.length),[m]);return i&&c&&p&&u?(0,K.jsxs)("div",{style:{paddingLeft:t,paddingRight:o},children:[(0,K.jsx)(l().A,{id:"form_editor_results",collectionContextStore:r,reducer:{type:"results",filter:{operator:"and",filters:[]},limit:1},resultStore:m}),(0,K.jsx)(a().A,{animate:{width:"100%"},children:(0,K.jsx)($,{collectionContextStore:r,collectionViewStore:i,layoutStore:c,isCollectionEmpty:f})})]}):null}},854593:(e,t,o)=>{o.d(t,{q:()=>v});o(944114),o(296540);var r=()=>o(302107),n=()=>o(959013),i=()=>o(284371),l=()=>o(521358),a=()=>o(16006),s=()=>o(972435),d=()=>o(685889),c=()=>o(470928),p=()=>o(290966),u=()=>o(204067),m=()=>o(27732),f=()=>o(901389),y=()=>o(751156),S=o(474848);async function v(e){const{environment:t,collectionContextStore:o,property:v,handleDeleteAccept:g}=e,h=o.collectionStore();if(!h)return;if(h.isTypedProperty(v)){if(await l().nD({environment:t,property:v,collectionContextStore:o,theme:e.theme,from:e.from}))return}const w=(0,u().R5)({environment:t,collectionStore:h,propertyId:v});if(w.length>0){if((0,p().E_)({environment:t,collectionStore:h,propertyId:v,compoundTemplateInstancesToDelete:w,collectionContextStore:o,from:e.from}))return}else if(((0,c().k$)(v)||(0,c().Do)({collectionStore:h,propertyId:v}))&&(0,c().aF)(h)&&(0,c().Io)()){if((0,p().I5)({environment:t,collectionStore:h,propertyId:v,collectionContextStore:o,from:e.from}))return}const _=o.normalizedSchemaStore.state,C=_[v],I=d().pg(o,C);await(null==I?void 0:I.load());const b=I&&d().D5(o,v,I),x=I&&d().uf(I),M=I&&h.id===I.id,k=[{label:(0,S.jsx)(n().sA,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:g}];let A,T;if(b&&h&&x&&!M&&k.push({label:(0,S.jsx)(n().sA,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{y().createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,canUndo:!0,perform:e=>{if(C&&"relation"===C.type&&C.property&&I){const o=C.property,r=I.getSchema();m().C4({environment:t,collectionStore:I,propertySchema:r[o],property:o,targetPropertyID:void 0,autoRelate:h.isSyncedCollection()&&!I.isSyncedCollection()?{enabled:!1}:C.autoRelate,transaction:e})}m().t$({environment:t,collectionStore:h,property:v,transaction:e})}})}}),"auto_increment_id"===(null==C?void 0:C.type))A=d().me(_)?(0,S.jsx)(n().sA,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,S.jsx)(n().sA,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==C?void 0:C.type)){const e=d().AX(_);if(e){const t=e.connectedRelation.automation;t&&t[v]&&(A=(0,S.jsx)(n().sA,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else I&&x&&!M&&b?A=(0,S.jsx)(n().sA,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,S.jsx)(a().A,{style:{display:"inline",fontWeight:i().Wy.medium},store:I})}}):C&&(0,r().dR)({propertyId:v,propertyType:C.type,permissionItems:h.getPermissionItems()})&&(T=s().A.formatMessage(r().DZ.deletePropertyTypeWarningMessage),A=s().A.formatMessage(r().DZ.deletePropertyTypeWarningDescription));f().ui({message:T||(0,S.jsx)("span",{children:(0,S.jsx)(n().sA,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property from {databaseName}? It will be removed from all views.",values:{databaseName:(0,S.jsx)(a().A,{style:{display:"inline",fontWeight:i().Wy.bold},shouldWrap:!0,store:h})}})}),description:A,showCancel:!0,keepFocus:!0,items:k,mode:"wide"})}}}]);