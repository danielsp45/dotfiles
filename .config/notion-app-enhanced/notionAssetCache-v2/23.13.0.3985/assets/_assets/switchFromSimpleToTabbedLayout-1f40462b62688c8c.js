"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[63990],{288143:(e,o,t)=>{t.r(o),t.d(o,{switchFromSimpleToTabbedLayout:()=>m});t(16280),t(898992),t(672577),t(803949);var a=()=>t(454984),i=()=>t(475140),n=()=>t(251822),r=()=>t(696706),l=()=>t(763824),s=()=>t(183558),d=()=>t(896628),c=()=>t(751156),p=()=>t(630116),u=()=>t(210748),w=()=>t(38e3);async function m(e){const{environment:o,layoutStore:t}=e;t.isTabbedPageLayout()||((0,u().O)({environment:o,layoutStore:t}),await c().createAndCommitAsync({environment:o,waitForServerCommit:!1,perform:async e=>{var u,m;const v=t.getRawModules();if(!v||!v.page_layout_schema)throw new Error("Invalid state: no raw modules by area");const y=`view_tab_${(0,s().Ay)()}`;let _;const b=(null===(u=t.getFormat())||void 0===u?void 0:u.previousViewsMainCollectionViewBlockPointer)||(null===(m=v.page_layout_schema.find((e=>"viewsMain"===e.type)))||void 0===m?void 0:m.collection_view_block_pointer);if(b){const a=t.getBlockChildrenPointers();if(!Boolean(a.find((e=>r().L3.isEqual(e,b)))))throw new Error("Invalid state: previous views main collection view block pointer is not a child of the layout");_=p().Bv.createChildStore(t,b);const i=_.getCollectionViewStores();await(0,l().lX)(i,25,(e=>e.load()));const n=i.find((e=>"page"===e.getType()))||(0,w().Q)({environment:o,layoutStore:t,transaction:e,collectionViewBlockStore:_,options:{viewsTabId:y}}).collectionViewStore;d().zA({stores:[n],update:{page_layout_pointer:{...t.pointer,views_main_tab_id:y}},transaction:e})}else({collectionViewBlockStore:_}=(0,w().$)({environment:o,layoutStore:t,transaction:e,options:{viewsTabId:y}}));const{moveableRawModules:h,nonMoveableFooterRawModules:I}=(0,n().lM)("page_layout_schema",v.page_layout_schema),f=[...h,...I];f.forEach((o=>{c().applyOperation({store:t,transaction:e,operation:a().N4.deleteModuleInArea({pointer:t.pointer,area:"page_layout_schema",moduleId:o.id})})})),c().applyOperation({store:t,transaction:e,operation:a().N4.setViewTabModules({pointer:t.pointer,viewId:y,modules:f})}),function(e){const{layoutStore:o,transaction:t,viewId:n}=e,r=o.getRawModules();if(!r)throw new Error("Invalid state: no raw modules by area");const l=(0,i().LP)(r,(e=>"editor"===e.type));l.forEach((e=>{let{module:i,position:n}=e;"page_layout_schema"===n.area&&c().applyOperation({store:o,transaction:t,operation:a().N4.deleteModuleInArea({pointer:o.pointer,moduleId:i.id,area:"page_layout_schema"})})}));l.find((e=>{let{module:o,position:t}=e;return"editor"===o.type&&"views_main_tab_modules"===t.area}))||c().applyOperation({store:o,transaction:t,operation:a().N4.putModuleAfter({pointer:o.pointer,area:"views_main_tab_modules",viewId:n,module:{id:(0,s().Ay)(),type:"editor"},afterId:void 0})})}({layoutStore:t,transaction:e,viewId:y}),function(e){const{layoutStore:o,transaction:t}=e,n=o.getRawModules();if(!n)throw new Error("Invalid state: no raw modules by area");const r=(0,i().LP)(n,(e=>"viewsMain"===e.type));r.forEach((e=>{let{module:i,position:n}=e;c().applyOperation({store:o,transaction:t,operation:a().N4.deleteModuleInArea({pointer:o.pointer,moduleId:i.id,..."views_main_tab_modules"===n.area?{area:n.area,viewId:n.viewId}:{area:n.area}})})}))}({layoutStore:t,transaction:e});const g={id:(0,s().Ay)(),type:"viewsMain",collection_view_block_pointer:{..._.pointer,spaceId:_.getSpaceId()}};c().applyOperation({store:t,transaction:e,operation:a().N4.putModuleAfter({pointer:t.pointer,area:"page_layout_schema",module:g,afterId:void 0})})},canUndo:!0,userAction:"viewsModuleActions.switchFromSimpletoTabbedLayout"}))}}}]);