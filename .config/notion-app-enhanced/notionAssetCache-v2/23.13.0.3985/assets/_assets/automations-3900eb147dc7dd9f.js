"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[2411,5834,34208,47381,47536,79665,97101],{3867:(e,t,o)=>{o.d(t,{cI:()=>M,mk:()=>k,w$:()=>A});o(898992),o(354520),o(581454);var n=o(296540),i=()=>o(56366),a=()=>o(401497),r=()=>o(791089),l=()=>o(974967),s=()=>o(959013),c=()=>o(496603),u=()=>o(534177),d=()=>o(284371),p=()=>o(425497),m=()=>o(399762),g=()=>o(881690),y=()=>o(496401),h=()=>o(214973),f=()=>o(741310),v=()=>o(929531),x=()=>o(529135),S=()=>o(16707),b=o(474848);function A(e){const{actionMenu:t,buttonPopupStore:o,disabled:r,onClick:c,propertySchema:u,value:p}=e,m=(0,s().tz)(),g=(0,a().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...d().RC,fontWeight:d().Wy.medium}})),[]),y=(0,i().K8)((()=>k({intl:m,propertySchema:u,styles:g,value:p})),[m,u,g,p]),h=(0,i().K8)((()=>M({intl:m,propertySchema:u,value:p})),[m,u,p]),x=(0,n.useCallback)((e=>(0,b.jsx)(v().aX,{...e,actionMenu:t,buttonPopupStore:o,disabled:r,icon:l().n,onClick:c,children:(0,b.jsx)("div",{style:g.content,children:y})})),[t,o,r,c,g.content,y]);return(0,b.jsx)(f().P,{renderOrigin:x,title:h})}function C(e,t){if(!e)return[];let o=(0,r().fromSimpleFormulaArrayValue)(e).filter((e=>(0,c().Kg)(e)));return"select"===t.type&&(o=o.slice(0,1)),o}function k(e){const{intl:t,limit:o,operator:n,propertySchema:i,styles:a,tokenFormat:r,value:l}=e,c=(0,p().Ug)(r),d=(0,b.jsx)("span",{style:a.propertyName,children:i.name});if("formula"===(null==l?void 0:l.type))return(0,b.jsx)(s().sA,{...h()._M({propertyName:d,propertyValue:(0,b.jsx)(S().g,{returnType:{type:"text"}})})});const y=h().kN({limit:o,propertySchema:i,optionValues:C(null==l?void 0:l.value,i)}).map((e=>"deleted"===e.type?(0,b.jsx)(x().A,{tokenFormat:c},`missing_option_value_${e.value}`):"option"===e.type?(0,b.jsx)(m().O,{color:e.value.color,format:c,isSingle:!0,showRemoveButton:!1,value:e.value.value},e.value.id):"truncation"===e.type?(0,b.jsx)(g().A,{format:c,isRound:!0,isSingle:!0,showRemoveButton:!1,value:e.value},"More tokens"):void(0,u().HB)(e)));return"replace"===n||"append"===n||"remove"===n||"toggle"===n?(0,b.jsx)(s().sA,{...h().f4({...h().f_({elements:y,intl:t}),operator:n,propertyName:d})}):0===y.length?(0,b.jsx)(s().sA,{...h().NW({propertyName:d})}):(0,b.jsx)(s().sA,{...h()._M({propertyName:d,propertyValue:y[0]})})}function M(e){const{intl:t,limit:o,propertySchema:n,value:i,operator:a}=e,r=n.name;if("formula"===(null==i?void 0:i.type))return(0,b.jsx)(s().sA,{...h()._M({propertyName:r,propertyValue:(0,b.jsx)(S().L,{})})});const l=h().kN({limit:o,propertySchema:n,optionValues:C(null==i?void 0:i.value,n)}).map((e=>"deleted"===e.type?h().iy(t):"option"===e.type?e.value.value:"truncation"===e.type?e.value:void(0,u().HB)(e)));return"replace"===a||"append"===a||"remove"===a||"toggle"===a?(0,b.jsx)(s().sA,{...h().f4({propertyName:r,propertyValue:(0,y().d)(t.formatList(l,{style:"long",type:"conjunction"})),operator:a})}):0===l.length?(0,b.jsx)(s().sA,{...h().NW({propertyName:r})}):(0,b.jsx)(s().sA,{...h()._M({propertyName:r,propertyValue:l[0]})})}},6731:(e,t,o)=>{o.d(t,{D:()=>u});o(898992),o(803949);var n=o(296540),i=()=>o(56366),a=()=>o(476158),r=()=>o(388821),l=()=>o(751156),s=()=>o(841696),c=()=>o(765957);function u(e){let{unpersistedInMemoryRecordCache:t}=e;const o=(0,i().K8)((()=>{var e;return null===(e=c().default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),u=(0,n.useCallback)((e=>{let{perform:n}=e;const i=new(s().Z)({deadlockTimeoutMs:l().DEADLOCK_WARNING_TIMEOUT_MS}),c=n(i),u=r().RecordMap.create();i.stores.forEach((e=>{const t=e.getRecordModel(e.pointer);t&&u.addModel(t)})),(0,a().applyOperationsToRecordMap)({operations:i.operations,recordMap:u,updateOnly:!1});for(const a of u){const{model:e,pointer:n}=a;t.setModelAndRole({pointer:n,userId:o},e,"editor")}return t.emitAll(),{performResult:c,serverCommitResult:Promise.resolve(void 0),transactionId:i.id}}),[t,o]);return(0,n.useMemo)((()=>({createAndCommit:u})),[u])}},12193:(e,t,o)=>{o.r(t),o.d(t,{globeIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.26 15.25",svg:(0,o(474848).jsx)("path",{d:"M2.375 10a7.625 7.625 0 1 1 15.25 0 7.625 7.625 0 0 1-15.25 0m3.123-4.514c.55.252 1.21.463 1.953.612q.135-.585.308-1.086a6.6 6.6 0 0 1 .512-1.15 6.4 6.4 0 0 0-2.773 1.624m-.814.994a6.34 6.34 0 0 0-1.029 2.895h3.396c.022-.715.081-1.403.173-2.048-.962-.191-1.827-.48-2.54-.847m-1.029 4.145a6.34 6.34 0 0 0 1.03 2.895c.712-.367 1.577-.656 2.54-.848a19 19 0 0 1-.174-2.047zm4.647 0c.021.657.076 1.283.158 1.862a15 15 0 0 1 3.08 0c.082-.58.137-1.205.158-1.862zm4.647 0a19 19 0 0 1-.173 2.048c.845.169 1.615.412 2.274.717a.6.6 0 0 1 .23.182 6.34 6.34 0 0 0 1.065-2.947zm3.396-1.25a6.34 6.34 0 0 0-1.03-2.895c-.712.367-1.577.656-2.54.847.093.645.152 1.333.174 2.048zm-4.647 0a17 17 0 0 0-.158-1.862 15 15 0 0 1-3.08 0c-.082.58-.137 1.205-.158 1.862zm-6.2 5.139a6.4 6.4 0 0 0 2.773 1.624 6.6 6.6 0 0 1-.512-1.15 11 11 0 0 1-.308-1.086 9 9 0 0 0-1.953.612m9.004 0a9 9 0 0 0-1.953-.611q-.135.584-.308 1.085a6.6 6.6 0 0 1-.512 1.15 6.4 6.4 0 0 0 2.773-1.624m-3.443.067q.136-.395.249-.86a13.7 13.7 0 0 0-2.615-.001q.111.466.248.861c.198.575.42.995.635 1.259.22.269.366.302.424.302s.205-.033.424-.302c.215-.264.437-.684.635-1.259m3.443-9.095a6.4 6.4 0 0 0-2.773-1.624c.196.337.366.726.512 1.15q.173.501.308 1.086a9 9 0 0 0 1.953-.612M10 6.342q.676-.001 1.308-.062a9 9 0 0 0-.249-.861c-.198-.575-.42-.995-.635-1.259-.22-.269-.366-.302-.424-.302s-.204.033-.424.302c-.215.264-.437.684-.635 1.259q-.136.395-.248.861.631.061 1.307.062"})},i=(0,o(340498).wt)("globe",n)},18530:(e,t,o)=>{o.d(t,{V:()=>a});var n=()=>o(762433),i=()=>o(640653);function a(e){const{spaceStore:t,billingData:o,isMmOrEnterprise:a}=e;if((0,n().N8)(null==o?void 0:o.subscription))return"sales_assisted";return t&&a&&!(0,i().hT)(t)?"sales_eligible":"self_serve"}},27356:(e,t,o)=>{o.r(t),o.d(t,{UISpacePermissionGroupToken:()=>h});var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(784892),s=()=>o(959013),c=()=>o(284371),u=()=>o(780054),d=()=>o(698449),p=()=>o(630116),m=()=>o(848401),g=()=>o(580648),y=o(474848);function h(e){const{groupPointer:t,parentStore:o,format:h}=e,f=(0,a().K8)((()=>p().Cv.createChildStore(o,t).getModel()),[o,t]),v=(0,a().K8)((()=>null==f?void 0:f.getName()),[f]),x=(0,i().Y0)(),{outerStyle:S,avatarWrapStyle:b}=(0,r().IS)((e=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0},avatarWrapStyle:{width:"none",minHeight:"none",marginRight:6},badgeStyle:{borderRadius:4,background:e.legacyDefaultSelectColor,fontSize:u().A.isMobile?11:9,lineHeight:x.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em"}})),[x]),A=(0,s().tz)(),C=(0,n.useCallback)((()=>f?h===l().NY.Inline?(0,y.jsx)(g().o,{group:f}):(0,y.jsxs)("div",{style:S,children:[(0,y.jsx)("div",{style:b,children:(0,y.jsx)(g().o,{group:f})}),(0,y.jsx)("div",{style:{...c().RC},children:(0,d().Pf)({intl:A,groupName:v})})]}):null),[b,h,f,v,A,S]);return f?(0,y.jsx)(m().Ay,{...e,style:{margin:0},renderAvatar:C}):null}},31902:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(959013),i=o(474848);const a=function(e){let{collectionViewName:t,collectionViewType:a}=e;return t?(0,i.jsx)(o(288722).A,{children:t}):"page"===a?(0,i.jsx)(n().sA,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,i.jsx)(n().sA,{...o(403905).X[a]})}},35091:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const i=function(e){let{switcherProps:t,...i}=e;return(0,n.jsx)(o(497222).A,{right:(0,n.jsx)(o(946548).A,{onClick:i.onClick,disabled:i.disabled,...t}),...i})}},48278:(e,t,o)=>{o.r(t),o.d(t,{AutomationWorkflowEditor:()=>la,AutomationWorkflowEditorActionSection:()=>ta,ButtonBlockUrlPreviewPopup:()=>fa,PlacedButtonBlockEditor:()=>ca,automationActions:()=>i(),automationErrorHelpers:()=>ae(),automationExecutionActions:()=>n});var n={};o.r(n),o.d(n,{executeClientAutomation:()=>ie});var i=()=>o(324587),a=(o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(823215),o(354520),o(581454),()=>o(81768)),r=()=>o(496603),l=()=>o(973647),s=()=>o(534177),c=()=>o(322867),u=()=>o(648651),d=()=>o(103966);const p=(0,c().kB)((async function(e){const{context:t,executeAutomationActionFn:o}=e,{actionModels:n,automationModel:i,contextType:a,runtimeStats:p}=t;let g=t.values;const y=performance.now();let h,f={value:{success:!0}};if("button_block"===a||"button_property"===a){if(!i.isButtonType())return{error:new(c().zK)({message:`Automation trigger (${i.getTriggerType()}) does not match context type (${a}).`})};const e=i.getTrigger();h=(0,d().Z)(i.getTriggerType()).execute(t,e)}else if("event"===a){if(!i.isEventType())return{error:new(c().zK)({message:`Automation trigger (${i.getTriggerType()}) does not match context type (${a}).`})};const e=i.getTrigger();h=(0,d().Z)(i.getTriggerType()).execute(t,e)}else if("recurrence"===a){if(!i.isRecurrenceType())return{error:new(c().zK)({message:`Automation trigger (${i.getTriggerType()}) does not match context type (${a}).`})};const e=i.getTrigger();h=(0,d().Z)(i.getTriggerType()).execute(t,e)}else(0,s().HB)(t);if(l().Q.isFail(h))return h;g=g.concat((0,r().o8)(h.value.values));const v=o??m;for(const r of n){var x;const e=await v({action:r,values:g,executionContext:t}),o=null==p||null===(x=p.actionStats)||void 0===x||null===(x=x[r.id])||void 0===x?void 0:x.executionDurationMs;if((0,s().O9)(o)&&o>7e3&&t.executeEffectMap.logMessage({from:"executeAutomation",level:"warning",type:"longRunningAutomationAction",data:{durationMs:o,automationId:i.id,actionId:r.id,actionType:r.getType()}}),l().Q.isFail(e)){f=e;break}if(g=g.concat(e.value.values),e.value.stopExecution)break}const S=await t.executeEffectMap.updateLastRunTimesForObservability({automationModel:t.automationModel,executeResult:f});l().Q.isFail(S)&&(f=S);const b=Math.trunc(performance.now()-y);p&&(p.executionStartTime=y,p.executionDurationMs=b,p.executionSuccess=l().Q.isSuccess(f),u().hs.aggregate(p));return f}),(e=>e.context.automationModel.id));async function m(e){const{action:t,values:o,executionContext:n}=e,i=(0,a().getActionRegistryItem)(t.getType());return i.requiresPriorTransactionsCommitted&&await n.executeEffectMap.waitForTransactionsCommitted(),await i.execute({...n,values:o},t)}var g=()=>o(247331),y=()=>o(919709),h=()=>o(352271);var f=()=>o(502856),v=()=>o(857639),x=()=>o(416504),S=()=>o(728272),b=()=>o(798880),A=()=>o(498212),C=()=>o(495262),k=()=>o(436572),M=()=>o(479788),j=()=>o(2220),T=()=>o(518736),I=()=>o(862292),w=()=>o(909470),P=()=>o(972435),_=()=>o(217429),B=()=>o(10984),R=()=>o(406792);const V={...u().hs,logNotionPerformance(e){const{automationStats:t,environment:o}=e;if((0,u().oh)(t)){var n;const e={metricName:"automation.client.execution_duration_ms",startTime:t.executionStartTime,endTime:t.executionStartTime+t.executionDurationMs};R().default.DO_NOT_USE_measureLegacy(e,{environment:o,data:{success:t.executionSuccess,has_formulas:((null===(n=t.formulaStats)||void 0===n?void 0:n.totalFormulas)??0)>0}})}for(const a of Object.values(t.actionStats))if((0,u().WV)(a)){var i;const e={metricName:"automation.client.action_execution_duration_ms",startTime:a.executionStartTime,endTime:a.executionStartTime+a.executionDurationMs};R().default.DO_NOT_USE_measureLegacy(e,{data:{automation_action_type:a.actionType,success:a.executionSuccess,has_formulas:((null===(i=a.formulaStats)||void 0===i?void 0:i.totalFormulas)??0)>0},environment:o})}}};var E=()=>o(66689),D=()=>o(959013);const F=(0,D().YK)({genericSuccessMessage:{id:"automations.buttonTrigger.genericSuccessMessage",defaultMessage:"Button automation ran successfully"},createdBlocks:{defaultMessage:"Created {numBlocksDuplicated, plural, one {1 block} other {{numBlocksDuplicated} blocks}} on page",id:"automations.buttonTrigger.createdBlocks"},createdSprintsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprints"},updatedSprintsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprints"},createdSprintsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprintsLowercase"},updatedSprintsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprintsLowercase"},createdTasksUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasks"},updatedTasksUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasks"},createdTasksLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasksLowercase"},updatedTasksLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasksLowercase"},createdProjectsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjects"},updatedProjectsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjects"},createdProjectsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjectsLowercase"},updatedProjectsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjectsLowercase"},createdPagesUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPages"},updatedPagesUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPages"},createdPagesLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPagesLowercase"},updatedPagesLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPagesLowercase"}}),O=["sprint","task","project","page"],L={[E().Tw]:"project",[E().dC]:"task",[E().yH]:"page",[E().TC]:"page",[E().av]:"sprint",[E().pW]:"page",[E().BF]:"page",[E().wZ]:"page",[E().CO]:"page",[E().SC]:"page",[E().Qk]:"page"};function K(e){const{typedAutomationExecutionSummary:t,numBlocksDuplicated:o,intl:n}=e,i=function(e){const{typedAutomationExecutionSummary:t,intl:o}=e,n=[];for(const a of O){const e=t[a];if(e){const{numPagesCreated:t,numPagesEdited:o}=e;t>0&&n.push({pageType:a,modificationType:"created",numPagesModified:t}),o>0&&n.push({pageType:a,modificationType:"updated",numPagesModified:o})}}const i=n.slice(0,N).map(((e,t)=>{let{pageType:n,modificationType:i,numPagesModified:a}=e;const r=W[n][i],l=0===t?r.start:r.append;return o.formatMessage(l,{numPagesModified:a})}));if(i.length>0)return o.formatList(i,{type:"conjunction",style:"long"})}({typedAutomationExecutionSummary:t,intl:n});return i||(o>0?n.formatMessage(F.createdBlocks,{numBlocksDuplicated:o}):n.formatMessage(F.genericSuccessMessage))}const N=3;const W={sprint:{created:{start:F.createdSprintsUppercase,append:F.createdSprintsLowercase},updated:{start:F.updatedSprintsUppercase,append:F.updatedSprintsLowercase}},task:{created:{start:F.createdTasksUppercase,append:F.createdTasksLowercase},updated:{start:F.updatedTasksUppercase,append:F.updatedTasksLowercase}},project:{created:{start:F.createdProjectsUppercase,append:F.createdProjectsLowercase},updated:{start:F.updatedProjectsUppercase,append:F.updatedProjectsLowercase}},page:{created:{start:F.createdPagesUppercase,append:F.createdPagesLowercase},updated:{start:F.updatedPagesUppercase,append:F.updatedPagesLowercase}}};var z=()=>o(179034),H=()=>o(630116);o(18107),o(967357);var U=()=>o(908006),Y=()=>o(584262),G=()=>o(134025),q=()=>o(763824),$=()=>o(449506),J=()=>o(246826),Q=()=>o(435009),Z=()=>o(778417),X=()=>o(751156),ee=()=>o(492414),te=()=>o(765957),oe=()=>o(387712);class ne{constructor(e){this.environment=void 0,this.clientContext=void 0,this.automationModel=void 0,this.numBlocksDuplicated=0,this.transactionServerCommitResults=[],this.saveTransactionInfos=[],this.undoCheckpointName=void 0,this.waitForTransactionsCommitted=async()=>{await Promise.all(this.transactionServerCommitResults),this.transactionServerCommitResults=[]},this.getCollectionSchema=async e=>{const t=await this.clientContext.parentRecordStore.loadRecordModel(e.pointer);return t?{value:{collectionSchema:t.getNormalizedSchema()}}:{error:new(c().WY)({actionId:e.actionId,pointer:e.pointer})}},this.logMessage=e=>{v().log(e)},this.incrementMetric=()=>{},this.queryCollection=async e=>{const t=await o(450859).mA(this.environment,{source:"automation",parentRecordStore:this.clientContext.parentRecordStore,collectionPointer:e.collection,filter:e.filter,sort:e.sort,limit:e.limit});return l().Q.isFail(t)?{error:new(c().rl)({actionId:e.actionId,type:t.error.type,message:t.error.message,cause:t.error})}:{value:{blockIds:t.value.blockIds}}},this.saveTransaction=e=>{const{info:t,operations:n}=e,i=[];if(this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.saveTransaction",environment:this.environment,perform:e=>{for(const t of n)if((0,o(439180).ph)(t)){const o=H().Bv.createChildStore(this.clientContext.parentRecordStore,t.pointer);X().applyCrdtTextOperation({store:o,operation:t,invertedOperation:void 0,transaction:e})}else if((0,G().$Y)(t)||(0,G().mP)(t)){const o=(0,H().Oo)(this.clientContext.parentRecordStore,t.pointer);X().applyOperation({store:o,operation:t,transaction:e})}else(0,s().HB)(t);i.push(e.id)}}),this.saveTransactionInfos.push(t),"create_page"===t.type)o(970330).v(this.environment,{type:"page",automation_id:this.automationModel.id,from:"button_automation",new_page_id:t.pageId,creating_block_id:t.pageId});else if("update_pages"===t.type){const{editedProperties:e,pageIds:n}=t;for(const t of n)for(const{id:n,type:i}of e)(0,o(810519).u)(this.environment,{block_id:t,property:n,property_type:i,from:"button_automation",automation_id:this.automationModel.id},!1)}else"publish_site"===t.type||(0,s().HB)(t);return Promise.resolve({value:{stats:{totalOperations:n.length,transactionIds:i}}})},this.navigateToPage=e=>{const t=te().default.state.mainEditorCurrentBlockStore;if(!t)return;const n=H().Bv.createChildStore(t,e.page),i="full_page"===e.openIn?(0,ee().Ay)({store:n,fullyQualified:!1,pageVisitSource:Y().y8.ButtonAutomation}):(0,ee().Ay)({store:t,peekViewBlockId:n.id,peekMode:(0,o(712505).getUrlParamFromPeekMode)(e.openIn),fullyQualified:!1,pageVisitSource:Y().y8.ButtonAutomation});Q().oo({environment:this.environment,url:i})},this.openUrl=e=>{Q().oo({environment:this.environment,url:e.url,openInNew:"tab"})},this.sendSlackNotification=async e=>{const{action:t,customMessage:o}=e;return(0,j().u)({environment:this.environment,event:{eventName:"button_automation_slack_action",eventProperties:{type:this.clientContext.type}}}),this.executeServerSideEffect({effect:"send_slack_notification",actionPointer:t.pointer,contextType:this.clientContext.type,args:{custom_message:o}})},this.duplicateBlockChildren=async e=>{if("button_block"!==this.clientContext.type)return{error:new(c().g7)({contextType:this.clientContext.type})};const t=this.clientContext.blockStore,n=t.getRecordStoreUIParent();if(!n)return{value:{}};const i={};let a,r=t;if("before"===e.insertionPoint)a=!0;else if("after"===e.insertionPoint)a=!1;else if("topOfPage"===e.insertionPoint){let e;if(a=!0,this.clientContext.pageStore?e=this.clientContext.pageStore:n&&n.isTable(z().ev)&&n.getAncestorRecordStoreAtRootPath()&&(e=n.getAncestorRecordStoreAtRootPath()),!e)return{error:new(c()._r)("invalid_record","Missing page store in client context for top of page insertion")};r=e.getContentStores().at(0)||t}else if("bottomOfPage"===e.insertionPoint){let e;if(a=!1,this.clientContext.pageStore?e=this.clientContext.pageStore:n&&n.isTable(z().ev)&&n.getAncestorRecordStoreAtRootPath()&&(e=n.getAncestorRecordStoreAtRootPath()),!e)return{error:new(c()._r)("invalid_record","Missing page store in client context for bottom of page insertion")};r=e.getContentStores().at(-1)||t}else(0,s().HB)(e.insertionPoint);const l=H().Bv.createChildStore(n,e.blockPointer);await l.load();const u=l.getContentStores();a||u.reverse();const d=o(695625).T.findSelectableFromStore(r),p=[],m=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.duplicateBlockChildren",environment:this.environment,perform:e=>{const t=u.map((t=>{const{blockStores:n,onComplete:i}=o(568131).duplicateBlock({environment:this.environment,stores:[t],transaction:e,targetSpaceId:(0,o(161479).e)(t.pointer.spaceId),preferDuplicateLocation:"local",analyticsFrom:"button_automation",options:{addCopyName:!1,allowRedundancy:!0,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!0}}),r=n[0];return d&&(a?d.props.onInsertAbove&&p.push(d.props.onInsertAbove({insertStores:[r],transaction:e})[0]):d.props.onInsertBelow&&p.push(d.props.onInsertBelow({insertStores:[r],transaction:e})[0])),{copy:r,onComplete:i}}));return V.aggregateActionStats(i,{transactionIds:[e.id]}),t}}).performResult;return a||p.reverse(),Z().td({environment:this.environment,stores:p}),await q().lX(m,10,(e=>e.onComplete)),U().default.afterNextFlush((()=>{for(const e of p){if(o(547392).Il({environment:this.environment,isAtStartOfLine:!1,store:e}))break}})),this.numBlocksDuplicated+=p.length,V.aggregateActionStats(i,{blocksCreated:this.getNumBlocksDuplicated()}),{value:{stats:i}}},this.displayModal=async e=>{oe().A.setState({open:!0,format:e.format,recordStore:this.clientContext.parentRecordStore}),await oe().A.waitUntil((()=>!oe().A.state.open));const t=oe().A.state;let o;return t.open||(o=t.result),o=o??"continue",{value:{result:o}}},this.initializeTemplateInDatabase=async e=>{const t=this.clientContext.parentRecordStore,n={},i=H().Bv.createChildStore(t,{table:z().ev,id:e.templateId});await i.load();const a=H().md.createChildStore(t,e.collection),r=(0,o(594794).Z1)({environment:this.environment,table:z().ev,spaceId:a.pointer.spaceId}),{performResult:l}=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.initializeTemplateInDatabase",environment:this.environment,perform:l=>{const s=J().Wv({environment:this.environment,transaction:l,inMemoryRecordCache:t.inMemoryRecordCache,type:o(700500).xd.page,id:r});return o(44729).X$({parentStore:a,childStore:s,transaction:l}),o(557281).n5({environment:this.environment,store:s,transaction:l,templateStore:i,title:"template",isCreateIn:!1,isKeyboard:!1,from:"automation_actions"}),o(586481).L({environment:this.environment,store:s,properties:e.propertyUpdates,transaction:l}),V.aggregateActionStats(n,{transactionIds:[l.id]}),s}});return this.saveTransactionInfos.push({type:"create_page",pageId:r,collection:e.collection}),await l.load(),l.isDefined()?{value:{pageId:r,pageModel:l.getModel(),stats:n}}:{error:new(c().WY)({actionId:e.actionId,pointer:l.pointer})}},this.sendInAppNotification=async e=>{const{actionPointer:t,targets:o,message:n,pagePointer:i}=e;return this.executeServerSideEffect({effect:"send_in_app_notification",actionPointer:t,contextType:this.clientContext.type,args:{targets:o,message:n,pagePointer:i}})},this.sendGmailNotification=async e=>{var t;const{action:o,to:n,cc:i,bcc:a,replyTo:r,fromName:l,subject:s,body:c}=e,u="button_block"===this.clientContext.type||"button_property"===this.clientContext.type?null===(t=this.clientContext.pageStore)||void 0===t?void 0:t.pointer:void 0;return this.executeServerSideEffect({effect:"send_gmail_notification",actionPointer:o.pointer,contextType:this.clientContext.type,args:{bcc:a,body:c,cc:i,fromName:l,pagePointer:u,replyTo:r,subject:s,to:n}})},this.updateLastRunTimesForObservability=async e=>{const{automationModel:t,executeResult:o}=e,n=this.clientContext.parentRecordStore,i=H().dn.createChildStore(n,t.pointer);return this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.updateLastRunTimesForObservability",environment:this.environment,skipUpdatingEditedMetadata:!0,perform:e=>{const t=Date.now();J().zv({data:{last_executed_time:t},store:i,transaction:e}),l().Q.isFail(o)&&J().zv({data:{last_failed_time:t},store:i,transaction:e})}}),Promise.resolve({value:void 0})},this.sendHttpRequest=async e=>{const{action:t,pagePointer:o,eventId:n}=e;return this.executeServerSideEffect({effect:"send_http_request",actionPointer:t.pointer,contextType:this.clientContext.type,args:{pagePointer:o,eventId:n}})},this.executeServerSideEffect=async e=>{const t=await $().callApi({eventName:"executeAutomationActionEffect",environment:this.environment,headers:{},data:e});return"failed"===t.type?{error:new(c().PD)({actionId:e.actionPointer.id,message:"Failure in execution of the executeAutomationActionEffect endpoint",cause:t.error})}:t.data},this.sleepForJitter=async e=>{await(0,q().wR)(e)},this.environment=e.environment,this.clientContext=e.clientContext,this.automationModel=e.automationModel,this.undoCheckpointName=`execute-client-automation-${o(206267).JW()}`}getNumBlocksDuplicated(){return this.numBlocksDuplicated}createAndCommitForEffect(e){const t=X().createAndCommit({...e,undoCheckpoint:this.undoCheckpointName,canUndo:!0});return this.transactionServerCommitResults.push(t.serverCommitResult),t}}async function ie(e){var t,o;const{clientContext:n,environment:r,onUndo:c}=e,u=await I().T.formulas.load(),d=await I().T.simpleFormulas.load();await n.automationStore.load();const m=n.automationStore.getModel();if(!m||!m.isButtonType()&&!m.isRecurrenceType())return;const R=m.spaceId,E=n.automationStore.getActionStores().map((e=>e.getModel())).filter(s().O9),D=m.getTriggerType(),F="button_block"===n.type?n.blockStore.id:"button_property"===n.type?null===(t=n.pageStore)||void 0===t?void 0:t.id:"recurrence"===n.type?void 0:(0,s().HB)(n),O=(0,B().AI)();(0,j().u)({environment:r,event:{eventName:"automation_triggered",eventProperties:{actions:E.map((e=>e.getType())),automation_id:m.id,block_id:F,context_type:n.type,space_id:R,subscription_tier:O,trigger:D}}});const N=new ne({automationModel:m,clientContext:n,environment:r}),W=(0,f().MC)({collectionFeatureGates:(0,w().i)(),experimentService:_().default,getRecordModel:n.parentRecordStore.getRecordModel,loadRecordModel:n.parentRecordStore.loadRecordModel}),U=_().default.getConfigKey("automation_settings","client_formula_timeout_ms"),Y=r.currentUser.id?{id:r.currentUser.id,table:b().oo}:void 0,G="recurrence"!==n.type?null===(o=n.pageStore)||void 0===o?void 0:o.getModel():void 0,q=[];if("recurrence"===n.type&&"completeSprint"===n.recurrence.type){const{values:e}=function(e){const{nextSprintDateRange:t,completeSprintActionType:o}=e;return{values:[{kind:g().FormulaContextValueKind.ContextValue,id:h().GF,value:{type:"date",value:t}},{kind:g().FormulaContextValueKind.ContextValue,id:h().uM,value:{type:"text",value:(0,y().x9d)(o)}}]}}({completeSprintActionType:n.recurrence.completeSprintActionType,nextSprintDateRange:n.recurrence.nextSprintDateRange});q.push(...e)}const $=V.create(m.pointer,"client"),J={author:Y,automationModel:m,actionModels:E,contextType:n.type,formulaVariableResolution:{executingUserPointer:Y,executingUserTimeZone:(0,x().P)(),thisPageBlockModel:G},values:q,executeEffectMap:N,executeContextualFormula:async(e,t)=>{if(!t)return{value:{type:"undefined"}};const o=Date.now()+U;return await u.executeFormulaAsync(t,{...e,depth:0,throwOnDownstreamParseFailures:!0,handleDataRequest:W,intl:n.intl,resultCache:new Map,regExpCache:new Map,userTimeZone:(0,x().P)(),visitedProperties:new Set,formulaTimeoutTimestampMs:o,experimentService:_().default,spaceId:R})},formulasModule:u,handleDataRequest:W,loadRecordModel:n.parentRecordStore.loadRecordModel,makeGetRecordModelFn:async e=>Promise.resolve(n.parentRecordStore.getRecordModel),userTimeZone:(0,x().P)(),intl:n.intl,depth:0,throwOnDownstreamParseFailures:!0,visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,eventTracker:(0,M().Q)(r),runtimeRecordPointerSet:new(S().d),runtimeStats:$,spaceIdCreator:await r.idCreator.getSpaceIdCreator(R),simpleFormulasModule:d,useCrdtDefault:(0,T().D8)(n.automationStore.getSpaceStore()),experimentService:_().default,collectionFeatureGates:(0,w().i)(),spaceId:R,eventId:(0,A().Ay)()},Q=await p({context:J});V.logNotionPerformance({automationStats:$,environment:r});const Z={automationContextType:n.type,automationId:m.id,automationRuntime:$,spaceId:R,userId:null==Y?void 0:Y.id};if(l().Q.isFail(Q)){const{error:e}=Q;0,v().log({actor:Y,data:Z,error:e,from:"automationActions",level:"error",type:"AutomationExecutionError"}),(0,j().u)({environment:r,event:{eventName:"automation_execution_fail",eventProperties:{automation_id:m.id,block_id:F,context_type:n.type,error_type:e.type,execution_duration_ms:$.executionDurationMs,subscription_tier:O,trigger:D}}});const t=function(e){if("query_collection_too_many_items"===e.type)return i().messages.errorQueryCollectionTooManyPages;if("record_pointer_in_trash"===e.type)return i().messages.errorRecordInTrash;return i().messages.genericErrorMessage}(e),o=P().A.formatMessage(t);k().D6({label:o})}else(0,j().u)({environment:r,event:{eventName:"automation_execution_success",eventProperties:{automation_id:m.id,block_id:F,context_type:n.type,execution_duration_ms:$.executionDurationMs,subscription_tier:O,trigger:D}}}),v().log({actor:Y,data:Z,from:"automationActions",level:"info",type:"AutomationExecutionSuccess"}),function(e){return!e.every((e=>!(0,a().getActionRegistryItem)(e.type).hasSideEffects))}(E)&&await async function(e){const{actionModels:t,environment:o,saveTransactionInfos:n,clientContext:i,undoCheckpointName:r,numBlocksDuplicated:l,onUndo:c}=e,u=function(e){const{saveTransactionInfos:t,parentRecordStore:o}=e,n={},i=new Set;for(const u of t)if("create_page"===u.type){var a,r;if(i.has(u.pageId))continue;const e=H().md.createChildStore(o,u.collection).getDatabaseType(),t=(e&&L[e])??"page",l=(null===(a=n[t])||void 0===a?void 0:a.numPagesEdited)??0,s=(null===(r=n[t])||void 0===r?void 0:r.numPagesCreated)??0;n[t]={numPagesCreated:s+1,numPagesEdited:l},i.add(u.pageId)}else if("update_pages"===u.type){var l,c;const e=H().md.createChildStore(o,u.collection).getDatabaseType(),t=(e&&L[e])??"page",i=(null===(l=n[t])||void 0===l?void 0:l.numPagesEdited)??0,a=(null===(c=n[t])||void 0===c?void 0:c.numPagesCreated)??0;n[t]={numPagesCreated:a,numPagesEdited:i+u.pageIds.length}}else"publish_site"===u.type?n.page={numPagesCreated:0,numPagesEdited:1}:(0,s().HB)(u);return n}({saveTransactionInfos:n,parentRecordStore:i.parentRecordStore}),d=K({typedAutomationExecutionSummary:u,numBlocksDuplicated:l,intl:i.intl}),p=await async function(e){const{saveTransactionInfos:t,clientContext:o}=e;let n;for(const r of t.slice().reverse()){if("create_page"===r.type){var i;n=H().Bv.createChildStore(o.parentRecordStore,{table:z().ev,id:r.pageId,spaceId:null===(i=r.collection)||void 0===i?void 0:i.spaceId});break}if("update_pages"===r.type){if(1===r.pageIds.length){var a;n=H().Bv.createChildStore(o.parentRecordStore,{table:z().ev,id:r.pageIds[0],spaceId:null===(a=r.collection)||void 0===a?void 0:a.spaceId})}else{const e=H().md.createChildStore(o.parentRecordStore,r.collection);await e.load();const t=e.getParentBlockStore();if(!t)continue;n=t}break}if("publish_site"===r.type)break;(0,s().HB)(r)}return n}({saveTransactionInfos:n,clientContext:i}),m=function(e){let t;for(const o of e){const e=(0,a().getActionRegistryItem)(o.type);if(!1===e.invertible)return!1;!0===e.invertible&&(t=!0)}return t}(t),g=!0===m&&C().xy(r)?()=>{C().JM({environment:o,namedRevisionId:r}),k().N2(),c&&c(r)}:void 0;k().AC({blockToOpenStore:p,item:{label:d},performUndo:g})}({actionModels:E,clientContext:n,environment:r,numBlocksDuplicated:N.getNumBlocksDuplicated(),onUndo:c,saveTransactionInfos:N.saveTransactionInfos,undoCheckpointName:N.undoCheckpointName})}var ae=()=>o(653417),re=o(296540),le=()=>o(402014),se=()=>o(484714),ce=()=>o(56366),ue=()=>o(401497),de=()=>o(284371),pe=()=>o(725614),me=()=>o(155004),ge=()=>o(623580),ye=()=>o(897119),he=()=>o(204063),fe=()=>o(2143),ve=()=>o(997583),xe=()=>o(756279),Se=()=>o(329304),be=()=>o(546461),Ae=()=>o(911724),Ce=()=>o(276936),ke=()=>o(293096),Me=()=>o(559419),je=()=>o(656134),Te=()=>o(840094),Ie=()=>o(633904),we=()=>o(284489),Pe=()=>o(774256),_e=()=>o(642054),Be=()=>o(383594),Re=()=>o(285790),Ve=()=>o(187820),Ee=()=>o(859428),De=()=>o(553965),Fe=()=>o(486666),Oe=o(474848);const Le=(0,D().YK)({icon:{defaultMessage:"Icon",id:"buttonBlock.button.iconHeading"},addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"}});function Ke(e){const{disabled:t,currentIcon:o,handleIconChange:n,store:i}=e,a=(0,se().v3)(),r=(0,D().tz)(),l=(0,re.useCallback)((e=>{Be().W(a,{originRect:e.currentTarget.getBoundingClientRect(),originGap:4,popupWidth:Fe().jv,popupHeight:Fe().GF,isSmallWidth:!1,title:r.formatMessage(Le.icon),currentTab:"icon",tabs:[{type:"icon",onChange:e=>{n(e),Be().I()}},{type:"emoji",onChange:(e,t)=>{n(e),Be().I()}}],onDelete:o?()=>{n(void 0),Be().I()}:void 0})}),[a,n,r,o]),s=(0,ue().IS)((e=>({iconButton:{background:"transparent",boxShadow:e.shadowXS,width:28,height:28},icon:{width:16,height:16}})),[]),c=e=>(0,Oe.jsx)(Re().A,{ariaLabel:r.formatMessage(Le.addIconButtonAriaLabel),style:s.iconButton,iconStyle:s.icon,hasBackground:!0,disabled:t,showShadow:!0,icon:e=>o?(0,Oe.jsx)(Ve().B6,{disabled:!0,isEmptyPage:!1,size:24,icon:{icon:o,pointer:i.pointer},style:e}):(0,_e().A)(e),...(0,De().A)(e??{},{onClick:l})});return o?c():(0,Oe.jsx)(Ee().A,{renderTooltip:()=>(0,Oe.jsx)(D().sA,{defaultMessage:"Add an icon",id:"buttonBlock.button.addIcon"}),delayThreshold:300,render:c})}var Ne=()=>o(805751),We=()=>o(79043),ze=()=>o(24157),He=()=>o(366360);function Ue(e){const{value:t,onChange:o,wrapStyle:n,onBlur:i,...a}=e,[r,l]=(0,re.useState)(!1),s=(0,se().v3)(),c=(0,We().A)(!0),u=(0,re.useCallback)((()=>{l(!1),null==i||i()}),[i]),d=(0,re.useCallback)((e=>o(e.currentTarget.value)),[o]),p=(0,re.useCallback)((()=>{"empty"!==ze().default.state.mode&&Z().IU({environment:s}),l(!0)}),[s]);return(0,Oe.jsx)(Ne().A,{debugName:"AutomationPlainTextInput",capture:r,children:(0,Oe.jsx)("div",{...c,style:n,children:(0,Oe.jsx)(ge().A,{...a,onBlur:u,onChange:d,onFocus:p,value:t})})})}function Ye(e){const{onChange:t,store:o,...n}=e,{maybePersistedTransactionActions:i}=(0,He().b)(),a=(0,ce().K8)((()=>o.getValue()??""),[o]),r=(0,re.useCallback)((e=>{i.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:t=>{J().KY({store:o,transaction:t,value:e})}}),null==t||t(e)}),[i,t,o]);return(0,Oe.jsx)(Ue,{value:a,onChange:r,...n})}var Ge=()=>o(903854),qe=()=>o(826352),$e=()=>o(71634),Je=(o(803949),()=>o(617668)),Qe=()=>o(863330),Ze=()=>o(340498),Xe=()=>o(813297),et=()=>o(760217),tt=()=>o(406699),ot=()=>o(439264),nt=()=>o(8980),it=()=>o(645873),at=()=>o(463830),rt=()=>o(170253),lt=()=>o(76190),st=()=>o(283088),ct=()=>o(383574),ut=()=>o(542339),dt=()=>o(895876),pt=()=>o(252463);function mt(e){return!e.pathIsDead()&&e.isDefined()}function gt(e){if(!(0,s().O9)(e))return[];return e.getTemplatePageStores().filter((e=>mt(e)))}var yt=()=>o(475679),ht=()=>o(310109),ft=()=>o(784892),vt=()=>o(16006),xt=()=>o(684125),St=()=>o(133518),bt=()=>o(548526),At=()=>o(194373);function Ct(e){const{actionStore:t,currentValue:o,onChange:n,disabled:i,errorMessage:a,errorIcon:r,skipVariables:l}=e,c=(0,se().v3)(),{typecheckResult:u}=(0,be().YC)(),d=(0,ce().uB)(void 0,at().A),p=t.id,m=(0,St().F)({actionId:p}),g=(0,ce().K8)((()=>o&&"collection"===o.type?H().md.createChildStore(t,o.collection):void 0),[o,t]),y=(0,ce().K8)((()=>{if(p&&u&&o&&"variable"===o.type)return(0,ht().getContextValueForActionById)(u,p,o.id)}),[o,u,p]),h=(0,re.useCallback)((e=>{"collection"!==e.type&&"variable"!==e.type||(n(e),d.reset(),(0,pt().CM)(((o,n,i)=>{const a=(0,pt().zc)({automationActionStore:t,formulaAnalyticsModule:n,formulasModule:o,simpleFormulasModule:i});(0,s().O9)(a)&&(0,j().u)({environment:c,event:{eventName:"automation_target_pick",eventProperties:{automation_action:a,automation_id:t.getParentId(),target_type:e.type}}})})))}),[n,d,t,c]),f=(0,re.useCallback)((()=>d.reset()),[d]),v=(0,je().j)(),x=Boolean(g||y);return(0,Oe.jsx)(tt().Ay,{buttonPopupStore:d,popupType:v,alignmentToOrigin:tt().yP.Center,placementToOrigin:tt().sx.Bottom,originGap:0,disabled:i,renderOrigin:e=>(0,Oe.jsx)(bt().x,{...e,disabled:i,isCompact:!0,isError:Boolean(a),hasActionRequired:!x,errorIcon:r,dropdownButtonType:"dropdown",children:g?(0,Oe.jsx)(vt().A,{store:g}):y?(0,Oe.jsx)(xt().F,{format:ft().NY.Medium,isSingle:!0,value:y,style:{background:"transparent",color:"unset",margin:"-1.5px 0",padding:0}}):(0,Oe.jsx)(D().sA,{id:"automations.databasePicker.buttonPlaceholder",defaultMessage:"Select database"})}),render:e=>(0,Oe.jsx)(At()._,{formulaTypecheckContextValues:m,onChange:h,onClose:f,parentRecordStore:t,selectedTarget:o,skipPages:!0,skipVariables:l})})}var kt=()=>o(763996),Mt=()=>o(928600),jt=()=>o(939740),Tt=()=>o(89924),It=()=>o(781697);function wt(e){const{collectionStore:t,currentTemplateId:o,onChange:n,disabled:i,errorMessage:a}=e,r=(0,se().v3)(),{device:l}=r,s=(0,ce().K8)((()=>{if(!t)return;if(o){return H().Bv.createChildStore(t,{id:o,spaceId:t.getSpaceId(),table:z().ev})}const e=t.getDefaultTemplatePageStore();return e&&!e.pathIsDead()?e:void 0}),[t,o]),c=(0,je().j)(),u=(0,ce().K8)((()=>gt(t)),[t]),d=Boolean(o);return(0,Oe.jsx)(tt().Ay,{popupType:c,alignmentToOrigin:tt().yP.Center,placementToOrigin:tt().sx.Bottom,originGap:0,disabled:i,renderOrigin:e=>(0,Oe.jsx)(bt().x,{...e,disabled:i,isCompact:!0,isError:Boolean(a),style:{minWidth:50},dropdownButtonType:"dropdown",children:s&&(d||mt(s))?(0,Oe.jsx)(vt().A,{store:s}):(0,Oe.jsx)(D().sA,{id:"automations.templatePicker.buttonPlaceholder",defaultMessage:"Empty"})}),render:e=>{const o=(0,It().v)({device:l,width:280});return(0,Oe.jsx)(Mt().A,{...o,children:t&&(0,Oe.jsx)(Pt,{collectionStore:t,templatePageStores:u,parent:e,onChange:n})})}})}function Pt(e){const{collectionStore:t,templatePageStores:o,parent:n,onChange:i}=e,a=(0,se().v3)(),{device:l}=a,s=(0,ce().K8)((()=>t.getDefaultTemplatePageStore()),[t]),c=o.map((e=>{const o={key:e.id,render:o=>(0,re.createElement)(kt().K,{...o,key:e.id,isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:e,isMobile:l.isMobile,locked:!0,isDefault:s===e,onCancelClick:r().lQ,draggable:!1}),action:t=>{i(e.id),n.close()}};return o})),u={key:"empty",render:e=>(0,re.createElement)(kt().K,{...e,key:"empty",isOverlay:!0,collectionStore:t,canConfigureCollection:!1,templateStore:void 0,isMobile:l.isMobile,locked:!0,onCancelClick:r().lQ,draggable:!1}),action:e=>{i(void 0),n.close()}};return(0,Oe.jsx)(jt().Ay,{type:jt().Oh.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,Oe.jsx)(Tt().A,{...e,title:(0,Oe.jsx)(D().sA,{id:"automations.templatePicker.menuHeader",defaultMessage:"Select template"})}),items:r().oE([...c,s?void 0:u])}]})}var _t=()=>o(929531);function Bt(e){const{actionStore:t,disabled:o,errorMessage:n,onChange:i,value:a,errorIcon:r}=e,l=(0,ce().K8)((()=>{let e;if("collection"===(null==a?void 0:a.type)){const o=t.getRecordModel(a.collection);e=null==o?void 0:o.getDatabaseType()}return(0,dt().$O)(e)}),[t,a]);return(0,Oe.jsx)(D().sA,{defaultMessage:"Add {itemType} to{collectionPicker}",id:"automations.CreatePageActionV2.header.title",values:{collectionPicker:(0,Oe.jsx)(Ct,{actionStore:t,currentValue:a,disabled:o,errorMessage:n,errorIcon:r,onChange:i,skipVariables:!0}),itemType:l}})}function Rt(e){const{collectionStore:t,disabled:o,errorMessage:n,onChange:i,value:a}=e;return(0,Oe.jsx)(D().sA,{defaultMessage:"as{collectionTemplatePicker}",id:"automations.CreatePageActionV2.header.template",values:{collectionTemplatePicker:(0,Oe.jsx)(wt,{collectionStore:t,currentTemplateId:a,disabled:o,errorMessage:n,onChange:i})}})}var Vt=()=>o(84817),Et=()=>o(199378),Dt=()=>o(183558),Ft=()=>o(770586);function Ot(e,t){const o=e.getConfigStore().getKeyStore("values"),n=o.getValue(),i=null==n?void 0:n[t];return(0,s().O9)(i)?{valueConfig:i,valueStore:o}:{valueConfig:void 0,valueStore:void 0}}var Lt=()=>o(493823);function Kt(e){const{disabled:t,onClick:o}=e,n=(0,ue().IS)((e=>({button:{color:e.text.secondary},children:{...de().RC,flex:"1 1 auto"}})),[]);return(0,Oe.jsx)(Lt().p,{disabled:t,disabledFeedback:t,onClick:o,shouldShrink:!0,style:n.button,children:(0,Oe.jsx)("div",{style:n.children,children:(0,Oe.jsx)(D().sA,{defaultMessage:"Define another variableâ€¦",id:"automations.DefineVariablesAction.addVariableButton.label"})})})}var Nt=()=>o(791089),Wt=()=>o(521732),zt=()=>o(419830),Ht=()=>o(858163),Ut=()=>o(938818),Yt=()=>o(546806),Gt=()=>o(962730),qt=()=>o(852507),$t=()=>o(708685),Jt=()=>o(145076),Qt=()=>o(764781),Zt=()=>o(105819),Xt=()=>o(585639),eo=()=>o(236262),to=()=>o(736767),oo=()=>o(419357),no=()=>o(693954);function io(){const e=(0,ue().IS)((e=>({warningIcon:{fill:e.icon.uiRedPrimary,height:14,width:15}})),[]);return(0,no().Q)(e.warningIcon)}function ao(){}function ro(e){const{analyzedFormulaOutput:t,onClearClick:o,onDeleteClick:n,onDuplicateClick:i,onEditFormulaClick:a,onEditTextClick:r,onVariableNameChange:l,onVariableNameSubmit:c,variableName:u}=e,{parseErrors:d,type:p,typeErrors:m}=t??{},g=(0,D().tz)(),y=(0,re.useMemo)((()=>(0,Ut().L)(g,d??[],m??[])),[g,d,m]),h=(0,s().O9)(y),f=(0,It().e)({width:265}),v=(0,ue().IS)((e=>({formulaErrorCaptionMenuItem:{marginBlockStart:0,paddingBlockStart:0,paddingInline:4},formulaReturnTypeDesktopIcon:{marginBlockStart:4,marginInlineStart:12},formulaReturnTypeCaptionMenuItem:{marginBlock:0,paddingInline:4},formulaErrorCaption:{...h&&{color:e.text.uiRedPrimary}},nameInputMenuItem:{marginBlock:6}})),[h]),x=(0,re.useMemo)((()=>p?(0,$t().getHumanReadableType)(p):Jt().qY.unknown),[p]),S=(0,se().v3)();(0,qt().l)((()=>{pe().clear({environment:S})}));const b=[];if((0,s().O9)(u)){const e=(0,s().O9)(l);b.push({items:[{action:()=>null,key:"variable-name-input-item",render:t=>(0,Oe.jsx)(oo().Ay,{...t,disabled:!e,focus:!0,onChange:l??ao,onSubmit:c,placeholder:g.formatMessage(Et().xC),style:v.nameInputMenuItem,value:u})}],key:"variable-name-input-section",render:e=>(0,Oe.jsx)(Tt().A,{...e,enableActionSheetTitle:!0})})}if((0,s().O9)(r)||(0,s().O9)(a)||(0,s().O9)(i)){const e=[];(0,s().O9)(r)&&e.push({action:r,key:"variable-name-manage-edit-text",render:e=>(0,Oe.jsx)(et().A,{...e,icon:(0,Oe.jsx)(nt().I,{icon:Zt().pencilLineIcon}),title:(0,Oe.jsx)(D().sA,{defaultMessage:"Edit as text",id:"EditVariableMenu.editSimpleFormulaButtonMenuItem.label"})})}),(0,s().O9)(a)&&e.push({action:a,key:"variable-name-manage-edit-formula",render:e=>(0,Oe.jsx)(et().A,{...e,icon:(0,Oe.jsx)(nt().I,{icon:Xt().v}),title:(0,Oe.jsx)(D().sA,{defaultMessage:"Edit as formula",id:"EditVariableMenu.editFormulaButtonMenuItem.label"})})}),(0,s().O9)(i)&&e.push({action:i,key:"variable-name-manage-duplicate",render:e=>(0,Oe.jsx)(et().A,{...e,icon:(0,Oe.jsx)(nt().I,{icon:Qt().V}),title:(0,Oe.jsx)(D().sA,{defaultMessage:"Duplicate",id:"EditVariableMenu.duplicateFormulaButtonMenuItem.label"})})});const t=b.length>0;b.push({items:e,key:"variable-name-manage-actions",render:e=>(0,Oe.jsx)(Tt().A,{...e,enableActionSheetTitle:!0,topBorder:t})})}if((0,s().O9)(n)||(0,s().O9)(o)){const e=[];(0,s().O9)(n)&&e.push({action:n,key:"variable-name-destructive-delete",render:e=>(0,Oe.jsx)(et().A,{...e,icon:(0,Oe.jsx)(nt().I,{icon:eo().trashIcon}),title:(0,Oe.jsx)(D().sA,{defaultMessage:"Delete",id:"EditVariableMenu.deleteFormulaButtonMenuItem.label"})})}),(0,s().O9)(o)&&e.push({action:o,key:"variable-name-destructive-clear",render:e=>(0,Oe.jsx)(et().A,{...e,icon:(0,Oe.jsx)(nt().I,{icon:eo().trashIcon}),title:(0,Oe.jsx)(D().sA,{defaultMessage:"Clear variable",id:"EditVariableMenu.clearFormulaButtonMenuItem.label"})})});const t=b.length>0;b.push({items:e,key:"variable-name-destructive-actions",render:e=>(0,Oe.jsx)(Tt().A,{...e,enableActionSheetTitle:!0,topBorder:t})})}const A=b.length>0,C=[{action:()=>{},key:"variable-name-typecheck-return-type",render:e=>(0,Oe.jsx)(to().A,{...e,caption:(0,Oe.jsx)("span",{style:v.formulaErrorCaption,children:(0,Oe.jsx)(D().sA,{defaultMessage:"Type: {formulaType}",id:"EditVariableMenu.formulaReturnType.label",values:{formulaType:(0,Oe.jsx)(D().sA,{...x})}})}),desktopIconStyle:v.formulaReturnTypeDesktopIcon,dontShrinkIcon:!0,icon:h?(0,Oe.jsx)(io,{}):null,shouldWrapCaption:!0,style:v.formulaReturnTypeCaptionMenuItem})}];return h&&C.push({action:()=>{},key:"variable-name-typecheck-error",render:e=>(0,Oe.jsx)(to().A,{...e,caption:(0,Oe.jsx)(D().sA,{...y}),shouldWrapCaption:!0,style:v.formulaErrorCaptionMenuItem})}),b.push({items:C,key:"variable-name-typecheck",render:e=>(0,Oe.jsx)(Tt().A,{...e,enableActionSheetTitle:!0,topBorder:A})}),0===b.length?null:(0,Oe.jsx)(Mt().A,{...f,children:(0,Oe.jsx)(jt().Ay,{initialFocus:0,sections:b,type:jt().Oh.Vertical})})}var lo=()=>o(977345);const so={type:"unknown"};function co(e){const{type:t}=e,o=(0,ue().IS)((e=>({icon:{fill:e.icon.secondary,width:16,height:16}})),[]);return(0,lo().Ix)(t??so)(o.icon)}function uo(e){const{analyzedFormulaOutput:t,buttonPopupStore:o,children:n,disabled:i,errorMessage:a,onClearClick:r,onDeleteClick:l,onDuplicateClick:s,onEditFormulaClick:c,onEditTextClick:u,onVariableNameChange:d,variableName:p}=e,{parseErrors:m,typeErrors:g}=t,y=Boolean(a),h=Boolean(m&&m.length>0),f=Boolean(g&&g.length>0),v=y||h||f,x=(0,ue().IS)((e=>({button:{color:e.text.secondary,padding:"0 6px",gap:2},chevronIcon:{fill:e.icon.secondary,flex:"0 0 auto",height:14,width:14},children:{...de().RC,color:v?e.errorText:e.text.secondary,flex:"1 1 auto",...v&&{fontWeight:de().Wy.medium}},iconWrap:{marginInlineEnd:2}})),[v]),S=(0,je().j)(),b=(0,ce().uB)(o,at().A),A=(0,re.useCallback)((()=>a??null),[a]),C=(0,re.useCallback)((()=>{b.reset()}),[b]);return(0,Oe.jsx)(tt().Ay,{alignmentToOrigin:tt().yP.Start,buttonPopupStore:b,disabled:i,originGap:0,placementToOrigin:tt().sx.Bottom,popupType:S,renderOrigin:e=>(0,Oe.jsx)(Ee().A,{delayThreshold:0,disableTooltip:!y,placement:Gt().W.Bottom,render:o=>(0,Oe.jsxs)(Lt().p,{...e,...o,disabled:i,disabledFeedback:i,shouldShrink:!0,style:x.button,children:[(0,Oe.jsx)("div",{style:x.iconWrap,children:v?(0,Oe.jsx)(io,{}):(0,Oe.jsx)(co,{type:t.type})}),(0,Oe.jsx)("div",{style:x.children,children:n}),(0,Yt().e)(x.chevronIcon)]}),renderTooltip:A}),render:e=>(0,Oe.jsx)(ro,{analyzedFormulaOutput:t,onClearClick:r,onDeleteClick:l,onDuplicateClick:s,onEditFormulaClick:c,onEditTextClick:u,onVariableNameChange:d,onVariableNameSubmit:C,variableName:p})})}function po(e){var t,o;const{actionStore:n,variableId:a}=e,r=(0,se().v3)(),{automationStore:l,contextType:c}=(0,be().EC)(),{disabled:u,maybePersistedTransactionActions:d,suppressActionErrors:p}=(0,He().b)(),m=(0,D().tz)(),{value:g}=(0,it().fJ)(I().T.formulas),{value:y}=(0,it().fJ)(Xe().QV.automationTypecheck),h=(0,ce().uB)(void 0,at().A),f=re.useRef(null),v=(0,ce().uB)(void 0,at().A),x=(0,lt().n)(l),S=(0,st().j)(),b=(0,ce().K8)((()=>l.getActionStores()),[l]),[A,C]=(0,ce().K8)((()=>[n.id,n.getSpaceId()]),[n]),k=(0,St().F)({actionId:A}),{onTextStoreSelect:M,onTextStoreUnselect:j}=(0,Ht().W)(n),T=(0,ce().K8)((()=>n.getConfig()),[n]),P=(0,ce().K8)((()=>{var e;return null==T||null===(e=T.values)||void 0===e?void 0:e[a]}),[T,a]),_="formula"===(null==P||null===(t=P.value)||void 0===t?void 0:t.type),B=(0,ce().K8)((()=>{if(g&&C)return(0,Nt().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:g.createFormulaDataRequestSyncHandler(n.getRecordModel),spaceId:C,valueTypes:k.slice(0),featureGates:(0,w().i)()},value:null==P?void 0:P.value})}),[C,n.getRecordModel,k,g,null==P?void 0:P.value]),R=(0,re.useMemo)((()=>!p.includes(n.id)),[p,n]),{errorMessage:V}=(0,ae().useErrorComponentForAction)({actionId:n.id,errorKey:a,shouldShow:R}),E=(0,re.useCallback)((e=>{const t=e.target.value;d.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,transaction:o,variableId:n,variableName:i}=e,{valueConfig:a,valueStore:r}=Ot(t,n);(0,s().O9)(a)&&(0,s().O9)(r)&&J().zv({data:{[n]:{...a,name:i}},store:r,transaction:o})}({automationActionStore:n,transaction:e,variableId:a,variableName:t})},userAction:"DefineVariablesAction.editVariableName"}),(0,pt().UB)(r,{automationStore:l,automationActionStore:n})}),[n,l,r,d,a]),F=(0,re.useCallback)((()=>{d.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,automationActionStores:o,transaction:n,variableId:i}=e,{valueConfig:a,valueStore:r}=Ot(t,i);if(!(0,s().O9)(a)||!(0,s().O9)(r))return;const l=(0,Dt().Ay)(),c=(0,Ft().v)(o,a.name);J().zv({data:{[l]:{...a,name:c}},store:r,transaction:n}),X().applyOperation({operation:{args:{id:l},command:"listAfter",path:["config","variableIds"],pointer:t.pointer},store:t,transaction:n})}({automationActionStore:n,automationActionStores:b,transaction:e,variableId:a})},userAction:"DefineVariables.duplicateVariable"}),h.reset(),(0,pt().UB)(r,{automationStore:l,automationActionStore:n})}),[n,b,l,h,r,d,a]),O=(0,re.useCallback)((e=>{g&&y&&(d.createAndCommit({perform:t=>{!function(e){const{automationActionStore:t,transaction:o,variableId:n,variableValue:i}=e,{valueConfig:a,valueStore:r}=Ot(t,n);(0,s().O9)(a)&&(0,s().O9)(r)&&J().zv({data:{[n]:{...a,value:i}},store:r,transaction:o})}({automationActionStore:n,transaction:t,variableValue:e,variableId:a}),(0,i().clearInvalidVariables)({environment:r,automationStore:l,automationTypecheckModule:y,contextType:c,formulasModule:g,intl:m,isSubscribed:x,transaction:t,pageStore:S})},userAction:"DefineVariables.editVariableValue"}),(0,pt().UB)(r,{automationStore:l,automationActionStore:n}))}),[n,l,y,c,r,g,m,x,d,a,S]),L=(0,re.useMemo)((()=>{if(null==T||!T.variableIds||1===T.variableIds.length)return function(){h.setState({open:!1}),O({type:"simple",value:void 0})}}),[null==T?void 0:T.variableIds,h,O]),K=(0,re.useMemo)((()=>{if(!(0,s().O9)(L))return function(){d.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,transaction:o,variableId:n}=e,{valueStore:i}=Ot(t,n);(0,s().O9)(i)&&(J().zv({data:{[n]:null},store:i,transaction:o}),X().applyOperation({operation:{args:{id:n},command:"listRemove",path:["config","variableIds"],pointer:t.pointer},store:t,transaction:o}))}({automationActionStore:n,transaction:e,variableId:a})},userAction:"DefineVariables.deleteVariable"}),h.reset(),(0,pt().UB)(r,{automationStore:l,automationActionStore:n})}}),[n,l,h,r,d,L,a]),N=(0,re.useCallback)((async()=>{var e,t;if(_){if(!(await(0,zt().Cp)()))return}null===(e=f.current)||void 0===e||e.focus(),h.setState({open:!1}),O({type:"simple",value:null==P||null===(t=P.value)||void 0===t?void 0:t.value})}),[h,_,O,null==P||null===(o=P.value)||void 0===o?void 0:o.value]),W=(0,re.useCallback)((()=>{var e;null===(e=f.current)||void 0===e||e.blur(),h.setState({open:!1}),v.setState({open:!0})}),[h,v]),z=(0,ue().IS)((()=>({textInput:{width:"100%"}})),[]),H=(0,re.useCallback)((()=>{pe().clear({environment:r})}),[r]);if(!C||!P||!B)return null;const U=P.name||m.formatMessage(Et().xC),{parseErrors:Y=[],typeErrors:G=[]}=B,q=Y.length>0||G.length>0;return(0,Oe.jsxs)(Vt().Y1,{direction:"vertical",gap:7,children:[(0,Oe.jsx)(Vt().Y1,{direction:"horizontal",width:"hug",children:(0,Oe.jsx)(uo,{analyzedFormulaOutput:B,buttonPopupStore:h,errorMessage:V,onClearClick:L,onDeleteClick:K,onDuplicateClick:F,onEditFormulaClick:W,onEditTextClick:N,onVariableNameChange:E,variableName:P.name,children:(0,Oe.jsx)("span",{style:de().RC,children:U})})}),(0,Oe.jsx)(Wt().Y,{disabled:u,formulaInputButtonPopupStore:v,formulaTypecheckContextValues:k,onChange:O,onTextStoreSelect:M,onTextStoreUnselect:j,onTextEsc:H,parentRecordStore:n,ref:f,spaceId:C,style:z.textInput,value:P.value,shouldShowErrorStyles:q}),(0,Oe.jsx)(Ut().J,{analyzedFormulaOutput:B})]},a)}o(672577);var mo=()=>o(11048),go=()=>o(261237),yo=()=>o(493733),ho=()=>o(199896),fo=()=>o(38337);const vo=(0,D().YK)({aboveMenuItemLabel:{id:"automations.DuplicateBlocksAction.aboveButtonLabel",defaultMessage:"Above button"},aboveTitle:{id:"automations.DuplicateBlocksAction.aboveTitle",defaultMessage:"above button"},belowMenuItemLabel:{id:"automations.DuplicateBlocksAction.belowButtonLabel",defaultMessage:"Below button"},belowTitle:{id:"automations.DuplicateBlocksAction.belowTitle",defaultMessage:"below button"},title:{defaultMessage:"Insert blocks {insertionPicker}",id:"automations.DuplicateBlocksAction.title"},topOfPageMenuItemLabel:{id:"automations.DuplicateBlocksAction.topOfPageButtonLabel",defaultMessage:"At top of page"},topOfPageTitle:{id:"automations.DuplicateBlocksAction.topOfPageTitle",defaultMessage:"at top of page"},bottomOfPageMenuItemLabel:{id:"automations.DuplicateBlocksAction.bottomOfPageButtonLabel",defaultMessage:"At bottom of page"},bottomOfPageTitle:{id:"automations.DuplicateBlocksAction.bottomOfPageTitle",defaultMessage:"at bottom of page"}}),xo={before:{icon:(0,o(334003).F)({width:Ze().Ev.default}),key:"before",menuItemLabel:vo.aboveMenuItemLabel,title:vo.aboveTitle},after:{icon:(0,o(457056).o)({width:Ze().Ev.default}),key:"after",menuItemLabel:vo.belowMenuItemLabel,title:vo.belowTitle},topOfPage:{icon:(0,o(419178).Q)({width:Ze().Ev.default}),key:"topOfPage",menuItemLabel:vo.topOfPageMenuItemLabel,title:vo.topOfPageTitle},bottomOfPage:{icon:(0,o(820579).f)({width:Ze().Ev.default}),key:"bottomOfPage",menuItemLabel:vo.bottomOfPageMenuItemLabel,title:vo.bottomOfPageTitle}},So=xo.after;function bo(e){const{currentOption:t,disabled:o,onChange:n}=e,i=(0,D().tz)(),a=(0,je().j)(),r=(0,ce().uB)(void 0,at().A),l=(0,re.useCallback)((e=>{n&&t.key!==e&&n(e),r.setState({open:!1})}),[r,t,n]);return(0,Oe.jsx)(tt().Ay,{alignmentToOrigin:tt().yP.Center,buttonPopupStore:r,disabled:o,originGap:0,placementToOrigin:tt().sx.Bottom,popupType:a,render:()=>(0,Oe.jsx)(Ao,{currentOption:t,onChange:l}),renderOrigin:e=>(0,Oe.jsx)(bt().x,{...e,disabled:o,isCompact:!0,dropdownButtonType:"dropdown",children:i.formatMessage(t.title)})})}function Ao(e){const{currentOption:t,onChange:o}=e,n=(0,D().tz)(),i=(0,It().e)({maxWidth:360}),a=Object.values(xo).map((e=>({key:e.key,render:o=>(0,Oe.jsx)(et().A,{...o,isChecked:t.key===e.key,icon:e.icon,title:n.formatMessage(e.menuItemLabel)}),action:()=>o(e.key)})));return(0,Oe.jsx)(Mt().A,{...i,children:(0,Oe.jsx)(jt().Ay,{initialFocus:0,sections:[{key:0,render:e=>(0,Oe.jsx)(Tt().A,{enableActionSheetTitle:!0,...e}),items:a}],type:jt().Oh.Vertical})})}function Co(e){const{actionStore:t,disabled:o,contentParentPointer:n,buttonPlacement:a}=e,r=(0,se().v3)(),l=(0,ue().IS)((e=>({listWrap:{background:e.contentBackground,borderRadius:5,boxShadow:e.inputBoxShadow,fontSize:14,minHeight:64,paddingBlock:3,paddingInline:10,cursor:"text",..."dark"===e.mode?{backgroundColor:e.palette.gray[50]}:{}},emptyPlaceholder:{caretColor:e.text.secondary,color:e.text.tertiary,fontSize:14,padding:"5px 0",display:"inline-block"}})),[]),s=(0,ce().K8)((()=>H().Bv.createChildStore(t,n)),[t,n]),c=(0,ce().K8)((()=>s.getContentStore()),[s]),u=(0,ce().K8)((()=>(c.getValue()??[]).every((e=>H().Bv.createChildStore(c,{table:z().ev,id:e}).isType("page")))),[c]),d=(0,re.useCallback)((()=>{(c.getValue()??[]).length>0&&!u||X().createAndCommit({userAction:"DuplicateBlocksAction.handleListClick",environment:r,canUndo:!0,perform:e=>{const t=i().insertEmptyTextInDuplicateBlockAction({environment:r,contentStore:c,transaction:e});Z().hc({environment:r,store:t}),pe().setSelectionAtStart({store:t.getBlockTitleStore()})}})}),[c,u,r]);if(!c)return null;const p="inline"===(null==a?void 0:a.type);return(0,Oe.jsx)(mo().A,{name:"DuplicateBlocksActionEditor",children:(0,Oe.jsx)(ho().Ay,{store:s,analyticsName:"duplicate_blocks_action",isListContainer:!0,children:(0,Oe.jsx)(me().s,{allowSelectionWithin:!0,children:(0,Oe.jsx)("div",{style:l.listWrap,onClick:d,className:fo().CCX,children:(0,Oe.jsx)(go().c,{displayName:"DuplicateBlocksActionContent",disabled:o,children:(0,Oe.jsx)(yo().A,{disabled:o,store:c,emptyPlaceholder:(0,Oe.jsx)("div",{style:l.emptyPlaceholder,children:p?(0,Oe.jsx)(D().sA,{id:"automations.DuplicateBlocksAction.emptyPlaceholder",defaultMessage:"Click to edit or drop blocks hereâ€¦"}):(0,Oe.jsx)(D().sA,{id:"automations.DuplicateBlocksAction.emptyCannotDropPlaceholder",defaultMessage:"Click to edit blocks hereâ€¦"})}),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1})})})})})})}var ko=()=>o(80979),Mo=()=>o(912720),jo=()=>o(616175);const To=(0,D().YK)({confirmationMessageLabel:{defaultMessage:"Confirmation message",id:"automations.BaseModalAction.confirmationMessageLabel"},continueButtonTextLabel:{defaultMessage:"Continue button text",id:"automations.BaseModalAction.continueButtonTextLabel"},cancelButtonTextLabel:{defaultMessage:"Cancel button text",id:"automations.BaseModalAction.cancelButtonTextLabel"}});var Io=()=>o(422540),wo=()=>o(265504);function Po(e){const{actionStore:t,disabled:o,errorMessage:n,includeThisPage:i,onChange:a,target:r,urlBehavior:l}=e,c=(0,se().v3)(),{typecheckResult:u}=(0,be().YC)(),d=(0,ce().uB)(void 0,at().A),[p,m]=(0,ce().K8)((()=>[t.id,t.getSpaceId()]),[t]),g=(0,St().F)({actionId:p}),y=(0,ce().K8)((()=>{if(r)if("variable"===r.type){if(!u)return;const e=(0,ht().getContextValueForActionById)(u,p,r.id);if(e)return{type:"variable",contextValue:e}}else{if("page"===r.type||"url"===r.type)return r;(0,s().HB)(r)}}),[r,u,p]),h=(0,je().j)(),f=(0,re.useCallback)((e=>{"page"!==e.type&&"variable"!==e.type&&"url"!==e.type||(a(e),d.reset(),(0,pt().CM)(((o,n,i)=>{const a=(0,pt().zc)({automationActionStore:t,formulaAnalyticsModule:n,formulasModule:o,simpleFormulasModule:i});(0,s().O9)(a)&&(0,j().u)({environment:c,event:{eventName:"automation_target_pick",eventProperties:{automation_action:a,automation_id:t.getParentId(),target_type:e.type}}})})))}),[a,d,t,c]),v=(0,re.useCallback)((()=>d.reset()),[d]);let x;return y?"page"===y.type?x=(0,Oe.jsx)(vt().A,{store:H().Bv.createChildStore(t,y.page),style:{paddingBlock:1}}):"variable"===y.type?x=(0,Oe.jsx)(xt().F,{value:y.contextValue,format:ft().NY.Medium,isSingle:!0,style:{background:"transparent",color:"unset",margin:"-1.5px 0",padding:0}}):"url"===y.type?x=(0,Oe.jsx)("div",{children:y.url}):(0,s().HB)(y):x="allow"===l?(0,Oe.jsx)(D().sA,{id:"automations.AutomationPagePicker.pagesDropdown.labelWithUrl",defaultMessage:"Select page, form, or URL"}):(0,Oe.jsx)(D().sA,{id:"automations.AutomationPagePicker.pagesDropdown.label",defaultMessage:"Select page"}),(0,Oe.jsx)(tt().Ay,{buttonPopupStore:d,popupType:h,alignmentToOrigin:tt().yP.Center,placementToOrigin:tt().sx.Bottom,originGap:0,disabled:o,renderOrigin:e=>(0,Oe.jsx)(bt().x,{...e,disabled:o,isCompact:!0,isError:Boolean(n),hasActionRequired:!Boolean(r),tooltipMessage:n,dropdownButtonType:"dropdown",children:x}),render:e=>(0,Oe.jsx)(At()._,{formulaTypecheckContextValues:g,includeThisPage:i,onChange:f,onClose:v,parentRecordStore:t,selectedTarget:r,skipCollections:!0,spaceId:m,urlBehavior:l})})}function _o(e){const{actionStore:t,disabled:o,errorMessage:n,onChange:i,value:a,urlBehavior:r}=e,l=(0,ue().IS)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]);return(0,Oe.jsxs)("div",{style:l.title,children:[(0,Oe.jsx)(D().sA,{defaultMessage:"<span>Open </span>{pagePicker}",id:"automations.OpenPageAction.action.title",values:{pagePicker:(0,Oe.jsx)("div",{style:l.picker,children:(0,Oe.jsx)(Po,{urlBehavior:r,actionStore:t,disabled:o,errorMessage:n,onChange:i,target:a})}),span:e=>(0,Oe.jsx)("span",{style:l.span,children:e})}}),"Â "]})}function Bo(e){const{actionStore:t,disabled:o,onChange:n}=e,i=(0,ue().IS)((()=>({picker:{display:"inline-flex",minWidth:50},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]),a=(0,ce().K8)((()=>t.getOpenPageIn()),[t]);return(0,Oe.jsx)("div",{style:i.title,children:(0,Oe.jsx)(D().sA,{defaultMessage:"<span>in </span>{peekModePicker}",id:"automations.OpenPageAction.peekMode.title",values:{peekModePicker:(0,Oe.jsx)("div",{style:i.picker,children:(0,Oe.jsx)(Ro,{disabled:o,onChange:n,value:a})}),span:e=>(0,Oe.jsx)("span",{style:i.span,children:e})}})})}function Ro(e){const{disabled:t,onChange:o,value:n}=e,i=(0,ue().DP)(),a=(0,ce().uB)(void 0,at().A),r=(0,ce().K8)((()=>(0,wo().c)({currentViewType:void 0,theme:i}).find((e=>e.key===n))),[n,i]),l=(0,re.useCallback)((()=>a.reset()),[a]),s=(0,re.useCallback)((e=>{e!==(null==r?void 0:r.key)&&o(e),l()}),[l,null==r?void 0:r.key,o]),c=(0,je().j)();return r?(0,Oe.jsx)(tt().Ay,{alignmentToOrigin:tt().yP.Center,buttonPopupStore:a,disabled:t,originGap:0,placementToOrigin:tt().sx.Bottom,popupType:c,renderOrigin:e=>(0,Oe.jsx)(bt().x,{...e,disabled:t,isCompact:!0,dropdownButtonType:"dropdown",children:r.title}),render:e=>(0,Oe.jsx)(Vo,{onChange:s,value:n})}):null}function Vo(e){const{onChange:t,value:o}=e,n=(0,ue().DP)(),i=(0,ue().IS)((()=>({menuItem:{paddingBlock:8}})),[]),a=(0,It().e)({maxWidth:360,width:280}),r=(0,ce().K8)((()=>(0,wo().c)({currentViewType:void 0,theme:n}).map(((e,n)=>({action:()=>t(e.key),key:n,render:t=>(0,Oe.jsx)(et().A,{...t,body:e.body,caption:e.caption,isChecked:o===e.key,disabled:!1,icon:e.icon,style:i.menuItem,title:e.title})})))),[t,i.menuItem,n,o]),l=[{key:0,render:e=>(0,Oe.jsx)(Tt().A,{enableActionSheetTitle:!0,...e}),items:r}];return(0,Oe.jsx)(Mt().A,{...a,children:(0,Oe.jsx)(jt().Ay,{initialFocus:0,sections:l,type:jt().Oh.Vertical})})}var Eo=()=>o(324254),Do=()=>o(811979),Fo=()=>o(946548),Oo=()=>o(574036),Lo=()=>o(125565),Ko=()=>o(722872),No=()=>o(439616),Wo=()=>o(585293),zo=()=>o(700250);function Ho(e){const{actionStore:t,disabled:o,errorMessage:n,onTargetChange:i,value:a}=e;return(0,Oe.jsx)(D().sA,{defaultMessage:"Publish{pagePicker}",id:"automations.PublishSiteAction.header.title",values:{pagePicker:(0,Oe.jsx)(Po,{actionStore:t,disabled:o,errorMessage:n,includeThisPage:!0,onChange:i,target:a})}})}function Uo(){const e=(0,se().Y0)(),t=(0,ue().IS)((e=>({outerContainer:{paddingTop:15,display:"flex",flexDirection:"column",gap:6},siteSettingsContainer:{borderRadius:10,border:`1px solid ${e.regularDividerColor}`,padding:2},sectionMenuItem:{padding:"6px 2px"},button:{marginLeft:0,marginRight:0,width:"100%",paddingTop:2,paddingBottom:2,background:"transparent"},itemInnerContainer:{marginLeft:0,paddingLeft:8,minWidth:"auto",background:"transparent"}})),[]),o={type:"public_permission",role:"reader",expiration_timestamp:void 0},n=[{key:"linkExpiration",render:e=>(0,Oe.jsx)(No().A,{...e,disabled:!1,permissionItem:o,onChange:e=>{},hideIcon:!0}),action:()=>{}},{key:"enableQna",render:o=>(0,Oe.jsx)(Oo().A,{...o,isMobile:e.isMobile,buttonStyle:t.button,textWrapperStyle:t.itemInnerContainer,title:(0,Oe.jsx)(D().sA,{defaultMessage:"Enable QnA",id:"automations.PublishSiteAction.action.siteSettingsEnableQna.title"}),on:!0,onClick:()=>{}}),action:()=>{}},{key:"enableSeo",render:o=>(0,Oe.jsx)(Oo().A,{...o,isMobile:e.isMobile,buttonStyle:t.button,textWrapperStyle:t.itemInnerContainer,title:(0,Oe.jsx)(D().sA,{defaultMessage:"Search engine indexing",id:"automations.PublishSiteAction.action.siteSettingsEnableSEO.title"}),on:!1,onClick:()=>{}}),action:()=>{}}],i=(0,r().oE)([{key:0,render:e=>(0,Oe.jsx)(Tt().A,{style:t.sectionMenuItem,...e}),items:n}]);return(0,Oe.jsxs)("div",{style:t.outerContainer,children:[(0,Oe.jsx)("label",{children:(0,Oe.jsx)(D().sA,{defaultMessage:"Settings",id:"automations.PublishSiteAction.action.siteSettingsTitle"})}),(0,Oe.jsx)(jt().Ay,{type:jt().Oh.Vertical,sections:i,initialFocus:void 0,resetFocusOnMouseOut:!0,style:t.siteSettingsContainer})]})}function Yo(){const e=(0,ue().IS)((e=>({outerContainer:{paddingTop:15,display:"flex",flexDirection:"column",gap:6},siteSettingsContainer:{borderRadius:10,border:`1px solid ${e.regularDividerColor}`,padding:2},sectionMenuItem:{padding:"6px 2px"}})),[]),t=[{key:"theme",render:t=>(0,Oe.jsx)(Go,{...t,style:e.sectionMenuItem}),action:()=>{}},{key:"header",render:t=>(0,Oe.jsx)(Jo,{...t,style:e.sectionMenuItem}),action:()=>{}},{key:"googleAnalytics",render:t=>(0,Oe.jsx)(Zo,{...t,style:e.sectionMenuItem}),action:()=>{}}],o=(0,r().oE)([{key:0,render:t=>(0,Oe.jsx)(Tt().A,{style:e.sectionMenuItem,...t}),items:t}]);return(0,Oe.jsxs)("div",{style:e.outerContainer,children:[(0,Oe.jsx)("label",{children:(0,Oe.jsx)(D().sA,{defaultMessage:"Site customization",id:"automations.PublishSiteAction.action.siteCustomizationTitle"})}),(0,Oe.jsx)(jt().Ay,{type:jt().Oh.Vertical,sections:o,initialFocus:void 0,resetFocusOnMouseOut:!0,style:e.siteSettingsContainer})]})}const Go=re.forwardRef(((e,t)=>{const o=(0,se().Y0)(),n=(0,re.useCallback)((e=>{}),[]),i="system";return(0,Oe.jsx)(Do().A,{...e,popupType:o.isMobile?tt().z7.SlideUp:tt().z7.Popup,renderOrigin:t=>(0,Oe.jsx)(Wo().a,{...(0,De().A)(e,t),title:(0,Oe.jsx)(D().sA,{defaultMessage:"Theme",id:"automations.PublishSiteAction.action.siteCustomization.themeTitle"}),right:(0,Oe.jsxs)(Oe.Fragment,{children:[(0,Oe.jsx)(qo,{value:i}),(0,Oe.jsx)(nt().I,{icon:Eo().arrowChevronSingleDownSmallIcon,size:"sm",color:"tertiary"})]})}),alignmentToOrigin:zo().MY.End,placementToOrigin:zo().UV.Bottom,render:e=>(0,Oe.jsx)($o,{value:i,onChange:n,onClose:()=>{e.close()}})})}));function qo(e){const{value:t}=e,o=(0,ue().IS)((e=>({container:{color:e.text.secondary}})),[]);return t?"system"===t?(0,Oe.jsx)(Lo().A,{style:o.container,children:(0,Oe.jsx)(D().sA,{defaultMessage:"System",id:"automations.PublishSiteAction.action.siteCustomization.themeOptions.system"})}):"light"===t?(0,Oe.jsx)(Lo().A,{style:o.container,children:(0,Oe.jsx)(D().sA,{defaultMessage:"Light",id:"automations.PublishSiteAction.action.siteCustomization.themeOptions.light"})}):"dark"===t?(0,Oe.jsx)(Lo().A,{style:o.container,children:(0,Oe.jsx)(D().sA,{defaultMessage:"Dark",id:"automations.PublishSiteAction.action.siteCustomization.themeOptions.dark"})}):void(0,s().HB)(t):null}function $o(e){const{value:t,onChange:o,onClose:n}=e,i=(0,se().Y0)(),a=(0,re.useCallback)((e=>{void 0!==e&&e!==t&&o(e),n()}),[t,o,n]),r=["system","light","dark"].map((e=>({key:e,render:t=>(0,Oe.jsx)(et().A,{...t,title:(0,Oe.jsx)(qo,{value:e})}),action:()=>{a(e)}}))),l=[{key:0,render:e=>(0,Oe.jsx)(Tt().A,{...e}),items:r}];return(0,Oe.jsx)(Mt().A,{menuType:i.isMobile?Ko().gu.ActionSheet:Ko().gu.Popup,width:240,children:(0,Oe.jsx)(jt().Ay,{type:jt().Oh.Vertical,initialFocus:r.findIndex((e=>e.key===t)),sections:l})})}Go.displayName="ThemeCustomizationItem";const Jo=re.forwardRef(((e,t)=>{const o=(0,se().Y0)(),n=(0,re.useCallback)((e=>{}),[]),i={};return(0,Oe.jsx)(Do().A,{...e,popupType:o.isMobile?tt().z7.SlideUp:tt().z7.Popup,renderOrigin:t=>(0,Oe.jsx)(Wo().a,{...(0,De().A)(e,t),title:(0,Oe.jsx)(D().sA,{defaultMessage:"Header",id:"automations.PublishSiteAction.action.siteCustomization.headerTitle"}),right:(0,Oe.jsxs)(Oe.Fragment,{children:[(0,Oe.jsx)(D().sA,{defaultMessage:"Default",id:"automations.PublishSiteAction.action.siteCustomization.headerDefaultValue"}),(0,Oe.jsx)(nt().I,{icon:Eo().arrowChevronSingleDownSmallIcon,size:"sm",color:"tertiary"})]})}),alignmentToOrigin:zo().MY.End,placementToOrigin:zo().UV.Bottom,render:e=>(0,Oe.jsx)(Qo,{value:i,onChange:n,onClose:()=>{e.close()}})})}));function Qo(e){const{value:t}=e,o=(0,se().Y0)(),n=[{key:"breadcrumbs",render:e=>(0,Oe.jsx)(Wo().a,{...e,title:(0,Oe.jsx)(D().sA,{defaultMessage:"Breadcrumbs",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionBreadcrumb"}),right:(0,Oe.jsx)(Fo().A,{...e,on:!(null!=t&&t.hideBreadcrumbs)})}),action:()=>{}},{key:"search",render:e=>(0,Oe.jsx)(Wo().a,{...e,title:(0,Oe.jsx)(D().sA,{defaultMessage:"Search",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionSearch"}),right:(0,Oe.jsx)(Fo().A,{...e,on:!(null!=t&&t.hideSearch)})}),action:()=>{}},...(0,ce().K8)((()=>"on"===_().default.getEligibleGroup({experimentId:"public_site_topbar_share_button",defaultGroup:"control"})&&"on"===_().default.getEligibleGroup({experimentId:"public_site_topbar_mobile_share_button",defaultGroup:"control"})),[])?[{key:"share",render:e=>(0,Oe.jsx)(Wo().a,{...e,disabled:!0,title:(0,Oe.jsx)(D().sA,{defaultMessage:"Share",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionShare"}),right:(0,Oe.jsx)(Fo().A,{...e,disabled:!0,on:!(null!=t&&t.hideShare)})}),action:()=>{}}]:[],{key:"watermark",render:e=>(0,Oe.jsx)(Wo().a,{...e,disabled:!0,title:(0,Oe.jsx)(D().sA,{defaultMessage:"Watermark",id:"automations.PublishSiteAction.action.siteCustomization.headerOptionWatermark"}),right:(0,Oe.jsx)(Fo().A,{...e,disabled:!0,on:!(null!=t&&t.hideWatermark)})}),action:()=>{}}],i=[{key:0,render:e=>(0,Oe.jsx)(Tt().A,{...e}),items:n}];return(0,Oe.jsx)(Mt().A,{menuType:o.isMobile?Ko().gu.ActionSheet:Ko().gu.Popup,width:240,children:(0,Oe.jsx)(jt().Ay,{type:jt().Oh.Vertical,initialFocus:n.findIndex((e=>e.key===t)),sections:i})})}Jo.displayName="HeaderCustomizationItem";const Zo=re.forwardRef(((e,t)=>{const o=(0,re.useRef)(null);return(0,Oe.jsx)(Wo().a,{...e,title:(0,Oe.jsx)(D().sA,{defaultMessage:"Google Analytics",id:"automations.PublishSiteAction.action.siteCustomization.googleAnalyticsTitle"}),right:(0,Oe.jsx)(Xo,{ref:o,value:undefined}),onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()}})}));Zo.displayName="GoogleAnalyticsCustomizationSetting";const Xo=re.forwardRef(((e,t)=>{const{value:o}=e,[n,i]=(0,re.useState)(!1),a=!1,r=(0,ue().IS)((e=>({inputContainer:{background:e.surface.page,borderRadius:4,boxShadow:n?"0px 0px 0px 1px #2383E2 inset, 0px 0px 0px 2px rgba(35, 131, 226, 0.35)":`${e.regularDividerColor} 0px 0px 0px 1px inset`,height:28,padding:8,fontWeight:de().Wy.regular,fontSize:14,lineHeight:1.3,color:e.text.secondary},input:{marginLeft:-6,paddingLeft:0,color:e.text.primary},wrapper:{paddingTop:4,paddingBottom:4}})),[a,n]);return(0,Oe.jsx)("div",{style:r.wrapper,children:(0,Oe.jsx)(ge().A,{ref:t,type:"text",style:r.inputContainer,inputStyle:r.input,value:o,onChange:e=>{},format:ge().C.Transparent,onFocus:()=>i(!0),onBlur:()=>i(!1),left:"G-",disabled:a})})}));Xo.displayName="GoogleAnalyticsInput";o(430670);var en=()=>o(79118),tn=()=>o(617871),on=()=>o(90907),nn=()=>o(704152),an=()=>o(554509),rn=()=>o(898125),ln=()=>o(53137),sn=()=>o(5269);function cn(e){const t=(0,se().v3)();(0,ce().K8)((()=>{(0,y().Fbh)(e).forEach((e=>{new(H().LU)(t,{table:b().oo,id:e},{userId:e}).isDefined()}))}),[t,e])}var un=()=>o(905209),dn=()=>o(50401),pn=()=>o(999638),mn=(o(908872),()=>o(970013)),gn=()=>o(842599),yn=()=>o(187174),hn=()=>o(931121),fn=()=>o(778078),vn=()=>o(453697),xn=()=>o(742971),Sn=()=>o(856952),bn=()=>o(963589),An=()=>o(106628),Cn=()=>o(361330),kn=()=>o(970585),Mn=()=>o(576241),jn=()=>o(674300),Tn=()=>o(644484),In=()=>o(848401);function wn(e){let{handleRemoveToken:t,token:o,format:n,style:i,addQuotes:a,renderAvatar:r,isDisabled:l}=e;const s=(0,ue().DP)();if(!(0,gn().DT)(o))return null;const c=a?`â€œ${o}â€`:o;return(0,Oe.jsx)(In().Ay,{title:c,format:n??ft().NY.Small,renderAvatar:r||(e=>(0,Tn().g)({width:e,height:e,padding:2,marginRight:6})),showRemoveButton:Boolean(t)&&!l,onClickRemove:e=>{null==e||e.stopPropagation(),t&&t(o)},style:{background:s.palette.gray[75],...i},shouldShrink:!0,isSingle:!1})}var Pn=()=>o(436876);const _n=["gmail.com","yahoo.com","outlook.com"],Bn=["com","net","org"];var Rn=()=>o(64e3),Vn=()=>o(480095),En=()=>o(320865),Dn=()=>o(996027),Fn=()=>o(231713),On=()=>o(629203);function Ln(e){let{email:t,disabled:o,menuArgs:n}=e;const i=(0,On().U)();return(0,Oe.jsx)(et().A,{...n,title:(0,Oe.jsx)(wn,{token:t,format:ft().NY.Inline,addQuotes:!0,style:{background:void 0,padding:void 0}}),disabled:o,style:o?i.disabledMenuItem:void 0,isTokenTitle:!0})}function Kn(e){let{token:t,disabled:o,menuArgs:n,type:i}=e;const a=(0,On().U)(),r=(0,ue().DP)();return(0,Oe.jsx)(et().A,{...n,title:(0,Oe.jsx)(Pn().A,{token:t,type:i,format:ft().NY.Inline,style:{color:r.darkTextColor,background:void 0,padding:void 0}}),disabled:o,style:{...o?a.disabledMenuItem:void 0},isTokenTitle:!0})}var Nn=()=>o(764880),Wn=()=>o(448693);function zn(e){let{annotation:t,disabled:o,getRecordModel:n,menuArgs:i}=e;const a=(0,On().U)(),r=(0,ce().K8)((()=>{if((0,Nt().isAnnotationSimpleValueToken)(t)&&(0,y().rie)(t)){const e=(0,y().NcG)(t);return e?(0,Nn().xC)({pointer:{table:b().oo,id:e},getRecordModel:n,getRecordValue:void 0}):void 0}}),[t,n]);return null!=r&&r.asActor&&r.table===b().oo?(0,Oe.jsx)(et().A,{...i,title:(0,Oe.jsx)(Hn,{actor:r}),disabled:o,style:o?a.disabledMenuItem:void 0,isTokenTitle:!0}):null}function Hn(e){let{actor:t}=e;const o=(0,ue().IS)((e=>({root:{margin:"4px 0"},actor:{margin:"0 10px 0 0"},email:{color:e.actionMenuButtonTextColor,margin:"0 0 0 26px"}})),[]),n=(0,ce().K8)((()=>t.getName()),[t]),i=(0,ce().K8)((()=>t.getEmail()),[t]);return(0,Oe.jsxs)("div",{style:o.root,children:[(0,Oe.jsx)(Wn().Ay,{actor:t,format:ft().NY.Medium,shouldShrink:!0,isSingle:!1,style:o.actor,hasPersonHoverCard:!1},t.id),n&&(0,Oe.jsx)(In().Ay,{title:i,format:ft().NY.ExtraSmall,isSingle:!1,style:o.email})]})}function Un(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:n,formulaValueContext:i,getRecordModel:a,isDisabled:l,limit:s,menuProps:c,onChange:u,onClose:d,onFormulaButtonClick:p,showFormulaValueItems:m=!1,value:h,pageProperties:f,parentRecordStore:v,showInputErrorStyles:x}=e,S=(0,se().Y0)(),b=(0,ue().DP)(),{errorMessage:A,isLoading:C,menuListStore:k,noResultsMessage:M,searchInput:j,userItems:T,valueItems:I,pagePropertyItems:w,emailItems:P}=function(e){var t,o,n;const{action:i,formulaTypecheckContextValues:a,formulaValueContext:l,isDisabled:s=!1,limit:c,onChange:u,onClose:d,onFormulaButtonClick:p,unlimitedCurrentSimpleFormulaValueTokens:m,value:h,pageProperties:f,parentRecordStore:v,showInputErrorStyles:x}=e,S=(0,se().v3)(),b=(0,D().tz)(),{collectionStore:A,property:C}="collection"===l.type?l:{collectionStore:void 0,property:void 0},k=v.getRecordModel,M=(0,zt().pg)(l),j=M(m,"first"),T=(0,re.useMemo)((()=>a.filter((e=>(0,lo().o5)(e.type,{type:"person"})))),[a]),I=(0,ue().IS)((e=>({personToken:{background:e.palette.gray[75],borderRadius:"6px"},formulaValueToken:{background:e.buttonBackground},searchInput:{maxHeight:6*parseInt(Sn().sA,10),width:"100%",margin:0,...x&&{border:`1px solid ${e.text.uiRedPrimary}`,boxShadow:"none"}},clearButton:{height:20},clearButtonIcon:{height:15,width:15,fill:e.icon.tertiary},actionButtonGroup:{alignSelf:"end",cursor:"unset",justifyContent:"end"}})),[x]),[w,P]=(0,re.useState)(""),_=(0,re.useRef)(null),B=(0,re.useRef)(""),R=(0,ce().uB)(void 0,kn().A),V=(0,ce().K8)((()=>(null==A?void 0:A.getSchema())??{}),[A]),E=(0,ce().K8)((()=>{if(V&&C){const e=V[C];if(e&&(0,mn().sO)(e))return 1===e.limit}return!1}),[V,C]),[F]=(0,yn().Yb)((async()=>{const e=w?(0,fn().Ay)(w,T,(e=>e.kind===g().FormulaContextValueKind.ContextValue?e.name:"")):T,t=w?(0,fn().Ay)(w,f,(e=>(0,y().GCe)(e).name??"")):f,o=(0,Nt().fromSimpleFormulaArrayValue)(null==h?void 0:h.value).reduce(((e,t)=>(t&&(0,Nt().isAnnotationSimpleValueToken)(t)&&(0,y().rie)(t)&&e.push(t[1]),e)),[]),n=await An().T.searchActions.load(),i=await n.searchSpaceUsers({environment:S,query:w,membersOnly:!1,limit:20+o.length,shouldUseEdgeCacheRollout:!0});let a=0,r=i[a];const l=[];for(;r&&l.length<20;)o.includes(r.id)||l.push(r.id),a+=1,r=i[a];return{valueResults:e,userResults:l,pagePropertyResults:t}}),[S,w,T,null==h?void 0:h.value,f],{debounce:Cn().tu}),O=(0,re.useCallback)((()=>{var e;P(""),null===(e=_.current)||void 0===e||e.focus(),R.setState({...R.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[R]),L=(0,re.useCallback)(((e,t)=>{u(e||h,t||i)}),[i,u,h]),K=(0,re.useCallback)((e=>{const t=M(e,"last");L({type:"simple",value:(0,Nt().toSimpleFormulaArrayValue)(t)}),O()}),[M,L,O]),N=(0,re.useCallback)((()=>{K(j.slice(0,j.length-1))}),[j,K]),W=(0,re.useCallback)((e=>{null==K||K((0,Nt().simpleFormulaValueWithoutToken)(j,e))}),[j,K]),z=Boolean(c&&j.length>=c),H=r().oE(j.map(((e,t)=>{if("boolean"==typeof e)return null;if("string"==typeof e)return(0,Oe.jsx)(wn,{handleRemoveToken:W,token:e,isDisabled:s,renderAvatar:t=>(0,vn().A)({avatar:{email:e},style:{marginRight:4}}),style:I.personToken},t);if((0,y().rie)(e))return(0,Oe.jsx)(Mn().A,{handleRemoveToken:W,token:e,isDisabled:s,style:I.personToken,preventOnClickPropagation:!0},t);if((0,y().s1Y)(e))return(0,Oe.jsx)(jn().A,{formulaTypecheckContextValues:a,handleRemoveToken:W,isDisabled:s,style:I.formulaValueToken,token:e,preventOnClickPropagation:!0},t);if((0,y().iz3)(e)){var o;const n=(0,y().GCe)(e);return(0,Oe.jsx)(Pn().A,{type:null===(o=V[n.property])||void 0===o?void 0:o.type,isDisabled:s,handleRemoveToken:W,token:e},t)}return null}))),Y=new Set(r().oE(j.map((e=>(0,Nt().isAnnotationSimpleValueToken)(e)&&(0,y().s1Y)(e)&&(0,y().iVq)(e).id)))),G=new Set(r().oE(j.map((e=>(0,Nt().isAnnotationSimpleValueToken)(e)&&(0,y().rie)(e)&&(0,y().NcG)(e))))),q=r().oE(((null===(t=F.value)||void 0===t?void 0:t.valueResults)||[]).map((e=>{const t=e.kind===g().FormulaContextValueKind.ContextValue&&e.id||"";if(!t||!Y.has(t))return{action:"append",currentSimpleFormulaValueTokens:j,isDisabled:s||z,id:t,getRecordModel:k,setCurrentTokens:K,value:e}}))),$=r().oE(((null===(o=F.value)||void 0===o?void 0:o.userResults)||[]).map((e=>{const t=G.has(e);if(t)return;const o=(0,y().P4h)(e);return{action:()=>{t?W(o):K([...j,o]),E&&U().default.afterNextFlush((()=>{d()}))},annotation:o,getRecordModel:k,id:e,isDisabled:s||z,userId:e,isSelected:t}}))),J=new Set(j.filter((e=>(0,Nt().isAnnotationSimpleValueToken)(e)&&(0,y().iz3)(e))).map((e=>(0,y().GCe)(e).property))),Q=r().oE(null===(n=F.value)||void 0===n?void 0:n.pagePropertyResults.map((e=>{var t;const o=(0,y().GCe)(e);if(!J.has(o.property))return{id:o.property,type:null===(t=V[o.property])||void 0===t?void 0:t.type,isDisabled:s||z,action:()=>{K([...j,e])},propertyAnnotation:e}}))),Z=(0,re.useCallback)((e=>{(0,gn().DT)(e)&&K([...j,e])}),[j,K]),X=(0,re.useCallback)((()=>{Z(B.current)}),[Z]);(0,re.useEffect)((()=>{B.current=w}),[w]),(0,re.useEffect)((()=>{const e=_.current;return e&&e.addEventListener("blur",X),()=>{e&&e.removeEventListener("blur",X)}}),[X]);const ee=(0,gn().DT)(w)?[w]:[];if(0===ee.length){const[e,t]=w.split("@");if(t){const[o,n]=t.split(".");(!n||n.length<=1)&&ee.push(...Bn.map((t=>`${e}@${o}.${t}`)).filter(gn().DT))}else ee.push(..._n.map((t=>`${e}@${t}`)).filter(gn().DT))}const te=ee.map((e=>({action:()=>Z(e),isDisabled:s||z,email:e}))),oe=[...q,...$,...Q,...te],ne=(0,bn().X)("gmail_action_formula_recipients");return{errorMessage:F.error&&b.formatMessage(xn().D.somethingWentWrong),header:b.formatMessage(xn().D.genericMenuHeader),isLoading:!F.value&&!F.error,menuListStore:R,noResultsMessage:0===oe.length&&F.value&&b.formatMessage(xn().D.noResults),searchInput:e=>(0,Oe.jsx)(Sn().Ay,{ref:_,style:I.searchInput,right:(0,Oe.jsxs)(Vt().Y1,{direction:"horizontal",style:I.actionButtonGroup,children:[ne&&p&&(0,Oe.jsx)(dn().F,{disabled:s,onClick:e=>{e.stopPropagation(),p(e)},value:h}),(0,Oe.jsx)(Re().A,{ariaLabel:b.formatMessage({id:"automations.emailRecipients.clear",defaultMessage:"Clear"}),disabled:s,disabledFeedback:s,onClick:e=>{e.stopPropagation(),K([])},style:I.clearButton,icon:hn().J,iconStyle:I.clearButtonIcon})]}),disabled:s||z,format:Sn().le.FilterValue,onChange:e=>P(e.target.value),onRemoveLastToken:N,placeholder:"",onClick:e,tokens:H,value:w}),userItems:$,valueItems:q,pagePropertyItems:Q,emailItems:te}}({action:t,formulaTypecheckContextValues:n,formulaValueContext:i,isDisabled:l,limit:s,onChange:u,onClose:d,onFormulaButtonClick:p,unlimitedCurrentSimpleFormulaValueTokens:o,value:h,pageProperties:f,parentRecordStore:v,showInputErrorStyles:x})||{},_=(0,re.useMemo)((()=>I&&m?I.map((e=>{const{annotation:t,itemAction:o}=(0,Fn().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:o=>(0,Oe.jsx)(Dn().A,{annotation:t,disabled:e.isDisabled,formulaTypecheckContextValues:n,menuArgs:o,style:{background:void 0,color:b.darkTextColor,padding:void 0},parentRecordStore:v}),action:o}})):[]),[I,m,n,b,v]),B=(0,re.useMemo)((()=>T?T.map((e=>({key:e.userId,render:t=>(0,Oe.jsx)(zn,{annotation:e.annotation,disabled:e.isDisabled,menuArgs:t,getRecordModel:a||e.getRecordModel}),action:e.action}))):[]),[a,T]),R=[..._,...(0,re.useMemo)((()=>w?w.map((e=>({key:e.id,render:t=>(0,Oe.jsx)(Kn,{disabled:e.isDisabled,menuArgs:t,type:e.type,token:e.propertyAnnotation}),action:e.action}))):[]),[w])],V=[];R.length>0&&V.push({key:"properties",render:e=>(0,Oe.jsx)(Tt().A,{...e,title:"Property",topBorder:!1}),items:R}),B.length>0&&V.push({key:"users",render:e=>(0,Oe.jsx)(Tt().A,{...e,title:"Person",topBorder:R.length>0}),items:B});const E=(0,re.useMemo)((()=>P?P.map((e=>({key:e.email,action:e.action,render:t=>(0,Oe.jsx)(Ln,{email:e.email,disabled:e.isDisabled,menuArgs:t})}))):[]),[P]);let F;E.length>0&&V.push({key:"emails",render:e=>(0,Oe.jsx)(Tt().A,{...e,title:"Email",topBorder:R.length>0||B.length>0}),items:E}),F=S.isMobile?{menuType:Ko().gu.Modal,right:(0,Oe.jsx)(Vn().DoneMenuText,{}),minWidth:"100%"}:{menuType:Ko().gu.Popup,maxHeight:"50vh",minWidth:"100%",disableHeaderBorder:!0};const O={width:"260px"},L=(0,Oe.jsxs)(Oe.Fragment,{children:[A&&(0,Oe.jsx)(Tt().A,{style:O,children:(0,Oe.jsx)(Rn().A,{title:A})}),M&&(0,Oe.jsx)(Tt().A,{style:O,children:(0,Oe.jsx)(Rn().A,{title:M})}),C&&(0,Oe.jsx)(Tt().A,{style:O,children:(0,Oe.jsx)(En().A,{})}),V.length>0&&(0,Oe.jsx)(jt().Ay,{type:jt().Oh.Vertical,initialFocus:0,sections:V,store:k,style:O})]});return{searchInput:j,innerComponents:L,emailRecipientsMenu:(0,Oe.jsx)(Mt().A,{...F,...c,children:L})}}function Yn(e){const{currentValue:t,onChange:o,parentRecordStore:n,spaceId:i,formulaTypecheckContextValues:a,disabled:r}=e;return"formula"===(null==t?void 0:t.type)?(0,Oe.jsx)($n,{parentRecordStore:n,spaceId:i,value:t,formulaTypecheckContextValues:a,isDisabled:r,onChange:o}):(0,Oe.jsx)(Gn,{...e})}function Gn(e){const{currentValue:t,collectionStore:o,onChange:n,formulaTypecheckContextValues:i,limit:a,pageProperties:r,disabled:l,parentRecordStore:c,errorMessage:u}=e,d=o?{type:"collection",collectionStore:o,property:"person"}:{type:"empty"},p={menuType:Ko().gu.Popup},m=(0,ce().K8)((()=>(0,Nt().fromSimpleFormulaArrayValue)(null==t?void 0:t.value)),[t]),{searchInput:g,emailRecipientsMenu:y}=Un({currentSimpleFormulaValueTokens:m,formulaTypecheckContextValues:i,formulaValueContext:d,limit:a,menuProps:p,onChange:n,onClose:window.parent.close,onFormulaButtonClick:e=>{e.stopPropagation(),n({type:"formula",value:null==t?void 0:t.value})},showFormulaValueItems:!0,showGenericHeader:!0,value:t,pageProperties:r,isDisabled:l,parentRecordStore:c,showInputErrorStyles:(0,s().O9)(u)});return(0,Oe.jsx)(tt().Ay,{renderOrigin:e=>{let{onClick:t}=e;return null==g?void 0:g(t)},popupType:tt().z7.Popup,render:()=>y})}const qn=[{type:"person"},{type:"text"},{type:"array",of:{type:"person"}},{type:"array",of:{type:"text"}}];function $n(e){const{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:n,value:i,onChange:a,isDisabled:r}=e,l=(0,ue().IS)((e=>({containerWrap:{width:"100%"},formulaText:{whiteSpace:"pre-wrap",cursor:"pointer"},scroller:{flexGrow:1,width:"100%"},textWrap:{cursor:"text",display:"flex",flexWrap:"wrap",justifyContent:"end",width:"100%"},wrap:{background:e.inputBackground,boxShadow:e.inputBoxShadow,boxSizing:"border-box",cursor:"text",padding:"4px 8px"},actionButtonGroup:{alignSelf:"end",cursor:"unset",justifyContent:"end"}})),[]),s=async e=>{e.stopPropagation();await(0,zt().Cp)()&&(null==a||a({type:"simple",value:null==i?void 0:i.value}))},c=(0,ce().uB)(void 0,at().A),u=(0,re.useCallback)((()=>c.setState({open:!1})),[c]);return(0,Oe.jsx)(tt().Ay,{buttonPopupStore:c,renderOrigin:e=>(0,Oe.jsx)("div",{...e,style:l.containerWrap,children:(0,Oe.jsx)(Vt().Y1,{align:"center",className:fo().CCX,direction:"vertical",gap:4,style:l.wrap,children:(0,Oe.jsxs)("div",{style:l.textWrap,children:[(0,Oe.jsx)(fe().H,{style:l.scroller,type:xe().A.Y,children:(0,Oe.jsx)("div",{style:l.formulaText,children:(0,Oe.jsx)(un().$,{formulaTypecheckContextValues:t,parentRecordStore:o,spaceId:n,value:i})})}),(0,Oe.jsx)("div",{children:(0,Oe.jsx)(Vt().Y1,{direction:"horizontal",gap:2,style:l.actionButtonGroup,children:(0,Oe.jsx)(dn().F,{disabled:r,onClick:s,value:i})})})]})})}),popupType:tt().z7.Popup,render:()=>(0,Oe.jsx)(pn().A,{allowedReturnTypes:qn,disabled:r,formulaTypecheckContextValues:t??[],onChange:a,onClose:u,parentRecordStore:o,value:i,spaceId:n})})}var Jn=()=>o(148307),Qn=()=>o(218275),Zn=()=>o(158661),Xn=()=>o(510683),ei=()=>o(633457),ti=()=>o(678553),oi=()=>o(47373),ni=()=>o(47170);const ii=(0,D().YK)({gmailAccountMenuPickerHeader:{defaultMessage:"Select Account",id:"automations.gmailAccountPicker.menuHeader"},gmailAccountMenuPickerHeaderInvalidAccount:{defaultMessage:"Invalid Account",id:"automations.gmailAccountPicker.menuHeaderInvalidAccount"},gmailAccountMenuPickerHeaderInvalidAccountTooltip:{defaultMessage:"Connect a valid account or delete this step",id:"automations.gmailAccountPicker.menuHeaderInvalidAccountTooltip"},addGmailAccountLabel:{id:"automations.gmailAccountPicker.setupAnotherGmailAccount.label",defaultMessage:"Add Gmail Account"},manageAccountInfoCaption:{id:"automations.gmailAccountPicker.manageAccountInfo.caption",defaultMessage:"Manage connected accounts in the â€œMy Connectionsâ€ tab of Settings"},connectGmailAccountMobileLabel:{id:"automations.gmailAccountPicker.connectGmailAccountMobile.label",defaultMessage:"Connect Gmail Account"},connectGmailAccountMobileCaption:{id:"automations.gmailAccountPicker.connectGmailAccountMobile.caption",defaultMessage:"Open desktop or web app to connect"},connectGmailAccountLabel:{id:"automations.gmailAccountPicker.connectGmailAccount.label",defaultMessage:"Connect Gmail Account"},connectGmailAccountCaption:{id:"automations.gmailAccountPicker.connectGmailAccount.caption",defaultMessage:"Allow Notion to send email on your behalf"}});function ai(e){const{currentGmailAuthentication:t,gmailAuthentications:o,disabled:n,errorMessage:i,onAccountChange:a}=e,r=(0,se().v3)(),l=(0,se().Y0)(),s=(0,ni().O)(),c="collection_view_settings",u=(0,ce().K8)((()=>ln().A.integrations.state.find((e=>e.id===tn().eg))),[]),d=Boolean(i),p=(0,ce().uB)(void 0,at().A),m=(0,re.useCallback)((e=>{a(e),(0,j().u)({environment:r,event:{eventName:"gmail_action_account_click",eventProperties:{}}}),p.reset()}),[a,p,r]),g=(0,je().j)(),y=(0,It().e)(),h=(0,ue().IS)((e=>({infoItem:{color:e.text.secondary,cursor:"default"},connectAccount:{paddingRight:"32px"},manageAccountCaption:{color:e.text.tertiary},errorText:{color:e.errorText}})),[]);if(!u)return null;const f=[{items:o.map(((e,o)=>({action:()=>null,key:e.id,render:()=>{const o=(null==t?void 0:t.id)===e.id;return(0,Oe.jsx)(et().A,{focused:(null==t?void 0:t.id)===e.id,onClick:async()=>{if(s)if(o&&d){const e=await ri(r,u,s,c);if("success"!==e.status)return void p.reset();m(e.externalAuthentication.id)}else m(e.id)},title:e.account_name,left:(0,Oe.jsx)(vn().A,{avatar:{email:e.account_name}}),isChecked:!d&&o,right:d&&o?(0,Oe.jsx)(nt().I,{icon:Zn().exclamationMarkTriangleFillSmallIcon,size:"sm"}):void 0,style:{...o&&d&&h.errorText},bodyStyle:{minWidth:"280px"}},e.id)}}))),key:"gmailAccounts",render:e=>(0,Oe.jsx)(Tt().A,{...e,enableActionSheetTitle:!0})}];f.push({key:"add-another-gmail-account-section",items:[{key:"add-another-gmail-account-item",action:async()=>{if(!s)return;const e=await ri(r,u,s,c);"success"===e.status&&(a(e.externalAuthentication.id),p.reset())},render:e=>(0,Oe.jsx)(et().A,{...e,left:(0,Oe.jsx)(nt().I,{icon:Je().plusIcon}),right:(0,Oe.jsx)(nt().I,{icon:Qn().arrowUpRightSquareSmallIcon,size:"sm",color:"tertiary"}),title:(0,Oe.jsx)(D().sA,{...ii.addGmailAccountLabel})})}],render:e=>(0,Oe.jsx)(Tt().A,{...e,topBorder:!0})}),f.push({key:"manage-account-info-section",items:[{key:"manage-account-info-item",action:()=>null,render:e=>(0,Oe.jsx)(et().A,{...e,style:h.infoItem,focused:!1,caption:(0,Oe.jsx)(ti().CU,{caption:(0,Oe.jsx)(D().sA,{...ii.manageAccountInfoCaption}),shouldWrapCaption:!0,captionStyle:h.manageAccountCaption})})}],render:e=>(0,Oe.jsx)(Tt().A,{...e,topBorder:!0})});const v={key:"connect-gmail-account-mobile-item",action:()=>null,render:e=>(0,Oe.jsx)(et().A,{...e,icon:(0,Oe.jsx)("img",{src:Jn().A.images.externalIntegrations.gmailIconPng,style:{width:18,height:"auto"}}),focused:!1,disabled:!0,buttonStyle:h.connectAccount,title:(0,Oe.jsx)(D().sA,{...ii.connectGmailAccountMobileLabel}),caption:(0,Oe.jsx)(ti().CU,{caption:(0,Oe.jsx)(D().sA,{...ii.connectGmailAccountMobileCaption}),shouldWrapCaption:!0})})},x={key:"connect-gmail-account-item",action:async()=>{if(p.reset(),!s)return;const e=await ri(r,u,s,c);"success"===e.status&&a(e.externalAuthentication.id)},render:e=>(0,Oe.jsx)(et().A,{...e,icon:(0,Oe.jsx)("img",{src:Jn().A.images.externalIntegrations.gmailIconPng,style:{width:18,height:"auto"}}),focused:!1,buttonStyle:h.connectAccount,title:(0,Oe.jsx)(D().sA,{...ii.connectGmailAccountLabel}),caption:(0,Oe.jsx)(ti().CU,{caption:(0,Oe.jsx)(D().sA,{...ii.connectGmailAccountCaption}),shouldWrapCaption:!0})})},S=[{key:"connectGmailAccount",items:[l.isMobile?v:x],render:e=>(0,Oe.jsx)(Tt().A,{...e,enableActionSheetTitle:!0})}];return(0,Oe.jsx)(tt().Ay,{buttonPopupStore:p,popupType:g,alignmentToOrigin:tt().yP.End,placementToOrigin:tt().sx.Bottom,originGap:0,disabled:n,renderOrigin:e=>(0,Oe.jsx)(bt().x,{...e,disabled:n,isCompact:!0,isError:d,hasActionRequired:!Boolean(t),dropdownButtonType:"dropdown",children:t?(0,Oe.jsx)(Ee().A,{renderTooltip:()=>i,disableTooltip:!d,render:e=>(0,Oe.jsx)("span",{...e,children:null==t?void 0:t.account_name})}):(0,Oe.jsx)(Ee().A,{renderTooltip:()=>(0,Oe.jsx)(D().sA,{...ii.gmailAccountMenuPickerHeaderInvalidAccountTooltip}),disableTooltip:!d,render:e=>(0,Oe.jsx)("span",{...e,children:(0,Oe.jsx)(D().sA,{...d?ii.gmailAccountMenuPickerHeaderInvalidAccount:ii.gmailAccountMenuPickerHeader})})})}),render:e=>(0,Oe.jsx)(Mt().A,{...y,children:(0,Oe.jsx)(jt().Ay,{type:jt().Oh.Vertical,sections:0===o.length?S:f,initialFocus:0})})})}async function ri(e,t,o,n){const i=await Xn().Jq({environment:e,integration:t,spaceId:o,from:n,preventRedirectToLastVisitedPage:(0,oi().dC)()});return l().Q.isFail(i)?{status:"failure"}:i.value.externalAuthentication?{externalAuthentication:i.value.externalAuthentication,status:"success"}:(await ei().oX({environment:e}),{status:"re-auth"})}const li=(0,D().YK)({toLabel:{defaultMessage:"To",id:"automations.SendGmailNotificationAction.toLabel"},ccLabel:{defaultMessage:"CC",id:"automations.SendGmailNotificationAction.ccLabel"},bccLabel:{defaultMessage:"BCC",id:"automations.SendGmailNotificationAction.bccLabel"},replyToLabel:{defaultMessage:"Send replies to",id:"automations.SendGmailNotificationAction.replyToLabel"},fromNameLabel:{defaultMessage:"Send with display name",id:"automations.SendGmailNotificationAction.fromNameLabel"},subjectLabel:{defaultMessage:"Subject",id:"automations.SendGmailNotificationAction.subjectLabel"},bodyLabel:{defaultMessage:"Message",id:"automations.SendGmailNotificationAction.bodyLabel"},gmailAccountPickerHidden:{defaultMessage:"Hidden",id:"automations.SendGmailNotificationAction.gmailAccountPickerHidden"}}),si=["subject","body","fromName"],ci={cc:!1,bcc:!1,replyTo:!1,displayName:!1},ui={displayName:!1,replyTo:!1},di={cc:li.ccLabel.defaultMessage,bcc:li.bccLabel.defaultMessage,replyTo:li.replyToLabel.defaultMessage,displayName:li.fromNameLabel.defaultMessage};function pi(e){var t,o,n,i,l,c,u,d,p,m,h,f,v,x,S;const A=(0,D().tz)(),{actionStore:C,currentGmailAuthentication:k,gmailAuthentications:M}=e,{automationStore:j,contextType:T}=(0,be().EC)(),{disabled:P,maybePersistedTransactionActions:_,suppressActionErrors:B}=(0,He().b)(),R=(0,sn().y)(j,T),V=(0,ce().K8)((()=>Boolean(P)),[P]),E=(0,a().getActionRegistryItem)("send_gmail_notification"),F=(0,ce().K8)((()=>C.getSpaceId()),[C]),O=(0,ce().K8)((()=>{var e,t,o,n;return{to:null==C||null===(e=C.getConfig())||void 0===e?void 0:e.to,cc:null==C||null===(t=C.getConfig())||void 0===t?void 0:t.cc,bcc:null==C||null===(o=C.getConfig())||void 0===o?void 0:o.bcc,reply_to:null==C||null===(n=C.getConfig())||void 0===n?void 0:n.reply_to}}),[C]),[L,K]=(0,re.useState)(ci),[N,W]=(0,re.useState)(ui),z=(0,se().v3)();cn(Object.values(O).flatMap((e=>{var t;return(null==e||null===(t=e.value)||void 0===t?void 0:t.value)||[]})));const{actionId:U,currentFromName:Y,currentSubject:G,currentBody:q,externalBotId:$}=(0,ce().K8)((()=>{var e,t,o;return{currentFromName:null===(e=C.getConfig())||void 0===e?void 0:e.from_name,currentSubject:null===(t=C.getConfig())||void 0===t?void 0:t.email_subject,currentBody:null===(o=C.getConfig())||void 0===o?void 0:o.email_body,actionId:C.id,externalBotId:C.getConfigStore().getKeyStore("external_bot_id").getValue()}}),[C]);(0,qt().l)((()=>{K((e=>{var t,o,n;return{...e,cc:Boolean(null==O||null===(t=O.cc)||void 0===t||null===(t=t.value)||void 0===t?void 0:t.value),bcc:Boolean(null==O||null===(o=O.bcc)||void 0===o||null===(o=o.value)||void 0===o?void 0:o.value),replyTo:Boolean(null==O||null===(n=O.reply_to)||void 0===n||null===(n=n.value)||void 0===n?void 0:n.value),displayName:Boolean(null==Y?void 0:Y.value)}}))}));const Q=(0,St().F)({actionId:U}),{value:Z}=(0,it().fJ)(I().T.formulas),X=function(e,t){return(0,ce().K8)((()=>t&&e?r().oE(Object.entries(e.getSchema()).map((e=>{let[t,o]=e;const n=new Set(["person","email"]),i=null==o?void 0:o.type;if(!i)return;return n.has(i)||"rollup"===i&&o.target_property_type&&n.has(o.target_property_type)?(0,y().ESw)({contextValueId:(0,en().KI)(),name:o.name,property:t,valueSnapshot:"current"}):void 0}))):[]),[e,t])}(R,(0,re.useMemo)((()=>{if(Z)return Q.filter((e=>(null==e?void 0:e.kind)===g().FormulaContextValueKind.ContextValue)).find((e=>(null==e?void 0:e.id)===(0,en().KI)()))}),[Q,Z])),ee=(0,ce().uB)(void 0,at().A),te=(0,re.useCallback)((()=>ee.reset()),[ee]),oe=(0,re.useMemo)((()=>(0,Oe.jsx)(yt().z,{actionStore:C,closeMenu:te})),[C,te]),ne=(0,re.useMemo)((()=>!B.includes(C.id)),[B,C]),ie=function(e){const{actionId:t,shouldShowError:o}=e,n={};return n.external_bot_id=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"external_bot_id"}),n.to=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"to"}),n.cc=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"cc"}),n.bcc=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"bcc"}),n.reply_to=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"reply_to"}),n.email_body=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"email_body"}),n.email_subject=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"email_subject"}),n}({actionId:C.id,shouldShowError:ne}),le=(0,ae().useRequiresSubscriptionUpgradeError)({actionId:C.id,shouldShow:ne}),me=Boolean(le),ge=(0,re.useMemo)((()=>Object.values(ie).filter((e=>(0,s().O9)(e.errorMessage)))[0]),[ie]),ye=(0,re.useCallback)((e=>{const t=ln().A.externalAuthentications.state.find((t=>t.integration_id===tn().eg&&t.id===e)),o=$!==(null==t?void 0:t.id);t&&o&&_.createAndCommit({perform:e=>{J().zv({data:{external_bot_id:t.id},store:C.getConfigStore(),transaction:e})},userAction:"SendGmailNotificationAction.setExternalBotId"})}),[C,$,_]);(0,ce().K8)((()=>{$||1===M.length&&ye(M[0].id)}),[M,ye,$]);const he=(0,re.useCallback)((e=>t=>{if(!t)return;if("formula"===t.type)return void _.createAndCommit({perform:o=>{J().zv({data:{[e]:{type:"formula",value:t}},store:C.getConfigStore(),transaction:o})},userAction:"SendGmailNotificationAction.setRecipient.formula"});const o=(0,y().RQ)(t.value).filter((e=>{const t=(0,y().Fbh)([e]);if(0===t.length)return!0;return!new(H().LU)(z,{table:b().oo,id:t[0]},{userId:t[0]}).getIsDeleted()}));_.createAndCommit({perform:t=>{J().zv({data:{[e]:{type:"formula",value:{type:"simple",value:o}}},store:C.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setRecipient.simple"}),(0,pt().UB)(z,{automationStore:j,automationActionStore:C})}),[C,_,z,j]),fe=(0,re.useCallback)((e=>{_.createAndCommit({perform:t=>{J().zv({data:{from_name:e},store:C.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setFromName"}),(0,pt().UB)(z,{automationStore:j,automationActionStore:C})}),[C,_,z,j]),ve=(0,re.useCallback)((e=>{_.createAndCommit({perform:t=>{J().zv({data:{email_subject:e},store:C.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setSubject"}),(0,pt().UB)(z,{automationStore:j,automationActionStore:C})}),[C,_,z,j]),xe=(0,re.useCallback)((e=>{_.createAndCommit({perform:t=>{J().zv({data:{email_body:e},store:C.getConfigStore(),transaction:t})},userAction:"SendGmailNotificationAction.setBody"}),(0,pt().UB)(z,{automationStore:j,automationActionStore:C})}),[C,_,z,j]),{onTextStoreSelect:Se,onTextStoreUnselect:Ae}=(0,Ht().W)(C),Ce=(0,ce().K8)((()=>{if(!Z||!F)return{};const{createFormulaDataRequestSyncHandler:e}=Z,t={subject:G,body:q,fromName:Y};return Object.fromEntries(si.map((o=>{const n=t[o];return n?[o,(0,Nt().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:e(C.getRecordModel),spaceId:F,valueTypes:Q.slice(0),featureGates:(0,w().i)()},value:n})]:[o,""]})))}),[C.getRecordModel,G,q,Y,Q,Z,F]),ke=(0,re.useCallback)(((e,t)=>{e.stopPropagation(),e.preventDefault(),K((e=>({...e,[t]:!0}))),"displayName"===t&&W((e=>({...e,displayName:!1})))}),[]),Me=(0,re.useCallback)((e=>{W((t=>({...t,[e]:!t[e]})))}),[]),je=(0,re.useCallback)((e=>{var t,o,n;return!("displayName"!==e||null==Y||!Y.value)||(!("cc"!==e||null==O||null===(t=O.cc)||void 0===t||null===(t=t.value)||void 0===t||!t.value)||(!("bcc"!==e||null==O||null===(o=O.bcc)||void 0===o||null===(o=o.value)||void 0===o||!o.value)||!("replyTo"!==e||null==O||null===(n=O.reply_to)||void 0===n||null===(n=n.value)||void 0===n||!n.value)))}),[Y,O]),Te=(0,re.useCallback)((async(e,t)=>{e.stopPropagation(),e.preventDefault();if(je(t)){if(!(await(0,rn().bx)({fieldName:`"${di[t]}"`})))return}"displayName"===t&&fe(void 0),"cc"!==t&&"bcc"!==t||he(t)({type:"simple",value:void 0}),"replyTo"===t&&he("reply_to")({type:"simple",value:void 0}),K((e=>({...e,[t]:!1})))}),[fe,je,he]),Ie=(0,re.useCallback)((()=>{pe().clear({environment:z})}),[z]),{isMobile:we}=(0,se().Y0)(),Pe=(0,ue().IS)((e=>{var t;const o={color:e.text.secondary,fontSize:we?de().J.UIRegular.mobile:de().J.UIRegular.desktop,lineHeight:we?de().K_.UIRegular.mobile:de().K_.UIRegular.desktop,fontWeight:de().Wy.regular};return{inputLabel:{...o},toInputLabel:{...o,...(0,s().O9)(null===(t=ie.to)||void 0===t?void 0:t.errorMessage)&&{color:e.text.uiRedPrimary,fontWeight:de().Wy.medium}},toErrorLabel:{color:e.text.uiRedPrimary},toggleableInputLabel:{...o,cursor:"pointer",padding:2,transform:"translateX(-2px)",display:"flex",width:"fit-content"},toggleableInputLabelHovered:{...o,cursor:"pointer",backgroundColor:e.buttonHoveredBackground,transform:"translateX(-2px)",display:"flex",width:"fit-content",borderRadius:"4px",padding:2},messageInput:{width:"100%"},replyToInputContainer:{display:"flex",justifyContent:"space-between"},replyToInputField:{width:"100%",fontSize:we?de().J.UIRegular.mobile:de().J.UIRegular.desktop},ccBccToggle:{padding:"6px 12px",color:e.text.tertiary,borderRadius:"6px",marginLeft:8,alignSelf:"flex-start"},toggleFieldGridContainer:{display:"grid",gridTemplateRows:"auto auto",gridTemplateColumns:"1fr auto",alignItems:"center",columnGap:8,rowGap:6},toggleFieldGridLabel:{gridRow:"1",gridColumn:"1"},toggleFieldGridInput:{gridRow:"2",gridColumn:"1"},toggleFieldGridTrashIconButton:{gridRow:"2",gridColumn:"2",alignSelf:"flex-start",height:32,width:32},toggleFieldTrashIconButtonForTextInput:{gridRow:"1",gridColumn:"2",alignSelf:"flex-start",marginTop:26,height:32,width:32},trashIcon:{width:Ze().Ev.default,height:Ze().Ev.default}}}),[ie,we]);function _e(e,t){return e||t?!e&&t?Pe.toggleableInputLabelHovered:Pe.inputLabel:Pe.toggleableInputLabel}if(!F)return null;const Be={collectionStore:R,limit:yi,disabled:V,formulaTypecheckContextValues:Q,spaceId:F,pageProperties:X};return(0,Oe.jsxs)(_t().OT,{actionMenu:oe,buttonPopupStore:ee,disabled:V,actionId:C.id,canCollapse:!me,hideDragHandle:me,children:[(0,Oe.jsx)(_t().h3,{actionId:C.id,actionRegistryItem:E,disabled:V,errorMessage:le||(null==ge?void 0:ge.errorMessage),styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,Oe.jsx)(mi,{currentGmailAuthentication:k,gmailAuthentications:M,disabled:V,isError:me,onGmailAccountChange:ye,accountPickerErrorMessage:null===(t=ie.external_bot_id)||void 0===t?void 0:t.errorMessage})}),k&&(0,Oe.jsx)(_t().qt,{children:(0,Oe.jsxs)(Vt().Y1,{direction:"vertical",gap:16,children:[(0,Oe.jsxs)(Vt().Y1,{direction:"vertical",gap:6,children:[(0,Oe.jsx)("label",{style:Pe.toInputLabel,children:(0,Oe.jsx)(D().sA,{...li.toLabel})}),(0,Oe.jsxs)("div",{className:"to-input-and-ccBcc-container",style:Pe.replyToInputContainer,children:[(0,Oe.jsx)(gi,{...Be,recipients:null==O||null===(o=O.to)||void 0===o?void 0:o.value,onChange:he("to"),errorMessage:null===(n=ie.to)||void 0===n?void 0:n.errorMessage,style:Pe.replyToInputField}),(!L.cc||!L.bcc)&&(0,Oe.jsx)(nn().A,{onClick:e=>{L.cc||ke(e,"cc"),L.bcc||ke(e,"bcc")},style:Pe.ccBccToggle,children:L.cc||L.bcc?(0,Oe.jsx)(D().sA,{id:"automations.SendGmailNotificationAction.ccOrBccToggleLabel",defaultMessage:"{showCCLabel, select, true {CC} other {BCC}}",values:{showCCLabel:!L.cc&&L.bcc}}):(0,Oe.jsx)(D().sA,{id:"automations.SendGmailNotificationAction.ccAndBccToggleLabel",defaultMessage:"CC/BCC"})})]}),(0,s().O9)(null===(i=ie.to)||void 0===i?void 0:i.errorMessage)&&(0,Oe.jsx)(an().D,{colorName:"secondary",styleName:"UISmall-12px/Regular",style:Pe.toErrorLabel,children:(0,Oe.jsx)(D().sA,{...null===(l=ie.to)||void 0===l?void 0:l.errorMessageDescriptor})})]}),L.cc&&(0,Oe.jsx)(Vt().Y1,{direction:"vertical",gap:16,children:(0,Oe.jsxs)("div",{style:Pe.toggleFieldGridContainer,children:[(0,Oe.jsxs)("label",{style:Pe.inputLabel,children:[(0,Oe.jsx)(D().sA,{...li.ccLabel}),(0,Oe.jsx)(jo().z,{})]}),(0,Oe.jsx)(gi,{...Be,recipients:null==O||null===(c=O.cc)||void 0===c?void 0:c.value,onChange:he("cc"),errorMessage:null===(u=ie.cc)||void 0===u?void 0:u.errorMessage,style:Pe.toggleFieldGridInput}),(0,Oe.jsx)(Re().A,{icon:eo().trashIcon,ariaLabel:A.formatMessage({id:"automations.SendGmailNotificationAction.removeField",defaultMessage:"Remove Field"}),onClick:e=>Te(e,"cc"),style:Pe.toggleFieldGridTrashIconButton,iconStyle:Pe.trashIcon})]})}),L.bcc&&(0,Oe.jsx)(Vt().Y1,{direction:"vertical",gap:16,children:(0,Oe.jsxs)("div",{style:Pe.toggleFieldGridContainer,children:[(0,Oe.jsxs)("label",{style:{...Pe.inputLabel},children:[(0,Oe.jsx)(D().sA,{...li.bccLabel}),(0,Oe.jsx)(jo().z,{})]}),(0,Oe.jsx)(gi,{...Be,recipients:null==O||null===(d=O.bcc)||void 0===d?void 0:d.value,onChange:he("bcc"),errorMessage:null===(p=ie.bcc)||void 0===p?void 0:p.errorMessage,style:Pe.toggleFieldGridInput}),(0,Oe.jsx)(Re().A,{icon:eo().trashIcon,ariaLabel:A.formatMessage({id:"automations.SendGmailNotificationAction.removeField",defaultMessage:"Remove Field"}),onClick:e=>Te(e,"bcc"),style:Pe.toggleFieldGridTrashIconButton,iconStyle:Pe.trashIcon})]})}),(0,Oe.jsx)(jo().M,{disabled:V,disableMobileActionBar:!1,disableNewLines:!0,disableStyleAnnotations:!0,formulaTypecheckContextValues:Q,onChange:ve,onTextStoreSelect:Se,onTextStoreUnselect:Ae,onTextEsc:Ie,parentRecordStore:C,spaceId:F,style:Pe.messageInput,value:G,analyzedFormulaOutput:Ce.subject,labelMessageDescriptor:li.subjectLabel,errorMessageDescriptor:null===(m=ie.email_subject)||void 0===m?void 0:m.errorMessageDescriptor,shouldShowErrorStyles:(0,s().O9)(null===(h=ie.email_subject)||void 0===h?void 0:h.errorMessage)}),(0,Oe.jsx)(jo().M,{disabled:V,disableMobileActionBar:!1,formulaTypecheckContextValues:Q,onChange:xe,onTextStoreSelect:Se,onTextStoreUnselect:Ae,onTextEsc:Ie,parentRecordStore:C,rows:4,spaceId:F,style:Pe.messageInput,value:q,analyzedFormulaOutput:Ce.body,labelMessageDescriptor:li.bodyLabel,errorMessageDescriptor:null===(f=ie.email_body)||void 0===f?void 0:f.errorMessageDescriptor,shouldShowErrorStyles:(0,s().O9)(null===(v=ie.email_body)||void 0===v?void 0:v.errorMessage)}),!L.displayName&&(0,Oe.jsx)("label",{children:(0,Oe.jsxs)("span",{onClick:e=>ke(e,"displayName"),onMouseEnter:()=>Me("displayName"),onMouseLeave:()=>Me("displayName"),style:_e(L.displayName,N.displayName),children:[(0,Oe.jsx)(D().sA,{...li.fromNameLabel}),"..."]})}),L.displayName&&(0,Oe.jsxs)("div",{style:{...Pe.toggleFieldGridContainer,rowGap:0},children:[(0,Oe.jsx)("div",{style:Pe.toggleFieldGridLabel,children:(0,Oe.jsx)(jo().M,{disabled:V,disableMobileActionBar:!1,formulaTypecheckContextValues:Q,disableNewLines:!0,disableStyleAnnotations:!0,onChange:fe,onTextStoreSelect:Se,onTextStoreUnselect:Ae,onTextEsc:Ie,parentRecordStore:C,rows:1,spaceId:F,value:Y,analyzedFormulaOutput:Ce.fromName,labelMessageDescriptor:li.fromNameLabel,isOptional:!0})}),(0,Oe.jsx)(Re().A,{icon:eo().trashIcon,ariaLabel:A.formatMessage({id:"automations.SendGmailNotificationAction.removeField",defaultMessage:"Remove Field"}),onClick:e=>Te(e,"displayName"),style:Pe.toggleFieldTrashIconButtonForTextInput,iconStyle:Pe.trashIcon})]}),(0,Oe.jsxs)("div",{style:Pe.toggleFieldGridContainer,children:[(0,Oe.jsx)("label",{style:Pe.toggleFieldGridLabel,children:(0,Oe.jsxs)("span",{onClick:e=>ke(e,"replyTo"),onMouseEnter:()=>Me("replyTo"),onMouseLeave:()=>Me("replyTo"),style:_e(L.replyTo,N.replyTo),children:[(0,Oe.jsx)(D().sA,{...li.replyToLabel}),!L.replyTo&&"...",L.replyTo&&(0,Oe.jsx)(jo().z,{})]})}),L.replyTo&&(0,Oe.jsxs)(Oe.Fragment,{children:[(0,Oe.jsx)(gi,{...Be,recipients:null==O||null===(x=O.reply_to)||void 0===x?void 0:x.value,onChange:he("reply_to"),errorMessage:null===(S=ie.reply_to)||void 0===S?void 0:S.errorMessage,limit:1,style:Pe.toggleFieldGridInput}),(0,Oe.jsx)(Re().A,{icon:eo().trashIcon,ariaLabel:A.formatMessage({id:"automations.SendGmailNotificationAction.removeField",defaultMessage:"Remove Field"}),onClick:e=>Te(e,"replyTo"),style:Pe.toggleFieldGridTrashIconButton,iconStyle:Pe.trashIcon})]})]})]})})]})}function mi(e){const{currentGmailAuthentication:t,gmailAuthentications:o,disabled:n,isError:i,onGmailAccountChange:a,accountPickerErrorMessage:r}=e,l=(0,ue().IS)((()=>({title:{display:"inline-flex",minWidth:50,flexWrap:"wrap",gap:6}})),[]),s=function(){const{isMobile:e}=(0,se().Y0)(),t=e?de().J.UISmall.mobile:de().J.UISmall.desktop;return(0,ue().IS)((()=>({container:{alignItems:"center",display:"inline-flex",gap:2,minWidth:50,width:"100%"},lockIcon:{alignSelf:"center",height:"auto",width:t}})),[t])}();return i?(0,Oe.jsx)("div",{style:l.title,children:(0,Oe.jsx)(D().sA,{defaultMessage:"Send mail",id:"automations.SendGmailNotificationAction.header.titleError"})}):(0,Oe.jsx)("div",{style:l.title,children:(0,Oe.jsx)(D().sA,{defaultMessage:"Send mail from{gmailAccountPicker}",id:"automations.SendGmailNotificationAction.header.title",values:{gmailAccountPicker:n?(0,Oe.jsxs)("div",{style:s.container,children:[(0,Oe.jsx)(nt().I,{icon:on().h}),(0,Oe.jsx)("span",{style:de().RC,children:(0,Oe.jsx)(D().sA,{...li.gmailAccountPickerHidden})})]}):(0,Oe.jsx)(ai,{currentGmailAuthentication:t,gmailAuthentications:o,disabled:n,onAccountChange:a,errorMessage:r})}})})}function gi(e){const{recipients:t,style:o,collectionStore:n,...i}=e,{automationStore:a}=(0,be().EC)();return(0,Oe.jsx)("div",{style:o,children:(0,Oe.jsx)(Yn,{currentValue:t,collectionStore:n,parentRecordStore:a,...i})})}const yi=20;var hi=()=>o(678350);const fi=(0,D().YK)({defaultMenuHeader:{defaultMessage:"Select people",id:"automationPersonPicker.defaultMenuHeaderMessage"},personValuePickerPlaceholder:{defaultMessage:"Select up to {maxSelected} people...",id:"automations.personPicker.buttonPlaceholder"}});function vi(e){const{currentValue:t,collectionStore:o,disabled:n,onChange:i,formulaTypecheckContextValues:a,menuHeader:r,limit:l,errorMessage:s,parentRecordStore:c,spaceId:u,style:d}=e,p={type:"person_array"},m=(0,D().tz)(),g=o?{type:"collection",collectionStore:o,property:"person"}:{type:"empty"},y={menuType:Ko().gu.Popup,header:(0,Oe.jsx)(Tt().A,{title:r?m.formatMessage(r):m.formatMessage(fi.defaultMenuHeader)})};return(0,Oe.jsx)(hi().U,{allowedReturnTypes:Io().Yy.person,formulaTypecheckContextValues:a,disabled:n,simpleFormulaContext:g,onChange:i,type:p,value:t,menuProps:y,placeholder:l?m.formatMessage(fi.personValuePickerPlaceholder,{maxSelected:l}):void 0,limit:l,errorMessage:s,parentRecordStore:c,spaceId:u,style:d})}var xi=()=>o(464004);const Si=(0,D().YK)({property:{id:"automationAction.sendInAppNotification.targetType.property",defaultMessage:"Person property"},formula:{id:"automationAction.sendInAppNotification.targetType.formula",defaultMessage:"Specific people"},default:{id:"automations.targetPicker.targetTypePlaceholder",defaultMessage:"Select recipients"}});function bi(e){const{disabled:t,errorMessage:o,selectedTargetType:n,onSelectedTargetTypeChange:i}=e,a=(0,ce().uB)(void 0,at().A),r=(0,je().j)(),l=(0,re.useCallback)((e=>{e!==n&&(i(e),a.reset())}),[i,a,n]);return(0,Oe.jsx)(tt().Ay,{buttonPopupStore:a,popupType:r,alignmentToOrigin:tt().yP.End,placementToOrigin:tt().sx.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,Oe.jsx)(bt().x,{...e,disabled:t,isCompact:!0,isError:Boolean(o),hasActionRequired:!Boolean(n),dropdownButtonType:"dropdown",children:n?(0,Oe.jsx)(D().sA,{...Si[n]}):(0,Oe.jsx)(D().sA,{...Si.default})}),render:e=>(0,Oe.jsx)(Ai,{handleChange:l,selectedTargetType:n})})}function Ai(e){const{handleChange:t}=e,o=(0,It().e)(),n=[(0,re.useMemo)((()=>({action:()=>null,key:"selectUsers",render:e=>(0,Oe.jsx)(et().A,{...e,onClick:()=>t("formula"),title:(0,Oe.jsx)(D().sA,{...Si.formula})})})),[t]),(0,re.useMemo)((()=>({action:()=>null,key:"selectPersonProperty",render:e=>(0,Oe.jsx)(et().A,{...e,onClick:()=>t("property"),title:(0,Oe.jsx)(D().sA,{...Si.property})})})),[t])].filter(s().O9);if(0===n.length)return null;const i={items:n,key:"targetType",render:e=>(0,Oe.jsx)(Tt().A,{topBorder:!0,...e,enableActionSheetTitle:!0})};return(0,Oe.jsx)(Mt().A,{...o,children:(0,Oe.jsx)(jt().Ay,{type:jt().Oh.Vertical,sections:[i],initialFocus:0})})}const Ci=(0,D().YK)({notificationMessageLabel:{defaultMessage:"Message",id:"automations.BaseModalAction.notificationMessageLabel"},personPropertyTargetTypeLabel:{defaultMessage:"Property",id:"automations.SendInAppNotificationAction.personPropertyTargetTypeLabel"},usersTargetTypeLabel:{defaultMessage:"People",id:"automations.SendInAppNotificationAction.usersTargetTypeLabel"},propertyPickerPlaceholder:{defaultMessage:"Select a property",id:"automations.SendInAppNotificationAction.propertyPickerPlaceholder"},personValuePickerMenuHeader:{defaultMessage:"Send notification to",id:"automations.personPicker.menuHeader"}});function ki(e){const{noCollection:t,targetsErrorMessage:o,selectedTargetType:n,disabled:i,onTargetTypeChange:a}=e;return t?(0,Oe.jsx)(D().sA,{defaultMessage:"Send notification to specific people",id:"automations.SendInAppNotificationAction.header.titleButtonBlock",values:{placeholder:"specific people"}}):(0,Oe.jsx)(D().sA,{defaultMessage:"Send notification to{targetTypePicker}",id:"automations.SendInAppNotificationAction.header.title",values:{targetTypePicker:(0,Oe.jsx)(bi,{onSelectedTargetTypeChange:a,disabled:i,errorMessage:o,selectedTargetType:n})}})}function Mi(e){const{isError:t,isMobile:o,selectedTargetType:n}=e,i=(0,ue().IS)((e=>({inputLabel:{color:t?e.text.uiRedPrimary:e.text.secondary,fontSize:o?de().J.UIRegular.mobile:de().J.UIRegular.desktop,lineHeight:o?de().K_.UIRegular.mobile:de().K_.UIRegular.desktop,fontWeight:de().Wy.regular}})),[t,o]),a=(0,ce().K8)((()=>{switch(n){case"property":return Ci.personPropertyTargetTypeLabel;case"formula":return Ci.usersTargetTypeLabel;default:(0,s().HB)(n)}}),[n]);return(0,Oe.jsx)("label",{style:i.inputLabel,children:(0,Oe.jsx)(D().sA,{...a})})}const ji=20;function Ti(e){const{collectionStore:t,currentProperties:o,currentTargetValue:n,disabled:i,errorMessage:a,formulaTypecheckContextValues:r,onTargetValueChange:l,parentRecordStore:c,spaceId:u}=e,d=n.type;switch(d){case"formula":return(0,Oe.jsx)(vi,{collectionStore:t,currentValue:n.value,disabled:Boolean(i),onChange:e=>l({type:"formula",value:e}),parentRecordStore:c,formulaTypecheckContextValues:r,menuHeader:Ci.personValuePickerMenuHeader,limit:ji,errorMessage:a,spaceId:u,style:{width:"100%"}});case"property":return t?(0,Oe.jsx)(xi().l,{availablePropertyIds:o,currentValue:n.propertyId,collectionStore:t,onChange:e=>l({type:"property",propertyId:e}),disabled:Boolean(i),alreadyHaveProperties:Boolean(n.propertyId),placeholderMessage:Ci.propertyPickerPlaceholder,errorMessage:a}):null;default:(0,s().HB)(d)}}function Ii(e,t){if("formula"===t.type||!(0,s().O9)(t.value))return{type:"simple",value:void 0};const o=t.value.filter((t=>{if(!(0,y().qXl)(t))return!1;const o=(0,y().uPN)(t),n=(0,y().snh)(o);if(n){const t=(0,y().NcG)(n);return!new(H().LU)(e,{id:t,table:b().oo},{userId:t}).getIsDeleted()}return(0,y().tVx)(o)}));return{type:"simple",value:(0,Nt().toSimpleFormulaArrayValue)((0,Nt().filterTextValueToSimpleFormulaValueTokens)(o))}}o(737550);var wi=()=>o(841369),Pi=()=>o(21140),_i=()=>o(795727);const Bi=(0,D().YK)({addCustomHeader:{defaultMessage:"Add custom header",id:"automations.BaseModalAction.addCustomHeader"},customHeaderKeyLabel:{defaultMessage:"Key",id:"automations.BaseModalAction.customHeaderKeyLabel"},customHeaderValueLabel:{defaultMessage:"Value",id:"automations.BaseModalAction.customHeaderValueLabel"},removeCustomHeaderAriaLabel:{defaultMessage:"Remove custom header",id:"automations.BaseModalAction.removeCustomHeaderAriaLabel"}});function Ri(e){const{actionStore:t}=e,o=(0,D().tz)(),n=Ji(),{suppressActionErrors:i}=(0,He().b)(),{typecheckResult:a}=(0,be().EC)(),[r,s]=(0,re.useState)(new Set),[c,u]=(0,re.useState)((()=>new(_i().A))),d=(0,ce().K8)((()=>{if(!l().Q.isSuccess(a))return new(_i().A);const e=i.includes(t.id),o=a.value.actionValidationFailures[t.id]||[],n=new(_i().A);return o.forEach((t=>{if("empty_custom_header_field"===t.type){const[o,i,a]=t.key;n.set({id:i,field:a},!e&&!r.has(i)||(c.get({id:i,field:a})||!1))}})),n}),[a,i,t.id,c,r]),{maybePersistedTransactionActions:p}=(0,He().b)(),m=(0,ue().IS)((()=>({customHeadersContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:12},customHeaderInputsContainer:{display:"grid",gridTemplateRows:"auto auto",gridTemplateColumns:"1fr 1fr auto",alignItems:"center",columnGap:8,rowGap:4},customHeaderKeyLabel:{...n.inputLabel,gridRow:1,gridColumn:1},customHeaderValueLabel:{...n.inputLabel,gridRow:1,gridColumn:2},customHeaderKeyInput:{...n.input,gridRow:2,gridColumn:1},customHeaderValueInput:{...n.input,gridRow:2,gridColumn:2},customHeaderRemoveButton:{gridRow:2,gridColumn:3,width:32,height:32},customHeaderRemoveButtonIcon:{width:Ze().Ev.default,height:Ze().Ev.default},addCustomHeaderButton:{marginLeft:-8,marginTop:8}})),[n]),g=(0,ce().K8)((()=>t.getConfigStore().getKeyStore("customHeaders")),[t]),y=(0,ce().K8)((()=>(g.getValue()||[]).map((e=>({...e,id:e.id||(0,Dt().Ay)()})))),[g]),h=(0,re.useCallback)(((e,t)=>()=>{const o=new(_i().A)({from:c.entries()});o.set({id:e,field:t},!0),u(o)}),[c]),f=(0,re.useCallback)(((e,t)=>o=>{const n=(g.getValue()||[]).map((n=>n.id===e?{...n,[t]:o}:n));p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:e=>{J().KY({store:g,transaction:e,value:n})}})}),[g,p]),v=(0,re.useCallback)((()=>{p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:e=>{const t={id:(0,Dt().Ay)(),key:"",value:""};J().KY({store:g,transaction:e,value:[...y,t]}),s((e=>{const o=new Set(e);return o.add(t.id),o}))}})}),[y,g,p]),x=(0,re.useCallback)((e=>()=>{const t=y.filter((t=>t.id!==e));p.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:e=>{J().KY({store:g,transaction:e,value:t})}})}),[y,g,p]),S=y.length>0&&(0,Oe.jsx)("div",{style:m.customHeadersContainer,children:y.map((e=>(0,Oe.jsxs)("div",{style:m.customHeaderInputsContainer,children:[(0,Oe.jsx)("label",{style:m.customHeaderKeyLabel,children:(0,Oe.jsx)(D().sA,{...Bi.customHeaderKeyLabel})}),(0,Oe.jsx)("label",{style:m.customHeaderValueLabel,children:(0,Oe.jsx)(D().sA,{...Bi.customHeaderValueLabel})}),(0,Oe.jsx)("div",{}),(0,Oe.jsx)(Ue,{style:m.customHeaderKeyInput,value:e.key,onChange:f(e.id,"key"),errorOutline:d.get({id:e.id,field:"key"}),onBlur:h(e.id,"key"),autoFocus:!e.key,maxlength:wi().Sx}),(0,Oe.jsx)(Ue,{style:m.customHeaderValueInput,value:e.value,onChange:f(e.id,"value"),errorOutline:d.get({id:e.id,field:"value"}),onBlur:h(e.id,"value"),maxlength:wi().Sx}),(0,Oe.jsx)(Re().A,{icon:eo().trashIcon,ariaLabel:o.formatMessage(Bi.removeCustomHeaderAriaLabel),style:m.customHeaderRemoveButton,iconStyle:m.customHeaderRemoveButtonIcon,onClick:x(e.id)})]},e.id)))});return(0,Oe.jsxs)(Oe.Fragment,{children:[S,y.length<wi().qu&&(0,Oe.jsx)(Pi().Ye,{children:(0,Oe.jsx)(Lt().p,{isGray:!0,onClick:v,style:m.addCustomHeaderButton,children:(0,Oe.jsx)(D().sA,{...Bi.addCustomHeader})})})]})}var Vi=()=>o(721479),Ei=()=>o(148024),Di=()=>o(187485),Fi=()=>o(836251);function Oi(e){const t=(0,se().v3)(),o=(0,D().tz)();return(0,Oe.jsx)(Ee().A,{renderTooltip:()=>(0,Oe.jsx)(D().sA,{defaultMessage:"Learn more",id:"webhookAction.helpButton.tooltip"}),render:e=>(0,Oe.jsx)(Di().A,{...e,href:(0,Fi().xS)("guides.webhookAction"),onClick:()=>Ei().FH(t,{from:"webhookAction"}),external:!0,children:(0,Oe.jsx)(Re().A,{...e,ariaLabel:o.formatMessage({id:"webhookAction.helpButton.ariaLabel",defaultMessage:"Learn about webhook actions"}),icon:Vi().questionMarkCircleSmallIcon,iconStyle:{width:Ze().Ev.sm,height:Ze().Ev.sm}})})})}Oi.displayName="SendWebhookActionHelpLink";var Li=()=>o(713998),Ki=()=>o(743176),Ni=()=>o(488887);const Wi=new Set(["title","text","relation","checkbox","number","person","file","url","email","phone_number","created_time","created_by","last_edited_time","last_edited_by","last_visited_time","formula","rollup","select","multi_select","date","status","auto_increment_id","location","verification","place"]);const zi=(0,D().YK)({selectAllPropertiesDescription:{defaultMessage:"New properties will not be included automatically",id:"automations.BaseModalAction.selectAllPropertiesDescription"},selectAllProperties:{defaultMessage:"Select all existing properties",id:"automations.BaseModalAction.selectAllProperties"},propertyPickerLabel:{defaultMessage:"Content",id:"automations.BaseModalAction.propertyPickerLabel"},propertyDisabledMissingPermissionTooltip:{defaultMessage:"This property references a database you don't have access to",id:"automations.SendWebhookActionPropertyPicker.propertyDisabledMissingPermissionTooltip"},propertyDisabledUnsupportedTypeTooltip:{defaultMessage:"This property type is not supported",id:"automations.SendWebhookActionPropertyPicker.propertyDisabledUnsupportedTypeTooltip"}});function Hi(){return(0,ue().IS)((e=>({buttonMenuItemContent:{height:34,gap:6},buttonMenuItem:{borderRadius:4}})),[])}function Ui(e){let{collectionStore:t,value:o,onChange:n}=e;const i=Hi(),a=Ji(),l=(0,ce().K8)((()=>t.getSchema()),[t]),s=(0,re.useMemo)((()=>new Set("some"===o.type?o.some||[]:Object.keys(l))),[l,o]),c=function(e){const{value:t}=(0,it().fJ)(I().T.formulas),{value:o}=(0,it().fJ)(I().T.formulaPermissions),n=(0,ce().K8)((()=>{if(!t)return;const o=(0,w().i)();return{allowedReturnTypes:[{type:"unknown"}],handleDataRequest:(0,f().MC)({collectionFeatureGates:o,experimentService:_().default,getRecordModel:e.getRecordModel,loadRecordModel:e.loadRecordModel}),restrictUnaccessibleProperties:"cross_space_and_read_permissions",spaceId:e.getSpaceId(),valueTypes:[],featureGates:o}}),[t,e]),[i]=(0,yn().Yb)((async()=>{if(!t||!n||!o)return;const i=e.getSchema(),a=Object.keys(i),r=await(0,q().lX)(a,3,(async t=>{const a=(0,Li()._g)({schema:i,property:t});if(a)return Wi.has(a.type)?await o.hasAccessToProperty({collectionPointer:e.pointer,collectionSchema:i,context:n,propertyId:t,hasAccessFn:o.hasAccessDefaultFn})?void 0:"missing_permission":"unsupported_property_type"})),l=new Map;return r.forEach(((e,t)=>{l.set(a[t],e)})),l.size>0?l:void 0}),[e,n,t,o]);return i}(t),u=(0,re.useMemo)((()=>c.value||new Map),[c]),d=(0,re.useMemo)((()=>new Set(Array.from(u.entries()).filter((e=>{let[t,o]=e;return void 0===o})).map((e=>{let[t]=e;return t})))),[u]),p=(0,re.useMemo)((()=>"some"===o.type&&(0,Ni()._)(s,d)),[o.type,s,d]),m=(0,re.useRef)(null),g=(0,re.useCallback)((e=>{s.has(e)?s.delete(e):s.add(e),n({type:"some",some:Array.from(s)})}),[s,n]),y=(0,ue().IS)((e=>({sectionMenuItem:{padding:8},propertyPickerContainer:{display:"flex",flexDirection:"column",border:`1px solid ${e.regularDividerColor}`,borderRadius:8,maxHeight:212,overflowY:"auto",marginBottom:2},selectAllPropertiesButtonTitle:{display:"flex",alignItems:"center",gap:4},selectAllPropertiesCheckboxContainer:{height:34,width:30,display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:4},selectAllPropertiesCheckbox:{cursor:"pointer"}})),[]),h=(0,re.useCallback)((()=>{n(p?{type:"some",some:[]}:{type:"some",some:Array.from(d.values())})}),[p,n,d]);(0,re.useEffect)((()=>{m.current&&(m.current.indeterminate=s.size>0&&!p)}),[p,s,o.type]);const v=Object.keys(l),x=(0,re.useMemo)((()=>v.sort(((e,t)=>{const o=(0,Li()._g)({schema:l,property:e}),n=(0,Li()._g)({schema:l,property:t});if("title"===(null==o?void 0:o.type))return-1;if("title"===(null==n?void 0:n.type))return 1;const i=(null==o?void 0:o.name)||"",a=(null==n?void 0:n.name)||"";return i.localeCompare(a)}))),[v,l]);if(!u)return null;const S=(0,r().oE)(x.map((e=>{const t=(0,Li()._g)({schema:l,property:e});if(!t)return null;return{key:e,render:o=>(0,Oe.jsx)(Yi,{...o,propertySchema:t,selected:s.has(e),noAccessReason:u.get(e),buttonStyle:i.buttonMenuItem,style:i.buttonMenuItemContent}),action:()=>{g(e)}}}))),b=(0,r().oE)([{key:0,render:e=>(0,Oe.jsx)(Tt().A,{...e,style:y.sectionMenuItem}),items:[{key:0,render:e=>(0,Oe.jsx)(et().A,{...e,style:i.buttonMenuItemContent,buttonStyle:i.buttonMenuItem,title:(0,Oe.jsxs)("div",{style:y.selectAllPropertiesButtonTitle,children:[(0,Oe.jsx)(D().sA,{...zi.selectAllProperties}),(0,Oe.jsx)(Gi,{})]}),leftStyle:y.selectAllPropertiesCheckboxContainer,left:(0,Oe.jsx)("input",{type:"checkbox",readOnly:!0,checked:p,ref:m,style:y.selectAllPropertiesCheckbox})}),action:h}]},{key:1,render:e=>(0,Oe.jsx)(Tt().A,{topBorder:!0,style:y.sectionMenuItem,...e}),items:S}]);return(0,Oe.jsxs)(Oe.Fragment,{children:[(0,Oe.jsx)("label",{style:a.inputLabel,children:(0,Oe.jsx)(D().sA,{...zi.propertyPickerLabel})}),(0,Oe.jsx)("div",{style:y.propertyPickerContainer,children:(0,Oe.jsx)(jt().Ay,{type:jt().Oh.Vertical,sections:b,initialFocus:void 0,resetFocusOnMouseOut:!0})})]})}function Yi(e){const{propertySchema:t,noAccessReason:o}=e,n=(0,ue().DP)(),i=(0,se().v3)(),{name:a,type:r,icon:l}=t,s=Hi(),c=(0,ue().IS)((e=>({buttonMenuItemTitle:{color:o?e.text.tertiary:e.text.secondary},propertyIcon:{fill:o?e.icon.tertiary:e.icon.secondary,height:Ze().Ev.sm,width:Ze().Ev.sm,display:"flex",alignItems:"center",justifyContent:"center"},checkBoxInput:{cursor:o?void 0:"pointer"},checkboxContainer:{height:34,width:30,display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:4}})),[o]),u=(0,Oe.jsx)(et().A,{title:a,disabled:Boolean(o),style:s.buttonMenuItemContent,titleStyle:c.buttonMenuItemTitle,icon:(0,Oe.jsx)(Ki().zB,{icon:l,type:r,size:i.device.isMobile?18:16,theme:n,style:c.propertyIcon}),left:(0,Oe.jsx)("div",{style:c.checkboxContainer,children:(0,Oe.jsx)("input",{type:"checkbox",readOnly:!0,checked:e.selected,disabled:Boolean(o),style:c.checkBoxInput})}),...e});return o?(0,Oe.jsx)(qi,{noAccessReason:o,children:u}):u}function Gi(){return(0,Oe.jsx)(Ee().A,{renderTooltip:()=>(0,Oe.jsx)(D().sA,{...zi.selectAllPropertiesDescription}),render:e=>(0,Oe.jsx)("div",{...e,children:(0,Oe.jsx)(nt().I,{icon:Vi().questionMarkCircleSmallIcon,size:"sm",color:"secondary"})}),placement:Gt().W.Top})}function qi(e){const{children:t,noAccessReason:o}=e;return(0,Oe.jsx)(Ee().A,{renderTooltip:()=>"missing_permission"===o?(0,Oe.jsx)(D().sA,{...zi.propertyDisabledMissingPermissionTooltip}):"unsupported_property_type"===o?(0,Oe.jsx)(D().sA,{...zi.propertyDisabledUnsupportedTypeTooltip}):void(0,s().HB)(o),originGap:0,render:e=>(0,Oe.jsx)("div",{...e,children:t}),placement:Gt().W.Left})}const $i=(0,D().YK)({urlInputLabel:{defaultMessage:"URL",id:"automations.BaseModalAction.urlInputLabel"}});function Ji(){const{isMobile:e}=(0,se().Y0)();return(0,ue().IS)((t=>({inputLabel:{color:t.text.secondary,fontSize:e?de().J.UIRegular.mobile:de().J.UIRegular.desktop},input:{backgroundColor:t.contentBackground,paddingTop:6,paddingBottom:6},helpText:{color:t.text.secondary,fontSize:e?de().J.UISmall.mobile:de().J.UISmall.desktop}})),[e])}const Qi={create_page:function(e){const{actionStore:t}=e,n=(0,se().v3)(),{automationStore:i}=(0,be().EC)(),{disabled:r,maybePersistedTransactionActions:l,suppressActionErrors:c}=(0,He().b)(),u=(0,a().getActionRegistryItem)("create_page"),[d,p]=(0,ce().K8)((()=>{const e=t.getConfig();return[null==e?void 0:e.properties,null==e?void 0:e.values]}),[t]),[m,g]=(0,ce().K8)((()=>{const e=t.getCollectionStore();return null!=e&&e.isDefined()?[e,{collection:e.getSpaceShardedPointer(),type:"collection"}]:[void 0,void 0]}),[t]),y=(0,ce().K8)((()=>gt(m).length>0),[m]),h=(0,ce().K8)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.template_page_id}),[t]),f=(0,re.useMemo)((()=>({values:p??{},properties:d??[]})),[p,d]),v=(0,ce().uB)(void 0,at().A),x=(0,re.useCallback)((()=>v.reset()),[v]),S=(0,re.useMemo)((()=>(0,Oe.jsx)(yt().z,{actionStore:t,closeMenu:x})),[t,x]),b=(0,ce().K8)((()=>(0,s().O9)(t.getConfigStore().getKeyStore("collection").getValue())),[t]),A=(0,re.useCallback)((e=>{"collection"===e.type&&(l.createAndCommit({perform:o=>{J().zv({data:{collection:e.collection,properties:["title"],template_page_id:null,values:null},store:t.getConfigStore(),transaction:o})},userAction:"CreatePageAction.setCollection"}),(0,pt().UB)(n,{automationStore:i,automationActionStore:t}))}),[l,n,i,t]),C=(0,re.useCallback)((e=>{const{properties:o,values:a}=f;let r=!1;if(e&&o&&1===o.length&&o.includes("title")){var s;const e=null==a?void 0:a.title;e&&null!==(s=e.value)&&void 0!==s&&s.value||(r=!0)}l.createAndCommit({perform:o=>{J().zv({store:t.getConfigStore(),data:{template_page_id:e??null,...r&&{properties:[]}},transaction:o})},userAction:"CreatePageAction.onTemplateChange"}),(0,pt().UB)(n,{automationStore:i,automationActionStore:t})}),[f,l,n,i,t]),k=(0,re.useMemo)((()=>!c.includes(t.id)),[c,t]),{errorMessage:M,errorIcon:j}=(0,ae().useErrorComponentForAction)({actionId:t.id,errorKeys:["collection","config",t.id],shouldShow:k}),{errorMessage:T}=(0,ae().useErrorComponentForAction)({actionId:t.id,errorKey:"template",shouldShow:k}),I=Boolean(r);return(0,Oe.jsxs)(_t().OT,{actionId:t.id,actionMenu:S,buttonPopupStore:v,canCollapse:b,disabled:I,children:[(0,Oe.jsxs)(_t().h3,{actionId:t.id,actionRegistryItem:u,disabled:I,errorMessage:M||T,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:[(0,Oe.jsx)(Bt,{actionStore:t,disabled:I,errorMessage:M,errorIcon:j,onChange:A,value:g}),(0,s().O9)(m)&&(y||(0,s().O9)(h))&&(0,Oe.jsx)(Rt,{collectionStore:m,disabled:I,errorMessage:T,onChange:C,value:h})]}),m&&(0,Oe.jsx)(_t().qt,{disabled:I,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,Oe.jsx)(o(95199).Ud,{actionStore:t,collectionStore:m,disabled:I,showSetPropertyActions:!1})})]})},update_pages:o(686169).w,query_collection:function(){return null},open_page:function(e){const{actionStore:t}=e,{disabled:o,maybePersistedTransactionActions:n,suppressActionErrors:i}=(0,He().b)(),r=(0,ce().uB)(void 0,at().A),l=(0,a().getActionRegistryItem)("open_page"),s=(0,ce().K8)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.target}),[t]),{contextType:c}=(0,be().EC)(),u=(0,ce().K8)((()=>{if(!(0,Io().Fx)(c))return;const e=t.getIndex();return(0,Io().cQ)(e)?"allow":"disallow_with_message"}),[t,c]),d=(0,ce().K8)((()=>s&&"url"!==s.type),[s]),p=(0,re.useMemo)((()=>({headerWrap:{paddingInlineEnd:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}})),[]),m=(0,re.useCallback)((e=>{n.createAndCommit({perform:o=>{J().zv({store:t.getConfigStore(),data:{target:e},transaction:o})},userAction:"OpenPageAction.setTarget"})}),[n,t]),g=(0,re.useCallback)((e=>{n.createAndCommit({perform:o=>{J().zv({store:t.getConfigStore(),data:{open_in:e},transaction:o})},userAction:"OpenPageAction.setPeekMode"})}),[n,t]),y=(0,re.useCallback)((()=>r.reset()),[r]),h=(0,re.useMemo)((()=>!i.includes(t.id)),[i,t]),{errorMessage:f}=(0,ae().useErrorComponentForAction)({actionId:t.id,shouldShow:h}),v=(0,re.useMemo)((()=>(0,Oe.jsx)(yt().z,{actionStore:t,closeMenu:y})),[t,y]),x=Boolean(o);return(0,Oe.jsx)(_t().OT,{actionMenu:v,buttonPopupStore:r,actionId:t.id,canCollapse:!1,children:(0,Oe.jsxs)(_t().h3,{actionId:t.id,actionRegistryItem:l,disabled:x,styles:p,children:[(0,Oe.jsx)(_o,{actionStore:t,disabled:x,errorMessage:f,onChange:m,value:s,urlBehavior:u}),d?(0,Oe.jsx)(Bo,{actionStore:t,disabled:x,onChange:g}):null]})})},duplicate_blocks:function(e){const{actionStore:t}=e,{disabled:o,editorPlacement:n}=(0,He().b)(),i=(0,se().v3)(),l=(0,ue().IS)((()=>({title:{display:"inline-flex",flexWrap:"wrap",gap:6,whiteSpace:"pre-wrap"}})),[]),s=(0,ce().K8)((()=>(0,r().$1)(t.getBlockPointers())),[t],{useDeepEqual:!0}),c=(0,ce().K8)((()=>function(e){const t=Object.values(xo).find((t=>t.key===e));return t??So}(t.getInsertionPoint())),[t]),u=(0,re.useCallback)((e=>function(e,t,o){X().createAndCommit({userAction:"DuplicateBlocksAction.setInsertionPoint",environment:e,canUndo:!0,perform:e=>{J().zv({store:t.getConfigStore(),data:{insertion_point:o},transaction:e})}})}(i,t,e)),[t,i]),d=(0,ce().uB)(void 0,at().A),p=(0,re.useCallback)((()=>d.reset()),[d]),m=(0,re.useMemo)((()=>(0,Oe.jsx)(yt().z,{actionStore:t,closeMenu:p})),[t,p]),g=(0,a().getActionRegistryItem)("duplicate_blocks"),y=Boolean(o);return(0,Oe.jsxs)(_t().OT,{actionMenu:m,buttonPopupStore:d,disabled:y,actionId:t.id,canCollapse:!0,children:[(0,Oe.jsx)(_t().h3,{actionId:t.id,actionRegistryItem:g,disabled:y,children:(0,Oe.jsx)("div",{style:l.title,children:(0,Oe.jsx)(D().sA,{...vo.title,values:{insertionPicker:(0,Oe.jsx)(bo,{currentOption:c,disabled:y,onChange:u})}})})}),(0,Oe.jsx)(_t().qt,{disabled:y,children:s?(0,Oe.jsx)(Co,{actionStore:t,buttonPlacement:n,contentParentPointer:s,disabled:y}):null})]})},modal_confirmation:function(e){const{actionStore:t}=e,o=(0,se().v3)(),{isMobile:n}=(0,se().Y0)(),{automationStore:i}=(0,be().EC)(),r=(0,D().tz)(),{disabled:l,maybePersistedTransactionActions:s}=(0,He().b)(),c=Boolean(l),u=(0,a().getActionRegistryItem)("modal_confirmation"),[d,p]=(0,ce().K8)((()=>[t.id,t.getSpaceId()]),[t]),m=(0,St().F)({actionId:d}),g=(0,ue().IS)((e=>({input:{backgroundColor:e.contentBackground,paddingTop:6,paddingBottom:6},inputLabel:{color:e.text.tertiary,fontSize:n?14:12,lineHeight:1.3,fontWeight:de().Wy.medium,display:"flex",alignItems:"center"}})),[n]),y=(0,ce().uB)(void 0,at().A),h=(0,re.useCallback)((()=>y.reset()),[y]),f=(0,re.useMemo)((()=>(0,Oe.jsx)(yt().z,{actionStore:t,closeMenu:h})),[t,h]),v=(0,ce().K8)((()=>t.getConfigStore().getKeyStore("text")),[t]),x=(0,ce().K8)((()=>v.getValue()),[v]),S=(0,ce().K8)((()=>{if(p)return(0,Nt().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:(0,ko().createFormulaDataRequestSyncHandler)(t.getRecordModel),spaceId:p,valueTypes:m.slice(0),featureGates:(0,w().i)()},value:x})}),[p,t.getRecordModel,m,x]),b=(0,ce().K8)((()=>t.getConfigStore().getKeyStore("continue_button").getKeyStore("text")),[t]),A=(0,ce().K8)((()=>t.getConfigStore().getKeyStore("cancel_button").getKeyStore("text")),[t]),C=(0,re.useCallback)((e=>{s.createAndCommit({userAction:"BaseModalAction.handleTextChange",perform:t=>{J().KY({store:v,value:e,transaction:t})}}),(0,pt().UB)(o,{automationStore:i,automationActionStore:t})}),[t,i,o,s,v]),k=(0,re.useCallback)((()=>{(0,pt().UB)(o,{automationStore:i,automationActionStore:t})}),[t,i,o]),{onTextStoreSelect:M,onTextStoreUnselect:j}=(0,Ht().W)(t);return p&&S?(0,Oe.jsxs)(_t().OT,{actionMenu:f,buttonPopupStore:y,disabled:c,actionId:t.id,canCollapse:!0,children:[(0,Oe.jsx)(_t().h3,{actionId:t.id,actionRegistryItem:u,disabled:c,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,Oe.jsx)(D().sA,{...u.display.name})}),(0,Oe.jsx)(_t().qt,{disabled:c,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,Oe.jsxs)(Vt().Y1,{direction:"vertical",gap:16,children:[(0,Oe.jsx)(jo().M,{disabled:c,disableMobileActionBar:!0,formulaTypecheckContextValues:m,onChange:C,onTextStoreSelect:M,onTextStoreUnselect:j,parentRecordStore:t,placeholder:r.formatMessage(To.confirmationMessageLabel),rows:4,spaceId:p,value:x,analyzedFormulaOutput:S,labelMessageDescriptor:To.confirmationMessageLabel}),(0,Oe.jsxs)(Vt().Y1,{direction:"vertical",gap:6,children:[(0,Oe.jsx)("label",{style:g.inputLabel,children:(0,Oe.jsx)(D().sA,{...To.continueButtonTextLabel})}),(0,Oe.jsx)(Ye,{disabled:c,maxlength:Mo().Vx,onChange:k,style:g.input,store:b})]}),(0,Oe.jsxs)(Vt().Y1,{direction:"vertical",gap:6,children:[(0,Oe.jsx)("label",{style:g.inputLabel,children:(0,Oe.jsx)(D().sA,{...To.cancelButtonTextLabel})}),(0,Oe.jsx)(Ye,{disabled:c,maxlength:Mo().Vx,onChange:k,style:g.input,store:A})]})]})})]}):null},slack_notification:o(500071).y9,send_in_app_notification:function(e){var t;const{actionStore:o}=e,{isMobile:n}=(0,se().Y0)(),{automationStore:i,contextType:r}=(0,be().EC)(),{disabled:l,maybePersistedTransactionActions:c,suppressActionErrors:u}=(0,He().b)(),d=(0,sn().y)(i,r),p=!(0,s().O9)(d),m=Boolean(l),g=(0,a().getActionRegistryItem)("send_in_app_notification"),y=(0,ce().K8)((()=>o.getSpaceId()),[o]),h=(0,ce().K8)((()=>null==d?void 0:d.getSpaceShardedPointer()),[d]),f=(0,ce().K8)((()=>{if(!d)return[];return(0,Io().Ge)({collectionFormat:d.getFormat(),collectionSchema:d.getSchema(),spaceId:d.getSpaceId(),restrictCrossSpace:!0})}),[d]),v=(0,ce().K8)((()=>{var e;return null==o||null===(e=o.getConfig())||void 0===e?void 0:e.target}),[o]),x=(0,St().F)({actionId:o.id}),S=(0,se().v3)();cn("formula"===(null==v?void 0:v.type)?null==v||null===(t=v.value)||void 0===t?void 0:t.value:void 0);const b=(0,ce().K8)((()=>{var e;return null===(e=o.getConfig())||void 0===e?void 0:e.notification_message}),[o]),A=(0,ce().K8)((()=>{if(y)return(0,Nt().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:(0,ko().createFormulaDataRequestSyncHandler)(o.getRecordModel),spaceId:y,valueTypes:x.slice(0),featureGates:(0,w().i)()},value:b})}),[o.getRecordModel,b,x,y]),C=(0,ce().uB)(void 0,at().A),k=(0,re.useCallback)((()=>C.reset()),[C]),M=(0,re.useMemo)((()=>(0,Oe.jsx)(yt().z,{actionStore:o,closeMenu:k})),[o,k]),j=(0,re.useMemo)((()=>!u.includes(o.id)),[u,o]),{errorMessages:T,errorMessageDescriptors:I}=function(e){const{actionId:t,shouldShowError:o}=e,n={},i={};n.target=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"target"}).errorMessage;const a=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"notification_message"});return n.notification_message=a.errorMessage,i.notification_message=a.errorMessageDescriptor,n.collectionPointer=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"collectionPointer"}).errorMessage,n.propertyId=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"propertyId"}).errorMessage,n.formulaValue=(0,ae().useErrorComponentForAction)({actionId:t,shouldShow:o,errorKey:"formulaValue"}).errorMessage,{errorMessages:n,errorMessageDescriptors:i}}({actionId:o.id,shouldShowError:j}),P=(0,ce().K8)((()=>(0,s().O9)(o.getConfigStore().getKeyStore("target").getValue())),[o]),_=(0,re.useCallback)((e=>{c.createAndCommit({perform:t=>{J().zv({data:{target:{type:e}},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setTargetType"})}),[o,c]);(0,re.useEffect)((()=>{!v&&p&&_("formula")}),[v,p,_]);const B=(0,re.useCallback)((e=>{const t=e.value;if(!t)return;let n;"formula"===t.type?n={type:"formula",value:t}:"simple"===t.type?n={type:"formula",value:Ii(S,t)}:(0,s().HB)(t.type),c.createAndCommit({perform:e=>{J().zv({data:{target:{type:"formula",value:n.value}},store:o.getConfigStore(),transaction:e})},userAction:"SendInAppNotificationAction.setTarget"}),(0,pt().UB)(S,{automationStore:i,automationActionStore:o})}),[i,o,S,c]),R=(0,re.useCallback)((e=>{c.createAndCommit({perform:t=>{J().zv({data:{target:{...e,collectionPointer:h}},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setTarget"}),(0,pt().UB)(S,{automationStore:i,automationActionStore:o})}),[o,i,h,S,c]),V=(0,re.useCallback)((e=>{switch(e.type){case"formula":return B(e);case"property":return R(e);default:(0,s().HB)(e)}}),[B,R]),E=(0,re.useCallback)((e=>{c.createAndCommit({perform:t=>{J().zv({data:{notification_message:e},store:o.getConfigStore(),transaction:t})},userAction:"SendInAppNotificationAction.setNotificationMessage"}),(0,pt().UB)(S,{automationStore:i,automationActionStore:o})}),[o,i,S,c]),{onTextStoreSelect:D,onTextStoreUnselect:F}=(0,Ht().W)(o),O=(0,re.useCallback)((()=>{pe().clear({environment:S})}),[S]);return y&&A?(0,Oe.jsxs)(_t().OT,{actionMenu:M,buttonPopupStore:C,disabled:m,actionId:o.id,canCollapse:P,children:[(0,Oe.jsx)(_t().h3,{actionId:o.id,actionRegistryItem:g,disabled:l,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,Oe.jsx)(ki,{noCollection:p,targetsErrorMessage:T.target,selectedTargetType:null==v?void 0:v.type,onTargetTypeChange:_,disabled:Boolean(l)})}),v&&(0,Oe.jsx)(_t().qt,{children:(0,Oe.jsxs)(Vt().Y1,{direction:"vertical",gap:16,children:[(0,Oe.jsxs)(Vt().Y1,{direction:"vertical",gap:6,children:[(0,Oe.jsx)(Mi,{isMobile:n,selectedTargetType:v.type,isError:Boolean("property"===v.type?T.propertyId:T.formulaValue)}),(0,Oe.jsx)("div",{children:(0,Oe.jsx)(Ti,{collectionStore:d,disabled:Boolean(l),formulaTypecheckContextValues:x,currentTargetValue:v,currentProperties:f,onTargetValueChange:V,errorMessage:"property"===v.type?T.propertyId:T.formulaValue,parentRecordStore:o,spaceId:y})})]}),(0,Oe.jsx)(jo().M,{analyzedFormulaOutput:A,labelMessageDescriptor:Ci.notificationMessageLabel,disabled:m,disableMobileActionBar:!0,errorMessageDescriptor:I.notification_message,formulaTypecheckContextValues:x,onChange:E,onTextStoreSelect:D,onTextStoreUnselect:F,onTextEsc:O,parentRecordStore:o,rows:3,spaceId:y,value:b})]})})]}):null},send_gmail_notification:function(e){const{actionStore:t}=e,o=function(e){return(0,ce().K8)((()=>{const t=e.getConfigStore().getKeyStore("external_bot_id").getValue();if(!t)return;return ln().A.externalAuthentications.state.find((e=>e.integration_id===tn().eg&&t===e.id))}),[e])}(t),n=(0,ce().K8)((()=>ln().A.externalAuthentications.state.filter((e=>e.integration_id===tn().eg))),[]);return(0,Oe.jsx)(pi,{actionStore:t,gmailAuthentications:n,currentGmailAuthentication:o,allGmailAuthentications:n})},define_variables:function(e){const{actionStore:t}=e,o=(0,se().v3)(),n=(0,D().tz)(),{automationStore:i}=(0,be().EC)(),{disabled:r,maybePersistedTransactionActions:l}=(0,He().b)(),s=Boolean(r),c=(0,a().getActionRegistryItem)("define_variables"),u=(0,ce().K8)((()=>i.getActionStores()),[i]),d=(0,ce().K8)((()=>{const e=t.getConfigStore().getValue();return{values:(null==e?void 0:e.values)??{},variableIds:(null==e?void 0:e.variableIds)??[]}}),[t]),p=(0,ce().uB)(void 0,at().A),m=(0,re.useCallback)((()=>p.reset()),[p]),g=(0,re.useMemo)((()=>(0,Oe.jsx)(yt().z,{actionStore:t,closeMenu:m})),[t,m]),y=(0,re.useCallback)((()=>{l.createAndCommit({perform:e=>{!function(e){const{automationActionStore:t,automationActionStores:o,intl:n,transaction:i}=e,a=(0,Dt().Ay)(),r={name:(0,Ft().v)(o,n.formatMessage(Et().xC)),value:{type:"simple",value:[[""]]}};J().zv({data:{[a]:r},store:t.getConfigStore().getKeyStore("values"),transaction:i}),X().applyOperation({operation:{args:{id:a},command:"listAfter",path:["config","variableIds"],pointer:t.pointer},store:t,transaction:i})}({automationActionStore:t,automationActionStores:u,intl:n,transaction:e})},userAction:"DefineVariablesAction.addVariable"}),(0,pt().UB)(o,{automationStore:i,automationActionStore:t})}),[t,u,i,o,n,l]),h=(0,ue().IS)((()=>({headerWrap:{paddingRight:32},titleWrap:{whiteSpace:"pre-wrap"},footer:{display:"flex",overflow:"hidden"}})),[]);return(0,Oe.jsxs)(_t().OT,{actionMenu:g,buttonPopupStore:p,disabled:s,actionId:t.id,canCollapse:!0,children:[(0,Oe.jsx)(_t().h3,{actionId:t.id,actionRegistryItem:c,disabled:s,styles:{headerWrap:h.headerWrap,titleWrap:h.titleWrap},children:(0,Oe.jsx)(D().sA,{...c.display.name})}),(0,Oe.jsx)(_t().qt,{disabled:s,children:(0,Oe.jsxs)(Vt().Y1,{direction:"vertical",gap:16,children:[d.variableIds.length>0&&(0,Oe.jsx)(Vt().Y1,{direction:"vertical",gap:14,children:d.variableIds.map((e=>d.values[e]?(0,Oe.jsx)(po,{actionStore:t,variableId:e},e):null))}),(0,Oe.jsx)("footer",{style:h.footer,children:(0,Oe.jsx)(Kt,{disabled:s,onClick:y})})]})})]})},http_request:function(e){const{actionStore:t}=e,{disabled:n,maybePersistedTransactionActions:i,suppressActionErrors:r}=(0,He().b)(),{automationStore:s,contextType:c,typecheckResult:u}=(0,be().EC)(),d=(0,sn().y)(s,c),p=Boolean(n),m=(0,a().getActionRegistryItem)("http_request"),g=Ji(),y=(0,ce().uB)(void 0,at().A),h=(0,re.useCallback)((()=>y.reset()),[y]),f=(0,re.useMemo)((()=>(0,Oe.jsx)(yt().z,{actionStore:t,closeMenu:h})),[t,h]),v=(0,ce().K8)((()=>t.getConfigStore().getKeyStore("url")),[t]),x=(0,ce().K8)((()=>t.getConfigStore().getKeyStore("selectedProperties")),[t]),S=(0,ce().K8)((()=>x.getValue()||{type:"some",some:[]}),[x]),b=(0,re.useCallback)((e=>{i.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:t=>{J().KY({store:x,transaction:t,value:e})}})}),[x,i]),A=(0,ue().IS)((e=>({divider:{marginBottom:8,marginTop:8},dividerColor:{color:e.stroke.secondary},errorMessage:{color:e.text.redTertiary}})),[]),[C,k]=(0,re.useState)(!1),M=(0,re.useMemo)((()=>!r.includes(t.id)||C),[r,t.id,C]),j=(0,ce().K8)((()=>{if(!l().Q.isSuccess(u)||!M)return!1;return(u.value.actionValidationFailures[t.id]||[]).some((e=>"invalid_url"===e.type))}),[u,t,M]),T=(0,ae().useRequiresSubscriptionUpgradeError)({actionId:t.id,shouldShow:M}),I=Boolean(T),w=(0,re.useCallback)((()=>{k(!0)}),[]);return(0,Oe.jsxs)(_t().OT,{actionMenu:f,buttonPopupStore:y,disabled:p,actionId:t.id,canCollapse:!I,hideDragHandle:I,children:[(0,Oe.jsx)(_t().h3,{actionId:t.id,actionRegistryItem:m,disabled:p,errorMessage:T,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"inline-flex",flexWrap:"wrap",gap:"6px 0"}},children:(0,Oe.jsx)(D().sA,{...m.display.name})}),(0,Oe.jsxs)(_t().qt,{disabled:p,styles:{bodyWrap:{display:"grid",gap:4,gridTemplateColumns:"1fr",minWidth:0}},children:[(0,Oe.jsx)("label",{style:g.inputLabel,children:(0,Oe.jsxs)(Pi().Ye,{alignItems:"center",gap:4,children:[(0,Oe.jsx)(D().sA,{...$i.urlInputLabel}),(0,Oe.jsx)(Oi,{})]})}),(0,Oe.jsx)(Ye,{disabled:p,style:g.input,store:v,errorOutline:j,onBlur:w,maxlength:wi().i8}),j&&(0,Oe.jsx)("div",{style:A.errorMessage,children:(0,Oe.jsx)(D().sA,{id:"SendWebhookAction.invalidUrl",defaultMessage:"Invalid URL"})}),(0,Oe.jsx)(Ri,{actionStore:t}),d&&(0,Oe.jsxs)(Oe.Fragment,{children:[(0,Oe.jsx)(o(802790).A,{size:1,style:A.divider,dividerColor:A.dividerColor.color}),(0,Oe.jsx)(Ui,{collectionStore:d,value:S,onChange:b})]})]})]})},publish_site:function(e){const{actionStore:t}=e,{disabled:o,maybePersistedTransactionActions:n,suppressActionErrors:i}=(0,He().b)(),r=(0,ce().K8)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.target}),[t]),l=Boolean(o),s=(0,a().getActionRegistryItem)("publish_site"),c=(0,ce().uB)(void 0,at().A),u=(0,re.useCallback)((e=>{"url"!==e.type&&n.createAndCommit({perform:o=>{J().zv({store:t.getConfigStore(),data:{target:e},transaction:o})},userAction:"PublishSiteAction.setTarget"})}),[n,t]),d=(0,re.useCallback)((()=>c.reset()),[c]),p=(0,re.useMemo)((()=>!i.includes(t.id)),[i,t]),{errorMessage:m}=(0,ae().useErrorComponentForAction)({actionId:t.id,shouldShow:p}),g=(0,re.useMemo)((()=>(0,Oe.jsx)(yt().z,{actionStore:t,closeMenu:d})),[t,d]);return(0,Oe.jsxs)(_t().OT,{actionMenu:g,buttonPopupStore:c,disabled:l,actionId:t.id,canCollapse:!0,children:[(0,Oe.jsx)(_t().h3,{actionId:t.id,actionRegistryItem:s,disabled:l,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,Oe.jsx)(Ho,{actionStore:t,disabled:l,errorMessage:m,onTargetChange:u,value:r})}),(0,Oe.jsxs)(_t().qt,{disabled:l,styles:{sectionBodyWrap:{display:"grid",gap:4,gridTemplateColumns:"1fr",minWidth:0}},children:[(0,Oe.jsx)(Uo,{}),(0,Oe.jsx)(Yo,{})]})]})}};var Zi=()=>o(142755);function Xi(e){const{children:t}=e,{isMobile:o}=(0,se().Y0)(),n=(0,ue().IS)((e=>({wrap:{color:e.text.tertiary,fontSize:o?14:12,lineHeight:1.3,fontWeight:de().Wy.medium}})),[o]);return(0,Oe.jsx)("div",{style:n.wrap,children:t})}const ea=(0,D().YK)({newActionLabel:{defaultMessage:"New action",id:"AutomationActionSelectButton.actionSection.newAction"},addActionLabel:{defaultMessage:"Add action",id:"AutomationActionSelectButton.actionSection.addAction"},addActionAriaLabel:{id:"collectionSettings.editAutomationView.addAction.iconButton",defaultMessage:"Add action"},builderModalActionTitle:{defaultMessage:"Do",id:"builderModal.editAutomationView.actionSection.title"}});function ta(e){let{isEditable:t}=e;const{automationStore:o}=(0,be().EC)(),{disabled:n}=(0,He().b)(),i=(0,ct().V)(),{contextType:a}=(0,be().EC)(),r="button_block"===a||"button_property"===a,l=(0,ce().K8)((()=>o.getActionStores().map((e=>e.isDefined()&&e.hasConcern("display")?e:null)).filter(s().Pe)),[o]),c=l.length>0,u=(0,ue().IS)((e=>({section:{display:"flex",flexDirection:"column",gap:4,width:"100%",...r&&{marginTop:20}},header:{alignItems:"center",display:"flex",flexDirection:"row",height:24},list:{display:"flex",flexDirection:"column"}})),[r]),d=t&&i.length>0||!c;return(0,Oe.jsxs)("section",{style:u.section,children:[(0,Oe.jsx)("header",{style:u.header,children:(0,Oe.jsx)(Xi,{children:(0,Oe.jsx)(D().sA,{...ea.builderModalActionTitle})})}),(0,Oe.jsxs)("div",{style:u.list,children:[t?(0,Oe.jsx)(na,{actionStores:l}):(0,Oe.jsx)(oa,{actionStores:l}),d&&(0,Oe.jsx)("footer",{children:(0,Oe.jsx)(ra,{disabled:n,hasAnyActions:c,variant:"button"})})]})]})}function oa(e){let{actionStores:t}=e;const o=(0,$e().vV)();return(0,Oe.jsx)("div",{style:o.wrap,children:(0,Oe.jsx)("div",{style:o.list,children:t.map((e=>(0,Oe.jsx)("div",{className:$e().xB,children:(0,Oe.jsx)(ia,{actionStore:e})},e.id)))})})}function na(e){let{actionStores:t}=e;const o=(0,se().v3)(),{automationStore:n,contextType:a}=(0,be().EC)(),{disabled:r,onActionDragStart:l,onActionDragEnd:c,maybePersistedTransactionActions:u}=(0,He().b)(),d=(0,D().tz)(),{value:p}=(0,it().fJ)(I().T.formulas),{value:m}=(0,it().fJ)(Xe().QV.automationTypecheck),g=(0,lt().n)(n),y=(0,st().j)(),{automationActionMap:h,actionStoreIds:f}=(0,ce().K8)((()=>{const e=[],t=new Map;return n.getActionStores().forEach((o=>{o.isDefined()&&o.hasConcern("display")&&(e.push(o.id),t.set(o.id,o))})),{automationActionMap:t,actionStoreIds:e}}),[n]),v=(0,ce().uB)(void 0,rt().A),x=(0,re.useCallback)((e=>{const t=e.state;if(t.willDrag){const e=h.get(t.draggingKey);(0,s().O9)(e)&&(0,s().O9)(l)&&l(e)}else t.willDrag||t.isDragging||null==c||c()}),[h,c,l]);(0,re.useEffect)((()=>(v.addListener(x),()=>v.removeListener(x))),[h,v,x]);const S=(0,re.useCallback)(((e,t)=>{p&&m&&u.createAndCommit({userAction:"AutomationButtonAction.moveAction",perform:r=>{i().reorderAutomationActions({environment:o,automationStore:n,automationTypecheckModule:m,contextType:a,formulasModule:p,intl:d,newActionIds:e,transaction:r,from:"drag_and_drop",movedActionId:t.key,isSubscribed:g,pageStore:y})}})}),[y,n,a,m,p,d,u,o,g]),b=(0,re.useMemo)((()=>!r&&t.length>1),[r,t]),A=(0,re.useCallback)(((e,t)=>{const o=h.get(e);return(0,s().O9)(o)?(0,Oe.jsx)(ia,{actionStore:o},o.id):null}),[h]);return t.length>0?(0,Oe.jsx)(aa,{draggableListStore:v,hasDragging:b,keys:f,onDrop:S,renderKey:A}):null}function ia(e){const{actionStore:t}=e,o=(0,ce().K8)((()=>t.getType()),[t]);if(!o)return null;const n=Qi[o];return(0,Oe.jsx)(n,{actionStore:t})}function aa(e){const{draggableListStore:t,hasDragging:o,keys:n,onDrop:i,renderKey:a}=e,{isMobile:r}=(0,se().Y0)(),l=(0,$e().vV)();return(0,Oe.jsx)("div",{style:l.wrap,children:(0,Oe.jsx)(ot().Ay,{childClassName:$e().xB,direction:"vertical",disabled:!o||r,keys:n,onDrop:i,renderKey:a,store:t,style:l.list})})}function ra(e){const{disabled:t,hasAnyActions:o,variant:n}=e,i=(0,je().j)(),a=(0,D().tz)(),r=(0,re.useMemo)((()=>({availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"})),[]),l=(0,ce().uB)(void 0,at().A),s=(0,re.useCallback)((()=>l.reset()),[l]),c=(0,ue().IS)((e=>({buttonWrap:{boxShadow:"initial",background:"transparent"},button:{color:e.text.secondary,fill:e.icon.secondary,margin:0,width:"100%"}})),[]),u=Boolean(t);return(0,Oe.jsx)(tt().Ay,{alignmentToOrigin:tt().yP.Start,buttonPopupStore:l,disabled:u,placementToOrigin:tt().sx.Bottom,popupType:i,render:()=>(0,Oe.jsx)(ut().A,{initialState:r,onClose:s}),renderOrigin:e=>"icon"===n?(0,Oe.jsx)(Re().A,{...e,ariaLabel:a.formatMessage(ea.addActionAriaLabel),disabled:u,disabledFeedback:u,icon:Qe().plusSmallIcon,iconStyle:{width:Ze().Ev.sm,height:Ze().Ev.sm}}):"button"===n?(0,Oe.jsx)(Zi().F,{...e,ariaLabel:a.formatMessage(ea.addActionAriaLabel),disabled:u,icon:(0,Oe.jsx)(nt().I,{icon:Qe().plusSmallIcon,size:"sm"}),title:(0,Oe.jsx)(D().sA,{...o?ea.addActionLabel:ea.newActionLabel})}):(0,Oe.jsx)(et().A,{...e,buttonStyle:c.button,disabled:u,disabledFeedback:u,focused:!1,icon:(0,Oe.jsx)(nt().I,{icon:Je().plusIcon}),style:c.buttonWrap,title:o?(0,Oe.jsx)(D().sA,{id:"automations.addActionButton.nonEmpty.label",defaultMessage:"Add another step"}):(0,Oe.jsx)(D().sA,{id:"automations.addActionButton.empty.label",defaultMessage:"Add a step"})})})}function la(e){const{areActionsEditable:t,areTriggersEditable:o,footer:n}=e,{isMobile:i}=(0,se().Y0)(),a=(0,ue().IS)((e=>({verticalRule:{background:e.stroke.primary,borderRadius:2,height:56,marginBottom:5,marginLeft:0,marginTop:16,width:2},container:{alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",padding:i?"0 16px":void 0}})),[i]);return(0,Oe.jsxs)("div",{style:a.container,children:[(0,Oe.jsx)($e().Kn,{isEditable:o}),(0,Oe.jsx)("div",{style:a.verticalRule}),(0,Oe.jsx)(ta,{isEditable:t}),n]})}const sa=(0,D().YK)({editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You donâ€™t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"},done:{defaultMessage:"Done",id:"buttonBlock.button.done"},noEditError:{defaultMessage:"You donâ€™t have full access to edit this button",id:"buttonBlock.button.noEditError"}});function ca(e){var t,o,n;const{buttonBlockStore:i}=e,a=(0,ce().K8)((()=>i.state.editing?i.state:void 0),[i]),r=(0,ue().IS)((e=>{var t;return{popup:{width:400},editor:{background:e.contentBackground,..."inline"===(null==a||null===(t=a.placement)||void 0===t?void 0:t.type)?{marginTop:6,borderRadius:6,border:`1px solid ${e.regularDividerColor}`,maxWidth:600}:{}}}}),[null==a||null===(t=a.placement)||void 0===t?void 0:t.type]),l=(0,je().j)({tabletBehavior:"slideUp"});return a&&a.placement?"popup"===(null===(o=a.placement)||void 0===o?void 0:o.type)?(0,Oe.jsx)(ye().Ay,{open:!0,popupType:l,render:()=>(0,Oe.jsx)(ua,{...e,style:r.editor}),originRect:a.placement.originRect,style:r.popup,originGap:4,onDismiss:()=>{i.stopEditing()}}):"inline"===(null===(n=a.placement)||void 0===n?void 0:n.type)?(0,Oe.jsx)(ua,{...e,style:r.editor}):void(0,s().HB)(a.placement):null}function ua(e){var t;const{disabled:o,store:n,buttonBlockStore:i}=e,a=(0,se().v3)(),[r,l]=(0,ve().z)(),s=(0,ue().IS)((e=>({scroller:{maxHeight:"75vh"},container:{fontFamily:de().Tf.sans},footerButton:{height:32,width:"100%"},upgradeMessageWrap:{margin:8},footerButtonWrap:{width:"100%",display:"flex",flexDirection:"column",paddingTop:24}})),[]),c=(0,ce().K8)((()=>n.getAutomationStore()),[n]),u=(0,ce().K8)((()=>null==c?void 0:c.getSpaceId()),[c]),{maybePersistedAutomationStore:d,maybePersistedTransactionActions:p}=(0,Ie().t)({automationId:null==c?void 0:c.id,spaceId:u,defaultValue:void 0,persist:!0}),m=(0,Te().OW)({store:n,automationStore:d}),g=(0,ce().K8)((()=>{var e;return n.canEdit()&&"sufficient"===(null==m||null===(e=m.state)||void 0===e?void 0:e.editPermissionStatus)}),[n,m]),y=(0,ce().K8)((()=>i.state.editing?i.state.placement:void 0),[i]),h=(0,ce().K8)((()=>{var e;return null===(e=te().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),f=(0,Se()._X)({name:"slack_automation_action",spaceId:u,userId:null==h?void 0:h.id}),v=(0,ke().c)({automationStores:[d],slackActionFeatureAvailability:f}),x=(0,re.useCallback)((e=>{(0,le().SQ)({event:e,context:le().y$.Click,callback:()=>{pe().clear({environment:a}),Z().IU({environment:a})}})}),[a]),S=(0,re.useCallback)((()=>{i.stopEditing(),(0,j().u)({environment:a,event:{eventName:"click_configure_button_done",eventProperties:{block_id:n.id,automation_id:null==d?void 0:d.id}}}),_().default.logEvent("click_configure_button_done")}),[i,a,n,d]),b=(0,ce().K8)((()=>i.state.suppressErrorsForActionIds),[i]),A=(0,re.useCallback)((e=>i.suppressErrorsForAction(e.id)),[i]),C=f&&"expiry"in f&&null!==(t=f.expiry)&&void 0!==t&&t.upsell?f.expiry.upsell:void 0,k=(0,we().k)({from:"button_block_automation_header_message",upsell:C}),M=(0,we().k)({from:"button_block_automation_header_message",upsell:null==f?void 0:f.upsell}),T=(0,Me().c)(),I=(0,ce().K8)((()=>{var e;return!(null==m||null===(e=m.state)||void 0===e||!e.typecheckResult)&&(0,Ce().h)({environment:a,typecheckResult:m.state.typecheckResult,automationStore:d})}),[m,a,d]),w=o||!g;return d?(0,Oe.jsx)("div",{ref:r,style:{...s.container,...e.style},onClick:x,children:(0,Oe.jsx)(be().u,{automationStore:d,contextType:"button_block",children:(0,Oe.jsxs)(Ae().v,{value:{disabled:w,editorPlacement:y,editorWidth:l,maybePersistedTransactionActions:p,onActionAdded:A,suppressActionErrors:b,hideDragHandle:I,...T},defaultCollapseActions:I,children:[(0,Oe.jsx)(da,{blockStore:n,disabled:w}),(0,Oe.jsxs)(fe().H,{style:s.scroller,type:xe().A.Y,children:[I&&(0,Oe.jsx)("div",{style:s.upgradeMessageWrap,children:(0,Oe.jsx)(qe().j,{onUpsellClick:M})}),v&&(0,Oe.jsx)("div",{style:s.upgradeMessageWrap,children:(0,Oe.jsx)(Ge().v,{onUpsellClick:k})}),!g&&(0,Oe.jsx)("div",{style:s.upgradeMessageWrap,children:(0,Oe.jsx)(Pe().z,{children:(0,Oe.jsx)(D().sA,{...sa.noEditError})})}),(0,Oe.jsx)("section",{style:{paddingBlock:8,paddingInline:8},children:(0,Oe.jsx)(la,{areActionsEditable:!I,areTriggersEditable:!1,footer:(0,Oe.jsx)("div",{style:s.footerButtonWrap,children:(0,Oe.jsx)(he().A,{onClick:S,style:s.footerButton,children:(0,Oe.jsx)(D().sA,{...sa.done})})})})})]})]})})}):null}function da(e){const{blockStore:t,disabled:o}=e,{automationStore:n}=(0,be().EC)(),i=(0,se().v3)(),a=(0,ue().IS)((e=>({wrap:{display:"flex",flexDirection:"column",padding:12,gap:6},inputs:{display:"flex",alignItems:"center",gap:6,borderBottom:`1px solid ${e.stroke.secondary}`,paddingBottom:12},nameInputWrap:{flexGrow:"1"},nameInput:{background:"transparent",boxShadow:"none",padding:4}})),[]),r=(0,ce().K8)((()=>n.getNameStore()),[n]),l=(0,ce().K8)((()=>n.getIconStore()),[n]),s=(0,ce().K8)((()=>(null==r?void 0:r.getValue())??""),[r]),c=(0,ce().K8)((()=>null==l?void 0:l.getValue()),[l]),u=(0,re.useCallback)(((e,t)=>{X().createAndCommit({userAction:"ButtonBlock.updateProperty",environment:i,canUndo:!0,perform:o=>{J().zv({store:n.getPropertiesStore(),transaction:o,data:{[e]:t??null}})}})}),[n,i]),d=(0,re.useCallback)((e=>u("icon",e)),[u]),p=(0,re.useCallback)((e=>u("name",e)),[u]);return(0,Oe.jsx)(me().s,{allowSelectionWithin:!0,style:a.wrap,children:(0,Oe.jsxs)("div",{style:a.inputs,children:[(0,Oe.jsx)(Ke,{disabled:o,currentIcon:c,handleIconChange:d,store:t}),(0,Oe.jsx)(Ue,{onChange:p,value:s,disabled:o,placeholder:P().A.formatMessage(sa.buttonPlaceholder),wrapStyle:a.nameInputWrap,style:a.nameInput,format:ge().C.ExtraLarge,autoFocus:!s})]})})}var pa=()=>o(591779),ma=()=>o(728611),ga=(o(16280),()=>o(495408)),ya=()=>o(881254);function ha(e){var t;const{url:o,parentStore:n,onMouseEnter:i,onMouseLeave:a}=e,r=(0,se().v3)(),[l]=(0,yn().Yb)((async()=>{var e,t;const n=await $().callApi({eventName:"getDataForLinkMention",environment:r,data:{url:o,spaceId:(null===(e=te().default.state.currentSpaceStore)||void 0===e?void 0:e.id)??(null===(t=te().default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId()),source:"button_hover"}});if("success"===n.type){if("error"in n.data)throw new Error(`Error in iframely response: ${n.data.status} ${n.data.error}`);return n.data}throw n.error}),[r,o]);let s;return s=null!==(t=l.value)&&void 0!==t&&t.iframe?(0,Oe.jsx)(ga().p,{hoverData:l.value,iframe_url:l.value.iframe,height:l.value.height,padding:l.value.padding,padding_top:l.value.padding_top,store:n,href:o,showEditButton:!1}):(0,Oe.jsx)(ya().R,{hoverData:l.value,href:o,showEditButton:!1,store:n,loading:"pending"===l.status}),(0,Oe.jsx)("div",{onMouseEnter:i,onMouseLeave:a,children:s})}function fa(e){const{renderOrigin:t}=e;return(0,se().Y0)().isMobile?(0,Oe.jsx)(Oe.Fragment,{children:t()}):(0,Oe.jsx)(va,{...e})}function va(e){const{renderOrigin:t,urlToPreview:o,parentStore:n}=e,[i,a]=(0,re.useState)(!1),l=(0,re.useMemo)((()=>({onMouseEnter:()=>{a(!0)},onMouseLeave:()=>{a(!1)}})),[]),s=function(e){const{targetHovered:t}=e,[o,n]=(0,re.useState)(!1),i=(0,pa().lW)(t,400,Object.is),[a,l]=(0,re.useState)(!1),s=a||!o&&i,c=(0,re.useCallback)((()=>l(s)),[s]),u=(0,re.useCallback)((()=>{l(!1)}),[]),d=(0,re.useCallback)((()=>{u(),n(!0)}),[u]);return(0,re.useEffect)((()=>{n(!1)}),[i]),(0,re.useEffect)((()=>{const e=r().nF((()=>{d()}),200,{leading:!0});return ma().P4(window,"scroll",e,!0),()=>ma().Ol(window,"scroll",e,!0)}),[d]),{state:s,pinPopup:c,unpinPopup:u}}({targetHovered:i});return(0,Oe.jsx)(ye().Ay,{disableMouseCapture:!0,preventCaptureEsc:!0,preventScaleTransition:!0,originGap:6,preventOpacityTransition:!0,open:s.state,popupType:ye().nl.Popup,alignmentToOrigin:Gt().C.Start,placementToOrigin:Gt().W.Bottom,render:()=>(0,Oe.jsx)(ha,{url:o,parentStore:n,onMouseEnter:s.pinPopup,onMouseLeave:s.unpinPopup}),origin:t(l)})}},65767:(e,t,o)=>{o.d(t,{l:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("closeThick",{viewBox:"0 0 8 8",svg:(0,n.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},73332:(e,t,o)=>{o.d(t,{T:()=>u});var n=o(296540),i=()=>o(401497),a=()=>o(340498),r=o(474848);const l=(0,a().wt)("roundedCheckPartial",{viewBox:"0 0 14 14",svg:(0,r.jsx)("path",{d:"M5.33496 7.91016C4.85645 7.91016 4.5 7.63672 4.5 7.14355C4.5 6.64551 4.85645 6.37695 5.33496 6.37695H8.66016C9.14355 6.37695 9.5 6.64551 9.5 7.14355C9.5 7.63672 9.14355 7.91016 8.66016 7.91016H5.33496Z"})}),s=(0,a().wt)("roundedSquareCheckbox",{viewBox:"0 0 14 14",svg:(0,r.jsx)("rect",{x:"0.5",y:"0.5",width:"13",height:"13",rx:"2.5"})});var c=()=>o(381349);const u=n.memo(n.forwardRef((function(e,t){const{checked:a,disabled:u=!1,onClick:d,size:p,fill:m="none",stroke:g=c().Ay.uiLightGray,round:y=!1,thinOutline:h=!1,tooltipHeader:f,tapArea:v,checkedColor:x=c().Ay.blue,withComma:S,style:b,id:A,disallowTabbing:C,...k}=e,M=(0,n.useMemo)((()=>{switch(p){case 10:return 8;case 12:return 10;case 14:return 12;case 16:return 14;case 20:return 16;case 22:return 18}}),[p]),j=(0,i().IS)((()=>{const e=v?v.size:p;return{root:{width:p,height:p,display:"flex",alignItems:"center",justifyContent:"center",transition:"background 200ms ease-out",borderRadius:10===p?2:3,...!1!==a&&{background:x},...y&&{borderRadius:"50%"},...b},input:{width:e,height:e,top:-(e-p)/2,left:-(e-p)/2},iconWhite:{fill:c().Ay.white,width:M,height:M},iconDefault:{fill:m,stroke:g}}}),[v,p,a,x,y,b,M,m,g]),T=(0,i().DP)(),I=(0,n.useMemo)((()=>!0===a||"partial"===a?("partial"===a?l:o(980585).n)(j.iconWhite):y?h?"light"===T.mode?(0,o(953624).k)(j.iconDefault):(0,o(753476).e)(j.iconDefault):(0,o(968307).Z)(j.iconDefault):s(j.iconDefault)),[a,y,h,j.iconDefault,j.iconWhite,T.mode]),w=(0,n.useCallback)((()=>f),[f]),P=(0,n.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o(435801)._,{ref:t,checked:a,disabled:u,onClick:d,style:j.root,inputStyle:j.input,id:A,disallowTabbing:C,...k,...e,children:(0,r.jsx)("div",{"aria-hidden":"true",children:I})}),S?", ":""]})}),[t,a,u,d,j.root,j.input,A,C,k,I,S]);return f?(0,r.jsx)(o(859428).A,{renderTooltip:w,render:P}):P()})))},75858:(e,t,o)=>{o.d(t,{Li:()=>P,iD:()=>w,yA:()=>E,V6:()=>b,_n:()=>M,Yk:()=>_,rD:()=>T,w_:()=>F,xX:()=>k,wh:()=>W,dr:()=>N,Gx:()=>O,q4:()=>K,MX:()=>L,fs:()=>D,VT:()=>C,fA:()=>j,LX:()=>R,l:()=>V,L:()=>I,kb:()=>A,Sh:()=>B,cm:()=>S});var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(959013),l=()=>o(2220),s=()=>o(928600),c=()=>o(939740),u=()=>o(897119),d=()=>o(722872),p=()=>o(108944),m=()=>o(217429),g=()=>o(457717),y=()=>o(864040),h=o(474848);function f(e){const{store:t}=e,o=(0,i().Y0)(),r=(0,a().O$)(g().F),l=(0,n.useCallback)((()=>{g().F.setState({open:!1})}),[]);return o.isMobile?(0,h.jsx)(u().Ay,{popupType:u().nl.BottomSheet,bottomSheetInitialState:"half",trapFocus:!0,open:r.open,render:()=>(0,h.jsx)(v,{store:t,onClose:l}),onDismiss:l}):null}function v(e){const{store:t,onClose:o}=e,n=(0,i().v3)(),u=(0,a().K8)((()=>{const e=p().fU(t);return e.reverse(),e}),[t]),g={menuType:d().gu.Modal,title:(0,h.jsx)(r().sA,{defaultMessage:"Breadcrumb",id:"breadcrumb.mobileBreadcrumbMenu.title"})};return(0,h.jsx)(s().A,{...g,children:(0,h.jsx)(c().Ay,{type:c().Oh.Vertical,onAccept:o,initialFocus:void 0,sections:(0,y().A)(n,u,(e=>{(0,l().u)({environment:n,event:{eventName:"topbar_breadcrumb_page_click",eventProperties:{page_id:e.id}}}),m().default.logEvent("topbar_breadcrumb_page_click",void 0,{page_id:e.id})}))})})}var x=()=>o(645873);const S=new(x().O2)("menus",(async()=>{const[{default:e},{TopbarPageAnalyticsOptOutMenu:t},{default:n},{default:i},{default:a},{default:r},{default:l},{default:s},{default:c},{default:u},{default:d},{SidebarTeamModal:p},{SidebarCreateTeamModal:m},{CreateTeamFromPageConfirmModal:g},{CollectionTypedDatabaseMigrationModal:y},{default:h},{default:v},{default:x},{MobilePageBacklinksMenuRenderer:S},{MobileShareMenuRenderer:b},{MobilePageUpdatesMenuRenderer:A},{MobileCommentsModalRenderer:C}]=await Promise.all([Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,74355)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,687110)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,467935)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,742784)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,381495)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,952305)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,70463)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,946576)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,996594)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,554778)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,339806)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,353289)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,83842)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,135546)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,438988)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,275193)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,756710)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,877263)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,220172)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,417242)),Promise.all([o.e(75134),o.e(9304),o.e(16471),o.e(58550),o.e(44711),o.e(53321),o.e(90825),o.e(96346),o.e(55373),o.e(37353),o.e(29151),o.e(78191),o.e(62475),o.e(3151),o.e(98629),o.e(49889),o.e(97727),o.e(22900),o.e(85128),o.e(95555),o.e(14659),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(48632),o.e(74562),o.e(27711),o.e(4422),o.e(11341),o.e(46414),o.e(95168),o.e(28271),o.e(34877),o.e(36908),o.e(17254),o.e(84185),o.e(32421),o.e(15315),o.e(24587),o.e(78708),o.e(43777),o.e(74752),o.e(91194),o.e(81197),o.e(98659),o.e(20502),o.e(6266),o.e(8184),o.e(83884),o.e(65881),o.e(99809),o.e(93282),o.e(43678),o.e(15019),o.e(90978),o.e(3910),o.e(77213),o.e(6912),o.e(21194),o.e(30291),o.e(39541),o.e(12913),o.e(45620),o.e(54220),o.e(19930),o.e(81768),o.e(58102),o.e(52836),o.e(26483),o.e(19687),o.e(6463),o.e(68137),o.e(50569),o.e(40925),o.e(24975),o.e(282),o.e(87250),o.e(93847),o.e(79928),o.e(7203),o.e(61349),o.e(55197),o.e(94256),o.e(76690),o.e(29669),o.e(24930),o.e(62573),o.e(33882),o.e(44763),o.e(1440),o.e(5044),o.e(31782),o.e(93449),o.e(63996),o.e(895),o.e(66559),o.e(35986),o.e(45683),o.e(78862),o.e(38536),o.e(92924),o.e(64819),o.e(67378),o.e(40186),o.e(97339),o.e(55717),o.e(63797),o.e(56352),o.e(52811),o.e(28398),o.e(21367),o.e(65351),o.e(22686),o.e(4112),o.e(31889),o.e(36009),o.e(81973),o.e(2600),o.e(77663),o.e(97832),o.e(75681)]).then(o.bind(o,274072)),Promise.all([o.e(75134),o.e(49889),o.e(97727),o.e(48632),o.e(21194),o.e(79928),o.e(52811),o.e(4412),o.e(75840),o.e(18331)]).then(o.bind(o,503307))]);return{CustomizePageMenuRenderer:e,TopbarPageAnalyticsOptOutMenu:t,ImportModal:n,ExportModal:i,PageTemplateModal:a,GoogleAuthPromptModal:r,StudentNotEligibleModal:l,CookieModal:s,ForkPagePopup:c,DatePropertyMenu:u,ReportPageModal:d,SidebarCreateTeamModal:m,SidebarTeamModal:p,CreateTeamFromPageConfirmModal:g,CollectionTypedDatabaseMigrationModal:y,OpenInDesktopAppPopup:h,BlockMenu:v,ImportIntoNewPageModal:x,MobilePageBacklinksMenuRenderer:S,MobileShareMenuRenderer:b,MobilePageUpdatesMenuRenderer:A,MobileCommentsModalRenderer:C,MobileBreadcrumbMenuRenderer:f}})),b=(0,x()._h)(S,(e=>e.CustomizePageMenuRenderer)),A=(0,x()._h)(S,(e=>e.TopbarPageAnalyticsOptOutMenu)),C=(0,x()._h)(S,(e=>e.PageTemplateModal)),k=(0,x()._h)(S,(e=>e.ImportModal)),M=(0,x()._h)(S,(e=>e.ExportModal)),j=(0,x()._h)(S,(e=>e.ReportPageModal)),T=(0,x()._h)(S,(e=>e.GoogleAuthPromptModal)),I=(0,x()._h)(S,(e=>e.StudentNotEligibleModal)),w=(0,x()._h)(S,(e=>e.CookieModal)),P=(0,x()._h)(S,(e=>e.BlockMenu)),_=(0,x()._h)(S,(e=>e.ForkPagePopup)),B=(0,x()._h)(S,(e=>e.CollectionTypedDatabaseMigrationModal)),R=(0,x()._h)(S,(e=>e.SidebarCreateTeamModal)),V=(0,x()._h)(S,(e=>e.SidebarTeamModal)),E=(0,x()._h)(S,(e=>e.CreateTeamFromPageConfirmModal)),D=(0,x()._h)(S,(e=>e.OpenInDesktopAppPopup)),F=(0,x()._h)(S,(e=>e.ImportIntoNewPageModal)),O=(0,x()._h)(S,(e=>e.MobilePageBacklinksMenuRenderer)),L=(0,x()._h)(S,(e=>e.MobileShareMenuRenderer)),K=(0,x()._h)(S,(e=>e.MobilePageUpdatesMenuRenderer)),N=(0,x()._h)(S,(e=>e.MobileCommentsModalRenderer)),W=(0,x()._h)(S,(e=>e.MobileBreadcrumbMenuRenderer))},80524:(e,t,o)=>{o.r(t),o.d(t,{AutomationBuilderModal:()=>dt,ButtonBuilderModal:()=>Ct});o(944114),o(898992),o(354520),o(737550);var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(422540),s=()=>o(278132),c=()=>o(66913),u=()=>o(912720),d=()=>o(959013),p=()=>o(496603),m=()=>o(973647),g=()=>o(534177),y=()=>o(284371),h=()=>o(686526),f=()=>o(436572),v=()=>o(813297),x=()=>o(735695),S=()=>o(704152),b=()=>o(939740),A=()=>o(864943),C=()=>o(204063),k=()=>o(89924),M=()=>o(898125),j=()=>o(584262),T=()=>o(101209),I=()=>o(735384),w=()=>o(693954),P=()=>o(792071),_=()=>o(142748),B=()=>o(179034),R=()=>o(824862),V=()=>o(519831),E=()=>o(96689),D=()=>o(867201),F=()=>o(679924),O=()=>o(837570),L=()=>o(774256),K=()=>o(903854),N=()=>o(826352),W=()=>o(546461),z=()=>o(293096),H=()=>o(76190),U=()=>o(284489),Y=()=>o(493823),G=()=>o(719147),q=()=>o(862292),$=()=>o(157857),J=()=>o(731320),Q=()=>o(645873),Z=()=>o(765957),X=()=>o(630116),ee=()=>o(329304),te=o(474848);const oe=(0,d().YK)({automationIncompatibleViewFilterAndOwner:{defaultMessage:"This automation may not work because the view has a non-supported filter",id:"AutomationHeaderView.incompatibleCollectionViewFilter.owner"},automationPublicAccess:{defaultMessage:"This automation is part of a public page",id:"AutomationHeaderView.automationPublicAccess"},automationUpgrade:{defaultMessage:"<anchor-upsell>Upgrade</anchor-upsell> to edit this automation or create your own",id:"AutomationHeaderView.automationUpgrade"},automationEditOnSite:{defaultMessage:"This automation can only be edited on notion.com",id:"AutomationHeaderView.automationEditOnSite"},automationExternalBotNoPermissions:{defaultMessage:"Ask {user} to edit this automation",id:"AutomationHeaderView.automationExternalBotNoPermissions"},automationExternalBotWithPermissions:{defaultMessage:"Ask {user} to edit this automation or <anchor-delete>delete</anchor-delete> it when necessary",id:"AutomationHeaderView.automationExternalBotWithPermissions"},automationMissingPermissionsNoPermissionsForDatabase:{defaultMessage:"You must have full access to target databases in this automation to edit it",id:"AutomationHeaderView.automationMissingPermissionsNoPermissionsForDatabase"},automationGenericFullAccess:{defaultMessage:"You must have full access to this database to edit automations",id:"AutomationHeaderView.automationGenericFullAccess"},automationCollectionInTrashedPage:{defaultMessage:"This database is in the trash and cannot be edited.",id:"AutomationHeaderView.automationCollectionInTrash"},automationCollectionInTrashedPageViewDeletedPageButton:{defaultMessage:"View deleted page",id:"AutomationHeaderView.automationCollectionInTrashedPageViewDeletedPageButton"},automationMissingActionFeature:{defaultMessage:"The {actionName} action is not available in your workspace",id:"AutomationHeaderView.automationMissingActionFeature"},mustBeWorkspaceMember:{defaultMessage:"You must be a workspace member to edit automations",id:"AutomationHeaderView.mustBeWorkspaceMember"}});function ne(e){var t;const{automationPermissionScope:o,collectionStore:n,collectionSettingsStore:r,onDelete:l,referencesIncompatibleCollectionViewFilter:s,requiresSubscriptionUpgrade:c}=e,u=(0,i().v3)(),{automationStore:p,contextType:m}=(0,W().EC)(),y=(0,d().tz)(),{value:h}=(0,Q().fJ)(q().T.formulas),{value:f}=(0,Q().fJ)(v().QV.automationActionRegistry),{value:x}=(0,Q().fJ)(v().QV.automationTypecheck),S=(0,a().K8)((()=>Boolean((0,J().qb)(u,p))),[p,u]),b=(0,a().K8)((()=>p.getSpaceId()),[p]),A=(0,a().K8)((()=>{var e;return null===(e=Z().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),C=(0,H().n)(p),k=(0,ee()._X)({name:"slack_automation_action",spaceId:b,userId:null==A?void 0:A.id}),M=(0,z().c)({automationStores:[p],slackActionFeatureAvailability:k}),P=(0,a().K8)((()=>(0,$().sl)({environment:u,automationStore:p,automationActionRegistryModule:f,automationTypecheckModule:x,contextType:m,formulasModule:h,intl:y,isSubscribed:C})),[u,p,f,x,m,h,y,C]),ne=(0,a().K8)((()=>{const e=(0,_().O)({recordPointer:n.pointer,getRecordModel:n.getRecordModel});if(!e||e.table!==B().ev)return;const t=e.pointer;return X().Bv.createChildStore(n,t)}),[n]),se=le(),ce=(0,U().k)({upsell:null==k?void 0:k.upsell,from:"database_automation_settings_header_message"}),ue=k&&"expiry"in k&&null!==(t=k.expiry)&&void 0!==t&&t.upsell?k.expiry.upsell:void 0,de=(0,U().k)({upsell:ue,from:"database_automation_settings_header_message"});if(c)return(0,te.jsx)(N().j,{onUpsellClick:ce});if(ne)return(0,te.jsx)(re,{icon:(0,te.jsx)("div",{style:se.lockedIconWrap,children:(0,I().I)(se.lockedIcon)}),children:(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{style:se.paragraph,children:(0,te.jsx)(d().sA,{...oe.automationCollectionInTrashedPage})}),(0,te.jsx)(Y().p,{onClick:()=>{!function(e,t){(function(e){(0,F().v)(e,"view_deleted_page_from_automation_edit_menu")})(t),D().Y({environment:t,store:e,pageVisitSource:j().y8.LinkInPage})}(ne,u),O().V({collectionSettingsStore:r})},style:se.restoreButton,isLightGray:!0,children:(0,te.jsx)(d().sA,{...oe.automationCollectionInTrashedPageViewDeletedPageButton})})]})});if(S)return(0,te.jsx)(L().z,{children:(0,te.jsx)(d().sA,{...oe.automationPublicAccess})});if("insufficient"===P.editPermissionStatus){if("free_workspace"===P.reason)return(0,$().ip)({contextType:m,environment:u})?(0,te.jsx)(ae,{icon:(0,te.jsx)("div",{style:se.boltIconWrap,children:(0,T().v)(se.boltIcon)}),children:(0,te.jsx)("p",{style:se.paragraph,children:(0,te.jsx)(d().sA,{...oe.automationUpgrade,values:{"anchor-upsell":e=>(0,te.jsx)(G().A,{onClick:ce,style:se.link,children:e})}})})}):(0,te.jsx)(L().z,{children:(0,te.jsx)(d().sA,{...oe.automationEditOnSite})});if("feature_not_enabled"===P.reason)return(0,te.jsx)(L().z,{children:(0,te.jsx)(d().sA,{...oe.automationMissingActionFeature,values:{actionName:P.actionName.toLocaleLowerCase()}})});var pe,me,ge;if("missing_permissions"===P.reason)return(null===(pe=P.relatedPointer)||void 0===pe?void 0:pe.table)===R().GP?(0,te.jsx)(ie,{botId:P.relatedPointer.id,automationPermissionScope:o,onDelete:l,automationStore:p}):(null===(me=P.relatedPointer)||void 0===me?void 0:me.table)===V().Vl&&P.relatedPointer.id!==n.id?(0,te.jsx)(L().z,{children:(0,te.jsx)(d().sA,{...oe.automationMissingPermissionsNoPermissionsForDatabase})}):(null===(ge=P.relatedPointer)||void 0===ge?void 0:ge.table)===E().NX?(0,te.jsx)(L().z,{children:(0,te.jsx)(d().sA,{...oe.mustBeWorkspaceMember})}):(0,te.jsx)(L().z,{children:(0,te.jsx)(d().sA,{...oe.automationGenericFullAccess})});(0,g().HB)(P)}else{if("unknown"===P.editPermissionStatus)return(0,te.jsx)(L().z,{children:(0,te.jsx)(d().sA,{...oe.automationGenericFullAccess})});if("sufficient"===P.editPermissionStatus)return s?(0,te.jsx)(L().z,{icon:(0,w().Q)(se.warningIcon),children:(0,te.jsx)(d().sA,{...oe.automationIncompatibleViewFilterAndOwner})}):M?(0,te.jsx)(K().v,{onUpsellClick:de}):null;(0,g().HB)(P)}}function ie(e){const{botId:t,automationPermissionScope:o,onDelete:n,automationStore:i}=e,r=(0,d().tz)(),l=le(),s=(0,a().K8)((()=>{const e=X().vK.createChildStore(i,{id:t,spaceId:i.getSpaceId(),table:R().GP}).getCreatedByStore();return e?e.getDisplayName(r):r.formatMessage(P().Fvx.messages.anonymousPlaceholder)}),[i,t,r]);return(0,te.jsx)(L().z,{children:(0,te.jsx)(d().sA,{..."readonly"===o?oe.automationExternalBotNoPermissions:oe.automationExternalBotWithPermissions,values:{"anchor-delete":e=>(0,te.jsx)(G().A,{onClick:n,style:l.link,children:e}),user:s}})})}function ae(e){const{children:t,icon:o}=e,n=le();return(0,te.jsx)("div",{style:n.wrapWrap,children:(0,te.jsxs)("div",{style:n.upsellWrap,children:[o&&(0,te.jsx)("div",{style:n.iconWrap,children:o}),(0,te.jsx)("div",{style:n.messageWrap,children:t})]})})}function re(e){const{children:t,icon:o}=e,n=le();return(0,te.jsx)("div",{style:n.wrapWrap,children:(0,te.jsxs)("div",{style:n.trashPageWrap,children:[o&&(0,te.jsx)("div",{style:n.iconWrap,children:o}),(0,te.jsx)("div",{style:n.messageWrap,children:t})]})})}function le(){const{isMobile:e}=(0,i().Y0)();return(0,r().IS)((t=>({boltIcon:{fill:t.icon.yellowPrimary,height:"100%",width:"100%"},boltIconWrap:{height:20,padding:2,width:20},icon:{},iconWrap:{flexGrow:0,flexShrink:0},lockedIcon:{fill:t.icon.secondary,height:"100%",width:"100%"},lockedIconWrap:{background:t.fill.lightGraySecondary,borderRadius:4,height:20,padding:2,width:20},link:{color:t.text.uiBluePrimary},messageWrap:{flexGrow:1},paragraph:{color:t.text.secondary,fontSize:e?14:12,margin:0},restoreButton:{fontSize:e?14:12,fontWeight:y().Wy.medium,marginLeft:-8},warningIcon:{color:t.palette.orange[400],height:"100%",width:"100%"},warningIconWrap:{height:20,padding:2,width:20},wrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10},wrapWrap:{padding:e?"0 12px 12px":"0 0 6px 0"},upsellWrap:{alignItems:"center",background:t.palette.yellow[50],border:`1px solid ${t.palette.yellow[100]}`,borderRadius:6,display:"flex",flexDirection:"row",gap:10,padding:8},trashPageWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10,background:t.palette.gray[30],padding:8,borderRadius:6},personBadgeQuestionMark:{fill:t.icon.secondary,width:16,height:"auto"},personBadgeQuestionMarkWrap:{height:20,padding:2,width:20}})),[e])}var se=()=>o(366360),ce=()=>o(946548),ue=()=>o(859428),de=()=>o(115512);const pe=(0,d().YK)({automationEnabledLabel:{defaultMessage:"Active",id:"collectionSettings.editAutomationView.automationEnabledLabel"},automationEnabledHiddenAriaLabel:{defaultMessage:"Automation is active.",id:"collectionSettings.editAutomationView.automationEnabledHiddenAriaLabel"},automationPausedHiddenAriaLabel:{defaultMessage:"Automation is paused.",id:"collectionSettings.editAutomationView.automationPausedHiddenAriaLabel"},automationDisabledTooltip:{defaultMessage:"Ask {user} to resume this automation.",id:"collectionSettings.editAutomationView.automationDisabledTooltip"},automationErrorsDisabledTooltip:{defaultMessage:"Fix any errors or remove failing steps to enable this automation",id:"collectionSettings.editAutomationView.automationErrorsDisabledTooltip"}});function me(e){const{automationId:t,automationOwner:o,disabled:a,isAutomationPaused:l,onPause:s,onResume:c}=e,{cantSaveDueToError:u}=(0,se().b)(),{isMobile:p}=(0,i().Y0)(),m=`toggle-${t}`,g=(0,n.useCallback)((()=>{l?null==c||c():null==s||s()}),[l,c,s]),h=(0,r().IS)((e=>({labelWrap:{color:a?e.text.tertiary:e.text.secondary,flex:"1 1 auto",fontSize:p?y().J.UIRegular.mobile:y().J.UIRegular.desktop},sectionWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:6,marginBlockEnd:0},toggleWrap:{flex:"0 0 auto",paddingBlockStart:p?5:2}})),[a,p]),f=pe.automationEnabledLabel,v=l?pe.automationPausedHiddenAriaLabel:pe.automationEnabledHiddenAriaLabel;return(0,te.jsxs)("section",{style:h.sectionWrap,children:[(0,te.jsx)("div",{style:h.toggleWrap,children:(0,te.jsx)(ue().A,{disableTooltip:!a||!l,renderTooltip:()=>u?(0,te.jsx)(d().sA,{...pe.automationErrorsDisabledTooltip}):(0,te.jsx)(d().sA,{...pe.automationDisabledTooltip,values:{user:o}}),render:e=>(0,te.jsx)("div",{...e,children:(0,te.jsx)(ce().A,{disabled:a,inputId:m,on:!l,onClick:g})})})}),(0,te.jsx)("div",{style:h.labelWrap,children:(0,te.jsxs)("label",{htmlFor:m,children:[(0,te.jsx)("span",{"aria-hidden":!0,children:(0,te.jsx)(d().sA,{...f})}),(0,te.jsx)("span",{style:de().Qg,children:(0,te.jsx)(d().sA,{...v})})]})})]})}var ge=()=>o(2220),ye=()=>o(217429);var he=()=>o(253579),fe=()=>o(506090);function ve(e){const{shouldInvokeHandler:t,isMobile:o,onClick:i}=e;(0,n.useEffect)((()=>{async function e(e){const o=fe().A.state.open,n=e.target instanceof Element&&((0,he().pM)(e.target)||(0,he().m5)(e.target)&&!o);e.eventPhase===Event.CAPTURING_PHASE&&t&&n&&(e.stopPropagation(),e.preventDefault(),await i())}if(!o)return window.addEventListener("click",e,{capture:!0}),()=>{window.removeEventListener("click",e,{capture:!0})}}),[t,o,i])}var xe=()=>o(726483),Se=()=>o(698331),be=()=>o(594794),Ae=()=>o(124749),Ce=()=>o(246125),ke=()=>o(940371),Me=()=>o(911724),je=()=>o(276936),Te=()=>o(104636),Ie=()=>o(190019),we=()=>o(559419);var Pe=()=>o(633904);function _e(){const{automationStore:e}=(0,se().k)();return(0,a().K8)((()=>function(e){var t;const o=(null===(t=e.getTrigger())||void 0===t?void 0:t.type)??"event";return"event"===o||"recurrence"!==o&&void(0,g().HB)(o)}(e)),[e])}var Be=()=>o(751156),Re=()=>o(623580),Ve=()=>o(419357);const Ee=(0,d().YK)({loadingPlaceholder:{defaultMessage:"Loading...",id:"AutomationNameInput.loadingPlaceholder"},placeholder:{defaultMessage:"Automation name",id:"AutomationNameInput.placeholder"}});const De=(0,n.forwardRef)((function(e,t){const{disabled:l,focusInitial:s,placeholder:c,...u}=e,{automationStore:p}=(0,W().EC)(),{maybePersistedTransactionActions:m}=(0,se().b)(),g=function(e){const{isMobile:t}=(0,i().Y0)(),{disabled:o}=e;return(0,r().IS)((e=>({automationNameInput:{marginBlockEnd:0,paddingInline:0},automationNameText:{color:o?e.text.tertiary:e.text.primary,marginInlineStart:t?12:0,marginInlineEnd:t?12:18,fontWeight:y().Wy.medium,padding:0},input:{background:"transparent",boxShadow:"unset",fontWeight:y().Wy.medium,padding:0}})),[t,o])}({disabled:l}),{isMobile:h}=(0,i().Y0)(),f=(0,d().tz)(),v=(0,a().K8)((()=>(null==p?void 0:p.getName())??""),[p]),x=c||f.formatMessage(Ee.placeholder),S=(0,n.useCallback)((e=>{m.createAndCommit({userAction:"Automation.updateName",perform:t=>{Be().applyOperation({store:p,operation:{path:["properties"],pointer:p.pointer,command:"update",args:{name:e}},transaction:t})}})}),[p,m]),b=(0,n.useCallback)((e=>{const t=e.currentTarget.value;S(t)}),[S]),A=(0,n.useCallback)((e=>{e.currentTarget.value||S(x)}),[S,x]);return(0,o(852507).w)((()=>{h&&!v&&S(x)})),(0,te.jsx)(Ve().Ay,{...u,disabled:l,focusInitial:s,format:Re().C.ExtraLarge,inputOuterStyle:g.input,inputStyle:{paddingInline:0},onBlur:A,onChange:b,placeholder:x,ref:t,style:g.automationNameInput,textWrapperStyle:g.automationNameText,value:v??f.formatMessage(Ee.loadingPlaceholder)})}));var Fe=()=>o(401634),Oe=()=>o(668725),Le=()=>o(869558),Ke=()=>o(406699),Ne=()=>o(656134),We=(o(581454),o(908872),()=>o(289915)),ze=()=>o(701545),He=()=>o(745266),Ue=()=>o(31902),Ye=()=>o(519839),Ge=()=>o(736767),qe=()=>o(760217),$e=()=>o(928600),Je=()=>o(480095),Qe=()=>o(187820),Ze=()=>o(852353),Xe=()=>o(722872),et=()=>o(71304),tt=()=>o(962730);const ot=(0,d().YK)({forPagesIn:{id:"collectionSettings.editAutomationView.notifyForOption.title",defaultMessage:"For pages in"}});function nt(e){const{selectedSourcePointer:t,collectionContextStore:o,onSelect:r,onClose:l}=e,{isMobile:s}=(0,i().Y0)(),c=(0,d().tz)(),u=(0,i().v3)(),[m,y]=n.useState(""),h=(0,a().K8)((()=>o.collectionStore()),[o]),f=(0,a().K8)((()=>o.collectionViewBlockStore()),[o]),v=(0,a().K8)((()=>f&&h?f.getCollectionViewStores().filter((e=>{var t;const o=null===(t=e.getCollectionStore())||void 0===t?void 0:t.pointer;return(null==o?void 0:o.id)===h.id})):[]),[f,h]),x=(0,a().K8)((()=>{if(!h)return[];let e;t&&"collection_view"===t.table&&(e=X().pS.createChildStore(h,t));return p().hS([...v,e].filter(g().O9),(e=>{let{id:t}=e;return t})).filter((e=>(0,Ye().As)(e,m)))}),[h,v,m,t]),S=(0,a().K8)((()=>{if(h&&(0,Ze().zY)({collectionStore:h,environment:u,intl:c,queryForFilter:m}))return function(e){const{collectionStore:t,environment:o,selectedSourcePointer:n,onSelect:i,isMobile:a,intl:r}=e,l=t.getIcon(),s=(0,et().tS)({environment:o,intl:r,store:t}),c=n&&"collection"===n.table&&n.id===t.id,u=t.getSpaceShardedPointer(),p={key:t.id,action:()=>{u&&i(u)},render:e=>(0,te.jsx)(qe().A,{...e,icon:l&&(0,te.jsx)(Qe().B6,{isEmptyPage:!1,size:a?18:16,disabled:!0,icon:l}),title:s,caption:(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collection.caption",defaultMessage:"Entire database",values:{collectionName:s}}),right:c&&(0,ze().p)({width:16,height:"auto"})})};return{key:"collection",items:[p],render:e=>(0,te.jsx)(k().A,{...e})}}({collectionStore:h,environment:u,selectedSourcePointer:t,onSelect:r,isMobile:s,intl:c})}),[h,u,c,s,r,m,t]),A=(0,a().K8)((()=>h&&f&&v?function(e){const{blockStore:t,filteredCollectionViewStores:o,collectionStore:n,selectedSourcePointer:i,onSelect:a,intl:r}=e,l=n.getSchema(),s=o.map((e=>{if("form_editor"===e.getType()||"chart"===e.getType())return;const o=e.getSpaceShardedPointer();if(e.isDefined()&&o){const s=i&&"collection_view"===i.table&&i.id===o.id,c=(0,xe().RN)({collectionViewStore:e,collectionSchema:l}),u=(0,xe().EN)({collectionViewStore:e,collectionSchema:l}),p=(0,g().O9)(c)||(0,g().O9)(u),m=e.getType(),y=e.getFormat().collection_view_icon,h=e.getName(),f=(o,n)=>(0,te.jsx)(qe().A,{...o,...n,icon:(0,te.jsx)(He().h,{color:"lightGray",viewType:m,viewIcon:y}),title:(0,te.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4},children:[(0,te.jsx)(Ue().A,{collectionViewType:m,collectionViewName:h}),p&&s&&(0,w().Q)({width:16,height:"auto"})]}),caption:(0,te.jsx)(it,{blockStore:t,collectionViewStore:e,intl:r,collectionSchema:l,referencesIncompatibleProperties:p}),right:s&&(0,ze().p)({width:16,height:"auto"}),disabled:p,disabledFeedback:p});let v;if(p&&c){var n;const e=null===(n=l[c])||void 0===n?void 0:n.type,t=e?Ze().dC[e]:void 0,o=t?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.specific",defaultMessage:"{propertyTypeName} properties are not supported",values:{propertyTypeName:t}}):(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.default",defaultMessage:"Some properties are not supported"});v=e=>(0,te.jsx)(ue().A,{placement:tt().W.Right,renderTooltip:()=>o,render:t=>f(e,t)})}else if((0,g().O9)(u)){const e=(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.crossSpace",defaultMessage:"Cross work-space properties are not supported"});v=t=>(0,te.jsx)(ue().A,{placement:tt().W.Right,renderTooltip:()=>e,render:e=>f(t,e)})}else v=f;return{key:e.id,action:()=>{a(o)},render:v}}}));return[...s].filter(g().O9)}({blockStore:f,collectionStore:h,filteredCollectionViewStores:x,selectedSourcePointer:t,onSelect:r,intl:c}):[]),[f,h,v,x,c,r,t]),C=function(e){const{menuListItems:t}=e;if(0===t.length)return;return{key:"collection-views",items:t,render:e=>(0,te.jsx)(k().A,{...e,topBorder:!0})}}({menuListItems:A}),M={key:"search",items:[{key:"search_item",action:()=>{},render:()=>(0,te.jsx)(Ve().Ay,{value:m,focus:!0,onChange:e=>y(e.target.value),placeholder:c.formatMessage({defaultMessage:"Search views...",id:"collectionViewSelect.viewSearch.placeholder"})})}],render:e=>(0,te.jsx)(k().A,{isInput:!0,...e})};let j;(0,g().O9)(S)||(0,g().O9)(C)||(j={key:"no-results-section",items:[{key:"no-results-item",action:p().lQ,render:()=>(0,te.jsx)(Ge().A,{caption:(0,te.jsx)(d().sA,{defaultMessage:"No results",id:"collectionViewSelect.noResults.title"})})}],render:e=>(0,te.jsx)(k().A,{...e,topBorder:!0})});const T=[M,S,C,j].filter(g().O9);if(!h)return null;let I;return I=s?{menuType:Xe().gu.Modal,title:(0,te.jsx)("div",{style:{display:"flex"},children:(0,te.jsx)(d().sA,{...ot.forPagesIn})}),right:(0,te.jsx)(Je().DoneMenuText,{}),onClickRight:()=>{l()}}:{menuType:Xe().gu.Popup,width:230,maxHeight:"50vh"},(0,te.jsx)($e().A,{...I,children:(0,te.jsx)(b().Ay,{type:b().Oh.Vertical,sections:T,initialFocus:0,onAccept:()=>{l()}})})}function it(e){const{blockStore:t,collectionViewStore:o,intl:n,collectionSchema:r,referencesIncompatibleProperties:l}=e,s=(0,i().v3)(),c=(0,a().K8)((()=>!o.getAlive()),[o]),u=(0,a().K8)((()=>{const e=o.getParentBlockStore();if(e)return t.id!==e.id?(0,et().tS)({environment:s,intl:n,store:e}):void 0}),[t.id,o,n,s]),p=(0,a().K8)((()=>{const e=o.getQuery(r);return(0,We().rg)({propertyFilters:o.getPropertyFiltersStore().getValue()??[],combinatorFilter:null==e?void 0:e.filter,schema:r}).reduce(((e,t)=>{if((0,We().yX)(t))return e+1;return e+(t.filters??[]).length}),0)}),[r,o]);return l?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.unsupportedView",defaultMessage:"Not supported"}):c?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.deletedView",defaultMessage:"<emphasis>View not found.</emphasis>",values:{emphasis:e=>(0,te.jsx)("em",{children:e})}}):u?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.captionDifferentParent",defaultMessage:"<emphasis>View configured in {externalParentBlockName}</emphasis>",values:{emphasis:e=>(0,te.jsx)("em",{children:e}),externalParentBlockName:u}}):0===p?(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.captionWithNoFilters",defaultMessage:"Any page in this view"}):(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.collectionView.captionWithFilters",defaultMessage:"{ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",values:{ruleCount:p}})}function at(e){const{pointer:t,collectionStore:o,intl:n}=e,l=(0,i().v3)(),s=(0,r().IS)((e=>({warningIcon:{width:16,height:"auto",color:e.palette.orange[400]},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4,flex:"1 1 auto",minWidth:0},title:{...y().RC},errorText:{color:e.errorText,fontWeight:y().Wy.medium}})),[]),c=(0,a().K8)((()=>t?X().sk.createChildStore(o,t):void 0),[o,t]),u=(0,a().K8)((()=>c?(0,et().tS)({environment:l,intl:n,store:c}):(0,te.jsx)("span",{style:s.errorText,children:(0,te.jsx)(d().sA,{id:"AutomationCollectionSelectMenu.source.missing",defaultMessage:"Select database"})})),[l,n,s.errorText,c]),p=(0,a().K8)((()=>{if(!c||c.table===V().Vl)return!1;const e=o.getSchema();return(0,g().O9)((0,xe().RN)({collectionViewStore:c,collectionSchema:e}))}),[o,c]);return(0,te.jsxs)("div",{style:s.titleContainer,children:[p&&(0,w().Q)(s.warningIcon),(0,te.jsx)("span",{style:s.title,children:u})]})}function rt(e){const{collectionContextStore:t,disabled:o}=e,{isMobile:l}=(0,i().Y0)(),s=(0,d().tz)(),c=(0,r().IS)((e=>{const t=o?e.text.tertiary:e.text.secondary,n=l?y().J.UIRegular.mobile:y().J.UIRegular.desktop;return{wrap:{alignItems:"center",color:t,cursor:"default",display:"grid",fontSize:n,gridTemplateColumns:"auto auto"},button:{color:t,fontWeight:y().Wy.medium,fontSize:n,width:"100%",height:24,paddingLeft:6,paddingRight:6,marginLeft:1},icon:{width:10,marginLeft:4,fill:t}}}),[l,o]),{automationStore:u}=(0,W().EC)(),{maybePersistedTransactionActions:p}=(0,se().b)(),m=(0,a().K8)((()=>t.collectionStore()),[t]),g=(0,a().K8)((()=>{const e=null==u?void 0:u.getTrigger();if("event"===(null==e?void 0:e.type)){const t=e.event.source;if(t&&"filter"!==t.type)return t.pointer}}),[u]),h=(0,n.useCallback)((e=>{const t=e.table===V().Vl?{pointer:e,type:V().Vl}:{pointer:e,type:Le().Gy};p.createAndCommit({userAction:"Automation.updateSource",perform:e=>{Be().applyOperation({store:u,operation:{path:["trigger","event"],pointer:u.pointer,command:"update",args:{source:t}},transaction:e})}})}),[u,p]),f=(0,Ne().j)(),v=m?(0,te.jsx)(at,{pointer:g,collectionStore:m,intl:s}):(0,te.jsx)(n.Fragment,{}),x=(0,te.jsx)(Ke().Ay,{alignmentToOrigin:Ke().yP.Start,placementToOrigin:Ke().sx.Bottom,popupType:f,render:e=>(0,te.jsx)(nt,{selectedSourcePointer:g,onSelect:h,onClose:()=>{e.close()},collectionContextStore:t}),renderOrigin:e=>(0,te.jsxs)(Y().p,{...e,style:c.button,disabled:o,children:[v,(0,Oe().b)(c.icon)]})});return(0,te.jsx)("div",{style:c.wrap,children:(0,te.jsx)(d().sA,{id:"automationBuilderModal.SourceInput.appliesTo",defaultMessage:"For all pages in {button}",values:{button:x}})})}function lt(){const e=(0,i().v3)(),t=(0,d().tz)(),{isMobile:o}=(0,i().Y0)(),n=(0,r().IS)((e=>{const t=o?y().J.UIRegular.mobile:y().J.UIRegular.desktop;return{wrap:{color:e.text.secondary,fontSize:t},title:{color:e.text.secondary,fontWeight:y().Wy.medium,fontSize:t}}}),[o]),{collectionStore:l}=(0,se().k)(),s=(0,a().K8)((()=>(0,et().tS)({environment:e,intl:t,store:l})),[l,e,t]),c=(0,te.jsx)("span",{style:n.title,children:s});return(0,te.jsx)("div",{style:n.wrap,children:(0,te.jsx)(d().sA,{id:"automationBuilderModal.SourceLabel.appliesTo",defaultMessage:"For {source}",values:{source:c}})})}let st;(0,o(604341).exposeDebugGetter)("currentAutomation",(()=>st));const ct=(0,d().YK)({deleteButton:{id:"automationBuilderModal.editAutomationView.deleteButton",defaultMessage:"Delete"},createButton:{id:"automationBuilderModal.editAutomationView.createButton.label",defaultMessage:"Create"},saveButton:{id:"automationBuilderModal.editAutomationView.saveButton.label",defaultMessage:"Save"},cancelButton:{id:"automationBuilderModal.editAutomationView.cancelButton.label",defaultMessage:"Cancel"},doneButton:{id:"automationBuilderModal.editAutomationView.doneButton.label",defaultMessage:"Done"},enableButton:{id:"automationBuilderModal.editAutomationView.enableButton.label",defaultMessage:"Enable"},errorsFooterCaption:{id:"automationBuilderModal.editAutomationView.errorCaption",defaultMessage:"Fix errors to enable"}});function ut(){}function dt(e){const{collectionSettingsStore:t,collectionContextStore:o,source:j,...T}=e,[I]=(0,n.useState)((()=>T)),{mode:w}=I,P=(0,d().tz)(),_=(0,i().v3)(),{isMobile:B}=(0,i().Y0)(),{value:R}=(0,Q().fJ)(q().T.formulas),{value:V}=(0,Q().fJ)(v().QV.automationTypecheck),[E,D]=(0,n.useState)([]),F="create"===w,L=(0,Ce().l)("BuilderModal",{cacheFallback:_.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),K=(0,Ae().$)(),N=(0,a().K8)((()=>null==K?void 0:K.userId),[K]),z=(0,a().K8)((()=>null==K?void 0:K.getDisplayName(P)),[K,P]),U=(0,a().K8)((()=>o.collectionStore()),[o]),Y=(0,a().K8)((()=>null==U?void 0:U.getSpaceId()),[U]),G=(0,a().K8)((()=>null==U?void 0:U.id),[U]),$=(0,n.useMemo)((()=>"update"===I.mode?I.automationId:(0,be().Z1)({environment:_,table:u().yB,spaceId:Y})),[I,_,Y]),J=(0,a().O$)(o.aliveAutomationCountStore),Z=(0,a().K8)((()=>{if(Y&&U&&N)return new(X().dn)(_,{id:$,table:u().yB,spaceId:Y})}),[$,U,N,_,Y]);!function(e){(0,n.useEffect)((()=>(st=e,()=>{st=void 0})),[e])}(Z);const ee=(0,a().K8)((()=>(0,s().PK)(P,z)),[z,P]),oe=(0,a().K8)((()=>{if(!Y||!U||!N)return;const e={id:$,table:u().yB,spaceId:Y},t=L.getEntry({pointer:e,userId:N});return t?t.value.value:xe().EZ({automationId:$,automationName:"",collectionStore:U,userId:N})}),[$,U,N,Y,L]),{maybePersistedAutomationStore:ie,maybePersistedTransactionActions:ae,hasUnpersistedChanges:re}=(0,Pe().t)({automationId:$,spaceId:Y,defaultValue:F?oe:void 0,persist:!1}),le=(0,a().K8)((()=>{if(ie&&(0,Se().$X)(ie))return ie}),[ie]),se=(0,a().K8)((()=>((null==le?void 0:le.getActionStores())??[]).filter((e=>e.isDefined()))),[le]),ce=(0,a().K8)((()=>(0,Se().H8)((null==le?void 0:le.getTriggerType())??"event")),[le]),ue=(0,a().K8)((()=>{const e=null==U?void 0:U.getParentBlockStore();return!!e&&e.pathIsDead()}),[U]),de=function(e){const{actionStores:t,automationStore:o,collectionStore:n,loadingStatus:i,mode:r}=e;return(0,a().K8)((()=>"create"===r?"edit":"resolved"===i&&o&&t&&n?(0,xe().TT)({automationStore:o,actionStores:t,collectionStore:n})?"edit":(0,xe().Gz)({automationStore:o,collectionStore:n})?"readonly_with_delete":"readonly":"readonly"),[r,i,o,t,n])}({automationStore:le,actionStores:se,collectionStore:U,loadingStatus:"resolved",mode:I.mode}),pe=("readonly_with_delete"===de||"edit"===de&&!F)&&!ue,me=(0,H().n)(le),he=(0,a().K8)((()=>!(!le||!U)&&xe().l({automationStore:le,collectionStore:U})),[le,U]),fe=(0,a().K8)((()=>le&&R&&V?(0,Ie().Z)({environment:_,automationStore:le,automationTypecheckModule:V,contextType:ce,formulasModule:R,intl:P,isSubscribed:me}):void 0),[le,R,V,_,ce,P,me]),Te=(0,a().K8)((()=>!!(U&&le&&fe)&&xe().Qn({automationStore:le,collectionStore:U,typecheckResult:fe})),[le,U,fe]),_e=(0,a().K8)((()=>!!fe&&(0,je().h)({environment:_,typecheckResult:fe,automationStore:le})),[le,_,fe]),Be=(0,a().K8)((()=>Z&&R&&V?(0,Ie().Z)({environment:_,automationStore:Z,automationTypecheckModule:V,contextType:ce,formulasModule:R,intl:P,isSubscribed:me}):void 0),[_,Z,ce,R,V,P,me]),Re=(0,a().K8)((()=>!!(U&&Z&&Be)&&xe().Qn({automationStore:Z,collectionStore:U,typecheckResult:Be})),[U,Z,Be]),Ve=(0,a().K8)((()=>{if(!le)return!0;let e;var t;le.isTriggerType("event")&&(e=null===(t=le.getEventConfiguration())||void 0===t?void 0:t.pagePropertiesEdited.type);const o=(0,g().O9)(e)&&"none"!==e,n=le.getActionStores().length>0;if(!n&&!o)return!1;const i=!(0,l().aE)({automationTrigger:le.getTrigger(),collectionSchema:null==U?void 0:U.getSchema()});if(o&&i)return!0;if(n&&(0,g().O9)(fe)&&m().Q.isSuccess(fe)){if(Object.keys(fe.value.actionValidationFailures).some((e=>!E.includes(e))))return!0}return!1}),[le,U,E,fe]);!function(e){const{automationStore:t,collectionStoreId:o,source:r}=e,l=(0,i().v3)(),[s,c]=(0,n.useState)(!1),u=(0,a().K8)((()=>(null==t?void 0:t.getActionIds().length)??0),[t]),d=(0,a().K8)((()=>{if(!t||!t.isTriggerType("event"))return 0;const e=t.getTriggerStore().getKeyStore("event");let o=0;e.getKeyStore("pagesAdded").getValue()&&o++;const n=e.getKeyStore("pagePropertiesEdited").getValue();if("any"===(null==n?void 0:n.type))o++;else if("some"===(null==n?void 0:n.type)){var i;o+=(null===(i=n.some)||void 0===i?void 0:i.length)??0}else if("all"===(null==n?void 0:n.type)){var a;o+=(null===(a=n.all)||void 0===a?void 0:a.length)??0}return o}),[t]);(0,n.useEffect)((()=>{o&&!s&&t&&((0,ge().u)({environment:l,event:{eventName:"automation_configure_view",eventProperties:{automation_id:t.id,automation_total_actions:u,automation_total_triggers:d,collection_id:o,source:r}}}),ye().default.logEvent("automation_configure_view","true"),c(!0))}),[l,o,s,u,d,null==t?void 0:t.id,t,r])}({automationStore:le,collectionStoreId:G,source:e.source});const Ee="edit"===de&&!ue&&!_e,Oe=(0,n.useCallback)((()=>{D([])}),[]),Le=(0,n.useCallback)((()=>{U&&le&&re&&("create"===w?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,intl:a,from:r}=e;M().nO({automationStore:t,collectionStore:n,environment:i,intl:a,from:r,builderType:"modal"}),f().D6({label:(0,te.jsx)(d().sA,{id:"automations.editAutomationView.createdConfirmation",defaultMessage:"{automationName} created",values:{automationName:t.getName()}})}),O().V({collectionSettingsStore:o});const l=(0,ke().S)(o);l&&"automationSettings"!==l.type&&h().a2({collectionSettingsStore:o,item:{type:"automationSettings",source:"first_automation_created"}})}({automationStore:le,collectionSettingsStore:t,collectionStore:U,environment:_,intl:P,from:I.from}):"update"===w?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,source:a}=e;M().kU({automationStore:t,collectionStore:n,environment:i,builderType:"modal",source:a}),f().D6({label:(0,te.jsx)(d().sA,{id:"automations.editAutomationView.updatedConfirmation",defaultMessage:"{automationName} updated",values:{automationName:t.getName()}})}),O().V({collectionSettingsStore:o})}({automationStore:le,collectionSettingsStore:t,collectionStore:U,environment:_,source:j}):(0,g().HB)(w))}),[le,t,U,_,re,P,w,I,j]),Ke=(0,n.useCallback)((async()=>{le&&U&&!F&&await M().lg({intl:P,environment:_,existingAutomationStore:le,collectionStore:U,onDelete:()=>{var e;O().V({collectionSettingsStore:t}),1===J&&"automationSettings"===(null===(e=(0,ke().S)(t))||void 0===e?void 0:e.type)&&h().R8({collectionSettingsStore:t,item:{type:"main"}})}})}),[J,le,t,U,_,P,F]),Ne=(0,n.useCallback)((async()=>{if(re){await M().US({hasPendingChanges:re})&&O().V({collectionSettingsStore:t})}else O().V({collectionSettingsStore:t})}),[t,re]);ve({shouldInvokeHandler:!0,onClick:Ne,isMobile:B});const We=(0,n.useCallback)((e=>{D([e.id])}),[]),ze=(0,we().c)(),He=function(){const{isMobile:e}=(0,i().Y0)(),t=yt();return(0,r().IS)((o=>({header:{backgroundColor:o.surface.elevated,zIndex:100,width:"100%",...e?{paddingBottom:0,paddingTop:0}:{paddingBottom:8,borderBottom:`1px solid ${o.stroke.secondary}`}},nameInput:{...e&&{paddingTop:8}},buttons:{backgroundColor:o.surface.elevated,display:"flex",flexDirection:"row",paddingBottom:e?16:4,paddingTop:12,justifyContent:"space-between",gap:e?"10px":0,width:"100%",zIndex:100,...e&&{paddingLeft:pt,paddingRight:pt,flexDirection:"column-reverse"}},footerButton:{height:32,width:e?"100%":"auto",pointerEvents:"auto"},footerErrorCaption:{color:o.text.tertiary,fontSize:y().J.UISmall.desktop},footerRight:{alignItems:"center",display:"flex",gap:14,justifyContent:"space-between"},automationOptionIconDesktop:{marginInlineStart:12},wrap:{marginTop:e?16:17,marginBottom:e?20:0,paddingBottom:16,width:"100%",flexGrow:1,overflowY:"auto"},closeButtonContainer:{position:"absolute",top:10,right:10,zIndex:101},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:o.tint.regular,width:24,height:24},closeButtonHover:{background:o.buttonPressedBackground},closeButtonIcon:{width:14,fill:o.icon.secondary},...t})),[e,t])}(),Ue=[],Ye=re&&Te;Ee&&!B&&Ue.push((0,te.jsxs)(k().A,{style:He.buttons,mobileStyle:He.buttons,children:[(0,te.jsx)(A().A,{size:"lg",onClick:Ne,style:He.footerButton,children:(0,te.jsx)(d().sA,{...ct.cancelButton})}),(0,te.jsxs)("div",{style:He.footerRight,children:[!Ye&&Ve&&(0,te.jsx)("div",{style:He.footerErrorCaption,children:(0,te.jsx)(d().sA,{...ct.errorsFooterCaption})}),(0,te.jsx)(C().A,{onClick:Le,onMouseEnter:Oe,disabled:!Ye,style:He.footerButton,children:F?(0,te.jsx)(d().sA,{...ct.enableButton}):(0,te.jsx)(d().sA,{...ct.doneButton})})]})]},"save"));const Ge=(0,a().K8)((()=>{if(!U||!le)return null;const e=!B&&Ee&&"create"===w;return(0,te.jsx)(W().or,{automationStore:le,children:(0,te.jsxs)(Me().v,{value:{collectionStore:U,disabled:!Ee,editorPlacement:{type:"inline"},editorWidth:x().vE,maybePersistedTransactionActions:ae,onActionAdded:We,suppressActionErrors:E,hideDragHandle:_e,cantSaveDueToError:Ve,...ze},defaultCollapseActions:_e,children:[!B&&(0,te.jsx)("div",{style:He.closeButtonContainer,children:(0,te.jsx)(S().A,{onClick:Ne,style:He.closeButton,hoveredStyle:He.closeButtonHover,children:(0,c().V)(He.closeButtonIcon)})}),(0,te.jsx)("div",{style:He.header,children:(0,te.jsx)(b().Ay,{type:b().Oh.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:(0,p().oE)([{key:"automation_name",action:()=>{},render:t=>(0,te.jsx)("div",{...t,style:He.nameInput,children:(0,te.jsx)(De,{...t,disabled:!Ee,focusInitial:e,placeholder:ee})})},mt({showActiveAutomationToggle:pe,isPersistedStateComplete:Re,collectionContextStore:o,canEdit:Ee,automationStore:le})]),render:e=>(0,te.jsx)(k().A,{...e,disableMobilePadding:!0,desktopStyle:{paddingTop:0,paddingBottom:0}})}]})}),(0,te.jsxs)("div",{style:He.wrap,children:[(0,te.jsx)(ne,{collectionStore:U,collectionSettingsStore:t,automationPermissionScope:de,referencesIncompatibleCollectionViewFilter:he,requiresSubscriptionUpgrade:_e,onDelete:Ke}),(0,te.jsx)(v().U3,{areActionsEditable:Ee,areTriggersEditable:Ee})]})]})})}),[U,le,Ee,ae,We,E,_e,ze,B,He,Ne,pe,Re,o,Ve,t,de,he,Ke,w,ee]);return(0,te.jsxs)(Fe().i,{handleOnDismiss:Ne,handleOnSave:Le,canSave:Ye,mode:w,children:[Ge,Ue]})}const pt=16;function mt(e){const{showActiveAutomationToggle:t,isPersistedStateComplete:o,collectionContextStore:n,canEdit:i}=e;return{key:"automation_toggle_and_source",action:ut,render:e=>(0,te.jsx)(gt,{menuListItemProps:e,showActiveAutomationToggle:t,isPersistedStateComplete:o,collectionContextStore:n,canEdit:i})}}function gt(e){const{menuListItemProps:t,showActiveAutomationToggle:o,isPersistedStateComplete:l,collectionContextStore:s,canEdit:c}=e,u=(0,d().tz)(),{isMobile:p}=(0,i().Y0)(),m=(0,i().v3)(),g=yt(),y=(0,r().IS)((e=>({wrap:{display:"flex",...p?{flexDirection:"column",justifyContent:"center",alignItems:"flex-start",paddingInline:12,borderBottom:`1px solid ${e.stroke.primary}`,paddingBlock:12,gap:12}:{gap:8,minHeight:24,alignItems:"center"}},toggle:{display:"flex",alignItems:"center",marginLeft:1},...g})),[p,g]),{automationStore:h}=(0,W().EC)(),f=(0,a().K8)((()=>{var e;return(null==h||null===(e=h.getOwnerStore())||void 0===e?void 0:e.getDisplayName(u))??""}),[u,h]),v="active"===(0,a().K8)((()=>(null==h?void 0:h.getStatus())??"disabled"),[h]),x=_e(),S=(0,n.useCallback)((()=>{h&&M().WA({automationStore:h,environment:m})}),[m,h]),b=(0,n.useCallback)((()=>{h&&M().HJ({automationStore:h,environment:m})}),[m,h]),A=(0,a().K8)((()=>!l||(0,Te().NH)(h)),[h,l]);return(0,te.jsxs)("div",{...t,style:y.wrap,children:[(l||!v)&&o&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{style:y.toggle,children:(0,te.jsx)(me,{automationId:h.id,automationOwner:f,isAutomationPaused:!v,onPause:S,onResume:b,disabled:A})}),(0,te.jsx)("div",{style:y.verticalDivider})]}),x?(0,te.jsx)(rt,{disabled:!c,collectionContextStore:s}):(0,te.jsx)(lt,{})]})}function yt(){const{isMobile:e}=(0,i().Y0)();return(0,r().IS)((t=>({verticalDivider:{background:t.stroke.secondary,height:16,width:1,borderRadius:1,display:e?"none":"block"}})),[e])}var ht=()=>o(246826),ft=()=>o(840094),vt=()=>o(845715);const xt=(0,d().YK)({placeholder:{id:"automations.builderModal.buttonBuilderLabelInput.placeholder",defaultMessage:"Enter a name"},loading:{id:"automations.builderModal.buttonBuilderLabelInput.loading",defaultMessage:"Loading..."}}),St=(0,n.forwardRef)((function(e,t){let{disabled:o,buttonName:a,handleNameChange:l,handleBlur:s,handleSubmit:c,...u}=e;const p=(0,d().tz)(),{isMobile:m}=(0,i().Y0)(),g=(0,r().IS)((e=>({buttonNamePropertyInput:{marginBlockEnd:0,boxShadow:"none"},buttonNameText:{marginInlineStart:m?12:0,marginInlineEnd:m?12:18},inputOuterStyle:{background:"transparent",boxShadow:"unset"}})),[m]),y=(0,n.useCallback)((e=>{l(e)}),[l]),h=(0,n.useCallback)((e=>{s(e.target.value)}),[s]),f=(0,n.useCallback)((()=>{c(a)}),[c,a]);return(0,te.jsx)(Ve().Ay,{style:g.buttonNamePropertyInput,...u,value:a??p.formatMessage(xt.loading),onChange:y,disabled:o,ref:t,inputOuterStyle:g.inputOuterStyle,format:Re().C.ExtraLarge,textWrapperStyle:g.buttonNameText,placeholder:p.formatMessage(xt.placeholder),onBlur:h,onSubmit:f,autoFocus:!a})}));var bt=()=>o(390518);const At=(0,d().YK)({saveButton:{defaultMessage:"Save",id:"database.buttonProperty.saveButtonLabel"},noEditError:{defaultMessage:"You don't have full access to edit this button",id:"database.buttonProperty.noEditError"}});function Ct(e){const{collectionContextStore:t,propertySchema:o}=e,i=(0,a().K8)((()=>t.collectionStore()),[t]),r=(0,a().K8)((()=>null==i?void 0:i.getSpaceId()),[i]),l=(0,n.useMemo)((()=>{const e=o.automation_id;if(e&&r)return{id:e,spaceId:r,table:u().yB}}),[o.automation_id,r]);return(0,vt().K)(i,l)?(0,te.jsx)(kt,{...e}):(0,te.jsx)(bt().A,{})}function kt(e){var t;const{collectionContextStore:o,collectionSettingsStore:l,propertyId:s,propertySchema:u}=e,{isMobile:p}=(0,i().Y0)(),m=(0,i().v3)(),g=(0,Ae().$)(),y=(0,a().K8)((()=>null==g?void 0:g.userId),[g]),[h,f]=(0,n.useState)([]),A=(0,a().K8)((()=>o.collectionStore()),[o]),M=(0,a().K8)((()=>null==A?void 0:A.getSpaceId()),[A]),{maybePersistedAutomationStore:j,maybePersistedTransactionActions:T}=(0,Pe().t)({automationId:u.automation_id,spaceId:M,defaultValue:void 0,persist:!0}),I=(0,a().K8)((()=>null==j?void 0:j.getTrigger()),[j]),w=(0,ft().Qj)({automationStore:j,propertyId:s,propertySchema:u,collectionContextStore:o}),P=(0,a().K8)((()=>{var e;return"sufficient"===(null==w||null===(e=w.state)||void 0===e?void 0:e.editPermissionStatus)}),[w]),_=(0,a().K8)((()=>{var e;return!(null==w||null===(e=w.state)||void 0===e||!e.typecheckResult)&&(0,je().h)({environment:m,typecheckResult:w.state.typecheckResult,automationStore:j})}),[w,m,j]),B=(0,a().K8)((()=>(null==j?void 0:j.getNameStore().getValue())??u.name),[j,u.name]),R=(0,a().K8)((()=>"collectionTypedView"===o.contextType),[o]),V=(0,n.useCallback)((e=>{if(!j)return;const t=e.currentTarget.value;T.createAndCommit({userAction:"ButtonBuilderModal.setName",perform:e=>{ht().KY({store:j.getNameStore(),transaction:e,value:t})}})}),[j,T]),E=(0,n.useCallback)((e=>{f((t=>[...t,e.id]))}),[]),D=(0,we().c)(),F=function(){const{isMobile:e}=(0,i().Y0)();return(0,r().IS)((t=>({header:{backgroundColor:"transparent",borderBottom:`1px solid ${t.stroke.secondary}`,paddingBottom:8,paddingTop:Pt,position:"absolute",top:0,width:`calc(100% - ${2*wt}px)`,zIndex:100,...e&&{paddingBottom:0,paddingTop:0,width:"100%"}},buttons:{backgroundColor:"dark"===t.mode?t.palette.gray[100]:t.white,display:"flex",gap:4,paddingBlock:`${Pt}px ${wt}px`,position:"absolute",bottom:0,width:`calc(100% - ${2*wt}px)`,zIndex:100,...e&&{paddingLeft:wt,paddingRight:wt,flexDirection:"column-reverse",width:"100%"}},label:{paddingTop:e?"10px":0},closeButtonContainer:{position:"absolute",top:10,right:10,zIndex:101},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:t.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:t.buttonPressedBackground},closeButtonIcon:{width:16,fill:t.text.secondary},wrap:{overflowY:"auto",overflowX:"hidden",marginTop:e?Tt:Mt,marginBottom:e?It:jt,paddingInline:e?0:2,width:"100%"},desktopButtonLabelNameContainer:{paddingLeft:0,paddingRight:0,color:t.text.tertiary},mobileButtonLabelNameContainer:{paddingTop:Pt,paddingBottom:4,paddingLeft:wt,paddingRight:wt,color:t.text.tertiary},buttonLabelNameTextWrapperStyle:{marginLeft:e?wt:0,marginRight:e?wt:0},footerButton:{height:32,width:"100%"},inputStyle:{background:"transparent"},inputOuterStyle:{background:"transparent"}})),[e])}(),H=(0,n.useCallback)((()=>{O().V({collectionSettingsStore:l})}),[l]);ve({shouldInvokeHandler:!0,onClick:H,isMobile:p});const Y=(0,n.useCallback)((e=>{j&&T.createAndCommit({userAction:"ButtonBuilderModal.setName",perform:t=>{ht().KY({store:j.getNameStore(),transaction:t,value:e})}})}),[j,T]),G=(0,ee()._X)({name:"slack_automation_action",spaceId:M,userId:y}),q=(0,z().c)({automationStores:[j],slackActionFeatureAvailability:G}),$=G&&"expiry"in G&&null!==(t=G.expiry)&&void 0!==t&&t.upsell?G.expiry.upsell:void 0,J=(0,U().k)({from:"button_builder_modal_header_message",upsell:$}),Q=(0,U().k)({from:"button_property_automation_header_message",upsell:null==G?void 0:G.upsell}),Z=(0,n.useMemo)((()=>A&&j&&I&&"button"===I.type?(0,te.jsx)(W().u,{automationStore:j,contextType:"button_property",children:(0,te.jsxs)(Me().v,{value:{collectionStore:A,disabled:!P,editorPlacement:{type:"inline"},editorWidth:x().vE,maybePersistedTransactionActions:T,onActionAdded:E,suppressActionErrors:h,hideDragHandle:_,...D},defaultCollapseActions:_,children:[!p&&(0,te.jsx)("div",{style:F.closeButtonContainer,children:(0,te.jsx)(S().A,{onClick:H,style:F.closeButton,hoveredStyle:F.closeButtonHover,children:(0,c().V)(F.closeButtonIcon)})}),(0,te.jsx)("div",{style:F.header,children:(0,te.jsx)(b().Ay,{type:b().Oh.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:[{key:"automation_name",action:()=>{},render:e=>(0,te.jsx)(St,{...e,disabled:R,buttonName:B,handleNameChange:V,handleBlur:Y,handleSubmit:Y})}],render:e=>(0,te.jsx)(k().A,{...e,disableMobilePadding:!0,shouldShowBottomDivider:!0,desktopStyle:{paddingTop:0}})}]})}),(0,te.jsxs)("div",{style:F.wrap,children:[_&&(0,te.jsx)(N().j,{onUpsellClick:Q}),!P&&(0,te.jsx)(L().z,{children:(0,te.jsx)(d().sA,{...At.noEditError})}),P&&q&&(0,te.jsx)(K().v,{onUpsellClick:J}),(0,te.jsx)(v().U3,{areActionsEditable:!_,areTriggersEditable:!1})]})]})}):null),[A,j,I,P,T,E,h,_,D,p,F.closeButtonContainer,F.closeButton,F.closeButtonHover,F.closeButtonIcon,F.header,F.wrap,H,Q,q,J,R,B,V,Y]),X=p?(0,te.jsx)(n.Fragment,{}):(0,te.jsx)(k().A,{mobileStyle:F.buttons,style:F.buttons,children:(0,te.jsx)(C().A,{onClick:H,disabled:!P,style:F.footerButton,children:(0,te.jsx)(d().sA,{...At.saveButton})})});return A&&j&&I&&"button"===I.type?(0,te.jsxs)(Fe().i,{handleOnDismiss:H,canSave:!0,mode:"button_property",handleOnSave:H,children:[Z,X]}):null}const Mt=60,jt=60,Tt=60,It=60,wt=16,Pt=12},89849:(e,t,o)=>{o.r(t),o.d(t,{eyeIcon:()=>a,iconDefinition:()=>i});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"0.96 4.19 18.07 11.62",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M10.17 6.694a3.307 3.307 0 0 1 3.135 3.303l-.005.17a3.305 3.305 0 0 1-3.3 3.137l-.17-.004a3.307 3.307 0 0 1-3.132-3.133l-.004-.17A3.307 3.307 0 0 1 10 6.69zm-.17 2.2a1.104 1.104 0 0 0 0 2.207 1.103 1.103 0 0 0 0-2.207"}),(0,n.jsx)("path",{d:"M10 4.194c3.878 0 7.26 2.075 8.862 5.127l.073.163c.126.333.126.7 0 1.033l-.073.163c-1.602 3.052-4.984 5.126-8.862 5.126-3.757 0-7.049-1.946-8.707-4.843l-.156-.283a1.46 1.46 0 0 1 0-1.359l.156-.283C2.95 6.141 6.243 4.194 10 4.194m0 1.251c-3.33 0-6.196 1.724-7.622 4.214l-.134.243a.21.21 0 0 0 0 .197l.134.243c1.426 2.49 4.292 4.214 7.622 4.214 3.437 0 6.38-1.837 7.756-4.457l.018-.048a.2.2 0 0 0 0-.1l-.018-.049C16.38 7.282 13.437 5.445 10 5.445"})]})},a=(0,o(340498).wt)("eye",i)},90907:(e,t,o)=>{o.d(t,{h:()=>a});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"3.97 1.95 12.06 15.66",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M10.55 12.808a1.35 1.35 0 1 0-1.1 0v1.242a.55.55 0 0 0 1.1 0z"}),(0,n.jsx)("path",{d:"M10 1.95a4 4 0 0 0-4 4v1.433a2.426 2.426 0 0 0-2.025 2.392v5.4A2.425 2.425 0 0 0 6.4 17.6h7.2a2.425 2.425 0 0 0 2.425-2.425v-5.4A2.426 2.426 0 0 0 14 7.383V5.95a4 4 0 0 0-4-4m2.75 5.4h-5.5v-1.4a2.75 2.75 0 0 1 5.5 0zM5.225 9.775c0-.649.526-1.175 1.175-1.175h7.2c.649 0 1.175.526 1.175 1.175v5.4c0 .649-.526 1.175-1.175 1.175H6.4a1.175 1.175 0 0 1-1.175-1.175z"})]})},a=(0,o(340498).wt)("lock",i)},95199:(e,t,o)=>{o.d(t,{Ud:()=>N});o(898992),o(354520),o(581454);var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(422540),s=()=>o(462618),c=()=>o(352271),u=()=>o(80979),d=()=>o(791089),p=()=>o(519831),m=()=>o(959013),g=()=>o(496603),y=()=>o(534177),h=()=>o(246826),f=()=>o(725614),v=()=>o(84817),x=()=>o(760217),S=()=>o(406699),b=()=>o(623580),A=()=>o(928600),C=()=>o(939740),k=()=>o(89924),M=()=>o(521732),j=()=>o(678350),T=()=>o(909470),I=()=>o(546461),w=()=>o(653417),P=()=>o(252463),_=()=>o(366360),B=()=>o(858163),R=()=>o(133518),V=()=>o(781697),E=()=>o(656134),D=()=>o(548526),F=()=>o(464004),O=()=>o(938818),L=o(474848);const K=(0,m().YK)({replaceActionLabel:{id:"automations.AutomationActionSetPropertiesSection.replaceAction.label",defaultMessage:"Replace with"},appendActionLabel:{id:"automations.AutomationActionSetPropertiesSection.appendAction.label",defaultMessage:"Add"},removeActionLabel:{id:"automations.AutomationActionSetPropertiesSection.removeAction.label",defaultMessage:"Remove"},toggleActionLabel:{id:"automations.AutomationActionSetPropertiesSection.toggleAction.label",defaultMessage:"Toggle"},titlePlaceholder:{id:"automations.AutomationActionSetPropertiesSection.titlePlaceholder",defaultMessage:"Untitled"},automationActionPropertyDeleted:{id:"automations.AutomationActionSetPropertiesSection.automationActionPropertyDeleted",defaultMessage:"This property was deleted"},automationActionPropertyUnsupported:{id:"automations.AutomationActionSetPropertiesSection.automationActionPropertyUnsupported",defaultMessage:"This property is unsupported"}});function N(e){const{actionStore:t,collectionStore:o,disabled:r,showSetPropertyActions:l}=e,s=(0,i().v3)(),{automationStore:c}=(0,I().EC)(),{maybePersistedTransactionActions:u}=(0,_().b)(),d=(0,a().K8)((()=>{var e;return(null===(e=t.getConfig())||void 0===e?void 0:e.values)??{}}),[t]),p=(0,a().K8)((()=>{var e;return(null===(e=t.getConfig())||void 0===e?void 0:e.properties)??[]}),[t]),m=(0,n.useCallback)((e=>{const o=p.concat([e]),n={...d,[e]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.propertiesChange",perform:e=>{W({configStore:t.getConfigStore(),properties:o,transaction:e,values:n})}}),(0,P().UB)(s,{automationActionStore:t,automationStore:c})}),[p,d,u,s,c,t]),g=(0,n.useCallback)(((e,o)=>{const n=p.indexOf(e);if(-1===n)return;const i=p.slice(0);i[n]=o;const a={...d,[o]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.setProperties",perform:e=>{W({configStore:t.getConfigStore(),properties:i,transaction:e,values:a})}}),(0,P().UB)(s,{automationActionStore:t,automationStore:c})}),[p,d,u,s,c,t]),y=(0,n.useCallback)((e=>{const o=p.filter((t=>t!==e)),n={...d,[e]:void 0};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.removeProperty",perform:e=>{W({configStore:t.getConfigStore(),properties:o,transaction:e,values:n})}}),(0,P().UB)(s,{automationActionStore:t,automationStore:c})}),[p,d,u,s,c,t]),h=(0,n.useCallback)(((e,o)=>{const n={...d,[e]:o};u.createAndCommit({userAction:"AutomationActionSetPropertiesSection.handleValueChange",perform:e=>{W({configStore:t.getConfigStore(),properties:p,transaction:e,values:n})}}),(0,P().UB)(s,{automationActionStore:t,automationStore:c})}),[d,u,s,t,c,p]);return(0,L.jsx)(z,{actionStore:t,collectionStore:o,disabled:r,onPropertyAdd:m,onPropertyChange:g,onPropertyRemove:y,onPropertyValueChange:h,showSetPropertyActions:l})}function W(e){const{configStore:t,properties:o,transaction:n,values:i}=e;h().zv({store:t,data:{properties:o,values:i},transaction:n})}function z(e){const{actionStore:t,collectionStore:o,onPropertyAdd:n,onPropertyChange:i,onPropertyRemove:s,onPropertyValueChange:c,disabled:u,showSetPropertyActions:d}=e,p=(0,r().IS)((e=>({addPropertyRow:{display:"flex",alignItems:"center"}})),[]),m=(0,a().K8)((()=>t.getConfigStore().getKeyStore("properties").getValue()??[]),[t]),g=(0,a().K8)((()=>(0,l().m7)({collectionFormat:o.getFormat(),collectionSchema:o.getSchema(),filter:e=>{let[t]=e;return!m.includes(t)},spaceId:o.getSpaceId(),restrictCrossSpace:!0})),[o,m]),y=0===g.length;return(0,L.jsxs)(L.Fragment,{children:[m.length>0&&(0,L.jsx)(H,{actionStore:t,availablePropertyIds:g,collectionStore:o,disabled:u,onPropertyChange:i,onPropertyRemove:s,onPropertyValueChange:c,showSetPropertyActions:d}),!u&&!y&&(0,L.jsx)("div",{style:p.addPropertyRow,children:(0,L.jsx)(F().l,{availablePropertyIds:g,currentValue:void 0,collectionStore:o,onChange:n,disabled:u,alreadyHaveProperties:m.length>0})})]})}function H(e){const{actionStore:t,availablePropertyIds:o,collectionStore:n,onPropertyChange:l,onPropertyRemove:s,onPropertyValueChange:c,showSetPropertyActions:u,disabled:d}=e,{isMobile:p}=(0,i().Y0)(),m=p,g=(0,r().IS)((()=>({wrap:{alignItems:"start",columnGap:4,display:"grid",gridTemplateColumns:m?"100%":"160px 1fr",minWidth:0,rowGap:m?4:8},propertyValue:{...m?{fontSize:14,marginBlockEnd:16}:{}},lastPropertyValue:{...m?{fontSize:14,marginBlockEnd:0}:{}}})),[m]),[y,h]=(0,a().K8)((()=>{const e=t.getConfig();return[(null==e?void 0:e.properties)??[],(null==e?void 0:e.values)??{}]}),[t]);return(0,L.jsx)("div",{style:g.wrap,children:y.map(((e,i)=>{const a=i===y.length-1;return(0,L.jsx)(U,{actionStore:t,availablePropertyIds:o,collectionStore:n,disabled:d,onPropertyChange:l,onPropertyRemove:s,onPropertyValueChange:c,property:e,showSetPropertyActions:u,value:h[e],valueStyle:a?g.lastPropertyValue:g.propertyValue},e)}))})}function U(e){const{actionStore:t,availablePropertyIds:o,collectionStore:i,disabled:g,onPropertyChange:y,onPropertyRemove:h,onPropertyValueChange:f,property:x,showSetPropertyActions:S,value:A,valueStyle:C}=e,k={type:"collection",collectionStore:i,property:x},M=(0,m().tz)(),j=(0,r().IS)((e=>({propertyName:{display:"flex"},propertyValue:{display:"flex",gap:4,minWidth:50,...C},propertyValueInput:{minWidth:50}})),[C]),P=(0,n.useMemo)((()=>{if("title"===x)return M.formatMessage(K.titlePlaceholder)}),[M,x]),B=(0,a().K8)((()=>i.getSchema()[x]||i.getDeletedSchema()[x]),[i,x]),V=(0,a().K8)((()=>Boolean(!i.getSchema()[x])),[i,x]),E=(0,a().K8)((()=>{if(B)return(0,d().setPropertyValueToSimpleFormulaReturnType)({table:p().Vl,id:i.id,spaceId:i.getSpaceId()},x,B)}),[i,B,x]),D=(0,n.useMemo)((()=>{if(B&&(0,l().I3)(B))return B.type}),[B]),N=(0,n.useMemo)((()=>B&&!(0,l().I3)(B)),[B]),W=null==A?void 0:A.value,z=(0,a().K8)((()=>(0,c().tz)(A)),[A]),{automationStore:H}=(0,I().EC)(),U=(0,a().K8)((()=>H.getSpaceId()),[H]),G=(0,R().F)({actionId:t.id}),q=(0,a().K8)((()=>{if(D&&U)return(0,d().analyzeSimpleFormulaOrFormulaSync)({context:{allowedReturnTypes:l().Yy[D],handleDataRequest:(0,u().createFormulaDataRequestSyncHandler)(t.getRecordModel),spaceId:U,valueTypes:G.slice(0),featureGates:(0,T().i)()},value:null==A?void 0:A.value})}),[t.getRecordModel,G,U,D,null==A?void 0:A.value]),{suppressActionErrors:J}=(0,_().b)(),Q=(0,n.useMemo)((()=>!J.includes(t.id)),[J,t]),{errorMessage:Z}=(0,w().useErrorComponentForAction)({actionId:t.id,errorKey:x,shouldShow:Q}),X=(0,n.useCallback)((e=>{y(x,e)}),[y,x]),ee=(0,n.useCallback)((()=>h(x)),[h,x]),te=(0,n.useCallback)((e=>{f(x,e)}),[f,x]),oe=(0,n.useCallback)((e=>{te({action:e,value:W})}),[W,te]),ne=(0,n.useCallback)((e=>{te({action:z,value:e})}),[z,te]);if(!U)return null;const ie=function(e){if("email"===e||"phone_number"===e||"url"===e)return{disableEmojiCommands:!0,disableFormattingAndMentions:!0};return{}}(D);let ae;return V?ae=(0,L.jsx)(m().sA,{...K.automationActionPropertyDeleted}):N?ae=(0,L.jsx)(m().sA,{...K.automationActionPropertyUnsupported}):Z&&(ae=Z),(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("div",{style:j.propertyName,children:(0,L.jsx)(F().l,{availablePropertyIds:o,currentValue:x,collectionStore:i,onChange:X,disabled:g,onRemove:ee,errorMessage:ae})}),(0,L.jsxs)("div",{style:j.propertyValue,children:[!V&&S&&B&&s().M[B.type]&&(0,L.jsx)(Y,{disabled:g,onChange:oe,value:z}),V?(0,L.jsx)(b().A,{disabled:!0,placeholder:M.formatMessage(K.automationActionPropertyDeleted)}):N?(0,L.jsx)(b().A,{disabled:!0,placeholder:M.formatMessage(K.automationActionPropertyUnsupported)}):D&&E?(0,L.jsxs)(v().Y1,{direction:"vertical",gap:7,style:j.propertyValueInput,children:[(0,L.jsx)($,{...ie,analyzedFormulaOutput:q,automationActionStore:t,disabled:g,disableMobileActionBar:!0,simpleFormulaContext:k,formulaTypecheckContextValues:G,onChange:ne,parentRecordStore:t,placeholder:P,propertyType:D,spaceId:U,type:E,value:null==A?void 0:A.value}),q&&(0,L.jsx)(O().J,{analyzedFormulaOutput:q})]}):null]})]})}function Y(e){const{disabled:t,onChange:o,value:n}=e,i=(0,r().IS)((e=>({button:{boxShadow:e.inputBoxShadow,minWidth:120}})),[]),a=(0,E().j)();return(0,L.jsx)(S().Ay,{popupType:a,alignmentToOrigin:S().yP.End,placementToOrigin:S().sx.Bottom,originGap:0,disabled:t,renderOrigin:e=>(0,L.jsx)(D().x,{...e,disabled:t,style:i.button,dropdownButtonType:"button",children:(0,L.jsx)(q,{action:n})}),render:e=>(0,L.jsx)(G,{onChange:o,parent:e,value:n})})}function G(e){const{value:t,onChange:o,parent:n}=e,i=(0,V().e)({width:250}),a=g().oE(c().Au.map(((e,i)=>({key:i,render:o=>(0,L.jsx)(x().A,{...o,disabled:!1,title:(0,L.jsx)(q,{action:e}),isChecked:t===e}),action:()=>{e!==t&&o(e),n.close()}}))));return(0,L.jsx)(A().A,{...i,children:(0,L.jsx)(C().Ay,{type:C().Oh.Vertical,sections:[{key:0,render:e=>(0,L.jsx)(k().A,{enableActionSheetTitle:!0,...e}),items:a}],initialFocus:0})})}function q(e){const{action:t}=e;return"replace"===t?(0,L.jsx)(m().sA,{...K.replaceActionLabel}):"append"===t?(0,L.jsx)(m().sA,{...K.appendActionLabel}):"remove"===t?(0,L.jsx)(m().sA,{...K.removeActionLabel}):"toggle"===t?(0,L.jsx)(m().sA,{...K.toggleActionLabel}):void(0,y().HB)(t)}function $(e){const{analyzedFormulaOutput:t={},automationActionStore:o,disabled:a,disableEmojiCommands:s,disableFormattingAndMentions:c,disableMobileActionBar:u,formulaTypecheckContextValues:d,onChange:p,parentRecordStore:m,placeholder:g,propertyType:y,simpleFormulaContext:h,spaceId:v,type:x,value:S}=e,{parseErrors:b=[],typeErrors:A=[]}=t,C=b.length>0||A.length>0,{onTextStoreSelect:k,onTextStoreUnselect:T}=(0,B().W)(o),I=(0,r().IS)((e=>({input:{width:"100%"}})),[]),w=(0,i().v3)(),P=(0,n.useCallback)((()=>{f().clear({environment:w})}),[w]);return"text"===x.type?(0,L.jsx)(M().Y,{allowedReturnTypes:l().Yy[y],disabled:a,disableEmojiCommands:s,disableMobileActionBar:u,formulaTypecheckContextValues:d,onChange:p,onTextStoreSelect:k,onTextStoreUnselect:T,onTextEsc:P,parentRecordStore:m,spaceId:v,placeholder:g,style:I.input,shouldShowErrorStyles:C,value:S}):"number"===x.type?(0,L.jsx)(M().Y,{allowedReturnTypes:l().Yy[y],disabled:a,disableEmojiCommands:!0,disableInsertedDeletedAnnotations:!0,disableMentions:!0,disableMobileActionBar:!0,disableStyleAnnotations:!0,formulaTypecheckContextValues:d,onChange:p,onTextStoreSelect:k,onTextStoreUnselect:T,onTextEsc:P,parentRecordStore:m,spaceId:v,style:I.input,shouldShowErrorStyles:C,value:S}):(0,L.jsx)(j().U,{allowedReturnTypes:l().Yy[y],disabled:a,disableEmojiCommands:s,disableFormattingAndMentions:c,disableMobileActionBar:u,formulaTypecheckContextValues:d,onChange:p,parentRecordStore:m,placeholder:g,simpleFormulaContext:h,spaceId:v,type:x,value:S})}},95441:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const i=function(e){const{title:t,href:i,analyticsFrom:a}=e,r=(0,o(484714).v3)();return(0,n.jsx)(o(187485).A,{href:i,onClick:()=>o(148024).FH(r,{from:a}),external:!0,children:(0,n.jsx)(o(497222).A,{icon:o(406533).questionMarkCircleIcon,title:t,isGray:!0})})}},101209:(e,t,o)=>{o.d(t,{v:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("boltFilled",{svg:(0,n.jsx)("path",{d:"M0 12.117c0 .38.293.664.703.664h5.518l-2.91 7.91c-.381 1.006.664 1.543 1.318.723l8.877-11.094c.166-.205.254-.4.254-.625 0-.371-.293-.664-.703-.664H7.539l2.91-7.91C10.83.115 9.785-.422 9.131.408L.254 11.492c-.166.215-.254.41-.254.625z"}),viewBox:"0 0 14 22"})},102777:(e,t,o)=>{o.d(t,{b:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("sendArrow",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M9.79883 18.5894C14.6216 18.5894 18.5894 14.6216 18.5894 9.79883C18.5894 4.96777 14.6216 1 9.79053 1C4.95947 1 1 4.96777 1 9.79883C1 14.6216 4.96777 18.5894 9.79883 18.5894ZM9.79883 14.3062C9.20947 14.3062 8.76953 13.9077 8.76953 13.3433V9.69922L8.86914 8.00586L8.25488 8.84424L7.3916 9.81543C7.23389 10.0063 6.98486 10.1143 6.72754 10.1143C6.21289 10.1143 5.84766 9.75732 5.84766 9.25928C5.84766 8.99365 5.92236 8.79443 6.12158 8.58691L8.96045 5.61523C9.19287 5.35791 9.4585 5.2417 9.79883 5.2417C10.1309 5.2417 10.4048 5.36621 10.6372 5.61523L13.4761 8.58691C13.667 8.79443 13.75 8.99365 13.75 9.25928C13.75 9.75732 13.3848 10.1143 12.8618 10.1143C12.6128 10.1143 12.3638 10.0063 12.2061 9.81543L11.3428 8.86914L10.7202 7.99756L10.8281 9.69922V13.3433C10.8281 13.9077 10.3799 14.3062 9.79883 14.3062Z"})})},112282:(e,t,o)=>{o.d(t,{s:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.97 2.37 12.06 15.26",svg:(0,o(474848).jsx)("path",{d:"M9.792 2.41a.6.6 0 0 0-.234.148l-5.4 5.4a.625.625 0 1 0 .884.884l4.333-4.333V17a.625.625 0 1 0 1.25 0V4.509l4.333 4.333a.625.625 0 1 0 .884-.884l-5.4-5.4a.62.62 0 0 0-.65-.147"})},i=(0,o(340498).wt)("arrowStraightUp",n)},113474:(e,t,o)=>{o.d(t,{_:()=>u});o(296540);var n=()=>o(484714),i=()=>o(401497),a=()=>o(668725),r=()=>o(704152),l=()=>o(678553),s=()=>o(125565),c=o(474848);function u(e){const t=(0,i().DP)(),o=(0,n().v3)(),{device:u}=o;return(0,c.jsx)(r().A,{onClick:e.onClick,hovered:e.focused,disabled:e.disabled,style:{width:"100%",...!u.isMobile&&{borderRadius:6},...e.buttonStyle},hoveredStyle:e.hoveredButtonStyle,pressedStyle:e.pressedButtonStyle,children:(0,c.jsx)(l().Ay,{...e,dontShrinkTitle:!0,right:(0,c.jsxs)("div",{style:{display:"flex",whiteSpace:"nowrap"},children:[e.right&&(0,c.jsx)(s().A,{isSecondaryColor:!0,isMobile:u.isMobile,children:e.right}),!u.isMobile&&(0,c.jsx)("div",{style:{flexShrink:0},children:(0,a().b)({width:10,marginLeft:4,fill:t.icon.tertiary,transform:"right"===e.chevronType?"rotate(-90deg)":void 0,transition:"transform 0.2s ease"})})]})})})}},118849:(e,t,o)=>{o.d(t,{A:()=>d});o(296540);var n=()=>o(56366),i=()=>o(979340),a=()=>o(959013),r=()=>o(381349),l=()=>o(284371),s=()=>o(824160),c=()=>o(991249),u=o(474848);const d=function(e){let{subscriptionTier:t,mobileStyle:d,desktopStyle:p,analyticsName:m,onClick:g,disableTooltip:y,tooltipContent:h}=e;const f=(0,o(401497).DP)(),v=(0,o(484714).v3)(),{device:x}=v,S=(0,n().K8)((()=>{const{currentSpaceStore:e}=o(765957).default.state;return null==e?void 0:e.canAdmin()}),[]),b=(0,n().K8)((()=>function(e,t){switch(e){case"plus":case"business":case"enterprise":return{color:t.blueColor,background:"light"===t.mode?r().Ay.diffBackground:"rgba(35, 131, 226, 0.2)",fontWeight:l().Wy.medium};default:return{}}}(t,f)),[t,f]);if(x.isMobileNative)return null;let A;return"personal"===t?A=(0,u.jsx)(a().sA,{defaultMessage:"Personal Pro",id:"upgradeButton.personal.text"}):(0,i().$P)(t)?A=(0,u.jsx)(a().sA,{defaultMessage:"Plus â†—",id:"upgradeButton.plus.textWithArrow"}):(0,i().tL)(t)?A=(0,u.jsx)(a().sA,{defaultMessage:"Business â†—",id:"upgradeButton.business.textWithArrow"}):(0,i().OX)(t)?A=(0,u.jsx)(a().sA,{defaultMessage:"Enterprise â†—",id:"upgradeButton.enterprise.textWithArrow"}):(0,o(534177).HB)(t),x.isMobile||!S?(0,u.jsx)(s().A,{mobileStyle:d,children:A}):(0,u.jsx)(o(859428).A,{delayThreshold:120,disableTooltip:y,placement:o(962730).W.Bottom,renderTooltip:()=>(0,u.jsx)("div",{style:{maxWidth:500},children:h?(0,u.jsx)(a().sA,{defaultMessage:"{tooltipText}",id:"upgradeButton.upgrade.custom.tooltip",values:{tooltipText:h}}):(0,u.jsx)(a().sA,{defaultMessage:"Upgrade to use this feature.",id:"upgradeButton.upgrade.tooltip"})}),originGap:6,render:e=>(0,u.jsx)(s().A,{desktopStyle:p,innerStyle:b,onClick:e=>function(e,t,o,n,i){c().K(n,{from:t,upsell:{type:"product",product:o,limit:{type:"none"},trialability:"none"}}),i&&i(e)}(e,m,t,v,g),...e,children:A})})}},124954:(e,t,o)=>{o.d(t,{w:()=>m});var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(987555),s=()=>o(246826),c=()=>o(751156),u=()=>o(187820),d=()=>o(738865),p=o(474848);function m(e){const{clickTitleBehavior:t,blockStore:o,format:l,shouldWrap:m}=e,y="edit"===t,h=(0,i().v3)(),[f,v,x]=(0,a().K8)((()=>[o.getIcon(),o.isEmptyPage(),o.isReady()&&"none"===o.getRole()]),[o]),S=(0,a().K8)((()=>(0,u().Te)(o)),[o]),{style:b}=(0,r().IS)((()=>({style:{flexShrink:0,marginRight:y?0:d().U[l].recordIconMarginRight,justifyContent:"flex-start",...m&&{display:"inline-block",verticalAlign:"text-top",marginBottom:-1}}})),[y,l,m]),A=(0,n.useCallback)((e=>{const t=o.getIconStore();t&&c().createAndCommit({userAction:"RelationToken.handleRecordIconChange",environment:h,canUndo:!0,perform:o=>{s().KY({store:t,value:e,transaction:o})}})}),[o,h]),C={icon:f,size:d().U[l].pageIconSize,isEmptyPage:v,iconRecordCategory:S,style:b};return x?(0,p.jsx)(g,{...C}):y?(0,p.jsx)(u().B6,{...C,disabled:!1,onChange:A,bucket:"public"}):(0,p.jsx)(u().B6,{...C,disabled:!0})}function g(e){const t=(0,r().DP)();return(0,l().T)({...e.style,width:e.size,height:e.size,fill:t.icon.secondary,verticalAlign:"top",marginTop:1})}},132389:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);function i(e){const t={display:"inline-block",minWidth:e.size,minHeight:e.size};return"x"===e.axis?t.minHeight=1:"y"===e.axis&&(t.minWidth=1),(0,n.jsx)("div",{style:t})}},134589:(e,t,o)=>{o.d(t,{R:()=>a});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"3.37 1.43 13.25 15.44",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M9.325 10.466V2.063a.625.625 0 1 1 1.25 0v8.453l1.458-1.458a.625.625 0 1 1 .884.884l-2.5 2.5a.625.625 0 0 1-.884 0l-2.5-2.5a.625.625 0 1 1 .884-.884z"}),(0,n.jsx)("path",{d:"M11.825 6.375H14.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-9a.875.875 0 0 1-.875-.875v-7.5c0-.483.392-.875.875-.875h2.575v-1.25H5.5A2.125 2.125 0 0 0 3.375 7.25v7.5c0 1.174.951 2.125 2.125 2.125h9a2.125 2.125 0 0 0 2.125-2.125v-7.5A2.125 2.125 0 0 0 14.5 5.125h-2.675z"})]})},a=(0,o(340498).wt)("squareAndArrowDown",i)},135221:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const i=function(e){let{style:t,styleParentContainer:i,isTriColored:a}=e;const r=(0,o(959013).tz)();return(0,n.jsxs)("div",{"aria-valuetext":r.formatMessage({id:"loadingDots.label",defaultMessage:"Loading..."}),role:"progressbar",className:"loading-dots",style:{...i},children:[(0,n.jsx)("div",{className:"loading-dot",style:{...t,...a&&{backgroundColor:"#F6C050"}}}),(0,n.jsx)("div",{className:"loading-dot",style:{...t,...a&&{backgroundColor:"#ED6A5F"}}}),(0,n.jsx)("div",{className:"loading-dot",style:{...t,...a&&{backgroundColor:"#5F9CDB"}}})]})}},147294:(e,t,o)=>{o.d(t,{Ee:()=>y,oG:()=>p});o(296540);var n=()=>o(56366),i=()=>o(401497),a=()=>o(959013),r=()=>o(963589),l=()=>o(765957),s=()=>o(464708),c=o(474848);const u={define_variables_automation_action:{launchDateMs:17277408e5,expiryDateMs:1738368e6},passkey_setting:{launchDateMs:1729101727e3,expiryDateMs:1738432882e3},http_request_automation_action:{launchDateMs:173324302e4,expiryDateMs:1738368e6},publish_site_settings_embed_page:{launchDateMs:1736208e6,expiryDateMs:1743984e6},generalized_recurrence_automations:{launchDateMs:17365536e5,expiryDateMs:17460576e5},ai_page_translation_topbar_more_action:{launchDateMs:1740451280830,expiryDateMs:17434656e5},verification:{launchDateMs:1740096e6,expiryDateMs:174375e7},notion_ai_workspace_settings:{launchDateMs:17424288e5,expiryDateMs:17550432e5},notion_mail_launch_modal:{launchDateMs:17446752e5,expiryDateMs:17525376e5},notion_mail_launch_modal_2:{launchDateMs:17446752e5,expiryDateMs:17578944e5},ui_doc_example:{launchDateMs:19249056e5,expiryDateMs:19249056e5},collection_property_permissions:{launchDateMs:17433792e5,expiryDateMs:17671392e5},salesforce_sync_unfurling_option:{launchDateMs:17443296e5,expiryDateMs:17538336e5},personal_home_sidebar_item:{launchDateMs:17470944e5,expiryDateMs:175392e7},feed_collection_view:{launchDateMs:17471808e5,expiryDateMs:17591904e5}};function d(e){let{style:t}=e;const o=(0,i().IS)((()=>({badge:{letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",...t}})),[t]);return(0,c.jsx)(s().A,{color:"blue",style:o.badge,content:(0,c.jsx)(a().sA,{id:"newBadgeComponent.label",defaultMessage:"New"})})}function p(e){return(0,n().K8)((()=>{const{launchDateMs:t,expiryDateMs:o}=u[e],{currentUserSettingsStore:n}=l().default.state;if(n&&n.isReady()){var i;const e=null===(i=n.getSettings())||void 0===i?void 0:i.signup_time;if(e&&e>t)return!1}return Date.now()<=o}),[e])}function m(e){let{style:t,newBadgeKey:o}=e;return p(o)?(0,c.jsx)(d,{style:t}):null}function g(e){let{style:t,newBadgeKey:o}=e;return(0,r().X)(o)?(0,c.jsx)(d,{style:t}):null}function y(e){return e.didUserEngage?null:"feature_gate"===e.keyType?(0,c.jsx)(g,{...e}):(0,c.jsx)(m,{...e})}},163749:(e,t,o)=>{o.d(t,{m:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.18 3.24 11.63 11.45",svg:(0,o(474848).jsx)("path",{d:"m5.578 10.183 1.399 1.49c.233.299.458.746.672 1.173.143.283.28.557.413.773l.287.589c.255.418.775.589 1.232.418.496-.194.76-.728.612-1.24l-.403-1.41c-.079-.273-.192-.5-.305-.73-.11-.22-.22-.441-.3-.704a.32.32 0 0 1 .31-.41h3.256a.97.97 0 0 0 .969-.97.94.94 0 0 0-.442-.79.94.94 0 0 0 .534-.852.955.955 0 0 0-.65-.907.96.96 0 0 0 .364-.744.963.963 0 0 0-.961-.969.97.97 0 0 0-.69-1.65H8.45c-.574 0-1.132.131-1.643.387v.008l-1.132.387h-.097zm-.968-.517V4.032H2.913a.727.727 0 0 0-.727.727v4.18c0 .402.326.727.727.727z"})},i=(0,o(340498).wt)("handThumbsDownFillSmall",n)},173783:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var n=()=>o(401497),i=()=>o(658985),a=o(474848);function r(e){const t=function(e){const{size:t,style:o}=e;return(0,n().IS)((e=>({icon:{width:.6*t,height:.6*t,fill:e.text.secondary},iconContainer:{width:t,height:t,borderRadius:"100%",background:e.regularDividerColor,display:"flex",alignItems:"center",justifyContent:"center",...o}})),[t,o])}(e),o=(0,i().$)(t.icon);return(0,a.jsx)("div",{style:t.iconContainer,children:o})}},194373:(e,t,o)=>{o.d(t,{_:()=>$});o(16280),o(944114),o(898992),o(354520),o(581454);var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(700500),s=()=>o(247331),c=()=>o(977345),u=()=>o(187174),d=()=>o(12193),p=()=>o(206267),m=()=>o(179034),g=()=>o(519831),y=()=>o(959013),h=()=>o(778078),f=()=>o(496603),v=()=>o(534177),x=()=>o(736767),S=()=>o(760217),b=()=>o(419357),A=()=>o(928600),C=()=>o(678553),k=()=>o(939740),M=()=>o(8980),j=()=>o(958378),T=()=>o(89924),I=()=>o(859428),w=()=>o(996027),P=()=>o(320865),_=()=>o(175116),B=()=>o(186445),R=()=>o(156988),V=()=>o(553965),E=()=>o(645873),D=()=>o(106628),F=()=>o(361330),O=()=>o(962730),L=()=>o(765957),K=()=>o(970585),N=()=>o(630116),W=()=>o(546461),z=()=>o(781697),H=o(474848);const U=(0,y().YK)({searchInputPlaceholder:{defaultMessage:"Type to searchâ€¦",id:"automations.AutomationTargetPickerMenu.search.placeholder"},searchInputPlaceholderUrlsAllowed:{defaultMessage:"Type to search or paste a linkâ€¦",id:"automations.AutomationTargetPickerMenu.search.placeholderUrlsAllowed"}}),Y=5,G=20,q=20;function $(e){const t=(0,z().e)({maxWidth:360,width:280}),o=(0,n.useMemo)((()=>p().JW()),[]);return(0,H.jsx)(A().A,{...t,children:(0,H.jsx)(Z,{...e,searchSessionId:o})})}const J=Object.values(l().xd).filter((e=>e!==l().xd.form)),Q=[l().xd.form];function Z(e){const{formulaTypecheckContextValues:t,includeThisPage:o,onChange:r,onClose:l,parentRecordStore:p,selectedTarget:m,skipCollections:b,skipPages:A,skipVariables:z,spaceId:U,urlBehavior:G}=e,$=(0,a().uB)(void 0,K().A),Z=(0,W().YC)(),ae=(0,a().K8)((()=>{if(z)return[];if((0,v().O9)(t)&&t.length>0){return Object.values(t).filter((e=>{if(!(0,c().o5)(e.type,{type:"block"}))return!1;if(!o&&"event"===(null==Z?void 0:Z.contextType)&&e.kind===s().FormulaContextValueKind.ContextValue){const t=(0,c().y5)(e.id);return!("global"===t.source&&"button_page"===t.global)}return!0}))}return[]}),[o,z,t,null==Z?void 0:Z.contextType],{useDeepEqual:!0}),[re]=(0,n.useState)((()=>"url"===(null==m?void 0:m.type)?m.url:"")),[le,se]=(0,n.useReducer)(te,{automationVariables:[],collectionQueryLimit:Y,pageQueryLimit:Y,formQueryLimit:Y,searchTerm:re});(0,n.useEffect)((()=>{if(le.searchTerm){const e=(0,h().Ay)(le.searchTerm,ae,(e=>e.kind===s().FormulaContextValueKind.ContextValue?e.name:""));se({type:"set_variables",variables:e})}else se({type:"set_variables",variables:ae})}),[le.searchTerm,ae]);const ce=function(e){const{limit:t,searchTerm:o,skip:r}=e,l=(0,i().v3)(),s=(0,a().K8)((()=>(0,B().ao)()),[]),c=(0,a().O$)(L().AppStoreCurrentSpaceStore),d=(0,_().Ks)(),p=(0,a().K8)((()=>null==d?void 0:d.collectionViewBlockStore()),[d]),[m,g]=(0,n.useReducer)(oe,{error:void 0,isLoading:Boolean(r),results:void 0,total:void 0}),y=(0,E().fJ)(D().T.searchActions),[h]=(0,u().Yb)((async()=>{if(r||!s||"resolved"!==y.status)return;const e=y.value,n=await e.searchCollectionsWithRecents({collectionViewBlockStore:p,environment:l,spaceStore:c,limit:t,parentStore:s,query:o,requireEditPermissions:!0,searchSessionId:void 0});return{results:n.results,total:n.total}}),[r,s,y.status,y.value,p,l,c,t,o],{debounce:F().tu});return(0,n.useEffect)((()=>{if("pending"===h.status||"idle"===h.status)g({type:"query_loadstart"});else if("resolved"===h.status){var e,t;g({results:null===(e=h.value)||void 0===e?void 0:e.results,total:null===(t=h.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===h.status?g({error:h.error,type:"query_error"}):(0,v().HB)(h)}),[h]),m}({limit:le.collectionQueryLimit,searchTerm:le.searchTerm,skip:b}),ue=ne({limit:le.pageQueryLimit,searchTerm:le.searchTerm,skip:A,spaceId:U,blockTypes:J}),de=ne({limit:le.pageQueryLimit,searchTerm:le.searchTerm,skip:A,spaceId:U,blockTypes:Q}),pe=(0,v().O9)(G)?(0,R().KX)(le.searchTerm):void 0,me=(0,n.useCallback)((e=>{m&&!f().n4(m,e)?r(e):m?l():r(e)}),[m,r,l]),ge=(0,n.useCallback)((e=>{const t=e.target.value;se({searchTerm:t,type:"set_search_term"}),$.setState({focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[$]),ye=(0,n.useCallback)((()=>{se({queryLimit:le.collectionQueryLimit+q,type:"set_collection_query_limit"})}),[le.collectionQueryLimit]),he=(0,n.useCallback)((()=>{se({queryLimit:le.pageQueryLimit+q,type:"set_page_query_limit"})}),[le.pageQueryLimit]),fe=(0,n.useCallback)((()=>{se({queryLimit:le.formQueryLimit+q,type:"set_form_query_limit"})}),[le.formQueryLimit]),ve="variable"===(null==m?void 0:m.type)?m.id:void 0,xe="collection"===(null==m?void 0:m.type)?m.collection.id:void 0,Se="page"===(null==m?void 0:m.type)?m.page.id:void 0,be=[],Ae=function(e){const{automationVariables:t,onClick:o,selectedVariableId:n,parentRecordStore:i}=e,a=t.map((e=>{if(e.kind!==s().FormulaContextValueKind.ContextValue)throw new Error("Not implemented yet.");return{action:()=>o({id:e.id,type:"variable"}),key:e.id,render:t=>(0,H.jsx)(w().A,{contextValue:e,isChecked:e.id===n,menuArgs:t,parentRecordStore:i})}}));if(0===a.length)return;return{key:"variable_results",items:a,render:e=>(0,H.jsx)(T().A,{...e,title:(0,H.jsx)(y().sA,{defaultMessage:"From this automation",id:"automations.AutomationTargetPickerMenu.variablesSection.title"})})}}({automationVariables:le.automationVariables,onClick:me,selectedVariableId:ve,parentRecordStore:p});Ae&&be.push(Ae);const Ce=function(e){const{collectionQueryResult:t,onCollectionMenuItemClick:o,onShowMoreItemClick:n,parentRecordStore:i,selectedCollectionId:a}=e;if(t.isLoading)return;let r=[];if(t.error)r.push({action:n,key:"show_more_collection_results",render:e=>(0,H.jsx)(x().A,{...e,caption:(0,H.jsx)(y().sA,{defaultMessage:"Sorry, something went wrong while searching for databases.",id:"automations.AutomationTargetPickerMenu.errorCollections.label"}),shouldWrapCaption:!0})});else{const e=t.results??[],l=e.length;r=e.map((e=>{const t=N().md.createChildStore(i,{table:g().Vl,id:e});return{action:()=>o({collection:t.getSpaceShardedPointer(),type:"collection"}),key:e,render:o=>(0,H.jsx)(j().A,{...o,isChecked:e===a,store:t})}}));const s=t.total??0,c=Math.max(0,s-l);c>0&&r.push({action:n,key:"show_more_collection_results",render:e=>(0,H.jsx)(ee,{...e,showMoreCount:c})})}if(0===r.length)return;return{key:"collection_results",items:r,render:e=>(0,H.jsx)(T().A,{...e,title:(0,H.jsx)(y().sA,{defaultMessage:"Databases",id:"automations.AutomationTargetPickerMenu.collectionsSection.title"})})}}({collectionQueryResult:ce,onCollectionMenuItemClick:me,onShowMoreItemClick:ye,parentRecordStore:p,selectedCollectionId:xe});Ce&&be.push(Ce);const ke=ie({type:"page",onPageMenuItemClick:me,onShowMoreItemClick:he,queryResult:ue,parentRecordStore:p,selectedPageId:Se});ke&&be.push(ke);const Me=ie({type:"form",onPageMenuItemClick:me,onShowMoreItemClick:fe,queryResult:de,parentRecordStore:p,selectedPageId:Se});Me&&be.push(Me);const je=function(e){const{urlResult:t,urlBehavior:o,onMenuItemClick:n,isPagesSectionEmpty:i}=e;if(!t||!o)return;const a=t.type;switch(a){case"notion":if(!i)return;case"web":case"other":const e=[],r={title:t.url,icon:(0,H.jsx)(M().I,{icon:d().globeIcon})};return"allow"===o?e.push({action:()=>{n({type:"url",url:t.url})},key:"url",render:e=>(0,H.jsx)(S().A,{...e,...r})}):"disallow_with_message"===o?e.push({action:()=>{},key:"url",render:e=>(0,H.jsx)(I().A,{placement:O().W.Right,render:t=>(0,H.jsx)(S().A,{...(0,V().A)(t,e),disabled:!0,disabledFeedback:!0,...r}),renderTooltip:()=>(0,H.jsx)(y().sA,{defaultMessage:"Linking to a URL is only allowed if it is the first action in an automation.",id:"automations.AutomationTargetPickerMenu.urlSection.disabledMessage"})})}):(0,v().HB)(o),{key:"url_results",items:e,render:e=>(0,H.jsx)(T().A,{...e,title:(0,H.jsx)(y().sA,{defaultMessage:"Link",id:"automations.AutomationTargetPickerMenu.urlSection.sectionTitle"})})};default:(0,v().HB)(a)}}({urlResult:pe,urlBehavior:G,onMenuItemClick:me,isPagesSectionEmpty:void 0===ke});je&&be.push(je);const Te=ce.isLoading||ue.isLoading||de.isLoading;let Ie;if(be.length>0)Ie=(0,H.jsx)(k().Ay,{initialFocus:0,sections:be,store:$,type:k().Oh.Vertical});else if(Te){const e=Y+2;Ie=(0,H.jsxs)(T().A,{children:[(0,H.jsx)(P().A,{}),[...Array(e)].map(((e,t)=>(0,H.jsx)(C().Ay,{},t)))]})}else Ie=(0,H.jsx)(x().A,{caption:(0,H.jsx)(y().sA,{defaultMessage:"No results",id:"automations.AutomationTargetPickerMenu.noResults.label"})});return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(X,{onChange:ge,value:le.searchTerm,urlsAllowed:"allow"===G}),Ie]})}function X(e){const{onChange:t,value:o,urlsAllowed:n}=e,{isMobile:a}=(0,i().Y0)(),l=(0,y().tz)(),s=(0,r().IS)((()=>({section:{paddingBlockStart:0,marginTop:12}})),[]);return(0,H.jsx)(T().A,{style:s.section,children:(0,H.jsx)(b().Ay,{focusInitial:!a||void 0,onChange:t,placeholder:l.formatMessage(n?U.searchInputPlaceholderUrlsAllowed:U.searchInputPlaceholder),showClearButton:!0,value:o??""})})}const ee=(0,n.forwardRef)((function(e,t){const{showMoreCount:n}=e,i=(0,r().IS)((e=>({showMoreButton:{color:e.text.secondary,fill:e.icon.secondary}})),[]);return(0,H.jsx)(S().A,{...e,icon:(0,H.jsx)(M().I,{icon:o(589407).L}),ref:t,style:i.showMoreButton,title:(0,H.jsx)(y().sA,{defaultMessage:"Show {showMore} more",id:"automations.AutomationTargetPickerMenu.showMore.label",values:{showMore:Math.min(n,q)}})})}));function te(e,t){if("set_variables"===t.type)return{...e,automationVariables:t.variables.slice(0)};if("set_search_term"===t.type){const o=t.searchTerm?G:Y;return{...e,collectionQueryLimit:o,pageQueryLimit:o,searchTerm:t.searchTerm}}if("set_collection_query_limit"===t.type){if(e.collectionQueryLimit!==t.queryLimit)return{...e,collectionQueryLimit:t.queryLimit}}else if("set_page_query_limit"===t.type){if(e.pageQueryLimit!==t.queryLimit)return{...e,pageQueryLimit:t.queryLimit}}else if("set_form_query_limit"===t.type){if(e.formQueryLimit!==t.queryLimit)return{...e,formQueryLimit:t.queryLimit}}else(0,v().HB)(t);return e}function oe(e,t){if("query_loadstart"===t.type){if(!e.isLoading)return{...e,isLoading:!0}}else{if("query_finish"===t.type)return{...e,error:void 0,isLoading:!1,results:t.results,total:t.total};if("query_error"===t.type)return{...e,error:t.error,isLoading:!1,results:void 0,total:void 0};(0,v().HB)(t)}return e}function ne(e){const{limit:t,searchTerm:o,skip:r,spaceId:l,blockTypes:s}=e,c=(0,i().v3)(),d=(0,a().O$)(L().AppStoreCurrentSpaceStore),[p,m]=(0,n.useReducer)(oe,{error:void 0,isLoading:Boolean(r),results:void 0,total:void 0}),[g]=(0,u().Yb)((async()=>{if(r||!l||!d)return;const e=await D().T.searchActions.load(),n=await e.searchPagesInSpace({boostRecentlyViewedPages:!0,environment:c,excludeTemplates:!0,limit:t,query:o,requireEditPermissions:!1,source:"automation_page_picker",spaceId:l,filterOverrides:{blockTypes:s},spaceStore:d});return{results:n.results.map((e=>e.id)),total:n.total}}),[s,c,t,o,r,l,d],{debounce:F().tu});return(0,n.useEffect)((()=>{if("pending"===g.status||"idle"===g.status)m({type:"query_loadstart"});else if("resolved"===g.status){var e,t;m({results:null===(e=g.value)||void 0===e?void 0:e.results,total:null===(t=g.value)||void 0===t?void 0:t.total,type:"query_finish"})}else"rejected"===g.status?m({error:g.error,type:"query_error"}):(0,v().HB)(g)}),[g]),p}function ie(e){const{type:t,queryResult:o,onPageMenuItemClick:n,onShowMoreItemClick:i,selectedPageId:a,parentRecordStore:r}=e;if(o.isLoading)return;const l=[];if(o.error)l.push({action:i,key:"show_more_page_results",render:e=>(0,H.jsx)(x().A,{...e,caption:(0,H.jsx)(y().sA,{defaultMessage:"Sorry, something went wrong while searching for pages.",id:"automations.AutomationTargetPickerMenu.errorPages.label"}),shouldWrapCaption:!0})});else{const e=(o.results??[]).length;for(const i of o.results??[]){const e=N().Bv.createChildStore(r,{table:m().ev,id:i}),t={key:i,render:t=>(0,H.jsx)(j().A,{...t,isChecked:i===a,store:e}),action:()=>n({page:e.getSpaceShardedPointer(),type:"page"})};l.push(t)}const t=o.total??0,s=Math.max(0,t-e);s>0&&l.push({action:i,key:"show_more_page_results",render:e=>(0,H.jsx)(ee,{...e,showMoreCount:s})})}return 0!==l.length?{key:"page"===t?"page_results":"form_results",items:l,render:e=>(0,H.jsx)(T().A,{...e,title:"page"===t?(0,H.jsx)(y().sA,{defaultMessage:"Pages",id:"automations.AutomationTargetPickerMenu.pagesSection.title"}):(0,H.jsx)(y().sA,{defaultMessage:"Forms",id:"automations.AutomationTargetPickerMenu.formsSection.title"})})}:void 0}},200582:(e,t,o)=>{o.d(t,{m:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"4.62 1.77 10.75 15.98",svg:(0,o(474848).jsx)("path",{d:"M11.633 1.812c.263.096.43.354.41.632l-.392 5.51h3.099a.625.625 0 0 1 .506.992l-6.18 8.54a.625.625 0 0 1-1.13-.412l.402-5.5H5.25a.625.625 0 0 1-.507-.99l6.17-8.55a.625.625 0 0 1 .72-.222m-5.161 8.513H9.02a.625.625 0 0 1 .623.67l-.29 3.976 4.173-5.766H10.98a.625.625 0 0 1-.623-.67l.284-3.987z"})},i=(0,o(340498).wt)("lightning",n)},217827:(e,t,o)=>{o.d(t,{A:()=>a});var n=()=>o(821062);class i extends(()=>o(757695))().Store{getInitialState(){return{automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0}}blur(e){void 0!==this.state.automationStore&&(void 0===e||(0,n().A)(this.state,e))&&this.setState({automationActionStore:void 0,automationStore:void 0,contextType:void 0,typecheckResult:void 0})}focus(e){(0,n().A)(this.instanceState,e)||this.setState(e)}}const a=new i;(0,o(604341).exposeDebugValue)("AutomationFocusStore",i)},218275:(e,t,o)=>{o.r(t),o.d(t,{arrowUpRightSquareSmallIcon:()=>a,iconDefinition:()=>i});o(296540);var n=o(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"2.37 2.37 11.25 11.25",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M6.898 5.025a.575.575 0 1 0 0 1.15h2.114l-3.969 3.968a.575.575 0 0 0 .814.814l3.968-3.969v2.114a.575.575 0 0 0 1.15 0V5.6a.575.575 0 0 0-.575-.575z"}),(0,n.jsx)("path",{d:"M4.25 2.375c-1.036 0-1.875.84-1.875 1.875v7.5c0 1.036.84 1.875 1.875 1.875h7.5c1.036 0 1.875-.84 1.875-1.875v-7.5c0-1.036-.84-1.875-1.875-1.875zM3.625 4.25c0-.345.28-.625.625-.625h7.5c.345 0 .625.28.625.625v7.5c0 .345-.28.625-.625.625h-7.5a.625.625 0 0 1-.625-.625z"})]})},a=(0,o(340498).wt)("arrowUpRightSquareSmall",i)},237985:(e,t,o)=>{o.d(t,{II:()=>h,qC:()=>f});var n=o(296540),i=()=>o(56366),a=()=>o(401497),r=()=>o(791089),l=()=>o(164153),s=()=>o(959013),c=()=>o(284371),u=()=>o(214973),d=()=>o(741310),p=()=>o(929531),m=()=>o(27511),g=()=>o(16707),y=o(474848);function h(e){const{actionMenu:t,buttonPopupStore:o,disabled:h,onClick:v,propertySchema:x,value:S}=e,b=(0,s().tz)(),A=(0,a().IS)((()=>({content:{alignItems:"baseline"},propertyName:{...c().RC,fontWeight:c().Wy.medium}})),[]),C=(0,i().K8)((()=>function(e){const{intl:t,propertySchema:o,styles:n,value:i}=e;if(!i)return;const a=(0,y.jsx)("span",{style:n.propertyName,children:o.name});if("formula"===i.type)return(0,y.jsx)(s().sA,{...(0,u().qx)({propertyName:a,propertyValue:(0,y.jsx)(g().g,{returnType:{type:"text"}})})});const l=(0,r().fromSimpleFormulaArrayValue)(null==i?void 0:i.value)[0];if("string"!=typeof l)return;const c=(0,m().a)({intl:t,groupValues:[],optionValues:[l],propertySchema:o});if(0===c.length)return;return(0,y.jsx)(s().sA,{...(0,u().qx)({propertyName:a,propertyValue:c})})}({intl:b,propertySchema:x,styles:A,value:S})),[b,x,A,S]),k=(0,i().K8)((()=>f({intl:b,propertySchema:x,value:S})),[b,x,S]),M=(0,n.useCallback)((e=>(0,y.jsx)(p().aX,{...e,actionMenu:t,buttonPopupStore:o,disabled:h,icon:l().T,onClick:v,children:(0,y.jsx)("div",{style:A.content,children:C})})),[t,o,h,v,A.content,C]);return C&&k?(0,y.jsx)(d().P,{renderOrigin:M,title:k}):null}function f(e){const{intl:t,propertySchema:o,value:n}=e;if(!n)return;const i=o.name;if("formula"===n.type)return(0,y.jsx)(s().sA,{...(0,u().qx)({propertyName:i,propertyValue:(0,y.jsx)(g().L,{})})});const a=(0,r().fromSimpleFormulaArrayValue)(null==n?void 0:n.value)[0];if("string"!=typeof a)return;const l=(0,m().a)({intl:t,isText:!0,groupValues:[],optionValues:[a],propertySchema:o});return 0!==l.length?(0,y.jsx)(s().sA,{...(0,u().qx)({propertyName:i,propertyValue:l})}):void 0}},241319:(e,t,o)=>{o.d(t,{y:()=>a});o(898992),o(672577);var n=()=>o(534177),i=()=>o(977345);function a(e){var t;const{actionModels:o,id:a}=e,r=(0,i().y5)(a),l="action"===r.source?o.find((e=>e.id===r.action_id)):void 0,s=(0,n().O9)(l)&&l.isType("create_page")?null===(t=l.getConfig())||void 0===t?void 0:t.collection:void 0;return{automationValueInfo:r,collectionPointer:s,actionModel:l}}},247345:(e,t,o)=>{o.d(t,{J:()=>p});o(296540);var n=()=>o(484714),i=()=>o(102777),a=()=>o(959013),r=()=>o(285790),l=()=>o(35392),s=()=>o(859428),c=()=>o(962730),u=()=>o(286088),d=o(474848);function p(e){const t=(0,a().tz)(),{onSubmit:o,canSend:p}=e,m=(0,u().q2)(),g=(0,n().WS)(),y=t.formatMessage({id:"completions.CompletionMenuActionBar.sendTooltip",defaultMessage:"Send to AI"});return(0,d.jsx)(s().A,{renderTooltip:()=>(0,d.jsxs)("div",{children:[y,(0,d.jsx)(l().A,{style:m.keyboardShortcutInverted,name:"enter"})]}),placement:c().W.Bottom,render:e=>(0,d.jsx)(r().A,{icon:i().b,onClick:o,color:p?"uiBluePrimary":"secondary",disabled:!p,iconStyle:{height:g?24:20,width:g?24:20},ariaLabel:y,style:{pointerEvents:"auto",height:g?24:20,width:g?24:20},...e})})}},250202:(e,t,o)=>{o.d(t,{G:()=>l,e:()=>r});var n=o(296540),i=()=>o(401497),a=o(474848);let r=function(e){return e[e.Name=0]="Name",e}({});const l=n.forwardRef((function(e,t){const{propertySchema:n,format:l}=e,{name:s,type:c,icon:u}=n,d=(0,o(963589).X)("nds_default_property_noticon"),{isMobile:p}=(0,o(484714).Y0)(),m=(0,i().IS)((e=>({propertyIcon:{fill:e.icon.primary,marginLeft:6,marginRight:2}})),[]),g=(0,i().DP)(),y=l===r.Name?s:o(852353).dC[c];return(0,a.jsx)(o(760217).A,{title:y,icon:(0,a.jsx)(o(743176).zB,{icon:u,type:c,size:p?18:16,theme:g,style:m.propertyIcon,isDefaultNoticonEnabled:d}),...e})}))},274570:(e,t,o)=>{o.r(t),o.d(t,{clockIcon:()=>a,iconDefinition:()=>i});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M10.625 5.725a.625.625 0 1 0-1.25 0v3.65H6.4a.625.625 0 1 0 0 1.25H10c.345 0 .625-.28.625-.625z"}),(0,n.jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M3.625 10a6.375 6.375 0 1 1 12.75 0 6.375 6.375 0 0 1-12.75 0"})]})},a=(0,o(340498).wt)("clock",i)},274652:(e,t,o)=>{o.d(t,{o:()=>a});var n=o(296540),i=o(474848);const a=n.forwardRef((function(e,t){let{color:n="primary",...a}=e;const r=(0,o(401497).IS)((e=>{const t="blue"===n?o(381349).Ay.blue:"secondary"===n?e.text.secondary:e.text.primary;return{title:{color:t,fill:t},buttonMenuItem:{...a.style,...a.disabled?{cursor:"not-allowed"}:{}}}}),[a.disabled,n,a.style]);return(0,i.jsx)(o(760217).A,{ref:t,...a,title:(0,i.jsx)("div",{style:r.title,children:a.title}),icon:(0,i.jsx)(o(8980).I,{icon:o(617668).plusIcon,style:{fill:n}}),style:r.buttonMenuItem})}))},276936:(e,t,o)=>{o.d(t,{h:()=>r});o(898992),o(737550);var n=()=>o(973647),i=()=>o(534177),a=()=>o(527871);function r(e){const{environment:t,typecheckResult:o,automationStore:r}=e,l=null==r?void 0:r.getTriggerType();if((0,i().O9)(l)){if(!(0,a().V)({triggerType:l,environment:t,automationStore:r}))return!0}return!n().Q.isFail(o)&&Object.values(o.value.actionValidationFailures).some((e=>null==e?void 0:e.some((e=>"requires_subscription_upgrade"===e.type))))}},279620:(e,t,o)=>{o.d(t,{Y:()=>r});var n=o(296540),i=()=>o(16006),a=o(474848);function r(e){const{blockStore:t,shouldWrap:o,titleStyle:r,recordTitleRef:l,noUnderline:s,disableTooltip:c}=e,u=(0,n.useRef)({getNode:()=>l.current});return(0,a.jsx)(i().A,{store:t,underline:!s,shouldWrap:o,style:r,ref:u,enableHover:!0,showTooltipWhenTruncated:!0,disableTooltip:c})}},284489:(e,t,o)=>{o.d(t,{k:()=>r});var n=o(296540),i=()=>o(484714),a=()=>o(991249);function r(e){let{from:t,onClose:o,upsell:r}=e;const l=(0,i().v3)();return(0,n.useCallback)((()=>{o&&o(),r&&a().K(l,{from:t,upsell:r})}),[o,r,l,t])}},288739:(e,t,o)=>{o.d(t,{M:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"0.7 2.19 14.6 11.6",svg:(0,o(474848).jsx)("path",{d:"M3.142 2.332a.55.55 0 0 1 .695-.017l.081.077.227.264.007.01 8.773 10.235.056.082a.551.551 0 0 1-.818.701l-.08-.076-1.18-1.376A8.5 8.5 0 0 1 8 12.74c-3.027 0-5.685-1.569-7.026-3.911L.848 8.6a1.29 1.29 0 0 1 0-1.199l.126-.228c.705-1.233 1.776-2.251 3.073-2.94l-.965-1.125-.063-.091a.55.55 0 0 1 .123-.685m2.77 4.078a2.6 2.6 0 0 0-.537 1.588l.014.269a2.626 2.626 0 0 0 2.343 2.343l.268.014c.453 0 .878-.118 1.25-.32L8.023 8.872 8 8.874a.875.875 0 0 1-.861-1.032zM8 3.26c3.125 0 5.857 1.673 7.152 4.141l.065.144c.11.293.11.617 0 .91l-.065.145a7.5 7.5 0 0 1-2.255 2.577L10.58 8.475q.02-.103.031-.208l.014-.269A2.626 2.626 0 0 0 8 5.372l-.077.002-1.66-1.937A8.6 8.6 0 0 1 8 3.261"})},i=(0,o(340498).wt)("eyeSlashFillSmall",n)},293096:(e,t,o)=>{o.d(t,{c:()=>a});o(898992),o(430670),o(737550);var n=()=>o(56366),i=()=>o(76118);function a(e){const{automationStores:t,slackActionFeatureAvailability:o}=e,a=(0,n().K8)((()=>function(e,t){var o;return(0,i().e2)(e)&&"sunset"===(null==e||null===(o=e.expiry)||void 0===o?void 0:o.type)&&t}(o,function(e){const{automationStores:t}=e,o=null==t?void 0:t.flatMap((e=>null==e?void 0:e.getActionStores()));if(!o)return!1;return o.some((e=>"slack_notification"===(null==e?void 0:e.getType())))}({automationStores:t}))),[t,o]);return a}},300985:(e,t,o)=>{o.d(t,{Z:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.49 2.37 15.01 15.25",svg:(0,o(474848).jsx)("path",{d:"M7.154 3.625h1.23a.625.625 0 1 0 0-1.25h-1.23A2.625 2.625 0 0 0 4.529 5v2.069c0 .9-.508 1.722-1.313 2.124l-.317.159a.725.725 0 0 0 0 1.297l.317.158a2.38 2.38 0 0 1 1.313 2.124V15a2.625 2.625 0 0 0 2.625 2.625h1.23a.625.625 0 1 0 0-1.25h-1.23c-.76 0-1.375-.616-1.375-1.375v-2.069c0-1.17-.564-2.256-1.492-2.931a3.63 3.63 0 0 0 1.492-2.931V5c0-.76.615-1.375 1.375-1.375m5.692 12.75h-1.23a.625.625 0 1 0 0 1.25h1.23A2.625 2.625 0 0 0 15.471 15v-2.069c0-.9.508-1.722 1.313-2.124l.317-.159a.725.725 0 0 0 0-1.296l-.317-.159a2.38 2.38 0 0 1-1.313-2.124V5a2.625 2.625 0 0 0-2.625-2.625h-1.23a.625.625 0 1 0 0 1.25h1.23c.76 0 1.375.616 1.375 1.375v2.069c0 1.17.564 2.256 1.492 2.931a3.63 3.63 0 0 0-1.492 2.931V15c0 .76-.615 1.375-1.375 1.375"})},i=(0,o(340498).wt)("curlyBraces",n)},307159:(e,t,o)=>{o.d(t,{A:()=>T,m:()=>j});var n=o(296540),i=()=>o(56366),a=()=>o(401497),r=()=>o(784892),l=()=>o(869190),s=()=>o(977345),c=()=>o(791089),u=()=>o(416504),d=()=>o(758219),p=()=>o(919709),m=()=>o(959013),g=()=>o(534177),y=()=>o(284371),h=()=>o(684125),f=()=>o(419830),v=()=>o(881690),x=()=>o(214973),S=()=>o(133518),b=()=>o(741310),A=()=>o(929531),C=()=>o(436876),k=()=>o(16707),M=o(474848);function j(e){const{actionMenu:t,automationActionStore:o,buttonPopupStore:j,disabled:w,onClick:P,propertySchema:_,value:B,valueContext:R}=e,V=(0,m().tz)(),E=(0,a().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre"},propertyName:{...y().RC,fontWeight:y().Wy.medium}})),[]),D=(0,S().F)({actionId:o.id}),F=(0,i().K8)((()=>function(e){const{intl:t,propertySchema:o,styles:n,typecheckContextValues:i,value:a,valueContext:d}=e,S=(0,M.jsx)("span",{style:n.propertyName,children:o.name});if(void 0===(null==a?void 0:a.value))return(0,M.jsx)(m().sA,{...x().NW({propertyName:S})});let b;const A="formula"===a.type,j=(0,c().fromSimpleFormulaArrayValue)(null==a?void 0:a.value)[0];if(A)b=(0,M.jsx)(k().g,{returnType:{type:"date"}});else if(!(0,g().O9)(j)||"string"==typeof j||"boolean"==typeof j||(0,p().rie)(j)||(0,p().jIt)(j))b=(0,M.jsx)(v().A,{format:r().NY.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,M.jsx)("span",{style:y().RC,children:(0,M.jsx)(m().sA,{...x().CV.unknownValue})})});else if((0,p().s1Y)(j)){const e=(0,p().iVq)(j).id,t=(0,s().IV)(i,e);b=t?(0,M.jsx)(h().F,{value:t,format:r().NY.Medium,isSingle:!1,shouldShrink:!0}):(0,M.jsx)(v().A,{format:r().NY.Medium,isRound:!0,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:(0,M.jsx)("span",{style:y().RC,children:(0,M.jsx)(m().sA,{...x().CV.unknownValue})})})}else if((0,p().qsB)(j)){const e=(0,f().aS)(d),o=(0,p().K7D)(j);b=o?(0,l().zV)({value:o,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,u().P)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:!0,displayInUserTimezone:!0,formatValuesFn:e=>{let{endDate:t,endTime:o,startDate:n}=e;return(0,g().O9)(o)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I,{value:n})," â†’ ",(0,M.jsx)(I,{value:o})]}):(0,g().O9)(t)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I,{value:n})," â†’ ",(0,M.jsx)(I,{value:t})]}):(0,M.jsx)(I,{value:n})}}):null}else{if((0,p().iz3)(j))return(0,M.jsx)(C().A,{token:j});(0,g().HB)(j)}return void 0===b?void 0:(0,M.jsx)(m().sA,{...x().Oo({propertyName:S,propertyValue:b})})}({intl:V,propertySchema:_,styles:E,typecheckContextValues:D,value:B,valueContext:R})),[V,_,E,D,B,R]),O=(0,i().K8)((()=>T({intl:V,propertySchema:_,typecheckContextValues:D,value:B,valueContext:R})),[V,_,D,B,R]),L=(0,n.useCallback)((e=>(0,M.jsx)(A().aX,{...e,actionMenu:t,buttonPopupStore:j,disabled:w,icon:d().Z,onClick:P,children:(0,M.jsx)("div",{style:E.content,children:F})})),[t,j,w,P,E.content,F]);return F&&O?(0,M.jsx)(b().P,{disable:w,renderOrigin:L,title:O}):null}function T(e){const{intl:t,propertySchema:o,typecheckContextValues:n,value:i,valueContext:a}=e,r=o.name;if(void 0===(null==i?void 0:i.value))return(0,M.jsx)(m().sA,{...x().NW({propertyName:r})});let d;const y="formula"===i.type,h=(0,c().fromSimpleFormulaArrayValue)(i.value)[0];if(y)d=(0,M.jsx)(k().L,{});else if(!(0,g().O9)(h)||"string"==typeof h||"boolean"==typeof h||(0,p().rie)(h)||(0,p().jIt)(h)||(0,p().iz3)(h))d=(0,M.jsx)(m().sA,{...x().CV.unknownValue});else if((0,p().s1Y)(h)){const e=(0,p().iVq)(h).id,t=(0,s().IV)(n,e);d=t?(0,s().sM)(t):(0,M.jsx)(m().sA,{...x().CV.unknownValue})}else if((0,p().qsB)(h)){const e=(0,f().aS)(a),o=(0,p().K7D)(h);d=o?(0,l().ZF)({value:o,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,u().P)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:!0,displayInUserTimezone:!0}):null}else(0,g().HB)(h);return void 0===d?void 0:(0,M.jsx)(m().sA,{...x().Oo({propertyName:r,propertyValue:d})})}function I(e){const{value:t}=e,o=(0,a().IS)((e=>({token:{marginBlockEnd:4},tokenBackgroundColor:{backgroundColor:e.palette.gray[75]}})),[]);return(0,M.jsx)(v().A,{backgroundColor:o.tokenBackgroundColor.backgroundColor,format:r().NY.Medium,isRound:!0,isSingle:!0,showRemoveButton:!1,style:o.token,value:t})}},314660:(e,t,o)=>{o.d(t,{f:()=>i});var n=()=>o(246826);function i(e){const{collectionViewStore:t,update:o,transaction:i}=e;n().zv({store:t.getQueryStore(),data:o,transaction:i})}},315564:(e,t,o)=>{o.d(t,{S:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("locked",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M4.79395 14.7227H11.1992C12.252 14.7227 12.7783 14.1963 12.7783 13.0479V8.20801C12.7783 7.19629 12.3682 6.66992 11.541 6.56055V4.96094C11.541 2.36328 9.81152 1.1123 7.99316 1.1123C6.18164 1.1123 4.45215 2.36328 4.45215 4.96094V6.56055C3.625 6.66992 3.21484 7.19629 3.21484 8.20801V13.0479C3.21484 14.1963 3.73438 14.7227 4.79395 14.7227ZM5.75098 4.83105C5.75098 3.22461 6.76953 2.35645 7.99316 2.35645C9.2168 2.35645 10.2422 3.22461 10.2422 4.83105V6.54004H5.75098V4.83105ZM4.99219 13.5059C4.69141 13.5059 4.54102 13.3623 4.54102 13V8.25586C4.54102 7.89355 4.69141 7.76367 4.99219 7.76367H11.0078C11.3086 7.76367 11.4521 7.89355 11.4521 8.25586V13C11.4521 13.3623 11.3086 13.5059 11.0078 13.5059H4.99219Z"})})},320865:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const i=function(){return(0,n.jsx)(o(678553).Ay,{title:(0,n.jsx)(o(331542).A,{})})}},322972:(e,t,o)=>{o.d(t,{P:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.18 1.3 11.63 11.45",svg:(0,o(474848).jsx)("path",{d:"M8.45 12.75a3.66 3.66 0 0 1-1.643-.387v-.008l-1.132-.387h-.097v-6.15l1.399-1.492c.233-.298.458-.745.672-1.172.143-.283.28-.557.413-.773l.287-.589a1.024 1.024 0 0 1 1.232-.418c.496.193.76.728.612 1.24l-.403 1.41c-.079.272-.192.5-.305.73-.11.22-.22.441-.3.704a.32.32 0 0 0 .31.41h3.256a.97.97 0 0 1 .969.97c0 .333-.179.62-.442.79a.94.94 0 0 1 .534.852.955.955 0 0 1-.65.907.96.96 0 0 1 .364.744.96.96 0 0 1-.961.969.97.97 0 0 1-.69 1.65zM4.61 6.334H2.913a.727.727 0 0 0-.727.726v4.181c0 .402.326.727.727.727H4.61z"})},i=(0,o(340498).wt)("handThumbsUpFillSmall",n)},334684:(e,t,o)=>{o.d(t,{$:()=>l});var n=()=>o(970013),i=()=>o(713998),a=()=>o(534177);const r=["button","formula","auto_increment_id","file"];function l(e){const{propertyType:t,propertySchema:o,allowAIProperty:l}=e,s=(0,a().O9)(o)&&(0,n().$M)(o)&&(0,a().O9)((0,n().om)(o)),c=!l&&s,u=(0,a().O9)((0,i().Dz)(o));return r.includes(t)||c||u}},340266:(e,t,o)=>{o.d(t,{d:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"1.55 2.62 12.88 12.68",svg:(0,o(474848).jsx)("path",{d:"M14.44 7.52c0-.39-.14-.77-.41-1.06.08-.19.12-.39.12-.59 0-.54-.27-1.04-.71-1.33.02-.11.03-.21.03-.32 0-.88-.71-1.59-1.59-1.59H8.45c-.67 0-1.32.15-1.93.46l-.95.33H2.91c-.75 0-1.35.61-1.35 1.35v4.18c0 .75.61 1.35 1.35 1.35h1.91l1.67 1.78c.16.21.33.53.48.84l.1.2c.14.28.29.57.43.8l.27.56s.02.03.03.05c.3.5.84.78 1.4.78.19 0 .39-.03.58-.1.8-.32 1.22-1.17.99-2l-.4-1.41c-.09-.32-.23-.59-.34-.82l-.02-.04-.09-.18h2.81c.88 0 1.59-.71 1.59-1.59 0-.26-.07-.51-.19-.74.19-.26.28-.57.28-.9zM8.73 9.89c-.18.24-.23.55-.14.83.1.32.23.58.33.79v.02c.12.22.21.4.27.6l.41 1.42c.06.2-.04.41-.23.48-.17.06-.37 0-.46-.14l-.27-.56s-.02-.04-.03-.05c-.12-.19-.23-.43-.38-.71-.04-.08-.08-.15-.12-.23-.19-.38-.4-.77-.63-1.06-.01-.01-.02-.03-.04-.04L5.68 9.36V4.65c.07 0 .14-.01.2-.03l1.13-.39c.06-.02.11-.05.15-.07.41-.19.84-.29 1.3-.29h3.43c.19 0 .34.15.34.34 0 .09-.04.18-.11.25a.63.63 0 0 0 .46 1.06.329.329 0 0 1 .19.6.63.63 0 0 0-.22.59c.04.22.2.41.41.48.14.05.23.17.23.32 0 .13-.07.23-.18.29-.2.1-.34.3-.35.52s.1.44.29.56c.1.06.16.16.16.27 0 .19-.15.34-.34.34H9.52c-.3 0-.58.14-.76.39zM4.52 4.66v4.38h-1.6a.1.1 0 0 1-.1-.1V4.76c0-.06.05-.1.1-.1z"})},i=(0,o(340498).wt)("handThumbsDownSmall",n)},347114:(e,t,o)=>{o.d(t,{S:()=>m,j:()=>g});var n=o(296540),i=()=>o(56366),a=()=>o(401497),r=()=>o(281067),l=()=>o(959013),s=()=>o(284371),c=()=>o(741310),u=()=>o(929531),d=()=>o(3867),p=o(474848);const m=5;function g(e){const{action:t,actionMenu:o,buttonPopupStore:g,disabled:y,limit:h=m,onClick:f,propertySchema:v,value:x}=e,S=(0,l().tz)(),b=(0,a().IS)((()=>({content:{alignItems:"baseline",display:"flex",flexWrap:"wrap",whiteSpace:"pre",lineHeight:1.6},propertyName:{...s().RC,fontWeight:s().Wy.medium}})),[]),A=(0,i().K8)((()=>(0,d().mk)({intl:S,limit:h,propertySchema:v,styles:b,operator:t,value:x})),[S,h,v,b,t,x]),C=(0,i().K8)((()=>(0,d().cI)({intl:S,limit:h,propertySchema:v,operator:t,value:x})),[t,S,h,v,x]),k=(0,n.useCallback)((e=>(0,p.jsx)(u().aX,{...e,actionMenu:o,buttonPopupStore:g,disabled:y,icon:r().v,onClick:f,children:(0,p.jsx)("div",{style:b.content,children:A})})),[o,g,y,f,b.content,A]);return(0,p.jsx)(c().P,{renderOrigin:k,title:C})}},348501:(e,t,o)=>{o.d(t,{A:()=>s,q:()=>l});var n=o(296540),i=()=>o(959013),a=()=>o(59364),r=o(474848);const l=300,s=(0,n.forwardRef)((function(e,t){const s=(0,i().tz)(),c=(0,o(444570).Jj)(),u=(0,o(401497).IS)((t=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",cursor:e.disableDrag?"pointer":"grab",width:e.width??a().Z,height:e.height??a().S,borderRadius:4,fill:c?t.icon.secondary:t.icon.tertiary,...e.style},text:{color:t.text.contrastSecondary}})),[e.disableDrag,e.width,e.height,e.style,c]);const{onClick:d}=e,p=(0,n.useCallback)((e=>{d&&(e.preventDefault(),d(e))}),[d]),m=(0,n.useCallback)((n=>(0,r.jsx)(o(704152).A,{ref:t,ariaLabel:s.formatMessage({id:"dragHandleButton.ariaLabel",defaultMessage:"Drag"}),role:e.role,style:u.buttonStyle,onClick:e.onClick,onContextMenu:p,disallowTabbing:e.disallowTabbing,...n,children:(0,o(887146).i)({width:14,height:14,...e.iconStyle})})),[p,s,e.disallowTabbing,e.iconStyle,e.onClick,e.role,t,u.buttonStyle]);return e.disableTooltip?m({}):(0,r.jsx)(o(859428).A,{placement:e.tooltipPlacement??o(962730).W.Bottom,delayThreshold:l,renderTooltip:function(){return(0,r.jsxs)("div",{style:{textAlign:"center"},children:[!e.disableDrag&&(0,r.jsx)(i().sA,{defaultMessage:"Drag <medium>to move</medium>",id:"dragHandleButton.dragPrompt.text",values:{medium:e=>(0,r.jsx)("span",{style:u.text,children:e})}}),!e.hideClickMessage&&(0,r.jsx)("div",{children:(0,r.jsx)(i().sA,{defaultMessage:"Click <medium>to open menu</medium>",id:"dragHandleButton.clickPrompt.text",values:{medium:e=>(0,r.jsx)("span",{style:u.text,children:e})}})})]})},render:m})}))},348869:(e,t,o)=>{o.d(t,{g:()=>l});o(944114);var n=()=>o(386164),i=()=>o(532659),a=()=>o(449506),r=()=>o(901389);async function l(e){const{environment:t,onResponse:o,data:l,userId:s,tracking:c,abortSignal:u}=e,d=await a().callStreamApi({eventName:"runInferenceTranscript",environment:t,data:l,userId:s,tracking:c,abortSignal:u,headers:(0,n().WS)({spaceId:l.spaceId})});if("success"!==d.type)return null!=u&&u.aborted?{error:{message:"Aborted",code:0}}:(r().Qg(d),{error:{message:d.error.message,code:d.status}});const p=[];if(i().hS.is(d.data))for await(const n of d.data){if("error"===n.type)return{error:{message:n.message,code:n.errorCode}};null==o||o(n),p.push(n)}return{value:p}}},359186:(e,t,o)=>{o.d(t,{EJ:()=>T,Jx:()=>B,T7:()=>_,Vj:()=>P,Zd:()=>I,ef:()=>w,hF:()=>j});var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(617073),s=()=>o(966098),c=()=>o(818256),u=()=>o(523872),d=()=>o(263931),p=()=>o(352064),m=()=>o(161479),g=()=>o(959013),y=()=>o(284371),h=()=>o(712030),f=()=>o(921855),v=()=>o(546461),x=()=>o(214973),S=()=>o(133518),b=()=>o(741310),A=()=>o(929531),C=()=>o(16707),k=o(474848);function M(e){const{actionMenu:t,automationActionStore:o,buttonPopupStore:l,disabled:s,icon:c,onClick:u,propertySchema:d,value:p}=e,{automationStore:M}=(0,v().EC)(),T=(0,i().v3)(),I=(0,r().DP)(),w=(0,r().IS)((()=>({propertyName:{...y().RC,fontWeight:y().Wy.medium,flexShrink:0}})),[]),P=(0,S().F)({actionId:o.id}),_=(0,a().K8)((()=>function(e){const{automationStore:t,environment:o,propertySchema:n,styles:i,theme:a,typecheckContextValues:r,value:l}=e,s=(0,k.jsx)("span",{style:i.propertyName,children:n.name}),c=void 0===(null==l?void 0:l.value);if(c)return(0,k.jsx)(g().sA,{...x().NW({propertyName:s})});let u;const d="formula"===l.type;if(d)u=(0,k.jsx)(C().g,{returnType:{type:"text"}});else{const e=(0,f().S5)({disabled:!0,disableDateStyleAnnotations:!0,disableHover:!0,disableLinks:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableSuggestionAnnotations:!0,emojiType:(0,h().FN)(o),environment:o,formulaValueTypes:r,katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:l.value??[],spaceId:(0,m().e)(t.pointer.spaceId)},theme:a});u=(0,k.jsxs)(k.Fragment,{children:['"',(0,k.jsx)("span",{style:y().RC,children:e}),'"']})}return(0,k.jsx)(g().sA,{...x().LK({propertyName:s,propertyValue:u})})}({automationStore:M,environment:T,propertySchema:d,styles:w,theme:I,typecheckContextValues:P,value:p})),[M,T,d,w,I,P,p]),B=(0,a().K8)((()=>j({automationStore:M,environment:T,propertySchema:d,theme:I,typecheckContextValues:P,value:p})),[M,T,d,I,P,p]),R=(0,n.useCallback)((e=>(0,k.jsx)(A().aX,{...e,actionMenu:t,buttonPopupStore:l,disabled:s,icon:c,onClick:u,children:_})),[t,l,s,c,u,_]);return _&&B?(0,k.jsx)(b().P,{renderOrigin:R,title:B}):null}function j(e){const{automationStore:t,environment:o,propertySchema:n,theme:i,typecheckContextValues:a,value:r}=e,l=n.name;if(void 0===(null==r?void 0:r.value))return(0,k.jsx)(g().sA,{...x().NW({propertyName:l})});let s;return s="formula"===r.type?(0,k.jsx)(C().L,{}):(0,f().S5)({disabled:!0,disableDateStyleAnnotations:!0,disableFormulaVariableStyles:!0,disableHover:!0,disableInsertedDeletedAnnotations:!0,disableLinks:!0,disableStyleAnnotations:!0,disableSuggestionAnnotations:!0,emojiType:(0,h().FN)(o),environment:o,formulaValueTypes:a,katex:o.KatexStore.getKatex(),parentStore:t,stopLinkPropagation:!0,textValue:{value:r.value??[],spaceId:(0,m().e)(t.pointer.spaceId)},theme:i}),(0,k.jsx)(g().sA,{...x().LK({propertyName:l,propertyValue:s})})}function T(e){return(0,k.jsx)(M,{...e,icon:d().D})}function I(e){return(0,k.jsx)(M,{...e,icon:u().U})}function w(e){return(0,k.jsx)(M,{...e,icon:l().J})}function P(e){return(0,k.jsx)(M,{...e,icon:p().I})}function _(e){return(0,k.jsx)(M,{...e,icon:s().E})}function B(e){return(0,k.jsx)(M,{...e,icon:c().C})}},383574:(e,t,o)=>{o.d(t,{V:()=>s});o(898992),o(354520);var n=()=>o(56366),i=()=>o(81768),a=()=>o(352271),r=()=>o(157857),l=()=>o(546461);function s(){const{automationStore:e,contextType:t}=(0,l().EC)(),o=(0,n().K8)((()=>(0,r().Z6)(e,t)),[e,t]);return(0,n().K8)((()=>{if(!o)return[];const{automation:e,automationActions:t}=o,n=e.getTriggerType(),r=(0,a().ad)({isGenericRecurrenceAllowed:!0})[n],l="default_bound"===r.max?a().x3:r.max;if(t.length>=l)return[];return function(e){const t=e=>e?1:-1;return e.slice().sort(((e,o)=>t(o.hasSideEffects)-t(e.hasSideEffects)))}((0,i().getActionRegistryItemsWithConcern)("display").filter((e=>e.isAvailableForContext({...o,isSubscribed:!0}))))}),[o])}},387712:(e,t,o)=>{o.d(t,{A:()=>a});class n extends(()=>o(757695))().Store{getInitialState(){return{open:!1}}}const i=new n;(0,o(604341).exposeDebugValue)("AutomationModalStore",i);const a=i},390518:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(331542),i=o(474848);function a(){return(0,i.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:200,overflow:"hidden"},children:(0,i.jsx)(n().A,{})})}},390527:(e,t,o)=>{o.r(t),o.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>_,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>C,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>A,MAX_RECURRENCE_INTERVAL:()=>f,MAX_RECURRENCE_NUMBER_OF_RUNS:()=>v,RRULE_WEEKDAYS_MAP:()=>h,adjustedStartDateIfPossible:()=>M,areRecurrenceSchedulesEqual:()=>D,convertFromUnpersistedRecurrenceConfig:()=>E,convertToUnpersistedRecurrenceConfig:()=>B,getFormattedEndCondition:()=>P,getFormattedNextRecurrenceTime:()=>w,getNewEndTimestamp:()=>R,getNextDateUtc:()=>I,getRecurrenceAfter:()=>j,isRunningBetweenMidnightAnd3AM:()=>T,isValidRecurrenceInterval:()=>x,isValidRecurrenceNumberOfRuns:()=>S,rruleFromRecurrence:()=>b,templateAncestorsViolateRecurrenceNesting:()=>k});o(898992),o(354520),o(581454);var n=()=>o(244641);o(944114);function i(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];if(0===o.length)return e.map((e=>[e]));const a=[];for(const r of e)a.push(...i(o[0],...o.slice(1)).map((e=>[r,...e])));return a}var a=()=>o(496603),r=()=>o(534177),l=()=>o(720665),s=()=>o(597777),c=()=>o(869190),u=()=>o(416504),d=()=>o(402390);class p extends(()=>o(896346))().p3{constructor(e,t){super(e,t)}after(e,t){return super.after(e,t)}}var m=()=>o(912720);const g=(0,o(959013).YK)({dateAtTime:{id:"automations.recurrenceHelpers.dateAtTime",defaultMessage:"{date} at {time}"},dateBetweenMidnightAnd3AM:{id:"automations.recurrenceHelpers.dateBetweenMidnightAnd3AM",defaultMessage:"{date} between 12â€“3 AM"},numberEndConditionDescription:{id:"automations.recurrenceHelpers.numberEndConditionDescription",defaultMessage:"{number, plural, one {After {number} run} other {After {number} runs}}"},noEndCondition:{id:"automations.recurrenceHelpers.noEndCondition",defaultMessage:"Never"}}),y={day:p.DAILY,week:p.WEEKLY,month:p.MONTHLY,year:p.YEARLY},h={MO:p.MO,TU:p.TU,WE:p.WE,TH:p.TH,FR:p.FR,SA:p.SA,SU:p.SU},f=99,v=999;function x(e){return(0,l().Et)(e)&&Number.isInteger(e)&&e>0&&e<=f}function S(e){return(0,l().Et)(e)&&Number.isInteger(e)&&e>0&&e<=v}function b(e){const{start_date:t,frequency:o,interval:n,weekdays:a,timezone:l,hour:c,minute:u}=e,d="week"===o&&a?a.map((e=>h[e])):void 0,m={};return(0,r().O9)(e.end_condition)&&("date"===e.end_condition.type?m.until=(0,s().eU)(e.end_condition.end_at):"number"===e.end_condition.type?m.count=e.end_condition.number_of_occurrences:(0,r().HB)(e.end_condition)),"month"===e.frequency&&(0,r().O9)(e.monthly_restriction)&&("monthdays"===e.monthly_restriction.type?m.bymonthday=e.monthly_restriction.monthdays:"weekdays_in_month"===e.monthly_restriction.type?m.byweekday=i(e.monthly_restriction.weekdays,e.monthly_restriction.week_numbers).map((e=>{let[t,o]=e;return h[t].nth(o)})):(0,r().HB)(e.monthly_restriction)),new p({freq:y[o],dtstart:(0,s().eU)(t),interval:n,byweekday:d,tzid:l,byhour:c??0,byminute:u??0,bysecond:0,...m})}const A=1,C=1;function k(e){var t;if(0===e.length)return{violatesConstraint:!1,templateNestingExceedsMaxDepth:!1,ancestorHasDailyTemplate:!1,nestedDepthOfAutomationAncestors:void 0,immediateAncestorRecurrenceType:void 0};const o=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)})),n=e.length,i=null===(t=e[0].getRecurrence())||void 0===t?void 0:t.frequency,a=n>A,r=o.length>=C;return{violatesConstraint:a||r,templateNestingExceedsMaxDepth:a,ancestorHasDailyTemplate:r,nestedDepthOfAutomationAncestors:n,immediateAncestorRecurrenceType:i}}function M(e){var t;const{recurrence:o,afterDate:i}=e;if("number"===(null===(t=o.end_condition)||void 0===t?void 0:t.type)||o.start_date>=i)return o;let a=n().c9.fromMillis(o.start_date,{zone:"utc"});const r=n().c9.fromMillis(i,{zone:"utc"});switch(o.frequency){case"year":{const e=Math.floor(r.diff(a,"years").years/o.interval);a=a.plus({years:e*o.interval});break}case"month":{const e=Math.floor(r.diff(a,"months").months/o.interval);a=a.plus({months:e*o.interval});break}case"week":{const e=Math.floor(r.diff(a,"weeks").weeks/o.interval);a=a.plus({weeks:e*o.interval});break}case"day":{const e=Math.floor(r.diff(a,"days").days/o.interval);a=a.plus({days:e*o.interval});break}}return{...o,start_date:(0,s().DH)(a.toMillis())}}function j(e){const{recurrence:t,afterDate:o}=e;if((0,m().wt)(t)){const e=(0,s().l1)(o);return t.start_date>=e?new Date(t.start_date):void 0}{const e=b(M({recurrence:t,afterDate:o})).after((0,s().eU)(o));if(!e)return;return(0,s().h1)(e)}}function T(e){return 0===e.hour||1===e.hour||2===e.hour}function I(e){return b(e).after((0,s().eU)((0,s().Rz)()))||void 0}function w(e){const{recurrence:t,intl:o}=e,i=I(E(t));if(!i)return;const a=T(t),r=n().c9.fromJSDate(i).toUTC().setZone("local",{keepLocalTime:!0}).setLocale((0,d().H)(o)).setZone(t.timezone),l=(0,c().Yq)({date:r,dateFormat:"relative",allowRelativeDates:!0,intl:o,shortenDate:!0});if(a)return o.formatMessage(g.dateBetweenMidnightAnd3AM,{date:l});{let e=r.toLocaleString(n().c9.TIME_SIMPLE);return t.timezone!==(0,u().P)()&&(e+=` ${r.toFormat("ZZZZ")}`),o.formatMessage(g.dateAtTime,{date:l,time:e})}}function P(e,t){return(0,r().O9)(e)?"number"===e.type?t.formatMessage(g.numberEndConditionDescription,{number:e.number_of_occurrences}):"date"===e.type?(0,c().Yq)({date:n().c9.fromMillis(e.end_at),dateFormat:"relative",allowRelativeDates:!0,intl:t,shortenDate:!0}):void(0,r().HB)(e):t.formatMessage(g.noEndCondition)}const _=100;function B(e){return{...e,start_date:(0,s().l1)(e.start_date),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?{type:"date",end_at:(0,s().l1)(e.end_condition.end_at)}:(0,r().HB)(e.end_condition):void 0}}function R(e,t,o){return e.plus(o-t)}function V(e,t){const o=n().c9.fromMillis(t.end_at).set({hour:e.hour??0,minute:e.minute??0});return{type:"date",end_at:(0,s().Rz)(o.toJSDate())}}function E(e){return{...e,start_date:(0,s().Rz)(new Date(e.start_date)),end_condition:e.end_condition?"number"===e.end_condition.type?e.end_condition:"date"===e.end_condition.type?V(e,e.end_condition):(0,r().HB)(e.end_condition):void 0}}function D(e,t){const o=a().fN(e,(e=>void 0!==e)),n=a().fN(t,(e=>void 0!==e));return a().n4(o,n)}},413194:(e,t,o)=>{o.d(t,{L:()=>we,g:()=>M});o(898992),o(672577);var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(970013),l=()=>o(713998),s=()=>o(784892),c=()=>o(977345),u=()=>o(791089),d=()=>o(919709),p=()=>o(973647),m=()=>o(534177),g=()=>o(529135),y=()=>o(436876),h=()=>o(576241),f=()=>o(546461),v=()=>o(73332),x=()=>o(654734),S=()=>o(566081),b=()=>o(399762),A=()=>o(684125),C=()=>o(419830),k=o(474848);function M(e){const{token:t,disabled:o,setCurrentTokens:n,currentSimpleFormulaValueTokens:M,context:j,parentRecordStore:T}=e,I=(0,i().Y0)(),{typecheckResult:w}=(0,f().YC)(),P=(0,a().K8)((()=>{if("collection"===j.type)return(0,C().aS)(j)}),[j]),_=(0,a().K8)((()=>{if("collection"===j.type)return j.collectionStore.getSchema()[j.property]}),[j]);if("string"==typeof t){if(!_||!(0,r().DQ)(_))return null;const e=(0,l().jy)((null==_?void 0:_.options)??[],t);if(!e)return(0,k.jsx)(g().A,{isSingle:!1,showRemoveButton:!o,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))}},`deleted_option_value_${t}`);const i={value:e.value,color:e.color,isSingle:!1,showRemoveButton:!o,format:I.isMobile?s().NY.Medium:s().NY.Small,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))}};if((0,r().DD)(_)){var B;const t=null===(B=_.groups)||void 0===B||null===(B=B.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})))||void 0===B?void 0:B.color;return(0,k.jsx)(b().q,{...i,groupColor:t})}return(0,k.jsx)(b().O,{...i})}if("boolean"==typeof t)return(0,k.jsx)(v().T,{checked:t,disabled:!0,size:16,style:{marginBottom:6}},t.toString());if((0,d().rie)(t))return(0,k.jsx)(h().A,{handleRemoveToken:o?void 0:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))},token:t});if((0,d().s1Y)(t)){const e=(0,d().iVq)(t).id,i=w&&p().Q.isSuccess(w)?(0,c().IV)(w.value.valueTypes,e):void 0;return i?(0,k.jsx)(A().F,{value:i,format:s().NY.Small,isSingle:!1,shouldShrink:!0,showRemoveButton:!o,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))},style:{margin:"0 6px 6px 0"}}):null}if((0,d().qsB)(t)){const e=M[0],t=e&&(0,u().isAnnotationSimpleValueToken)(e)&&(0,d().qsB)(e)?(0,d().K7D)(e):void 0;return t&&P?(0,k.jsx)(x().A,{value:t,dateFormat:P.dateFormat,timeFormat:P.timeFormat,style:{marginBottom:6}}):null}if((0,d().jIt)(t)){const e=(0,d().v55)(t);return e?(0,k.jsx)(S().A,{format:I.isMobile?s().NY.Medium:s().NY.Small,blockId:e,shouldWrap:!1,shouldShrink:!0,isSingle:!1,parentStore:T,showRemoveButton:!o,onClickRemove:()=>{null==n||n((0,u().simpleFormulaValueWithoutToken)(M,t))}},e):null}if((0,d().iz3)(t))return(0,k.jsx)(y().A,{token:t});(0,m().HB)(t)}o(18107),o(967357);var j=()=>o(217827),T=()=>o(542339);function I(){const e=(0,f().YC)(),{menuStore:t}=(0,n.useContext)(T().S),{automationActionId:o,insertionPoint:i}=(0,a().K8)((()=>{const e=null==t?void 0:t.getCurrentTab();return{automationActionId:"eventActionProperty"===(null==e?void 0:e.type)?e.actionId:void 0,insertionPoint:null==t?void 0:t.getInsertionPoint()}}),[t]),r=(0,a().K8)((()=>{var t;return o?null===(t=e.automationStore)||void 0===t?void 0:t.findActionStoreById(o):function(e,t){if(!e)return;const o=e.getActionIds(),n=e.getActionStores();if(!t)return;if("beforeActionId"in t){const e=o.indexOf(t.beforeActionId)-1;return e<=0?n.at(0):n.at(e)}if("afterActionId"in t){const e=o.indexOf(t.afterActionId);if(-1===e)return;return n.at(e+1)}(0,m().HB)(t)}(e.automationStore,i)}),[o,i,e.automationStore]);(0,n.useEffect)((()=>{if(e.defined&&p().Q.isSuccess(e.typecheckResult)){const{automationStore:t,contextType:o,typecheckResult:n}=e;return j().A.focus({automationStore:t,contextType:o,typecheckResult:n.value,automationActionStore:r}),function(){j().A.blur({automationStore:t,contextType:o,typecheckResult:n.value,automationActionStore:r})}}}),[r,e])}var w=()=>o(47170),P=()=>o(999638),_=()=>o(7868),B=()=>o(294852),R=()=>o(621314),V=(o(944114),o(581454),()=>o(401497)),E=(o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(354520),o(908872),()=>o(908006)),D=()=>o(247331),F=()=>o(959013),O=()=>o(778078),L=()=>o(496603),K=()=>o(742971),N=()=>o(258804),W=()=>o(856952),z=()=>o(780054),H=()=>o(970585),U=()=>o(120423);function Y(e){let{disabled:t,handleRemoveToken:o,propertySchema:a,token:c}=e;const u=(0,i().Y0)(),d=(0,n.useCallback)((()=>{o&&o(c)}),[o,c]);if("string"!=typeof c||!a||!(0,r().DQ)(a))return null;const p=(0,l().jy)((null==a?void 0:a.options)??[],c);if(!p)return(0,k.jsx)(g().A,{isSingle:!1,showRemoveButton:!t,onClickRemove:d},`deleted_option_value_${c}`);if((0,r().DD)(a)){var m;const e=null===(m=a.groups)||void 0===m||null===(m=m.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(p.id)})))||void 0===m?void 0:m.color;return(0,k.jsx)(b().q,{color:p.color,format:u.isMobile?s().NY.Medium:s().NY.Small,groupColor:e,isSingle:!1,onClickRemove:d,showRemoveButton:!t,value:p.value})}return(0,k.jsx)(b().O,{color:p.color,format:u.isMobile?s().NY.Medium:s().NY.Small,isSingle:!1,onClickRemove:d,showRemoveButton:!t,value:p.value})}var G=()=>o(722872),q=()=>o(928600),$=()=>o(939740),J=()=>o(64e3),Q=()=>o(480095),Z=()=>o(89924),X=()=>o(996027),ee=()=>o(231713),te=()=>o(760217);function oe(e){let{isChecked:t,checkType:o,menuArgs:n,onCheckboxClick:a,option:r}=e;const l=(0,i().Y0)();return(0,k.jsx)(te().A,{...n,..."single"===o?{isChecked:t}:{},..."multi"===o?{icon:(0,k.jsx)(v().T,{checked:t,size:14,onClick:a})}:{},title:(0,k.jsx)(b().O,{value:r.value,color:r.color,showRemoveButton:!1,isSingle:!0,shouldShrink:!0,format:l.isMobile?s().NY.Large:s().NY.Small}),isTokenTitle:!0})}function ne(e){let{isChecked:t,checkType:o,menuArgs:n,onCheckboxClick:a,option:r,group:l}=e;const c=(0,i().Y0)();return(0,k.jsx)(te().A,{...n,..."single"===o?{isChecked:t}:{},..."multi"===o?{icon:(0,k.jsx)(v().T,{checked:t,size:14,onClick:a})}:{},title:(0,k.jsx)(b().q,{color:r.color,format:c.isMobile?s().NY.Large:s().NY.Small,groupColor:null==l?void 0:l.color,isSingle:!0,shouldShrink:!0,showRemoveButton:!1,value:r.value},r.value),isTokenTitle:!0})}function ie(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:l,formulaValueContext:s,isSingle:p,menuProps:g,onChange:y,onClose:h,showClearButton:f=!1,showInputMenuItem:v=!1,showReplaceAddRemoveToggle:x=!1,type:S,value:b,parentRecordStore:A}=e,C=(0,i().Y0)(),M=(0,V().IS)((e=>({replaceAddRemoveToggleButton:{marginLeft:"8px",marginRight:"8px",marginTop:"8px"}})),[]),{footer:j,groupedItems:T,menuListStore:I,noResultsMessage:w,replaceAddRemoveToggleButton:P,searchInput:_,selectItems:B,valueItems:R}=function(e){const{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:l,formulaValueContext:s,isSingle:p,onChange:g,onClose:y,showClearButton:h,showReplaceAddRemoveToggle:f,type:v,value:x}=e,[S,b]=(0,n.useState)(""),A=(0,a().uB)(void 0,H().A),C=(0,i().Y0)(),M=(0,F().tz)(),{collectionStore:j,property:T}=s,I=(0,a().K8)((()=>j.getSchema()[T]),[j,T]),w=I&&(0,r().DD)(I),P=(0,a().K8)((()=>w?I.groups??[]:[]),[w,I]),_=(0,a().K8)((()=>I&&(0,r().DQ)(I)&&I.options||[]),[I]),B=(0,n.useMemo)((()=>l.filter((e=>(0,c().o5)(e.type,{type:"select",collection:v.collection,property:v.property})))),[l,v.collection,v.property]),R=(0,a().K8)((()=>({valueResults:S?(0,O().Ay)(S,B,(e=>e.kind===D().FormulaContextValueKind.ContextValue?e.name:"")):B,selectResults:S?(0,O().Ay)(S,_,(e=>e.value)):_})),[S,B,_]),V=(0,n.useCallback)((()=>{b(""),A.setState({...A.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[A]),G=(0,n.useCallback)(((e,o)=>{g(e||x,o||t)}),[t,g,x]),q=(0,n.useCallback)((()=>{p&&E().default.afterNextFlush((()=>{y()}))}),[p,y]),$=(0,n.useCallback)((e=>{G({type:"simple",value:p?(0,u().toSimpleFormulaSingleValue)(e[0]):(0,u().toSimpleFormulaArrayValue)(e)}),q(),V()}),[G,p,q,V]),J=(0,n.useCallback)((()=>{$(o.slice(0,o.length-1))}),[o,$]),Q=(0,n.useCallback)((e=>{$((0,u().simpleFormulaValueWithoutToken)(o,e))}),[o,$]),Z=(0,n.useMemo)((()=>L().oE(o.map(((e,t)=>(0,k.jsx)(Y,{disabled:!1,handleRemoveToken:Q,propertySchema:I,token:e},`select_option_token_${t}`))))),[o,Q,I]),X=(0,n.useMemo)((()=>new Set(L().oE(o.map((e=>(0,u().isAnnotationSimpleValueToken)(e)&&(0,d().s1Y)(e)&&(0,d().iVq)(e).id))))),[o]),ee=(0,n.useMemo)((()=>L().oE((R.valueResults??[]).map((e=>{const t=e.kind===D().FormulaContextValueKind.ContextValue&&e.id||"";if(!t||!X.has(t))return{action:p?"replace":"append",currentSimpleFormulaValueTokens:o,onCheckboxClick:q,id:t,isStatusProperty:Boolean(w),setCurrentTokens:$,value:e}})))),[X,o,q,p,w,R.valueResults,$]),te=p?"single":"multi",oe=(0,n.useMemo)((()=>L().oE(R.selectResults??[]).reduce(((e,t)=>{const n=Boolean(o.find((e=>"string"==typeof e&&e===t.value)));return e[t.id]={isChecked:n,checkType:te,group:void 0,id:t.id,isStatusProperty:Boolean(w),onCheckboxClick:()=>{$(p?n?[]:[t.value]:n?(0,u().simpleFormulaValueWithoutToken)(o,t.value):[...o,t.value]),p&&E().default.afterNextFlush((()=>{y()}))},option:t},e}),{})),[te,o,p,w,y,R.selectResults,$]),ne=(0,n.useMemo)((()=>Object.values(oe)),[oe]),ie=(0,n.useMemo)((()=>P.map((e=>({items:(e.optionIds??[]).map((e=>oe[e])).filter(m().O9),group:e})))),[oe,P]),ae=P.length>0&&0===ie.length||0===P.length&&0===ne.length,re=(0,k.jsx)("div",{style:{...!z().A.isMobile&&{padding:"0 8px 4px 8px"}},children:(0,k.jsx)(W().Ay,{dontShowBorderBottom:C.isAndroid,focus:!z().A.isMobile||void 0,focusAfterAnimation:!0,format:W().le.FilterValue,onChange:e=>b(e.target.value),onClearButtonClick:()=>$([]),onRemoveLastToken:J,placeholder:M.formatMessage(K().D.searchPlaceHolder),showClearButton:h,tokens:Z,value:S})}),le=(0,k.jsx)(N().A,{value:x,onChange:G}),se=(0,k.jsx)(U().A,{action:t,handleOnChange:G});return{footer:le,groupedItems:ie,menuListStore:A,noResultsMessage:ae&&M.formatMessage(K().D.noResults),replaceAddRemoveToggleButton:Boolean(f)&&se,searchInput:re,selectItems:ne,valueItems:ee}}({action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:l,formulaValueContext:s,isSingle:p,onChange:y,onClose:h,showClearButton:f,showReplaceAddRemoveToggle:x,type:S,value:b})||{},te=(0,n.useMemo)((()=>R.map((e=>{const{annotation:t,itemAction:o}=(0,ee().E)({action:e.action,currentSimpleFormulaValueTokens:e.currentSimpleFormulaValueTokens,setCurrentTokens:e.setCurrentTokens,value:e.value});return{key:e.id,render:e=>(0,k.jsx)(X().A,{annotation:t,disabled:!1,formulaTypecheckContextValues:l,menuArgs:e,parentRecordStore:A}),action:o}}))),[l,R,A]),{groupedMenuItems:ie,selectMenuItems:ae}=(0,n.useMemo)((()=>{let e=[],t=[];return T.length>0?e=T.map((e=>{let{group:t,items:o}=e;return{key:t.name,render:e=>(0,k.jsx)(Z().A,{...e,title:t.name,topBorder:!0}),items:o.map((e=>({key:e.id,render:t=>(0,k.jsx)(ne,{...t,isChecked:e.isChecked,checkType:e.checkType,group:e.group,menuArgs:t,onCheckboxClick:e.onCheckboxClick,option:e.option}),action:e.onCheckboxClick})))}})):t=B.map((e=>({key:e.id,render:t=>(0,k.jsx)(oe,{...t,isChecked:e.isChecked,checkType:e.checkType,menuArgs:t,onCheckboxClick:e.onCheckboxClick,option:e.option}),action:e.onCheckboxClick}))),{groupedMenuItems:e,selectMenuItems:t}}),[T,B]),re=[...te,...ae];let le,se=[];re.length>0&&se.push({key:"options",render:e=>(0,k.jsx)(Z().A,{...e}),items:re}),ie.length>0&&(se=[...se,...ie]),le=C.isMobile?{menuType:G().gu.Modal,right:(0,k.jsx)(Q().DoneMenuText,{}),onClickRight:h,footer:j&&(0,k.jsx)(Z().A,{topBorder:!0,children:j})}:{menuType:G().gu.Popup,maxHeight:"50vh",width:260,footer:j&&(0,k.jsx)(Z().A,{topBorder:!0,children:j}),disableHeaderBorder:!0};const ce=(0,k.jsxs)(k.Fragment,{children:[!C.isMobile&&(null==g?void 0:g.header),v&&(0,k.jsx)(Z().A,{children:_})]});return(0,k.jsxs)(q().A,{...le,header:ce,children:[P&&(0,k.jsx)("div",{style:M.replaceAddRemoveToggleButton,children:P}),w&&(0,k.jsx)(Z().A,{children:(0,k.jsx)(J().A,{title:w})}),se.length>0&&(0,k.jsx)($().Ay,{type:$().Oh.Vertical,initialFocus:0,sections:se,store:I})]})}var ae=()=>o(277871),re=(o(737550),o(16280),()=>o(764880)),le=()=>o(179034),se=()=>o(798880),ce=()=>o(962730),ue=()=>o(630116),de=()=>o(958378),pe=()=>o(859428),me=()=>o(448693);const ge=(0,F().YK)({maximumPeopleSelectedTooltip:{defaultMessage:"Maximum people selected",id:"valuePickerItem.maximumSelectedReached"}});function ye(e){const{args:t,isChecked:o,checkType:n,context:g,disabled:h,onCheckboxClick:x,parentRecordStore:S,token:A}=e,C=(0,i().Y0)(),M=(0,a().K8)((()=>{if((0,u().isAnnotationSimpleValueToken)(A)&&(0,d().rie)(A)){const e=(0,d().NcG)(A);if(e)return(0,re().xC)({pointer:{table:se().oo,id:e},getRecordValue:S.getRecordModel})}}),[S.getRecordModel,A]),j=(0,a().K8)((()=>g.collectionStore.getSchema()[g.property]),[g]),T=(0,a().K8)((()=>j&&(0,r().DQ)(j)?j.options??[]:[]),[j]),I=(0,a().K8)((()=>j&&(0,r().DD)(j)?j.groups??[]:[]),[j]),{typecheckResult:w}=(0,f().YC)(),P=(0,V().IS)((e=>({disabledMenuItem:{cursor:"not-allowed",opacity:.4}})),[]),_=Boolean(j&&(0,r().DD)(j)),B="single"===n?{isChecked:o}:"multi"===n?{icon:(0,k.jsx)(v().T,{style:h?P.disabledMenuItem:void 0,checked:o,size:14,onClick:x,disabled:h})}:{};if("string"==typeof A){if(_){const e=(0,l().jy)(T,A),o=I.find((t=>{var o;return e&&(null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id))}));return e?(0,k.jsx)(te().A,{...t,...B,title:(0,k.jsx)(b().q,{format:C.isMobile?s().NY.Large:s().NY.Small,isSingle:!0,value:e.value,color:e.color,groupColor:null==o?void 0:o.color,shouldShrink:!0,showRemoveButton:!1},A),isTokenTitle:!0,disabled:h,style:h?P.disabledMenuItem:void 0,...t}):null}{const e=(0,l().jy)(T,A);return e?(0,k.jsx)(te().A,{...t,...B,title:(0,k.jsx)(b().O,{value:e.value,color:e.color,showRemoveButton:!1,isSingle:!0,shouldShrink:!0,format:C.isMobile?s().NY.Large:s().NY.Small}),isTokenTitle:!0,disabled:h,style:h?P.disabledMenuItem:void 0,...t}):null}}if("boolean"==typeof A)return null;if((0,d().rie)(A))return null!=M&&M.asActor&&M.table===se().oo?(0,k.jsx)(te().A,{...t,...B,title:h?(0,k.jsx)(pe().A,{renderTooltip:()=>(0,k.jsx)(F().sA,{...ge.maximumPeopleSelectedTooltip}),placement:ce().W.Right,render:e=>(0,k.jsx)("div",{style:{width:"100%"},...e,children:(0,k.jsx)(me().t_,{isSingle:!0,shouldShrink:!0,format:C.isMobile?me().t_.Format.Large:me().t_.Format.Medium,userValue:M.asActor,hasPersonHoverCard:!1})})}):(0,k.jsx)(me().t_,{isSingle:!0,shouldShrink:!0,format:C.isMobile?me().t_.Format.Large:me().t_.Format.Medium,userValue:M.asActor,hasPersonHoverCard:!1}),disabled:h,style:h?P.disabledMenuItem:void 0,isTokenTitle:!0}):null;if((0,d().s1Y)(A)){const e=(0,d().iVq)(A).id,n=w&&p().Q.isSuccess(w)?(0,c().IV)(w.value.valueTypes,e):void 0;return n?(0,k.jsx)(X().A,{isChecked:o,contextValue:n,disabled:Boolean(h),menuArgs:t,parentRecordStore:S}):null}if((0,d().qsB)(A))return null;if((0,d().jIt)(A)){const e=(0,d().v55)(A);if(!e)return null;const n=ue().Bv.createChildStore(S,{id:e,table:le().ev});return(0,k.jsx)(de().A,{store:n,isChecked:o,hidePath:!0,...t})}if((0,d().iz3)(A))return(0,k.jsx)(y().A,{token:A});(0,m().HB)(A)}function he(e){const{currentSimpleFormulaValueTokens:t,value:o,setCurrentTokens:n,action:i,context:a,checkType:r,onCheckboxClick:l,isDisabled:s,parentRecordStore:c}=e;if(o.kind!==D().FormulaContextValueKind.ContextValue)throw new Error("Not implemented yet.");const p=Boolean(t.find((e=>(0,u().isAnnotationSimpleValueToken)(e)&&(0,d().s1Y)(e)&&(0,d().iVq)(e).id===o.id))),m=(0,d().CA$)({id:o.id}),g=()=>{n("append"===i?p?(0,u().simpleFormulaValueWithoutToken)(t,m):[...t,m]:[m]),null==l||l()};return{key:o.id,render:e=>(0,k.jsx)(ye,{disabled:s,token:m,args:e,isChecked:p,checkType:r,context:a,onCheckboxClick:g,parentRecordStore:c}),action:g}}function fe(e){const{context:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:a,menuProps:r,onChange:l,onClose:s,parentRecordStore:c,value:d}=e,p=(0,F().tz)(),m=(0,i().Y0)(),g=a.filter((e=>"checkbox"===e.type.type)),y=(0,n.useCallback)((e=>{l({type:"simple",value:void 0!==e[0]?(0,u().toSimpleFormulaSingleValue)(e[0]):void 0})}),[l]),h=(0,n.useCallback)((e=>{y(e),s()}),[y,s]),f=L().oE(g.map((e=>he({currentSimpleFormulaValueTokens:o,value:e,setCurrentTokens:h,action:"replace",context:t,checkType:"single",parentRecordStore:c})))),v=[],x=o.some((e=>!0===e)),S=[...f,...[{key:0,render:e=>(0,k.jsx)(te().A,{title:(0,k.jsx)(F().sA,{...K().D.unchecked}),isChecked:!x,...e}),action:()=>{h([!1])}},{key:1,render:e=>(0,k.jsx)(te().A,{title:(0,k.jsx)(F().sA,{...K().D.checked}),isChecked:x,...e}),action:()=>{h([!0])}}]],b=void 0!==(null==r?void 0:r.header)?r.header:(0,k.jsx)(Z().A,{style:{paddingBottom:0},title:p.formatMessage(K().D.genericMenuHeader)}),A=Boolean(b);v.push({key:"checkbox",render:e=>(0,k.jsx)(Z().A,{...e,topBorder:A}),items:S});const C=(0,k.jsx)(Z().A,{topBorder:!0,children:(0,k.jsx)(N().A,{onChange:l,value:d})});let M;M=m.isMobile?{menuType:G().gu.Modal,right:(0,k.jsx)(Q().DoneMenuText,{}),onClickRight:s,footer:C}:{menuType:G().gu.Popup,maxHeight:"50vh",width:260,disableHeaderBorder:!0,header:b,footer:C};const j={...M,...r,header:m.isMobile?null:b};return(0,k.jsx)(q().A,{...j,children:(0,k.jsx)($().Ay,{type:$().Oh.Vertical,initialFocus:0,sections:v})})}var ve=()=>o(42583),xe=()=>o(8980),Se=()=>o(597777),be=()=>o(274609),Ae=()=>o(75858),Ce=()=>o(186445),ke=()=>o(645873),Me=()=>o(493823),je=()=>o(285790);function Te(e){const{context:t,currentSimpleFormulaValueTokens:o,disabled:i,onClose:r,setCurrentTokens:l,setInDatePicker:s}=e,c=o[0],p=c&&(0,u().isAnnotationSimpleValueToken)(c)&&d().qsB(c)?d().K7D(c):void 0,m=(0,F().tz)(),g=(0,a().O$)(Ce().XX),y=(0,n.useCallback)((()=>{s(!1)}),[s]),h=(0,n.useCallback)((e=>{e&&(0,Se().kC)(e)?l([d().Ww9(e)]):l([])}),[l]),f=(0,V().IS)((e=>({header:{display:"flex",alignItems:"center",fontSize:12,paddingInline:14,color:e.text.secondary,marginTop:8,fontWeight:500},iconWrap:{width:18,height:18,marginRight:4},icon:{width:12,height:12},title:{flex:"1 1 auto"}})),[]),v=(0,a().K8)((()=>(0,C().aS)(t)),[t]);return(0,k.jsx)(ke().u2,{dependency:Ae().cm,children:e=>{let{DatePropertyMenu:t}=e;return(0,k.jsx)(t,{firstDayOfWeek:g,value:p,canConfigureCollection:!1,onChangeValue:h,dateFormat:v.dateFormat,timeFormat:v.timeFormat,onDismiss:r,disabled:i,shouldShowReminder:!1,header:(0,k.jsxs)("div",{style:f.header,children:[(0,k.jsx)(je().A,{ariaLabel:m.formatMessage(K().D.back),icon:be().L,onClick:y,style:f.iconWrap,iconStyle:f.icon}),(0,k.jsx)("span",{style:f.title,children:(0,k.jsx)(F().sA,{...K().D.pickADate})}),(0,k.jsx)(Me().p,{onClick:r,isBlue:!0,children:(0,k.jsx)(Q().DoneMenuText,{})})]}),isTemplatePage:!1})}})}function Ie(e){const{context:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:a,menuProps:r,onChange:l,onClose:s,parentRecordStore:c,value:d}=e,p=(0,F().tz)(),m=(0,i().Y0)(),[g,y]=(0,n.useState)(!1),h=a.filter((e=>"date"===e.type.type)),f=(0,n.useCallback)((e=>{l({type:"simple",value:void 0!==e[0]?(0,u().toSimpleFormulaSingleValue)(e[0]):void 0})}),[l]),v=(0,n.useCallback)((e=>{f(e),s()}),[f,s]),x=(0,n.useCallback)((()=>{y(!0)}),[]),S=(0,n.useCallback)((()=>{f([]),s()}),[f,s]);if(g)return(0,k.jsx)(Te,{context:t,currentSimpleFormulaValueTokens:o,disabled:!1,onClose:s,setCurrentTokens:f,setInDatePicker:y});const b=void 0!==(null==r?void 0:r.header)?r.header:(0,k.jsx)(Z().A,{style:{paddingBottom:0},title:p.formatMessage(K().D.genericMenuHeader)}),A=L().oE(h.map((e=>he({currentSimpleFormulaValueTokens:o,value:e,setCurrentTokens:v,parentRecordStore:c,action:"replace",context:t,checkType:"single"})))),C=[];if(A.length>0){const e=Boolean(b);C.push({key:"values",render:t=>(0,k.jsx)(Z().A,{topBorder:e,...t}),items:A})}const M=(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(Z().A,{topBorder:!0,children:[(0,k.jsx)(te().A,{icon:(0,k.jsx)(xe().I,{icon:ve().D,color:"secondary"}),title:(0,k.jsx)(F().sA,{...K().D.pickADate}),focused:!1,showExtensionArrow:!0,onClick:x}),(0,k.jsx)(N().A,{onChange:l,value:d})]}),o.length>0&&(0,k.jsx)(Z().A,{topBorder:!0,children:(0,k.jsx)(te().A,{title:(0,k.jsx)(F().sA,{...K().D.clear}),focused:!1,onClick:S})})]});let j;j=m.isMobile?{menuType:G().gu.Modal,right:(0,k.jsx)(Q().DoneMenuText,{}),onClickRight:s,footer:M}:{menuType:G().gu.Popup,maxHeight:"50vh",width:260,footer:M,disableHeaderBorder:!0};const T={...j,...r,header:m.isMobile?null:b};return(0,k.jsx)(q().A,{...T,children:(0,k.jsx)($().Ay,{type:$().Oh.Vertical,initialFocus:0,sections:C})})}function we(e){const{action:t,allowedFormulaReturnTypes:o,currentSimpleFormulaValueTokens:i,disableEmojiCommands:a,disableFormattingAndMentions:r,disableMobileActionBar:l,formulaTypecheckContextValues:s,formulaValueContext:c,limit:u,menuProps:d,onChange:p,onClose:g,parentRecordStore:y,showClearButton:h,showInputMenuItem:f,showReplaceAddRemoveToggle:v,type:x,value:S}=e;I();const b="formula"===(null==S?void 0:S.type),A=(0,w().O)(),C=n.useCallback((()=>{p({type:"simple",value:null==S?void 0:S.value})}),[p,null==S?void 0:S.value]);return b&&A?(0,k.jsx)(P().A,{allowedReturnTypes:o,disabled:!1,formulaTypecheckContextValues:s,onBack:C,onChange:p,onClose:g,parentRecordStore:y,restrictUnaccessibleProperties:"cross_space_and_read_permissions",spaceId:A,value:S}):"person_array"===x.type?(0,k.jsx)(Be,{action:t,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:s,formulaValueContext:c,limit:u,menuProps:d,onChange:p,onClose:g,showClearButton:h??!0,showInputMenuItem:f??!0,showFormulaValueItems:!0,showGenericHeader:!0,showReplaceAddRemoveToggle:v,showPersonCheckbox:v,getRecordModel:y.getRecordModel,value:S,parentRecordStore:y}):"collection"!==c.type?null:"text"===x.type?(0,k.jsx)(_e,{currentSimpleFormulaValueTokens:i,disableEmojiCommands:a,disableFormattingAndMentions:r,disableMobileActionBar:l,formulaTypecheckContextValues:s,menuProps:d,onChange:p,onClose:g,parentRecordStore:y,showGenericHeader:!0,value:S}):"number"===x.type?(0,k.jsx)(Pe,{currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:s,menuProps:d,onChange:p,onClose:g,showGenericHeader:!0,value:S,parentRecordStore:y}):"checkbox"===x.type?(0,k.jsx)(fe,{context:c,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:s,menuProps:d,onChange:p,onClose:g,parentRecordStore:y,value:S}):"date"===x.type?(0,k.jsx)(Ie,{context:c,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:s,menuProps:d,onChange:p,onClose:g,parentRecordStore:y,value:S}):"block_array"===x.type?(0,k.jsx)(Re,{action:t,collection:"block_array"===x.type?x.collection:void 0,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:s,formulaValueContext:c,menuProps:d,onChange:p,onClose:g,showClearButton:h??!0,showFormulaValueItems:!0,showGenericHeader:!0,showInputMenuItem:f??!0,showReplaceAddRemoveToggle:v,value:S,parentRecordStore:y}):"select"===x.type?(0,k.jsx)(ie,{currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:s,formulaValueContext:c,isSingle:!0,menuProps:d,onChange:p,onClose:g,showClearButton:h??!0,showInputMenuItem:f??!0,type:x,value:S,parentRecordStore:y}):"select_array"===x.type?(0,k.jsx)(ie,{action:t,currentSimpleFormulaValueTokens:i,formulaTypecheckContextValues:s,formulaValueContext:c,isSingle:!1,menuProps:d,onChange:p,onClose:g,showClearButton:h??!0,showInputMenuItem:f??!0,showReplaceAddRemoveToggle:v,type:x,value:S,parentRecordStore:y}):void(0,m().HB)(x)}function Pe(e){let{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,showGenericHeader:r,value:l,parentRecordStore:s}=e;const{numberMenu:c}=(0,_().A)({currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,showGenericHeader:r,value:l,parentRecordStore:s});return c}function _e(e){let{currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,parentRecordStore:r,showGenericHeader:l,value:s}=e;const{textMenu:c}=(0,ae().A)({currentSimpleFormulaValueTokens:t,formulaTypecheckContextValues:o,menuProps:n,onChange:i,onClose:a,parentRecordStore:r,showGenericHeader:l,value:s});return c}function Be(e){let{action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:n,formulaValueContext:i,limit:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showInputMenuItem:u,showFormulaValueItems:d,showGenericHeader:p,showReplaceAddRemoveToggle:m,showPersonCheckbox:g,getRecordModel:y,value:h,parentRecordStore:f}=e;const{personArrayMenu:v}=(0,B().A)({action:t,currentSimpleFormulaValueTokens:o,formulaTypecheckContextValues:n,formulaValueContext:i,limit:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showInputMenuItem:u,showFormulaValueItems:d,showGenericHeader:p,showReplaceAddRemoveToggle:m,showPersonCheckbox:g,getRecordModel:y,value:h,parentRecordStore:f});return v}function Re(e){let{action:t,collection:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:i,formulaValueContext:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showFormulaValueItems:u,showGenericHeader:d,showInputMenuItem:p,showReplaceAddRemoveToggle:m,value:g,parentRecordStore:y}=e;const{relationMenu:h}=(0,R().A)({action:t,collection:o,currentSimpleFormulaValueTokens:n,formulaTypecheckContextValues:i,formulaValueContext:a,menuProps:r,onChange:l,onClose:s,showClearButton:c,showFormulaValueItems:u,showGenericHeader:d,showInputMenuItem:p,showReplaceAddRemoveToggle:m,value:g,parentRecordStore:y});return h}},422540:(e,t,o)=>{o.d(t,{$0:()=>h,Fx:()=>C,Ge:()=>m,I3:()=>d,Kj:()=>b,PP:()=>k,TK:()=>M,Yy:()=>u,aE:()=>j,cQ:()=>A,kH:()=>g,m7:()=>p,nq:()=>x,nv:()=>f,tj:()=>y});o(898992),o(354520),o(737550);var n=()=>o(496603),i=()=>o(534177),a=()=>o(970013),r=()=>o(651124),l=()=>o(349835),s=()=>o(390066);const c={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1},u={checkbox:[{type:"checkbox"}],date:[{type:"date"}],email:[{type:"text"}],multi_select:[{type:"text"},{of:{type:"text"},type:"array"}],number:[{type:"number"}],person:[{type:"person"},{of:{type:"person"},type:"array"}],phone_number:[{type:"text"}],relation:[{type:"block"},{of:{type:"block"},type:"array"}],select:[{type:"text"},{of:{type:"text"},type:"array"}],status:[{type:"text"},{of:{type:"text"},type:"array"}],text:void 0,title:void 0,url:[{type:"text"}]};function d(e){return Boolean(c[e.type]&&!(0,a().UU)(e)&&(!(0,a().$M)(e)||void 0===(0,a().om)(e)))}function p(e){const{collectionFormat:t,collectionSchema:o,filter:l,sort:c,sourcePropertyIds:u}=e,p=(u??(0,i().uv)(o)).filter(((t,n,i)=>{const r=o[t];return!(!r||!d(r))&&(("relation"!==r.type||!e.restrictCrossSpace||!(0,a().o2)(e.spaceId,r))&&(!l||l([t,r],n,o)))}));if(0===p.length)return[];if(!t||!1===c)return p;const m=(0,s().L)(t,o,void 0,r().jf.Page).collection_page_properties||[];return n().Ul(p,(e=>m.findIndex((t=>t.property===e))))}function m(e){const{collectionFormat:t,collectionSchema:o,sort:l}=e,c=(0,i().uv)(o).filter(((e,t,n)=>{const i=o[e];return!(!i||!(0,a().JY)(i))}));if(0===c.length)return[];if(!t||!1===l)return c;const u=(0,s().L)(t,o,void 0,r().jf.Page).collection_page_properties||[];return n().Ul(c,(e=>u.findIndex((t=>t.property===e))))}function g(e){return e.type===l().M9.InvalidCharacter?{type:e.type,character:e.character}:e.type===l().M9.TokenExpected?{type:e.type,token:e.token}:e.type===l().uW.MissingSchemaPropertyOnThisRow||e.type===l().uW.MissingSchemaPropertyOnCollection?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===l().uW.ThisRowBlockPropertyMismatchCollection?{type:e.type,thisRowCollection:e.thisRowCollection}:e.type===l().uW.MissingContextVariable?{type:e.type,valueId:e.valueId}:e.type===l().uW.FunctionCallTooFewArguments?{type:e.type,numArguments:e.numArguments}:e.type===l().uW.FunctionCallUnexpectedArgument?{type:e.type,parameterIndex:e.parameterIndex}:e.type===l().uW.FunctionCallArgumentWrongType?{type:e.type,argumentType:e.argumentType,libraryFunctionName:e.libraryFunction.name,parameterIndex:e.parameterIndex}:e.type===l().uW.MissingDataDependencyBlock?{type:e.type,blockPointer:e.blockPointer,node:e.node}:e.type===l().uW.MissingDataDependencyPerson?{type:e.type,personPointer:e.personPointer}:e.type===l().uW.MemberPropertyMismatchCollection?{type:e.type,blockCollection:e.blockCollection}:e.type===l().uW.DownstreamParseFailure?{type:e.type,collectionId:e.collectionId,property:e.property}:e.type===l().uW.ContextVariableWrongType?{type:e.type,valueId:e.valueId,expectedType:e.expectedType,resultType:e.resultType}:e.type===l().uW.DisallowedValueType?{type:e.type,expressionValue:e.expressionValue,allowedValueTypes:e.allowedValueTypes}:e.type===l().uW.LibraryFunctionExecutionError?{type:e.type,error:e.error,libraryFunctionName:e.libraryFunction.name}:{type:e.type}}const y={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,place:!1};function h(e){return Boolean(y[e.type])}function f(e){const{collectionFormat:t,collectionSchema:o,filter:l,sort:c}=e,u=(0,i().uv)(o).filter(((e,t,n)=>{var i;const r=o[e];return!(!r||!y[r.type])&&((!(0,a().$M)(r)||null===(i=(0,a().om)(r))||void 0===i||!i.auto_update_on_edit)&&(!l||l([e,r],t,o)))}));if(0===u.length)return[];if(!t||!1===c)return u;const d=(0,s().L)(t,o,void 0,r().jf.Page).collection_page_properties||[];return n().Ul(u,(e=>d.findIndex((t=>t.property===e))))}const v={checkbox:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1};function x(e){return v[e.type]}const S={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1,place:!1};function b(e){return S[e.type]}function A(e){return 0===e}function C(e){return function(e){return"button_block"===e||"button_property"===e}(e)}function k(e){const{property:t,collectionSchema:o}=e;return!!o&&!o[t]}function M(e){const{collectionSchema:t,property:o,type:n}=e,i=null==t?void 0:t[o];return!i||("action"===n?!d(i):!y[i.type])}function j(e){let{automationTrigger:t,collectionSchema:o}=e;if("event"===(null==t?void 0:t.type)){const{pagesAdded:e,pagePropertiesEdited:n,source:a,relativeDate:r}=t.event;if(void 0===a)return!1;const l="some"===n.type&&n.some,s="all"===n.type&&n.all;if((l||s||[]).some((e=>k({collectionSchema:o,property:e.property})||M({collectionSchema:o,property:e.property,type:"trigger"}))))return!1;const c="some"===n.type&&(!(0,i().O9)(n.some)||0===n.some.length),u="all"===n.type&&(!(0,i().O9)(n.all)||0===n.all.length);if(!e&&("none"===n.type||c||u)&&!r)return!1}else{if("recurrence"!==(null==t?void 0:t.type))return!1;if(!t.recurrence)return!1}return!0}},427636:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const i=function(e){const{botStore:t,avatarSize:i,shouldShowBadge:a,style:r,inline:l}=e,s=(0,o(959013).tz)(),c=(0,o(484714).Y0)(),u=(0,o(56366).K8)((()=>null==t?void 0:t.getDisplayName(s)),[t,s]),{outerStyle:d,avatarWrapStyle:p,badgeStyle:m}=(0,o(401497).IS)((e=>({outerStyle:{display:"flex",alignItems:"center",minWidth:0,...r},avatarWrapStyle:l?{width:"none",minHeight:"none",marginRight:6}:{marginRight:6},badgeStyle:{padding:"2px 6px",borderRadius:4,color:e.text.secondary,background:e.legacyDefaultSelectColor,fontSize:o(780054).A.isMobile?11:9,lineHeight:c.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",marginLeft:8,marginTop:1}})),[r,l,c]);return(0,n.jsxs)("div",{style:d,children:[(0,n.jsx)("div",{style:p,children:(0,n.jsx)(o(256863).A,{botStore:t,size:i})}),(0,n.jsx)("div",{style:{...o(284371).RC},children:u}),a&&(0,n.jsx)("div",{style:m,children:"Bot"})]})}},428390:(e,t,o)=>{o.r(t),o.d(t,{exclamationMarkCircleFillIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,o(474848).jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25M9.875 6.25c.345 0 .625.28.625.625v3.5a.625.625 0 1 1-1.25 0v-3.5c0-.345.28-.625.625-.625m0 7.375a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5"})},i=(0,o(340498).wt)("exclamationMarkCircleFill",n)},436876:(e,t,o)=>{o.d(t,{A:()=>d});o(296540);var n=()=>o(401497),i=()=>o(784892),a=()=>o(576250),r=()=>o(617073),l=()=>o(234194),s=()=>o(919709),c=()=>o(848401),u=o(474848);function d(e){let{handleRemoveToken:t,token:o,type:d,format:p,style:m,isDisabled:g}=e;const y=(0,s().GCe)(o).name,h=(0,n().DP)();if(!y)return null;let f;switch(d){case"person":f=l().M;break;case"email":f=r().J;break;default:f=a().y}return(0,u.jsx)(c().Ay,{title:y,renderAvatar:e=>f({width:e,height:e,padding:2,marginRight:6}),style:{background:h.palette.gray[75],padding:"2px 4px",...m},showRemoveButton:Boolean(t)&&!g,onClickRemove:e=>{null==e||e.stopPropagation(),t&&t(o)},format:p??i().NY.Small,shouldShrink:!0,isSingle:!1})}},438632:(e,t,o)=>{o.d(t,{PD:()=>u,cb:()=>c,yR:()=>d});o(16280),o(944114),o(898992),o(354520),o(803949),o(581454);var n=o.n(o(625473)),i=o.n(o(716471)),a=()=>o(496603),r=()=>o(534177),l=()=>o(634201),s=()=>o(919709);let c=function(e){return e[e.removed=-1]="removed",e[e.added=1]="added",e[e.same=0]="same",e}({});function u(e,t){const o=new(i())({timeout:2,editCost:6}),n=o.main(t,e);return o.cleanupSemantic(n),n}function d(e){const{before:t,after:o,isIncompleteAfter:i,insertCursor:d}=e,p={count:0,encoding:{},decoding:{},annotationEncoding:{},annotationDecoding:{}},m=e=>{const t=p.encoding[e];if(t)return t;{const t=String.fromCharCode(p.count);return p.count++,p.encoding[e]=t,p.decoding[t]=e,t}},g=e=>{const t=n()(e),o=p.annotationEncoding[t];if(o)return o;{const o=String.fromCharCode(p.count);return p.count++,p.annotationEncoding[t]=o,p.annotationDecoding[o]=e,o}},y=t=>a().Bq(s().RQ(t).map((t=>{let o=[];if("word"===e.mode||"wordUnderlineFinal"===e.mode){if("undefined"==typeof Intl||!Intl.Segmenter)throw new Error("Intl.Segmenter is not supported");{const e=new Intl.Segmenter(void 0,{granularity:"word"}).segment(t[0]);o=Array.from(e).map((e=>e.segment))}}else o=l().PE(t[0]);const n=o.map(m);if(s().qXl(t)){const e=s().uPN(t),o=s().jhx(e);o&&(n[0]=g({type:"mention",value:o}),e.forEach((e=>{s().iGj(e)||s().gir(e)||s().lfl(e)||(n.unshift(g({type:"start",value:e})),n.push(g({type:"end",value:e})))})))}else if(s().GiG(t)){const e=s().uPN(t),o=s().j1D(e);if(o){n[0]=g({type:"equation",value:o});for(const t of e)s().iGj(t)||s().gir(t)||s().lfl(t)||(n.unshift(g({type:"start",value:t})),n.push(g({type:"end",value:t})))}}else if(s().BEe(t)){s().uPN(t).forEach((e=>{n.unshift(g({type:"start",value:e})),n.push(g({type:"end",value:e}))}))}return n}))).join("");if(p.count>65535)throw new Error("This string has way too many different characters.");const h=u(y(o),y(t)),f=[];let v=[],x=0;const S=i?a().Kl(h,(e=>0===e[0]||1===e[0])):0;let b=!1;const A=e.insertionAnnotation,C=e.deletionAnnotation;return h.forEach((t=>{let[o,n]=t;n.split("").forEach((t=>{if(p.decoding[t]){const n=p.decoding[t];o===c.added?f.push([n,[...v,"wordUnderlineFinal"===e.mode?e.underlineAnnotation:A]]):o===c.removed&&(!i||x<=S)?"wordUnderlineFinal"!==e.mode&&f.push([n,[...v,C]]):(i&&d&&!b&&x===S+1&&(b=!0,f.push(["",[["tc"]]])),f.push([n,v]))}else{const n=p.annotationDecoding[t];if(o===c.added)if("mention"===n.type)f.push([s().Sj,[...v,"wordUnderlineFinal"===e.mode?e.underlineAnnotation:A,n.value]]);else if("start"===n.type)v=[...v,n.value];else if("end"===n.type)v=v.filter((e=>!a().n4(e,n.value)));else if("equation"===n.type){const e=s().U35(n.value),t=s().G0H(e,[...v,A]);f.push(t)}else(0,r().HB)(n);else if(o===c.removed){if("mention"===n.type)"wordUnderlineFinal"!==e.mode&&f.push([s().Sj,[...v,C,n.value]]);else if("equation"===n.type){const e=s().U35(n.value),t=s().G0H(e,[...v,C]);f.push(t)}}else if(o===c.same)if("mention"===n.type)f.push([s().Sj,[...v,n.value]]);else if("start"===n.type)v=[...v,n.value];else if("end"===n.type)v=v.filter((e=>!a().n4(e,n.value)));else if("equation"===n.type){const e=s().U35(n.value),t=s().G0H(e,v);f.push(t)}else(0,r().HB)(n)}})),i&&(x+=1)})),s().__s(f)}},439442:(e,t,o)=>{o.r(t),o.d(t,{CollectionSettingsAutomationsView:()=>Jt});o(16280),o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577),o(803949),o(581454),o(737550);var n=o.n(o(844751)),i=o(296540),a=()=>o(484714),r=()=>o(56366),l=()=>o(401497),s=()=>o(764880),c=()=>o(422540),u=()=>o(81768),d=()=>o(352271),p=()=>o(289915),m=()=>o(970013),g=()=>o(713998),y=()=>o(791089),h=()=>o(709687),f=()=>o(101209),v=()=>o(563884),x=()=>o(340498),S=o(474848);const b=(0,x().wt)("codeFile",{viewBox:"0 0 23 24",svg:(0,S.jsx)("path",{d:"M4.195 11.86c0-.266.078-.488.235-.665.156-.182.38-.3.672-.351.494-.089.849-.271 1.062-.547.214-.281.32-.73.32-1.344V6.961c0-1.115.263-1.938.79-2.469.525-.536 1.333-.804 2.421-.804.203 0 .375.023.516.07.177.057.31.146.398.265a.646.646 0 01.141.422c0 .339-.148.558-.445.657a1.14 1.14 0 01-.157.039l-.171.015c-.625.047-1.066.222-1.32.524-.256.302-.384.8-.384 1.492v2.414c0 .672-.182 1.198-.546 1.578-.36.38-.86.604-1.5.672-.032 0-.047.013-.047.039.005.02.02.034.047.04.64.062 1.14.283 1.5.663.364.38.546.906.546 1.578v2.414c0 .693.128 1.19.383 1.492.255.303.696.48 1.32.532.053 0 .1.002.141.008l.133.03c.333.09.5.308.5.657a.68.68 0 01-.14.43.816.816 0 01-.407.273 1.48 1.48 0 01-.437.063c-1.12 0-1.948-.266-2.485-.797-.531-.526-.797-1.352-.797-2.477V14.79c0-.614-.106-1.062-.32-1.344-.213-.28-.568-.463-1.062-.547-.292-.062-.516-.182-.672-.359-.157-.177-.235-.404-.235-.68zm15.602 0c0 .275-.078.502-.235.68-.156.176-.382.296-.68.358-.5.084-.856.266-1.07.547-.208.282-.312.73-.312 1.344v1.992c0 1.125-.266 1.95-.797 2.477-.531.531-1.36.797-2.484.797-.151 0-.297-.021-.438-.063a.757.757 0 01-.414-.265.715.715 0 01-.133-.438c0-.182.042-.328.125-.437a.674.674 0 01.383-.22l.117-.03c.047-.006.097-.008.149-.008.625-.052 1.065-.23 1.32-.532.255-.302.383-.799.383-1.492v-2.414c0-.672.182-1.208.547-1.61.364-.405.864-.616 1.5-.632.026-.005.039-.018.039-.039 0-.026-.013-.04-.04-.04-.635-.015-1.135-.226-1.5-.632-.364-.406-.546-.945-.546-1.617V7.172c0-.693-.128-1.193-.383-1.5-.255-.307-.695-.48-1.32-.516l-.18-.015a1.233 1.233 0 01-.148-.04c-.297-.109-.446-.328-.446-.656 0-.166.045-.307.133-.422a.777.777 0 01.414-.265c.14-.047.31-.07.508-.07 1.089 0 1.896.268 2.422.804.526.531.789 1.354.789 2.469v1.992c0 .615.107 1.06.32 1.336.214.276.568.461 1.063.555.297.052.523.169.68.351a.967.967 0 01.234.664z"})});var A=()=>o(813572),C=()=>o(133033),k=()=>o(173019),M=()=>o(689094),j=()=>o(751109),T=()=>o(292643),I=()=>o(46472);const w=(0,x().wt)("typesLocation",{viewBox:"0 0 25 25",svg:(0,S.jsxs)("g",{children:[(0,S.jsx)("path",{d:"M12.105 24.21C18.7369 24.21 24.2121 18.7273 24.2121 12.105C24.2121 5.47312 18.7273 0 12.0954 0C5.47523 0 0 5.47312 0 12.105C0 18.7273 5.48484 24.21 12.105 24.21ZM12.105 21.8255C6.71085 21.8255 2.39412 17.4991 2.39412 12.105C2.39412 6.71085 6.70124 2.38452 12.0954 2.38452C17.4895 2.38452 21.8276 6.71085 21.8276 12.105C21.8276 17.4991 17.4991 21.8255 12.105 21.8255Z"}),(0,S.jsx)("path",{d:"M6.75703 16.5939C6.75703 17.4355 7.28742 17.9479 8.17266 17.9479H16.0416C16.9247 17.9479 17.4476 17.4355 17.4476 16.5939V12.0109L12.4683 7.82758C12.236 7.63047 11.9686 7.64008 11.7363 7.82758L6.75703 12.0013V16.5939ZM13.6692 16.7148H10.5429V12.9969C10.5429 12.7178 10.7283 12.5366 11.0128 12.5366H13.2014C13.4977 12.5366 13.6692 12.7178 13.6692 12.9969V16.7148ZM4.81055 11.2199C4.81055 11.5316 5.04469 11.8138 5.43211 11.8138C5.62593 11.8138 5.78554 11.7083 5.9271 11.5806L11.8111 6.65687C12.0145 6.47477 12.2093 6.49609 12.4052 6.65687L18.2775 11.5806C18.4383 11.7083 18.5883 11.8138 18.7725 11.8138C19.1194 11.8138 19.3941 11.5818 19.3941 11.2391C19.3941 11.0315 19.3228 10.873 19.1653 10.7336L13.0078 5.5661C12.4605 5.10508 11.7558 5.10508 11.2181 5.5661L5.03929 10.7357C4.89141 10.8751 4.81055 11.0507 4.81055 11.2199ZM15.8079 8.35282L17.4623 9.75391V6.88399C17.4623 6.62618 17.3004 6.44501 17.033 6.44501H16.249C15.9912 6.44501 15.8079 6.62618 15.8079 6.88399V8.35282Z"})]})});var P=()=>o(281067),_=()=>o(164153),B=()=>o(523872),R=()=>o(166883),V=()=>o(696706),E=()=>o(84262),D=()=>o(959013),F=()=>o(534177),O=()=>o(284371),L=()=>o(686526),K=()=>o(436572),N=()=>o(2220),W=()=>o(837570),z=()=>o(741310),H=()=>o(546461),U=()=>o(104636),Y=()=>o(293096),G=()=>o(284489),q=()=>o(735695),$=()=>o(493823),J=()=>o(419357),Q=()=>o(187485),Z=()=>o(204063),X=()=>o(89924),ee=()=>o(859428),te=()=>o(852353),oe=()=>o(726483),ne=()=>o(731320),ie=()=>o(962730),ae=()=>o(765957),re=()=>o(227440),le=()=>o(217429),se=()=>o(329304),ce=()=>o(500128),ue=()=>o(898125),de=()=>o(819121),pe=()=>o(588316),me=()=>o(442277),ge=()=>o(428390);const ye=(0,x().wt)("pause",{viewBox:"0 0 6 8",svg:(0,S.jsx)("path",{d:"M1.008 7.473q-.294 0-.442-.149t-.144-.441V1.477q0-.29.148-.438.15-.148.438-.148h.937q.29.003.438.148.148.144.148.438v5.406q0 .292-.148.441-.15.15-.438.149zm3.047 0q-.297 0-.446-.149-.144-.149-.144-.441V1.477q0-.29.148-.438.149-.148.442-.148h.933q.293 0 .438.148.148.144.148.438v5.406q0 .292-.148.441-.145.15-.438.149z"})});var he=()=>o(693954),fe=()=>o(558842),ve=()=>o(519143),xe=()=>o(764781),Se=()=>o(126617),be=()=>o(200582),Ae=()=>o(105819),Ce=()=>o(236262),ke=()=>o(760217),Me=()=>o(406699),je=()=>o(285790),Te=()=>o(928600),Ie=()=>o(939740),we=()=>o(8980),Pe=()=>o(574036),_e=()=>o(463830),Be=()=>o(781697),Re=()=>o(656134);const Ve=(0,D().YK)({automationSummaryCardMoreButtonAriaLabel:{defaultMessage:"More",id:"automations.AutomationSummaryCard.MoreActionsButton.ariaLabel"},automationSummaryCardMoreMenuEditTitle:{defaultMessage:"Edit",id:"automations.AutomationSummaryCard.MoreActionsMenu.Edit.title"},automationSummaryCardMoreMenuDuplicateTitle:{defaultMessage:"Duplicate",id:"automations.AutomationSummaryCard.MoreActionsMenu.Duplicate.title"},automationSummaryCardMoreMenuDeleteTitle:{defaultMessage:"Delete",id:"automations.AutomationSummaryCard.MoreActionsMenu.Delete.title"},automationSummaryCardMoreMenuActiveTitle:{defaultMessage:"Active",id:"automations.AutomationSummaryCard.MoreActionsMenu.Active.title"},automationSummaryCardMoreMenuRestartTitle:{defaultMessage:"Restart",id:"automations.AutomationSummaryCard.MoreActionsMenu.Restart.title"}});function Ee(e){const{focused:t,style:o,onEdit:n,onDelete:a,onDuplicate:s,onDisable:c,onEnable:u,onRestart:d}=e,p=(0,D().tz)(),m=(0,r().uB)(void 0,_e().A),g=(0,Re().j)();(0,i.useEffect)((()=>{t||m.setState({open:!1})}),[t,m]);const y=(0,l().IS)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,height:26,width:26,...o},iconButtonIcon:{width:x().Ev.sm,height:x().Ev.sm}})),[o]);return(0,S.jsx)(Me().Ay,{stopClickPropagation:!0,popupType:g,alignmentToOrigin:Me().yP.Center,placementToOrigin:Me().sx.Bottom,originGap:0,renderOrigin:e=>(0,S.jsx)(je().A,{ariaLabel:p.formatMessage(Ve.automationSummaryCardMoreButtonAriaLabel),icon:Se().Y,iconStyle:y.iconButtonIcon,style:y.iconButton,hasBackground:!0,...e}),render:e=>(0,S.jsx)(De,{onClose:()=>e.close(),onEdit:n,onDelete:a,onDuplicate:s,onDisable:c,onEnable:u,onRestart:d}),buttonPopupStore:m})}function De(e){const{onClose:t,onEdit:o,onDelete:n,onDuplicate:i,onDisable:a,onEnable:r,onRestart:l}=e,s=(0,D().tz)(),c=(0,Be().e)(),u=o?{action:()=>{t(),o()},key:"edit",render:e=>(0,S.jsx)(ke().A,{...e,icon:(0,S.jsx)(we().I,{icon:Ae().pencilLineIcon}),title:s.formatMessage(Ve.automationSummaryCardMoreMenuEditTitle)})}:void 0,d=l?{action:()=>{t(),l()},key:"restart",render:e=>(0,S.jsx)(ke().A,{...e,icon:(0,S.jsx)(we().I,{icon:ve().D}),title:s.formatMessage(Ve.automationSummaryCardMoreMenuRestartTitle)})}:void 0,p=i?{action:()=>{t(),i()},key:"duplicate",render:e=>(0,S.jsx)(ke().A,{...e,icon:(0,S.jsx)(we().I,{icon:xe().V}),title:s.formatMessage(Ve.automationSummaryCardMoreMenuDuplicateTitle)})}:void 0,m=r||a?{action:()=>{t(),r?r():a&&a()},key:"active",render:e=>(0,S.jsx)(Pe().A,{...e,icon:(0,S.jsx)(we().I,{icon:be().m}),title:s.formatMessage(Ve.automationSummaryCardMoreMenuActiveTitle),on:(0,F().O9)(a)})}:void 0,g=n?{action:()=>{t(),n()},key:"delete",render:e=>(0,S.jsx)(ke().A,{...e,icon:(0,S.jsx)(we().I,{icon:Ce().trashIcon}),title:s.formatMessage(Ve.automationSummaryCardMoreMenuDeleteTitle),isRedOnHover:!0})}:void 0,y=[];return(0,F().O9)(m)&&y.push({items:[m],key:"active-inactive",render:e=>(0,S.jsx)(X().A,{enableActionSheetTitle:!0,...e})}),y.push({items:[d,u,p,g].filter(F().O9),key:"items",render:e=>(0,S.jsx)(X().A,{enableActionSheetTitle:!0,topBorder:(0,F().O9)(m),...e})}),(0,S.jsx)(Te().A,{...c,children:(0,S.jsx)(Ie().Ay,{type:Ie().Oh.Vertical,sections:y,initialFocus:0})})}var Fe=()=>o(464708),Oe=()=>o(704152),Le=()=>o(448693),Ke=()=>o(115512);const Ne=6;function We(e){const{actions:t,caption:o,focused:n,status:s,maxIcons:c,onBlur:u,onClick:d,onDelete:p,onDisable:m,onDuplicate:g,onEdit:y,onRestart:h,onEnable:f,onFocus:v,onMouseDown:x,onMouseEnter:b,onMouseLeave:A,title:C,triggers:k,shouldShowSlackPricingChangeBanner:M}=e,{isMobile:j}=(0,a().Y0)(),T=(0,i.useRef)(null),[I,w]=(0,de().A)(),[P,_]=(0,pe().A)(),[B,R]=(0,i.useState)(!1),V=j||B||w||_,E=(0,l().IS)((e=>({wrap:{background:e.surface.elevated,border:`1px solid ${e.regularDividerColor}`,borderRadius:10,display:"flex",flexDirection:"column",gap:11,paddingTop:16,paddingLeft:16,paddingRight:16,paddingBottom:13,position:"relative"},moreButtonWrap:{display:V?"block":"none",position:"absolute",right:8,top:8},iconList:{display:"flex",flexWrap:"wrap",gap:6,listStyle:"none",margin:"0 30px 0 0",padding:0},body:{display:"flex",flexDirection:"column",gap:j?4:0},titleWrap:{..."success"!==s||M?{alignItems:"center",display:"inline-flex",gap:4}:(0,Ke().pA)(2),fontSize:j?16:14,fontWeight:O().Wy.medium,lineHeight:"20px"},title:{..."success"!==s?O().RC:{}},caption:{...(0,Ke().pA)(2),color:e.text.secondary,fontSize:j?14:12,fontWeight:O().Wy.regular,lineHeight:"16px",margin:0}})),[V,j,s,M]),L=(0,i.useCallback)((e=>{R(!0),b&&b(e)}),[b]),K=(0,i.useCallback)((e=>{R(!1),A&&A(e)}),[A]);(0,i.useEffect)((()=>{n&&null!==T.current&&T.current.focus()}),[n]);const N=(0,fe().Px)(T,I,P),W=function(e){const{actionIcons:t,maxIcons:o,triggerIcons:n}=e,i=n.length,a=t.length,r=i>0&&a>0,l=Math.max(o,3),s=r?l-1:l;let c=Math.max(Math.floor(s/2),1),u=Math.max(Math.ceil(s/2),1);if(i<c&&a>u){u+=c-i,c=i}else if(a<u&&i>c){c+=u-a,u=a}const d=[];if(i>0)if(i>c)if(1===c)d.push({color:"gray",type:"truncate",value:i});else{const e=i-(c-1);d.push(...n.slice(0,c-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...n);r&&d.push({type:"arrow"});if(a>0)if(a>u)if(1===u)d.push({color:"gray",type:"truncate",value:a});else{const e=a-(u-1);d.push(...t.slice(0,u-1)),d.push({color:"gray",type:"truncate",value:e})}else d.push(...t);return d}({actionIcons:t,maxIcons:$e(c),triggerIcons:k}),z=(0,r().O$)(re().e),H=z&&Boolean(p||m||f||g||y||h),U=function(e){let{status:t,titleSize:o}=e;const n=Qe({status:t,titleSize:o});return(0,i.useMemo)((()=>"invalid"===t?(0,S.jsx)(Fe().A,{style:n.invalidBadge,content:(0,S.jsxs)("div",{style:n.badgeContainer,children:[(0,he().Q)(n.icon),(0,S.jsx)(D().sA,{defaultMessage:"Invalid",id:"automationSummaryCard.invalidToken"})]})}):"paused"===t?(0,S.jsx)(Fe().A,{style:n.pausedBadge,content:(0,S.jsxs)("div",{style:n.badgeContainer,children:[ye(n.icon),(0,S.jsx)(D().sA,{defaultMessage:"Paused",id:"automationSummaryCard.pausedToken"})]})}):"failing"===t?(0,S.jsx)(Fe().A,{style:n.failingBadge,content:(0,S.jsx)("div",{style:n.badgeContainer,children:(0,S.jsx)(D().sA,{defaultMessage:"Failing",id:"automationSummaryCard.failingToken"})})}):"expired"===t?(0,S.jsx)(Fe().A,{style:n.pausedBadge,content:(0,S.jsx)("div",{style:n.badgeContainer,children:(0,S.jsx)(D().sA,{defaultMessage:"Completed",id:"automationSummaryCard.completedToken"})})}):void("error"!==t&&"warning"!==t&&"success"!==t&&(0,F().HB)(t))),[t,n])}({status:s,titleSize:j?16:14});return(0,S.jsxs)(Oe().A,{onBlur:u,onClick:d,onFocus:v,onMouseDown:x,onMouseEnter:L,onMouseLeave:K,ref:N,style:E.wrap,disabled:!z,children:[(0,S.jsxs)("header",{children:[H&&(0,S.jsx)("div",{style:E.moreButtonWrap,children:(0,S.jsx)(Ee,{focused:V,onDelete:p,onDisable:m,onEnable:f,onDuplicate:g,onEdit:y,onRestart:h})}),(0,S.jsx)("ul",{"aria-hidden":"true",style:E.iconList,children:W.map(((e,t)=>(0,S.jsx)("li",{children:(0,S.jsx)(ze,{icon:e})},t)))})]}),(0,S.jsxs)("div",{style:E.body,children:[(0,S.jsxs)("div",{style:E.titleWrap,children:[(0,S.jsx)("span",{style:E.title,children:C}),M?(0,S.jsx)(Ze,{isMobile:j,shouldShowSlackPricingChangeBanner:M}):U]}),o&&(0,S.jsx)("p",{style:E.caption,children:o})]})]})}function ze(e){const{icon:t}=e;return"property"===t.type||"page"===t.type||"misc"===t.type?(0,S.jsx)(He,{color:t.color,icon:t.icon}):"person"===t.type?(0,S.jsx)(qe,{actor:t.actor}):"app"===t.type?(0,S.jsx)(Ye,{color:"default",icon:t.icon}):"arrow"===t.type?(0,S.jsx)(Ue,{}):"truncate"===t.type?(0,S.jsx)(Ge,{color:t.color,value:t.value}):void(0,F().HB)(t.type)}function He(e){const{color:t,icon:o}=e,n=Je(t);return(0,S.jsx)("div",{"aria-hidden":"true",style:n.iconWrap,children:o(n.icon)})}function Ue(){const e=Je("default");return(0,S.jsx)("div",{style:{...e.iconWrap,...e.iconArrowWrap},children:(0,me().B)({...e.icon,...e.iconArrow})})}function Ye(e){const{icon:t}=e,o=Je("default");return(0,S.jsx)("div",{"aria-hidden":"true",style:o.iconAppWrap,children:t(o.iconApp)})}function Ge(e){const{color:t,value:o}=e,n=Je(t);return(0,S.jsxs)("div",{style:{...n.iconWrap,...n.truncateWrap},children:["+",o]})}function qe(e){const{actor:t}=e,o=Je("default");return(0,S.jsx)("div",{"aria-hidden":"true",style:o.iconPersonWrap,children:(0,S.jsx)(Le().Ay,{actor:t,avatarSize:26,format:Le().Ay.Format.Inline,isSingle:!1,showRemoveButton:!1,style:{margin:0},hasPersonHoverCard:!1})})}function $e(e){return void 0===e||e<0?Ne:e}function Je(e){const t="default"===e?"gray":e;return(0,l().IS)((e=>{const o="light"===e.mode?400:800,n="light"===e.mode?100:400;return{icon:{fill:e.palette[t][o],width:16},iconWrap:{background:e.palette[t][n],borderRadius:6,padding:6},iconApp:{width:14,height:14},iconAppWrap:{borderRadius:6,borderWidth:1,borderStyle:"solid",borderColor:e.palette.gray[n],padding:6},iconPerson:{display:"block",width:"100%"},iconPersonWrap:{alignItems:"center",display:"flex",height:28,justifyContent:"center",width:28},iconArrow:{fill:e.icon.secondary,width:14,height:14},iconArrowWrap:{background:void 0},truncateWrap:{alignItems:"center",background:e.palette.gray[n],color:e.palette[t][o],display:"inline-flex",fontSize:12,fontWeight:O().Wy.semibold,height:28,justifyContent:"center",padding:3,width:28}}}),[t])}function Qe(e){let{status:t,titleSize:o}=e;const n=o??14;return(0,l().IS)((e=>({warning:{color:"error"===t?e.errorText:e.palette.orange[400],height:"auto",width:n},invalidBadge:{backgroundColor:e.tint.uiRed,color:e.icon.uiRedPrimary},failingBadge:{backgroundColor:e.palette.yellow[50],color:e.palette.yellow[400]},pausedBadge:{backgroundColor:e.tint.regular,color:e.text.secondary},badgeContainer:{alignItems:"center",display:"flex",fontSize:10},icon:{width:10,height:10,marginRight:"4px"},slackPricingChangeBadgeStyle:{backgroundColor:e.tint.uiBlue,color:e.icon.uiBluePrimary},slackPricingChangeIcon:{width:10,height:10,marginRight:"4px",fill:e.blueColor}})),[t,n])}function Ze(e){let{isMobile:t,shouldShowSlackPricingChangeBanner:o}=e;const n=Qe({});return o?(0,S.jsx)(Fe().A,{style:n.slackPricingChangeBadgeStyle,content:(0,S.jsxs)("div",{style:n.badgeContainer,children:[(0,ge().exclamationMarkCircleFillIcon)(n.slackPricingChangeIcon),!t&&(0,S.jsx)(D().sA,{defaultMessage:"Upgrade",id:"automationSummaryCard.slackPricingChangeBadge"})]})}):null}var Xe=()=>o(310109),et=()=>o(784892),tt=()=>o(842599),ot=()=>o(977345),nt=()=>o(519831),it=()=>o(798880),at=()=>o(919709),rt=()=>o(500071),lt=()=>o(656476),st=()=>o(307159),ct=()=>o(347114),ut=()=>o(3867),dt=()=>o(237985),pt=()=>o(359186),mt=()=>o(217028),gt=()=>o(383688),yt=()=>o(880264),ht=()=>o(112588),ft=()=>o(477329),vt=()=>o(27511),xt=()=>o(214973),St=()=>o(38440),bt=()=>o(133518),At=()=>o(798941),Ct=()=>o(397785),kt=()=>o(457050),Mt=()=>o(967823),jt=()=>o(71304),Tt=()=>o(630116);const It=(0,D().YK)({automationSingleTargetDefault:{defaultMessage:"1 person",id:"database.viewSettings.automationTab.automationSingleTargetDefault"},recurrenceAutomationSummary:{defaultMessage:"Every {frequency}, {actions}",id:"automation.summaryCard.recurrenceCaption"}});function wt(e){const{intl:t,triggerConfig:o}=e;if(o){if("event"===o.type){const n=function(e){const{collectionStore:t,environment:o,getRecordModel:n,intl:i,schema:a,typecheckResult:r,triggerConfig:l}=e,{event:s}=l,u=t.getSpaceId(),d=[];s.pagesAdded&&d.push(xt().CH(i));if("none"===s.pagePropertiesEdited.type);else if("any"===s.pagePropertiesEdited.type)d.push(xt().HG(i));else if("some"===s.pagePropertiesEdited.type||"all"===s.pagePropertiesEdited.type){let e=[];"all"===s.pagePropertiesEdited.type?e=s.pagePropertiesEdited.all??[]:"some"===s.pagePropertiesEdited.type&&(e=s.pagePropertiesEdited.some??[]);for(const l of e){const e=a[l.property];if(!e){d.push(xt().Pg(i));continue}if(!c().tj[e.type]){d.push((0,mt().cn)());continue}const{filter:s}=l;if("changes_to_any"===s.operator)d.push(xt().Od(i,{propertyName:e.name}));else if(p().fZ(s))d.push(xt().yR(i,{propertyName:e.name}));else if(c().nq(e))if("status"===e.type){if(!p().H$(s)||!p().gc(s)){d.push((0,St().zQ)(e));continue}const t=p().V6(s),o=(0,vt().a)({intl:i,groupValues:t.map((e=>"is_group"===e.type?e.value:void 0)).filter(F().O9),isText:!0,optionValues:t.map((e=>"is_option"===e.type?e.value:void 0)).filter(F().O9),propertySchema:e,tokenFormat:et().NY.Small}),n=i.formatList(o,{style:"long",type:"disjunction"});d.push(xt().Yx(i,{propertyName:e.name,propertyValues:n}))}else if("select"===e.type||"multi_select"===e.type){if(p().fZ(s)||!p().v0(s)&&!p().as(s)||"select"===e.type&&p().as(s)||"multi_select"===e.type&&p().v0(s)){d.push((0,St().zQ)(e));continue}const t=Array.isArray(s.value)?s.value:[s.value],o=(0,ft().$5)({intl:i,isText:!0,optionValues:t.map((e=>e.value)).filter(F().O9),propertySchema:e,tokenFormat:et().NY.Small}),n=i.formatList(o,{style:"long",type:"disjunction"}),a=(0,ft().l5)({filter:s,propertySchema:e});if(a){const t=(0,ft().JI)(a);d.push(t(i,{propertyName:e.name,propertyValues:n}))}}else if("checkbox"===e.type){if(!p().Ui(s)){d.push((0,St().zQ)(e));continue}d.push((0,gt().Hk)({filter:s,propertySchema:e,intl:i}))}else if("person"===e.type){if(!p().I_(s)){d.push((0,St().zQ)(e));continue}d.push((0,Ct().H)({actorModels:(0,ht().Y)(s,n),operator:s.operator,propertySchema:e,intl:i}))}else if("number"===e.type){if(!p().My(s)){d.push((0,St().zQ)(e));continue}d.push((0,At().VW)({messageType:"trigger",numberValue:s.value.value,operator:s.operator,propertySchema:e,intl:i}))}else if("email"===e.type||"url"===e.type||"text"===e.type||"phone_number"===e.type||"title"===e.type){if(!p().YH(s)){d.push((0,St().zQ)(e));continue}"string_is"!==s.operator&&"string_is_not"!==s.operator&&"string_contains"!==s.operator&&"string_does_not_contain"!==s.operator&&"string_starts_with"!==s.operator&&"string_ends_with"!==s.operator||d.push((0,Mt().zl)({messageType:"trigger",textValue:s.value.value,operator:s.operator,propertySchema:e,intl:i}))}else if("relation"===e.type){if(!p().Pq(s)){d.push((0,St().zQ)(e));continue}if(m().o2(u,e)){d.push((0,yt().Mh)({propertySchema:e}));continue}const n=(0,kt().WE)({collectionStore:t,filter:s}),a=(0,Xe().getAllContextValues)(r),l=(0,kt().eg)({collectionStore:t,filter:s,propertySchema:e});d.push((0,kt().oE)({availableTokens:l,collectionStore:t,environment:o,operator:s.operator,propertySchema:e,intl:i,relationPages:(0,kt().Iq)({value:n.value,automationContextValues:a})}))}else(0,F().HB)(e)}}return i.formatList(d,{style:"long",type:"all"===s.pagePropertiesEdited.type?"conjunction":"disjunction"})}({...e,triggerConfig:o}),i=Pt(e);return t.formatMessage({defaultMessage:"When {triggers}, {actions}",id:"automation.summaryCard.caption"},{actions:i,triggers:n})}if("recurrence"===o.type){if(!o.recurrence)return;const n=(0,U().LS)({intl:t,recurrence:o.recurrence}),i=Pt(e);return t.formatMessage(It.recurrenceAutomationSummary,{frequency:n,actions:i})}"button"!==o.type&&(0,F().HB)(o)}}function Pt(e){var t,o;const{actionStores:n,collectionStore:i,environment:a,intl:r,schema:l,typecheckResult:u}=e,d=[];for(const k of n)if(k.isType("slack_notification"))d.push((0,S.jsx)(D().sA,{defaultMessage:"notify {channel}",id:"CollectionSettingsAutomationsView.summaryCard.slackAction",values:{channel:(0,S.jsx)(rt().D,{actionStore:k})}}));else if(k.isType("update_pages")){const e=k.getConfig(),t=null==e?void 0:e.properties,o=null==e?void 0:e.values,n=null==e?void 0:e.target;if(!t||0===t.length||!n)continue;if("collection"===n.type)if((0,V().Z2)(n.collection,i.pointer))d.push((0,S.jsx)(D().sA,{defaultMessage:"edit pages in this collection",id:"automation.summaryCard.updatePages.sameCollection"}));else{const e=Tt().md.createChildStore(i,n.collection),t=(0,jt().tS)({environment:a,intl:r,store:e});d.push((0,S.jsx)(D().sA,{defaultMessage:"edit pages in {collectionTitle}",id:"automation.summaryCard.updatePages.differentCollection",values:{collectionTitle:t}}))}else if("variable"===n.type){const e=t[0],a=null==o?void 0:o[e],s=Ot({collectionSchema:l,propertyId:e,variableId:n.id,typecheckResult:u,actionStore:k});if(!s){d.push(xt().cC(r));continue}if(!a)continue;if(c().I3(s))if("person"===s.type)d.push((0,S.jsx)(Ft,{collectionStore:i,contextValues:(0,Xe().getAllContextValues)(u),propertyActionValue:a,propertySchema:s}));else if("status"===s.type){const e=(0,S.jsx)(_t,{propertyActionValue:a,propertySchema:s});e&&d.push(e)}else if("select"===s.type||"multi_select"===s.type)d.push((0,S.jsx)(Bt,{propertyActionValue:a,propertySchema:s}));else if("checkbox"===s.type)d.push((0,S.jsx)(Rt,{propertyActionValue:a,propertySchema:s}));else if("relation"===s.type)d.push((0,S.jsx)(Vt,{collectionStore:i,propertyActionValue:a,propertySchema:s}));else if("date"===s.type){const t=(0,S.jsx)(Et,{automationActionId:k.id,collectionStore:i,propertyActionValue:a,propertyId:e,propertySchema:s});t&&d.push(t)}else"number"===s.type||"phone_number"===s.type||"text"===s.type||"title"===s.type||"email"===s.type||"url"===s.type?d.push((0,S.jsx)(Dt,{automationActionId:k.id,propertyActionValue:a,propertySchema:s})):(0,F().HB)(s);else d.push((0,mt().cn)())}}else if(k.isType("create_page")){var p;const e=null===(p=k.getConfig())||void 0===p?void 0:p.collection;if(!e)continue;e.id===i.pointer.id?d.push((0,S.jsx)(D().sA,{defaultMessage:"create a page in this database",id:"automation.summaryCard.createPageThisDatabase"})):d.push((0,S.jsx)(D().sA,{defaultMessage:"create a page in another database",id:"automation.summaryCard.createPageAnotherDatabase"}))}else if(k.isType("define_variables")){var m;d.push((0,S.jsx)(D().sA,{defaultMessage:"define {numVariables} custom {numVariables, plural, one {variable} other {variables}}",values:{numVariables:(null===(m=k.getConfig())||void 0===m||null===(m=m.variableIds)||void 0===m?void 0:m.length)??0},id:"automation.summaryCard.defineVariables"}))}else if(k.isType("send_in_app_notification")){var g;const e=null===(g=k.getConfig())||void 0===g?void 0:g.target;if(!e)continue;const n=e.type;switch(n){case"formula":const a=(0,at().Fbh)(null===(t=e.value)||void 0===t?void 0:t.value),l=(0,at().kNd)(null===(o=e.value)||void 0===o?void 0:o.value),c=e=>{const t=k.getSpaceId()??"";return{table:it().oo,id:e,spaceId:t}},u=a.map((e=>c(e))),p=u.map((e=>(0,s().xC)({getRecordModel:i.getRecordModel,pointer:e}))).filter(F().O9).map((e=>(0,s().lR)(r,e)));d.push((0,S.jsx)(D().sA,{defaultMessage:"{numTargets, plural, one {send a notification to {singleTarget}} other {send a notification to {numTargets} people}}",values:{numTargets:u.length+l.length,singleTarget:u.length>0?p[0]:te().dC.created_by},id:"automation.summaryCard.sendNotificationUserTarget"}));break;case"property":if(!e.propertyId)break;let m;const g=i.getSchema()[e.propertyId];m=g?g.name??te().dC[g.type]:xt().CV.unknownPropertyTitle.defaultMessage,d.push((0,S.jsx)(D().sA,{defaultMessage:"send a notification to {propertyDisplayName}",values:{propertyDisplayName:m},id:"automation.summaryCard.sendNotificationPropertyTarget"}));break;default:(0,F().HB)(n)}}else if(k.isType("send_gmail_notification")){var y,h,f,v;const e=k.getConfig()??{},{to:t,cc:o,bcc:n}=e;if(null==t||null===(y=t.value)||void 0===y||!y.value)continue;if("formula"===(null==t||null===(h=t.value)||void 0===h?void 0:h.type)||"formula"===(null==o||null===(f=o.value)||void 0===f?void 0:f.type)||"formula"===(null==n||null===(v=n.value)||void 0===v?void 0:v.type))d.push((0,S.jsx)(D().sA,{defaultMessage:"send an email to recipients based on a formula",id:"automation.summaryCard.sendGmailNotificationUserFormulaTarget"}));else{var x,b,A,C;const e=[...null===(x=t.value)||void 0===x?void 0:x.value,...(null==o||null===(b=o.value)||void 0===b?void 0:b.value)||[],...(null==n||null===(A=n.value)||void 0===A?void 0:A.value)||[]],a=(0,at().Fbh)(e),l=(0,at().kNd)(null===(C=t.value)||void 0===C?void 0:C.value),c=(0,at().IQD)(e),u=e=>{const t=k.getSpaceId()??"";return{table:it().oo,id:e,spaceId:t}},p=a.map((e=>(0,s().xC)({getRecordModel:i.getRecordModel,pointer:u(e)}))).filter(F().O9).map((e=>(0,s().lR)(r,e))),m=(0,tt().C3)((0,at().k4p)(e));p.push(...m);const g=r.formatMessage(It.automationSingleTargetDefault);d.push((0,S.jsx)(D().sA,{defaultMessage:"{numTargets, plural, one {send an email to {singleTarget}} other {send an email to {numTargets} people}}",values:{numTargets:new Set(p).size+l.length+c.length,singleTarget:g},id:"automation.summaryCard.sendGmailNotificationUserTarget"}))}}else k.isType("http_request")&&d.push((0,S.jsx)(D().sA,{defaultMessage:"send a webhook",id:"automation.summaryCard.sendWebRequest"}));return r.formatList(d,{style:"long",type:"conjunction"})}function _t(e){const{propertyActionValue:t,propertySchema:o}=e,n=(0,D().tz)(),i=(0,dt().qC)({intl:n,propertySchema:o,value:t.value});return i||null}function Bt(e){const{propertyActionValue:t,propertySchema:o}=e,n=(0,D().tz)();return(0,r().K8)((()=>(0,ut().cI)({intl:n,limit:ct().S,propertySchema:o,operator:null==t?void 0:t.action,value:t.value})),[n,null==t?void 0:t.action,t.value,o])}function Rt(e){const{propertyActionValue:t,propertySchema:o}=e;return(0,lt().rD)({propertySchema:o,value:t.value})}function Vt(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,D().tz)(),l=(0,a().v3)(),{typecheckResult:s}=(0,H().EC)(),c=o.value,u=(0,Xe().getAllContextValues)(s),d=(0,kt().Iq)({automationContextValues:u,limit:n.limit,value:c});return(0,r().K8)((()=>(0,kt().UW)({collectionStore:t,environment:l,intl:i,operator:null==o?void 0:o.action,propertySchema:n,relationPages:d,value:c})),[t,l,i,null==o?void 0:o.action,n,d,c])}function Et(e){const{automationActionId:t,collectionStore:o,propertyActionValue:n,propertyId:a,propertySchema:l}=e,s=(0,D().tz)(),c=n.value,u=(0,bt().F)({actionId:t}),d=(0,i.useMemo)((()=>({type:"collection",collectionStore:o,property:a})),[o,a]),p=(0,r().K8)((()=>(0,st().A)({intl:s,propertySchema:l,typecheckContextValues:u,value:c,valueContext:d})),[s,l,u,c,d]);return p||null}function Dt(e){const{automationActionId:t,propertyActionValue:o,propertySchema:n}=e,i=(0,a().v3)(),s=(0,l().DP)(),{automationStore:c}=(0,H().EC)(),u=(0,bt().F)({actionId:t}),d=(0,r().K8)((()=>(0,pt().hF)({automationStore:c,environment:i,propertySchema:n,theme:s,typecheckContextValues:u,value:o.value})),[c,i,o.value,n,s,u]);return d||null}function Ft(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n,contextValues:i}=e,a=(0,D().tz)(),l=(0,r().K8)((()=>(0,Ct().hs)({getRecordModel:t.getRecordModel,contextValues:i,intl:a,operator:o.action,propertySchema:n,value:o.value})),[t.getRecordModel,a,o.action,o.value,n,i]);return l||null}function Ot(e){let{collectionSchema:t,propertyId:o,variableId:n,typecheckResult:i,actionStore:a}=e;const r=(0,ot()._H)((0,Xe().getAllContextValues)(i),n),l=r?(0,ot().XZ)(r.type):void 0;let s=t;if(l&&l.table===nt().Vl){s=Tt().md.createChildStore(a,l).getSchema()}return s[o]}var Lt=()=>o(244641),Kt=()=>o(556927),Nt=()=>o(66913),Wt=()=>o(751156),zt=()=>o(755199),Ht=()=>o(460292),Ut=()=>o(554283);const Yt=(0,D().YK)({tryRepeatingTriggersTitle:{defaultMessage:"Try repeating triggers",id:"database.viewSettings.automationTab.automationWhatsNew.tryRepeatingTriggersTitle"},tryRepeatingTriggersBody:{defaultMessage:"Automatically create and edit items on a schedule",id:"database.viewSettings.automationTab.automationWhatsNew.tryRepeatingTriggersBody"},dismissButtonAriaLabel:{defaultMessage:"Close",id:"database.viewSettings.automationTab.automationWhatsNew.dismissButtonAriaLabel"},slackPricingChangeTitle:{defaultMessage:"Notice",id:"database.viewSettings.automationTab.automationWhatsNew.slackPricingChangeTitle"},slackPricingChangeBody:{defaultMessage:"A Plus plan will be required to access this feature starting August 13",id:"database.viewSettings.automationTab.automationWhatsNew.slackPricingChangeBody"}}),Gt={try_repeating_triggers:{title:Yt.tryRepeatingTriggersTitle,body:Yt.tryRepeatingTriggersBody,url:"https://www.notion.com/help/database-automations#database-automation-triggers"},slack_pricing_change:{title:Yt.slackPricingChangeTitle,body:Yt.slackPricingChangeBody,url:"http://notion.com/blog/notion-ai-for-work"}};function qt(e){let{collectionStoreId:t,surface:o,type:n,closeable:s}=e;const[c,u]=(0,i.useState)(!0),[d,p]=(0,Ut().B)(),m=(0,a().v3)(),g=(0,D().tz)(),y=(0,r().K8)((()=>{const{currentUserSettingsStore:e}=ae().default.state;if(!e||!e.isReady())return!1;const t=e.getSettingsStore().getKeyStore(`has_clicked_${n}_prompt`).getValue(),o=e.getSettingsStore().getKeyStore(`has_clicked_close_${n}_prompt`).getValue();if(t||o)return!1;const i=e.getSettingsStore().getKeyStore(`seen_${n}_prompt_at`).getValue();if((0,F().O9)(i)){const e=Lt().c9.fromMillis(i),t=Lt().c9.fromMillis(Lt().c9.now().toMillis()).diff(e,["weeks"]),o=t.toObject().weeks??0;return(0,F().O9)(t.toObject().weeks)&&o<=5}return Wt().createAndCommit({userAction:"AutomationsView.markPromptFirstSeen",environment:m,canUndo:!0,perform:t=>{zt().mJ({userSettingsStore:e,transaction:t,data:{[`seen_${n}_prompt_at`]:Lt().c9.now().toMillis()}})}}),!0}),[m,n]),h=(0,l().IS)((e=>({button:{borderRadius:10,display:"flex",flexDirection:"column",position:"relative",background:e.tint.regular,padding:"9px 12px"},hoveredButton:{background:e.tint.primaryHover},pressedButton:{backgroundColor:e.tint.primaryPressed},title:{fontWeight:O().Wy.medium,fontSize:O().J.UIRegular.desktop,alignItems:"center",display:"flex",color:e.text.primary,lineHeight:"20px",flexDirection:"row",gap:"2px",marginBottom:6},description:{fontWeight:O().Wy.regular,color:e.text.secondary,fontSize:"14px",lineHeight:"20px"},dismissButton:{position:"absolute",right:6,top:6,borderRadius:4,display:"flex",height:20,justifyContent:"center",alignItems:"center",width:20,visibility:p?"visible":"hidden"},dismissIcon:{width:14,height:14,color:e.icon.secondary}})),[p]),f=(0,i.useCallback)((()=>{if(!t)return;(0,N().u)({environment:m,event:{eventName:"automation_learn_click",eventProperties:{collection_id:t,specific_feature:n,surface:o}}});const{currentUserSettingsStore:e}=ae().default.state;e&&e.isReady()&&s&&Wt().createAndCommit({userAction:"AutomationsView.markPromptLinkClicked",environment:m,canUndo:!0,perform:t=>{zt().mJ({userSettingsStore:e,transaction:t,data:{[`has_clicked_${n}_prompt`]:!0}})}})}),[t,n,o,m,s]),v=(0,i.useCallback)((e=>{if(!s)return;if(e.preventDefault(),e.stopPropagation(),u(!1),!t)return;(0,N().u)({environment:m,event:{eventName:"automation_close_learn_prompt",eventProperties:{collection_id:t,specific_feature:n,surface:o}}});const{currentUserSettingsStore:i}=ae().default.state;i&&i.isReady()&&Wt().createAndCommit({userAction:"AutomationsView.markPromptDismissed",environment:m,canUndo:!0,perform:e=>{zt().mJ({userSettingsStore:i,transaction:e,data:{[`has_clicked_close_${n}_prompt`]:!0}})}})}),[t,m,o,n,s]);return c&&y?(0,S.jsxs)(Oe().A,{style:h.button,hoveredStyle:h.hoveredButton,pressedStyle:h.pressedButton,ref:d,href:Gt[n].url,external:!0,onClick:f,children:[(0,S.jsxs)("div",{style:h.title,children:[(0,S.jsx)(D().sA,{...Gt[n].title}),(0,S.jsx)(Ht().Q,{iconGroup:Kt().j,variantName:"mini",colorName:"secondary"})]}),(0,S.jsx)("div",{style:h.description,children:(0,S.jsx)(D().sA,{...Gt[n].body})}),s?(0,S.jsx)($().p,{size:"sm",style:h.dismissButton,onClick:v,"aria-label":g.formatMessage(Yt.dismissButtonAriaLabel),children:(0,Nt().V)(h.dismissIcon)}):null]}):null}const $t=(0,D().YK)({automationTabTitle:{defaultMessage:"Automations",id:"database.viewSettings.automationTab.title"},automationNewAutomationTitle:{defaultMessage:"New automation",id:"database.viewSettings.automationTab.newAutomationTitle"},automationUpgradeTitle:{defaultMessage:"Upgrade",id:"database.viewSettings.automationTab.upgradeTitle"},automationLearnAutomationTitle:{defaultMessage:"Learn about automations",id:"database.viewSettings.automationTab.learnAutomationTitle"},automationEmptyViewEditorPublic:{defaultMessage:"Automatically edit properties, create pages, send updates, and more",id:"database.viewSettings.automationTab.automationEmptyViewEditorPublic"},automationEmptyViewReadOnly:{defaultMessage:"Youâ€™re a content viewer. Content viewers cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewReadOnly"},automationEmptyViewContentEditor:{defaultMessage:"Youâ€™re a content editor. Content editors can edit pages, but you need full access to create automations.",id:"database.viewSettings.automationTab.automationEmptyViewContentEditor"},automationSearchPlaceholder:{defaultMessage:"Search automationsâ€¦",id:"database.viewSettings.automationTab.automationSearchPlaceholder"},automationInvalidPausedCaption:{defaultMessage:"Fix any errors or remove failing steps to enable this automation",id:"database.viewSettings.automationTab.automationInvalidPausedCaption"},automationInvalidActiveCaption:{defaultMessage:"Fix any errors or remove failing steps to prevent this automation from pausing on failure",id:"database.viewSettings.automationTab.automationInvalidActiveCaption"},automationRestartSuccessMessage:{defaultMessage:"Restarted automation successfully",id:"automations.buttonTrigger.restartSuccessMessage"}});function Jt(e){const{collectionContextStore:t,collectionSettingsStore:o,fullHeight:s,tabSettings:c}=e,u=(0,a().v3)(),d=(0,D().tz)(),{isMobile:p}=(0,a().Y0)(),[m,g]=(0,i.useState)(""),y=(0,r().K8)((()=>t.collectionStore()),[t]),h=(0,r().K8)((()=>t.collectionViewBlockStore()),[t]),f=(0,r().K8)((()=>y&&y.id),[y]),v=(0,r().K8)((()=>null==y?void 0:y.getSchema()),[y]),x=(0,r().K8)((()=>null==y?void 0:y.getFormat()),[y]),b=(0,r().K8)((()=>function(e){const{collectionStore:t,collectionViewBlockStore:o}=e;if(!t||!o)return[];const n=t.getAutomationStores(),i=[];for(const a of n){const e=a.getModel();null!=e&&e.getAlive()&&(a.isDisplayableInCollectionSettings()&&i.push(a))}return i}({collectionStore:y,collectionViewBlockStore:h})),[y,h]),A=(0,r().K8)((()=>function(e){const{automationStores:t,collectionSchema:o,intl:i}=e,a=new Map,r=[];for(const n of t){var l;if(!n.isDefined())continue;const e=[],t=n.getName();void 0!==t&&e.push(t);const s=null===(l=n.getOwnerStore())||void 0===l?void 0:l.getDisplayName(i);if(void 0!==s&&e.push(s),n.isTriggerType("event")){const t=n.getEventConfiguration(),a=null==t?void 0:t.pagePropertiesEdited;let r;if("some"===(null==a?void 0:a.type)?r=a.some:"all"===(null==a?void 0:a.type)&&(r=a.all),r)for(const n of r){const t=null==o?void 0:o[n.property];t&&e.push(`${t.name} ${te().dC[t.type]}`)}const l=to(n.getActionStores(),o,i);e.push(...l)}else if(n.isTriggerType("recurrence")){const t=n.getRecurrence();t&&e.push((0,U().LS)({recurrence:t,intl:i,leadingPhrase:"every"}));const a=to(n.getActionStores(),o,i);e.push(...a)}const c=e.join(" ");a.set(n.id,c),r.push(c)}return function(e){const o=new Set(n().filter(e,r).map((e=>{let{original:t}=e;return t})));return t.filter((e=>{if(!e.isTriggerType("event")&&!e.isTriggerType("recurrence"))return!1;const t=a.get(e.id);return!(!t||!o.has(t))}))}}({automationStores:b,collectionSchema:v,intl:d})),[b,v,d]),k=(0,r().K8)((()=>A(m)),[A,m]),j=b.find((e=>void 0!==(null==e?void 0:e.getSpaceId()))),{currentSpaceStoreId:T,currentUserStoreId:I}=(0,r().K8)((()=>{var e,t;return{currentSpaceStoreId:(null==j?void 0:j.getSpaceId())??(null===(e=ae().default.state.currentSpaceStore)||void 0===e?void 0:e.id),currentUserStoreId:null===(t=ae().default.state.currentUserStore)||void 0===t?void 0:t.id}}),[j]),w=(0,se().P9)({name:"premium_automations",spaceId:T,userId:I}),P=(0,se()._X)({name:"slack_automation_action",spaceId:T,userId:I}),_=(0,E().e2)(P),B=(0,Y().c)({automationStores:b,slackActionFeatureAvailability:P}),R=(0,r().K8)((()=>_&&oe().rc({collectionStore:y})),[y,_]),F=(0,G().k)({upsell:null==P?void 0:P.upsell,from:"automations_list_upgrade_button"}),O=(0,i.useCallback)((()=>{L().js({environment:u,collectionSettingsStore:o,collectionContextStore:t})}),[u,o,t]),K=(0,i.useCallback)((e=>g(e.target.value)),[]),W=(0,i.useCallback)((()=>{f&&(0,N().u)({environment:u,event:{eventName:"automation_learn_click",eventProperties:{collection_id:f}}})}),[u,f]);(0,i.useEffect)((()=>{f&&((0,N().u)({environment:u,event:{eventName:"automation_list_view",eventProperties:{source:c.source,collection_id:f}}}),le().default.logEvent("automation_list_view","true"))}),[u,f,c]);const[z,ne]=i.useState(!1),ue=(0,r().K8)((()=>function(e){var t;const o=null===(t=ae().default.state.currentUserStore)||void 0===t?void 0:t.pointer,n=[],i=[];for(const a of e){const e=a.getCreatedByPointer();o&&e&&V().L3.isEqual(o,e)?n.push(a):i.push(a)}return n.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),i.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),{currentUserAutomations:n,otherUserAutomations:i}}(k)),[k]),de=(0,i.useMemo)((()=>{const{currentUserAutomations:e,otherUserAutomations:t}=ue;return z?[...e,...t]:e.length>0?e:t}),[ue,z]),pe=k.length-de.length,me=!z&&pe>0,ge=de.length>0,ye=!ge&&!(""!==m),he=(0,r().K8)((()=>oe().rc({collectionStore:y})),[y]),fe=(0,r().O$)(re().e),ve=w&&he&&fe,xe=(0,l().IS)((e=>({buttonList:{display:"flex",flexDirection:"column",flexShrink:1,gap:12,overflow:"hidden auto",paddingBlockEnd:p?0:12,paddingBlockStart:p?12:0,paddingInline:12},emptyViewWrap:{paddingBlockEnd:12,paddingInline:12},menuScrollerStyle:{marginBlockStart:p?12:8},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0},createSection:{paddingBlock:20},createButtonWrapper:{paddingInline:12},createButton:{width:"100%",display:"flex",gap:6},headerContainer:{alignItems:"center",display:"flex",gap:4},headerInfoIcon:{fill:e.icon.secondary,height:14,width:14},whatsNewPrompt:{marginTop:8}})),[p]);return y&&v&&x&&h?(0,S.jsx)(q().Ay,{...e,fullHeight:s,header:!ye&&(0,S.jsx)(X().A,{children:(0,S.jsx)(J().Ay,{focusInitial:!p,onChange:K,placeholder:d.formatMessage($t.automationSearchPlaceholder),showClearButton:!0,value:m})}),footer:(0,S.jsxs)(X().A,{style:xe.createSection,topBorder:!1,children:[R&&(0,S.jsx)("div",{style:xe.createButtonWrapper,children:(0,S.jsxs)(Z().A,{style:xe.createButton,onClick:O,disabled:!fe,children:[(0,M().W)({width:14,height:14}),(0,S.jsx)(D().sA,{...$t.automationNewAutomationTitle})]})}),!R&&!_&&(null==P?void 0:P.upsell)&&(0,S.jsx)("div",{style:xe.createButtonWrapper,children:(0,S.jsx)(ce().K,{source:"automations_list_upgrade_button",display:"button",upsell:P.upsell,children:(0,S.jsx)(Z().A,{style:xe.createButton,onClick:F,disabled:!fe,children:(0,S.jsx)(D().sA,{...$t.automationUpgradeTitle})})})})]}),menuScrollerStyle:xe.menuScrollerStyle,title:ge||m?(0,S.jsxs)("div",{style:xe.headerContainer,children:[(0,S.jsx)(D().sA,{...$t.automationTabTitle}),(0,S.jsx)(ee().A,{placement:ie().W.Right,renderTooltip:()=>(0,S.jsx)(D().sA,{...$t.automationLearnAutomationTitle}),render:e=>(0,S.jsx)(Q().A,{...e,href:"https://www.notion.so/help/database-automations",external:!0,onClick:W,children:(0,C().$)(xe.headerInfoIcon)})})]}):null,children:(0,S.jsx)("div",{style:xe.wrap,children:ye?(0,S.jsxs)("div",{style:xe.emptyViewWrap,children:[(0,S.jsx)(Qt,{collectionStore:y}),ve&&(0,S.jsx)("div",{style:xe.whatsNewPrompt,children:(0,S.jsx)(qt,{surface:"empty_automations_view",type:"try_repeating_triggers",collectionStoreId:f,closeable:!0})}),B&&(0,S.jsx)("div",{style:xe.whatsNewPrompt,children:(0,S.jsx)(qt,{surface:"list_automations_view",type:"slack_pricing_change",collectionStoreId:f,closeable:!1})})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("div",{style:xe.buttonList,children:[ve&&(0,S.jsx)("div",{style:xe.whatsNewPrompt,children:(0,S.jsx)(qt,{surface:"list_automations_view",type:"try_repeating_triggers",collectionStoreId:f,closeable:!0})}),B&&(0,S.jsx)("div",{style:xe.whatsNewPrompt,children:(0,S.jsx)(qt,{surface:"list_automations_view",type:"slack_pricing_change",collectionStoreId:f,closeable:!1})}),de.length>0?de.map(((e,n)=>(0,S.jsx)(H().or,{automationStore:e,children:(0,S.jsx)(Xt,{collectionContextStore:t,collectionStore:y,collectionSettingsStore:o,focused:!1,schema:v,shouldShowSlackPricingChangeBanner:B})},e.id))):(0,S.jsx)("p",{style:xe.noResultsTitle,children:(0,S.jsx)(D().sA,{defaultMessage:"No results",id:"collectionSettings.automationsView.noResults"})})]}),me&&(0,S.jsx)($().p,{isGray:!0,size:"xs",style:xe.showMoreButtonContainer,onClick:e=>{e.stopPropagation(),ne(!0)},children:(0,S.jsx)("div",{style:xe.showMoreButtonContent,children:(0,S.jsx)(D().sA,{id:"collectionSettings.automationsView.showMore",defaultMessage:"Show {number} more",values:{number:pe}})})})]})})}):null}function Qt(e){const{collectionStore:t}=e,o=(0,a().v3)(),n=(0,l().IS)((e=>({wrap:{alignItems:"center",display:"flex",flexDirection:"column",gap:7.5,justifyContent:"center",minHeight:250,textAlign:"center"},icon:{fill:e.icon.yellowPrimary,height:24,width:24},title:{fontSize:17,fontWeight:O().Wy.medium,margin:0},copy:{color:e.text.secondary,fontSize:14,margin:0,lineHeight:1.5}})),[]),i=(0,r().K8)((()=>t.getRole()),[t]);let s;return s=(0,r().K8)((()=>Boolean((0,ne().qb)(o,t))),[t,o])||!i||"editor"===i?$t.automationEmptyViewEditorPublic:"reader"===i||"comment_only"===i?$t.automationEmptyViewReadOnly:"content_only_editor"===i||"read_and_write"===i?$t.automationEmptyViewContentEditor:$t.automationEmptyViewEditorPublic,(0,S.jsxs)("div",{style:n.wrap,children:[(0,S.jsx)("div",{"aria-hidden":!0,children:(0,f().v)(n.icon)}),(0,S.jsx)("p",{style:n.title,children:(0,S.jsx)(D().sA,{...$t.automationTabTitle})}),(0,S.jsx)("p",{style:n.copy,children:(0,S.jsx)(D().sA,{...s})})]})}const Zt={text:B().U,number:o(966098).E,url:o(352064).I,file:o(504709).J,date:o(758219).Z,person:o(234194).M,email:o(617073).J,phone_number:o(818256).C,checkbox:o(263178).S,select:o(974967).n,multi_select:P().v,status:_().T,relation:o(365683).H,rollup:o(735925).h,formula:o(514503).n,created_time:T().w,created_by:I().E,title:o(263931).D,last_edited_time:T().w,last_edited_by:I().E,last_visited_time:T().w,button:_().T,auto_increment_id:o(786386).A,location:w,verification:o(372160).E,place:w,ai_summary:o(727706).G,ai_custom_prompt:o(806411).x,ai_extract:P().v,ai_translate:o(318890).K,ai_keywords:o(981714).u};function Xt(e){const{collectionContextStore:t,collectionStore:o,collectionSettingsStore:n,focused:l,schema:u,shouldShowSlackPricingChangeBanner:d}=e,f=(0,D().tz)(),x=(0,a().v3)(),{automationStore:C}=(0,H().EC)(),{actionIcons:T,actionStores:I,canUserManageAutomation:w,canUserRemoveAutomation:P,isAutomationEnabled:_,isPersistedStateComplete:R,title:V,triggerConfig:E,triggerIcons:O}=function(e){let{collectionStore:t,schema:o}=e;const n=(0,D().tz)(),{automationStore:i,typecheckResult:a}=(0,H().EC)(),l=(0,r().K8)((()=>oe().Qn({automationStore:i,collectionStore:t,typecheckResult:a})),[i,t,a]),u=(0,r().K8)((()=>i.getActionStores()),[i]),d=(0,r().K8)((()=>i.getTriggerStore().getValue()),[i]),f=(0,r().K8)((()=>d?function(e){const{schema:t,triggerConfig:o,collectionStore:n}=e,i=[];if("event"===o.type){o.event.pagesAdded&&i.push({color:"blue",icon:M().W,type:"page"});const e=o.event.pagePropertiesEdited;if("any"===e.type)i.push({color:"blue",icon:k().r,type:"misc"});else if("some"===e.type||"all"===e.type){let o=[];"some"===e.type?o=e.some??[]:"all"===e.type&&(o=e.all??[]);for(const e of o){const o=t[e.property],a=e.filter;if(!o)continue;if(!c().tj[o.type]){i.push({color:"gray",icon:eo(o.type),type:"property"});continue}const r=m().DD(o),l=m().lx(o),u=m().E(o),d=m().AM(o),y=(0,g().DY)(o.type),h=m().nC(o);if("changes_to_any"===a.operator)i.push({color:r||l?"gray":"blue",icon:eo(o.type),type:"property"});else if(r&&!p().fZ(a)&&p().H$(a)){const e=p().V6(a);if(e.length>1)i.push({color:"gray",icon:eo(o.type),type:"property"});else if(1===e.length){const t=e[0];if("is_group"===t.type){const e=(o.groups??[]).find((e=>e.name===t.value));e&&i.push({color:e.color??"gray",icon:eo(o.type),type:"property"})}else{const e=(o.options??[]).find((e=>e.value===t.value));e&&i.push({color:e.color??"gray",icon:eo(o.type),type:"property"})}}}else if(l&&(p().v0(a)||p().as(a))){const e=p().fZ(a)?[]:p().v0(a)?p().Zl(a):p().SM(a);if(1===e.length){const t=e[0],n=(o.options??[]).find((e=>e.value===t.value));n&&i.push({color:n.color??"gray",icon:eo(o.type),type:"property"})}else(e.length>1||0===e.length)&&i.push({color:"gray",icon:eo(o.type),type:"property"})}else if(u&&p().I_(a)){const e=p().fZ(a)?[]:p().Wf(a);if(1===e.length){if(!p().fZ(a)){const e=p().Wf(a)[0];if("exact"===e.type&&e.value){if("space_permission_group"===e.value.table)throw new Error("Unexpected group");const t=(0,s().xC)({pointer:e.value,getRecordValue:n.getRecordValue});i.push({actor:t,type:"person"})}}}else(e.length>1||0===e.length)&&i.push({color:"gray",icon:eo(o.type),type:"property"})}else(d&&p().My(a)||y&&p().YH(a)||h&&p().Pq(a))&&i.push({color:"is_empty"===a.operator?"gray":"blue",icon:eo(o.type),type:"property"})}}}else"recurrence"===o.type?i.push({color:"blue",icon:v().k,type:"misc"}):"button"===o.type||(0,F().HB)(o);return i}({schema:o,triggerConfig:d,collectionStore:t}):[]),[o,d,t]),x=(0,r().K8)((()=>function(e){const{actionStores:t,collectionStore:o,schema:n}=e,i=[];for(const d of t)if(d.isType("slack_notification"))i.push({icon:j().z,type:"app"});else if(d.isType("update_pages")){const e=d.getConfig(),t=(null==e?void 0:e.properties)??[];if(1===t.length){var a,r;const u=t[0],d=n[u],p=null==e||null===(a=e.values)||void 0===a?void 0:a[u];if(!d||!p)continue;if(!c().I3(d)){i.push({color:"gray",icon:eo(d.type),type:"property"});continue}const h=(0,y().fromSimpleFormulaArrayValue)(null===(r=p.value)||void 0===r?void 0:r.value);if(m().DD(d)){const e=(d.options||[]).find((e=>e.value===h[0]));e&&i.push({color:e.color??"gray",icon:eo(d.type),type:"property"})}else if(m().lx(d))if(1===h.length){const e=(d.options||[]).find((e=>e.value===h[0]));e&&i.push({color:e.color??"gray",icon:eo(d.type),type:"property"})}else h.length>1&&i.push({color:"gray",icon:eo(d.type),type:"property"});else if(m().E(d)){var l;const e=(0,g().Y6)({textValue:null===(l=p.value)||void 0===l?void 0:l.value,propertySchema:d,blockCreatorPointer:void 0}).map((e=>(0,s().xC)({pointer:e,getRecordValue:o.getRecordValue})));1===e.length?i.push({actor:e[0],type:"person"}):i.push({color:"gray",icon:eo(d.type),type:"property"})}else i.push({color:"gray",icon:eo(d.type),type:"property"})}else t.length>1&&i.push({color:"gray",icon:k().r,type:"misc"})}else if(d.isType("create_page")){var u;(null===(u=d.getConfig())||void 0===u?void 0:u.collection)&&i.push({color:"blue",icon:M().W,type:"page"})}else d.isType("send_in_app_notification")?i.push({color:"blue",icon:h().r,type:"misc"}):d.isType("define_variables")?i.push({color:"gray",icon:B().U,type:"misc"}):d.isType("send_gmail_notification")?i.push({icon:A().Y,type:"app"}):d.isType("http_request")&&i.push({color:"gray",icon:e=>b({transform:"scale(1.35)",...e}),type:"misc"});return i}({actionStores:u,collectionStore:t,schema:o})),[o,t,u]),S=(0,r().K8)((()=>i.getNameWithDefault(n)),[n,i]),C=(0,r().K8)((()=>i.isActive()),[i]),T=(0,r().K8)((()=>oe().Gz({automationStore:i,collectionStore:t})),[i,t]),I=(0,r().K8)((()=>oe().TT({actionStores:u,automationStore:i,collectionStore:t})),[u,i,t]);return{isPersistedStateComplete:l,actionStores:u,triggerConfig:d,title:S,isAutomationEnabled:C,canUserManageAutomation:I,canUserRemoveAutomation:T,triggerIcons:f,actionIcons:x}}({collectionStore:o,schema:u}),N=function(e){let{isPersistedStateComplete:t,isAutomationEnabled:o,collectionStore:n}=e;const{automationStore:a,typecheckResult:l}=(0,H().EC)(),s=(0,r().K8)((()=>{if(a.isTriggerType("event")){return!a.getTrigger()||oe().l({automationStore:a,collectionStore:n})}return!1}),[a,n]),c=(0,i.useMemo)((()=>{if(l.error)return!0;const e=l.value.actionValidationFailures;return Object.values(e).flat().length>0}),[l]);return(0,r().K8)((()=>{var e,n;const i=null===(e=a.getModel())||void 0===e?void 0:e.getLastFailedTime(),r=null===(n=a.getModel())||void 0===n?void 0:n.getLastExecutedTime();return c||s||!t?"invalid":i&&r&&i>=r&&!o?"failing":o?"success":(0,U().NH)(a)?"expired":"paused"}),[a,c,s,t,o])}({collectionStore:o,isAutomationEnabled:_,isPersistedStateComplete:R}),{caption:Y,tooltipCaption:G}=function(e){let{actionStores:t,automationStatus:o,collectionStore:n,isAutomationEnabled:i,schema:l,triggerConfig:s}=e;const c=(0,a().v3)(),u=(0,D().tz)(),{automationStore:d,typecheckResult:p}=(0,H().EC)();return(0,r().K8)((()=>{const e=wt({actionStores:t,collectionStore:n,environment:c,getRecordModel:d.getRecordModel,intl:u,schema:l,triggerConfig:s,typecheckResult:p});return{caption:e,tooltipCaption:"invalid"===o?(0,S.jsx)(D().sA,{...i?$t.automationInvalidActiveCaption:$t.automationInvalidPausedCaption}):e}}),[i,u,t,n,c,d.getRecordModel,l,s,p,o])}({actionStores:I,automationStatus:N,collectionStore:o,isAutomationEnabled:_,schema:u,triggerConfig:E}),q=(0,r().O$)(t.aliveAutomationCountStore),$=(0,i.useCallback)((async()=>{await ue().lg({collectionStore:o,environment:x,existingAutomationStore:C,intl:f,onDelete:()=>{1===q&&L().R8({collectionSettingsStore:n,item:{type:"main"}})}})}),[f,x,o,n,C,q]),J=(0,i.useCallback)((()=>{ue().WA({automationStore:C,environment:x})}),[x,C]),Q=(0,i.useCallback)((()=>{W().h({environment:x,mode:"edit_automation",collectionSettingsStore:n,collectionContextStore:t,automationId:C.id,source:"collection_settings_automation_view"})}),[x,n,t,C]),Z=(0,i.useCallback)((()=>{ue().HJ({automationStore:C,environment:x})}),[x,C]),X=(0,i.useCallback)((()=>{ue().vH({automationStore:C,collectionStore:o,environment:x})}),[C,o,x]),ee=(0,i.useCallback)((()=>{if(!C.isTriggerType("recurrence"))return;ue().be({automationStore:C,collectionStore:o,environment:x});const e=f.formatMessage($t.automationRestartSuccessMessage);K().D6({label:e})}),[C,o,x,f]),te=(0,i.useCallback)((e=>(0,i.createElement)(We,{...e,key:C.id,actions:T,caption:Y,focused:l,status:N,onClick:Q,onDelete:P?$:void 0,onDisable:_&&P&&R?J:void 0,onRestart:"expired"===N?ee:void 0,onDuplicate:w?X:void 0,onEdit:w?Q:void 0,onEnable:!_&&P&&R?Z:void 0,title:V,triggers:O,shouldShowSlackPricingChangeBanner:d})),[T,C.id,w,P,Y,l,N,_,R,$,J,X,Q,Z,ee,V,O,d]);return(0,S.jsx)(z().P,{caption:G,renderOrigin:te,title:V,tooltipAlignment:ie().C.Start,tooltipPlacement:ie().W.Left})}function eo(e){return(0,F().O9)(e)?Zt[e]??R().x:R().x}function to(e,t,o){const n=[];for(const a of e){const e=a.getType();if(e){const t=(0,u().getActionRegistryItem)(e);(0,d().qe)(t)&&n.push(o.formatMessage(t.display.name))}if(a.isType("create_page")||a.isType("update_pages")){var i;const e=a.getConfig();null==e||null===(i=e.properties)||void 0===i||i.forEach((e=>{const o=null==t?void 0:t[e];o&&n.push(`${o.name} ${te().dC[o.type]}`)}))}}return n}},439616:(e,t,o)=>{o.d(t,{A:()=>V});o(944114),o(581454);var n=o(296540),i=()=>o(662303),a=()=>o(484714),r=()=>o(56366),l=()=>o(401497),s=()=>o(869190),c=()=>o(68263),u=()=>o(959013),d=()=>o(720665),p=()=>o(760217),m=()=>o(406699),g=()=>o(928600),y=()=>o(939740),h=()=>o(8980),f=()=>o(89924),v=()=>o(125565),x=()=>o(573351),S=()=>o(662971),b=()=>o(186445),A=()=>o(722872),C=()=>o(700250),k=()=>o(991249),M=()=>o(118849),j=()=>o(807778),T=()=>o(134217),I=()=>o(404520),w=o(474848);function P(e,t){const{permissionItem:n,hideIcon:i,onChange:r,buttonStyle:l}=e,s=(0,a().Y0)();return(0,w.jsx)(o(811979).A,{...e,popupType:s.isMobile?m().z7.SlideUp:m().z7.Popup,renderOrigin:a=>(0,w.jsx)(o(585293).a,{...(0,o(553965).A)(e,a),ref:t,title:(0,w.jsx)(u().sA,{defaultMessage:"Link expires",id:"publishSiteSettings.linkExpiration.settingTitle"}),icon:!i&&(0,w.jsx)(h().I,{icon:o(274570).clockIcon,color:"secondary"}),right:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(_,{permissionItem:n}),(0,w.jsx)(h().I,{icon:o(324254).arrowChevronSingleDownSmallIcon,size:"sm",color:"tertiary"})]}),buttonStyle:l}),alignmentToOrigin:C().MY.End,placementToOrigin:C().UV.Bottom,render:e=>(0,w.jsx)(B,{value:n.expiration_timestamp,onChange:r,onClose:()=>{e.close()}})})}function _(e){const{permissionItem:t}=e,o=(0,u().tz)(),n=(0,l().IS)((e=>({container:{color:e.text.secondary}})),[]);if(!t.expiration_timestamp||(0,c().OA)(t))return(0,w.jsx)(v().A,{style:n.container,children:(0,w.jsx)(u().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})});const a=s().jE(t.expiration_timestamp,i().locale,o);return(0,w.jsx)(v().A,{style:n.container,children:a})}function B(e){const{value:t,onChange:o,onClose:s}=e,c=(0,a().v3)(),m=c.device,h=(0,r().K8)((()=>(0,j().P4)()),[]),v=(0,r().K8)((()=>!T().qC()),[]),x=(0,r().K8)((()=>T().Si(c)),[c]),S=(0,n.useCallback)((e=>{void 0!==e&&e<=(new Date).getTime()||(o(e),s())}),[o,s]),b=(0,l().IS)((e=>({disabledContainer:{display:"flex",gap:6},disabledText:{color:e.text.tertiary}})),[]),C=function(){const e=Date.now(),t=e+d().pT,o=e+d().nD,n=e+7*d().nD;return[{key:"none",time:void 0,title:(0,w.jsx)(u().sA,{defaultMessage:"Never",id:"publishSiteSettings.linkExpiration.never"})},{key:"hour",time:t,title:(0,w.jsx)(u().sA,{defaultMessage:"In an hour",id:"publishSiteSettings.linkExpiration.oneHour"}),caption:new Intl.DateTimeFormat(i().locale,{hour:"numeric",minute:"numeric"}).format(t)},{key:"day",time:o,title:(0,w.jsx)(u().sA,{defaultMessage:"In a day",id:"publishSiteSettings.linkExpiration.oneDay"}),caption:new Intl.DateTimeFormat(i().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(o)},{key:"week",time:n,title:(0,w.jsx)(u().sA,{defaultMessage:"In a week",id:"publishSiteSettings.linkExpiration.oneWeek"}),caption:new Intl.DateTimeFormat(i().locale,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(n)}]}().map((e=>({key:e.key,action:()=>{S(e.time)},render:t=>(0,w.jsx)(p().A,{...t,title:e.title,titleStyle:v?b.disabledText:{},caption:e.caption,captionStyle:v?b.disabledText:{},disabled:v})}))),P=[{key:"predefined-expiration",render:e=>(0,w.jsx)(f().A,{...e}),items:C},{key:"custom-expiration",render:e=>(0,w.jsx)(f().A,{...e,topBorder:!0}),items:[R(S,t,v,b.disabledText)]}];return x&&v&&!h&&P.push({key:"upgrade-for-expiration",render:e=>(0,w.jsx)(f().A,{...e,topBorder:!0}),items:[{key:"upsell",action:()=>{k().K(c,{from:"public_permission_item_expiration",upsell:{type:"product",product:x,limit:{type:"none"},trialability:"none"}})},render:e=>(0,w.jsx)(p().A,{...e,focused:e.focused,title:(0,w.jsxs)("div",{style:b.disabledContainer,children:[(0,w.jsx)(u().sA,{defaultMessage:"Unlock link expiration",id:"publishSiteSettings.linkExpiration.upgrade"}),(0,w.jsx)(M().A,{subscriptionTier:x,analyticsName:"public_permission_item_expiration"})]})})}]}),(0,w.jsxs)(g().A,{menuType:m.isMobile?A().gu.ActionSheet:A().gu.Popup,width:271,children:[h&&v&&x&&(0,w.jsx)("div",{style:{padding:"10px 10px 4px 10px"},children:(0,w.jsx)(I().R,{source:"public_permission_item_expiration",display:"button",upsell:{type:"product",product:x,limit:{type:"none"},trialability:"none"}})}),(0,w.jsx)(y().Ay,{type:y().Oh.Vertical,initialFocus:void 0,sections:P})]})}function R(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return{key:"custom",action:()=>{window.parent.close()},render:(i,a)=>(0,w.jsx)(S().A,{...i,renderOrigin:e=>(0,w.jsx)(p().A,{...e,disabled:o,title:(0,w.jsx)(u().sA,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"}),titleStyle:o?n:{}}),onFocus:a.onFocus,disableDefaultClick:!0,renderExtension:(n,i)=>(0,w.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,w.jsx)(x().A,{...n,firstDayOfWeek:b().XX.state,value:t||Date.now(),onChange:t=>{e(t),i.close()},disabledDays:o||{before:new Date}})})})}}const V=n.forwardRef(P)},442277:(e,t,o)=>{o.d(t,{B:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("arrowRightSmaller",{viewBox:"0 0 16 16",directional:!0,svg:(0,n.jsx)("path",{d:"M15.383 8.352a.877.877 0 01-.274.64l-5.156 5.14a.864.864 0 01-.617.266.831.831 0 01-.602-.234.795.795 0 01-.234-.586c0-.12.02-.232.063-.336a.912.912 0 01.187-.273l1.75-1.766 2.914-2.656.274.5-2.711.156H1.484c-.26 0-.471-.078-.632-.234a.851.851 0 01-.235-.617c0-.256.078-.461.235-.618a.856.856 0 01.632-.242h9.493l2.71.164-.273.508L10.5 5.5 8.75 3.727a.946.946 0 01-.188-.266.917.917 0 01-.062-.344c0-.234.078-.43.234-.586a.831.831 0 01.602-.234.79.79 0 01.328.07c.104.047.203.117.297.211l5.148 5.133a.877.877 0 01.274.64z"})})},448693:(e,t,o)=>{o.d(t,{Ay:()=>v,t_:()=>x,v7:()=>S});o(296540);var n=()=>o(484714),i=()=>o(56366),a=()=>o(764880),r=()=>o(784892),l=()=>o(534177),s=()=>o(436525),c=()=>o(630116),u=()=>o(427636),d=()=>o(256863),p=()=>o(848401),m=()=>o(994006),g=()=>o(453697),y=o(474848);function h(e){const t=(0,n().v3)(),{actor:o,format:a,hasTooltip:h,tooltipHeader:v,hasPersonHoverCard:x}=e,S=(0,i().K8)((()=>{const e=o.asActor;return e&&c().sk.createUniqueRootStore(t,e.pointer)}),[o,t]);return(0,y.jsx)(p().Ay,{...e,renderAvatar:e=>{if(S){if(S instanceof c().vK)return a===r().NY.Inline?(0,y.jsx)(d().A,{botStore:S,size:e,style:f}):(0,y.jsx)(u().A,{botStore:S,avatarSize:e,inline:!0,style:f});if(S instanceof c().LU){if(a===r().NY.Inline){const t=(0,y.jsx)(g().A,{userStore:S,size:e,avatarShouldShowShadow:!0,hasTooltip:h??!0,style:f,tooltipHeader:v});return x?(0,y.jsx)(s().D,{userStore:S,children:t}):t}return(0,y.jsx)(m().A,{userStore:S,avatarSize:e,inline:!0,hasTooltip:h,hasPersonHoverCard:x,style:f,tooltipHeader:v})}S instanceof c().pH||(0,l().HB)(S)}}})}const f={minWidth:0};h.Format=r().NY;const v=h;function x(e){const{userValue:t,...o}=e;return(0,y.jsx)(h,{actor:(0,a().MR)(t),...o})}function S(e){const{botValue:t,...o}=e;return(0,y.jsx)(h,{actor:(0,a().oC)(t),...o})}x.Format=p().mI,S.Format=p().mI},450859:(e,t,o)=>{o.d(t,{mA:()=>A});o(16280),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520);var n=()=>o(329199),i=()=>o(416504),a=()=>o(696706),r=()=>o(179034),l=()=>o(973647),s=()=>o(534177),c=()=>o(862292),u=()=>o(186445),d=()=>o(909470),p=()=>o(972435),m=()=>o(217429),g=()=>o(38789),y=()=>o(630116),h=()=>o(449506);const f=1e3;class v extends Error{constructor(e,t){super(t),this.type=e}}class x extends v{constructor(){super("query_collection_limit_outside_range",`Query collection limit must be between 0 andÂ ${f}`)}}class S extends v{constructor(e){super("query_collection_failed",`Query collection failed: ${e.reason}`),this.data=e}}class b extends v{constructor(){super("query_collection_too_many_items","Query collection updating too many items")}}async function A(e,t){const{source:o,parentRecordStore:v,collectionPointer:A,filter:C,sort:k,limit:M}=t,j=M??f;if(j<0||j>f)return{error:new x};const T=y().md.createChildStore(v,A);await T.load();const I=T.getModel();if(!I)return{error:new S({reason:"no collection value"})};const w=T.getParentBlockStore();if(!w)return{error:new S({reason:"no collection parent"})};await w.load();const P=w.getCollectionViewStores()[0],_=P.getSpaceId();if(!P||!_)return{error:new S({reason:"no first collection view"})};const B="results",R={[B]:{type:"results",limit:j}},V=Object.keys(t.aggregations??{});for(const n of V){var E;if(n===B)return{error:new S({reason:`${B} is a reserved reducer keyword.`})};const e=null===(E=t.aggregations)||void 0===E?void 0:E[n];if(!e)return{error:new S({reason:`no aggregation provided for ${n}.`})};e&&(R[n]={type:"aggregation",aggregation:e})}const D=T.getSchema(),F={filter:C&&n().SK(C,D),sort:k&&n().g4(k,D),userId:e.currentUser.id,userTimeZone:(0,i().P)(),searchQuery:void 0,reducers:R},O=await h().callApi({eventName:"queryCollection",environment:e,data:{source:{type:"collection",id:A.id,spaceId:A.spaceId},collectionView:{id:P.id,spaceId:_},loader:F},tracking:{src:o}});if("failed"===O.type)return{error:new S({reason:"server query failed",cause:O.error})};const L=O.data.result.reducerResults[B];if(!L||"results"!==L.type)return{error:new S({reason:"unexpected server result"})};if(L.blockIds.length===f&&L.hasMore)return{error:new b};const{groupsReducerIds:K,reducerIdsWithNoGroupDependencies:N}=n().M(F.reducers,F.reducerDependencies),W=m().default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),z=Date.now(),H=await c().T.formulas.load(),U={pageSort:[],schema:D,loader:F,userId:e.currentUser.id,userStartOfWeek:u().XX.state,currentTime:z,getRecordModel:v.getRecordModel,getRecordRole:v.getRecordRole,intl:p().A.getIntl(),isSorted:!1,visibleProperties:void 0,relativeVariableResult:null==O?void 0:O.data.relativeVariableResult,currentPageInRelatedCollection:void 0,isSprintPlanningView:!1,source:{type:"collection",id:A.id,spaceId:A.spaceId},groupsReducerIds:K,reducerIdsWithNoGroupDependencies:N,formulaTimeoutMs:W,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,experimentService:m().default,collectionFeatureGates:(0,d().i)(),formulasModule:H},Y=n().zl(U);for(const i of L.blockIds){var G;const e=y().Bv.createChildStore(v,{table:r().ev,id:i}),t=null===(G=e.getAssociatedCollectionStore())||void 0===G?void 0:G.pointer;if(!(t&&a().L3.isEqualIdTable(t,T.pointer)))continue;const o=v.getRecordModel(e);o&&n().UC(o,I,U,Y)}const q=g().A.getEditedBlocksForCollection(I.id),$=new Set(L.blockIds);for(const i of q){if($.has(i))continue;const e=v.getRecordModel({table:r().ev,id:i});e&&n().UC(e,I,U,Y)}const{result:J}=n().Mo(U,Y),Q=n().uX({result:J}),Z={};for(const i of V){var X;const e=n().VI({expectedAggregator:null===(X=t.aggregations)||void 0===X||null===(X=X[i])||void 0===X?void 0:X.aggregator,aggregationReducerResult:O.data.result.reducerResults[i]});if(l().Q.isFail(e)){const t="no aggregation provided"===e.error?`no aggregation provided for ${i}`:"unexpected response returned for aggregation"===e.error?`unexpected response returned for aggregation ${i}`:(0,s().HB)(e.error);return{error:new S({reason:t})}}Z[i]=e.value}return{value:{blockIds:Q,...Z}}}},457717:(e,t,o)=>{o.d(t,{F:()=>n});const n=new(o(463830).A)},464004:(e,t,o)=>{o.d(t,{l:()=>f});var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(743176),s=()=>o(959013),c=()=>o(284371),u=()=>o(380468),d=()=>o(406699),p=()=>o(928600),m=()=>o(781697),g=()=>o(656134),y=()=>o(548526),h=o(474848);function f(e){const{alreadyHaveProperties:t,availablePropertyIds:o,collectionStore:f,currentValue:v,disabled:x,onChange:S,onRemove:b,placeholderMessage:A,errorMessage:C,hideErrorMessageTooltip:k}=e,M=(0,i().v3)(),j=(0,r().DP)(),{device:T}=M,I=(0,a().K8)((()=>f.getSchema()??{}),[f]),w=(0,a().K8)((()=>f.getFormat()??{}),[f]),P=(0,a().K8)((()=>v?f.getSchema()[v]:void 0),[v,f]),_=(0,a().K8)((()=>v?f.getDeletedSchema()[v]:void 0),[v,f]),B=(0,r().IS)((e=>{const t={fill:e.text.tertiary,height:"auto",marginRight:4,width:16};return{propertyIcon:t,deletedPropertyIcon:{...t,fill:e.text.uiRedPrimary},propertyTitle:{fontWeight:c().Wy.regular,...c().RC},deletedPropertyTitle:{color:e.text.uiRedPrimary,fontWeight:c().Wy.regular,...c().RC}}}),[]),R=(0,n.useCallback)((()=>o),[o]),V=(0,g().j)(),E=(0,n.useMemo)((()=>P?function(e){return(0,h.jsx)(l().zB,{icon:void 0,size:16,style:{...e,...B.propertyIcon},theme:j,type:P.type})}:_?function(e){return(0,h.jsx)(l().zB,{icon:void 0,type:_.type,size:16,theme:j,style:{...e,...B.deletedPropertyIcon}})}:void 0),[_,P,B.deletedPropertyIcon,B.propertyIcon,j]),D=Boolean(C),F=!Boolean(P)&&!Boolean(t),O=!Boolean(t);return(0,h.jsx)(d().Ay,{popupType:V,alignmentToOrigin:d().yP.Center,placementToOrigin:d().sx.Bottom,originGap:0,disabled:x,renderOrigin:e=>(0,h.jsx)(y().x,{...e,disabled:x,icon:E,isError:D,hasActionRequired:F,isSecondary:O,tooltipMessage:!k&&C,dropdownButtonType:"button",children:P?(0,h.jsx)("div",{style:B.propertyTitle,children:P.name}):_?(0,h.jsx)("div",{style:B.deletedPropertyTitle,children:_.name}):A?(0,h.jsx)(s().sA,{...A}):t?(0,h.jsx)(s().sA,{id:"automations.propertyPicker.buttonPlaceholderAlreadyHaveProperties",defaultMessage:"Edit property"}):(0,h.jsx)(s().sA,{id:"automations.propertyPicker.buttonPlaceholder",defaultMessage:"Edit a property"})}),render:e=>{const t=(0,m().v)({device:T,width:280,paddingTop:4});return(0,h.jsx)(p().A,{...t,children:(0,h.jsx)(u().A,{schema:I,format:w,showRemoveOption:Boolean(b),currentProperty:v,getProperties:R,onAccept:t=>{t&&t!==v?S(t):void 0===t&&(null==b||b(v)),e.close()}})})}})}},475679:(e,t,o)=>{o.d(t,{z:()=>O});o(898992),o(354520),o(737550);var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(655923),s=()=>o(112282),c=()=>o(457056),u=()=>o(334003),d=()=>o(764781),p=()=>o(105819),m=()=>o(406533),g=()=>o(236262),y=()=>o(340498),h=()=>o(959013),f=()=>o(534177),v=()=>o(813297),x=()=>o(760217),S=()=>o(187485),b=()=>o(135221),A=()=>o(928600),C=()=>o(939740),k=()=>o(89924),M=()=>o(862292),j=()=>o(645873),T=()=>o(324587),I=()=>o(546461),w=()=>o(366360),P=()=>o(76190),_=()=>o(781697),B=()=>o(283088),R=()=>o(383574),V=()=>o(686169),E=()=>o(542339),D=o(474848);const F=(0,h().YK)({learnAboutVariablesMenuItemLabel:{defaultMessage:"Learn about variables",id:"automations.actionContextMenu.learnAboutVariablesMenuItemLabel"},learnAboutWebhooksMenuItemLabel:{defaultMessage:"Learn about webhooks",id:"automations.actionContextMenu.learnAboutWebhooksMenuItemLabel"},addStepAboveMenuItemLabel:{defaultMessage:"Add action above",id:"automations.actionContextMenu.addStepAboveMenuItemLabel"},addStepBelowMenuItemLabel:{defaultMessage:"Add action below",id:"automations.actionContextMenu.addStepBelowMenuItemLabel"},deleteMenuItemLabel:{defaultMessage:"Delete",id:"automations.actionContextMenu.deleteMenuItemLabel"},duplicateMenuItemLabel:{defaultMessage:"Duplicate",id:"automations.actionContextMenu.duplicateMenuItemLabel"},duplicatingMenuItemLabel:{defaultMessage:"Duplicatingâ€¦",id:"automations.actionContextMenu.duplicatingMenuItemLabel"},editMenuItemLabel:{defaultMessage:"Edit",id:"automations.actionContextMenu.editMenuItemLabel"},moveDownMenuItemLabel:{defaultMessage:"Move down",id:"automations.actionContextMenu.moveDownMenuItemLabel"},moveUpMenuItemLabel:{defaultMessage:"Move up",id:"automations.actionContextMenu.moveUpMenuItemLabel"}});function O(e){const{actionStore:t,closeMenu:o}=e,{maybePersistedTransactionActions:r}=(0,w().b)(),{automationStore:l,contextType:s}=(0,I().EC)(),c=(0,h().tz)(),u=(0,i().v3)(),{value:d}=(0,j().fJ)(M().T.formulas),{value:p}=(0,j().fJ)(v().QV.automationTypecheck),[m,g]=(0,n.useState)(),y=(0,a().K8)((()=>l.getActionIds()),[l]),f=(0,a().K8)((()=>y.indexOf(t.id)),[t.id,y]),x=(0,a().K8)((()=>(0,V().J)(s,t)),[t,s]),S=(0,a().K8)((()=>{if(!x||!t.isType("update_pages"))return;const e=t.getConfigStore().getKeyStore("properties").getValue();return null==e?void 0:e[0]}),[t,x]),b=0===f,A=f===y.length-1,C=(0,n.useCallback)((()=>{g(void 0),null==o||o()}),[o]),k=(0,R().V)(),_=(0,a().K8)((()=>k.some((e=>e.type===t.getType()))),[t,k]),O=(0,P().n)(l),K=(0,B().j)(),W=(0,n.useMemo)((()=>{if(l&&_)return async()=>{const e=r.createAndCommit({perform:e=>T().duplicateAutomationAction({sourceActionStore:t,environment:u,includeParenting:!0,insertionPoint:{afterActionId:t.id},transaction:e}),userAction:"ActionContextMenu.duplicateAction"});await e.performResult.onComplete,C()}}),[t,l,u,C,r,_]),z=(0,n.useCallback)((()=>{if(d&&p)return r.createAndCommit({perform:e=>{T().removeAutomationAction({actionStore:t,automationStore:l,automationTypecheckModule:p,contextType:s,environment:u,formulasModule:d,intl:c,isSubscribed:O,transaction:e,pageStore:K})},userAction:"ActionContextMenu.removeAction"}),C(),Promise.resolve()}),[t,l,p,s,u,d,C,c,r,O,K]),H=(0,n.useMemo)((()=>{if(!b&&d&&p)return()=>{r.createAndCommit({perform:e=>{const o=N(y,f-1,f);T().reorderAutomationActions({environment:u,automationStore:l,automationTypecheckModule:p,contextType:s,formulasModule:d,intl:c,newActionIds:o,transaction:e,from:"action_menu",movedActionId:t.id,isSubscribed:O,pageStore:K})},userAction:"ActionContextMenu.moveAction"}),C()}}),[b,r,C,y,d,f,l,s,c,u,t,p,O,K]),U=(0,n.useMemo)((()=>{if(!A&&d&&p)return()=>{r.createAndCommit({perform:e=>{const o=N(y,f+1,f);T().reorderAutomationActions({environment:u,automationStore:l,automationTypecheckModule:p,contextType:s,formulasModule:d,intl:c,newActionIds:o,transaction:e,from:"action_menu",movedActionId:t.id,isSubscribed:O,pageStore:K})},userAction:"ActionContextMenu.moveAction"}),C()}}),[A,r,C,y,f,l,s,c,d,u,t,p,O,K]),Y=(0,n.useMemo)((()=>{if(x&&S)return function(){g({initialState:{actionId:t.id,propertyId:S,type:"eventActionProperty"},insertionPoint:void 0})}}),[t.id,x,S]),G=(0,n.useMemo)((()=>{if(0!==k.length)return()=>{g({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{beforeActionId:t.id}})}}),[k.length,t.id]),q=(0,n.useMemo)((()=>{if(0!==k.length)return()=>{g({initialState:{availableActions:[],hasUpdateThisPagePropertyActions:!0,hasSearch:!0,type:"eventActions"},insertionPoint:{afterActionId:t.id}})}}),[k.length,t.id]),$=(0,a().K8)((()=>"define_variables"===t.getType()?{link:"https://www.notion.so/help/database-automations#database-automation-actions",label:F.learnAboutVariablesMenuItemLabel}:"http_request"===t.getType()?{link:"https://www.notion.so/help/webhook-actions",label:F.learnAboutWebhooksMenuItemLabel}:void 0),[t]);return(0,D.jsxs)(D.Fragment,{children:[!m&&(0,D.jsx)(L,{onAddStepAbove:G,onAddStepBelow:q,onDelete:z,onDuplicate:W,onEdit:Y,onMoveDown:U,onMoveUp:H,learnAbout:$}),m&&(0,D.jsx)(E().A,{initialState:m.initialState,insertionPoint:m.insertionPoint,onClose:C})]})}function L(e){const{onAddStepAbove:t,onAddStepBelow:o,onDelete:i,onDuplicate:a,onEdit:v,onMoveDown:x,onMoveUp:b,learnAbout:M}=e,j=(0,_().e)();let T=!1;const I=function(e){const{hasSeparator:t,onEdit:o}=e,i=(0,n.useMemo)((()=>{if(o)return{action:o,key:"edit",render:e=>(0,D.jsx)(K,{...e,icon:(0,p().pencilLineIcon)({width:y().Ev.default}),children:(0,D.jsx)(h().sA,{...F.editMenuItemLabel})})}}),[o]),a=[i].filter(f().O9);if(0===a.length)return;return{items:a,key:"editActions",render:e=>(0,D.jsx)(k().A,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onEdit:v});T||=Boolean(I);const w=function(e){const{hasSeparator:t,onMoveDown:o,onMoveUp:i}=e,a=(0,n.useMemo)((()=>{if(i)return{action:i,key:"moveUp",render:e=>(0,D.jsx)(K,{...e,icon:(0,s().s)({width:y().Ev.default}),children:(0,D.jsx)(h().sA,{...F.moveUpMenuItemLabel})})}}),[i]),r=(0,n.useMemo)((()=>{if(o)return{action:o,key:"moveDown",render:e=>(0,D.jsx)(K,{...e,icon:(0,l().v)({width:y().Ev.default}),children:(0,D.jsx)(h().sA,{...F.moveDownMenuItemLabel})})}}),[o]),c=[a,r].filter(f().O9);if(0===c.length)return;return{items:c,key:"moveSteps",render:e=>(0,D.jsx)(k().A,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onMoveDown:x,onMoveUp:b});T||=Boolean(w);const P=function(e){const{hasSeparator:t,onAddStepAbove:o,onAddStepBelow:i}=e,a=(0,n.useMemo)((()=>{if(o)return{action:o,key:"addStepAbove",render:e=>(0,D.jsx)(K,{...e,icon:(0,u().F)({width:y().Ev.default}),children:(0,D.jsx)(h().sA,{...F.addStepAboveMenuItemLabel})})}}),[o]),r=(0,n.useMemo)((()=>{if(i)return{action:i,key:"addStepBelow",render:e=>(0,D.jsx)(K,{...e,icon:(0,c().o)({width:y().Ev.default}),children:(0,D.jsx)(h().sA,{...F.addStepBelowMenuItemLabel})})}}),[i]),l=[a,r].filter(f().O9);if(0===l.length)return;return{items:l,key:"addSteps",render:e=>(0,D.jsx)(k().A,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onAddStepAbove:t,onAddStepBelow:o});T||=Boolean(P);const B=function(e){const{hasSeparator:t,onDuplicate:o,onDelete:i}=e,[a,r]=(0,n.useState)(!1),l=(0,n.useMemo)((()=>{if(o)return{action:async()=>{r(!0);try{await o()}finally{r(!1)}},key:"duplicate",render:e=>(0,D.jsx)(K,{...e,icon:(0,d().V)({width:y().Ev.default}),isLoading:a,children:a?(0,D.jsx)(h().sA,{...F.duplicatingMenuItemLabel}):(0,D.jsx)(h().sA,{...F.duplicateMenuItemLabel})})}}),[a,o]),s=(0,n.useMemo)((()=>{if(i)return{action:i,key:"delete",render:e=>(0,D.jsx)(K,{...e,icon:(0,g().trashIcon)({width:y().Ev.default}),isRedOnHover:!0,children:(0,D.jsx)(h().sA,{...F.deleteMenuItemLabel})})}}),[i]),c=[l,s].filter(f().O9);if(0===c.length)return;return{items:c,key:"otherActions",render:e=>(0,D.jsx)(k().A,{enableActionSheetTitle:!0,topBorder:t,...e})}}({hasSeparator:T,onDuplicate:a,onDelete:i});T||=Boolean(B);const R=function(e){const{hasSeparator:t,learnAbout:o}=e,n=(0,r().IS)((e=>({icon:{height:16,width:16,fill:e.text.secondary},textWrapper:{color:e.text.secondary}})),[]);if(!o)return;return{items:[{action:()=>{},key:"learnAbout",render:e=>(0,D.jsx)(K,{...e,icon:(0,m().questionMarkCircleIcon)(n.icon),textWrapperStyle:n.textWrapper,children:(0,D.jsx)(S().A,{href:o.link,external:!0,children:(0,D.jsx)(h().sA,{...o.label})})})}],key:"learnSteps",render:e=>(0,D.jsx)(k().A,{topBorder:t,...e})}}({hasSeparator:T,learnAbout:M});return T||=Boolean(R),(0,D.jsx)(A().A,{...j,children:(0,D.jsx)(C().Ay,{type:C().Oh.Vertical,sections:[I,w,P,B,R].filter(f().O9),initialFocus:0})})}function K(e){const{children:t,icon:o,isLoading:n,...i}=e,a=n?(0,D.jsx)(b().A,{}):o;return(0,D.jsx)(x().A,{...i,disabled:n,disabledFeedback:n,icon:a,title:t})}function N(e,t,o){if(t<0||t>=e.length||o<0||o>=e.length)return e;const n=[...e];return n[t]=e[o],n[o]=e[t],n}},495408:(e,t,o)=>{o.d(t,{p:()=>S});var n=o(296540),i=()=>o(401497),a=()=>o(30626),r=()=>o(173019),l=()=>o(959013),s=()=>o(381349),c=()=>o(522945),u=()=>o(962730),d=()=>o(397248),p=()=>o(630116),m=()=>o(704152),g=()=>o(406699),y=()=>o(285790),h=()=>o(453101),f=()=>o(839010),v=()=>o(904694),x=o(474848);function S(e){const{height:t,padding:o,padding_top:S,iframe_url:b,hoverData:A,store:C,token:k,href:M,onDismiss:j}=e,T=(0,l().YK)({editLink:{defaultMessage:"Edit link",id:"hoverPreviewOverlay.editLink"}}),I=(0,l().tz)(),w=(0,n.useRef)(null),P=(0,i().IS)((e=>({content:{width:340,height:"100%",aspectRatio:"auto",position:"relative"},container:{width:340,maxHeight:420,flexDirection:"column",alignItems:"flex-start"},buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:e.icon.tertiary,background:h().xA}})),[]),_=C&&C.recordStoreUIParentStore&&C.recordStoreUIParentStore instanceof p().Bv?C.recordStoreUIParentStore:C instanceof p().Bv?C:void 0;return(0,x.jsxs)("div",{style:P.container,children:[e.showEditButton?(0,x.jsx)(y().A,{onClick:e.handleEditClick,icon:r().r,color:"primary",ariaLabel:I.formatMessage(T.editLink),hasBackground:!0,style:{position:"absolute",top:8,right:8,zIndex:1}}):void 0,k&&_&&A?(0,x.jsx)("div",{style:{position:"absolute",top:8,right:8,zIndex:2},children:(0,x.jsx)(g().Ay,{popupType:g().z7.Popup,placementToOrigin:u().W.Right,alignmentToOrigin:u().C.Start,originGap:4,onClose:()=>{let e=!1;const t=w.current;t&&(e=(0,d().ux)(t.getBoundingClientRect(),c().$C.x,c().$C.y)),e||null==j||j()},renderOrigin:e=>(0,x.jsx)(m().A,{style:P.buttonStyle,...e,children:(0,a()._)({width:14,fill:s().Ay.white})}),render:e=>(0,x.jsx)(v().A,{parentBlockStore:_,store:C,token:k,href:M,hoverData:A,onAccept:()=>e.close()})})}):void 0,(0,x.jsx)(f().A,{source:b,style:P.content,preserveScale:!!(t&&t<1||o),background:!1,height:t&&t>0?t:void 0,aspectRatio:o?o/100:.75,paddingTop:S||void 0})]})}},500071:(e,t,o)=>{o.d(t,{D:()=>U,y9:()=>W});o(898992),o(672577);var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(81768);const s=2e3;var c=()=>o(977345),u=()=>o(791089),d=()=>o(315564),p=()=>o(919709),m=()=>o(959013),g=()=>o(496603),y=()=>o(534177),h=()=>o(284371),f=()=>o(246826),v=()=>o(725614),x=()=>o(84817),S=()=>o(406699),b=()=>o(628864),A=()=>o(186445),C=()=>o(909470),k=()=>o(731320),M=()=>o(463830),j=()=>o(53137),T=()=>o(829e3),I=()=>o(546461),w=()=>o(653417),P=()=>o(252463),_=()=>o(366360),B=()=>o(858163),R=()=>o(133518),V=()=>o(656134),E=()=>o(475679),D=()=>o(542339),F=()=>o(548526),O=()=>o(929531),L=()=>o(616175),K=o(474848);const N=(0,m().YK)({slackCustomMessageLabel:{defaultMessage:"Custom message",id:"automations.SlackNotificationAction.customMessageLabel"},invalidChannelLabel:{defaultMessage:"Invalid channel",id:"slackNotificationAction.slackTargetChannel.invalidChannel"},hiddenChannelLabel:{defaultMessage:"Hidden channel",id:"slackNotificationAction.slackTargetChannel.hiddenName"},noTargetChannelLabel:{id:"slackNotificationAction.targetPicker.noTarget",defaultMessage:"Select Slack channel"}});function W(e){const{actionStore:t}=e,o=te(t),{automationStore:r}=(0,I().EC)(),{disabled:d,maybePersistedTransactionActions:g,suppressActionErrors:h}=(0,_().b)(),S=(0,l().getActionRegistryItem)("slack_notification"),b=Boolean(d),A=X(r)?(0,K.jsx)(w().TooltipWithSubtitle,{content:(0,K.jsx)(m().sA,{...w().automationErrorMessages.slackNotificationAuthenticationError})}):null,k=(0,a().uB)(void 0,M().A),j=(0,n.useCallback)((()=>k.reset()),[k]),T=(0,n.useMemo)((()=>(0,K.jsx)(E().z,{actionStore:t,closeMenu:j})),[t,j]),V=(0,n.useMemo)((()=>!h.includes(t.id)),[h,t]),{errorMessage:D}=(0,w().useErrorComponentForAction)({actionId:t.id,errorKey:"external_bot_id",shouldShow:V}),{errorMessage:F}=(0,w().useErrorComponentForAction)({actionId:t.id,errorKey:"target",shouldShow:V}),W=(0,a().K8)((()=>t.getSpaceId()),[t]),H=(0,a().K8)((()=>{var e;return null===(e=t.getConfig())||void 0===e?void 0:e.custom_message}),[t]),U=(0,R().F)({actionId:t.id}),Y=(0,a().K8)((()=>{if(W)return(0,u().analyzeSimpleFormulaOrFormulaSync)({context:{handleDataRequest:(0,c().zg)(t.getRecordModel),spaceId:W,valueTypes:U.slice(0),featureGates:(0,C().i)()},value:H})}),[t.getRecordModel,H,U,W]),{onTextStoreSelect:G,onTextStoreUnselect:q}=(0,B().W)(t),$=(0,i().v3)(),J=(0,n.useCallback)((()=>{v().clear({environment:$})}),[$]),Q=(0,n.useCallback)((e=>{const o=null==e?void 0:e.value;(!(0,y().O9)(o)||(0,p().AhH)(o)<=s)&&(g.createAndCommit({perform:o=>{f().zv({data:{custom_message:e},store:t.getConfigStore(),transaction:o})},userAction:"SlackNotificationAction.setCustomMessage"}),(0,P().UB)($,{automationStore:r,automationActionStore:t}))}),[t,r,$,g]);return W&&Y?(0,K.jsxs)(O().OT,{actionMenu:T,buttonPopupStore:k,disabled:b,actionId:t.id,canCollapse:!1,children:[(0,K.jsx)(O().h3,{actionId:t.id,actionRegistryItem:S,disabled:b,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"flex",flexWrap:"wrap",gap:4}},children:(0,K.jsx)(z,{actionStore:t,automationStore:r,disabled:b,errorMessage:A??D??F})}),(0,y().O9)(o)&&(0,K.jsx)(O().qt,{children:(0,K.jsx)(x().Y1,{direction:"vertical",gap:16,children:(0,K.jsx)(L().M,{analyzedFormulaOutput:Y,labelMessageDescriptor:N.slackCustomMessageLabel,disabled:b,disableMobileActionBar:!0,disableStyleAnnotations:!1,disableFormulas:!1,disableMentions:!1,isOptional:!0,formulaTypecheckContextValues:U,parentRecordStore:t,rows:5,spaceId:W,value:H,onChange:Q,onTextStoreSelect:G,onTextStoreUnselect:q,onTextEsc:J})})})]}):null}function z(e){const{actionStore:t,automationStore:o,disabled:n,errorMessage:i}=e;return(0,K.jsx)(m().sA,{defaultMessage:"Notify{slackTargetPicker}",id:"automations.slackNotificationAction.action.title",values:{slackTargetPicker:(0,K.jsx)(H,{actionStore:t,automationStore:o,disabled:n,errorMessage:i})}})}function H(e){const{actionStore:t,automationStore:o,disabled:i,errorMessage:r}=e,l=(0,a().K8)((()=>{const e=t.getConfigStore(),o=e.getKeyStore("external_bot_id").getValue();if((0,g().Im)(o))return!1;const n=e.getKeyStore("target").getValue();return!(0,g().Im)(null==n?void 0:n.id)}),[t]),s=(0,a().uB)(void 0,M().A),c=(0,n.useCallback)((()=>s.reset()),[s]),u=function(e){const{actionStore:t,automationStore:o}=e,[n,i]=(0,a().K8)((()=>{const e=t.getConfigStore();return[e.getKeyStore("target").getValue(),e.getKeyStore("external_bot_id").getValue()]}),[t]),r=X(o),{currentExternalAuthentication:l}=Z(t),s=(0,a().K8)((()=>j().A.completeSlackAuthentications.state.length??0),[]);if((0,y().O9)(n)&&(0,y().O9)(i))return r?{actionStore:t,externalBotId:i,notificationActionConfigStore:t,type:"connectToSlackReconnect"}:(0,y().O9)(l)?{actionStore:t,currentExternalAuthentication:l,currentNotificationChannel:n,type:"selectChannelUpdate"}:{actionStore:t,type:"connectToSlackDefault"};return 0===s?{actionStore:t,type:"connectToSlackDefault"}:s>1?{actionStore:t,type:"selectWorkspace"}:{actionStore:t,type:"selectChannelNew"}}({actionStore:t,automationStore:o}),d=(0,V().j)();return(0,K.jsx)(S().Ay,{alignmentToOrigin:S().yP.End,buttonPopupStore:s,disabled:i,originGap:0,placementToOrigin:S().sx.Bottom,popupType:d,renderOrigin:e=>(0,K.jsx)(F().x,{...e,disabled:i,isCompact:!0,isError:Boolean(r),hasActionRequired:!l,dropdownButtonType:"dropdown",children:l?(0,K.jsx)(U,{actionStore:t}):(0,K.jsx)(m().sA,{...N.noTargetChannelLabel})}),render:()=>(0,K.jsx)(D().A,{initialState:u,onClose:c})})}function U(e){const{actionStore:t}=e,o=(0,i().v3)(),n=(0,a().K8)((()=>{const e=(0,A().ZO)();return!(0,y().O9)(e)||Boolean((0,k().qb)(o,e))}),[o]),r=te(t),{authenticationState:l}=Z(t);return"invalid_channel"===l?(0,K.jsx)(Q,{}):n||!(0,y().O9)(r)?(0,K.jsx)(J,{}):"me"===r.type?(0,K.jsx)(q,{channelName:r.name}):"private"===r.type?(0,K.jsx)(G,{channelName:r.name}):"public"===r.type?(0,K.jsx)(Y,{channelName:r.name}):"im"===r.type?(0,K.jsx)($,{channelName:r.name}):void(0,y().HB)(r.type)}function Y(e){return(0,K.jsx)("span",{style:h().RC,children:`#${e.channelName}`})}function G(e){const{channelName:t}=e,o=ee();return(0,K.jsxs)("div",{style:o.container,children:[(0,d().S)(o.lockIcon),(0,K.jsx)("span",{style:h().RC,children:t})]})}function q(e){const{channelName:t}=e;return(0,K.jsx)("span",{style:h().RC,children:`@${t}`})}function $(e){const{channelName:t}=e;return(0,K.jsx)("span",{style:h().RC,children:`@${t}`})}function J(){const e=ee();return(0,K.jsxs)("div",{style:e.container,children:[(0,d().S)(e.lockIcon),(0,K.jsx)("span",{style:h().RC,children:(0,K.jsx)(m().sA,{...N.hiddenChannelLabel})})]})}function Q(){const e=ee();return(0,K.jsx)("div",{style:e.container,children:(0,K.jsx)("span",{style:h().RC,children:(0,K.jsx)(m().sA,{...N.invalidChannelLabel})})})}function Z(e){return(0,a().K8)((()=>{const t=e.getConfigStore().getKeyStore("external_bot_id").getValue();if(!t)return{authenticationState:"invalid_channel",currentExternalAuthentication:void 0};const o=j().A.completeSlackAuthentications.state.find((e=>t===e.id));return(0,y().O9)(o)?{authenticationState:"selected_channel",currentExternalAuthentication:o}:{authenticationState:"hidden_channel",currentExternalAuthentication:void 0}}),[e])}function X(e){return(0,a().K8)((()=>"disabled_auth"===e.getStatus()),[e])}function ee(){const{isMobile:e}=(0,i().Y0)(),t=e?h().J.UISmall.mobile:h().J.UISmall.desktop;return(0,r().IS)((()=>({container:{alignItems:"baseline",display:"inline-flex",gap:2,minWidth:50,width:"100%"},lockIcon:{alignSelf:"center",height:"auto",width:t}})),[t])}function te(e){const t=(0,i().v3)(),o=(0,a().K8)((()=>{var t;return null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.id}),[e]),{currentExternalAuthentication:r}=Z(e);return n.useEffect((()=>{r&&(0,b().Hn)({environment:t,spaceId:r.space_id,externalAuthConfig:{type:"external",botId:r.id}})}),[t,r]),(0,a().K8)((()=>{if(r&&o){const e=T().c.getStateForBot({type:"external",botId:r.id}).channels[o];if(e)return e}}),[o,r])}},500128:(e,t,o)=>{o.d(t,{K:()=>r});o(296540);var n=()=>o(963589),i=()=>o(404520),a=o(474848);function r(e){const{children:t,...o}=e;return(0,n().X)("upgrade_system")?(0,a.jsx)(i().R,{...o}):t}},514608:(e,t,o)=>{o.r(t),o.d(t,{eyeFillSmallIcon:()=>a,iconDefinition:()=>i});o(296540);var n=o(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"0.7 3.26 14.6 9.48",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M8 7.122a.875.875 0 1 1 0 1.75.875.875 0 0 1 0-1.75"}),(0,n.jsx)("path",{d:"M8 3.26c3.125 0 5.857 1.673 7.152 4.141l.065.144c.11.293.11.617 0 .91l-.065.145c-1.295 2.468-4.027 4.14-7.152 4.14-3.027 0-5.685-1.57-7.026-3.912L.848 8.6a1.29 1.29 0 0 1 0-1.199l.126-.228C2.314 4.83 4.972 3.26 8 3.26m0 2.112a2.626 2.626 0 0 0-2.625 2.626l.014.269A2.626 2.626 0 0 0 7.73 10.61l.269.014a2.626 2.626 0 0 0 2.611-2.357l.014-.269A2.626 2.626 0 0 0 8 5.372"})]})},a=(0,o(340498).wt)("eyeFillSmall",i)},519143:(e,t,o)=>{o.d(t,{D:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"0.12 2.37 19.76 15.25",svg:(0,o(474848).jsx)("path",{d:"m3.625 11.151 1.187-1.187a.625.625 0 1 1 .884.884l-2.254 2.254a.625.625 0 0 1-.884 0L.304 10.848a.625.625 0 0 1 .884-.884l1.187 1.187V10a7.625 7.625 0 0 1 12.813-5.587.625.625 0 1 1-.85.915A6.375 6.375 0 0 0 3.625 10zm14-2.302 1.187 1.187a.625.625 0 1 0 .884-.884l-2.254-2.254a.625.625 0 0 0-.884 0l-2.254 2.254a.625.625 0 1 0 .884.884l1.187-1.187V10a6.375 6.375 0 0 1-10.713 4.672.625.625 0 0 0-.85.915A7.625 7.625 0 0 0 17.625 10z"})},i=(0,o(340498).wt)("arrowCircleLoop",n)},536583:(e,t,o)=>{o.d(t,{d:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.88 2.32 14.24 15.36",svg:(0,o(474848).jsx)("path",{d:"M9.294 2.325h3.103c.484 0 .948.192 1.29.534l2.897 2.898c.343.342.535.806.535 1.29v5.903a1.825 1.825 0 0 1-1.825 1.825H12.53v1.075a1.825 1.825 0 0 1-1.825 1.825h-6A1.825 1.825 0 0 1 2.88 15.85v-8.8c0-1.008.817-1.825 1.825-1.825H7.47V4.15c0-1.008.817-1.825 1.825-1.825M9.1 5.76l2.897 2.897c.342.342.534.806.534 1.29v3.578h2.763a.575.575 0 0 0 .575-.575V7.3h-1.975a1.75 1.75 0 0 1-1.75-1.75V3.575h-2.85a.575.575 0 0 0-.575.575v1.318q.208.12.38.292m6.16.44-2.016-2.016V5.55c0 .359.29.65.65.65zm-10.554.275a.575.575 0 0 0-.575.575v8.8c0 .318.258.575.575.575h6a.575.575 0 0 0 .575-.575V10.2H9.306a1.75 1.75 0 0 1-1.75-1.75V6.475zm3.95.609V8.45c0 .359.291.65.65.65h1.366z"})},i=(0,o(340498).wt)("docOnDoc",n)},542339:(e,t,o)=>{o.d(t,{S:()=>qe,A:()=>$e});var n=o(296540),i=()=>o(56366),a=()=>o(534177),r=()=>o(404412),l=(o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(581454),o(908872),o.n(o(844751))),s=()=>o(484714),c=()=>o(401497),u=()=>o(890409),d=()=>o(556927),p=()=>o(340498),m=()=>o(199378),g=()=>o(84262),y=()=>o(959013),h=()=>o(496603),f=()=>o(813297),v=()=>o(2220),x=()=>o(760217),S=()=>o(928600),b=()=>o(939740),A=()=>o(460292),C=()=>o(147294),k=()=>o(89924),M=()=>o(859428),j=()=>o(594794),T=()=>o(972435),I=()=>o(47170),w=()=>o(645873),P=()=>o(479788);function _(){const e=(0,s().v3)();return(0,n.useMemo)((()=>(0,P().Q)(e)),[e])}var B=()=>o(962730),R=()=>o(765957),V=()=>o(329304),E=()=>o(324587),D=()=>o(546461),F=()=>o(5269),O=()=>o(366360),L=()=>o(781697),K=()=>o(383574),N=()=>o(284489),W=(o(430670),()=>o(422540)),z=()=>o(419357),H=()=>o(852353),U=o(474848);function Y(e){const{automationStore:t,collectionStore:o,searchInput:n}=e,i=new Set(t.getActionStores().flatMap((e=>e.isType("update_pages")?e.getConfigStore().getKeyStore("properties").getValue()??[]:[]))),r=o.getFormat(),s=o.getSchema(),c=(0,W().m7)({collectionFormat:r,collectionSchema:s,filter:e=>{let[t]=e;return!i.has(t)},spaceId:o.getSpaceId(),restrictCrossSpace:!0}),u=new Map,d=c.map((e=>{const t=s[e];if(t){const o=`${t.name} ${H().dC[t.type]}`;return u.set(e,o),o}})).filter(a().O9),p=new Set(l().filter(n,d).map((e=>{let{original:t}=e;return t})));return c.filter((e=>{const t=u.get(e);return t&&p.has(t)}))}function G(e){const{onChange:t,value:o,placeholder:n,isInput:i}=e;return{items:[{action:()=>{},key:"search-input",render:e=>(0,U.jsx)(q,{...e,onChange:t,value:o,placeholder:n})}],key:"search",render:e=>(0,U.jsx)(k().A,{...e,isInput:i})}}const q=(0,n.forwardRef)((function(e,t){const{onChange:o,value:n,placeholder:i,...a}=e,r=(0,y().tz)(),{isMobile:l}=(0,s().Y0)();return(0,U.jsx)(z().Ay,{...a,focus:!l,inputOuterStyle:{margin:0},onChange:o,placeholder:r.formatMessage(i),ref:t,value:n})}));var $=()=>o(253809);const J=(0,y().YK)({searchInputPlaceholder:{id:"UpdateThisPagePropertiesActionMenu.searchInputPlaceholder ",defaultMessage:"Search for a propertyâ€¦"},editProperty:{id:"automationEventActionMenu.pagePropertiesEditedSection.title",defaultMessage:"Edit property"}});function Q(e){const{automationActionMenuStore:t,onClose:o}=e,{automationStore:a,contextType:r}=(0,D().EC)(),l=(0,F().y)(a,r),[s,c]=(0,n.useState)(""),u=(0,i().K8)((()=>l&&a?Y({automationStore:a,collectionStore:l,searchInput:s}):[]),[a,l,s]),d=(0,i().K8)((()=>null==l?void 0:l.getSchema()),[l]),p=(0,n.useMemo)((()=>{const e=[];e.push(G({onChange:e=>c(e.target.value),value:s,placeholder:J.searchInputPlaceholder}));const o=d&&Z({automationActionMenuStore:t,propertyIds:u,normalizedBlockSchema:d,includeTitle:!1});return o&&e.push(o),e}),[t,u,d,s]),m=(0,$().r)({automationTriggerActionMenuStore:t,customMenuProps:{leftOuterStyle:{flexGrow:0},rightOuterStyle:{flexGrow:0},titleOuterStyle:{minWidth:0}},onClose:o,title:(0,U.jsx)("div",{style:{display:"inline-flex",minWidth:0,whiteSpace:"pre"},children:(0,U.jsx)(y().sA,{...J.editProperty})})});return(0,U.jsx)(S().A,{...m,children:(0,U.jsx)(b().Ay,{initialFocus:0,sections:p,type:b().Oh.Vertical})})}function Z(e){const{automationActionMenuStore:t,hasTopBorder:o,normalizedBlockSchema:n,propertyIds:i,includeTitle:r}=e,l=i.map((e=>{const o=n[e];if(o)return function(e){const{automationActionMenuStore:t,propertyId:o,propertySchema:n}=e;return{action:()=>{t.pushSettingsItem({actionId:void 0,propertyId:o,type:"eventActionProperty"})},key:`update_this_page_property_${o}_action`,render:e=>(0,U.jsx)(X,{...e,propertySchema:n})}}({automationActionMenuStore:t,propertyId:e,propertySchema:o})})).filter(a().O9);if(0!==l.length)return{key:"automation_update_this_page_section",items:l,render:e=>(0,U.jsx)(k().A,{...e,title:r?(0,U.jsx)(y().sA,{...J.editProperty}):void 0,topBorder:o})}}const X=(0,n.forwardRef)((function(e,t){const{propertySchema:o,...n}=e;return(0,U.jsx)(x().A,{...n,icon:(0,U.jsx)(ee,{propertySchema:o}),ref:t,showExtensionArrow:!0,title:o.name})}));function ee(e){const{propertySchema:t}=e,n=(0,c().DP)(),i=(0,c().IS)((e=>({icon:{fill:e.icon.secondary,width:p().Ev.sm},iconWrap:{alignItems:"center",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[]);return(0,U.jsx)("div",{style:i.iconWrap,children:(0,U.jsx)(o(743176).zB,{icon:t.icon,size:16,style:i.icon,theme:n,type:t.type})})}const te=(0,y().YK)({searchInputPlaceholder:{id:"automationEventActionMenu.searchInputPlaceholder.label",defaultMessage:"Search actionsâ€¦"},updateThisPagePropertiesMenuItemCaption:{defaultMessage:"Edit propertyâ€¦",id:"automationEventActionMenu.updateThisPagePropertiesMenuItem.caption"},upgrade:{defaultMessage:"Upgrade to Plus",id:"automationEventActionMenu.upsellFeatures.title"},disabledActionTooltipHeader:{defaultMessage:"Disabled in your workspace",id:"automationEventActionMenu.disabledActionTooltipHeader"},disabledActionTooltipBody:{defaultMessage:"Contact a workspace admin to modify this setting.",id:"automationEventActionMenu.disabledActionTooltipBody"}}),oe=["automation_actions","update_this_page_actions"],ne=["update_this_page_actions","automation_actions"];function ie(e){const{automationActionMenuStore:t,hasSearch:o,hasUpdateThisPagePropertyActions:r,onClose:p}=e,{isMobile:C}=(0,s().Y0)(),M=(0,s().v3)(),P=(0,y().tz)(),B=_(),{value:W}=(0,w().fJ)(f().QV.automationActionRegistry),{automationStore:z,contextType:H}=(0,D().EC)(),{maybePersistedTransactionActions:q,onActionAdded:$}=(0,O().b)(),J=(0,F().y)(z,H),Q=(0,K().V)(),X="event"===H,ee=(0,n.useMemo)((()=>X?ne:oe),[X]),ie=(0,i().K8)((()=>t.getInsertionPoint()),[t]),[re,le]=n.useState(""),se=(0,i().K8)((()=>o?function(e){const{automationActionRegistryModule:t,availableActions:o,searchInput:n}=e;if(!t||0===o.length)return[];const i=new Map,a=o.map((e=>{const t=T().A.formatMessage(e.display.name);return i.set(e.type,t),t})),r=new Set(l().filter(n,a).map((e=>{let{original:t}=e;return t})));return o.filter((e=>{const t=i.get(e.type);return t&&r.has(t)}))}({automationActionRegistryModule:W,availableActions:Q,searchInput:re}):Q),[Q,o,re,W]),ce=(0,i().K8)((()=>z.getActionStores().map((e=>e.getType())).filter(a().O9)),[z]),de=(0,n.useCallback)((e=>{if(!z)return;const t=z.getSpaceId(),{performResult:o}=q.createAndCommit({userAction:"AutomationActionList.addAction",perform:o=>E().addAutomationAction({actionId:(0,j().Z1)({environment:M,table:m().SC,spaceId:t}),actionType:e,automationStore:z,environment:M,insertionPoint:ie,intl:P,transaction:o,builderType:"modal"})});o&&((0,u().c_)(B,{automation_id:z.id,automation_action_id:o.id,automation_action_type:e,builder_type:"modal"}),null==$||$(o)),p()}),[z,q,p,M,ie,P,B,$]),pe=(0,i().K8)((()=>r&&J&&z?Y({automationStore:z,collectionStore:J,searchInput:re}):[]),[z,J,r,re]),me=(0,i().K8)((()=>Boolean(r&&J&&z&&Y({automationStore:z,collectionStore:J,searchInput:""}).length>0)),[z,J,r]),ge=(0,i().K8)((()=>null==J?void 0:J.getSchema()),[J]),ye=(0,I().O)(),he=(0,i().K8)((()=>{var e;return null===(e=R().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),fe=(0,V()._X)({name:"premium_automations",spaceId:ye,userId:null==he?void 0:he.id}),ve=(0,N().k)({onClose:p,upsell:null==fe?void 0:fe.upsell,from:"database_automation_modal_action_item"}),xe=(0,g().e2)(fe),Se=(0,V().P9)({name:"slack_automation_action",spaceId:ye,userId:null==he?void 0:he.id}),be=(0,c().IS)((e=>({unavailableHeader:{display:"inline-flex",minWidth:0,whiteSpace:"pre",cursor:"pointer",color:e.text.secondary},unavailableLinkIcon:{fill:e.icon.secondary}})),[]),Ae=(0,i().K8)((()=>{const e=[],n="button_block"===H||"button_property"===H,i=!n&&!xe,r=n&&!xe;o&&!i&&e.push(G({onChange:e=>le(e.target.value),value:re,placeholder:te.searchInputPlaceholder,isInput:!0}));const l=ee.reduce(((e,o)=>{if("automation_actions"===o)if(i||r){const[o,n]=h().jB(se,(e=>{if(i)return"slack_notification"===e.type&&Se;if(r){const t="slack_notification"!==e.type||Se;return"send_gmail_notification"!==e.type&&"http_request"!==e.type&&t}})),l=ae({key:"automation_actions_available_section",actionRegistryItems:o,hasTopBorder:e.length>0,onMenuItemClick:de,automationActionMenuStore:t,shouldShowUpdateThisPageProperties:"button_property"===H}),s=ae({key:"automation_actions_unavailable_section",actionRegistryItems:n,hasTopBorder:(0,a().O9)(l),hideChevron:!0,onMenuItemClick:ve,onClick:ve,automationActionMenuStore:t,shouldShowUpdateThisPageProperties:"event"===H,title:(0,U.jsxs)("div",{style:be.unavailableHeader,onClick:ve,children:[(0,U.jsx)(y().sA,{...te.upgrade}),(0,U.jsx)(A().Q,{iconGroup:d().j,variantName:"small",style:be.unavailableLinkIcon})]})});l&&e.push(l),s&&e.push(s)}else{const o=ae({actionRegistryItems:se,hasTopBorder:e.length>0,onMenuItemClick:de,automationActionMenuStore:t,shouldShowUpdateThisPageProperties:me&&"button_block"!==H&&(!re||ue(re))});o&&e.push(o)}else if("update_this_page_actions"===o){const o=ge&&(xe||!X)&&re.length>0&&Z({automationActionMenuStore:t,hasTopBorder:e.length>0,normalizedBlockSchema:ge,propertyIds:pe,includeTitle:!0});o&&e.push(o)}else(0,a().HB)(o);return e}),[]);return 0===l.length?e.push({key:"no_results_section",items:[{key:"no_results_item",action:()=>{},render:e=>(0,U.jsx)(x().A,{...e,disabled:!0,disabledFeedback:!0,title:(0,U.jsx)(y().sA,{defaultMessage:"No results",id:"automations.automationEventActionMenu.noResultsItem"})})}],render:e=>(0,U.jsx)(k().A,{...e})}):e.push(...l),e}),[t,xe,Se,pe,se,ge,H,o,me,X,de,ve,re,ee,be.unavailableHeader,be.unavailableLinkIcon]);(0,n.useEffect)((()=>{(0,v().u)({environment:M,event:{eventName:"automation_action_menu_opened",eventProperties:{automation_id:z.id,automation_context_type:H,existing_action_types:ce,available_action_types:Q.map((e=>e.type))}}})}),[Q,H,ce,z,M]);let Ce=(0,L().e)({width:266});return C||(Ce={...Ce,maxHeight:"50vh"}),(0,U.jsx)(S().A,{...Ce,children:(0,U.jsx)(b().Ay,{initialFocus:0,sections:Ae,type:b().Oh.Vertical})})}function ae(e){const{actionRegistryItems:t,hasTopBorder:o,onMenuItemClick:n,onClick:i,automationActionMenuStore:r,shouldShowUpdateThisPageProperties:l,key:s,title:c,hideChevron:u}=e,d=h().oE([l?se({hideChevron:u,onClick:()=>{(0,a().O9)(i)?i():r.pushSettingsItem({type:"updateThisPageProperties"})}}):void 0,...t.map((e=>function(e){const{actionRegistryItem:t,onClick:o}=e;return{action:()=>o(t.type),key:`${t.type}_action`,render:e=>(0,U.jsx)(re,{...e,actionRegistryItem:t})}}({actionRegistryItem:e,onClick:n})))]);if(0!==d.length)return{key:s||"automation_actions_section",items:d,render:e=>(0,U.jsx)(k().A,{...e,topBorder:o,title:c})}}const re=(0,n.forwardRef)((function(e,t){const{actionRegistryItem:r,...l}=e,s=r.display,{automationStore:u,contextType:d}=(0,D().EC)(),p=(0,i().K8)((()=>(0,o(157857).Z6)(u,d)),[u,d]),m=(0,I().O)(),g=(0,i().K8)((()=>{var e;return null===(e=R().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),h=(0,V().P9)({name:"premium_automations",spaceId:m,userId:null==g?void 0:g.id}),f=(0,V().P9)({name:"slack_automation_action",spaceId:m,userId:null==g?void 0:g.id}),v=(0,n.useMemo)((()=>{if(h)return!1;return"button_block"===d||"button_property"===d?"send_gmail_notification"===r.type||"http_request"===r.type||"slack_notification"===r.type&&!f:"slack_notification"!==r.type||!f}),[r.type,d,h,f]),S=(0,i().K8)((()=>!!((0,a().O9)(r)&&(0,a().O9)(p)&&(0,a().O9)(r.isDisabledForContext))&&r.isDisabledForContext(p)),[r,p]),b=(0,c().IS)((e=>({row:{display:"grid",gridTemplateColumns:"auto auto auto",justifyContent:"flex-start",...(v||S)&&{color:e.text.tertiary,cursor:"default"}},badge:{...(v||S)&&{color:e.text.tertiary,backgroundColor:e.palette.translucentGray[75]}},tooltipHeader:{width:200},tooltipBody:{color:e.text.secondary}})),[S,v]),A=(0,n.useMemo)((()=>{switch(r.type){case"send_gmail_notification":return(0,U.jsx)(o(515918).A,{style:b.badge});case"http_request":return(0,U.jsx)(C().Ee,{newBadgeKey:"http_request_automation_action",didUserEngage:!1,keyType:"date",style:b.badge});case"define_variables":return(0,U.jsx)(C().Ee,{newBadgeKey:"define_variables_automation_action",didUserEngage:!1,keyType:"date",style:b.badge});default:return}}),[r.type,b.badge]);return s?(0,U.jsx)(M().A,{textWrap:!0,placement:B().W.Right,alignment:B().C.End,disableTooltip:!S,renderTooltip:()=>(0,U.jsxs)("div",{style:b.tooltipHeader,children:[(0,U.jsx)("div",{children:(0,U.jsx)(y().sA,{...te.disabledActionTooltipHeader})}),(0,U.jsx)("div",{style:b.tooltipBody,children:(0,U.jsx)(y().sA,{...te.disabledActionTooltipBody})})]}),render:e=>(0,U.jsx)(x().A,{...l,...e,disabled:S,icon:(0,U.jsx)(le,{type:"actionRegistry",actionRegistryItem:r,disabled:S||v}),ref:t,right:A,title:(0,U.jsx)(y().sA,{...s.name}),style:b.row})}):null}));function le(e){const t="actionRegistry"===e.type&&"send_gmail_notification"===e.actionRegistryItem.type,o="actionRegistry"===e.type&&"slack_notification"===e.actionRegistryItem.type,n=(0,c().IS)((n=>({icon:{fill:e.disabled?n.text.tertiary:n.icon.secondary,height:"auto",width:p().Ev.default,opacity:(t||o)&&e.disabled?.4:1},iconWrap:{alignItems:"center",borderRadius:4,display:"flex",height:20,justifyContent:"center",width:20}})),[t,o,e.disabled]);return(0,U.jsx)("div",{style:n.iconWrap,children:"actionRegistry"===e.type?e.actionRegistryItem.display.icon(n.icon):"icon"===e.type?e.icon(n.icon):(0,a().HB)(e)})}function se(e){const{onClick:t,hideChevron:o}=e;return{action:()=>t(),key:"update_this_page_properties",render:e=>(0,U.jsx)(ce,{...e,hideChevron:o})}}const ce=(0,n.forwardRef)((function(e,t){const{hideChevron:n}=e,{contextType:a}=(0,D().EC)(),r=(0,I().O)(),l=(0,i().K8)((()=>{var e;return null===(e=R().default.state.currentUserStore)||void 0===e?void 0:e.getModel()}),[]),s=(0,V().P9)({name:"premium_automations",spaceId:r,userId:null==l?void 0:l.id}),u=(0,c().IS)((e=>({row:{...!s&&"event"===a&&{color:e.text.tertiary}}})),[a,s]);return(0,U.jsx)(x().A,{...e,icon:(0,U.jsx)(le,{type:"icon",icon:o(735790).M}),ref:t,showExtensionArrow:!n,title:(0,U.jsx)(y().sA,{...te.updateThisPagePropertiesMenuItemCaption}),style:u.row})}));function ue(e){const t=T().A.formatMessage(te.updateThisPagePropertiesMenuItemCaption);return l().test(e,t)}o(672577);var de=()=>o(118884),pe=()=>o(352271),me=()=>o(79118),ge=()=>o(410486),ye=()=>o(970013),he=()=>o(791089),fe=()=>o(919709),ve=()=>o(284371),xe=()=>o(246826),Se=()=>o(413194),be=()=>o(133518);const Ae=(0,y().YK)({menuHeaderTitle:{defaultMessage:"Set {propertyName} to",id:"automations.eventActionProperty.menuHeaderTitle"},menuHeaderEditTitle:{defaultMessage:"Edit {propertyName}",id:"automations.eventActionProperty.menuHeaderEditTitle"}});function Ce(e){var t;const{actionId:o,automationActionMenuStore:r,onClose:l,propertyId:c}=e,{automationStore:d,contextType:p}=(0,D().EC)(),g=(0,F().y)(d,p),{maybePersistedTransactionActions:f,onActionAdded:v}=(0,O().b)(),x=(0,y().tz)(),S=(0,s().v3)(),b=_(),A=(0,i().K8)((()=>r.getInsertionPoint()),[r]),C=(0,n.useMemo)((()=>g?{collectionStore:g,property:c,type:"collection"}:void 0),[g,c]),k=(0,i().K8)((()=>d.getSpaceId()),[d]),T=o??(0,j().Z1)({environment:S,table:m().SC,spaceId:k}),I=(0,i().K8)((()=>{const e=((null==d?void 0:d.getActionStores())??[]).find((e=>e.id===T));if(e&&e.isType("update_pages"))return e}),[d,T]),w=(0,i().K8)((()=>null==g?void 0:g.getSchema()[c]),[g,c]),P=(0,n.useMemo)((()=>{if(w&&(0,W().I3)(w))return W().Yy[w.type]}),[w]),R=(0,n.useMemo)((()=>!!w&&("multi_select"===w.type||(0,ye().sO)(w)&&1!==w.limit)),[w]),V=Boolean(w&&"button"!==w.type&&"rollup"!==w.type&&"formula"!==w.type&&"text"===(0,ge().IS)(w.type)),L=Boolean(w&&"button"!==w.type&&"rollup"!==w.type&&"formula"!==w.type&&"number"===(0,ge().IS)(w.type)),K=Boolean(w&&"date"===w.type),N=Boolean(w&&"status"===w.type),z=(0,i().K8)((()=>{if(g&&w)return(0,he().setPropertyValueToSimpleFormulaReturnType)(g.getSpaceShardedPointer(),c,w)}),[g,w,c]),H=(0,i().K8)((()=>{if(I)return I.getConfigStore().getKeyStore("values").getKeyStore(c).getValue()}),[I,c]),[Y,G]=(0,n.useState)(H),q=(0,n.useRef)({action:(null==H?void 0:H.action)||pe().yP,value:null==H?void 0:H.value}),J=(0,n.useMemo)((()=>{var e;return(0,he().fromSimpleFormulaArrayValue)(null==Y||null===(e=Y.value)||void 0===e?void 0:e.value)}),[null==Y||null===(t=Y.value)||void 0===t?void 0:t.value]),Q=(0,be().F)({actionId:null==I?void 0:I.id}),Z=(0,n.useCallback)((e=>{let{action:t,value:o}=e;if(!d)return;const{performResult:n}=f.createAndCommit({perform:e=>{if(!I)return E().addAutomationAction({actionId:T,actionType:"update_pages",automationStore:d,config:{properties:[c],target:{id:(0,me().KI)(),type:"variable"},values:{[c]:{action:t,value:o}}},environment:S,intl:x,insertionPoint:A,transaction:e,builderType:"modal"});xe().zv({data:{[c]:{action:t,value:o}},store:I.getConfigStore().getKeyStore("values"),transaction:e})},userAction:"UpdateThisPagePropertyActionMenu.saveChanges"});n&&((0,u().c_)(b,{automation_id:d.id,automation_action_id:n.id,automation_action_type:"update_pages"}),null==v||v(n))}),[I,d,S,b,T,A,x,f,v,c]),X=(0,n.useRef)(!1),ee=!N,te=(0,n.useCallback)((()=>{X.current=!0,(ee||(0,a().O9)(q.current.value))&&Z(q.current),l()}),[Z,l,ee]);(0,de().X)((()=>{const e=r.getState().stack,t=h().HV(e);!X.current&&(0,a().O9)(t)&&"eventActionProperty"===t.type&&te()}));const oe=(0,n.useCallback)(((e,t)=>{const o=t||pe().yP,n=q.current.value;q.current={value:e,action:o};if("formula"===(null==e?void 0:e.type))return void G({action:o,value:e});if("formula"===(null==n?void 0:n.type))G({action:o,value:e});else if(V||L||R||(0,a().O9)(t))G({action:o,value:e});else if(K){const t=(0,he().fromSimpleFormulaArrayValue)(null==e?void 0:e.value)[0];if((0,a().O9)(t)&&(0,he().isAnnotationSimpleValueToken)(t)&&(0,fe().qsB)(t))return void G({action:o,value:e});te()}}),[K,V,L,R,te]),ne="person"===(null==w?void 0:w.type)||"relation"===(null==w?void 0:w.type)||"multi_select"===(null==w?void 0:w.type),ie=ne?Ae.menuHeaderEditTitle:Ae.menuHeaderTitle,ae=(0,$().r)({automationTriggerActionMenuStore:r,customMenuProps:{leftOuterStyle:{flexGrow:0},rightOuterStyle:{flexGrow:0},titleOuterStyle:{minWidth:0}},onClose:l,onDone:te,title:(0,U.jsx)("div",{style:{display:"inline-flex",minWidth:0,whiteSpace:"pre"},children:x.formatMessage(ie,{propertyName:(0,U.jsx)(M().A,{placement:B().W.Bottom,render:e=>(0,U.jsx)("div",{...e,style:{...ve().RC},children:(null==w?void 0:w.name)??""}),renderTooltip:()=>(null==w?void 0:w.name)??""})})})});return w&&z&&C?(0,U.jsx)(Se().L,{allowedFormulaReturnTypes:P,formulaValueContext:C,currentSimpleFormulaValueTokens:J,formulaTypecheckContextValues:Q,menuProps:ae,onChange:oe,onClose:te,parentRecordStore:d,showClearButton:!N,type:z,value:null==Y?void 0:Y.value,action:(0,pe().tz)(Y),showReplaceAddRemoveToggle:ne}):null}var ke=()=>o(148307),Me=()=>o(617871),je=()=>o(402904),Te=()=>o(973647),Ie=()=>o(510683),we=()=>o(493823),Pe=()=>o(204063),_e=()=>o(881707),Be=()=>o(124749),Re=()=>o(53137),Ve=()=>o(630116);function Ee(e){const{type:t,automationActionMenuStore:o,onClose:n}=e,a=Ke(),r=(0,I().O)(),l=(0,Be().$)(),s="connectToSlackReconnect"===t?e.externalBotId:void 0,c=(0,i().K8)((()=>{if(void 0!==s&&l)return(0,Ve().Oo)(l,{table:je().As,id:s,spaceId:r}).getValue()}),[s,l,r]);let u,d=Le({viewType:"connectToSlackDefault"});if("connectToSlackReconnect"===t){if(!c)return null;const{accountName:e,organizationName:t}=(0,_e().qO)(c);u=(0,_e().Dy)(c),d=Le({viewType:"connectToSlackReconnect",accountName:e,organizationName:t})}return(0,U.jsx)($().A,{type:"custom",automationTriggerActionMenuStore:o,onClose:n,children:(0,U.jsx)(k().A,{children:(0,U.jsxs)("div",{style:a.container,children:[(0,U.jsx)(Fe,{}),(0,U.jsxs)("div",{style:a.connectToSlackBody,children:[(0,U.jsx)("div",{style:a.connectToSlackTitleText,children:Oe(t)}),(0,U.jsx)("div",{style:a.connectToSlackDescriptionText,children:d})]}),(0,U.jsx)(De,{...e,slackWorkspaceId:u})]})})})}function De(e){const{automationActionMenuStore:t,slackWorkspaceId:o}=e,n=(0,s().v3)(),r=Ke(),l=(0,I().O)(),c=(0,i().K8)((()=>Re().A.integrations.state.find((e=>e.id===Me().zG))),[]);return c&&l?(0,U.jsxs)("div",{style:r.buttonGroup,children:[(0,U.jsx)(Pe().A,{style:r.connectToSlackButton,size:"lg",onClick:async()=>{const i=await Ie().Jq({environment:n,integration:c,spaceId:l,from:"collection_view_settings",options:{slackWorkspaceId:o}});Te().Q.isFail(i)?t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):"connectToSlackReconnect"===e.type||("connectToSlackDefault"===e.type?i.value.externalAuthentication?t.replaceSettingsItem({type:"selectChannelNew",currentExternalAuthentication:i.value.externalAuthentication,actionStore:e.actionStore}):t.replaceSettingsItem({actionStore:e.actionStore,type:"selectWorkspace"}):(0,a().HB)(e))},children:(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.connectButton.label",defaultMessage:"Connect"})}),(0,U.jsx)(we().p,{style:r.cancelButton,size:"lg",onClick:()=>{t.popSettingsItem()},children:(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.cancelButton.label",defaultMessage:"Cancel"})})]}):null}function Fe(){const e=Ke();return(0,U.jsx)("div",{children:(0,U.jsx)("img",{src:ke().A.images.externalIntegrations.slackIconPng,style:e.slackIcon})})}function Oe(e){return"connectToSlackDefault"===e?(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.title",defaultMessage:"Connect to Slack"}):"connectToSlackReconnect"===e?(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.reconnect.title",defaultMessage:"Reconnect to Slack"}):void(0,a().HB)(e)}function Le(e){const{viewType:t}=e;return"connectToSlackDefault"===t?(0,U.jsx)(y().sA,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.description",defaultMessage:"Get notified in channels, see rich previews, and more."}):"connectToSlackReconnect"===t?(0,U.jsx)(y().sA,{id:"AutomationSlackConnectToSlackView.reconnect.description",defaultMessage:'Reconnect your Slack account ({accountName}) on {hasOrganizationName, select, true {"{organizationName}"} other {your Slack workspace}} to resume your notifications.',values:{accountName:e.accountName,hasOrganizationName:(0,a().O9)(e.organizationName),organizationName:e.organizationName}}):void(0,a().HB)(t)}function Ke(){return(0,c().IS)((e=>({container:{display:"flex",flexDirection:"column",margin:"10px 15px",justifyContent:"center",textAlign:"center"},connectToSlackBody:{margin:"0px 25px"},connectToSlackTitleText:{marginBottom:2,fontWeight:ve().Wy.semibold},connectToSlackDescriptionText:{fontSize:13,color:e.text.secondary},slackIcon:{width:23,height:"auto"},buttonGroup:{margin:"10px 10px 0px 10px"},connectToSlackButton:{width:"100%"},cancelButton:{color:e.text.secondary,width:"100%",justifyContent:"center",fontWeight:ve().Wy.medium,fontSize:13,marginTop:8}})),[])}var Ne=()=>o(628864);function We(e){const{actionStore:t,automationActionMenuStore:o,onClose:i}=e,{maybePersistedTransactionActions:r}=(0,O().b)(),l=n.useCallback(((e,o)=>{t&&r.createAndCommit({perform:n=>{var i;xe().zv({data:{config:{external_bot_id:o,target:{id:e.id,name:"",type:e.type},custom_message:null===(i=t.getConfig())||void 0===i?void 0:i.custom_message}},store:t,transaction:n})},userAction:"SlackSelectChannelMenu.handleChannelSelect"}),i()}),[t,r,i]),s=(0,n.useCallback)((()=>{const e=o.getState().stack;e.length<2||("selectWorkspace"===e[e.length-2].type?o.popSettingsItem():o.replaceSettingsItem({actionStore:t,type:"selectWorkspace"}))}),[t,o]),c="selectChannelNew"===e.type?void 0:"selectChannelUpdate"===e.type?e.currentNotificationChannel:(0,a().HB)(e),u=(0,n.useMemo)((()=>c?[c]:void 0),[c]);return(0,U.jsx)(Ne().pj,{currentExternalAuthentication:e.currentExternalAuthentication,currentNotificationChannels:u,onClose:i,onNotificationChannelSelect:l,onNewSlackAccountAdded:s,renderMenu:e=>(0,U.jsx)($().A,{type:"default",automationTriggerActionMenuStore:o,headerTitle:(0,U.jsx)(y().sA,{id:"notificationRuleSettings.selectChannelView.title",defaultMessage:"Select Slack channel"}),sections:e,onClose:i})})}var ze=()=>o(742117),He=()=>o(381138);const Ue=(0,y().YK)({workspaceSearchPlaceholder:{id:"notificationRuleSettings.selectWorkspaceView.searchInput.placeholder",defaultMessage:"Searchâ€¦"}});function Ye(e){const{onWorkspaceSelect:t,renderMenu:o,workspaceFilter:a,onNewSlackAccountAdded:r}=e,l=(0,s().v3)(),{isMobile:u}=(0,s().Y0)(),d=(0,I().O)(),p=(0,i().K8)((()=>(0,_e().l$)(Re().A.completeSlackAuthentications.state,a)),[a]),m=(0,i().K8)((()=>Re().A.integrations.state.find((e=>e.id===Me().zG))),[]),[g,h]=n.useState(""),f=(0,c().IS)((e=>({chevronRight:{width:12,height:"auto",color:e.icon.tertiary}})),[]);if(!m)return null;const v=Object.entries((0,_e().Os)(p,g)).map(((e,o)=>{let[n,i]=e;return{key:n,items:i.map((e=>{let{workspaceName:o,externalAuthentication:n}=e;return{key:n.id,action:()=>{t(n)},render:e=>(0,U.jsx)(x().A,{...e,title:o??(0,U.jsx)(y().sA,{id:"notificationRuleSettings.selectWorkspace.untitledWorkspace",defaultMessage:"Slack workspace"}),right:(0,ze().V)(f.chevronRight)})}})),render:e=>(0,U.jsx)(k().A,{...e,title:n,topBorder:0!==o})}}));return v.unshift({key:"search-input-section",items:[{key:"search-input-item",action:()=>{},render:e=>(0,U.jsx)("div",{children:(0,U.jsx)(z().Ay,{...e,inputLeft:(0,U.jsx)(z().Zf,{icon:He().q}),showClearButton:!0,placeholder:T().A.formatMessage(Ue.workspaceSearchPlaceholder),focus:!u||void 0,value:g,onChange:e=>{h(e.target.value)}})})}],render:e=>(0,U.jsx)(k().A,{...e})}),v.push({key:"add-another-slack-account-section",items:[{key:"add-another-slack-account-item",action:async()=>{if(!d)return;const e=await Ie().Jq({environment:l,integration:m,spaceId:d,from:"collection_view_settings"});Te().Q.isFail(e)||e.value.externalAuthentication&&(t(e.value.externalAuthentication),null==r||r())},render:e=>(0,U.jsx)(x().A,{...e,icon:(0,U.jsx)("img",{src:ke().A.images.externalIntegrations.slackIconPng,style:{width:18,height:"auto"}}),title:(0,U.jsx)(y().sA,{id:"notificationRuleSettings.selectWorkspaceView.setupAnotherSlackAccount.label",defaultMessage:"Add another Slack account"})})}],render:e=>(0,U.jsx)(k().A,{...e,topBorder:!0})}),(0,U.jsx)(U.Fragment,{children:o(v)})}function Ge(e){const{automationActionMenuStore:t,onClose:o}=e,i=n.useCallback((o=>{t.pushSettingsItem({actionStore:e.actionStore,type:"selectChannelNew",currentExternalAuthentication:o})}),[t,e.actionStore]);return(0,U.jsx)(Ye,{onWorkspaceSelect:i,renderMenu:e=>(0,U.jsx)($().A,{type:"default",automationTriggerActionMenuStore:t,headerTitle:(0,U.jsx)(y().sA,{id:"notificationRuleSettings.selectSlackWorkspace.title",defaultMessage:"Select Slack workspace"}),sections:e,onClose:o})})}const qe=(0,n.createContext)({menuStore:void 0});function $e(e){const{initialState:t,insertionPoint:o,onClose:l}=e,s=(0,i().K8)((()=>{const e=new(r().ew);return e.setState({insertionPoint:o,stack:[t]}),e}),[t,o]),c=(0,i().K8)((()=>s.getCurrentTab()),[s]),u=(0,n.useCallback)((()=>null==l?void 0:l()),[l]);if(!c)return null;let d;if("connectToSlackDefault"===c.type)d=(0,U.jsx)(Ee,{actionStore:c.actionStore,automationActionMenuStore:s,onClose:u,type:"connectToSlackDefault"});else if("connectToSlackReconnect"===c.type)d=(0,U.jsx)(Ee,{actionStore:c.actionStore,automationActionMenuStore:s,externalBotId:c.externalBotId,notificationActionConfigStore:c.notificationActionConfigStore,onClose:u,type:"connectToSlackReconnect"});else if("selectWorkspace"===c.type)d=(0,U.jsx)(qe.Provider,{value:{menuStore:s},children:(0,U.jsx)(Ge,{actionStore:c.actionStore,automationActionMenuStore:s,onClose:u})});else if("selectChannelNew"===c.type)d=(0,U.jsx)(We,{actionStore:c.actionStore,automationActionMenuStore:s,currentExternalAuthentication:c.currentExternalAuthentication,onClose:u,type:"selectChannelNew"});else if("selectChannelUpdate"===c.type)d=(0,U.jsx)(We,{actionStore:c.actionStore,automationActionMenuStore:s,currentExternalAuthentication:c.currentExternalAuthentication,currentNotificationChannel:c.currentNotificationChannel,onClose:u,type:"selectChannelUpdate"});else if("eventActions"===c.type)d=(0,U.jsx)(ie,{automationActionMenuStore:s,hasUpdateThisPagePropertyActions:c.hasUpdateThisPagePropertyActions,hasSearch:c.hasSearch,onClose:u});else if("eventActionProperty"===c.type){const{propertyId:e,actionId:t}=c;d=(0,U.jsx)(Ce,{actionId:t,automationActionMenuStore:s,onClose:u,propertyId:e})}else"updateThisPageProperties"===c.type?d=(0,U.jsx)(Q,{automationActionMenuStore:s,onClose:u}):(0,a().HB)(c);return(0,U.jsx)(qe.Provider,{value:{menuStore:s},children:d})}qe.displayName="AutomationActionMenuContext"},546461:(e,t,o)=>{o.d(t,{EC:()=>C,To:()=>A,YC:()=>k,or:()=>b,u:()=>S});o(16280);var n=o(296540),i=()=>o(484714),a=()=>o(792485),r=()=>o(56366),l=()=>o(496506),s=()=>o(322867),c=()=>o(959013),u=()=>o(534177),d=()=>o(813297),p=()=>o(862292),m=()=>o(698331),g=()=>o(645873),y=()=>o(190019),h=()=>o(76190),f=o(474848);const v=new WeakMap,x=(0,n.createContext)({automationStore:void 0,contextType:void 0,defined:!1,typecheckResult:void 0});x.displayName="AutomationContext";function S(e){const{automationStore:t,children:o,contextType:n}=e,S=(0,i().v3)(),b=(0,c().tz)(),{value:A}=(0,g().fJ)(p().T.formulas),{value:C}=(0,g().fJ)(d().QV.automationTypecheck),k=(0,h().n)(t),M=(0,a().S)(),j=(0,r().K8)((()=>{if(!A)return{error:new(s().N9)("Missing formulas dependency")};if(!C)return{error:new(s().N9)("Missing automation dependency")};const e=function(e){const{environment:t,automationStore:o,automationTypecheckModule:n,contextType:i,formulasModule:a,intl:r,isSubscribed:s,pageStore:c}=e,d=v.get(o);if(d)return d;{const e=new(l().ComputedStore)((()=>{const e=o.getTriggerType();let l=i;return(0,u().O9)(e)&&(0,m().x2)(e)&&(l=(0,m().H8)(e)),(0,y().Z)({environment:t,automationStore:o,automationTypecheckModule:n,contextType:l,formulasModule:a,intl:r,isSubscribed:s,pageStore:c})}),{debugName:"automationContextTypecheckResultCachedStore"});return v.set(o,e),e}}({environment:S,automationStore:t,automationTypecheckModule:C,contextType:n,formulasModule:A,intl:b,isSubscribed:k,pageStore:"button_block"===n?null==M?void 0:M.pageStore:void 0});return e.state}),[S,t,C,n,A,b,k,null==M?void 0:M.pageStore]);return(0,f.jsx)(x.Provider,{value:{automationStore:t,typecheckResult:j,contextType:n,defined:!0},children:o})}function b(e){const{automationStore:t,children:o}=e,n=(0,r().K8)((()=>{var e;return null===(e=t.getTrigger())||void 0===e?void 0:e.type}),[t]);return(0,f.jsx)(S,{automationStore:t,contextType:(0,m().H8)(n??"event"),children:o})}function A(e){var t;return null===(t=v.get(e))||void 0===t?void 0:t.state}function C(){const e=n.useContext(x);if(!1===e.defined)throw new Error("No automation context found!");return e}function k(){return n.useContext(x)}},546806:(e,t,o)=>{o.d(t,{e:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("chevronDownThin",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M8 11.4795C7.77214 11.4795 7.56478 11.3883 7.37793 11.2061L2.17578 5.88086C2.09831 5.80794 2.03906 5.72591 1.99805 5.63477C1.96159 5.53906 1.94336 5.43652 1.94336 5.32715C1.94336 5.17676 1.97754 5.04004 2.0459 4.91699C2.11882 4.79395 2.21452 4.69824 2.33301 4.62988C2.4515 4.55697 2.58594 4.52051 2.73633 4.52051C2.95508 4.52051 3.14648 4.60254 3.31055 4.7666L8.33496 9.91406H7.67188L12.6895 4.7666C12.8535 4.60254 13.0449 4.52051 13.2637 4.52051C13.4141 4.52051 13.5485 4.55697 13.667 4.62988C13.7855 4.69824 13.8789 4.79395 13.9473 4.91699C14.0202 5.04004 14.0566 5.17676 14.0566 5.32715C14.0566 5.54134 13.9792 5.72591 13.8242 5.88086L8.62207 11.2061C8.53548 11.2972 8.43978 11.3656 8.33496 11.4111C8.23014 11.4567 8.11849 11.4795 8 11.4795Z"})})},551882:(e,t,o)=>{o.d(t,{A:()=>d});o(296540);var n=()=>o(484714),i=()=>o(56366),a=()=>o(959013),r=()=>o(68465),l=()=>o(765957),s=()=>o(411671),c=()=>o(464708),u=o(474848);function d(e){const{message:t}=e,o=(0,n().v3)();return(0,i().K8)((()=>{const e=l().default.state.mainEditorCurrentBlockStore,t=e&&s().A.getMode(o,e);return(0,r().ZE)(t)}),[o])?(0,u.jsx)(c().A,{color:"purple",style:{padding:"1px 4px",display:"inline-flex",flexDirection:"row",alignItems:"center",gap:4,...e.style},content:t??(0,u.jsx)(a().sA,{id:"aiBadgeComponent.label",defaultMessage:"AI"})}):null}},556048:(e,t,o)=>{o.d(t,{C8:()=>p,Dz:()=>s,GC:()=>g,GL:()=>y,YY:()=>m,dM:()=>u,h9:()=>c,jX:()=>l,oF:()=>d,uj:()=>r});var n=()=>o(645873);const i={JiraSyncInfoPopup:new(n().O2)("JiraSyncInfoPopup",(async()=>await Promise.all([o.e(75134),o.e(68744)]).then(o.bind(o,408453)))),ImproveJiraSyncPopup:new(n().O2)("ImproveJiraSyncPopup",(async()=>await Promise.all([o.e(75134),o.e(2686)]).then(o.bind(o,484967)))),JiraDCAuthModal:new(n().O2)("JiraDCAuthModal",(async()=>await o.e(28763).then(o.bind(o,992567)))),ExternalImportAndSyncIndicator:new(n().O2)("ExternalImportAndSyncIndicator",(async()=>await o.e(98288).then(o.bind(o,244399)))),JiraSyncedAllProjectsTooltip:new(n().O2)("JiraSyncedAllProjectsTooltip",(async()=>await o.e(21446).then(o.bind(o,470020)))),JiraSyncedAllIssuesTooltip:new(n().O2)("JiraSyncedAllIssuesTooltip",(async()=>await o.e(21446).then(o.bind(o,470020)))),JiraSyncedDatabaseViewsAndFiltersTooltip:new(n().O2)("JiraSyncedDatabaseViewsAndFiltersTooltip",(async()=>await o.e(21446).then(o.bind(o,470020)))),JiraSyncSourceTooltip:new(n().O2)("JiraSyncSourceTooltip",(async()=>await o.e(21446).then(o.bind(o,470020)))),JiraSyncedSettingsToSetupProjectsAndIssuesTooltip:new(n().O2)("JiraSyncedSettingsToSetupProjectsAndIssuesTooltip",(async()=>await o.e(21446).then(o.bind(o,470020))))},a={JiraSyncTeamSpaceModal:new(n().O2)("JiraSyncTeamSpaceModal",(async()=>Promise.all([o.e(75134),o.e(92845),o.e(84468),o.e(5605),o.e(48486),o.e(95794),o.e(13677),o.e(56952),o.e(25497),o.e(74562),o.e(27711),o.e(30291),o.e(12913),o.e(28464),o.e(6463),o.e(50569),o.e(93449),o.e(56188)]).then(o.bind(o,604698))))},r=(0,n()._h)(a.JiraSyncTeamSpaceModal,(e=>e.default)),l=(0,n()._h)(i.JiraSyncedAllProjectsTooltip,(e=>e.JiraSyncedAllProjectsTooltip)),s=(0,n()._h)(i.JiraDCAuthModal,(e=>e.default)),c=(0,n()._h)(i.JiraSyncedAllIssuesTooltip,(e=>e.JiraSyncedAllIssuesTooltip)),u=(0,n()._h)(i.JiraSyncedDatabaseViewsAndFiltersTooltip,(e=>e.JiraSyncedDatabaseViewsAndFiltersTooltip)),d=(0,n()._h)(i.JiraSyncedSettingsToSetupProjectsAndIssuesTooltip,(e=>e.JiraSyncedSettingsToSetupProjectsAndIssuesTooltip)),p=(0,n()._h)(i.JiraSyncSourceTooltip,(e=>e.JiraSyncSourceTooltip)),m=(0,n()._h)(i.JiraSyncInfoPopup,(e=>e.JiraSyncInfoPopup)),g=(0,n()._h)(i.ImproveJiraSyncPopup,(e=>e.ImproveJiraSyncPopup)),y=(0,n()._h)(i.ExternalImportAndSyncIndicator,(e=>e.ExternalImportAndSyncIndicator));(0,o(340498).xh)("jira",{default:{loader:()=>o.e(60677).then(o.bind(o,460677)),size:20},small:{loader:()=>o.e(60677).then(o.bind(o,460677)),size:16},mini:{loader:()=>o.e(60677).then(o.bind(o,460677)),size:14},large:{loader:()=>o.e(60677).then(o.bind(o,460677)),size:24}})},556927:(e,t,o)=>{o.d(t,{j:()=>n});const n=(0,o(340498).xh)("arrowUpRight",{default:{loader:()=>o.e(43274).then(o.bind(o,443274))},small:{loader:()=>o.e(30720).then(o.bind(o,230720))},mini:{loader:()=>o.e(37972).then(o.bind(o,315591))},large:{loader:()=>o.e(49172).then(o.bind(o,749172))}})},557943:(e,t,o)=>{o.d(t,{s:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"1.56 0.68 12.88 12.7",svg:(0,o(474848).jsx)("path",{d:"M9.8.788a1.65 1.65 0 0 0-2.013.73l-.274.563c-.143.237-.29.53-.427.802v.002l-.103.203c-.178.35-.336.639-.483.833L4.823 5.709H2.914c-.746 0-1.352.605-1.352 1.351v4.181c0 .747.606 1.352 1.352 1.352h2.657l.945.324.01.005h.001c.598.3 1.252.454 1.923.454h3.425a1.594 1.594 0 0 0 1.562-1.912c.432-.286.714-.779.714-1.333 0-.213-.044-.413-.119-.593.251-.278.406-.645.406-1.058a1.56 1.56 0 0 0-.284-.901c.12-.218.19-.47.19-.742 0-.88-.713-1.593-1.593-1.593H9.94q.05-.106.11-.225l.002-.004c.11-.222.243-.491.338-.817v-.002l.403-1.41A1.65 1.65 0 0 0 9.808.791zM8.623 2.655l.27-.556a.4.4 0 0 1 .464-.141.4.4 0 0 1 .235.483L9.19 3.85a3.5 3.5 0 0 1-.26.612l-.011.025c-.106.214-.236.475-.33.787a.946.946 0 0 0 .907 1.219h3.255c.19 0 .344.154.344.343 0 .1-.052.198-.157.266a.625.625 0 0 0 .066 1.087.32.32 0 0 1 .184.29.33.33 0 0 1-.231.317.625.625 0 0 0-.192 1.073.34.34 0 0 1 .136.261.34.34 0 0 1-.336.344.625.625 0 0 0-.452 1.057.344.344 0 0 1-.238.594H8.45c-.45 0-.886-.097-1.29-.286a.6.6 0 0 0-.151-.076l-1.131-.387a.6.6 0 0 0-.203-.034h-.006V6.634l1.764-1.88.037-.043c.236-.302.449-.705.627-1.057l.117-.232a10 10 0 0 1 .41-.767M2.812 7.06c0-.056.046-.101.102-.101H4.52v4.384H2.914a.1.1 0 0 1-.102-.102z"})},i=(0,o(340498).wt)("handThumbsUpSmall",n)},559419:(e,t,o)=>{o.d(t,{c:()=>i});var n=o(296540);function i(){const[e,t]=(0,n.useState)(void 0),o=(0,n.useCallback)((e=>t(e.id)),[]),i=(0,n.useCallback)((()=>t(void 0)),[]);return(0,n.useMemo)((()=>({currentDraggingActionId:e,onActionDragStart:o,onActionDragEnd:i})),[e,i,o])}},566081:(e,t,o)=>{o.d(t,{A:()=>V});var n=o(296540),i=()=>o(56366),a=()=>o(728611),r=()=>o(908006),l=()=>o(725614),s=()=>o(685889),c=()=>o(704152),u=()=>o(16006),d=o(474848);function p(e){const{blockStore:t,titleStyle:o,shouldWrap:i,recordTitleRef:a,disableTooltip:p}=e,m=(0,n.useRef)({getNode:()=>a.current}),g=(0,n.useCallback)((e=>{r().default.afterNextFlush((()=>{const e=t.getBlockTitleStore();if(!e)return;const o=e.getValue(),n=o?o[0][0].length:0,i={start:{index:n,store:e},end:{index:n,store:e}};l().setMultiSelection({multiSelection:i})}))}),[t]);return(0,d.jsx)(c().A,{style:{height:s().d0+2,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:5,padding:"6px 8px 7px 8px",overflow:"hidden"},onClick:g,children:(0,d.jsx)(u().A,{store:t,underline:!0,shouldWrap:i,style:o,ref:m,disableTooltip:p})})}var m=()=>o(959013),g=()=>o(496603),y=()=>o(792540),h=()=>o(972435),f=()=>o(524702);const v=(0,m().YK)({typeTitle:{defaultMessage:"Type a title...",id:"relationToken.title.placeholder"}});function x(e){const{blockStore:t,clickTitleBehavior:o,onTitleEnter:n,onTitleEsc:a}=e,r="edit"===o,l=(0,i().K8)((()=>t.getBlockTitleStore()),[t]);return(0,d.jsx)(f().A,{store:l,disabled:!r,disableSlashCommands:!0,disableEmojiCommands:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableEmbedMenu:!0,onEnter:n,onEsc:a,onTab:g().D_,placeholder:h().A.formatMessage(v.typeTitle),style:{padding:"6px 8px 7px 8px",textOverflow:"none",overflow:"visible",whiteSpace:"pre"},disableSelectAllBlocks:!0,pasteBehavior:"inline",inPageFind:y().Os.none})}var S=()=>o(484714),b=()=>o(919709),A=()=>o(319975);const C=function(e){const{store:t,style:r,disableLinks:l,disableHover:s,isAndroid:c,externalIntegrations:u,canEdit:p,shouldWrap:g,tokenFormat:y}=e,h=(0,n.useRef)(null),f=(0,m().tz)(),v=(0,S().v3)(),x=(0,o(401497).DP)(),{isExternalIntegrationPageType:C,blockType:k,blockId:M,blockModel:j}=(0,i().K8)((()=>{const e=t.getModel();return{isExternalIntegrationPageType:Boolean(null==e?void 0:e.isType(o(700500).xd.externalObjectInstancePage)),blockType:t.getType(),blockId:t.id,blockModel:e}}),[t]),T=(0,i().K8)((()=>o(267419).A.getState()),[]),I=(0,n.useCallback)((()=>{if(!h||!h.current)return;const e=(0,b().bMp)(t.id),o=(0,b().wmz)(e);return{textValue:[o],tokenIndex:0,textToken:o,node:h.current}}),[h,t.id]),w=(0,n.useCallback)((e=>{if(s)return;const o=I(),n=t.getTitleStore();n&&o&&A().xE({environment:v,event:e,interactiveToken:o,store:n,canEdit:p})}),[s,I,t,v,p]),P=(0,n.useCallback)((e=>{const o=I(),n=t.getTitleStore();n&&o&&!s&&A().HH({environment:v,event:e,interactiveToken:o,store:n,canEdit:p})}),[I,t,s,v,p]),_=t.getRecordModel,B=M,R=(0,o(712030).FN)(v),V=o(780054).A.domainBaseUrl,E=v.currentUser.id,D=!l,F=(0,i().K8)((()=>{if(j)return(0,o(191772).gA)({blockModel:j,shouldWrap:g,index:0,style:r,disableHover:s,disableLinks:l,isAndroid:c,theme:x,getRecordModel:_,currentUserId:E,baseUrl:V,emojiType:R,externalIntegrations:u,classNames:[],intl:f,emojiData:T,stopLinkPropagation:D,tokenFormat:(0,o(425497).Ug)(y)})}),[j,g,r,s,l,c,x,_,E,V,R,u,f,T,D,y]);return B?"external_object_instance_page"!==k?null:C?(0,d.jsx)("span",{ref:h,onMouseOver:w,onMouseOut:P,onClick:D?a().kV:void 0,style:{width:"100%"},children:F}):null:null};function k(e){const{blockStore:t,shouldWrap:n,style:a,disableLinks:r,format:l}=e,s=(0,i().K8)((()=>(0,o(939768).q7)(t.getSyncedUri())),[t]),c=(0,i().O$)(o(53137).A.integrations),u=(0,S().v3)();return(0,d.jsx)(C,{shouldWrap:n,store:t,style:a,disableHover:r||!s,disableLinks:r||!s,isAndroid:u.device.isAndroid,externalIntegrations:c,canEdit:!0,tokenFormat:l})}var M=()=>o(738865);function j(e){const{format:t,showRemoveButton:n,onClickRemove:i}=e,{height:a,closeIconSize:r}=M().U[t];return n?(0,d.jsx)(c().A,{onClick:i,style:{display:"flex",alignItems:"center",justifyContent:"center",width:a,height:a,marginLeft:2,marginRight:2,flexGrow:0,flexShrink:0,borderRadius:4},children:(0,o(65767).l)({width:r,height:r,opacity:.5})}):null}var T=()=>o(584262),I=()=>o(519839),w=()=>o(175116),P=()=>o(492414),_=()=>o(765957);var B=()=>o(231722),R=()=>o(24157);const V=(0,n.forwardRef)((function(e,t){const{parentStore:a,blockId:r,shouldWrap:l,format:s,showRemoveButton:c,clickTitleBehavior:u,onClickRemove:p,titleStyle:m,onTitleEnter:g,onTitleEsc:y,index:h,noUnderline:f,disableTooltip:v,disableLinks:x}=e,S=o(630116).Bv.createChildStore(a,{table:o(179034).ev,id:r}),{style:b}=(0,M().t)(e),A=(0,n.useRef)(null),C=(0,n.useRef)(null),T="peek"===u;(0,n.useImperativeHandle)(t,(()=>S),[S]);const I=(0,i().K8)((()=>"external_object_instance_page"===S.getType()),[S]);if((0,o(571468).W)(S))return null;if(I)return(0,d.jsx)(k,{shouldWrap:l,blockStore:S,style:b,disableLinks:x,format:s});const w=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(o(124954).w,{format:s,blockStore:S,clickTitleBehavior:u,shouldWrap:l}),(0,d.jsx)(D,{blockStore:S,recordTitleRef:A,clickTitleBehavior:u,shouldWrap:l,titleStyle:m,noUnderline:f,onTitleEnter:g,onTitleEsc:y,index:h,disableTooltip:v})]});return(0,d.jsxs)("div",{style:b,ref:C,children:[T?(0,d.jsx)(E,{blockStore:S,relationTokenStyle:b,children:w}):w,(0,d.jsx)(j,{showRemoveButton:c,onClickRemove:p,format:s})]})}));function E(e){let{blockStore:t,relationTokenStyle:r,children:l}=e;const{blockUrlPage:s,blockUrlPeek:c}=function(e){const t=(0,S().v3)(),o=(0,w().Ks)(),n=(0,i().K8)((()=>(0,P().Ay)({store:e,fullyQualified:!1,pageVisitSource:T().y8.LinkInPage})),[e]);return{blockUrlPeek:(0,i().K8)((()=>{const{mainEditorCurrentBlockStore:n}=_().default.state;return I().wy({environment:t,store:e,mainEditorCurrentBlockStore:n,collectionContextStore:o,fullyQualified:!1})}),[t,e,o]),blockUrlPage:n}}(t),u=(0,n.useMemo)((()=>({display:r.display,height:r.height,alignItems:r.alignItems})),[r]);return(0,d.jsx)(o(187485).A,{href:s,metaHref:c,onClick:a().kV,style:u,children:l})}function D(e){const{blockStore:t,clickTitleBehavior:n,onTitleEnter:a,onTitleEsc:r,index:l,recordTitleRef:s,titleStyle:c,shouldWrap:u,noUnderline:m,disableTooltip:g}=e,y=(0,o(551619).Sm)(t),h="edit"===n&&!y,f=function(e){return(0,i().K8)((()=>{var t;const o=R().default.state;return"editing"===o.mode&&(null===(t=(0,B().H7)(o.multiSelection))||void 0===t?void 0:t.store)===e.getBlockTitleStore()}),[e])}(t);return h?f&&a&&l?(0,d.jsx)(x,{blockStore:t,clickTitleBehavior:n,onTitleEnter:a,onTitleEsc:r}):(0,d.jsx)(p,{blockStore:t,recordTitleRef:s,titleStyle:c,shouldWrap:u,disableTooltip:g}):(0,d.jsx)(o(279620).Y,{blockStore:t,recordTitleRef:s,titleStyle:c,shouldWrap:u,noUnderline:m,disableTooltip:g})}},571468:(e,t,o)=>{o.d(t,{W:()=>a,X:()=>i});var n=()=>o(56366);function i(e){return e.isReady()&&!e.isDefined()&&"none"!==e.getRole()}function a(e){return(0,n().K8)((()=>i(e)),[e])}},580648:(e,t,o)=>{o.d(t,{o:()=>c});o(296540);var n=()=>o(56366),i=()=>o(959013),a=()=>o(698449),r=()=>o(173783),l=()=>o(187820),s=o(474848);function c(e){const{group:t}=e,o=e.size??20,c=(0,i().tz)(),u=(0,n().K8)((()=>{if(t.icon)return{pointer:t.pointer,icon:t.icon}}),[t]),d=(0,n().K8)((()=>null==t?void 0:t.getName()),[t]);return(0,s.jsx)("div",{children:u?(0,s.jsx)(l().B6,{disabled:!0,size:o,icon:u,isEmptyPage:!1,title:(0,a().Pf)({intl:c,groupName:d})}):(0,s.jsx)(r().A,{size:o})})}},585293:(e,t,o)=>{o.d(t,{a:()=>a});var n=o(296540),i=o(474848);const a=n.forwardRef(((e,t)=>{const n=(0,o(401497).IS)((t=>({buttonStyle:{paddingLeft:8,paddingRight:8,paddingTop:2,paddingBottom:2,width:"100%",marginLeft:0,background:"transparent",...e.buttonStyle},menuItemStyle:{gap:6,background:"transparent",...e.style},innerContainer:{marginLeft:0,paddingLeft:0,minWidth:"auto",color:e.disabled?t.text.secondary:void 0,background:"transparent"},desktopIconStyle:{margin:0},rightStyle:{display:"flex",alignItems:"center",gap:6,color:t.text.secondary,margin:0,...e.rightStyle}})),[e.disabled,e.rightStyle,e.buttonStyle,e.style]);return(0,i.jsx)(o(760217).A,{role:"button",...e,ref:t,style:n.menuItemStyle,buttonStyle:n.buttonStyle,textWrapperStyle:n.innerContainer,desktopIconStyle:n.desktopIconStyle,rightStyle:n.rightStyle})}));a.displayName="SiteSettingButtonMenuItem"},612900:(e,t,o)=>{o.d(t,{u:()=>a});var n=()=>o(645873);const i=new(n().O2)("PulsingWrapper",(async()=>o.e(45248).then(o.bind(o,673962)))),a=(0,n().jQ)(i,(e=>e.PulsingWrapper),{renderLoading:(e,t)=>t.children})},614415:(e,t,o)=>{o.d(t,{Wx:()=>a,fM:()=>n,sM:()=>i});const n=new(o(645873).O2)("framer-motion",(async()=>await Promise.all([o.e(44711),o.e(53321),o.e(37043)]).then(o.bind(o,301716))));function i(e){return e.useAnimation()}function a(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return e.useInView(...o)}},616175:(e,t,o)=>{o.d(t,{M:()=>g,z:()=>y});o(296540);var n=()=>o(484714),i=()=>o(56366),a=()=>o(401497),r=()=>o(693954),l=()=>o(959013),s=()=>o(284371),c=()=>o(84817),u=()=>o(554509),d=()=>o(521732),p=()=>o(938818),m=o(474848);function g(e){const{analyzedFormulaOutput:t,labelMessageDescriptor:o,isOptional:g,errorMessageDescriptor:h}=e,f=(0,l().tz)(),v=(0,i().K8)((()=>(0,p().L)(f,null==t?void 0:t.parseErrors,null==t?void 0:t.typeErrors)),[t,f]),{isMobile:x}=(0,n().Y0)(),S=(0,a().IS)((e=>({inputLabel:{display:"flex",alignItems:"center",color:e.text.secondary,fontSize:x?s().J.UIRegular.mobile:s().J.UIRegular.desktop,lineHeight:x?s().K_.UIRegular.mobile:s().K_.UIRegular.desktop,fontWeight:s().Wy.regular},messageInput:{width:"100%"},warningIcon:{color:e.errorText,fill:e.errorText,height:12,flex:"0 0 auto",width:12,display:"flex",marginRight:4},inputLabelInner:{flex:"1 1 auto",...(h||v)&&{color:e.text.uiRedPrimary,fontWeight:s().Wy.medium}},warningError:{color:e.text.uiRedPrimary}})),[h,v,x]);return(0,m.jsxs)(c().Y1,{direction:"vertical",gap:6,children:[(0,m.jsxs)("label",{style:S.inputLabel,children:[v&&(0,r().Q)(S.warningIcon),(0,m.jsxs)("div",{style:S.inputLabelInner,children:[(0,m.jsx)(l().sA,{...o}),g&&(0,m.jsx)(y,{})]})]}),(0,m.jsxs)(c().Y1,{direction:"vertical",gap:6,children:[(0,m.jsx)(d().Y,{...e,style:S.messageInput,shouldShowErrorStyles:Boolean(v)||e.shouldShowErrorStyles}),v&&(0,m.jsx)(p().J,{analyzedFormulaOutput:t}),!v&&h&&(0,m.jsx)(u().D,{colorName:"secondary",styleName:"UISmall-12px/Regular",style:S.warningError,children:(0,m.jsx)(l().sA,{...h})})]})]})}function y(){const e=(0,a().IS)((e=>({optionalLabel:{color:e.text.tertiary,marginLeft:4}})),[]);return(0,m.jsx)("span",{style:e.optionalLabel,children:(0,m.jsx)(l().sA,{defaultMessage:"{openParenthesis}Optional{closeParenthesis}",id:"automations.SimpleFormulaTextInputWithError.optionalLabel",values:{openParenthesis:"(",closeParenthesis:")"}})})}},636740:(e,t,o)=>{function n(e){const{dateRangeStart:t,dateRangeEnd:o,collectionContextStore:n}=e;n.dateRangeStartStore.setState(t),n.dateRangeEndStore.setState(o)}o.d(t,{r:()=>n})},642054:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("addPage",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 0c3.861 0 7 3.139 7 7s-3.139 7-7 7-7-3.139-7-7 3.139-7 7-7zM3.561 5.295a1.027 1.027 0 1 0 2.054 0 1.027 1.027 0 0 0-2.054 0zm5.557 1.027a1.027 1.027 0 1 1 0-2.054 1.027 1.027 0 0 1 0 2.054zm1.211 2.816a.77.77 0 0 0-.124-1.087.786.786 0 0 0-1.098.107c-.273.407-1.16.958-2.254.958-1.093 0-1.981-.55-2.244-.945a.788.788 0 0 0-1.107-.135.786.786 0 0 0-.126 1.101c.55.734 1.81 1.542 3.477 1.542 1.668 0 2.848-.755 3.476-1.541z"})})},644484:(e,t,o)=>{o.d(t,{g:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("addPerson",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M9.48242 7.91211C10.8076 7.91211 11.8352 6.77783 11.8352 5.35718C11.8352 4.00391 10.7908 2.84717 9.48242 2.84717C8.17407 2.84717 7.12964 4.00952 7.13525 5.36279C7.14087 6.77783 8.16284 7.91211 9.48242 7.91211ZM9.48242 8.87231C8.7356 8.87231 8.04492 8.99585 7.44409 9.22046C8.23022 9.95044 8.72437 10.9836 8.72437 12.1235C8.72437 12.511 8.66821 12.8872 8.55591 13.2466H12.8684C13.969 13.2466 14.3171 12.8479 14.3171 12.2302C14.3171 10.804 12.3967 8.87231 9.48242 8.87231ZM4.74316 15.1895C6.42212 15.1895 7.80347 13.7969 7.80347 12.1235C7.80347 10.4558 6.42212 9.06885 4.74316 9.06885C3.06982 9.06885 1.68286 10.4558 1.68286 12.1235C1.68286 13.7969 3.06982 15.1895 4.74316 15.1895ZM4.74316 14.1675C4.41187 14.1675 4.18726 13.9429 4.18726 13.6172V12.6907H3.27197C2.94629 12.6907 2.72168 12.4661 2.71606 12.1292C2.71045 11.7979 2.93506 11.5732 3.27197 11.5732H4.18726V10.6636C4.18726 10.3379 4.41187 10.1133 4.74316 10.1077C5.08008 10.1021 5.30469 10.3267 5.30469 10.6636V11.5732H6.22559C6.55127 11.5732 6.77588 11.7979 6.77588 12.1292C6.77588 12.4661 6.55127 12.6907 6.22559 12.6907H5.30469V13.6172C5.30469 13.9429 5.08008 14.1675 4.74316 14.1675Z"})})},654734:(e,t,o)=>{o.d(t,{A:()=>c});var n=o(296540),i=()=>o(597777),a=()=>o(869190),r=()=>o(604995),l=()=>o(416504),s=o(474848);const c=function(e){const t=(0,o(959013).tz)(),c=(0,o(401497).DP)(),p=(0,o(396182).I)(),m=(0,n.useRef)(),g=(0,n.useCallback)((()=>{const t=e.value;if(!t)return;const n=r().q8(t,(0,l().P)());if(!n)return;const i=n.valueOf(),a=i-Date.now();a<0||a>o(720665).nD||m.current&&m.current.timestamp===i||(m.current&&clearTimeout(m.current.timer),m.current={timestamp:i,timer:setTimeout((()=>p("DateBox","DateBox/createReminderTimer")),a)})}),[p,e.value]),y=(0,n.useCallback)((()=>{m.current&&(clearTimeout(m.current.timer),m.current=void 0)}),[]);(0,n.useEffect)((()=>{g()}),[g]),(0,n.useEffect)((()=>()=>{y()}),[y]);const{value:h,withComma:f}=e,v=(0,o(56366).K8)((()=>h?(0,a().ZF)({value:h,date_format:e.dateFormat,time_format:e.timeFormat,userTimeZone:(0,l().P)(),allowRelativeDates:!0,intl:t,shortenDateAndRange:e.shortenDateAndRange,displayInUserTimezone:e.displayInUserTimezone,getToday:o(838924).x1}):void 0),[t,e.dateFormat,e.displayInUserTimezone,e.shortenDateAndRange,e.timeFormat,h]);if(!h)return null;const x=r().AA(h,(0,l().P)(),o(662303).locale);let S;if((0,i().Lh)(h)){const e=r().Zs(h,(0,l().P)());S=e?{color:c.errorText}:{color:o(381349).Ay.blue}}const b=(0,s.jsxs)(s.Fragment,{children:[v,(0,i().Lh)(h)&&(0,o(599987).P)({display:"inline-block",width:"1em",marginLeft:6,marginRight:2,paddingBottom:4,verticalAlign:"middle"}),f?", ":null]});return e.disableTooltip?(0,s.jsx)("div",{className:e.className,style:{...e.style,...S},children:b}):(0,s.jsx)(o(859428).A,{renderTooltip:()=>(0,s.jsxs)(s.Fragment,{children:[e.tooltipHeader,(0,s.jsxs)("div",{style:d(c,e.tooltipHeader),children:[u(x.start),x.end?` â†’ ${u(x.end)}`:""]})]}),render:t=>(0,s.jsx)("div",{className:e.className,style:{...e.style,...S},...t,children:b}),placement:e.tooltipPlacement})};function u(e){return(0,a().eV)({value:e,preset:"medium"})}function d(e,t){return t?{color:e.text.contrastSecondary}:{}}},655923:(e,t,o)=>{o.d(t,{v:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.97 2.37 12.06 15.26",svg:(0,o(474848).jsx)("path",{d:"M10.625 3a.625.625 0 1 0-1.25 0v12.491l-4.333-4.333a.625.625 0 1 0-.884.884l5.4 5.4a.62.62 0 0 0 .884 0l5.4-5.4a.625.625 0 0 0-.884-.884l-4.333 4.333z"})},i=(0,o(340498).wt)("arrowStraightDown",n)},656134:(e,t,o)=>{o.d(t,{j:()=>r});var n=()=>o(484714),i=()=>o(56366),a=()=>o(897119);function r(e){const t=(0,n().Y0)();return(0,i().K8)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?a().nl.SlideUp:a().nl.Popup),[t,null==e?void 0:e.tabletBehavior])}},656476:(e,t,o)=>{o.d(t,{rD:()=>v,zH:()=>f});var n=o(296540),i=()=>o(401497),a=()=>o(791089),r=()=>o(834368),l=()=>o(486521),s=()=>o(263178),c=()=>o(959013),u=()=>o(284371),d=()=>o(340743),p=()=>o(214973),m=()=>o(741310),g=()=>o(929531),y=()=>o(16707),h=o(474848);function f(e){const{actionMenu:t,buttonPopupStore:o,disabled:f,onClick:x,propertySchema:S,value:b}=e,A=(0,i().IS)((()=>({content:{alignItems:"center",display:"flex"},propertyName:{...u().RC,fontWeight:u().Wy.medium}})),[]),C=function(e){const{propertySchema:t,styles:o,value:n}=e,i=(0,h.jsx)("span",{style:o.propertyName,children:t.name});let s;const u="formula"===(null==n?void 0:n.type);if(u)s=(0,h.jsx)(y().g,{returnType:{type:"checkbox"}});else{const e=(0,a().fromSimpleFormulaArrayValue)(null==n?void 0:n.value)[0],t=!0===e?(0,l().v)({width:12}):(0,r().K)({width:10});s=(0,h.jsx)(d().G,{icon:t,shouldTruncateChildren:!0,children:!0===e?(0,h.jsx)(c().sA,{...p().CV.actionCheckboxPropertyChecked}):(0,h.jsx)(c().sA,{...p().CV.actionCheckboxPropertyUnchecked})})}return(0,h.jsx)(c().sA,{...p().Xr({propertyName:i,propertyValue:s})})}({propertySchema:S,styles:A,value:b}),k=v({propertySchema:S,value:b}),M=(0,n.useCallback)((e=>(0,h.jsx)(g().aX,{...e,actionMenu:t,buttonPopupStore:o,disabled:f,icon:s().S,onClick:x,children:(0,h.jsx)("div",{style:A.content,children:C})})),[t,o,f,x,A.content,C]);return(0,h.jsx)(m().P,{renderOrigin:M,title:k})}function v(e){const{propertySchema:t,value:o}=e;let n;if("formula"===(null==o?void 0:o.type))n=(0,h.jsx)(y().L,{});else{n=!0===(0,a().fromSimpleFormulaArrayValue)(null==o?void 0:o.value)[0]?(0,h.jsx)(c().sA,{...p().CV.actionCheckboxPropertyChecked}):(0,h.jsx)(c().sA,{...p().CV.actionCheckboxPropertyUnchecked})}return(0,h.jsx)(c().sA,{...p().Xr({propertyName:t.name,propertyValue:n})})}},658985:(e,t,o)=>{o.d(t,{$:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("membersFilled",{viewBox:"0 0 30 30",svg:(0,n.jsx)("path",{d:"M20.31 14.731c2.22 0 4.097-1.967 4.097-4.513 0-2.485-1.887-4.391-4.098-4.391-2.2 0-4.097 1.937-4.087 4.411 0 2.526 1.866 4.493 4.087 4.493zm-11.725.233c1.937 0 3.57-1.724 3.57-3.935 0-2.17-1.653-3.823-3.57-3.823-1.917 0-3.57 1.683-3.56 3.844 0 2.19 1.633 3.914 3.56 3.914zm-5.588 9.21h7.606c-1.085-1.552.082-4.615 2.374-6.42-1.116-.72-2.566-1.248-4.392-1.248-4.533 0-7.464 3.337-7.464 6.085 0 1.004.507 1.582 1.876 1.582zm10.994-.01h12.637c1.673 0 2.251-.508 2.251-1.44 0-2.607-3.316-6.198-8.57-6.198-5.263 0-8.57 3.59-8.57 6.197 0 .933.578 1.44 2.252 1.44z"})})},678350:(e,t,o)=>{o.d(t,{U:()=>A});o(296540);var n=()=>o(484714),i=()=>o(56366),a=()=>o(401497),r=()=>o(791089),l=()=>o(284371),s=()=>o(548526),c=()=>o(463830),u=()=>o(406699),d=()=>o(897119),p=()=>o(999638),m=()=>o(413194),g=(o(581454),()=>o(959013)),y=()=>o(534177),h=()=>o(905209),f=()=>o(419830),v=()=>o(742971),x=o(474848);function S(e){const{context:t,currentSimpleFormulaValueTokens:o,disabled:n,formulaTypecheckContextValues:i,parentRecordStore:r,placeholder:l,spaceId:s,type:c,value:u}=e,d=(0,a().IS)((()=>({tokenWrap:{display:"flex",alignItems:"center",flexGrow:1,overflow:"hidden",marginTop:6}})),[]),p=(0,f().pg)(t);if("formula"===(null==u?void 0:u.type)&&u.value)return(0,x.jsx)(h().$,{formulaTypecheckContextValues:i??[],parentRecordStore:r,spaceId:s,value:u});if("text"===c.type||"number"===c.type)return null;if("date"===c.type||"select"===c.type||"checkbox"===c.type){const e=o[0];return void 0===e?(0,x.jsx)(b,{placeholder:l}):(0,x.jsx)("div",{style:d.tokenWrap,children:(0,x.jsx)(m().g,{token:e,parentRecordStore:r,disabled:n,currentSimpleFormulaValueTokens:o,context:t})})}return"person_array"===c.type||"block_array"===c.type||"select_array"===c.type?0===o.length?(0,x.jsx)(b,{placeholder:l}):(0,x.jsx)("div",{style:d.tokenWrap,children:p(o,"first").map(((e,i)=>(0,x.jsx)(m().g,{token:e,parentRecordStore:r,disabled:n,currentSimpleFormulaValueTokens:o,context:t},i)))}):void(0,y().HB)(c)}function b(e){const{placeholder:t}=e,o=(0,a().IS)((e=>({placeholderText:{color:e.text.tertiary}})),[]);return(0,x.jsx)("div",{style:o.placeholderText,children:t?(0,x.jsx)(g().sA,{defaultMessage:"{placeholder}",values:{placeholder:t},id:"formulas.SimpleFormulaValuePicker.people.customPlaceholder"}):(0,x.jsx)(g().sA,{...v().D.personSelect})})}function A(e){const{allowedReturnTypes:t,disabled:o,disableEmojiCommands:g,disableFormattingAndMentions:y,disableMobileActionBar:h,errorMessage:f,formulaTypecheckContextValues:v,limit:b,menuProps:A,onChange:C,parentRecordStore:k,placeholder:M,showClearButton:j,showInputMenuItem:T,simpleFormulaContext:I,spaceId:w,style:P,type:_,value:B}=e,R=(0,n().Y0)(),V=!B||"simple"===B.type,E=(0,i().K8)((()=>(0,r().fromSimpleFormulaArrayValue)(null==B?void 0:B.value)),[B]),D=(0,a().IS)((e=>({button:{boxShadow:e.inputBoxShadow,flexGrow:1,flexShrink:1,fontSize:"inherit",fontWeight:l().Wy.regular,...P}})),[P]),F=(0,i().uB)(void 0,c().A);return(0,x.jsx)(u().Ay,{alignmentToOrigin:u().yP.End,buttonPopupStore:F,disabled:o,originGap:0,placementToOrigin:u().sx.Bottom,popupType:R.isMobile?d().nl.SlideUp:d().nl.Popup,renderOrigin:e=>(0,x.jsx)(s().x,{...e,disabled:o,hasActionRequired:!Boolean(E.length>0),isError:Boolean(f),style:D.button,tooltipMessage:f,dropdownButtonType:"button",children:(0,x.jsx)(S,{currentSimpleFormulaValueTokens:E,context:I,disabled:!0,formulaTypecheckContextValues:v,parentRecordStore:k,placeholder:M,spaceId:w,type:_,value:B})}),render:e=>V?(0,x.jsx)(m().L,{currentSimpleFormulaValueTokens:E,disableEmojiCommands:g,disableFormattingAndMentions:y,disableMobileActionBar:h,formulaTypecheckContextValues:v,formulaValueContext:I,limit:b,menuProps:A,onChange:C,onClose:e.close,parentRecordStore:k,showClearButton:j,showInputMenuItem:T,type:_,value:B}):(0,x.jsx)(p().A,{allowedReturnTypes:t,disabled:o,formulaTypecheckContextValues:v,onChange:C,onClose:e.close,parentRecordStore:k,restrictUnaccessibleProperties:"cross_space_and_read_permissions",spaceId:w,value:B})})}},686169:(e,t,o)=>{o.d(t,{w:()=>Ce,J:()=>ke});var n=o(296540),i=()=>o(56366),a=()=>o(977345),r=()=>o(546461),l=(o(16280),o(898992),o(354520),()=>o(484714)),s=()=>o(401497),c=()=>o(81768),u=()=>o(310109),d=()=>o(289915),p=()=>o(329199),m=()=>o(784892),g=()=>o(959013),y=()=>o(534177),h=()=>o(284371),f=()=>o(246826),v=()=>o(751156),x=()=>o(2220),S=()=>o(895876),b=()=>o(406699),A=()=>o(16006),C=()=>o(684125),k=()=>o(175116),M=()=>o(726483),j=()=>o(463830),T=()=>o(630116),I=()=>o(653417),w=()=>o(252463),P=()=>o(366360),_=()=>o(133518),B=()=>o(656134),R=()=>o(475679),V=()=>o(95199),E=()=>o(548526),D=()=>o(194373),F=()=>o(929531),O=()=>o(497222),L=()=>o(870988),K=()=>o(44935),N=()=>o(928600),W=()=>o(89924),z=()=>o(781697),H=o(474848);function U(e){const{filter:t,onChange:o,onClose:a,collectionStore:r}=e,l=(0,k().Ks)(),s=(0,i().K8)((()=>r.getSchema()),[r]),c=(0,z().e)({minWidth:300,tabletBehavior:"actionSheet"}),u=(0,n.useCallback)(((e,t)=>o(t)),[o]),p=(0,n.useCallback)((()=>{o(void 0),a()}),[o,a]);return(0,H.jsxs)(N().A,{...c,children:[(0,H.jsx)(K().i,{children:(0,H.jsx)(L().tY,{collectionViewId:"Automation.FilterMenu",collectionContextStore:l,collectionViewType:"table",combinatorFilter:t||d().AY,index:0,level:0,onChange:u,parentStore:r,schema:s})}),(0,H.jsx)(W().A,{topBorder:!0,children:(0,H.jsx)(O().A,{title:(0,H.jsx)(g().sA,{defaultMessage:"Delete filter",id:"automations.AutomationCombinatorFilterPopup.deleteFilter.label"}),onClick:p})})]})}const Y=(0,g().YK)({multipleTargetsFilter:{defaultMessage:"<span>Edit </span>{filterPicker}",id:"automations.UpdatePagesAction.multipleTargetsFilter"},multipleTargetsPicker:{defaultMessage:"<span>in </span>{targetPicker}",id:"automations.UpdatePagesAction.multipleTargetsPicker"},singleTarget:{defaultMessage:"<span>Edit </span>{targetPicker}",id:"automations.UpdatePagesAction.singleTarget"}});function G(e){const{actionStore:t}=e,o=(0,l().v3)(),{automationStore:a,typecheckResult:s}=(0,r().EC)(),{disabled:d,suppressActionErrors:m}=(0,P().b)(),h=(0,i().K8)((()=>t.getTargetStore()),[t]),x=(0,i().K8)((()=>a.isTriggerType("button")),[a]),S=(0,k().Ks)(),b=(0,i().K8)((()=>Z(t,(0,u().getAllContextValues)(s))),[t,s]),A=(0,i().K8)((()=>{var e;const o=t.getCollectionTargetStore(),n=null==o||null===(e=o.getKeyStore("filter"))||void 0===e?void 0:e.getValue();if(n)return(0,p().SK)(n,(null==b?void 0:b.getSchema())||{})}),[t,b]),C=(0,i().K8)((()=>{const e=t.getVariableTargetStore();if(e)return e.getValue();const o=t.getCollectionTargetStore();if(o){const e=o.getKeyStore("collection").getValue();if(e)return{collection:e,type:"collection"}}}),[t]),T=(0,i().K8)((()=>{if(!C||"variable"!==C.type)return!1;const e=(0,u().getContextValueForActionById)(s,t.id,C.id),o=null==e?void 0:e.type;return!!o&&("block"===o.type||"array"===o.type&&"block"===o.of.type)}),[t.id,C,s]),_=(0,i().uB)(void 0,j().A),B=(0,n.useCallback)((()=>_.reset()),[_]),E=(0,n.useMemo)((()=>(0,H.jsx)(R().z,{actionStore:t,closeMenu:B})),[t,B]),D=(0,n.useMemo)((()=>!m.includes(t.id)),[m,t]),O=(0,i().K8)((()=>{if(b)return D&&!(0,M().bI)({actionStore:t,collectionStore:b,typecheckResult:s})?(0,H.jsx)(g().sA,{...I().automationErrorMessages.actionIncompleteErrorMessage}):void 0}),[t,b,D,s]),{errorMessage:L,errorIcon:K}=(0,I().useErrorComponentForAction)({actionId:t.id,shouldShow:D,errorKeys:["target","collection","block"]}),{errorMessage:N,errorIcon:W}=(0,I().useErrorComponentForAction)({actionId:t.id,errorKey:"filter",shouldShow:D}),z=(0,i().K8)((()=>(0,y().O9)(t.getConfigStore().getKeyStore("target").getValue())),[t]),U=(0,n.useCallback)((e=>{v().createAndCommit({userAction:"UpdatePagesAction.filterChange",environment:o,canUndo:!0,perform:t=>{f().zv({data:{filter:e},store:h,transaction:t})}}),(0,w().UB)(o,{automationStore:a,automationActionStore:t})}),[t,a,o,h]),Y=(0,n.useCallback)((e=>{let n;if("collection"===e.type)n="UpdatePageAction.updateCollection";else if("variable"===e.type)n="UpdatePageAction.updateVariable";else{if("page"===e.type||"property"===e.type||"formula"===e.type||"url"===e.type)throw new Error("Not implemented yet.");(0,y().HB)(e)}v().createAndCommit({userAction:n,environment:o,canUndo:!0,perform:o=>{f().zv({data:{properties:null,target:e,values:null},store:t.getConfigStore(),transaction:o})}}),(0,w().UB)(o,{automationStore:a,automationActionStore:t})}),[o,a,t]),G=Boolean(d),J=(0,c().getActionRegistryItem)("update_pages");return(0,H.jsx)(k().RI,{value:x?void 0:S,children:(0,H.jsxs)(F().OT,{actionMenu:E,buttonPopupStore:_,disabled:G,actionId:t.id,canCollapse:z,children:[(0,H.jsx)(F().h3,{actionId:t.id,actionRegistryItem:J,disabled:G,styles:{headerWrap:{paddingRight:32},titleWrap:{display:"grid",gridTemplateColumns:"auto 1fr"}},errorMessage:L||N||O,children:T||!b?(0,H.jsx)(q,{actionStore:t,disabled:G,errorMessage:L,errorIcon:K,onTargetChange:Y,value:C}):(0,H.jsx)($,{actionStore:t,collectionStore:b,disabled:G,errorMessage:L,errorIcon:K,filterErrorIcon:W,filterErrorMessage:N,filter:A,onFilterChange:U,onTargetChange:Y,value:C})}),b&&(0,H.jsx)(F().qt,{disabled:G,styles:{bodyWrap:{display:"grid",gap:8,gridTemplateColumns:"1fr",minWidth:0}},children:(0,H.jsx)(V().Ud,{actionStore:t,collectionStore:b,disabled:G,showSetPropertyActions:!0})})]})})}function q(e){const{actionStore:t,disabled:o,errorMessage:n,onTargetChange:i,value:a,errorIcon:r}=e,l=(0,s().IS)((()=>({b:{fontWeight:h().Wy.medium},span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]);return(0,H.jsx)("div",{style:l.title,children:(0,H.jsx)(g().sA,{...Y.singleTarget,values:{b:e=>(0,H.jsx)("b",{style:l.b,children:e}),targetPicker:(0,H.jsx)(Q,{actionStore:t,disabled:o,errorMessage:n,errorIcon:r,onChange:i,value:a}),span:e=>(0,H.jsx)("span",{style:l.span,children:e})}})})}function $(e){const{actionStore:t,collectionStore:o,disabled:n,errorMessage:i,errorIcon:a,filterErrorMessage:r,filterErrorIcon:l,filter:c,onFilterChange:u,onTargetChange:d,value:p}=e,m=(0,s().IS)((()=>({span:{flex:0,display:"flex",alignItems:"center"},title:{display:"inline-flex",minWidth:50,gap:6}})),[]);return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)("div",{style:m.title,children:[(0,H.jsx)(g().sA,{...Y.multipleTargetsFilter,values:{filterPicker:(0,H.jsx)(J,{collectionStore:o,disabled:n,errorMessage:r,errorIcon:l,filter:c,onChange:u}),span:e=>(0,H.jsx)("span",{style:m.span,children:e})}}),"Â "]}),(0,H.jsx)("div",{style:m.title,children:(0,H.jsx)(g().sA,{...Y.multipleTargetsPicker,values:{targetPicker:(0,H.jsx)(Q,{actionStore:t,disabled:n,errorMessage:i,errorIcon:a,onChange:d,value:p}),span:e=>(0,H.jsx)("span",{style:m.span,children:e})}})})]})}function J(e){var t;const{collectionStore:o,disabled:a,errorMessage:r,filter:l,onChange:s,errorIcon:c}=e,u=(0,i().uB)(void 0,j().A),p=(0,B().j)({tabletBehavior:"slideUp"}),m=(0,n.useCallback)((()=>u.reset()),[u]),y=(0,i().K8)((()=>{const e=o.getModel(),t=null==e?void 0:e.getDatabaseType();return(0,S().oj)(t)}),[o]),h=(null==l||null===(t=l.filters)||void 0===t?void 0:t.length)||0;return(0,H.jsx)(b().Ay,{alignmentToOrigin:b().yP.Center,disabled:a,originGap:0,placementToOrigin:b().sx.Bottom,popupType:p,renderOrigin:e=>(0,H.jsx)(E().x,{...e,disabled:a,isCompact:!0,errorIcon:c,onClick:t=>{e.onClick(t),0===h&&s(d().Lx)},dropdownButtonType:"dropdown",isError:Boolean(r),tooltipMessage:r,children:h>0?(0,H.jsx)(g().sA,{defaultMessage:"{itemType} that match {ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",id:"automations.UpdatePagesAction.FilterPicker.withRules",values:{itemType:y,ruleCount:h}}):(0,H.jsx)(g().sA,{defaultMessage:"all {itemType}",id:"automations.UpdatePagesAction.FilterPicker.noRules",values:{itemType:y}})}),render:()=>(0,H.jsx)(U,{collectionStore:o,disabled:a,filter:l,onChange:s,onClose:m})})}function Q(e){const{actionStore:t,disabled:o,errorMessage:a,onChange:s,value:c,errorIcon:d}=e,p=(0,l().v3)(),{automationStore:h,typecheckResult:f}=(0,r().EC)(),v=(0,_().F)({actionId:t.id}),S=(0,i().K8)((()=>{if("collection"===(null==c?void 0:c.type))return T().md.createChildStore(t,c.collection)}),[t,c]),k=(0,i().K8)((()=>{if(f&&c&&"variable"===c.type)return(0,u().getContextValueForActionById)(f,t.id,c.id)}),[f,c,t.id]),M=(0,i().uB)(void 0,j().A),I=(0,B().j)(),P=(0,n.useCallback)((()=>M.reset()),[M]),R=(0,n.useCallback)((e=>{s(e),P(),(0,w().CM)(((o,n,i)=>{const a=(0,w().zc)({automationActionStore:t,formulasModule:o,formulaAnalyticsModule:n,simpleFormulasModule:i});(0,y().O9)(a)&&(0,x().u)({environment:p,event:{eventName:"automation_target_pick",eventProperties:{automation_action:a,automation_id:t.getParentId(),target_type:e.type}}})}))}),[s,P,t,p]);return(0,H.jsx)(b().Ay,{buttonPopupStore:M,popupType:I,alignmentToOrigin:b().yP.Center,placementToOrigin:b().sx.Bottom,originGap:0,disabled:o,renderOrigin:e=>(0,H.jsx)(E().x,{...e,disabled:o,isCompact:!0,isError:Boolean(a),errorIcon:d,hasActionRequired:!Boolean(c||k),dropdownButtonType:"dropdown",children:(0,y().O9)(S)?(0,H.jsx)(A().A,{store:S,style:{paddingBlock:1}}):k?(0,H.jsx)(C().F,{format:m().NY.Medium,isSingle:!0,value:k,style:{background:"transparent",color:"unset",margin:"-1.5px 0",padding:0}}):(0,H.jsx)(g().sA,{id:"automations.UpdatePagesAction.pagesDropdown.label",defaultMessage:"Select database"})}),render:e=>(0,H.jsx)(D()._,{formulaTypecheckContextValues:v,onChange:R,onClose:P,parentRecordStore:h,selectedTarget:c,skipPages:!0})})}function Z(e,t){const o=e.getTargetStore().getValue();if(o){if("collection"===o.type)return T().md.createChildStore(e,o.collection);if("variable"===o.type){if(!t)return;const n=(0,a().IV)(t,o.id);if(n)return(0,M().A8)(n,e)}else{if("page"===o.type)return;(0,y().HB)(o)}}}var X=()=>o(422540),ee=()=>o(352271),te=()=>o(970013),oe=()=>o(542339),ne=()=>o(656476),ie=()=>o(541172),ae=()=>o(217028);function re(e){const{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertySchema:a}=e,r=(0,s().IS)((e=>({icon:{fill:e.text.uiRedPrimary},propertyType:{color:e.palette.red[700]}})),[]),l=function(e){const{propertySchema:t,styles:o}=e,n=t.name;return(0,H.jsx)(g().sA,{defaultMessage:"{propertyName} is a cross-workspace relation",id:"updateThisPageCrossSpaceRelationAction.crossSpaceRelation.title",values:{propertyName:(0,H.jsx)("span",{style:o.propertyType,children:n})}})}({propertySchema:a,styles:r}),c=function(e){const{propertySchema:t}=e,o=t.name;return(0,H.jsx)(g().sA,{defaultMessage:"{propertyName} is a cross-workspace relation. Cross-workspace features are restricted in automations and will not work.",id:"updateThisPageCrossSpaceRelationAction.crossSpaceRelation.text",values:{propertyName:o}})}({propertySchema:a});return(0,H.jsx)(ae().z$,{actionMenu:t,buttonPopupStore:o,disabled:n,onClick:i,propertyType:a.type,styles:r,tooltip:c,children:l})}function le(e){const{actionId:t,renderOrigin:o}=e,a=(0,B().j)(),r=(0,i().uB)(void 0,j().A),l=(0,n.useCallback)((()=>r.reset()),[r]);return(0,H.jsx)(b().Ay,{buttonPopupStore:r,popupType:a,render:()=>(0,H.jsx)(ie().qM,{actionId:t,closeMenu:l}),renderOrigin:o})}var se=()=>o(307159),ce=()=>o(984714),ue=()=>o(347114),de=(o(581454),()=>o(234194)),pe=()=>o(397785),me=()=>o(741310);function ge(e){const{action:t,actionMenu:o,buttonPopupStore:i,disabled:a,onClick:l,propertySchema:s,value:c}=e,{automationStore:d,typecheckResult:p}=(0,r().EC)(),m=(0,n.useMemo)((()=>(0,u().getAllContextValues)(p)),[p]),{title:g,tooltipTitle:y,styles:h}=(0,pe().oG)({getRecordModel:d.getRecordModel,contextValues:m,messageType:"action",operator:t,propertySchema:s,value:c}),f=(0,n.useCallback)((e=>(0,H.jsx)(F().aX,{...e,actionMenu:o,buttonPopupStore:i,disabled:a,icon:de().M,onClick:l,children:(0,H.jsx)("div",{style:h.content,children:g})})),[o,i,a,l,h.content,g]);return(0,H.jsx)(me().P,{renderOrigin:f,title:y})}var ye=()=>o(365683),he=()=>o(457050);function fe(e){const{action:t,actionMenu:o,automationActionStore:i,buttonPopupStore:a,collectionStore:r,disabled:l,onClick:s,propertySchema:c,value:u}=e,d=(0,_().F)({actionId:i.id}),{tooltipTitle:p,title:m}=(0,he().xL)({automationContextValues:d,collectionStore:r,messageType:"action",operator:t,propertySchema:c,value:u}),g=(0,n.useCallback)((e=>(0,H.jsx)(F().aX,{...e,actionMenu:o,buttonPopupStore:a,disabled:l,icon:ye().H,onClick:s,children:m})),[o,a,l,s,m]);return(0,H.jsx)(me().P,{renderOrigin:g,title:p})}var ve=()=>o(3867),xe=()=>o(237985),Se=()=>o(359186);function be(e){var t;const{actionStore:o}=e,{disabled:a}=(0,P().b)(),[r,l]=(0,i().K8)((()=>[o.id,o.getConfig()]),[o]),s=(0,_().F)({actionId:r}),c=(0,i().K8)((()=>Z(o,s)),[o,s]),u=(0,i().K8)((()=>null==c?void 0:c.getSchema()),[c]),d=(0,i().K8)((()=>null==c?void 0:c.getDeletedSchema()),[c]),p=(0,i().uB)(void 0,j().A),m=(0,n.useCallback)((()=>p.reset()),[p]),g=(0,n.useMemo)((()=>(0,H.jsx)(R().z,{actionStore:o,closeMenu:m})),[o,m]),y=((null==l?void 0:l.properties)??[])[0],h=null==u?void 0:u[y],f=null==d?void 0:d[y],v=null==l||null===(t=l.values)||void 0===t?void 0:t[y],x=Boolean(a),S={automationActionStore:o,actionMenu:g,buttonPopupStore:p,disabled:x,value:null==v?void 0:v.value};return!h&&f?(0,H.jsx)(ce().sF,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(ce().vu,{...e,...S,propertySchema:f})}):h||f?h&&c?(0,X().I3)(h)?"person"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(ge,{...e,...S,propertySchema:h,action:(0,ee().tz)(v)})}):"status"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(xe().II,{...e,...S,propertySchema:h})}):"select"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(ve().w$,{...e,...S,propertySchema:h})}):"multi_select"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(ue().j,{...e,...S,propertySchema:h,action:(0,ee().tz)(v)})}):"date"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(se().m,{...e,...S,propertySchema:h,valueContext:{collectionStore:c,property:y,type:"collection"}})}):"relation"===h.type&&(0,te().o2)(c.pointer.spaceId,h)?(0,H.jsx)(le,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(re,{...e,...S,propertySchema:h})}):"relation"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(fe,{...e,...S,collectionStore:c,propertySchema:h,action:(0,ee().tz)(v)})}):"checkbox"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(ne().zH,{...e,...S,propertySchema:h})}):"title"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(Se().EJ,{...e,...S,propertySchema:h})}):"text"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(Se().Zd,{...e,...S,propertySchema:h})}):"email"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(Se().ef,{...e,...S,propertySchema:h})}):"url"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(Se().Vj,{...e,...S,propertySchema:h})}):"number"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(Se().T7,{...e,...S,propertySchema:h})}):"phone_number"===h.type?(0,H.jsx)(Ae,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(Se().Jx,{...e,...S,propertySchema:h})}):null:(0,H.jsx)(ae().gI,{actionId:o.id,propertyId:y,renderOrigin:e=>(0,H.jsx)(ae().RY,{...e,...S,propertySchema:h})}):null:(0,H.jsx)(ce().sF,{actionId:o.id,renderOrigin:e=>(0,H.jsx)(ce().qR,{...e,...S})})}function Ae(e){const{actionId:t,propertyId:o,renderOrigin:a}=e,r=(0,B().j)(),l=(0,i().uB)(void 0,j().A),s=(0,n.useCallback)((()=>l.reset()),[l]),c=(0,n.useMemo)((()=>({actionId:t,propertyId:o,type:"eventActionProperty"})),[t,o]);return(0,H.jsx)(b().Ay,{buttonPopupStore:l,popupType:r,render:()=>(0,H.jsx)(oe().A,{initialState:c,onClose:s}),renderOrigin:a})}function Ce(e){const{actionStore:t}=e,{contextType:o}=(0,r().YC)();return(0,i().K8)((()=>ke(o,t)),[t,o])?(0,H.jsx)(be,{...e}):(0,H.jsx)(G,{...e})}function ke(e,t){var o;if(!t.isType("update_pages"))return!1;const n=t.getConfig(),i="variable"===(null==n||null===(o=n.target)||void 0===o?void 0:o.type)?(0,a().y5)(n.target.id):void 0;return"event"===e&&i&&"global"===i.source&&"button_page"===i.global}},688311:(e,t,o)=>{o.d(t,{h:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.12 3.12 13.76 13.76",svg:(0,o(474848).jsx)("path",{d:"M12.718 4.625H6.313a3 3 0 0 0 0 6h7.562a1.75 1.75 0 1 1 0 3.5H7.282a2.126 2.126 0 1 0 0 1.25h6.593a3 3 0 1 0 0-6H6.313a1.75 1.75 0 1 1 0-3.5h6.405a2.126 2.126 0 1 0 0-1.25m1.157.625a.875.875 0 1 1 1.75 0 .875.875 0 0 1-1.75 0"})},i=(0,o(340498).wt)("pathRoundEnds",n)},698331:(e,t,o)=>{o.d(t,{$X:()=>a,H8:()=>r,x2:()=>i});var n=()=>o(534177);function i(e){return"event"===e||"recurrence"===e}function a(e){const t=e.getTrigger();return(0,n().O9)(t)&&i(t.type)}function r(e){return"event"===e?"event":"recurrence"===e?"recurrence":void(0,n().HB)(e)}},701545:(e,t,o)=>{o.d(t,{p:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("checkMarkLine",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M6.79297 13.2871C6.48047 13.2871 6.21484 13.1523 5.99609 12.8828L2.96094 9.14453C2.875 9.04297 2.8125 8.94336 2.77344 8.8457C2.73828 8.74805 2.7207 8.64648 2.7207 8.54102C2.7207 8.30664 2.79883 8.11328 2.95508 7.96094C3.11133 7.80859 3.30859 7.73242 3.54688 7.73242C3.81641 7.73242 4.04297 7.84766 4.22656 8.07812L6.76953 11.3008L11.7324 3.4375C11.834 3.28125 11.9395 3.17188 12.0488 3.10938C12.1582 3.04297 12.2949 3.00977 12.459 3.00977C12.6973 3.00977 12.8926 3.08398 13.0449 3.23242C13.1973 3.38086 13.2734 3.57031 13.2734 3.80078C13.2734 3.89453 13.2578 3.98828 13.2266 4.08203C13.1953 4.17578 13.1465 4.27344 13.0801 4.375L7.5957 12.8594C7.4082 13.1445 7.14062 13.2871 6.79297 13.2871Z"})})},703778:(e,t,o)=>{o.d(t,{d:()=>a});o(296540);var n=o(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.19 12.19",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M12.848 2.8a3.145 3.145 0 0 0-4.448 0L6.918 4.282a.625.625 0 0 0 .884.884l1.482-1.482c.74-.74 1.94-.74 2.68 0l.294.294c.74.74.74 1.94 0 2.68l-1.482 1.483a.625.625 0 1 0 .884.884l1.482-1.482a3.145 3.145 0 0 0 0-4.449z"}),(0,n.jsx)("path",{d:"M10.472 5.47a.625.625 0 0 0-.884 0L5.229 9.83a.625.625 0 1 0 .884.884l4.359-4.359a.625.625 0 0 0 0-.884"}),(0,n.jsx)("path",{d:"M5.167 6.917a.625.625 0 0 0-.884 0L2.8 8.4a3.146 3.146 0 0 0 0 4.448l.294.294a3.145 3.145 0 0 0 4.449 0l1.482-1.482a.625.625 0 0 0-.884-.884L6.66 12.258c-.74.74-1.94.74-2.68 0l-.295-.294c-.74-.74-.74-1.94 0-2.68L5.167 7.8a.625.625 0 0 0 0-.884"})]})},a=(0,o(340498).wt)("linkSmall",i)},709687:(e,t,o)=>{o.d(t,{r:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("bell",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.36914 11.7627C1.36914 12.3369 1.80664 12.7266 2.51074 12.7266H5.32031C5.38184 14.0322 6.44824 15.2285 8 15.2285C9.55176 15.2285 10.6182 14.0391 10.6797 12.7266H13.4893C14.2002 12.7266 14.6309 12.3369 14.6309 11.7627C14.6309 11.0381 13.9678 10.416 13.3457 9.81445C12.8672 9.34277 12.751 8.39941 12.6621 7.46289C12.5732 4.87207 11.8213 3.14258 10.0371 2.49316C9.77734 1.59082 9.01855 0.900391 8 0.900391C6.98145 0.900391 6.22266 1.59082 5.96289 2.49316C4.17871 3.14258 3.42676 4.87207 3.33789 7.46289C3.24902 8.39941 3.13965 9.34277 2.6543 9.81445C2.03906 10.416 1.36914 11.0381 1.36914 11.7627ZM3.00293 11.4756V11.3936C3.18066 11.1953 3.57715 10.833 3.91211 10.4434C4.38379 9.90332 4.60254 8.92578 4.6709 7.62695C4.75293 4.85156 5.60059 3.92871 6.70801 3.62793C6.87207 3.58691 6.96777 3.50488 6.98145 3.32031C7.01562 2.62305 7.39844 2.1582 8 2.1582C8.60156 2.1582 8.99121 2.62305 9.01855 3.32031C9.03223 3.50488 9.12793 3.58691 9.29883 3.62793C10.3994 3.92871 11.2539 4.85156 11.3291 7.62695C11.3975 8.92578 11.623 9.90332 12.0879 10.4434C12.4297 10.833 12.8125 11.1953 12.9834 11.3936V11.4756H3.00293ZM6.6123 12.7266H9.3877C9.33984 13.5811 8.7793 14.1348 8 14.1348C7.22754 14.1348 6.66699 13.5811 6.6123 12.7266Z"})})},721479:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,questionMarkCircleSmallIcon:()=>a});o(296540);var n=o(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.25 12.25",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M7.98 4.456c-1.044 0-2.053.604-2.298 1.584a.575.575 0 1 0 1.116.279c.083-.334.513-.713 1.183-.713.79 0 1.204.49 1.204.85 0 .219-.134.47-.443.658l-.011.006-.67.458-.003.002a1.82 1.82 0 0 0-.803 1.488.575.575 0 1 0 1.15 0c0-.193.102-.4.306-.541l.642-.44c.554-.342.982-.92.982-1.63 0-1.22-1.179-2-2.354-2m-.118 5.688a.775.775 0 1 0 0 1.55.775.775 0 0 0 0-1.55"}),(0,n.jsx)("path",{d:"M8 1.875a6.125 6.125 0 1 0 0 12.25 6.125 6.125 0 0 0 0-12.25M3.125 8a4.875 4.875 0 1 1 9.75 0 4.875 4.875 0 0 1-9.75 0"})]})},a=(0,o(340498).wt)("questionMarkCircleSmall",i)},735790:(e,t,o)=>{o.d(t,{M:()=>a});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"2.37 4.25 15.25 11.5",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M3 7.375h6.829a2.501 2.501 0 0 0 4.842 0H17a.625.625 0 1 0 0-1.25h-2.329a2.501 2.501 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25M12.25 5.5a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5"}),(0,n.jsx)("path",{fillRule:"evenodd",d:"M7.75 15.75a2.5 2.5 0 0 0 2.421-1.875H17a.625.625 0 1 0 0-1.25h-6.829a2.5 2.5 0 0 0-4.842 0H3a.625.625 0 1 0 0 1.25h2.329A2.5 2.5 0 0 0 7.75 15.75m0-1.25a1.25 1.25 0 1 0 0-2.5 1.25 1.25 0 0 0 0 2.5",clipRule:"evenodd"})]})},a=(0,o(340498).wt)("sliders",i)},736767:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(296540),i=o(474848);function a(e,t){return(0,i.jsx)(o(678553).Ay,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const r=(0,n.forwardRef)(a)},738865:(e,t,o)=>{o.d(t,{U:()=>l,t:()=>s});var n=()=>o(401497),i=()=>o(784892),a=()=>o(284371),r=()=>o(685889);const l={[i().NY.ExtremeSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[i().NY.ExtraSmall]:{height:16,fontSize:12,margin:"0 4px 0 0",recordIconMarginRight:3,pageIconSize:13,closeIconSize:8},[i().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",recordIconMarginRight:3,pageIconSize:16,closeIconSize:8},[i().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Medium]:{height:20,fontSize:14,margin:"0 12px 6px 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Inline]:{height:20,fontSize:14,margin:"0 12px 0 0",recordIconMarginRight:4,pageIconSize:20,closeIconSize:8},[i().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",recordIconMarginRight:4,pageIconSize:24,closeIconSize:10}};function s(e){let{format:t,shouldShrink:o,shouldWrap:s,isSingle:u,style:d,clickTitleBehavior:p}=e;const m="edit"===p;return(0,n().IS)((()=>{const{fontSize:e,margin:n}=l[t],p=m?r().d0:l[t].height;return{style:{...s?{display:"inline",lineHeight:1.5,borderRadius:4}:c({height:p}),fontSize:e,fontWeight:a().Wy.medium,minWidth:o?0:"auto",margin:u?0:n,...t===i().NY.Inline&&{overflow:"hidden"},...d}}}),[t,o,s,u,m,d])}function c(e){let{height:t}=e;return{display:"flex",alignItems:"center",lineHeight:1.2,height:t}}},742117:(e,t,o)=>{o.d(t,{V:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("chevronRight",{viewBox:"0 0 16 16",directional:!0,svg:(0,n.jsx)("path",{d:"M12.375 8.06445C12.375 7.83203 12.2861 7.63379 12.1084 7.45605L6.77637 2.24023C6.62598 2.08984 6.44141 2.01465 6.22266 2.01465C5.77832 2.01465 5.42285 2.35645 5.42285 2.80078C5.42285 3.01953 5.51172 3.21777 5.66211 3.375L10.4746 8.06445L5.66211 12.7539C5.51855 12.9043 5.42285 13.1025 5.42285 13.3213C5.42285 13.7725 5.77832 14.1143 6.22266 14.1143C6.44141 14.1143 6.62598 14.0391 6.77637 13.8887L12.1084 8.67285C12.293 8.49512 12.375 8.29688 12.375 8.06445Z"})})},748054:(e,t,o)=>{o.d(t,{M:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.97 2.68 12.51 14.37",svg:(0,o(474848).jsx)("path",{d:"M10.282 3.66a5.39 5.39 0 0 0-5.217-.54l-.711.305a.63.63 0 0 0-.38.575v12.425a.625.625 0 1 0 1.25 0v-3.913l.333-.142a4.14 4.14 0 0 1 4.008.414 5.39 5.39 0 0 0 5.504.405l1.06-.53a.63.63 0 0 0 .346-.56V4a.625.625 0 0 0-.905-.558l-1.06.53c-1.36.68-2.983.56-4.228-.312m-5.057 7.495V4.412l.332-.142a4.14 4.14 0 0 1 4.008.413 5.39 5.39 0 0 0 5.504.406l.156-.078v6.703l-.715.357c-1.36.68-2.983.56-4.228-.312a5.4 5.4 0 0 0-5.057-.604"})},i=(0,o(340498).wt)("flag",n)},751109:(e,t,o)=>{o.d(t,{z:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("slackLogo",{viewBox:"0 0 16 16",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M1.68078 11.7915C2.60586 11.7915 3.36156 11.0358 3.36156 10.1107V8.42993H1.68078C0.755701 8.42993 0 9.18563 0 10.1107C0 11.0358 0.755701 11.7915 1.68078 11.7915Z",fill:"#E01E5A"}),(0,n.jsx)("path",{d:"M5.88928 8.42993C4.9642 8.42993 4.2085 9.18563 4.2085 10.1107V14.3192C4.2085 15.2443 4.9642 16 5.88928 16C6.81436 16 7.57006 15.2443 7.57006 14.3192V10.1107C7.57006 9.18563 6.81436 8.42993 5.88928 8.42993Z",fill:"#E01E5A"}),(0,n.jsx)("path",{d:"M4.2085 1.68078C4.2085 2.60586 4.9642 3.36156 5.88928 3.36156H7.57006V1.68078C7.57006 0.755701 6.81436 0 5.88928 0C4.9642 0 4.2085 0.755701 4.2085 1.68078Z",fill:"#36C5F0"}),(0,n.jsx)("path",{d:"M7.57003 5.88928C7.57003 4.9642 6.81433 4.2085 5.88925 4.2085H1.68078C0.755701 4.2085 0 4.9642 0 5.88928C0 6.81436 0.755701 7.57006 1.68078 7.57006H5.88925C6.81433 7.57006 7.57003 6.81436 7.57003 5.88928Z",fill:"#36C5F0"}),(0,n.jsx)("path",{d:"M10.1107 7.57003C11.0358 7.57003 11.7915 6.81433 11.7915 5.88925V1.68078C11.7915 0.755701 11.0358 0 10.1107 0C9.18563 0 8.42993 0.755701 8.42993 1.68078V5.88925C8.42993 6.81433 9.18563 7.57003 10.1107 7.57003Z",fill:"#2EB67D"}),(0,n.jsx)("path",{d:"M14.3192 4.2085C13.3941 4.2085 12.6384 4.9642 12.6384 5.88928V7.57006H14.3192C15.2443 7.57006 16 6.81436 16 5.88928C16 4.9642 15.2443 4.2085 14.3192 4.2085Z",fill:"#2EB67D"}),(0,n.jsx)("path",{d:"M8.42993 10.1107C8.42993 11.0358 9.18563 11.7915 10.1107 11.7915H14.3192C15.2443 11.7915 16 11.0358 16 10.1107C16 9.18563 15.2443 8.42993 14.3192 8.42993H10.1107C9.18563 8.42993 8.42993 9.18563 8.42993 10.1107Z",fill:"#ECB22E"}),(0,n.jsx)("path",{d:"M11.7915 14.3192C11.7915 13.3941 11.0358 12.6384 10.1107 12.6384H8.42993V14.3192C8.42993 15.2443 9.18563 16 10.1107 16C11.0358 16 11.7915 15.2443 11.7915 14.3192Z",fill:"#ECB22E"})]})})},755535:(e,t,o)=>{o.d(t,{A:()=>v});o(581454);var n=o(296540),i=()=>o(484714),a=()=>o(56366),r=()=>o(401497),l=()=>o(668725),s=()=>o(722872);class c extends(()=>o(757695))().Store{getInitialState(){return{}}}const u=c;var d=()=>o(493823),p=()=>o(406699),m=()=>o(113474),g=()=>o(928600),y=()=>o(939740),h=o(474848);function f(e,t){let{isMenuItem:i,style:l,labelStyle:s,alignmentToOrigin:c,renderMenuSections:d,label:p,selectedTitle:m,focused:g,disabled:y,innerButtonStyle:f,buttonPopupStore:v,downIconStyle:S}=e;const C=(0,r().DP)(),k=(0,a().uB)(void 0,u),M=(0,a().uB)(v,o(463830).A);return(0,n.useImperativeHandle)(t,(()=>({closeMenu:()=>{M.setState({...M.state,open:!1})}})),[M]),i?(0,h.jsx)(A,{alignmentToOrigin:c,isMenuItem:i,renderMenuSections:d,buttonPopupStore:M,SelectButtonStore:k,renderOrigin:e=>(0,h.jsx)(x,{events:e,style:l,isMenuItem:i,label:p,selectedTitle:m,focused:g,disabled:y})}):(0,h.jsxs)("div",{style:{display:"flex",alignItems:"center",height:32,...l},children:[p&&(0,h.jsx)("div",{style:{marginRight:"auto",color:C.text.tertiary,fontSize:14,...s},children:p}),(0,h.jsx)(A,{alignmentToOrigin:c,isMenuItem:i,renderMenuSections:d,buttonPopupStore:M,SelectButtonStore:k,renderOrigin:e=>(0,h.jsx)(b,{events:e,innerButtonStyle:f,disabled:y,selectedTitle:m,downIconStyle:S})})]})}const v=n.forwardRef(f);function x(e){let{events:t,style:o,isMenuItem:n,label:i,selectedTitle:a,focused:r,disabled:l}=e;if(n){const e=i?{title:i,right:a}:{title:a};return(0,h.jsx)(m()._,{...t,focused:Boolean(r),disabled:l,style:o,...e})}return null}function S(e){let{downIconStyle:t}=e;const{device:o}=(0,i().v3)(),n=(0,r().DP)();return(0,h.jsx)(h.Fragment,{children:(0,l().b)({width:o.isMobile?14:10,marginLeft:4,fill:n.icon.tertiary,...t})})}function b(e){let{events:t,innerButtonStyle:o,downIconStyle:n,disabled:i,selectedTitle:a}=e;return(0,h.jsxs)(d().p,{disabled:i,disabledFeedback:!0,style:{marginRight:-6,...o},...t,children:[a,(0,h.jsx)(S,{downIconStyle:n})]})}function A(e){let{renderOrigin:t,alignmentToOrigin:o,isMenuItem:n,renderMenuSections:a,buttonPopupStore:r,SelectButtonStore:l}=e;const c=(0,i().v3)(),{device:u}=c;return(0,h.jsx)(p().Ay,{popupType:u.isMobile?p().z7.SlideUp:p().z7.Popup,buttonPopupStore:r,alignmentToOrigin:void 0!==o?o:p().yP.End,renderOrigin:t,placementToOrigin:n?p().sx.Right:p().sx.Bottom,originGap:n?void 0:4,render:e=>{let t;t=u.isMobile?{menuType:s().gu.ActionSheet}:{menuType:s().gu.Popup};const{focusedIndex:o,menuSections:n}=function(e,t,o){let n,i=0;const a=t(e).map((e=>({...e,items:e.items.map((e=>(e.key===o.state.selectedKey&&(n=i),i++,{...e,action:t=>{e.action(t),function(e,t){t.setState({selectedKey:e})}(e.key,o)}})))})));return{menuSections:a,focusedIndex:n}}(e,a,l);return(0,h.jsx)(g().A,{...t,children:(0,h.jsx)(y().Ay,{type:y().Oh.Vertical,initialFocus:o,sections:n})})}})}},774256:(e,t,o)=>{o.d(t,{z:()=>l});o(296540);var n=()=>o(484714),i=()=>o(401497),a=()=>o(449552),r=o(474848);function l(e){const{children:t,icon:o}=e,l=function(){const{isMobile:e}=(0,n().Y0)();return(0,i().IS)((t=>({iconWrap:{flexGrow:0,flexShrink:0},messageWrap:{flexGrow:1},lockedIcon:{fill:t.icon.secondary,height:"100%",width:"100%"},lockedIconWrap:{background:t.fill.lightGraySecondary,borderRadius:4,height:20,padding:2,width:20},paragraph:{color:t.text.secondary,fontSize:e?14:12,margin:0},wrap:{alignItems:"center",display:"flex",flexDirection:"row",marginBottom:6,gap:10},wrapWrap:{padding:e?"0 12px 12px":"0 0 6px 0"}})),[e])}();return(0,r.jsx)("div",{style:l.wrapWrap,children:(0,r.jsxs)("div",{style:l.wrap,children:[(0,r.jsx)("div",{style:l.iconWrap,children:(0,r.jsx)("div",{style:l.lockedIconWrap,children:o||(0,a().g)(l.lockedIcon)})}),(0,r.jsx)("div",{style:l.messageWrap,children:(0,r.jsx)("p",{style:l.paragraph,children:t})})]})})}},781697:(e,t,o)=>{o.d(t,{e:()=>l,v:()=>r});var n=()=>o(484714),i=()=>o(56366),a=()=>o(722872);function r(e){return e.device.isPhone||"actionSheet"===e.tabletBehavior&&e.device.isTablet?{menuType:a().gu.ActionSheet}:{menuType:a().gu.Popup,maxHeight:e.maxHeight,maxWidth:e.maxWidth,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,width:e.width,minWidth:e.minWidth}}function l(e){const t=(0,n().Y0)();return(0,i().K8)((()=>r({device:t,maxHeight:null==e?void 0:e.maxHeight,maxWidth:null==e?void 0:e.maxWidth,paddingTop:null==e?void 0:e.paddingTop,paddingBottom:null==e?void 0:e.paddingBottom,width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,tabletBehavior:null==e?void 0:e.tabletBehavior})),[t,null==e?void 0:e.maxHeight,null==e?void 0:e.maxWidth,null==e?void 0:e.paddingTop,null==e?void 0:e.paddingBottom,null==e?void 0:e.width,null==e?void 0:e.minWidth,null==e?void 0:e.tabletBehavior])}},803025:(e,t,o)=>{o.d(t,{q:()=>c});var n=()=>o(484714),i=()=>o(187174),a=()=>o(58293),r=()=>o(128265),l=()=>o(324561),s=()=>o(18530);function c(){const e=(0,a().r)(),t=(0,l().f_)({spaceId:null==e?void 0:e.id}),o=(0,n().v3)(),[{value:c}]=(0,i().Yb)((async()=>{const n=await(0,r().G)(o);return(0,s().V)({spaceStore:e,billingData:t,isMmOrEnterprise:n})}),[e,t,o]);return c??"self_serve"}},811979:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(296540),i=()=>o(56366),a=()=>o(592678),r=o(474848);function l(e,t){const{onClose:l,persistOnClose:s,render:d,stopClickPropagation:p,onClick:m,disablePopup:g,disabled:y,forceInitialInbound:h,renderOrigin:f,originGap:v,borderRadius:x,popupWrapStyle:S}=e,b=(0,i().uB)(e.buttonPopupStore,o(463830).A);(0,n.useEffect)((()=>()=>{b.setState({open:!1})}),[b]);const A=(0,n.useCallback)((()=>c(l,s,b)),[l,s,b]),C=(0,n.useCallback)((()=>(0,r.jsx)(u,{onClose:l,persistOnClose:s,render:d,buttonPopupStore:b})),[l,s,d,b]),k=(0,n.useCallback)((e=>function(e,t,o,n,i){t&&(null==e||e.stopPropagation());if(e&&a().Vt(e))return;o&&o(e);n||i.setState({...i.state,open:!0})}(e,p,m,g,b)),[p,m,g,b]),M=(0,i().K8)((()=>f({...e,onClick:y?o(496603).D_:k})),[y,k,e,f]),j=(0,i().K8)((()=>b.state.open),[b]);return(0,r.jsx)(o(897119).Ay,{ref:t,...e,forceInitialInbound:Boolean(h),render:C,open:j,onDismiss:A,origin:M,originGap:v,borderRadius:x,popupWrapStyle:S,trapFocus:!0})}const s=n.forwardRef(l);function c(e,t,o){e&&e(),t||o.reset()}function u(e){let{onClose:t,persistOnClose:o,render:a,buttonPopupStore:l}=e;const s=(0,n.useCallback)((()=>c(t,o,l)),[t,o,l]),u=(0,i().K8)((()=>a({close:s})),[a,s]);return(0,r.jsx)(r.Fragment,{children:u})}},813572:(e,t,o)=>{o.d(t,{Y:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("gmailLogo",{viewBox:"52 42 88 66",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{fill:"#4285f4",d:"M58 108h14V74L52 59v43c0 3.32 2.69 6 6 6"}),(0,n.jsx)("path",{fill:"#34a853",d:"M120 108h14c3.32 0 6-2.69 6-6V59l-20 15"}),(0,n.jsx)("path",{fill:"#fbbc04",d:"M120 48v26l20-15v-8c0-7.42-8.47-11.65-14.4-7.2"}),(0,n.jsx)("path",{fill:"#ea4335",d:"M72 74V48l24 18 24-18v26L96 92"}),(0,n.jsx)("path",{fill:"#c5221f",d:"M52 51v8l20 15V48l-5.6-4.2c-5.94-4.45-14.4-.22-14.4 7.2"})]})})},820579:(e,t,o)=>{o.d(t,{f:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.52 2.39 12.95 15.21",svg:(0,o(474848).jsx)("path",{d:"M10 2.4c.345 0 .625.28.625.625v9.966l3.333-3.333a.625.625 0 1 1 .884.884l-4.4 4.4a.625.625 0 0 1-.884 0l-4.4-4.4a.625.625 0 0 1 .884-.884l3.333 3.333V3.025c0-.345.28-.625.625-.625M4.15 16.35a.625.625 0 1 0 0 1.25h11.7a.625.625 0 0 0 0-1.25z"})},i=(0,o(340498).wt)("arrowLineDown",n)},824160:(e,t,o)=>{o.d(t,{A:()=>s});o(296540);var n=()=>o(484714),i=()=>o(401497),a=()=>o(780054),r=()=>o(704152),l=o(474848);function s(e){const t=(0,n().Y0)(),o=(0,i().IS)((e=>({sharedStyle:{display:"flex",alignItems:"center",borderRadius:4},innerStyle:{padding:"2px 6px",borderRadius:4,color:e.text.secondary,background:e.defaultBadgeBackground,fontSize:a().A.isMobile?11:9,lineHeight:t.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[t.isAndroid]);return a().A.isMobile?(0,l.jsx)(r().A,{style:{...o.sharedStyle,...e.mobileStyle},disabled:void 0===e.onClick,children:(0,l.jsx)("div",{style:{...o.innerStyle,...e.innerStyle},children:e.children})}):(0,l.jsx)(r().A,{style:{...o.sharedStyle,...e.desktopStyle},disabled:void 0===e.onClick,...e,children:(0,l.jsx)("div",{style:{...o.innerStyle,...e.innerStyle},children:e.children})})}},826352:(e,t,o)=>{o.d(t,{j:()=>g});o(296540);var n=()=>o(401497),i=()=>o(132855),a=()=>o(959013),r=()=>o(284371),l=()=>o(84817),s=()=>o(493823),c=()=>o(719147),u=()=>o(836251),d=()=>o(546461),p=o(474848);const m=(0,a().YK)({automationRequiresSubscription:{defaultMessage:"Upgrade to Plus to use this feature. <learnmore>Learn more</learnmore>",id:"AutomationHeaderView.automationRequiresSubscription"},automationRequiresSubscriptionButton:{defaultMessage:"To edit or run this automation, upgrade your plan or remove any connected action steps. <learnmore>Learn more</learnmore>",id:"AutomationHeaderView.automationRequiresSubscriptionButton"},automationRequiresSubscriptionTitle:{defaultMessage:"Upgrade to use connected actions",id:"AutomationHeaderView.automationRequiresSubscriptionTitle"},automationRequiresSubscriptionUpgradeButton:{defaultMessage:"Upgrade",id:"AutomationHeaderView.automationRequiresSubscriptionUpgradeButton"}});function g(e){const{onUpsellClick:t}=e,{contextType:o}=(0,d().EC)(),g="button_block"===o||"button_property"===o,y=g?m.automationRequiresSubscriptionButton:m.automationRequiresSubscription,h=(0,n().IS)((e=>({wrap:{fontSize:14,background:e.surface.wash,border:`1px solid ${e.surface.wash}`,borderRadius:6,padding:12,marginBottom:12},button:{fontWeight:r().Wy.medium,borderRadius:6,border:`1px solid ${e.stroke.primary}`,alignSelf:"flex-start"},titleContainer:{display:"flex"},title:{color:e.text.primary,fontWeight:r().Wy.medium,margin:0},textContainer:{display:"flex"},text:{color:e.text.secondary,margin:0},upgradeIcon:{width:18,height:18,marginLeft:0,marginRight:2,marginTop:2,marginBottom:2,color:e.text.uiBluePrimary}})),[]);return(0,p.jsxs)(l().Y1,{direction:"vertical",gap:4,style:h.wrap,children:[g&&(0,p.jsxs)("span",{style:h.titleContainer,children:[(0,i().arrowInCircleUpFillIcon)(h.upgradeIcon),(0,p.jsx)("p",{style:h.title,children:(0,p.jsx)(a().sA,{...m.automationRequiresSubscriptionTitle})})]}),(0,p.jsxs)("span",{style:h.textContainer,children:[!g&&(0,i().arrowInCircleUpFillIcon)(h.upgradeIcon),(0,p.jsx)("p",{style:h.text,children:(0,p.jsx)(a().sA,{...y,values:{learnmore:e=>(0,p.jsx)(c().A,{href:(0,u().xS)("guides.notionAiForWork"),external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,p.jsx)(s().p,{onClick:t,style:h.button,children:(0,p.jsx)(a().sA,{...m.automationRequiresSubscriptionUpgradeButton})})]})}},828973:(e,t,o)=>{o.d(t,{A:()=>p});o(898992),o(672577),o(581454);var n=o(296540),i=()=>o(56366),a=()=>o(496603),r=()=>o(406699),l=()=>o(939740),s=()=>o(897119),c=()=>o(89924),u=()=>o(722872),d=o(474848);const p=function(e){let{icon:t,iconStyle:p,title:m,selectedKey:g,onChange:y,onClick:h,popupStyle:f,menuItemOptionsStyle:v,menuStyle:x,disabled:S,collectionContextStore:b,openButtonPopup:A,hideCheck:C,children:k,disableParentClose:M,inputPlaceholder:j,...T}=e;const I=(0,o(484714).Y0)(),w="options"in T?T.options:a().Bq(T.sections),P=w.find((e=>a().n4(e.key,g))),_=(0,i().uB)(void 0,o(463830).A),B=(0,i().O$)(_);return(0,n.useEffect)((()=>{b&&A&&(_.setState({..._.state,open:A}),b.settingsStore.setState({...b.settingsStore.state,openButtonPopup:void 0})),P||o(857639).log({level:"error",from:"CollectionSettingsPickListMenuItem",type:"InvalidSelectedItem",error:(0,o(502800).convertErrorToLog)("Selected key is invalid.")})})),(0,d.jsx)(r().Ay,{popupType:I.isMobile?s().nl.SlideUp:s().nl.Popup,alignmentToOrigin:r().yP.End,placementToOrigin:r().sx.Bottom,style:f,originGap:0,buttonPopupStore:_,disabled:S,onClick:h,renderOrigin:e=>(0,d.jsx)(o(497222).A,{title:m,showChevron:!0,right:(0,d.jsx)("span",{style:o(284371).RC,children:"input"===(null==P?void 0:P.type)?P.inputValue:null==P?void 0:P.title}),rotateChevron:B.open,disabled:S,icon:t,iconStyle:p,...(0,o(553965).A)(e,T)}),render:e=>{let t;t=I.isMobile?{menuType:u().gu.ActionSheet}:{menuType:u().gu.Popup,width:250,...x};const n=(t,n)=>{if(t.hideOption)return null;let i;return i="input"===t.type?{key:n,render:n=>(0,d.jsx)(o(419357).Ay,{...n,style:{width:"100%",paddingTop:4,paddingBottom:4},value:t.inputValue??"",onChange:e=>{var o;null===(o=t.onChange)||void 0===o||o.call(t,e.target.value)},onSubmit:o=>{var n;null===(n=t.onSubmit)||void 0===n||n.call(t,t.key,e,t.inputValue),e.close()},placeholder:j,isChecked:!C&&a().n4(t.key,g)}),action:()=>{}}:{key:n,render:e=>(0,d.jsx)(o(760217).A,{...e,disabled:!1,title:t.title,icon:t.icon,caption:t.caption,captionStyle:t.captionStyle,inline:t.captionInline,spacerStyle:t.inlineSpacerStyle,body:t.body,style:v,isChecked:!C&&a().n4(t.key,g)}),action:()=>{y(t.key,e),M||e.close()}},i},i="sections"in T?T.sections.map(((e,t)=>({key:t,render:e=>(0,d.jsx)(c().A,{enableActionSheetTitle:!0,topBorder:t>0,...e}),items:a().oE(e.map(n))}))):[{key:0,render:e=>(0,d.jsx)(c().A,{enableActionSheetTitle:!0,...e}),items:a().oE(w.map(n))}];return(0,d.jsxs)(o(928600).A,{...t,children:[(0,d.jsx)(l().Ay,{type:l().Oh.Vertical,sections:i,initialFocus:0,resetFocusOnMouseOut:!0}),k||null]})}})}},848401:(e,t,o)=>{o.d(t,{Ay:()=>m,mI:()=>d,vb:()=>p});o(296540);var n=()=>o(401497),i=()=>o(784892),a=()=>o(65767),r=()=>o(959013),l=()=>o(284371),s=()=>o(704152),c=o(474848);const u=(0,r().YK)({removeTokenLabel:{defaultMessage:"Remove {title}",id:"uiGenericToken.removeTokenLabel"},removeTokenLabelGeneric:{defaultMessage:"Remove Item",id:"uiGenericToken.removeTokenLabelGeneric"}}),d=i().NY,p={[i().NY.ExtremeSmall]:{height:12,fontSize:10,margin:"0 4px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[i().NY.ExtraSmall]:{height:14,fontSize:12,margin:"0 6px 0 0",marginEditState:"0 6px 0 0",closeIconSize:8,avatarSize:14},[i().NY.Small]:{height:18,fontSize:12,margin:"0 6px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:16},[i().NY.CompactEssential]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[i().NY.Medium]:{height:20,fontSize:14,margin:"0 10px 6px 0",marginEditState:"0 6px 6px 0",closeIconSize:8,avatarSize:20},[i().NY.Inline]:{height:20,fontSize:14,closeIconSize:8,avatarSize:20,margin:"0 -5px 0 0",marginEditState:"0 6px 0 0"},[i().NY.Large]:{height:24,fontSize:16,margin:"0 8px 8px 0",marginEditState:"0 8px 8px 0",closeIconSize:10,avatarSize:24}};function m(e){let{avatarSize:t,format:o,isSingle:i,onClickRemove:d,renderAvatar:m,showRemoveButton:g,shouldShrink:y,style:h,title:f}=e;const v=(0,r().tz)(),{height:x,fontSize:S,margin:b,marginEditState:A,closeIconSize:C,avatarSize:k}=p[o],M=t??k,j=(0,n().IS)((()=>({root:{display:"flex",alignItems:"center",flexShrink:y?1:0,minWidth:0,height:x,borderRadius:6,fontSize:S,lineHeight:"120%",margin:i?0:g?A:b,...h}})),[S,x,i,b,A,y,g,h]);return(0,c.jsxs)("div",{style:j.root,children:[null==m?void 0:m(M),(0,c.jsx)("div",{className:"notranslate",style:{...l().RC},children:f}),g?(0,c.jsx)(s().A,{ariaLabel:void 0!==f?v.formatMessage(u.removeTokenLabel,{title:f}):v.formatMessage(u.removeTokenLabelGeneric),onClick:d,style:{display:"flex",alignItems:"center",justifyContent:"center",width:x,height:x,marginLeft:2,marginRight:2,flexGrow:0,flexShrink:0,borderRadius:6},children:(0,a().l)({width:C,height:C,opacity:.5})}):null]})}},858163:(e,t,o)=>{o.d(t,{W:()=>l});var n=o(296540),i=()=>o(973647),a=()=>o(217827),r=()=>o(546461);function l(e){const t=(0,r().YC)();return{onTextStoreSelect:(0,n.useMemo)((()=>{if(t.defined&&i().Q.isSuccess(t.typecheckResult)){const{automationStore:o,contextType:n,typecheckResult:i}=t;return function(){a().A.focus({automationStore:o,contextType:n,typecheckResult:i.value,automationActionStore:e})}}}),[e,t]),onTextStoreUnselect:(0,n.useMemo)((()=>{if(t.defined&&i().Q.isSuccess(t.typecheckResult)){const{automationStore:o,contextType:n,typecheckResult:i}=t;return function(){a().A.blur({automationStore:o,contextType:n,typecheckResult:i.value,automationActionStore:e})}}}),[e,t])}}},863330:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,plusSmallIcon:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.74 2.74 10.52 10.52",svg:(0,o(474848).jsx)("path",{d:"M8 2.74a.66.66 0 0 1 .66.66v3.94h3.94a.66.66 0 0 1 0 1.32H8.66v3.94a.66.66 0 0 1-1.32 0V8.66H3.4a.66.66 0 0 1 0-1.32h3.94V3.4A.66.66 0 0 1 8 2.74"})},i=(0,o(340498).wt)("plusSmall",n)},864040:(e,t,o)=>{o.d(t,{A:()=>i});o(581454),o(296540);var n=o(474848);const i=function(e,t,i){return[{key:"results",render:e=>(0,n.jsx)(o(89924).A,{...e}),items:t.map(((t,a)=>({key:t.id,render:e=>(0,n.jsx)(o(958378).A,{...e,isSubpage:0!==a,store:t,hidePath:!0}),action:n=>{let{event:a}=n;const r=o(728611).Vr(a);t instanceof o(630116).Bv&&(i&&i(t),o(857783).uK({environment:e,store:t,openInNew:r,visitType:o(211716).ig.Link,pageVisitSource:o(584262).y8.Breadcrumb}))}})))}]}},864779:(e,t,o)=>{o.d(t,{Me:()=>l,Vv:()=>i,Z3:()=>a,wI:()=>r});var n=()=>o(244641);function i(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function a(e){const{currentSprintEndDate:t,sprintSchedule:o}=e;return s({startDate:u({dateToAdjust:n().c9.fromISO(t),weekday:o.weekday,wrapForEqualDays:!0}),duration:o.duration})}function r(e){const{userTimeZone:t,sprintSchedule:o}=e;return s({startDate:n().c9.local({zone:t}),duration:o.duration})}function l(e){const{currentSprintStartDate:t,sprintSchedule:o}=e,i=u({dateToAdjust:n().c9.fromISO(t),weekday:o.weekday,wrapForEqualDays:!1}),{end_date:a}=s({startDate:i,duration:o.duration});let r=n().c9.fromISO(a);const l=n().c9.now().startOf("day");for(;r.diff(l,"days").days<0;)r=r.plus({weeks:1});return{type:"daterange",start_date:r.plus({days:1}).minus({weeks:o.duration}).toISODate(),end_date:r.toISODate()}}function s(e){const{startDate:t,duration:o}=e,n=t.plus({weeks:o}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:n.toISODate()}}const c={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function u(e){const{dateToAdjust:t,weekday:o,wrapForEqualDays:n}=e,i=d({currentWeekday:t.weekday%7,nextWeekday:c[o],wrapForEqualDays:n});return t.plus({days:i})}function d(e){const{currentWeekday:t,nextWeekday:o,wrapForEqualDays:n}=e,i="number"==typeof t?t:c[t],a="number"==typeof o?o:c[o];if(i===a)return n?7:0;let r=i,l=0;for(;r!==a;)r===c.SA?r=0:r+=1,l+=1;return l}},866515:(e,t,o)=>{o.d(t,{n:()=>i});var n=o(296540);function i(e,t,o){const i=(0,n.useRef)(e),a=(0,n.useRef)(null);(0,n.useEffect)((()=>{i.current=e}),[e]),(0,n.useEffect)((()=>{const e=async()=>{a.current&&(clearTimeout(a.current),a.current=null),o&&(await i.current(),a.current=setTimeout(e,t))};return o&&e(),()=>{a.current&&(clearTimeout(a.current),a.current=null)}}),[o,t])}},881254:(e,t,o)=>{o.d(t,{R:()=>B});var n=o(296540),i=()=>o(908006),a=()=>o(484714),r=()=>o(401497),l=()=>o(925907),s=()=>o(126617),c=()=>o(703778),u=()=>o(173019),d=()=>o(340498),p=()=>o(959013),m=()=>o(381349),g=()=>o(284371),y=()=>o(884107),h=()=>o(522945),f=()=>o(115512),v=()=>o(962730),x=()=>o(397248),S=()=>o(630116),b=()=>o(704152),A=()=>o(406699),C=()=>o(854672),k=()=>o(285790),M=()=>o(807683),j=()=>o(710149),T=()=>o(8980),I=()=>o(453101),w=()=>o(21140),P=()=>o(904694),_=o(474848);function B(e){const t=(0,a().v3)(),{hoverData:o,href:B,handleEditClick:R,showEditButton:V,loading:E,store:D,token:F,onDismiss:O}=e,L=(0,r().IS)((e=>({newWrapper:{width:280,flexDirection:"column",alignItems:"flex-start"},coverContainer:{width:280,height:120},contentNew:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"12px 16px",gap:12,width:280},titleAndDescription:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:0,gap:2,width:248},linkTitle:{...(0,f().pA)(2),fontStyle:"normal",fontWeight:g().Wy.semibold,fontSize:14,lineHeight:"143%",fontFeatureSettings:"'case' on",textOverflow:"ellipsis",color:e.text.primary},newDescription:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:0,...(0,f().pA)(3),textOverflow:"ellipsis",width:248},newText:{fontSize:12,fontWeight:400,whiteSpace:"normal",wordBreak:"break-word",color:e.text.primary},buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,fill:e.icon.tertiary,background:o?I().xA:"dark"===e.mode?e.palette.gray[100]:e.buttonBackground,border:o?void 0:"1px solid var(--Stroke-Deemphasized, rgba(227, 226, 224, 0.50))"},iconBoxImageStyle:{margin:1}})),[o]),K=(0,p().tz)(),N=(0,n.useRef)(null),W=(0,p().YK)({copyLink:{defaultMessage:"Copy link",id:"hoverPreviewOverlay.copyLink"},editLink:{defaultMessage:"Edit link",id:"hoverPreviewOverlay.editLink"}}),z=(0,n.useCallback)((async()=>{await i().default.afterNextFlush();const e=await y().R.clipboardActions.load(),o=e.clipboardMessages.copiedLinkToClipboard,n=B;e.copyString({environment:t,stringValue:n,copiedMessage:o})}),[t,B]),H=D&&D.recordStoreUIParentStore&&D.recordStoreUIParentStore instanceof S().Bv?D.recordStoreUIParentStore:D instanceof S().Bv?D:void 0,U=(null==o?void 0:o.thumbnail_url)??((null==o?void 0:o.images)&&o.images.length>0&&o.images[0].url);return(0,_.jsxs)(w().wt,{style:L.newWrapper,children:[V?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(k().A,{onClick:z,icon:l().n,color:"primary",ariaLabel:K.formatMessage(W.copyLink),hasBackground:!0,style:{position:"absolute",top:8,right:8}}),(0,_.jsx)(k().A,{onClick:R,icon:u().r,color:"primary",ariaLabel:K.formatMessage(W.editLink),hasBackground:!0,style:{position:"absolute",top:8,right:35}})]}):void 0,F&&H&&!V?(0,_.jsx)("div",{style:{position:"absolute",top:8,right:8,zIndex:1},children:(0,_.jsx)(A().Ay,{popupType:A().z7.Popup,placementToOrigin:v().W.Right,alignmentToOrigin:v().C.Start,originGap:4,onClose:()=>{let e=!1;const t=N.current;t&&(e=(0,x().ux)(t.getBoundingClientRect(),h().$C.x,h().$C.y)),e||null==O||O()},renderOrigin:e=>(0,_.jsx)(b().A,{style:L.buttonStyle,...e,children:(0,s().Y)({width:d().Ev.sm,fill:o?m().Ay.white:m().Ay.uiGray})}),render:e=>(0,_.jsx)(P().A,{parentBlockStore:H,store:D,token:F,href:B,hoverData:o,onAccept:()=>e.close()})})}):void 0,U?(0,_.jsx)(w().Ye,{style:L.coverContainer,children:(0,_.jsx)(M().Ay,{src:U,style:{width:"100%",height:"100%",left:0,top:"calc(50% - 280px/2)"}})}):void 0,(0,_.jsxs)(w().wt,{style:L.contentNew,children:[null!=o&&o.title||null!=o&&o.description?(0,_.jsxs)(w().wt,{style:L.titleAndDescription,children:[null!=o&&o.title?(0,_.jsx)(w().Ye,{gap:2,children:(0,_.jsx)("div",{style:L.linkTitle,children:null==o?void 0:o.title})}):void 0,null!=o&&o.description?(0,_.jsx)(w().Ye,{gap:2,children:(0,_.jsx)("div",{style:L.newDescription,children:(0,_.jsx)("div",{spellCheck:!1,style:L.newText,children:(0,_.jsx)("div",{children:null==o?void 0:o.description})})})}):void 0]}):void 0,E?(0,_.jsx)(j().A,{style:{width:200,height:16}}):(0,_.jsxs)(w().Ye,{alignItems:"left",style:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4,width:205,height:16},children:[null!=o&&o.favicon_url?(0,_.jsx)(C().A,{type:"image_url",imageURL:null==o?void 0:o.favicon_url,size:16,style:L.iconBoxImageStyle}):null!=o&&o.icon_url?(0,_.jsx)(C().A,{type:"image_url",imageURL:null==o?void 0:o.icon_url,size:16,style:L.iconBoxImageStyle}):(0,_.jsx)(T().I,{icon:c().d,size:"sm",color:"secondary"}),(0,_.jsx)("div",{style:{flexGrow:0,fontWeight:g().Wy.medium,color:"#787774",fontSize:12,...g().RC},children:(null==o?void 0:o.provider_name)||(null==o?void 0:o.link_provider)||B})]})]})]})}},890409:(e,t,o)=>{o.d(t,{Ah:()=>h,Dk:()=>m,Iv:()=>y,SF:()=>g,YO:()=>x,_f:()=>b,c_:()=>d,dW:()=>v,gW:()=>p,sp:()=>A,vN:()=>f});o(16280),o(944114),o(898992),o(354520),o(803949),o(581454),o(737550);var n=()=>o(496603),i=()=>o(973647),a=()=>o(534177),r=()=>o(842599),l=()=>o(977345),s=()=>o(798880),c=()=>o(919709),u=()=>o(241319);function d(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"add_automation_step",properties:t})}function p(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"delete_automation_step",properties:t})}function m(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_create",properties:t})}function g(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_update",properties:t})}function y(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_delete",properties:t})}function h(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_enable",properties:t})}function f(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_disable",properties:t})}function v(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_create",properties:t})}function x(e,t){e.DO_NOT_USE_commonTrackEvent({eventName:"automation_action_delete",properties:t})}function S(e){const{formulaAnalyticsModule:t,formulasModule:o,formulaTypecheckContextValues:n,getRecordModel:r,spaceId:s,value:c,featureGates:u}=e;if("formula"===c.type){if(!(0,a().O9)(c.value))return;const e=i().Q.unwrapOr(o.parseFormulaInputToAst(c.value),void 0);if(e){const i=o.addTypesToFormulaAST(e,{handleDataRequest:(0,l().zg)(r),spaceId:s,valueTypes:n,featureGates:u});return{...t.getFormulaAnalytics(e,{getRecordModel:r,typecheckContextValues:n}),formula_return_type:i.node.type,redacted_formula:t.getRedactedFormulaAsStringSync(e,{getRecordModel:r,typecheckContextValues:n})}}}else{if("simple"===c.type){if(!(0,a().O9)(c.value))return;return t.getSimpleFormulaAnalytics(c.value,{getRecordModel:r,typecheckContextValues:n})}(0,a().HB)(c.type)}}function b(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g,simpleFormulasModule:y}=e;return t.isType("complete_sprint")?{automation_action_id:t.pointer.id,type:"complete_sprint"}:t.isType("create_page")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:i,getRecordModel:r,featureGates:l}=e,s=t.getConfig();let c,u=[];const d=null==s?void 0:s.collection,p=null==s?void 0:s.properties;if((0,a().O9)(d)&&(0,a().O9)(p)&&p.length>0){const e=r(d),g=null==e?void 0:e.getNormalizedSchema();(0,a().O9)(g)&&(u=p.map((e=>{var t;return(null===(t=g[e])||void 0===t?void 0:t.type)??"unknown"})));const y=null==s?void 0:s.values;if(n&&(0,a().O9)(y)){c=[];for(const e of p){var m;const a=null===(m=y[e])||void 0===m?void 0:m.value;if(!a)continue;const s=S({formulaAnalyticsModule:o,formulasModule:n,getRecordModel:r,formulaTypecheckContextValues:i,spaceId:t.spaceId,value:a,featureGates:l});s&&c.push(s)}}}return{automation_action_id:t.pointer.id,property_formula_stats:c,property_types:u,type:"create_page"}}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("duplicate_blocks")?{automation_action_id:t.pointer.id,type:"duplicate_blocks"}:t.isType("modal_confirmation")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:i,getRecordModel:r,featureGates:l}=e,s=t.getConfig(),c=[];if(n&&(0,a().O9)(s)&&s.text){const e=S({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:r,formulaTypecheckContextValues:i,spaceId:t.spaceId,value:s.text,featureGates:l});e&&c.push(e)}return{automation_action_id:t.pointer.id,formula_stats:c,type:"modal_confirmation"}}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("open_page")?{automation_action_id:t.pointer.id,type:"open_page"}:t.isType("query_collection")?{automation_action_id:t.pointer.id,type:"query_collection"}:t.isType("send_in_app_notification")?function(e){var t;const{automationActionModel:o,formulaAnalyticsModule:n,formulasModule:i,formulaTypecheckContextValues:r,getRecordModel:l,featureGates:s,simpleFormulasModule:u}=e,d={automation_action_id:o.pointer.id,messageCharacterCount:0,type:"send_in_app_notification"},p=o.getConfig();if(!(0,a().O9)(p))return d;if((0,a().O9)(p.target))if("formula"===p.target.type&&(0,a().O9)(p.target.value)){if(d.targetData={type:"formula",numUserFormulaTargets:(0,c().Fbh)(p.target.value.value).length,numFormulaContextTargets:u.getReferencedContextValueIds(p.target.value).length},i){const e=S({formulasModule:i,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:r,spaceId:o.spaceId,value:p.target.value,featureGates:s});e&&(d.formula_stats??=[],d.formula_stats.push(e))}}else if("property"===p.target.type&&(0,a().O9)(p.target.propertyId)&&(0,a().O9)(p.target.collectionPointer)){const e=l(p.target.collectionPointer),t=null==e?void 0:e.getSchema();var m;(0,a().O9)(t)&&(d.targetData={type:"property",propertyType:null===(m=t[p.target.propertyId])||void 0===m?void 0:m.type})}if((0,a().O9)(null===(t=p.notification_message)||void 0===t?void 0:t.value)&&(d.messageCharacterCount=(0,c().FAw)(p.notification_message.value),i)){const e=S({formulasModule:i,formulaAnalyticsModule:n,getRecordModel:l,formulaTypecheckContextValues:r,spaceId:o.spaceId,value:p.notification_message,featureGates:s});e&&(d.formula_stats??=[],d.formula_stats.push(e))}return d}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g,simpleFormulasModule:y}):t.isType("send_gmail_notification")?function(e){var t,o,i,l,u,d,p;const{automationActionModel:m,formulaAnalyticsModule:g,formulasModule:y,formulaTypecheckContextValues:h,getRecordModel:f,featureGates:v}=e,x=m.getConfig();if(!(0,a().O9)(x))return{automation_action_id:m.pointer.id,fields:{},recipient_domains:{},type:"send_gmail_notification"};const b=Object.fromEntries(Object.entries(x||{}).map((e=>{let[t,o]=e;var n;return"formula"===(null==o?void 0:o.type)?[t,Boolean(null==o||null===(n=o.value)||void 0===n?void 0:n.value)]:"simple"===(null==o?void 0:o.type)?[t,Boolean(null==o?void 0:o.value)]:[t,Boolean(o)]}))),{to:A,cc:C,bcc:k}=x,M=[...(null==A||null===(t=A.value)||void 0===t?void 0:t.value)||[],...(null==C||null===(o=C.value)||void 0===o?void 0:o.value)||[],...(null==k||null===(i=k.value)||void 0===i?void 0:i.value)||[]],j=[...(0,c().Fbh)(M).map((e=>f({table:s().oo,id:e}))).map((e=>null==e?void 0:e.email)).filter(a().O9),...(0,r().C3)((0,c().k4p)(M))],T=n().Tr(j.map((e=>e.split("@")[1]))),I=[null===(l=x.to)||void 0===l?void 0:l.value,null===(u=x.cc)||void 0===u?void 0:u.value,null===(d=x.bcc)||void 0===d?void 0:d.value,null===(p=x.reply_to)||void 0===p?void 0:p.value,x.from_name,x.email_subject,x.email_body].map((e=>{if(y&&(0,a().O9)(e))return S({formulaAnalyticsModule:g,formulasModule:y,getRecordModel:f,formulaTypecheckContextValues:h,spaceId:m.spaceId,value:e,featureGates:v})})).filter(a().O9);return{automation_action_id:m.pointer.id,fields:b,formula_stats:I,recipient_domains:T,type:"send_gmail_notification"}}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("slack_notification")?{automation_action_id:t.pointer.id,type:"slack_notification"}:t.isType("update_pages")?function(e){const{automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:n,formulasModule:i,formulaTypecheckContextValues:r,getRecordModel:s,featureGates:c}=e,d=t.getConfig(),p=[],m=[],g=[];if((0,a().O9)(d)&&(0,a().O9)(d.target)&&(0,a().O9)(d.properties)&&d.properties.length>0){let e;if("variable"===d.target.type){const t=(0,l().y5)(d.target.id);if("action"===t.source){const t=(0,u().y)({actionModels:o,id:d.target.id}).collectionPointer;if((0,a().O9)(t)){const o=s(t);e=null==o?void 0:o.getNormalizedSchema()}}else{if("global"!==t.source||"button_page"!==t.global)throw new Error("Failed loading property schema");{const t=(0,l().IV)(r,d.target.id);if("block"===(null==t?void 0:t.type.type)&&(0,a().O9)(t.type.collection)){const o=s(t.type.collection);e=null==o?void 0:o.getNormalizedSchema()}}}}else if("collection"===d.target.type){const t=s(d.target.collection);e=null==t?void 0:t.getNormalizedSchema()}(0,a().O9)(e)&&d.properties.forEach((o=>{const l=e[o];if((0,a().O9)(l)&&(p.push(l.type),i&&(0,a().O9)(d.values))){const e=d.values[o];if((0,a().O9)(e)&&(m.push({type:l.type,operator:e.action}),e.value)){const o=S({formulasModule:i,formulaAnalyticsModule:n,getRecordModel:s,formulaTypecheckContextValues:r,spaceId:t.spaceId,value:e.value,featureGates:c});o&&g.push(o)}}}))}return{automation_action_id:t.pointer.id,property_configs:m,property_formula_stats:g,property_types:p,type:"update_pages"}}({automationActionModel:t,automationActionModels:o,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("define_variables")?function(e){const{automationActionModel:t,formulaAnalyticsModule:o,formulasModule:n,formulaTypecheckContextValues:i,getRecordModel:r,featureGates:l}=e,s=t.getConfig(),c=[];if(n&&(0,a().O9)(s)&&s.values)for(const a of Object.values(s.values))if(a.value){const e=S({formulasModule:n,formulaAnalyticsModule:o,getRecordModel:r,formulaTypecheckContextValues:i,spaceId:t.spaceId,value:a.value,featureGates:l});e&&c.push(e)}return{automation_action_id:t.pointer.id,formula_stats:c,type:"define_variables"}}({automationActionModel:t,formulaAnalyticsModule:i,formulasModule:d,formulaTypecheckContextValues:p,getRecordModel:m,featureGates:g}):t.isType("http_request")?{automation_action_id:t.pointer.id,type:"http_request"}:t.isType("publish_site")?{automation_action_id:t.pointer.id,type:"publish_site"}:void(0,a().HB)(t)}function A(e){const{automationModel:t,builderType:o="sidebar",formulaAnalyticsModule:n,formulasModule:i,formulaTypecheckContextValues:r,getRecordModel:l,featureGates:s,simpleFormulasModule:c,source:u}=e,d=[],p=t.getActionPointers().map((e=>l(e))).filter(a().O9);for(const x of t.getActionPointers()){const e=l(x);(0,a().O9)(e)&&d.push(b({automationActionModel:e,automationActionModels:p,formulaAnalyticsModule:n,formulasModule:i,formulaTypecheckContextValues:r,getRecordModel:l,featureGates:s,simpleFormulasModule:c}))}const m=[];let g,y,h;if(t.isEventType()){var f;const e=t.getEventConfiguration(),o=l(t.getParentPointer());g=t.getParentId();const n=t.getEventConfiguration();if("collection_view"===(null===(f=n.source)||void 0===f?void 0:f.type)){const e=l(n.source.pointer);h=null==e?void 0:e.parent_id,y=null==n?void 0:n.source.pointer.id}const i=null==o?void 0:o.getNormalizedSchema();if((0,a().O9)(i)){const{pagesAdded:t,pagePropertiesEdited:o}=e;if(t&&m.push({type:"page"}),"any"===o.type)m.push({condition:"any",type:"property"});else if("none"===o.type)m.push({condition:"none",type:"property"});else{let e=[];"some"===o.type?e=o.some??[]:"all"===o.type&&(e=o.all??[]);const t=[],n=[];e.forEach((e=>{var o;const r=null===(o=i[e.property])||void 0===o?void 0:o.type;(0,a().O9)(r)&&(t.push({type:r,operator:e.filter.operator}),n.push(r))})),m.push({condition:o.type,property_configs:t,property_types:n,type:"property"})}}}else if(t.isButtonType())m.push({type:"button"});else if(t.isRecurrenceType()){var v;m.push({type:"recurrence",frequency:null===(v=t.getTrigger().recurrence)||void 0===v?void 0:v.frequency})}else(0,a().HB)(t);return{automation_actions:d,automation_id:t.id,automation_triggers:m,collection_id:g,collection_view_id:y,collection_view_block_id:h,builder_type:o,source:u}}},903854:(e,t,o)=>{o.d(t,{v:()=>p});o(296540);var n=()=>o(401497),i=()=>o(959013),a=()=>o(284371),r=()=>o(84817),l=()=>o(493823),s=()=>o(719147),c=()=>o(836251),u=o(474848);const d=(0,i().YK)({slackAutomationPricingChangeWarning:{defaultMessage:"A Plus plan will be required to access this feature starting August 13. <learnmore>Learn more</learnmore>",id:"AutomationHeaderView.slackAutomationPricingChangeWarning"},upgrade:{defaultMessage:"Upgrade",id:"AutomationHeaderView.slackAutomationPricingChangeUpgrade"}});function p(e){const{onUpsellClick:t}=e,o=d.slackAutomationPricingChangeWarning,p=(0,n().IS)((e=>({wrap:{fontSize:14,background:e.surface.wash,border:`1px solid ${e.surface.wash}`,borderRadius:6,padding:12,marginBottom:12},button:{fontWeight:a().Wy.medium,borderRadius:6,border:`1px solid ${e.stroke.primary}`,alignSelf:"flex-start"},text:{color:e.text.secondary,margin:0}})),[]);return(0,u.jsxs)(r().Y1,{direction:"vertical",gap:4,style:p.wrap,children:[(0,u.jsx)("p",{style:p.text,children:(0,u.jsx)(i().sA,{...o,values:{learnmore:e=>(0,u.jsx)(s().A,{href:(0,c().xS)("guides.notionAiForWork"),external:!0,onClick:e=>e.stopPropagation(),children:e})}})}),(0,u.jsx)(l().p,{onClick:t,style:p.button,children:(0,u.jsx)(i().sA,{...d.upgrade})})]})}},904694:(e,t,o)=>{o.d(t,{A:()=>x});o(944114),o(296540);var n=()=>o(484714),i=()=>o(700500),a=()=>o(519143),r=()=>o(742852),l=()=>o(919709),s=()=>o(959013),c=()=>o(443120),u=()=>o(884107),d=()=>o(246826),p=()=>o(751156),m=()=>o(722872),g=()=>o(575143),y=()=>o(928600),h=()=>o(939740),f=()=>o(89924),v=o(474848);function x(e){const{store:t,parentBlockStore:o,onAccept:x,token:S,href:b,hoverData:A}=e,C=(0,n().v3)(),k=[];return k.push({key:0,render:e=>(0,v.jsx)(f().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[{key:"copy link",render:e=>(0,v.jsx)(g().A,{...e,title:(0,v.jsx)(s().sA,{id:"linkMention.copyLink",defaultMessage:"Copy link"}),svg:r().w}),action:async()=>{if(!t)return;if(!S)return;const e=await u().R.clipboardActions.load(),o=e.clipboardMessages.copiedLinkToClipboard,n=b;e.copyString({environment:C,stringValue:n,copiedMessage:o})}}]}),k.push({key:1,render:e=>(0,v.jsx)(f().A,{...e,style:{paddingTop:0,paddingBottom:0}}),items:[{key:"convert to bookmark",render:e=>(0,v.jsx)(g().A,{...e,title:(0,v.jsx)(s().sA,{id:"linkMention.convertToBookmark",defaultMessage:"Turn into preview"}),svg:a().D}),action:()=>{t&&S&&p().createAndCommit({userAction:"LinkMentionMenu.convertToBookmark",environment:C,canUndo:!0,perform:e=>{if(A){const n=d().Wv({environment:C,type:i().xd.bookmark,inMemoryRecordCache:t.inMemoryRecordCache,properties:{title:A&&A.title?l().x9d(A.title):l().x9d(b),link:l().x9d(b),description:A&&A.description?l().x9d(A.description):void 0},format:{bookmark_cover:A.thumbnail_url,bookmark_icon:A.favicon_url?A.favicon_url:A.icon_url},transaction:e,spaceId:t.pointer.spaceId});c().ed({environment:C,parentBlockStore:o,blockStore:n,token:S,transaction:e})}else{const n=d().Wv({environment:C,type:i().xd.bookmark,inMemoryRecordCache:t.inMemoryRecordCache,properties:{title:l().x9d(b),link:l().x9d(b)},transaction:e,spaceId:t.pointer.spaceId});c().ed({environment:C,parentBlockStore:o,blockStore:n,token:S,transaction:e})}}})}}]}),(0,v.jsx)(y().A,{menuType:m().gu.Popup,children:(0,v.jsx)(h().Ay,{type:h().Oh.Vertical,initialFocus:void 0,onAccept:x,sections:k,style:{paddingTop:3,paddingBottom:3}})})}},920370:(e,t,o)=>{o.d(t,{L:()=>n});const n=new(o(391685).n)((e=>{let{spaceId:t}=e;return t}),(async(e,t)=>{const n=await Promise.resolve().then(o.bind(o,449506)),i=await n.callApi({eventName:"getAllUpgradeRequestsForSpace",environment:e,data:t}),a=[{key:(0,o(921997).VI)(t),version:-1}];return"success"===i.type?{value:i.data.requests,dependencies:i.data.dependencies??a}:void 0}))},933117:(e,t,o)=>{o.d(t,{A:()=>m});o(944114),o(898992),o(803949),o(581454);var n=o(296540),i=()=>o(496603),a=()=>o(534177),r=()=>o(722872),l=()=>o(377586),s=()=>o(928600),c=()=>o(939740),u=()=>o(480095),d=()=>o(89924),p=o(474848);const m=function(e){let{renderOrigin:t,onClick:n,items:i,getKey:a,renderItem:l,selectedItem:s,onSelect:c,dontCloseParentOnSelect:u,menuTypeOverride:d,menuTitle:m,width:g,minWidth:f,disabled:v,originGap:x,buttonPopupStore:S,sameWidthAsOrigin:b}=e;const A=(0,o(56366).uB)(S,o(463830).A),C=d??(o(780054).A.isMobile?r().gu.Modal:r().gu.Popup);return(0,p.jsx)(o(406699).Ay,{popupType:h(C),bottomSheetInitialState:"half",renderOrigin:t,buttonPopupStore:A,placementToOrigin:o(700250).UV.Bottom,onClick:n,render:e=>(0,p.jsx)(y,{parent:e,items:i,getKey:a,renderItem:l,selectedItem:s,onSelect:c,dontCloseParentOnSelect:u,menuType:C,menuTitle:m,width:g,minWidth:f}),disabled:v,originGap:x,sameWidthAsOrigin:b})};function g(e,t,o,i,a,r,l,s){return{key:0,render:e=>(0,n.createElement)(d().A,{...e,key:t,topBorder:t>0}),items:e.map((e=>({key:i(e),render:t=>a({...t,value:e,key:i(e),selectedItem:r}),action:()=>{!function(e,t,o){t!==e&&o(e)}(e,r,l),s||o.close()}})))}}function y(e){let{parent:t,items:o,getKey:n,renderItem:l,selectedItem:d,onSelect:m,dontCloseParentOnSelect:y,menuType:h,menuTitle:f,width:v,minWidth:x}=e;const S=[];if(function(e){return e.length>0&&e[0]instanceof Array}(o))o.forEach(((e,o)=>{const i=g(e,o,t,n,l,d,m,y);S.push(i)}));else{const e=g(o,0,t,n,l,d,m,y);S.push(e)}const b=(0,p.jsx)(c().Ay,{type:c().Oh.Vertical,initialFocus:i().SL(i().Bq(o),(e=>i().n4(e,d))),sections:S});let A;switch(h){case r().gu.ActionSheet:A={menuType:r().gu.ActionSheet};break;case r().gu.Modal:A={menuType:r().gu.Modal,title:f,right:(0,p.jsx)(u().DoneMenuText,{}),onClickRight:t.close};break;case r().gu.Popup:A={menuType:r().gu.Popup,width:v||160,minWidth:x};break;default:(0,a().HB)(h)}return(0,p.jsx)(s().A,{...A,children:b})}function h(e){switch(e){case r().gu.ActionSheet:return l().n.SlideUp;case r().gu.Modal:return l().n.BottomSheet;case r().gu.Popup:return l().n.Popup}}},938818:(e,t,o)=>{o.d(t,{J:()=>c,L:()=>u});o(18107),o(967357);var n=o(296540),i=()=>o(563015),a=()=>o(959013),r=()=>o(534177),l=()=>o(554509),s=o(474848);function c(e){const{analyzedFormulaOutput:t}=e,{parseErrors:o,typeErrors:i}=t,c=(0,a().tz)(),d=(0,n.useMemo)((()=>u(c,o??[],i??[])),[c,o,i]);return(0,r().O9)(d)?(0,s.jsx)(l().D,{colorName:"uiRedPrimary",styleName:"UISmall-12px/Regular",children:(0,s.jsx)(a().sA,{...d})}):null}function u(e,t,o){const n=null==t?void 0:t.at(0);if((0,r().O9)(n))return(0,i().ml)(n);const a=null==o?void 0:o.at(0);return(0,r().O9)(a)?(0,i().rA)(e,a):void 0}},950914:(e,t,o)=>{o.d(t,{AL:()=>a,Q6:()=>l,vt:()=>r});o(898992),o(672577);var n=()=>o(66689),i=()=>o(254947);const a={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function r(e){const{eventTracker:t,properties:o}=e;t.DO_NOT_USE_commonTrackEvent({eventName:"complete_sprint_action",properties:o})}function l(e,t){var o;return null===(o=t.groups)||void 0===o||null===(o=o.find((t=>t.id===n().nl||(null==t?void 0:t.name)===i().P0||(null==t?void 0:t.name)===e.formatMessage(i().oz.statusGroupNameComplete))))||void 0===o?void 0:o.name}},980585:(e,t,o)=>{o.d(t,{n:()=>i});o(296540);var n=o(474848);const i=(0,o(340498).wt)("roundedCheck",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M6.00879 11.4033C5.70605 11.4033 5.45378 11.2829 5.25195 11.042L2.73242 7.99023C2.64453 7.88932 2.58268 7.79167 2.54688 7.69727C2.51107 7.60286 2.49316 7.50521 2.49316 7.4043C2.49316 7.17318 2.56966 6.98275 2.72266 6.83301C2.87891 6.68001 3.07422 6.60352 3.30859 6.60352C3.56901 6.60352 3.78548 6.70931 3.95801 6.9209L5.98926 9.43555L9.97852 3.13184C10.0794 2.97884 10.1836 2.87142 10.291 2.80957C10.4017 2.74447 10.5368 2.71191 10.6963 2.71191C10.9307 2.71191 11.1243 2.78678 11.2773 2.93652C11.4303 3.08626 11.5068 3.27507 11.5068 3.50293C11.5068 3.58757 11.4922 3.67546 11.4629 3.7666C11.4336 3.85775 11.388 3.95215 11.3262 4.0498L6.78027 11.0078C6.60124 11.2715 6.34408 11.4033 6.00879 11.4033Z"})})},987017:(e,t,o)=>{o.d(t,{Ay:()=>c,Jy:()=>s,vU:()=>l});o(581454);var n=o(296540),i=()=>o(722872),a=o(474848);function r(e){let{tabs:t,selectedIndex:r,onChange:c,separatorIndexes:u,right:d,style:p,rightStyle:m,tabStyle:g,tabTitleStyle:y,selectedTabTitleStyle:h,tabBorderStyle:f,selectedTabStyle:v,readOnly:x,hideTabBorder:S,idPrefix:b,hideTabIndexes:A}=e;const C=(0,n.useContext)(i().xu),{device:k,WindowSizeStore:M}=(0,o(484714).v3)(),{safePaddingLeft:j,safePaddingRight:T}=(0,o(56366).K8)((()=>({safePaddingLeft:M.getSafePaddingLeftCSS(16),safePaddingRight:M.getSafePaddingRightCSS(16)})),[M]),I=(0,o(401497).IS)((e=>{const t={paddingTop:6,paddingBottom:6,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.text.secondary,...g},o=`inset 0 -1px 0 ${e.regularDividerColor}`,n=C.menuType===i().gu.Popup,a={fontSize:16,paddingTop:2,paddingLeft:n?16:j,paddingRight:n?16:T,zIndex:2,height:44,background:e.popoverBackground};return{container:{overflowY:"visible",overflowX:"auto",display:"flex",width:"100%",position:"relative",boxShadow:S?void 0:o,...k.isMobile?a:{fontSize:14,paddingLeft:8,paddingRight:8,zIndex:1},...p},separator:{display:"inline-flex",alignItems:"center",margin:"0 4px",paddingBottom:4,whiteSpace:"nowrap",minWidth:0,flexShrink:0,color:e.regularDividerColor},tab:t,selectedTab:{...t,position:"relative",color:e.text.primary,...v},border:{borderBottom:`2px solid ${e.text.primary}`,position:"absolute",bottom:0,left:8,right:8,...f},rightContainer:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"flex-end",color:e.text.secondary,...m}}}),[C.menuType,k.isMobile,m,j,T,v,p,f,g,S]);return(0,a.jsxs)("div",{className:"hide-scrollbar",style:I.container,role:"tablist",children:[t.map(((e,t)=>{if(null!=A&&A.includes(t))return null;const i=t===r;return(0,a.jsxs)(n.Fragment,{children:[(0,a.jsxs)("div",{style:i?I.selectedTab:I.tab,children:[(0,a.jsx)(o(493823).p,{role:"tab",style:{...y,...i?h:{}},onClick:()=>c(t),disabled:x,isLightGray:!Boolean(i),"aria-selected":i,id:l(b,t),"aria-controls":s(b,t),children:e}),i&&(0,a.jsx)("div",{style:I.border})]},`tabButton-${t}`),u&&u.includes(t)&&(0,a.jsx)("div",{style:I.separator,className:"notranslate",children:"|"},`${t}-separator`)]},t)})),d&&(0,a.jsx)("div",{style:I.rightContainer,children:d})]})}function l(e,t){if(e)return`${e}-tab-${t}`}function s(e,t){if(e)return`${e}-tabpanel-${t}`}const c=n.memo(r)}}]);