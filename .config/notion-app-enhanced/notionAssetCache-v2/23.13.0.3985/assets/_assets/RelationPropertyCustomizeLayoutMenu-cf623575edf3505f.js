"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[92222],{50651:(e,t,o)=>{o.d(t,{default:()=>_});o(898992),o(354520),o(672577),o(581454);var r=o(296540),i=()=>o(484714),n=()=>o(56366),l=()=>o(401497),s=()=>o(743176),a=()=>o(851979),d=()=>o(987555),p=()=>o(959013),c=()=>o(496603),y=()=>o(284371),u=()=>o(679924);var h=()=>o(27732),m=()=>o(896628),g=()=>o(751156),v=()=>o(722872),b=()=>o(685889),x=()=>o(962730),f=()=>o(736767),S=()=>o(760217),j=()=>o(439264),C=()=>o(285790),k=()=>o(928600),P=()=>o(939740),A=()=>o(89924),T=o(474848);const _=function(e){let{collectionStore:t,targetCollectionStore:s,property:a,disabled:d,rowType:c}=e;const y=(0,l().DP)(),h=(0,i().v3)(),m=(0,n().uB)(void 0,o(970585).A),{format:g}=(0,r.useContext)(o(655424).t),v=(0,n().K8)((()=>{const e=b().B7({collectionStore:t,property:a}),o=Object.keys(s.getSchema()).map((t=>e.find((e=>e.property===t))??{property:t,visible:!1})),r=e.map((e=>e.property)),i=e=>{const t=r.indexOf(e);return-1!==t?t:1/0};return o.sort(((e,t)=>i(e.property)-i(t.property))),o}),[t,s,a]),f=(0,r.useCallback)((e=>(0,T.jsx)(O,{parent:e,collectionStore:t,property:a,disabled:d,targetCollectionStore:s,menuListStore:m,allRelatedTargetProperties:v})),[t,a,d,s,m,v]),S=(0,l().IS)((e=>({tooltipBody:{color:e.text.secondary},tooltipContainer:{display:"flex",flexDirection:"column"}})),[]);return(0,i().WS)()&&"section"!==c||"form_editor"===g||"form_viewer"===g?null:(0,T.jsx)(o(859428).A,{renderTooltip:()=>(0,T.jsxs)("div",{style:S.tooltipContainer,children:[(0,T.jsx)("div",{children:(0,T.jsx)(p().sA,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message",defaultMessage:"Customize shown properties"})}),d&&(0,T.jsx)("div",{style:S.tooltipBody,children:(0,T.jsx)(p().sA,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message.no_access",defaultMessage:"You do not have permission to edit"})})]}),placement:"section"===c?x().W.Top:x().W.Right,render:e=>(0,T.jsx)(o(406699).Ay,{popupType:o(897119).nl.Popup,alignmentToOrigin:x().C.Start,...e,renderOrigin:t=>(0,T.jsx)(C().A,{icon:o(30626)._,iconStyle:{width:16,color:y.icon.secondary,fill:y.icon.secondary},disabled:d,...t,...e}),onClick:()=>{!function(e,t){(0,u().v)(e,"relation_customize_displayed_properties",t)}(h,{from:"section"===c?"relation_section":"configure_relation_modal"})},originGap:16,render:f})})};function w(e){const{props:t,children:o}=e;return(0,T.jsx)(A().A,{...t,noTextOverflow:!0,title:(0,T.jsx)(p().sA,{defaultMessage:"Hidden in relation",id:"database.relationMenu.hiddenInRelationTitle"}),desktopTitleStyle:{height:19},children:o,disableDesktopPadding:!0})}function M(e,t,o,r,i,n,l){const{properties:p,visibility:u}=e;return c().oE(p.map((e=>function(e,t,o,r,i,n,l){const{propertyFormat:p,visibility:c}=e,u=!c,m=i.getSchema();if(!m)return;const g=m[p.property];return g?{key:p.property,render:e=>(0,T.jsx)(S().A,{...e,showDragHandle:!l,title:(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,T.jsx)(s().zB,{icon:g.icon,type:g.type,size:16,theme:o,style:{fill:o.icon.primary}}),(0,T.jsx)("span",{style:{marginLeft:8,...y().RC},children:g.name})]}),right:(0,T.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,T.jsx)(C().A,{icon:u?d().T:a().h,iconStyle:{width:16,height:16},color:u?"secondary":"primary",onClick:()=>{h().xI({propertyFormat:p,visibility:c,collectionStore:r,property:n,environment:t})},disabled:l||"title"===p.property})})}),action:()=>{}}:void 0}({propertyFormat:e,visibility:u},t,o,r,i,n,l))))}function B(e){const t=(0,i().v3)(),{collectionStore:o,property:r,menuListStore:n,disabled:l,visibleProperties:s,hiddenProperties:a,children:d}=e,p=c().oE([...s.map((e=>e.property)),s.length>0&&a.length>0&&{key:"group-header-hidden-property",draggable:!1},...a.map((e=>e.property))]);return(0,T.jsx)(j().Ay,{direction:"vertical",keys:p,renderKey:(e,t)=>d[t],onDrop:e=>{!function(e,t,o,r,i){const{newPropertyKeys:n}=e,l=b().B7({collectionStore:o,property:r}),s=n.indexOf("group-header-hidden-property"),a=c().oE(n.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const o=l.find((t=>t.property===e));return o?s>0?"title"===e&&t>=s?o:{...o,visible:Boolean(t<s)}:o:{property:e,visible:!(s>0)||Boolean(t<s)}}))),d=l.filter((e=>!n.includes(e.property))),p={...b().TA(o)};p[r]||(p[r]={}),p[r].related_properties=[...a,...d],g().createAndCommit({userAction:"RelationPropertyCustomizeLayoutMenu.handlePropertyReorder",environment:t,canUndo:!0,perform:e=>{m().zA({stores:[o],update:{collection_relation_options:p},transaction:e})}}),i.reset()}({newPropertyKeys:e},t,o,r,n)},disabled:l})}function O(e){let{parent:t,collectionStore:o,property:r,disabled:s,targetCollectionStore:a,menuListStore:d,allRelatedTargetProperties:y}=e;const u=(0,l().DP)(),h=(0,i().v3)(),m=y.filter((e=>e.visible)),g=y.filter((e=>!e.visible)),b=(0,n().K8)((()=>M({properties:m,visibility:!0},h,u,o,a,r,s)),[m,h,u,o,a,r,s]),x=(0,n().K8)((()=>M({properties:g,visibility:!1},h,u,o,a,r,s)),[g,h,u,o,a,r,s]);return y?(0,T.jsxs)(k().A,{menuType:v().gu.Popup,maxWidth:240,maxHeight:500,children:[0===y.length&&(0,T.jsx)(A().A,{children:(0,T.jsx)(f().A,{caption:(0,T.jsx)(p().sA,{defaultMessage:"No properties",id:"database.relationMenu.noProperties"})})}),y.length>0&&(0,T.jsx)(P().Ay,{type:P().Oh.Vertical,store:d,initialFocus:void 0,sections:c().oE([m.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,T.jsx)(A().A,{...e,noTextOverflow:!0,title:(0,T.jsx)(p().sA,{defaultMessage:"Shown in relation",id:"database.relationMenu.shownInRelationTitle"}),desktopTitleStyle:{height:18},children:(0,T.jsx)(B,{collectionStore:o,property:r,disabled:s,menuListStore:d,visibleProperties:m,hiddenProperties:g,children:e.children})}),items:c().oE([...b,g.length>0&&{key:"group-header-hidden-property",render:e=>(0,T.jsx)(w,{props:e,children:(0,T.jsx)(T.Fragment,{})}),action:()=>{}},...x])},0===m.length&&g.length>0&&{key:"hidden_properties",render:e=>(0,T.jsx)(w,{props:e,children:(0,T.jsx)(B,{collectionStore:o,property:r,disabled:s,menuListStore:d,visibleProperties:m,hiddenProperties:g,children:e.children})}),items:x}])})]}):null}},655424:(e,t,o)=>{o.d(t,{O:()=>l,t:()=>n});var r=o(296540),i=o(474848);const n=(0,r.createContext)({blockPointers:[],collectionStore:void 0,collectionId:"",property:"",schema:{},analyticsFrom:void 0,isDisabled:!0,canConfigureCollection:!1,onChange:()=>{},onDismiss:()=>{},blockStore:void 0,blockPropertyValueOverlayStore:void 0,overlayMode:void 0,insertChar:void 0,format:"table"});function l(e){const{children:t,blockPointers:o,collectionStore:l,collectionId:s,property:a,schema:d,analyticsFrom:p,isDisabled:c,canConfigureCollection:y,blockStore:u,blockPropertyValueOverlayStore:h,overlayMode:m,insertChar:g,onChange:v,onDismiss:b,format:x}=e,f=(0,r.useMemo)((()=>({blockPointers:o,collectionStore:l,collectionId:s,property:a,schema:d,analyticsFrom:p,isDisabled:c,canConfigureCollection:y,blockStore:u,blockPropertyValueOverlayStore:h,overlayMode:m,insertChar:g,onChange:v,onDismiss:b,format:x})),[o,l,s,a,d,p,c,y,u,h,m,g,v,b,x]);return(0,i.jsx)(n.Provider,{value:f,children:t})}n.displayName="BlockPropertyValueOverlayContext"},736767:(e,t,o)=>{o.d(t,{A:()=>l});var r=o(296540),i=o(474848);function n(e,t){return(0,i.jsx)(o(678553).Ay,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const l=(0,r.forwardRef)(n)},851979:(e,t,o)=>{o.d(t,{h:()=>i});o(296540);var r=o(474848);const i=(0,o(340498).wt)("eye",{viewBox:"0 0 32 32",svg:(0,r.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})}}]);